import{e as LS,_ as x1e,a as T1e,P as O1e,c as E1e,b as R1e,u as k1e}from"./chart-270f9fd1.js";import{d as Fu,o as ii,a as ai,b as kr,e as Io,w as FT,j as ow,t as zO,i as o$,s as mne,v as bne,_ as pm,B as Ef,r as Jp,F as HT,x as BT,n as $5,D as N5,G as cp,f as Mo,h as GO,H as QP,I as PC,J as A1e,c as el,K as P1e,L as eb,M as L5,l as kB,N as I1e,O as M1e,q as wne,P as D1e,Q as $1e,R as N1e,S as L1e,A as F1e,u as H1e}from"./index-412d0f2d.js";const AB=e=>(mne("data-v-8e39b53c"),e=e(),bne(),e),B1e={class:"topbar"},V1e={class:"left"},W1e={class:"logo",title:"charts"},j1e=AB(()=>kr("img",{src:x1e,alt:"charts"},null,-1)),U1e={class:"center"},z1e={class:"name-box"},G1e={class:"name"},Y1e=AB(()=>kr("i",{class:"iconfont icon-weibiaoti520"},null,-1)),K1e={class:"right"},X1e={class:"operation"},q1e=AB(()=>kr("div",null,[kr("i",{class:"iconfont icon-xiazai"}),kr("div",{class:"text"},"下载")],-1)),Z1e=[q1e],J1e=Fu({__name:"topbar",props:{chart:{type:Object,default:()=>({})}},setup(e){const t=e,r=n=>{LS.emit("handleChart",n)};return(n,i)=>{const a=o$("router-link");return ii(),ai("div",B1e,[kr("div",V1e,[kr("h1",W1e,[Io(a,{tag:"a",to:{name:"home"}},{default:FT(()=>[j1e,ow(" Charts ")]),_:1})])]),kr("div",U1e,[kr("div",z1e,[kr("div",G1e,[ow(zO(t.chart.name),1),Y1e])])]),kr("div",K1e,[kr("div",X1e,[kr("div",{class:"item",onClick:i[0]||(i[0]=o=>r("download"))},Z1e)])])])}}});const Q1e=pm(J1e,[["__scopeId","data-v-8e39b53c"]]);var YO={},eCe={get exports(){return YO},set exports(e){YO=e}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright JS Foundation and other contributors <https://js.foundation/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(e,t){(function(){var r,n="4.17.11",i=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",s="__lodash_hash_undefined__",l=500,u="__lodash_placeholder__",f=1,c=2,h=4,d=1,v=2,g=1,y=2,b=4,w=8,_=16,x=32,T=64,O=128,E=256,M=512,P=30,N="...",D=800,L=16,V=1,ee=2,ie=3,le=1/0,_e=9007199254740991,U=17976931348623157e292,C=0/0,R=4294967295,I=R-1,k=R>>>1,F=[["ary",O],["bind",g],["bindKey",y],["curry",w],["curryRight",_],["flip",M],["partial",x],["partialRight",T],["rearg",E]],H="[object Arguments]",W="[object Array]",Q="[object AsyncFunction]",se="[object Boolean]",we="[object Date]",pe="[object DOMException]",me="[object Error]",Ie="[object Function]",z="[object GeneratorFunction]",Le="[object Map]",ye="[object Number]",Xe="[object Null]",Ge="[object Object]",De="[object Promise]",tt="[object Proxy]",Qe="[object RegExp]",G="[object Set]",Z="[object String]",ae="[object Symbol]",Se="[object Undefined]",fe="[object WeakMap]",Te="[object WeakSet]",ve="[object ArrayBuffer]",ge="[object DataView]",Oe="[object Float32Array]",Ce="[object Float64Array]",be="[object Int8Array]",He="[object Int16Array]",qe="[object Int32Array]",Je="[object Uint8Array]",mt="[object Uint8ClampedArray]",It="[object Uint16Array]",ur="[object Uint32Array]",Et=/\b__p \+= '';/g,St=/\b(__p \+=) '' \+/g,tr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,rr=/&(?:amp|lt|gt|quot|#39);/g,Qt=/[&<>"']/g,Ht=RegExp(rr.source),Bt=RegExp(Qt.source),qr=/<%-([\s\S]+?)%>/g,_r=/<%([\s\S]+?)%>/g,fr=/<%=([\s\S]+?)%>/g,or=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yo=/^\w*$/,to=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ro=/[\\^$.*+?()[\]{}|]/g,Oc=RegExp(ro.source),Yu=/^\s+|\s+$/g,fa=/^\s+/,Ec=/\s+$/,av=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,j=/\{\n\/\* \[wrapped with (.+)\] \*/,te=/,? & /,q=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,J=/\\(\\)?/g,re=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ne=/\w*$/,Ae=/^[-+]0x[0-9a-f]+$/i,$e=/^0b[01]+$/i,ke=/^\[object .+?Constructor\]$/,he=/^0o[0-7]+$/i,K=/^(?:0|[1-9]\d*)$/,xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Pe=/($^)/,je=/['\n\r\u2028\u2029\\]/g,Ve="\\ud800-\\udfff",Ke="\\u0300-\\u036f",pt="\\ufe20-\\ufe2f",Tr="\\u20d0-\\u20ff",Dt=Ke+pt+Tr,fn="\\u2700-\\u27bf",Ko="a-z\\xdf-\\xf6\\xf8-\\xff",Ku="\\xac\\xb1\\xd7\\xf7",Rc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Sl="\\u2000-\\u206f",Hm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",no="A-Z\\xc0-\\xd6\\xd8-\\xde",mU="\\ufe0e\\ufe0f",bU=Ku+Rc+Sl+Hm,jA="['’]",Sye="["+Ve+"]",wU="["+bU+"]",z1="["+Dt+"]",_U="\\d+",Cye="["+fn+"]",SU="["+Ko+"]",CU="[^"+Ve+bU+_U+fn+Ko+no+"]",UA="\\ud83c[\\udffb-\\udfff]",xye="(?:"+z1+"|"+UA+")",xU="[^"+Ve+"]",zA="(?:\\ud83c[\\udde6-\\uddff]){2}",GA="[\\ud800-\\udbff][\\udc00-\\udfff]",ov="["+no+"]",TU="\\u200d",OU="(?:"+SU+"|"+CU+")",Tye="(?:"+ov+"|"+CU+")",EU="(?:"+jA+"(?:d|ll|m|re|s|t|ve))?",RU="(?:"+jA+"(?:D|LL|M|RE|S|T|VE))?",kU=xye+"?",AU="["+mU+"]?",Oye="(?:"+TU+"(?:"+[xU,zA,GA].join("|")+")"+AU+kU+")*",Eye="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rye="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",PU=AU+kU+Oye,kye="(?:"+[Cye,zA,GA].join("|")+")"+PU,Aye="(?:"+[xU+z1+"?",z1,zA,GA,Sye].join("|")+")",Pye=RegExp(jA,"g"),Iye=RegExp(z1,"g"),YA=RegExp(UA+"(?="+UA+")|"+Aye+PU,"g"),Mye=RegExp([ov+"?"+SU+"+"+EU+"(?="+[wU,ov,"$"].join("|")+")",Tye+"+"+RU+"(?="+[wU,ov+OU,"$"].join("|")+")",ov+"?"+OU+"+"+EU,ov+"+"+RU,Rye,Eye,_U,kye].join("|"),"g"),Dye=RegExp("["+TU+Ve+Dt+mU+"]"),$ye=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Nye=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Lye=-1,Zr={};Zr[Oe]=Zr[Ce]=Zr[be]=Zr[He]=Zr[qe]=Zr[Je]=Zr[mt]=Zr[It]=Zr[ur]=!0,Zr[H]=Zr[W]=Zr[ve]=Zr[se]=Zr[ge]=Zr[we]=Zr[me]=Zr[Ie]=Zr[Le]=Zr[ye]=Zr[Ge]=Zr[Qe]=Zr[G]=Zr[Z]=Zr[fe]=!1;var Gr={};Gr[H]=Gr[W]=Gr[ve]=Gr[ge]=Gr[se]=Gr[we]=Gr[Oe]=Gr[Ce]=Gr[be]=Gr[He]=Gr[qe]=Gr[Le]=Gr[ye]=Gr[Ge]=Gr[Qe]=Gr[G]=Gr[Z]=Gr[ae]=Gr[Je]=Gr[mt]=Gr[It]=Gr[ur]=!0,Gr[me]=Gr[Ie]=Gr[fe]=!1;var Fye={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Hye={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Bye={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Vye={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Wye=parseFloat,jye=parseInt,IU=typeof Ef=="object"&&Ef&&Ef.Object===Object&&Ef,Uye=typeof self=="object"&&self&&self.Object===Object&&self,fi=IU||Uye||Function("return this")(),KA=t&&!t.nodeType&&t,kc=KA&&!0&&e&&!e.nodeType&&e,MU=kc&&kc.exports===KA,XA=MU&&IU.process,io=function(){try{var Ee=kc&&kc.require&&kc.require("util").types;return Ee||XA&&XA.binding&&XA.binding("util")}catch{}}(),DU=io&&io.isArrayBuffer,$U=io&&io.isDate,NU=io&&io.isMap,LU=io&&io.isRegExp,FU=io&&io.isSet,HU=io&&io.isTypedArray;function Ia(Ee,Ne,Me){switch(Me.length){case 0:return Ee.call(Ne);case 1:return Ee.call(Ne,Me[0]);case 2:return Ee.call(Ne,Me[0],Me[1]);case 3:return Ee.call(Ne,Me[0],Me[1],Me[2])}return Ee.apply(Ne,Me)}function zye(Ee,Ne,Me,ct){for(var Vt=-1,xr=Ee==null?0:Ee.length;++Vt<xr;){var Yn=Ee[Vt];Ne(ct,Yn,Me(Yn),Ee)}return ct}function ao(Ee,Ne){for(var Me=-1,ct=Ee==null?0:Ee.length;++Me<ct&&Ne(Ee[Me],Me,Ee)!==!1;);return Ee}function Gye(Ee,Ne){for(var Me=Ee==null?0:Ee.length;Me--&&Ne(Ee[Me],Me,Ee)!==!1;);return Ee}function BU(Ee,Ne){for(var Me=-1,ct=Ee==null?0:Ee.length;++Me<ct;)if(!Ne(Ee[Me],Me,Ee))return!1;return!0}function Xu(Ee,Ne){for(var Me=-1,ct=Ee==null?0:Ee.length,Vt=0,xr=[];++Me<ct;){var Yn=Ee[Me];Ne(Yn,Me,Ee)&&(xr[Vt++]=Yn)}return xr}function G1(Ee,Ne){var Me=Ee==null?0:Ee.length;return!!Me&&sv(Ee,Ne,0)>-1}function qA(Ee,Ne,Me){for(var ct=-1,Vt=Ee==null?0:Ee.length;++ct<Vt;)if(Me(Ne,Ee[ct]))return!0;return!1}function cn(Ee,Ne){for(var Me=-1,ct=Ee==null?0:Ee.length,Vt=Array(ct);++Me<ct;)Vt[Me]=Ne(Ee[Me],Me,Ee);return Vt}function qu(Ee,Ne){for(var Me=-1,ct=Ne.length,Vt=Ee.length;++Me<ct;)Ee[Vt+Me]=Ne[Me];return Ee}function ZA(Ee,Ne,Me,ct){var Vt=-1,xr=Ee==null?0:Ee.length;for(ct&&xr&&(Me=Ee[++Vt]);++Vt<xr;)Me=Ne(Me,Ee[Vt],Vt,Ee);return Me}function Yye(Ee,Ne,Me,ct){var Vt=Ee==null?0:Ee.length;for(ct&&Vt&&(Me=Ee[--Vt]);Vt--;)Me=Ne(Me,Ee[Vt],Vt,Ee);return Me}function JA(Ee,Ne){for(var Me=-1,ct=Ee==null?0:Ee.length;++Me<ct;)if(Ne(Ee[Me],Me,Ee))return!0;return!1}var Kye=QA("length");function Xye(Ee){return Ee.split("")}function qye(Ee){return Ee.match(q)||[]}function VU(Ee,Ne,Me){var ct;return Me(Ee,function(Vt,xr,Yn){if(Ne(Vt,xr,Yn))return ct=xr,!1}),ct}function Y1(Ee,Ne,Me,ct){for(var Vt=Ee.length,xr=Me+(ct?1:-1);ct?xr--:++xr<Vt;)if(Ne(Ee[xr],xr,Ee))return xr;return-1}function sv(Ee,Ne,Me){return Ne===Ne?lme(Ee,Ne,Me):Y1(Ee,WU,Me)}function Zye(Ee,Ne,Me,ct){for(var Vt=Me-1,xr=Ee.length;++Vt<xr;)if(ct(Ee[Vt],Ne))return Vt;return-1}function WU(Ee){return Ee!==Ee}function jU(Ee,Ne){var Me=Ee==null?0:Ee.length;return Me?tP(Ee,Ne)/Me:C}function QA(Ee){return function(Ne){return Ne==null?r:Ne[Ee]}}function eP(Ee){return function(Ne){return Ee==null?r:Ee[Ne]}}function UU(Ee,Ne,Me,ct,Vt){return Vt(Ee,function(xr,Yn,Wr){Me=ct?(ct=!1,xr):Ne(Me,xr,Yn,Wr)}),Me}function Jye(Ee,Ne){var Me=Ee.length;for(Ee.sort(Ne);Me--;)Ee[Me]=Ee[Me].value;return Ee}function tP(Ee,Ne){for(var Me,ct=-1,Vt=Ee.length;++ct<Vt;){var xr=Ne(Ee[ct]);xr!==r&&(Me=Me===r?xr:Me+xr)}return Me}function rP(Ee,Ne){for(var Me=-1,ct=Array(Ee);++Me<Ee;)ct[Me]=Ne(Me);return ct}function Qye(Ee,Ne){return cn(Ne,function(Me){return[Me,Ee[Me]]})}function Ma(Ee){return function(Ne){return Ee(Ne)}}function nP(Ee,Ne){return cn(Ne,function(Me){return Ee[Me]})}function Bm(Ee,Ne){return Ee.has(Ne)}function zU(Ee,Ne){for(var Me=-1,ct=Ee.length;++Me<ct&&sv(Ne,Ee[Me],0)>-1;);return Me}function GU(Ee,Ne){for(var Me=Ee.length;Me--&&sv(Ne,Ee[Me],0)>-1;);return Me}function eme(Ee,Ne){for(var Me=Ee.length,ct=0;Me--;)Ee[Me]===Ne&&++ct;return ct}var tme=eP(Fye),rme=eP(Hye);function nme(Ee){return"\\"+Vye[Ee]}function ime(Ee,Ne){return Ee==null?r:Ee[Ne]}function lv(Ee){return Dye.test(Ee)}function ame(Ee){return $ye.test(Ee)}function ome(Ee){for(var Ne,Me=[];!(Ne=Ee.next()).done;)Me.push(Ne.value);return Me}function iP(Ee){var Ne=-1,Me=Array(Ee.size);return Ee.forEach(function(ct,Vt){Me[++Ne]=[Vt,ct]}),Me}function YU(Ee,Ne){return function(Me){return Ee(Ne(Me))}}function Zu(Ee,Ne){for(var Me=-1,ct=Ee.length,Vt=0,xr=[];++Me<ct;){var Yn=Ee[Me];(Yn===Ne||Yn===u)&&(Ee[Me]=u,xr[Vt++]=Me)}return xr}function K1(Ee){var Ne=-1,Me=Array(Ee.size);return Ee.forEach(function(ct){Me[++Ne]=ct}),Me}function sme(Ee){var Ne=-1,Me=Array(Ee.size);return Ee.forEach(function(ct){Me[++Ne]=[ct,ct]}),Me}function lme(Ee,Ne,Me){for(var ct=Me-1,Vt=Ee.length;++ct<Vt;)if(Ee[ct]===Ne)return ct;return-1}function ume(Ee,Ne,Me){for(var ct=Me+1;ct--;)if(Ee[ct]===Ne)return ct;return ct}function uv(Ee){return lv(Ee)?cme(Ee):Kye(Ee)}function Xo(Ee){return lv(Ee)?hme(Ee):Xye(Ee)}var fme=eP(Bye);function cme(Ee){for(var Ne=YA.lastIndex=0;YA.test(Ee);)++Ne;return Ne}function hme(Ee){return Ee.match(YA)||[]}function dme(Ee){return Ee.match(Mye)||[]}var vme=function Ee(Ne){Ne=Ne==null?fi:fv.defaults(fi.Object(),Ne,fv.pick(fi,Nye));var Me=Ne.Array,ct=Ne.Date,Vt=Ne.Error,xr=Ne.Function,Yn=Ne.Math,Wr=Ne.Object,aP=Ne.RegExp,pme=Ne.String,oo=Ne.TypeError,X1=Me.prototype,gme=xr.prototype,cv=Wr.prototype,q1=Ne["__core-js_shared__"],Z1=gme.toString,Yr=cv.hasOwnProperty,yme=0,KU=function(){var p=/[^.]+$/.exec(q1&&q1.keys&&q1.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),J1=cv.toString,mme=Z1.call(Wr),bme=fi._,wme=aP("^"+Z1.call(Yr).replace(ro,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Q1=MU?Ne.Buffer:r,Ju=Ne.Symbol,eC=Ne.Uint8Array,XU=Q1?Q1.allocUnsafe:r,tC=YU(Wr.getPrototypeOf,Wr),qU=Wr.create,ZU=cv.propertyIsEnumerable,rC=X1.splice,JU=Ju?Ju.isConcatSpreadable:r,Vm=Ju?Ju.iterator:r,Ac=Ju?Ju.toStringTag:r,nC=function(){try{var p=Dc(Wr,"defineProperty");return p({},"",{}),p}catch{}}(),_me=Ne.clearTimeout!==fi.clearTimeout&&Ne.clearTimeout,Sme=ct&&ct.now!==fi.Date.now&&ct.now,Cme=Ne.setTimeout!==fi.setTimeout&&Ne.setTimeout,iC=Yn.ceil,aC=Yn.floor,oP=Wr.getOwnPropertySymbols,xme=Q1?Q1.isBuffer:r,Tme=Ne.isFinite,Ome=X1.join,Eme=YU(Wr.keys,Wr),Kn=Yn.max,yi=Yn.min,Rme=ct.now,kme=Ne.parseInt,QU=Yn.random,Ame=X1.reverse,sP=Dc(Ne,"DataView"),Wm=Dc(Ne,"Map"),lP=Dc(Ne,"Promise"),hv=Dc(Ne,"Set"),jm=Dc(Ne,"WeakMap"),Um=Dc(Wr,"create"),oC=jm&&new jm,zm={},Pme=$c(sP),Ime=$c(Wm),Mme=$c(lP),Dme=$c(hv),$me=$c(jm),sC=Ju?Ju.prototype:r,Gm=sC?sC.valueOf:r,e8=sC?sC.toString:r;function Y(p){if(wn(p)&&!Wt(p)&&!(p instanceof cr)){if(p instanceof so)return p;if(Yr.call(p,"__wrapped__"))return e5(p)}return new so(p)}var dv=function(){function p(){}return function(m){if(!hn(m))return{};if(qU)return qU(m);p.prototype=m;var S=new p;return p.prototype=r,S}}();function lC(){}function so(p,m){this.__wrapped__=p,this.__actions__=[],this.__chain__=!!m,this.__index__=0,this.__values__=r}Y.templateSettings={escape:qr,evaluate:_r,interpolate:fr,variable:"",imports:{_:Y}},Y.prototype=lC.prototype,Y.prototype.constructor=Y,so.prototype=dv(lC.prototype),so.prototype.constructor=so;function cr(p){this.__wrapped__=p,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=R,this.__views__=[]}function Nme(){var p=new cr(this.__wrapped__);return p.__actions__=ca(this.__actions__),p.__dir__=this.__dir__,p.__filtered__=this.__filtered__,p.__iteratees__=ca(this.__iteratees__),p.__takeCount__=this.__takeCount__,p.__views__=ca(this.__views__),p}function Lme(){if(this.__filtered__){var p=new cr(this);p.__dir__=-1,p.__filtered__=!0}else p=this.clone(),p.__dir__*=-1;return p}function Fme(){var p=this.__wrapped__.value(),m=this.__dir__,S=Wt(p),A=m<0,B=S?p.length:0,X=Z0e(0,B,this.__views__),oe=X.start,de=X.end,Re=de-oe,Be=A?de:oe-1,Fe=this.__iteratees__,We=Fe.length,ot=0,gt=yi(Re,this.__takeCount__);if(!S||!A&&B==Re&&gt==Re)return x8(p,this.__actions__);var kt=[];e:for(;Re--&&ot<gt;){Be+=m;for(var sr=-1,xt=p[Be];++sr<We;){var lr=Fe[sr],Er=lr.iteratee,Bi=lr.type,Vi=Er(xt);if(Bi==ee)xt=Vi;else if(!Vi){if(Bi==V)continue e;break e}}kt[ot++]=xt}return kt}cr.prototype=dv(lC.prototype),cr.prototype.constructor=cr;function Pc(p){var m=-1,S=p==null?0:p.length;for(this.clear();++m<S;){var A=p[m];this.set(A[0],A[1])}}function Hme(){this.__data__=Um?Um(null):{},this.size=0}function Bme(p){var m=this.has(p)&&delete this.__data__[p];return this.size-=m?1:0,m}function Vme(p){var m=this.__data__;if(Um){var S=m[p];return S===s?r:S}return Yr.call(m,p)?m[p]:r}function Wme(p){var m=this.__data__;return Um?m[p]!==r:Yr.call(m,p)}function jme(p,m){var S=this.__data__;return this.size+=this.has(p)?0:1,S[p]=Um&&m===r?s:m,this}Pc.prototype.clear=Hme,Pc.prototype.delete=Bme,Pc.prototype.get=Vme,Pc.prototype.has=Wme,Pc.prototype.set=jme;function Cl(p){var m=-1,S=p==null?0:p.length;for(this.clear();++m<S;){var A=p[m];this.set(A[0],A[1])}}function Ume(){this.__data__=[],this.size=0}function zme(p){var m=this.__data__,S=uC(m,p);if(S<0)return!1;var A=m.length-1;return S==A?m.pop():rC.call(m,S,1),--this.size,!0}function Gme(p){var m=this.__data__,S=uC(m,p);return S<0?r:m[S][1]}function Yme(p){return uC(this.__data__,p)>-1}function Kme(p,m){var S=this.__data__,A=uC(S,p);return A<0?(++this.size,S.push([p,m])):S[A][1]=m,this}Cl.prototype.clear=Ume,Cl.prototype.delete=zme,Cl.prototype.get=Gme,Cl.prototype.has=Yme,Cl.prototype.set=Kme;function xl(p){var m=-1,S=p==null?0:p.length;for(this.clear();++m<S;){var A=p[m];this.set(A[0],A[1])}}function Xme(){this.size=0,this.__data__={hash:new Pc,map:new(Wm||Cl),string:new Pc}}function qme(p){var m=_C(this,p).delete(p);return this.size-=m?1:0,m}function Zme(p){return _C(this,p).get(p)}function Jme(p){return _C(this,p).has(p)}function Qme(p,m){var S=_C(this,p),A=S.size;return S.set(p,m),this.size+=S.size==A?0:1,this}xl.prototype.clear=Xme,xl.prototype.delete=qme,xl.prototype.get=Zme,xl.prototype.has=Jme,xl.prototype.set=Qme;function Ic(p){var m=-1,S=p==null?0:p.length;for(this.__data__=new xl;++m<S;)this.add(p[m])}function e0e(p){return this.__data__.set(p,s),this}function t0e(p){return this.__data__.has(p)}Ic.prototype.add=Ic.prototype.push=e0e,Ic.prototype.has=t0e;function qo(p){var m=this.__data__=new Cl(p);this.size=m.size}function r0e(){this.__data__=new Cl,this.size=0}function n0e(p){var m=this.__data__,S=m.delete(p);return this.size=m.size,S}function i0e(p){return this.__data__.get(p)}function a0e(p){return this.__data__.has(p)}function o0e(p,m){var S=this.__data__;if(S instanceof Cl){var A=S.__data__;if(!Wm||A.length<i-1)return A.push([p,m]),this.size=++S.size,this;S=this.__data__=new xl(A)}return S.set(p,m),this.size=S.size,this}qo.prototype.clear=r0e,qo.prototype.delete=n0e,qo.prototype.get=i0e,qo.prototype.has=a0e,qo.prototype.set=o0e;function t8(p,m){var S=Wt(p),A=!S&&Nc(p),B=!S&&!A&&nf(p),X=!S&&!A&&!B&&mv(p),oe=S||A||B||X,de=oe?rP(p.length,pme):[],Re=de.length;for(var Be in p)(m||Yr.call(p,Be))&&!(oe&&(Be=="length"||B&&(Be=="offset"||Be=="parent")||X&&(Be=="buffer"||Be=="byteLength"||Be=="byteOffset")||Rl(Be,Re)))&&de.push(Be);return de}function r8(p){var m=p.length;return m?p[bP(0,m-1)]:r}function s0e(p,m){return SC(ca(p),Mc(m,0,p.length))}function l0e(p){return SC(ca(p))}function uP(p,m,S){(S!==r&&!Zo(p[m],S)||S===r&&!(m in p))&&Tl(p,m,S)}function Ym(p,m,S){var A=p[m];(!(Yr.call(p,m)&&Zo(A,S))||S===r&&!(m in p))&&Tl(p,m,S)}function uC(p,m){for(var S=p.length;S--;)if(Zo(p[S][0],m))return S;return-1}function u0e(p,m,S,A){return Qu(p,function(B,X,oe){m(A,B,S(B),oe)}),A}function n8(p,m){return p&&Ms(m,ri(m),p)}function f0e(p,m){return p&&Ms(m,da(m),p)}function Tl(p,m,S){m=="__proto__"&&nC?nC(p,m,{configurable:!0,enumerable:!0,value:S,writable:!0}):p[m]=S}function fP(p,m){for(var S=-1,A=m.length,B=Me(A),X=p==null;++S<A;)B[S]=X?r:UP(p,m[S]);return B}function Mc(p,m,S){return p===p&&(S!==r&&(p=p<=S?p:S),m!==r&&(p=p>=m?p:m)),p}function lo(p,m,S,A,B,X){var oe,de=m&f,Re=m&c,Be=m&h;if(S&&(oe=B?S(p,A,B,X):S(p)),oe!==r)return oe;if(!hn(p))return p;var Fe=Wt(p);if(Fe){if(oe=Q0e(p),!de)return ca(p,oe)}else{var We=mi(p),ot=We==Ie||We==z;if(nf(p))return O8(p,de);if(We==Ge||We==H||ot&&!B){if(oe=Re||ot?{}:z8(p),!de)return Re?W0e(p,f0e(oe,p)):V0e(p,n8(oe,p))}else{if(!Gr[We])return B?p:{};oe=ebe(p,We,de)}}X||(X=new qo);var gt=X.get(p);if(gt)return gt;if(X.set(p,oe),w5(p))return p.forEach(function(xt){oe.add(lo(xt,m,S,xt,p,X))}),oe;if(m5(p))return p.forEach(function(xt,lr){oe.set(lr,lo(xt,m,S,lr,p,X))}),oe;var kt=Be?Re?AP:kP:Re?da:ri,sr=Fe?r:kt(p);return ao(sr||p,function(xt,lr){sr&&(lr=xt,xt=p[lr]),Ym(oe,lr,lo(xt,m,S,lr,p,X))}),oe}function c0e(p){var m=ri(p);return function(S){return i8(S,p,m)}}function i8(p,m,S){var A=S.length;if(p==null)return!A;for(p=Wr(p);A--;){var B=S[A],X=m[B],oe=p[B];if(oe===r&&!(B in p)||!X(oe))return!1}return!0}function a8(p,m,S){if(typeof p!="function")throw new oo(o);return e0(function(){p.apply(r,S)},m)}function Km(p,m,S,A){var B=-1,X=G1,oe=!0,de=p.length,Re=[],Be=m.length;if(!de)return Re;S&&(m=cn(m,Ma(S))),A?(X=qA,oe=!1):m.length>=i&&(X=Bm,oe=!1,m=new Ic(m));e:for(;++B<de;){var Fe=p[B],We=S==null?Fe:S(Fe);if(Fe=A||Fe!==0?Fe:0,oe&&We===We){for(var ot=Be;ot--;)if(m[ot]===We)continue e;Re.push(Fe)}else X(m,We,A)||Re.push(Fe)}return Re}var Qu=P8(Is),o8=P8(hP,!0);function h0e(p,m){var S=!0;return Qu(p,function(A,B,X){return S=!!m(A,B,X),S}),S}function fC(p,m,S){for(var A=-1,B=p.length;++A<B;){var X=p[A],oe=m(X);if(oe!=null&&(de===r?oe===oe&&!$a(oe):S(oe,de)))var de=oe,Re=X}return Re}function d0e(p,m,S,A){var B=p.length;for(S=Kt(S),S<0&&(S=-S>B?0:B+S),A=A===r||A>B?B:Kt(A),A<0&&(A+=B),A=S>A?0:S5(A);S<A;)p[S++]=m;return p}function s8(p,m){var S=[];return Qu(p,function(A,B,X){m(A,B,X)&&S.push(A)}),S}function ci(p,m,S,A,B){var X=-1,oe=p.length;for(S||(S=rbe),B||(B=[]);++X<oe;){var de=p[X];m>0&&S(de)?m>1?ci(de,m-1,S,A,B):qu(B,de):A||(B[B.length]=de)}return B}var cP=I8(),l8=I8(!0);function Is(p,m){return p&&cP(p,m,ri)}function hP(p,m){return p&&l8(p,m,ri)}function cC(p,m){return Xu(m,function(S){return kl(p[S])})}function vv(p,m){m=tf(m,p);for(var S=0,A=m.length;p!=null&&S<A;)p=p[Ds(m[S++])];return S&&S==A?p:r}function u8(p,m,S){var A=m(p);return Wt(p)?A:qu(A,S(p))}function Fi(p){return p==null?p===r?Se:Xe:Ac&&Ac in Wr(p)?q0e(p):ube(p)}function dP(p,m){return p>m}function v0e(p,m){return p!=null&&Yr.call(p,m)}function p0e(p,m){return p!=null&&m in Wr(p)}function g0e(p,m,S){return p>=yi(m,S)&&p<Kn(m,S)}function vP(p,m,S){for(var A=S?qA:G1,B=p[0].length,X=p.length,oe=X,de=Me(X),Re=1/0,Be=[];oe--;){var Fe=p[oe];oe&&m&&(Fe=cn(Fe,Ma(m))),Re=yi(Fe.length,Re),de[oe]=!S&&(m||B>=120&&Fe.length>=120)?new Ic(oe&&Fe):r}Fe=p[0];var We=-1,ot=de[0];e:for(;++We<B&&Be.length<Re;){var gt=Fe[We],kt=m?m(gt):gt;if(gt=S||gt!==0?gt:0,!(ot?Bm(ot,kt):A(Be,kt,S))){for(oe=X;--oe;){var sr=de[oe];if(!(sr?Bm(sr,kt):A(p[oe],kt,S)))continue e}ot&&ot.push(kt),Be.push(gt)}}return Be}function y0e(p,m,S,A){return Is(p,function(B,X,oe){m(A,S(B),X,oe)}),A}function Xm(p,m,S){m=tf(m,p),p=X8(p,m);var A=p==null?p:p[Ds(fo(m))];return A==null?r:Ia(A,p,S)}function f8(p){return wn(p)&&Fi(p)==H}function m0e(p){return wn(p)&&Fi(p)==ve}function b0e(p){return wn(p)&&Fi(p)==we}function qm(p,m,S,A,B){return p===m?!0:p==null||m==null||!wn(p)&&!wn(m)?p!==p&&m!==m:w0e(p,m,S,A,qm,B)}function w0e(p,m,S,A,B,X){var oe=Wt(p),de=Wt(m),Re=oe?W:mi(p),Be=de?W:mi(m);Re=Re==H?Ge:Re,Be=Be==H?Ge:Be;var Fe=Re==Ge,We=Be==Ge,ot=Re==Be;if(ot&&nf(p)){if(!nf(m))return!1;oe=!0,Fe=!1}if(ot&&!Fe)return X||(X=new qo),oe||mv(p)?W8(p,m,S,A,B,X):K0e(p,m,Re,S,A,B,X);if(!(S&d)){var gt=Fe&&Yr.call(p,"__wrapped__"),kt=We&&Yr.call(m,"__wrapped__");if(gt||kt){var sr=gt?p.value():p,xt=kt?m.value():m;return X||(X=new qo),B(sr,xt,S,A,X)}}return ot?(X||(X=new qo),X0e(p,m,S,A,B,X)):!1}function _0e(p){return wn(p)&&mi(p)==Le}function pP(p,m,S,A){var B=S.length,X=B,oe=!A;if(p==null)return!X;for(p=Wr(p);B--;){var de=S[B];if(oe&&de[2]?de[1]!==p[de[0]]:!(de[0]in p))return!1}for(;++B<X;){de=S[B];var Re=de[0],Be=p[Re],Fe=de[1];if(oe&&de[2]){if(Be===r&&!(Re in p))return!1}else{var We=new qo;if(A)var ot=A(Be,Fe,Re,p,m,We);if(!(ot===r?qm(Fe,Be,d|v,A,We):ot))return!1}}return!0}function c8(p){if(!hn(p)||ibe(p))return!1;var m=kl(p)?wme:ke;return m.test($c(p))}function S0e(p){return wn(p)&&Fi(p)==Qe}function C0e(p){return wn(p)&&mi(p)==G}function x0e(p){return wn(p)&&RC(p.length)&&!!Zr[Fi(p)]}function h8(p){return typeof p=="function"?p:p==null?va:typeof p=="object"?Wt(p)?p8(p[0],p[1]):v8(p):M5(p)}function gP(p){if(!Qm(p))return Eme(p);var m=[];for(var S in Wr(p))Yr.call(p,S)&&S!="constructor"&&m.push(S);return m}function T0e(p){if(!hn(p))return lbe(p);var m=Qm(p),S=[];for(var A in p)A=="constructor"&&(m||!Yr.call(p,A))||S.push(A);return S}function yP(p,m){return p<m}function d8(p,m){var S=-1,A=ha(p)?Me(p.length):[];return Qu(p,function(B,X,oe){A[++S]=m(B,X,oe)}),A}function v8(p){var m=IP(p);return m.length==1&&m[0][2]?Y8(m[0][0],m[0][1]):function(S){return S===p||pP(S,p,m)}}function p8(p,m){return DP(p)&&G8(m)?Y8(Ds(p),m):function(S){var A=UP(S,p);return A===r&&A===m?zP(S,p):qm(m,A,d|v)}}function hC(p,m,S,A,B){p!==m&&cP(m,function(X,oe){if(hn(X))B||(B=new qo),O0e(p,m,oe,S,hC,A,B);else{var de=A?A(NP(p,oe),X,oe+"",p,m,B):r;de===r&&(de=X),uP(p,oe,de)}},da)}function O0e(p,m,S,A,B,X,oe){var de=NP(p,S),Re=NP(m,S),Be=oe.get(Re);if(Be){uP(p,S,Be);return}var Fe=X?X(de,Re,S+"",p,m,oe):r,We=Fe===r;if(We){var ot=Wt(Re),gt=!ot&&nf(Re),kt=!ot&&!gt&&mv(Re);Fe=Re,ot||gt||kt?Wt(de)?Fe=de:En(de)?Fe=ca(de):gt?(We=!1,Fe=O8(Re,!0)):kt?(We=!1,Fe=E8(Re,!0)):Fe=[]:t0(Re)||Nc(Re)?(Fe=de,Nc(de)?Fe=C5(de):(!hn(de)||kl(de))&&(Fe=z8(Re))):We=!1}We&&(oe.set(Re,Fe),B(Fe,Re,A,X,oe),oe.delete(Re)),uP(p,S,Fe)}function g8(p,m){var S=p.length;if(S)return m+=m<0?S:0,Rl(m,S)?p[m]:r}function y8(p,m,S){var A=-1;m=cn(m.length?m:[va],Ma(Ct()));var B=d8(p,function(X,oe,de){var Re=cn(m,function(Be){return Be(X)});return{criteria:Re,index:++A,value:X}});return Jye(B,function(X,oe){return B0e(X,oe,S)})}function E0e(p,m){return m8(p,m,function(S,A){return zP(p,A)})}function m8(p,m,S){for(var A=-1,B=m.length,X={};++A<B;){var oe=m[A],de=vv(p,oe);S(de,oe)&&Zm(X,tf(oe,p),de)}return X}function R0e(p){return function(m){return vv(m,p)}}function mP(p,m,S,A){var B=A?Zye:sv,X=-1,oe=m.length,de=p;for(p===m&&(m=ca(m)),S&&(de=cn(p,Ma(S)));++X<oe;)for(var Re=0,Be=m[X],Fe=S?S(Be):Be;(Re=B(de,Fe,Re,A))>-1;)de!==p&&rC.call(de,Re,1),rC.call(p,Re,1);return p}function b8(p,m){for(var S=p?m.length:0,A=S-1;S--;){var B=m[S];if(S==A||B!==X){var X=B;Rl(B)?rC.call(p,B,1):SP(p,B)}}return p}function bP(p,m){return p+aC(QU()*(m-p+1))}function k0e(p,m,S,A){for(var B=-1,X=Kn(iC((m-p)/(S||1)),0),oe=Me(X);X--;)oe[A?X:++B]=p,p+=S;return oe}function wP(p,m){var S="";if(!p||m<1||m>_e)return S;do m%2&&(S+=p),m=aC(m/2),m&&(p+=p);while(m);return S}function er(p,m){return LP(K8(p,m,va),p+"")}function A0e(p){return r8(bv(p))}function P0e(p,m){var S=bv(p);return SC(S,Mc(m,0,S.length))}function Zm(p,m,S,A){if(!hn(p))return p;m=tf(m,p);for(var B=-1,X=m.length,oe=X-1,de=p;de!=null&&++B<X;){var Re=Ds(m[B]),Be=S;if(B!=oe){var Fe=de[Re];Be=A?A(Fe,Re,de):r,Be===r&&(Be=hn(Fe)?Fe:Rl(m[B+1])?[]:{})}Ym(de,Re,Be),de=de[Re]}return p}var w8=oC?function(p,m){return oC.set(p,m),p}:va,I0e=nC?function(p,m){return nC(p,"toString",{configurable:!0,enumerable:!1,value:YP(m),writable:!0})}:va;function M0e(p){return SC(bv(p))}function uo(p,m,S){var A=-1,B=p.length;m<0&&(m=-m>B?0:B+m),S=S>B?B:S,S<0&&(S+=B),B=m>S?0:S-m>>>0,m>>>=0;for(var X=Me(B);++A<B;)X[A]=p[A+m];return X}function D0e(p,m){var S;return Qu(p,function(A,B,X){return S=m(A,B,X),!S}),!!S}function dC(p,m,S){var A=0,B=p==null?A:p.length;if(typeof m=="number"&&m===m&&B<=k){for(;A<B;){var X=A+B>>>1,oe=p[X];oe!==null&&!$a(oe)&&(S?oe<=m:oe<m)?A=X+1:B=X}return B}return _P(p,m,va,S)}function _P(p,m,S,A){m=S(m);for(var B=0,X=p==null?0:p.length,oe=m!==m,de=m===null,Re=$a(m),Be=m===r;B<X;){var Fe=aC((B+X)/2),We=S(p[Fe]),ot=We!==r,gt=We===null,kt=We===We,sr=$a(We);if(oe)var xt=A||kt;else Be?xt=kt&&(A||ot):de?xt=kt&&ot&&(A||!gt):Re?xt=kt&&ot&&!gt&&(A||!sr):gt||sr?xt=!1:xt=A?We<=m:We<m;xt?B=Fe+1:X=Fe}return yi(X,I)}function _8(p,m){for(var S=-1,A=p.length,B=0,X=[];++S<A;){var oe=p[S],de=m?m(oe):oe;if(!S||!Zo(de,Re)){var Re=de;X[B++]=oe===0?0:oe}}return X}function S8(p){return typeof p=="number"?p:$a(p)?C:+p}function Da(p){if(typeof p=="string")return p;if(Wt(p))return cn(p,Da)+"";if($a(p))return e8?e8.call(p):"";var m=p+"";return m=="0"&&1/p==-le?"-0":m}function ef(p,m,S){var A=-1,B=G1,X=p.length,oe=!0,de=[],Re=de;if(S)oe=!1,B=qA;else if(X>=i){var Be=m?null:G0e(p);if(Be)return K1(Be);oe=!1,B=Bm,Re=new Ic}else Re=m?[]:de;e:for(;++A<X;){var Fe=p[A],We=m?m(Fe):Fe;if(Fe=S||Fe!==0?Fe:0,oe&&We===We){for(var ot=Re.length;ot--;)if(Re[ot]===We)continue e;m&&Re.push(We),de.push(Fe)}else B(Re,We,S)||(Re!==de&&Re.push(We),de.push(Fe))}return de}function SP(p,m){return m=tf(m,p),p=X8(p,m),p==null||delete p[Ds(fo(m))]}function C8(p,m,S,A){return Zm(p,m,S(vv(p,m)),A)}function vC(p,m,S,A){for(var B=p.length,X=A?B:-1;(A?X--:++X<B)&&m(p[X],X,p););return S?uo(p,A?0:X,A?X+1:B):uo(p,A?X+1:0,A?B:X)}function x8(p,m){var S=p;return S instanceof cr&&(S=S.value()),ZA(m,function(A,B){return B.func.apply(B.thisArg,qu([A],B.args))},S)}function CP(p,m,S){var A=p.length;if(A<2)return A?ef(p[0]):[];for(var B=-1,X=Me(A);++B<A;)for(var oe=p[B],de=-1;++de<A;)de!=B&&(X[B]=Km(X[B]||oe,p[de],m,S));return ef(ci(X,1),m,S)}function T8(p,m,S){for(var A=-1,B=p.length,X=m.length,oe={};++A<B;){var de=A<X?m[A]:r;S(oe,p[A],de)}return oe}function xP(p){return En(p)?p:[]}function TP(p){return typeof p=="function"?p:va}function tf(p,m){return Wt(p)?p:DP(p,m)?[p]:Q8(Or(p))}var $0e=er;function rf(p,m,S){var A=p.length;return S=S===r?A:S,!m&&S>=A?p:uo(p,m,S)}var N0e=_me||function(p){return fi.clearTimeout(p)};function O8(p,m){if(m)return p.slice();var S=p.length,A=XU?XU(S):new p.constructor(S);return p.copy(A),A}function OP(p){var m=new p.constructor(p.byteLength);return new eC(m).set(new eC(p)),m}function L0e(p,m){var S=m?OP(p.buffer):p.buffer;return new p.constructor(S,p.byteOffset,p.byteLength)}function F0e(p){var m=new p.constructor(p.source,ne.exec(p));return m.lastIndex=p.lastIndex,m}function H0e(p){return Gm?Wr(Gm.call(p)):{}}function E8(p,m){var S=m?OP(p.buffer):p.buffer;return new p.constructor(S,p.byteOffset,p.length)}function R8(p,m){if(p!==m){var S=p!==r,A=p===null,B=p===p,X=$a(p),oe=m!==r,de=m===null,Re=m===m,Be=$a(m);if(!de&&!Be&&!X&&p>m||X&&oe&&Re&&!de&&!Be||A&&oe&&Re||!S&&Re||!B)return 1;if(!A&&!X&&!Be&&p<m||Be&&S&&B&&!A&&!X||de&&S&&B||!oe&&B||!Re)return-1}return 0}function B0e(p,m,S){for(var A=-1,B=p.criteria,X=m.criteria,oe=B.length,de=S.length;++A<oe;){var Re=R8(B[A],X[A]);if(Re){if(A>=de)return Re;var Be=S[A];return Re*(Be=="desc"?-1:1)}}return p.index-m.index}function k8(p,m,S,A){for(var B=-1,X=p.length,oe=S.length,de=-1,Re=m.length,Be=Kn(X-oe,0),Fe=Me(Re+Be),We=!A;++de<Re;)Fe[de]=m[de];for(;++B<oe;)(We||B<X)&&(Fe[S[B]]=p[B]);for(;Be--;)Fe[de++]=p[B++];return Fe}function A8(p,m,S,A){for(var B=-1,X=p.length,oe=-1,de=S.length,Re=-1,Be=m.length,Fe=Kn(X-de,0),We=Me(Fe+Be),ot=!A;++B<Fe;)We[B]=p[B];for(var gt=B;++Re<Be;)We[gt+Re]=m[Re];for(;++oe<de;)(ot||B<X)&&(We[gt+S[oe]]=p[B++]);return We}function ca(p,m){var S=-1,A=p.length;for(m||(m=Me(A));++S<A;)m[S]=p[S];return m}function Ms(p,m,S,A){var B=!S;S||(S={});for(var X=-1,oe=m.length;++X<oe;){var de=m[X],Re=A?A(S[de],p[de],de,S,p):r;Re===r&&(Re=p[de]),B?Tl(S,de,Re):Ym(S,de,Re)}return S}function V0e(p,m){return Ms(p,MP(p),m)}function W0e(p,m){return Ms(p,j8(p),m)}function pC(p,m){return function(S,A){var B=Wt(S)?zye:u0e,X=m?m():{};return B(S,p,Ct(A,2),X)}}function pv(p){return er(function(m,S){var A=-1,B=S.length,X=B>1?S[B-1]:r,oe=B>2?S[2]:r;for(X=p.length>3&&typeof X=="function"?(B--,X):r,oe&&Hi(S[0],S[1],oe)&&(X=B<3?r:X,B=1),m=Wr(m);++A<B;){var de=S[A];de&&p(m,de,A,X)}return m})}function P8(p,m){return function(S,A){if(S==null)return S;if(!ha(S))return p(S,A);for(var B=S.length,X=m?B:-1,oe=Wr(S);(m?X--:++X<B)&&A(oe[X],X,oe)!==!1;);return S}}function I8(p){return function(m,S,A){for(var B=-1,X=Wr(m),oe=A(m),de=oe.length;de--;){var Re=oe[p?de:++B];if(S(X[Re],Re,X)===!1)break}return m}}function j0e(p,m,S){var A=m&g,B=Jm(p);function X(){var oe=this&&this!==fi&&this instanceof X?B:p;return oe.apply(A?S:this,arguments)}return X}function M8(p){return function(m){m=Or(m);var S=lv(m)?Xo(m):r,A=S?S[0]:m.charAt(0),B=S?rf(S,1).join(""):m.slice(1);return A[p]()+B}}function gv(p){return function(m){return ZA(P5(A5(m).replace(Pye,"")),p,"")}}function Jm(p){return function(){var m=arguments;switch(m.length){case 0:return new p;case 1:return new p(m[0]);case 2:return new p(m[0],m[1]);case 3:return new p(m[0],m[1],m[2]);case 4:return new p(m[0],m[1],m[2],m[3]);case 5:return new p(m[0],m[1],m[2],m[3],m[4]);case 6:return new p(m[0],m[1],m[2],m[3],m[4],m[5]);case 7:return new p(m[0],m[1],m[2],m[3],m[4],m[5],m[6])}var S=dv(p.prototype),A=p.apply(S,m);return hn(A)?A:S}}function U0e(p,m,S){var A=Jm(p);function B(){for(var X=arguments.length,oe=Me(X),de=X,Re=yv(B);de--;)oe[de]=arguments[de];var Be=X<3&&oe[0]!==Re&&oe[X-1]!==Re?[]:Zu(oe,Re);if(X-=Be.length,X<S)return F8(p,m,gC,B.placeholder,r,oe,Be,r,r,S-X);var Fe=this&&this!==fi&&this instanceof B?A:p;return Ia(Fe,this,oe)}return B}function D8(p){return function(m,S,A){var B=Wr(m);if(!ha(m)){var X=Ct(S,3);m=ri(m),S=function(de){return X(B[de],de,B)}}var oe=p(m,S,A);return oe>-1?B[X?m[oe]:oe]:r}}function $8(p){return El(function(m){var S=m.length,A=S,B=so.prototype.thru;for(p&&m.reverse();A--;){var X=m[A];if(typeof X!="function")throw new oo(o);if(B&&!oe&&wC(X)=="wrapper")var oe=new so([],!0)}for(A=oe?A:S;++A<S;){X=m[A];var de=wC(X),Re=de=="wrapper"?PP(X):r;Re&&$P(Re[0])&&Re[1]==(O|w|x|E)&&!Re[4].length&&Re[9]==1?oe=oe[wC(Re[0])].apply(oe,Re[3]):oe=X.length==1&&$P(X)?oe[de]():oe.thru(X)}return function(){var Be=arguments,Fe=Be[0];if(oe&&Be.length==1&&Wt(Fe))return oe.plant(Fe).value();for(var We=0,ot=S?m[We].apply(this,Be):Fe;++We<S;)ot=m[We].call(this,ot);return ot}})}function gC(p,m,S,A,B,X,oe,de,Re,Be){var Fe=m&O,We=m&g,ot=m&y,gt=m&(w|_),kt=m&M,sr=ot?r:Jm(p);function xt(){for(var lr=arguments.length,Er=Me(lr),Bi=lr;Bi--;)Er[Bi]=arguments[Bi];if(gt)var Vi=yv(xt),af=eme(Er,Vi);if(A&&(Er=k8(Er,A,B,gt)),X&&(Er=A8(Er,X,oe,gt)),lr-=af,gt&&lr<Be){var Rn=Zu(Er,Vi);return F8(p,m,gC,xt.placeholder,S,Er,Rn,de,Re,Be-lr)}var Jo=We?S:this,Pl=ot?Jo[p]:p;return lr=Er.length,de?Er=fbe(Er,de):kt&&lr>1&&Er.reverse(),Fe&&Re<lr&&(Er.length=Re),this&&this!==fi&&this instanceof xt&&(Pl=sr||Jm(Pl)),Pl.apply(Jo,Er)}return xt}function N8(p,m){return function(S,A){return y0e(S,p,m(A),{})}}function yC(p,m){return function(S,A){var B;if(S===r&&A===r)return m;if(S!==r&&(B=S),A!==r){if(B===r)return A;typeof S=="string"||typeof A=="string"?(S=Da(S),A=Da(A)):(S=S8(S),A=S8(A)),B=p(S,A)}return B}}function EP(p){return El(function(m){return m=cn(m,Ma(Ct())),er(function(S){var A=this;return p(m,function(B){return Ia(B,A,S)})})})}function mC(p,m){m=m===r?" ":Da(m);var S=m.length;if(S<2)return S?wP(m,p):m;var A=wP(m,iC(p/uv(m)));return lv(m)?rf(Xo(A),0,p).join(""):A.slice(0,p)}function z0e(p,m,S,A){var B=m&g,X=Jm(p);function oe(){for(var de=-1,Re=arguments.length,Be=-1,Fe=A.length,We=Me(Fe+Re),ot=this&&this!==fi&&this instanceof oe?X:p;++Be<Fe;)We[Be]=A[Be];for(;Re--;)We[Be++]=arguments[++de];return Ia(ot,B?S:this,We)}return oe}function L8(p){return function(m,S,A){return A&&typeof A!="number"&&Hi(m,S,A)&&(S=A=r),m=Al(m),S===r?(S=m,m=0):S=Al(S),A=A===r?m<S?1:-1:Al(A),k0e(m,S,A,p)}}function bC(p){return function(m,S){return typeof m=="string"&&typeof S=="string"||(m=co(m),S=co(S)),p(m,S)}}function F8(p,m,S,A,B,X,oe,de,Re,Be){var Fe=m&w,We=Fe?oe:r,ot=Fe?r:oe,gt=Fe?X:r,kt=Fe?r:X;m|=Fe?x:T,m&=~(Fe?T:x),m&b||(m&=~(g|y));var sr=[p,m,B,gt,We,kt,ot,de,Re,Be],xt=S.apply(r,sr);return $P(p)&&q8(xt,sr),xt.placeholder=A,Z8(xt,p,m)}function RP(p){var m=Yn[p];return function(S,A){if(S=co(S),A=A==null?0:yi(Kt(A),292),A){var B=(Or(S)+"e").split("e"),X=m(B[0]+"e"+(+B[1]+A));return B=(Or(X)+"e").split("e"),+(B[0]+"e"+(+B[1]-A))}return m(S)}}var G0e=hv&&1/K1(new hv([,-0]))[1]==le?function(p){return new hv(p)}:qP;function H8(p){return function(m){var S=mi(m);return S==Le?iP(m):S==G?sme(m):Qye(m,p(m))}}function Ol(p,m,S,A,B,X,oe,de){var Re=m&y;if(!Re&&typeof p!="function")throw new oo(o);var Be=A?A.length:0;if(Be||(m&=~(x|T),A=B=r),oe=oe===r?oe:Kn(Kt(oe),0),de=de===r?de:Kt(de),Be-=B?B.length:0,m&T){var Fe=A,We=B;A=B=r}var ot=Re?r:PP(p),gt=[p,m,S,A,B,Fe,We,X,oe,de];if(ot&&sbe(gt,ot),p=gt[0],m=gt[1],S=gt[2],A=gt[3],B=gt[4],de=gt[9]=gt[9]===r?Re?0:p.length:Kn(gt[9]-Be,0),!de&&m&(w|_)&&(m&=~(w|_)),!m||m==g)var kt=j0e(p,m,S);else m==w||m==_?kt=U0e(p,m,de):(m==x||m==(g|x))&&!B.length?kt=z0e(p,m,S,A):kt=gC.apply(r,gt);var sr=ot?w8:q8;return Z8(sr(kt,gt),p,m)}function B8(p,m,S,A){return p===r||Zo(p,cv[S])&&!Yr.call(A,S)?m:p}function V8(p,m,S,A,B,X){return hn(p)&&hn(m)&&(X.set(m,p),hC(p,m,r,V8,X),X.delete(m)),p}function Y0e(p){return t0(p)?r:p}function W8(p,m,S,A,B,X){var oe=S&d,de=p.length,Re=m.length;if(de!=Re&&!(oe&&Re>de))return!1;var Be=X.get(p);if(Be&&X.get(m))return Be==m;var Fe=-1,We=!0,ot=S&v?new Ic:r;for(X.set(p,m),X.set(m,p);++Fe<de;){var gt=p[Fe],kt=m[Fe];if(A)var sr=oe?A(kt,gt,Fe,m,p,X):A(gt,kt,Fe,p,m,X);if(sr!==r){if(sr)continue;We=!1;break}if(ot){if(!JA(m,function(xt,lr){if(!Bm(ot,lr)&&(gt===xt||B(gt,xt,S,A,X)))return ot.push(lr)})){We=!1;break}}else if(!(gt===kt||B(gt,kt,S,A,X))){We=!1;break}}return X.delete(p),X.delete(m),We}function K0e(p,m,S,A,B,X,oe){switch(S){case ge:if(p.byteLength!=m.byteLength||p.byteOffset!=m.byteOffset)return!1;p=p.buffer,m=m.buffer;case ve:return!(p.byteLength!=m.byteLength||!X(new eC(p),new eC(m)));case se:case we:case ye:return Zo(+p,+m);case me:return p.name==m.name&&p.message==m.message;case Qe:case Z:return p==m+"";case Le:var de=iP;case G:var Re=A&d;if(de||(de=K1),p.size!=m.size&&!Re)return!1;var Be=oe.get(p);if(Be)return Be==m;A|=v,oe.set(p,m);var Fe=W8(de(p),de(m),A,B,X,oe);return oe.delete(p),Fe;case ae:if(Gm)return Gm.call(p)==Gm.call(m)}return!1}function X0e(p,m,S,A,B,X){var oe=S&d,de=kP(p),Re=de.length,Be=kP(m),Fe=Be.length;if(Re!=Fe&&!oe)return!1;for(var We=Re;We--;){var ot=de[We];if(!(oe?ot in m:Yr.call(m,ot)))return!1}var gt=X.get(p);if(gt&&X.get(m))return gt==m;var kt=!0;X.set(p,m),X.set(m,p);for(var sr=oe;++We<Re;){ot=de[We];var xt=p[ot],lr=m[ot];if(A)var Er=oe?A(lr,xt,ot,m,p,X):A(xt,lr,ot,p,m,X);if(!(Er===r?xt===lr||B(xt,lr,S,A,X):Er)){kt=!1;break}sr||(sr=ot=="constructor")}if(kt&&!sr){var Bi=p.constructor,Vi=m.constructor;Bi!=Vi&&"constructor"in p&&"constructor"in m&&!(typeof Bi=="function"&&Bi instanceof Bi&&typeof Vi=="function"&&Vi instanceof Vi)&&(kt=!1)}return X.delete(p),X.delete(m),kt}function El(p){return LP(K8(p,r,n5),p+"")}function kP(p){return u8(p,ri,MP)}function AP(p){return u8(p,da,j8)}var PP=oC?function(p){return oC.get(p)}:qP;function wC(p){for(var m=p.name+"",S=zm[m],A=Yr.call(zm,m)?S.length:0;A--;){var B=S[A],X=B.func;if(X==null||X==p)return B.name}return m}function yv(p){var m=Yr.call(Y,"placeholder")?Y:p;return m.placeholder}function Ct(){var p=Y.iteratee||KP;return p=p===KP?h8:p,arguments.length?p(arguments[0],arguments[1]):p}function _C(p,m){var S=p.__data__;return nbe(m)?S[typeof m=="string"?"string":"hash"]:S.map}function IP(p){for(var m=ri(p),S=m.length;S--;){var A=m[S],B=p[A];m[S]=[A,B,G8(B)]}return m}function Dc(p,m){var S=ime(p,m);return c8(S)?S:r}function q0e(p){var m=Yr.call(p,Ac),S=p[Ac];try{p[Ac]=r;var A=!0}catch{}var B=J1.call(p);return A&&(m?p[Ac]=S:delete p[Ac]),B}var MP=oP?function(p){return p==null?[]:(p=Wr(p),Xu(oP(p),function(m){return ZU.call(p,m)}))}:ZP,j8=oP?function(p){for(var m=[];p;)qu(m,MP(p)),p=tC(p);return m}:ZP,mi=Fi;(sP&&mi(new sP(new ArrayBuffer(1)))!=ge||Wm&&mi(new Wm)!=Le||lP&&mi(lP.resolve())!=De||hv&&mi(new hv)!=G||jm&&mi(new jm)!=fe)&&(mi=function(p){var m=Fi(p),S=m==Ge?p.constructor:r,A=S?$c(S):"";if(A)switch(A){case Pme:return ge;case Ime:return Le;case Mme:return De;case Dme:return G;case $me:return fe}return m});function Z0e(p,m,S){for(var A=-1,B=S.length;++A<B;){var X=S[A],oe=X.size;switch(X.type){case"drop":p+=oe;break;case"dropRight":m-=oe;break;case"take":m=yi(m,p+oe);break;case"takeRight":p=Kn(p,m-oe);break}}return{start:p,end:m}}function J0e(p){var m=p.match(j);return m?m[1].split(te):[]}function U8(p,m,S){m=tf(m,p);for(var A=-1,B=m.length,X=!1;++A<B;){var oe=Ds(m[A]);if(!(X=p!=null&&S(p,oe)))break;p=p[oe]}return X||++A!=B?X:(B=p==null?0:p.length,!!B&&RC(B)&&Rl(oe,B)&&(Wt(p)||Nc(p)))}function Q0e(p){var m=p.length,S=new p.constructor(m);return m&&typeof p[0]=="string"&&Yr.call(p,"index")&&(S.index=p.index,S.input=p.input),S}function z8(p){return typeof p.constructor=="function"&&!Qm(p)?dv(tC(p)):{}}function ebe(p,m,S){var A=p.constructor;switch(m){case ve:return OP(p);case se:case we:return new A(+p);case ge:return L0e(p,S);case Oe:case Ce:case be:case He:case qe:case Je:case mt:case It:case ur:return E8(p,S);case Le:return new A;case ye:case Z:return new A(p);case Qe:return F0e(p);case G:return new A;case ae:return H0e(p)}}function tbe(p,m){var S=m.length;if(!S)return p;var A=S-1;return m[A]=(S>1?"& ":"")+m[A],m=m.join(S>2?", ":" "),p.replace(av,`{
/* [wrapped with `+m+`] */
`)}function rbe(p){return Wt(p)||Nc(p)||!!(JU&&p&&p[JU])}function Rl(p,m){var S=typeof p;return m=m??_e,!!m&&(S=="number"||S!="symbol"&&K.test(p))&&p>-1&&p%1==0&&p<m}function Hi(p,m,S){if(!hn(S))return!1;var A=typeof m;return(A=="number"?ha(S)&&Rl(m,S.length):A=="string"&&m in S)?Zo(S[m],p):!1}function DP(p,m){if(Wt(p))return!1;var S=typeof p;return S=="number"||S=="symbol"||S=="boolean"||p==null||$a(p)?!0:Yo.test(p)||!or.test(p)||m!=null&&p in Wr(m)}function nbe(p){var m=typeof p;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?p!=="__proto__":p===null}function $P(p){var m=wC(p),S=Y[m];if(typeof S!="function"||!(m in cr.prototype))return!1;if(p===S)return!0;var A=PP(S);return!!A&&p===A[0]}function ibe(p){return!!KU&&KU in p}var abe=q1?kl:JP;function Qm(p){var m=p&&p.constructor,S=typeof m=="function"&&m.prototype||cv;return p===S}function G8(p){return p===p&&!hn(p)}function Y8(p,m){return function(S){return S==null?!1:S[p]===m&&(m!==r||p in Wr(S))}}function obe(p){var m=OC(p,function(A){return S.size===l&&S.clear(),A}),S=m.cache;return m}function sbe(p,m){var S=p[1],A=m[1],B=S|A,X=B<(g|y|O),oe=A==O&&S==w||A==O&&S==E&&p[7].length<=m[8]||A==(O|E)&&m[7].length<=m[8]&&S==w;if(!(X||oe))return p;A&g&&(p[2]=m[2],B|=S&g?0:b);var de=m[3];if(de){var Re=p[3];p[3]=Re?k8(Re,de,m[4]):de,p[4]=Re?Zu(p[3],u):m[4]}return de=m[5],de&&(Re=p[5],p[5]=Re?A8(Re,de,m[6]):de,p[6]=Re?Zu(p[5],u):m[6]),de=m[7],de&&(p[7]=de),A&O&&(p[8]=p[8]==null?m[8]:yi(p[8],m[8])),p[9]==null&&(p[9]=m[9]),p[0]=m[0],p[1]=B,p}function lbe(p){var m=[];if(p!=null)for(var S in Wr(p))m.push(S);return m}function ube(p){return J1.call(p)}function K8(p,m,S){return m=Kn(m===r?p.length-1:m,0),function(){for(var A=arguments,B=-1,X=Kn(A.length-m,0),oe=Me(X);++B<X;)oe[B]=A[m+B];B=-1;for(var de=Me(m+1);++B<m;)de[B]=A[B];return de[m]=S(oe),Ia(p,this,de)}}function X8(p,m){return m.length<2?p:vv(p,uo(m,0,-1))}function fbe(p,m){for(var S=p.length,A=yi(m.length,S),B=ca(p);A--;){var X=m[A];p[A]=Rl(X,S)?B[X]:r}return p}function NP(p,m){if(m!="__proto__")return p[m]}var q8=J8(w8),e0=Cme||function(p,m){return fi.setTimeout(p,m)},LP=J8(I0e);function Z8(p,m,S){var A=m+"";return LP(p,tbe(A,cbe(J0e(A),S)))}function J8(p){var m=0,S=0;return function(){var A=Rme(),B=L-(A-S);if(S=A,B>0){if(++m>=D)return arguments[0]}else m=0;return p.apply(r,arguments)}}function SC(p,m){var S=-1,A=p.length,B=A-1;for(m=m===r?A:m;++S<m;){var X=bP(S,B),oe=p[X];p[X]=p[S],p[S]=oe}return p.length=m,p}var Q8=obe(function(p){var m=[];return p.charCodeAt(0)===46&&m.push(""),p.replace(to,function(S,A,B,X){m.push(B?X.replace(J,"$1"):A||S)}),m});function Ds(p){if(typeof p=="string"||$a(p))return p;var m=p+"";return m=="0"&&1/p==-le?"-0":m}function $c(p){if(p!=null){try{return Z1.call(p)}catch{}try{return p+""}catch{}}return""}function cbe(p,m){return ao(F,function(S){var A="_."+S[0];m&S[1]&&!G1(p,A)&&p.push(A)}),p.sort()}function e5(p){if(p instanceof cr)return p.clone();var m=new so(p.__wrapped__,p.__chain__);return m.__actions__=ca(p.__actions__),m.__index__=p.__index__,m.__values__=p.__values__,m}function hbe(p,m,S){(S?Hi(p,m,S):m===r)?m=1:m=Kn(Kt(m),0);var A=p==null?0:p.length;if(!A||m<1)return[];for(var B=0,X=0,oe=Me(iC(A/m));B<A;)oe[X++]=uo(p,B,B+=m);return oe}function dbe(p){for(var m=-1,S=p==null?0:p.length,A=0,B=[];++m<S;){var X=p[m];X&&(B[A++]=X)}return B}function vbe(){var p=arguments.length;if(!p)return[];for(var m=Me(p-1),S=arguments[0],A=p;A--;)m[A-1]=arguments[A];return qu(Wt(S)?ca(S):[S],ci(m,1))}var pbe=er(function(p,m){return En(p)?Km(p,ci(m,1,En,!0)):[]}),gbe=er(function(p,m){var S=fo(m);return En(S)&&(S=r),En(p)?Km(p,ci(m,1,En,!0),Ct(S,2)):[]}),ybe=er(function(p,m){var S=fo(m);return En(S)&&(S=r),En(p)?Km(p,ci(m,1,En,!0),r,S):[]});function mbe(p,m,S){var A=p==null?0:p.length;return A?(m=S||m===r?1:Kt(m),uo(p,m<0?0:m,A)):[]}function bbe(p,m,S){var A=p==null?0:p.length;return A?(m=S||m===r?1:Kt(m),m=A-m,uo(p,0,m<0?0:m)):[]}function wbe(p,m){return p&&p.length?vC(p,Ct(m,3),!0,!0):[]}function _be(p,m){return p&&p.length?vC(p,Ct(m,3),!0):[]}function Sbe(p,m,S,A){var B=p==null?0:p.length;return B?(S&&typeof S!="number"&&Hi(p,m,S)&&(S=0,A=B),d0e(p,m,S,A)):[]}function t5(p,m,S){var A=p==null?0:p.length;if(!A)return-1;var B=S==null?0:Kt(S);return B<0&&(B=Kn(A+B,0)),Y1(p,Ct(m,3),B)}function r5(p,m,S){var A=p==null?0:p.length;if(!A)return-1;var B=A-1;return S!==r&&(B=Kt(S),B=S<0?Kn(A+B,0):yi(B,A-1)),Y1(p,Ct(m,3),B,!0)}function n5(p){var m=p==null?0:p.length;return m?ci(p,1):[]}function Cbe(p){var m=p==null?0:p.length;return m?ci(p,le):[]}function xbe(p,m){var S=p==null?0:p.length;return S?(m=m===r?1:Kt(m),ci(p,m)):[]}function Tbe(p){for(var m=-1,S=p==null?0:p.length,A={};++m<S;){var B=p[m];A[B[0]]=B[1]}return A}function i5(p){return p&&p.length?p[0]:r}function Obe(p,m,S){var A=p==null?0:p.length;if(!A)return-1;var B=S==null?0:Kt(S);return B<0&&(B=Kn(A+B,0)),sv(p,m,B)}function Ebe(p){var m=p==null?0:p.length;return m?uo(p,0,-1):[]}var Rbe=er(function(p){var m=cn(p,xP);return m.length&&m[0]===p[0]?vP(m):[]}),kbe=er(function(p){var m=fo(p),S=cn(p,xP);return m===fo(S)?m=r:S.pop(),S.length&&S[0]===p[0]?vP(S,Ct(m,2)):[]}),Abe=er(function(p){var m=fo(p),S=cn(p,xP);return m=typeof m=="function"?m:r,m&&S.pop(),S.length&&S[0]===p[0]?vP(S,r,m):[]});function Pbe(p,m){return p==null?"":Ome.call(p,m)}function fo(p){var m=p==null?0:p.length;return m?p[m-1]:r}function Ibe(p,m,S){var A=p==null?0:p.length;if(!A)return-1;var B=A;return S!==r&&(B=Kt(S),B=B<0?Kn(A+B,0):yi(B,A-1)),m===m?ume(p,m,B):Y1(p,WU,B,!0)}function Mbe(p,m){return p&&p.length?g8(p,Kt(m)):r}var Dbe=er(a5);function a5(p,m){return p&&p.length&&m&&m.length?mP(p,m):p}function $be(p,m,S){return p&&p.length&&m&&m.length?mP(p,m,Ct(S,2)):p}function Nbe(p,m,S){return p&&p.length&&m&&m.length?mP(p,m,r,S):p}var Lbe=El(function(p,m){var S=p==null?0:p.length,A=fP(p,m);return b8(p,cn(m,function(B){return Rl(B,S)?+B:B}).sort(R8)),A});function Fbe(p,m){var S=[];if(!(p&&p.length))return S;var A=-1,B=[],X=p.length;for(m=Ct(m,3);++A<X;){var oe=p[A];m(oe,A,p)&&(S.push(oe),B.push(A))}return b8(p,B),S}function FP(p){return p==null?p:Ame.call(p)}function Hbe(p,m,S){var A=p==null?0:p.length;return A?(S&&typeof S!="number"&&Hi(p,m,S)?(m=0,S=A):(m=m==null?0:Kt(m),S=S===r?A:Kt(S)),uo(p,m,S)):[]}function Bbe(p,m){return dC(p,m)}function Vbe(p,m,S){return _P(p,m,Ct(S,2))}function Wbe(p,m){var S=p==null?0:p.length;if(S){var A=dC(p,m);if(A<S&&Zo(p[A],m))return A}return-1}function jbe(p,m){return dC(p,m,!0)}function Ube(p,m,S){return _P(p,m,Ct(S,2),!0)}function zbe(p,m){var S=p==null?0:p.length;if(S){var A=dC(p,m,!0)-1;if(Zo(p[A],m))return A}return-1}function Gbe(p){return p&&p.length?_8(p):[]}function Ybe(p,m){return p&&p.length?_8(p,Ct(m,2)):[]}function Kbe(p){var m=p==null?0:p.length;return m?uo(p,1,m):[]}function Xbe(p,m,S){return p&&p.length?(m=S||m===r?1:Kt(m),uo(p,0,m<0?0:m)):[]}function qbe(p,m,S){var A=p==null?0:p.length;return A?(m=S||m===r?1:Kt(m),m=A-m,uo(p,m<0?0:m,A)):[]}function Zbe(p,m){return p&&p.length?vC(p,Ct(m,3),!1,!0):[]}function Jbe(p,m){return p&&p.length?vC(p,Ct(m,3)):[]}var Qbe=er(function(p){return ef(ci(p,1,En,!0))}),ewe=er(function(p){var m=fo(p);return En(m)&&(m=r),ef(ci(p,1,En,!0),Ct(m,2))}),twe=er(function(p){var m=fo(p);return m=typeof m=="function"?m:r,ef(ci(p,1,En,!0),r,m)});function rwe(p){return p&&p.length?ef(p):[]}function nwe(p,m){return p&&p.length?ef(p,Ct(m,2)):[]}function iwe(p,m){return m=typeof m=="function"?m:r,p&&p.length?ef(p,r,m):[]}function HP(p){if(!(p&&p.length))return[];var m=0;return p=Xu(p,function(S){if(En(S))return m=Kn(S.length,m),!0}),rP(m,function(S){return cn(p,QA(S))})}function o5(p,m){if(!(p&&p.length))return[];var S=HP(p);return m==null?S:cn(S,function(A){return Ia(m,r,A)})}var awe=er(function(p,m){return En(p)?Km(p,m):[]}),owe=er(function(p){return CP(Xu(p,En))}),swe=er(function(p){var m=fo(p);return En(m)&&(m=r),CP(Xu(p,En),Ct(m,2))}),lwe=er(function(p){var m=fo(p);return m=typeof m=="function"?m:r,CP(Xu(p,En),r,m)}),uwe=er(HP);function fwe(p,m){return T8(p||[],m||[],Ym)}function cwe(p,m){return T8(p||[],m||[],Zm)}var hwe=er(function(p){var m=p.length,S=m>1?p[m-1]:r;return S=typeof S=="function"?(p.pop(),S):r,o5(p,S)});function s5(p){var m=Y(p);return m.__chain__=!0,m}function dwe(p,m){return m(p),p}function CC(p,m){return m(p)}var vwe=El(function(p){var m=p.length,S=m?p[0]:0,A=this.__wrapped__,B=function(X){return fP(X,p)};return m>1||this.__actions__.length||!(A instanceof cr)||!Rl(S)?this.thru(B):(A=A.slice(S,+S+(m?1:0)),A.__actions__.push({func:CC,args:[B],thisArg:r}),new so(A,this.__chain__).thru(function(X){return m&&!X.length&&X.push(r),X}))});function pwe(){return s5(this)}function gwe(){return new so(this.value(),this.__chain__)}function ywe(){this.__values__===r&&(this.__values__=_5(this.value()));var p=this.__index__>=this.__values__.length,m=p?r:this.__values__[this.__index__++];return{done:p,value:m}}function mwe(){return this}function bwe(p){for(var m,S=this;S instanceof lC;){var A=e5(S);A.__index__=0,A.__values__=r,m?B.__wrapped__=A:m=A;var B=A;S=S.__wrapped__}return B.__wrapped__=p,m}function wwe(){var p=this.__wrapped__;if(p instanceof cr){var m=p;return this.__actions__.length&&(m=new cr(this)),m=m.reverse(),m.__actions__.push({func:CC,args:[FP],thisArg:r}),new so(m,this.__chain__)}return this.thru(FP)}function _we(){return x8(this.__wrapped__,this.__actions__)}var Swe=pC(function(p,m,S){Yr.call(p,S)?++p[S]:Tl(p,S,1)});function Cwe(p,m,S){var A=Wt(p)?BU:h0e;return S&&Hi(p,m,S)&&(m=r),A(p,Ct(m,3))}function xwe(p,m){var S=Wt(p)?Xu:s8;return S(p,Ct(m,3))}var Twe=D8(t5),Owe=D8(r5);function Ewe(p,m){return ci(xC(p,m),1)}function Rwe(p,m){return ci(xC(p,m),le)}function kwe(p,m,S){return S=S===r?1:Kt(S),ci(xC(p,m),S)}function l5(p,m){var S=Wt(p)?ao:Qu;return S(p,Ct(m,3))}function u5(p,m){var S=Wt(p)?Gye:o8;return S(p,Ct(m,3))}var Awe=pC(function(p,m,S){Yr.call(p,S)?p[S].push(m):Tl(p,S,[m])});function Pwe(p,m,S,A){p=ha(p)?p:bv(p),S=S&&!A?Kt(S):0;var B=p.length;return S<0&&(S=Kn(B+S,0)),kC(p)?S<=B&&p.indexOf(m,S)>-1:!!B&&sv(p,m,S)>-1}var Iwe=er(function(p,m,S){var A=-1,B=typeof m=="function",X=ha(p)?Me(p.length):[];return Qu(p,function(oe){X[++A]=B?Ia(m,oe,S):Xm(oe,m,S)}),X}),Mwe=pC(function(p,m,S){Tl(p,S,m)});function xC(p,m){var S=Wt(p)?cn:d8;return S(p,Ct(m,3))}function Dwe(p,m,S,A){return p==null?[]:(Wt(m)||(m=m==null?[]:[m]),S=A?r:S,Wt(S)||(S=S==null?[]:[S]),y8(p,m,S))}var $we=pC(function(p,m,S){p[S?0:1].push(m)},function(){return[[],[]]});function Nwe(p,m,S){var A=Wt(p)?ZA:UU,B=arguments.length<3;return A(p,Ct(m,4),S,B,Qu)}function Lwe(p,m,S){var A=Wt(p)?Yye:UU,B=arguments.length<3;return A(p,Ct(m,4),S,B,o8)}function Fwe(p,m){var S=Wt(p)?Xu:s8;return S(p,EC(Ct(m,3)))}function Hwe(p){var m=Wt(p)?r8:A0e;return m(p)}function Bwe(p,m,S){(S?Hi(p,m,S):m===r)?m=1:m=Kt(m);var A=Wt(p)?s0e:P0e;return A(p,m)}function Vwe(p){var m=Wt(p)?l0e:M0e;return m(p)}function Wwe(p){if(p==null)return 0;if(ha(p))return kC(p)?uv(p):p.length;var m=mi(p);return m==Le||m==G?p.size:gP(p).length}function jwe(p,m,S){var A=Wt(p)?JA:D0e;return S&&Hi(p,m,S)&&(m=r),A(p,Ct(m,3))}var Uwe=er(function(p,m){if(p==null)return[];var S=m.length;return S>1&&Hi(p,m[0],m[1])?m=[]:S>2&&Hi(m[0],m[1],m[2])&&(m=[m[0]]),y8(p,ci(m,1),[])}),TC=Sme||function(){return fi.Date.now()};function zwe(p,m){if(typeof m!="function")throw new oo(o);return p=Kt(p),function(){if(--p<1)return m.apply(this,arguments)}}function f5(p,m,S){return m=S?r:m,m=p&&m==null?p.length:m,Ol(p,O,r,r,r,r,m)}function c5(p,m){var S;if(typeof m!="function")throw new oo(o);return p=Kt(p),function(){return--p>0&&(S=m.apply(this,arguments)),p<=1&&(m=r),S}}var BP=er(function(p,m,S){var A=g;if(S.length){var B=Zu(S,yv(BP));A|=x}return Ol(p,A,m,S,B)}),h5=er(function(p,m,S){var A=g|y;if(S.length){var B=Zu(S,yv(h5));A|=x}return Ol(m,A,p,S,B)});function d5(p,m,S){m=S?r:m;var A=Ol(p,w,r,r,r,r,r,m);return A.placeholder=d5.placeholder,A}function v5(p,m,S){m=S?r:m;var A=Ol(p,_,r,r,r,r,r,m);return A.placeholder=v5.placeholder,A}function p5(p,m,S){var A,B,X,oe,de,Re,Be=0,Fe=!1,We=!1,ot=!0;if(typeof p!="function")throw new oo(o);m=co(m)||0,hn(S)&&(Fe=!!S.leading,We="maxWait"in S,X=We?Kn(co(S.maxWait)||0,m):X,ot="trailing"in S?!!S.trailing:ot);function gt(Rn){var Jo=A,Pl=B;return A=B=r,Be=Rn,oe=p.apply(Pl,Jo),oe}function kt(Rn){return Be=Rn,de=e0(lr,m),Fe?gt(Rn):oe}function sr(Rn){var Jo=Rn-Re,Pl=Rn-Be,D5=m-Jo;return We?yi(D5,X-Pl):D5}function xt(Rn){var Jo=Rn-Re,Pl=Rn-Be;return Re===r||Jo>=m||Jo<0||We&&Pl>=X}function lr(){var Rn=TC();if(xt(Rn))return Er(Rn);de=e0(lr,sr(Rn))}function Er(Rn){return de=r,ot&&A?gt(Rn):(A=B=r,oe)}function Bi(){de!==r&&N0e(de),Be=0,A=Re=B=de=r}function Vi(){return de===r?oe:Er(TC())}function af(){var Rn=TC(),Jo=xt(Rn);if(A=arguments,B=this,Re=Rn,Jo){if(de===r)return kt(Re);if(We)return de=e0(lr,m),gt(Re)}return de===r&&(de=e0(lr,m)),oe}return af.cancel=Bi,af.flush=Vi,af}var Gwe=er(function(p,m){return a8(p,1,m)}),Ywe=er(function(p,m,S){return a8(p,co(m)||0,S)});function Kwe(p){return Ol(p,M)}function OC(p,m){if(typeof p!="function"||m!=null&&typeof m!="function")throw new oo(o);var S=function(){var A=arguments,B=m?m.apply(this,A):A[0],X=S.cache;if(X.has(B))return X.get(B);var oe=p.apply(this,A);return S.cache=X.set(B,oe)||X,oe};return S.cache=new(OC.Cache||xl),S}OC.Cache=xl;function EC(p){if(typeof p!="function")throw new oo(o);return function(){var m=arguments;switch(m.length){case 0:return!p.call(this);case 1:return!p.call(this,m[0]);case 2:return!p.call(this,m[0],m[1]);case 3:return!p.call(this,m[0],m[1],m[2])}return!p.apply(this,m)}}function Xwe(p){return c5(2,p)}var qwe=$0e(function(p,m){m=m.length==1&&Wt(m[0])?cn(m[0],Ma(Ct())):cn(ci(m,1),Ma(Ct()));var S=m.length;return er(function(A){for(var B=-1,X=yi(A.length,S);++B<X;)A[B]=m[B].call(this,A[B]);return Ia(p,this,A)})}),VP=er(function(p,m){var S=Zu(m,yv(VP));return Ol(p,x,r,m,S)}),g5=er(function(p,m){var S=Zu(m,yv(g5));return Ol(p,T,r,m,S)}),Zwe=El(function(p,m){return Ol(p,E,r,r,r,m)});function Jwe(p,m){if(typeof p!="function")throw new oo(o);return m=m===r?m:Kt(m),er(p,m)}function Qwe(p,m){if(typeof p!="function")throw new oo(o);return m=m==null?0:Kn(Kt(m),0),er(function(S){var A=S[m],B=rf(S,0,m);return A&&qu(B,A),Ia(p,this,B)})}function e_e(p,m,S){var A=!0,B=!0;if(typeof p!="function")throw new oo(o);return hn(S)&&(A="leading"in S?!!S.leading:A,B="trailing"in S?!!S.trailing:B),p5(p,m,{leading:A,maxWait:m,trailing:B})}function t_e(p){return f5(p,1)}function r_e(p,m){return VP(TP(m),p)}function n_e(){if(!arguments.length)return[];var p=arguments[0];return Wt(p)?p:[p]}function i_e(p){return lo(p,h)}function a_e(p,m){return m=typeof m=="function"?m:r,lo(p,h,m)}function o_e(p){return lo(p,f|h)}function s_e(p,m){return m=typeof m=="function"?m:r,lo(p,f|h,m)}function l_e(p,m){return m==null||i8(p,m,ri(m))}function Zo(p,m){return p===m||p!==p&&m!==m}var u_e=bC(dP),f_e=bC(function(p,m){return p>=m}),Nc=f8(function(){return arguments}())?f8:function(p){return wn(p)&&Yr.call(p,"callee")&&!ZU.call(p,"callee")},Wt=Me.isArray,c_e=DU?Ma(DU):m0e;function ha(p){return p!=null&&RC(p.length)&&!kl(p)}function En(p){return wn(p)&&ha(p)}function h_e(p){return p===!0||p===!1||wn(p)&&Fi(p)==se}var nf=xme||JP,d_e=$U?Ma($U):b0e;function v_e(p){return wn(p)&&p.nodeType===1&&!t0(p)}function p_e(p){if(p==null)return!0;if(ha(p)&&(Wt(p)||typeof p=="string"||typeof p.splice=="function"||nf(p)||mv(p)||Nc(p)))return!p.length;var m=mi(p);if(m==Le||m==G)return!p.size;if(Qm(p))return!gP(p).length;for(var S in p)if(Yr.call(p,S))return!1;return!0}function g_e(p,m){return qm(p,m)}function y_e(p,m,S){S=typeof S=="function"?S:r;var A=S?S(p,m):r;return A===r?qm(p,m,r,S):!!A}function WP(p){if(!wn(p))return!1;var m=Fi(p);return m==me||m==pe||typeof p.message=="string"&&typeof p.name=="string"&&!t0(p)}function m_e(p){return typeof p=="number"&&Tme(p)}function kl(p){if(!hn(p))return!1;var m=Fi(p);return m==Ie||m==z||m==Q||m==tt}function y5(p){return typeof p=="number"&&p==Kt(p)}function RC(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=_e}function hn(p){var m=typeof p;return p!=null&&(m=="object"||m=="function")}function wn(p){return p!=null&&typeof p=="object"}var m5=NU?Ma(NU):_0e;function b_e(p,m){return p===m||pP(p,m,IP(m))}function w_e(p,m,S){return S=typeof S=="function"?S:r,pP(p,m,IP(m),S)}function __e(p){return b5(p)&&p!=+p}function S_e(p){if(abe(p))throw new Vt(a);return c8(p)}function C_e(p){return p===null}function x_e(p){return p==null}function b5(p){return typeof p=="number"||wn(p)&&Fi(p)==ye}function t0(p){if(!wn(p)||Fi(p)!=Ge)return!1;var m=tC(p);if(m===null)return!0;var S=Yr.call(m,"constructor")&&m.constructor;return typeof S=="function"&&S instanceof S&&Z1.call(S)==mme}var jP=LU?Ma(LU):S0e;function T_e(p){return y5(p)&&p>=-_e&&p<=_e}var w5=FU?Ma(FU):C0e;function kC(p){return typeof p=="string"||!Wt(p)&&wn(p)&&Fi(p)==Z}function $a(p){return typeof p=="symbol"||wn(p)&&Fi(p)==ae}var mv=HU?Ma(HU):x0e;function O_e(p){return p===r}function E_e(p){return wn(p)&&mi(p)==fe}function R_e(p){return wn(p)&&Fi(p)==Te}var k_e=bC(yP),A_e=bC(function(p,m){return p<=m});function _5(p){if(!p)return[];if(ha(p))return kC(p)?Xo(p):ca(p);if(Vm&&p[Vm])return ome(p[Vm]());var m=mi(p),S=m==Le?iP:m==G?K1:bv;return S(p)}function Al(p){if(!p)return p===0?p:0;if(p=co(p),p===le||p===-le){var m=p<0?-1:1;return m*U}return p===p?p:0}function Kt(p){var m=Al(p),S=m%1;return m===m?S?m-S:m:0}function S5(p){return p?Mc(Kt(p),0,R):0}function co(p){if(typeof p=="number")return p;if($a(p))return C;if(hn(p)){var m=typeof p.valueOf=="function"?p.valueOf():p;p=hn(m)?m+"":m}if(typeof p!="string")return p===0?p:+p;p=p.replace(Yu,"");var S=$e.test(p);return S||he.test(p)?jye(p.slice(2),S?2:8):Ae.test(p)?C:+p}function C5(p){return Ms(p,da(p))}function P_e(p){return p?Mc(Kt(p),-_e,_e):p===0?p:0}function Or(p){return p==null?"":Da(p)}var I_e=pv(function(p,m){if(Qm(m)||ha(m)){Ms(m,ri(m),p);return}for(var S in m)Yr.call(m,S)&&Ym(p,S,m[S])}),x5=pv(function(p,m){Ms(m,da(m),p)}),AC=pv(function(p,m,S,A){Ms(m,da(m),p,A)}),M_e=pv(function(p,m,S,A){Ms(m,ri(m),p,A)}),D_e=El(fP);function $_e(p,m){var S=dv(p);return m==null?S:n8(S,m)}var N_e=er(function(p,m){p=Wr(p);var S=-1,A=m.length,B=A>2?m[2]:r;for(B&&Hi(m[0],m[1],B)&&(A=1);++S<A;)for(var X=m[S],oe=da(X),de=-1,Re=oe.length;++de<Re;){var Be=oe[de],Fe=p[Be];(Fe===r||Zo(Fe,cv[Be])&&!Yr.call(p,Be))&&(p[Be]=X[Be])}return p}),L_e=er(function(p){return p.push(r,V8),Ia(T5,r,p)});function F_e(p,m){return VU(p,Ct(m,3),Is)}function H_e(p,m){return VU(p,Ct(m,3),hP)}function B_e(p,m){return p==null?p:cP(p,Ct(m,3),da)}function V_e(p,m){return p==null?p:l8(p,Ct(m,3),da)}function W_e(p,m){return p&&Is(p,Ct(m,3))}function j_e(p,m){return p&&hP(p,Ct(m,3))}function U_e(p){return p==null?[]:cC(p,ri(p))}function z_e(p){return p==null?[]:cC(p,da(p))}function UP(p,m,S){var A=p==null?r:vv(p,m);return A===r?S:A}function G_e(p,m){return p!=null&&U8(p,m,v0e)}function zP(p,m){return p!=null&&U8(p,m,p0e)}var Y_e=N8(function(p,m,S){m!=null&&typeof m.toString!="function"&&(m=J1.call(m)),p[m]=S},YP(va)),K_e=N8(function(p,m,S){m!=null&&typeof m.toString!="function"&&(m=J1.call(m)),Yr.call(p,m)?p[m].push(S):p[m]=[S]},Ct),X_e=er(Xm);function ri(p){return ha(p)?t8(p):gP(p)}function da(p){return ha(p)?t8(p,!0):T0e(p)}function q_e(p,m){var S={};return m=Ct(m,3),Is(p,function(A,B,X){Tl(S,m(A,B,X),A)}),S}function Z_e(p,m){var S={};return m=Ct(m,3),Is(p,function(A,B,X){Tl(S,B,m(A,B,X))}),S}var J_e=pv(function(p,m,S){hC(p,m,S)}),T5=pv(function(p,m,S,A){hC(p,m,S,A)}),Q_e=El(function(p,m){var S={};if(p==null)return S;var A=!1;m=cn(m,function(X){return X=tf(X,p),A||(A=X.length>1),X}),Ms(p,AP(p),S),A&&(S=lo(S,f|c|h,Y0e));for(var B=m.length;B--;)SP(S,m[B]);return S});function eSe(p,m){return O5(p,EC(Ct(m)))}var tSe=El(function(p,m){return p==null?{}:E0e(p,m)});function O5(p,m){if(p==null)return{};var S=cn(AP(p),function(A){return[A]});return m=Ct(m),m8(p,S,function(A,B){return m(A,B[0])})}function rSe(p,m,S){m=tf(m,p);var A=-1,B=m.length;for(B||(B=1,p=r);++A<B;){var X=p==null?r:p[Ds(m[A])];X===r&&(A=B,X=S),p=kl(X)?X.call(p):X}return p}function nSe(p,m,S){return p==null?p:Zm(p,m,S)}function iSe(p,m,S,A){return A=typeof A=="function"?A:r,p==null?p:Zm(p,m,S,A)}var E5=H8(ri),R5=H8(da);function aSe(p,m,S){var A=Wt(p),B=A||nf(p)||mv(p);if(m=Ct(m,4),S==null){var X=p&&p.constructor;B?S=A?new X:[]:hn(p)?S=kl(X)?dv(tC(p)):{}:S={}}return(B?ao:Is)(p,function(oe,de,Re){return m(S,oe,de,Re)}),S}function oSe(p,m){return p==null?!0:SP(p,m)}function sSe(p,m,S){return p==null?p:C8(p,m,TP(S))}function lSe(p,m,S,A){return A=typeof A=="function"?A:r,p==null?p:C8(p,m,TP(S),A)}function bv(p){return p==null?[]:nP(p,ri(p))}function uSe(p){return p==null?[]:nP(p,da(p))}function fSe(p,m,S){return S===r&&(S=m,m=r),S!==r&&(S=co(S),S=S===S?S:0),m!==r&&(m=co(m),m=m===m?m:0),Mc(co(p),m,S)}function cSe(p,m,S){return m=Al(m),S===r?(S=m,m=0):S=Al(S),p=co(p),g0e(p,m,S)}function hSe(p,m,S){if(S&&typeof S!="boolean"&&Hi(p,m,S)&&(m=S=r),S===r&&(typeof m=="boolean"?(S=m,m=r):typeof p=="boolean"&&(S=p,p=r)),p===r&&m===r?(p=0,m=1):(p=Al(p),m===r?(m=p,p=0):m=Al(m)),p>m){var A=p;p=m,m=A}if(S||p%1||m%1){var B=QU();return yi(p+B*(m-p+Wye("1e-"+((B+"").length-1))),m)}return bP(p,m)}var dSe=gv(function(p,m,S){return m=m.toLowerCase(),p+(S?k5(m):m)});function k5(p){return GP(Or(p).toLowerCase())}function A5(p){return p=Or(p),p&&p.replace(xe,tme).replace(Iye,"")}function vSe(p,m,S){p=Or(p),m=Da(m);var A=p.length;S=S===r?A:Mc(Kt(S),0,A);var B=S;return S-=m.length,S>=0&&p.slice(S,B)==m}function pSe(p){return p=Or(p),p&&Bt.test(p)?p.replace(Qt,rme):p}function gSe(p){return p=Or(p),p&&Oc.test(p)?p.replace(ro,"\\$&"):p}var ySe=gv(function(p,m,S){return p+(S?"-":"")+m.toLowerCase()}),mSe=gv(function(p,m,S){return p+(S?" ":"")+m.toLowerCase()}),bSe=M8("toLowerCase");function wSe(p,m,S){p=Or(p),m=Kt(m);var A=m?uv(p):0;if(!m||A>=m)return p;var B=(m-A)/2;return mC(aC(B),S)+p+mC(iC(B),S)}function _Se(p,m,S){p=Or(p),m=Kt(m);var A=m?uv(p):0;return m&&A<m?p+mC(m-A,S):p}function SSe(p,m,S){p=Or(p),m=Kt(m);var A=m?uv(p):0;return m&&A<m?mC(m-A,S)+p:p}function CSe(p,m,S){return S||m==null?m=0:m&&(m=+m),kme(Or(p).replace(fa,""),m||0)}function xSe(p,m,S){return(S?Hi(p,m,S):m===r)?m=1:m=Kt(m),wP(Or(p),m)}function TSe(){var p=arguments,m=Or(p[0]);return p.length<3?m:m.replace(p[1],p[2])}var OSe=gv(function(p,m,S){return p+(S?"_":"")+m.toLowerCase()});function ESe(p,m,S){return S&&typeof S!="number"&&Hi(p,m,S)&&(m=S=r),S=S===r?R:S>>>0,S?(p=Or(p),p&&(typeof m=="string"||m!=null&&!jP(m))&&(m=Da(m),!m&&lv(p))?rf(Xo(p),0,S):p.split(m,S)):[]}var RSe=gv(function(p,m,S){return p+(S?" ":"")+GP(m)});function kSe(p,m,S){return p=Or(p),S=S==null?0:Mc(Kt(S),0,p.length),m=Da(m),p.slice(S,S+m.length)==m}function ASe(p,m,S){var A=Y.templateSettings;S&&Hi(p,m,S)&&(m=r),p=Or(p),m=AC({},m,A,B8);var B=AC({},m.imports,A.imports,B8),X=ri(B),oe=nP(B,X),de,Re,Be=0,Fe=m.interpolate||Pe,We="__p += '",ot=aP((m.escape||Pe).source+"|"+Fe.source+"|"+(Fe===fr?re:Pe).source+"|"+(m.evaluate||Pe).source+"|$","g"),gt="//# sourceURL="+("sourceURL"in m?m.sourceURL:"lodash.templateSources["+ ++Lye+"]")+`
`;p.replace(ot,function(xt,lr,Er,Bi,Vi,af){return Er||(Er=Bi),We+=p.slice(Be,af).replace(je,nme),lr&&(de=!0,We+=`' +
__e(`+lr+`) +
'`),Vi&&(Re=!0,We+=`';
`+Vi+`;
__p += '`),Er&&(We+=`' +
((__t = (`+Er+`)) == null ? '' : __t) +
'`),Be=af+xt.length,xt}),We+=`';
`;var kt=m.variable;kt||(We=`with (obj) {
`+We+`
}
`),We=(Re?We.replace(Et,""):We).replace(St,"$1").replace(tr,"$1;"),We="function("+(kt||"obj")+`) {
`+(kt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(de?", __e = _.escape":"")+(Re?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+We+`return __p
}`;var sr=I5(function(){return xr(X,gt+"return "+We).apply(r,oe)});if(sr.source=We,WP(sr))throw sr;return sr}function PSe(p){return Or(p).toLowerCase()}function ISe(p){return Or(p).toUpperCase()}function MSe(p,m,S){if(p=Or(p),p&&(S||m===r))return p.replace(Yu,"");if(!p||!(m=Da(m)))return p;var A=Xo(p),B=Xo(m),X=zU(A,B),oe=GU(A,B)+1;return rf(A,X,oe).join("")}function DSe(p,m,S){if(p=Or(p),p&&(S||m===r))return p.replace(Ec,"");if(!p||!(m=Da(m)))return p;var A=Xo(p),B=GU(A,Xo(m))+1;return rf(A,0,B).join("")}function $Se(p,m,S){if(p=Or(p),p&&(S||m===r))return p.replace(fa,"");if(!p||!(m=Da(m)))return p;var A=Xo(p),B=zU(A,Xo(m));return rf(A,B).join("")}function NSe(p,m){var S=P,A=N;if(hn(m)){var B="separator"in m?m.separator:B;S="length"in m?Kt(m.length):S,A="omission"in m?Da(m.omission):A}p=Or(p);var X=p.length;if(lv(p)){var oe=Xo(p);X=oe.length}if(S>=X)return p;var de=S-uv(A);if(de<1)return A;var Re=oe?rf(oe,0,de).join(""):p.slice(0,de);if(B===r)return Re+A;if(oe&&(de+=Re.length-de),jP(B)){if(p.slice(de).search(B)){var Be,Fe=Re;for(B.global||(B=aP(B.source,Or(ne.exec(B))+"g")),B.lastIndex=0;Be=B.exec(Fe);)var We=Be.index;Re=Re.slice(0,We===r?de:We)}}else if(p.indexOf(Da(B),de)!=de){var ot=Re.lastIndexOf(B);ot>-1&&(Re=Re.slice(0,ot))}return Re+A}function LSe(p){return p=Or(p),p&&Ht.test(p)?p.replace(rr,fme):p}var FSe=gv(function(p,m,S){return p+(S?" ":"")+m.toUpperCase()}),GP=M8("toUpperCase");function P5(p,m,S){return p=Or(p),m=S?r:m,m===r?ame(p)?dme(p):qye(p):p.match(m)||[]}var I5=er(function(p,m){try{return Ia(p,r,m)}catch(S){return WP(S)?S:new Vt(S)}}),HSe=El(function(p,m){return ao(m,function(S){S=Ds(S),Tl(p,S,BP(p[S],p))}),p});function BSe(p){var m=p==null?0:p.length,S=Ct();return p=m?cn(p,function(A){if(typeof A[1]!="function")throw new oo(o);return[S(A[0]),A[1]]}):[],er(function(A){for(var B=-1;++B<m;){var X=p[B];if(Ia(X[0],this,A))return Ia(X[1],this,A)}})}function VSe(p){return c0e(lo(p,f))}function YP(p){return function(){return p}}function WSe(p,m){return p==null||p!==p?m:p}var jSe=$8(),USe=$8(!0);function va(p){return p}function KP(p){return h8(typeof p=="function"?p:lo(p,f))}function zSe(p){return v8(lo(p,f))}function GSe(p,m){return p8(p,lo(m,f))}var YSe=er(function(p,m){return function(S){return Xm(S,p,m)}}),KSe=er(function(p,m){return function(S){return Xm(p,S,m)}});function XP(p,m,S){var A=ri(m),B=cC(m,A);S==null&&!(hn(m)&&(B.length||!A.length))&&(S=m,m=p,p=this,B=cC(m,ri(m)));var X=!(hn(S)&&"chain"in S)||!!S.chain,oe=kl(p);return ao(B,function(de){var Re=m[de];p[de]=Re,oe&&(p.prototype[de]=function(){var Be=this.__chain__;if(X||Be){var Fe=p(this.__wrapped__),We=Fe.__actions__=ca(this.__actions__);return We.push({func:Re,args:arguments,thisArg:p}),Fe.__chain__=Be,Fe}return Re.apply(p,qu([this.value()],arguments))})}),p}function XSe(){return fi._===this&&(fi._=bme),this}function qP(){}function qSe(p){return p=Kt(p),er(function(m){return g8(m,p)})}var ZSe=EP(cn),JSe=EP(BU),QSe=EP(JA);function M5(p){return DP(p)?QA(Ds(p)):R0e(p)}function e1e(p){return function(m){return p==null?r:vv(p,m)}}var t1e=L8(),r1e=L8(!0);function ZP(){return[]}function JP(){return!1}function n1e(){return{}}function i1e(){return""}function a1e(){return!0}function o1e(p,m){if(p=Kt(p),p<1||p>_e)return[];var S=R,A=yi(p,R);m=Ct(m),p-=R;for(var B=rP(A,m);++S<p;)m(S);return B}function s1e(p){return Wt(p)?cn(p,Ds):$a(p)?[p]:ca(Q8(Or(p)))}function l1e(p){var m=++yme;return Or(p)+m}var u1e=yC(function(p,m){return p+m},0),f1e=RP("ceil"),c1e=yC(function(p,m){return p/m},1),h1e=RP("floor");function d1e(p){return p&&p.length?fC(p,va,dP):r}function v1e(p,m){return p&&p.length?fC(p,Ct(m,2),dP):r}function p1e(p){return jU(p,va)}function g1e(p,m){return jU(p,Ct(m,2))}function y1e(p){return p&&p.length?fC(p,va,yP):r}function m1e(p,m){return p&&p.length?fC(p,Ct(m,2),yP):r}var b1e=yC(function(p,m){return p*m},1),w1e=RP("round"),_1e=yC(function(p,m){return p-m},0);function S1e(p){return p&&p.length?tP(p,va):0}function C1e(p,m){return p&&p.length?tP(p,Ct(m,2)):0}return Y.after=zwe,Y.ary=f5,Y.assign=I_e,Y.assignIn=x5,Y.assignInWith=AC,Y.assignWith=M_e,Y.at=D_e,Y.before=c5,Y.bind=BP,Y.bindAll=HSe,Y.bindKey=h5,Y.castArray=n_e,Y.chain=s5,Y.chunk=hbe,Y.compact=dbe,Y.concat=vbe,Y.cond=BSe,Y.conforms=VSe,Y.constant=YP,Y.countBy=Swe,Y.create=$_e,Y.curry=d5,Y.curryRight=v5,Y.debounce=p5,Y.defaults=N_e,Y.defaultsDeep=L_e,Y.defer=Gwe,Y.delay=Ywe,Y.difference=pbe,Y.differenceBy=gbe,Y.differenceWith=ybe,Y.drop=mbe,Y.dropRight=bbe,Y.dropRightWhile=wbe,Y.dropWhile=_be,Y.fill=Sbe,Y.filter=xwe,Y.flatMap=Ewe,Y.flatMapDeep=Rwe,Y.flatMapDepth=kwe,Y.flatten=n5,Y.flattenDeep=Cbe,Y.flattenDepth=xbe,Y.flip=Kwe,Y.flow=jSe,Y.flowRight=USe,Y.fromPairs=Tbe,Y.functions=U_e,Y.functionsIn=z_e,Y.groupBy=Awe,Y.initial=Ebe,Y.intersection=Rbe,Y.intersectionBy=kbe,Y.intersectionWith=Abe,Y.invert=Y_e,Y.invertBy=K_e,Y.invokeMap=Iwe,Y.iteratee=KP,Y.keyBy=Mwe,Y.keys=ri,Y.keysIn=da,Y.map=xC,Y.mapKeys=q_e,Y.mapValues=Z_e,Y.matches=zSe,Y.matchesProperty=GSe,Y.memoize=OC,Y.merge=J_e,Y.mergeWith=T5,Y.method=YSe,Y.methodOf=KSe,Y.mixin=XP,Y.negate=EC,Y.nthArg=qSe,Y.omit=Q_e,Y.omitBy=eSe,Y.once=Xwe,Y.orderBy=Dwe,Y.over=ZSe,Y.overArgs=qwe,Y.overEvery=JSe,Y.overSome=QSe,Y.partial=VP,Y.partialRight=g5,Y.partition=$we,Y.pick=tSe,Y.pickBy=O5,Y.property=M5,Y.propertyOf=e1e,Y.pull=Dbe,Y.pullAll=a5,Y.pullAllBy=$be,Y.pullAllWith=Nbe,Y.pullAt=Lbe,Y.range=t1e,Y.rangeRight=r1e,Y.rearg=Zwe,Y.reject=Fwe,Y.remove=Fbe,Y.rest=Jwe,Y.reverse=FP,Y.sampleSize=Bwe,Y.set=nSe,Y.setWith=iSe,Y.shuffle=Vwe,Y.slice=Hbe,Y.sortBy=Uwe,Y.sortedUniq=Gbe,Y.sortedUniqBy=Ybe,Y.split=ESe,Y.spread=Qwe,Y.tail=Kbe,Y.take=Xbe,Y.takeRight=qbe,Y.takeRightWhile=Zbe,Y.takeWhile=Jbe,Y.tap=dwe,Y.throttle=e_e,Y.thru=CC,Y.toArray=_5,Y.toPairs=E5,Y.toPairsIn=R5,Y.toPath=s1e,Y.toPlainObject=C5,Y.transform=aSe,Y.unary=t_e,Y.union=Qbe,Y.unionBy=ewe,Y.unionWith=twe,Y.uniq=rwe,Y.uniqBy=nwe,Y.uniqWith=iwe,Y.unset=oSe,Y.unzip=HP,Y.unzipWith=o5,Y.update=sSe,Y.updateWith=lSe,Y.values=bv,Y.valuesIn=uSe,Y.without=awe,Y.words=P5,Y.wrap=r_e,Y.xor=owe,Y.xorBy=swe,Y.xorWith=lwe,Y.zip=uwe,Y.zipObject=fwe,Y.zipObjectDeep=cwe,Y.zipWith=hwe,Y.entries=E5,Y.entriesIn=R5,Y.extend=x5,Y.extendWith=AC,XP(Y,Y),Y.add=u1e,Y.attempt=I5,Y.camelCase=dSe,Y.capitalize=k5,Y.ceil=f1e,Y.clamp=fSe,Y.clone=i_e,Y.cloneDeep=o_e,Y.cloneDeepWith=s_e,Y.cloneWith=a_e,Y.conformsTo=l_e,Y.deburr=A5,Y.defaultTo=WSe,Y.divide=c1e,Y.endsWith=vSe,Y.eq=Zo,Y.escape=pSe,Y.escapeRegExp=gSe,Y.every=Cwe,Y.find=Twe,Y.findIndex=t5,Y.findKey=F_e,Y.findLast=Owe,Y.findLastIndex=r5,Y.findLastKey=H_e,Y.floor=h1e,Y.forEach=l5,Y.forEachRight=u5,Y.forIn=B_e,Y.forInRight=V_e,Y.forOwn=W_e,Y.forOwnRight=j_e,Y.get=UP,Y.gt=u_e,Y.gte=f_e,Y.has=G_e,Y.hasIn=zP,Y.head=i5,Y.identity=va,Y.includes=Pwe,Y.indexOf=Obe,Y.inRange=cSe,Y.invoke=X_e,Y.isArguments=Nc,Y.isArray=Wt,Y.isArrayBuffer=c_e,Y.isArrayLike=ha,Y.isArrayLikeObject=En,Y.isBoolean=h_e,Y.isBuffer=nf,Y.isDate=d_e,Y.isElement=v_e,Y.isEmpty=p_e,Y.isEqual=g_e,Y.isEqualWith=y_e,Y.isError=WP,Y.isFinite=m_e,Y.isFunction=kl,Y.isInteger=y5,Y.isLength=RC,Y.isMap=m5,Y.isMatch=b_e,Y.isMatchWith=w_e,Y.isNaN=__e,Y.isNative=S_e,Y.isNil=x_e,Y.isNull=C_e,Y.isNumber=b5,Y.isObject=hn,Y.isObjectLike=wn,Y.isPlainObject=t0,Y.isRegExp=jP,Y.isSafeInteger=T_e,Y.isSet=w5,Y.isString=kC,Y.isSymbol=$a,Y.isTypedArray=mv,Y.isUndefined=O_e,Y.isWeakMap=E_e,Y.isWeakSet=R_e,Y.join=Pbe,Y.kebabCase=ySe,Y.last=fo,Y.lastIndexOf=Ibe,Y.lowerCase=mSe,Y.lowerFirst=bSe,Y.lt=k_e,Y.lte=A_e,Y.max=d1e,Y.maxBy=v1e,Y.mean=p1e,Y.meanBy=g1e,Y.min=y1e,Y.minBy=m1e,Y.stubArray=ZP,Y.stubFalse=JP,Y.stubObject=n1e,Y.stubString=i1e,Y.stubTrue=a1e,Y.multiply=b1e,Y.nth=Mbe,Y.noConflict=XSe,Y.noop=qP,Y.now=TC,Y.pad=wSe,Y.padEnd=_Se,Y.padStart=SSe,Y.parseInt=CSe,Y.random=hSe,Y.reduce=Nwe,Y.reduceRight=Lwe,Y.repeat=xSe,Y.replace=TSe,Y.result=rSe,Y.round=w1e,Y.runInContext=Ee,Y.sample=Hwe,Y.size=Wwe,Y.snakeCase=OSe,Y.some=jwe,Y.sortedIndex=Bbe,Y.sortedIndexBy=Vbe,Y.sortedIndexOf=Wbe,Y.sortedLastIndex=jbe,Y.sortedLastIndexBy=Ube,Y.sortedLastIndexOf=zbe,Y.startCase=RSe,Y.startsWith=kSe,Y.subtract=_1e,Y.sum=S1e,Y.sumBy=C1e,Y.template=ASe,Y.times=o1e,Y.toFinite=Al,Y.toInteger=Kt,Y.toLength=S5,Y.toLower=PSe,Y.toNumber=co,Y.toSafeInteger=P_e,Y.toString=Or,Y.toUpper=ISe,Y.trim=MSe,Y.trimEnd=DSe,Y.trimStart=$Se,Y.truncate=NSe,Y.unescape=LSe,Y.uniqueId=l1e,Y.upperCase=FSe,Y.upperFirst=GP,Y.each=l5,Y.eachRight=u5,Y.first=i5,XP(Y,function(){var p={};return Is(Y,function(m,S){Yr.call(Y.prototype,S)||(p[S]=m)}),p}(),{chain:!1}),Y.VERSION=n,ao(["bind","bindKey","curry","curryRight","partial","partialRight"],function(p){Y[p].placeholder=Y}),ao(["drop","take"],function(p,m){cr.prototype[p]=function(S){S=S===r?1:Kn(Kt(S),0);var A=this.__filtered__&&!m?new cr(this):this.clone();return A.__filtered__?A.__takeCount__=yi(S,A.__takeCount__):A.__views__.push({size:yi(S,R),type:p+(A.__dir__<0?"Right":"")}),A},cr.prototype[p+"Right"]=function(S){return this.reverse()[p](S).reverse()}}),ao(["filter","map","takeWhile"],function(p,m){var S=m+1,A=S==V||S==ie;cr.prototype[p]=function(B){var X=this.clone();return X.__iteratees__.push({iteratee:Ct(B,3),type:S}),X.__filtered__=X.__filtered__||A,X}}),ao(["head","last"],function(p,m){var S="take"+(m?"Right":"");cr.prototype[p]=function(){return this[S](1).value()[0]}}),ao(["initial","tail"],function(p,m){var S="drop"+(m?"":"Right");cr.prototype[p]=function(){return this.__filtered__?new cr(this):this[S](1)}}),cr.prototype.compact=function(){return this.filter(va)},cr.prototype.find=function(p){return this.filter(p).head()},cr.prototype.findLast=function(p){return this.reverse().find(p)},cr.prototype.invokeMap=er(function(p,m){return typeof p=="function"?new cr(this):this.map(function(S){return Xm(S,p,m)})}),cr.prototype.reject=function(p){return this.filter(EC(Ct(p)))},cr.prototype.slice=function(p,m){p=Kt(p);var S=this;return S.__filtered__&&(p>0||m<0)?new cr(S):(p<0?S=S.takeRight(-p):p&&(S=S.drop(p)),m!==r&&(m=Kt(m),S=m<0?S.dropRight(-m):S.take(m-p)),S)},cr.prototype.takeRightWhile=function(p){return this.reverse().takeWhile(p).reverse()},cr.prototype.toArray=function(){return this.take(R)},Is(cr.prototype,function(p,m){var S=/^(?:filter|find|map|reject)|While$/.test(m),A=/^(?:head|last)$/.test(m),B=Y[A?"take"+(m=="last"?"Right":""):m],X=A||/^find/.test(m);B&&(Y.prototype[m]=function(){var oe=this.__wrapped__,de=A?[1]:arguments,Re=oe instanceof cr,Be=de[0],Fe=Re||Wt(oe),We=function(lr){var Er=B.apply(Y,qu([lr],de));return A&&ot?Er[0]:Er};Fe&&S&&typeof Be=="function"&&Be.length!=1&&(Re=Fe=!1);var ot=this.__chain__,gt=!!this.__actions__.length,kt=X&&!ot,sr=Re&&!gt;if(!X&&Fe){oe=sr?oe:new cr(this);var xt=p.apply(oe,de);return xt.__actions__.push({func:CC,args:[We],thisArg:r}),new so(xt,ot)}return kt&&sr?p.apply(this,de):(xt=this.thru(We),kt?A?xt.value()[0]:xt.value():xt)})}),ao(["pop","push","shift","sort","splice","unshift"],function(p){var m=X1[p],S=/^(?:push|sort|unshift)$/.test(p)?"tap":"thru",A=/^(?:pop|shift)$/.test(p);Y.prototype[p]=function(){var B=arguments;if(A&&!this.__chain__){var X=this.value();return m.apply(Wt(X)?X:[],B)}return this[S](function(oe){return m.apply(Wt(oe)?oe:[],B)})}}),Is(cr.prototype,function(p,m){var S=Y[m];if(S){var A=S.name+"",B=zm[A]||(zm[A]=[]);B.push({name:m,func:S})}}),zm[gC(r,y).name]=[{name:"wrapper",func:r}],cr.prototype.clone=Nme,cr.prototype.reverse=Lme,cr.prototype.value=Fme,Y.prototype.at=vwe,Y.prototype.chain=pwe,Y.prototype.commit=gwe,Y.prototype.next=ywe,Y.prototype.plant=bwe,Y.prototype.reverse=wwe,Y.prototype.toJSON=Y.prototype.valueOf=Y.prototype.value=_we,Y.prototype.first=Y.prototype.head,Vm&&(Y.prototype[Vm]=mwe),Y},fv=vme();kc?((kc.exports=fv)._=fv,KA._=fv):fi._=fv}).call(Ef)})(eCe,YO);const gs=YO,_ne=e=>(mne("data-v-a55d8e87"),e=e(),bne(),e),tCe={class:"chart-list"},rCe=["onClick"],nCe=_ne(()=>kr("i",{class:"icon-sanjiaoyou iconfont"},null,-1)),iCe={key:0,class:"chart-wrapper"},aCe=["onClick"],oCe={class:"preview"},sCe={class:"name-box"},lCe={class:"chart-nav"},uCe=["onClick"],fCe=_ne(()=>kr("i",{class:"iconfont icon-shouqi"},null,-1)),cCe={key:0,class:"text"},hCe=Fu({__name:"typeBlock",props:{chart:{type:Object,default:()=>({})}},setup(e){const t=e,r=Jp(T1e().map(o=>({...o,open:!0}))),n=o=>{o.open=!o.open},i=Jp(!1),a=o=>{const s={...t.chart};s.type=o.value,LS.emit("updateChart",gs.cloneDeep(s))};return(o,s)=>(ii(),ai("div",{class:cp(["type-block",{expand:i.value}])},[kr("div",tCe,[(ii(!0),ai(HT,null,BT(r.value,l=>$5((ii(),ai("div",{key:l.value},[kr("div",{class:cp(["tab",{open:l.open}]),onClick:u=>n(l)},[nCe,ow(" "+zO(l.label),1)],10,rCe),l.open?(ii(),ai("div",iCe,[(ii(!0),ai(HT,null,BT(l.children,u=>(ii(),ai("div",{key:u.value,class:cp([{active:u.value===t.chart.type},"chart-block"]),onClick:f=>a(u)},[kr("div",oCe,[Io(Mo(O1e),{chart:u},null,8,["chart"])]),kr("div",sCe,zO(u.label),1)],10,aCe))),128))])):GO("",!0)])),[[N5,i.value]])),128)),$5(kr("div",lCe,[(ii(!0),ai(HT,null,BT(Mo(E1e),l=>(ii(),ai("div",{key:l.value,class:cp({active:l.value===t.chart.type}),onClick:u=>a(l)},[kr("i",{class:cp(["iconfont",[l.icon]])},null,2)],10,uCe))),128))],512),[[N5,!i.value]])]),kr("div",{class:"bottom",onClick:s[0]||(s[0]=l=>i.value=!i.value)},[kr("div",null,[fCe,i.value?(ii(),ai("span",cCe,"收起")):GO("",!0)])])],2))}});const dCe=pm(hCe,[["__scopeId","data-v-a55d8e87"]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var s$=function(e,t){return s$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},s$(e,t)};function st(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");s$(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var vCe=function(){function e(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return e}(),pCe=function(){function e(){this.browser=new vCe,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return e}(),Sh=new pCe;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(Sh.wxa=!0,Sh.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?Sh.worker=!0:typeof navigator>"u"?(Sh.node=!0,Sh.svgSupported=!0):gCe(navigator.userAgent,Sh);function gCe(e,t){var r=t.browser,n=e.match(/Firefox\/([\d.]+)/),i=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),a=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);n&&(r.firefox=!0,r.version=n[1]),i&&(r.ie=!0,r.version=i[1]),a&&(r.edge=!0,r.version=a[1],r.newEdge=+a[1].split(".")[0]>18),o&&(r.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,t.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),t.domSupported=typeof document<"u";var s=document.documentElement.style;t.transform3dSupported=(r.ie&&"transition"in s||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||r.ie&&+r.version>=9}const nr=Sh;var PB=12,yCe="sans-serif",pd=PB+"px "+yCe,mCe=20,bCe=100,wCe="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function _Ce(e){var t={};if(typeof JSON>"u")return t;for(var r=0;r<e.length;r++){var n=String.fromCharCode(r+32),i=(e.charCodeAt(r)-mCe)/bCe;t[n]=i}return t}var SCe=_Ce(wCe),gm={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var e,t;return function(r,n){if(!e){var i=gm.createCanvas();e=i&&i.getContext("2d")}if(e)return t!==n&&(t=e.font=n||pd),e.measureText(r);r=r||"",n=n||pd;var a=/(\d+)px/.exec(n),o=a&&+a[1]||PB,s=0;if(n.indexOf("mono")>=0)s=o*r.length;else for(var l=0;l<r.length;l++){var u=SCe[r[l]];s+=u==null?o:u*o}return{width:s}}}(),loadImage:function(e,t,r){var n=new Image;return n.onload=t,n.onerror=r,n.src=e,n}},Sne=sc(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),Cne=sc(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),FS=Object.prototype.toString,JR=Array.prototype,CCe=JR.forEach,xCe=JR.filter,IB=JR.slice,TCe=JR.map,F5=function(){}.constructor,IC=F5?F5.prototype:null,MB="__proto__",OCe=2311;function xne(){return OCe++}function DB(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];typeof console<"u"&&console.error.apply(console,e)}function mr(e){if(e==null||typeof e!="object")return e;var t=e,r=FS.call(e);if(r==="[object Array]"){if(!_b(e)){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=mr(e[n])}}else if(Cne[r]){if(!_b(e)){var a=e.constructor;if(a.from)t=a.from(e);else{t=new a(e.length);for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}}}else if(!Sne[r]&&!_b(e)&&!KO(e)){t={};for(var o in e)e.hasOwnProperty(o)&&o!==MB&&(t[o]=mr(e[o]))}return t}function Ar(e,t,r){if(!Tt(t)||!Tt(e))return r?mr(t):e;for(var n in t)if(t.hasOwnProperty(n)&&n!==MB){var i=e[n],a=t[n];Tt(a)&&Tt(i)&&!dt(a)&&!dt(i)&&!KO(a)&&!KO(i)&&!H5(a)&&!H5(i)&&!_b(a)&&!_b(i)?Ar(i,a,r):(r||!(n in e))&&(e[n]=mr(t[n]))}return e}function Ze(e,t){if(Object.assign)Object.assign(e,t);else for(var r in t)t.hasOwnProperty(r)&&r!==MB&&(e[r]=t[r]);return e}function Mr(e,t,r){for(var n=sn(t),i=0;i<n.length;i++){var a=n[i];(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}return e}function Hr(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return-1}function ECe(e,t){var r=e.prototype;function n(){}n.prototype=t.prototype,e.prototype=new n;for(var i in r)r.hasOwnProperty(i)&&(e.prototype[i]=r[i]);e.prototype.constructor=e,e.superClass=t}function hl(e,t,r){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var a=n[i];a!=="constructor"&&(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}else Mr(e,t,r)}function Ea(e){return!e||typeof e=="string"?!1:typeof e.length=="number"}function ce(e,t,r){if(e&&t)if(e.forEach&&e.forEach===CCe)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(r,e[a],a,e)}function Rt(e,t,r){if(!e)return[];if(!t)return $B(e);if(e.map&&e.map===TCe)return e.map(t,r);for(var n=[],i=0,a=e.length;i<a;i++)n.push(t.call(r,e[i],i,e));return n}function sc(e,t,r,n){if(e&&t){for(var i=0,a=e.length;i<a;i++)r=t.call(n,r,e[i],i,e);return r}}function Qi(e,t,r){if(!e)return[];if(!t)return $B(e);if(e.filter&&e.filter===xCe)return e.filter(t,r);for(var n=[],i=0,a=e.length;i<a;i++)t.call(r,e[i],i,e)&&n.push(e[i]);return n}function sn(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}function RCe(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){return e.apply(t,r.concat(IB.call(arguments)))}}var Jr=IC&&Zt(IC.bind)?IC.call.bind(IC.bind):RCe;function Mn(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){return e.apply(this,t.concat(IB.call(arguments)))}}function dt(e){return Array.isArray?Array.isArray(e):FS.call(e)==="[object Array]"}function Zt(e){return typeof e=="function"}function bt(e){return typeof e=="string"}function l$(e){return FS.call(e)==="[object String]"}function Ur(e){return typeof e=="number"}function Tt(e){var t=typeof e;return t==="function"||!!e&&t==="object"}function H5(e){return!!Sne[FS.call(e)]}function Xa(e){return!!Cne[FS.call(e)]}function KO(e){return typeof e=="object"&&typeof e.nodeType=="number"&&typeof e.ownerDocument=="object"}function QR(e){return e.colorStops!=null}function kCe(e){return e.image!=null}function XO(e){return e!==e}function sw(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e.length;r<n;r++)if(e[r]!=null)return e[r]}function pr(e,t){return e??t}function wb(e,t,r){return e??t??r}function $B(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return IB.apply(e,t)}function Tne(e){if(typeof e=="number")return[e,e,e,e];var t=e.length;return t===2?[e[0],e[1],e[0],e[1]]:t===3?[e[0],e[1],e[2],e[1]]:e}function ku(e,t){if(!e)throw new Error(t)}function al(e){return e==null?null:typeof e.trim=="function"?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var One="__ec_primitive__";function u$(e){e[One]=!0}function _b(e){return e[One]}var ACe=function(){function e(){this.data={}}return e.prototype.delete=function(t){var r=this.has(t);return r&&delete this.data[t],r},e.prototype.has=function(t){return this.data.hasOwnProperty(t)},e.prototype.get=function(t){return this.data[t]},e.prototype.set=function(t,r){return this.data[t]=r,this},e.prototype.keys=function(){return sn(this.data)},e.prototype.forEach=function(t){var r=this.data;for(var n in r)r.hasOwnProperty(n)&&t(r[n],n)},e}(),Ene=typeof Map=="function";function PCe(){return Ene?new Map:new ACe}var ICe=function(){function e(t){var r=dt(t);this.data=PCe();var n=this;t instanceof e?t.each(i):t&&ce(t,i);function i(a,o){r?n.set(a,o):n.set(o,a)}}return e.prototype.hasKey=function(t){return this.data.has(t)},e.prototype.get=function(t){return this.data.get(t)},e.prototype.set=function(t,r){return this.data.set(t,r),r},e.prototype.each=function(t,r){this.data.forEach(function(n,i){t.call(r,n,i)})},e.prototype.keys=function(){var t=this.data.keys();return Ene?Array.from(t):t},e.prototype.removeKey=function(t){this.data.delete(t)},e}();function ir(e){return new ICe(e)}function MCe(e,t){for(var r=new e.constructor(e.length+t.length),n=0;n<e.length;n++)r[n]=e[n];for(var i=e.length,n=0;n<t.length;n++)r[n+i]=t[n];return r}function ek(e,t){var r;if(Object.create)r=Object.create(e);else{var n=function(){};n.prototype=e,r=new n}return t&&Ze(r,t),r}function Rne(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function Qp(e,t){return e.hasOwnProperty(t)}function Ta(){}var DCe=180/Math.PI;function ym(e,t){return e==null&&(e=0),t==null&&(t=0),[e,t]}function $Ce(e){return[e[0],e[1]]}function B5(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function NCe(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function LCe(e){return Math.sqrt(FCe(e))}function FCe(e){return e[0]*e[0]+e[1]*e[1]}function eI(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function HCe(e,t){var r=LCe(t);return r===0?(e[0]=0,e[1]=0):(e[0]=t[0]/r,e[1]=t[1]/r),e}function f$(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var c$=f$;function BCe(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var kp=BCe;function tI(e,t,r,n){return e[0]=t[0]+n*(r[0]-t[0]),e[1]=t[1]+n*(r[1]-t[1]),e}function $o(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function bp(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function wp(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}var wv=function(){function e(t,r){this.target=t,this.topTarget=r&&r.topTarget}return e}(),VCe=function(){function e(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(t){for(var r=t.target;r&&!r.draggable;)r=r.parent||r.__hostTarget;r&&(this._draggingTarget=r,r.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new wv(r,t),"dragstart",t.event))},e.prototype._drag=function(t){var r=this._draggingTarget;if(r){var n=t.offsetX,i=t.offsetY,a=n-this._x,o=i-this._y;this._x=n,this._y=i,r.drift(a,o,t),this.handler.dispatchToElement(new wv(r,t),"drag",t.event);var s=this.handler.findHover(n,i,r).target,l=this._dropTarget;this._dropTarget=s,r!==s&&(l&&s!==l&&this.handler.dispatchToElement(new wv(l,t),"dragleave",t.event),s&&s!==l&&this.handler.dispatchToElement(new wv(s,t),"dragenter",t.event))}},e.prototype._dragEnd=function(t){var r=this._draggingTarget;r&&(r.dragging=!1),this.handler.dispatchToElement(new wv(r,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new wv(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},e}();const WCe=VCe;var jCe=function(){function e(t){t&&(this._$eventProcessor=t)}return e.prototype.on=function(t,r,n,i){this._$handlers||(this._$handlers={});var a=this._$handlers;if(typeof r=="function"&&(i=n,n=r,r=null),!n||!t)return this;var o=this._$eventProcessor;r!=null&&o&&o.normalizeQuery&&(r=o.normalizeQuery(r)),a[t]||(a[t]=[]);for(var s=0;s<a[t].length;s++)if(a[t][s].h===n)return this;var l={h:n,query:r,ctx:i||this,callAtLast:n.zrEventfulCallAtLast},u=a[t].length-1,f=a[t][u];return f&&f.callAtLast?a[t].splice(u,0,l):a[t].push(l),this},e.prototype.isSilent=function(t){var r=this._$handlers;return!r||!r[t]||!r[t].length},e.prototype.off=function(t,r){var n=this._$handlers;if(!n)return this;if(!t)return this._$handlers={},this;if(r){if(n[t]){for(var i=[],a=0,o=n[t].length;a<o;a++)n[t][a].h!==r&&i.push(n[t][a]);n[t]=i}n[t]&&n[t].length===0&&delete n[t]}else delete n[t];return this},e.prototype.trigger=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=i.length,l=0;l<s;l++){var u=i[l];if(!(a&&a.filter&&u.query!=null&&!a.filter(t,u.query)))switch(o){case 0:u.h.call(u.ctx);break;case 1:u.h.call(u.ctx,r[0]);break;case 2:u.h.call(u.ctx,r[0],r[1]);break;default:u.h.apply(u.ctx,r);break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e.prototype.triggerWithContext=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=r[o-1],l=i.length,u=0;u<l;u++){var f=i[u];if(!(a&&a.filter&&f.query!=null&&!a.filter(t,f.query)))switch(o){case 0:f.h.call(s);break;case 1:f.h.call(s,r[0]);break;case 2:f.h.call(s,r[0],r[1]);break;default:f.h.apply(s,r.slice(1,o-1));break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e}();const dl=jCe;var UCe=Math.log(2);function h$(e,t,r,n,i,a){var o=n+"-"+i,s=e.length;if(a.hasOwnProperty(o))return a[o];if(t===1){var l=Math.round(Math.log((1<<s)-1&~i)/UCe);return e[r][l]}for(var u=n|1<<r,f=r+1;n&1<<f;)f++;for(var c=0,h=0,d=0;h<s;h++){var v=1<<h;v&i||(c+=(d%2?-1:1)*e[r][h]*h$(e,t-1,f,u,i|v,a),d++)}return a[o]=c,c}function V5(e,t){var r=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],n={},i=h$(r,8,0,0,0,n);if(i!==0){for(var a=[],o=0;o<8;o++)for(var s=0;s<8;s++)a[s]==null&&(a[s]=0),a[s]+=((o+s)%2?-1:1)*h$(r,7,o===0?1:0,1<<o,1<<s,n)/i*t[o];return function(l,u,f){var c=u*a[6]+f*a[7]+1;l[0]=(u*a[0]+f*a[1]+a[2])/c,l[1]=(u*a[3]+f*a[4]+a[5])/c}}}var W5="___zrEVENTSAVED",rI=[];function zCe(e,t,r,n,i){return d$(rI,t,n,i,!0)&&d$(e,r,rI[0],rI[1])}function d$(e,t,r,n,i){if(t.getBoundingClientRect&&nr.domSupported&&!kne(t)){var a=t[W5]||(t[W5]={}),o=GCe(t,a),s=YCe(o,a,i);if(s)return s(e,r,n),!0}return!1}function GCe(e,t){var r=t.markers;if(r)return r;r=t.markers=[];for(var n=["left","right"],i=["top","bottom"],a=0;a<4;a++){var o=document.createElement("div"),s=o.style,l=a%2,u=(a>>1)%2;s.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[l]+":0",i[u]+":0",n[1-l]+":auto",i[1-u]+":auto",""].join("!important;"),e.appendChild(o),r.push(o)}return r}function YCe(e,t,r){for(var n=r?"invTrans":"trans",i=t[n],a=t.srcCoords,o=[],s=[],l=!0,u=0;u<4;u++){var f=e[u].getBoundingClientRect(),c=2*u,h=f.left,d=f.top;o.push(h,d),l=l&&a&&h===a[c]&&d===a[c+1],s.push(e[u].offsetLeft,e[u].offsetTop)}return l&&i?i:(t.srcCoords=o,t[n]=r?V5(s,o):V5(o,s))}function kne(e){return e.nodeName.toUpperCase()==="CANVAS"}var KCe=/([&<>"'])/g,XCe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Oo(e){return e==null?"":(e+"").replace(KCe,function(t,r){return XCe[r]})}var qCe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,nI=[],ZCe=nr.browser.firefox&&+nr.browser.version.split(".")[0]<39;function v$(e,t,r,n){return r=r||{},n?j5(e,t,r):ZCe&&t.layerX!=null&&t.layerX!==t.offsetX?(r.zrX=t.layerX,r.zrY=t.layerY):t.offsetX!=null?(r.zrX=t.offsetX,r.zrY=t.offsetY):j5(e,t,r),r}function j5(e,t,r){if(nr.domSupported&&e.getBoundingClientRect){var n=t.clientX,i=t.clientY;if(kne(e)){var a=e.getBoundingClientRect();r.zrX=n-a.left,r.zrY=i-a.top;return}else if(d$(nI,e,n,i)){r.zrX=nI[0],r.zrY=nI[1];return}}r.zrX=r.zrY=0}function NB(e){return e||window.event}function _o(e,t,r){if(t=NB(t),t.zrX!=null)return t;var n=t.type,i=n&&n.indexOf("touch")>=0;if(i){var o=n!=="touchend"?t.targetTouches[0]:t.changedTouches[0];o&&v$(e,o,t,r)}else{v$(e,t,t,r);var a=JCe(t);t.zrDelta=a?a/120:-(t.detail||0)/3}var s=t.button;return t.which==null&&s!==void 0&&qCe.test(t.type)&&(t.which=s&1?1:s&2?3:s&4?2:0),t}function JCe(e){var t=e.wheelDelta;if(t)return t;var r=e.deltaX,n=e.deltaY;if(r==null||n==null)return t;var i=Math.abs(n!==0?n:r),a=n>0?-1:n<0?1:r>0?-1:1;return 3*i*a}function QCe(e,t,r,n){e.addEventListener(t,r,n)}function exe(e,t,r,n){e.removeEventListener(t,r,n)}var Ane=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0},txe=function(){function e(){this._track=[]}return e.prototype.recognize=function(t,r,n){return this._doTrack(t,r,n),this._recognize(t)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(t,r,n){var i=t.touches;if(i){for(var a={points:[],touches:[],target:r,event:t},o=0,s=i.length;o<s;o++){var l=i[o],u=v$(n,l,{});a.points.push([u.zrX,u.zrY]),a.touches.push(l)}this._track.push(a)}},e.prototype._recognize=function(t){for(var r in iI)if(iI.hasOwnProperty(r)){var n=iI[r](this._track,t);if(n)return n}},e}();function U5(e){var t=e[1][0]-e[0][0],r=e[1][1]-e[0][1];return Math.sqrt(t*t+r*r)}function rxe(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}var iI={pinch:function(e,t){var r=e.length;if(r){var n=(e[r-1]||{}).points,i=(e[r-2]||{}).points||n;if(i&&i.length>1&&n&&n.length>1){var a=U5(n)/U5(i);!isFinite(a)&&(a=1),t.pinchScale=a;var o=rxe(n);return t.pinchX=o[0],t.pinchY=o[1],{type:"pinch",target:e[0].target,event:t}}}}};function lw(){return[1,0,0,1,0,0]}function LB(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function nxe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Ap(e,t,r){var n=t[0]*r[0]+t[2]*r[1],i=t[1]*r[0]+t[3]*r[1],a=t[0]*r[2]+t[2]*r[3],o=t[1]*r[2]+t[3]*r[3],s=t[0]*r[4]+t[2]*r[5]+t[4],l=t[1]*r[4]+t[3]*r[5]+t[5];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e}function p$(e,t,r){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+r[0],e[5]=t[5]+r[1],e}function FB(e,t,r){var n=t[0],i=t[2],a=t[4],o=t[1],s=t[3],l=t[5],u=Math.sin(r),f=Math.cos(r);return e[0]=n*f+o*u,e[1]=-n*u+o*f,e[2]=i*f+s*u,e[3]=-i*u+f*s,e[4]=f*a+u*l,e[5]=f*l-u*a,e}function ixe(e,t,r){var n=r[0],i=r[1];return e[0]=t[0]*n,e[1]=t[1]*i,e[2]=t[2]*n,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*i,e}function HB(e,t){var r=t[0],n=t[2],i=t[4],a=t[1],o=t[3],s=t[5],l=r*o-a*n;return l?(l=1/l,e[0]=o*l,e[1]=-a*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*s-o*i)*l,e[5]=(a*i-r*s)*l,e):null}var axe=function(){function e(t,r){this.x=t||0,this.y=r||0}return e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(t,r){return this.x=t,this.y=r,this},e.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.scaleAndAdd=function(t,r){this.x+=t.x*r,this.y+=t.y*r},e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},e.prototype.distance=function(t){var r=this.x-t.x,n=this.y-t.y;return Math.sqrt(r*r+n*n)},e.prototype.distanceSquare=function(t){var r=this.x-t.x,n=this.y-t.y;return r*r+n*n},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(t){if(t){var r=this.x,n=this.y;return this.x=t[0]*r+t[2]*n+t[4],this.y=t[1]*r+t[3]*n+t[5],this}},e.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},e.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},e.set=function(t,r,n){t.x=r,t.y=n},e.copy=function(t,r){t.x=r.x,t.y=r.y},e.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.lenSquare=function(t){return t.x*t.x+t.y*t.y},e.dot=function(t,r){return t.x*r.x+t.y*r.y},e.add=function(t,r,n){t.x=r.x+n.x,t.y=r.y+n.y},e.sub=function(t,r,n){t.x=r.x-n.x,t.y=r.y-n.y},e.scale=function(t,r,n){t.x=r.x*n,t.y=r.y*n},e.scaleAndAdd=function(t,r,n,i){t.x=r.x+n.x*i,t.y=r.y+n.y*i},e.lerp=function(t,r,n,i){var a=1-i;t.x=a*r.x+i*n.x,t.y=a*r.y+i*n.y},e}();const Nt=axe;var MC=Math.min,DC=Math.max,Lc=new Nt,Fc=new Nt,Hc=new Nt,Bc=new Nt,r0=new Nt,n0=new Nt,oxe=function(){function e(t,r,n,i){n<0&&(t=t+n,n=-n),i<0&&(r=r+i,i=-i),this.x=t,this.y=r,this.width=n,this.height=i}return e.prototype.union=function(t){var r=MC(t.x,this.x),n=MC(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=DC(t.x+t.width,this.x+this.width)-r:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=DC(t.y+t.height,this.y+this.height)-n:this.height=t.height,this.x=r,this.y=n},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(t){var r=this,n=t.width/r.width,i=t.height/r.height,a=lw();return p$(a,a,[-r.x,-r.y]),ixe(a,a,[n,i]),p$(a,a,[t.x,t.y]),a},e.prototype.intersect=function(t,r){if(!t)return!1;t instanceof e||(t=e.create(t));var n=this,i=n.x,a=n.x+n.width,o=n.y,s=n.y+n.height,l=t.x,u=t.x+t.width,f=t.y,c=t.y+t.height,h=!(a<l||u<i||s<f||c<o);if(r){var d=1/0,v=0,g=Math.abs(a-l),y=Math.abs(u-i),b=Math.abs(s-f),w=Math.abs(c-o),_=Math.min(g,y),x=Math.min(b,w);a<l||u<i?_>v&&(v=_,g<y?Nt.set(n0,-g,0):Nt.set(n0,y,0)):_<d&&(d=_,g<y?Nt.set(r0,g,0):Nt.set(r0,-y,0)),s<f||c<o?x>v&&(v=x,b<w?Nt.set(n0,0,-b):Nt.set(n0,0,w)):_<d&&(d=_,b<w?Nt.set(r0,0,b):Nt.set(r0,0,-w))}return r&&Nt.copy(r,h?r0:n0),h},e.prototype.contain=function(t,r){var n=this;return t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return this.width===0||this.height===0},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(t,r){t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height},e.applyTransform=function(t,r,n){if(!n){t!==r&&e.copy(t,r);return}if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var i=n[0],a=n[3],o=n[4],s=n[5];t.x=r.x*i+o,t.y=r.y*a+s,t.width=r.width*i,t.height=r.height*a,t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height);return}Lc.x=Hc.x=r.x,Lc.y=Bc.y=r.y,Fc.x=Bc.x=r.x+r.width,Fc.y=Hc.y=r.y+r.height,Lc.transform(n),Bc.transform(n),Fc.transform(n),Hc.transform(n),t.x=MC(Lc.x,Fc.x,Hc.x,Bc.x),t.y=MC(Lc.y,Fc.y,Hc.y,Bc.y);var l=DC(Lc.x,Fc.x,Hc.x,Bc.x),u=DC(Lc.y,Fc.y,Hc.y,Bc.y);t.width=l-t.x,t.height=u-t.y},e}();const Pr=oxe;var Pne="silent";function sxe(e,t,r){return{type:e,event:r,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:lxe}}function lxe(){Ane(this.event)}var uxe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.handler=null,r}return t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(dl),i0=function(){function e(t,r){this.x=t,this.y=r}return e}(),fxe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],aI=new Pr(0,0,0,0),Ine=function(e){st(t,e);function t(r,n,i,a,o){var s=e.call(this)||this;return s._hovered=new i0(0,0),s.storage=r,s.painter=n,s.painterRoot=a,s._pointerSize=o,i=i||new uxe,s.proxy=null,s.setHandlerProxy(i),s._draggingMgr=new WCe(s),s}return t.prototype.setHandlerProxy=function(r){this.proxy&&this.proxy.dispose(),r&&(ce(fxe,function(n){r.on&&r.on(n,this[n],this)},this),r.handler=this),this.proxy=r},t.prototype.mousemove=function(r){var n=r.zrX,i=r.zrY,a=Mne(this,n,i),o=this._hovered,s=o.target;s&&!s.__zr&&(o=this.findHover(o.x,o.y),s=o.target);var l=this._hovered=a?new i0(n,i):this.findHover(n,i),u=l.target,f=this.proxy;f.setCursor&&f.setCursor(u?u.cursor:"default"),s&&u!==s&&this.dispatchToElement(o,"mouseout",r),this.dispatchToElement(l,"mousemove",r),u&&u!==s&&this.dispatchToElement(l,"mouseover",r)},t.prototype.mouseout=function(r){var n=r.zrEventControl;n!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",r),n!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:r})},t.prototype.resize=function(){this._hovered=new i0(0,0)},t.prototype.dispatch=function(r,n){var i=this[r];i&&i.call(this,n)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(r){var n=this.proxy;n.setCursor&&n.setCursor(r)},t.prototype.dispatchToElement=function(r,n,i){r=r||{};var a=r.target;if(!(a&&a.silent)){for(var o="on"+n,s=sxe(n,r,i);a&&(a[o]&&(s.cancelBubble=!!a[o].call(a,s)),a.trigger(n,s),a=a.__hostTarget?a.__hostTarget:a.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(n,s),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[o]=="function"&&l[o].call(l,s),l.trigger&&l.trigger(n,s)}))}},t.prototype.findHover=function(r,n,i){var a=this.storage.getDisplayList(),o=new i0(r,n);if(z5(a,o,r,n,i),this._pointerSize&&!o.target){for(var s=[],l=this._pointerSize,u=l/2,f=new Pr(r-u,n-u,l,l),c=a.length-1;c>=0;c--){var h=a[c];h!==i&&!h.ignore&&!h.ignoreCoarsePointer&&(!h.parent||!h.parent.ignoreCoarsePointer)&&(aI.copy(h.getBoundingRect()),h.transform&&aI.applyTransform(h.transform),aI.intersect(f)&&s.push(h))}if(s.length)for(var d=4,v=Math.PI/12,g=Math.PI*2,y=0;y<u;y+=d)for(var b=0;b<g;b+=v){var w=r+y*Math.cos(b),_=n+y*Math.sin(b);if(z5(s,o,w,_,i),o.target)return o}}return o},t.prototype.processGesture=function(r,n){this._gestureMgr||(this._gestureMgr=new txe);var i=this._gestureMgr;n==="start"&&i.clear();var a=i.recognize(r,this.findHover(r.zrX,r.zrY,null).target,this.proxy.dom);if(n==="end"&&i.clear(),a){var o=a.type;r.gestureEvent=o;var s=new i0;s.target=a.target,this.dispatchToElement(s,o,a.event)}},t}(dl);ce(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){Ine.prototype[e]=function(t){var r=t.zrX,n=t.zrY,i=Mne(this,r,n),a,o;if((e!=="mouseup"||!i)&&(a=this.findHover(r,n),o=a.target),e==="mousedown")this._downEl=o,this._downPoint=[t.zrX,t.zrY],this._upEl=o;else if(e==="mouseup")this._upEl=o;else if(e==="click"){if(this._downEl!==this._upEl||!this._downPoint||c$(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,e,t)}});function cxe(e,t,r){if(e[e.rectHover?"rectContain":"contain"](t,r)){for(var n=e,i=void 0,a=!1;n;){if(n.ignoreClip&&(a=!0),!a){var o=n.getClipPath();if(o&&!o.contain(t,r))return!1;n.silent&&(i=!0)}var s=n.__hostTarget;n=s||n.parent}return i?Pne:!0}return!1}function z5(e,t,r,n,i){for(var a=e.length-1;a>=0;a--){var o=e[a],s=void 0;if(o!==i&&!o.ignore&&(s=cxe(o,r,n))&&(!t.topTarget&&(t.topTarget=o),s!==Pne)){t.target=o;break}}}function Mne(e,t,r){var n=e.painter;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}const hxe=Ine;var Dne=32,a0=7;function dxe(e){for(var t=0;e>=Dne;)t|=e&1,e>>=1;return e+t}function G5(e,t,r,n){var i=t+1;if(i===r)return 1;if(n(e[i++],e[t])<0){for(;i<r&&n(e[i],e[i-1])<0;)i++;vxe(e,t,i)}else for(;i<r&&n(e[i],e[i-1])>=0;)i++;return i-t}function vxe(e,t,r){for(r--;t<r;){var n=e[t];e[t++]=e[r],e[r--]=n}}function Y5(e,t,r,n,i){for(n===t&&n++;n<r;n++){for(var a=e[n],o=t,s=n,l;o<s;)l=o+s>>>1,i(a,e[l])<0?s=l:o=l+1;var u=n-o;switch(u){case 3:e[o+3]=e[o+2];case 2:e[o+2]=e[o+1];case 1:e[o+1]=e[o];break;default:for(;u>0;)e[o+u]=e[o+u-1],u--}e[o]=a}}function oI(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])>0){for(s=n-i;l<s&&a(e,t[r+i+l])>0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}else{for(s=i+1;l<s&&a(e,t[r+i-l])<=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])>0?o=f+1:l=f}return l}function sI(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])<0){for(s=i+1;l<s&&a(e,t[r+i-l])<0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}else{for(s=n-i;l<s&&a(e,t[r+i+l])>=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])<0?l=f:o=f+1}return l}function pxe(e,t){var r=a0,n,i,a=0;e.length;var o=[];n=[],i=[];function s(d,v){n[a]=d,i[a]=v,a+=1}function l(){for(;a>1;){var d=a-2;if(d>=1&&i[d-1]<=i[d]+i[d+1]||d>=2&&i[d-2]<=i[d]+i[d-1])i[d-1]<i[d+1]&&d--;else if(i[d]>i[d+1])break;f(d)}}function u(){for(;a>1;){var d=a-2;d>0&&i[d-1]<i[d+1]&&d--,f(d)}}function f(d){var v=n[d],g=i[d],y=n[d+1],b=i[d+1];i[d]=g+b,d===a-3&&(n[d+1]=n[d+2],i[d+1]=i[d+2]),a--;var w=sI(e[y],e,v,g,0,t);v+=w,g-=w,g!==0&&(b=oI(e[v+g-1],e,y,b,b-1,t),b!==0&&(g<=b?c(v,g,y,b):h(v,g,y,b)))}function c(d,v,g,y){var b=0;for(b=0;b<v;b++)o[b]=e[d+b];var w=0,_=g,x=d;if(e[x++]=e[_++],--y===0){for(b=0;b<v;b++)e[x+b]=o[w+b];return}if(v===1){for(b=0;b<y;b++)e[x+b]=e[_+b];e[x+y]=o[w];return}for(var T=r,O,E,M;;){O=0,E=0,M=!1;do if(t(e[_],o[w])<0){if(e[x++]=e[_++],E++,O=0,--y===0){M=!0;break}}else if(e[x++]=o[w++],O++,E=0,--v===1){M=!0;break}while((O|E)<T);if(M)break;do{if(O=sI(e[_],o,w,v,0,t),O!==0){for(b=0;b<O;b++)e[x+b]=o[w+b];if(x+=O,w+=O,v-=O,v<=1){M=!0;break}}if(e[x++]=e[_++],--y===0){M=!0;break}if(E=oI(o[w],e,_,y,0,t),E!==0){for(b=0;b<E;b++)e[x+b]=e[_+b];if(x+=E,_+=E,y-=E,y===0){M=!0;break}}if(e[x++]=o[w++],--v===1){M=!0;break}T--}while(O>=a0||E>=a0);if(M)break;T<0&&(T=0),T+=2}if(r=T,r<1&&(r=1),v===1){for(b=0;b<y;b++)e[x+b]=e[_+b];e[x+y]=o[w]}else{if(v===0)throw new Error;for(b=0;b<v;b++)e[x+b]=o[w+b]}}function h(d,v,g,y){var b=0;for(b=0;b<y;b++)o[b]=e[g+b];var w=d+v-1,_=y-1,x=g+y-1,T=0,O=0;if(e[x--]=e[w--],--v===0){for(T=x-(y-1),b=0;b<y;b++)e[T+b]=o[b];return}if(y===1){for(x-=v,w-=v,O=x+1,T=w+1,b=v-1;b>=0;b--)e[O+b]=e[T+b];e[x]=o[_];return}for(var E=r;;){var M=0,P=0,N=!1;do if(t(o[_],e[w])<0){if(e[x--]=e[w--],M++,P=0,--v===0){N=!0;break}}else if(e[x--]=o[_--],P++,M=0,--y===1){N=!0;break}while((M|P)<E);if(N)break;do{if(M=v-sI(o[_],e,d,v,v-1,t),M!==0){for(x-=M,w-=M,v-=M,O=x+1,T=w+1,b=M-1;b>=0;b--)e[O+b]=e[T+b];if(v===0){N=!0;break}}if(e[x--]=o[_--],--y===1){N=!0;break}if(P=y-oI(e[w],o,0,y,y-1,t),P!==0){for(x-=P,_-=P,y-=P,O=x+1,T=_+1,b=0;b<P;b++)e[O+b]=o[T+b];if(y<=1){N=!0;break}}if(e[x--]=e[w--],--v===0){N=!0;break}E--}while(M>=a0||P>=a0);if(N)break;E<0&&(E=0),E+=2}if(r=E,r<1&&(r=1),y===1){for(x-=v,w-=v,O=x+1,T=w+1,b=v-1;b>=0;b--)e[O+b]=e[T+b];e[x]=o[_]}else{if(y===0)throw new Error;for(T=x-(y-1),b=0;b<y;b++)e[T+b]=o[b]}}return{mergeRuns:l,forceMergeRuns:u,pushRun:s}}function VT(e,t,r,n){r||(r=0),n||(n=e.length);var i=n-r;if(!(i<2)){var a=0;if(i<Dne){a=G5(e,r,n,t),Y5(e,r,n,r+a,t);return}var o=pxe(e,t),s=dxe(i);do{if(a=G5(e,r,n,t),a<s){var l=i;l>s&&(l=s),Y5(e,r,r+l,r+a,t),a=l}o.pushRun(r,a),o.mergeRuns(),i-=a,r+=a}while(i!==0);o.forceMergeRuns()}}var za=1,tb=2,hp=4,K5=!1;function lI(){K5||(K5=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function X5(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var gxe=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=X5}return e.prototype.traverse=function(t,r){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,r)},e.prototype.getDisplayList=function(t,r){r=r||!1;var n=this._displayList;return(t||!n.length)&&this.updateDisplayList(r),n},e.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var r=this._roots,n=this._displayList,i=0,a=r.length;i<a;i++)this._updateAndAddDisplayable(r[i],null,t);n.length=this._displayListLen,VT(n,X5)},e.prototype._updateAndAddDisplayable=function(t,r,n){if(!(t.ignore&&!n)){t.beforeUpdate(),t.update(),t.afterUpdate();var i=t.getClipPath();if(t.ignoreClip)r=null;else if(i){r?r=r.slice():r=[];for(var a=i,o=t;a;)a.parent=o,a.updateTransform(),r.push(a),o=a,a=a.getClipPath()}if(t.childrenRef){for(var s=t.childrenRef(),l=0;l<s.length;l++){var u=s[l];t.__dirty&&(u.__dirty|=za),this._updateAndAddDisplayable(u,r,n)}t.__dirty=0}else{var f=t;r&&r.length?f.__clipPaths=r:f.__clipPaths&&f.__clipPaths.length>0&&(f.__clipPaths=[]),isNaN(f.z)&&(lI(),f.z=0),isNaN(f.z2)&&(lI(),f.z2=0),isNaN(f.zlevel)&&(lI(),f.zlevel=0),this._displayList[this._displayListLen++]=f}var c=t.getDecalElement&&t.getDecalElement();c&&this._updateAndAddDisplayable(c,r,n);var h=t.getTextGuideLine();h&&this._updateAndAddDisplayable(h,r,n);var d=t.getTextContent();d&&this._updateAndAddDisplayable(d,r,n)}},e.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},e.prototype.delRoot=function(t){if(t instanceof Array){for(var r=0,n=t.length;r<n;r++)this.delRoot(t[r]);return}var i=Hr(this._roots,t);i>=0&&this._roots.splice(i,1)},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}();const yxe=gxe;var $ne;$ne=nr.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};const g$=$ne;var WT={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return .5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},exponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)))},elasticOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},elasticInOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)):r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-WT.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?WT.bounceIn(e*2)*.5:WT.bounceOut(e*2-1)*.5+.5}};const Nne=WT;var $C=Math.pow,Vf=Math.sqrt,qO=1e-8,Lne=1e-4,q5=Vf(3),NC=1/3,tl=ym(),Eo=ym(),Pp=ym();function If(e){return e>-qO&&e<qO}function Fne(e){return e>qO||e<-qO}function qn(e,t,r,n,i){var a=1-i;return a*a*(a*e+3*i*t)+i*i*(i*n+3*a*r)}function Z5(e,t,r,n,i){var a=1-i;return 3*(((t-e)*a+2*(r-t)*i)*a+(n-r)*i*i)}function ZO(e,t,r,n,i,a){var o=n+3*(t-r)-e,s=3*(r-t*2+e),l=3*(t-e),u=e-i,f=s*s-3*o*l,c=s*l-9*o*u,h=l*l-3*s*u,d=0;if(If(f)&&If(c))if(If(s))a[0]=0;else{var v=-l/s;v>=0&&v<=1&&(a[d++]=v)}else{var g=c*c-4*f*h;if(If(g)){var y=c/f,v=-s/o+y,b=-y/2;v>=0&&v<=1&&(a[d++]=v),b>=0&&b<=1&&(a[d++]=b)}else if(g>0){var w=Vf(g),_=f*s+1.5*o*(-c+w),x=f*s+1.5*o*(-c-w);_<0?_=-$C(-_,NC):_=$C(_,NC),x<0?x=-$C(-x,NC):x=$C(x,NC);var v=(-s-(_+x))/(3*o);v>=0&&v<=1&&(a[d++]=v)}else{var T=(2*f*s-3*o*c)/(2*Vf(f*f*f)),O=Math.acos(T)/3,E=Vf(f),M=Math.cos(O),v=(-s-2*E*M)/(3*o),b=(-s+E*(M+q5*Math.sin(O)))/(3*o),P=(-s+E*(M-q5*Math.sin(O)))/(3*o);v>=0&&v<=1&&(a[d++]=v),b>=0&&b<=1&&(a[d++]=b),P>=0&&P<=1&&(a[d++]=P)}}return d}function Hne(e,t,r,n,i){var a=6*r-12*t+6*e,o=9*t+3*n-3*e-9*r,s=3*t-3*e,l=0;if(If(o)){if(Fne(a)){var u=-s/a;u>=0&&u<=1&&(i[l++]=u)}}else{var f=a*a-4*o*s;if(If(f))i[0]=-a/(2*o);else if(f>0){var c=Vf(f),u=(-a+c)/(2*o),h=(-a-c)/(2*o);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function JO(e,t,r,n,i,a){var o=(t-e)*i+e,s=(r-t)*i+t,l=(n-r)*i+r,u=(s-o)*i+o,f=(l-s)*i+s,c=(f-u)*i+u;a[0]=e,a[1]=o,a[2]=u,a[3]=c,a[4]=c,a[5]=f,a[6]=l,a[7]=n}function mxe(e,t,r,n,i,a,o,s,l,u,f){var c,h=.005,d=1/0,v,g,y,b;tl[0]=l,tl[1]=u;for(var w=0;w<1;w+=.05)Eo[0]=qn(e,r,i,o,w),Eo[1]=qn(t,n,a,s,w),y=kp(tl,Eo),y<d&&(c=w,d=y);d=1/0;for(var _=0;_<32&&!(h<Lne);_++)v=c-h,g=c+h,Eo[0]=qn(e,r,i,o,v),Eo[1]=qn(t,n,a,s,v),y=kp(Eo,tl),v>=0&&y<d?(c=v,d=y):(Pp[0]=qn(e,r,i,o,g),Pp[1]=qn(t,n,a,s,g),b=kp(Pp,tl),g<=1&&b<d?(c=g,d=b):h*=.5);return f&&(f[0]=qn(e,r,i,o,c),f[1]=qn(t,n,a,s,c)),Vf(d)}function bxe(e,t,r,n,i,a,o,s,l){for(var u=e,f=t,c=0,h=1/l,d=1;d<=l;d++){var v=d*h,g=qn(e,r,i,o,v),y=qn(t,n,a,s,v),b=g-u,w=y-f;c+=Math.sqrt(b*b+w*w),u=g,f=y}return c}function Si(e,t,r,n){var i=1-n;return i*(i*e+2*n*t)+n*n*r}function J5(e,t,r,n){return 2*((1-n)*(t-e)+n*(r-t))}function wxe(e,t,r,n,i){var a=e-2*t+r,o=2*(t-e),s=e-n,l=0;if(If(a)){if(Fne(o)){var u=-s/o;u>=0&&u<=1&&(i[l++]=u)}}else{var f=o*o-4*a*s;if(If(f)){var u=-o/(2*a);u>=0&&u<=1&&(i[l++]=u)}else if(f>0){var c=Vf(f),u=(-o+c)/(2*a),h=(-o-c)/(2*a);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function Bne(e,t,r){var n=e+r-2*t;return n===0?.5:(e-t)/n}function QO(e,t,r,n,i){var a=(t-e)*n+e,o=(r-t)*n+t,s=(o-a)*n+a;i[0]=e,i[1]=a,i[2]=s,i[3]=s,i[4]=o,i[5]=r}function _xe(e,t,r,n,i,a,o,s,l){var u,f=.005,c=1/0;tl[0]=o,tl[1]=s;for(var h=0;h<1;h+=.05){Eo[0]=Si(e,r,i,h),Eo[1]=Si(t,n,a,h);var d=kp(tl,Eo);d<c&&(u=h,c=d)}c=1/0;for(var v=0;v<32&&!(f<Lne);v++){var g=u-f,y=u+f;Eo[0]=Si(e,r,i,g),Eo[1]=Si(t,n,a,g);var d=kp(Eo,tl);if(g>=0&&d<c)u=g,c=d;else{Pp[0]=Si(e,r,i,y),Pp[1]=Si(t,n,a,y);var b=kp(Pp,tl);y<=1&&b<c?(u=y,c=b):f*=.5}}return l&&(l[0]=Si(e,r,i,u),l[1]=Si(t,n,a,u)),Vf(c)}function Sxe(e,t,r,n,i,a,o){for(var s=e,l=t,u=0,f=1/o,c=1;c<=o;c++){var h=c*f,d=Si(e,r,i,h),v=Si(t,n,a,h),g=d-s,y=v-l;u+=Math.sqrt(g*g+y*y),s=d,l=v}return u}var Cxe=/cubic-bezier\(([0-9,\.e ]+)\)/;function Vne(e){var t=e&&Cxe.exec(e);if(t){var r=t[1].split(","),n=+al(r[0]),i=+al(r[1]),a=+al(r[2]),o=+al(r[3]);if(isNaN(n+i+a+o))return;var s=[];return function(l){return l<=0?0:l>=1?1:ZO(0,n,a,1,l,s)&&qn(0,i,o,1,s[0])}}}var xxe=function(){function e(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||Ta,this.ondestroy=t.ondestroy||Ta,this.onrestart=t.onrestart||Ta,t.easing&&this.setEasing(t.easing)}return e.prototype.step=function(t,r){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=r;return}var n=this._life,i=t-this._startTime-this._pausedTime,a=i/n;a<0&&(a=0),a=Math.min(a,1);var o=this.easingFunc,s=o?o(a):a;if(this.onframe(s),a===1)if(this.loop){var l=i%n;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(t){this.easing=t,this.easingFunc=Zt(t)?t:Nne[t]||Vne(t)},e}();const Txe=xxe;var Wne=function(){function e(t){this.value=t}return e}(),Oxe=function(){function e(){this._len=0}return e.prototype.insert=function(t){var r=new Wne(t);return this.insertEntry(r),r},e.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},e.prototype.remove=function(t){var r=t.prev,n=t.next;r?r.next=n:this.head=n,n?n.prev=r:this.tail=r,t.next=t.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),Exe=function(){function e(t){this._list=new Oxe,this._maxSize=10,this._map={},this._maxSize=t}return e.prototype.put=function(t,r){var n=this._list,i=this._map,a=null;if(i[t]==null){var o=n.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var l=n.head;n.remove(l),delete i[l.key],a=l.value,this._lastRemovedEntry=l}s?s.value=r:s=new Wne(r),s.key=t,n.insertEntry(s),i[t]=s}return a},e.prototype.get=function(t){var r=this._map[t],n=this._list;if(r!=null)return r!==n.tail&&(n.remove(r),n.insertEntry(r)),r.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}();const HS=Exe;var Q5={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Wf(e){return e=Math.round(e),e<0?0:e>255?255:e}function y$(e){return e<0?0:e>1?1:e}function uI(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?Wf(parseFloat(t)/100*255):Wf(parseInt(t,10))}function Sb(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?y$(parseFloat(t)/100):y$(parseFloat(t))}function fI(e,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?e+(t-e)*r*6:r*2<1?t:r*3<2?e+(t-e)*(2/3-r)*6:e}function LC(e,t,r){return e+(t-e)*r}function bo(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function m$(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var jne=new HS(20),FC=null;function _v(e,t){FC&&m$(FC,t),FC=jne.put(e,FC||t.slice())}function xu(e,t){if(e){t=t||[];var r=jne.get(e);if(r)return m$(t,r);e=e+"";var n=e.replace(/ /g,"").toLowerCase();if(n in Q5)return m$(t,Q5[n]),_v(e,t),t;var i=n.length;if(n.charAt(0)==="#"){if(i===4||i===5){var a=parseInt(n.slice(1,4),16);if(!(a>=0&&a<=4095)){bo(t,0,0,0,1);return}return bo(t,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,i===5?parseInt(n.slice(4),16)/15:1),_v(e,t),t}else if(i===7||i===9){var a=parseInt(n.slice(1,7),16);if(!(a>=0&&a<=16777215)){bo(t,0,0,0,1);return}return bo(t,(a&16711680)>>16,(a&65280)>>8,a&255,i===9?parseInt(n.slice(7),16)/255:1),_v(e,t),t}return}var o=n.indexOf("("),s=n.indexOf(")");if(o!==-1&&s+1===i){var l=n.substr(0,o),u=n.substr(o+1,s-(o+1)).split(","),f=1;switch(l){case"rgba":if(u.length!==4)return u.length===3?bo(t,+u[0],+u[1],+u[2],1):bo(t,0,0,0,1);f=Sb(u.pop());case"rgb":if(u.length>=3)return bo(t,uI(u[0]),uI(u[1]),uI(u[2]),u.length===3?f:Sb(u[3])),_v(e,t),t;bo(t,0,0,0,1);return;case"hsla":if(u.length!==4){bo(t,0,0,0,1);return}return u[3]=Sb(u[3]),e6(u,t),_v(e,t),t;case"hsl":if(u.length!==3){bo(t,0,0,0,1);return}return e6(u,t),_v(e,t),t;default:return}}bo(t,0,0,0,1)}}function e6(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=Sb(e[1]),i=Sb(e[2]),a=i<=.5?i*(n+1):i+n-i*n,o=i*2-a;return t=t||[],bo(t,Wf(fI(o,a,r+1/3)*255),Wf(fI(o,a,r)*255),Wf(fI(o,a,r-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function t6(e,t){var r=xu(e);if(r){for(var n=0;n<3;n++)t<0?r[n]=r[n]*(1-t)|0:r[n]=(255-r[n])*t+r[n]|0,r[n]>255?r[n]=255:r[n]<0&&(r[n]=0);return tk(r,r.length===4?"rgba":"rgb")}}function Rxe(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=xu(t[i]),s=xu(t[a]),l=n-i,u=tk([Wf(LC(o[0],s[0],l)),Wf(LC(o[1],s[1],l)),Wf(LC(o[2],s[2],l)),y$(LC(o[3],s[3],l))],"rgba");return r?{color:u,leftIndex:i,rightIndex:a,value:n}:u}}function tk(e,t){if(!(!e||!e.length)){var r=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+e[3]),t+"("+r+")"}}function eE(e,t){var r=xu(e);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*t:0}function kxe(e){return e.type==="linear"}function Axe(e){return e.type==="radial"}(function(){return nr.hasGlobalWindow&&Zt(window.btoa)?function(e){return window.btoa(unescape(encodeURIComponent(e)))}:typeof Buffer<"u"?function(e){return Buffer.from(e).toString("base64")}:function(e){return null}})();var b$=Array.prototype.slice;function Bl(e,t,r){return(t-e)*r+e}function cI(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=Bl(t[a],r[a],n);return e}function Pxe(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=Bl(t[o][s],r[o][s],n)}return e}function HC(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=t[a]+r[a]*n;return e}function r6(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=t[o][s]+r[o][s]*n}return e}function Ixe(e,t){for(var r=e.length,n=t.length,i=r>n?t:e,a=Math.min(r,n),o=i[a-1]||{color:[0,0,0,0],offset:0},s=a;s<Math.max(r,n);s++)i.push({offset:o.offset,color:o.color.slice()})}function Mxe(e,t,r){var n=e,i=t;if(!(!n.push||!i.push)){var a=n.length,o=i.length;if(a!==o){var s=a>o;if(s)n.length=o;else for(var l=a;l<o;l++)n.push(r===1?i[l]:b$.call(i[l]))}for(var u=n[0]&&n[0].length,l=0;l<n.length;l++)if(r===1)isNaN(n[l])&&(n[l]=i[l]);else for(var f=0;f<u;f++)isNaN(n[l][f])&&(n[l][f]=i[l][f])}}function jT(e){if(Ea(e)){var t=e.length;if(Ea(e[0])){for(var r=[],n=0;n<t;n++)r.push(b$.call(e[n]));return r}return b$.call(e)}return e}function UT(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=e[3]==null?1:e[3],"rgba("+e.join(",")+")"}function Dxe(e){return Ea(e&&e[0])?2:1}var BC=0,zT=1,Une=2,rb=3,w$=4,_$=5,n6=6;function i6(e){return e===w$||e===_$}function VC(e){return e===zT||e===Une}var o0=[0,0,0,0],$xe=function(){function e(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(t,r,n){this._needsSort=!0;var i=this.keyframes,a=i.length,o=!1,s=n6,l=r;if(Ea(r)){var u=Dxe(r);s=u,(u===1&&!Ur(r[0])||u===2&&!Ur(r[0][0]))&&(o=!0)}else if(Ur(r)&&!XO(r))s=BC;else if(bt(r))if(!isNaN(+r))s=BC;else{var f=xu(r);f&&(l=f,s=rb)}else if(QR(r)){var c=Ze({},l);c.colorStops=Rt(r.colorStops,function(d){return{offset:d.offset,color:xu(d.color)}}),kxe(r)?s=w$:Axe(r)&&(s=_$),l=c}a===0?this.valType=s:(s!==this.valType||s===n6)&&(o=!0),this.discrete=this.discrete||o;var h={time:t,value:l,rawValue:r,percent:0};return n&&(h.easing=n,h.easingFunc=Zt(n)?n:Nne[n]||Vne(n)),i.push(h),h},e.prototype.prepare=function(t,r){var n=this.keyframes;this._needsSort&&n.sort(function(g,y){return g.time-y.time});for(var i=this.valType,a=n.length,o=n[a-1],s=this.discrete,l=VC(i),u=i6(i),f=0;f<a;f++){var c=n[f],h=c.value,d=o.value;c.percent=c.time/t,s||(l&&f!==a-1?Mxe(h,d,i):u&&Ixe(h.colorStops,d.colorStops))}if(!s&&i!==_$&&r&&this.needsAnimate()&&r.needsAnimate()&&i===r.valType&&!r._finished){this._additiveTrack=r;for(var v=n[0].value,f=0;f<a;f++)i===BC?n[f].additiveValue=n[f].value-v:i===rb?n[f].additiveValue=HC([],n[f].value,v,-1):VC(i)&&(n[f].additiveValue=i===zT?HC([],n[f].value,v,-1):r6([],n[f].value,v,-1))}},e.prototype.step=function(t,r){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var n=this._additiveTrack!=null,i=n?"additiveValue":"value",a=this.valType,o=this.keyframes,s=o.length,l=this.propName,u=a===rb,f,c=this._lastFr,h=Math.min,d,v;if(s===1)d=v=o[0];else{if(r<0)f=0;else if(r<this._lastFrP){var g=h(c+1,s-1);for(f=g;f>=0&&!(o[f].percent<=r);f--);f=h(f,s-2)}else{for(f=c;f<s&&!(o[f].percent>r);f++);f=h(f-1,s-2)}v=o[f+1],d=o[f]}if(d&&v){this._lastFr=f,this._lastFrP=r;var y=v.percent-d.percent,b=y===0?1:h((r-d.percent)/y,1);v.easingFunc&&(b=v.easingFunc(b));var w=n?this._additiveValue:u?o0:t[l];if((VC(a)||u)&&!w&&(w=this._additiveValue=[]),this.discrete)t[l]=b<1?d.rawValue:v.rawValue;else if(VC(a))a===zT?cI(w,d[i],v[i],b):Pxe(w,d[i],v[i],b);else if(i6(a)){var _=d[i],x=v[i],T=a===w$;t[l]={type:T?"linear":"radial",x:Bl(_.x,x.x,b),y:Bl(_.y,x.y,b),colorStops:Rt(_.colorStops,function(E,M){var P=x.colorStops[M];return{offset:Bl(E.offset,P.offset,b),color:UT(cI([],E.color,P.color,b))}}),global:x.global},T?(t[l].x2=Bl(_.x2,x.x2,b),t[l].y2=Bl(_.y2,x.y2,b)):t[l].r=Bl(_.r,x.r,b)}else if(u)cI(w,d[i],v[i],b),n||(t[l]=UT(w));else{var O=Bl(d[i],v[i],b);n?this._additiveValue=O:t[l]=O}n&&this._addToTarget(t)}}},e.prototype._addToTarget=function(t){var r=this.valType,n=this.propName,i=this._additiveValue;r===BC?t[n]=t[n]+i:r===rb?(xu(t[n],o0),HC(o0,o0,i,1),t[n]=UT(o0)):r===zT?HC(t[n],t[n],i,1):r===Une&&r6(t[n],t[n],i,1)},e}(),Nxe=function(){function e(t,r,n,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=r,r&&i){DB("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=n}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(t){this._target=t},e.prototype.when=function(t,r,n){return this.whenWithKeys(t,r,sn(r),n)},e.prototype.whenWithKeys=function(t,r,n,i){for(var a=this._tracks,o=0;o<n.length;o++){var s=n[o],l=a[s];if(!l){l=a[s]=new $xe(s);var u=void 0,f=this._getAdditiveTrack(s);if(f){var c=f.keyframes,h=c[c.length-1];u=h&&h.value,f.valType===rb&&u&&(u=UT(u))}else u=this._target[s];if(u==null)continue;t>0&&l.addKeyframe(0,jT(u),i),this._trackKeys.push(s)}l.addKeyframe(t,jT(r[s]),i)}return this._maxTime=Math.max(this._maxTime,t),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var r=t.length,n=0;n<r;n++)t[n].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,r=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,r)for(var n=0;n<r.length;n++)r[n].call(this)},e.prototype._setTracksFinished=function(){for(var t=this._tracks,r=this._trackKeys,n=0;n<r.length;n++)t[r[n]].setFinished()},e.prototype._getAdditiveTrack=function(t){var r,n=this._additiveAnimators;if(n)for(var i=0;i<n.length;i++){var a=n[i].getTrack(t);a&&(r=a)}return r},e.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var r=this,n=[],i=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var o=this._trackKeys[a],s=this._tracks[o],l=this._getAdditiveTrack(o),u=s.keyframes,f=u.length;if(s.prepare(i,l),s.needsAnimate())if(!this._allowDiscrete&&s.discrete){var c=u[f-1];c&&(r._target[s.propName]=c.rawValue),s.setFinished()}else n.push(s)}if(n.length||this._force){var h=new Txe({life:i,loop:this._loop,delay:this._delay||0,onframe:function(d){r._started=2;var v=r._additiveAnimators;if(v){for(var g=!1,y=0;y<v.length;y++)if(v[y]._clip){g=!0;break}g||(r._additiveAnimators=null)}for(var y=0;y<n.length;y++)n[y].step(r._target,d);var b=r._onframeCbs;if(b)for(var y=0;y<b.length;y++)b[y](r._target,d)},ondestroy:function(){r._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),t&&h.setEasing(t)}else this._doneCallback();return this}},e.prototype.stop=function(t){if(this._clip){var r=this._clip;t&&r.onframe(1),this._abortedCallback()}},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},e.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},e.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(t){return this._tracks[t]},e.prototype.getTracks=function(){var t=this;return Rt(this._trackKeys,function(r){return t._tracks[r]})},e.prototype.stopTracks=function(t,r){if(!t.length||!this._clip)return!0;for(var n=this._tracks,i=this._trackKeys,a=0;a<t.length;a++){var o=n[t[a]];o&&!o.isFinished()&&(r?o.step(this._target,1):this._started===1&&o.step(this._target,0),o.setFinished())}for(var s=!0,a=0;a<i.length;a++)if(!n[i[a]].isFinished()){s=!1;break}return s&&this._abortedCallback(),s},e.prototype.saveTo=function(t,r,n){if(t){r=r||this._trackKeys;for(var i=0;i<r.length;i++){var a=r[i],o=this._tracks[a];if(!(!o||o.isFinished())){var s=o.keyframes,l=s[n?0:s.length-1];l&&(t[a]=jT(l.rawValue))}}}},e.prototype.__changeFinalValue=function(t,r){r=r||sn(t);for(var n=0;n<r.length;n++){var i=r[n],a=this._tracks[i];if(a){var o=a.keyframes;if(o.length>1){var s=o.pop();a.addKeyframe(s.time,t[i]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},e}();const BB=Nxe;function _p(){return new Date().getTime()}var Lxe=function(e){st(t,e);function t(r){var n=e.call(this)||this;return n._running=!1,n._time=0,n._pausedTime=0,n._pauseStart=0,n._paused=!1,r=r||{},n.stage=r.stage||{},n}return t.prototype.addClip=function(r){r.animation&&this.removeClip(r),this._head?(this._tail.next=r,r.prev=this._tail,r.next=null,this._tail=r):this._head=this._tail=r,r.animation=this},t.prototype.addAnimator=function(r){r.animation=this;var n=r.getClip();n&&this.addClip(n)},t.prototype.removeClip=function(r){if(r.animation){var n=r.prev,i=r.next;n?n.next=i:this._head=i,i?i.prev=n:this._tail=n,r.next=r.prev=r.animation=null}},t.prototype.removeAnimator=function(r){var n=r.getClip();n&&this.removeClip(n),r.animation=null},t.prototype.update=function(r){for(var n=_p()-this._pausedTime,i=n-this._time,a=this._head;a;){var o=a.next,s=a.step(n,i);s&&(a.ondestroy(),this.removeClip(a)),a=o}this._time=n,r||(this.trigger("frame",i),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var r=this;this._running=!0;function n(){r._running&&(g$(n),!r._paused&&r.update())}g$(n)},t.prototype.start=function(){this._running||(this._time=_p(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=_p(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=_p()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var r=this._head;r;){var n=r.next;r.prev=r.next=r.animation=null,r=n}this._head=this._tail=null},t.prototype.isFinished=function(){return this._head==null},t.prototype.animate=function(r,n){n=n||{},this.start();var i=new BB(r,n.loop);return this.addAnimator(i),i},t}(dl);const Fxe=Lxe;var Hxe=300,hI=nr.domSupported,dI=function(){var e=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t=["touchstart","touchend","touchmove"],r={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},n=Rt(e,function(i){var a=i.replace("mouse","pointer");return r.hasOwnProperty(a)?a:i});return{mouse:e,touch:t,pointer:n}}(),a6={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},o6=!1;function S$(e){var t=e.pointerType;return t==="pen"||t==="touch"}function Bxe(e){e.touching=!0,e.touchTimer!=null&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout(function(){e.touching=!1,e.touchTimer=null},700)}function vI(e){e&&(e.zrByTouch=!0)}function Vxe(e,t){return _o(e.dom,new Wxe(e,t),!0)}function zne(e,t){for(var r=t,n=!1;r&&r.nodeType!==9&&!(n=r.domBelongToZr||r!==t&&r===e.painterRoot);)r=r.parentNode;return n}var Wxe=function(){function e(t,r){this.stopPropagation=Ta,this.stopImmediatePropagation=Ta,this.preventDefault=Ta,this.type=r.type,this.target=this.currentTarget=t.dom,this.pointerType=r.pointerType,this.clientX=r.clientX,this.clientY=r.clientY}return e}(),ls={mousedown:function(e){e=_o(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=_o(this.dom,e);var t=this.__mayPointerCapture;t&&(e.zrX!==t[0]||e.zrY!==t[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=_o(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){e=_o(this.dom,e);var t=e.toElement||e.relatedTarget;zne(this,t)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){o6=!0,e=_o(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){o6||(e=_o(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){e=_o(this.dom,e),vI(e),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),ls.mousemove.call(this,e),ls.mousedown.call(this,e)},touchmove:function(e){e=_o(this.dom,e),vI(e),this.handler.processGesture(e,"change"),ls.mousemove.call(this,e)},touchend:function(e){e=_o(this.dom,e),vI(e),this.handler.processGesture(e,"end"),ls.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<Hxe&&ls.click.call(this,e)},pointerdown:function(e){ls.mousedown.call(this,e)},pointermove:function(e){S$(e)||ls.mousemove.call(this,e)},pointerup:function(e){ls.mouseup.call(this,e)},pointerout:function(e){S$(e)||ls.mouseout.call(this,e)}};ce(["click","dblclick","contextmenu"],function(e){ls[e]=function(t){t=_o(this.dom,t),this.trigger(e,t)}});var C$={pointermove:function(e){S$(e)||C$.mousemove.call(this,e)},pointerup:function(e){C$.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function jxe(e,t){var r=t.domHandlers;nr.pointerEventsSupported?ce(dI.pointer,function(n){GT(t,n,function(i){r[n].call(e,i)})}):(nr.touchEventsSupported&&ce(dI.touch,function(n){GT(t,n,function(i){r[n].call(e,i),Bxe(t)})}),ce(dI.mouse,function(n){GT(t,n,function(i){i=NB(i),t.touching||r[n].call(e,i)})}))}function Uxe(e,t){nr.pointerEventsSupported?ce(a6.pointer,r):nr.touchEventsSupported||ce(a6.mouse,r);function r(n){function i(a){a=NB(a),zne(e,a.target)||(a=Vxe(e,a),t.domHandlers[n].call(e,a))}GT(t,n,i,{capture:!0})}}function GT(e,t,r,n){e.mounted[t]=r,e.listenerOpts[t]=n,QCe(e.domTarget,t,r,n)}function pI(e){var t=e.mounted;for(var r in t)t.hasOwnProperty(r)&&exe(e.domTarget,r,t[r],e.listenerOpts[r]);e.mounted={}}var s6=function(){function e(t,r){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=r}return e}(),zxe=function(e){st(t,e);function t(r,n){var i=e.call(this)||this;return i.__pointerCapturing=!1,i.dom=r,i.painterRoot=n,i._localHandlerScope=new s6(r,ls),hI&&(i._globalHandlerScope=new s6(document,C$)),jxe(i,i._localHandlerScope),i}return t.prototype.dispose=function(){pI(this._localHandlerScope),hI&&pI(this._globalHandlerScope)},t.prototype.setCursor=function(r){this.dom.style&&(this.dom.style.cursor=r||"default")},t.prototype.__togglePointerCapture=function(r){if(this.__mayPointerCapture=null,hI&&+this.__pointerCapturing^+r){this.__pointerCapturing=r;var n=this._globalHandlerScope;r?Uxe(this,n):pI(n)}},t}(dl);const Gxe=zxe;var Gne=1;nr.hasGlobalWindow&&(Gne=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var tE=Gne,x$=.4,T$="#333",O$="#ccc",Yxe="#eee",l6=LB,u6=5e-5;function Vc(e){return e>u6||e<-u6}var Wc=[],Sv=[],gI=lw(),yI=Math.abs,VB=function(){function e(){}return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},e.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},e.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},e.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},e.prototype.needLocalTransform=function(){return Vc(this.rotation)||Vc(this.x)||Vc(this.y)||Vc(this.scaleX-1)||Vc(this.scaleY-1)||Vc(this.skewX)||Vc(this.skewY)},e.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,r=this.needLocalTransform(),n=this.transform;if(!(r||t)){n&&l6(n);return}n=n||lw(),r?this.getLocalTransform(n):l6(n),t&&(r?Ap(n,t,n):nxe(n,t)),this.transform=n,this._resolveGlobalScaleRatio(n)},e.prototype._resolveGlobalScaleRatio=function(t){var r=this.globalScaleRatio;if(r!=null&&r!==1){this.getGlobalScale(Wc);var n=Wc[0]<0?-1:1,i=Wc[1]<0?-1:1,a=((Wc[0]-n)*r+n)/Wc[0]||0,o=((Wc[1]-i)*r+i)/Wc[1]||0;t[0]*=a,t[1]*=a,t[2]*=o,t[3]*=o}this.invTransform=this.invTransform||lw(),HB(this.invTransform,t)},e.prototype.getComputedTransform=function(){for(var t=this,r=[];t;)r.push(t),t=t.parent;for(;t=r.pop();)t.updateTransform();return this.transform},e.prototype.setLocalTransform=function(t){if(t){var r=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],i=Math.atan2(t[1],t[0]),a=Math.PI/2+i-Math.atan2(t[3],t[2]);n=Math.sqrt(n)*Math.cos(a),r=Math.sqrt(r),this.skewX=a,this.skewY=0,this.rotation=-i,this.x=+t[4],this.y=+t[5],this.scaleX=r,this.scaleY=n,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,r=this.transform;t&&t.transform&&(Ap(Sv,t.invTransform,r),r=Sv);var n=this.originX,i=this.originY;(n||i)&&(gI[4]=n,gI[5]=i,Ap(Sv,r,gI),Sv[4]-=n,Sv[5]-=i,r=Sv),this.setLocalTransform(r)}},e.prototype.getGlobalScale=function(t){var r=this.transform;return t=t||[],r?(t[0]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),t[1]=Math.sqrt(r[2]*r[2]+r[3]*r[3]),r[0]<0&&(t[0]=-t[0]),r[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},e.prototype.transformCoordToLocal=function(t,r){var n=[t,r],i=this.invTransform;return i&&$o(n,n,i),n},e.prototype.transformCoordToGlobal=function(t,r){var n=[t,r],i=this.transform;return i&&$o(n,n,i),n},e.prototype.getLineScale=function(){var t=this.transform;return t&&yI(t[0]-1)>1e-10&&yI(t[3]-1)>1e-10?Math.sqrt(yI(t[0]*t[3]-t[2]*t[1])):1},e.prototype.copyTransform=function(t){Kxe(this,t)},e.getLocalTransform=function(t,r){r=r||[];var n=t.originX||0,i=t.originY||0,a=t.scaleX,o=t.scaleY,s=t.anchorX,l=t.anchorY,u=t.rotation||0,f=t.x,c=t.y,h=t.skewX?Math.tan(t.skewX):0,d=t.skewY?Math.tan(-t.skewY):0;if(n||i||s||l){var v=n+s,g=i+l;r[4]=-v*a-h*g*o,r[5]=-g*o-d*v*a}else r[4]=r[5]=0;return r[0]=a,r[3]=o,r[1]=d*a,r[2]=h*o,u&&FB(r,r,u),r[4]+=n+f,r[5]+=i+c,r},e.initDefaultProps=function(){var t=e.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),e}(),uw=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function Kxe(e,t){for(var r=0;r<uw.length;r++){var n=uw[r];e[n]=t[n]}}var f6={};function Ka(e,t){t=t||pd;var r=f6[t];r||(r=f6[t]=new HS(500));var n=r.get(e);return n==null&&(n=gm.measureText(e,t).width,r.put(e,n)),n}function c6(e,t,r,n){var i=Ka(e,t),a=jB(t),o=nb(0,i,r),s=dp(0,a,n),l=new Pr(o,s,i,a);return l}function WB(e,t,r,n){var i=((e||"")+"").split(`
`),a=i.length;if(a===1)return c6(i[0],t,r,n);for(var o=new Pr(0,0,0,0),s=0;s<i.length;s++){var l=c6(i[s],t,r,n);s===0?o.copy(l):o.union(l)}return o}function nb(e,t,r){return r==="right"?e-=t:r==="center"&&(e-=t/2),e}function dp(e,t,r){return r==="middle"?e-=t/2:r==="bottom"&&(e-=t),e}function jB(e){return Ka("国",e)}function lc(e,t){return typeof e=="string"?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function rE(e,t,r){var n=t.position||"inside",i=t.distance!=null?t.distance:5,a=r.height,o=r.width,s=a/2,l=r.x,u=r.y,f="left",c="top";if(n instanceof Array)l+=lc(n[0],r.width),u+=lc(n[1],r.height),f=null,c=null;else switch(n){case"left":l-=i,u+=s,f="right",c="middle";break;case"right":l+=i+o,u+=s,c="middle";break;case"top":l+=o/2,u-=i,f="center",c="bottom";break;case"bottom":l+=o/2,u+=a+i,f="center";break;case"inside":l+=o/2,u+=s,f="center",c="middle";break;case"insideLeft":l+=i,u+=s,c="middle";break;case"insideRight":l+=o-i,u+=s,f="right",c="middle";break;case"insideTop":l+=o/2,u+=i,f="center";break;case"insideBottom":l+=o/2,u+=a-i,f="center",c="bottom";break;case"insideTopLeft":l+=i,u+=i;break;case"insideTopRight":l+=o-i,u+=i,f="right";break;case"insideBottomLeft":l+=i,u+=a-i,c="bottom";break;case"insideBottomRight":l+=o-i,u+=a-i,f="right",c="bottom";break}return e=e||{},e.x=l,e.y=u,e.align=f,e.verticalAlign=c,e}var mI="__zr_normal__",bI=uw.concat(["ignore"]),Xxe=sc(uw,function(e,t){return e[t]=!0,e},{ignore:!1}),Cv={},qxe=new Pr(0,0,0,0),UB=function(){function e(t){this.id=xne(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return e.prototype._init=function(t){this.attr(t)},e.prototype.drift=function(t,r,n){switch(this.draggable){case"horizontal":r=0;break;case"vertical":t=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=r,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(t){var r=this._textContent;if(r&&(!r.ignore||t)){this.textConfig||(this.textConfig={});var n=this.textConfig,i=n.local,a=r.innerTransformable,o=void 0,s=void 0,l=!1;a.parent=i?this:null;var u=!1;if(a.copyTransform(r),n.position!=null){var f=qxe;n.layoutRect?f.copy(n.layoutRect):f.copy(this.getBoundingRect()),i||f.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(Cv,n,f):rE(Cv,n,f),a.x=Cv.x,a.y=Cv.y,o=Cv.align,s=Cv.verticalAlign;var c=n.origin;if(c&&n.rotation!=null){var h=void 0,d=void 0;c==="center"?(h=f.width*.5,d=f.height*.5):(h=lc(c[0],f.width),d=lc(c[1],f.height)),u=!0,a.originX=-a.x+h+(i?0:f.x),a.originY=-a.y+d+(i?0:f.y)}}n.rotation!=null&&(a.rotation=n.rotation);var v=n.offset;v&&(a.x+=v[0],a.y+=v[1],u||(a.originX=-v[0],a.originY=-v[1]));var g=n.inside==null?typeof n.position=="string"&&n.position.indexOf("inside")>=0:n.inside,y=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),b=void 0,w=void 0,_=void 0;g&&this.canBeInsideText()?(b=n.insideFill,w=n.insideStroke,(b==null||b==="auto")&&(b=this.getInsideTextFill()),(w==null||w==="auto")&&(w=this.getInsideTextStroke(b),_=!0)):(b=n.outsideFill,w=n.outsideStroke,(b==null||b==="auto")&&(b=this.getOutsideFill()),(w==null||w==="auto")&&(w=this.getOutsideStroke(b),_=!0)),b=b||"#000",(b!==y.fill||w!==y.stroke||_!==y.autoStroke||o!==y.align||s!==y.verticalAlign)&&(l=!0,y.fill=b,y.stroke=w,y.autoStroke=_,y.align=o,y.verticalAlign=s,r.setDefaultTextStyle(y)),r.__dirty|=za,l&&r.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(t){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?O$:T$},e.prototype.getOutsideStroke=function(t){var r=this.__zr&&this.__zr.getBackgroundColor(),n=typeof r=="string"&&xu(r);n||(n=[255,255,255,1]);for(var i=n[3],a=this.__zr.isDarkMode(),o=0;o<3;o++)n[o]=n[o]*i+(a?0:255)*(1-i);return n[3]=1,tk(n,"rgba")},e.prototype.traverse=function(t,r){},e.prototype.attrKV=function(t,r){t==="textConfig"?this.setTextConfig(r):t==="textContent"?this.setTextContent(r):t==="clipPath"?this.setClipPath(r):t==="extra"?(this.extra=this.extra||{},Ze(this.extra,r)):this[t]=r},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(t,r){if(typeof t=="string")this.attrKV(t,r);else if(Tt(t))for(var n=t,i=sn(n),a=0;a<i.length;a++){var o=i[a];this.attrKV(o,t[o])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var r=this._normalState,n=0;n<this.animators.length;n++){var i=this.animators[n],a=i.__fromStateTransition;if(!(i.getLoop()||a&&a!==mI)){var o=i.targetName,s=o?r[o]:r;i.saveTo(s)}}},e.prototype._innerSaveToNormal=function(t){var r=this._normalState;r||(r=this._normalState={}),t.textConfig&&!r.textConfig&&(r.textConfig=this.textConfig),this._savePrimaryToNormal(t,r,bI)},e.prototype._savePrimaryToNormal=function(t,r,n){for(var i=0;i<n.length;i++){var a=n[i];t[a]!=null&&!(a in r)&&(r[a]=this[a])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(t){return this.states[t]},e.prototype.ensureState=function(t){var r=this.states;return r[t]||(r[t]={}),r[t]},e.prototype.clearStates=function(t){this.useState(mI,!1,t)},e.prototype.useState=function(t,r,n,i){var a=t===mI,o=this.hasState();if(!(!o&&a)){var s=this.currentStates,l=this.stateTransition;if(!(Hr(s,t)>=0&&(r||s.length===1))){var u;if(this.stateProxy&&!a&&(u=this.stateProxy(t)),u||(u=this.states&&this.states[t]),!u&&!a){DB("State "+t+" not exists.");return}a||this.saveCurrentToNormalState(u);var f=!!(u&&u.hoverLayer||i);f&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,u,this._normalState,r,!n&&!this.__inHover&&l&&l.duration>0,l);var c=this._textContent,h=this._textGuide;return c&&c.useState(t,r,n,f),h&&h.useState(t,r,n,f),a?(this.currentStates=[],this._normalState={}):r?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!f&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~za),u}}},e.prototype.useStates=function(t,r,n){if(!t.length)this.clearStates();else{var i=[],a=this.currentStates,o=t.length,s=o===a.length;if(s){for(var l=0;l<o;l++)if(t[l]!==a[l]){s=!1;break}}if(s)return;for(var l=0;l<o;l++){var u=t[l],f=void 0;this.stateProxy&&(f=this.stateProxy(u,t)),f||(f=this.states[u]),f&&i.push(f)}var c=i[o-1],h=!!(c&&c.hoverLayer||n);h&&this._toggleHoverLayerFlag(!0);var d=this._mergeStates(i),v=this.stateTransition;this.saveCurrentToNormalState(d),this._applyStateObj(t.join(","),d,this._normalState,!1,!r&&!this.__inHover&&v&&v.duration>0,v);var g=this._textContent,y=this._textGuide;g&&g.useStates(t,r,h),y&&y.useStates(t,r,h),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~za)}},e.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var r=this.animators[t];r.targetName&&r.changeTarget(this[r.targetName])}},e.prototype.removeState=function(t){var r=Hr(this.currentStates,t);if(r>=0){var n=this.currentStates.slice();n.splice(r,1),this.useStates(n)}},e.prototype.replaceState=function(t,r,n){var i=this.currentStates.slice(),a=Hr(i,t),o=Hr(i,r)>=0;a>=0?o?i.splice(a,1):i[a]=r:n&&!o&&i.push(r),this.useStates(i)},e.prototype.toggleState=function(t,r){r?this.useState(t,!0):this.removeState(t)},e.prototype._mergeStates=function(t){for(var r={},n,i=0;i<t.length;i++){var a=t[i];Ze(r,a),a.textConfig&&(n=n||{},Ze(n,a.textConfig))}return n&&(r.textConfig=n),r},e.prototype._applyStateObj=function(t,r,n,i,a,o){var s=!(r&&i);r&&r.textConfig?(this.textConfig=Ze({},i?this.textConfig:n.textConfig),Ze(this.textConfig,r.textConfig)):s&&n.textConfig&&(this.textConfig=n.textConfig);for(var l={},u=!1,f=0;f<bI.length;f++){var c=bI[f],h=a&&Xxe[c];r&&r[c]!=null?h?(u=!0,l[c]=r[c]):this[c]=r[c]:s&&n[c]!=null&&(h?(u=!0,l[c]=n[c]):this[c]=n[c])}if(!a)for(var f=0;f<this.animators.length;f++){var d=this.animators[f],v=d.targetName;d.getLoop()||d.__changeFinalValue(v?(r||n)[v]:r||n)}u&&this._transitionState(t,l,o)},e.prototype._attachComponent=function(t){if(!(t.__zr&&!t.__hostTarget)&&t!==this){var r=this.__zr;r&&t.addSelfToZr(r),t.__zr=r,t.__hostTarget=this}},e.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},e.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(t){var r=this._textContent;r!==t&&(r&&r!==t&&this.removeTextContent(),t.innerTransformable=new VB,this._attachComponent(t),this._textContent=t,this.markRedraw())},e.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),Ze(this.textConfig,t),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=za;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var r=this._textContent,n=this._textGuide;r&&(r.__inHover=t),n&&(n.__inHover=t)},e.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.addAnimator(r[n]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.removeAnimator(r[n]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},e.prototype.animate=function(t,r,n){var i=t?this[t]:this,a=new BB(i,r,n);return t&&(a.targetName=t),this.addAnimator(a,t),a},e.prototype.addAnimator=function(t,r){var n=this.__zr,i=this;t.during(function(){i.updateDuringAnimation(r)}).done(function(){var a=i.animators,o=Hr(a,t);o>=0&&a.splice(o,1)}),this.animators.push(t),n&&n.animation.addAnimator(t),n&&n.wakeUp()},e.prototype.updateDuringAnimation=function(t){this.markRedraw()},e.prototype.stopAnimation=function(t,r){for(var n=this.animators,i=n.length,a=[],o=0;o<i;o++){var s=n[o];!t||t===s.scope?s.stop(r):a.push(s)}return this.animators=a,this},e.prototype.animateTo=function(t,r,n){wI(this,t,r,n)},e.prototype.animateFrom=function(t,r,n){wI(this,t,r,n,!0)},e.prototype._transitionState=function(t,r,n,i){for(var a=wI(this,r,n,i),o=0;o<a.length;o++)a[o].__fromStateTransition=t},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=za;function r(n,i,a,o){Object.defineProperty(t,n,{get:function(){if(!this[i]){var l=this[i]=[];s(this,l)}return this[i]},set:function(l){this[a]=l[0],this[o]=l[1],this[i]=l,s(this,l)}});function s(l,u){Object.defineProperty(u,0,{get:function(){return l[a]},set:function(f){l[a]=f}}),Object.defineProperty(u,1,{get:function(){return l[o]},set:function(f){l[o]=f}})}}Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),e}();hl(UB,dl);hl(UB,VB);function wI(e,t,r,n,i){r=r||{};var a=[];Yne(e,"",e,t,r,n,a,i);var o=a.length,s=!1,l=r.done,u=r.aborted,f=function(){s=!0,o--,o<=0&&(s?l&&l():u&&u())},c=function(){o--,o<=0&&(s?l&&l():u&&u())};o||l&&l(),a.length>0&&r.during&&a[0].during(function(v,g){r.during(g)});for(var h=0;h<a.length;h++){var d=a[h];f&&d.done(f),c&&d.aborted(c),r.force&&d.duration(r.duration),d.start(r.easing)}return a}function _I(e,t,r){for(var n=0;n<r;n++)e[n]=t[n]}function Zxe(e){return Ea(e[0])}function Jxe(e,t,r){if(Ea(t[r]))if(Ea(e[r])||(e[r]=[]),Xa(t[r])){var n=t[r].length;e[r].length!==n&&(e[r]=new t[r].constructor(n),_I(e[r],t[r],n))}else{var i=t[r],a=e[r],o=i.length;if(Zxe(i))for(var s=i[0].length,l=0;l<o;l++)a[l]?_I(a[l],i[l],s):a[l]=Array.prototype.slice.call(i[l]);else _I(a,i,o);a.length=i.length}else e[r]=t[r]}function Qxe(e,t){return e===t||Ea(e)&&Ea(t)&&eTe(e,t)}function eTe(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Yne(e,t,r,n,i,a,o,s){for(var l=sn(n),u=i.duration,f=i.delay,c=i.additive,h=i.setToFinal,d=!Tt(a),v=e.animators,g=[],y=0;y<l.length;y++){var b=l[y],w=n[b];if(w!=null&&r[b]!=null&&(d||a[b]))if(Tt(w)&&!Ea(w)&&!QR(w)){if(t){s||(r[b]=w,e.updateDuringAnimation(t));continue}Yne(e,b,r[b],w,i,a&&a[b],o,s)}else g.push(b);else s||(r[b]=w,e.updateDuringAnimation(t),g.push(b))}var _=g.length;if(!c&&_)for(var x=0;x<v.length;x++){var T=v[x];if(T.targetName===t){var O=T.stopTracks(g);if(O){var E=Hr(v,T);v.splice(E,1)}}}if(i.force||(g=Qi(g,function(D){return!Qxe(n[D],r[D])}),_=g.length),_>0||i.force&&!o.length){var M=void 0,P=void 0,N=void 0;if(s){P={},h&&(M={});for(var x=0;x<_;x++){var b=g[x];P[b]=r[b],h?M[b]=n[b]:r[b]=n[b]}}else if(h){N={};for(var x=0;x<_;x++){var b=g[x];N[b]=jT(r[b]),Jxe(r,n,b)}}var T=new BB(r,!1,!1,c?Qi(v,function(L){return L.targetName===t}):null);T.targetName=t,i.scope&&(T.scope=i.scope),h&&M&&T.whenWithKeys(0,M,g),N&&T.whenWithKeys(0,N,g),T.whenWithKeys(u??500,s?P:n,g).delay(f||0),e.addAnimator(T,t),o.push(T)}}const Kne=UB;var Xne=function(e){st(t,e);function t(r){var n=e.call(this)||this;return n.isGroup=!0,n._children=[],n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(r){return this._children[r]},t.prototype.childOfName=function(r){for(var n=this._children,i=0;i<n.length;i++)if(n[i].name===r)return n[i]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(r){return r&&r!==this&&r.parent!==this&&(this._children.push(r),this._doAdd(r)),this},t.prototype.addBefore=function(r,n){if(r&&r!==this&&r.parent!==this&&n&&n.parent===this){var i=this._children,a=i.indexOf(n);a>=0&&(i.splice(a,0,r),this._doAdd(r))}return this},t.prototype.replace=function(r,n){var i=Hr(this._children,r);return i>=0&&this.replaceAt(n,i),this},t.prototype.replaceAt=function(r,n){var i=this._children,a=i[n];if(r&&r!==this&&r.parent!==this&&r!==a){i[n]=r,a.parent=null;var o=this.__zr;o&&a.removeSelfFromZr(o),this._doAdd(r)}return this},t.prototype._doAdd=function(r){r.parent&&r.parent.remove(r),r.parent=this;var n=this.__zr;n&&n!==r.__zr&&r.addSelfToZr(n),n&&n.refresh()},t.prototype.remove=function(r){var n=this.__zr,i=this._children,a=Hr(i,r);return a<0?this:(i.splice(a,1),r.parent=null,n&&r.removeSelfFromZr(n),n&&n.refresh(),this)},t.prototype.removeAll=function(){for(var r=this._children,n=this.__zr,i=0;i<r.length;i++){var a=r[i];n&&a.removeSelfFromZr(n),a.parent=null}return r.length=0,this},t.prototype.eachChild=function(r,n){for(var i=this._children,a=0;a<i.length;a++){var o=i[a];r.call(n,o,a)}return this},t.prototype.traverse=function(r,n){for(var i=0;i<this._children.length;i++){var a=this._children[i],o=r.call(n,a);a.isGroup&&!o&&a.traverse(r,n)}return this},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.addSelfToZr(r)}},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.removeSelfFromZr(r)}},t.prototype.getBoundingRect=function(r){for(var n=new Pr(0,0,0,0),i=r||this._children,a=[],o=null,s=0;s<i.length;s++){var l=i[s];if(!(l.ignore||l.invisible)){var u=l.getBoundingRect(),f=l.getLocalTransform(a);f?(Pr.applyTransform(n,u,f),o=o||n.clone(),o.union(n)):(o=o||u.clone(),o.union(u))}}return o||n},t}(Kne);Xne.prototype.type="group";const Pi=Xne;/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var YT={},qne={};function tTe(e){delete qne[e]}function rTe(e){if(!e)return!1;if(typeof e=="string")return eE(e,1)<x$;if(e.colorStops){for(var t=e.colorStops,r=0,n=t.length,i=0;i<n;i++)r+=eE(t[i].color,1);return r/=n,r<x$}return!1}var nTe=function(){function e(t,r,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=r,this.id=t;var a=new yxe,o=n.renderer||"canvas";YT[o]||(o=sn(YT)[0]),n.useDirtyRect=n.useDirtyRect==null?!1:n.useDirtyRect;var s=new YT[o](r,a,n,t),l=n.ssr||s.ssrOnly;this.storage=a,this.painter=s;var u=!nr.node&&!nr.worker&&!l?new Gxe(s.getViewportRoot(),s.root):null,f=n.useCoarsePointer,c=f==null||f==="auto"?nr.touchEventsSupported:!!f,h=44,d;c&&(d=pr(n.pointerSize,h)),this.handler=new hxe(a,s,u,s.root,d),this.animation=new Fxe({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return e.prototype.add=function(t){t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},e.prototype.remove=function(t){t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(t,r){this.painter.configLayer&&this.painter.configLayer(t,r),this.refresh()},e.prototype.setBackgroundColor=function(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=rTe(t)},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(t){this._darkMode=t},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(t){t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},e.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},e.prototype.flush=function(){this._flush(!1)},e.prototype._flush=function(t){var r,n=_p();this._needsRefresh&&(r=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var i=_p();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},e.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover()},e.prototype.resize=function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},e.prototype.clearAnimation=function(){this.animation.clear()},e.prototype.getWidth=function(){return this.painter.getWidth()},e.prototype.getHeight=function(){return this.painter.getHeight()},e.prototype.setCursorStyle=function(t){this.handler.setCursorStyle(t)},e.prototype.findHover=function(t,r){return this.handler.findHover(t,r)},e.prototype.on=function(t,r,n){return this.handler.on(t,r,n),this},e.prototype.off=function(t,r){this.handler.off(t,r)},e.prototype.trigger=function(t,r){this.handler.trigger(t,r)},e.prototype.clear=function(){for(var t=this.storage.getRoots(),r=0;r<t.length;r++)t[r]instanceof Pi&&t[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},e.prototype.dispose=function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,tTe(this.id)},e}();function h6(e,t){var r=new nTe(xne(),e,t);return qne[r.id]=r,r}function iTe(e,t){YT[e]=t}var d6=1e-4,Zne=20;function aTe(e){return e.replace(/^\s+|\s+$/g,"")}function E$(e,t,r,n){var i=t[0],a=t[1],o=r[0],s=r[1],l=a-i,u=s-o;if(l===0)return u===0?o:(o+s)/2;if(n)if(l>0){if(e<=i)return o;if(e>=a)return s}else{if(e>=i)return o;if(e<=a)return s}else{if(e===i)return o;if(e===a)return s}return(e-i)/l*u+o}function on(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%";break}return bt(e)?aTe(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):e==null?NaN:+e}function jn(e,t,r){return t==null&&(t=10),t=Math.min(Math.max(0,t),Zne),e=(+e).toFixed(t),r?e:+e}function Yl(e){if(e=+e,isNaN(e))return 0;if(e>1e-14){for(var t=1,r=0;r<15;r++,t*=10)if(Math.round(e*t)/t===e)return r}return oTe(e)}function oTe(e){var t=e.toString().toLowerCase(),r=t.indexOf("e"),n=r>0?+t.slice(r+1):0,i=r>0?r:t.length,a=t.indexOf("."),o=a<0?0:i-1-a;return Math.max(0,o-n)}function sTe(e,t){var r=Math.log,n=Math.LN10,i=Math.floor(r(e[1]-e[0])/n),a=Math.round(r(Math.abs(t[1]-t[0]))/n),o=Math.min(Math.max(-i+a,0),20);return isFinite(o)?o:20}function lTe(e,t){var r=sc(e,function(d,v){return d+(isNaN(v)?0:v)},0);if(r===0)return[];for(var n=Math.pow(10,t),i=Rt(e,function(d){return(isNaN(d)?0:d)/r*n*100}),a=n*100,o=Rt(i,function(d){return Math.floor(d)}),s=sc(o,function(d,v){return d+v},0),l=Rt(i,function(d,v){return d-o[v]});s<a;){for(var u=Number.NEGATIVE_INFINITY,f=null,c=0,h=l.length;c<h;++c)l[c]>u&&(u=l[c],f=c);++o[f],l[f]=0,++s}return Rt(o,function(d){return d/n})}function uTe(e,t){var r=Math.max(Yl(e),Yl(t)),n=e+t;return r>Zne?n:jn(n,r)}function Jne(e){var t=Math.PI*2;return(e%t+t)%t}function nE(e){return e>-d6&&e<d6}var fTe=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Au(e){if(e instanceof Date)return e;if(bt(e)){var t=fTe.exec(e);if(!t)return new Date(NaN);if(t[8]){var r=+t[4]||0;return t[8].toUpperCase()!=="Z"&&(r-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,r,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}else return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}else if(e==null)return new Date(NaN);return new Date(Math.round(e))}function cTe(e){return Math.pow(10,zB(e))}function zB(e){if(e===0)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return e/Math.pow(10,t)>=10&&t++,t}function Qne(e,t){var r=zB(e),n=Math.pow(10,r),i=e/n,a;return t?i<1.5?a=1:i<2.5?a=2:i<4?a=3:i<7?a=5:a=10:i<1?a=1:i<2?a=2:i<3?a=3:i<5?a=5:a=10,e=a*n,r>=-20?+e.toFixed(r<0?-r:0):e}function iE(e){var t=parseFloat(e);return t==e&&(t!==0||!bt(e)||e.indexOf("x")<=0)?t:NaN}function hTe(e){return!isNaN(iE(e))}function eie(){return Math.round(Math.random()*9)}function tie(e,t){return t===0?e:tie(t,e%t)}function v6(e,t){return e==null?t:t==null?e:e*t/tie(e,t)}function Sa(e){throw new Error(e)}function p6(e,t,r){return(t-e)*r+e}var rie="series\0",dTe="\0_ec_\0";function na(e){return e instanceof Array?e:e==null?[]:[e]}function R$(e,t,r){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var n=0,i=r.length;n<i;n++){var a=r[n];!e.emphasis[t].hasOwnProperty(a)&&e[t].hasOwnProperty(a)&&(e.emphasis[t][a]=e[t][a])}}}var g6=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function BS(e){return Tt(e)&&!dt(e)&&!(e instanceof Date)?e.value:e}function vTe(e){return Tt(e)&&!(e instanceof Array)}function pTe(e,t,r){var n=r==="normalMerge",i=r==="replaceMerge",a=r==="replaceAll";e=e||[],t=(t||[]).slice();var o=ir();ce(t,function(l,u){if(!Tt(l)){t[u]=null;return}});var s=gTe(e,o,r);return(n||i)&&yTe(s,e,o,t),n&&mTe(s,t),n||i?bTe(s,t,i):a&&wTe(s,t),_Te(s),s}function gTe(e,t,r){var n=[];if(r==="replaceAll")return n;for(var i=0;i<e.length;i++){var a=e[i];a&&a.id!=null&&t.set(a.id,i),n.push({existing:r==="replaceMerge"||fw(a)?null:a,newOption:null,keyInfo:null,brandNew:null})}return n}function yTe(e,t,r,n){ce(n,function(i,a){if(!(!i||i.id==null)){var o=Cb(i.id),s=r.get(o);if(s!=null){var l=e[s];ku(!l.newOption,'Duplicated option on id "'+o+'".'),l.newOption=i,l.existing=t[s],n[a]=null}}})}function mTe(e,t){ce(t,function(r,n){if(!(!r||r.name==null))for(var i=0;i<e.length;i++){var a=e[i].existing;if(!e[i].newOption&&a&&(a.id==null||r.id==null)&&!fw(r)&&!fw(a)&&nie("name",a,r)){e[i].newOption=r,t[n]=null;return}}})}function bTe(e,t,r){ce(t,function(n){if(n){for(var i,a=0;(i=e[a])&&(i.newOption||fw(i.existing)||i.existing&&n.id!=null&&!nie("id",n,i.existing));)a++;i?(i.newOption=n,i.brandNew=r):e.push({newOption:n,brandNew:r,existing:null,keyInfo:null}),a++}})}function wTe(e,t){ce(t,function(r){e.push({newOption:r,brandNew:!0,existing:null,keyInfo:null})})}function _Te(e){var t=ir();ce(e,function(r){var n=r.existing;n&&t.set(n.id,r)}),ce(e,function(r){var n=r.newOption;ku(!n||n.id==null||!t.get(n.id)||t.get(n.id)===r,"id duplicates: "+(n&&n.id)),n&&n.id!=null&&t.set(n.id,r),!r.keyInfo&&(r.keyInfo={})}),ce(e,function(r,n){var i=r.existing,a=r.newOption,o=r.keyInfo;if(Tt(a)){if(o.name=a.name!=null?Cb(a.name):i?i.name:rie+n,i)o.id=Cb(i.id);else if(a.id!=null)o.id=Cb(a.id);else{var s=0;do o.id="\0"+o.name+"\0"+s++;while(t.get(o.id))}t.set(o.id,r)}})}function nie(e,t,r){var n=sl(t[e],null),i=sl(r[e],null);return n!=null&&i!=null&&n===i}function Cb(e){return sl(e,"")}function sl(e,t){return e==null?t:bt(e)?e:Ur(e)||l$(e)?e+"":t}function GB(e){var t=e.name;return!!(t&&t.indexOf(rie))}function fw(e){return e&&e.id!=null&&Cb(e.id).indexOf(dTe)===0}function STe(e,t,r){ce(e,function(n){var i=n.newOption;Tt(i)&&(n.keyInfo.mainType=t,n.keyInfo.subType=CTe(t,i,n.existing,r))})}function CTe(e,t,r,n){var i=t.type?t.type:r?r.subType:n.determineSubType(e,t);return i}function gd(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return dt(t.dataIndex)?Rt(t.dataIndex,function(r){return e.indexOfRawIndex(r)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return dt(t.name)?Rt(t.name,function(r){return e.indexOfName(r)}):e.indexOfName(t.name)}function zn(){var e="__ec_inner_"+xTe++;return function(t){return t[e]||(t[e]={})}}var xTe=eie();function SI(e,t,r){var n=YB(t,r),i=n.mainTypeSpecified,a=n.queryOptionMap,o=n.others,s=o,l=r?r.defaultMainType:null;return!i&&l&&a.set(l,{}),a.each(function(u,f){var c=VS(e,f,u,{useDefault:l===f,enableAll:r&&r.enableAll!=null?r.enableAll:!0,enableNone:r&&r.enableNone!=null?r.enableNone:!0});s[f+"Models"]=c.models,s[f+"Model"]=c.models[0]}),s}function YB(e,t){var r;if(bt(e)){var n={};n[e+"Index"]=0,r=n}else r=e;var i=ir(),a={},o=!1;return ce(r,function(s,l){if(l==="dataIndex"||l==="dataIndexInside"){a[l]=s;return}var u=l.match(/^(\w+)(Index|Id|Name)$/)||[],f=u[1],c=(u[2]||"").toLowerCase();if(!(!f||!c||t&&t.includeMainTypes&&Hr(t.includeMainTypes,f)<0)){o=o||!!f;var h=i.get(f)||i.set(f,{});h[c]=s}}),{mainTypeSpecified:o,queryOptionMap:i,others:a}}var ys={useDefault:!0,enableAll:!1,enableNone:!1};function VS(e,t,r,n){n=n||ys;var i=r.index,a=r.id,o=r.name,s={models:null,specified:i!=null||a!=null||o!=null};if(!s.specified){var l=void 0;return s.models=n.useDefault&&(l=e.getComponent(t))?[l]:[],s}return i==="none"||i===!1?(ku(n.enableNone,'`"none"` or `false` is not a valid value on index option.'),s.models=[],s):(i==="all"&&(ku(n.enableAll,'`"all"` is not a valid value on index option.'),i=a=o=null),s.models=e.queryComponents({mainType:t,index:i,id:a,name:o}),s)}function iie(e,t,r){e.setAttribute?e.setAttribute(t,r):e[t]=r}function TTe(e,t){return e.getAttribute?e.getAttribute(t):e[t]}function OTe(e){return e==="auto"?nr.domSupported?"html":"richText":e||"html"}function ETe(e,t,r,n,i){var a=t==null||t==="auto";if(n==null)return n;if(Ur(n)){var o=p6(r||0,n,i);return jn(o,a?Math.max(Yl(r||0),Yl(n)):t)}else{if(bt(n))return i<1?r:n;for(var s=[],l=r,u=n,f=Math.max(l?l.length:0,u.length),c=0;c<f;++c){var h=e.getDimensionInfo(c);if(h&&h.type==="ordinal")s[c]=(i<1&&l?l:u)[c];else{var d=l&&l[c]?l[c]:0,v=u[c],o=p6(d,v,i);s[c]=jn(o,a?Math.max(Yl(d),Yl(v)):t)}}return s}}var RTe=".",jc="___EC__COMPONENT__CONTAINER___",aie="___EC__EXTENDED_CLASS___";function ol(e){var t={main:"",sub:""};if(e){var r=e.split(RTe);t.main=r[0]||"",t.sub=r[1]||""}return t}function kTe(e){ku(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function ATe(e){return!!(e&&e[aie])}function KB(e,t){e.$constructor=e,e.extend=function(r){var n=this,i;return PTe(n)?i=function(a){st(o,a);function o(){return a.apply(this,arguments)||this}return o}(n):(i=function(){(r.$constructor||n).apply(this,arguments)},ECe(i,this)),Ze(i.prototype,r),i[aie]=!0,i.extend=this.extend,i.superCall=DTe,i.superApply=$Te,i.superClass=n,i}}function PTe(e){return Zt(e)&&/^class\s/.test(Function.prototype.toString.call(e))}function oie(e,t){e.extend=t.extend}var ITe=Math.round(Math.random()*10);function MTe(e){var t=["__\0is_clz",ITe++].join("_");e.prototype[t]=!0,e.isInstance=function(r){return!!(r&&r[t])}}function DTe(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.superClass.prototype[t].apply(e,r)}function $Te(e,t,r){return this.superClass.prototype[t].apply(e,r)}function rk(e){var t={};e.registerClass=function(n){var i=n.type||n.prototype.type;if(i){kTe(i),n.prototype.type=i;var a=ol(i);if(!a.sub)t[a.main]=n;else if(a.sub!==jc){var o=r(a);o[a.sub]=n}}return n},e.getClass=function(n,i,a){var o=t[n];if(o&&o[jc]&&(o=i?o[i]:null),a&&!o)throw new Error(i?"Component "+n+"."+(i||"")+" is used but not imported.":n+".type should be specified.");return o},e.getClassesByMainType=function(n){var i=ol(n),a=[],o=t[i.main];return o&&o[jc]?ce(o,function(s,l){l!==jc&&a.push(s)}):a.push(o),a},e.hasClass=function(n){var i=ol(n);return!!t[i.main]},e.getAllClassMainTypes=function(){var n=[];return ce(t,function(i,a){n.push(a)}),n},e.hasSubTypes=function(n){var i=ol(n),a=t[i.main];return a&&a[jc]};function r(n){var i=t[n.main];return(!i||!i[jc])&&(i=t[n.main]={},i[jc]=!0),i}}function cw(e,t){for(var r=0;r<e.length;r++)e[r][1]||(e[r][1]=e[r][0]);return t=t||!1,function(n,i,a){for(var o={},s=0;s<e.length;s++){var l=e[s][1];if(!(i&&Hr(i,l)>=0||a&&Hr(a,l)<0)){var u=n.getShallow(l,t);u!=null&&(o[e[s][0]]=u)}}return o}}var NTe=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],LTe=cw(NTe),FTe=function(){function e(){}return e.prototype.getAreaStyle=function(t,r){return LTe(this,t,r)},e}(),k$=new HS(50);function HTe(e){if(typeof e=="string"){var t=k$.get(e);return t&&t.image}else return e}function sie(e,t,r,n,i){if(e)if(typeof e=="string"){if(t&&t.__zrImageSrc===e||!r)return t;var a=k$.get(e),o={hostEl:r,cb:n,cbPayload:i};return a?(t=a.image,!nk(t)&&a.pending.push(o)):(t=gm.loadImage(e,y6,y6),t.__zrImageSrc=e,k$.put(e,t.__cachedImgObj={image:t,pending:[o]})),t}else return e;else return t}function y6(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var r=e.pending[t],n=r.cb;n&&n(this,r.cbPayload),r.hostEl.dirty()}e.pending.length=0}function nk(e){return e&&e.width&&e.height}var CI=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function BTe(e,t,r,n,i){if(!t)return"";var a=(e+"").split(`
`);i=lie(t,r,n,i);for(var o=0,s=a.length;o<s;o++)a[o]=uie(a[o],i);return a.join(`
`)}function lie(e,t,r,n){n=n||{};var i=Ze({},n);i.font=t,r=pr(r,"..."),i.maxIterations=pr(n.maxIterations,2);var a=i.minChar=pr(n.minChar,0);i.cnCharWidth=Ka("国",t);var o=i.ascCharWidth=Ka("a",t);i.placeholder=pr(n.placeholder,"");for(var s=e=Math.max(0,e-1),l=0;l<a&&s>=o;l++)s-=o;var u=Ka(r,t);return u>s&&(r="",u=0),s=e-u,i.ellipsis=r,i.ellipsisWidth=u,i.contentWidth=s,i.containerWidth=e,i}function uie(e,t){var r=t.containerWidth,n=t.font,i=t.contentWidth;if(!r)return"";var a=Ka(e,n);if(a<=r)return e;for(var o=0;;o++){if(a<=i||o>=t.maxIterations){e+=t.ellipsis;break}var s=o===0?VTe(e,i,t.ascCharWidth,t.cnCharWidth):a>0?Math.floor(e.length*i/a):0;e=e.substr(0,s),a=Ka(e,n)}return e===""&&(e=t.placeholder),e}function VTe(e,t,r,n){for(var i=0,a=0,o=e.length;a<o&&i<t;a++){var s=e.charCodeAt(a);i+=0<=s&&s<=127?r:n}return a}function WTe(e,t){e!=null&&(e+="");var r=t.overflow,n=t.padding,i=t.font,a=r==="truncate",o=jB(i),s=pr(t.lineHeight,o),l=!!t.backgroundColor,u=t.lineOverflow==="truncate",f=t.width,c;f!=null&&(r==="break"||r==="breakAll")?c=e?fie(e,t.font,f,r==="breakAll",0).lines:[]:c=e?e.split(`
`):[];var h=c.length*s,d=pr(t.height,h);if(h>d&&u){var v=Math.floor(d/s);c=c.slice(0,v)}if(e&&a&&f!=null)for(var g=lie(f,i,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),y=0;y<c.length;y++)c[y]=uie(c[y],g);for(var b=d,w=0,y=0;y<c.length;y++)w=Math.max(Ka(c[y],i),w);f==null&&(f=w);var _=w;return n&&(b+=n[0]+n[2],_+=n[1]+n[3],f+=n[1]+n[3]),l&&(_=f),{lines:c,height:d,outerWidth:_,outerHeight:b,lineHeight:s,calculatedLineHeight:o,contentWidth:w,contentHeight:h,width:f}}var jTe=function(){function e(){}return e}(),m6=function(){function e(t){this.tokens=[],t&&(this.tokens=t)}return e}(),UTe=function(){function e(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return e}();function zTe(e,t){var r=new UTe;if(e!=null&&(e+=""),!e)return r;for(var n=t.width,i=t.height,a=t.overflow,o=(a==="break"||a==="breakAll")&&n!=null?{width:n,accumWidth:0,breakAll:a==="breakAll"}:null,s=CI.lastIndex=0,l;(l=CI.exec(e))!=null;){var u=l.index;u>s&&xI(r,e.substring(s,u),t,o),xI(r,l[2],t,o,l[1]),s=CI.lastIndex}s<e.length&&xI(r,e.substring(s,e.length),t,o);var f=[],c=0,h=0,d=t.padding,v=a==="truncate",g=t.lineOverflow==="truncate";function y(U,C,R){U.width=C,U.lineHeight=R,c+=R,h=Math.max(h,C)}e:for(var b=0;b<r.lines.length;b++){for(var w=r.lines[b],_=0,x=0,T=0;T<w.tokens.length;T++){var O=w.tokens[T],E=O.styleName&&t.rich[O.styleName]||{},M=O.textPadding=E.padding,P=M?M[1]+M[3]:0,N=O.font=E.font||t.font;O.contentHeight=jB(N);var D=pr(E.height,O.contentHeight);if(O.innerHeight=D,M&&(D+=M[0]+M[2]),O.height=D,O.lineHeight=wb(E.lineHeight,t.lineHeight,D),O.align=E&&E.align||t.align,O.verticalAlign=E&&E.verticalAlign||"middle",g&&i!=null&&c+O.lineHeight>i){T>0?(w.tokens=w.tokens.slice(0,T),y(w,x,_),r.lines=r.lines.slice(0,b+1)):r.lines=r.lines.slice(0,b);break e}var L=E.width,V=L==null||L==="auto";if(typeof L=="string"&&L.charAt(L.length-1)==="%")O.percentWidth=L,f.push(O),O.contentWidth=Ka(O.text,N);else{if(V){var ee=E.backgroundColor,ie=ee&&ee.image;ie&&(ie=HTe(ie),nk(ie)&&(O.width=Math.max(O.width,ie.width*D/ie.height)))}var le=v&&n!=null?n-x:null;le!=null&&le<O.width?!V||le<P?(O.text="",O.width=O.contentWidth=0):(O.text=BTe(O.text,le-P,N,t.ellipsis,{minChar:t.truncateMinChar}),O.width=O.contentWidth=Ka(O.text,N)):O.contentWidth=Ka(O.text,N)}O.width+=P,x+=O.width,E&&(_=Math.max(_,O.lineHeight))}y(w,x,_)}r.outerWidth=r.width=pr(n,h),r.outerHeight=r.height=pr(i,c),r.contentHeight=c,r.contentWidth=h,d&&(r.outerWidth+=d[1]+d[3],r.outerHeight+=d[0]+d[2]);for(var b=0;b<f.length;b++){var O=f[b],_e=O.percentWidth;O.width=parseInt(_e,10)/100*r.width}return r}function xI(e,t,r,n,i){var a=t==="",o=i&&r.rich[i]||{},s=e.lines,l=o.font||r.font,u=!1,f,c;if(n){var h=o.padding,d=h?h[1]+h[3]:0;if(o.width!=null&&o.width!=="auto"){var v=lc(o.width,n.width)+d;s.length>0&&v+n.accumWidth>n.width&&(f=t.split(`
`),u=!0),n.accumWidth=v}else{var g=fie(t,l,n.width,n.breakAll,n.accumWidth);n.accumWidth=g.accumWidth+d,c=g.linesWidths,f=g.lines}}else f=t.split(`
`);for(var y=0;y<f.length;y++){var b=f[y],w=new jTe;if(w.styleName=i,w.text=b,w.isLineHolder=!b&&!a,typeof o.width=="number"?w.width=o.width:w.width=c?c[y]:Ka(b,l),!y&&!u){var _=(s[s.length-1]||(s[0]=new m6)).tokens,x=_.length;x===1&&_[0].isLineHolder?_[0]=w:(b||!x||a)&&_.push(w)}else s.push(new m6([w]))}}function GTe(e){var t=e.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var YTe=sc(",&?/;] ".split(""),function(e,t){return e[t]=!0,e},{});function KTe(e){return GTe(e)?!!YTe[e]:!0}function fie(e,t,r,n,i){for(var a=[],o=[],s="",l="",u=0,f=0,c=0;c<e.length;c++){var h=e.charAt(c);if(h===`
`){l&&(s+=l,f+=u),a.push(s),o.push(f),s="",l="",u=0,f=0;continue}var d=Ka(h,t),v=n?!1:!KTe(h);if(a.length?f+d>r:i+f+d>r){f?(s||l)&&(v?(s||(s=l,l="",u=0,f=u),a.push(s),o.push(f-u),l+=h,u+=d,s="",f=u):(l&&(s+=l,l="",u=0),a.push(s),o.push(f),s=h,f=d)):v?(a.push(l),o.push(u),l=h,u=d):(a.push(h),o.push(d));continue}f+=d,v?(l+=h,u+=d):(l&&(s+=l,l="",u=0),s+=h)}return!a.length&&!s&&(s=e,l="",u=0),l&&(s+=l),s&&(a.push(s),o.push(f)),a.length===1&&(f+=i),{accumWidth:f,lines:a,linesWidths:o}}var A$="__zr_style_"+Math.round(Math.random()*10),od={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},ik={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};od[A$]=!0;var b6=["z","z2","invisible"],XTe=["invisible"],qTe=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype._init=function(r){for(var n=sn(r),i=0;i<n.length;i++){var a=n[i];a==="style"?this.useStyle(r[a]):e.prototype.attrKV.call(this,a,r[a])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(r,n,i,a){var o=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&ZTe(this,r,n)||o&&!o[0]&&!o[3])return!1;if(i&&this.__clipPaths){for(var s=0;s<this.__clipPaths.length;++s)if(this.__clipPaths[s].isZeroArea())return!1}if(a&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},t.prototype.contain=function(r,n){return this.rectContain(r,n)},t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.rectContain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();return a.contain(i[0],i[1])},t.prototype.getPaintRect=function(){var r=this._paintRect;if(!this._paintRect||this.__dirty){var n=this.transform,i=this.getBoundingRect(),a=this.style,o=a.shadowBlur||0,s=a.shadowOffsetX||0,l=a.shadowOffsetY||0;r=this._paintRect||(this._paintRect=new Pr(0,0,0,0)),n?Pr.applyTransform(r,i,n):r.copy(i),(o||s||l)&&(r.width+=o*2+Math.abs(s),r.height+=o*2+Math.abs(l),r.x=Math.min(r.x,r.x+s-o),r.y=Math.min(r.y,r.y+l-o));var u=this.dirtyRectTolerance;r.isZero()||(r.x=Math.floor(r.x-u),r.y=Math.floor(r.y-u),r.width=Math.ceil(r.width+1+u*2),r.height=Math.ceil(r.height+1+u*2))}return r},t.prototype.setPrevPaintRect=function(r){r?(this._prevPaintRect=this._prevPaintRect||new Pr(0,0,0,0),this._prevPaintRect.copy(r)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(r){return this.animate("style",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(r,n){r!=="style"?e.prototype.attrKV.call(this,r,n):this.style?this.setStyle(n):this.useStyle(n)},t.prototype.setStyle=function(r,n){return typeof r=="string"?this.style[r]=n:Ze(this.style,r),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(r){r||this.markRedraw(),this.__dirty|=tb,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&tb)},t.prototype.styleUpdated=function(){this.__dirty&=~tb},t.prototype.createStyle=function(r){return ek(od,r)},t.prototype.useStyle=function(r){r[A$]||(r=this.createStyle(r)),this.__inHover?this.__hoverStyle=r:this.style=r,this.dirtyStyle()},t.prototype.isStyleObject=function(r){return r[A$]},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(r,n,b6)},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.style?o?a?u=n.style:(u=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(u,n.style)):(u=this._mergeStyle(this.createStyle(),a?this.style:i.style),this._mergeStyle(u,n.style)):l&&(u=i.style),u)if(o){var f=this.style;if(this.style=this.createStyle(l?{}:f),l)for(var c=sn(f),h=0;h<c.length;h++){var d=c[h];d in u&&(u[d]=u[d],this.style[d]=f[d])}for(var v=sn(u),h=0;h<v.length;h++){var d=v[h];this.style[d]=this.style[d]}this._transitionState(r,{style:u},s,this.getAnimationStyleProps())}else this.useStyle(u);for(var g=this.__inHover?XTe:b6,h=0;h<g.length;h++){var d=g[h];n&&n[d]!=null?this[d]=n[d]:l&&i[d]!=null&&(this[d]=i[d])}},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.style&&(i=i||{},this._mergeStyle(i,o.style))}return i&&(n.style=i),n},t.prototype._mergeStyle=function(r,n){return Ze(r,n),r},t.prototype.getAnimationStyleProps=function(){return ik},t.initDefaultProps=function(){var r=t.prototype;r.type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,r.__dirty=za|tb}(),t}(Kne),TI=new Pr(0,0,0,0),OI=new Pr(0,0,0,0);function ZTe(e,t,r){return TI.copy(e.getBoundingRect()),e.transform&&TI.applyTransform(e.transform),OI.width=t,OI.height=r,!TI.intersect(OI)}const WS=qTe;var Ro=Math.min,ko=Math.max,EI=Math.sin,RI=Math.cos,Uc=Math.PI*2,WC=ym(),jC=ym(),UC=ym();function w6(e,t,r,n,i,a){i[0]=Ro(e,r),i[1]=Ro(t,n),a[0]=ko(e,r),a[1]=ko(t,n)}var _6=[],S6=[];function JTe(e,t,r,n,i,a,o,s,l,u){var f=Hne,c=qn,h=f(e,r,i,o,_6);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<h;d++){var v=c(e,r,i,o,_6[d]);l[0]=Ro(v,l[0]),u[0]=ko(v,u[0])}h=f(t,n,a,s,S6);for(var d=0;d<h;d++){var g=c(t,n,a,s,S6[d]);l[1]=Ro(g,l[1]),u[1]=ko(g,u[1])}l[0]=Ro(e,l[0]),u[0]=ko(e,u[0]),l[0]=Ro(o,l[0]),u[0]=ko(o,u[0]),l[1]=Ro(t,l[1]),u[1]=ko(t,u[1]),l[1]=Ro(s,l[1]),u[1]=ko(s,u[1])}function QTe(e,t,r,n,i,a,o,s){var l=Bne,u=Si,f=ko(Ro(l(e,r,i),1),0),c=ko(Ro(l(t,n,a),1),0),h=u(e,r,i,f),d=u(t,n,a,c);o[0]=Ro(e,i,h),o[1]=Ro(t,a,d),s[0]=ko(e,i,h),s[1]=ko(t,a,d)}function eOe(e,t,r,n,i,a,o,s,l){var u=bp,f=wp,c=Math.abs(i-a);if(c%Uc<1e-4&&c>1e-4){s[0]=e-r,s[1]=t-n,l[0]=e+r,l[1]=t+n;return}if(WC[0]=RI(i)*r+e,WC[1]=EI(i)*n+t,jC[0]=RI(a)*r+e,jC[1]=EI(a)*n+t,u(s,WC,jC),f(l,WC,jC),i=i%Uc,i<0&&(i=i+Uc),a=a%Uc,a<0&&(a=a+Uc),i>a&&!o?a+=Uc:i<a&&o&&(i+=Uc),o){var h=a;a=i,i=h}for(var d=0;d<a;d+=Math.PI/2)d>i&&(UC[0]=RI(d)*r+e,UC[1]=EI(d)*n+t,u(s,UC,s),f(l,UC,l))}var Rr={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},zc=[],Gc=[],$s=[],of=[],Ns=[],Ls=[],kI=Math.min,AI=Math.max,Yc=Math.cos,Kc=Math.sin,Il=Math.abs,P$=Math.PI,Cf=P$*2,PI=typeof Float32Array<"u",s0=[];function II(e){var t=Math.round(e/P$*1e8)/1e8;return t%2*P$}function tOe(e,t){var r=II(e[0]);r<0&&(r+=Cf);var n=r-e[0],i=e[1];i+=n,!t&&i-r>=Cf?i=r+Cf:t&&r-i>=Cf?i=r-Cf:!t&&r>i?i=r+(Cf-II(r-i)):t&&r<i&&(i=r-(Cf-II(i-r))),e[0]=r,e[1]=i}var rOe=function(){function e(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(t,r,n){n=n||0,n>0&&(this._ux=Il(n/tE/t)||0,this._uy=Il(n/tE/r)||0)},e.prototype.setDPR=function(t){this.dpr=t},e.prototype.setContext=function(t){this._ctx=t},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(t,r){return this._drawPendingPt(),this.addData(Rr.M,t,r),this._ctx&&this._ctx.moveTo(t,r),this._x0=t,this._y0=r,this._xi=t,this._yi=r,this},e.prototype.lineTo=function(t,r){var n=Il(t-this._xi),i=Il(r-this._yi),a=n>this._ux||i>this._uy;if(this.addData(Rr.L,t,r),this._ctx&&a&&this._ctx.lineTo(t,r),a)this._xi=t,this._yi=r,this._pendingPtDist=0;else{var o=n*n+i*i;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=r,this._pendingPtDist=o)}return this},e.prototype.bezierCurveTo=function(t,r,n,i,a,o){return this._drawPendingPt(),this.addData(Rr.C,t,r,n,i,a,o),this._ctx&&this._ctx.bezierCurveTo(t,r,n,i,a,o),this._xi=a,this._yi=o,this},e.prototype.quadraticCurveTo=function(t,r,n,i){return this._drawPendingPt(),this.addData(Rr.Q,t,r,n,i),this._ctx&&this._ctx.quadraticCurveTo(t,r,n,i),this._xi=n,this._yi=i,this},e.prototype.arc=function(t,r,n,i,a,o){this._drawPendingPt(),s0[0]=i,s0[1]=a,tOe(s0,o),i=s0[0],a=s0[1];var s=a-i;return this.addData(Rr.A,t,r,n,n,i,s,0,o?0:1),this._ctx&&this._ctx.arc(t,r,n,i,a,o),this._xi=Yc(a)*n+t,this._yi=Kc(a)*n+r,this},e.prototype.arcTo=function(t,r,n,i,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,r,n,i,a),this},e.prototype.rect=function(t,r,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,r,n,i),this.addData(Rr.R,t,r,n,i),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(Rr.Z);var t=this._ctx,r=this._x0,n=this._y0;return t&&t.closePath(),this._xi=r,this._yi=n,this},e.prototype.fill=function(t){t&&t.fill(),this.toStatic()},e.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(t){var r=t.length;!(this.data&&this.data.length===r)&&PI&&(this.data=new Float32Array(r));for(var n=0;n<r;n++)this.data[n]=t[n];this._len=r},e.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var r=t.length,n=0,i=this._len,a=0;a<r;a++)n+=t[a].len();PI&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(var a=0;a<r;a++)for(var o=t[a].data,s=0;s<o.length;s++)this.data[i++]=o[s];this._len=i},e.prototype.addData=function(t,r,n,i,a,o,s,l,u){if(this._saveData){var f=this.data;this._len+arguments.length>f.length&&(this._expandData(),f=this.data);for(var c=0;c<arguments.length;c++)f[this._len++]=arguments[c]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],r=0;r<this._len;r++)t[r]=this.data[r];this.data=t}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,PI&&this._len>11&&(this.data=new Float32Array(t)))}},e.prototype.getBoundingRect=function(){$s[0]=$s[1]=Ns[0]=Ns[1]=Number.MAX_VALUE,of[0]=of[1]=Ls[0]=Ls[1]=-Number.MAX_VALUE;var t=this.data,r=0,n=0,i=0,a=0,o;for(o=0;o<this._len;){var s=t[o++],l=o===1;switch(l&&(r=t[o],n=t[o+1],i=r,a=n),s){case Rr.M:r=i=t[o++],n=a=t[o++],Ns[0]=i,Ns[1]=a,Ls[0]=i,Ls[1]=a;break;case Rr.L:w6(r,n,t[o],t[o+1],Ns,Ls),r=t[o++],n=t[o++];break;case Rr.C:JTe(r,n,t[o++],t[o++],t[o++],t[o++],t[o],t[o+1],Ns,Ls),r=t[o++],n=t[o++];break;case Rr.Q:QTe(r,n,t[o++],t[o++],t[o],t[o+1],Ns,Ls),r=t[o++],n=t[o++];break;case Rr.A:var u=t[o++],f=t[o++],c=t[o++],h=t[o++],d=t[o++],v=t[o++]+d;o+=1;var g=!t[o++];l&&(i=Yc(d)*c+u,a=Kc(d)*h+f),eOe(u,f,c,h,d,v,g,Ns,Ls),r=Yc(v)*c+u,n=Kc(v)*h+f;break;case Rr.R:i=r=t[o++],a=n=t[o++];var y=t[o++],b=t[o++];w6(i,a,i+y,a+b,Ns,Ls);break;case Rr.Z:r=i,n=a;break}bp($s,$s,Ns),wp(of,of,Ls)}return o===0&&($s[0]=$s[1]=of[0]=of[1]=0),new Pr($s[0],$s[1],of[0]-$s[0],of[1]-$s[1])},e.prototype._calculateLength=function(){var t=this.data,r=this._len,n=this._ux,i=this._uy,a=0,o=0,s=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var u=this._pathSegLen,f=0,c=0,h=0;h<r;){var d=t[h++],v=h===1;v&&(a=t[h],o=t[h+1],s=a,l=o);var g=-1;switch(d){case Rr.M:a=s=t[h++],o=l=t[h++];break;case Rr.L:{var y=t[h++],b=t[h++],w=y-a,_=b-o;(Il(w)>n||Il(_)>i||h===r-1)&&(g=Math.sqrt(w*w+_*_),a=y,o=b);break}case Rr.C:{var x=t[h++],T=t[h++],y=t[h++],b=t[h++],O=t[h++],E=t[h++];g=bxe(a,o,x,T,y,b,O,E,10),a=O,o=E;break}case Rr.Q:{var x=t[h++],T=t[h++],y=t[h++],b=t[h++];g=Sxe(a,o,x,T,y,b,10),a=y,o=b;break}case Rr.A:var M=t[h++],P=t[h++],N=t[h++],D=t[h++],L=t[h++],V=t[h++],ee=V+L;h+=1,t[h++],v&&(s=Yc(L)*N+M,l=Kc(L)*D+P),g=AI(N,D)*kI(Cf,Math.abs(V)),a=Yc(ee)*N+M,o=Kc(ee)*D+P;break;case Rr.R:{s=a=t[h++],l=o=t[h++];var ie=t[h++],le=t[h++];g=ie*2+le*2;break}case Rr.Z:{var w=s-a,_=l-o;g=Math.sqrt(w*w+_*_),a=s,o=l;break}}g>=0&&(u[c++]=g,f+=g)}return this._pathLen=f,f},e.prototype.rebuildPath=function(t,r){var n=this.data,i=this._ux,a=this._uy,o=this._len,s,l,u,f,c,h,d=r<1,v,g,y=0,b=0,w,_=0,x,T;if(!(d&&(this._pathSegLen||this._calculateLength(),v=this._pathSegLen,g=this._pathLen,w=r*g,!w)))e:for(var O=0;O<o;){var E=n[O++],M=O===1;switch(M&&(u=n[O],f=n[O+1],s=u,l=f),E!==Rr.L&&_>0&&(t.lineTo(x,T),_=0),E){case Rr.M:s=u=n[O++],l=f=n[O++],t.moveTo(u,f);break;case Rr.L:{c=n[O++],h=n[O++];var P=Il(c-u),N=Il(h-f);if(P>i||N>a){if(d){var D=v[b++];if(y+D>w){var L=(w-y)/D;t.lineTo(u*(1-L)+c*L,f*(1-L)+h*L);break e}y+=D}t.lineTo(c,h),u=c,f=h,_=0}else{var V=P*P+N*N;V>_&&(x=c,T=h,_=V)}break}case Rr.C:{var ee=n[O++],ie=n[O++],le=n[O++],_e=n[O++],U=n[O++],C=n[O++];if(d){var D=v[b++];if(y+D>w){var L=(w-y)/D;JO(u,ee,le,U,L,zc),JO(f,ie,_e,C,L,Gc),t.bezierCurveTo(zc[1],Gc[1],zc[2],Gc[2],zc[3],Gc[3]);break e}y+=D}t.bezierCurveTo(ee,ie,le,_e,U,C),u=U,f=C;break}case Rr.Q:{var ee=n[O++],ie=n[O++],le=n[O++],_e=n[O++];if(d){var D=v[b++];if(y+D>w){var L=(w-y)/D;QO(u,ee,le,L,zc),QO(f,ie,_e,L,Gc),t.quadraticCurveTo(zc[1],Gc[1],zc[2],Gc[2]);break e}y+=D}t.quadraticCurveTo(ee,ie,le,_e),u=le,f=_e;break}case Rr.A:var R=n[O++],I=n[O++],k=n[O++],F=n[O++],H=n[O++],W=n[O++],Q=n[O++],se=!n[O++],we=k>F?k:F,pe=Il(k-F)>.001,me=H+W,Ie=!1;if(d){var D=v[b++];y+D>w&&(me=H+W*(w-y)/D,Ie=!0),y+=D}if(pe&&t.ellipse?t.ellipse(R,I,k,F,Q,H,me,se):t.arc(R,I,we,H,me,se),Ie)break e;M&&(s=Yc(H)*k+R,l=Kc(H)*F+I),u=Yc(me)*k+R,f=Kc(me)*F+I;break;case Rr.R:s=u=n[O],l=f=n[O+1],c=n[O++],h=n[O++];var z=n[O++],Le=n[O++];if(d){var D=v[b++];if(y+D>w){var ye=w-y;t.moveTo(c,h),t.lineTo(c+kI(ye,z),h),ye-=z,ye>0&&t.lineTo(c+z,h+kI(ye,Le)),ye-=Le,ye>0&&t.lineTo(c+AI(z-ye,0),h+Le),ye-=z,ye>0&&t.lineTo(c,h+AI(Le-ye,0));break e}y+=D}t.rect(c,h,z,Le);break;case Rr.Z:if(d){var D=v[b++];if(y+D>w){var L=(w-y)/D;t.lineTo(u*(1-L)+s*L,f*(1-L)+l*L);break e}y+=D}t.closePath(),u=s,f=l}}},e.prototype.clone=function(){var t=new e,r=this.data;return t.data=r.slice?r.slice():Array.prototype.slice.call(r),t._len=this._len,t},e.CMD=Rr,e.initDefaultProps=function(){var t=e.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),e}();const uc=rOe;function xv(e,t,r,n,i,a,o){if(i===0)return!1;var s=i,l=0,u=e;if(o>t+s&&o>n+s||o<t-s&&o<n-s||a>e+s&&a>r+s||a<e-s&&a<r-s)return!1;if(e!==r)l=(t-n)/(e-r),u=(e*n-r*t)/(e-r);else return Math.abs(a-e)<=s/2;var f=l*a-o+u,c=f*f/(l*l+1);return c<=s/2*s/2}function nOe(e,t,r,n,i,a,o,s,l,u,f){if(l===0)return!1;var c=l;if(f>t+c&&f>n+c&&f>a+c&&f>s+c||f<t-c&&f<n-c&&f<a-c&&f<s-c||u>e+c&&u>r+c&&u>i+c&&u>o+c||u<e-c&&u<r-c&&u<i-c&&u<o-c)return!1;var h=mxe(e,t,r,n,i,a,o,s,u,f,null);return h<=c/2}function iOe(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;if(l>t+u&&l>n+u&&l>a+u||l<t-u&&l<n-u&&l<a-u||s>e+u&&s>r+u&&s>i+u||s<e-u&&s<r-u&&s<i-u)return!1;var f=_xe(e,t,r,n,i,a,s,l,null);return f<=u/2}var C6=Math.PI*2;function zC(e){return e%=C6,e<0&&(e+=C6),e}var l0=Math.PI*2;function aOe(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;s-=e,l-=t;var f=Math.sqrt(s*s+l*l);if(f-u>r||f+u<r)return!1;if(Math.abs(n-i)%l0<1e-4)return!0;if(a){var c=n;n=zC(i),i=zC(c)}else n=zC(n),i=zC(i);n>i&&(i+=l0);var h=Math.atan2(l,s);return h<0&&(h+=l0),h>=n&&h<=i||h+l0>=n&&h+l0<=i}function Xc(e,t,r,n,i,a){if(a>t&&a>n||a<t&&a<n||n===t)return 0;var o=(a-t)/(n-t),s=n<t?1:-1;(o===1||o===0)&&(s=n<t?.5:-.5);var l=o*(r-e)+e;return l===i?1/0:l>i?s:0}var sf=uc.CMD,qc=Math.PI*2,oOe=1e-4;function sOe(e,t){return Math.abs(e-t)<oOe}var Xi=[-1,-1,-1],xo=[-1,-1];function lOe(){var e=xo[0];xo[0]=xo[1],xo[1]=e}function uOe(e,t,r,n,i,a,o,s,l,u){if(u>t&&u>n&&u>a&&u>s||u<t&&u<n&&u<a&&u<s)return 0;var f=ZO(t,n,a,s,u,Xi);if(f===0)return 0;for(var c=0,h=-1,d=void 0,v=void 0,g=0;g<f;g++){var y=Xi[g],b=y===0||y===1?.5:1,w=qn(e,r,i,o,y);w<l||(h<0&&(h=Hne(t,n,a,s,xo),xo[1]<xo[0]&&h>1&&lOe(),d=qn(t,n,a,s,xo[0]),h>1&&(v=qn(t,n,a,s,xo[1]))),h===2?y<xo[0]?c+=d<t?b:-b:y<xo[1]?c+=v<d?b:-b:c+=s<v?b:-b:y<xo[0]?c+=d<t?b:-b:c+=s<d?b:-b)}return c}function fOe(e,t,r,n,i,a,o,s){if(s>t&&s>n&&s>a||s<t&&s<n&&s<a)return 0;var l=wxe(t,n,a,s,Xi);if(l===0)return 0;var u=Bne(t,n,a);if(u>=0&&u<=1){for(var f=0,c=Si(t,n,a,u),h=0;h<l;h++){var d=Xi[h]===0||Xi[h]===1?.5:1,v=Si(e,r,i,Xi[h]);v<o||(Xi[h]<u?f+=c<t?d:-d:f+=a<c?d:-d)}return f}else{var d=Xi[0]===0||Xi[0]===1?.5:1,v=Si(e,r,i,Xi[0]);return v<o?0:a<t?d:-d}}function cOe(e,t,r,n,i,a,o,s){if(s-=t,s>r||s<-r)return 0;var l=Math.sqrt(r*r-s*s);Xi[0]=-l,Xi[1]=l;var u=Math.abs(n-i);if(u<1e-4)return 0;if(u>=qc-1e-4){n=0,i=qc;var f=a?1:-1;return o>=Xi[0]+e&&o<=Xi[1]+e?f:0}if(n>i){var c=n;n=i,i=c}n<0&&(n+=qc,i+=qc);for(var h=0,d=0;d<2;d++){var v=Xi[d];if(v+e>o){var g=Math.atan2(s,v),f=a?1:-1;g<0&&(g=qc+g),(g>=n&&g<=i||g+qc>=n&&g+qc<=i)&&(g>Math.PI/2&&g<Math.PI*1.5&&(f=-f),h+=f)}}return h}function cie(e,t,r,n,i){for(var a=e.data,o=e.len(),s=0,l=0,u=0,f=0,c=0,h,d,v=0;v<o;){var g=a[v++],y=v===1;switch(g===sf.M&&v>1&&(r||(s+=Xc(l,u,f,c,n,i))),y&&(l=a[v],u=a[v+1],f=l,c=u),g){case sf.M:f=a[v++],c=a[v++],l=f,u=c;break;case sf.L:if(r){if(xv(l,u,a[v],a[v+1],t,n,i))return!0}else s+=Xc(l,u,a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case sf.C:if(r){if(nOe(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=uOe(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case sf.Q:if(r){if(iOe(l,u,a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=fOe(l,u,a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case sf.A:var b=a[v++],w=a[v++],_=a[v++],x=a[v++],T=a[v++],O=a[v++];v+=1;var E=!!(1-a[v++]);h=Math.cos(T)*_+b,d=Math.sin(T)*x+w,y?(f=h,c=d):s+=Xc(l,u,h,d,n,i);var M=(n-b)*x/_+b;if(r){if(aOe(b,w,x,T,T+O,E,t,M,i))return!0}else s+=cOe(b,w,x,T,T+O,E,M,i);l=Math.cos(T+O)*_+b,u=Math.sin(T+O)*x+w;break;case sf.R:f=l=a[v++],c=u=a[v++];var P=a[v++],N=a[v++];if(h=f+P,d=c+N,r){if(xv(f,c,h,c,t,n,i)||xv(h,c,h,d,t,n,i)||xv(h,d,f,d,t,n,i)||xv(f,d,f,c,t,n,i))return!0}else s+=Xc(h,c,h,d,n,i),s+=Xc(f,d,f,c,n,i);break;case sf.Z:if(r){if(xv(l,u,f,c,t,n,i))return!0}else s+=Xc(l,u,f,c,n,i);l=f,u=c;break}}return!r&&!sOe(u,c)&&(s+=Xc(l,u,f,c,n,i)||0),s!==0}function hOe(e,t,r){return cie(e,0,!1,t,r)}function dOe(e,t,r,n){return cie(e,t,!0,r,n)}var hie=Mr({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},od),vOe={style:Mr({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},ik.style)},MI=uw.concat(["invisible","culling","z","z2","zlevel","parent"]),pOe=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.update=function(){var r=this;e.prototype.update.call(this);var n=this.style;if(n.decal){var i=this._decalEl=this._decalEl||new t;i.buildPath===t.prototype.buildPath&&(i.buildPath=function(l){r.buildPath(l,r.shape)}),i.silent=!0;var a=i.style;for(var o in n)a[o]!==n[o]&&(a[o]=n[o]);a.fill=n.fill?n.decal:null,a.decal=null,a.shadowColor=null,n.strokeFirst&&(a.stroke=null);for(var s=0;s<MI.length;++s)i[MI[s]]=this[MI[s]];i.__dirty|=za}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(r){var n=sn(r);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var a=0;a<n.length;a++){var o=n[a],s=r[o];o==="style"?this.style?Ze(this.style,s):this.useStyle(s):o==="shape"?Ze(this.shape,s):e.prototype.attrKV.call(this,o,s)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var r=this.style.fill;if(r!=="none"){if(bt(r)){var n=eE(r,0);return n>.5?T$:n>.2?Yxe:O$}else if(r)return O$}return T$},t.prototype.getInsideTextStroke=function(r){var n=this.style.fill;if(bt(n)){var i=this.__zr,a=!!(i&&i.isDarkMode()),o=eE(r,0)<x$;if(a===o)return n}},t.prototype.buildPath=function(r,n,i){},t.prototype.pathUpdated=function(){this.__dirty&=~hp},t.prototype.getUpdatedPathProxy=function(r){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,r),this.path},t.prototype.createPathProxy=function(){this.path=new uc(!1)},t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return!(n==null||n==="none"||!(r.lineWidth>0))},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.getBoundingRect=function(){var r=this._rect,n=this.style,i=!r;if(i){var a=!1;this.path||(a=!0,this.createPathProxy());var o=this.path;(a||this.__dirty&hp)&&(o.beginPath(),this.buildPath(o,this.shape,!1),this.pathUpdated()),r=o.getBoundingRect()}if(this._rect=r,this.hasStroke()&&this.path&&this.path.len()>0){var s=this._rectStroke||(this._rectStroke=r.clone());if(this.__dirty||i){s.copy(r);var l=n.strokeNoScale?this.getLineScale():1,u=n.lineWidth;if(!this.hasFill()){var f=this.strokeContainThreshold;u=Math.max(u,f??4)}l>1e-10&&(s.width+=u/l,s.height+=u/l,s.x-=u/l/2,s.y-=u/l/2)}return s}return r},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect(),o=this.style;if(r=i[0],n=i[1],a.contain(r,n)){var s=this.path;if(this.hasStroke()){var l=o.lineWidth,u=o.strokeNoScale?this.getLineScale():1;if(u>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),dOe(s,l/u,r,n)))return!0}if(this.hasFill())return hOe(s,r,n)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=hp,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(r){return this.animate("shape",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():r==="shape"?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(r,n){r==="shape"?this.setShape(n):e.prototype.attrKV.call(this,r,n)},t.prototype.setShape=function(r,n){var i=this.shape;return i||(i=this.shape={}),typeof r=="string"?i[r]=n:Ze(i,r),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&hp)},t.prototype.createStyle=function(r){return ek(hie,r)},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.shape&&!n.shape&&(n.shape=Ze({},this.shape))},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.shape?o?a?u=n.shape:(u=Ze({},i.shape),Ze(u,n.shape)):(u=Ze({},a?this.shape:i.shape),Ze(u,n.shape)):l&&(u=i.shape),u)if(o){this.shape=Ze({},this.shape);for(var f={},c=sn(u),h=0;h<c.length;h++){var d=c[h];typeof u[d]=="object"?this.shape[d]=u[d]:f[d]=u[d]}this._transitionState(r,{shape:f},s)}else this.shape=u,this.dirtyShape()},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.shape&&(i=i||{},this._mergeStyle(i,o.shape))}return i&&(n.shape=i),n},t.prototype.getAnimationStyleProps=function(){return vOe},t.prototype.isZeroArea=function(){return!1},t.extend=function(r){var n=function(a){st(o,a);function o(s){var l=a.call(this,s)||this;return r.init&&r.init.call(l,s),l}return o.prototype.getDefaultStyle=function(){return mr(r.style)},o.prototype.getDefaultShape=function(){return mr(r.shape)},o}(t);for(var i in r)typeof r[i]=="function"&&(n.prototype[i]=r[i]);return n},t.initDefaultProps=function(){var r=t.prototype;r.type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,r.__dirty=za|tb|hp}(),t}(WS);const Nr=pOe;var gOe=Mr({strokeFirst:!0,font:pd,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},hie),die=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return n!=null&&n!=="none"&&r.lineWidth>0},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.createStyle=function(r){return ek(gOe,r)},t.prototype.setBoundingRect=function(r){this._rect=r},t.prototype.getBoundingRect=function(){var r=this.style;if(!this._rect){var n=r.text;n!=null?n+="":n="";var i=WB(n,r.font,r.textAlign,r.textBaseline);if(i.x+=r.x||0,i.y+=r.y||0,this.hasStroke()){var a=r.lineWidth;i.x-=a/2,i.y-=a/2,i.width+=a,i.height+=a}this._rect=i}return this._rect},t.initDefaultProps=function(){var r=t.prototype;r.dirtyRectTolerance=10}(),t}(WS);die.prototype.type="tspan";const I$=die;var yOe=Mr({x:0,y:0},od),mOe={style:Mr({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},ik.style)};function bOe(e){return!!(e&&typeof e!="string"&&e.width&&e.height)}var vie=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.createStyle=function(r){return ek(yOe,r)},t.prototype._getSize=function(r){var n=this.style,i=n[r];if(i!=null)return i;var a=bOe(n.image)?n.image:this.__image;if(!a)return 0;var o=r==="width"?"height":"width",s=n[o];return s==null?a[r]:a[r]/a[o]*s},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return mOe},t.prototype.getBoundingRect=function(){var r=this.style;return this._rect||(this._rect=new Pr(r.x||0,r.y||0,this.getWidth(),this.getHeight())),this._rect},t}(WS);vie.prototype.type="image";const Nd=vie;function wOe(e,t){var r=t.x,n=t.y,i=t.width,a=t.height,o=t.r,s,l,u,f;i<0&&(r=r+i,i=-i),a<0&&(n=n+a,a=-a),typeof o=="number"?s=l=u=f=o:o instanceof Array?o.length===1?s=l=u=f=o[0]:o.length===2?(s=u=o[0],l=f=o[1]):o.length===3?(s=o[0],l=f=o[1],u=o[2]):(s=o[0],l=o[1],u=o[2],f=o[3]):s=l=u=f=0;var c;s+l>i&&(c=s+l,s*=i/c,l*=i/c),u+f>i&&(c=u+f,u*=i/c,f*=i/c),l+u>a&&(c=l+u,l*=a/c,u*=a/c),s+f>a&&(c=s+f,s*=a/c,f*=a/c),e.moveTo(r+s,n),e.lineTo(r+i-l,n),l!==0&&e.arc(r+i-l,n+l,l,-Math.PI/2,0),e.lineTo(r+i,n+a-u),u!==0&&e.arc(r+i-u,n+a-u,u,0,Math.PI/2),e.lineTo(r+f,n+a),f!==0&&e.arc(r+f,n+a-f,f,Math.PI/2,Math.PI),e.lineTo(r,n+s),s!==0&&e.arc(r+s,n+s,s,Math.PI,Math.PI*1.5)}var Sp=Math.round;function pie(e,t,r){if(t){var n=t.x1,i=t.x2,a=t.y1,o=t.y2;e.x1=n,e.x2=i,e.y1=a,e.y2=o;var s=r&&r.lineWidth;return s&&(Sp(n*2)===Sp(i*2)&&(e.x1=e.x2=kh(n,s,!0)),Sp(a*2)===Sp(o*2)&&(e.y1=e.y2=kh(a,s,!0))),e}}function gie(e,t,r){if(t){var n=t.x,i=t.y,a=t.width,o=t.height;e.x=n,e.y=i,e.width=a,e.height=o;var s=r&&r.lineWidth;return s&&(e.x=kh(n,s,!0),e.y=kh(i,s,!0),e.width=Math.max(kh(n+a,s,!1)-e.x,a===0?0:1),e.height=Math.max(kh(i+o,s,!1)-e.y,o===0?0:1)),e}}function kh(e,t,r){if(!t)return e;var n=Sp(e*2);return(n+Sp(t))%2===0?n/2:(n+(r?1:-1))/2}var _Oe=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0}return e}(),SOe={},yie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new _Oe},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=gie(SOe,n,this.style);i=l.x,a=l.y,o=l.width,s=l.height,l.r=n.r,n=l}else i=n.x,a=n.y,o=n.width,s=n.height;n.r?wOe(r,n):r.rect(i,a,o,s)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(Nr);yie.prototype.type="rect";const Qn=yie;var x6={fill:"#000"},T6=2,COe={style:Mr({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},ik.style)},mie=function(e){st(t,e);function t(r){var n=e.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=x6,n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var r=0;r<this._children.length;r++){var n=this._children[r];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},t.prototype.updateTransform=function(){var r=this.innerTransformable;r?(r.updateTransform(),r.transform&&(this.transform=r.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(r){var n=this.innerTransformable;return n?n.getLocalTransform(r):e.prototype.getLocalTransform.call(this,r)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,ROe(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=r},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var r=new Pr(0,0,0,0),n=this._children,i=[],a=null,o=0;o<n.length;o++){var s=n[o],l=s.getBoundingRect(),u=s.getLocalTransform(i);u?(r.copy(l),r.applyTransform(u),a=a||r.clone(),a.union(r)):(a=a||l.clone(),a.union(l))}this._rect=a||r}return this._rect},t.prototype.setDefaultTextStyle=function(r){this._defaultStyle=r||x6},t.prototype.setTextContent=function(r){},t.prototype._mergeStyle=function(r,n){if(!n)return r;var i=n.rich,a=r.rich||i&&{};return Ze(r,n),i&&a?(this._mergeRich(a,i),r.rich=a):a&&(r.rich=a),r},t.prototype._mergeRich=function(r,n){for(var i=sn(n),a=0;a<i.length;a++){var o=i[a];r[o]=r[o]||{},Ze(r[o],n[o])}},t.prototype.getAnimationStyleProps=function(){return COe},t.prototype._getOrCreateChild=function(r){var n=this._children[this._childCursor];return(!n||!(n instanceof r))&&(n=new r),this._children[this._childCursor++]=n,n.__zr=this.__zr,n.parent=this,n},t.prototype._updatePlainTexts=function(){var r=this.style,n=r.font||pd,i=r.padding,a=I6(r),o=WTe(a,r),s=DI(r),l=!!r.backgroundColor,u=o.outerHeight,f=o.outerWidth,c=o.contentWidth,h=o.lines,d=o.lineHeight,v=this._defaultStyle,g=r.x||0,y=r.y||0,b=r.align||v.align||"left",w=r.verticalAlign||v.verticalAlign||"top",_=g,x=dp(y,o.contentHeight,w);if(s||i){var T=nb(g,f,b),O=dp(y,u,w);s&&this._renderBackground(r,r,T,O,f,u)}x+=d/2,i&&(_=P6(g,b,i),w==="top"?x+=i[0]:w==="bottom"&&(x-=i[2]));for(var E=0,M=!1,P=A6("fill"in r?r.fill:(M=!0,v.fill)),N=k6("stroke"in r?r.stroke:!l&&(!v.autoStroke||M)?(E=T6,v.stroke):null),D=r.textShadowBlur>0,L=r.width!=null&&(r.overflow==="truncate"||r.overflow==="break"||r.overflow==="breakAll"),V=o.calculatedLineHeight,ee=0;ee<h.length;ee++){var ie=this._getOrCreateChild(I$),le=ie.createStyle();ie.useStyle(le),le.text=h[ee],le.x=_,le.y=x,b&&(le.textAlign=b),le.textBaseline="middle",le.opacity=r.opacity,le.strokeFirst=!0,D&&(le.shadowBlur=r.textShadowBlur||0,le.shadowColor=r.textShadowColor||"transparent",le.shadowOffsetX=r.textShadowOffsetX||0,le.shadowOffsetY=r.textShadowOffsetY||0),le.stroke=N,le.fill=P,N&&(le.lineWidth=r.lineWidth||E,le.lineDash=r.lineDash,le.lineDashOffset=r.lineDashOffset||0),le.font=n,E6(le,r),x+=d,L&&ie.setBoundingRect(new Pr(nb(le.x,r.width,le.textAlign),dp(le.y,V,le.textBaseline),c,V))}},t.prototype._updateRichTexts=function(){var r=this.style,n=I6(r),i=zTe(n,r),a=i.width,o=i.outerWidth,s=i.outerHeight,l=r.padding,u=r.x||0,f=r.y||0,c=this._defaultStyle,h=r.align||c.align,d=r.verticalAlign||c.verticalAlign,v=nb(u,o,h),g=dp(f,s,d),y=v,b=g;l&&(y+=l[3],b+=l[0]);var w=y+a;DI(r)&&this._renderBackground(r,r,v,g,o,s);for(var _=!!r.backgroundColor,x=0;x<i.lines.length;x++){for(var T=i.lines[x],O=T.tokens,E=O.length,M=T.lineHeight,P=T.width,N=0,D=y,L=w,V=E-1,ee=void 0;N<E&&(ee=O[N],!ee.align||ee.align==="left");)this._placeToken(ee,r,M,b,D,"left",_),P-=ee.width,D+=ee.width,N++;for(;V>=0&&(ee=O[V],ee.align==="right");)this._placeToken(ee,r,M,b,L,"right",_),P-=ee.width,L-=ee.width,V--;for(D+=(a-(D-y)-(w-L)-P)/2;N<=V;)ee=O[N],this._placeToken(ee,r,M,b,D+ee.width/2,"center",_),D+=ee.width,N++;b+=M}},t.prototype._placeToken=function(r,n,i,a,o,s,l){var u=n.rich[r.styleName]||{};u.text=r.text;var f=r.verticalAlign,c=a+i/2;f==="top"?c=a+r.height/2:f==="bottom"&&(c=a+i-r.height/2);var h=!r.isLineHolder&&DI(u);h&&this._renderBackground(u,n,s==="right"?o-r.width:s==="center"?o-r.width/2:o,c-r.height/2,r.width,r.height);var d=!!u.backgroundColor,v=r.textPadding;v&&(o=P6(o,s,v),c-=r.height/2-v[0]-r.innerHeight/2);var g=this._getOrCreateChild(I$),y=g.createStyle();g.useStyle(y);var b=this._defaultStyle,w=!1,_=0,x=A6("fill"in u?u.fill:"fill"in n?n.fill:(w=!0,b.fill)),T=k6("stroke"in u?u.stroke:"stroke"in n?n.stroke:!d&&!l&&(!b.autoStroke||w)?(_=T6,b.stroke):null),O=u.textShadowBlur>0||n.textShadowBlur>0;y.text=r.text,y.x=o,y.y=c,O&&(y.shadowBlur=u.textShadowBlur||n.textShadowBlur||0,y.shadowColor=u.textShadowColor||n.textShadowColor||"transparent",y.shadowOffsetX=u.textShadowOffsetX||n.textShadowOffsetX||0,y.shadowOffsetY=u.textShadowOffsetY||n.textShadowOffsetY||0),y.textAlign=s,y.textBaseline="middle",y.font=r.font||pd,y.opacity=wb(u.opacity,n.opacity,1),E6(y,u),T&&(y.lineWidth=wb(u.lineWidth,n.lineWidth,_),y.lineDash=pr(u.lineDash,n.lineDash),y.lineDashOffset=n.lineDashOffset||0,y.stroke=T),x&&(y.fill=x);var E=r.contentWidth,M=r.contentHeight;g.setBoundingRect(new Pr(nb(y.x,E,y.textAlign),dp(y.y,M,y.textBaseline),E,M))},t.prototype._renderBackground=function(r,n,i,a,o,s){var l=r.backgroundColor,u=r.borderWidth,f=r.borderColor,c=l&&l.image,h=l&&!c,d=r.borderRadius,v=this,g,y;if(h||r.lineHeight||u&&f){g=this._getOrCreateChild(Qn),g.useStyle(g.createStyle()),g.style.fill=null;var b=g.shape;b.x=i,b.y=a,b.width=o,b.height=s,b.r=d,g.dirtyShape()}if(h){var w=g.style;w.fill=l||null,w.fillOpacity=pr(r.fillOpacity,1)}else if(c){y=this._getOrCreateChild(Nd),y.onload=function(){v.dirtyStyle()};var _=y.style;_.image=l.image,_.x=i,_.y=a,_.width=o,_.height=s}if(u&&f){var w=g.style;w.lineWidth=u,w.stroke=f,w.strokeOpacity=pr(r.strokeOpacity,1),w.lineDash=r.borderDash,w.lineDashOffset=r.borderDashOffset||0,g.strokeContainThreshold=0,g.hasFill()&&g.hasStroke()&&(w.strokeFirst=!0,w.lineWidth*=2)}var x=(g||y).style;x.shadowBlur=r.shadowBlur||0,x.shadowColor=r.shadowColor||"transparent",x.shadowOffsetX=r.shadowOffsetX||0,x.shadowOffsetY=r.shadowOffsetY||0,x.opacity=wb(r.opacity,n.opacity,1)},t.makeFont=function(r){var n="";return EOe(r)&&(n=[r.fontStyle,r.fontWeight,OOe(r.fontSize),r.fontFamily||"sans-serif"].join(" ")),n&&al(n)||r.textFont||r.font},t}(WS),xOe={left:!0,right:1,center:1},TOe={top:1,bottom:1,middle:1},O6=["fontStyle","fontWeight","fontSize","fontFamily"];function OOe(e){return typeof e=="string"&&(e.indexOf("px")!==-1||e.indexOf("rem")!==-1||e.indexOf("em")!==-1)?e:isNaN(+e)?PB+"px":e+"px"}function E6(e,t){for(var r=0;r<O6.length;r++){var n=O6[r],i=t[n];i!=null&&(e[n]=i)}}function EOe(e){return e.fontSize!=null||e.fontFamily||e.fontWeight}function ROe(e){return R6(e),ce(e.rich,R6),e}function R6(e){if(e){e.font=mie.makeFont(e);var t=e.align;t==="middle"&&(t="center"),e.align=t==null||xOe[t]?t:"left";var r=e.verticalAlign;r==="center"&&(r="middle"),e.verticalAlign=r==null||TOe[r]?r:"top";var n=e.padding;n&&(e.padding=Tne(e.padding))}}function k6(e,t){return e==null||t<=0||e==="transparent"||e==="none"?null:e.image||e.colorStops?"#000":e}function A6(e){return e==null||e==="none"?null:e.image||e.colorStops?"#000":e}function P6(e,t,r){return t==="right"?e-r[1]:t==="center"?e+r[3]/2-r[1]/2:e+r[3]}function I6(e){var t=e.text;return t!=null&&(t+=""),t}function DI(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}const Ii=mie;var Dr=zn(),kOe=function(e,t,r,n){if(n){var i=Dr(n);i.dataIndex=r,i.dataType=t,i.seriesIndex=e,n.type==="group"&&n.traverse(function(a){var o=Dr(a);o.seriesIndex=e,o.dataIndex=r,o.dataType=t})}},M6=1,D6={},bie=zn(),XB=zn(),qB=0,ak=1,ok=2,Lo=["emphasis","blur","select"],aE=["normal","emphasis","blur","select"],AOe=10,POe=9,sd="highlight",KT="downplay",xb="select",XT="unselect",Tb="toggleSelect";function Tv(e){return e!=null&&e!=="none"}var $6=new HS(100);function N6(e){if(bt(e)){var t=$6.get(e);return t||(t=t6(e,-.1),$6.put(e,t)),t}else if(QR(e)){var r=Ze({},e);return r.colorStops=Rt(e.colorStops,function(n){return{offset:n.offset,color:t6(n.color,-.1)}}),r}return e}function sk(e,t,r){e.onHoverStateChange&&(e.hoverState||0)!==r&&e.onHoverStateChange(t),e.hoverState=r}function wie(e){sk(e,"emphasis",ok)}function _ie(e){e.hoverState===ok&&sk(e,"normal",qB)}function ZB(e){sk(e,"blur",ak)}function Sie(e){e.hoverState===ak&&sk(e,"normal",qB)}function IOe(e){e.selected=!0}function MOe(e){e.selected=!1}function L6(e,t,r){t(e,r)}function Hu(e,t,r){L6(e,t,r),e.isGroup&&e.traverse(function(n){L6(n,t,r)})}function F6(e,t){switch(t){case"emphasis":e.hoverState=ok;break;case"normal":e.hoverState=qB;break;case"blur":e.hoverState=ak;break;case"select":e.selected=!0}}function DOe(e,t,r,n){for(var i=e.style,a={},o=0;o<t.length;o++){var s=t[o],l=i[s];a[s]=l??(n&&n[s])}for(var o=0;o<e.animators.length;o++){var u=e.animators[o];u.__fromStateTransition&&u.__fromStateTransition.indexOf(r)<0&&u.targetName==="style"&&u.saveTo(a,t)}return a}function $Oe(e,t,r,n){var i=r&&Hr(r,"select")>=0,a=!1;if(e instanceof Nr){var o=bie(e),s=i&&o.selectFill||o.normalFill,l=i&&o.selectStroke||o.normalStroke;if(Tv(s)||Tv(l)){n=n||{};var u=n.style||{};u.fill==="inherit"?(a=!0,n=Ze({},n),u=Ze({},u),u.fill=s):!Tv(u.fill)&&Tv(s)?(a=!0,n=Ze({},n),u=Ze({},u),u.fill=N6(s)):!Tv(u.stroke)&&Tv(l)&&(a||(n=Ze({},n),u=Ze({},u)),u.stroke=N6(l)),n.style=u}}if(n&&n.z2==null){a||(n=Ze({},n));var f=e.z2EmphasisLift;n.z2=e.z2+(f??AOe)}return n}function NOe(e,t,r){if(r&&r.z2==null){r=Ze({},r);var n=e.z2SelectLift;r.z2=e.z2+(n??POe)}return r}function LOe(e,t,r){var n=Hr(e.currentStates,t)>=0,i=e.style.opacity,a=n?null:DOe(e,["opacity"],t,{opacity:1});r=r||{};var o=r.style||{};return o.opacity==null&&(r=Ze({},r),o=Ze({opacity:n?i:a.opacity*.1},o),r.style=o),r}function $I(e,t){var r=this.states[e];if(this.style){if(e==="emphasis")return $Oe(this,e,t,r);if(e==="blur")return LOe(this,e,r);if(e==="select")return NOe(this,e,r)}return r}function FOe(e){e.stateProxy=$I;var t=e.getTextContent(),r=e.getTextGuideLine();t&&(t.stateProxy=$I),r&&(r.stateProxy=$I)}function H6(e,t){!Oie(e,t)&&!e.__highByOuter&&Hu(e,wie)}function B6(e,t){!Oie(e,t)&&!e.__highByOuter&&Hu(e,_ie)}function oE(e,t){e.__highByOuter|=1<<(t||0),Hu(e,wie)}function sE(e,t){!(e.__highByOuter&=~(1<<(t||0)))&&Hu(e,_ie)}function HOe(e){Hu(e,ZB)}function Cie(e){Hu(e,Sie)}function xie(e){Hu(e,IOe)}function Tie(e){Hu(e,MOe)}function Oie(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function Eie(e){var t=e.getModel(),r=[],n=[];t.eachComponent(function(i,a){var o=XB(a),s=i==="series",l=s?e.getViewOfSeriesModel(a):e.getViewOfComponentModel(a);!s&&n.push(l),o.isBlured&&(l.group.traverse(function(u){Sie(u)}),s&&r.push(a)),o.isBlured=!1}),ce(n,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(r,!1,t)})}function M$(e,t,r,n){var i=n.getModel();r=r||"coordinateSystem";function a(u,f){for(var c=0;c<f.length;c++){var h=u.getItemGraphicEl(f[c]);h&&Cie(h)}}if(e!=null&&!(!t||t==="none")){var o=i.getSeriesByIndex(e),s=o.coordinateSystem;s&&s.master&&(s=s.master);var l=[];i.eachSeries(function(u){var f=o===u,c=u.coordinateSystem;c&&c.master&&(c=c.master);var h=c&&s?c===s:f;if(!(r==="series"&&!f||r==="coordinateSystem"&&!h||t==="series"&&f)){var d=n.getViewOfSeriesModel(u);if(d.group.traverse(function(y){ZB(y)}),Ea(t))a(u.getData(),t);else if(Tt(t))for(var v=sn(t),g=0;g<v.length;g++)a(u.getData(v[g]),t[v[g]]);l.push(u),XB(u).isBlured=!0}}),i.eachComponent(function(u,f){if(u!=="series"){var c=n.getViewOfComponentModel(f);c&&c.toggleBlurSeries&&c.toggleBlurSeries(l,!0,i)}})}}function D$(e,t,r){if(!(e==null||t==null)){var n=r.getModel().getComponent(e,t);if(n){XB(n).isBlured=!0;var i=r.getViewOfComponentModel(n);!i||!i.focusBlurEnabled||i.group.traverse(function(a){ZB(a)})}}}function BOe(e,t,r){var n=e.seriesIndex,i=e.getData(t.dataType);if(i){var a=gd(i,t);a=(dt(a)?a[0]:a)||0;var o=i.getItemGraphicEl(a);if(!o)for(var s=i.count(),l=0;!o&&l<s;)o=i.getItemGraphicEl(l++);if(o){var u=Dr(o);M$(n,u.focus,u.blurScope,r)}else{var f=e.get(["emphasis","focus"]),c=e.get(["emphasis","blurScope"]);f!=null&&M$(n,f,c,r)}}}function JB(e,t,r,n){var i={focusSelf:!1,dispatchers:null};if(e==null||e==="series"||t==null||r==null)return i;var a=n.getModel().getComponent(e,t);if(!a)return i;var o=n.getViewOfComponentModel(a);if(!o||!o.findHighDownDispatchers)return i;for(var s=o.findHighDownDispatchers(r),l,u=0;u<s.length;u++)if(Dr(s[u]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:s}}function VOe(e,t,r){var n=Dr(e),i=JB(n.componentMainType,n.componentIndex,n.componentHighDownName,r),a=i.dispatchers,o=i.focusSelf;a?(o&&D$(n.componentMainType,n.componentIndex,r),ce(a,function(s){return H6(s,t)})):(M$(n.seriesIndex,n.focus,n.blurScope,r),n.focus==="self"&&D$(n.componentMainType,n.componentIndex,r),H6(e,t))}function WOe(e,t,r){Eie(r);var n=Dr(e),i=JB(n.componentMainType,n.componentIndex,n.componentHighDownName,r).dispatchers;i?ce(i,function(a){return B6(a,t)}):B6(e,t)}function jOe(e,t,r){if(L$(t)){var n=t.dataType,i=e.getData(n),a=gd(i,t);dt(a)||(a=[a]),e[t.type===Tb?"toggleSelect":t.type===xb?"select":"unselect"](a,n)}}function V6(e){var t=e.getAllData();ce(t,function(r){var n=r.data,i=r.type;n.eachItemGraphicEl(function(a,o){e.isSelected(o,i)?xie(a):Tie(a)})})}function UOe(e){var t=[];return e.eachSeries(function(r){var n=r.getAllData();ce(n,function(i){i.data;var a=i.type,o=r.getSelectedDataIndices();if(o.length>0){var s={dataIndex:o,seriesIndex:r.seriesIndex};a!=null&&(s.dataType=a),t.push(s)}})}),t}function $$(e,t,r){Rie(e,!0),Hu(e,FOe),GOe(e,t,r)}function zOe(e){Rie(e,!1)}function hw(e,t,r,n){n?zOe(e):$$(e,t,r)}function GOe(e,t,r){var n=Dr(e);t!=null?(n.focus=t,n.blurScope=r):n.focus&&(n.focus=null)}var W6=["emphasis","blur","select"],YOe={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function lE(e,t,r,n){r=r||"itemStyle";for(var i=0;i<W6.length;i++){var a=W6[i],o=t.getModel([a,r]),s=e.ensureState(a);s.style=n?n(o):o[YOe[r]]()}}function Rie(e,t){var r=t===!1,n=e;e.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=e.highDownSilentOnTouch),(!r||n.__highDownDispatcher)&&(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!r)}function N$(e){return!!(e&&e.__highDownDispatcher)}function KOe(e){var t=D6[e];return t==null&&M6<=32&&(t=D6[e]=M6++),t}function L$(e){var t=e.type;return t===xb||t===XT||t===Tb}function j6(e){var t=e.type;return t===sd||t===KT}function XOe(e){var t=bie(e);t.normalFill=e.style.fill,t.normalStroke=e.style.stroke;var r=e.states.select||{};t.selectFill=r.style&&r.style.fill||null,t.selectStroke=r.style&&r.style.stroke||null}var Ov=uc.CMD,qOe=[[],[],[]],U6=Math.sqrt,ZOe=Math.atan2;function JOe(e,t){if(t){var r=e.data,n=e.len(),i,a,o,s,l,u,f=Ov.M,c=Ov.C,h=Ov.L,d=Ov.R,v=Ov.A,g=Ov.Q;for(o=0,s=0;o<n;){switch(i=r[o++],s=o,a=0,i){case f:a=1;break;case h:a=1;break;case c:a=3;break;case g:a=2;break;case v:var y=t[4],b=t[5],w=U6(t[0]*t[0]+t[1]*t[1]),_=U6(t[2]*t[2]+t[3]*t[3]),x=ZOe(-t[1]/_,t[0]/w);r[o]*=w,r[o++]+=y,r[o]*=_,r[o++]+=b,r[o++]*=w,r[o++]*=_,r[o++]+=x,r[o++]+=x,o+=2,s=o;break;case d:u[0]=r[o++],u[1]=r[o++],$o(u,u,t),r[s++]=u[0],r[s++]=u[1],u[0]+=r[o++],u[1]+=r[o++],$o(u,u,t),r[s++]=u[0],r[s++]=u[1]}for(l=0;l<a;l++){var T=qOe[l];T[0]=r[o++],T[1]=r[o++],$o(T,T,t),r[s++]=T[0],r[s++]=T[1]}}e.increaseVersion()}}var NI=Math.sqrt,GC=Math.sin,YC=Math.cos,u0=Math.PI;function z6(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function F$(e,t){return(e[0]*t[0]+e[1]*t[1])/(z6(e)*z6(t))}function G6(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(F$(e,t))}function Y6(e,t,r,n,i,a,o,s,l,u,f){var c=l*(u0/180),h=YC(c)*(e-r)/2+GC(c)*(t-n)/2,d=-1*GC(c)*(e-r)/2+YC(c)*(t-n)/2,v=h*h/(o*o)+d*d/(s*s);v>1&&(o*=NI(v),s*=NI(v));var g=(i===a?-1:1)*NI((o*o*(s*s)-o*o*(d*d)-s*s*(h*h))/(o*o*(d*d)+s*s*(h*h)))||0,y=g*o*d/s,b=g*-s*h/o,w=(e+r)/2+YC(c)*y-GC(c)*b,_=(t+n)/2+GC(c)*y+YC(c)*b,x=G6([1,0],[(h-y)/o,(d-b)/s]),T=[(h-y)/o,(d-b)/s],O=[(-1*h-y)/o,(-1*d-b)/s],E=G6(T,O);if(F$(T,O)<=-1&&(E=u0),F$(T,O)>=1&&(E=0),E<0){var M=Math.round(E/u0*1e6)/1e6;E=u0*2+M%2*u0}f.addData(u,w,_,o,s,x,E,c,a)}var QOe=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,eEe=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function tEe(e){var t=new uc;if(!e)return t;var r=0,n=0,i=r,a=n,o,s=uc.CMD,l=e.match(QOe);if(!l)return t;for(var u=0;u<l.length;u++){for(var f=l[u],c=f.charAt(0),h=void 0,d=f.match(eEe)||[],v=d.length,g=0;g<v;g++)d[g]=parseFloat(d[g]);for(var y=0;y<v;){var b=void 0,w=void 0,_=void 0,x=void 0,T=void 0,O=void 0,E=void 0,M=r,P=n,N=void 0,D=void 0;switch(c){case"l":r+=d[y++],n+=d[y++],h=s.L,t.addData(h,r,n);break;case"L":r=d[y++],n=d[y++],h=s.L,t.addData(h,r,n);break;case"m":r+=d[y++],n+=d[y++],h=s.M,t.addData(h,r,n),i=r,a=n,c="l";break;case"M":r=d[y++],n=d[y++],h=s.M,t.addData(h,r,n),i=r,a=n,c="L";break;case"h":r+=d[y++],h=s.L,t.addData(h,r,n);break;case"H":r=d[y++],h=s.L,t.addData(h,r,n);break;case"v":n+=d[y++],h=s.L,t.addData(h,r,n);break;case"V":n=d[y++],h=s.L,t.addData(h,r,n);break;case"C":h=s.C,t.addData(h,d[y++],d[y++],d[y++],d[y++],d[y++],d[y++]),r=d[y-2],n=d[y-1];break;case"c":h=s.C,t.addData(h,d[y++]+r,d[y++]+n,d[y++]+r,d[y++]+n,d[y++]+r,d[y++]+n),r+=d[y-2],n+=d[y-1];break;case"S":b=r,w=n,N=t.len(),D=t.data,o===s.C&&(b+=r-D[N-4],w+=n-D[N-3]),h=s.C,M=d[y++],P=d[y++],r=d[y++],n=d[y++],t.addData(h,b,w,M,P,r,n);break;case"s":b=r,w=n,N=t.len(),D=t.data,o===s.C&&(b+=r-D[N-4],w+=n-D[N-3]),h=s.C,M=r+d[y++],P=n+d[y++],r+=d[y++],n+=d[y++],t.addData(h,b,w,M,P,r,n);break;case"Q":M=d[y++],P=d[y++],r=d[y++],n=d[y++],h=s.Q,t.addData(h,M,P,r,n);break;case"q":M=d[y++]+r,P=d[y++]+n,r+=d[y++],n+=d[y++],h=s.Q,t.addData(h,M,P,r,n);break;case"T":b=r,w=n,N=t.len(),D=t.data,o===s.Q&&(b+=r-D[N-4],w+=n-D[N-3]),r=d[y++],n=d[y++],h=s.Q,t.addData(h,b,w,r,n);break;case"t":b=r,w=n,N=t.len(),D=t.data,o===s.Q&&(b+=r-D[N-4],w+=n-D[N-3]),r+=d[y++],n+=d[y++],h=s.Q,t.addData(h,b,w,r,n);break;case"A":_=d[y++],x=d[y++],T=d[y++],O=d[y++],E=d[y++],M=r,P=n,r=d[y++],n=d[y++],h=s.A,Y6(M,P,r,n,O,E,_,x,T,h,t);break;case"a":_=d[y++],x=d[y++],T=d[y++],O=d[y++],E=d[y++],M=r,P=n,r+=d[y++],n+=d[y++],h=s.A,Y6(M,P,r,n,O,E,_,x,T,h,t);break}}(c==="z"||c==="Z")&&(h=s.Z,t.addData(h),r=i,n=a),o=h}return t.toStatic(),t}var kie=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.applyTransform=function(r){},t}(Nr);function Aie(e){return e.setData!=null}function Pie(e,t){var r=tEe(e),n=Ze({},t);return n.buildPath=function(i){if(Aie(i)){i.setData(r.data);var a=i.getContext();a&&i.rebuildPath(a,1)}else{var a=i;r.rebuildPath(a,1)}},n.applyTransform=function(i){JOe(r,i),this.dirtyShape()},n}function rEe(e,t){return new kie(Pie(e,t))}function nEe(e,t){var r=Pie(e,t),n=function(i){st(a,i);function a(o){var s=i.call(this,o)||this;return s.applyTransform=r.applyTransform,s.buildPath=r.buildPath,s}return a}(kie);return n}function iEe(e,t){for(var r=[],n=e.length,i=0;i<n;i++){var a=e[i];r.push(a.getUpdatedPathProxy(!0))}var o=new Nr(t);return o.createPathProxy(),o.buildPath=function(s){if(Aie(s)){s.appendPath(r);var l=s.getContext();l&&s.rebuildPath(l,1)}},o}var aEe=function(){function e(){this.cx=0,this.cy=0,this.r=0}return e}(),Iie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new aEe},t.prototype.buildPath=function(r,n){r.moveTo(n.cx+n.r,n.cy),r.arc(n.cx,n.cy,n.r,0,Math.PI*2)},t}(Nr);Iie.prototype.type="circle";const QB=Iie;var oEe=function(){function e(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return e}(),Mie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new oEe},t.prototype.buildPath=function(r,n){var i=.5522848,a=n.cx,o=n.cy,s=n.rx,l=n.ry,u=s*i,f=l*i;r.moveTo(a-s,o),r.bezierCurveTo(a-s,o-f,a-u,o-l,a,o-l),r.bezierCurveTo(a+u,o-l,a+s,o-f,a+s,o),r.bezierCurveTo(a+s,o+f,a+u,o+l,a,o+l),r.bezierCurveTo(a-u,o+l,a-s,o+f,a-s,o),r.closePath()},t}(Nr);Mie.prototype.type="ellipse";const Die=Mie;var $ie=Math.PI,LI=$ie*2,Zc=Math.sin,Ev=Math.cos,sEe=Math.acos,bi=Math.atan2,K6=Math.abs,Ob=Math.sqrt,ib=Math.max,Fs=Math.min,os=1e-4;function lEe(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=c*l-f*u;if(!(h*h<os))return h=(f*(t-a)-c*(e-i))/h,[e+h*l,t+h*u]}function KC(e,t,r,n,i,a,o){var s=e-r,l=t-n,u=(o?a:-a)/Ob(s*s+l*l),f=u*l,c=-u*s,h=e+f,d=t+c,v=r+f,g=n+c,y=(h+v)/2,b=(d+g)/2,w=v-h,_=g-d,x=w*w+_*_,T=i-a,O=h*g-v*d,E=(_<0?-1:1)*Ob(ib(0,T*T*x-O*O)),M=(O*_-w*E)/x,P=(-O*w-_*E)/x,N=(O*_+w*E)/x,D=(-O*w+_*E)/x,L=M-y,V=P-b,ee=N-y,ie=D-b;return L*L+V*V>ee*ee+ie*ie&&(M=N,P=D),{cx:M,cy:P,x0:-f,y0:-c,x1:M*(i/T-1),y1:P*(i/T-1)}}function uEe(e){var t;if(dt(e)){var r=e.length;if(!r)return e;r===1?t=[e[0],e[0],0,0]:r===2?t=[e[0],e[0],e[1],e[1]]:r===3?t=e.concat(e[2]):t=e}else t=[e,e,e,e];return t}function fEe(e,t){var r,n=ib(t.r,0),i=ib(t.r0||0,0),a=n>0,o=i>0;if(!(!a&&!o)){if(a||(n=i,i=0),i>n){var s=n;n=i,i=s}var l=t.startAngle,u=t.endAngle;if(!(isNaN(l)||isNaN(u))){var f=t.cx,c=t.cy,h=!!t.clockwise,d=K6(u-l),v=d>LI&&d%LI;if(v>os&&(d=v),!(n>os))e.moveTo(f,c);else if(d>LI-os)e.moveTo(f+n*Ev(l),c+n*Zc(l)),e.arc(f,c,n,l,u,!h),i>os&&(e.moveTo(f+i*Ev(u),c+i*Zc(u)),e.arc(f,c,i,u,l,h));else{var g=void 0,y=void 0,b=void 0,w=void 0,_=void 0,x=void 0,T=void 0,O=void 0,E=void 0,M=void 0,P=void 0,N=void 0,D=void 0,L=void 0,V=void 0,ee=void 0,ie=n*Ev(l),le=n*Zc(l),_e=i*Ev(u),U=i*Zc(u),C=d>os;if(C){var R=t.cornerRadius;R&&(r=uEe(R),g=r[0],y=r[1],b=r[2],w=r[3]);var I=K6(n-i)/2;if(_=Fs(I,b),x=Fs(I,w),T=Fs(I,g),O=Fs(I,y),P=E=ib(_,x),N=M=ib(T,O),(E>os||M>os)&&(D=n*Ev(u),L=n*Zc(u),V=i*Ev(l),ee=i*Zc(l),d<$ie)){var k=lEe(ie,le,V,ee,D,L,_e,U);if(k){var F=ie-k[0],H=le-k[1],W=D-k[0],Q=L-k[1],se=1/Zc(sEe((F*W+H*Q)/(Ob(F*F+H*H)*Ob(W*W+Q*Q)))/2),we=Ob(k[0]*k[0]+k[1]*k[1]);P=Fs(E,(n-we)/(se+1)),N=Fs(M,(i-we)/(se-1))}}}if(!C)e.moveTo(f+ie,c+le);else if(P>os){var pe=Fs(b,P),me=Fs(w,P),Ie=KC(V,ee,ie,le,n,pe,h),z=KC(D,L,_e,U,n,me,h);e.moveTo(f+Ie.cx+Ie.x0,c+Ie.cy+Ie.y0),P<E&&pe===me?e.arc(f+Ie.cx,c+Ie.cy,P,bi(Ie.y0,Ie.x0),bi(z.y0,z.x0),!h):(pe>0&&e.arc(f+Ie.cx,c+Ie.cy,pe,bi(Ie.y0,Ie.x0),bi(Ie.y1,Ie.x1),!h),e.arc(f,c,n,bi(Ie.cy+Ie.y1,Ie.cx+Ie.x1),bi(z.cy+z.y1,z.cx+z.x1),!h),me>0&&e.arc(f+z.cx,c+z.cy,me,bi(z.y1,z.x1),bi(z.y0,z.x0),!h))}else e.moveTo(f+ie,c+le),e.arc(f,c,n,l,u,!h);if(!(i>os)||!C)e.lineTo(f+_e,c+U);else if(N>os){var pe=Fs(g,N),me=Fs(y,N),Ie=KC(_e,U,D,L,i,-me,h),z=KC(ie,le,V,ee,i,-pe,h);e.lineTo(f+Ie.cx+Ie.x0,c+Ie.cy+Ie.y0),N<M&&pe===me?e.arc(f+Ie.cx,c+Ie.cy,N,bi(Ie.y0,Ie.x0),bi(z.y0,z.x0),!h):(me>0&&e.arc(f+Ie.cx,c+Ie.cy,me,bi(Ie.y0,Ie.x0),bi(Ie.y1,Ie.x1),!h),e.arc(f,c,i,bi(Ie.cy+Ie.y1,Ie.cx+Ie.x1),bi(z.cy+z.y1,z.cx+z.x1),h),pe>0&&e.arc(f+z.cx,c+z.cy,pe,bi(z.y1,z.x1),bi(z.y0,z.x0),!h))}else e.lineTo(f+_e,c+U),e.arc(f,c,i,u,l,h)}e.closePath()}}}var cEe=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return e}(),Nie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new cEe},t.prototype.buildPath=function(r,n){fEe(r,n)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(Nr);Nie.prototype.type="sector";const Ld=Nie;var hEe=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return e}(),Lie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new hEe},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.PI*2;r.moveTo(i+n.r,a),r.arc(i,a,n.r,0,o,!1),r.moveTo(i+n.r0,a),r.arc(i,a,n.r0,0,o,!0)},t}(Nr);Lie.prototype.type="ring";const Fie=Lie;function dEe(e,t,r,n){var i=[],a=[],o=[],s=[],l,u,f,c;if(n){f=[1/0,1/0],c=[-1/0,-1/0];for(var h=0,d=e.length;h<d;h++)bp(f,f,e[h]),wp(c,c,e[h]);bp(f,f,n[0]),wp(c,c,n[1])}for(var h=0,d=e.length;h<d;h++){var v=e[h];if(r)l=e[h?h-1:d-1],u=e[(h+1)%d];else if(h===0||h===d-1){i.push($Ce(e[h]));continue}else l=e[h-1],u=e[h+1];NCe(a,u,l),eI(a,a,t);var g=f$(v,l),y=f$(v,u),b=g+y;b!==0&&(g/=b,y/=b),eI(o,a,-g),eI(s,a,y);var w=B5([],v,o),_=B5([],v,s);n&&(wp(w,w,f),bp(w,w,c),wp(_,_,f),bp(_,_,c)),i.push(w),i.push(_)}return r&&i.push(i.shift()),i}function Hie(e,t,r){var n=t.smooth,i=t.points;if(i&&i.length>=2){if(n){var a=dEe(i,n,r,t.smoothConstraint);e.moveTo(i[0][0],i[0][1]);for(var o=i.length,s=0;s<(r?o:o-1);s++){var l=a[s*2],u=a[s*2+1],f=i[(s+1)%o];e.bezierCurveTo(l[0],l[1],u[0],u[1],f[0],f[1])}}else{e.moveTo(i[0][0],i[0][1]);for(var s=1,c=i.length;s<c;s++)e.lineTo(i[s][0],i[s][1])}r&&e.closePath()}}var vEe=function(){function e(){this.points=null,this.smooth=0,this.smoothConstraint=null}return e}(),Bie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new vEe},t.prototype.buildPath=function(r,n){Hie(r,n,!0)},t}(Nr);Bie.prototype.type="polygon";const Vie=Bie;var pEe=function(){function e(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return e}(),Wie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new pEe},t.prototype.buildPath=function(r,n){Hie(r,n,!1)},t}(Nr);Wie.prototype.type="polyline";const lk=Wie;var gEe={},yEe=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return e}(),jie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new yEe},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=pie(gEe,n,this.style);i=l.x1,a=l.y1,o=l.x2,s=l.y2}else i=n.x1,a=n.y1,o=n.x2,s=n.y2;var u=n.percent;u!==0&&(r.moveTo(i,a),u<1&&(o=i*(1-u)+o*u,s=a*(1-u)+s*u),r.lineTo(o,s))},t.prototype.pointAt=function(r){var n=this.shape;return[n.x1*(1-r)+n.x2*r,n.y1*(1-r)+n.y2*r]},t}(Nr);jie.prototype.type="line";const yd=jie;var pa=[],mEe=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return e}();function X6(e,t,r){var n=e.cpx2,i=e.cpy2;return n!=null||i!=null?[(r?Z5:qn)(e.x1,e.cpx1,e.cpx2,e.x2,t),(r?Z5:qn)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(r?J5:Si)(e.x1,e.cpx1,e.x2,t),(r?J5:Si)(e.y1,e.cpy1,e.y2,t)]}var Uie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new mEe},t.prototype.buildPath=function(r,n){var i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.cpx1,u=n.cpy1,f=n.cpx2,c=n.cpy2,h=n.percent;h!==0&&(r.moveTo(i,a),f==null||c==null?(h<1&&(QO(i,l,o,h,pa),l=pa[1],o=pa[2],QO(a,u,s,h,pa),u=pa[1],s=pa[2]),r.quadraticCurveTo(l,u,o,s)):(h<1&&(JO(i,l,f,o,h,pa),l=pa[1],f=pa[2],o=pa[3],JO(a,u,c,s,h,pa),u=pa[1],c=pa[2],s=pa[3]),r.bezierCurveTo(l,u,f,c,o,s)))},t.prototype.pointAt=function(r){return X6(this.shape,r,!1)},t.prototype.tangentAt=function(r){var n=X6(this.shape,r,!0);return HCe(n,n)},t}(Nr);Uie.prototype.type="bezier-curve";const zie=Uie;var bEe=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),Gie=function(e){st(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new bEe},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r,0),s=n.startAngle,l=n.endAngle,u=n.clockwise,f=Math.cos(s),c=Math.sin(s);r.moveTo(f*o+i,c*o+a),r.arc(i,a,o,s,l,!u)},t}(Nr);Gie.prototype.type="arc";const e3=Gie;var wEe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="compound",r}return t.prototype._updatePathDirty=function(){for(var r=this.shape.paths,n=this.shapeChanged(),i=0;i<r.length;i++)n=n||r[i].shapeChanged();n&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var r=this.shape.paths||[],n=this.getGlobalScale(),i=0;i<r.length;i++)r[i].path||r[i].createPathProxy(),r[i].path.setScale(n[0],n[1],r[i].segmentIgnoreThreshold)},t.prototype.buildPath=function(r,n){for(var i=n.paths||[],a=0;a<i.length;a++)i[a].buildPath(r,i[a].shape,!0)},t.prototype.afterBrush=function(){for(var r=this.shape.paths||[],n=0;n<r.length;n++)r[n].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Nr.prototype.getBoundingRect.call(this)},t}(Nr);const _Ee=wEe;var SEe=function(){function e(t){this.colorStops=t||[]}return e.prototype.addColorStop=function(t,r){this.colorStops.push({offset:t,color:r})},e}();const Yie=SEe;var CEe=function(e){st(t,e);function t(r,n,i,a,o,s){var l=e.call(this,o)||this;return l.x=r??0,l.y=n??0,l.x2=i??1,l.y2=a??0,l.type="linear",l.global=s||!1,l}return t}(Yie);const Kie=CEe;var xEe=function(e){st(t,e);function t(r,n,i,a,o){var s=e.call(this,a)||this;return s.x=r??.5,s.y=n??.5,s.r=i??.5,s.type="radial",s.global=o||!1,s}return t}(Yie);const TEe=xEe;var Jc=[0,0],Qc=[0,0],XC=new Nt,qC=new Nt,OEe=function(){function e(t,r){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new Nt;for(var n=0;n<2;n++)this._axes[n]=new Nt;t&&this.fromBoundingRect(t,r)}return e.prototype.fromBoundingRect=function(t,r){var n=this._corners,i=this._axes,a=t.x,o=t.y,s=a+t.width,l=o+t.height;if(n[0].set(a,o),n[1].set(s,o),n[2].set(s,l),n[3].set(a,l),r)for(var u=0;u<4;u++)n[u].transform(r);Nt.sub(i[0],n[1],n[0]),Nt.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(var u=0;u<2;u++)this._origin[u]=i[u].dot(n[0])},e.prototype.intersect=function(t,r){var n=!0,i=!r;return XC.set(1/0,1/0),qC.set(0,0),!this._intersectCheckOneSide(this,t,XC,qC,i,1)&&(n=!1,i)||!this._intersectCheckOneSide(t,this,XC,qC,i,-1)&&(n=!1,i)||i||Nt.copy(r,n?XC:qC),n},e.prototype._intersectCheckOneSide=function(t,r,n,i,a,o){for(var s=!0,l=0;l<2;l++){var u=this._axes[l];if(this._getProjMinMaxOnAxis(l,t._corners,Jc),this._getProjMinMaxOnAxis(l,r._corners,Qc),Jc[1]<Qc[0]||Jc[0]>Qc[1]){if(s=!1,a)return s;var f=Math.abs(Qc[0]-Jc[1]),c=Math.abs(Jc[0]-Qc[1]);Math.min(f,c)>i.len()&&(f<c?Nt.scale(i,u,-f*o):Nt.scale(i,u,c*o))}else if(n){var f=Math.abs(Qc[0]-Jc[1]),c=Math.abs(Jc[0]-Qc[1]);Math.min(f,c)<n.len()&&(f<c?Nt.scale(n,u,f*o):Nt.scale(n,u,-c*o))}}return s},e.prototype._getProjMinMaxOnAxis=function(t,r,n){for(var i=this._axes[t],a=this._origin,o=r[0].dot(i)+a[t],s=o,l=o,u=1;u<r.length;u++){var f=r[u].dot(i)+a[t];s=Math.min(f,s),l=Math.max(f,l)}n[0]=s,n[1]=l},e}();const uE=OEe;var EEe=[],REe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.notClear=!0,r.incremental=!0,r._displayables=[],r._temporaryDisplayables=[],r._cursor=0,r}return t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(r,n){n?this._temporaryDisplayables.push(r):this._displayables.push(r),this.markRedraw()},t.prototype.addDisplayables=function(r,n){n=n||!1;for(var i=0;i<r.length;i++)this.addDisplayable(r[i],n)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(r){for(var n=this._cursor;n<this._displayables.length;n++)r&&r(this._displayables[n]);for(var n=0;n<this._temporaryDisplayables.length;n++)r&&r(this._temporaryDisplayables[n])},t.prototype.update=function(){this.updateTransform();for(var r=this._cursor;r<this._displayables.length;r++){var n=this._displayables[r];n.parent=this,n.update(),n.parent=null}for(var r=0;r<this._temporaryDisplayables.length;r++){var n=this._temporaryDisplayables[r];n.parent=this,n.update(),n.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var r=new Pr(1/0,1/0,-1/0,-1/0),n=0;n<this._displayables.length;n++){var i=this._displayables[n],a=i.getBoundingRect().clone();i.needLocalTransform()&&a.applyTransform(i.getLocalTransform(EEe)),r.union(a)}this._rect=r}return this._rect},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(a.contain(i[0],i[1]))for(var o=0;o<this._displayables.length;o++){var s=this._displayables[o];if(s.contain(r,n))return!0}return!1},t}(WS);const kEe=REe;var AEe=zn();function PEe(e,t,r,n,i){var a;if(t&&t.ecModel){var o=t.ecModel.getUpdatePayload();a=o&&o.animation}var s=t&&t.isAnimationEnabled(),l=e==="update";if(s){var u=void 0,f=void 0,c=void 0;n?(u=pr(n.duration,200),f=pr(n.easing,"cubicOut"),c=0):(u=t.getShallow(l?"animationDurationUpdate":"animationDuration"),f=t.getShallow(l?"animationEasingUpdate":"animationEasing"),c=t.getShallow(l?"animationDelayUpdate":"animationDelay")),a&&(a.duration!=null&&(u=a.duration),a.easing!=null&&(f=a.easing),a.delay!=null&&(c=a.delay)),Zt(c)&&(c=c(r,i)),Zt(u)&&(u=u(r));var h={duration:u||0,delay:c,easing:f};return h}else return null}function t3(e,t,r,n,i,a,o){var s=!1,l;Zt(i)?(o=a,a=i,i=null):Tt(i)&&(a=i.cb,o=i.during,s=i.isFrom,l=i.removeOpt,i=i.dataIndex);var u=e==="leave";u||t.stopAnimation("leave");var f=PEe(e,n,i,u?l||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(t,i):null);if(f&&f.duration>0){var c=f.duration,h=f.delay,d=f.easing,v={duration:c,delay:h||0,easing:d,done:a,force:!!a||!!o,setToFinal:!u,scope:e,during:o};s?t.animateFrom(r,v):t.animateTo(r,v)}else t.stopAnimation(),!s&&t.attr(r),o&&o(1),a&&a()}function aa(e,t,r,n,i,a){t3("update",e,t,r,n,i,a)}function No(e,t,r,n,i,a){t3("enter",e,t,r,n,i,a)}function Eb(e){if(!e.__zr)return!0;for(var t=0;t<e.animators.length;t++){var r=e.animators[t];if(r.scope==="leave")return!0}return!1}function fE(e,t,r,n,i,a){Eb(e)||t3("leave",e,t,r,n,i,a)}function q6(e,t,r,n){e.removeTextContent(),e.removeTextGuideLine(),fE(e,{style:{opacity:0}},t,r,n)}function cE(e,t,r){function n(){e.parent&&e.parent.remove(e)}e.isGroup?e.traverse(function(i){i.isGroup||q6(i,t,r,n)}):q6(e,t,r,n)}function r3(e){AEe(e).oldStyle=e.style}var hE=Math.max,dE=Math.min,H$={};function IEe(e){return Nr.extend(e)}var MEe=nEe;function DEe(e,t){return MEe(e,t)}function Rs(e,t){H$[e]=t}function $Ee(e){if(H$.hasOwnProperty(e))return H$[e]}function n3(e,t,r,n){var i=rEe(e,t);return r&&(n==="center"&&(r=qie(r,i.getBoundingRect())),Zie(i,r)),i}function Xie(e,t,r){var n=new Nd({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(i){if(r==="center"){var a={width:i.width,height:i.height};n.setStyle(qie(t,a))}}});return n}function qie(e,t){var r=t.width/t.height,n=e.height*r,i;n<=e.width?i=e.height:(n=e.width,i=n/r);var a=e.x+e.width/2,o=e.y+e.height/2;return{x:a-n/2,y:o-i/2,width:n,height:i}}var NEe=iEe;function Zie(e,t){if(e.applyTransform){var r=e.getBoundingRect(),n=r.calculateTransform(t);e.applyTransform(n)}}function dw(e,t){return pie(e,e,{lineWidth:t}),e}function LEe(e){return gie(e.shape,e.shape,e.style),e}var FEe=kh;function HEe(e,t){for(var r=LB([]);e&&e!==t;)Ap(r,e.getLocalTransform(),r),e=e.parent;return r}function i3(e,t,r){return t&&!Ea(t)&&(t=VB.getLocalTransform(t)),r&&(t=HB([],t)),$o([],e,t)}function BEe(e,t,r){var n=t[4]===0||t[5]===0||t[0]===0?1:Math.abs(2*t[4]/t[0]),i=t[4]===0||t[5]===0||t[2]===0?1:Math.abs(2*t[4]/t[2]),a=[e==="left"?-n:e==="right"?n:0,e==="top"?-i:e==="bottom"?i:0];return a=i3(a,t,r),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function Z6(e){return!e.isGroup}function VEe(e){return e.shape!=null}function Jie(e,t,r){if(!e||!t)return;function n(o){var s={};return o.traverse(function(l){Z6(l)&&l.anid&&(s[l.anid]=l)}),s}function i(o){var s={x:o.x,y:o.y,rotation:o.rotation};return VEe(o)&&(s.shape=Ze({},o.shape)),s}var a=n(e);t.traverse(function(o){if(Z6(o)&&o.anid){var s=a[o.anid];if(s){var l=i(o);o.attr(i(s)),aa(o,l,r,Dr(o).dataIndex)}}})}function WEe(e,t){return Rt(e,function(r){var n=r[0];n=hE(n,t.x),n=dE(n,t.x+t.width);var i=r[1];return i=hE(i,t.y),i=dE(i,t.y+t.height),[n,i]})}function jEe(e,t){var r=hE(e.x,t.x),n=dE(e.x+e.width,t.x+t.width),i=hE(e.y,t.y),a=dE(e.y+e.height,t.y+t.height);if(n>=r&&a>=i)return{x:r,y:i,width:n-r,height:a-i}}function a3(e,t,r){var n=Ze({rectHover:!0},t),i=n.style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},e)return e.indexOf("image://")===0?(i.image=e.slice(8),Mr(i,r),new Nd(n)):n3(e.replace("path://",""),n,r,"center")}function UEe(e,t,r,n,i){for(var a=0,o=i[i.length-1];a<i.length;a++){var s=i[a];if(Qie(e,t,r,n,s[0],s[1],o[0],o[1]))return!0;o=s}}function Qie(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=FI(f,c,l,u);if(zEe(h))return!1;var d=e-i,v=t-a,g=FI(d,v,l,u)/h;if(g<0||g>1)return!1;var y=FI(d,v,f,c)/h;return!(y<0||y>1)}function FI(e,t,r,n){return e*n-r*t}function zEe(e){return e<=1e-6&&e>=-1e-6}function o3(e){var t=e.itemTooltipOption,r=e.componentModel,n=e.itemName,i=bt(t)?{formatter:t}:t,a=r.mainType,o=r.componentIndex,s={componentType:a,name:n,$vars:["name"]};s[a+"Index"]=o;var l=e.formatterParamsExtra;l&&ce(sn(l),function(f){Qp(s,f)||(s[f]=l[f],s.$vars.push(f))});var u=Dr(e.el);u.componentMainType=a,u.componentIndex=o,u.tooltipConfig={name:n,option:Mr({content:n,formatterParams:s},i)}}function J6(e,t){var r;e.isGroup&&(r=t(e)),r||e.traverse(t)}function uk(e,t){if(e)if(dt(e))for(var r=0;r<e.length;r++)J6(e[r],t);else J6(e,t)}Rs("circle",QB);Rs("ellipse",Die);Rs("sector",Ld);Rs("ring",Fie);Rs("polygon",Vie);Rs("polyline",lk);Rs("rect",Qn);Rs("line",yd);Rs("bezierCurve",zie);Rs("arc",e3);const GEe=Object.freeze(Object.defineProperty({__proto__:null,Arc:e3,BezierCurve:zie,BoundingRect:Pr,Circle:QB,CompoundPath:_Ee,Ellipse:Die,Group:Pi,Image:Nd,IncrementalDisplayable:kEe,Line:yd,LinearGradient:Kie,OrientedBoundingRect:uE,Path:Nr,Point:Nt,Polygon:Vie,Polyline:lk,RadialGradient:TEe,Rect:Qn,Ring:Fie,Sector:Ld,Text:Ii,applyTransform:i3,clipPointsByRect:WEe,clipRectByRect:jEe,createIcon:a3,extendPath:DEe,extendShape:IEe,getShapeClass:$Ee,getTransform:HEe,groupTransition:Jie,initProps:No,isElementRemoved:Eb,lineLineIntersect:Qie,linePolygonIntersect:UEe,makeImage:Xie,makePath:n3,mergePath:NEe,registerShape:Rs,removeElement:fE,removeElementWithFadeOut:cE,resizePath:Zie,setTooltipConfig:o3,subPixelOptimize:FEe,subPixelOptimizeLine:dw,subPixelOptimizeRect:LEe,transformDirection:BEe,traverseElements:uk,updateProps:aa},Symbol.toStringTag,{value:"Module"}));var fk={};function YEe(e,t){for(var r=0;r<Lo.length;r++){var n=Lo[r],i=t[n],a=e.ensureState(n);a.style=a.style||{},a.style.text=i}var o=e.currentStates.slice();e.clearStates(!0),e.setStyle({text:t.normal}),e.useStates(o,!0)}function Q6(e,t,r){var n=e.labelFetcher,i=e.labelDataIndex,a=e.labelDimIndex,o=t.normal,s;n&&(s=n.getFormattedLabel(i,"normal",null,a,o&&o.get("formatter"),r!=null?{interpolatedValue:r}:null)),s==null&&(s=Zt(e.defaultText)?e.defaultText(i,e,r):e.defaultText);for(var l={normal:s},u=0;u<Lo.length;u++){var f=Lo[u],c=t[f];l[f]=pr(n?n.getFormattedLabel(i,f,null,a,c&&c.get("formatter")):null,s)}return l}function jS(e,t,r,n){r=r||fk;for(var i=e instanceof Ii,a=!1,o=0;o<aE.length;o++){var s=t[aE[o]];if(s&&s.getShallow("show")){a=!0;break}}var l=i?e:e.getTextContent();if(a){i||(l||(l=new Ii,e.setTextContent(l)),e.stateProxy&&(l.stateProxy=e.stateProxy));var u=Q6(r,t),f=t.normal,c=!!f.getShallow("show"),h=fc(f,n&&n.normal,r,!1,!i);h.text=u.normal,i||e.setTextConfig(ez(f,r,!1));for(var o=0;o<Lo.length;o++){var d=Lo[o],s=t[d];if(s){var v=l.ensureState(d),g=!!pr(s.getShallow("show"),c);if(g!==c&&(v.ignore=!g),v.style=fc(s,n&&n[d],r,!0,!i),v.style.text=u[d],!i){var y=e.ensureState(d);y.textConfig=ez(s,r,!0)}}}l.silent=!!f.getShallow("silent"),l.style.x!=null&&(h.x=l.style.x),l.style.y!=null&&(h.y=l.style.y),l.ignore=!c,l.useStyle(h),l.dirty(),r.enableTextSetter&&(ck(l).setLabelText=function(b){var w=Q6(r,t,b);YEe(l,w)})}else l&&(l.ignore=!0);e.dirty()}function US(e,t){t=t||"label";for(var r={normal:e.getModel(t)},n=0;n<Lo.length;n++){var i=Lo[n];r[i]=e.getModel([i,t])}return r}function fc(e,t,r,n,i){var a={};return KEe(a,e,r,n,i),t&&Ze(a,t),a}function ez(e,t,r){t=t||{};var n={},i,a=e.getShallow("rotate"),o=pr(e.getShallow("distance"),r?null:5),s=e.getShallow("offset");return i=e.getShallow("position")||(r?null:"inside"),i==="outside"&&(i=t.defaultOutsidePosition||"top"),i!=null&&(n.position=i),s!=null&&(n.offset=s),a!=null&&(a*=Math.PI/180,n.rotation=a),o!=null&&(n.distance=o),n.outsideFill=e.get("color")==="inherit"?t.inheritColor||null:"auto",n}function KEe(e,t,r,n,i){r=r||fk;var a=t.ecModel,o=a&&a.option.textStyle,s=XEe(t),l;if(s){l={};for(var u in s)if(s.hasOwnProperty(u)){var f=t.getModel(["rich",u]);iz(l[u]={},f,o,r,n,i,!1,!0)}}l&&(e.rich=l);var c=t.get("overflow");c&&(e.overflow=c);var h=t.get("minMargin");h!=null&&(e.margin=h),iz(e,t,o,r,n,i,!0,!1)}function XEe(e){for(var t;e&&e!==e.ecModel;){var r=(e.option||fk).rich;if(r){t=t||{};for(var n=sn(r),i=0;i<n.length;i++){var a=n[i];t[a]=1}}e=e.parentModel}return t}var tz=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],rz=["align","lineHeight","width","height","tag","verticalAlign"],nz=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function iz(e,t,r,n,i,a,o,s){r=!i&&r||fk;var l=n&&n.inheritColor,u=t.getShallow("color"),f=t.getShallow("textBorderColor"),c=pr(t.getShallow("opacity"),r.opacity);(u==="inherit"||u==="auto")&&(l?u=l:u=null),(f==="inherit"||f==="auto")&&(l?f=l:f=null),a||(u=u||r.color,f=f||r.textBorderColor),u!=null&&(e.fill=u),f!=null&&(e.stroke=f);var h=pr(t.getShallow("textBorderWidth"),r.textBorderWidth);h!=null&&(e.lineWidth=h);var d=pr(t.getShallow("textBorderType"),r.textBorderType);d!=null&&(e.lineDash=d);var v=pr(t.getShallow("textBorderDashOffset"),r.textBorderDashOffset);v!=null&&(e.lineDashOffset=v),!i&&c==null&&!s&&(c=n&&n.defaultOpacity),c!=null&&(e.opacity=c),!i&&!a&&e.fill==null&&n.inheritColor&&(e.fill=n.inheritColor);for(var g=0;g<tz.length;g++){var y=tz[g],b=pr(t.getShallow(y),r[y]);b!=null&&(e[y]=b)}for(var g=0;g<rz.length;g++){var y=rz[g],b=t.getShallow(y);b!=null&&(e[y]=b)}if(e.verticalAlign==null){var w=t.getShallow("baseline");w!=null&&(e.verticalAlign=w)}if(!o||!n.disableBox){for(var g=0;g<nz.length;g++){var y=nz[g],b=t.getShallow(y);b!=null&&(e[y]=b)}var _=t.getShallow("borderType");_!=null&&(e.borderDash=_),(e.backgroundColor==="auto"||e.backgroundColor==="inherit")&&l&&(e.backgroundColor=l),(e.borderColor==="auto"||e.borderColor==="inherit")&&l&&(e.borderColor=l)}}function qEe(e,t){var r=t&&t.getModel("textStyle");return al([e.fontStyle||r&&r.getShallow("fontStyle")||"",e.fontWeight||r&&r.getShallow("fontWeight")||"",(e.fontSize||r&&r.getShallow("fontSize")||12)+"px",e.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}var ck=zn();function ZEe(e,t,r,n){if(e){var i=ck(e);i.prevValue=i.value,i.value=r;var a=t.normal;i.valueAnimation=a.get("valueAnimation"),i.valueAnimation&&(i.precision=a.get("precision"),i.defaultInterpolatedText=n,i.statesModels=t)}}var JEe=["textStyle","color"],HI=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],BI=new Ii,QEe=function(){function e(){}return e.prototype.getTextColor=function(t){var r=this.ecModel;return this.getShallow("color")||(!t&&r?r.get(JEe):null)},e.prototype.getFont=function(){return qEe({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},e.prototype.getTextRect=function(t){for(var r={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<HI.length;n++)r[HI[n]]=this.getShallow(HI[n]);return BI.useStyle(r),BI.update(),BI.getBoundingRect()},e}();const eRe=QEe;var eae=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],tRe=cw(eae),rRe=function(){function e(){}return e.prototype.getLineStyle=function(t){return tRe(this,t)},e}(),tae=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],nRe=cw(tae),iRe=function(){function e(){}return e.prototype.getItemStyle=function(t,r){return nRe(this,t,r)},e}(),Fd=function(){function e(t,r,n){this.parentModel=r,this.ecModel=n,this.option=t}return e.prototype.init=function(t,r,n){},e.prototype.mergeOption=function(t,r){Ar(this.option,t,!0)},e.prototype.get=function(t,r){return t==null?this.option:this._doGet(this.parsePath(t),!r&&this.parentModel)},e.prototype.getShallow=function(t,r){var n=this.option,i=n==null?n:n[t];if(i==null&&!r){var a=this.parentModel;a&&(i=a.getShallow(t))}return i},e.prototype.getModel=function(t,r){var n=t!=null,i=n?this.parsePath(t):null,a=n?this._doGet(i):this.option;return r=r||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new e(a,r,this.ecModel)},e.prototype.isEmpty=function(){return this.option==null},e.prototype.restoreData=function(){},e.prototype.clone=function(){var t=this.constructor;return new t(mr(this.option))},e.prototype.parsePath=function(t){return typeof t=="string"?t.split("."):t},e.prototype.resolveParentPath=function(t){return t},e.prototype.isAnimationEnabled=function(){if(!nr.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},e.prototype._doGet=function(t,r){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&!(t[i]&&(n=n&&typeof n=="object"?n[t[i]]:null,n==null));i++);return n==null&&r&&(n=r._doGet(this.resolveParentPath(t),r.parentModel)),n},e}();KB(Fd);MTe(Fd);hl(Fd,rRe);hl(Fd,iRe);hl(Fd,FTe);hl(Fd,eRe);const Ei=Fd;var aRe=Math.round(Math.random()*10);function hk(e){return[e||"",aRe++].join("_")}function oRe(e){var t={};e.registerSubTypeDefaulter=function(r,n){var i=ol(r);t[i.main]=n},e.determineSubType=function(r,n){var i=n.type;if(!i){var a=ol(r).main;e.hasSubTypes(r)&&t[a]&&(i=t[a](n))}return i}}function sRe(e,t){e.topologicalTravel=function(a,o,s,l){if(!a.length)return;var u=r(o),f=u.graph,c=u.noEntryList,h={};for(ce(a,function(w){h[w]=!0});c.length;){var d=c.pop(),v=f[d],g=!!h[d];g&&(s.call(l,d,v.originalDeps.slice()),delete h[d]),ce(v.successor,g?b:y)}ce(h,function(){var w="";throw new Error(w)});function y(w){f[w].entryCount--,f[w].entryCount===0&&c.push(w)}function b(w){h[w]=!0,y(w)}};function r(a){var o={},s=[];return ce(a,function(l){var u=n(o,l),f=u.originalDeps=t(l),c=i(f,a);u.entryCount=c.length,u.entryCount===0&&s.push(l),ce(c,function(h){Hr(u.predecessor,h)<0&&u.predecessor.push(h);var d=n(o,h);Hr(d.successor,h)<0&&d.successor.push(l)})}),{graph:o,noEntryList:s}}function n(a,o){return a[o]||(a[o]={predecessor:[],successor:[]}),a[o]}function i(a,o){var s=[];return ce(a,function(l){Hr(o,l)>=0&&s.push(l)}),s}}function rae(e,t){return Ar(Ar({},e,!0),t,!0)}const lRe={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},uRe={time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}};var vE="ZH",s3="EN",vw=s3,qT={},l3={},nae=nr.domSupported?function(){var e=(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase();return e.indexOf(vE)>-1?vE:vw}():vw;function iae(e,t){e=e.toUpperCase(),l3[e]=new Ei(t),qT[e]=t}function fRe(e){if(bt(e)){var t=qT[e.toUpperCase()]||{};return e===vE||e===s3?mr(t):Ar(mr(t),mr(qT[vw]),!1)}else return Ar(mr(e),mr(qT[vw]),!1)}function cRe(e){return l3[e]}function hRe(){return l3[vw]}iae(s3,lRe);iae(vE,uRe);var u3=1e3,f3=u3*60,Rb=f3*60,Po=Rb*24,az=Po*365,ab={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},ZC="{yyyy}-{MM}-{dd}",oz={year:"{yyyy}",month:"{yyyy}-{MM}",day:ZC,hour:ZC+" "+ab.hour,minute:ZC+" "+ab.minute,second:ZC+" "+ab.second,millisecond:ab.none},VI=["year","month","day","hour","minute","second","millisecond"],aae=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function eh(e,t){return e+="","0000".substr(0,t-e.length)+e}function Ip(e){switch(e){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return e}}function dRe(e){return e===Ip(e)}function vRe(e){switch(e){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function dk(e,t,r,n){var i=Au(e),a=i[c3(r)](),o=i[Mp(r)]()+1,s=Math.floor((o-1)/3)+1,l=i[vk(r)](),u=i["get"+(r?"UTC":"")+"Day"](),f=i[pw(r)](),c=(f-1)%12+1,h=i[pk(r)](),d=i[gk(r)](),v=i[yk(r)](),g=n instanceof Ei?n:cRe(n||nae)||hRe(),y=g.getModel("time"),b=y.get("month"),w=y.get("monthAbbr"),_=y.get("dayOfWeek"),x=y.get("dayOfWeekAbbr");return(t||"").replace(/{yyyy}/g,a+"").replace(/{yy}/g,a%100+"").replace(/{Q}/g,s+"").replace(/{MMMM}/g,b[o-1]).replace(/{MMM}/g,w[o-1]).replace(/{MM}/g,eh(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,eh(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,_[u]).replace(/{ee}/g,x[u]).replace(/{e}/g,u+"").replace(/{HH}/g,eh(f,2)).replace(/{H}/g,f+"").replace(/{hh}/g,eh(c+"",2)).replace(/{h}/g,c+"").replace(/{mm}/g,eh(h,2)).replace(/{m}/g,h+"").replace(/{ss}/g,eh(d,2)).replace(/{s}/g,d+"").replace(/{SSS}/g,eh(v,3)).replace(/{S}/g,v+"")}function pRe(e,t,r,n,i){var a=null;if(bt(r))a=r;else if(Zt(r))a=r(e.value,t,{level:e.level});else{var o=Ze({},ab);if(e.level>0)for(var s=0;s<VI.length;++s)o[VI[s]]="{primary|"+o[VI[s]]+"}";var l=r?r.inherit===!1?r:Mr(r,o):o,u=oae(e.value,i);if(l[u])a=l[u];else if(l.inherit){for(var f=aae.indexOf(u),s=f-1;s>=0;--s)if(l[u]){a=l[u];break}a=a||o.none}if(dt(a)){var c=e.level==null?0:e.level>=0?e.level:a.length+e.level;c=Math.min(c,a.length-1),a=a[c]}}return dk(new Date(e.value),a,i,n)}function oae(e,t){var r=Au(e),n=r[Mp(t)]()+1,i=r[vk(t)](),a=r[pw(t)](),o=r[pk(t)](),s=r[gk(t)](),l=r[yk(t)](),u=l===0,f=u&&s===0,c=f&&o===0,h=c&&a===0,d=h&&i===1,v=d&&n===1;return v?"year":d?"month":h?"day":c?"hour":f?"minute":u?"second":"millisecond"}function sz(e,t,r){var n=Ur(e)?Au(e):e;switch(t=t||oae(e,r),t){case"year":return n[c3(r)]();case"half-year":return n[Mp(r)]()>=6?1:0;case"quarter":return Math.floor((n[Mp(r)]()+1)/4);case"month":return n[Mp(r)]();case"day":return n[vk(r)]();case"half-day":return n[pw(r)]()/24;case"hour":return n[pw(r)]();case"minute":return n[pk(r)]();case"second":return n[gk(r)]();case"millisecond":return n[yk(r)]()}}function c3(e){return e?"getUTCFullYear":"getFullYear"}function Mp(e){return e?"getUTCMonth":"getMonth"}function vk(e){return e?"getUTCDate":"getDate"}function pw(e){return e?"getUTCHours":"getHours"}function pk(e){return e?"getUTCMinutes":"getMinutes"}function gk(e){return e?"getUTCSeconds":"getSeconds"}function yk(e){return e?"getUTCMilliseconds":"getMilliseconds"}function gRe(e){return e?"setUTCFullYear":"setFullYear"}function sae(e){return e?"setUTCMonth":"setMonth"}function lae(e){return e?"setUTCDate":"setDate"}function uae(e){return e?"setUTCHours":"setHours"}function fae(e){return e?"setUTCMinutes":"setMinutes"}function cae(e){return e?"setUTCSeconds":"setSeconds"}function hae(e){return e?"setUTCMilliseconds":"setMilliseconds"}function dae(e){if(!hTe(e))return bt(e)?e:"-";var t=(e+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function vae(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(r,n){return n.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var mk=Tne;function B$(e,t,r){var n="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(f){return f&&al(f)?f:"-"}function a(f){return!!(f!=null&&!isNaN(f)&&isFinite(f))}var o=t==="time",s=e instanceof Date;if(o||s){var l=o?Au(e):e;if(isNaN(+l)){if(s)return"-"}else return dk(l,n,r)}if(t==="ordinal")return l$(e)?i(e):Ur(e)&&a(e)?e+"":"-";var u=iE(e);return a(u)?dae(u):l$(e)?i(e):typeof e=="boolean"?e+"":"-"}var lz=["a","b","c","d","e","f","g"],WI=function(e,t){return"{"+e+(t??"")+"}"};function pae(e,t,r){dt(t)||(t=[t]);var n=t.length;if(!n)return"";for(var i=t[0].$vars||[],a=0;a<i.length;a++){var o=lz[a];e=e.replace(WI(o),WI(o,0))}for(var s=0;s<n;s++)for(var l=0;l<i.length;l++){var u=t[s][i[l]];e=e.replace(WI(lz[l],s),r?Oo(u):u)}return e}function yRe(e,t){var r=bt(e)?{color:e,extraCssText:t}:e||{},n=r.color,i=r.type;t=r.extraCssText;var a=r.renderMode||"html";if(!n)return"";if(a==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Oo(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Oo(n)+";"+(t||"")+'"></span>';var o=r.markerId||"markerX";return{renderMode:a,content:"{"+o+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}}function md(e,t){return t=t||"transparent",bt(e)?e:Tt(e)&&e.colorStops&&(e.colorStops[0]||{}).color||t}function uz(e,t){if(t==="_blank"||t==="blank"){var r=window.open();r.opener=null,r.location.href=e}else window.open(e,t)}var ZT=ce,mRe=["left","right","top","bottom","width","height"],JC=[["width","left","right"],["height","top","bottom"]];function h3(e,t,r,n,i){var a=0,o=0;n==null&&(n=1/0),i==null&&(i=1/0);var s=0;t.eachChild(function(l,u){var f=l.getBoundingRect(),c=t.childAt(u+1),h=c&&c.getBoundingRect(),d,v;if(e==="horizontal"){var g=f.width+(h?-h.x+f.x:0);d=a+g,d>n||l.newline?(a=0,d=g,o+=s+r,s=f.height):s=Math.max(s,f.height)}else{var y=f.height+(h?-h.y+f.y:0);v=o+y,v>i||l.newline?(a+=s+r,o=0,v=y,s=f.width):s=Math.max(s,f.width)}l.newline||(l.x=a,l.y=o,l.markRedraw(),e==="horizontal"?a=d+r:o=v+r)})}var kb=h3;Mn(h3,"vertical");Mn(h3,"horizontal");function eg(e,t,r){r=mk(r||0);var n=t.width,i=t.height,a=on(e.left,n),o=on(e.top,i),s=on(e.right,n),l=on(e.bottom,i),u=on(e.width,n),f=on(e.height,i),c=r[2]+r[0],h=r[1]+r[3],d=e.aspect;switch(isNaN(u)&&(u=n-s-h-a),isNaN(f)&&(f=i-l-c-o),d!=null&&(isNaN(u)&&isNaN(f)&&(d>n/i?u=n*.8:f=i*.8),isNaN(u)&&(u=d*f),isNaN(f)&&(f=u/d)),isNaN(a)&&(a=n-s-u-h),isNaN(o)&&(o=i-l-f-c),e.left||e.right){case"center":a=n/2-u/2-r[3];break;case"right":a=n-u-h;break}switch(e.top||e.bottom){case"middle":case"center":o=i/2-f/2-r[0];break;case"bottom":o=i-f-c;break}a=a||0,o=o||0,isNaN(u)&&(u=n-h-a-(s||0)),isNaN(f)&&(f=i-c-o-(l||0));var v=new Pr(a+r[3],o+r[0],u,f);return v.margin=r,v}function gw(e){var t=e.layoutMode||e.constructor.layoutMode;return Tt(t)?t:t?{type:t}:null}function tg(e,t,r){var n=r&&r.ignoreSize;!dt(n)&&(n=[n,n]);var i=o(JC[0],0),a=o(JC[1],1);u(JC[0],e,i),u(JC[1],e,a);function o(f,c){var h={},d=0,v={},g=0,y=2;if(ZT(f,function(_){v[_]=e[_]}),ZT(f,function(_){s(t,_)&&(h[_]=v[_]=t[_]),l(h,_)&&d++,l(v,_)&&g++}),n[c])return l(t,f[1])?v[f[2]]=null:l(t,f[2])&&(v[f[1]]=null),v;if(g===y||!d)return v;if(d>=y)return h;for(var b=0;b<f.length;b++){var w=f[b];if(!s(h,w)&&s(e,w)){h[w]=e[w];break}}return h}function s(f,c){return f.hasOwnProperty(c)}function l(f,c){return f[c]!=null&&f[c]!=="auto"}function u(f,c,h){ZT(f,function(d){c[d]=h[d]})}}function bk(e){return bRe({},e)}function bRe(e,t){return t&&e&&ZT(mRe,function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e}var wRe=zn(),mm=function(e){st(t,e);function t(r,n,i){var a=e.call(this,r,n,i)||this;return a.uid=hk("ec_cpt_model"),a}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=gw(this),a=i?bk(r):{},o=n.getTheme();Ar(r,o.get(this.mainType)),Ar(r,this.getDefaultOption()),i&&tg(r,a,i)},t.prototype.mergeOption=function(r,n){Ar(this.option,r,!0);var i=gw(this);i&&tg(this.option,r,i)},t.prototype.optionUpdated=function(r,n){},t.prototype.getDefaultOption=function(){var r=this.constructor;if(!ATe(r))return r.defaultOption;var n=wRe(this);if(!n.defaultOption){for(var i=[],a=r;a;){var o=a.prototype.defaultOption;o&&i.push(o),a=a.superClass}for(var s={},l=i.length-1;l>=0;l--)s=Ar(s,i[l],!0);n.defaultOption=s}return n.defaultOption},t.prototype.getReferringComponents=function(r,n){var i=r+"Index",a=r+"Id";return VS(this.ecModel,r,{index:this.get(i,!0),id:this.get(a,!0)},n)},t.prototype.getBoxLayoutParams=function(){var r=this;return{left:r.get("left"),top:r.get("top"),right:r.get("right"),bottom:r.get("bottom"),width:r.get("width"),height:r.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(r){this.option.zlevel=r},t.protoInitialize=function(){var r=t.prototype;r.type="component",r.id="",r.name="",r.mainType="",r.subType="",r.componentIndex=0}(),t}(Ei);oie(mm,Ei);rk(mm);oRe(mm);sRe(mm,_Re);function _Re(e){var t=[];return ce(mm.getClassesByMainType(e),function(r){t=t.concat(r.dependencies||r.prototype.dependencies||[])}),t=Rt(t,function(r){return ol(r).main}),e!=="dataset"&&Hr(t,"dataset")<=0&&t.unshift("dataset"),t}const nn=mm;var gae="";typeof navigator<"u"&&(gae=navigator.platform||"");var Rv="rgba(0, 0, 0, 0.2)";const SRe={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:Rv,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:Rv,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:Rv,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:Rv,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:Rv,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:Rv,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:gae.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var yae=ir(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),Bo="original",Ra="arrayRows",ks="objectRows",vl="keyedColumns",jf="typedArray",mae="unknown",Tu="column",bm="row",hi={Must:1,Might:2,Not:3},bae=zn();function CRe(e){bae(e).datasetMap=ir()}function xRe(e,t,r){var n={},i=d3(t);if(!i||!e)return n;var a=[],o=[],s=t.ecModel,l=bae(s).datasetMap,u=i.uid+"_"+r.seriesLayoutBy,f,c;e=e.slice(),ce(e,function(g,y){var b=Tt(g)?g:e[y]={name:g};b.type==="ordinal"&&f==null&&(f=y,c=v(b)),n[b.name]=[]});var h=l.get(u)||l.set(u,{categoryWayDim:c,valueWayDim:0});ce(e,function(g,y){var b=g.name,w=v(g);if(f==null){var _=h.valueWayDim;d(n[b],_,w),d(o,_,w),h.valueWayDim+=w}else if(f===y)d(n[b],0,w),d(a,0,w);else{var _=h.categoryWayDim;d(n[b],_,w),d(o,_,w),h.categoryWayDim+=w}});function d(g,y,b){for(var w=0;w<b;w++)g.push(y+w)}function v(g){var y=g.dimsDef;return y?y.length:1}return a.length&&(n.itemName=a),o.length&&(n.seriesName=o),n}function TRe(e,t,r){var n={},i=d3(e);if(!i)return n;var a=t.sourceFormat,o=t.dimensionsDefine,s;(a===ks||a===vl)&&ce(o,function(f,c){(Tt(f)?f.name:f)==="name"&&(s=c)});var l=function(){for(var f={},c={},h=[],d=0,v=Math.min(5,r);d<v;d++){var g=_ae(t.data,a,t.seriesLayoutBy,o,t.startIndex,d);h.push(g);var y=g===hi.Not;if(y&&f.v==null&&d!==s&&(f.v=d),(f.n==null||f.n===f.v||!y&&h[f.n]===hi.Not)&&(f.n=d),b(f)&&h[f.n]!==hi.Not)return f;y||(g===hi.Might&&c.v==null&&d!==s&&(c.v=d),(c.n==null||c.n===c.v)&&(c.n=d))}function b(w){return w.v!=null&&w.n!=null}return b(f)?f:b(c)?c:null}();if(l){n.value=[l.v];var u=s??l.n;n.itemName=[u],n.seriesName=[u]}return n}function d3(e){var t=e.get("data",!0);if(!t)return VS(e.ecModel,"dataset",{index:e.get("datasetIndex",!0),id:e.get("datasetId",!0)},ys).models[0]}function ORe(e){return!e.get("transform",!0)&&!e.get("fromTransformResult",!0)?[]:VS(e.ecModel,"dataset",{index:e.get("fromDatasetIndex",!0),id:e.get("fromDatasetId",!0)},ys).models}function wae(e,t){return _ae(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function _ae(e,t,r,n,i,a){var o,s=5;if(Xa(e))return hi.Not;var l,u;if(n){var f=n[a];Tt(f)?(l=f.name,u=f.type):bt(f)&&(l=f)}if(u!=null)return u==="ordinal"?hi.Must:hi.Not;if(t===Ra){var c=e;if(r===bm){for(var h=c[a],d=0;d<(h||[]).length&&d<s;d++)if((o=x(h[i+d]))!=null)return o}else for(var d=0;d<c.length&&d<s;d++){var v=c[i+d];if(v&&(o=x(v[a]))!=null)return o}}else if(t===ks){var g=e;if(!l)return hi.Not;for(var d=0;d<g.length&&d<s;d++){var y=g[d];if(y&&(o=x(y[l]))!=null)return o}}else if(t===vl){var b=e;if(!l)return hi.Not;var h=b[l];if(!h||Xa(h))return hi.Not;for(var d=0;d<h.length&&d<s;d++)if((o=x(h[d]))!=null)return o}else if(t===Bo)for(var w=e,d=0;d<w.length&&d<s;d++){var y=w[d],_=BS(y);if(!dt(_))return hi.Not;if((o=x(_[a]))!=null)return o}function x(T){var O=bt(T);if(T!=null&&isFinite(T)&&T!=="")return O?hi.Might:hi.Not;if(O&&T!=="-")return hi.Must}return hi.Not}var ERe=ir();function RRe(e,t,r){var n=ERe.get(t);if(!n)return r;var i=n(e);return i?r.concat(i):r}var fz=zn();zn();var v3=function(){function e(){}return e.prototype.getColorFromPalette=function(t,r,n){var i=na(this.get("color",!0)),a=this.get("colorLayer",!0);return ARe(this,fz,i,a,t,r,n)},e.prototype.clearColorPalette=function(){PRe(this,fz)},e}();function kRe(e,t){for(var r=e.length,n=0;n<r;n++)if(e[n].length>t)return e[n];return e[r-1]}function ARe(e,t,r,n,i,a,o){a=a||e;var s=t(a),l=s.paletteIdx||0,u=s.paletteNameMap=s.paletteNameMap||{};if(u.hasOwnProperty(i))return u[i];var f=o==null||!n?r:kRe(n,o);if(f=f||r,!(!f||!f.length)){var c=f[l];return i&&(u[i]=c),s.paletteIdx=(l+1)%f.length,c}}function PRe(e,t){t(e).paletteIdx=0,t(e).paletteNameMap={}}var QC,f0,cz,hz="\0_ec_inner",IRe=1,Sae=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r,n,i,a,o,s){a=a||{},this.option=null,this._theme=new Ei(a),this._locale=new Ei(o),this._optionManager=s},t.prototype.setOption=function(r,n,i){var a=pz(n);this._optionManager.setOption(r,i,a),this._resetOption(null,a)},t.prototype.resetOption=function(r,n){return this._resetOption(r,pz(n))},t.prototype._resetOption=function(r,n){var i=!1,a=this._optionManager;if(!r||r==="recreate"){var o=a.mountOption(r==="recreate");!this.option||r==="recreate"?cz(this,o):(this.restoreData(),this._mergeOption(o,n)),i=!0}if((r==="timeline"||r==="media")&&this.restoreData(),!r||r==="recreate"||r==="timeline"){var s=a.getTimelineOption(this);s&&(i=!0,this._mergeOption(s,n))}if(!r||r==="recreate"||r==="media"){var l=a.getMediaOption(this);l.length&&ce(l,function(u){i=!0,this._mergeOption(u,n)},this)}return i},t.prototype.mergeOption=function(r){this._mergeOption(r,null)},t.prototype._mergeOption=function(r,n){var i=this.option,a=this._componentsMap,o=this._componentsCount,s=[],l=ir(),u=n&&n.replaceMergeMainTypeMap;CRe(this),ce(r,function(c,h){c!=null&&(nn.hasClass(h)?h&&(s.push(h),l.set(h,!0)):i[h]=i[h]==null?mr(c):Ar(i[h],c,!0))}),u&&u.each(function(c,h){nn.hasClass(h)&&!l.get(h)&&(s.push(h),l.set(h,!0))}),nn.topologicalTravel(s,nn.getAllClassMainTypes(),f,this);function f(c){var h=RRe(this,c,na(r[c])),d=a.get(c),v=d?u&&u.get(c)?"replaceMerge":"normalMerge":"replaceAll",g=pTe(d,h,v);STe(g,c,nn),i[c]=null,a.set(c,null),o.set(c,0);var y=[],b=[],w=0,_;ce(g,function(x,T){var O=x.existing,E=x.newOption;if(!E)O&&(O.mergeOption({},this),O.optionUpdated({},!1));else{var M=c==="series",P=nn.getClass(c,x.keyInfo.subType,!M);if(!P)return;if(c==="tooltip"){if(_)return;_=!0}if(O&&O.constructor===P)O.name=x.keyInfo.name,O.mergeOption(E,this),O.optionUpdated(E,!1);else{var N=Ze({componentIndex:T},x.keyInfo);O=new P(E,this,this,N),Ze(O,N),x.brandNew&&(O.__requireNewView=!0),O.init(E,this,this),O.optionUpdated(null,!0)}}O?(y.push(O.option),b.push(O),w++):(y.push(void 0),b.push(void 0))},this),i[c]=y,a.set(c,b),o.set(c,w),c==="series"&&QC(this)}this._seriesIndices||QC(this)},t.prototype.getOption=function(){var r=mr(this.option);return ce(r,function(n,i){if(nn.hasClass(i)){for(var a=na(n),o=a.length,s=!1,l=o-1;l>=0;l--)a[l]&&!fw(a[l])?s=!0:(a[l]=null,!s&&o--);a.length=o,r[i]=a}}),delete r[hz],r},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(r){this._payload=r},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(r,n){var i=this._componentsMap.get(r);if(i){var a=i[n||0];if(a)return a;if(n==null){for(var o=0;o<i.length;o++)if(i[o])return i[o]}}},t.prototype.queryComponents=function(r){var n=r.mainType;if(!n)return[];var i=r.index,a=r.id,o=r.name,s=this._componentsMap.get(n);if(!s||!s.length)return[];var l;return i!=null?(l=[],ce(na(i),function(u){s[u]&&l.push(s[u])})):a!=null?l=dz("id",a,s):o!=null?l=dz("name",o,s):l=Qi(s,function(u){return!!u}),vz(l,r)},t.prototype.findComponents=function(r){var n=r.query,i=r.mainType,a=s(n),o=a?this.queryComponents(a):Qi(this._componentsMap.get(i),function(u){return!!u});return l(vz(o,r));function s(u){var f=i+"Index",c=i+"Id",h=i+"Name";return u&&(u[f]!=null||u[c]!=null||u[h]!=null)?{mainType:i,index:u[f],id:u[c],name:u[h]}:null}function l(u){return r.filter?Qi(u,r.filter):u}},t.prototype.eachComponent=function(r,n,i){var a=this._componentsMap;if(Zt(r)){var o=n,s=r;a.each(function(c,h){for(var d=0;c&&d<c.length;d++){var v=c[d];v&&s.call(o,h,v,v.componentIndex)}})}else for(var l=bt(r)?a.get(r):Tt(r)?this.findComponents(r):null,u=0;l&&u<l.length;u++){var f=l[u];f&&n.call(i,f,f.componentIndex)}},t.prototype.getSeriesByName=function(r){var n=sl(r,null);return Qi(this._componentsMap.get("series"),function(i){return!!i&&n!=null&&i.name===n})},t.prototype.getSeriesByIndex=function(r){return this._componentsMap.get("series")[r]},t.prototype.getSeriesByType=function(r){return Qi(this._componentsMap.get("series"),function(n){return!!n&&n.subType===r})},t.prototype.getSeries=function(){return Qi(this._componentsMap.get("series"),function(r){return!!r})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(r,n){f0(this),ce(this._seriesIndices,function(i){var a=this._componentsMap.get("series")[i];r.call(n,a,i)},this)},t.prototype.eachRawSeries=function(r,n){ce(this._componentsMap.get("series"),function(i){i&&r.call(n,i,i.componentIndex)})},t.prototype.eachSeriesByType=function(r,n,i){f0(this),ce(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];o.subType===r&&n.call(i,o,a)},this)},t.prototype.eachRawSeriesByType=function(r,n,i){return ce(this.getSeriesByType(r),n,i)},t.prototype.isSeriesFiltered=function(r){return f0(this),this._seriesIndicesMap.get(r.componentIndex)==null},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(r,n){f0(this);var i=[];ce(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];r.call(n,o,a)&&i.push(a)},this),this._seriesIndices=i,this._seriesIndicesMap=ir(i)},t.prototype.restoreData=function(r){QC(this);var n=this._componentsMap,i=[];n.each(function(a,o){nn.hasClass(o)&&i.push(o)}),nn.topologicalTravel(i,nn.getAllClassMainTypes(),function(a){ce(n.get(a),function(o){o&&(a!=="series"||!MRe(o,r))&&o.restoreData()})})},t.internalField=function(){QC=function(r){var n=r._seriesIndices=[];ce(r._componentsMap.get("series"),function(i){i&&n.push(i.componentIndex)}),r._seriesIndicesMap=ir(n)},f0=function(r){},cz=function(r,n){r.option={},r.option[hz]=IRe,r._componentsMap=ir({series:[]}),r._componentsCount=ir();var i=n.aria;Tt(i)&&i.enabled==null&&(i.enabled=!0),DRe(n,r._theme.option),Ar(n,SRe,!1),r._mergeOption(n,null)}}(),t}(Ei);function MRe(e,t){if(t){var r=t.seriesIndex,n=t.seriesId,i=t.seriesName;return r!=null&&e.componentIndex!==r||n!=null&&e.id!==n||i!=null&&e.name!==i}}function DRe(e,t){var r=e.color&&!e.colorLayer;ce(t,function(n,i){i==="colorLayer"&&r||nn.hasClass(i)||(typeof n=="object"?e[i]=e[i]?Ar(e[i],n,!1):mr(n):e[i]==null&&(e[i]=n))})}function dz(e,t,r){if(dt(t)){var n=ir();return ce(t,function(a){if(a!=null){var o=sl(a,null);o!=null&&n.set(a,!0)}}),Qi(r,function(a){return a&&n.get(a[e])})}else{var i=sl(t,null);return Qi(r,function(a){return a&&i!=null&&a[e]===i})}}function vz(e,t){return t.hasOwnProperty("subType")?Qi(e,function(r){return r&&r.subType===t.subType}):e}function pz(e){var t=ir();return e&&ce(na(e.replaceMerge),function(r){t.set(r,!0)}),{replaceMergeMainTypeMap:t}}hl(Sae,v3);const Cae=Sae;var $Re=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],NRe=function(){function e(t){ce($Re,function(r){this[r]=Jr(t[r],t)},this)}return e}();const xae=NRe;var jI={},LRe=function(){function e(){this._coordinateSystems=[]}return e.prototype.create=function(t,r){var n=[];ce(jI,function(i,a){var o=i.create(t,r);n=n.concat(o||[])}),this._coordinateSystems=n},e.prototype.update=function(t,r){ce(this._coordinateSystems,function(n){n.update&&n.update(t,r)})},e.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},e.register=function(t,r){jI[t]=r},e.get=function(t){return jI[t]},e}();const p3=LRe;var FRe=/^(min|max)?(.+)$/,HRe=function(){function e(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return e.prototype.setOption=function(t,r,n){t&&(ce(na(t.series),function(o){o&&o.data&&Xa(o.data)&&u$(o.data)}),ce(na(t.dataset),function(o){o&&o.source&&Xa(o.source)&&u$(o.source)})),t=mr(t);var i=this._optionBackup,a=BRe(t,r,!i);this._newBaseOption=a.baseOption,i?(a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},e.prototype.mountOption=function(t){var r=this._optionBackup;return this._timelineOptions=r.timelineOptions,this._mediaList=r.mediaList,this._mediaDefault=r.mediaDefault,this._currentMediaIndices=[],mr(t?r.baseOption:this._newBaseOption)},e.prototype.getTimelineOption=function(t){var r,n=this._timelineOptions;if(n.length){var i=t.getComponent("timeline");i&&(r=mr(n[i.getCurrentIndex()]))}return r},e.prototype.getMediaOption=function(t){var r=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,a=this._mediaDefault,o=[],s=[];if(!i.length&&!a)return s;for(var l=0,u=i.length;l<u;l++)VRe(i[l].query,r,n)&&o.push(l);return!o.length&&a&&(o=[-1]),o.length&&!jRe(o,this._currentMediaIndices)&&(s=Rt(o,function(f){return mr(f===-1?a.option:i[f].option)})),this._currentMediaIndices=o,s},e}();function BRe(e,t,r){var n=[],i,a,o=e.baseOption,s=e.timeline,l=e.options,u=e.media,f=!!e.media,c=!!(l||s||o&&o.timeline);o?(a=o,a.timeline||(a.timeline=s)):((c||f)&&(e.options=e.media=null),a=e),f&&dt(u)&&ce(u,function(d){d&&d.option&&(d.query?n.push(d):i||(i=d))}),h(a),ce(l,function(d){return h(d)}),ce(n,function(d){return h(d.option)});function h(d){ce(t,function(v){v(d,r)})}return{baseOption:a,timelineOptions:l||[],mediaDefault:i,mediaList:n}}function VRe(e,t,r){var n={width:t,height:r,aspectratio:t/r},i=!0;return ce(e,function(a,o){var s=o.match(FRe);if(!(!s||!s[1]||!s[2])){var l=s[1],u=s[2].toLowerCase();WRe(n[u],a,l)||(i=!1)}}),i}function WRe(e,t,r){return r==="min"?e>=t:r==="max"?e<=t:e===t}function jRe(e,t){return e.join(",")===t.join(",")}const URe=HRe;var Qo=ce,yw=Tt,gz=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function UI(e){var t=e&&e.itemStyle;if(t)for(var r=0,n=gz.length;r<n;r++){var i=gz[r],a=t.normal,o=t.emphasis;a&&a[i]&&(e[i]=e[i]||{},e[i].normal?Ar(e[i].normal,a[i]):e[i].normal=a[i],a[i]=null),o&&o[i]&&(e[i]=e[i]||{},e[i].emphasis?Ar(e[i].emphasis,o[i]):e[i].emphasis=o[i],o[i]=null)}}function Ci(e,t,r){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,i=e[t].emphasis;n&&(r?(e[t].normal=e[t].emphasis=null,Mr(e[t],n)):e[t]=n),i&&(e.emphasis=e.emphasis||{},e.emphasis[t]=i,i.focus&&(e.emphasis.focus=i.focus),i.blurScope&&(e.emphasis.blurScope=i.blurScope))}}function ob(e){Ci(e,"itemStyle"),Ci(e,"lineStyle"),Ci(e,"areaStyle"),Ci(e,"label"),Ci(e,"labelLine"),Ci(e,"upperLabel"),Ci(e,"edgeLabel")}function In(e,t){var r=yw(e)&&e[t],n=yw(r)&&r.textStyle;if(n)for(var i=0,a=g6.length;i<a;i++){var o=g6[i];n.hasOwnProperty(o)&&(r[o]=n[o])}}function So(e){e&&(ob(e),In(e,"label"),e.emphasis&&In(e.emphasis,"label"))}function zRe(e){if(yw(e)){UI(e),ob(e),In(e,"label"),In(e,"upperLabel"),In(e,"edgeLabel"),e.emphasis&&(In(e.emphasis,"label"),In(e.emphasis,"upperLabel"),In(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(UI(t),So(t));var r=e.markLine;r&&(UI(r),So(r));var n=e.markArea;n&&So(n);var i=e.data;if(e.type==="graph"){i=i||e.nodes;var a=e.links||e.edges;if(a&&!Xa(a))for(var o=0;o<a.length;o++)So(a[o]);ce(e.categories,function(u){ob(u)})}if(i&&!Xa(i))for(var o=0;o<i.length;o++)So(i[o]);if(t=e.markPoint,t&&t.data)for(var s=t.data,o=0;o<s.length;o++)So(s[o]);if(r=e.markLine,r&&r.data)for(var l=r.data,o=0;o<l.length;o++)dt(l[o])?(So(l[o][0]),So(l[o][1])):So(l[o]);e.type==="gauge"?(In(e,"axisLabel"),In(e,"title"),In(e,"detail")):e.type==="treemap"?(Ci(e.breadcrumb,"itemStyle"),ce(e.levels,function(u){ob(u)})):e.type==="tree"&&ob(e.leaves)}}function Ml(e){return dt(e)?e:e?[e]:[]}function yz(e){return(dt(e)?e[0]:e)||{}}function GRe(e,t){Qo(Ml(e.series),function(n){yw(n)&&zRe(n)});var r=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&r.push("valueAxis","categoryAxis","logAxis","timeAxis"),Qo(r,function(n){Qo(Ml(e[n]),function(i){i&&(In(i,"axisLabel"),In(i.axisPointer,"label"))})}),Qo(Ml(e.parallel),function(n){var i=n&&n.parallelAxisDefault;In(i,"axisLabel"),In(i&&i.axisPointer,"label")}),Qo(Ml(e.calendar),function(n){Ci(n,"itemStyle"),In(n,"dayLabel"),In(n,"monthLabel"),In(n,"yearLabel")}),Qo(Ml(e.radar),function(n){In(n,"name"),n.name&&n.axisName==null&&(n.axisName=n.name,delete n.name),n.nameGap!=null&&n.axisNameGap==null&&(n.axisNameGap=n.nameGap,delete n.nameGap)}),Qo(Ml(e.geo),function(n){yw(n)&&(So(n),Qo(Ml(n.regions),function(i){So(i)}))}),Qo(Ml(e.timeline),function(n){So(n),Ci(n,"label"),Ci(n,"itemStyle"),Ci(n,"controlStyle",!0);var i=n.data;dt(i)&&ce(i,function(a){Tt(a)&&(Ci(a,"label"),Ci(a,"itemStyle"))})}),Qo(Ml(e.toolbox),function(n){Ci(n,"iconStyle"),Qo(n.feature,function(i){Ci(i,"iconStyle")})}),In(yz(e.axisPointer),"label"),In(yz(e.tooltip).axisPointer,"label")}function YRe(e,t){for(var r=t.split(","),n=e,i=0;i<r.length&&(n=n&&n[r[i]],n!=null);i++);return n}function KRe(e,t,r,n){for(var i=t.split(","),a=e,o,s=0;s<i.length-1;s++)o=i[s],a[o]==null&&(a[o]={}),a=a[o];(n||a[i[s]]==null)&&(a[i[s]]=r)}function mz(e){e&&ce(XRe,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var XRe=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],qRe=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],zI=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function c0(e){var t=e&&e.itemStyle;if(t)for(var r=0;r<zI.length;r++){var n=zI[r][1],i=zI[r][0];t[n]!=null&&(t[i]=t[n])}}function bz(e){e&&e.alignTo==="edge"&&e.margin!=null&&e.edgeDistance==null&&(e.edgeDistance=e.margin)}function wz(e){e&&e.downplay&&!e.blur&&(e.blur=e.downplay)}function ZRe(e){e&&e.focusNodeAdjacency!=null&&(e.emphasis=e.emphasis||{},e.emphasis.focus==null&&(e.emphasis.focus="adjacency"))}function Tae(e,t){if(e)for(var r=0;r<e.length;r++)t(e[r]),e[r]&&Tae(e[r].children,t)}function Oae(e,t){GRe(e,t),e.series=na(e.series),ce(e.series,function(r){if(Tt(r)){var n=r.type;if(n==="line")r.clipOverflow!=null&&(r.clip=r.clipOverflow);else if(n==="pie"||n==="gauge"){r.clockWise!=null&&(r.clockwise=r.clockWise),bz(r.label);var i=r.data;if(i&&!Xa(i))for(var a=0;a<i.length;a++)bz(i[a]);r.hoverOffset!=null&&(r.emphasis=r.emphasis||{},(r.emphasis.scaleSize=null)&&(r.emphasis.scaleSize=r.hoverOffset))}else if(n==="gauge"){var o=YRe(r,"pointer.color");o!=null&&KRe(r,"itemStyle.color",o)}else if(n==="bar"){c0(r),c0(r.backgroundStyle),c0(r.emphasis);var i=r.data;if(i&&!Xa(i))for(var a=0;a<i.length;a++)typeof i[a]=="object"&&(c0(i[a]),c0(i[a]&&i[a].emphasis))}else if(n==="sunburst"){var s=r.highlightPolicy;s&&(r.emphasis=r.emphasis||{},r.emphasis.focus||(r.emphasis.focus=s)),wz(r),Tae(r.data,wz)}else n==="graph"||n==="sankey"?ZRe(r):n==="map"&&(r.mapType&&!r.map&&(r.map=r.mapType),r.mapLocation&&Mr(r,r.mapLocation));r.hoverAnimation!=null&&(r.emphasis=r.emphasis||{},r.emphasis&&r.emphasis.scale==null&&(r.emphasis.scale=r.hoverAnimation)),mz(r)}}),e.dataRange&&(e.visualMap=e.dataRange),ce(qRe,function(r){var n=e[r];n&&(dt(n)||(n=[n]),ce(n,function(i){mz(i)}))})}function JRe(e){var t=ir();e.eachSeries(function(r){var n=r.get("stack");if(n){var i=t.get(n)||t.set(n,[]),a=r.getData(),o={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:r};if(!o.stackedDimension||!(o.isStackedByIndex||o.stackedByDimension))return;i.length&&a.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(o)}}),t.each(QRe)}function QRe(e){ce(e,function(t,r){var n=[],i=[NaN,NaN],a=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";o.modify(a,function(u,f,c){var h=o.get(t.stackedDimension,c);if(isNaN(h))return i;var d,v;s?v=o.getRawIndex(c):d=o.get(t.stackedByDimension,c);for(var g=NaN,y=r-1;y>=0;y--){var b=e[y];if(s||(v=b.data.rawIndexOf(b.stackedByDimension,d)),v>=0){var w=b.data.getByRawIndex(b.stackResultDimension,v);if(l==="all"||l==="positive"&&w>0||l==="negative"&&w<0||l==="samesign"&&h>=0&&w>0||l==="samesign"&&h<=0&&w<0){h=uTe(h,w),g=w;break}}}return n[0]=h,n[1]=g,n})})}var wk=function(){function e(t){this.data=t.data||(t.sourceFormat===vl?{}:[]),this.sourceFormat=t.sourceFormat||mae,this.seriesLayoutBy=t.seriesLayoutBy||Tu,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var r=this.dimensionsDefine=t.dimensionsDefine;if(r)for(var n=0;n<r.length;n++){var i=r[n];i.type==null&&wae(this,n)===hi.Must&&(i.type="ordinal")}}return e}();function g3(e){return e instanceof wk}function V$(e,t,r){r=r||Eae(e);var n=t.seriesLayoutBy,i=tke(e,r,n,t.sourceHeader,t.dimensions),a=new wk({data:e,sourceFormat:r,seriesLayoutBy:n,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:mr(t)});return a}function y3(e){return new wk({data:e,sourceFormat:Xa(e)?jf:Bo})}function eke(e){return new wk({data:e.data,sourceFormat:e.sourceFormat,seriesLayoutBy:e.seriesLayoutBy,dimensionsDefine:mr(e.dimensionsDefine),startIndex:e.startIndex,dimensionsDetectedCount:e.dimensionsDetectedCount})}function Eae(e){var t=mae;if(Xa(e))t=jf;else if(dt(e)){e.length===0&&(t=Ra);for(var r=0,n=e.length;r<n;r++){var i=e[r];if(i!=null){if(dt(i)){t=Ra;break}else if(Tt(i)){t=ks;break}}}}else if(Tt(e)){for(var a in e)if(Qp(e,a)&&Ea(e[a])){t=vl;break}}return t}function tke(e,t,r,n,i){var a,o;if(!e)return{dimensionsDefine:_z(i),startIndex:o,dimensionsDetectedCount:a};if(t===Ra){var s=e;n==="auto"||n==null?Sz(function(u){u!=null&&u!=="-"&&(bt(u)?o==null&&(o=1):o=0)},r,s,10):o=Ur(n)?n:n?1:0,!i&&o===1&&(i=[],Sz(function(u,f){i[f]=u!=null?u+"":""},r,s,1/0)),a=i?i.length:r===bm?s.length:s[0]?s[0].length:null}else if(t===ks)i||(i=rke(e));else if(t===vl)i||(i=[],ce(e,function(u,f){i.push(f)}));else if(t===Bo){var l=BS(e[0]);a=dt(l)&&l.length||1}return{startIndex:o,dimensionsDefine:_z(i),dimensionsDetectedCount:a}}function rke(e){for(var t=0,r;t<e.length&&!(r=e[t++]););if(r)return sn(r)}function _z(e){if(e){var t=ir();return Rt(e,function(r,n){r=Tt(r)?r:{name:r};var i={name:r.name,displayName:r.displayName,type:r.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var a=t.get(i.name);return a?i.name+="-"+a.count++:t.set(i.name,{count:1}),i})}}function Sz(e,t,r,n){if(t===bm)for(var i=0;i<r.length&&i<n;i++)e(r[i]?r[i][0]:null,i);else for(var a=r[0]||[],i=0;i<a.length&&i<n;i++)e(a[i],i)}function Rae(e){var t=e.sourceFormat;return t===ks||t===vl}var th,rh,nh,Cz,xz,kae=function(){function e(t,r){var n=g3(t)?t:y3(t);this._source=n;var i=this._data=n.data;n.sourceFormat===jf&&(this._offset=0,this._dimSize=r,this._data=i),xz(this,i,n)}return e.prototype.getSource=function(){return this._source},e.prototype.count=function(){return 0},e.prototype.getItem=function(t,r){},e.prototype.appendData=function(t){},e.prototype.clean=function(){},e.protoInitialize=function(){var t=e.prototype;t.pure=!1,t.persistent=!0}(),e.internalField=function(){var t;xz=function(o,s,l){var u=l.sourceFormat,f=l.seriesLayoutBy,c=l.startIndex,h=l.dimensionsDefine,d=Cz[m3(u,f)];if(Ze(o,d),u===jf)o.getItem=r,o.count=i,o.fillStorage=n;else{var v=Aae(u,f);o.getItem=Jr(v,null,s,c,h);var g=Pae(u,f);o.count=Jr(g,null,s,c,h)}};var r=function(o,s){o=o-this._offset,s=s||[];for(var l=this._data,u=this._dimSize,f=u*o,c=0;c<u;c++)s[c]=l[f+c];return s},n=function(o,s,l,u){for(var f=this._data,c=this._dimSize,h=0;h<c;h++){for(var d=u[h],v=d[0]==null?1/0:d[0],g=d[1]==null?-1/0:d[1],y=s-o,b=l[h],w=0;w<y;w++){var _=f[w*c+h];b[o+w]=_,_<v&&(v=_),_>g&&(g=_)}d[0]=v,d[1]=g}},i=function(){return this._data?this._data.length/this._dimSize:0};Cz=(t={},t[Ra+"_"+Tu]={pure:!0,appendData:a},t[Ra+"_"+bm]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[ks]={pure:!0,appendData:a},t[vl]={pure:!0,appendData:function(o){var s=this._data;ce(o,function(l,u){for(var f=s[u]||(s[u]=[]),c=0;c<(l||[]).length;c++)f.push(l[c])})}},t[Bo]={appendData:a},t[jf]={persistent:!1,pure:!0,appendData:function(o){this._data=o},clean:function(){this._offset+=this.count(),this._data=null}},t);function a(o){for(var s=0;s<o.length;s++)this._data.push(o[s])}}(),e}(),Tz=function(e,t,r,n){return e[n]},nke=(th={},th[Ra+"_"+Tu]=function(e,t,r,n){return e[n+t]},th[Ra+"_"+bm]=function(e,t,r,n,i){n+=t;for(var a=i||[],o=e,s=0;s<o.length;s++){var l=o[s];a[s]=l?l[n]:null}return a},th[ks]=Tz,th[vl]=function(e,t,r,n,i){for(var a=i||[],o=0;o<r.length;o++){var s=r[o].name,l=e[s];a[o]=l?l[n]:null}return a},th[Bo]=Tz,th);function Aae(e,t){var r=nke[m3(e,t)];return r}var Oz=function(e,t,r){return e.length},ike=(rh={},rh[Ra+"_"+Tu]=function(e,t,r){return Math.max(0,e.length-t)},rh[Ra+"_"+bm]=function(e,t,r){var n=e[0];return n?Math.max(0,n.length-t):0},rh[ks]=Oz,rh[vl]=function(e,t,r){var n=r[0].name,i=e[n];return i?i.length:0},rh[Bo]=Oz,rh);function Pae(e,t){var r=ike[m3(e,t)];return r}var GI=function(e,t,r){return e[t]},ake=(nh={},nh[Ra]=GI,nh[ks]=function(e,t,r){return e[r]},nh[vl]=GI,nh[Bo]=function(e,t,r){var n=BS(e);return n instanceof Array?n[t]:n},nh[jf]=GI,nh);function Iae(e){var t=ake[e];return t}function m3(e,t){return e===Ra?e+"_"+t:e}function rg(e,t,r){if(e){var n=e.getRawDataItem(t);if(n!=null){var i=e.getStore(),a=i.getSource().sourceFormat;if(r!=null){var o=e.getDimensionIndex(r),s=i.getDimensionProperty(o);return Iae(a)(n,o,s)}else{var l=n;return a===Bo&&(l=BS(n)),l}}}}var oke=/\{@(.+?)\}/g,ske=function(){function e(){}return e.prototype.getDataParams=function(t,r){var n=this.getData(r),i=this.getRawValue(t,r),a=n.getRawIndex(t),o=n.getName(t),s=n.getRawDataItem(t),l=n.getItemVisual(t,"style"),u=l&&l[n.getItemVisual(t,"drawType")||"fill"],f=l&&l.stroke,c=this.mainType,h=c==="series",d=n.userOutput&&n.userOutput.get();return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:h?this.subType:null,seriesIndex:this.seriesIndex,seriesId:h?this.id:null,seriesName:h?this.name:null,name:o,dataIndex:a,data:s,dataType:r,value:i,color:u,borderColor:f,dimensionNames:d?d.fullDimensions:null,encode:d?d.encode:null,$vars:["seriesName","name","value"]}},e.prototype.getFormattedLabel=function(t,r,n,i,a,o){r=r||"normal";var s=this.getData(n),l=this.getDataParams(t,n);if(o&&(l.value=o.interpolatedValue),i!=null&&dt(l.value)&&(l.value=l.value[i]),!a){var u=s.getItemModel(t);a=u.get(r==="normal"?["label","formatter"]:[r,"label","formatter"])}if(Zt(a))return l.status=r,l.dimensionIndex=i,a(l);if(bt(a)){var f=pae(a,l);return f.replace(oke,function(c,h){var d=h.length,v=h;v.charAt(0)==="["&&v.charAt(d-1)==="]"&&(v=+v.slice(1,d-1));var g=rg(s,t,v);if(o&&dt(o.interpolatedValue)){var y=s.getDimensionIndex(v);y>=0&&(g=o.interpolatedValue[y])}return g!=null?g+"":""})}},e.prototype.getRawValue=function(t,r){return rg(this.getData(r),t)},e.prototype.formatTooltip=function(t,r,n){},e}();function Ez(e){var t,r;return Tt(e)?e.type&&(r=e):t=e,{text:t,frag:r}}function Ab(e){return new lke(e)}var lke=function(){function e(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return e.prototype.perform=function(t){var r=this._upstream,n=t&&t.skip;if(this._dirty&&r){var i=this.context;i.data=i.outputData=r.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var a;this._plan&&!n&&(a=this._plan(this.context));var o=f(this._modBy),s=this._modDataCount||0,l=f(t&&t.modBy),u=t&&t.modDataCount||0;(o!==l||s!==u)&&(a="reset");function f(w){return!(w>=1)&&(w=1),w}var c;(this._dirty||a==="reset")&&(this._dirty=!1,c=this._doReset(n)),this._modBy=l,this._modDataCount=u;var h=t&&t.step;if(r?this._dueEnd=r._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var d=this._dueIndex,v=Math.min(h!=null?this._dueIndex+h:1/0,this._dueEnd);if(!n&&(c||d<v)){var g=this._progress;if(dt(g))for(var y=0;y<g.length;y++)this._doProgress(g[y],d,v,l,u);else this._doProgress(g,d,v,l,u)}this._dueIndex=v;var b=this._settedOutputEnd!=null?this._settedOutputEnd:v;this._outputDueEnd=b}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},e.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},e.prototype._doProgress=function(t,r,n,i,a){Rz.reset(r,n,i,a),this._callingProgress=t,this._callingProgress({start:r,end:n,count:n-r,next:Rz.next},this.context)},e.prototype._doReset=function(t){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var r,n;!t&&this._reset&&(r=this._reset(this.context),r&&r.progress&&(n=r.forceFirstProgress,r=r.progress),dt(r)&&!r.length&&(r=null)),this._progress=r,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),n},e.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},e.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},e.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},e.prototype.getUpstream=function(){return this._upstream},e.prototype.getDownstream=function(){return this._downstream},e.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},e}(),Rz=function(){var e,t,r,n,i,a={reset:function(l,u,f,c){t=l,e=u,r=f,n=c,i=Math.ceil(n/r),a.next=r>1&&n>0?s:o}};return a;function o(){return t<e?t++:null}function s(){var l=t%i*r+Math.ceil(t/i),u=t>=e?null:l<n?l:t;return t++,u}}();function JT(e,t){var r=t&&t.type;return r==="ordinal"?e:(r==="time"&&!Ur(e)&&e!=null&&e!=="-"&&(e=+Au(e)),e==null||e===""?NaN:+e)}ir({number:function(e){return parseFloat(e)},time:function(e){return+Au(e)},trim:function(e){return bt(e)?al(e):e}});var uke=function(){function e(t,r){var n=t==="desc";this._resultLT=n?1:-1,r==null&&(r=n?"min":"max"),this._incomparable=r==="min"?-1/0:1/0}return e.prototype.evaluate=function(t,r){var n=Ur(t)?t:iE(t),i=Ur(r)?r:iE(r),a=isNaN(n),o=isNaN(i);if(a&&(n=this._incomparable),o&&(i=this._incomparable),a&&o){var s=bt(t),l=bt(r);s&&(n=l?t:0),l&&(i=s?r:0)}return n<i?this._resultLT:n>i?-this._resultLT:0},e}(),fke=function(){function e(){}return e.prototype.getRawData=function(){throw new Error("not supported")},e.prototype.getRawDataItem=function(t){throw new Error("not supported")},e.prototype.cloneRawData=function(){},e.prototype.getDimensionInfo=function(t){},e.prototype.cloneAllDimensionInfo=function(){},e.prototype.count=function(){},e.prototype.retrieveValue=function(t,r){},e.prototype.retrieveValueFromItem=function(t,r){},e.prototype.convertValue=function(t,r){return JT(t,r)},e}();function cke(e,t){var r=new fke,n=e.data,i=r.sourceFormat=e.sourceFormat,a=e.startIndex,o="";e.seriesLayoutBy!==Tu&&Sa(o);var s=[],l={},u=e.dimensionsDefine;if(u)ce(u,function(g,y){var b=g.name,w={index:y,name:b,displayName:g.displayName};if(s.push(w),b!=null){var _="";Qp(l,b)&&Sa(_),l[b]=w}});else for(var f=0;f<e.dimensionsDetectedCount;f++)s.push({index:f});var c=Aae(i,Tu);t.__isBuiltIn&&(r.getRawDataItem=function(g){return c(n,a,s,g)},r.getRawData=Jr(hke,null,e)),r.cloneRawData=Jr(dke,null,e);var h=Pae(i,Tu);r.count=Jr(h,null,n,a,s);var d=Iae(i);r.retrieveValue=function(g,y){var b=c(n,a,s,g);return v(b,y)};var v=r.retrieveValueFromItem=function(g,y){if(g!=null){var b=s[y];if(b)return d(g,y,b.name)}};return r.getDimensionInfo=Jr(vke,null,s,l),r.cloneAllDimensionInfo=Jr(pke,null,s),r}function hke(e){var t=e.sourceFormat;if(!b3(t)){var r="";Sa(r)}return e.data}function dke(e){var t=e.sourceFormat,r=e.data;if(!b3(t)){var n="";Sa(n)}if(t===Ra){for(var i=[],a=0,o=r.length;a<o;a++)i.push(r[a].slice());return i}else if(t===ks){for(var i=[],a=0,o=r.length;a<o;a++)i.push(Ze({},r[a]));return i}}function vke(e,t,r){if(r!=null){if(Ur(r)||!isNaN(r)&&!Qp(t,r))return e[r];if(Qp(t,r))return t[r]}}function pke(e){return mr(e)}var Mae=ir();function gke(e){e=mr(e);var t=e.type,r="";t||Sa(r);var n=t.split(":");n.length!==2&&Sa(r);var i=!1;n[0]==="echarts"&&(t=n[1],i=!0),e.__isBuiltIn=i,Mae.set(t,e)}function yke(e,t,r){var n=na(e),i=n.length,a="";i||Sa(a);for(var o=0,s=i;o<s;o++){var l=n[o];t=mke(l,t),o!==s-1&&(t.length=Math.max(t.length,1))}return t}function mke(e,t,r,n){var i="";t.length||Sa(i),Tt(e)||Sa(i);var a=e.type,o=Mae.get(a);o||Sa(i);var s=Rt(t,function(u){return cke(u,o)}),l=na(o.transform({upstream:s[0],upstreamList:s,config:mr(e.config)}));return Rt(l,function(u,f){var c="";Tt(u)||Sa(c),u.data||Sa(c);var h=Eae(u.data);b3(h)||Sa(c);var d,v=t[0];if(v&&f===0&&!u.dimensions){var g=v.startIndex;g&&(u.data=v.data.slice(0,g).concat(u.data)),d={seriesLayoutBy:Tu,sourceHeader:g,dimensions:v.metaRawOption.dimensions}}else d={seriesLayoutBy:Tu,sourceHeader:0,dimensions:u.dimensions};return V$(u.data,d,null)})}function b3(e){return e===Ra||e===ks}var _k="undefined",bke=typeof Uint32Array===_k?Array:Uint32Array,wke=typeof Uint16Array===_k?Array:Uint16Array,Dae=typeof Int32Array===_k?Array:Int32Array,kz=typeof Float64Array===_k?Array:Float64Array,$ae={float:kz,int:Dae,ordinal:Array,number:Array,time:kz},YI;function h0(e){return e>65535?bke:wke}function kv(){return[1/0,-1/0]}function _ke(e){var t=e.constructor;return t===Array?e.slice():new t(e)}function Az(e,t,r,n,i){var a=$ae[r||"float"];if(i){var o=e[t],s=o&&o.length;if(s!==n){for(var l=new a(n),u=0;u<s;u++)l[u]=o[u];e[t]=l}}else e[t]=new a(n)}var W$=function(){function e(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=ir()}return e.prototype.initData=function(t,r,n){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=t.getSource(),a=this.defaultDimValueGetter=YI[i.sourceFormat];this._dimValueGetter=n||a,this._rawExtent=[],Rae(i),this._dimensions=Rt(r,function(o){return{type:o.type,property:o.property}}),this._initDataFromProvider(0,t.count())},e.prototype.getProvider=function(){return this._provider},e.prototype.getSource=function(){return this._provider.getSource()},e.prototype.ensureCalculationDimension=function(t,r){var n=this._calcDimNameToIdx,i=this._dimensions,a=n.get(t);if(a!=null){if(i[a].type===r)return a}else a=i.length;return i[a]={type:r},n.set(t,a),this._chunks[a]=new $ae[r||"float"](this._rawCount),this._rawExtent[a]=kv(),a},e.prototype.collectOrdinalMeta=function(t,r){var n=this._chunks[t],i=this._dimensions[t],a=this._rawExtent,o=i.ordinalOffset||0,s=n.length;o===0&&(a[t]=kv());for(var l=a[t],u=o;u<s;u++){var f=n[u]=r.parseAndCollect(n[u]);isNaN(f)||(l[0]=Math.min(f,l[0]),l[1]=Math.max(f,l[1]))}i.ordinalMeta=r,i.ordinalOffset=s,i.type="ordinal"},e.prototype.getOrdinalMeta=function(t){var r=this._dimensions[t],n=r.ordinalMeta;return n},e.prototype.getDimensionProperty=function(t){var r=this._dimensions[t];return r&&r.property},e.prototype.appendData=function(t){var r=this._provider,n=this.count();r.appendData(t);var i=r.count();return r.persistent||(i+=n),n<i&&this._initDataFromProvider(n,i,!0),[n,i]},e.prototype.appendValues=function(t,r){for(var n=this._chunks,i=this._dimensions,a=i.length,o=this._rawExtent,s=this.count(),l=s+Math.max(t.length,r||0),u=0;u<a;u++){var f=i[u];Az(n,u,f.type,l,!0)}for(var c=[],h=s;h<l;h++)for(var d=h-s,v=0;v<a;v++){var f=i[v],g=YI.arrayRows.call(this,t[d]||c,f.property,d,v);n[v][h]=g;var y=o[v];g<y[0]&&(y[0]=g),g>y[1]&&(y[1]=g)}return this._rawCount=this._count=l,{start:s,end:l}},e.prototype._initDataFromProvider=function(t,r,n){for(var i=this._provider,a=this._chunks,o=this._dimensions,s=o.length,l=this._rawExtent,u=Rt(o,function(w){return w.property}),f=0;f<s;f++){var c=o[f];l[f]||(l[f]=kv()),Az(a,f,c.type,r,n)}if(i.fillStorage)i.fillStorage(t,r,a,l);else for(var h=[],d=t;d<r;d++){h=i.getItem(d,h);for(var v=0;v<s;v++){var g=a[v],y=this._dimValueGetter(h,u[v],d,v);g[d]=y;var b=l[v];y<b[0]&&(b[0]=y),y>b[1]&&(b[1]=y)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=r,this._extent=[]},e.prototype.count=function(){return this._count},e.prototype.get=function(t,r){if(!(r>=0&&r<this._count))return NaN;var n=this._chunks[t];return n?n[this.getRawIndex(r)]:NaN},e.prototype.getValues=function(t,r){var n=[],i=[];if(r==null){r=t,t=[];for(var a=0;a<this._dimensions.length;a++)i.push(a)}else i=t;for(var a=0,o=i.length;a<o;a++)n.push(this.get(i[a],r));return n},e.prototype.getByRawIndex=function(t,r){if(!(r>=0&&r<this._rawCount))return NaN;var n=this._chunks[t];return n?n[r]:NaN},e.prototype.getSum=function(t){var r=this._chunks[t],n=0;if(r)for(var i=0,a=this.count();i<a;i++){var o=this.get(t,i);isNaN(o)||(n+=o)}return n},e.prototype.getMedian=function(t){var r=[];this.each([t],function(a){isNaN(a)||r.push(a)});var n=r.sort(function(a,o){return a-o}),i=this.count();return i===0?0:i%2===1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},e.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var r=this._indices,n=r[t];if(n!=null&&n<this._count&&n===t)return t;for(var i=0,a=this._count-1;i<=a;){var o=(i+a)/2|0;if(r[o]<t)i=o+1;else if(r[o]>t)a=o-1;else return o}return-1},e.prototype.indicesOfNearest=function(t,r,n){var i=this._chunks,a=i[t],o=[];if(!a)return o;n==null&&(n=1/0);for(var s=1/0,l=-1,u=0,f=0,c=this.count();f<c;f++){var h=this.getRawIndex(f),d=r-a[h],v=Math.abs(d);v<=n&&((v<s||v===s&&d>=0&&l<0)&&(s=v,l=d,u=0),d===l&&(o[u++]=f))}return o.length=u,o},e.prototype.getIndices=function(){var t,r=this._indices;if(r){var n=r.constructor,i=this._count;if(n===Array){t=new n(i);for(var a=0;a<i;a++)t[a]=r[a]}else t=new n(r.buffer,0,i)}else{var n=h0(this._rawCount);t=new n(this.count());for(var a=0;a<t.length;a++)t[a]=a}return t},e.prototype.filter=function(t,r){if(!this._count)return this;for(var n=this.clone(),i=n.count(),a=h0(n._rawCount),o=new a(i),s=[],l=t.length,u=0,f=t[0],c=n._chunks,h=0;h<i;h++){var d=void 0,v=n.getRawIndex(h);if(l===0)d=r(h);else if(l===1){var g=c[f][v];d=r(g,h)}else{for(var y=0;y<l;y++)s[y]=c[t[y]][v];s[y]=h,d=r.apply(null,s)}d&&(o[u++]=v)}return u<i&&(n._indices=o),n._count=u,n._extent=[],n._updateGetRawIdx(),n},e.prototype.selectRange=function(t){var r=this.clone(),n=r._count;if(!n)return this;var i=sn(t),a=i.length;if(!a)return this;var o=r.count(),s=h0(r._rawCount),l=new s(o),u=0,f=i[0],c=t[f][0],h=t[f][1],d=r._chunks,v=!1;if(!r._indices){var g=0;if(a===1){for(var y=d[i[0]],b=0;b<n;b++){var w=y[b];(w>=c&&w<=h||isNaN(w))&&(l[u++]=g),g++}v=!0}else if(a===2){for(var y=d[i[0]],_=d[i[1]],x=t[i[1]][0],T=t[i[1]][1],b=0;b<n;b++){var w=y[b],O=_[b];(w>=c&&w<=h||isNaN(w))&&(O>=x&&O<=T||isNaN(O))&&(l[u++]=g),g++}v=!0}}if(!v)if(a===1)for(var b=0;b<o;b++){var E=r.getRawIndex(b),w=d[i[0]][E];(w>=c&&w<=h||isNaN(w))&&(l[u++]=E)}else for(var b=0;b<o;b++){for(var M=!0,E=r.getRawIndex(b),P=0;P<a;P++){var N=i[P],w=d[N][E];(w<t[N][0]||w>t[N][1])&&(M=!1)}M&&(l[u++]=r.getRawIndex(b))}return u<o&&(r._indices=l),r._count=u,r._extent=[],r._updateGetRawIdx(),r},e.prototype.map=function(t,r){var n=this.clone(t);return this._updateDims(n,t,r),n},e.prototype.modify=function(t,r){this._updateDims(this,t,r)},e.prototype._updateDims=function(t,r,n){for(var i=t._chunks,a=[],o=r.length,s=t.count(),l=[],u=t._rawExtent,f=0;f<r.length;f++)u[r[f]]=kv();for(var c=0;c<s;c++){for(var h=t.getRawIndex(c),d=0;d<o;d++)l[d]=i[r[d]][h];l[o]=c;var v=n&&n.apply(null,l);if(v!=null){typeof v!="object"&&(a[0]=v,v=a);for(var f=0;f<v.length;f++){var g=r[f],y=v[f],b=u[g],w=i[g];w&&(w[h]=y),y<b[0]&&(b[0]=y),y>b[1]&&(b[1]=y)}}}},e.prototype.lttbDownSample=function(t,r){var n=this.clone([t],!0),i=n._chunks,a=i[t],o=this.count(),s=0,l=Math.floor(1/r),u=this.getRawIndex(0),f,c,h,d=new(h0(this._rawCount))(Math.min((Math.ceil(o/l)+2)*2,o));d[s++]=u;for(var v=1;v<o-1;v+=l){for(var g=Math.min(v+l,o-1),y=Math.min(v+l*2,o),b=(y+g)/2,w=0,_=g;_<y;_++){var x=this.getRawIndex(_),T=a[x];isNaN(T)||(w+=T)}w/=y-g;var O=v,E=Math.min(v+l,o),M=v-1,P=a[u];f=-1,h=O;for(var N=-1,D=0,_=O;_<E;_++){var x=this.getRawIndex(_),T=a[x];if(isNaN(T)){D++,N<0&&(N=x);continue}c=Math.abs((M-b)*(T-P)-(M-_)*(w-P)),c>f&&(f=c,h=x)}D>0&&D<E-O&&(d[s++]=Math.min(N,h),h=Math.max(N,h)),d[s++]=h,u=h}return d[s++]=this.getRawIndex(o-1),n._count=s,n._indices=d,n.getRawIndex=this._getRawIdx,n},e.prototype.downSample=function(t,r,n,i){for(var a=this.clone([t],!0),o=a._chunks,s=[],l=Math.floor(1/r),u=o[t],f=this.count(),c=a._rawExtent[t]=kv(),h=new(h0(this._rawCount))(Math.ceil(f/l)),d=0,v=0;v<f;v+=l){l>f-v&&(l=f-v,s.length=l);for(var g=0;g<l;g++){var y=this.getRawIndex(v+g);s[g]=u[y]}var b=n(s),w=this.getRawIndex(Math.min(v+i(s,b)||0,f-1));u[w]=b,b<c[0]&&(c[0]=b),b>c[1]&&(c[1]=b),h[d++]=w}return a._count=d,a._indices=h,a._updateGetRawIdx(),a},e.prototype.each=function(t,r){if(this._count)for(var n=t.length,i=this._chunks,a=0,o=this.count();a<o;a++){var s=this.getRawIndex(a);switch(n){case 0:r(a);break;case 1:r(i[t[0]][s],a);break;case 2:r(i[t[0]][s],i[t[1]][s],a);break;default:for(var l=0,u=[];l<n;l++)u[l]=i[t[l]][s];u[l]=a,r.apply(null,u)}}},e.prototype.getDataExtent=function(t){var r=this._chunks[t],n=kv();if(!r)return n;var i=this.count(),a=!this._indices,o;if(a)return this._rawExtent[t].slice();if(o=this._extent[t],o)return o.slice();o=n;for(var s=o[0],l=o[1],u=0;u<i;u++){var f=this.getRawIndex(u),c=r[f];c<s&&(s=c),c>l&&(l=c)}return o=[s,l],this._extent[t]=o,o},e.prototype.getRawDataItem=function(t){var r=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(r);for(var n=[],i=this._chunks,a=0;a<i.length;a++)n.push(i[a][r]);return n},e.prototype.clone=function(t,r){var n=new e,i=this._chunks,a=t&&sc(t,function(s,l){return s[l]=!0,s},{});if(a)for(var o=0;o<i.length;o++)n._chunks[o]=a[o]?_ke(i[o]):i[o];else n._chunks=i;return this._copyCommonProps(n),r||(n._indices=this._cloneIndices()),n._updateGetRawIdx(),n},e.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=mr(this._extent),t._rawExtent=mr(this._rawExtent)},e.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,r=void 0;if(t===Array){var n=this._indices.length;r=new t(n);for(var i=0;i<n;i++)r[i]=this._indices[i]}else r=new t(this._indices);return r}return null},e.prototype._getRawIdxIdentity=function(t){return t},e.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},e.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},e.internalField=function(){function t(r,n,i,a){return JT(r[a],this._dimensions[a])}YI={arrayRows:t,objectRows:function(r,n,i,a){return JT(r[n],this._dimensions[a])},keyedColumns:t,original:function(r,n,i,a){var o=r&&(r.value==null?r:r.value);return JT(o instanceof Array?o[a]:o,this._dimensions[a])},typedArray:function(r,n,i,a){return r[a]}}}(),e}(),Ske=function(){function e(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return e.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},e.prototype._setLocalSource=function(t,r){this._sourceList=t,this._upstreamSignList=r,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},e.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},e.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},e.prototype._createSource=function(){this._setLocalSource([],[]);var t=this._sourceHost,r=this._getUpstreamSourceManagers(),n=!!r.length,i,a;if(ex(t)){var o=t,s=void 0,l=void 0,u=void 0;if(n){var f=r[0];f.prepareSource(),u=f.getSource(),s=u.data,l=u.sourceFormat,a=[f._getVersionSign()]}else s=o.get("data",!0),l=Xa(s)?jf:Bo,a=[];var c=this._getSourceMetaRawOption()||{},h=u&&u.metaRawOption||{},d=pr(c.seriesLayoutBy,h.seriesLayoutBy)||null,v=pr(c.sourceHeader,h.sourceHeader),g=pr(c.dimensions,h.dimensions),y=d!==h.seriesLayoutBy||!!v!=!!h.sourceHeader||g;i=y?[V$(s,{seriesLayoutBy:d,sourceHeader:v,dimensions:g},l)]:[]}else{var b=t;if(n){var w=this._applyTransform(r);i=w.sourceList,a=w.upstreamSignList}else{var _=b.get("source",!0);i=[V$(_,this._getSourceMetaRawOption(),null)],a=[]}}this._setLocalSource(i,a)},e.prototype._applyTransform=function(t){var r=this._sourceHost,n=r.get("transform",!0),i=r.get("fromTransformResult",!0);if(i!=null){var a="";t.length!==1&&Pz(a)}var o,s=[],l=[];return ce(t,function(u){u.prepareSource();var f=u.getSource(i||0),c="";i!=null&&!f&&Pz(c),s.push(f),l.push(u._getVersionSign())}),n?o=yke(n,s,{datasetIndex:r.componentIndex}):i!=null&&(o=[eke(s[0])]),{sourceList:o,upstreamSignList:l}},e.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),r=0;r<t.length;r++){var n=t[r];if(n._isDirty()||this._upstreamSignList[r]!==n._getVersionSign())return!0}},e.prototype.getSource=function(t){t=t||0;var r=this._sourceList[t];if(!r){var n=this._getUpstreamSourceManagers();return n[0]&&n[0].getSource(t)}return r},e.prototype.getSharedDataStore=function(t){var r=t.makeStoreSchema();return this._innerGetDataStore(r.dimensions,t.source,r.hash)},e.prototype._innerGetDataStore=function(t,r,n){var i=0,a=this._storeList,o=a[i];o||(o=a[i]={});var s=o[n];if(!s){var l=this._getUpstreamSourceManagers()[0];ex(this._sourceHost)&&l?s=l._innerGetDataStore(t,r,n):(s=new W$,s.initData(new kae(r,t.length),t)),o[n]=s}return s},e.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(ex(t)){var r=d3(t);return r?[r.getSourceManager()]:[]}else return Rt(ORe(t),function(n){return n.getSourceManager()})},e.prototype._getSourceMetaRawOption=function(){var t=this._sourceHost,r,n,i;if(ex(t))r=t.get("seriesLayoutBy",!0),n=t.get("sourceHeader",!0),i=t.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=t;r=a.get("seriesLayoutBy",!0),n=a.get("sourceHeader",!0),i=a.get("dimensions",!0)}return{seriesLayoutBy:r,sourceHeader:n,dimensions:i}},e}();function ex(e){return e.mainType==="series"}function Pz(e){throw new Error(e)}var Nae="line-height:1";function Lae(e,t){var r=e.color||"#6e7079",n=e.fontSize||12,i=e.fontWeight||"400",a=e.color||"#464646",o=e.fontSize||14,s=e.fontWeight||"900";return t==="html"?{nameStyle:"font-size:"+Oo(n+"")+"px;color:"+Oo(r)+";font-weight:"+Oo(i+""),valueStyle:"font-size:"+Oo(o+"")+"px;color:"+Oo(a)+";font-weight:"+Oo(s+"")}:{nameStyle:{fontSize:n,fill:r,fontWeight:i},valueStyle:{fontSize:o,fill:a,fontWeight:s}}}var Cke=[0,10,20,30],xke=["",`
`,`

`,`


`];function mw(e,t){return t.type=e,t}function j$(e){return e.type==="section"}function Fae(e){return j$(e)?Tke:Oke}function Hae(e){if(j$(e)){var t=0,r=e.blocks.length,n=r>1||r>0&&!e.noHeader;return ce(e.blocks,function(i){var a=Hae(i);a>=t&&(t=a+ +(n&&(!a||j$(i)&&!i.noHeader)))}),t}return 0}function Tke(e,t,r,n){var i=t.noHeader,a=Eke(Hae(t)),o=[],s=t.blocks||[];ku(!s||dt(s)),s=s||[];var l=e.orderMode;if(t.sortBlocks&&l){s=s.slice();var u={valueAsc:"asc",valueDesc:"desc"};if(Qp(u,l)){var f=new uke(u[l],null);s.sort(function(v,g){return f.evaluate(v.sortParam,g.sortParam)})}else l==="seriesDesc"&&s.reverse()}ce(s,function(v,g){var y=t.valueFormatter,b=Fae(v)(y?Ze(Ze({},e),{valueFormatter:y}):e,v,g>0?a.html:0,n);b!=null&&o.push(b)});var c=e.renderMode==="richText"?o.join(a.richText):U$(o.join(""),i?r:a.html);if(i)return c;var h=B$(t.header,"ordinal",e.useUTC),d=Lae(n,e.renderMode).nameStyle;return e.renderMode==="richText"?Bae(e,h,d)+a.richText+c:U$('<div style="'+d+";"+Nae+';">'+Oo(h)+"</div>"+c,r)}function Oke(e,t,r,n){var i=e.renderMode,a=t.noName,o=t.noValue,s=!t.markerType,l=t.name,u=e.useUTC,f=t.valueFormatter||e.valueFormatter||function(x){return x=dt(x)?x:[x],Rt(x,function(T,O){return B$(T,dt(d)?d[O]:d,u)})};if(!(a&&o)){var c=s?"":e.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",i),h=a?"":B$(l,"ordinal",u),d=t.valueType,v=o?[]:f(t.value),g=!s||!a,y=!s&&a,b=Lae(n,i),w=b.nameStyle,_=b.valueStyle;return i==="richText"?(s?"":c)+(a?"":Bae(e,h,w))+(o?"":Ake(e,v,g,y,_)):U$((s?"":c)+(a?"":Rke(h,!s,w))+(o?"":kke(v,g,y,_)),r)}}function Iz(e,t,r,n,i,a){if(e){var o=Fae(e),s={useUTC:i,renderMode:r,orderMode:n,markupStyleCreator:t,valueFormatter:e.valueFormatter};return o(s,e,0,a)}}function Eke(e){return{html:Cke[e],richText:xke[e]}}function U$(e,t){var r='<div style="clear:both"></div>',n="margin: "+t+"px 0 0";return'<div style="'+n+";"+Nae+';">'+e+r+"</div>"}function Rke(e,t,r){var n=t?"margin-left:2px":"";return'<span style="'+r+";"+n+'">'+Oo(e)+"</span>"}function kke(e,t,r,n){var i=r?"10px":"20px",a=t?"float:right;margin-left:"+i:"";return e=dt(e)?e:[e],'<span style="'+a+";"+n+'">'+Rt(e,function(o){return Oo(o)}).join("&nbsp;&nbsp;")+"</span>"}function Bae(e,t,r){return e.markupStyleCreator.wrapRichTextStyle(t,r)}function Ake(e,t,r,n,i){var a=[i],o=n?10:20;return r&&a.push({padding:[0,0,0,o],align:"right"}),e.markupStyleCreator.wrapRichTextStyle(dt(t)?t.join("  "):t,a)}function Pke(e,t){var r=e.getData().getItemVisual(t,"style"),n=r[e.visualDrawType];return md(n)}function Vae(e,t){var r=e.get("padding");return r??(t==="richText"?[8,10]:10)}var KI=function(){function e(){this.richTextStyles={},this._nextStyleNameId=eie()}return e.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},e.prototype.makeTooltipMarker=function(t,r,n){var i=n==="richText"?this._generateStyleName():null,a=yRe({color:r,type:t,renderMode:n,markerId:i});return bt(a)?a:(this.richTextStyles[i]=a.style,a.content)},e.prototype.wrapRichTextStyle=function(t,r){var n={};dt(r)?ce(r,function(a){return Ze(n,a)}):Ze(n,r);var i=this._generateStyleName();return this.richTextStyles[i]=n,"{"+i+"|"+t+"}"},e}();function Ike(e){var t=e.series,r=e.dataIndex,n=e.multipleSeries,i=t.getData(),a=i.mapDimensionsAll("defaultedTooltip"),o=a.length,s=t.getRawValue(r),l=dt(s),u=Pke(t,r),f,c,h,d;if(o>1||l&&!o){var v=Mke(s,t,r,a,u);f=v.inlineValues,c=v.inlineValueTypes,h=v.blocks,d=v.inlineValues[0]}else if(o){var g=i.getDimensionInfo(a[0]);d=f=rg(i,r,a[0]),c=g.type}else d=f=l?s[0]:s;var y=GB(t),b=y&&t.name||"",w=i.getName(r),_=n?b:w;return mw("section",{header:b,noHeader:n||!y,sortParam:d,blocks:[mw("nameValue",{markerType:"item",markerColor:u,name:_,noName:!al(_),value:f,valueType:c})].concat(h||[])})}function Mke(e,t,r,n,i){var a=t.getData(),o=sc(e,function(c,h,d){var v=a.getDimensionInfo(d);return c=c||v&&v.tooltip!==!1&&v.displayName!=null},!1),s=[],l=[],u=[];n.length?ce(n,function(c){f(rg(a,r,c),c)}):ce(e,f);function f(c,h){var d=a.getDimensionInfo(h);!d||d.otherDims.tooltip===!1||(o?u.push(mw("nameValue",{markerType:"subItem",markerColor:i,name:d.displayName,value:c,valueType:d.type})):(s.push(c),l.push(d.type)))}return{inlineValues:s,inlineValueTypes:l,blocks:u}}var lf=zn();function tx(e,t){return e.getName(t)||e.getId(t)}var Dke="__universalTransitionEnabled",Sk=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._selectedDataIndicesMap={},r}return t.prototype.init=function(r,n,i){this.seriesIndex=this.componentIndex,this.dataTask=Ab({count:Nke,reset:Lke}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(r,i);var a=lf(this).sourceManager=new Ske(this);a.prepareSource();var o=this.getInitialData(r,i);Dz(o,this),this.dataTask.context.data=o,lf(this).dataBeforeProcessed=o,Mz(this),this._initSelectedMapFromData(o)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=gw(this),a=i?bk(r):{},o=this.subType;nn.hasClass(o)&&(o+="Series"),Ar(r,n.getTheme().get(this.subType)),Ar(r,this.getDefaultOption()),R$(r,"label",["show"]),this.fillDataTextStyle(r.data),i&&tg(r,a,i)},t.prototype.mergeOption=function(r,n){r=Ar(this.option,r,!0),this.fillDataTextStyle(r.data);var i=gw(this);i&&tg(this.option,r,i);var a=lf(this).sourceManager;a.dirty(),a.prepareSource();var o=this.getInitialData(r,n);Dz(o,this),this.dataTask.dirty(),this.dataTask.context.data=o,lf(this).dataBeforeProcessed=o,Mz(this),this._initSelectedMapFromData(o)},t.prototype.fillDataTextStyle=function(r){if(r&&!Xa(r))for(var n=["show"],i=0;i<r.length;i++)r[i]&&r[i].label&&R$(r[i],"label",n)},t.prototype.getInitialData=function(r,n){},t.prototype.appendData=function(r){var n=this.getRawData();n.appendData(r.data)},t.prototype.getData=function(r){var n=z$(this);if(n){var i=n.context.data;return r==null?i:i.getLinkedData(r)}else return lf(this).data},t.prototype.getAllData=function(){var r=this.getData();return r&&r.getLinkedDataAll?r.getLinkedDataAll():[{data:r}]},t.prototype.setData=function(r){var n=z$(this);if(n){var i=n.context;i.outputData=r,n!==this.dataTask&&(i.data=r)}lf(this).data=r},t.prototype.getEncode=function(){var r=this.get("encode",!0);if(r)return ir(r)},t.prototype.getSourceManager=function(){return lf(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return lf(this).dataBeforeProcessed},t.prototype.getColorBy=function(){var r=this.get("colorBy");return r||"series"},t.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},t.prototype.getBaseAxis=function(){var r=this.coordinateSystem;return r&&r.getBaseAxis&&r.getBaseAxis()},t.prototype.formatTooltip=function(r,n,i){return Ike({series:this,dataIndex:r,multipleSeries:n})},t.prototype.isAnimationEnabled=function(){var r=this.ecModel;if(nr.node&&!(r&&r.ssr))return!1;var n=this.getShallow("animation");return n&&this.getData().count()>this.getShallow("animationThreshold")&&(n=!1),!!n},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(r,n,i){var a=this.ecModel,o=v3.prototype.getColorFromPalette.call(this,r,n,i);return o||(o=a.getColorFromPalette(r,n,i)),o},t.prototype.coordDimToDataDim=function(r){return this.getRawData().mapDimensionsAll(r)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(r,n){this._innerSelect(this.getData(n),r)},t.prototype.unselect=function(r,n){var i=this.option.selectedMap;if(i){var a=this.option.selectedMode,o=this.getData(n);if(a==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var s=0;s<r.length;s++){var l=r[s],u=tx(o,l);i[u]=!1,this._selectedDataIndicesMap[u]=-1}}},t.prototype.toggleSelect=function(r,n){for(var i=[],a=0;a<r.length;a++)i[0]=r[a],this.isSelected(r[a],n)?this.unselect(i,n):this.select(i,n)},t.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var r=this._selectedDataIndicesMap,n=sn(r),i=[],a=0;a<n.length;a++){var o=r[n[a]];o>=0&&i.push(o)}return i},t.prototype.isSelected=function(r,n){var i=this.option.selectedMap;if(!i)return!1;var a=this.getData(n);return(i==="all"||i[tx(a,r)])&&!a.getItemModel(r).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[Dke])return!0;var r=this.option.universalTransition;return r?r===!0?!0:r&&r.enabled:!1},t.prototype._innerSelect=function(r,n){var i,a,o=this.option,s=o.selectedMode,l=n.length;if(!(!s||!l)){if(s==="series")o.selectedMap="all";else if(s==="multiple"){Tt(o.selectedMap)||(o.selectedMap={});for(var u=o.selectedMap,f=0;f<l;f++){var c=n[f],h=tx(r,c);u[h]=!0,this._selectedDataIndicesMap[h]=r.getRawIndex(c)}}else if(s==="single"||s===!0){var d=n[l-1],h=tx(r,d);o.selectedMap=(i={},i[h]=!0,i),this._selectedDataIndicesMap=(a={},a[h]=r.getRawIndex(d),a)}}},t.prototype._initSelectedMapFromData=function(r){if(!this.option.selectedMap){var n=[];r.hasItemOption&&r.each(function(i){var a=r.getRawDataItem(i);a&&a.selected&&n.push(i)}),n.length>0&&this._innerSelect(r,n)}},t.registerClass=function(r){return nn.registerClass(r)},t.protoInitialize=function(){var r=t.prototype;r.type="series.__base__",r.seriesIndex=0,r.ignoreStyleOnData=!1,r.hasSymbolVisual=!1,r.defaultSymbol="circle",r.visualStyleAccessPath="itemStyle",r.visualDrawType="fill"}(),t}(nn);hl(Sk,ske);hl(Sk,v3);oie(Sk,nn);function Mz(e){var t=e.name;GB(e)||(e.name=$ke(e)||t)}function $ke(e){var t=e.getRawData(),r=t.mapDimensionsAll("seriesName"),n=[];return ce(r,function(i){var a=t.getDimensionInfo(i);a.displayName&&n.push(a.displayName)}),n.join(" ")}function Nke(e){return e.model.getRawData().count()}function Lke(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),Fke}function Fke(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function Dz(e,t){ce(MCe(e.CHANGABLE_METHODS,e.DOWNSAMPLE_METHODS),function(r){e.wrapMethod(r,Mn(Hke,t))})}function Hke(e,t){var r=z$(e);return r&&r.setOutputEnd((t||this).count()),t}function z$(e){var t=(e.ecModel||{}).scheduler,r=t&&t.getPipeline(e.uid);if(r){var n=r.currentTask;if(n){var i=n.agentStubMap;i&&(n=i.get(e.uid))}return n}}const cc=Sk;var w3=function(){function e(){this.group=new Pi,this.uid=hk("viewComponent")}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){},e.prototype.updateLayout=function(t,r,n,i){},e.prototype.updateVisual=function(t,r,n,i){},e.prototype.toggleBlurSeries=function(t,r,n){},e.prototype.eachRendered=function(t){var r=this.group;r&&r.traverse(t)},e}();KB(w3);rk(w3);const Pu=w3;function _3(){var e=zn();return function(t){var r=e(t),n=t.pipelineContext,i=!!r.large,a=!!r.progressiveRender,o=r.large=!!(n&&n.large),s=r.progressiveRender=!!(n&&n.progressiveRender);return(i!==o||a!==s)&&"reset"}}var Wae=zn(),Bke=_3(),S3=function(){function e(){this.group=new Pi,this.uid=hk("viewChart"),this.renderTask=Ab({plan:Vke,reset:Wke}),this.renderTask.context={view:this}}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.highlight=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&Nz(a,i,"emphasis")},e.prototype.downplay=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&Nz(a,i,"normal")},e.prototype.remove=function(t,r){this.group.removeAll()},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateLayout=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateVisual=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.eachRendered=function(t){uk(this.group,t)},e.markUpdateMethod=function(t,r){Wae(t).updateMethod=r},e.protoInitialize=function(){var t=e.prototype;t.type="chart"}(),e}();function $z(e,t,r){e&&N$(e)&&(t==="emphasis"?oE:sE)(e,r)}function Nz(e,t,r){var n=gd(e,t),i=t&&t.highlightKey!=null?KOe(t.highlightKey):null;n!=null?ce(na(n),function(a){$z(e.getItemGraphicEl(a),r,i)}):e.eachItemGraphicEl(function(a){$z(a,r,i)})}KB(S3);rk(S3);function Vke(e){return Bke(e.model)}function Wke(e){var t=e.model,r=e.ecModel,n=e.api,i=e.payload,a=t.pipelineContext.progressiveRender,o=e.view,s=i&&Wae(i).updateMethod,l=a?"incrementalPrepareRender":s&&o[s]?s:"render";return l!=="render"&&o[l](t,r,n,i),jke[l]}var jke={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}};const ll=S3;var pE="\0__throttleOriginMethod",Lz="\0__throttleRate",Fz="\0__throttleType";function Ck(e,t,r){var n,i=0,a=0,o=null,s,l,u,f;t=t||0;function c(){a=new Date().getTime(),o=null,e.apply(l,u||[])}var h=function(){for(var d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];n=new Date().getTime(),l=this,u=d;var g=f||t,y=f||r;f=null,s=n-(y?i:a)-g,clearTimeout(o),y?o=setTimeout(c,g):s>=0?c():o=setTimeout(c,-s),i=n};return h.clear=function(){o&&(clearTimeout(o),o=null)},h.debounceNextCall=function(d){f=d},h}function jae(e,t,r,n){var i=e[t];if(i){var a=i[pE]||i,o=i[Fz],s=i[Lz];if(s!==r||o!==n){if(r==null||!n)return e[t]=a;i=e[t]=Ck(a,r,n==="debounce"),i[pE]=a,i[Fz]=n,i[Lz]=r}return i}}function G$(e,t){var r=e[t];r&&r[pE]&&(r.clear&&r.clear(),e[t]=r[pE])}var Hz=zn(),Bz={itemStyle:cw(tae,!0),lineStyle:cw(eae,!0)},Uke={lineStyle:"stroke",itemStyle:"fill"};function Uae(e,t){var r=e.visualStyleMapper||Bz[t];return r||(console.warn("Unknown style type '"+t+"'."),Bz.itemStyle)}function zae(e,t){var r=e.visualDrawType||Uke[t];return r||(console.warn("Unknown style type '"+t+"'."),"fill")}var zke={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=e.getModel(n),a=Uae(e,n),o=a(i),s=i.getShallow("decal");s&&(r.setVisual("decal",s),s.dirty=!0);var l=zae(e,n),u=o[l],f=Zt(u)?u:null,c=o.fill==="auto"||o.stroke==="auto";if(!o[l]||f||c){var h=e.getColorFromPalette(e.name,null,t.getSeriesCount());o[l]||(o[l]=h,r.setVisual("colorFromPalette",!0)),o.fill=o.fill==="auto"||Zt(o.fill)?h:o.fill,o.stroke=o.stroke==="auto"||Zt(o.stroke)?h:o.stroke}if(r.setVisual("style",o),r.setVisual("drawType",l),!t.isSeriesFiltered(e)&&f)return r.setVisual("colorFromPalette",!1),{dataEach:function(d,v){var g=e.getDataParams(v),y=Ze({},o);y[l]=f(g),d.setItemVisual(v,"style",y)}}}},d0=new Ei,Gke={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!(e.ignoreStyleOnData||t.isSeriesFiltered(e))){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=Uae(e,n),a=r.getVisual("drawType");return{dataEach:r.hasItemOption?function(o,s){var l=o.getRawDataItem(s);if(l&&l[n]){d0.option=l[n];var u=i(d0),f=o.ensureUniqueItemVisual(s,"style");Ze(f,u),d0.option.decal&&(o.setItemVisual(s,"decal",d0.option.decal),d0.option.decal.dirty=!0),a in u&&o.setItemVisual(s,"colorFromPalette",!1)}}:null}}}},Yke={performRawSeries:!0,overallReset:function(e){var t=ir();e.eachSeries(function(r){var n=r.getColorBy();if(!r.isColorBySeries()){var i=r.type+"-"+n,a=t.get(i);a||(a={},t.set(i,a)),Hz(r).scope=a}}),e.eachSeries(function(r){if(!(r.isColorBySeries()||e.isSeriesFiltered(r))){var n=r.getRawData(),i={},a=r.getData(),o=Hz(r).scope,s=r.visualStyleAccessPath||"itemStyle",l=zae(r,s);a.each(function(u){var f=a.getRawIndex(u);i[f]=u}),n.each(function(u){var f=i[u],c=a.getItemVisual(f,"colorFromPalette");if(c){var h=a.ensureUniqueItemVisual(f,"style"),d=n.getName(u)||u+"",v=n.count();h[l]=r.getColorFromPalette(d,o,v)}})}})}},rx=Math.PI;function Kke(e,t){t=t||{},Mr(t,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var r=new Pi,n=new Qn({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});r.add(n);var i=new Ii({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),a=new Qn({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});r.add(a);var o;return t.showSpinner&&(o=new e3({shape:{startAngle:-rx/2,endAngle:-rx/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001}),o.animateShape(!0).when(1e3,{endAngle:rx*3/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:rx*3/2}).delay(300).start("circularInOut"),r.add(o)),r.resize=function(){var s=i.getBoundingRect().width,l=t.showSpinner?t.spinnerRadius:0,u=(e.getWidth()-l*2-(t.showSpinner&&s?10:0)-s)/2-(t.showSpinner&&s?0:5+s/2)+(t.showSpinner?0:s/2)+(s?0:l),f=e.getHeight()/2;t.showSpinner&&o.setShape({cx:u,cy:f}),a.setShape({x:u-l,y:f-l,width:l*2,height:l*2}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},r.resize(),r}var Xke=function(){function e(t,r,n,i){this._stageTaskMap=ir(),this.ecInstance=t,this.api=r,n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=n.concat(i)}return e.prototype.restoreData=function(t,r){t.restoreData(r),this._stageTaskMap.each(function(n){var i=n.overallTask;i&&i.dirty()})},e.prototype.getPerformArgs=function(t,r){if(t.__pipeline){var n=this._pipelineMap.get(t.__pipeline.id),i=n.context,a=!r&&n.progressiveEnabled&&(!i||i.progressiveRender)&&t.__idxInPipeline>n.blockIndex,o=a?n.step:null,s=i&&i.modDataCount,l=s!=null?Math.ceil(s/o):null;return{step:o,modBy:l,modDataCount:s}}},e.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},e.prototype.updateStreamModes=function(t,r){var n=this._pipelineMap.get(t.uid),i=t.getData(),a=i.count(),o=n.progressiveEnabled&&r.incrementalPrepareRender&&a>=n.threshold,s=t.get("large")&&a>=t.get("largeThreshold"),l=t.get("progressiveChunkMode")==="mod"?a:null;t.pipelineContext=n.context={progressiveRender:o,modDataCount:l,large:s}},e.prototype.restorePipelines=function(t){var r=this,n=r._pipelineMap=ir();t.eachSeries(function(i){var a=i.getProgressive(),o=i.uid;n.set(o,{id:o,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:a&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(a||700),count:0}),r._pipe(i,i.dataTask)})},e.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,r=this.api.getModel(),n=this.api;ce(this._allHandlers,function(i){var a=t.get(i.uid)||t.set(i.uid,{}),o="";ku(!(i.reset&&i.overallReset),o),i.reset&&this._createSeriesStageTask(i,a,r,n),i.overallReset&&this._createOverallStageTask(i,a,r,n)},this)},e.prototype.prepareView=function(t,r,n,i){var a=t.renderTask,o=a.context;o.model=r,o.ecModel=n,o.api=i,a.__block=!t.incrementalPrepareRender,this._pipe(r,a)},e.prototype.performDataProcessorTasks=function(t,r){this._performStageTasks(this._dataProcessorHandlers,t,r,{block:!0})},e.prototype.performVisualTasks=function(t,r,n){this._performStageTasks(this._visualHandlers,t,r,n)},e.prototype._performStageTasks=function(t,r,n,i){i=i||{};var a=!1,o=this;ce(t,function(l,u){if(!(i.visualType&&i.visualType!==l.visualType)){var f=o._stageTaskMap.get(l.uid),c=f.seriesTaskMap,h=f.overallTask;if(h){var d,v=h.agentStubMap;v.each(function(y){s(i,y)&&(y.dirty(),d=!0)}),d&&h.dirty(),o.updatePayload(h,n);var g=o.getPerformArgs(h,i.block);v.each(function(y){y.perform(g)}),h.perform(g)&&(a=!0)}else c&&c.each(function(y,b){s(i,y)&&y.dirty();var w=o.getPerformArgs(y,i.block);w.skip=!l.performRawSeries&&r.isSeriesFiltered(y.context.model),o.updatePayload(y,n),y.perform(w)&&(a=!0)})}});function s(l,u){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(u.__pipeline.id))}this.unfinished=a||this.unfinished},e.prototype.performSeriesTasks=function(t){var r;t.eachSeries(function(n){r=n.dataTask.perform()||r}),this.unfinished=r||this.unfinished},e.prototype.plan=function(){this._pipelineMap.each(function(t){var r=t.tail;do{if(r.__block){t.blockIndex=r.__idxInPipeline;break}r=r.getUpstream()}while(r)})},e.prototype.updatePayload=function(t,r){r!=="remain"&&(t.context.payload=r)},e.prototype._createSeriesStageTask=function(t,r,n,i){var a=this,o=r.seriesTaskMap,s=r.seriesTaskMap=ir(),l=t.seriesType,u=t.getTargetSeries;t.createOnAllSeries?n.eachRawSeries(f):l?n.eachRawSeriesByType(l,f):u&&u(n,i).each(f);function f(c){var h=c.uid,d=s.set(h,o&&o.get(h)||Ab({plan:eAe,reset:tAe,count:nAe}));d.context={model:c,ecModel:n,api:i,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:a},a._pipe(c,d)}},e.prototype._createOverallStageTask=function(t,r,n,i){var a=this,o=r.overallTask=r.overallTask||Ab({reset:qke});o.context={ecModel:n,api:i,overallReset:t.overallReset,scheduler:a};var s=o.agentStubMap,l=o.agentStubMap=ir(),u=t.seriesType,f=t.getTargetSeries,c=!0,h=!1,d="";ku(!t.createOnAllSeries,d),u?n.eachRawSeriesByType(u,v):f?f(n,i).each(v):(c=!1,ce(n.getSeries(),v));function v(g){var y=g.uid,b=l.set(y,s&&s.get(y)||(h=!0,Ab({reset:Zke,onDirty:Qke})));b.context={model:g,overallProgress:c},b.agent=o,b.__block=c,a._pipe(g,b)}h&&o.dirty()},e.prototype._pipe=function(t,r){var n=t.uid,i=this._pipelineMap.get(n);!i.head&&(i.head=r),i.tail&&i.tail.pipe(r),i.tail=r,r.__idxInPipeline=i.count++,r.__pipeline=i},e.wrapStageHandler=function(t,r){return Zt(t)&&(t={overallReset:t,seriesType:iAe(t)}),t.uid=hk("stageHandler"),r&&(t.visualType=r),t},e}();function qke(e){e.overallReset(e.ecModel,e.api,e.payload)}function Zke(e){return e.overallProgress&&Jke}function Jke(){this.agent.dirty(),this.getDownstream().dirty()}function Qke(){this.agent&&this.agent.dirty()}function eAe(e){return e.plan?e.plan(e.model,e.ecModel,e.api,e.payload):null}function tAe(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=na(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?Rt(t,function(r,n){return Gae(n)}):rAe}var rAe=Gae(0);function Gae(e){return function(t,r){var n=r.data,i=r.resetDefines[e];if(i&&i.dataEach)for(var a=t.start;a<t.end;a++)i.dataEach(n,a);else i&&i.progress&&i.progress(t,n)}}function nAe(e){return e.data.count()}function iAe(e){gE=null;try{e(bw,Yae)}catch{}return gE}var bw={},Yae={},gE;Kae(bw,Cae);Kae(Yae,xae);bw.eachSeriesByType=bw.eachRawSeriesByType=function(e){gE=e};bw.eachComponent=function(e){e.mainType==="series"&&e.subType&&(gE=e.subType)};function Kae(e,t){for(var r in t.prototype)e[r]=Ta}const Xae=Xke;var Vz=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const aAe={color:Vz,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],Vz]};var zi="#B9B8CE",Wz="#100C2A",nx=function(){return{axisLine:{lineStyle:{color:zi}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},jz=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],qae={darkMode:!0,color:jz,backgroundColor:Wz,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:zi}},textStyle:{color:zi},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:zi}},dataZoom:{borderColor:"#71708A",textStyle:{color:zi},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:zi}},timeline:{lineStyle:{color:zi},label:{color:zi},controlStyle:{color:zi,borderColor:zi}},calendar:{itemStyle:{color:Wz},dayLabel:{color:zi},monthLabel:{color:zi},yearLabel:{color:zi}},timeAxis:nx(),logAxis:nx(),valueAxis:nx(),categoryAxis:nx(),line:{symbol:"circle"},graph:{color:jz},gauge:{title:{color:zi},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:zi},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};qae.categoryAxis.splitLine.show=!1;const oAe=qae;var sAe=function(){function e(){}return e.prototype.normalizeQuery=function(t){var r={},n={},i={};if(bt(t)){var a=ol(t);r.mainType=a.main||null,r.subType=a.sub||null}else{var o=["Index","Name","Id"],s={name:1,dataIndex:1,dataType:1};ce(t,function(l,u){for(var f=!1,c=0;c<o.length;c++){var h=o[c],d=u.lastIndexOf(h);if(d>0&&d===u.length-h.length){var v=u.slice(0,d);v!=="data"&&(r.mainType=v,r[h.toLowerCase()]=l,f=!0)}}s.hasOwnProperty(u)&&(n[u]=l,f=!0),f||(i[u]=l)})}return{cptQuery:r,dataQuery:n,otherQuery:i}},e.prototype.filter=function(t,r){var n=this.eventInfo;if(!n)return!0;var i=n.targetEl,a=n.packedEvent,o=n.model,s=n.view;if(!o||!s)return!0;var l=r.cptQuery,u=r.dataQuery;return f(l,o,"mainType")&&f(l,o,"subType")&&f(l,o,"index","componentIndex")&&f(l,o,"name")&&f(l,o,"id")&&f(u,a,"name")&&f(u,a,"dataIndex")&&f(u,a,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,r.otherQuery,i,a));function f(c,h,d,v){return c[d]==null||h[v||d]===c[d]}},e.prototype.afterTrigger=function(){this.eventInfo=null},e}(),Y$=["symbol","symbolSize","symbolRotate","symbolOffset"],Uz=Y$.concat(["symbolKeepAspect"]),lAe={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData();if(e.legendIcon&&r.setVisual("legendIcon",e.legendIcon),!e.hasSymbolVisual)return;for(var n={},i={},a=!1,o=0;o<Y$.length;o++){var s=Y$[o],l=e.get(s);Zt(l)?(a=!0,i[s]=l):n[s]=l}if(n.symbol=n.symbol||e.defaultSymbol,r.setVisual(Ze({legendIcon:e.legendIcon||n.symbol,symbolKeepAspect:e.get("symbolKeepAspect")},n)),t.isSeriesFiltered(e))return;var u=sn(i);function f(c,h){for(var d=e.getRawValue(h),v=e.getDataParams(h),g=0;g<u.length;g++){var y=u[g];c.setItemVisual(h,y,i[y](d,v))}}return{dataEach:a?f:null}}},uAe={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!e.hasSymbolVisual||t.isSeriesFiltered(e))return;var r=e.getData();function n(i,a){for(var o=i.getItemModel(a),s=0;s<Uz.length;s++){var l=Uz[s],u=o.getShallow(l,!0);u!=null&&i.setItemVisual(a,l,u)}}return{dataEach:r.hasItemOption?n:null}}};function fAe(e,t,r){switch(r){case"color":var n=e.getItemVisual(t,"style");return n[e.getVisual("drawType")];case"opacity":return e.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getItemVisual(t,r)}}function cAe(e,t){switch(t){case"color":var r=e.getVisual("style");return r[e.getVisual("drawType")];case"opacity":return e.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getVisual(t)}}function hAe(e,t){function r(n,i){var a=[];return n.eachComponent({mainType:"series",subType:e,query:i},function(o){a.push(o.seriesIndex)}),a}ce([[e+"ToggleSelect","toggleSelect"],[e+"Select","select"],[e+"UnSelect","unselect"]],function(n){t(n[0],function(i,a,o){i=Ze({},i),o.dispatchAction(Ze(i,{type:n[1],seriesIndex:r(a,i)}))})})}function Av(e,t,r,n,i){var a=e+t;r.isSilent(a)||n.eachComponent({mainType:"series",subType:"pie"},function(o){for(var s=o.seriesIndex,l=o.option.selectedMap,u=i.selected,f=0;f<u.length;f++)if(u[f].seriesIndex===s){var c=o.getData(),h=gd(c,i.fromActionPayload);r.trigger(a,{type:a,seriesId:o.id,name:dt(h)?c.getName(h[0]):c.getName(h),selected:bt(l)?l:Ze({},l)})}})}function dAe(e,t,r){e.on("selectchanged",function(n){var i=r.getModel();n.isFromClick?(Av("map","selectchanged",t,i,n),Av("pie","selectchanged",t,i,n)):n.fromAction==="select"?(Av("map","selected",t,i,n),Av("pie","selected",t,i,n)):n.fromAction==="unselect"&&(Av("map","unselected",t,i,n),Av("pie","unselected",t,i,n))})}function sb(e,t,r){for(var n;e&&!(t(e)&&(n=e,r));)e=e.__hostTarget||e.parent;return n}var vAe=Math.round(Math.random()*9),pAe=typeof Object.defineProperty=="function",gAe=function(){function e(){this._id="__ec_inner_"+vAe++}return e.prototype.get=function(t){return this._guard(t)[this._id]},e.prototype.set=function(t,r){var n=this._guard(t);return pAe?Object.defineProperty(n,this._id,{value:r,enumerable:!1,configurable:!0}):n[this._id]=r,this},e.prototype.delete=function(t){return this.has(t)?(delete this._guard(t)[this._id],!0):!1},e.prototype.has=function(t){return!!this._guard(t)[this._id]},e.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},e}();const yAe=gAe;var mAe=Nr.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n+a),e.lineTo(r-i,n+a),e.closePath()}}),bAe=Nr.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n),e.lineTo(r,n+a),e.lineTo(r-i,n),e.closePath()}}),wAe=Nr.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.x,n=t.y,i=t.width/5*3,a=Math.max(i,t.height),o=i/2,s=o*o/(a-o),l=n-a+o+s,u=Math.asin(s/o),f=Math.cos(u)*o,c=Math.sin(u),h=Math.cos(u),d=o*.6,v=o*.7;e.moveTo(r-f,l+s),e.arc(r,l,o,Math.PI-u,Math.PI*2+u),e.bezierCurveTo(r+f-c*d,l+s+h*d,r,n-v,r,n),e.bezierCurveTo(r,n-v,r-f+c*d,l+s+h*d,r-f,l+s),e.closePath()}}),_Ae=Nr.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.height,n=t.width,i=t.x,a=t.y,o=n/3*2;e.moveTo(i,a),e.lineTo(i+o,a+r),e.lineTo(i,a+r/4*3),e.lineTo(i-o,a+r),e.lineTo(i,a),e.closePath()}}),SAe={line:yd,rect:Qn,roundRect:Qn,square:Qn,circle:QB,diamond:bAe,pin:wAe,arrow:_Ae,triangle:mAe},CAe={line:function(e,t,r,n,i){i.x1=e,i.y1=t+n/2,i.x2=e+r,i.y2=t+n/2},rect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n},roundRect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n,i.r=Math.min(r,n)/4},square:function(e,t,r,n,i){var a=Math.min(r,n);i.x=e,i.y=t,i.width=a,i.height=a},circle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.r=Math.min(r,n)/2},diamond:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n},pin:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},arrow:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},triangle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n}},K$={};ce(SAe,function(e,t){K$[t]=new e});var xAe=Nr.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,r){var n=rE(e,t,r),i=this.shape;return i&&i.symbolType==="pin"&&t.position==="inside"&&(n.y=r.y+r.height*.4),n},buildPath:function(e,t,r){var n=t.symbolType;if(n!=="none"){var i=K$[n];i||(n="rect",i=K$[n]),CAe[n](t.x,t.y,t.width,t.height,i.shape),i.buildPath(e,i.shape,r)}}});function TAe(e,t){if(this.type!=="image"){var r=this.style;this.__isEmptyBrush?(r.stroke=e,r.fill=t||"#fff",r.lineWidth=2):this.shape.symbolType==="line"?r.stroke=e:r.fill=e,this.markRedraw()}}function ng(e,t,r,n,i,a,o){var s=e.indexOf("empty")===0;s&&(e=e.substr(5,1).toLowerCase()+e.substr(6));var l;return e.indexOf("image://")===0?l=Xie(e.slice(8),new Pr(t,r,n,i),o?"center":"cover"):e.indexOf("path://")===0?l=n3(e.slice(7),{},new Pr(t,r,n,i),o?"center":"cover"):l=new xAe({shape:{symbolType:e,x:t,y:r,width:n,height:i}}),l.__isEmptyBrush=s,l.setColor=TAe,a&&l.setColor(a),l}function OAe(e){return dt(e)||(e=[+e,+e]),[e[0]||0,e[1]||0]}function Zae(e,t){if(e!=null)return dt(e)||(e=[e,e]),[on(e[0],t[0])||0,on(pr(e[1],e[0]),t[1])||0]}function Ah(e){return isFinite(e)}function EAe(e,t,r){var n=t.x==null?0:t.x,i=t.x2==null?1:t.x2,a=t.y==null?0:t.y,o=t.y2==null?0:t.y2;t.global||(n=n*r.width+r.x,i=i*r.width+r.x,a=a*r.height+r.y,o=o*r.height+r.y),n=Ah(n)?n:0,i=Ah(i)?i:1,a=Ah(a)?a:0,o=Ah(o)?o:0;var s=e.createLinearGradient(n,a,i,o);return s}function RAe(e,t,r){var n=r.width,i=r.height,a=Math.min(n,i),o=t.x==null?.5:t.x,s=t.y==null?.5:t.y,l=t.r==null?.5:t.r;t.global||(o=o*n+r.x,s=s*i+r.y,l=l*a),o=Ah(o)?o:.5,s=Ah(s)?s:.5,l=l>=0&&Ah(l)?l:.5;var u=e.createRadialGradient(o,s,0,o,s,l);return u}function X$(e,t,r){for(var n=t.type==="radial"?RAe(e,t,r):EAe(e,t,r),i=t.colorStops,a=0;a<i.length;a++)n.addColorStop(i[a].offset,i[a].color);return n}function kAe(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!0;return!1}function ix(e){return parseInt(e,10)}function ax(e,t,r){var n=["width","height"][t],i=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(r[n]!=null&&r[n]!=="auto")return parseFloat(r[n]);var s=document.defaultView.getComputedStyle(e);return(e[i]||ix(s[n])||ix(e.style[n]))-(ix(s[a])||0)-(ix(s[o])||0)|0}function AAe(e,t){return!e||e==="solid"||!(t>0)?null:e==="dashed"?[4*t,2*t]:e==="dotted"?[t]:Ur(e)?[e]:dt(e)?e:null}function Jae(e){var t=e.style,r=t.lineDash&&t.lineWidth>0&&AAe(t.lineDash,t.lineWidth),n=t.lineDashOffset;if(r){var i=t.strokeNoScale&&e.getLineScale?e.getLineScale():1;i&&i!==1&&(r=Rt(r,function(a){return a/i}),n/=i)}return[r,n]}var PAe=new uc(!0);function yE(e){var t=e.stroke;return!(t==null||t==="none"||!(e.lineWidth>0))}function zz(e){return typeof e=="string"&&e!=="none"}function mE(e){var t=e.fill;return t!=null&&t!=="none"}function Gz(e,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=r}else e.fill()}function Yz(e,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=r}else e.stroke()}function q$(e,t,r){var n=sie(t.image,t.__image,r);if(nk(n)){var i=e.createPattern(n,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var a=new DOMMatrix;a.translateSelf(t.x||0,t.y||0),a.rotateSelf(0,0,(t.rotation||0)*DCe),a.scaleSelf(t.scaleX||1,t.scaleY||1),i.setTransform(a)}return i}}function IAe(e,t,r,n){var i,a=yE(r),o=mE(r),s=r.strokePercent,l=s<1,u=!t.path;(!t.silent||l)&&u&&t.createPathProxy();var f=t.path||PAe,c=t.__dirty;if(!n){var h=r.fill,d=r.stroke,v=o&&!!h.colorStops,g=a&&!!d.colorStops,y=o&&!!h.image,b=a&&!!d.image,w=void 0,_=void 0,x=void 0,T=void 0,O=void 0;(v||g)&&(O=t.getBoundingRect()),v&&(w=c?X$(e,h,O):t.__canvasFillGradient,t.__canvasFillGradient=w),g&&(_=c?X$(e,d,O):t.__canvasStrokeGradient,t.__canvasStrokeGradient=_),y&&(x=c||!t.__canvasFillPattern?q$(e,h,t):t.__canvasFillPattern,t.__canvasFillPattern=x),b&&(T=c||!t.__canvasStrokePattern?q$(e,d,t):t.__canvasStrokePattern,t.__canvasStrokePattern=x),v?e.fillStyle=w:y&&(x?e.fillStyle=x:o=!1),g?e.strokeStyle=_:b&&(T?e.strokeStyle=T:a=!1)}var E=t.getGlobalScale();f.setScale(E[0],E[1],t.segmentIgnoreThreshold);var M,P;e.setLineDash&&r.lineDash&&(i=Jae(t),M=i[0],P=i[1]);var N=!0;(u||c&hp)&&(f.setDPR(e.dpr),l?f.setContext(null):(f.setContext(e),N=!1),f.reset(),t.buildPath(f,t.shape,n),f.toStatic(),t.pathUpdated()),N&&f.rebuildPath(e,l?s:1),M&&(e.setLineDash(M),e.lineDashOffset=P),n||(r.strokeFirst?(a&&Yz(e,r),o&&Gz(e,r)):(o&&Gz(e,r),a&&Yz(e,r))),M&&e.setLineDash([])}function MAe(e,t,r){var n=t.__image=sie(r.image,t.__image,t,t.onload);if(!(!n||!nk(n))){var i=r.x||0,a=r.y||0,o=t.getWidth(),s=t.getHeight(),l=n.width/n.height;if(o==null&&s!=null?o=s*l:s==null&&o!=null?s=o/l:o==null&&s==null&&(o=n.width,s=n.height),r.sWidth&&r.sHeight){var u=r.sx||0,f=r.sy||0;e.drawImage(n,u,f,r.sWidth,r.sHeight,i,a,o,s)}else if(r.sx&&r.sy){var u=r.sx,f=r.sy,c=o-u,h=s-f;e.drawImage(n,u,f,c,h,i,a,o,s)}else e.drawImage(n,i,a,o,s)}}function DAe(e,t,r){var n,i=r.text;if(i!=null&&(i+=""),i){e.font=r.font||pd,e.textAlign=r.textAlign,e.textBaseline=r.textBaseline;var a=void 0,o=void 0;e.setLineDash&&r.lineDash&&(n=Jae(t),a=n[0],o=n[1]),a&&(e.setLineDash(a),e.lineDashOffset=o),r.strokeFirst?(yE(r)&&e.strokeText(i,r.x,r.y),mE(r)&&e.fillText(i,r.x,r.y)):(mE(r)&&e.fillText(i,r.x,r.y),yE(r)&&e.strokeText(i,r.x,r.y)),a&&e.setLineDash([])}}var Kz=["shadowBlur","shadowOffsetX","shadowOffsetY"],Xz=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function Qae(e,t,r,n,i){var a=!1;if(!n&&(r=r||{},t===r))return!1;if(n||t.opacity!==r.opacity){xa(e,i),a=!0;var o=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(o)?od.opacity:o}(n||t.blend!==r.blend)&&(a||(xa(e,i),a=!0),e.globalCompositeOperation=t.blend||od.blend);for(var s=0;s<Kz.length;s++){var l=Kz[s];(n||t[l]!==r[l])&&(a||(xa(e,i),a=!0),e[l]=e.dpr*(t[l]||0))}return(n||t.shadowColor!==r.shadowColor)&&(a||(xa(e,i),a=!0),e.shadowColor=t.shadowColor||od.shadowColor),a}function qz(e,t,r,n,i){var a=ww(t,i.inHover),o=n?null:r&&ww(r,i.inHover)||{};if(a===o)return!1;var s=Qae(e,a,o,n,i);if((n||a.fill!==o.fill)&&(s||(xa(e,i),s=!0),zz(a.fill)&&(e.fillStyle=a.fill)),(n||a.stroke!==o.stroke)&&(s||(xa(e,i),s=!0),zz(a.stroke)&&(e.strokeStyle=a.stroke)),(n||a.opacity!==o.opacity)&&(s||(xa(e,i),s=!0),e.globalAlpha=a.opacity==null?1:a.opacity),t.hasStroke()){var l=a.lineWidth,u=l/(a.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==u&&(s||(xa(e,i),s=!0),e.lineWidth=u)}for(var f=0;f<Xz.length;f++){var c=Xz[f],h=c[0];(n||a[h]!==o[h])&&(s||(xa(e,i),s=!0),e[h]=a[h]||c[1])}return s}function $Ae(e,t,r,n,i){return Qae(e,ww(t,i.inHover),r&&ww(r,i.inHover),n,i)}function eoe(e,t){var r=t.transform,n=e.dpr||1;r?e.setTransform(n*r[0],n*r[1],n*r[2],n*r[3],n*r[4],n*r[5]):e.setTransform(n,0,0,n,0,0)}function NAe(e,t,r){for(var n=!1,i=0;i<e.length;i++){var a=e[i];n=n||a.isZeroArea(),eoe(t,a),t.beginPath(),a.buildPath(t,a.shape),t.clip()}r.allClipped=n}function LAe(e,t){return e&&t?e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]:!(!e&&!t)}var Zz=1,Jz=2,Qz=3,eG=4;function FAe(e){var t=mE(e),r=yE(e);return!(e.lineDash||!(+t^+r)||t&&typeof e.fill!="string"||r&&typeof e.stroke!="string"||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}function xa(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function ww(e,t){return t&&e.__hoverStyle||e.style}function toe(e,t){Ph(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Ph(e,t,r,n){var i=t.transform;if(!t.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1)){t.__dirty&=~za,t.__isRendered=!1;return}var a=t.__clipPaths,o=r.prevElClipPaths,s=!1,l=!1;if((!o||kAe(a,o))&&(o&&o.length&&(xa(e,r),e.restore(),l=s=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),a&&a.length&&(xa(e,r),e.save(),NAe(a,e,r),s=!0),r.prevElClipPaths=a),r.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var u=r.prevEl;u||(l=s=!0);var f=t instanceof Nr&&t.autoBatch&&FAe(t.style);s||LAe(i,u.transform)?(xa(e,r),eoe(e,t)):f||xa(e,r);var c=ww(t,r.inHover);t instanceof Nr?(r.lastDrawType!==Zz&&(l=!0,r.lastDrawType=Zz),qz(e,t,u,l,r),(!f||!r.batchFill&&!r.batchStroke)&&e.beginPath(),IAe(e,t,c,f),f&&(r.batchFill=c.fill||"",r.batchStroke=c.stroke||"")):t instanceof I$?(r.lastDrawType!==Qz&&(l=!0,r.lastDrawType=Qz),qz(e,t,u,l,r),DAe(e,t,c)):t instanceof Nd?(r.lastDrawType!==Jz&&(l=!0,r.lastDrawType=Jz),$Ae(e,t,u,l,r),MAe(e,t,c)):t.getTemporalDisplayables&&(r.lastDrawType!==eG&&(l=!0,r.lastDrawType=eG),HAe(e,t,r)),f&&n&&xa(e,r),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),r.prevEl=t,t.__dirty=0,t.__isRendered=!0}function HAe(e,t,r){var n=t.getDisplayables(),i=t.getTemporalDisplayables();e.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover},o,s;for(o=t.getCursor(),s=n.length;o<s;o++){var l=n[o];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Ph(e,l,a,o===s-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}for(var u=0,f=i.length;u<f;u++){var l=i[u];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Ph(e,l,a,u===f-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}var XI=new yAe,tG=new HS(100),rG=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function Z$(e,t){if(e==="none")return null;var r=t.getDevicePixelRatio(),n=t.getZr(),i=n.painter.type==="svg";e.dirty&&XI.delete(e);var a=XI.get(e);if(a)return a;var o=Mr(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});o.backgroundColor==="none"&&(o.backgroundColor=null);var s={repeat:"repeat"};return l(s),s.rotation=o.rotation,s.scaleX=s.scaleY=i?1:1/r,XI.set(e,s),e.dirty=!1,s;function l(u){for(var f=[r],c=!0,h=0;h<rG.length;++h){var d=o[rG[h]];if(d!=null&&!dt(d)&&!bt(d)&&!Ur(d)&&typeof d!="boolean"){c=!1;break}f.push(d)}var v;if(c){v=f.join(",")+(i?"-svg":"");var g=tG.get(v);g&&(i?u.svgElement=g:u.image=g)}var y=noe(o.dashArrayX),b=BAe(o.dashArrayY),w=roe(o.symbol),_=VAe(y),x=ioe(b),T=!i&&gm.createCanvas(),O=i&&{tag:"g",attrs:{},key:"dcl",children:[]},E=P(),M;T&&(T.width=E.width*r,T.height=E.height*r,M=T.getContext("2d")),N(),c&&tG.put(v,T||O),u.image=T,u.svgElement=O,u.svgWidth=E.width,u.svgHeight=E.height;function P(){for(var D=1,L=0,V=_.length;L<V;++L)D=v6(D,_[L]);for(var ee=1,L=0,V=w.length;L<V;++L)ee=v6(ee,w[L].length);D*=ee;var ie=x*_.length*w.length;return{width:Math.max(1,Math.min(D,o.maxTileWidth)),height:Math.max(1,Math.min(ie,o.maxTileHeight))}}function N(){M&&(M.clearRect(0,0,T.width,T.height),o.backgroundColor&&(M.fillStyle=o.backgroundColor,M.fillRect(0,0,T.width,T.height)));for(var D=0,L=0;L<b.length;++L)D+=b[L];if(D<=0)return;for(var V=-x,ee=0,ie=0,le=0;V<E.height;){if(ee%2===0){for(var _e=ie/2%w.length,U=0,C=0,R=0;U<E.width*2;){for(var I=0,L=0;L<y[le].length;++L)I+=y[le][L];if(I<=0)break;if(C%2===0){var k=(1-o.symbolSize)*.5,F=U+y[le][C]*k,H=V+b[ee]*k,W=y[le][C]*o.symbolSize,Q=b[ee]*o.symbolSize,se=R/2%w[_e].length;we(F,H,W,Q,w[_e][se])}U+=y[le][C],++R,++C,C===y[le].length&&(C=0)}++le,le===y.length&&(le=0)}V+=b[ee],++ie,++ee,ee===b.length&&(ee=0)}function we(pe,me,Ie,z,Le){var ye=i?1:r,Xe=ng(Le,pe*ye,me*ye,Ie*ye,z*ye,o.color,o.symbolKeepAspect);if(i){var Ge=n.painter.renderOneToVNode(Xe);Ge&&O.children.push(Ge)}else toe(M,Xe)}}}}function roe(e){if(!e||e.length===0)return[["rect"]];if(bt(e))return[[e]];for(var t=!0,r=0;r<e.length;++r)if(!bt(e[r])){t=!1;break}if(t)return roe([e]);for(var n=[],r=0;r<e.length;++r)bt(e[r])?n.push([e[r]]):n.push(e[r]);return n}function noe(e){if(!e||e.length===0)return[[0,0]];if(Ur(e)){var t=Math.ceil(e);return[[t,t]]}for(var r=!0,n=0;n<e.length;++n)if(!Ur(e[n])){r=!1;break}if(r)return noe([e]);for(var i=[],n=0;n<e.length;++n)if(Ur(e[n])){var t=Math.ceil(e[n]);i.push([t,t])}else{var t=Rt(e[n],function(s){return Math.ceil(s)});t.length%2===1?i.push(t.concat(t)):i.push(t)}return i}function BAe(e){if(!e||typeof e=="object"&&e.length===0)return[0,0];if(Ur(e)){var t=Math.ceil(e);return[t,t]}var r=Rt(e,function(n){return Math.ceil(n)});return e.length%2?r.concat(r):r}function VAe(e){return Rt(e,function(t){return ioe(t)})}function ioe(e){for(var t=0,r=0;r<e.length;++r)t+=e[r];return e.length%2===1?t*2:t}function WAe(e,t){e.eachRawSeries(function(r){if(!e.isSeriesFiltered(r)){var n=r.getData();n.hasItemVisual()&&n.each(function(o){var s=n.getItemVisual(o,"decal");if(s){var l=n.ensureUniqueItemVisual(o,"style");l.decal=Z$(s,t)}});var i=n.getVisual("decal");if(i){var a=n.getVisual("style");a.decal=Z$(i,t)}}})}var jAe=new dl;const us=jAe;var aoe={};function UAe(e,t){aoe[e]=t}function zAe(e){return aoe[e]}var GAe=1,YAe=800,KAe=900,XAe=1e3,qAe=2e3,ZAe=5e3,ooe=1e3,JAe=1100,C3=2e3,soe=3e3,QAe=4e3,xk=4500,ePe=4600,tPe=5e3,rPe=6e3,loe=7e3,nPe={PROCESSOR:{FILTER:XAe,SERIES_FILTER:YAe,STATISTIC:ZAe},VISUAL:{LAYOUT:ooe,PROGRESSIVE_LAYOUT:JAe,GLOBAL:C3,CHART:soe,POST_CHART_LAYOUT:ePe,COMPONENT:QAe,BRUSH:tPe,CHART_ITEM:xk,ARIA:rPe,DECAL:loe}},wi="__flagInMainProcess",ga="__pendingUpdate",qI="__needsUpdateStatus",nG=/^[a-zA-Z0-9_]+$/,ZI="__connectUpdateStatus",iG=0,iPe=1,aPe=2;function uoe(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.isDisposed()){this.id;return}return coe(this,e,t)}}function foe(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return coe(this,e,t)}}function coe(e,t,r){return r[0]=r[0]&&r[0].toLowerCase(),dl.prototype[t].apply(e,r)}var hoe=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(dl),doe=hoe.prototype;doe.on=foe("on");doe.off=foe("off");var Pv,JI,ox,uf,QI,eM,tM,v0,p0,aG,oG,rM,sG,sx,lG,voe,ho,uG,poe=function(e){st(t,e);function t(r,n,i){var a=e.call(this,new sAe)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],i=i||{},bt(n)&&(n=goe[n]),a._dom=r;var o="canvas",s="auto",l=!1,u=a._zr=h6(r,{renderer:i.renderer||o,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:pr(i.useDirtyRect,l),useCoarsePointer:pr(i.useCoarsePointer,s),pointerSize:i.pointerSize});a._ssr=i.ssr,a._throttledZrFlush=Ck(Jr(u.flush,u),17),n=mr(n),n&&Oae(n,!0),a._theme=n,a._locale=fRe(i.locale||nae),a._coordSysMgr=new p3;var f=a._api=lG(a);function c(h,d){return h.__prio-d.__prio}return VT(wE,c),VT(J$,c),a._scheduler=new Xae(a,f,J$,wE),a._messageCenter=new hoe,a._initEvents(),a.resize=Jr(a.resize,a),u.animation.on("frame",a._onframe,a),aG(u,a),oG(u,a),u$(a),a}return t.prototype._onframe=function(){if(!this._disposed){uG(this);var r=this._scheduler;if(this[ga]){var n=this[ga].silent;this[wi]=!0;try{Pv(this),uf.update.call(this,null,this[ga].updateParams)}catch(l){throw this[wi]=!1,this[ga]=null,l}this._zr.flush(),this[wi]=!1,this[ga]=null,v0.call(this,n),p0.call(this,n)}else if(r.unfinished){var i=GAe,a=this._model,o=this._api;r.unfinished=!1;do{var s=+new Date;r.performSeriesTasks(a),r.performDataProcessorTasks(a),eM(this,a),r.performVisualTasks(a),sx(this,this._model,o,"remain",{}),i-=+new Date-s}while(i>0&&r.unfinished);r.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(r,n,i){if(!this[wi]){if(this._disposed){this.id;return}var a,o,s;if(Tt(n)&&(i=n.lazyUpdate,a=n.silent,o=n.replaceMerge,s=n.transition,n=n.notMerge),this[wi]=!0,!this._model||n){var l=new URe(this._api),u=this._theme,f=this._model=new Cae;f.scheduler=this._scheduler,f.ssr=this._ssr,f.init(null,null,null,u,this._locale,l)}this._model.setOption(r,{replaceMerge:o},Q$);var c={seriesTransition:s,optionChanged:!0};if(i)this[ga]={silent:a,updateParams:c},this[wi]=!1,this.getZr().wakeUp();else{try{Pv(this),uf.update.call(this,null,c)}catch(h){throw this[ga]=null,this[wi]=!1,h}this._ssr||this._zr.flush(),this[ga]=null,this[wi]=!1,v0.call(this,a),p0.call(this,a)}}},t.prototype.setTheme=function(){},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||nr.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(r){return this.renderToCanvas(r)},t.prototype.renderToCanvas=function(r){r=r||{};var n=this._zr.painter;return n.getRenderedCanvas({backgroundColor:r.backgroundColor||this._model.get("backgroundColor"),pixelRatio:r.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(r){r=r||{};var n=this._zr.painter;return n.renderToString({useViewBox:r.useViewBox})},t.prototype.getSvgDataURL=function(){if(nr.svgSupported){var r=this._zr,n=r.storage.getDisplayList();return ce(n,function(i){i.stopAnimation(null,!0)}),r.painter.toDataURL()}},t.prototype.getDataURL=function(r){if(this._disposed){this.id;return}r=r||{};var n=r.excludeComponents,i=this._model,a=[],o=this;ce(n,function(l){i.eachComponent({mainType:l},function(u){var f=o._componentsMap[u.__viewId];f.group.ignore||(a.push(f),f.group.ignore=!0)})});var s=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(r).toDataURL("image/"+(r&&r.type||"png"));return ce(a,function(l){l.group.ignore=!1}),s},t.prototype.getConnectedDataURL=function(r){if(this._disposed){this.id;return}var n=r.type==="svg",i=this.group,a=Math.min,o=Math.max,s=1/0;if(fG[i]){var l=s,u=s,f=-s,c=-s,h=[],d=r&&r.pixelRatio||this.getDevicePixelRatio();ce(Ib,function(_,x){if(_.group===i){var T=n?_.getZr().painter.getSvgDom().innerHTML:_.renderToCanvas(mr(r)),O=_.getDom().getBoundingClientRect();l=a(O.left,l),u=a(O.top,u),f=o(O.right,f),c=o(O.bottom,c),h.push({dom:T,left:O.left,top:O.top})}}),l*=d,u*=d,f*=d,c*=d;var v=f-l,g=c-u,y=gm.createCanvas(),b=h6(y,{renderer:n?"svg":"canvas"});if(b.resize({width:v,height:g}),n){var w="";return ce(h,function(_){var x=_.left-l,T=_.top-u;w+='<g transform="translate('+x+","+T+')">'+_.dom+"</g>"}),b.painter.getSvgRoot().innerHTML=w,r.connectedBackgroundColor&&b.painter.setBackgroundColor(r.connectedBackgroundColor),b.refreshImmediately(),b.painter.toDataURL()}else return r.connectedBackgroundColor&&b.add(new Qn({shape:{x:0,y:0,width:v,height:g},style:{fill:r.connectedBackgroundColor}})),ce(h,function(_){var x=new Nd({style:{x:_.left*d-l,y:_.top*d-u,image:_.dom}});b.add(x)}),b.refreshImmediately(),y.toDataURL("image/"+(r&&r.type||"png"))}else return this.getDataURL(r)},t.prototype.convertToPixel=function(r,n){return QI(this,"convertToPixel",r,n)},t.prototype.convertFromPixel=function(r,n){return QI(this,"convertFromPixel",r,n)},t.prototype.containPixel=function(r,n){if(this._disposed){this.id;return}var i=this._model,a,o=SI(i,r);return ce(o,function(s,l){l.indexOf("Models")>=0&&ce(s,function(u){var f=u.coordinateSystem;if(f&&f.containPoint)a=a||!!f.containPoint(n);else if(l==="seriesModels"){var c=this._chartsMap[u.__viewId];c&&c.containPoint&&(a=a||c.containPoint(n,u))}},this)},this),!!a},t.prototype.getVisual=function(r,n){var i=this._model,a=SI(i,r,{defaultMainType:"series"}),o=a.seriesModel,s=o.getData(),l=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?s.indexOfRawIndex(a.dataIndex):null;return l!=null?fAe(s,l,n):cAe(s,n)},t.prototype.getViewOfComponentModel=function(r){return this._componentsMap[r.__viewId]},t.prototype.getViewOfSeriesModel=function(r){return this._chartsMap[r.__viewId]},t.prototype._initEvents=function(){var r=this;ce(oPe,function(n){var i=function(a){var o=r.getModel(),s=a.target,l,u=n==="globalout";if(u?l={}:s&&sb(s,function(v){var g=Dr(v);if(g&&g.dataIndex!=null){var y=g.dataModel||o.getSeriesByIndex(g.seriesIndex);return l=y&&y.getDataParams(g.dataIndex,g.dataType)||{},!0}else if(g.eventData)return l=Ze({},g.eventData),!0},!0),l){var f=l.componentType,c=l.componentIndex;(f==="markLine"||f==="markPoint"||f==="markArea")&&(f="series",c=l.seriesIndex);var h=f&&c!=null&&o.getComponent(f,c),d=h&&r[h.mainType==="series"?"_chartsMap":"_componentsMap"][h.__viewId];l.event=a,l.type=n,r._$eventProcessor.eventInfo={targetEl:s,packedEvent:l,model:h,view:d},r.trigger(n,l)}};i.zrEventfulCallAtLast=!0,r._zr.on(n,i,r)}),ce(Pb,function(n,i){r._messageCenter.on(i,function(a){this.trigger(i,a)},r)}),ce(["selectchanged"],function(n){r._messageCenter.on(n,function(i){this.trigger(n,i)},r)}),dAe(this._messageCenter,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var r=this.getDom();r&&iie(this.getDom(),T3,"");var n=this,i=n._api,a=n._model;ce(n._componentsViews,function(o){o.dispose(a,i)}),ce(n._chartsViews,function(o){o.dispose(a,i)}),n._zr.dispose(),n._dom=n._model=n._chartsMap=n._componentsMap=n._chartsViews=n._componentsViews=n._scheduler=n._api=n._zr=n._throttledZrFlush=n._theme=n._coordSysMgr=n._messageCenter=null,delete Ib[n.id]},t.prototype.resize=function(r){if(!this[wi]){if(this._disposed){this.id;return}this._zr.resize(r);var n=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!n){var i=n.resetOption("media"),a=r&&r.silent;this[ga]&&(a==null&&(a=this[ga].silent),i=!0,this[ga]=null),this[wi]=!0;try{i&&Pv(this),uf.update.call(this,{type:"resize",animation:Ze({duration:0},r&&r.animation)})}catch(o){throw this[wi]=!1,o}this[wi]=!1,v0.call(this,a),p0.call(this,a)}}},t.prototype.showLoading=function(r,n){if(this._disposed){this.id;return}if(Tt(r)&&(n=r,r=""),r=r||"default",this.hideLoading(),!!eN[r]){var i=eN[r](this._api,n),a=this._zr;this._loadingFX=i,a.add(i)}},t.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},t.prototype.makeActionFromEvent=function(r){var n=Ze({},r);return n.type=Pb[r.type],n},t.prototype.dispatchAction=function(r,n){if(this._disposed){this.id;return}if(Tt(n)||(n={silent:!!n}),!!bE[r.type]&&this._model){if(this[wi]){this._pendingActions.push(r);return}var i=n.silent;tM.call(this,r,i);var a=n.flush;a?this._zr.flush():a!==!1&&nr.browser.weChat&&this._throttledZrFlush(),v0.call(this,i),p0.call(this,i)}},t.prototype.updateLabelLayout=function(){us.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(r){if(this._disposed){this.id;return}var n=r.seriesIndex,i=this.getModel(),a=i.getSeriesByIndex(n);a.appendData(r),this._scheduler.unfinished=!0,this.getZr().wakeUp()},t.internalField=function(){Pv=function(c){var h=c._scheduler;h.restorePipelines(c._model),h.prepareStageTasks(),JI(c,!0),JI(c,!1),h.plan()},JI=function(c,h){for(var d=c._model,v=c._scheduler,g=h?c._componentsViews:c._chartsViews,y=h?c._componentsMap:c._chartsMap,b=c._zr,w=c._api,_=0;_<g.length;_++)g[_].__alive=!1;h?d.eachComponent(function(O,E){O!=="series"&&x(E)}):d.eachSeries(x);function x(O){var E=O.__requireNewView;O.__requireNewView=!1;var M="_ec_"+O.id+"_"+O.type,P=!E&&y[M];if(!P){var N=ol(O.type),D=h?Pu.getClass(N.main,N.sub):ll.getClass(N.sub);P=new D,P.init(d,w),y[M]=P,g.push(P),b.add(P.group)}O.__viewId=P.__id=M,P.__alive=!0,P.__model=O,P.group.__ecComponentInfo={mainType:O.mainType,index:O.componentIndex},!h&&v.prepareView(P,O,d,w)}for(var _=0;_<g.length;){var T=g[_];T.__alive?_++:(!h&&T.renderTask.dispose(),b.remove(T.group),T.dispose(d,w),g.splice(_,1),y[T.__id]===T&&delete y[T.__id],T.__id=T.group.__ecComponentInfo=null)}},ox=function(c,h,d,v,g){var y=c._model;if(y.setUpdatePayload(d),!v){ce([].concat(c._componentsViews).concat(c._chartsViews),T);return}var b={};b[v+"Id"]=d[v+"Id"],b[v+"Index"]=d[v+"Index"],b[v+"Name"]=d[v+"Name"];var w={mainType:v,query:b};g&&(w.subType=g);var _=d.excludeSeriesId,x;_!=null&&(x=ir(),ce(na(_),function(O){var E=sl(O,null);E!=null&&x.set(E,!0)})),y&&y.eachComponent(w,function(O){var E=x&&x.get(O.id)!=null;if(!E)if(j6(d))if(O instanceof cc)d.type===sd&&!d.notBlur&&!O.get(["emphasis","disabled"])&&BOe(O,d,c._api);else{var M=JB(O.mainType,O.componentIndex,d.name,c._api),P=M.focusSelf,N=M.dispatchers;d.type===sd&&P&&!d.notBlur&&D$(O.mainType,O.componentIndex,c._api),N&&ce(N,function(D){d.type===sd?oE(D):sE(D)})}else L$(d)&&O instanceof cc&&(jOe(O,d,c._api),V6(O),ho(c))},c),y&&y.eachComponent(w,function(O){var E=x&&x.get(O.id)!=null;E||T(c[v==="series"?"_chartsMap":"_componentsMap"][O.__viewId])},c);function T(O){O&&O.__alive&&O[h]&&O[h](O.__model,y,c._api,d)}},uf={prepareAndUpdate:function(c){Pv(this),uf.update.call(this,c,{optionChanged:c.newOption!=null})},update:function(c,h){var d=this._model,v=this._api,g=this._zr,y=this._coordSysMgr,b=this._scheduler;if(d){d.setUpdatePayload(c),b.restoreData(d,c),b.performSeriesTasks(d),y.create(d,v),b.performDataProcessorTasks(d,c),eM(this,d),y.update(d,v),r(d),b.performVisualTasks(d,c),rM(this,d,v,c,h);var w=d.get("backgroundColor")||"transparent",_=d.get("darkMode");g.setBackgroundColor(w),_!=null&&_!=="auto"&&g.setDarkMode(_),us.trigger("afterupdate",d,v)}},updateTransform:function(c){var h=this,d=this._model,v=this._api;if(d){d.setUpdatePayload(c);var g=[];d.eachComponent(function(b,w){if(b!=="series"){var _=h.getViewOfComponentModel(w);if(_&&_.__alive)if(_.updateTransform){var x=_.updateTransform(w,d,v,c);x&&x.update&&g.push(_)}else g.push(_)}});var y=ir();d.eachSeries(function(b){var w=h._chartsMap[b.__viewId];if(w.updateTransform){var _=w.updateTransform(b,d,v,c);_&&_.update&&y.set(b.uid,1)}else y.set(b.uid,1)}),r(d),this._scheduler.performVisualTasks(d,c,{setDirty:!0,dirtyMap:y}),sx(this,d,v,c,{},y),us.trigger("afterupdate",d,v)}},updateView:function(c){var h=this._model;h&&(h.setUpdatePayload(c),ll.markUpdateMethod(c,"updateView"),r(h),this._scheduler.performVisualTasks(h,c,{setDirty:!0}),rM(this,h,this._api,c,{}),us.trigger("afterupdate",h,this._api))},updateVisual:function(c){var h=this,d=this._model;d&&(d.setUpdatePayload(c),d.eachSeries(function(v){v.getData().clearAllVisual()}),ll.markUpdateMethod(c,"updateVisual"),r(d),this._scheduler.performVisualTasks(d,c,{visualType:"visual",setDirty:!0}),d.eachComponent(function(v,g){if(v!=="series"){var y=h.getViewOfComponentModel(g);y&&y.__alive&&y.updateVisual(g,d,h._api,c)}}),d.eachSeries(function(v){var g=h._chartsMap[v.__viewId];g.updateVisual(v,d,h._api,c)}),us.trigger("afterupdate",d,this._api))},updateLayout:function(c){uf.update.call(this,c)}},QI=function(c,h,d,v){if(c._disposed){c.id;return}for(var g=c._model,y=c._coordSysMgr.getCoordinateSystems(),b,w=SI(g,d),_=0;_<y.length;_++){var x=y[_];if(x[h]&&(b=x[h](g,w,v))!=null)return b}},eM=function(c,h){var d=c._chartsMap,v=c._scheduler;h.eachSeries(function(g){v.updateStreamModes(g,d[g.__viewId])})},tM=function(c,h){var d=this,v=this.getModel(),g=c.type,y=c.escapeConnect,b=bE[g],w=b.actionInfo,_=(w.update||"update").split(":"),x=_.pop(),T=_[0]!=null&&ol(_[0]);this[wi]=!0;var O=[c],E=!1;c.batch&&(E=!0,O=Rt(c.batch,function(ee){return ee=Mr(Ze({},ee),c),ee.batch=null,ee}));var M=[],P,N=L$(c),D=j6(c);if(D&&Eie(this._api),ce(O,function(ee){if(P=b.action(ee,d._model,d._api),P=P||Ze({},ee),P.type=w.event||P.type,M.push(P),D){var ie=YB(c),le=ie.queryOptionMap,_e=ie.mainTypeSpecified,U=_e?le.keys()[0]:"series";ox(d,x,ee,U),ho(d)}else N?(ox(d,x,ee,"series"),ho(d)):T&&ox(d,x,ee,T.main,T.sub)}),x!=="none"&&!D&&!N&&!T)try{this[ga]?(Pv(this),uf.update.call(this,c),this[ga]=null):uf[x].call(this,c)}catch(ee){throw this[wi]=!1,ee}if(E?P={type:w.event||g,escapeConnect:y,batch:M}:P=M[0],this[wi]=!1,!h){var L=this._messageCenter;if(L.trigger(P.type,P),N){var V={type:"selectchanged",escapeConnect:y,selected:UOe(v),isFromClick:c.isFromClick||!1,fromAction:c.type,fromActionPayload:c};L.trigger(V.type,V)}}},v0=function(c){for(var h=this._pendingActions;h.length;){var d=h.shift();tM.call(this,d,c)}},p0=function(c){!c&&this.trigger("updated")},aG=function(c,h){c.on("rendered",function(d){h.trigger("rendered",d),c.animation.isFinished()&&!h[ga]&&!h._scheduler.unfinished&&!h._pendingActions.length&&h.trigger("finished")})},oG=function(c,h){c.on("mouseover",function(d){var v=d.target,g=sb(v,N$);g&&(VOe(g,d,h._api),ho(h))}).on("mouseout",function(d){var v=d.target,g=sb(v,N$);g&&(WOe(g,d,h._api),ho(h))}).on("click",function(d){var v=d.target,g=sb(v,function(w){return Dr(w).dataIndex!=null},!0);if(g){var y=g.selected?"unselect":"select",b=Dr(g);h._api.dispatchAction({type:y,dataType:b.dataType,dataIndexInside:b.dataIndex,seriesIndex:b.seriesIndex,isFromClick:!0})}})};function r(c){c.clearColorPalette(),c.eachSeries(function(h){h.clearColorPalette()})}function n(c){var h=[],d=[],v=!1;if(c.eachComponent(function(w,_){var x=_.get("zlevel")||0,T=_.get("z")||0,O=_.getZLevelKey();v=v||!!O,(w==="series"?d:h).push({zlevel:x,z:T,idx:_.componentIndex,type:w,key:O})}),v){var g=h.concat(d),y,b;VT(g,function(w,_){return w.zlevel===_.zlevel?w.z-_.z:w.zlevel-_.zlevel}),ce(g,function(w){var _=c.getComponent(w.type,w.idx),x=w.zlevel,T=w.key;y!=null&&(x=Math.max(y,x)),T?(x===y&&T!==b&&x++,b=T):b&&(x===y&&x++,b=""),y=x,_.setZLevel(x)})}}rM=function(c,h,d,v,g){n(h),sG(c,h,d,v,g),ce(c._chartsViews,function(y){y.__alive=!1}),sx(c,h,d,v,g),ce(c._chartsViews,function(y){y.__alive||y.remove(h,d)})},sG=function(c,h,d,v,g,y){ce(y||c._componentsViews,function(b){var w=b.__model;u(w,b),b.render(w,h,d,v),s(w,b),f(w,b)})},sx=function(c,h,d,v,g,y){var b=c._scheduler;g=Ze(g||{},{updatedSeries:h.getSeries()}),us.trigger("series:beforeupdate",h,d,g);var w=!1;h.eachSeries(function(_){var x=c._chartsMap[_.__viewId];x.__alive=!0;var T=x.renderTask;b.updatePayload(T,v),u(_,x),y&&y.get(_.uid)&&T.dirty(),T.perform(b.getPerformArgs(T))&&(w=!0),x.group.silent=!!_.get("silent"),o(_,x),V6(_)}),b.unfinished=w||b.unfinished,us.trigger("series:layoutlabels",h,d,g),us.trigger("series:transition",h,d,g),h.eachSeries(function(_){var x=c._chartsMap[_.__viewId];s(_,x),f(_,x)}),a(c,h),us.trigger("series:afterupdate",h,d,g)},ho=function(c){c[qI]=!0,c.getZr().wakeUp()},uG=function(c){c[qI]&&(c.getZr().storage.traverse(function(h){Eb(h)||i(h)}),c[qI]=!1)};function i(c){for(var h=[],d=c.currentStates,v=0;v<d.length;v++){var g=d[v];g==="emphasis"||g==="blur"||g==="select"||h.push(g)}c.selected&&c.states.select&&h.push("select"),c.hoverState===ok&&c.states.emphasis?h.push("emphasis"):c.hoverState===ak&&c.states.blur&&h.push("blur"),c.useStates(h)}function a(c,h){var d=c._zr,v=d.storage,g=0;v.traverse(function(y){y.isGroup||g++}),g>h.get("hoverLayerThreshold")&&!nr.node&&!nr.worker&&h.eachSeries(function(y){if(!y.preventUsingHoverLayer){var b=c._chartsMap[y.__viewId];b.__alive&&b.eachRendered(function(w){w.states.emphasis&&(w.states.emphasis.hoverLayer=!0)})}})}function o(c,h){var d=c.get("blendMode")||null;h.eachRendered(function(v){v.isGroup||(v.style.blend=d)})}function s(c,h){if(!c.preventAutoZ){var d=c.get("z")||0,v=c.get("zlevel")||0;h.eachRendered(function(g){return l(g,d,v,-1/0),!0})}}function l(c,h,d,v){var g=c.getTextContent(),y=c.getTextGuideLine(),b=c.isGroup;if(b)for(var w=c.childrenRef(),_=0;_<w.length;_++)v=Math.max(l(w[_],h,d,v),v);else c.z=h,c.zlevel=d,v=Math.max(c.z2,v);if(g&&(g.z=h,g.zlevel=d,isFinite(v)&&(g.z2=v+2)),y){var x=c.textGuideLineConfig;y.z=h,y.zlevel=d,isFinite(v)&&(y.z2=v+(x&&x.showAbove?1:-1))}return v}function u(c,h){h.eachRendered(function(d){if(!Eb(d)){var v=d.getTextContent(),g=d.getTextGuideLine();d.stateTransition&&(d.stateTransition=null),v&&v.stateTransition&&(v.stateTransition=null),g&&g.stateTransition&&(g.stateTransition=null),d.hasState()?(d.prevStates=d.currentStates,d.clearStates()):d.prevStates&&(d.prevStates=null)}})}function f(c,h){var d=c.getModel("stateAnimation"),v=c.isAnimationEnabled(),g=d.get("duration"),y=g>0?{duration:g,delay:d.get("delay"),easing:d.get("easing")}:null;h.eachRendered(function(b){if(b.states&&b.states.emphasis){if(Eb(b))return;if(b instanceof Nr&&XOe(b),b.__dirty){var w=b.prevStates;w&&b.useStates(w)}if(v){b.stateTransition=y;var _=b.getTextContent(),x=b.getTextGuideLine();_&&(_.stateTransition=y),x&&(x.stateTransition=y)}b.__dirty&&i(b)}})}lG=function(c){return new(function(h){st(d,h);function d(){return h!==null&&h.apply(this,arguments)||this}return d.prototype.getCoordinateSystems=function(){return c._coordSysMgr.getCoordinateSystems()},d.prototype.getComponentByElement=function(v){for(;v;){var g=v.__ecComponentInfo;if(g!=null)return c._model.getComponent(g.mainType,g.index);v=v.parent}},d.prototype.enterEmphasis=function(v,g){oE(v,g),ho(c)},d.prototype.leaveEmphasis=function(v,g){sE(v,g),ho(c)},d.prototype.enterBlur=function(v){HOe(v),ho(c)},d.prototype.leaveBlur=function(v){Cie(v),ho(c)},d.prototype.enterSelect=function(v){xie(v),ho(c)},d.prototype.leaveSelect=function(v){Tie(v),ho(c)},d.prototype.getModel=function(){return c.getModel()},d.prototype.getViewOfComponentModel=function(v){return c.getViewOfComponentModel(v)},d.prototype.getViewOfSeriesModel=function(v){return c.getViewOfSeriesModel(v)},d}(xae))(c)},voe=function(c){function h(d,v){for(var g=0;g<d.length;g++){var y=d[g];y[ZI]=v}}ce(Pb,function(d,v){c._messageCenter.on(v,function(g){if(fG[c.group]&&c[ZI]!==iG){if(g&&g.escapeConnect)return;var y=c.makeActionFromEvent(g),b=[];ce(Ib,function(w){w!==c&&w.group===c.group&&b.push(w)}),h(b,iG),ce(b,function(w){w[ZI]!==iPe&&w.dispatchAction(y)}),h(b,aPe)}})})}}(),t}(dl),x3=poe.prototype;x3.on=uoe("on");x3.off=uoe("off");x3.one=function(e,t,r){var n=this;function i(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];t&&t.apply&&t.apply(this,a),n.off(e,i)}this.on.call(this,e,i,r)};var oPe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var bE={},Pb={},J$=[],Q$=[],wE=[],goe={},eN={},Ib={},fG={},sPe=+new Date-0,T3="_echarts_instance_";function lPe(e,t,r){var n=!(r&&r.ssr);if(n){var i=uPe(e);if(i)return i}var a=new poe(e,t,r);return a.id="ec_"+sPe++,Ib[a.id]=a,n&&iie(e,T3,a.id),voe(a),us.trigger("afterinit",a),a}function uPe(e){return Ib[TTe(e,T3)]}function yoe(e,t){goe[e]=t}function moe(e){Hr(Q$,e)<0&&Q$.push(e)}function boe(e,t){E3(J$,e,t,qAe)}function fPe(e){O3("afterinit",e)}function cPe(e){O3("afterupdate",e)}function O3(e,t){us.on(e,t)}function wm(e,t,r){Zt(t)&&(r=t,t="");var n=Tt(e)?e.type:[e,e={event:t}][0];e.event=(e.event||n).toLowerCase(),t=e.event,!Pb[t]&&(ku(nG.test(n)&&nG.test(t)),bE[n]||(bE[n]={action:r,actionInfo:e}),Pb[t]=n)}function hPe(e,t){p3.register(e,t)}function dPe(e,t){E3(wE,e,t,ooe,"layout")}function Hd(e,t){E3(wE,e,t,soe,"visual")}var cG=[];function E3(e,t,r,n,i){if((Zt(t)||Tt(t))&&(r=t,t=n),!(Hr(cG,r)>=0)){cG.push(r);var a=Xae.wrapStageHandler(r,i);a.__prio=t,a.__raw=r,e.push(a)}}function woe(e,t){eN[e]=t}function vPe(e,t,r){var n=zAe("registerMap");n&&n(e,t,r)}var pPe=gke;Hd(C3,zke);Hd(xk,Gke);Hd(xk,Yke);Hd(C3,lAe);Hd(xk,uAe);Hd(loe,WAe);moe(Oae);boe(KAe,JRe);woe("default",Kke);wm({type:sd,event:sd,update:sd},Ta);wm({type:KT,event:KT,update:KT},Ta);wm({type:xb,event:xb,update:xb},Ta);wm({type:XT,event:XT,update:XT},Ta);wm({type:Tb,event:Tb,update:Tb},Ta);yoe("light",aAe);yoe("dark",oAe);function g0(e){return e==null?0:e.length||1}function hG(e){return e}var gPe=function(){function e(t,r,n,i,a,o){this._old=t,this._new=r,this._oldKeyGetter=n||hG,this._newKeyGetter=i||hG,this.context=a,this._diffModeMultiple=o==="multiple"}return e.prototype.add=function(t){return this._add=t,this},e.prototype.update=function(t){return this._update=t,this},e.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},e.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},e.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},e.prototype.remove=function(t){return this._remove=t,this},e.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},e.prototype._executeOneToOne=function(){var t=this._old,r=this._new,n={},i=new Array(t.length),a=new Array(r.length);this._initIndexMap(t,null,i,"_oldKeyGetter"),this._initIndexMap(r,n,a,"_newKeyGetter");for(var o=0;o<t.length;o++){var s=i[o],l=n[s],u=g0(l);if(u>1){var f=l.shift();l.length===1&&(n[s]=l[0]),this._update&&this._update(f,o)}else u===1?(n[s]=null,this._update&&this._update(l,o)):this._remove&&this._remove(o)}this._performRestAdd(a,n)},e.prototype._executeMultiple=function(){var t=this._old,r=this._new,n={},i={},a=[],o=[];this._initIndexMap(t,n,a,"_oldKeyGetter"),this._initIndexMap(r,i,o,"_newKeyGetter");for(var s=0;s<a.length;s++){var l=a[s],u=n[l],f=i[l],c=g0(u),h=g0(f);if(c>1&&h===1)this._updateManyToOne&&this._updateManyToOne(f,u),i[l]=null;else if(c===1&&h>1)this._updateOneToMany&&this._updateOneToMany(f,u),i[l]=null;else if(c===1&&h===1)this._update&&this._update(f,u),i[l]=null;else if(c>1&&h>1)this._updateManyToMany&&this._updateManyToMany(f,u),i[l]=null;else if(c>1)for(var d=0;d<c;d++)this._remove&&this._remove(u[d]);else this._remove&&this._remove(u)}this._performRestAdd(o,i)},e.prototype._performRestAdd=function(t,r){for(var n=0;n<t.length;n++){var i=t[n],a=r[i],o=g0(a);if(o>1)for(var s=0;s<o;s++)this._add&&this._add(a[s]);else o===1&&this._add&&this._add(a);r[i]=null}},e.prototype._initIndexMap=function(t,r,n,i){for(var a=this._diffModeMultiple,o=0;o<t.length;o++){var s="_ec_"+this[i](t[o],o);if(a||(n[o]=s),!!r){var l=r[s],u=g0(l);u===0?(r[s]=o,a&&n.push(s)):u===1?r[s]=[l,o]:l.push(o)}}},e}();const yPe=gPe;var mPe=function(){function e(t,r){this._encode=t,this._schema=r}return e.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},e.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},e}();function bPe(e,t){var r={},n=r.encode={},i=ir(),a=[],o=[],s={};ce(e.dimensions,function(h){var d=e.getDimensionInfo(h),v=d.coordDim;if(v){var g=d.coordDimIndex;nM(n,v)[g]=h,d.isExtraCoord||(i.set(v,1),_Pe(d.type)&&(a[0]=h),nM(s,v)[g]=e.getDimensionIndex(d.name)),d.defaultTooltip&&o.push(h)}yae.each(function(y,b){var w=nM(n,b),_=d.otherDims[b];_!=null&&_!==!1&&(w[_]=d.name)})});var l=[],u={};i.each(function(h,d){var v=n[d];u[d]=v[0],l=l.concat(v)}),r.dataDimsOnCoord=l,r.dataDimIndicesOnCoord=Rt(l,function(h){return e.getDimensionInfo(h).storeDimIndex}),r.encodeFirstDimNotExtra=u;var f=n.label;f&&f.length&&(a=f.slice());var c=n.tooltip;return c&&c.length?o=c.slice():o.length||(o=a.slice()),n.defaultedLabel=a,n.defaultedTooltip=o,r.userOutput=new mPe(s,t),r}function nM(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}function wPe(e){return e==="category"?"ordinal":e==="time"?"time":"float"}function _Pe(e){return!(e==="ordinal"||e==="time")}var SPe=function(){function e(t){this.otherDims={},t!=null&&Ze(this,t)}return e}();const QT=SPe;var CPe=zn(),xPe={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},_oe=function(){function e(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return e.prototype.isDimensionOmitted=function(){return this._dimOmitted},e.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=xoe(this.source)))},e.prototype.getSourceDimensionIndex=function(t){return pr(this._dimNameMap.get(t),-1)},e.prototype.getSourceDimension=function(t){var r=this.source.dimensionsDefine;if(r)return r[t]},e.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,r=Rae(this.source),n=!Toe(t),i="",a=[],o=0,s=0;o<t;o++){var l=void 0,u=void 0,f=void 0,c=this.dimensions[s];if(c&&c.storeDimIndex===o)l=r?c.name:null,u=c.type,f=c.ordinalMeta,s++;else{var h=this.getSourceDimension(o);h&&(l=r?h.name:null,u=h.type)}a.push({property:l,type:u,ordinalMeta:f}),r&&l!=null&&(!c||!c.isCalculationCoord)&&(i+=n?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),i+="$",i+=xPe[u]||"f",f&&(i+=f.uid),i+="$"}var d=this.source,v=[d.seriesLayoutBy,d.startIndex,i].join("$$");return{dimensions:a,hash:v}},e.prototype.makeOutputDimensionNames=function(){for(var t=[],r=0,n=0;r<this._fullDimCount;r++){var i=void 0,a=this.dimensions[n];if(a&&a.storeDimIndex===r)a.isCalculationCoord||(i=a.name),n++;else{var o=this.getSourceDimension(r);o&&(i=o.name)}t.push(i)}return t},e.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},e}();function Soe(e){return e instanceof _oe}function Coe(e){for(var t=ir(),r=0;r<(e||[]).length;r++){var n=e[r],i=Tt(n)?n.name:n;i!=null&&t.get(i)==null&&t.set(i,r)}return t}function xoe(e){var t=CPe(e);return t.dimNameMap||(t.dimNameMap=Coe(e.dimensionsDefine))}function Toe(e){return e>30}var y0=Tt,ff=Rt,TPe=typeof Int32Array>"u"?Array:Int32Array,OPe="e\0\0",dG=-1,EPe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],RPe=["_approximateExtent"],vG,lx,m0,b0,iM,ux,aM,kPe=function(){function e(t,r){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var n,i=!1;Soe(t)?(n=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(i=!0,n=t),n=n||["x","y"];for(var a={},o=[],s={},l=!1,u={},f=0;f<n.length;f++){var c=n[f],h=bt(c)?new QT({name:c}):c instanceof QT?c:new QT(c),d=h.name;h.type=h.type||"float",h.coordDim||(h.coordDim=d,h.coordDimIndex=0);var v=h.otherDims=h.otherDims||{};o.push(d),a[d]=h,u[d]!=null&&(l=!0),h.createInvertedIndices&&(s[d]=[]),v.itemName===0&&(this._nameDimIdx=f),v.itemId===0&&(this._idDimIdx=f),i&&(h.storeDimIndex=f)}if(this.dimensions=o,this._dimInfos=a,this._initGetDimensionInfo(l),this.hostModel=r,this._invertedIndicesMap=s,this._dimOmitted){var g=this._dimIdxToName=ir();ce(o,function(y){g.set(a[y].storeDimIndex,y)})}}return e.prototype.getDimension=function(t){var r=this._recognizeDimIndex(t);if(r==null)return t;if(r=t,!this._dimOmitted)return this.dimensions[r];var n=this._dimIdxToName.get(r);if(n!=null)return n;var i=this._schema.getSourceDimension(r);if(i)return i.name},e.prototype.getDimensionIndex=function(t){var r=this._recognizeDimIndex(t);if(r!=null)return r;if(t==null)return-1;var n=this._getDimInfo(t);return n?n.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},e.prototype._recognizeDimIndex=function(t){if(Ur(t)||t!=null&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},e.prototype._getStoreDimIndex=function(t){var r=this.getDimensionIndex(t);return r},e.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},e.prototype._initGetDimensionInfo=function(t){var r=this._dimInfos;this._getDimInfo=t?function(n){return r.hasOwnProperty(n)?r[n]:void 0}:function(n){return r[n]}},e.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},e.prototype.mapDimension=function(t,r){var n=this._dimSummary;if(r==null)return n.encodeFirstDimNotExtra[t];var i=n.encode[t];return i?i[r]:null},e.prototype.mapDimensionsAll=function(t){var r=this._dimSummary,n=r.encode[t];return(n||[]).slice()},e.prototype.getStore=function(){return this._store},e.prototype.initData=function(t,r,n){var i=this,a;if(t instanceof W$&&(a=t),!a){var o=this.dimensions,s=g3(t)||Ea(t)?new kae(t,o.length):t;a=new W$;var l=ff(o,function(u){return{type:i._dimInfos[u].type,property:u}});a.initData(s,l,n)}this._store=a,this._nameList=(r||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,a.count()),this._dimSummary=bPe(this,this._schema),this.userOutput=this._dimSummary.userOutput},e.prototype.appendData=function(t){var r=this._store.appendData(t);this._doInit(r[0],r[1])},e.prototype.appendValues=function(t,r){var n=this._store.appendValues(t,r.length),i=n.start,a=n.end,o=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),r)for(var s=i;s<a;s++){var l=s-i;this._nameList[s]=r[l],o&&aM(this,s)}},e.prototype._updateOrdinalMeta=function(){for(var t=this._store,r=this.dimensions,n=0;n<r.length;n++){var i=this._dimInfos[r[n]];i.ordinalMeta&&t.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},e.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return this._idDimIdx==null&&t.getSource().sourceFormat!==jf&&!t.fillStorage},e.prototype._doInit=function(t,r){if(!(t>=r)){var n=this._store,i=n.getProvider();this._updateOrdinalMeta();var a=this._nameList,o=this._idList,s=i.getSource().sourceFormat,l=s===Bo;if(l&&!i.pure)for(var u=[],f=t;f<r;f++){var c=i.getItem(f,u);if(!this.hasItemOption&&vTe(c)&&(this.hasItemOption=!0),c){var h=c.name;a[f]==null&&h!=null&&(a[f]=sl(h,null));var d=c.id;o[f]==null&&d!=null&&(o[f]=sl(d,null))}}if(this._shouldMakeIdFromName())for(var f=t;f<r;f++)aM(this,f);vG(this)}},e.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.setApproximateExtent=function(t,r){r=this.getDimension(r),this._approximateExtent[r]=t.slice()},e.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},e.prototype.setCalculationInfo=function(t,r){y0(t)?Ze(this._calculationInfo,t):this._calculationInfo[t]=r},e.prototype.getName=function(t){var r=this.getRawIndex(t),n=this._nameList[r];return n==null&&this._nameDimIdx!=null&&(n=m0(this,this._nameDimIdx,r)),n==null&&(n=""),n},e.prototype._getCategory=function(t,r){var n=this._store.get(t,r),i=this._store.getOrdinalMeta(t);return i?i.categories[n]:n},e.prototype.getId=function(t){return lx(this,this.getRawIndex(t))},e.prototype.count=function(){return this._store.count()},e.prototype.get=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.get(i.storeDimIndex,r)},e.prototype.getByRawIndex=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.getByRawIndex(i.storeDimIndex,r)},e.prototype.getIndices=function(){return this._store.getIndices()},e.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},e.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},e.prototype.getValues=function(t,r){var n=this,i=this._store;return dt(t)?i.getValues(ff(t,function(a){return n._getStoreDimIndex(a)}),r):i.getValues(t)},e.prototype.hasValue=function(t){for(var r=this._dimSummary.dataDimIndicesOnCoord,n=0,i=r.length;n<i;n++)if(isNaN(this._store.get(r[n],t)))return!1;return!0},e.prototype.indexOfName=function(t){for(var r=0,n=this._store.count();r<n;r++)if(this.getName(r)===t)return r;return-1},e.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},e.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},e.prototype.rawIndexOf=function(t,r){var n=t&&this._invertedIndicesMap[t],i=n[r];return i==null||isNaN(i)?dG:i},e.prototype.indicesOfNearest=function(t,r,n){return this._store.indicesOfNearest(this._getStoreDimIndex(t),r,n)},e.prototype.each=function(t,r,n){Zt(t)&&(n=r,r=t,t=[]);var i=n||this,a=ff(b0(t),this._getStoreDimIndex,this);this._store.each(a,i?Jr(r,i):r)},e.prototype.filterSelf=function(t,r,n){Zt(t)&&(n=r,r=t,t=[]);var i=n||this,a=ff(b0(t),this._getStoreDimIndex,this);return this._store=this._store.filter(a,i?Jr(r,i):r),this},e.prototype.selectRange=function(t){var r=this,n={},i=sn(t);return ce(i,function(a){var o=r._getStoreDimIndex(a);n[o]=t[a]}),this._store=this._store.selectRange(n),this},e.prototype.mapArray=function(t,r,n){Zt(t)&&(n=r,r=t,t=[]),n=n||this;var i=[];return this.each(t,function(){i.push(r&&r.apply(this,arguments))},n),i},e.prototype.map=function(t,r,n,i){var a=n||i||this,o=ff(b0(t),this._getStoreDimIndex,this),s=ux(this);return s._store=this._store.map(o,a?Jr(r,a):r),s},e.prototype.modify=function(t,r,n,i){var a=n||i||this,o=ff(b0(t),this._getStoreDimIndex,this);this._store.modify(o,a?Jr(r,a):r)},e.prototype.downSample=function(t,r,n,i){var a=ux(this);return a._store=this._store.downSample(this._getStoreDimIndex(t),r,n,i),a},e.prototype.lttbDownSample=function(t,r){var n=ux(this);return n._store=this._store.lttbDownSample(this._getStoreDimIndex(t),r),n},e.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},e.prototype.getItemModel=function(t){var r=this.hostModel,n=this.getRawDataItem(t);return new Ei(n,r,r&&r.ecModel)},e.prototype.diff=function(t){var r=this;return new yPe(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(n){return lx(t,n)},function(n){return lx(r,n)})},e.prototype.getVisual=function(t){var r=this._visual;return r&&r[t]},e.prototype.setVisual=function(t,r){this._visual=this._visual||{},y0(t)?Ze(this._visual,t):this._visual[t]=r},e.prototype.getItemVisual=function(t,r){var n=this._itemVisuals[t],i=n&&n[r];return i??this.getVisual(r)},e.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},e.prototype.ensureUniqueItemVisual=function(t,r){var n=this._itemVisuals,i=n[t];i||(i=n[t]={});var a=i[r];return a==null&&(a=this.getVisual(r),dt(a)?a=a.slice():y0(a)&&(a=Ze({},a)),i[r]=a),a},e.prototype.setItemVisual=function(t,r,n){var i=this._itemVisuals[t]||{};this._itemVisuals[t]=i,y0(r)?Ze(i,r):i[r]=n},e.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},e.prototype.setLayout=function(t,r){y0(t)?Ze(this._layout,t):this._layout[t]=r},e.prototype.getLayout=function(t){return this._layout[t]},e.prototype.getItemLayout=function(t){return this._itemLayouts[t]},e.prototype.setItemLayout=function(t,r,n){this._itemLayouts[t]=n?Ze(this._itemLayouts[t]||{},r):r},e.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},e.prototype.setItemGraphicEl=function(t,r){var n=this.hostModel&&this.hostModel.seriesIndex;kOe(n,this.dataType,t,r),this._graphicEls[t]=r},e.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},e.prototype.eachItemGraphicEl=function(t,r){ce(this._graphicEls,function(n,i){n&&t&&t.call(r,n,i)})},e.prototype.cloneShallow=function(t){return t||(t=new e(this._schema?this._schema:ff(this.dimensions,this._getDimInfo,this),this.hostModel)),iM(t,this),t._store=this._store,t},e.prototype.wrapMethod=function(t,r){var n=this[t];Zt(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var i=n.apply(this,arguments);return r.apply(this,[i].concat($B(arguments)))})},e.internalField=function(){vG=function(t){var r=t._invertedIndicesMap;ce(r,function(n,i){var a=t._dimInfos[i],o=a.ordinalMeta,s=t._store;if(o){n=r[i]=new TPe(o.categories.length);for(var l=0;l<n.length;l++)n[l]=dG;for(var l=0;l<s.count();l++)n[s.get(a.storeDimIndex,l)]=l}})},m0=function(t,r,n){return sl(t._getCategory(r,n),null)},lx=function(t,r){var n=t._idList[r];return n==null&&t._idDimIdx!=null&&(n=m0(t,t._idDimIdx,r)),n==null&&(n=OPe+r),n},b0=function(t){return dt(t)||(t=t!=null?[t]:[]),t},ux=function(t){var r=new e(t._schema?t._schema:ff(t.dimensions,t._getDimInfo,t),t.hostModel);return iM(r,t),r},iM=function(t,r){ce(EPe.concat(r.__wrappedMethods||[]),function(n){r.hasOwnProperty(n)&&(t[n]=r[n])}),t.__wrappedMethods=r.__wrappedMethods,ce(RPe,function(n){t[n]=mr(r[n])}),t._calculationInfo=Ze({},r._calculationInfo)},aM=function(t,r){var n=t._nameList,i=t._idList,a=t._nameDimIdx,o=t._idDimIdx,s=n[r],l=i[r];if(s==null&&a!=null&&(n[r]=s=m0(t,a,r)),l==null&&o!=null&&(i[r]=l=m0(t,o,r)),l==null&&s!=null){var u=t._nameRepeatCount,f=u[s]=(u[s]||0)+1;l=s,f>1&&(l+="__ec__"+f),i[r]=l}}}(),e}();const Ooe=kPe;function Eoe(e,t){g3(e)||(e=y3(e)),t=t||{};var r=t.coordDimensions||[],n=t.dimensionsDefine||e.dimensionsDefine||[],i=ir(),a=[],o=PPe(e,r,n,t.dimensionsCount),s=t.canOmitUnusedDimensions&&Toe(o),l=n===e.dimensionsDefine,u=l?xoe(e):Coe(n),f=t.encodeDefine;!f&&t.encodeDefaulter&&(f=t.encodeDefaulter(e,o));for(var c=ir(f),h=new Dae(o),d=0;d<h.length;d++)h[d]=-1;function v(P){var N=h[P];if(N<0){var D=n[P],L=Tt(D)?D:{name:D},V=new QT,ee=L.name;ee!=null&&u.get(ee)!=null&&(V.name=V.displayName=ee),L.type!=null&&(V.type=L.type),L.displayName!=null&&(V.displayName=L.displayName);var ie=a.length;return h[P]=ie,V.storeDimIndex=P,a.push(V),V}return a[N]}if(!s)for(var d=0;d<o;d++)v(d);c.each(function(P,N){var D=na(P).slice();if(D.length===1&&!bt(D[0])&&D[0]<0){c.set(N,!1);return}var L=c.set(N,[]);ce(D,function(V,ee){var ie=bt(V)?u.get(V):V;ie!=null&&ie<o&&(L[ee]=ie,y(v(ie),N,ee))})});var g=0;ce(r,function(P){var N,D,L,V;if(bt(P))N=P,V={};else{V=P,N=V.name;var ee=V.ordinalMeta;V.ordinalMeta=null,V=Ze({},V),V.ordinalMeta=ee,D=V.dimsDef,L=V.otherDims,V.name=V.coordDim=V.coordDimIndex=V.dimsDef=V.otherDims=null}var ie=c.get(N);if(ie!==!1){if(ie=na(ie),!ie.length)for(var le=0;le<(D&&D.length||1);le++){for(;g<o&&v(g).coordDim!=null;)g++;g<o&&ie.push(g++)}ce(ie,function(_e,U){var C=v(_e);if(l&&V.type!=null&&(C.type=V.type),y(Mr(C,V),N,U),C.name==null&&D){var R=D[U];!Tt(R)&&(R={name:R}),C.name=C.displayName=R.name,C.defaultTooltip=R.defaultTooltip}L&&Mr(C.otherDims,L)})}});function y(P,N,D){yae.get(N)!=null?P.otherDims[N]=D:(P.coordDim=N,P.coordDimIndex=D,i.set(N,!0))}var b=t.generateCoord,w=t.generateCoordCount,_=w!=null;w=b?w||1:0;var x=b||"value";function T(P){P.name==null&&(P.name=P.coordDim)}if(s)ce(a,function(P){T(P)}),a.sort(function(P,N){return P.storeDimIndex-N.storeDimIndex});else for(var O=0;O<o;O++){var E=v(O),M=E.coordDim;M==null&&(E.coordDim=IPe(x,i,_),E.coordDimIndex=0,(!b||w<=0)&&(E.isExtraCoord=!0),w--),T(E),E.type==null&&(wae(e,O)===hi.Must||E.isExtraCoord&&(E.otherDims.itemName!=null||E.otherDims.seriesName!=null))&&(E.type="ordinal")}return APe(a),new _oe({source:e,dimensions:a,fullDimensionCount:o,dimensionOmitted:s})}function APe(e){for(var t=ir(),r=0;r<e.length;r++){var n=e[r],i=n.name,a=t.get(i)||0;a>0&&(n.name=i+(a-1)),a++,t.set(i,a)}}function PPe(e,t,r,n){var i=Math.max(e.dimensionsDetectedCount||1,t.length,r.length,n||0);return ce(t,function(a){var o;Tt(a)&&(o=a.dimsDef)&&(i=Math.max(i,o.length))}),i}function IPe(e,t,r){if(r||t.hasKey(e)){for(var n=0;t.hasKey(e+n);)n++;e+=n}return t.set(e,!0),e}var MPe=function(){function e(t){this.coordSysDims=[],this.axisMap=ir(),this.categoryAxisMap=ir(),this.coordSysName=t}return e}();function DPe(e){var t=e.get("coordinateSystem"),r=new MPe(t),n=$Pe[t];if(n)return n(e,r,r.axisMap,r.categoryAxisMap),r}var $Pe={cartesian2d:function(e,t,r,n){var i=e.getReferringComponents("xAxis",ys).models[0],a=e.getReferringComponents("yAxis",ys).models[0];t.coordSysDims=["x","y"],r.set("x",i),r.set("y",a),Iv(i)&&(n.set("x",i),t.firstCategoryDimIndex=0),Iv(a)&&(n.set("y",a),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},singleAxis:function(e,t,r,n){var i=e.getReferringComponents("singleAxis",ys).models[0];t.coordSysDims=["single"],r.set("single",i),Iv(i)&&(n.set("single",i),t.firstCategoryDimIndex=0)},polar:function(e,t,r,n){var i=e.getReferringComponents("polar",ys).models[0],a=i.findAxisModel("radiusAxis"),o=i.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],r.set("radius",a),r.set("angle",o),Iv(a)&&(n.set("radius",a),t.firstCategoryDimIndex=0),Iv(o)&&(n.set("angle",o),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},geo:function(e,t,r,n){t.coordSysDims=["lng","lat"]},parallel:function(e,t,r,n){var i=e.ecModel,a=i.getComponent("parallel",e.get("parallelIndex")),o=t.coordSysDims=a.dimensions.slice();ce(a.parallelAxisIndex,function(s,l){var u=i.getComponent("parallelAxis",s),f=o[l];r.set(f,u),Iv(u)&&(n.set(f,u),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=l))})}};function Iv(e){return e.get("type")==="category"}function NPe(e,t,r){r=r||{};var n=r.byIndex,i=r.stackedCoordDimension,a,o,s;LPe(t)?a=t:(o=t.schema,a=o.dimensions,s=t.store);var l=!!(e&&e.get("stack")),u,f,c,h;if(ce(a,function(w,_){bt(w)&&(a[_]=w={name:w}),l&&!w.isExtraCoord&&(!n&&!u&&w.ordinalMeta&&(u=w),!f&&w.type!=="ordinal"&&w.type!=="time"&&(!i||i===w.coordDim)&&(f=w))}),f&&!n&&!u&&(n=!0),f){c="__\0ecstackresult_"+e.id,h="__\0ecstackedover_"+e.id,u&&(u.createInvertedIndices=!0);var d=f.coordDim,v=f.type,g=0;ce(a,function(w){w.coordDim===d&&g++});var y={name:c,coordDim:d,coordDimIndex:g,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length},b={name:h,coordDim:h,coordDimIndex:g+1,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length+1};o?(s&&(y.storeDimIndex=s.ensureCalculationDimension(h,v),b.storeDimIndex=s.ensureCalculationDimension(c,v)),o.appendCalculationDimension(y),o.appendCalculationDimension(b)):(a.push(y),a.push(b))}return{stackedDimension:f&&f.name,stackedByDimension:u&&u.name,isStackedByIndex:n,stackedOverDimension:h,stackResultDimension:c}}function LPe(e){return!Soe(e.schema)}function ig(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function FPe(e,t){return ig(e,t)?e.getCalculationInfo("stackResultDimension"):t}function HPe(e,t){var r=e.get("coordinateSystem"),n=p3.get(r),i;return t&&t.coordSysDims&&(i=Rt(t.coordSysDims,function(a){var o={name:a},s=t.axisMap.get(a);if(s){var l=s.get("type");o.type=wPe(l)}return o})),i||(i=n&&(n.getDimensionsInfo?n.getDimensionsInfo():n.dimensions.slice())||["x","y"]),i}function BPe(e,t,r){var n,i;return r&&ce(e,function(a,o){var s=a.coordDim,l=r.categoryAxisMap.get(s);l&&(n==null&&(n=o),a.ordinalMeta=l.getOrdinalMeta(),t&&(a.createInvertedIndices=!0)),a.otherDims.itemName!=null&&(i=!0)}),!i&&n!=null&&(e[n].otherDims.itemName=0),n}function R3(e,t,r){r=r||{};var n=t.getSourceManager(),i,a=!1;e?(a=!0,i=y3(e)):(i=n.getSource(),a=i.sourceFormat===Bo);var o=DPe(t),s=HPe(t,o),l=r.useEncodeDefaulter,u=Zt(l)?l:l?Mn(xRe,s,t):null,f={coordDimensions:s,generateCoord:r.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!a},c=Eoe(i,f),h=BPe(c.dimensions,r.createInvertedIndices,o),d=a?null:n.getSharedDataStore(c),v=NPe(t,{schema:c,store:d}),g=new Ooe(c,t);g.setCalculationInfo(v);var y=h!=null&&VPe(i)?function(b,w,_,x){return x===h?_:this.defaultDimValueGetter(b,w,_,x)}:null;return g.hasItemOption=!1,g.initData(a?i:d,null,y),g}function VPe(e){if(e.sourceFormat===Bo){var t=WPe(e.data||[]);return!dt(BS(t))}}function WPe(e){for(var t=0;t<e.length&&e[t]==null;)t++;return e[t]}var Roe=function(){function e(t){this._setting=t||{},this._extent=[1/0,-1/0]}return e.prototype.getSetting=function(t){return this._setting[t]},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1])},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.setExtent=function(t,r){var n=this._extent;isNaN(t)||(n[0]=t),isNaN(r)||(n[1]=r)},e.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},e.prototype.isBlank=function(){return this._isBlank},e.prototype.setBlank=function(t){this._isBlank=t},e}();rk(Roe);const Bu=Roe;var jPe=0,UPe=function(){function e(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++jPe}return e.createByAxisModel=function(t){var r=t.option,n=r.data,i=n&&Rt(n,zPe);return new e({categories:i,needCollect:!i,deduplication:r.dedplication!==!1})},e.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},e.prototype.parseAndCollect=function(t){var r,n=this._needCollect;if(!bt(t)&&!n)return t;if(n&&!this._deduplication)return r=this.categories.length,this.categories[r]=t,r;var i=this._getOrCreateMap();return r=i.get(t),r==null&&(n?(r=this.categories.length,this.categories[r]=t,i.set(t,r)):r=NaN),r},e.prototype._getOrCreateMap=function(){return this._map||(this._map=ir(this.categories))},e}();function zPe(e){return Tt(e)&&e.value!=null?e.value:e+""}const tN=UPe;function rN(e){return e.type==="interval"||e.type==="log"}function GPe(e,t,r,n){var i={},a=e[1]-e[0],o=i.interval=Qne(a/t,!0);r!=null&&o<r&&(o=i.interval=r),n!=null&&o>n&&(o=i.interval=n);var s=i.intervalPrecision=koe(o),l=i.niceTickExtent=[jn(Math.ceil(e[0]/o)*o,s),jn(Math.floor(e[1]/o)*o,s)];return YPe(l,e),i}function oM(e){var t=Math.pow(10,zB(e)),r=e/t;return r?r===2?r=3:r===3?r=5:r*=2:r=1,jn(r*t)}function koe(e){return Yl(e)+2}function pG(e,t,r){e[t]=Math.max(Math.min(e[t],r[1]),r[0])}function YPe(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),pG(e,0,t),pG(e,1,t),e[0]>e[1]&&(e[0]=e[1])}function Tk(e,t){return e>=t[0]&&e<=t[1]}function Ok(e,t){return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])}function Ek(e,t){return e*(t[1]-t[0])+t[0]}var Aoe=function(e){st(t,e);function t(r){var n=e.call(this,r)||this;n.type="ordinal";var i=n.getSetting("ordinalMeta");return i||(i=new tN({})),dt(i)&&(i=new tN({categories:Rt(i,function(a){return Tt(a)?a.value:a})})),n._ordinalMeta=i,n._extent=n.getSetting("extent")||[0,i.categories.length-1],n}return t.prototype.parse=function(r){return r==null?NaN:bt(r)?this._ordinalMeta.getOrdinal(r):Math.round(r)},t.prototype.contain=function(r){return r=this.parse(r),Tk(r,this._extent)&&this._ordinalMeta.categories[r]!=null},t.prototype.normalize=function(r){return r=this._getTickNumber(this.parse(r)),Ok(r,this._extent)},t.prototype.scale=function(r){return r=Math.round(Ek(r,this._extent)),this.getRawOrdinalNumber(r)},t.prototype.getTicks=function(){for(var r=[],n=this._extent,i=n[0];i<=n[1];)r.push({value:i}),i++;return r},t.prototype.getMinorTicks=function(r){},t.prototype.setSortInfo=function(r){if(r==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var n=r.ordinalNumbers,i=this._ordinalNumbersByTick=[],a=this._ticksByOrdinalNumber=[],o=0,s=this._ordinalMeta.categories.length,l=Math.min(s,n.length);o<l;++o){var u=n[o];i[o]=u,a[u]=o}for(var f=0;o<s;++o){for(;a[f]!=null;)f++;i.push(f),a[f]=o}},t.prototype._getTickNumber=function(r){var n=this._ticksByOrdinalNumber;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getRawOrdinalNumber=function(r){var n=this._ordinalNumbersByTick;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getLabel=function(r){if(!this.isBlank()){var n=this.getRawOrdinalNumber(r.value),i=this._ordinalMeta.categories[n];return i==null?"":i+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.isInExtentRange=function(r){return r=this._getTickNumber(r),this._extent[0]<=r&&this._extent[1]>=r},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(Bu);Bu.registerClass(Aoe);const Poe=Aoe;var ih=jn,Ioe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="interval",r._interval=0,r._intervalPrecision=2,r}return t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return Tk(r,this._extent)},t.prototype.normalize=function(r){return Ok(r,this._extent)},t.prototype.scale=function(r){return Ek(r,this._extent)},t.prototype.setExtent=function(r,n){var i=this._extent;isNaN(r)||(i[0]=parseFloat(r)),isNaN(n)||(i[1]=parseFloat(n))},t.prototype.unionExtent=function(r){var n=this._extent;r[0]<n[0]&&(n[0]=r[0]),r[1]>n[1]&&(n[1]=r[1]),this.setExtent(n[0],n[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(r){this._interval=r,this._niceExtent=this._extent.slice(),this._intervalPrecision=koe(r)},t.prototype.getTicks=function(r){var n=this._interval,i=this._extent,a=this._niceExtent,o=this._intervalPrecision,s=[];if(!n)return s;var l=1e4;i[0]<a[0]&&(r?s.push({value:ih(a[0]-n,o)}):s.push({value:i[0]}));for(var u=a[0];u<=a[1]&&(s.push({value:u}),u=ih(u+n,o),u!==s[s.length-1].value);)if(s.length>l)return[];var f=s.length?s[s.length-1].value:a[1];return i[1]>f&&(r?s.push({value:ih(f+n,o)}):s.push({value:i[1]})),s},t.prototype.getMinorTicks=function(r){for(var n=this.getTicks(!0),i=[],a=this.getExtent(),o=1;o<n.length;o++){for(var s=n[o],l=n[o-1],u=0,f=[],c=s.value-l.value,h=c/r;u<r-1;){var d=ih(l.value+(u+1)*h);d>a[0]&&d<a[1]&&f.push(d),u++}i.push(f)}return i},t.prototype.getLabel=function(r,n){if(r==null)return"";var i=n&&n.precision;i==null?i=Yl(r.value)||0:i==="auto"&&(i=this._intervalPrecision);var a=ih(r.value,i,!0);return dae(a)},t.prototype.calcNiceTicks=function(r,n,i){r=r||5;var a=this._extent,o=a[1]-a[0];if(isFinite(o)){o<0&&(o=-o,a.reverse());var s=GPe(a,r,n,i);this._intervalPrecision=s.intervalPrecision,this._interval=s.interval,this._niceExtent=s.niceTickExtent}},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1])if(n[0]!==0){var i=Math.abs(n[0]);r.fixMax||(n[1]+=i/2),n[0]-=i/2}else n[1]=1;var a=n[1]-n[0];isFinite(a)||(n[0]=0,n[1]=1),this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval);var o=this._interval;r.fixMin||(n[0]=ih(Math.floor(n[0]/o)*o)),r.fixMax||(n[1]=ih(Math.ceil(n[1]/o)*o))},t.prototype.setNiceExtent=function(r,n){this._niceExtent=[r,n]},t.type="interval",t}(Bu);Bu.registerClass(Ioe);const zS=Ioe;var Moe=typeof Float32Array<"u",KPe=Moe?Float32Array:Array;function Kl(e){return dt(e)?Moe?new Float32Array(e):e:new KPe(e)}var XPe="__ec_stack_";function k3(e){return e.get("stack")||XPe+e.seriesIndex}function A3(e){return e.dim+e.index}function Doe(e,t){var r=[];return t.eachSeriesByType(e,function(n){Noe(n)&&r.push(n)}),r}function qPe(e){var t={};ce(e,function(l){var u=l.coordinateSystem,f=u.getBaseAxis();if(!(f.type!=="time"&&f.type!=="value"))for(var c=l.getData(),h=f.dim+"_"+f.index,d=c.getDimensionIndex(c.mapDimension(f.dim)),v=c.getStore(),g=0,y=v.count();g<y;++g){var b=v.get(d,g);t[h]?t[h].push(b):t[h]=[b]}});var r={};for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(i){i.sort(function(l,u){return l-u});for(var a=null,o=1;o<i.length;++o){var s=i[o]-i[o-1];s>0&&(a=a===null?s:Math.min(a,s))}r[n]=a}}return r}function $oe(e){var t=qPe(e),r=[];return ce(e,function(n){var i=n.coordinateSystem,a=i.getBaseAxis(),o=a.getExtent(),s;if(a.type==="category")s=a.getBandWidth();else if(a.type==="value"||a.type==="time"){var l=a.dim+"_"+a.index,u=t[l],f=Math.abs(o[1]-o[0]),c=a.scale.getExtent(),h=Math.abs(c[1]-c[0]);s=u?f/h*u:f}else{var d=n.getData();s=Math.abs(o[1]-o[0])/d.count()}var v=on(n.get("barWidth"),s),g=on(n.get("barMaxWidth"),s),y=on(n.get("barMinWidth")||(Loe(n)?.5:1),s),b=n.get("barGap"),w=n.get("barCategoryGap");r.push({bandWidth:s,barWidth:v,barMaxWidth:g,barMinWidth:y,barGap:b,barCategoryGap:w,axisKey:A3(a),stackId:k3(n)})}),ZPe(r)}function ZPe(e){var t={};ce(e,function(n,i){var a=n.axisKey,o=n.bandWidth,s=t[a]||{bandWidth:o,remainedWidth:o,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=s.stacks;t[a]=s;var u=n.stackId;l[u]||s.autoWidthCount++,l[u]=l[u]||{width:0,maxWidth:0};var f=n.barWidth;f&&!l[u].width&&(l[u].width=f,f=Math.min(s.remainedWidth,f),s.remainedWidth-=f);var c=n.barMaxWidth;c&&(l[u].maxWidth=c);var h=n.barMinWidth;h&&(l[u].minWidth=h);var d=n.barGap;d!=null&&(s.gap=d);var v=n.barCategoryGap;v!=null&&(s.categoryGap=v)});var r={};return ce(t,function(n,i){r[i]={};var a=n.stacks,o=n.bandWidth,s=n.categoryGap;if(s==null){var l=sn(a).length;s=Math.max(35-l*4,15)+"%"}var u=on(s,o),f=on(n.gap,1),c=n.remainedWidth,h=n.autoWidthCount,d=(c-u)/(h+(h-1)*f);d=Math.max(d,0),ce(a,function(b){var w=b.maxWidth,_=b.minWidth;if(b.width){var x=b.width;w&&(x=Math.min(x,w)),_&&(x=Math.max(x,_)),b.width=x,c-=x+f*x,h--}else{var x=d;w&&w<x&&(x=Math.min(w,c)),_&&_>x&&(x=_),x!==d&&(b.width=x,c-=x+f*x,h--)}}),d=(c-u)/(h+(h-1)*f),d=Math.max(d,0);var v=0,g;ce(a,function(b,w){b.width||(b.width=d),g=b,v+=b.width*(1+f)}),g&&(v-=g.width*f);var y=-v/2;ce(a,function(b,w){r[i][w]=r[i][w]||{bandWidth:o,offset:y,width:b.width},y+=b.width*(1+f)})}),r}function JPe(e,t,r){if(e&&t){var n=e[A3(t)];return n!=null&&r!=null?n[k3(r)]:n}}function QPe(e,t){var r=Doe(e,t),n=$oe(r);ce(r,function(i){var a=i.getData(),o=i.coordinateSystem,s=o.getBaseAxis(),l=k3(i),u=n[A3(s)][l],f=u.offset,c=u.width;a.setLayout({bandWidth:u.bandWidth,offset:f,size:c})})}function eIe(e){return{seriesType:e,plan:_3(),reset:function(t){if(Noe(t)){var r=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),a=n.getOtherAxis(i),o=r.getDimensionIndex(r.mapDimension(a.dim)),s=r.getDimensionIndex(r.mapDimension(i.dim)),l=t.get("showBackground",!0),u=r.mapDimension(a.dim),f=r.getCalculationInfo("stackResultDimension"),c=ig(r,u)&&!!r.getCalculationInfo("stackedOnSeries"),h=a.isHorizontal(),d=tIe(i,a),v=Loe(t),g=t.get("barMinHeight")||0,y=f&&r.getDimensionIndex(f),b=r.getLayout("size"),w=r.getLayout("offset");return{progress:function(_,x){for(var T=_.count,O=v&&Kl(T*3),E=v&&l&&Kl(T*3),M=v&&Kl(T),P=n.master.getRect(),N=h?P.width:P.height,D,L=x.getStore(),V=0;(D=_.next())!=null;){var ee=L.get(c?y:o,D),ie=L.get(s,D),le=d,_e=void 0;c&&(_e=+ee-L.get(o,D));var U=void 0,C=void 0,R=void 0,I=void 0;if(h){var k=n.dataToPoint([ee,ie]);if(c){var F=n.dataToPoint([_e,ie]);le=F[0]}U=le,C=k[1]+w,R=k[0]-le,I=b,Math.abs(R)<g&&(R=(R<0?-1:1)*g)}else{var k=n.dataToPoint([ie,ee]);if(c){var F=n.dataToPoint([ie,_e]);le=F[1]}U=k[0]+w,C=le,R=b,I=k[1]-le,Math.abs(I)<g&&(I=(I<=0?-1:1)*g)}v?(O[V]=U,O[V+1]=C,O[V+2]=h?R:I,E&&(E[V]=h?P.x:U,E[V+1]=h?C:P.y,E[V+2]=N),M[D]=D):x.setItemLayout(D,{x:U,y:C,width:R,height:I}),V+=3}v&&x.setLayout({largePoints:O,largeDataIndices:M,largeBackgroundPoints:E,valueAxisHorizontal:h})}}}}}}function Noe(e){return e.coordinateSystem&&e.coordinateSystem.type==="cartesian2d"}function Loe(e){return e.pipelineContext&&e.pipelineContext.large}function tIe(e,t){return t.toGlobalCoord(t.dataToCoord(t.type==="log"?1:0))}var rIe=function(e,t,r,n){for(;r<n;){var i=r+n>>>1;e[i][1]<t?r=i+1:n=i}return r},Foe=function(e){st(t,e);function t(r){var n=e.call(this,r)||this;return n.type="time",n}return t.prototype.getLabel=function(r){var n=this.getSetting("useUTC");return dk(r.value,oz[vRe(Ip(this._minLevelUnit))]||oz.second,n,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(r,n,i){var a=this.getSetting("useUTC"),o=this.getSetting("locale");return pRe(r,n,i,o,a)},t.prototype.getTicks=function(){var r=this._interval,n=this._extent,i=[];if(!r)return i;i.push({value:n[0],level:0});var a=this.getSetting("useUTC"),o=uIe(this._minLevelUnit,this._approxInterval,a,n);return i=i.concat(o),i.push({value:n[1],level:0}),i},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1]&&(n[0]-=Po,n[1]+=Po),n[1]===-1/0&&n[0]===1/0){var i=new Date;n[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),n[0]=n[1]-Po}this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval)},t.prototype.calcNiceTicks=function(r,n,i){r=r||10;var a=this._extent,o=a[1]-a[0];this._approxInterval=o/r,n!=null&&this._approxInterval<n&&(this._approxInterval=n),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var s=fx.length,l=Math.min(rIe(fx,this._approxInterval,0,s),s-1);this._interval=fx[l][1],this._minLevelUnit=fx[Math.max(l-1,0)][0]},t.prototype.parse=function(r){return Ur(r)?r:+Au(r)},t.prototype.contain=function(r){return Tk(this.parse(r),this._extent)},t.prototype.normalize=function(r){return Ok(this.parse(r),this._extent)},t.prototype.scale=function(r){return Ek(r,this._extent)},t.type="time",t}(zS),fx=[["second",u3],["minute",f3],["hour",Rb],["quarter-day",Rb*6],["half-day",Rb*12],["day",Po*1.2],["half-week",Po*3.5],["week",Po*7],["month",Po*31],["quarter",Po*95],["half-year",az/2],["year",az]];function nIe(e,t,r,n){var i=Au(t),a=Au(r),o=function(v){return sz(i,v,n)===sz(a,v,n)},s=function(){return o("year")},l=function(){return s()&&o("month")},u=function(){return l()&&o("day")},f=function(){return u()&&o("hour")},c=function(){return f()&&o("minute")},h=function(){return c()&&o("second")},d=function(){return h()&&o("millisecond")};switch(e){case"year":return s();case"month":return l();case"day":return u();case"hour":return f();case"minute":return c();case"second":return h();case"millisecond":return d()}}function iIe(e,t){return e/=Po,e>16?16:e>7.5?7:e>3.5?4:e>1.5?2:1}function aIe(e){var t=30*Po;return e/=t,e>6?6:e>3?3:e>2?2:1}function oIe(e){return e/=Rb,e>12?12:e>6?6:e>3.5?4:e>2?2:1}function gG(e,t){return e/=t?f3:u3,e>30?30:e>20?20:e>15?15:e>10?10:e>5?5:e>2?2:1}function sIe(e){return Qne(e,!0)}function lIe(e,t,r){var n=new Date(e);switch(Ip(t)){case"year":case"month":n[sae(r)](0);case"day":n[lae(r)](1);case"hour":n[uae(r)](0);case"minute":n[fae(r)](0);case"second":n[cae(r)](0),n[hae(r)](0)}return n.getTime()}function uIe(e,t,r,n){var i=1e4,a=aae,o=0;function s(N,D,L,V,ee,ie,le){for(var _e=new Date(D),U=D,C=_e[V]();U<L&&U<=n[1];)le.push({value:U}),C+=N,_e[ee](C),U=_e.getTime();le.push({value:U,notAdd:!0})}function l(N,D,L){var V=[],ee=!D.length;if(!nIe(Ip(N),n[0],n[1],r)){ee&&(D=[{value:lIe(new Date(n[0]),N,r)},{value:n[1]}]);for(var ie=0;ie<D.length-1;ie++){var le=D[ie].value,_e=D[ie+1].value;if(le!==_e){var U=void 0,C=void 0,R=void 0,I=!1;switch(N){case"year":U=Math.max(1,Math.round(t/Po/365)),C=c3(r),R=gRe(r);break;case"half-year":case"quarter":case"month":U=aIe(t),C=Mp(r),R=sae(r);break;case"week":case"half-week":case"day":U=iIe(t),C=vk(r),R=lae(r),I=!0;break;case"half-day":case"quarter-day":case"hour":U=oIe(t),C=pw(r),R=uae(r);break;case"minute":U=gG(t,!0),C=pk(r),R=fae(r);break;case"second":U=gG(t,!1),C=gk(r),R=cae(r);break;case"millisecond":U=sIe(t),C=yk(r),R=hae(r);break}s(U,le,_e,C,R,I,V),N==="year"&&L.length>1&&ie===0&&L.unshift({value:L[0].value-U})}}for(var ie=0;ie<V.length;ie++)L.push(V[ie]);return V}}for(var u=[],f=[],c=0,h=0,d=0;d<a.length&&o++<i;++d){var v=Ip(a[d]);if(dRe(a[d])){l(a[d],u[u.length-1]||[],f);var g=a[d+1]?Ip(a[d+1]):null;if(v!==g){if(f.length){h=c,f.sort(function(N,D){return N.value-D.value});for(var y=[],b=0;b<f.length;++b){var w=f[b].value;(b===0||f[b-1].value!==w)&&(y.push(f[b]),w>=n[0]&&w<=n[1]&&c++)}var _=(n[1]-n[0])/t;if(c>_*1.5&&h>_/1.5||(u.push(y),c>_||e===a[d]))break}f=[]}}}for(var x=Qi(Rt(u,function(N){return Qi(N,function(D){return D.value>=n[0]&&D.value<=n[1]&&!D.notAdd})}),function(N){return N.length>0}),T=[],O=x.length-1,d=0;d<x.length;++d)for(var E=x[d],M=0;M<E.length;++M)T.push({value:E[M].value,level:O-d});T.sort(function(N,D){return N.value-D.value});for(var P=[],d=0;d<T.length;++d)(d===0||T[d].value!==T[d-1].value)&&P.push(T[d]);return P}Bu.registerClass(Foe);const fIe=Foe;var yG=Bu.prototype,Mb=zS.prototype,cIe=jn,hIe=Math.floor,dIe=Math.ceil,cx=Math.pow,es=Math.log,P3=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="log",r.base=10,r._originalScale=new zS,r._interval=0,r}return t.prototype.getTicks=function(r){var n=this._originalScale,i=this._extent,a=n.getExtent(),o=Mb.getTicks.call(this,r);return Rt(o,function(s){var l=s.value,u=jn(cx(this.base,l));return u=l===i[0]&&this._fixMin?hx(u,a[0]):u,u=l===i[1]&&this._fixMax?hx(u,a[1]):u,{value:u}},this)},t.prototype.setExtent=function(r,n){var i=es(this.base);r=es(Math.max(0,r))/i,n=es(Math.max(0,n))/i,Mb.setExtent.call(this,r,n)},t.prototype.getExtent=function(){var r=this.base,n=yG.getExtent.call(this);n[0]=cx(r,n[0]),n[1]=cx(r,n[1]);var i=this._originalScale,a=i.getExtent();return this._fixMin&&(n[0]=hx(n[0],a[0])),this._fixMax&&(n[1]=hx(n[1],a[1])),n},t.prototype.unionExtent=function(r){this._originalScale.unionExtent(r);var n=this.base;r[0]=es(r[0])/es(n),r[1]=es(r[1])/es(n),yG.unionExtent.call(this,r)},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.calcNiceTicks=function(r){r=r||10;var n=this._extent,i=n[1]-n[0];if(!(i===1/0||i<=0)){var a=cTe(i),o=r/i*a;for(o<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var s=[jn(dIe(n[0]/a)*a),jn(hIe(n[1]/a)*a)];this._interval=a,this._niceExtent=s}},t.prototype.calcNiceExtent=function(r){Mb.calcNiceExtent.call(this,r),this._fixMin=r.fixMin,this._fixMax=r.fixMax},t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return r=es(r)/es(this.base),Tk(r,this._extent)},t.prototype.normalize=function(r){return r=es(r)/es(this.base),Ok(r,this._extent)},t.prototype.scale=function(r){return r=Ek(r,this._extent),cx(this.base,r)},t.type="log",t}(Bu),Hoe=P3.prototype;Hoe.getMinorTicks=Mb.getMinorTicks;Hoe.getLabel=Mb.getLabel;function hx(e,t){return cIe(e,Yl(t))}Bu.registerClass(P3);const vIe=P3;var pIe=function(){function e(t,r,n){this._prepareParams(t,r,n)}return e.prototype._prepareParams=function(t,r,n){n[1]<n[0]&&(n=[NaN,NaN]),this._dataMin=n[0],this._dataMax=n[1];var i=this._isOrdinal=t.type==="ordinal";this._needCrossZero=t.type==="interval"&&r.getNeedCrossZero&&r.getNeedCrossZero();var a=this._modelMinRaw=r.get("min",!0);Zt(a)?this._modelMinNum=dx(t,a({min:n[0],max:n[1]})):a!=="dataMin"&&(this._modelMinNum=dx(t,a));var o=this._modelMaxRaw=r.get("max",!0);if(Zt(o)?this._modelMaxNum=dx(t,o({min:n[0],max:n[1]})):o!=="dataMax"&&(this._modelMaxNum=dx(t,o)),i)this._axisDataLen=r.getCategories().length;else{var s=r.get("boundaryGap"),l=dt(s)?s:[s||0,s||0];typeof l[0]=="boolean"||typeof l[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[lc(l[0],1),lc(l[1],1)]}},e.prototype.calculate=function(){var t=this._isOrdinal,r=this._dataMin,n=this._dataMax,i=this._axisDataLen,a=this._boundaryGapInner,o=t?null:n-r||Math.abs(r),s=this._modelMinRaw==="dataMin"?r:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?n:this._modelMaxNum,u=s!=null,f=l!=null;s==null&&(s=t?i?0:NaN:r-a[0]*o),l==null&&(l=t?i?i-1:NaN:n+a[1]*o),(s==null||!isFinite(s))&&(s=NaN),(l==null||!isFinite(l))&&(l=NaN);var c=XO(s)||XO(l)||t&&!i;this._needCrossZero&&(s>0&&l>0&&!u&&(s=0),s<0&&l<0&&!f&&(l=0));var h=this._determinedMin,d=this._determinedMax;return h!=null&&(s=h,u=!0),d!=null&&(l=d,f=!0),{min:s,max:l,minFixed:u,maxFixed:f,isBlank:c}},e.prototype.modifyDataMinMax=function(t,r){this[yIe[t]]=r},e.prototype.setDeterminedMinMax=function(t,r){var n=gIe[t];this[n]=r},e.prototype.freeze=function(){this.frozen=!0},e}(),gIe={min:"_determinedMin",max:"_determinedMax"},yIe={min:"_dataMin",max:"_dataMax"};function mIe(e,t,r){var n=e.rawExtentInfo;return n||(n=new pIe(e,t,r),e.rawExtentInfo=n,n)}function dx(e,t){return t==null?null:XO(t)?NaN:e.parse(t)}function Boe(e,t){var r=e.type,n=mIe(e,t,e.getExtent()).calculate();e.setBlank(n.isBlank);var i=n.min,a=n.max,o=t.ecModel;if(o&&r==="time"){var s=Doe("bar",o),l=!1;if(ce(s,function(c){l=l||c.getBaseAxis()===t.axis}),l){var u=$oe(s),f=bIe(i,a,t,u);i=f.min,a=f.max}}return{extent:[i,a],fixMin:n.minFixed,fixMax:n.maxFixed}}function bIe(e,t,r,n){var i=r.axis.getExtent(),a=i[1]-i[0],o=JPe(n,r.axis);if(o===void 0)return{min:e,max:t};var s=1/0;ce(o,function(d){s=Math.min(d.offset,s)});var l=-1/0;ce(o,function(d){l=Math.max(d.offset+d.width,l)}),s=Math.abs(s),l=Math.abs(l);var u=s+l,f=t-e,c=1-(s+l)/a,h=f/c-f;return t+=h*(l/u),e-=h*(s/u),{min:e,max:t}}function mG(e,t){var r=t,n=Boe(e,r),i=n.extent,a=r.get("splitNumber");e instanceof vIe&&(e.base=r.get("logBase"));var o=e.type,s=r.get("interval"),l=o==="interval"||o==="time";e.setExtent(i[0],i[1]),e.calcNiceExtent({splitNumber:a,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:l?r.get("minInterval"):null,maxInterval:l?r.get("maxInterval"):null}),s!=null&&e.setInterval&&e.setInterval(s)}function wIe(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new Poe({ordinalMeta:e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),extent:[1/0,-1/0]});case"time":return new fIe({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new(Bu.getClass(t)||zS)}}function _Ie(e){var t=e.scale.getExtent(),r=t[0],n=t[1];return!(r>0&&n>0||r<0&&n<0)}function GS(e){var t=e.getLabelModel().get("formatter"),r=e.type==="category"?e.scale.getExtent()[0]:null;return e.scale.type==="time"?function(n){return function(i,a){return e.scale.getFormattedLabel(i,a,n)}}(t):bt(t)?function(n){return function(i){var a=e.scale.getLabel(i),o=n.replace("{value}",a??"");return o}}(t):Zt(t)?function(n){return function(i,a){return r!=null&&(a=i.value-r),n(I3(e,i),a,i.level!=null?{level:i.level}:null)}}(t):function(n){return e.scale.getLabel(n)}}function I3(e,t){return e.type==="category"?e.scale.getLabel(t):t.value}function SIe(e){var t=e.model,r=e.scale;if(!(!t.get(["axisLabel","show"])||r.isBlank())){var n,i,a=r.getExtent();r instanceof Poe?i=r.count():(n=r.getTicks(),i=n.length);var o=e.getLabelModel(),s=GS(e),l,u=1;i>40&&(u=Math.ceil(i/40));for(var f=0;f<i;f+=u){var c=n?n[f]:{value:a[0]+f},h=s(c,f),d=o.getTextRect(h),v=CIe(d,o.get("rotate")||0);l?l.union(v):l=v}return l}}function CIe(e,t){var r=t*Math.PI/180,n=e.width,i=e.height,a=n*Math.abs(Math.cos(r))+Math.abs(i*Math.sin(r)),o=n*Math.abs(Math.sin(r))+Math.abs(i*Math.cos(r)),s=new Pr(e.x,e.y,a,o);return s}function M3(e){var t=e.get("interval");return t??"auto"}function Voe(e){return e.type==="category"&&M3(e.getLabelModel())===0}function xIe(e,t){var r={};return ce(e.mapDimensionsAll(t),function(n){r[FPe(e,n)]=!0}),sn(r)}var TIe=function(){function e(){}return e.prototype.getNeedCrossZero=function(){var t=this.option;return!t.scale},e.prototype.getCoordSysModel=function(){},e}(),bG=[],OIe={registerPreprocessor:moe,registerProcessor:boe,registerPostInit:fPe,registerPostUpdate:cPe,registerUpdateLifecycle:O3,registerAction:wm,registerCoordinateSystem:hPe,registerLayout:dPe,registerVisual:Hd,registerTransform:pPe,registerLoading:woe,registerMap:vPe,registerImpl:UAe,PRIORITY:nPe,ComponentModel:nn,ComponentView:Pu,SeriesModel:cc,ChartView:ll,registerComponentModel:function(e){nn.registerClass(e)},registerComponentView:function(e){Pu.registerClass(e)},registerSeriesModel:function(e){cc.registerClass(e)},registerChartView:function(e){ll.registerClass(e)},registerSubTypeDefaulter:function(e,t){nn.registerSubTypeDefaulter(e,t)},registerPainter:function(e,t){iTe(e,t)}};function hc(e){if(dt(e)){ce(e,function(t){hc(t)});return}Hr(bG,e)>=0||(bG.push(e),Zt(e)&&(e={install:e}),e.install(OIe))}var _w=zn();function EIe(e){return e.type==="category"?kIe(e):PIe(e)}function RIe(e,t){return e.type==="category"?AIe(e,t):{ticks:Rt(e.scale.getTicks(),function(r){return r.value})}}function kIe(e){var t=e.getLabelModel(),r=Woe(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r}function Woe(e,t){var r=joe(e,"labels"),n=M3(t),i=Uoe(r,n);if(i)return i;var a,o;return Zt(n)?a=Yoe(e,n):(o=n==="auto"?IIe(e):n,a=Goe(e,o)),zoe(r,n,{labels:a,labelCategoryInterval:o})}function AIe(e,t){var r=joe(e,"ticks"),n=M3(t),i=Uoe(r,n);if(i)return i;var a,o;if((!t.get("show")||e.scale.isBlank())&&(a=[]),Zt(n))a=Yoe(e,n,!0);else if(n==="auto"){var s=Woe(e,e.getLabelModel());o=s.labelCategoryInterval,a=Rt(s.labels,function(l){return l.tickValue})}else o=n,a=Goe(e,o,!0);return zoe(r,n,{ticks:a,tickCategoryInterval:o})}function PIe(e){var t=e.scale.getTicks(),r=GS(e);return{labels:Rt(t,function(n,i){return{level:n.level,formattedLabel:r(n,i),rawLabel:e.scale.getLabel(n),tickValue:n.value}})}}function joe(e,t){return _w(e)[t]||(_w(e)[t]=[])}function Uoe(e,t){for(var r=0;r<e.length;r++)if(e[r].key===t)return e[r].value}function zoe(e,t,r){return e.push({key:t,value:r}),r}function IIe(e){var t=_w(e).autoInterval;return t??(_w(e).autoInterval=e.calculateCategoryInterval())}function MIe(e){var t=DIe(e),r=GS(e),n=(t.axisRotate-t.labelRotate)/180*Math.PI,i=e.scale,a=i.getExtent(),o=i.count();if(a[1]-a[0]<1)return 0;var s=1;o>40&&(s=Math.max(1,Math.floor(o/40)));for(var l=a[0],u=e.dataToCoord(l+1)-e.dataToCoord(l),f=Math.abs(u*Math.cos(n)),c=Math.abs(u*Math.sin(n)),h=0,d=0;l<=a[1];l+=s){var v=0,g=0,y=WB(r({value:l}),t.font,"center","top");v=y.width*1.3,g=y.height*1.3,h=Math.max(h,v,7),d=Math.max(d,g,7)}var b=h/f,w=d/c;isNaN(b)&&(b=1/0),isNaN(w)&&(w=1/0);var _=Math.max(0,Math.floor(Math.min(b,w))),x=_w(e.model),T=e.getExtent(),O=x.lastAutoInterval,E=x.lastTickCount;return O!=null&&E!=null&&Math.abs(O-_)<=1&&Math.abs(E-o)<=1&&O>_&&x.axisExtent0===T[0]&&x.axisExtent1===T[1]?_=O:(x.lastTickCount=o,x.lastAutoInterval=_,x.axisExtent0=T[0],x.axisExtent1=T[1]),_}function DIe(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function Goe(e,t,r){var n=GS(e),i=e.scale,a=i.getExtent(),o=e.getLabelModel(),s=[],l=Math.max((t||0)+1,1),u=a[0],f=i.count();u!==0&&l>1&&f/l>2&&(u=Math.round(Math.ceil(u/l)*l));var c=Voe(e),h=o.get("showMinLabel")||c,d=o.get("showMaxLabel")||c;h&&u!==a[0]&&g(a[0]);for(var v=u;v<=a[1];v+=l)g(v);d&&v-l!==a[1]&&g(a[1]);function g(y){var b={value:y};s.push(r?y:{formattedLabel:n(b),rawLabel:i.getLabel(b),tickValue:y})}return s}function Yoe(e,t,r){var n=e.scale,i=GS(e),a=[];return ce(n.getTicks(),function(o){var s=n.getLabel(o),l=o.value;t(o.value,s)&&a.push(r?l:{formattedLabel:i(o),rawLabel:s,tickValue:l})}),a}var wG=[0,1],$Ie=function(){function e(t,r,n){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=r,this._extent=n||[0,0]}return e.prototype.contain=function(t){var r=this._extent,n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return t>=n&&t<=i},e.prototype.containData=function(t){return this.scale.contain(t)},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.getPixelPrecision=function(t){return sTe(t||this.scale.getExtent(),this._extent)},e.prototype.setExtent=function(t,r){var n=this._extent;n[0]=t,n[1]=r},e.prototype.dataToCoord=function(t,r){var n=this._extent,i=this.scale;return t=i.normalize(t),this.onBand&&i.type==="ordinal"&&(n=n.slice(),_G(n,i.count())),E$(t,wG,n,r)},e.prototype.coordToData=function(t,r){var n=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(n=n.slice(),_G(n,i.count()));var a=E$(t,n,wG,r);return this.scale.scale(a)},e.prototype.pointToData=function(t,r){},e.prototype.getTicksCoords=function(t){t=t||{};var r=t.tickModel||this.getTickModel(),n=RIe(this,r),i=n.ticks,a=Rt(i,function(s){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(s):s),tickValue:s}},this),o=r.get("alignWithLabel");return NIe(this,a,o,t.clamp),a},e.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var t=this.model.getModel("minorTick"),r=t.get("splitNumber");r>0&&r<100||(r=5);var n=this.scale.getMinorTicks(r),i=Rt(n,function(a){return Rt(a,function(o){return{coord:this.dataToCoord(o),tickValue:o}},this)},this);return i},e.prototype.getViewLabels=function(){return EIe(this).labels},e.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},e.prototype.getTickModel=function(){return this.model.getModel("axisTick")},e.prototype.getBandWidth=function(){var t=this._extent,r=this.scale.getExtent(),n=r[1]-r[0]+(this.onBand?1:0);n===0&&(n=1);var i=Math.abs(t[1]-t[0]);return Math.abs(i)/n},e.prototype.calculateCategoryInterval=function(){return MIe(this)},e}();function _G(e,t){var r=e[1]-e[0],n=t,i=r/n/2;e[0]+=i,e[1]-=i}function NIe(e,t,r,n){var i=t.length;if(!e.onBand||r||!i)return;var a=e.getExtent(),o,s;if(i===1)t[0].coord=a[0],o=t[1]={coord:a[0]};else{var l=t[i-1].tickValue-t[0].tickValue,u=(t[i-1].coord-t[0].coord)/l;ce(t,function(d){d.coord-=u/2});var f=e.scale.getExtent();s=1+f[1]-t[i-1].tickValue,o={coord:t[i-1].coord+u*s},t.push(o)}var c=a[0]>a[1];h(t[0].coord,a[0])&&(n?t[0].coord=a[0]:t.shift()),n&&h(a[0],t[0].coord)&&t.unshift({coord:a[0]}),h(a[1],o.coord)&&(n?o.coord=a[1]:t.pop()),n&&h(o.coord,a[1])&&t.push({coord:a[1]});function h(d,v){return d=jn(d),v=jn(v),c?d>v:d<v}}const LIe=$Ie;uc.CMD;function Koe(e,t,r,n,i,a,o,s){var l=i-e,u=a-t,f=r-e,c=n-t,h=Math.sqrt(f*f+c*c);f/=h,c/=h;var d=l*f+u*c,v=d/h;s&&(v=Math.min(Math.max(v,0),1)),v*=h;var g=o[0]=e+v*f,y=o[1]=t+v*c;return Math.sqrt((g-i)*(g-i)+(y-a)*(y-a))}var Mf=new Nt,Sn=new Nt,di=new Nt,Df=new Nt,rl=new Nt,_E=[],qi=new Nt;function FIe(e,t){if(t<=180&&t>0){t=t/180*Math.PI,Mf.fromArray(e[0]),Sn.fromArray(e[1]),di.fromArray(e[2]),Nt.sub(Df,Mf,Sn),Nt.sub(rl,di,Sn);var r=Df.len(),n=rl.len();if(!(r<.001||n<.001)){Df.scale(1/r),rl.scale(1/n);var i=Df.dot(rl),a=Math.cos(t);if(a<i){var o=Koe(Sn.x,Sn.y,di.x,di.y,Mf.x,Mf.y,_E,!1);qi.fromArray(_E),qi.scaleAndAdd(rl,o/Math.tan(Math.PI-t));var s=di.x!==Sn.x?(qi.x-Sn.x)/(di.x-Sn.x):(qi.y-Sn.y)/(di.y-Sn.y);if(isNaN(s))return;s<0?Nt.copy(qi,Sn):s>1&&Nt.copy(qi,di),qi.toArray(e[1])}}}}function HIe(e,t,r){if(r<=180&&r>0){r=r/180*Math.PI,Mf.fromArray(e[0]),Sn.fromArray(e[1]),di.fromArray(e[2]),Nt.sub(Df,Sn,Mf),Nt.sub(rl,di,Sn);var n=Df.len(),i=rl.len();if(!(n<.001||i<.001)){Df.scale(1/n),rl.scale(1/i);var a=Df.dot(t),o=Math.cos(r);if(a<o){var s=Koe(Sn.x,Sn.y,di.x,di.y,Mf.x,Mf.y,_E,!1);qi.fromArray(_E);var l=Math.PI/2,u=Math.acos(rl.dot(t)),f=l+u-r;if(f>=l)Nt.copy(qi,di);else{qi.scaleAndAdd(rl,s/Math.tan(Math.PI/2-f));var c=di.x!==Sn.x?(qi.x-Sn.x)/(di.x-Sn.x):(qi.y-Sn.y)/(di.y-Sn.y);if(isNaN(c))return;c<0?Nt.copy(qi,Sn):c>1&&Nt.copy(qi,di)}qi.toArray(e[1])}}}}function SG(e,t,r,n){var i=r==="normal",a=i?e:e.ensureState(r);a.ignore=t;var o=n.get("smooth");o&&o===!0&&(o=.3),a.shape=a.shape||{},o>0&&(a.shape.smooth=o);var s=n.getModel("lineStyle").getLineStyle();i?e.useStyle(s):a.style=s}function BIe(e,t){var r=t.smooth,n=t.points;if(n)if(e.moveTo(n[0][0],n[0][1]),r>0&&n.length>=3){var i=c$(n[0],n[1]),a=c$(n[1],n[2]);if(!i||!a){e.lineTo(n[1][0],n[1][1]),e.lineTo(n[2][0],n[2][1]);return}var o=Math.min(i,a)*r,s=tI([],n[1],n[0],o/i),l=tI([],n[1],n[2],o/a),u=tI([],s,l,.5);e.bezierCurveTo(s[0],s[1],s[0],s[1],u[0],u[1]),e.bezierCurveTo(l[0],l[1],l[0],l[1],n[2][0],n[2][1])}else for(var f=1;f<n.length;f++)e.lineTo(n[f][0],n[f][1])}function VIe(e,t,r){var n=e.getTextGuideLine(),i=e.getTextContent();if(!i){n&&e.removeTextGuideLine();return}for(var a=t.normal,o=a.get("show"),s=i.ignore,l=0;l<aE.length;l++){var u=aE[l],f=t[u],c=u==="normal";if(f){var h=f.get("show"),d=c?s:pr(i.states[u]&&i.states[u].ignore,s);if(d||!pr(h,o)){var v=c?n:n&&n.states[u];v&&(v.ignore=!0);continue}n||(n=new lk,e.setTextGuideLine(n),!c&&(s||!o)&&SG(n,!0,"normal",t.normal),e.stateProxy&&(n.stateProxy=e.stateProxy)),SG(n,!1,u,f)}}if(n){Mr(n.style,r),n.style.fill=null;var g=a.get("showAbove"),y=e.textGuideLineConfig=e.textGuideLineConfig||{};y.showAbove=g||!1,n.buildPath=BIe}}function WIe(e,t){t=t||"labelLine";for(var r={normal:e.getModel(t)},n=0;n<Lo.length;n++){var i=Lo[n];r[i]=e.getModel([i,t])}return r}function jIe(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(!n.defaultAttr.ignore){var i=n.label,a=i.getComputedTransform(),o=i.getBoundingRect(),s=!a||a[1]<1e-5&&a[2]<1e-5,l=i.style.margin||0,u=o.clone();u.applyTransform(a),u.x-=l/2,u.y-=l/2,u.width+=l,u.height+=l;var f=s?new uE(o,a):null;t.push({label:i,labelLine:n.labelLine,rect:u,localRect:o,obb:f,priority:n.priority,defaultAttr:n.defaultAttr,layoutOption:n.computedLayoutOption,axisAligned:s,transform:a})}}return t}function UIe(e,t,r,n,i,a){var o=e.length;if(o<2)return;e.sort(function(M,P){return M.rect[t]-P.rect[t]});for(var s=0,l,u=!1,f=0,c=0;c<o;c++){var h=e[c],d=h.rect;l=d[t]-s,l<0&&(d[t]-=l,h.label[t]-=l,u=!0);var v=Math.max(-l,0);f+=v,s=d[t]+d[r]}f>0&&a&&T(-f/o,0,o);var g=e[0],y=e[o-1],b,w;_(),b<0&&O(-b,.8),w<0&&O(w,.8),_(),x(b,w,1),x(w,b,-1),_(),b<0&&E(-b),w<0&&E(w);function _(){b=g.rect[t]-n,w=i-y.rect[t]-y.rect[r]}function x(M,P,N){if(M<0){var D=Math.min(P,-M);if(D>0){T(D*N,0,o);var L=D+M;L<0&&O(-L*N,1)}else O(-M*N,1)}}function T(M,P,N){M!==0&&(u=!0);for(var D=P;D<N;D++){var L=e[D],V=L.rect;V[t]+=M,L.label[t]+=M}}function O(M,P){for(var N=[],D=0,L=1;L<o;L++){var V=e[L-1].rect,ee=Math.max(e[L].rect[t]-V[t]-V[r],0);N.push(ee),D+=ee}if(D){var ie=Math.min(Math.abs(M)/D,P);if(M>0)for(var L=0;L<o-1;L++){var le=N[L]*ie;T(le,0,L+1)}else for(var L=o-1;L>0;L--){var le=N[L-1]*ie;T(-le,L,o)}}}function E(M){var P=M<0?-1:1;M=Math.abs(M);for(var N=Math.ceil(M/(o-1)),D=0;D<o-1;D++)if(P>0?T(N,0,D+1):T(-N,o-D-1,o),M-=N,M<=0)return}return u}function zIe(e,t,r,n){return UIe(e,"y","height",t,r,n)}function GIe(e){var t=[];e.sort(function(g,y){return y.priority-g.priority});var r=new Pr(0,0,0,0);function n(g){if(!g.ignore){var y=g.ensureState("emphasis");y.ignore==null&&(y.ignore=!1)}g.ignore=!0}for(var i=0;i<e.length;i++){var a=e[i],o=a.axisAligned,s=a.localRect,l=a.transform,u=a.label,f=a.labelLine;r.copy(a.rect),r.width-=.1,r.height-=.1,r.x+=.05,r.y+=.05;for(var c=a.obb,h=!1,d=0;d<t.length;d++){var v=t[d];if(r.intersect(v.rect)){if(o&&v.axisAligned){h=!0;break}if(v.obb||(v.obb=new uE(v.localRect,v.transform)),c||(c=new uE(s,l)),c.intersect(v.obb)){h=!0;break}}}h?(n(u),f&&n(f)):(u.attr("ignore",a.defaultAttr.ignore),f&&f.attr("ignore",a.defaultAttr.labelGuideIgnore),t.push(a))}}function CG(e,t,r){var n=gm.createCanvas(),i=t.getWidth(),a=t.getHeight(),o=n.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=i+"px",o.height=a+"px",n.setAttribute("data-zr-dom-id",e)),n.width=i*r,n.height=a*r,n}var YIe=function(e){st(t,e);function t(r,n,i){var a=e.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var o;i=i||tE,typeof r=="string"?o=CG(r,n,i):Tt(r)&&(o=r,r=o.id),a.id=r,a.dom=o;var s=o.style;return s&&(Rne(o),o.onselectstart=function(){return!1},s.padding="0",s.margin="0",s.borderWidth="0"),a.painter=n,a.dpr=i,a}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var r=this.dpr;this.domBack=CG("back-"+this.id,this.painter,r),this.ctxBack=this.domBack.getContext("2d"),r!==1&&this.ctxBack.scale(r,r)},t.prototype.createRepaintRects=function(r,n,i,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var o=[],s=this.maxRepaintRectCount,l=!1,u=new Pr(0,0,0,0);function f(w){if(!(!w.isFinite()||w.isZero()))if(o.length===0){var _=new Pr(0,0,0,0);_.copy(w),o.push(_)}else{for(var x=!1,T=1/0,O=0,E=0;E<o.length;++E){var M=o[E];if(M.intersect(w)){var P=new Pr(0,0,0,0);P.copy(M),P.union(w),o[E]=P,x=!0;break}else if(l){u.copy(w),u.union(M);var N=w.width*w.height,D=M.width*M.height,L=u.width*u.height,V=L-N-D;V<T&&(T=V,O=E)}}if(l&&(o[O].union(w),x=!0),!x){var _=new Pr(0,0,0,0);_.copy(w),o.push(_)}l||(l=o.length>=s)}}for(var c=this.__startIndex;c<this.__endIndex;++c){var h=r[c];if(h){var d=h.shouldBePainted(i,a,!0,!0),v=h.__isRendered&&(h.__dirty&za||!d)?h.getPrevPaintRect():null;v&&f(v);var g=d&&(h.__dirty&za||!h.__isRendered)?h.getPaintRect():null;g&&f(g)}}for(var c=this.__prevStartIndex;c<this.__prevEndIndex;++c){var h=n[c],d=h.shouldBePainted(i,a,!0,!0);if(h&&(!d||!h.__zr)&&h.__isRendered){var v=h.getPrevPaintRect();v&&f(v)}}var y;do{y=!1;for(var c=0;c<o.length;){if(o[c].isZero()){o.splice(c,1);continue}for(var b=c+1;b<o.length;)o[c].intersect(o[b])?(y=!0,o[c].union(o[b]),o.splice(b,1)):b++;c++}}while(y);return this._paintRects=o,o},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(r,n){var i=this.dpr,a=this.dom,o=a.style,s=this.domBack;o&&(o.width=r+"px",o.height=n+"px"),a.width=r*i,a.height=n*i,s&&(s.width=r*i,s.height=n*i,i!==1&&this.ctxBack.scale(i,i))},t.prototype.clear=function(r,n,i){var a=this.dom,o=this.ctx,s=a.width,l=a.height;n=n||this.clearColor;var u=this.motionBlur&&!r,f=this.lastFrameAlpha,c=this.dpr,h=this;u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,s/c,l/c));var d=this.domBack;function v(g,y,b,w){if(o.clearRect(g,y,b,w),n&&n!=="transparent"){var _=void 0;if(QR(n)){var x=n.global||n.__width===b&&n.__height===w;_=x&&n.__canvasGradient||X$(o,n,{x:0,y:0,width:b,height:w}),n.__canvasGradient=_,n.__width=b,n.__height=w}else kCe(n)&&(n.scaleX=n.scaleX||c,n.scaleY=n.scaleY||c,_=q$(o,n,{dirty:function(){h.setUnpainted(),h.__painter.refresh()}}));o.save(),o.fillStyle=_||n,o.fillRect(g,y,b,w),o.restore()}u&&(o.save(),o.globalAlpha=f,o.drawImage(d,g,y,b,w),o.restore())}!i||u?v(0,0,s,l):i.length&&ce(i,function(g){v(g.x*c,g.y*c,g.width*c,g.height*c)})},t}(dl);const sM=YIe;var xG=1e5,ah=314159,vx=.01,KIe=.001;function XIe(e){return e?e.__builtin__?!0:!(typeof e.resize!="function"||typeof e.refresh!="function"):!1}function qIe(e,t){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var ZIe=function(){function e(t,r,n,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=n=Ze({},n||{}),this.dpr=n.devicePixelRatio||tE,this._singleCanvas=a,this.root=t;var o=t.style;o&&(Rne(t),t.innerHTML=""),this.storage=r;var s=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(a){var f=t,c=f.width,h=f.height;n.width!=null&&(c=n.width),n.height!=null&&(h=n.height),this.dpr=n.devicePixelRatio||1,f.width=c*this.dpr,f.height=h*this.dpr,this._width=c,this._height=h;var d=new sM(f,this,this.dpr);d.__builtin__=!0,d.initContext(),l[ah]=d,d.zlevel=ah,s.push(ah),this._domRoot=t}else{this._width=ax(t,0,n),this._height=ax(t,1,n);var u=this._domRoot=qIe(this._width,this._height);t.appendChild(u)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.refresh=function(t){var r=this.storage.getDisplayList(!0),n=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(r,n,t,this._redrawId);for(var a=0;a<i.length;a++){var o=i[a],s=this._layers[o];if(!s.__builtin__&&s.refresh){var l=a===0?this._backgroundColor:null;s.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=r.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(t){var r=t.length,n=this._hoverlayer;if(n&&n.clear(),!!r){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,o=0;o<r;o++){var s=t[o];s.__inHover&&(n||(n=this._hoverlayer=this.getLayer(xG)),a||(a=n.ctx,a.save()),Ph(a,s,i,o===r-1))}a&&a.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(xG)},e.prototype.paintOne=function(t,r){toe(t,r)},e.prototype._paintList=function(t,r,n,i){if(this._redrawId===i){n=n||!1,this._updateLayerStatus(t);var a=this._doPaintList(t,r,n),o=a.finished,s=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),s&&this._paintHoverList(t),o)this.eachLayer(function(u){u.afterBrush&&u.afterBrush()});else{var l=this;g$(function(){l._paintList(t,r,n,i)})}}},e.prototype._compositeManually=function(){var t=this.getLayer(ah).ctx,r=this._domRoot.width,n=this._domRoot.height;t.clearRect(0,0,r,n),this.eachBuiltinLayer(function(i){i.virtual&&t.drawImage(i.dom,0,0,r,n)})},e.prototype._doPaintList=function(t,r,n){for(var i=this,a=[],o=this._opts.useDirtyRect,s=0;s<this._zlevelList.length;s++){var l=this._zlevelList[s],u=this._layers[l];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||n)&&a.push(u)}for(var f=!0,c=!1,h=function(g){var y=a[g],b=y.ctx,w=o&&y.createRepaintRects(t,r,d._width,d._height),_=n?y.__startIndex:y.__drawIndex,x=!n&&y.incremental&&Date.now,T=x&&Date.now(),O=y.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(y.__startIndex===y.__endIndex)y.clear(!1,O,w);else if(_===y.__startIndex){var E=t[_];(!E.incremental||!E.notClear||n)&&y.clear(!1,O,w)}_===-1&&(console.error("For some unknown reason. drawIndex is -1"),_=y.__startIndex);var M,P=function(V){var ee={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(M=_;M<y.__endIndex;M++){var ie=t[M];if(ie.__inHover&&(c=!0),i._doPaintEl(ie,y,o,V,ee,M===y.__endIndex-1),x){var le=Date.now()-T;if(le>15)break}}ee.prevElClipPaths&&b.restore()};if(w)if(w.length===0)M=y.__endIndex;else for(var N=d.dpr,D=0;D<w.length;++D){var L=w[D];b.save(),b.beginPath(),b.rect(L.x*N,L.y*N,L.width*N,L.height*N),b.clip(),P(L),b.restore()}else b.save(),P(),b.restore();y.__drawIndex=M,y.__drawIndex<y.__endIndex&&(f=!1)},d=this,v=0;v<a.length;v++)h(v);return nr.wxa&&ce(this._layers,function(g){g&&g.ctx&&g.ctx.draw&&g.ctx.draw()}),{finished:f,needsRefreshHover:c}},e.prototype._doPaintEl=function(t,r,n,i,a,o){var s=r.ctx;if(n){var l=t.getPaintRect();(!i||l&&l.intersect(i))&&(Ph(s,t,a,o),t.setPrevPaintRect(l))}else Ph(s,t,a,o)},e.prototype.getLayer=function(t,r){this._singleCanvas&&!this._needsManuallyCompositing&&(t=ah);var n=this._layers[t];return n||(n=new sM("zr_"+t,this,this.dpr),n.zlevel=t,n.__builtin__=!0,this._layerConfig[t]?Ar(n,this._layerConfig[t],!0):this._layerConfig[t-vx]&&Ar(n,this._layerConfig[t-vx],!0),r&&(n.virtual=r),this.insertLayer(t,n),n.initContext()),n},e.prototype.insertLayer=function(t,r){var n=this._layers,i=this._zlevelList,a=i.length,o=this._domRoot,s=null,l=-1;if(!n[t]&&XIe(r)){if(a>0&&t>i[0]){for(l=0;l<a-1&&!(i[l]<t&&i[l+1]>t);l++);s=n[i[l]]}if(i.splice(l+1,0,t),n[t]=r,!r.virtual)if(s){var u=s.dom;u.nextSibling?o.insertBefore(r.dom,u.nextSibling):o.appendChild(r.dom)}else o.firstChild?o.insertBefore(r.dom,o.firstChild):o.appendChild(r.dom);r.__painter=this}},e.prototype.eachLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i];t.call(r,this._layers[a],a)}},e.prototype.eachBuiltinLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__&&t.call(r,o,a)}},e.prototype.eachOtherLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__||t.call(r,o,a)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(c,h){c.__dirty=c.__used=!1});function r(c){a&&(a.__endIndex!==c&&(a.__dirty=!0),a.__endIndex=c)}if(this._singleCanvas)for(var n=1;n<t.length;n++){var i=t[n];if(i.zlevel!==t[n-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var a=null,o=0,s,l;for(l=0;l<t.length;l++){var i=t[l],u=i.zlevel,f=void 0;s!==u&&(s=u,o=0),i.incremental?(f=this.getLayer(u+KIe,this._needsManuallyCompositing),f.incremental=!0,o=1):f=this.getLayer(u+(o>0?vx:0),this._needsManuallyCompositing),f.__builtin__||DB("ZLevel "+u+" has been used by unkown layer "+f.id),f!==a&&(f.__used=!0,f.__startIndex!==l&&(f.__dirty=!0),f.__startIndex=l,f.incremental?f.__drawIndex=-1:f.__drawIndex=l,r(l),a=f),i.__dirty&za&&!i.__inHover&&(f.__dirty=!0,f.incremental&&f.__drawIndex<0&&(f.__drawIndex=l))}r(l),this.eachBuiltinLayer(function(c,h){!c.__used&&c.getElementCount()>0&&(c.__dirty=!0,c.__startIndex=c.__endIndex=c.__drawIndex=0),c.__dirty&&c.__drawIndex<0&&(c.__drawIndex=c.__startIndex)})},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(t){t.clear()},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t,ce(this._layers,function(r){r.setUnpainted()})},e.prototype.configLayer=function(t,r){if(r){var n=this._layerConfig;n[t]?Ar(n[t],r,!0):n[t]=r;for(var i=0;i<this._zlevelList.length;i++){var a=this._zlevelList[i];if(a===t||a===t+vx){var o=this._layers[a];Ar(o,n[t],!0)}}}},e.prototype.delLayer=function(t){var r=this._layers,n=this._zlevelList,i=r[t];i&&(i.dom.parentNode.removeChild(i.dom),delete r[t],n.splice(Hr(n,t),1))},e.prototype.resize=function(t,r){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var i=this._opts,a=this.root;if(t!=null&&(i.width=t),r!=null&&(i.height=r),t=ax(a,0,i),r=ax(a,1,i),n.style.display="",this._width!==t||r!==this._height){n.style.width=t+"px",n.style.height=r+"px";for(var o in this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(t,r);this.refresh(!0)}this._width=t,this._height=r}else{if(t==null||r==null)return;this._width=t,this._height=r,this.getLayer(ah).resize(t,r)}return this},e.prototype.clearLayer=function(t){var r=this._layers[t];r&&r.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[ah].dom;var r=new sM("image",this,t.pixelRatio||this.dpr);r.initContext(),r.clear(!1,t.backgroundColor||this._backgroundColor);var n=r.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var i=r.dom.width,a=r.dom.height;this.eachLayer(function(c){c.__builtin__?n.drawImage(c.dom,0,0,i,a):c.renderToCanvas&&(n.save(),c.renderToCanvas(n),n.restore())})}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},s=this.storage.getDisplayList(!0),l=0,u=s.length;l<u;l++){var f=s[l];Ph(n,f,o,l===u-1)}return r.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();const JIe=ZIe;function QIe(e){e.registerPainter("canvas",JIe)}var eMe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r){return R3(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(r){var n=new Pi,i=ng("line",0,r.itemHeight/2,r.itemWidth,0,r.lineStyle.stroke,!1);n.add(i),i.setStyle(r.lineStyle);var a=this.getData().getVisual("symbol"),o=this.getData().getVisual("symbolRotate"),s=a==="none"?"circle":a,l=r.itemHeight*.8,u=ng(s,(r.itemWidth-l)/2,(r.itemHeight-l)/2,l,l,r.itemStyle.fill);n.add(u),u.setStyle(r.itemStyle);var f=r.iconRotate==="inherit"?o:r.iconRotate||0;return u.rotation=f*Math.PI/180,u.setOrigin([r.itemWidth/2,r.itemHeight/2]),s.indexOf("empty")>-1&&(u.style.stroke=u.style.fill,u.style.fill="#fff",u.style.lineWidth=2),n},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(cc);const tMe=eMe;function D3(e,t){var r=e.mapDimensionsAll("defaultedLabel"),n=r.length;if(n===1){var i=rg(e,t,r[0]);return i!=null?i+"":null}else if(n){for(var a=[],o=0;o<r.length;o++)a.push(rg(e,t,r[o]));return a.join(" ")}}function Xoe(e,t){var r=e.mapDimensionsAll("defaultedLabel");if(!dt(t))return t+"";for(var n=[],i=0;i<r.length;i++){var a=e.getDimensionIndex(r[i]);a>=0&&n.push(t[a])}return n.join(" ")}var rMe=function(e){st(t,e);function t(r,n,i,a){var o=e.call(this)||this;return o.updateData(r,n,i,a),o}return t.prototype._createSymbol=function(r,n,i,a,o){this.removeAll();var s=ng(r,-1,-1,2,2,null,o);s.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),s.drift=nMe,this._symbolType=r,this.add(s)},t.prototype.stopSymbolAnimation=function(r){this.childAt(0).stopAnimation(null,r)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){oE(this.childAt(0))},t.prototype.downplay=function(){sE(this.childAt(0))},t.prototype.setZ=function(r,n){var i=this.childAt(0);i.zlevel=r,i.z=n},t.prototype.setDraggable=function(r,n){var i=this.childAt(0);i.draggable=r,i.cursor=!n&&r?"move":i.cursor},t.prototype.updateData=function(r,n,i,a){this.silent=!1;var o=r.getItemVisual(n,"symbol")||"circle",s=r.hostModel,l=t.getSymbolSize(r,n),u=o!==this._symbolType,f=a&&a.disableAnimation;if(u){var c=r.getItemVisual(n,"symbolKeepAspect");this._createSymbol(o,r,n,l,c)}else{var h=this.childAt(0);h.silent=!1;var d={scaleX:l[0]/2,scaleY:l[1]/2};f?h.attr(d):aa(h,d,s,n),r3(h)}if(this._updateCommon(r,n,l,i,a),u){var h=this.childAt(0);if(!f){var d={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:h.style.opacity}};h.scaleX=h.scaleY=0,h.style.opacity=0,No(h,d,s,n)}}f&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(r,n,i,a,o){var s=this.childAt(0),l=r.hostModel,u,f,c,h,d,v,g,y,b;if(a&&(u=a.emphasisItemStyle,f=a.blurItemStyle,c=a.selectItemStyle,h=a.focus,d=a.blurScope,g=a.labelStatesModels,y=a.hoverScale,b=a.cursorStyle,v=a.emphasisDisabled),!a||r.hasItemOption){var w=a&&a.itemModel?a.itemModel:r.getItemModel(n),_=w.getModel("emphasis");u=_.getModel("itemStyle").getItemStyle(),c=w.getModel(["select","itemStyle"]).getItemStyle(),f=w.getModel(["blur","itemStyle"]).getItemStyle(),h=_.get("focus"),d=_.get("blurScope"),v=_.get("disabled"),g=US(w),y=_.getShallow("scale"),b=w.getShallow("cursor")}var x=r.getItemVisual(n,"symbolRotate");s.attr("rotation",(x||0)*Math.PI/180||0);var T=Zae(r.getItemVisual(n,"symbolOffset"),i);T&&(s.x=T[0],s.y=T[1]),b&&s.attr("cursor",b);var O=r.getItemVisual(n,"style"),E=O.fill;if(s instanceof Nd){var M=s.style;s.useStyle(Ze({image:M.image,x:M.x,y:M.y,width:M.width,height:M.height},O))}else s.__isEmptyBrush?s.useStyle(Ze({},O)):s.useStyle(O),s.style.decal=null,s.setColor(E,o&&o.symbolInnerColor),s.style.strokeNoScale=!0;var P=r.getItemVisual(n,"liftZ"),N=this._z2;P!=null?N==null&&(this._z2=s.z2,s.z2+=P):N!=null&&(s.z2=N,this._z2=null);var D=o&&o.useNameLabel;jS(s,g,{labelFetcher:l,labelDataIndex:n,defaultText:L,inheritColor:E,defaultOpacity:O.opacity});function L(ie){return D?r.getName(ie):D3(r,ie)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var V=s.ensureState("emphasis");V.style=u,s.ensureState("select").style=c,s.ensureState("blur").style=f;var ee=y==null||y===!0?Math.max(1.1,3/this._sizeY):isFinite(y)&&y>0?+y:1;V.scaleX=this._sizeX*ee,V.scaleY=this._sizeY*ee,this.setSymbolScale(1),hw(this,h,d,v)},t.prototype.setSymbolScale=function(r){this.scaleX=this.scaleY=r},t.prototype.fadeOut=function(r,n,i){var a=this.childAt(0),o=Dr(this).dataIndex,s=i&&i.animation;if(this.silent=a.silent=!0,i&&i.fadeLabel){var l=a.getTextContent();l&&fE(l,{style:{opacity:0}},n,{dataIndex:o,removeOpt:s,cb:function(){a.removeTextContent()}})}else a.removeTextContent();fE(a,{style:{opacity:0},scaleX:0,scaleY:0},n,{dataIndex:o,cb:r,removeOpt:s})},t.getSymbolSize=function(r,n){return OAe(r.getItemVisual(n,"symbolSize"))},t}(Pi);function nMe(e,t){this.parent.drift(e,t)}const $3=rMe;function lM(e,t,r,n){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(n.isIgnore&&n.isIgnore(r))&&!(n.clipShape&&!n.clipShape.contain(t[0],t[1]))&&e.getItemVisual(r,"symbol")!=="none"}function TG(e){return e!=null&&!Tt(e)&&(e={isIgnore:e}),e||{}}function OG(e){var t=e.hostModel,r=t.getModel("emphasis");return{emphasisItemStyle:r.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:r.get("focus"),blurScope:r.get("blurScope"),emphasisDisabled:r.get("disabled"),hoverScale:r.get("scale"),labelStatesModels:US(t),cursorStyle:t.get("cursor")}}var iMe=function(){function e(t){this.group=new Pi,this._SymbolCtor=t||$3}return e.prototype.updateData=function(t,r){this._progressiveEls=null,r=TG(r);var n=this.group,i=t.hostModel,a=this._data,o=this._SymbolCtor,s=r.disableAnimation,l=OG(t),u={disableAnimation:s},f=r.getSymbolPoint||function(c){return t.getItemLayout(c)};a||n.removeAll(),t.diff(a).add(function(c){var h=f(c);if(lM(t,h,c,r)){var d=new o(t,c,l,u);d.setPosition(h),t.setItemGraphicEl(c,d),n.add(d)}}).update(function(c,h){var d=a.getItemGraphicEl(h),v=f(c);if(!lM(t,v,c,r)){n.remove(d);return}var g=t.getItemVisual(c,"symbol")||"circle",y=d&&d.getSymbolType&&d.getSymbolType();if(!d||y&&y!==g)n.remove(d),d=new o(t,c,l,u),d.setPosition(v);else{d.updateData(t,c,l,u);var b={x:v[0],y:v[1]};s?d.attr(b):aa(d,b,i)}n.add(d),t.setItemGraphicEl(c,d)}).remove(function(c){var h=a.getItemGraphicEl(c);h&&h.fadeOut(function(){n.remove(h)},i)}).execute(),this._getSymbolPoint=f,this._data=t},e.prototype.updateLayout=function(){var t=this,r=this._data;r&&r.eachItemGraphicEl(function(n,i){var a=t._getSymbolPoint(i);n.setPosition(a),n.markRedraw()})},e.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=OG(t),this._data=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(t,r,n){this._progressiveEls=[],n=TG(n);function i(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var a=t.start;a<t.end;a++){var o=r.getItemLayout(a);if(lM(r,o,a,n)){var s=new this._SymbolCtor(r,a,this._seriesScope);s.traverse(i),s.setPosition(o),this.group.add(s),r.setItemGraphicEl(a,s),this._progressiveEls.push(s)}}},e.prototype.eachRendered=function(t){uk(this._progressiveEls||this.group,t)},e.prototype.remove=function(t){var r=this.group,n=this._data;n&&t?n.eachItemGraphicEl(function(i){i.fadeOut(function(){r.remove(i)},n.hostModel)}):r.removeAll()},e}();const aMe=iMe;function qoe(e,t,r){var n=e.getBaseAxis(),i=e.getOtherAxis(n),a=oMe(i,r),o=n.dim,s=i.dim,l=t.mapDimension(s),u=t.mapDimension(o),f=s==="x"||s==="radius"?1:0,c=Rt(e.dimensions,function(v){return t.mapDimension(v)}),h=!1,d=t.getCalculationInfo("stackResultDimension");return ig(t,c[0])&&(h=!0,c[0]=d),ig(t,c[1])&&(h=!0,c[1]=d),{dataDimsForPoint:c,valueStart:a,valueAxisDim:s,baseAxisDim:o,stacked:!!h,valueDim:l,baseDim:u,baseDataOffset:f,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function oMe(e,t){var r=0,n=e.scale.getExtent();return t==="start"?r=n[0]:t==="end"?r=n[1]:Ur(t)&&!isNaN(t)?r=t:n[0]>0?r=n[0]:n[1]<0&&(r=n[1]),r}function Zoe(e,t,r,n){var i=NaN;e.stacked&&(i=r.get(r.getCalculationInfo("stackedOverDimension"),n)),isNaN(i)&&(i=e.valueStart);var a=e.baseDataOffset,o=[];return o[a]=r.get(e.baseDim,n),o[1-a]=i,t.dataToPoint(o)}function sMe(e,t){var r=[];return t.diff(e).add(function(n){r.push({cmd:"+",idx:n})}).update(function(n,i){r.push({cmd:"=",idx:i,idx1:n})}).remove(function(n){r.push({cmd:"-",idx:n})}).execute(),r}function lMe(e,t,r,n,i,a,o,s){for(var l=sMe(e,t),u=[],f=[],c=[],h=[],d=[],v=[],g=[],y=qoe(i,t,o),b=e.getLayout("points")||[],w=t.getLayout("points")||[],_=0;_<l.length;_++){var x=l[_],T=!0,O=void 0,E=void 0;switch(x.cmd){case"=":O=x.idx*2,E=x.idx1*2;var M=b[O],P=b[O+1],N=w[E],D=w[E+1];(isNaN(M)||isNaN(P))&&(M=N,P=D),u.push(M,P),f.push(N,D),c.push(r[O],r[O+1]),h.push(n[E],n[E+1]),g.push(t.getRawIndex(x.idx1));break;case"+":var L=x.idx,V=y.dataDimsForPoint,ee=i.dataToPoint([t.get(V[0],L),t.get(V[1],L)]);E=L*2,u.push(ee[0],ee[1]),f.push(w[E],w[E+1]);var ie=Zoe(y,i,t,L);c.push(ie[0],ie[1]),h.push(n[E],n[E+1]),g.push(t.getRawIndex(L));break;case"-":T=!1}T&&(d.push(x),v.push(v.length))}v.sort(function(W,Q){return g[W]-g[Q]});for(var le=u.length,_e=Kl(le),U=Kl(le),C=Kl(le),R=Kl(le),I=[],_=0;_<v.length;_++){var k=v[_],F=_*2,H=k*2;_e[F]=u[H],_e[F+1]=u[H+1],U[F]=f[H],U[F+1]=f[H+1],C[F]=c[H],C[F+1]=c[H+1],R[F]=h[H],R[F+1]=h[H+1],I[_]=d[k]}return{current:_e,next:U,stackedOnCurrent:C,stackedOnNext:R,status:I}}var cf=Math.min,hf=Math.max;function ld(e,t){return isNaN(e)||isNaN(t)}function nN(e,t,r,n,i,a,o,s,l){for(var u,f,c,h,d,v,g=r,y=0;y<n;y++){var b=t[g*2],w=t[g*2+1];if(g>=i||g<0)break;if(ld(b,w)){if(l){g+=a;continue}break}if(g===r)e[a>0?"moveTo":"lineTo"](b,w),c=b,h=w;else{var _=b-u,x=w-f;if(_*_+x*x<.5){g+=a;continue}if(o>0){for(var T=g+a,O=t[T*2],E=t[T*2+1];O===b&&E===w&&y<n;)y++,T+=a,g+=a,O=t[T*2],E=t[T*2+1],b=t[g*2],w=t[g*2+1],_=b-u,x=w-f;var M=y+1;if(l)for(;ld(O,E)&&M<n;)M++,T+=a,O=t[T*2],E=t[T*2+1];var P=.5,N=0,D=0,L=void 0,V=void 0;if(M>=n||ld(O,E))d=b,v=w;else{N=O-u,D=E-f;var ee=b-u,ie=O-b,le=w-f,_e=E-w,U=void 0,C=void 0;if(s==="x"){U=Math.abs(ee),C=Math.abs(ie);var R=N>0?1:-1;d=b-R*U*o,v=w,L=b+R*C*o,V=w}else if(s==="y"){U=Math.abs(le),C=Math.abs(_e);var I=D>0?1:-1;d=b,v=w-I*U*o,L=b,V=w+I*C*o}else U=Math.sqrt(ee*ee+le*le),C=Math.sqrt(ie*ie+_e*_e),P=C/(C+U),d=b-N*o*(1-P),v=w-D*o*(1-P),L=b+N*o*P,V=w+D*o*P,L=cf(L,hf(O,b)),V=cf(V,hf(E,w)),L=hf(L,cf(O,b)),V=hf(V,cf(E,w)),N=L-b,D=V-w,d=b-N*U/C,v=w-D*U/C,d=cf(d,hf(u,b)),v=cf(v,hf(f,w)),d=hf(d,cf(u,b)),v=hf(v,cf(f,w)),N=b-d,D=w-v,L=b+N*C/U,V=w+D*C/U}e.bezierCurveTo(c,h,d,v,b,w),c=L,h=V}else e.lineTo(b,w)}u=b,f=w,g+=a}return y}var Joe=function(){function e(){this.smooth=0,this.smoothConstraint=!0}return e}(),uMe=function(e){st(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polyline",n}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Joe},t.prototype.buildPath=function(r,n){var i=n.points,a=0,o=i.length/2;if(n.connectNulls){for(;o>0&&ld(i[o*2-2],i[o*2-1]);o--);for(;a<o&&ld(i[a*2],i[a*2+1]);a++);}for(;a<o;)a+=nN(r,i,a,o,o,1,n.smooth,n.smoothMonotone,n.connectNulls)+1},t.prototype.getPointOn=function(r,n){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,a=i.data,o=uc.CMD,s,l,u=n==="x",f=[],c=0;c<a.length;){var h=a[c++],d=void 0,v=void 0,g=void 0,y=void 0,b=void 0,w=void 0,_=void 0;switch(h){case o.M:s=a[c++],l=a[c++];break;case o.L:if(d=a[c++],v=a[c++],_=u?(r-s)/(d-s):(r-l)/(v-l),_<=1&&_>=0){var x=u?(v-l)*_+l:(d-s)*_+s;return u?[r,x]:[x,r]}s=d,l=v;break;case o.C:d=a[c++],v=a[c++],g=a[c++],y=a[c++],b=a[c++],w=a[c++];var T=u?ZO(s,d,g,b,r,f):ZO(l,v,y,w,r,f);if(T>0)for(var O=0;O<T;O++){var E=f[O];if(E<=1&&E>=0){var x=u?qn(l,v,y,w,E):qn(s,d,g,b,E);return u?[r,x]:[x,r]}}s=b,l=w;break}}},t}(Nr),fMe=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Joe),cMe=function(e){st(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polygon",n}return t.prototype.getDefaultShape=function(){return new fMe},t.prototype.buildPath=function(r,n){var i=n.points,a=n.stackedOnPoints,o=0,s=i.length/2,l=n.smoothMonotone;if(n.connectNulls){for(;s>0&&ld(i[s*2-2],i[s*2-1]);s--);for(;o<s&&ld(i[o*2],i[o*2+1]);o++);}for(;o<s;){var u=nN(r,i,o,s,s,1,n.smooth,l,n.connectNulls);nN(r,a,o+u-1,u,s,-1,n.stackedOnSmooth,l,n.connectNulls),o+=u+1,r.closePath()}},t}(Nr);function Qoe(e,t,r,n,i){var a=e.getArea(),o=a.x,s=a.y,l=a.width,u=a.height,f=r.get(["lineStyle","width"])||2;o-=f/2,s-=f/2,l+=f,u+=f,o=Math.floor(o),l=Math.round(l);var c=new Qn({shape:{x:o,y:s,width:l,height:u}});if(t){var h=e.getBaseAxis(),d=h.isHorizontal(),v=h.inverse;d?(v&&(c.shape.x+=l),c.shape.width=0):(v||(c.shape.y+=u),c.shape.height=0);var g=Zt(i)?function(y){i(y,c)}:null;No(c,{shape:{width:l,height:u,x:o,y:s}},r,null,n,g)}return c}function ese(e,t,r){var n=e.getArea(),i=jn(n.r0,1),a=jn(n.r,1),o=new Ld({shape:{cx:jn(e.cx,1),cy:jn(e.cy,1),r0:i,r:a,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});if(t){var s=e.getBaseAxis().dim==="angle";s?o.shape.endAngle=n.startAngle:o.shape.r=i,No(o,{shape:{endAngle:n.endAngle,r:a}},r)}return o}function hMe(e,t,r,n,i){if(e){if(e.type==="polar")return ese(e,t,r);if(e.type==="cartesian2d")return Qoe(e,t,r,n,i)}else return null;return null}function N3(e,t){return e.type===t}function EG(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return;return!0}}function RG(e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,a=0;a<e.length;){var o=e[a++],s=e[a++];isNaN(o)||(t=Math.min(o,t),n=Math.max(o,n)),isNaN(s)||(r=Math.min(s,r),i=Math.max(s,i))}return[[t,r],[n,i]]}function kG(e,t){var r=RG(e),n=r[0],i=r[1],a=RG(t),o=a[0],s=a[1];return Math.max(Math.abs(n[0]-o[0]),Math.abs(n[1]-o[1]),Math.abs(i[0]-s[0]),Math.abs(i[1]-s[1]))}function AG(e){return Ur(e)?e:e?.5:0}function dMe(e,t,r){if(!r.valueDim)return[];for(var n=t.count(),i=Kl(n*2),a=0;a<n;a++){var o=Zoe(r,e,t,a);i[a*2]=o[0],i[a*2+1]=o[1]}return i}function df(e,t,r,n){var i=t.getBaseAxis(),a=i.dim==="x"||i.dim==="radius"?0:1,o=[],s=0,l=[],u=[],f=[],c=[];if(n){for(s=0;s<e.length;s+=2)!isNaN(e[s])&&!isNaN(e[s+1])&&c.push(e[s],e[s+1]);e=c}for(s=0;s<e.length-2;s+=2)switch(f[0]=e[s+2],f[1]=e[s+3],u[0]=e[s],u[1]=e[s+1],o.push(u[0],u[1]),r){case"end":l[a]=f[a],l[1-a]=u[1-a],o.push(l[0],l[1]);break;case"middle":var h=(u[a]+f[a])/2,d=[];l[a]=d[a]=h,l[1-a]=u[1-a],d[1-a]=f[1-a],o.push(l[0],l[1]),o.push(d[0],d[1]);break;default:l[a]=u[a],l[1-a]=f[1-a],o.push(l[0],l[1])}return o.push(e[s++],e[s++]),o}function vMe(e,t){var r=[],n=e.length,i,a;function o(f,c,h){var d=f.coord,v=(h-d)/(c.coord-d),g=Rxe(v,[f.color,c.color]);return{coord:h,color:g}}for(var s=0;s<n;s++){var l=e[s],u=l.coord;if(u<0)i=l;else if(u>t){a?r.push(o(a,l,t)):i&&r.push(o(i,l,0),o(i,l,t));break}else i&&(r.push(o(i,l,0)),i=null),r.push(l),a=l}return r}function pMe(e,t,r){var n=e.getVisual("visualMeta");if(!(!n||!n.length||!e.count())&&t.type==="cartesian2d"){for(var i,a,o=n.length-1;o>=0;o--){var s=e.getDimensionInfo(n[o].dimension);if(i=s&&s.coordDim,i==="x"||i==="y"){a=n[o];break}}if(a){var l=t.getAxis(i),u=Rt(a.stops,function(_){return{coord:l.toGlobalCoord(l.dataToCoord(_.value)),color:_.color}}),f=u.length,c=a.outerColors.slice();f&&u[0].coord>u[f-1].coord&&(u.reverse(),c.reverse());var h=vMe(u,i==="x"?r.getWidth():r.getHeight()),d=h.length;if(!d&&f)return u[0].coord<0?c[1]?c[1]:u[f-1].color:c[0]?c[0]:u[0].color;var v=10,g=h[0].coord-v,y=h[d-1].coord+v,b=y-g;if(b<.001)return"transparent";ce(h,function(_){_.offset=(_.coord-g)/b}),h.push({offset:d?h[d-1].offset:.5,color:c[1]||"transparent"}),h.unshift({offset:d?h[0].offset:.5,color:c[0]||"transparent"});var w=new Kie(0,0,0,0,h,!0);return w[i]=g,w[i+"2"]=y,w}}}function gMe(e,t,r){var n=e.get("showAllSymbol"),i=n==="auto";if(!(n&&!i)){var a=r.getAxesByScale("ordinal")[0];if(a&&!(i&&yMe(a,t))){var o=t.mapDimension(a.dim),s={};return ce(a.getViewLabels(),function(l){var u=a.scale.getRawOrdinalNumber(l.tickValue);s[u]=1}),function(l){return!s.hasOwnProperty(t.get(o,l))}}}}function yMe(e,t){var r=e.getExtent(),n=Math.abs(r[1]-r[0])/e.scale.count();isNaN(n)&&(n=0);for(var i=t.count(),a=Math.max(1,Math.round(i/5)),o=0;o<i;o+=a)if($3.getSymbolSize(t,o)[e.isHorizontal()?1:0]*1.5>n)return!1;return!0}function mMe(e,t){return isNaN(e)||isNaN(t)}function bMe(e){for(var t=e.length/2;t>0&&mMe(e[t*2-2],e[t*2-1]);t--);return t-1}function PG(e,t){return[e[t*2],e[t*2+1]]}function wMe(e,t,r){for(var n=e.length/2,i=r==="x"?0:1,a,o,s=0,l=-1,u=0;u<n;u++)if(o=e[u*2+i],!(isNaN(o)||isNaN(e[u*2+1-i]))){if(u===0){a=o;continue}if(a<=t&&o>=t||a>=t&&o<=t){l=u;break}s=u,a=o}return{range:[s,l],t:(t-a)/(o-a)}}function tse(e){if(e.get(["endLabel","show"]))return!0;for(var t=0;t<Lo.length;t++)if(e.get([Lo[t],"endLabel","show"]))return!0;return!1}function uM(e,t,r,n){if(N3(t,"cartesian2d")){var i=n.getModel("endLabel"),a=i.get("valueAnimation"),o=n.getData(),s={lastFrameIndex:0},l=tse(n)?function(d,v){e._endLabelOnDuring(d,v,o,s,a,i,t)}:null,u=t.getBaseAxis().isHorizontal(),f=Qoe(t,r,n,function(){var d=e._endLabel;d&&r&&s.originalX!=null&&d.attr({x:s.originalX,y:s.originalY})},l);if(!n.get("clip",!0)){var c=f.shape,h=Math.max(c.width,c.height);u?(c.y-=h,c.height+=h*2):(c.x-=h,c.width+=h*2)}return l&&l(1,f),f}else return ese(t,r,n)}function _Me(e,t){var r=t.getBaseAxis(),n=r.isHorizontal(),i=r.inverse,a=n?i?"right":"left":"center",o=n?"middle":i?"top":"bottom";return{normal:{align:e.get("align")||a,verticalAlign:e.get("verticalAlign")||o}}}var SMe=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(){var r=new Pi,n=new aMe;this.group.add(n.group),this._symbolDraw=n,this._lineGroup=r},t.prototype.render=function(r,n,i){var a=this,o=r.coordinateSystem,s=this.group,l=r.getData(),u=r.getModel("lineStyle"),f=r.getModel("areaStyle"),c=l.getLayout("points")||[],h=o.type==="polar",d=this._coordSys,v=this._symbolDraw,g=this._polyline,y=this._polygon,b=this._lineGroup,w=!n.ssr&&r.isAnimationEnabled(),_=!f.isEmpty(),x=f.get("origin"),T=qoe(o,l,x),O=_&&dMe(o,l,T),E=r.get("showSymbol"),M=r.get("connectNulls"),P=E&&!h&&gMe(r,l,o),N=this._data;N&&N.eachItemGraphicEl(function(Q,se){Q.__temp&&(s.remove(Q),N.setItemGraphicEl(se,null))}),E||v.remove(),s.add(b);var D=h?!1:r.get("step"),L;o&&o.getArea&&r.get("clip",!0)&&(L=o.getArea(),L.width!=null?(L.x-=.1,L.y-=.1,L.width+=.2,L.height+=.2):L.r0&&(L.r0-=.5,L.r+=.5)),this._clipShapeForSymbol=L;var V=pMe(l,o,i)||l.getVisual("style")[l.getVisual("drawType")];if(!(g&&d.type===o.type&&D===this._step))E&&v.updateData(l,{isIgnore:P,clipShape:L,disableAnimation:!0,getSymbolPoint:function(Q){return[c[Q*2],c[Q*2+1]]}}),w&&this._initSymbolLabelAnimation(l,o,L),D&&(c=df(c,o,D,M),O&&(O=df(O,o,D,M))),g=this._newPolyline(c),_?y=this._newPolygon(c,O):y&&(b.remove(y),y=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,md(V)),b.setClipPath(uM(this,o,!0,r));else{_&&!y?y=this._newPolygon(c,O):y&&!_&&(b.remove(y),y=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,md(V));var ee=b.getClipPath();if(ee){var ie=uM(this,o,!1,r);No(ee,{shape:ie.shape},r)}else b.setClipPath(uM(this,o,!0,r));E&&v.updateData(l,{isIgnore:P,clipShape:L,disableAnimation:!0,getSymbolPoint:function(Q){return[c[Q*2],c[Q*2+1]]}}),(!EG(this._stackedOnPoints,O)||!EG(this._points,c))&&(w?this._doUpdateAnimation(l,O,o,i,D,x,M):(D&&(c=df(c,o,D,M),O&&(O=df(O,o,D,M))),g.setShape({points:c}),y&&y.setShape({points:c,stackedOnPoints:O})))}var le=r.getModel("emphasis"),_e=le.get("focus"),U=le.get("blurScope"),C=le.get("disabled");if(g.useStyle(Mr(u.getLineStyle(),{fill:"none",stroke:V,lineJoin:"bevel"})),lE(g,r,"lineStyle"),g.style.lineWidth>0&&r.get(["emphasis","lineStyle","width"])==="bolder"){var R=g.getState("emphasis").style;R.lineWidth=+g.style.lineWidth+1}Dr(g).seriesIndex=r.seriesIndex,hw(g,_e,U,C);var I=AG(r.get("smooth")),k=r.get("smoothMonotone");if(g.setShape({smooth:I,smoothMonotone:k,connectNulls:M}),y){var F=l.getCalculationInfo("stackedOnSeries"),H=0;y.useStyle(Mr(f.getAreaStyle(),{fill:V,opacity:.7,lineJoin:"bevel",decal:l.getVisual("style").decal})),F&&(H=AG(F.get("smooth"))),y.setShape({smooth:I,stackedOnSmooth:H,smoothMonotone:k,connectNulls:M}),lE(y,r,"areaStyle"),Dr(y).seriesIndex=r.seriesIndex,hw(y,_e,U,C)}var W=function(Q){a._changePolyState(Q)};l.eachItemGraphicEl(function(Q){Q&&(Q.onHoverStateChange=W)}),this._polyline.onHoverStateChange=W,this._data=l,this._coordSys=o,this._stackedOnPoints=O,this._points=c,this._step=D,this._valueOrigin=x,r.get("triggerLineEvent")&&(this.packEventData(r,g),y&&this.packEventData(r,y))},t.prototype.packEventData=function(r,n){Dr(n).eventData={componentType:"series",componentSubType:"line",componentIndex:r.componentIndex,seriesIndex:r.seriesIndex,seriesName:r.name,seriesType:"line"}},t.prototype.highlight=function(r,n,i,a){var o=r.getData(),s=gd(o,a);if(this._changePolyState("emphasis"),!(s instanceof Array)&&s!=null&&s>=0){var l=o.getLayout("points"),u=o.getItemGraphicEl(s);if(!u){var f=l[s*2],c=l[s*2+1];if(isNaN(f)||isNaN(c)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(f,c))return;var h=r.get("zlevel")||0,d=r.get("z")||0;u=new $3(o,s),u.x=f,u.y=c,u.setZ(h,d);var v=u.getSymbolPath().getTextContent();v&&(v.zlevel=h,v.z=d,v.z2=this._polyline.z2+1),u.__temp=!0,o.setItemGraphicEl(s,u),u.stopSymbolAnimation(!0),this.group.add(u)}u.highlight()}else ll.prototype.highlight.call(this,r,n,i,a)},t.prototype.downplay=function(r,n,i,a){var o=r.getData(),s=gd(o,a);if(this._changePolyState("normal"),s!=null&&s>=0){var l=o.getItemGraphicEl(s);l&&(l.__temp?(o.setItemGraphicEl(s,null),this.group.remove(l)):l.downplay())}else ll.prototype.downplay.call(this,r,n,i,a)},t.prototype._changePolyState=function(r){var n=this._polygon;F6(this._polyline,r),n&&F6(n,r)},t.prototype._newPolyline=function(r){var n=this._polyline;return n&&this._lineGroup.remove(n),n=new uMe({shape:{points:r},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(n),this._polyline=n,n},t.prototype._newPolygon=function(r,n){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new cMe({shape:{points:r,stackedOnPoints:n},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},t.prototype._initSymbolLabelAnimation=function(r,n,i){var a,o,s=n.getBaseAxis(),l=s.inverse;n.type==="cartesian2d"?(a=s.isHorizontal(),o=!1):n.type==="polar"&&(a=s.dim==="angle",o=!0);var u=r.hostModel,f=u.get("animationDuration");Zt(f)&&(f=f(null));var c=u.get("animationDelay")||0,h=Zt(c)?c(null):c;r.eachItemGraphicEl(function(d,v){var g=d;if(g){var y=[d.x,d.y],b=void 0,w=void 0,_=void 0;if(i)if(o){var x=i,T=n.pointToCoord(y);a?(b=x.startAngle,w=x.endAngle,_=-T[1]/180*Math.PI):(b=x.r0,w=x.r,_=T[0])}else{var O=i;a?(b=O.x,w=O.x+O.width,_=d.x):(b=O.y+O.height,w=O.y,_=d.y)}var E=w===b?0:(_-b)/(w-b);l&&(E=1-E);var M=Zt(c)?c(v):f*E+h,P=g.getSymbolPath(),N=P.getTextContent();g.attr({scaleX:0,scaleY:0}),g.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:M}),N&&N.animateFrom({style:{opacity:0}},{duration:300,delay:M}),P.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(r,n,i){var a=r.getModel("endLabel");if(tse(r)){var o=r.getData(),s=this._polyline,l=o.getLayout("points");if(!l){s.removeTextContent(),this._endLabel=null;return}var u=this._endLabel;u||(u=this._endLabel=new Ii({z2:200}),u.ignoreClip=!0,s.setTextContent(this._endLabel),s.disableLabelAnimation=!0);var f=bMe(l);f>=0&&(jS(s,US(r,"endLabel"),{inheritColor:i,labelFetcher:r,labelDataIndex:f,defaultText:function(c,h,d){return d!=null?Xoe(o,d):D3(o,c)},enableTextSetter:!0},_Me(a,n)),s.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(r,n,i,a,o,s,l){var u=this._endLabel,f=this._polyline;if(u){r<1&&a.originalX==null&&(a.originalX=u.x,a.originalY=u.y);var c=i.getLayout("points"),h=i.hostModel,d=h.get("connectNulls"),v=s.get("precision"),g=s.get("distance")||0,y=l.getBaseAxis(),b=y.isHorizontal(),w=y.inverse,_=n.shape,x=w?b?_.x:_.y+_.height:b?_.x+_.width:_.y,T=(b?g:0)*(w?-1:1),O=(b?0:-g)*(w?-1:1),E=b?"x":"y",M=wMe(c,x,E),P=M.range,N=P[1]-P[0],D=void 0;if(N>=1){if(N>1&&!d){var L=PG(c,P[0]);u.attr({x:L[0]+T,y:L[1]+O}),o&&(D=h.getRawValue(P[0]))}else{var L=f.getPointOn(x,E);L&&u.attr({x:L[0]+T,y:L[1]+O});var V=h.getRawValue(P[0]),ee=h.getRawValue(P[1]);o&&(D=ETe(i,v,V,ee,M.t))}a.lastFrameIndex=P[0]}else{var ie=r===1||a.lastFrameIndex>0?P[0]:0,L=PG(c,ie);o&&(D=h.getRawValue(ie)),u.attr({x:L[0]+T,y:L[1]+O})}o&&ck(u).setLabelText(D)}},t.prototype._doUpdateAnimation=function(r,n,i,a,o,s,l){var u=this._polyline,f=this._polygon,c=r.hostModel,h=lMe(this._data,r,this._stackedOnPoints,n,this._coordSys,i,this._valueOrigin),d=h.current,v=h.stackedOnCurrent,g=h.next,y=h.stackedOnNext;if(o&&(d=df(h.current,i,o,l),v=df(h.stackedOnCurrent,i,o,l),g=df(h.next,i,o,l),y=df(h.stackedOnNext,i,o,l)),kG(d,g)>3e3||f&&kG(v,y)>3e3){u.stopAnimation(),u.setShape({points:g}),f&&(f.stopAnimation(),f.setShape({points:g,stackedOnPoints:y}));return}u.shape.__points=h.current,u.shape.points=d;var b={shape:{points:g}};h.current!==d&&(b.shape.__points=h.next),u.stopAnimation(),aa(u,b,c),f&&(f.setShape({points:d,stackedOnPoints:v}),f.stopAnimation(),aa(f,{shape:{stackedOnPoints:y}},c),u.shape.points!==f.shape.points&&(f.shape.points=u.shape.points));for(var w=[],_=h.status,x=0;x<_.length;x++){var T=_[x].cmd;if(T==="="){var O=r.getItemGraphicEl(_[x].idx1);O&&w.push({el:O,ptIdx:x})}}u.animators&&u.animators.length&&u.animators[0].during(function(){f&&f.dirtyShape();for(var E=u.shape.__points,M=0;M<w.length;M++){var P=w[M].el,N=w[M].ptIdx*2;P.x=E[N],P.y=E[N+1],P.markRedraw()}})},t.prototype.remove=function(r){var n=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(a,o){a.__temp&&(n.remove(a),i.setItemGraphicEl(o,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(ll);const CMe=SMe;function xMe(e,t){return{seriesType:e,plan:_3(),reset:function(r){var n=r.getData(),i=r.coordinateSystem,a=r.pipelineContext,o=t||a.large;if(i){var s=Rt(i.dimensions,function(d){return n.mapDimension(d)}).slice(0,2),l=s.length,u=n.getCalculationInfo("stackResultDimension");ig(n,s[0])&&(s[0]=u),ig(n,s[1])&&(s[1]=u);var f=n.getStore(),c=n.getDimensionIndex(s[0]),h=n.getDimensionIndex(s[1]);return l&&{progress:function(d,v){for(var g=d.end-d.start,y=o&&Kl(g*l),b=[],w=[],_=d.start,x=0;_<d.end;_++){var T=void 0;if(l===1){var O=f.get(c,_);T=i.dataToPoint(O,null,w)}else b[0]=f.get(c,_),b[1]=f.get(h,_),T=i.dataToPoint(b,null,w);o?(y[x++]=T[0],y[x++]=T[1]):v.setItemLayout(_,T.slice())}o&&v.setLayout("points",y)}}}}}}var TMe={average:function(e){for(var t=0,r=0,n=0;n<e.length;n++)isNaN(e[n])||(t+=e[n],r++);return r===0?NaN:t/r},sum:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r]||0;return t},max:function(e){for(var t=-1/0,r=0;r<e.length;r++)e[r]>t&&(t=e[r]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,r=0;r<e.length;r++)e[r]<t&&(t=e[r]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},OMe=function(e){return Math.round(e.length/2)};function rse(e){return{seriesType:e,reset:function(t,r,n){var i=t.getData(),a=t.get("sampling"),o=t.coordinateSystem,s=i.count();if(s>10&&o.type==="cartesian2d"&&a){var l=o.getBaseAxis(),u=o.getOtherAxis(l),f=l.getExtent(),c=n.getDevicePixelRatio(),h=Math.abs(f[1]-f[0])*(c||1),d=Math.round(s/h);if(isFinite(d)&&d>1){a==="lttb"&&t.setData(i.lttbDownSample(i.mapDimension(u.dim),1/d));var v=void 0;bt(a)?v=TMe[a]:Zt(a)&&(v=a),v&&t.setData(i.downSample(i.mapDimension(u.dim),1/d,v,OMe))}}}}}function EMe(e){e.registerChartView(CMe),e.registerSeriesModel(tMe),e.registerLayout(xMe("line",!0)),e.registerVisual({seriesType:"line",reset:function(t){var r=t.getData(),n=t.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=r.getVisual("style").fill),r.setVisual("legendLineStyle",n)}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,rse("line"))}var nse=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){return R3(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(r,n,i){var a=this.coordinateSystem;if(a&&a.clampData){var o=a.clampData(r),s=a.dataToPoint(o);if(i)ce(a.getAxes(),function(h,d){if(h.type==="category"&&n!=null){var v=h.getTicksCoords(),g=o[d],y=n[d]==="x1"||n[d]==="y1";if(y&&(g+=1),v.length<2)return;if(v.length===2){s[d]=h.toGlobalCoord(h.getExtent()[y?1:0]);return}for(var b=void 0,w=void 0,_=1,x=0;x<v.length;x++){var T=v[x].coord,O=x===v.length-1?v[x-1].tickValue+_:v[x].tickValue;if(O===g){w=T;break}else if(O<g)b=T;else if(b!=null&&O>g){w=(T+b)/2;break}x===1&&(_=O-v[0].tickValue)}w==null&&(b?b&&(w=v[v.length-1].coord):w=v[0].coord),s[d]=h.toGlobalCoord(w)}});else{var l=this.getData(),u=l.getLayout("offset"),f=l.getLayout("size"),c=a.getBaseAxis().isHorizontal()?0:1;s[c]+=u+f/2}return s}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(cc);cc.registerClass(nse);const IG=nse;var RMe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(){return R3(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},t.prototype.getProgressiveThreshold=function(){var r=this.get("progressiveThreshold"),n=this.get("largeThreshold");return n>r&&(r=n),r},t.prototype.brushSelector=function(r,n,i){return i.rect(n.getItemLayout(r))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=rae(IG.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(IG);const kMe=RMe;var AMe=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),PMe=function(e){st(t,e);function t(r){var n=e.call(this,r)||this;return n.type="sausage",n}return t.prototype.getDefaultShape=function(){return new AMe},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r0||0,0),s=Math.max(n.r,0),l=(s-o)*.5,u=o+l,f=n.startAngle,c=n.endAngle,h=n.clockwise,d=Math.PI*2,v=h?c-f<d:f-c<d;v||(f=c-(h?d:-d));var g=Math.cos(f),y=Math.sin(f),b=Math.cos(c),w=Math.sin(c);v?(r.moveTo(g*o+i,y*o+a),r.arc(g*u+i,y*u+a,l,-Math.PI+f,f,!h)):r.moveTo(g*s+i,y*s+a),r.arc(i,a,s,f,c,!h),r.arc(b*u+i,w*u+a,l,c-Math.PI*2,c-Math.PI,!h),o!==0&&r.arc(i,a,o,c,f,h)},t}(Nr);const MG=PMe;function IMe(e,t){t=t||{};var r=t.isRoundCap;return function(n,i,a){var o=i.position;if(!o||o instanceof Array)return rE(n,i,a);var s=e(o),l=i.distance!=null?i.distance:5,u=this.shape,f=u.cx,c=u.cy,h=u.r,d=u.r0,v=(h+d)/2,g=u.startAngle,y=u.endAngle,b=(g+y)/2,w=r?Math.abs(h-d)/2:0,_=Math.cos,x=Math.sin,T=f+h*_(g),O=c+h*x(g),E="left",M="top";switch(s){case"startArc":T=f+(d-l)*_(b),O=c+(d-l)*x(b),E="center",M="top";break;case"insideStartArc":T=f+(d+l)*_(b),O=c+(d+l)*x(b),E="center",M="bottom";break;case"startAngle":T=f+v*_(g)+px(g,l+w,!1),O=c+v*x(g)+gx(g,l+w,!1),E="right",M="middle";break;case"insideStartAngle":T=f+v*_(g)+px(g,-l+w,!1),O=c+v*x(g)+gx(g,-l+w,!1),E="left",M="middle";break;case"middle":T=f+v*_(b),O=c+v*x(b),E="center",M="middle";break;case"endArc":T=f+(h+l)*_(b),O=c+(h+l)*x(b),E="center",M="bottom";break;case"insideEndArc":T=f+(h-l)*_(b),O=c+(h-l)*x(b),E="center",M="top";break;case"endAngle":T=f+v*_(y)+px(y,l+w,!0),O=c+v*x(y)+gx(y,l+w,!0),E="left",M="middle";break;case"insideEndAngle":T=f+v*_(y)+px(y,-l+w,!0),O=c+v*x(y)+gx(y,-l+w,!0),E="right",M="middle";break;default:return rE(n,i,a)}return n=n||{},n.x=T,n.y=O,n.align=E,n.verticalAlign=M,n}}function MMe(e,t,r,n){if(Ur(n)){e.setTextConfig({rotation:n});return}else if(dt(t)){e.setTextConfig({rotation:0});return}var i=e.shape,a=i.clockwise?i.startAngle:i.endAngle,o=i.clockwise?i.endAngle:i.startAngle,s=(a+o)/2,l,u=r(t);switch(u){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=s;break;case"startAngle":case"insideStartAngle":l=a;break;case"endAngle":case"insideEndAngle":l=o;break;default:e.setTextConfig({rotation:0});return}var f=Math.PI*1.5-l;u==="middle"&&f>Math.PI/2&&f<Math.PI*1.5&&(f-=Math.PI),e.setTextConfig({rotation:f})}function px(e,t,r){return t*Math.sin(e)*(r?-1:1)}function gx(e,t,r){return t*Math.cos(e)*(r?1:-1)}function lb(e,t,r){var n=e.get("borderRadius");if(n==null)return r?{cornerRadius:0}:null;dt(n)||(n=[n,n,n,n]);var i=Math.abs(t.r||0-t.r0||0);return{cornerRadius:Rt(n,function(a){return lc(a,i)})}}var fM=Math.max,cM=Math.min;function DMe(e,t){var r=e.getArea&&e.getArea();if(N3(e,"cartesian2d")){var n=e.getBaseAxis();if(n.type!=="category"||!n.onBand){var i=t.getLayout("bandWidth");n.isHorizontal()?(r.x-=i,r.width+=i*2):(r.y-=i,r.height+=i*2)}}return r}var $Me=function(e){st(t,e);function t(){var r=e.call(this)||this;return r.type=t.type,r._isFirstFrame=!0,r}return t.prototype.render=function(r,n,i,a){this._model=r,this._removeOnRenderedListener(i),this._updateDrawMode(r);var o=r.get("coordinateSystem");(o==="cartesian2d"||o==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(r,n,i):this._renderNormal(r,n,i,a))},t.prototype.incrementalPrepareRender=function(r){this._clear(),this._updateDrawMode(r),this._updateLargeClip(r)},t.prototype.incrementalRender=function(r,n){this._progressiveEls=[],this._incrementalRenderLarge(r,n)},t.prototype.eachRendered=function(r){uk(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},t.prototype._renderNormal=function(r,n,i,a){var o=this.group,s=r.getData(),l=this._data,u=r.coordinateSystem,f=u.getBaseAxis(),c;u.type==="cartesian2d"?c=f.isHorizontal():u.type==="polar"&&(c=f.dim==="angle");var h=r.isAnimationEnabled()?r:null,d=NMe(r,u);d&&this._enableRealtimeSort(d,s,i);var v=r.get("clip",!0)||d,g=DMe(u,s);o.removeClipPath();var y=r.get("roundCap",!0),b=r.get("showBackground",!0),w=r.getModel("backgroundStyle"),_=w.get("borderRadius")||0,x=[],T=this._backgroundEls,O=a&&a.isInitSort,E=a&&a.type==="changeAxisOrder";function M(D){var L=yx[u.type](s,D),V=jMe(u,c,L);return V.useStyle(w.getItemStyle()),u.type==="cartesian2d"?V.setShape("r",_):V.setShape("cornerRadius",_),x[D]=V,V}s.diff(l).add(function(D){var L=s.getItemModel(D),V=yx[u.type](s,D,L);if(b&&M(D),!(!s.hasValue(D)||!FG[u.type](V))){var ee=!1;v&&(ee=DG[u.type](g,V));var ie=$G[u.type](r,s,D,V,c,h,f.model,!1,y);d&&(ie.forceLabelAnimation=!0),HG(ie,s,D,L,V,r,c,u.type==="polar"),O?ie.attr({shape:V}):d?NG(d,h,ie,V,D,c,!1,!1):No(ie,{shape:V},r,D),s.setItemGraphicEl(D,ie),o.add(ie),ie.ignore=ee}}).update(function(D,L){var V=s.getItemModel(D),ee=yx[u.type](s,D,V);if(b){var ie=void 0;T.length===0?ie=M(L):(ie=T[L],ie.useStyle(w.getItemStyle()),u.type==="cartesian2d"?ie.setShape("r",_):ie.setShape("cornerRadius",_),x[D]=ie);var le=yx[u.type](s,D),_e=ase(c,le,u);aa(ie,{shape:_e},h,D)}var U=l.getItemGraphicEl(L);if(!s.hasValue(D)||!FG[u.type](ee)){o.remove(U);return}var C=!1;if(v&&(C=DG[u.type](g,ee),C&&o.remove(U)),U?r3(U):U=$G[u.type](r,s,D,ee,c,h,f.model,!!U,y),d&&(U.forceLabelAnimation=!0),E){var R=U.getTextContent();if(R){var I=ck(R);I.prevValue!=null&&(I.prevValue=I.value)}}else HG(U,s,D,V,ee,r,c,u.type==="polar");O?U.attr({shape:ee}):d?NG(d,h,U,ee,D,c,!0,E):aa(U,{shape:ee},r,D,null),s.setItemGraphicEl(D,U),U.ignore=C,o.add(U)}).remove(function(D){var L=l.getItemGraphicEl(D);L&&cE(L,r,D)}).execute();var P=this._backgroundGroup||(this._backgroundGroup=new Pi);P.removeAll();for(var N=0;N<x.length;++N)P.add(x[N]);o.add(P),this._backgroundEls=x,this._data=s},t.prototype._renderLarge=function(r,n,i){this._clear(),VG(r,this.group),this._updateLargeClip(r)},t.prototype._incrementalRenderLarge=function(r,n){this._removeBackground(),VG(n,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(r){var n=r.get("clip",!0)&&hMe(r.coordinateSystem,!1,r),i=this.group;n?i.setClipPath(n):i.removeClipPath()},t.prototype._enableRealtimeSort=function(r,n,i){var a=this;if(n.count()){var o=r.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(n,r,i),this._isFirstFrame=!1;else{var s=function(l){var u=n.getItemGraphicEl(l),f=u&&u.shape;return f&&Math.abs(o.isHorizontal()?f.height:f.width)||0};this._onRendered=function(){a._updateSortWithinSameData(n,s,o,i)},i.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(r,n,i){var a=[];return r.each(r.mapDimension(n.dim),function(o,s){var l=i(s);l=l??NaN,a.push({dataIndex:s,mappedValue:l,ordinalNumber:o})}),a.sort(function(o,s){return s.mappedValue-o.mappedValue}),{ordinalNumbers:Rt(a,function(o){return o.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(r,n,i){for(var a=i.scale,o=r.mapDimension(i.dim),s=Number.MAX_VALUE,l=0,u=a.getOrdinalMeta().categories.length;l<u;++l){var f=r.rawIndexOf(o,a.getRawOrdinalNumber(l)),c=f<0?Number.MIN_VALUE:n(r.indexOfRawIndex(f));if(c>s)return!0;s=c}return!1},t.prototype._isOrderDifferentInView=function(r,n){for(var i=n.scale,a=i.getExtent(),o=Math.max(0,a[0]),s=Math.min(a[1],i.getOrdinalMeta().categories.length-1);o<=s;++o)if(r.ordinalNumbers[o]!==i.getRawOrdinalNumber(o))return!0},t.prototype._updateSortWithinSameData=function(r,n,i,a){if(this._isOrderChangedWithinSameData(r,n,i)){var o=this._dataSort(r,i,n);this._isOrderDifferentInView(o,i)&&(this._removeOnRenderedListener(a),a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:o}))}},t.prototype._dispatchInitSort=function(r,n,i){var a=n.baseAxis,o=this._dataSort(r,a,function(s){return r.get(r.mapDimension(n.otherAxis.dim),s)});i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",isInitSort:!0,axisId:a.index,sortInfo:o})},t.prototype.remove=function(r,n){this._clear(this._model),this._removeOnRenderedListener(n)},t.prototype.dispose=function(r,n){this._removeOnRenderedListener(n)},t.prototype._removeOnRenderedListener=function(r){this._onRendered&&(r.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(r){var n=this.group,i=this._data;r&&r.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(a){cE(a,r,Dr(a).dataIndex)})):n.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(ll),DG={cartesian2d:function(e,t){var r=t.width<0?-1:1,n=t.height<0?-1:1;r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height);var i=e.x+e.width,a=e.y+e.height,o=fM(t.x,e.x),s=cM(t.x+t.width,i),l=fM(t.y,e.y),u=cM(t.y+t.height,a),f=s<o,c=u<l;return t.x=f&&o>i?s:o,t.y=c&&l>a?u:l,t.width=f?0:s-o,t.height=c?0:u-l,r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height),f||c},polar:function(e,t){var r=t.r0<=t.r?1:-1;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}var i=cM(t.r,e.r),a=fM(t.r0,e.r0);t.r=i,t.r0=a;var o=i-a<0;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}return o}},$G={cartesian2d:function(e,t,r,n,i,a,o,s,l){var u=new Qn({shape:Ze({},n),z2:1});if(u.__dataIndex=r,u.name="item",a){var f=u.shape,c=i?"height":"width";f[c]=0}return u},polar:function(e,t,r,n,i,a,o,s,l){var u=!i&&l?MG:Ld,f=new u({shape:n,z2:1});f.name="item";var c=ise(i);if(f.calculateTextPosition=IMe(c,{isRoundCap:u===MG}),a){var h=f.shape,d=i?"r":"endAngle",v={};h[d]=i?n.r0:n.startAngle,v[d]=n[d],(s?aa:No)(f,{shape:v},a)}return f}};function NMe(e,t){var r=e.get("realtimeSort",!0),n=t.getBaseAxis();if(r&&n.type==="category"&&t.type==="cartesian2d")return{baseAxis:n,otherAxis:t.getOtherAxis(n)}}function NG(e,t,r,n,i,a,o,s){var l,u;a?(u={x:n.x,width:n.width},l={y:n.y,height:n.height}):(u={y:n.y,height:n.height},l={x:n.x,width:n.width}),s||(o?aa:No)(r,{shape:l},t,i,null);var f=t?e.baseAxis.model:null;(o?aa:No)(r,{shape:u},f,i)}function LG(e,t){for(var r=0;r<t.length;r++)if(!isFinite(e[t[r]]))return!0;return!1}var LMe=["x","y","width","height"],FMe=["cx","cy","r","startAngle","endAngle"],FG={cartesian2d:function(e){return!LG(e,LMe)},polar:function(e){return!LG(e,FMe)}},yx={cartesian2d:function(e,t,r){var n=e.getItemLayout(t),i=r?BMe(r,n):0,a=n.width>0?1:-1,o=n.height>0?1:-1;return{x:n.x+a*i/2,y:n.y+o*i/2,width:n.width-a*i,height:n.height-o*i}},polar:function(e,t,r){var n=e.getItemLayout(t);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function HMe(e){return e.startAngle!=null&&e.endAngle!=null&&e.startAngle===e.endAngle}function ise(e){return function(t){var r=t?"Arc":"Angle";return function(n){switch(n){case"start":case"insideStart":case"end":case"insideEnd":return n+r;default:return n}}}(e)}function HG(e,t,r,n,i,a,o,s){var l=t.getItemVisual(r,"style");if(s){if(!a.get("roundCap")){var f=e.shape,c=lb(n.getModel("itemStyle"),f,!0);Ze(f,c),e.setShape(f)}}else{var u=n.get(["itemStyle","borderRadius"])||0;e.setShape("r",u)}e.useStyle(l);var h=n.getShallow("cursor");h&&e.attr("cursor",h);var d=s?o?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":o?i.height>=0?"bottom":"top":i.width>=0?"right":"left",v=US(n);jS(e,v,{labelFetcher:a,labelDataIndex:r,defaultText:D3(a.getData(),r),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var g=e.getTextContent();if(s&&g){var y=n.get(["label","position"]);e.textConfig.inside=y==="middle"?!0:null,MMe(e,y==="outside"?d:y,ise(o),n.get(["label","rotate"]))}ZEe(g,v,a.getRawValue(r),function(w){return Xoe(t,w)});var b=n.getModel(["emphasis"]);hw(e,b.get("focus"),b.get("blurScope"),b.get("disabled")),lE(e,n),HMe(i)&&(e.style.fill="none",e.style.stroke="none",ce(e.states,function(w){w.style&&(w.style.fill=w.style.stroke="none")}))}function BMe(e,t){var r=e.get(["itemStyle","borderColor"]);if(!r||r==="none")return 0;var n=e.get(["itemStyle","borderWidth"])||0,i=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),a=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(n,i,a)}var VMe=function(){function e(){}return e}(),BG=function(e){st(t,e);function t(r){var n=e.call(this,r)||this;return n.type="largeBar",n}return t.prototype.getDefaultShape=function(){return new VMe},t.prototype.buildPath=function(r,n){for(var i=n.points,a=this.baseDimIdx,o=1-this.baseDimIdx,s=[],l=[],u=this.barWidth,f=0;f<i.length;f+=3)l[a]=u,l[o]=i[f+2],s[a]=i[f+a],s[o]=i[f+o],r.rect(s[0],s[1],l[0],l[1])},t}(Nr);function VG(e,t,r,n){var i=e.getData(),a=i.getLayout("valueAxisHorizontal")?1:0,o=i.getLayout("largeDataIndices"),s=i.getLayout("size"),l=e.getModel("backgroundStyle"),u=i.getLayout("largeBackgroundPoints");if(u){var f=new BG({shape:{points:u},incremental:!!n,silent:!0,z2:0});f.baseDimIdx=a,f.largeDataIndices=o,f.barWidth=s,f.useStyle(l.getItemStyle()),t.add(f),r&&r.push(f)}var c=new BG({shape:{points:i.getLayout("largePoints")},incremental:!!n,ignoreCoarsePointer:!0,z2:1});c.baseDimIdx=a,c.largeDataIndices=o,c.barWidth=s,t.add(c),c.useStyle(i.getVisual("style")),Dr(c).seriesIndex=e.seriesIndex,e.get("silent")||(c.on("mousedown",WG),c.on("mousemove",WG)),r&&r.push(c)}var WG=Ck(function(e){var t=this,r=WMe(t,e.offsetX,e.offsetY);Dr(t).dataIndex=r>=0?r:null},30,!1);function WMe(e,t,r){for(var n=e.baseDimIdx,i=1-n,a=e.shape.points,o=e.largeDataIndices,s=[],l=[],u=e.barWidth,f=0,c=a.length/3;f<c;f++){var h=f*3;if(l[n]=u,l[i]=a[h+2],s[n]=a[h+n],s[i]=a[h+i],l[i]<0&&(s[i]+=l[i],l[i]=-l[i]),t>=s[0]&&t<=s[0]+l[0]&&r>=s[1]&&r<=s[1]+l[1])return o[f]}return-1}function ase(e,t,r){if(N3(r,"cartesian2d")){var n=t,i=r.getArea();return{x:e?n.x:i.x,y:e?i.y:n.y,width:e?n.width:i.width,height:e?i.height:n.height}}else{var i=r.getArea(),a=t;return{cx:i.cx,cy:i.cy,r0:e?i.r0:a.r0,r:e?i.r:a.r,startAngle:e?a.startAngle:0,endAngle:e?a.endAngle:Math.PI*2}}}function jMe(e,t,r){var n=e.type==="polar"?Ld:Qn;return new n({shape:ase(t,r,e),silent:!0,z2:0})}const UMe=$Me;function zMe(e){e.registerChartView(UMe),e.registerSeriesModel(kMe),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,Mn(QPe,"bar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,eIe("bar")),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,rse("bar")),e.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,r){var n=t.componentType||"series";r.eachComponent({mainType:n,query:t},function(i){t.sortInfo&&i.axis.setCategorySortInfo(t.sortInfo)})})}var mx=Math.PI*2,jG=Math.PI/180;function ose(e,t){return eg(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function sse(e,t){var r=ose(e,t),n=e.get("center"),i=e.get("radius");dt(i)||(i=[0,i]);var a=on(r.width,t.getWidth()),o=on(r.height,t.getHeight()),s=Math.min(a,o),l=on(i[0],s/2),u=on(i[1],s/2),f,c,h=e.coordinateSystem;if(h){var d=h.dataToPoint(n);f=d[0]||0,c=d[1]||0}else dt(n)||(n=[n,n]),f=on(n[0],a)+r.x,c=on(n[1],o)+r.y;return{cx:f,cy:c,r0:l,r:u}}function GMe(e,t,r){t.eachSeriesByType(e,function(n){var i=n.getData(),a=i.mapDimension("value"),o=ose(n,r),s=sse(n,r),l=s.cx,u=s.cy,f=s.r,c=s.r0,h=-n.get("startAngle")*jG,d=n.get("minAngle")*jG,v=0;i.each(a,function(N){!isNaN(N)&&v++});var g=i.getSum(a),y=Math.PI/(g||v)*2,b=n.get("clockwise"),w=n.get("roseType"),_=n.get("stillShowZeroSum"),x=i.getDataExtent(a);x[0]=0;var T=mx,O=0,E=h,M=b?1:-1;if(i.setLayout({viewRect:o,r:f}),i.each(a,function(N,D){var L;if(isNaN(N)){i.setItemLayout(D,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:b,cx:l,cy:u,r0:c,r:w?NaN:f});return}w!=="area"?L=g===0&&_?y:N*y:L=mx/v,L<d?(L=d,T-=d):O+=N;var V=E+M*L;i.setItemLayout(D,{angle:L,startAngle:E,endAngle:V,clockwise:b,cx:l,cy:u,r0:c,r:w?E$(N,x,[c,f]):f}),E=V}),T<mx&&v)if(T<=.001){var P=mx/v;i.each(a,function(N,D){if(!isNaN(N)){var L=i.getItemLayout(D);L.angle=P,L.startAngle=h+M*D*P,L.endAngle=h+M*(D+1)*P}})}else y=T/O,E=h,i.each(a,function(N,D){if(!isNaN(N)){var L=i.getItemLayout(D),V=L.angle===d?d:N*y;L.startAngle=E,L.endAngle=E+M*V,E+=M*V}})})}function YMe(e){return{seriesType:e,reset:function(t,r){var n=r.findComponents({mainType:"legend"});if(!(!n||!n.length)){var i=t.getData();i.filterSelf(function(a){for(var o=i.getName(a),s=0;s<n.length;s++)if(!n[s].isSelected(o))return!1;return!0})}}}}var KMe=Math.PI/180;function UG(e,t,r,n,i,a,o,s,l,u){if(e.length<2)return;function f(g){for(var y=g.rB,b=y*y,w=0;w<g.list.length;w++){var _=g.list[w],x=Math.abs(_.label.y-r),T=n+_.len,O=T*T,E=Math.sqrt((1-Math.abs(x*x/b))*O),M=t+(E+_.len2)*i,P=M-_.label.x,N=_.targetTextWidth-P*i;lse(_,N,!0),_.label.x=M}}function c(g){for(var y={list:[],maxY:0},b={list:[],maxY:0},w=0;w<g.length;w++)if(g[w].labelAlignTo==="none"){var _=g[w],x=_.label.y>r?b:y,T=Math.abs(_.label.y-r);if(T>=x.maxY){var O=_.label.x-t-_.len2*i,E=n+_.len,M=Math.abs(O)<E?Math.sqrt(T*T/(1-O*O/E/E)):E;x.rB=M,x.maxY=T}x.list.push(_)}f(y),f(b)}for(var h=e.length,d=0;d<h;d++)if(e[d].position==="outer"&&e[d].labelAlignTo==="labelLine"){var v=e[d].label.x-u;e[d].linePoints[1][0]+=v,e[d].label.x=u}zIe(e,l,l+o)&&c(e)}function XMe(e,t,r,n,i,a,o,s){for(var l=[],u=[],f=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<e.length;h++){var d=e[h].label;hM(e[h])||(d.x<t?(f=Math.min(f,d.x),l.push(e[h])):(c=Math.max(c,d.x),u.push(e[h])))}for(var h=0;h<e.length;h++){var v=e[h];if(!hM(v)&&v.linePoints){if(v.labelStyleWidth!=null)continue;var d=v.label,g=v.linePoints,y=void 0;v.labelAlignTo==="edge"?d.x<t?y=g[2][0]-v.labelDistance-o-v.edgeDistance:y=o+i-v.edgeDistance-g[2][0]-v.labelDistance:v.labelAlignTo==="labelLine"?d.x<t?y=f-o-v.bleedMargin:y=o+i-c-v.bleedMargin:d.x<t?y=d.x-o-v.bleedMargin:y=o+i-d.x-v.bleedMargin,v.targetTextWidth=y,lse(v,y)}}UG(u,t,r,n,1,i,a,o,s,c),UG(l,t,r,n,-1,i,a,o,s,f);for(var h=0;h<e.length;h++){var v=e[h];if(!hM(v)&&v.linePoints){var d=v.label,g=v.linePoints,b=v.labelAlignTo==="edge",w=d.style.padding,_=w?w[1]+w[3]:0,x=d.style.backgroundColor?0:_,T=v.rect.width+x,O=g[1][0]-g[2][0];b?d.x<t?g[2][0]=o+v.edgeDistance+T+v.labelDistance:g[2][0]=o+i-v.edgeDistance-T-v.labelDistance:(d.x<t?g[2][0]=d.x+v.labelDistance:g[2][0]=d.x-v.labelDistance,g[1][0]=g[2][0]+O),g[1][1]=g[2][1]=d.y}}}function lse(e,t,r){if(r===void 0&&(r=!1),e.labelStyleWidth==null){var n=e.label,i=n.style,a=e.rect,o=i.backgroundColor,s=i.padding,l=s?s[1]+s[3]:0,u=i.overflow,f=a.width+(o?0:l);if(t<f||r){var c=a.height;if(u&&u.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",t-l);var h=n.getBoundingRect();n.setStyle("width",Math.ceil(h.width)),n.setStyle("backgroundColor",o)}else{var d=t-l,v=t<f?d:r?d>e.unconstrainedWidth?null:d:null;n.setStyle("width",v)}var g=n.getBoundingRect();a.width=g.width;var y=(n.style.margin||0)+2.1;a.height=g.height+y,a.y-=(a.height-c)/2}}}function hM(e){return e.position==="center"}function qMe(e){var t=e.getData(),r=[],n,i,a=!1,o=(e.get("minShowLabelAngle")||0)*KMe,s=t.getLayout("viewRect"),l=t.getLayout("r"),u=s.width,f=s.x,c=s.y,h=s.height;function d(O){O.ignore=!0}function v(O){if(!O.ignore)return!0;for(var E in O.states)if(O.states[E].ignore===!1)return!0;return!1}t.each(function(O){var E=t.getItemGraphicEl(O),M=E.shape,P=E.getTextContent(),N=E.getTextGuideLine(),D=t.getItemModel(O),L=D.getModel("label"),V=L.get("position")||D.get(["emphasis","label","position"]),ee=L.get("distanceToLabelLine"),ie=L.get("alignTo"),le=on(L.get("edgeDistance"),u),_e=L.get("bleedMargin"),U=D.getModel("labelLine"),C=U.get("length");C=on(C,u);var R=U.get("length2");if(R=on(R,u),Math.abs(M.endAngle-M.startAngle)<o){ce(P.states,d),P.ignore=!0,N&&(ce(N.states,d),N.ignore=!0);return}if(v(P)){var I=(M.startAngle+M.endAngle)/2,k=Math.cos(I),F=Math.sin(I),H,W,Q,se;n=M.cx,i=M.cy;var we=V==="inside"||V==="inner";if(V==="center")H=M.cx,W=M.cy,se="center";else{var pe=(we?(M.r+M.r0)/2*k:M.r*k)+n,me=(we?(M.r+M.r0)/2*F:M.r*F)+i;if(H=pe+k*3,W=me+F*3,!we){var Ie=pe+k*(C+l-M.r),z=me+F*(C+l-M.r),Le=Ie+(k<0?-1:1)*R,ye=z;ie==="edge"?H=k<0?f+le:f+u-le:H=Le+(k<0?-ee:ee),W=ye,Q=[[pe,me],[Ie,z],[Le,ye]]}se=we?"center":ie==="edge"?k>0?"right":"left":k>0?"left":"right"}var Xe=Math.PI,Ge=0,De=L.get("rotate");if(Ur(De))Ge=De*(Xe/180);else if(V==="center")Ge=0;else if(De==="radial"||De===!0){var tt=k<0?-I+Xe:-I;Ge=tt}else if(De==="tangential"&&V!=="outside"&&V!=="outer"){var Qe=Math.atan2(k,F);Qe<0&&(Qe=Xe*2+Qe);var G=F>0;G&&(Qe=Xe+Qe),Ge=Qe-Xe}if(a=!!Ge,P.x=H,P.y=W,P.rotation=Ge,P.setStyle({verticalAlign:"middle"}),we){P.setStyle({align:se});var Se=P.states.select;Se&&(Se.x+=P.x,Se.y+=P.y)}else{var Z=P.getBoundingRect().clone();Z.applyTransform(P.getComputedTransform());var ae=(P.style.margin||0)+2.1;Z.y-=ae/2,Z.height+=ae,r.push({label:P,labelLine:N,position:V,len:C,len2:R,minTurnAngle:U.get("minTurnAngle"),maxSurfaceAngle:U.get("maxSurfaceAngle"),surfaceNormal:new Nt(k,F),linePoints:Q,textAlign:se,labelDistance:ee,labelAlignTo:ie,edgeDistance:le,bleedMargin:_e,rect:Z,unconstrainedWidth:Z.width,labelStyleWidth:P.style.width})}E.setTextConfig({inside:we})}}),!a&&e.get("avoidLabelOverlap")&&XMe(r,n,i,l,u,h,f,c);for(var g=0;g<r.length;g++){var y=r[g],b=y.label,w=y.labelLine,_=isNaN(b.x)||isNaN(b.y);if(b){b.setStyle({align:y.textAlign}),_&&(ce(b.states,d),b.ignore=!0);var x=b.states.select;x&&(x.x+=b.x,x.y+=b.y)}if(w){var T=y.linePoints;_||!T?(ce(w.states,d),w.ignore=!0):(FIe(T,y.minTurnAngle),HIe(T,y.surfaceNormal,y.maxSurfaceAngle),w.setShape({points:T}),b.__hostTarget.textGuideLineConfig={anchor:new Nt(T[0][0],T[0][1])})}}}var ZMe=function(e){st(t,e);function t(r,n,i){var a=e.call(this)||this;a.z2=2;var o=new Ii;return a.setTextContent(o),a.updateData(r,n,i,!0),a}return t.prototype.updateData=function(r,n,i,a){var o=this,s=r.hostModel,l=r.getItemModel(n),u=l.getModel("emphasis"),f=r.getItemLayout(n),c=Ze(lb(l.getModel("itemStyle"),f,!0),f);if(isNaN(c.startAngle)){o.setShape(c);return}if(a){o.setShape(c);var h=s.getShallow("animationType");s.ecModel.ssr?(No(o,{scaleX:0,scaleY:0},s,{dataIndex:n,isFrom:!0}),o.originX=c.cx,o.originY=c.cy):h==="scale"?(o.shape.r=f.r0,No(o,{shape:{r:f.r}},s,n)):i!=null?(o.setShape({startAngle:i,endAngle:i}),No(o,{shape:{startAngle:f.startAngle,endAngle:f.endAngle}},s,n)):(o.shape.endAngle=f.startAngle,aa(o,{shape:{endAngle:f.endAngle}},s,n))}else r3(o),aa(o,{shape:c},s,n);o.useStyle(r.getItemVisual(n,"style")),lE(o,l);var d=(f.startAngle+f.endAngle)/2,v=s.get("selectedOffset"),g=Math.cos(d)*v,y=Math.sin(d)*v,b=l.getShallow("cursor");b&&o.attr("cursor",b),this._updateLabel(s,r,n),o.ensureState("emphasis").shape=Ze({r:f.r+(u.get("scale")&&u.get("scaleSize")||0)},lb(u.getModel("itemStyle"),f)),Ze(o.ensureState("select"),{x:g,y,shape:lb(l.getModel(["select","itemStyle"]),f)}),Ze(o.ensureState("blur"),{shape:lb(l.getModel(["blur","itemStyle"]),f)});var w=o.getTextGuideLine(),_=o.getTextContent();w&&Ze(w.ensureState("select"),{x:g,y}),Ze(_.ensureState("select"),{x:g,y}),hw(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r,n,i){var a=this,o=n.getItemModel(i),s=o.getModel("labelLine"),l=n.getItemVisual(i,"style"),u=l&&l.fill,f=l&&l.opacity;jS(a,US(o),{labelFetcher:n.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:f,defaultText:r.getFormattedLabel(i,"normal")||n.getName(i)});var c=a.getTextContent();a.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var h=r.get(["label","position"]);if(h!=="outside"&&h!=="outer")a.removeTextGuideLine();else{var d=this.getTextGuideLine();d||(d=new lk,this.setTextGuideLine(d)),VIe(this,WIe(o),{stroke:u,opacity:wb(s.get(["lineStyle","opacity"]),f,1)})}},t}(Ld),JMe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,n,i,a){var o=r.getData(),s=this._data,l=this.group,u;if(!s&&o.count()>0){for(var f=o.getItemLayout(0),c=1;isNaN(f&&f.startAngle)&&c<o.count();++c)f=o.getItemLayout(c);f&&(u=f.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),o.count()===0&&r.get("showEmptyCircle")){var h=new Ld({shape:sse(r,i)});h.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=h,l.add(h)}o.diff(s).add(function(d){var v=new ZMe(o,d,u);o.setItemGraphicEl(d,v),l.add(v)}).update(function(d,v){var g=s.getItemGraphicEl(v);g.updateData(o,d,u),g.off("click"),l.add(g),o.setItemGraphicEl(d,g)}).remove(function(d){var v=s.getItemGraphicEl(d);cE(v,r,d)}).execute(),qMe(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=o)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var o=r[0]-a.cx,s=r[1]-a.cy,l=Math.sqrt(o*o+s*s);return l<=a.r&&l>=a.r0}},t.type="pie",t}(ll);const QMe=JMe;function e2e(e,t,r){t=dt(t)&&{coordDimensions:t}||Ze({encodeDefine:e.getEncode()},t);var n=e.getSource(),i=Eoe(n,t).dimensions,a=new Ooe(i,e);return a.initData(n,r),a}var t2e=function(){function e(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return e.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},e.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},e.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},e.prototype.getItemVisual=function(t,r){var n=this._getDataWithEncodedVisual();return n.getItemVisual(t,r)},e}();const r2e=t2e;var n2e=zn(),i2e=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new r2e(Jr(this.getData,this),Jr(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return e2e(this,{coordDimensions:["value"],encodeDefaulter:Mn(TRe,this)})},t.prototype.getDataParams=function(r){var n=this.getData(),i=n2e(n),a=i.seats;if(!a){var o=[];n.each(n.mapDimension("value"),function(l){o.push(l)}),a=i.seats=lTe(o,n.hostModel.get("percentPrecision"))}var s=e.prototype.getDataParams.call(this,r);return s.percent=a[r]||0,s.$vars.push("percent"),s},t.prototype._defaultLabelLine=function(r){R$(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(cc);const a2e=i2e;function o2e(e){return{seriesType:e,reset:function(t,r){var n=t.getData();n.filterSelf(function(i){var a=n.mapDimension("value"),o=n.get(a,i);return!(Ur(o)&&!isNaN(o)&&o<0)})}}}function s2e(e){e.registerChartView(QMe),e.registerSeriesModel(a2e),hAe("pie",e.registerAction),e.registerLayout(Mn(GMe,"pie")),e.registerProcessor(YMe("pie")),e.registerProcessor(o2e("pie"))}var l2e=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}(nn);const u2e=l2e;var iN=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",ys).models[0]},t.type="cartesian2dAxis",t}(nn);hl(iN,TIe);var use={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},f2e=Ar({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},use),L3=Ar({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},use),c2e=Ar({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},L3),h2e=Mr({logBase:10},L3);const d2e={category:f2e,value:L3,time:c2e,log:h2e};var v2e={value:1,category:1,time:1,log:1};function zG(e,t,r,n){ce(v2e,function(i,a){var o=Ar(Ar({},d2e[a],!0),n,!0),s=function(l){st(u,l);function u(){var f=l!==null&&l.apply(this,arguments)||this;return f.type=t+"Axis."+a,f}return u.prototype.mergeDefaultAndTheme=function(f,c){var h=gw(this),d=h?bk(f):{},v=c.getTheme();Ar(f,v.get(a+"Axis")),Ar(f,this.getDefaultOption()),f.type=GG(f),h&&tg(f,d,h)},u.prototype.optionUpdated=function(){var f=this.option;f.type==="category"&&(this.__ordinalMeta=tN.createByAxisModel(this))},u.prototype.getCategories=function(f){var c=this.option;if(c.type==="category")return f?c.data:this.__ordinalMeta.categories},u.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},u.type=t+"Axis."+a,u.defaultOption=o,u}(r);e.registerComponentModel(s)}),e.registerSubTypeDefaulter(t+"Axis",GG)}function GG(e){return e.type||(e.data?"category":"value")}var p2e=function(){function e(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return e.prototype.getAxis=function(t){return this._axes[t]},e.prototype.getAxes=function(){return Rt(this._dimList,function(t){return this._axes[t]},this)},e.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),Qi(this.getAxes(),function(r){return r.scale.type===t})},e.prototype.addAxis=function(t){var r=t.dim;this._axes[r]=t,this._dimList.push(r)},e}();const g2e=p2e;var aN=["x","y"];function YG(e){return e.type==="interval"||e.type==="time"}var y2e=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cartesian2d",r.dimensions=aN,r}return t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var r=this.getAxis("x").scale,n=this.getAxis("y").scale;if(!(!YG(r)||!YG(n))){var i=r.getExtent(),a=n.getExtent(),o=this.dataToPoint([i[0],a[0]]),s=this.dataToPoint([i[1],a[1]]),l=i[1]-i[0],u=a[1]-a[0];if(!(!l||!u)){var f=(s[0]-o[0])/l,c=(s[1]-o[1])/u,h=o[0]-i[0]*f,d=o[1]-a[0]*c,v=this._transform=[f,0,0,c,h,d];this._invTransform=HB([],v)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(r){var n=this.getAxis("x"),i=this.getAxis("y");return n.contain(n.toLocalCoord(r[0]))&&i.contain(i.toLocalCoord(r[1]))},t.prototype.containData=function(r){return this.getAxis("x").containData(r[0])&&this.getAxis("y").containData(r[1])},t.prototype.containZone=function(r,n){var i=this.dataToPoint(r),a=this.dataToPoint(n),o=this.getArea(),s=new Pr(i[0],i[1],a[0]-i[0],a[1]-i[1]);return o.intersect(s)},t.prototype.dataToPoint=function(r,n,i){i=i||[];var a=r[0],o=r[1];if(this._transform&&a!=null&&isFinite(a)&&o!=null&&isFinite(o))return $o(i,r,this._transform);var s=this.getAxis("x"),l=this.getAxis("y");return i[0]=s.toGlobalCoord(s.dataToCoord(a,n)),i[1]=l.toGlobalCoord(l.dataToCoord(o,n)),i},t.prototype.clampData=function(r,n){var i=this.getAxis("x").scale,a=this.getAxis("y").scale,o=i.getExtent(),s=a.getExtent(),l=i.parse(r[0]),u=a.parse(r[1]);return n=n||[],n[0]=Math.min(Math.max(Math.min(o[0],o[1]),l),Math.max(o[0],o[1])),n[1]=Math.min(Math.max(Math.min(s[0],s[1]),u),Math.max(s[0],s[1])),n},t.prototype.pointToData=function(r,n){var i=[];if(this._invTransform)return $o(i,r,this._invTransform);var a=this.getAxis("x"),o=this.getAxis("y");return i[0]=a.coordToData(a.toLocalCoord(r[0]),n),i[1]=o.coordToData(o.toLocalCoord(r[1]),n),i},t.prototype.getOtherAxis=function(r){return this.getAxis(r.dim==="x"?"y":"x")},t.prototype.getArea=function(){var r=this.getAxis("x").getGlobalExtent(),n=this.getAxis("y").getGlobalExtent(),i=Math.min(r[0],r[1]),a=Math.min(n[0],n[1]),o=Math.max(r[0],r[1])-i,s=Math.max(n[0],n[1])-a;return new Pr(i,a,o,s)},t}(g2e),m2e=function(e){st(t,e);function t(r,n,i,a,o){var s=e.call(this,r,n,i)||this;return s.index=0,s.type=a||"value",s.position=o||"bottom",s}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.getGlobalExtent=function(r){var n=this.getExtent();return n[0]=this.toGlobalCoord(n[0]),n[1]=this.toGlobalCoord(n[1]),r&&n[0]>n[1]&&n.reverse(),n},t.prototype.pointToData=function(r,n){return this.coordToData(this.toLocalCoord(r[this.dim==="x"?0:1]),n)},t.prototype.setCategorySortInfo=function(r){if(this.type!=="category")return!1;this.model.option.categorySortInfo=r,this.scale.setSortInfo(r)},t}(LIe);const b2e=m2e;function oN(e,t,r){r=r||{};var n=e.coordinateSystem,i=t.axis,a={},o=i.getAxesOnZeroOf()[0],s=i.position,l=o?"onZero":s,u=i.dim,f=n.getRect(),c=[f.x,f.x+f.width,f.y,f.y+f.height],h={left:0,right:1,top:0,bottom:1,onZero:2},d=t.get("offset")||0,v=u==="x"?[c[2]-d,c[3]+d]:[c[0]-d,c[1]+d];if(o){var g=o.toGlobalCoord(o.dataToCoord(0));v[h.onZero]=Math.max(Math.min(g,v[1]),v[0])}a.position=[u==="y"?v[h[l]]:c[0],u==="x"?v[h[l]]:c[3]],a.rotation=Math.PI/2*(u==="x"?0:1);var y={top:-1,bottom:1,left:-1,right:1};a.labelDirection=a.tickDirection=a.nameDirection=y[s],a.labelOffset=o?v[h[s]]-v[h.onZero]:0,t.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),sw(r.labelInside,t.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var b=t.get(["axisLabel","rotate"]);return a.labelRotate=l==="top"?-b:b,a.z2=1,a}function KG(e){return e.get("coordinateSystem")==="cartesian2d"}function XG(e){var t={xAxisModel:null,yAxisModel:null};return ce(t,function(r,n){var i=n.replace(/Model$/,""),a=e.getReferringComponents(i,ys).models[0];t[n]=a}),t}var dM=Math.log;function w2e(e,t,r){var n=zS.prototype,i=n.getTicks.call(r),a=n.getTicks.call(r,!0),o=i.length-1,s=n.getInterval.call(r),l=Boe(e,t),u=l.extent,f=l.fixMin,c=l.fixMax;if(e.type==="log"){var h=dM(e.base);u=[dM(u[0])/h,dM(u[1])/h]}e.setExtent(u[0],u[1]),e.calcNiceExtent({splitNumber:o,fixMin:f,fixMax:c});var d=n.getExtent.call(e);f&&(u[0]=d[0]),c&&(u[1]=d[1]);var v=n.getInterval.call(e),g=u[0],y=u[1];if(f&&c)v=(y-g)/o;else if(f)for(y=u[0]+v*o;y<u[1]&&isFinite(y)&&isFinite(u[1]);)v=oM(v),y=u[0]+v*o;else if(c)for(g=u[1]-v*o;g>u[0]&&isFinite(g)&&isFinite(u[0]);)v=oM(v),g=u[1]-v*o;else{var b=e.getTicks().length-1;b>o&&(v=oM(v));var w=v*o;y=Math.ceil(u[1]/v)*v,g=jn(y-w),g<0&&u[0]>=0?(g=0,y=jn(w)):y>0&&u[1]<=0&&(y=0,g=-jn(w))}var _=(i[0].value-a[0].value)/s,x=(i[o].value-a[o].value)/s;n.setExtent.call(e,g+v*_,y+v*x),n.setInterval.call(e,v),(_||x)&&n.setNiceExtent.call(e,g+v,y-v)}var _2e=function(){function e(t,r,n){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=aN,this._initCartesian(t,r,n),this.model=t}return e.prototype.getRect=function(){return this._rect},e.prototype.update=function(t,r){var n=this._axesMap;this._updateScale(t,this.model);function i(o){var s,l=sn(o),u=l.length;if(u){for(var f=[],c=u-1;c>=0;c--){var h=+l[c],d=o[h],v=d.model,g=d.scale;rN(g)&&v.get("alignTicks")&&v.get("interval")==null?f.push(d):(mG(g,v),rN(g)&&(s=d))}f.length&&(s||(s=f.pop(),mG(s.scale,s.model)),ce(f,function(y){w2e(y.scale,y.model,s.scale)}))}}i(n.x),i(n.y);var a={};ce(n.x,function(o){qG(n,"y",o,a)}),ce(n.y,function(o){qG(n,"x",o,a)}),this.resize(this.model,r)},e.prototype.resize=function(t,r,n){var i=t.getBoxLayoutParams(),a=!n&&t.get("containLabel"),o=eg(i,{width:r.getWidth(),height:r.getHeight()});this._rect=o;var s=this._axesList;l(),a&&(ce(s,function(u){if(!u.model.get(["axisLabel","inside"])){var f=SIe(u);if(f){var c=u.isHorizontal()?"height":"width",h=u.model.get(["axisLabel","margin"]);o[c]-=f[c]+h,u.position==="top"?o.y+=f.height+h:u.position==="left"&&(o.x+=f.width+h)}}}),l()),ce(this._coordsList,function(u){u.calcAffineTransform()});function l(){ce(s,function(u){var f=u.isHorizontal(),c=f?[0,o.width]:[0,o.height],h=u.inverse?1:0;u.setExtent(c[h],c[1-h]),S2e(u,f?o.x:o.y)})}},e.prototype.getAxis=function(t,r){var n=this._axesMap[t];if(n!=null)return n[r||0]},e.prototype.getAxes=function(){return this._axesList.slice()},e.prototype.getCartesian=function(t,r){if(t!=null&&r!=null){var n="x"+t+"y"+r;return this._coordsMap[n]}Tt(t)&&(r=t.yAxisIndex,t=t.xAxisIndex);for(var i=0,a=this._coordsList;i<a.length;i++)if(a[i].getAxis("x").index===t||a[i].getAxis("y").index===r)return a[i]},e.prototype.getCartesians=function(){return this._coordsList.slice()},e.prototype.convertToPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},e.prototype.convertFromPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},e.prototype._findConvertTarget=function(t){var r=t.seriesModel,n=t.xAxisModel||r&&r.getReferringComponents("xAxis",ys).models[0],i=t.yAxisModel||r&&r.getReferringComponents("yAxis",ys).models[0],a=t.gridModel,o=this._coordsList,s,l;if(r)s=r.coordinateSystem,Hr(o,s)<0&&(s=null);else if(n&&i)s=this.getCartesian(n.componentIndex,i.componentIndex);else if(n)l=this.getAxis("x",n.componentIndex);else if(i)l=this.getAxis("y",i.componentIndex);else if(a){var u=a.coordinateSystem;u===this&&(s=this._coordsList[0])}return{cartesian:s,axis:l}},e.prototype.containPoint=function(t){var r=this._coordsList[0];if(r)return r.containPoint(t)},e.prototype._initCartesian=function(t,r,n){var i=this,a=this,o={left:!1,right:!1,top:!1,bottom:!1},s={x:{},y:{}},l={x:0,y:0};if(r.eachComponent("xAxis",u("x"),this),r.eachComponent("yAxis",u("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=s,ce(s.x,function(f,c){ce(s.y,function(h,d){var v="x"+c+"y"+d,g=new y2e(v);g.master=i,g.model=t,i._coordsMap[v]=g,i._coordsList.push(g),g.addAxis(f),g.addAxis(h)})});function u(f){return function(c,h){if(vM(c,t)){var d=c.get("position");f==="x"?d!=="top"&&d!=="bottom"&&(d=o.bottom?"top":"bottom"):d!=="left"&&d!=="right"&&(d=o.left?"right":"left"),o[d]=!0;var v=new b2e(f,wIe(c),[0,0],c.get("type"),d),g=v.type==="category";v.onBand=g&&c.get("boundaryGap"),v.inverse=c.get("inverse"),c.axis=v,v.model=c,v.grid=a,v.index=h,a._axesList.push(v),s[f][h]=v,l[f]++}}}},e.prototype._updateScale=function(t,r){ce(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var a=i.model.get("categorySortInfo");i.scale.setSortInfo(a)}}),t.eachSeries(function(i){if(KG(i)){var a=XG(i),o=a.xAxisModel,s=a.yAxisModel;if(!vM(o,r)||!vM(s,r))return;var l=this.getCartesian(o.componentIndex,s.componentIndex),u=i.getData(),f=l.getAxis("x"),c=l.getAxis("y");n(u,f),n(u,c)}},this);function n(i,a){ce(xIe(i,a.dim),function(o){a.scale.unionExtentFromData(i,o)})}},e.prototype.getTooltipAxes=function(t){var r=[],n=[];return ce(this.getCartesians(),function(i){var a=t!=null&&t!=="auto"?i.getAxis(t):i.getBaseAxis(),o=i.getOtherAxis(a);Hr(r,a)<0&&r.push(a),Hr(n,o)<0&&n.push(o)}),{baseAxes:r,otherAxes:n}},e.create=function(t,r){var n=[];return t.eachComponent("grid",function(i,a){var o=new e(i,t,r);o.name="grid_"+a,o.resize(i,r,!0),i.coordinateSystem=o,n.push(o)}),t.eachSeries(function(i){if(KG(i)){var a=XG(i),o=a.xAxisModel,s=a.yAxisModel,l=o.getCoordSysModel(),u=l.coordinateSystem;i.coordinateSystem=u.getCartesian(o.componentIndex,s.componentIndex)}}),n},e.dimensions=aN,e}();function vM(e,t){return e.getCoordSysModel()===t}function qG(e,t,r,n){r.getAxesOnZeroOf=function(){return a?[a]:[]};var i=e[t],a,o=r.model,s=o.get(["axisLine","onZero"]),l=o.get(["axisLine","onZeroAxisIndex"]);if(!s)return;if(l!=null)ZG(i[l])&&(a=i[l]);else for(var u in i)if(i.hasOwnProperty(u)&&ZG(i[u])&&!n[f(i[u])]){a=i[u];break}a&&(n[f(a)]=!0);function f(c){return c.dim+"_"+c.index}}function ZG(e){return e&&e.type!=="category"&&e.type!=="time"&&_Ie(e)}function S2e(e,t){var r=e.getExtent(),n=r[0]+r[1];e.toGlobalCoord=e.dim==="x"?function(i){return i+t}:function(i){return n-i+t},e.toLocalCoord=e.dim==="x"?function(i){return i-t}:function(i){return n-i+t}}const C2e=_2e;var $f=Math.PI,ud=function(){function e(t,r){this.group=new Pi,this.opt=r,this.axisModel=t,Mr(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var n=new Pi({x:r.position[0],y:r.position[1],rotation:r.rotation});n.updateTransform(),this._transformGroup=n}return e.prototype.hasBuilder=function(t){return!!JG[t]},e.prototype.add=function(t){JG[t](this.opt,this.axisModel,this.group,this._transformGroup)},e.prototype.getGroup=function(){return this.group},e.innerTextLayout=function(t,r,n){var i=Jne(r-t),a,o;return nE(i)?(o=n>0?"top":"bottom",a="center"):nE(i-$f)?(o=n>0?"bottom":"top",a="center"):(o="middle",i>0&&i<$f?a=n>0?"right":"left":a=n>0?"left":"right"),{rotation:i,textAlign:a,textVerticalAlign:o}},e.makeAxisEventDataBase=function(t){var r={componentType:t.mainType,componentIndex:t.componentIndex};return r[t.mainType+"Index"]=t.componentIndex,r},e.isLabelSilent=function(t){var r=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||r&&r.show)},e}(),JG={axisLine:function(e,t,r,n){var i=t.get(["axisLine","show"]);if(i==="auto"&&e.handleAutoShown&&(i=e.handleAutoShown("axisLine")),!!i){var a=t.axis.getExtent(),o=n.transform,s=[a[0],0],l=[a[1],0],u=s[0]>l[0];o&&($o(s,s,o),$o(l,l,o));var f=Ze({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),c=new yd({shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:f,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1});dw(c.shape,c.style.lineWidth),c.anid="line",r.add(c);var h=t.get(["axisLine","symbol"]);if(h!=null){var d=t.get(["axisLine","symbolSize"]);bt(h)&&(h=[h,h]),(bt(d)||Ur(d))&&(d=[d,d]);var v=Zae(t.get(["axisLine","symbolOffset"])||0,d),g=d[0],y=d[1];ce([{rotate:e.rotation+Math.PI/2,offset:v[0],r:0},{rotate:e.rotation-Math.PI/2,offset:v[1],r:Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1]))}],function(b,w){if(h[w]!=="none"&&h[w]!=null){var _=ng(h[w],-g/2,-y/2,g,y,f.stroke,!0),x=b.r+b.offset,T=u?l:s;_.attr({rotation:b.rotate,x:T[0]+x*Math.cos(e.rotation),y:T[1]-x*Math.sin(e.rotation),silent:!0,z2:11}),r.add(_)}})}}},axisTickLabel:function(e,t,r,n){var i=O2e(r,n,t,e),a=R2e(r,n,t,e);if(T2e(t,a,i),E2e(r,n,t,e.tickDirection),t.get(["axisLabel","hideOverlap"])){var o=jIe(Rt(a,function(s){return{label:s,priority:s.z2,defaultAttr:{ignore:s.ignore}}}));GIe(o)}},axisName:function(e,t,r,n){var i=sw(e.axisName,t.get("name"));if(i){var a=t.get("nameLocation"),o=e.nameDirection,s=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,u=t.axis.getExtent(),f=u[0]>u[1]?-1:1,c=[a==="start"?u[0]-f*l:a==="end"?u[1]+f*l:(u[0]+u[1])/2,e7(a)?e.labelOffset+o*l:0],h,d=t.get("nameRotate");d!=null&&(d=d*$f/180);var v;e7(a)?h=ud.innerTextLayout(e.rotation,d??e.rotation,o):(h=x2e(e.rotation,a,d||0,u),v=e.axisNameAvailableWidth,v!=null&&(v=Math.abs(v/Math.sin(h.rotation)),!isFinite(v)&&(v=null)));var g=s.getFont(),y=t.get("nameTruncate",!0)||{},b=y.ellipsis,w=sw(e.nameTruncateMaxWidth,y.maxWidth,v),_=new Ii({x:c[0],y:c[1],rotation:h.rotation,silent:ud.isLabelSilent(t),style:fc(s,{text:i,font:g,overflow:"truncate",width:w,ellipsis:b,fill:s.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:s.get("align")||h.textAlign,verticalAlign:s.get("verticalAlign")||h.textVerticalAlign}),z2:1});if(o3({el:_,componentModel:t,itemName:i}),_.__fullText=i,_.anid="name",t.get("triggerEvent")){var x=ud.makeAxisEventDataBase(t);x.targetType="axisName",x.name=i,Dr(_).eventData=x}n.add(_),_.updateTransform(),r.add(_),_.decomposeTransform()}}};function x2e(e,t,r,n){var i=Jne(r-e),a,o,s=n[0]>n[1],l=t==="start"&&!s||t!=="start"&&s;return nE(i-$f/2)?(o=l?"bottom":"top",a="center"):nE(i-$f*1.5)?(o=l?"top":"bottom",a="center"):(o="middle",i<$f*1.5&&i>$f/2?a=l?"left":"right":a=l?"right":"left"),{rotation:i,textAlign:a,textVerticalAlign:o}}function T2e(e,t,r){if(!Voe(e.axis)){var n=e.get(["axisLabel","showMinLabel"]),i=e.get(["axisLabel","showMaxLabel"]);t=t||[],r=r||[];var a=t[0],o=t[1],s=t[t.length-1],l=t[t.length-2],u=r[0],f=r[1],c=r[r.length-1],h=r[r.length-2];n===!1?(vo(a),vo(u)):QG(a,o)&&(n?(vo(o),vo(f)):(vo(a),vo(u))),i===!1?(vo(s),vo(c)):QG(l,s)&&(i?(vo(l),vo(h)):(vo(s),vo(c)))}}function vo(e){e&&(e.ignore=!0)}function QG(e,t){var r=e&&e.getBoundingRect().clone(),n=t&&t.getBoundingRect().clone();if(!(!r||!n)){var i=LB([]);return FB(i,i,-e.rotation),r.applyTransform(Ap([],i,e.getLocalTransform())),n.applyTransform(Ap([],i,t.getLocalTransform())),r.intersect(n)}}function e7(e){return e==="middle"||e==="center"}function fse(e,t,r,n,i){for(var a=[],o=[],s=[],l=0;l<e.length;l++){var u=e[l].coord;o[0]=u,o[1]=0,s[0]=u,s[1]=r,t&&($o(o,o,t),$o(s,s,t));var f=new yd({shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:n,z2:2,autoBatch:!0,silent:!0});dw(f.shape,f.style.lineWidth),f.anid=i+"_"+e[l].tickValue,a.push(f)}return a}function O2e(e,t,r,n){var i=r.axis,a=r.getModel("axisTick"),o=a.get("show");if(o==="auto"&&n.handleAutoShown&&(o=n.handleAutoShown("axisTick")),!(!o||i.scale.isBlank())){for(var s=a.getModel("lineStyle"),l=n.tickDirection*a.get("length"),u=i.getTicksCoords(),f=fse(u,t.transform,l,Mr(s.getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])}),"ticks"),c=0;c<f.length;c++)e.add(f[c]);return f}}function E2e(e,t,r,n){var i=r.axis,a=r.getModel("minorTick");if(!(!a.get("show")||i.scale.isBlank())){var o=i.getMinorTicksCoords();if(o.length)for(var s=a.getModel("lineStyle"),l=n*a.get("length"),u=Mr(s.getLineStyle(),Mr(r.getModel("axisTick").getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])})),f=0;f<o.length;f++)for(var c=fse(o[f],t.transform,l,u,"minorticks_"+f),h=0;h<c.length;h++)e.add(c[h])}}function R2e(e,t,r,n){var i=r.axis,a=sw(n.axisLabelShow,r.get(["axisLabel","show"]));if(!(!a||i.scale.isBlank())){var o=r.getModel("axisLabel"),s=o.get("margin"),l=i.getViewLabels(),u=(sw(n.labelRotate,o.get("rotate"))||0)*$f/180,f=ud.innerTextLayout(n.rotation,u,n.labelDirection),c=r.getCategories&&r.getCategories(!0),h=[],d=ud.isLabelSilent(r),v=r.get("triggerEvent");return ce(l,function(g,y){var b=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(g.tickValue):g.tickValue,w=g.formattedLabel,_=g.rawLabel,x=o;if(c&&c[b]){var T=c[b];Tt(T)&&T.textStyle&&(x=new Ei(T.textStyle,o,r.ecModel))}var O=x.getTextColor()||r.get(["axisLine","lineStyle","color"]),E=i.dataToCoord(b),M=new Ii({x:E,y:n.labelOffset+n.labelDirection*s,rotation:f.rotation,silent:d,z2:10+(g.level||0),style:fc(x,{text:w,align:x.getShallow("align",!0)||f.textAlign,verticalAlign:x.getShallow("verticalAlign",!0)||x.getShallow("baseline",!0)||f.textVerticalAlign,fill:Zt(O)?O(i.type==="category"?_:i.type==="value"?b+"":b,y):O})});if(M.anid="label_"+b,v){var P=ud.makeAxisEventDataBase(r);P.targetType="axisLabel",P.value=_,P.tickIndex=y,i.type==="category"&&(P.dataIndex=b),Dr(M).eventData=P}t.add(M),M.updateTransform(),h.push(M),e.add(M),M.decomposeTransform()}),h}}const cse=ud;function k2e(e,t){var r={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return A2e(r,e,t),r.seriesInvolved&&I2e(r,e),r}function A2e(e,t,r){var n=t.getComponent("tooltip"),i=t.getComponent("axisPointer"),a=i.get("link",!0)||[],o=[];ce(r.getCoordinateSystems(),function(s){if(!s.axisPointerEnabled)return;var l=Sw(s.model),u=e.coordSysAxesInfo[l]={};e.coordSysMap[l]=s;var f=s.model,c=f.getModel("tooltip",n);if(ce(s.getAxes(),Mn(g,!1,null)),s.getTooltipAxes&&n&&c.get("show")){var h=c.get("trigger")==="axis",d=c.get(["axisPointer","type"])==="cross",v=s.getTooltipAxes(c.get(["axisPointer","axis"]));(h||d)&&ce(v.baseAxes,Mn(g,d?"cross":!0,h)),d&&ce(v.otherAxes,Mn(g,"cross",!1))}function g(y,b,w){var _=w.model.getModel("axisPointer",i),x=_.get("show");if(!(!x||x==="auto"&&!y&&!sN(_))){b==null&&(b=_.get("triggerTooltip")),_=y?P2e(w,c,i,t,y,b):_;var T=_.get("snap"),O=Sw(w.model),E=b||T||w.type==="category",M=e.axesInfo[O]={key:O,axis:w,coordSys:s,axisPointerModel:_,triggerTooltip:b,involveSeries:E,snap:T,useHandle:sN(_),seriesModels:[],linkGroup:null};u[O]=M,e.seriesInvolved=e.seriesInvolved||E;var P=M2e(a,w);if(P!=null){var N=o[P]||(o[P]={axesInfo:{}});N.axesInfo[O]=M,N.mapper=a[P].mapper,M.linkGroup=N}}}})}function P2e(e,t,r,n,i,a){var o=t.getModel("axisPointer"),s=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};ce(s,function(h){l[h]=mr(o.get(h))}),l.snap=e.type!=="category"&&!!a,o.get("type")==="cross"&&(l.type="line");var u=l.label||(l.label={});if(u.show==null&&(u.show=!1),i==="cross"){var f=o.get(["label","show"]);if(u.show=f??!0,!a){var c=l.lineStyle=o.get("crossStyle");c&&Mr(u,c.textStyle)}}return e.model.getModel("axisPointer",new Ei(l,r,n))}function I2e(e,t){t.eachSeries(function(r){var n=r.coordinateSystem,i=r.get(["tooltip","trigger"],!0),a=r.get(["tooltip","show"],!0);!n||i==="none"||i===!1||i==="item"||a===!1||r.get(["axisPointer","show"],!0)===!1||ce(e.coordSysAxesInfo[Sw(n.model)],function(o){var s=o.axis;n.getAxis(s.dim)===s&&(o.seriesModels.push(r),o.seriesDataCount==null&&(o.seriesDataCount=0),o.seriesDataCount+=r.getData().count())})})}function M2e(e,t){for(var r=t.model,n=t.dim,i=0;i<e.length;i++){var a=e[i]||{};if(pM(a[n+"AxisId"],r.id)||pM(a[n+"AxisIndex"],r.componentIndex)||pM(a[n+"AxisName"],r.name))return i}}function pM(e,t){return e==="all"||dt(e)&&Hr(e,t)>=0||e===t}function D2e(e){var t=F3(e);if(t){var r=t.axisPointerModel,n=t.axis.scale,i=r.option,a=r.get("status"),o=r.get("value");o!=null&&(o=n.parse(o));var s=sN(r);a==null&&(i.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(o==null||o>l[1])&&(o=l[1]),o<l[0]&&(o=l[0]),i.value=o,s&&(i.status=t.axis.scale.isBlank()?"hide":"show")}}function F3(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[Sw(e)]}function $2e(e){var t=F3(e);return t&&t.axisPointerModel}function sN(e){return!!e.get(["handle","show"])}function Sw(e){return e.type+"||"+e.id}var t7={},N2e=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){this.axisPointerClass&&D2e(r),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(r,i,!0)},t.prototype.updateAxisPointer=function(r,n,i,a){this._doUpdateAxisPointerClass(r,i,!1)},t.prototype.remove=function(r,n){var i=this._axisPointer;i&&i.remove(n)},t.prototype.dispose=function(r,n){this._disposeAxisPointer(n),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(r,n,i){var a=t.getAxisPointerClass(this.axisPointerClass);if(a){var o=$2e(r);o?(this._axisPointer||(this._axisPointer=new a)).render(r,o,n,i):this._disposeAxisPointer(n)}},t.prototype._disposeAxisPointer=function(r){this._axisPointer&&this._axisPointer.dispose(r),this._axisPointer=null},t.registerAxisPointerClass=function(r,n){t7[r]=n},t.getAxisPointerClass=function(r){return r&&t7[r]},t.type="axis",t}(Pu);const hse=N2e;var lN=zn();function L2e(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitArea"),o=a.getModel("areaStyle"),s=o.get("color"),l=n.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:a,clamp:!0});if(u.length){var f=s.length,c=lN(e).splitAreaColors,h=ir(),d=0;if(c)for(var v=0;v<u.length;v++){var g=c.get(u[v].tickValue);if(g!=null){d=(g+(f-1)*v)%f;break}}var y=i.toGlobalCoord(u[0].coord),b=o.getAreaStyle();s=dt(s)?s:[s];for(var v=1;v<u.length;v++){var w=i.toGlobalCoord(u[v].coord),_=void 0,x=void 0,T=void 0,O=void 0;i.isHorizontal()?(_=y,x=l.y,T=w-_,O=l.height,y=_+T):(_=l.x,x=y,T=l.width,O=w-x,y=x+O);var E=u[v-1].tickValue;E!=null&&h.set(E,d),t.add(new Qn({anid:E!=null?"area_"+E:null,shape:{x:_,y:x,width:T,height:O},style:Mr({fill:s[d]},b),autoBatch:!0,silent:!0})),d=(d+1)%f}lN(e).splitAreaColors=h}}}function F2e(e){lN(e).splitAreaColors=null}var H2e=["axisLine","axisTickLabel","axisName"],B2e=["splitArea","splitLine","minorSplitLine"],dse=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="CartesianAxisPointer",r}return t.prototype.render=function(r,n,i,a){this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new Pi,this.group.add(this._axisGroup),!!r.get("show")){var s=r.getCoordSysModel(),l=oN(s,r),u=new cse(r,Ze({handleAutoShown:function(c){for(var h=s.coordinateSystem.getCartesians(),d=0;d<h.length;d++)if(rN(h[d].getOtherAxis(r.axis).scale))return!0;return!1}},l));ce(H2e,u.add,u),this._axisGroup.add(u.getGroup()),ce(B2e,function(c){r.get([c,"show"])&&V2e[c](this,this._axisGroup,r,s)},this);var f=a&&a.type==="changeAxisOrder"&&a.isInitSort;f||Jie(o,this._axisGroup,r),e.prototype.render.call(this,r,n,i,a)}},t.prototype.remove=function(){F2e(this)},t.type="cartesianAxis",t}(hse),V2e={splitLine:function(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitLine"),o=a.getModel("lineStyle"),s=o.get("color");s=dt(s)?s:[s];for(var l=n.coordinateSystem.getRect(),u=i.isHorizontal(),f=0,c=i.getTicksCoords({tickModel:a}),h=[],d=[],v=o.getLineStyle(),g=0;g<c.length;g++){var y=i.toGlobalCoord(c[g].coord);u?(h[0]=y,h[1]=l.y,d[0]=y,d[1]=l.y+l.height):(h[0]=l.x,h[1]=y,d[0]=l.x+l.width,d[1]=y);var b=f++%s.length,w=c[g].tickValue,_=new yd({anid:w!=null?"line_"+c[g].tickValue:null,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:d[0],y2:d[1]},style:Mr({stroke:s[b]},v),silent:!0});dw(_.shape,v.lineWidth),t.add(_)}}},minorSplitLine:function(e,t,r,n){var i=r.axis,a=r.getModel("minorSplitLine"),o=a.getModel("lineStyle"),s=n.coordinateSystem.getRect(),l=i.isHorizontal(),u=i.getMinorTicksCoords();if(u.length)for(var f=[],c=[],h=o.getLineStyle(),d=0;d<u.length;d++)for(var v=0;v<u[d].length;v++){var g=i.toGlobalCoord(u[d][v].coord);l?(f[0]=g,f[1]=s.y,c[0]=g,c[1]=s.y+s.height):(f[0]=s.x,f[1]=g,c[0]=s.x+s.width,c[1]=g);var y=new yd({anid:"minor_line_"+u[d][v].tickValue,autoBatch:!0,shape:{x1:f[0],y1:f[1],x2:c[0],y2:c[1]},style:h,silent:!0});dw(y.shape,h.lineWidth),t.add(y)}},splitArea:function(e,t,r,n){L2e(e,t,r,n)}},vse=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="xAxis",t}(dse),W2e=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=vse.type,r}return t.type="yAxis",t}(dse),j2e=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="grid",r}return t.prototype.render=function(r,n){this.group.removeAll(),r.get("show")&&this.group.add(new Qn({shape:r.coordinateSystem.getRect(),style:Mr({fill:r.get("backgroundColor")},r.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(Pu),r7={offset:0};function U2e(e){e.registerComponentView(j2e),e.registerComponentModel(u2e),e.registerCoordinateSystem("cartesian2d",C2e),zG(e,"x",iN,r7),zG(e,"y",iN,r7),e.registerComponentView(vse),e.registerComponentView(W2e),e.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}var xh=zn(),n7=mr,gM=Jr,z2e=function(){function e(){this._dragging=!1,this.animationThreshold=15}return e.prototype.render=function(t,r,n,i){var a=r.get("value"),o=r.get("status");if(this._axisModel=t,this._axisPointerModel=r,this._api=n,!(!i&&this._lastValue===a&&this._lastStatus===o)){this._lastValue=a,this._lastStatus=o;var s=this._group,l=this._handle;if(!o||o==="hide"){s&&s.hide(),l&&l.hide();return}s&&s.show(),l&&l.show();var u={};this.makeElOption(u,a,t,r,n);var f=u.graphicKey;f!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=f;var c=this._moveAnimation=this.determineAnimation(t,r);if(!s)s=this._group=new Pi,this.createPointerEl(s,u,t,r),this.createLabelEl(s,u,t,r),n.getZr().add(s);else{var h=Mn(i7,r,c);this.updatePointerEl(s,u,h),this.updateLabelEl(s,u,h,r)}o7(s,r,!0),this._renderHandle(a)}},e.prototype.remove=function(t){this.clear(t)},e.prototype.dispose=function(t){this.clear(t)},e.prototype.determineAnimation=function(t,r){var n=r.get("animation"),i=t.axis,a=i.type==="category",o=r.get("snap");if(!o&&!a)return!1;if(n==="auto"||n==null){var s=this.animationThreshold;if(a&&i.getBandWidth()>s)return!0;if(o){var l=F3(t).seriesDataCount,u=i.getExtent();return Math.abs(u[0]-u[1])/l>s}return!1}return n===!0},e.prototype.makeElOption=function(t,r,n,i,a){},e.prototype.createPointerEl=function(t,r,n,i){var a=r.pointer;if(a){var o=xh(t).pointerEl=new GEe[a.type](n7(r.pointer));t.add(o)}},e.prototype.createLabelEl=function(t,r,n,i){if(r.label){var a=xh(t).labelEl=new Ii(n7(r.label));t.add(a),a7(a,i)}},e.prototype.updatePointerEl=function(t,r,n){var i=xh(t).pointerEl;i&&r.pointer&&(i.setStyle(r.pointer.style),n(i,{shape:r.pointer.shape}))},e.prototype.updateLabelEl=function(t,r,n,i){var a=xh(t).labelEl;a&&(a.setStyle(r.label.style),n(a,{x:r.label.x,y:r.label.y}),a7(a,i))},e.prototype._renderHandle=function(t){if(!(this._dragging||!this.updateHandleTransform)){var r=this._axisPointerModel,n=this._api.getZr(),i=this._handle,a=r.getModel("handle"),o=r.get("status");if(!a.get("show")||!o||o==="hide"){i&&n.remove(i),this._handle=null;return}var s;this._handle||(s=!0,i=this._handle=a3(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(u){Ane(u.event)},onmousedown:gM(this._onHandleDragMove,this,0,0),drift:gM(this._onHandleDragMove,this),ondragend:gM(this._onHandleDragEnd,this)}),n.add(i)),o7(i,r,!1),i.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=a.get("size");dt(l)||(l=[l,l]),i.scaleX=l[0]/2,i.scaleY=l[1]/2,jae(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,s)}},e.prototype._moveHandleToValue=function(t,r){i7(this._axisPointerModel,!r&&this._moveAnimation,this._handle,yM(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},e.prototype._onHandleDragMove=function(t,r){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(yM(n),[t,r],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(yM(i)),xh(n).lastProp=null,this._doDispatchAxisPointer()}},e.prototype._doDispatchAxisPointer=function(){var t=this._handle;if(t){var r=this._payloadInfo,n=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:r.cursorPoint[0],y:r.cursorPoint[1],tooltipOption:r.tooltipOption,axesInfo:[{axisDim:n.axis.dim,axisIndex:n.componentIndex}]})}},e.prototype._onHandleDragEnd=function(){this._dragging=!1;var t=this._handle;if(t){var r=this._axisPointerModel.get("value");this._moveHandleToValue(r),this._api.dispatchAction({type:"hideTip"})}},e.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var r=t.getZr(),n=this._group,i=this._handle;r&&n&&(this._lastGraphicKey=null,n&&r.remove(n),i&&r.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),G$(this,"_doDispatchAxisPointer")},e.prototype.doClear=function(){},e.prototype.buildLabel=function(t,r,n){return n=n||0,{x:t[n],y:t[1-n],width:r[n],height:r[1-n]}},e}();function i7(e,t,r,n){pse(xh(r).lastProp,n)||(xh(r).lastProp=n,t?aa(r,n,e):(r.stopAnimation(),r.attr(n)))}function pse(e,t){if(Tt(e)&&Tt(t)){var r=!0;return ce(t,function(n,i){r=r&&pse(e[i],n)}),!!r}else return e===t}function a7(e,t){e[t.get(["label","show"])?"show":"hide"]()}function yM(e){return{x:e.x||0,y:e.y||0,rotation:e.rotation||0}}function o7(e,t,r){var n=t.get("z"),i=t.get("zlevel");e&&e.traverse(function(a){a.type!=="group"&&(n!=null&&(a.z=n),i!=null&&(a.zlevel=i),a.silent=r)})}const G2e=z2e;function Y2e(e){var t=e.get("type"),r=e.getModel(t+"Style"),n;return t==="line"?(n=r.getLineStyle(),n.fill=null):t==="shadow"&&(n=r.getAreaStyle(),n.stroke=null),n}function K2e(e,t,r,n,i){var a=r.get("value"),o=gse(a,t.axis,t.ecModel,r.get("seriesDataIndices"),{precision:r.get(["label","precision"]),formatter:r.get(["label","formatter"])}),s=r.getModel("label"),l=mk(s.get("padding")||0),u=s.getFont(),f=WB(o,u),c=i.position,h=f.width+l[1]+l[3],d=f.height+l[0]+l[2],v=i.align;v==="right"&&(c[0]-=h),v==="center"&&(c[0]-=h/2);var g=i.verticalAlign;g==="bottom"&&(c[1]-=d),g==="middle"&&(c[1]-=d/2),X2e(c,h,d,n);var y=s.get("backgroundColor");(!y||y==="auto")&&(y=t.get(["axisLine","lineStyle","color"])),e.label={x:c[0],y:c[1],style:fc(s,{text:o,font:u,fill:s.getTextColor(),padding:l,backgroundColor:y}),z2:10}}function X2e(e,t,r,n){var i=n.getWidth(),a=n.getHeight();e[0]=Math.min(e[0]+t,i)-t,e[1]=Math.min(e[1]+r,a)-r,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}function gse(e,t,r,n,i){e=t.scale.parse(e);var a=t.scale.getLabel({value:e},{precision:i.precision}),o=i.formatter;if(o){var s={value:I3(t,{value:e}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};ce(n,function(l){var u=r.getSeriesByIndex(l.seriesIndex),f=l.dataIndexInside,c=u&&u.getDataParams(f);c&&s.seriesData.push(c)}),bt(o)?a=o.replace("{value}",a):Zt(o)&&(a=o(s))}return a}function yse(e,t,r){var n=lw();return FB(n,n,r.rotation),p$(n,n,r.position),i3([e.dataToCoord(t),(r.labelOffset||0)+(r.labelDirection||1)*(r.labelMargin||0)],n)}function q2e(e,t,r,n,i,a){var o=cse.innerTextLayout(r.rotation,0,r.labelDirection);r.labelMargin=i.get(["label","margin"]),K2e(t,n,i,a,{position:yse(n.axis,e,r),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function Z2e(e,t,r){return r=r||0,{x1:e[r],y1:e[1-r],x2:t[r],y2:t[1-r]}}function J2e(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}}var Q2e=function(e){st(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,i,a,o){var s=i.axis,l=s.grid,u=a.get("type"),f=s7(l,s).getOtherAxis(s).getGlobalExtent(),c=s.toGlobalCoord(s.dataToCoord(n,!0));if(u&&u!=="none"){var h=Y2e(a),d=eDe[u](s,c,f);d.style=h,r.graphicKey=d.type,r.pointer=d}var v=oN(l.model,i);q2e(n,r,v,i,a,o)},t.prototype.getHandleTransform=function(r,n,i){var a=oN(n.axis.grid.model,n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var o=yse(n.axis,r,a);return{x:o[0],y:o[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,n,i,a){var o=i.axis,s=o.grid,l=o.getGlobalExtent(!0),u=s7(s,o).getOtherAxis(o).getGlobalExtent(),f=o.dim==="x"?0:1,c=[r.x,r.y];c[f]+=n[f],c[f]=Math.min(l[1],c[f]),c[f]=Math.max(l[0],c[f]);var h=(u[1]+u[0])/2,d=[h,h];d[f]=c[f];var v=[{verticalAlign:"middle"},{align:"center"}];return{x:c[0],y:c[1],rotation:r.rotation,cursorPoint:d,tooltipOption:v[f]}},t}(G2e);function s7(e,t){var r={};return r[t.dim+"AxisIndex"]=t.index,e.getCartesian(r)}var eDe={line:function(e,t,r){var n=Z2e([t,r[0]],[t,r[1]],l7(e));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(e,t,r){var n=Math.max(1,e.getBandWidth()),i=r[1]-r[0];return{type:"Rect",shape:J2e([t-n/2,r[0]],[n,i],l7(e))}}};function l7(e){return e.dim==="x"?0:1}const tDe=Q2e;var rDe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}(nn);const nDe=rDe;var Xl=zn(),iDe=ce;function mse(e,t,r){if(!nr.node){var n=t.getZr();Xl(n).records||(Xl(n).records={}),aDe(n,t);var i=Xl(n).records[e]||(Xl(n).records[e]={});i.handler=r}}function aDe(e,t){if(Xl(e).initialized)return;Xl(e).initialized=!0,r("click",Mn(u7,"click")),r("mousemove",Mn(u7,"mousemove")),r("globalout",sDe);function r(n,i){e.on(n,function(a){var o=lDe(t);iDe(Xl(e).records,function(s){s&&i(s,a,o.dispatchAction)}),oDe(o.pendings,t)})}}function oDe(e,t){var r=e.showTip.length,n=e.hideTip.length,i;r?i=e.showTip[r-1]:n&&(i=e.hideTip[n-1]),i&&(i.dispatchAction=null,t.dispatchAction(i))}function sDe(e,t,r){e.handler("leave",null,r)}function u7(e,t,r,n){t.handler(e,r,n)}function lDe(e){var t={showTip:[],hideTip:[]},r=function(n){var i=t[n.type];i?i.push(n):(n.dispatchAction=r,e.dispatchAction(n))};return{dispatchAction:r,pendings:t}}function uN(e,t){if(!nr.node){var r=t.getZr(),n=(Xl(r).records||{})[e];n&&(Xl(r).records[e]=null)}}var uDe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=n.getComponent("tooltip"),o=r.get("triggerOn")||a&&a.get("triggerOn")||"mousemove|click";mse("axisPointer",i,function(s,l,u){o!=="none"&&(s==="leave"||o.indexOf(s)>=0)&&u({type:"updateAxisPointer",currTrigger:s,x:l&&l.offsetX,y:l&&l.offsetY})})},t.prototype.remove=function(r,n){uN("axisPointer",n)},t.prototype.dispose=function(r,n){uN("axisPointer",n)},t.type="axisPointer",t}(Pu);const fDe=uDe;function bse(e,t){var r=[],n=e.seriesIndex,i;if(n==null||!(i=t.getSeriesByIndex(n)))return{point:[]};var a=i.getData(),o=gd(a,e);if(o==null||o<0||dt(o))return{point:[]};var s=a.getItemGraphicEl(o),l=i.coordinateSystem;if(i.getTooltipPosition)r=i.getTooltipPosition(o)||[];else if(l&&l.dataToPoint)if(e.isStacked){var u=l.getBaseAxis(),f=l.getOtherAxis(u),c=f.dim,h=u.dim,d=c==="x"||c==="radius"?1:0,v=a.mapDimension(h),g=[];g[d]=a.get(v,o),g[1-d]=a.get(a.getCalculationInfo("stackResultDimension"),o),r=l.dataToPoint(g)||[]}else r=l.dataToPoint(a.getValues(Rt(l.dimensions,function(b){return a.mapDimension(b)}),o))||[];else if(s){var y=s.getBoundingRect().clone();y.applyTransform(s.transform),r=[y.x+y.width/2,y.y+y.height/2]}return{point:r,el:s}}var f7=zn();function cDe(e,t,r){var n=e.currTrigger,i=[e.x,e.y],a=e,o=e.dispatchAction||Jr(r.dispatchAction,r),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){eO(i)&&(i=bse({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},t).point);var l=eO(i),u=a.axesInfo,f=s.axesInfo,c=n==="leave"||eO(i),h={},d={},v={list:[],map:{}},g={showPointer:Mn(dDe,d),showTooltip:Mn(vDe,v)};ce(s.coordSysMap,function(b,w){var _=l||b.containPoint(i);ce(s.coordSysAxesInfo[w],function(x,T){var O=x.axis,E=mDe(u,x);if(!c&&_&&(!u||E)){var M=E&&E.value;M==null&&!l&&(M=O.pointToData(i)),M!=null&&c7(x,M,g,!1,h)}})});var y={};return ce(f,function(b,w){var _=b.linkGroup;_&&!d[w]&&ce(_.axesInfo,function(x,T){var O=d[T];if(x!==b&&O){var E=O.value;_.mapper&&(E=b.axis.scale.parse(_.mapper(E,h7(x),h7(b)))),y[b.key]=E}})}),ce(y,function(b,w){c7(f[w],b,g,!0,h)}),pDe(d,f,h),gDe(v,i,e,o),yDe(f,o,r),h}}function c7(e,t,r,n,i){var a=e.axis;if(!(a.scale.isBlank()||!a.containData(t))){if(!e.involveSeries){r.showPointer(e,t);return}var o=hDe(t,e),s=o.payloadBatch,l=o.snapToValue;s[0]&&i.seriesIndex==null&&Ze(i,s[0]),!n&&e.snap&&a.containData(l)&&l!=null&&(t=l),r.showPointer(e,t,s),r.showTooltip(e,o,l)}}function hDe(e,t){var r=t.axis,n=r.dim,i=e,a=[],o=Number.MAX_VALUE,s=-1;return ce(t.seriesModels,function(l,u){var f=l.getData().mapDimensionsAll(n),c,h;if(l.getAxisTooltipData){var d=l.getAxisTooltipData(f,e,r);h=d.dataIndices,c=d.nestestValue}else{if(h=l.getData().indicesOfNearest(f[0],e,r.type==="category"?.5:null),!h.length)return;c=l.getData().get(f[0],h[0])}if(!(c==null||!isFinite(c))){var v=e-c,g=Math.abs(v);g<=o&&((g<o||v>=0&&s<0)&&(o=g,s=v,i=c,a.length=0),ce(h,function(y){a.push({seriesIndex:l.seriesIndex,dataIndexInside:y,dataIndex:l.getData().getRawIndex(y)})}))}}),{payloadBatch:a,snapToValue:i}}function dDe(e,t,r,n){e[t.key]={value:r,payloadBatch:n}}function vDe(e,t,r,n){var i=r.payloadBatch,a=t.axis,o=a.model,s=t.axisPointerModel;if(!(!t.triggerTooltip||!i.length)){var l=t.coordSys.model,u=Sw(l),f=e.map[u];f||(f=e.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(f)),f.dataByAxis.push({axisDim:a.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:n,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function pDe(e,t,r){var n=r.axesInfo=[];ce(t,function(i,a){var o=i.axisPointerModel.option,s=e[a];s?(!i.useHandle&&(o.status="show"),o.value=s.value,o.seriesDataIndices=(s.payloadBatch||[]).slice()):!i.useHandle&&(o.status="hide"),o.status==="show"&&n.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:o.value})})}function gDe(e,t,r,n){if(eO(t)||!e.list.length){n({type:"hideTip"});return}var i=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:r.tooltipOption,position:r.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:e.list})}function yDe(e,t,r){var n=r.getZr(),i="axisPointerLastHighlights",a=f7(n)[i]||{},o=f7(n)[i]={};ce(e,function(u,f){var c=u.axisPointerModel.option;c.status==="show"&&ce(c.seriesDataIndices,function(h){var d=h.seriesIndex+" | "+h.dataIndex;o[d]=h})});var s=[],l=[];ce(a,function(u,f){!o[f]&&l.push(u)}),ce(o,function(u,f){!a[f]&&s.push(u)}),l.length&&r.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&r.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}function mDe(e,t){for(var r=0;r<(e||[]).length;r++){var n=e[r];if(t.axis.dim===n.axisDim&&t.axis.model.componentIndex===n.axisIndex)return n}}function h7(e){var t=e.axis.model,r={},n=r.axisDim=e.axis.dim;return r.axisIndex=r[n+"AxisIndex"]=t.componentIndex,r.axisName=r[n+"AxisName"]=t.name,r.axisId=r[n+"AxisId"]=t.id,r}function eO(e){return!e||e[0]==null||isNaN(e[0])||e[1]==null||isNaN(e[1])}function wse(e){hse.registerAxisPointerClass("CartesianAxisPointer",tDe),e.registerComponentModel(nDe),e.registerComponentView(fDe),e.registerPreprocessor(function(t){if(t){(!t.axisPointer||t.axisPointer.length===0)&&(t.axisPointer={});var r=t.axisPointer.link;r&&!dt(r)&&(t.axisPointer.link=[r])}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,function(t,r){t.getComponent("axisPointer").coordSysAxesInfo=k2e(t,r)}),e.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},cDe)}function bDe(e){hc(U2e),hc(wse)}function wDe(e,t){var r=mk(t.get("padding")),n=t.getItemStyle(["color","opacity"]);return n.fill=t.get("backgroundColor"),e=new Qn({shape:{x:e.x-r[3],y:e.y-r[0],width:e.width+r[1]+r[3],height:e.height+r[0]+r[2],r:t.get("borderRadius")},style:n,silent:!0,z2:-1}),e}var _De=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}(nn);const SDe=_De;function _se(e){var t=e.get("confine");return t!=null?!!t:e.get("renderMode")==="richText"}function Sse(e){if(nr.domSupported){for(var t=document.documentElement.style,r=0,n=e.length;r<n;r++)if(e[r]in t)return e[r]}}var Cse=Sse(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),CDe=Sse(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function xse(e,t){if(!e)return t;t=vae(t,!0);var r=e.indexOf(t);return e=r===-1?t:"-"+e.slice(0,r)+"-"+t,e.toLowerCase()}function xDe(e,t){var r=e.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(e);return r?t?r[t]:r:null}var TDe=xse(CDe,"transition"),H3=xse(Cse,"transform"),ODe="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(nr.transform3dSupported?"will-change:transform;":"");function EDe(e){return e=e==="left"?"right":e==="right"?"left":e==="top"?"bottom":"top",e}function RDe(e,t,r){if(!bt(r)||r==="inside")return"";var n=e.get("backgroundColor"),i=e.get("borderWidth");t=md(t);var a=EDe(r),o=Math.max(Math.round(i)*1.5,6),s="",l=H3+":",u;Hr(["left","right"],a)>-1?(s+="top:50%",l+="translateY(-50%) rotate("+(u=a==="left"?-225:-45)+"deg)"):(s+="left:50%",l+="translateX(-50%) rotate("+(u=a==="top"?225:45)+"deg)");var f=u*Math.PI/180,c=o+i,h=c*Math.abs(Math.cos(f))+c*Math.abs(Math.sin(f)),d=Math.round(((h-Math.SQRT2*i)/2+Math.SQRT2*i-(h-c)/2)*100)/100;s+=";"+a+":-"+d+"px";var v=t+" solid "+i+"px;",g=["position:absolute;width:"+o+"px;height:"+o+"px;z-index:-1;",s+";"+l+";","border-bottom:"+v,"border-right:"+v,"background-color:"+n+";"];return'<div style="'+g.join("")+'"></div>'}function kDe(e,t){var r="cubic-bezier(0.23,1,0.32,1)",n=" "+e/2+"s "+r,i="opacity"+n+",visibility"+n;return t||(n=" "+e+"s "+r,i+=nr.transformSupported?","+H3+n:",left"+n+",top"+n),TDe+":"+i}function d7(e,t,r){var n=e.toFixed(0)+"px",i=t.toFixed(0)+"px";if(!nr.transformSupported)return r?"top:"+i+";left:"+n+";":[["top",i],["left",n]];var a=nr.transform3dSupported,o="translate"+(a?"3d":"")+"("+n+","+i+(a?",0":"")+")";return r?"top:0;left:0;"+H3+":"+o+";":[["top",0],["left",0],[Cse,o]]}function ADe(e){var t=[],r=e.get("fontSize"),n=e.getTextColor();n&&t.push("color:"+n),t.push("font:"+e.getFont()),r&&t.push("line-height:"+Math.round(r*3/2)+"px");var i=e.get("textShadowColor"),a=e.get("textShadowBlur")||0,o=e.get("textShadowOffsetX")||0,s=e.get("textShadowOffsetY")||0;return i&&a&&t.push("text-shadow:"+o+"px "+s+"px "+a+"px "+i),ce(["decoration","align"],function(l){var u=e.get(l);u&&t.push("text-"+l+":"+u)}),t.join(";")}function PDe(e,t,r){var n=[],i=e.get("transitionDuration"),a=e.get("backgroundColor"),o=e.get("shadowBlur"),s=e.get("shadowColor"),l=e.get("shadowOffsetX"),u=e.get("shadowOffsetY"),f=e.getModel("textStyle"),c=Vae(e,"html"),h=l+"px "+u+"px "+o+"px "+s;return n.push("box-shadow:"+h),t&&i&&n.push(kDe(i,r)),a&&n.push("background-color:"+a),ce(["width","color","radius"],function(d){var v="border-"+d,g=vae(v),y=e.get(g);y!=null&&n.push(v+":"+y+(d==="color"?"":"px"))}),n.push(ADe(f)),c!=null&&n.push("padding:"+mk(c).join("px ")+"px"),n.join(";")+";"}function v7(e,t,r,n,i){var a=t&&t.painter;if(r){var o=a&&a.getViewportRoot();o&&zCe(e,o,document.body,n,i)}else{e[0]=n,e[1]=i;var s=a&&a.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var IDe=function(){function e(t,r,n){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,nr.wxa)return null;var i=document.createElement("div");i.domBelongToZr=!0,this.el=i;var a=this._zr=r.getZr(),o=this._appendToBody=n&&n.appendToBody;v7(this._styleCoord,a,o,r.getWidth()/2,r.getHeight()/2),o?document.body.appendChild(i):t.appendChild(i),this._container=t;var s=this;i.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},i.onmousemove=function(l){if(l=l||window.event,!s._enterable){var u=a.handler,f=a.painter.getViewportRoot();_o(f,l,!0),u.dispatch("mousemove",l)}},i.onmouseleave=function(){s._inContent=!1,s._enterable&&s._show&&s.hideLater(s._hideDelay)}}return e.prototype.update=function(t){var r=this._container,n=xDe(r,"position"),i=r.style;i.position!=="absolute"&&n!=="absolute"&&(i.position="relative");var a=t.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=t.get("className")||""},e.prototype.show=function(t,r){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var n=this.el,i=n.style,a=this._styleCoord;n.innerHTML?i.cssText=ODe+PDe(t,!this._firstShow,this._longHide)+d7(a[0],a[1],!0)+("border-color:"+md(r)+";")+(t.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},e.prototype.setContent=function(t,r,n,i,a){var o=this.el;if(t==null){o.innerHTML="";return}var s="";if(bt(a)&&n.get("trigger")==="item"&&!_se(n)&&(s=RDe(n,i,a)),bt(t))o.innerHTML=t+s;else if(t){o.innerHTML="",dt(t)||(t=[t]);for(var l=0;l<t.length;l++)KO(t[l])&&t[l].parentNode!==o&&o.appendChild(t[l]);if(s&&o.childNodes.length){var u=document.createElement("div");u.innerHTML=s,o.appendChild(u)}}},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el;return[t.offsetWidth,t.offsetHeight]},e.prototype.moveTo=function(t,r){var n=this._styleCoord;if(v7(n,this._zr,this._appendToBody,t,r),n[0]!=null&&n[1]!=null){var i=this.el.style,a=d7(n[0],n[1]);ce(a,function(o){i[o[0]]=o[1]})}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){var t=this,r=this.el.style;r.visibility="hidden",r.opacity="0",nr.transform3dSupported&&(r.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(Jr(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},e}();const MDe=IDe;var DDe=function(){function e(t){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=t.getZr(),g7(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return e.prototype.update=function(t){var r=t.get("alwaysShowContent");r&&this._moveIfResized(),this._alwaysShowContent=r},e.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},e.prototype.setContent=function(t,r,n,i,a){var o=this;Tt(t)&&Sa(""),this.el&&this._zr.remove(this.el);var s=n.getModel("textStyle");this.el=new Ii({style:{rich:r.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:s.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:Vae(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),ce(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(u){o.el.style[u]=n.get(u)}),ce(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(u){o.el.style[u]=s.get(u)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el,r=this.el.getBoundingRect(),n=p7(t.style);return[r.width+n.left+n.right,r.height+n.top+n.bottom]},e.prototype.moveTo=function(t,r){var n=this.el;if(n){var i=this._styleCoord;g7(i,this._zr,t,r),t=i[0],r=i[1];var a=n.style,o=xf(a.borderWidth||0),s=p7(a);n.x=t+o+s.left,n.y=r+o+s.top,n.markRedraw()}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(Jr(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this._zr.remove(this.el)},e}();function xf(e){return Math.max(0,e)}function p7(e){var t=xf(e.shadowBlur||0),r=xf(e.shadowOffsetX||0),n=xf(e.shadowOffsetY||0);return{left:xf(t-r),right:xf(t+r),top:xf(t-n),bottom:xf(t+n)}}function g7(e,t,r,n){e[0]=r,e[1]=n,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}const $De=DDe;var NDe=new Qn({shape:{x:-1,y:-1,width:2,height:2}}),LDe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){if(!(nr.node||!n.getDom())){var i=r.getComponent("tooltip"),a=this._renderMode=OTe(i.get("renderMode"));this._tooltipContent=a==="richText"?new $De(n):new MDe(n.getDom(),n,{appendToBody:i.get("appendToBody",!0)})}},t.prototype.render=function(r,n,i){if(!(nr.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=r,this._ecModel=n,this._api=i;var a=this._tooltipContent;a.update(r),a.setEnterable(r.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&r.get("transitionDuration")?jae(this,"_updatePosition",50,"fixRate"):G$(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var r=this._tooltipModel,n=r.get("triggerOn");mse("itemTooltip",this._api,Jr(function(i,a,o){n!=="none"&&(n.indexOf(i)>=0?this._tryShow(a,o):i==="leave"&&this._hide(o))},this))},t.prototype._keepShow=function(){var r=this._tooltipModel,n=this._ecModel,i=this._api,a=r.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&o.manuallyShowTip(r,n,i,{x:o._lastX,y:o._lastY,dataByCoordSys:o._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(r,n,i,a){if(!(a.from===this.uid||nr.node||!i.getDom())){var o=y7(a,i);this._ticket="";var s=a.dataByCoordSys,l=VDe(a,n,i);if(l){var u=l.el.getBoundingRect().clone();u.applyTransform(l.el.transform),this._tryShow({offsetX:u.x+u.width/2,offsetY:u.y+u.height/2,target:l.el,position:a.position,positionDefault:"bottom"},o)}else if(a.tooltip&&a.x!=null&&a.y!=null){var f=NDe;f.x=a.x,f.y=a.y,f.update(),Dr(f).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:f},o)}else if(s)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:s,tooltipOption:a.tooltipOption},o);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(r,n,i,a))return;var c=bse(a,n),h=c.point[0],d=c.point[1];h!=null&&d!=null&&this._tryShow({offsetX:h,offsetY:d,target:c.el,position:a.position,positionDefault:"bottom"},o)}else a.x!=null&&a.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:i.getZr().findHover(a.x,a.y).target},o))}},t.prototype.manuallyHideTip=function(r,n,i,a){var o=this._tooltipContent;this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(y7(a,i))},t.prototype._manuallyAxisShowTip=function(r,n,i,a){var o=a.seriesIndex,s=a.dataIndex,l=n.getComponent("axisPointer").coordSysAxesInfo;if(!(o==null||s==null||l==null)){var u=n.getSeriesByIndex(o);if(u){var f=u.getData(),c=w0([f.getItemModel(s),u,(u.coordinateSystem||{}).model],this._tooltipModel);if(c.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:s,position:a.position}),!0}}},t.prototype._tryShow=function(r,n){var i=r.target,a=this._tooltipModel;if(a){this._lastX=r.offsetX,this._lastY=r.offsetY;var o=r.dataByCoordSys;if(o&&o.length)this._showAxisTooltip(o,r);else if(i){this._lastDataByCoordSys=null;var s,l;sb(i,function(u){if(Dr(u).dataIndex!=null)return s=u,!0;if(Dr(u).tooltipConfig!=null)return l=u,!0},!0),s?this._showSeriesItemTooltip(r,s,n):l?this._showComponentItemTooltip(r,l,n):this._hide(n)}else this._lastDataByCoordSys=null,this._hide(n)}},t.prototype._showOrMove=function(r,n){var i=r.get("showDelay");n=Jr(n,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(n,i):n()},t.prototype._showAxisTooltip=function(r,n){var i=this._ecModel,a=this._tooltipModel,o=[n.offsetX,n.offsetY],s=w0([n.tooltipOption],a),l=this._renderMode,u=[],f=mw("section",{blocks:[],noHeader:!0}),c=[],h=new KI;ce(r,function(w){ce(w.dataByAxis,function(_){var x=i.getComponent(_.axisDim+"Axis",_.axisIndex),T=_.value;if(!(!x||T==null)){var O=gse(T,x.axis,i,_.seriesDataIndices,_.valueLabelOpt),E=mw("section",{header:O,noHeader:!al(O),sortBlocks:!0,blocks:[]});f.blocks.push(E),ce(_.seriesDataIndices,function(M){var P=i.getSeriesByIndex(M.seriesIndex),N=M.dataIndexInside,D=P.getDataParams(N);if(!(D.dataIndex<0)){D.axisDim=_.axisDim,D.axisIndex=_.axisIndex,D.axisType=_.axisType,D.axisId=_.axisId,D.axisValue=I3(x.axis,{value:T}),D.axisValueLabel=O,D.marker=h.makeTooltipMarker("item",md(D.color),l);var L=Ez(P.formatTooltip(N,!0,null)),V=L.frag;if(V){var ee=w0([P],a).get("valueFormatter");E.blocks.push(ee?Ze({valueFormatter:ee},V):V)}L.text&&c.push(L.text),u.push(D)}})}})}),f.blocks.reverse(),c.reverse();var d=n.position,v=s.get("order"),g=Iz(f,h,l,v,i.get("useUTC"),s.get("textStyle"));g&&c.unshift(g);var y=l==="richText"?`

`:"<br/>",b=c.join(y);this._showOrMove(s,function(){this._updateContentNotChangedOnAxis(r,u)?this._updatePosition(s,d,o[0],o[1],this._tooltipContent,u):this._showTooltipContent(s,b,u,Math.random()+"",o[0],o[1],d,null,h)})},t.prototype._showSeriesItemTooltip=function(r,n,i){var a=this._ecModel,o=Dr(n),s=o.seriesIndex,l=a.getSeriesByIndex(s),u=o.dataModel||l,f=o.dataIndex,c=o.dataType,h=u.getData(c),d=this._renderMode,v=r.positionDefault,g=w0([h.getItemModel(f),u,l&&(l.coordinateSystem||{}).model],this._tooltipModel,v?{position:v}:null),y=g.get("trigger");if(!(y!=null&&y!=="item")){var b=u.getDataParams(f,c),w=new KI;b.marker=w.makeTooltipMarker("item",md(b.color),d);var _=Ez(u.formatTooltip(f,!1,c)),x=g.get("order"),T=g.get("valueFormatter"),O=_.frag,E=O?Iz(T?Ze({valueFormatter:T},O):O,w,d,x,a.get("useUTC"),g.get("textStyle")):_.text,M="item_"+u.name+"_"+f;this._showOrMove(g,function(){this._showTooltipContent(g,E,b,M,r.offsetX,r.offsetY,r.position,r.target,w)}),i({type:"showTip",dataIndexInside:f,dataIndex:h.getRawIndex(f),seriesIndex:s,from:this.uid})}},t.prototype._showComponentItemTooltip=function(r,n,i){var a=Dr(n),o=a.tooltipConfig,s=o.option||{};if(bt(s)){var l=s;s={content:l,formatter:l}}var u=[s],f=this._ecModel.getComponent(a.componentMainType,a.componentIndex);f&&u.push(f),u.push({formatter:s.content});var c=r.positionDefault,h=w0(u,this._tooltipModel,c?{position:c}:null),d=h.get("content"),v=Math.random()+"",g=new KI;this._showOrMove(h,function(){var y=mr(h.get("formatterParams")||{});this._showTooltipContent(h,d,y,v,r.offsetX,r.offsetY,r.position,n,g)}),i({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(r,n,i,a,o,s,l,u,f){if(this._ticket="",!(!r.get("showContent")||!r.get("show"))){var c=this._tooltipContent;c.setEnterable(r.get("enterable"));var h=r.get("formatter");l=l||r.get("position");var d=n,v=this._getNearestPoint([o,s],i,r.get("trigger"),r.get("borderColor")),g=v.color;if(h)if(bt(h)){var y=r.ecModel.get("useUTC"),b=dt(i)?i[0]:i,w=b&&b.axisType&&b.axisType.indexOf("time")>=0;d=h,w&&(d=dk(b.axisValue,d,y)),d=pae(d,i,!0)}else if(Zt(h)){var _=Jr(function(x,T){x===this._ticket&&(c.setContent(T,f,r,g,l),this._updatePosition(r,l,o,s,c,i,u))},this);this._ticket=a,d=h(i,a,_)}else d=h;c.setContent(d,f,r,g,l),c.show(r,g),this._updatePosition(r,l,o,s,c,i,u)}},t.prototype._getNearestPoint=function(r,n,i,a){if(i==="axis"||dt(n))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!dt(n))return{color:a||n.color||n.borderColor}},t.prototype._updatePosition=function(r,n,i,a,o,s,l){var u=this._api.getWidth(),f=this._api.getHeight();n=n||r.get("position");var c=o.getSize(),h=r.get("align"),d=r.get("verticalAlign"),v=l&&l.getBoundingRect().clone();if(l&&v.applyTransform(l.transform),Zt(n)&&(n=n([i,a],s,o.el,v,{viewSize:[u,f],contentSize:c.slice()})),dt(n))i=on(n[0],u),a=on(n[1],f);else if(Tt(n)){var g=n;g.width=c[0],g.height=c[1];var y=eg(g,{width:u,height:f});i=y.x,a=y.y,h=null,d=null}else if(bt(n)&&l){var b=BDe(n,v,c,r.get("borderWidth"));i=b[0],a=b[1]}else{var b=FDe(i,a,o,u,f,h?null:20,d?null:20);i=b[0],a=b[1]}if(h&&(i-=m7(h)?c[0]/2:h==="right"?c[0]:0),d&&(a-=m7(d)?c[1]/2:d==="bottom"?c[1]:0),_se(r)){var b=HDe(i,a,o,u,f);i=b[0],a=b[1]}o.moveTo(i,a)},t.prototype._updateContentNotChangedOnAxis=function(r,n){var i=this._lastDataByCoordSys,a=this._cbParamsList,o=!!i&&i.length===r.length;return o&&ce(i,function(s,l){var u=s.dataByAxis||[],f=r[l]||{},c=f.dataByAxis||[];o=o&&u.length===c.length,o&&ce(u,function(h,d){var v=c[d]||{},g=h.seriesDataIndices||[],y=v.seriesDataIndices||[];o=o&&h.value===v.value&&h.axisType===v.axisType&&h.axisId===v.axisId&&g.length===y.length,o&&ce(g,function(b,w){var _=y[w];o=o&&b.seriesIndex===_.seriesIndex&&b.dataIndex===_.dataIndex}),a&&ce(h.seriesDataIndices,function(b){var w=b.seriesIndex,_=n[w],x=a[w];_&&x&&x.data!==_.data&&(o=!1)})})}),this._lastDataByCoordSys=r,this._cbParamsList=n,!!o},t.prototype._hide=function(r){this._lastDataByCoordSys=null,r({type:"hideTip",from:this.uid})},t.prototype.dispose=function(r,n){nr.node||!n.getDom()||(G$(this,"_updatePosition"),this._tooltipContent.dispose(),uN("itemTooltip",n))},t.type="tooltip",t}(Pu);function w0(e,t,r){var n=t.ecModel,i;r?(i=new Ei(r,n,n),i=new Ei(t.option,i,n)):i=t;for(var a=e.length-1;a>=0;a--){var o=e[a];o&&(o instanceof Ei&&(o=o.get("tooltip",!0)),bt(o)&&(o={formatter:o}),o&&(i=new Ei(o,i,n)))}return i}function y7(e,t){return e.dispatchAction||Jr(t.dispatchAction,t)}function FDe(e,t,r,n,i,a,o){var s=r.getSize(),l=s[0],u=s[1];return a!=null&&(e+l+a+2>n?e-=l+a:e+=a),o!=null&&(t+u+o>i?t-=u+o:t+=o),[e,t]}function HDe(e,t,r,n,i){var a=r.getSize(),o=a[0],s=a[1];return e=Math.min(e+o,n)-o,t=Math.min(t+s,i)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}function BDe(e,t,r,n){var i=r[0],a=r[1],o=Math.ceil(Math.SQRT2*n)+8,s=0,l=0,u=t.width,f=t.height;switch(e){case"inside":s=t.x+u/2-i/2,l=t.y+f/2-a/2;break;case"top":s=t.x+u/2-i/2,l=t.y-a-o;break;case"bottom":s=t.x+u/2-i/2,l=t.y+f+o;break;case"left":s=t.x-i-o,l=t.y+f/2-a/2;break;case"right":s=t.x+u+o,l=t.y+f/2-a/2}return[s,l]}function m7(e){return e==="center"||e==="middle"}function VDe(e,t,r){var n=YB(e).queryOptionMap,i=n.keys()[0];if(!(!i||i==="series")){var a=VS(t,i,n.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),o=a.models[0];if(o){var s=r.getViewOfComponentModel(o),l;if(s.group.traverse(function(u){var f=Dr(u).tooltipConfig;if(f&&f.name===e.name)return l=u,!0}),l)return{componentMainType:i,componentIndex:o.componentIndex,el:l}}}}const WDe=LDe;function jDe(e){hc(wse),e.registerComponentModel(SDe),e.registerComponentView(WDe),e.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Ta),e.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Ta)}var UDe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}(nn),zDe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){if(this.group.removeAll(),!!r.get("show")){var a=this.group,o=r.getModel("textStyle"),s=r.getModel("subtextStyle"),l=r.get("textAlign"),u=pr(r.get("textBaseline"),r.get("textVerticalAlign")),f=new Ii({style:fc(o,{text:r.get("text"),fill:o.getTextColor()},{disableBox:!0}),z2:10}),c=f.getBoundingRect(),h=r.get("subtext"),d=new Ii({style:fc(s,{text:h,fill:s.getTextColor(),y:c.height+r.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),v=r.get("link"),g=r.get("sublink"),y=r.get("triggerEvent",!0);f.silent=!v&&!y,d.silent=!g&&!y,v&&f.on("click",function(){uz(v,"_"+r.get("target"))}),g&&d.on("click",function(){uz(g,"_"+r.get("subtarget"))}),Dr(f).eventData=Dr(d).eventData=y?{componentType:"title",componentIndex:r.componentIndex}:null,a.add(f),h&&a.add(d);var b=a.getBoundingRect(),w=r.getBoxLayoutParams();w.width=b.width,w.height=b.height;var _=eg(w,{width:i.getWidth(),height:i.getHeight()},r.get("padding"));l||(l=r.get("left")||r.get("right"),l==="middle"&&(l="center"),l==="right"?_.x+=_.width:l==="center"&&(_.x+=_.width/2)),u||(u=r.get("top")||r.get("bottom"),u==="center"&&(u="middle"),u==="bottom"?_.y+=_.height:u==="middle"&&(_.y+=_.height/2),u=u||"top"),a.x=_.x,a.y=_.y,a.markRedraw();var x={align:l,verticalAlign:u};f.setStyle(x),d.setStyle(x),b=a.getBoundingRect();var T=_.margin,O=r.getItemStyle(["color","opacity"]);O.fill=r.get("backgroundColor");var E=new Qn({shape:{x:b.x-T[3],y:b.y-T[0],width:b.width+T[1]+T[3],height:b.height+T[0]+T[2],r:r.get("borderRadius")},style:O,subPixelOptimize:!0,silent:!0});a.add(E)}},t.type="title",t}(Pu);function GDe(e){e.registerComponentModel(UDe),e.registerComponentView(zDe)}var YDe=function(e,t){if(t==="all")return{type:"all",title:e.getLocaleModel().get(["legend","selector","all"])};if(t==="inverse")return{type:"inverse",title:e.getLocaleModel().get(["legend","selector","inverse"])}},KDe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),r.selected=r.selected||{},this._updateSelector(r)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),this._updateSelector(r)},t.prototype._updateSelector=function(r){var n=r.selector,i=this.ecModel;n===!0&&(n=r.selector=["all","inverse"]),dt(n)&&ce(n,function(a,o){bt(a)&&(a={type:a}),n[o]=Ar(a,YDe(i,a.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var r=this._data;if(r[0]&&this.get("selectedMode")==="single"){for(var n=!1,i=0;i<r.length;i++){var a=r[i].get("name");if(this.isSelected(a)){this.select(a),n=!0;break}}!n&&this.select(r[0].get("name"))}},t.prototype._updateData=function(r){var n=[],i=[];r.eachRawSeries(function(l){var u=l.name;i.push(u);var f;if(l.legendVisualProvider){var c=l.legendVisualProvider,h=c.getAllNames();r.isSeriesFiltered(l)||(i=i.concat(h)),h.length?n=n.concat(h):f=!0}else f=!0;f&&GB(l)&&n.push(l.name)}),this._availableNames=i;var a=this.get("data")||n,o=ir(),s=Rt(a,function(l){return(bt(l)||Ur(l))&&(l={name:l}),o.get(l.name)?null:(o.set(l.name,!0),new Ei(l,this,this.ecModel))},this);this._data=Qi(s,function(l){return!!l})},t.prototype.getData=function(){return this._data},t.prototype.select=function(r){var n=this.option.selected,i=this.get("selectedMode");if(i==="single"){var a=this._data;ce(a,function(o){n[o.get("name")]=!1})}n[r]=!0},t.prototype.unSelect=function(r){this.get("selectedMode")!=="single"&&(this.option.selected[r]=!1)},t.prototype.toggleSelected=function(r){var n=this.option.selected;n.hasOwnProperty(r)||(n[r]=!0),this[n[r]?"unSelect":"select"](r)},t.prototype.allSelect=function(){var r=this._data,n=this.option.selected;ce(r,function(i){n[i.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var r=this._data,n=this.option.selected;ce(r,function(i){var a=i.get("name",!0);n.hasOwnProperty(a)||(n[a]=!0),n[a]=!n[a]})},t.prototype.isSelected=function(r){var n=this.option.selected;return!(n.hasOwnProperty(r)&&!n[r])&&Hr(this._availableNames,r)>=0},t.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}(nn);const fN=KDe;var Mv=Mn,cN=ce,bx=Pi,XDe=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!1,r}return t.prototype.init=function(){this.group.add(this._contentGroup=new bx),this.group.add(this._selectorGroup=new bx),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(r,n,i){var a=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!r.get("show",!0)){var o=r.get("align"),s=r.get("orient");(!o||o==="auto")&&(o=r.get("left")==="right"&&s==="vertical"?"right":"left");var l=r.get("selector",!0),u=r.get("selectorPosition",!0);l&&(!u||u==="auto")&&(u=s==="horizontal"?"end":"start"),this.renderInner(o,r,n,i,l,s,u);var f=r.getBoxLayoutParams(),c={width:i.getWidth(),height:i.getHeight()},h=r.get("padding"),d=eg(f,c,h),v=this.layoutInner(r,o,d,a,l,u),g=eg(Mr({width:v.width,height:v.height},f),c,h);this.group.x=g.x-v.x,this.group.y=g.y-v.y,this.group.markRedraw(),this.group.add(this._backgroundEl=wDe(v,r))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this.getContentGroup(),f=ir(),c=n.get("selectedMode"),h=[];i.eachRawSeries(function(d){!d.get("legendHoverLink")&&h.push(d.id)}),cN(n.getData(),function(d,v){var g=d.get("name");if(!this.newlineDisabled&&(g===""||g===`
`)){var y=new bx;y.newline=!0,u.add(y);return}var b=i.getSeriesByName(g)[0];if(!f.get(g))if(b){var w=b.getData(),_=w.getVisual("legendLineStyle")||{},x=w.getVisual("legendIcon"),T=w.getVisual("style"),O=this._createItem(b,g,v,d,n,r,_,T,x,c,a);O.on("click",Mv(b7,g,null,a,h)).on("mouseover",Mv(hN,b.name,null,a,h)).on("mouseout",Mv(dN,b.name,null,a,h)),f.set(g,!0)}else i.eachRawSeries(function(E){if(!f.get(g)&&E.legendVisualProvider){var M=E.legendVisualProvider;if(!M.containName(g))return;var P=M.indexOfName(g),N=M.getItemVisual(P,"style"),D=M.getItemVisual(P,"legendIcon"),L=xu(N.fill);L&&L[3]===0&&(L[3]=.2,N=Ze(Ze({},N),{fill:tk(L,"rgba")}));var V=this._createItem(E,g,v,d,n,r,{},N,D,c,a);V.on("click",Mv(b7,null,g,a,h)).on("mouseover",Mv(hN,null,g,a,h)).on("mouseout",Mv(dN,null,g,a,h)),f.set(g,!0)}},this)},this),o&&this._createSelector(o,n,a,s,l)},t.prototype._createSelector=function(r,n,i,a,o){var s=this.getSelectorGroup();cN(r,function(u){var f=u.type,c=new Ii({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:f==="all"?"legendAllSelect":"legendInverseSelect"})}});s.add(c);var h=n.getModel("selectorLabel"),d=n.getModel(["emphasis","selectorLabel"]);jS(c,{normal:h,emphasis:d},{defaultText:u.title}),$$(c)})},t.prototype._createItem=function(r,n,i,a,o,s,l,u,f,c,h){var d=r.visualDrawType,v=o.get("itemWidth"),g=o.get("itemHeight"),y=o.isSelected(n),b=a.get("symbolRotate"),w=a.get("symbolKeepAspect"),_=a.get("icon");f=_||f||"roundRect";var x=qDe(f,a,l,u,d,y,h),T=new bx,O=a.getModel("textStyle");if(Zt(r.getLegendIcon)&&(!_||_==="inherit"))T.add(r.getLegendIcon({itemWidth:v,itemHeight:g,icon:f,iconRotate:b,itemStyle:x.itemStyle,lineStyle:x.lineStyle,symbolKeepAspect:w}));else{var E=_==="inherit"&&r.getData().getVisual("symbol")?b==="inherit"?r.getData().getVisual("symbolRotate"):b:0;T.add(ZDe({itemWidth:v,itemHeight:g,icon:f,iconRotate:E,itemStyle:x.itemStyle,lineStyle:x.lineStyle,symbolKeepAspect:w}))}var M=s==="left"?v+5:-5,P=s,N=o.get("formatter"),D=n;bt(N)&&N?D=N.replace("{name}",n??""):Zt(N)&&(D=N(n));var L=a.get("inactiveColor");T.add(new Ii({style:fc(O,{text:D,x:M,y:g/2,fill:y?O.getTextColor():L,align:P,verticalAlign:"middle"})}));var V=new Qn({shape:T.getBoundingRect(),invisible:!0}),ee=a.getModel("tooltip");return ee.get("show")&&o3({el:V,componentModel:o,itemName:n,itemTooltipOption:ee.option}),T.add(V),T.eachChild(function(ie){ie.silent=!0}),V.silent=!c,this.getContentGroup().add(T),$$(T),T.__legendDataIndex=i,T},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getContentGroup(),u=this.getSelectorGroup();kb(r.get("orient"),l,r.get("itemGap"),i.width,i.height);var f=l.getBoundingRect(),c=[-f.x,-f.y];if(u.markRedraw(),l.markRedraw(),o){kb("horizontal",u,r.get("selectorItemGap",!0));var h=u.getBoundingRect(),d=[-h.x,-h.y],v=r.get("selectorButtonGap",!0),g=r.getOrient().index,y=g===0?"width":"height",b=g===0?"height":"width",w=g===0?"y":"x";s==="end"?d[g]+=f[y]+v:c[g]+=h[y]+v,d[1-g]+=f[b]/2-h[b]/2,u.x=d[0],u.y=d[1],l.x=c[0],l.y=c[1];var _={x:0,y:0};return _[y]=f[y]+v+h[y],_[b]=Math.max(f[b],h[b]),_[w]=Math.min(0,h[w]+d[1-g]),_}else return l.x=c[0],l.y=c[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(Pu);function qDe(e,t,r,n,i,a,o){function s(y,b){y.lineWidth==="auto"&&(y.lineWidth=b.lineWidth>0?2:0),cN(y,function(w,_){y[_]==="inherit"&&(y[_]=b[_])})}var l=t.getModel("itemStyle"),u=l.getItemStyle(),f=e.lastIndexOf("empty",0)===0?"fill":"stroke",c=l.getShallow("decal");u.decal=!c||c==="inherit"?n.decal:Z$(c,o),u.fill==="inherit"&&(u.fill=n[i]),u.stroke==="inherit"&&(u.stroke=n[f]),u.opacity==="inherit"&&(u.opacity=(i==="fill"?n:r).opacity),s(u,n);var h=t.getModel("lineStyle"),d=h.getLineStyle();if(s(d,r),u.fill==="auto"&&(u.fill=n.fill),u.stroke==="auto"&&(u.stroke=n.fill),d.stroke==="auto"&&(d.stroke=n.fill),!a){var v=t.get("inactiveBorderWidth"),g=u[f];u.lineWidth=v==="auto"?n.lineWidth>0&&g?2:0:u.lineWidth,u.fill=t.get("inactiveColor"),u.stroke=t.get("inactiveBorderColor"),d.stroke=h.get("inactiveColor"),d.lineWidth=h.get("inactiveWidth")}return{itemStyle:u,lineStyle:d}}function ZDe(e){var t=e.icon||"roundRect",r=ng(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill,e.symbolKeepAspect);return r.setStyle(e.itemStyle),r.rotation=(e.iconRotate||0)*Math.PI/180,r.setOrigin([e.itemWidth/2,e.itemHeight/2]),t.indexOf("empty")>-1&&(r.style.stroke=r.style.fill,r.style.fill="#fff",r.style.lineWidth=2),r}function b7(e,t,r,n){dN(e,t,r,n),r.dispatchAction({type:"legendToggleSelect",name:e??t}),hN(e,t,r,n)}function Tse(e){for(var t=e.getZr().storage.getDisplayList(),r,n=0,i=t.length;n<i&&!(r=t[n].states.emphasis);)n++;return r&&r.hoverLayer}function hN(e,t,r,n){Tse(r)||r.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:n})}function dN(e,t,r,n){Tse(r)||r.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:n})}const Ose=XDe;function JDe(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(r){for(var n=0;n<t.length;n++)if(!t[n].isSelected(r.name))return!1;return!0})}function _0(e,t,r){var n={},i=e==="toggleSelected",a;return r.eachComponent("legend",function(o){i&&a!=null?o[a?"select":"unSelect"](t.name):e==="allSelect"||e==="inverseSelect"?o[e]():(o[e](t.name),a=o.isSelected(t.name));var s=o.getData();ce(s,function(l){var u=l.get("name");if(!(u===`
`||u==="")){var f=o.isSelected(u);n.hasOwnProperty(u)?n[u]=n[u]&&f:n[u]=f}})}),e==="allSelect"||e==="inverseSelect"?{selected:n}:{name:t.name,selected:n}}function QDe(e){e.registerAction("legendToggleSelect","legendselectchanged",Mn(_0,"toggleSelected")),e.registerAction("legendAllSelect","legendselectall",Mn(_0,"allSelect")),e.registerAction("legendInverseSelect","legendinverseselect",Mn(_0,"inverseSelect")),e.registerAction("legendSelect","legendselected",Mn(_0,"select")),e.registerAction("legendUnSelect","legendunselected",Mn(_0,"unSelect"))}function Ese(e){e.registerComponentModel(fN),e.registerComponentView(Ose),e.registerProcessor(e.PRIORITY.PROCESSOR.SERIES_FILTER,JDe),e.registerSubTypeDefaulter("legend",function(){return"plain"}),QDe(e)}var e$e=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.setScrollDataIndex=function(r){this.option.scrollDataIndex=r},t.prototype.init=function(r,n,i){var a=bk(r);e.prototype.init.call(this,r,n,i),w7(this,r,a)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),w7(this,this.option,r)},t.type="legend.scroll",t.defaultOption=rae(fN.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(fN);function w7(e,t,r){var n=e.getOrient(),i=[1,1];i[n.index]=0,tg(t,r,{type:"box",ignoreSize:!!i})}const t$e=e$e;var _7=Pi,mM=["width","height"],bM=["x","y"],r$e=function(e){st(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!0,r._currentIndex=0,r}return t.prototype.init=function(){e.prototype.init.call(this),this.group.add(this._containerGroup=new _7),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new _7)},t.prototype.resetInner=function(){e.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this;e.prototype.renderInner.call(this,r,n,i,a,o,s,l);var f=this._controllerGroup,c=n.get("pageIconSize",!0),h=dt(c)?c:[c,c];v("pagePrev",0);var d=n.getModel("pageTextStyle");f.add(new Ii({name:"pageText",style:{text:"xx/xx",fill:d.getTextColor(),font:d.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),v("pageNext",1);function v(g,y){var b=g+"DataIndex",w=a3(n.get("pageIcons",!0)[n.getOrient().name][y],{onclick:Jr(u._pageGo,u,b,n,a)},{x:-h[0]/2,y:-h[1]/2,width:h[0],height:h[1]});w.name=g,f.add(w)}},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getSelectorGroup(),u=r.getOrient().index,f=mM[u],c=bM[u],h=mM[1-u],d=bM[1-u];o&&kb("horizontal",l,r.get("selectorItemGap",!0));var v=r.get("selectorButtonGap",!0),g=l.getBoundingRect(),y=[-g.x,-g.y],b=mr(i);o&&(b[f]=i[f]-g[f]-v);var w=this._layoutContentAndController(r,a,b,u,f,h,d,c);if(o){if(s==="end")y[u]+=w[f]+v;else{var _=g[f]+v;y[u]-=_,w[c]-=_}w[f]+=g[f]+v,y[1-u]+=w[d]+w[h]/2-g[h]/2,w[h]=Math.max(w[h],g[h]),w[d]=Math.min(w[d],g[d]+y[1-u]),l.x=y[0],l.y=y[1],l.markRedraw()}return w},t.prototype._layoutContentAndController=function(r,n,i,a,o,s,l,u){var f=this.getContentGroup(),c=this._containerGroup,h=this._controllerGroup;kb(r.get("orient"),f,r.get("itemGap"),a?i.width:null,a?null:i.height),kb("horizontal",h,r.get("pageButtonItemGap",!0));var d=f.getBoundingRect(),v=h.getBoundingRect(),g=this._showController=d[o]>i[o],y=[-d.x,-d.y];n||(y[a]=f[u]);var b=[0,0],w=[-v.x,-v.y],_=pr(r.get("pageButtonGap",!0),r.get("itemGap",!0));if(g){var x=r.get("pageButtonPosition",!0);x==="end"?w[a]+=i[o]-v[o]:b[a]+=v[o]+_}w[1-a]+=d[s]/2-v[s]/2,f.setPosition(y),c.setPosition(b),h.setPosition(w);var T={x:0,y:0};if(T[o]=g?i[o]:d[o],T[s]=Math.max(d[s],v[s]),T[l]=Math.min(0,v[l]+w[1-a]),c.__rectSize=i[o],g){var O={x:0,y:0};O[o]=Math.max(i[o]-v[o]-_,0),O[s]=T[s],c.setClipPath(new Qn({shape:O})),c.__rectSize=O[o]}else h.eachChild(function(M){M.attr({invisible:!0,silent:!0})});var E=this._getPageInfo(r);return E.pageIndex!=null&&aa(f,{x:E.contentPosition[0],y:E.contentPosition[1]},g?r:null),this._updatePageInfoView(r,E),T},t.prototype._pageGo=function(r,n,i){var a=this._getPageInfo(n)[r];a!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:a,legendId:n.id})},t.prototype._updatePageInfoView=function(r,n){var i=this._controllerGroup;ce(["pagePrev","pageNext"],function(f){var c=f+"DataIndex",h=n[c]!=null,d=i.childOfName(f);d&&(d.setStyle("fill",h?r.get("pageIconColor",!0):r.get("pageIconInactiveColor",!0)),d.cursor=h?"pointer":"default")});var a=i.childOfName("pageText"),o=r.get("pageFormatter"),s=n.pageIndex,l=s!=null?s+1:0,u=n.pageCount;a&&o&&a.setStyle("text",bt(o)?o.replace("{current}",l==null?"":l+"").replace("{total}",u==null?"":u+""):o({current:l,total:u}))},t.prototype._getPageInfo=function(r){var n=r.get("scrollDataIndex",!0),i=this.getContentGroup(),a=this._containerGroup.__rectSize,o=r.getOrient().index,s=mM[o],l=bM[o],u=this._findTargetItemIndex(n),f=i.children(),c=f[u],h=f.length,d=h?1:0,v={contentPosition:[i.x,i.y],pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return v;var g=x(c);v.contentPosition[o]=-g.s;for(var y=u+1,b=g,w=g,_=null;y<=h;++y)_=x(f[y]),(!_&&w.e>b.s+a||_&&!T(_,b.s))&&(w.i>b.i?b=w:b=_,b&&(v.pageNextDataIndex==null&&(v.pageNextDataIndex=b.i),++v.pageCount)),w=_;for(var y=u-1,b=g,w=g,_=null;y>=-1;--y)_=x(f[y]),(!_||!T(w,_.s))&&b.i<w.i&&(w=b,v.pagePrevDataIndex==null&&(v.pagePrevDataIndex=b.i),++v.pageCount,++v.pageIndex),b=_;return v;function x(O){if(O){var E=O.getBoundingRect(),M=E[l]+O[l];return{s:M,e:M+E[s],i:O.__legendDataIndex}}}function T(O,E){return O.e>=E&&O.s<=E+a}},t.prototype._findTargetItemIndex=function(r){if(!this._showController)return 0;var n,i=this.getContentGroup(),a;return i.eachChild(function(o,s){var l=o.__legendDataIndex;a==null&&l!=null&&(a=s),l===r&&(n=s)}),n??a},t.type="legend.scroll",t}(Ose);const n$e=r$e;function i$e(e){e.registerAction("legendScroll","legendscroll",function(t,r){var n=t.scrollDataIndex;n!=null&&r.eachComponent({mainType:"legend",subType:"scroll",query:t},function(i){i.setScrollDataIndex(n)})})}function a$e(e){hc(Ese),e.registerComponentModel(t$e),e.registerComponentView(n$e),i$e(e)}function o$e(e){hc(Ese),hc(a$e)}var wM=null;function s$e(e){return wM||(wM=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),wM(e)}var _M=null;function l$e(e){_M||(_M=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),_M(e)}function u$e(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function _x(e,t){t===void 0&&(t={});var r=document.createElement(e);return Object.keys(t).forEach(function(n){r[n]=t[n]}),r}function Rse(e,t,r){var n=window.getComputedStyle(e,r||null)||{display:"none"};return n[t]}function vN(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Rse(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var f$e='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',pN=0,tO=null;function c$e(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=v$e.bind(e));var r=e.__resize_listeners__;if(!r){if(e.__resize_listeners__=[],window.ResizeObserver){var n=e.offsetWidth,i=e.offsetHeight,a=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===n&&e.offsetHeight===i)||SE(e)}),o=vN(e),s=o.detached,l=o.rendered;e.__resize_observer_triggered__=s===!1&&l===!1,e.__resize_observer__=a,a.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){SE(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(pN||(tO=u$e(f$e)),p$e(e),e.__resize_rendered__=vN(e).rendered,window.MutationObserver){var u=new MutationObserver(e.__resize_mutation_handler__);u.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=u}}e.__resize_listeners__.push(t),pN++}function h$e(e,t){var r=e.__resize_listeners__;if(r){if(t&&r.splice(r.indexOf(t),1),!r.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",B3),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--pN&&tO&&tO.parentNode.removeChild(tO)}}function d$e(e){var t=e.__resize_last__,r=t.width,n=t.height,i=e.offsetWidth,a=e.offsetHeight;return i!==r||a!==n?{width:i,height:a}:null}function v$e(){var e=vN(this),t=e.rendered,r=e.detached;t!==this.__resize_rendered__&&(!r&&this.__resize_triggers__&&(V3(this),this.addEventListener("scroll",B3,!0)),this.__resize_rendered__=t,SE(this))}function B3(){var e=this;V3(this),this.__resize_raf__&&l$e(this.__resize_raf__),this.__resize_raf__=s$e(function(){var t=d$e(e);t&&(e.__resize_last__=t,SE(e))})}function SE(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function p$e(e){var t=Rse(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var r=_x("div",{className:"resize-triggers"}),n=_x("div",{className:"resize-expand-trigger"}),i=_x("div"),a=_x("div",{className:"resize-contract-trigger"});n.appendChild(i),r.appendChild(n),r.appendChild(a),e.appendChild(r),e.__resize_triggers__={triggers:r,expand:n,expandChild:i,contract:a},V3(e),e.addEventListener("scroll",B3,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function V3(e){var t=e.__resize_triggers__,r=t.expand,n=t.expandChild,i=t.contract,a=i.scrollWidth,o=i.scrollHeight,s=r.offsetWidth,l=r.offsetHeight,u=r.scrollWidth,f=r.scrollHeight;i.scrollLeft=a,i.scrollTop=o,n.style.width=s+1+"px",n.style.height=l+1+"px",r.scrollLeft=u,r.scrollTop=f}var Vl=function(){return Vl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vl.apply(this,arguments)},g$e=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function y$e(e){return t=Object.create(null),g$e.forEach(function(r){t[r]=function(n){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[n].apply(e.value,i)}}(r)}),t;var t}var m$e={autoresize:Boolean},b$e=/^on[^a-z]/,w$e=function(e){return b$e.test(e)};function Sx(e,t){var r=Mo(e);return r&&typeof r=="object"&&"value"in r?r.value||t:r||t}var _$e={loading:Boolean,loadingOptions:Object},S0=null,S7=[],C0=[];(function(e,t){if(e&&typeof document<"u"){var r,n=t.prepend===!0?"prepend":"append",i=t.singleTag===!0,a=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var o=S7.indexOf(a);o===-1&&(o=S7.push(a)-1,C0[o]={}),r=C0[o]&&C0[o][n]?C0[o][n]:C0[o][n]=s()}else r=s();e.charCodeAt(0)===65279&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function s(){var l=document.createElement("style");if(l.setAttribute("type","text/css"),t.attributes)for(var u=Object.keys(t.attributes),f=0;f<u.length;f++)l.setAttribute(u[f],t.attributes[u[f]]);var c=n==="prepend"?"afterbegin":"beforeend";return a.insertAdjacentElement(c,l),l}})(`x-vue-echarts{display:block;width:100%;height:100%;min-width:0}
`,{});var S$e=function(){if(S0!=null)return S0;if(typeof HTMLElement>"u"||typeof customElements>"u")return S0=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)("x-vue-echarts")}catch{return S0=!1}return S0=!0}(),C$e="ecTheme",x$e=Fu({name:"echarts",props:Vl(Vl({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},m$e),_$e),emits:{},inheritAttrs:!1,setup:function(e,t){var r=t.attrs,n=QP(),i=QP(),a=QP(),o=PC("ecTheme",null),s=PC("ecInitOptions",null),l=PC("ecUpdateOptions",null),u=A1e(e),f=u.autoresize,c=u.manualUpdate,h=u.loading,d=u.loadingOptions,v=el(function(){return a.value||e.option||null}),g=el(function(){return e.theme||Sx(o,{})}),y=el(function(){return e.initOptions||Sx(s,{})}),b=el(function(){return e.updateOptions||Sx(l,{})}),w=el(function(){return function(M){var P={};for(var N in M)w$e(N)||(P[N]=M[N]);return P}(r)}),_=P1e().proxy.$listeners;function x(M){if(n.value){var P=i.value=lPe(n.value,g.value,y.value);e.group&&(P.group=e.group);var N=_;N||(N={},Object.keys(r).filter(function(L){return L.indexOf("on")===0&&L.length>2}).forEach(function(L){var V=L.charAt(2).toLowerCase()+L.slice(3);V.substring(V.length-4)==="Once"&&(V="~".concat(V.substring(0,V.length-4))),N[V]=r[L]})),Object.keys(N).forEach(function(L){var V=N[L];if(V){var ee=L.toLowerCase();ee.charAt(0)==="~"&&(ee=ee.substring(1),V.__once__=!0);var ie=P;if(ee.indexOf("zr:")===0&&(ie=P.getZr(),ee=ee.substring(3)),V.__once__){delete V.__once__;var le=V;V=function(){for(var _e=[],U=0;U<arguments.length;U++)_e[U]=arguments[U];le.apply(void 0,_e),ie.off(ee,V)}}ie.on(ee,V)}}),f.value?wne(function(){P&&!P.isDisposed()&&P.resize(),D()}):D()}function D(){var L=M||v.value;L&&P.setOption(L,b.value)}}function T(){i.value&&(i.value.dispose(),i.value=void 0)}var O=null;eb(c,function(M){typeof O=="function"&&(O(),O=null),M||(O=eb(function(){return e.option},function(P,N){P&&(i.value?i.value.setOption(P,Vl({notMerge:P!==N},b.value)):x())},{deep:!0}))},{immediate:!0}),eb([g,y],function(){T(),x()},{deep:!0}),L5(function(){e.group&&i.value&&(i.value.group=e.group)});var E=y$e(i);return function(M,P,N){var D=PC("ecLoadingOptions",{}),L=el(function(){return Vl(Vl({},Sx(D,{})),N==null?void 0:N.value)});L5(function(){var V=M.value;V&&(P.value?V.showLoading(L.value):V.hideLoading())})}(i,h,d),function(M,P,N){var D=null;eb([N,M,P],function(L,V,ee){var ie=L[0],le=L[1],_e=L[2];ie&&le&&_e&&(D=Ck(function(){le.resize()},100),c$e(ie,D)),ee(function(){D&&ie&&h$e(ie,D)})})}(i,f,n),kB(function(){x()}),I1e(function(){S$e&&n.value?n.value.__dispose=T:T()}),Vl({chart:i,root:n,setOption:function(M,P){e.manualUpdate&&(a.value=M),i.value?i.value.setOption(M,P||{}):x(M)},nonEventAttrs:w},E)},render:function(){var e=Vl({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",M1e("x-vue-echarts",e)}});const T$e={type:"bar"},O$e={type:"DYNAMIC_RANKING_BAR"},E$e={type:"line"},R$e={type:"pie"},k$e={type:"bar"},A$e={type:"ring"},_m={DYNAMIC_LINE_BAR_MIX:T$e,DYNAMIC_RANKING_BAR:O$e,LINE_BASICS:E$e,PIE_BASICS:R$e,BAR_BASICS:k$e,RING_BASICS:A$e},W3=e=>{var n;const{type:t}=e,r=(n=_m[t])==null?void 0:n.type;return!!["bar","line"].includes(r)},Cx=(e,t)=>{const{type:r}=e;return _m[r].type===t},P$e=e=>{const{config:t}=e,{data:r=[]}=t,n={};if(W3(e)){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{xAxis:n}}return{}},I$e=e=>{const{config:t,type:r}=e,{data:n=[]}=t,a=_m[r].type,o=[],s=gs.cloneDeep(n);if((Cx(e,"line")||Cx(e,"bar"))&&(s[0].shift(),s[0].forEach((u,f)=>{const c={name:u,type:a,data:[]};for(let h=1;h<s.length;h++){const d=s[h];c.data.push(+d[f+1])}o.push(c)})),Cx(e,"pie")){const l={name:s[0].shift(),radius:"50%",data:[],type:a};s[0].forEach((f,c)=>{l.data.push({value:s[1][c+1],name:f})}),o.push(l)}if(Cx(e,"ring")){const l={name:s[0].shift(),data:[],radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},type:"pie"};s[0].forEach((f,c)=>{l.data.push({value:s[1][c+1],name:f})}),o.push(l)}return{series:o}},M$e=e=>{const{config:t}=e,{data:r=[]}=t,n={bottom:"10"};if(W3(e)){const i=gs.cloneDeep(r);i[0].shift(),n.data=i[0]}return{legend:n}},D$e=e=>{const t={};return W3(e)?(t.type="value",{yAxis:t}):{}};function $$e(e){const t=gs.cloneDeep(e),r=P$e(t),n=D$e(t),i=I$e(t),a=M$e(t);return{backgroundColor:"#fff",...r,...n,...i,...a,title:{text:t.name,left:"10",top:"10"},grid:{},tooltip:{trigger:"item"}}}const j3=e=>{var n;const{type:t}=e,r=(n=_m[t])==null?void 0:n.type;return!!["DYNAMIC_RANKING_BAR"].includes(r)},N$e=(e,t)=>{const{type:r}=e;return _m[r].type===t},L$e=e=>{const{config:t}=e,{data:r=[]}=t,n={};if(j3(e)){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{xAxis:n}}return{}},F$e=e=>{const{config:t,type:r}=e,{data:n=[]}=t;_m[r].type;const a=[],o=gs.cloneDeep(n);return N$e(e,"DYNAMIC_RANKING_BAR")&&(o[0].shift(),o[0].forEach((l,u)=>{const f={name:l,type:"bar",data:[]};for(let c=1;c<o.length;c++){const h=o[c];f.data.push(+h[u+1])}a.push(f)})),{series:a}},H$e=e=>{const{config:t}=e,{data:r=[]}=t,n={bottom:"10"};if(j3(e)){const i=gs.cloneDeep(r);i[0].shift(),n.data=i[0]}return{legend:n}},B$e=e=>{const t={};return j3(e)?(t.type="value",{yAxis:t}):{}};function V$e(e){const t=gs.cloneDeep(e),r=L$e(t),n=B$e(t),i=F$e(t),a=H$e(t),o={backgroundColor:"#fff",...r,...n,...i,...a,title:{text:t.name,left:"10",top:"10"},grid:{},tooltip:{trigger:"item"}};return console.log("option: ",o),o}const W$e={class:"preview-block"},j$e={class:"v-chart-box"},U$e=Fu({__name:"previewBlock",props:{chart:{type:Object,default:()=>({})}},setup(e){const t=e;hc([bDe,QIe,s2e,EMe,zMe,GDe,jDe,o$e]),D1e(C$e,"light");const r=Jp(null),n=el(()=>t.chart.id?~t.chart.type.indexOf(R1e)?V$e(t.chart):$$e(t.chart):{}),i=a=>{const o=document.createElement("a");o.download=t.chart.name+".png",o.href=a,document.body.appendChild(o),o.click(),o.remove()};return LS.on("handleChart",a=>{var o;i((o=r.value)==null?void 0:o.getDataURL("awImage"))}),(a,o)=>(ii(),ai("div",W$e,[kr("div",j$e,[Io(Mo(x$e),{ref_key:"chartRef",ref:r,class:"chart",autoresize:"",option:Mo(n)},null,8,["option"])])]))}});const z$e=pm(U$e,[["__scopeId","data-v-589a8970"]]);var xx=function(e){return e&&e.Math==Math&&e},zr=xx(typeof globalThis=="object"&&globalThis)||xx(typeof window=="object"&&window)||xx(typeof self=="object"&&self)||xx(typeof Ef=="object"&&Ef)||function(){return this}()||Function("return this")(),pl={},Lt=function(e){try{return!!e()}catch{return!0}},G$e=Lt,Nn=!G$e(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Y$e=Lt,YS=!Y$e(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),K$e=YS,Tx=Function.prototype.call,Gn=K$e?Tx.bind(Tx):function(){return Tx.apply(Tx,arguments)},KS={},kse={}.propertyIsEnumerable,Ase=Object.getOwnPropertyDescriptor,X$e=Ase&&!kse.call({1:2},1);KS.f=X$e?function(t){var r=Ase(this,t);return!!r&&r.enumerable}:kse;var XS=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},Pse=YS,Ise=Function.prototype,gN=Ise.call,q$e=Pse&&Ise.bind.bind(gN,gN),Yt=Pse?q$e:function(e){return function(){return gN.apply(e,arguments)}},Mse=Yt,Z$e=Mse({}.toString),J$e=Mse("".slice),gl=function(e){return J$e(Z$e(e),8,-1)},Q$e=Yt,eNe=Lt,tNe=gl,SM=Object,rNe=Q$e("".split),qS=eNe(function(){return!SM("z").propertyIsEnumerable(0)})?function(e){return tNe(e)=="String"?rNe(e,""):SM(e)}:SM,As=function(e){return e==null},nNe=As,iNe=TypeError,ka=function(e){if(nNe(e))throw iNe("Can't call method on "+e);return e},aNe=qS,oNe=ka,Qa=function(e){return aNe(oNe(e))},yN=typeof document=="object"&&document.all,sNe=typeof yN>"u"&&yN!==void 0,Dse={all:yN,IS_HTMLDDA:sNe},$se=Dse,lNe=$se.all,en=$se.IS_HTMLDDA?function(e){return typeof e=="function"||e===lNe}:function(e){return typeof e=="function"},C7=en,Nse=Dse,uNe=Nse.all,Ln=Nse.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:C7(e)||e===uNe}:function(e){return typeof e=="object"?e!==null:C7(e)},CM=zr,fNe=en,cNe=function(e){return fNe(e)?e:void 0},Vu=function(e,t){return arguments.length<2?cNe(CM[e]):CM[e]&&CM[e][t]},hNe=Yt,_c=hNe({}.isPrototypeOf),Bd=typeof navigator<"u"&&String(navigator.userAgent)||"",Lse=zr,xM=Bd,x7=Lse.process,T7=Lse.Deno,O7=x7&&x7.versions||T7&&T7.version,E7=O7&&O7.v8,hs,CE;E7&&(hs=E7.split("."),CE=hs[0]>0&&hs[0]<4?1:+(hs[0]+hs[1]));!CE&&xM&&(hs=xM.match(/Edge\/(\d+)/),(!hs||hs[1]>=74)&&(hs=xM.match(/Chrome\/(\d+)/),hs&&(CE=+hs[1])));var ZS=CE,R7=ZS,dNe=Lt,Sm=!!Object.getOwnPropertySymbols&&!dNe(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&R7&&R7<41}),vNe=Sm,Fse=vNe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",pNe=Vu,gNe=en,yNe=_c,mNe=Fse,bNe=Object,JS=mNe?function(e){return typeof e=="symbol"}:function(e){var t=pNe("Symbol");return gNe(t)&&yNe(t.prototype,bNe(e))},wNe=String,Cm=function(e){try{return wNe(e)}catch{return"Object"}},_Ne=en,SNe=Cm,CNe=TypeError,Vd=function(e){if(_Ne(e))return e;throw CNe(SNe(e)+" is not a function")},xNe=Vd,TNe=As,Wd=function(e,t){var r=e[t];return TNe(r)?void 0:xNe(r)},TM=Gn,OM=en,EM=Ln,ONe=TypeError,Hse=function(e,t){var r,n;if(t==="string"&&OM(r=e.toString)&&!EM(n=TM(r,e))||OM(r=e.valueOf)&&!EM(n=TM(r,e))||t!=="string"&&OM(r=e.toString)&&!EM(n=TM(r,e)))return n;throw ONe("Can't convert object to primitive value")},dc={},ENe={get exports(){return dc},set exports(e){dc=e}},RNe=!1,k7=zr,kNe=Object.defineProperty,U3=function(e,t){try{kNe(k7,e,{value:t,configurable:!0,writable:!0})}catch{k7[e]=t}return t},ANe=zr,PNe=U3,A7="__core-js_shared__",INe=ANe[A7]||PNe(A7,{}),z3=INe,P7=z3;(ENe.exports=function(e,t){return P7[e]||(P7[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var MNe=ka,DNe=Object,Aa=function(e){return DNe(MNe(e))},$Ne=Yt,NNe=Aa,LNe=$Ne({}.hasOwnProperty),mn=Object.hasOwn||function(t,r){return LNe(NNe(t),r)},FNe=Yt,HNe=0,BNe=Math.random(),VNe=FNe(1 .toString),Rk=function(e){return"Symbol("+(e===void 0?"":e)+")_"+VNe(++HNe+BNe,36)},WNe=zr,jNe=dc,I7=mn,UNe=Rk,zNe=Sm,GNe=Fse,Cp=WNe.Symbol,RM=jNe("wks"),YNe=GNe?Cp.for||Cp:Cp&&Cp.withoutSetter||UNe,Xr=function(e){return I7(RM,e)||(RM[e]=zNe&&I7(Cp,e)?Cp[e]:YNe("Symbol."+e)),RM[e]},KNe=Gn,M7=Ln,D7=JS,XNe=Wd,qNe=Hse,ZNe=Xr,JNe=TypeError,QNe=ZNe("toPrimitive"),Bse=function(e,t){if(!M7(e)||D7(e))return e;var r=XNe(e,QNe),n;if(r){if(t===void 0&&(t="default"),n=KNe(r,e,t),!M7(n)||D7(n))return n;throw JNe("Can't convert object to primitive value")}return t===void 0&&(t="number"),qNe(e,t)},eLe=Bse,tLe=JS,kk=function(e){var t=eLe(e,"string");return tLe(t)?t:t+""},rLe=zr,$7=Ln,mN=rLe.document,nLe=$7(mN)&&$7(mN.createElement),Ak=function(e){return nLe?mN.createElement(e):{}},iLe=Nn,aLe=Lt,oLe=Ak,Vse=!iLe&&!aLe(function(){return Object.defineProperty(oLe("div"),"a",{get:function(){return 7}}).a!=7}),sLe=Nn,lLe=Gn,uLe=KS,fLe=XS,cLe=Qa,hLe=kk,dLe=mn,vLe=Vse,N7=Object.getOwnPropertyDescriptor;pl.f=sLe?N7:function(t,r){if(t=cLe(t),r=hLe(r),vLe)try{return N7(t,r)}catch{}if(dLe(t,r))return fLe(!lLe(uLe.f,t,r),t[r])};var la={},pLe=Nn,gLe=Lt,Wse=pLe&&gLe(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),yLe=Ln,mLe=String,bLe=TypeError,Tn=function(e){if(yLe(e))return e;throw bLe(mLe(e)+" is not an object")},wLe=Nn,_Le=Vse,SLe=Wse,Ox=Tn,L7=kk,CLe=TypeError,kM=Object.defineProperty,xLe=Object.getOwnPropertyDescriptor,AM="enumerable",PM="configurable",IM="writable";la.f=wLe?SLe?function(t,r,n){if(Ox(t),r=L7(r),Ox(n),typeof t=="function"&&r==="prototype"&&"value"in n&&IM in n&&!n[IM]){var i=xLe(t,r);i&&i[IM]&&(t[r]=n.value,n={configurable:PM in n?n[PM]:i[PM],enumerable:AM in n?n[AM]:i[AM],writable:!1})}return kM(t,r,n)}:kM:function(t,r,n){if(Ox(t),r=L7(r),Ox(n),_Le)try{return kM(t,r,n)}catch{}if("get"in n||"set"in n)throw CLe("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var TLe=Nn,OLe=la,ELe=XS,jd=TLe?function(e,t,r){return OLe.f(e,t,ELe(1,r))}:function(e,t,r){return e[t]=r,e},xE={},RLe={get exports(){return xE},set exports(e){xE=e}},bN=Nn,kLe=mn,jse=Function.prototype,ALe=bN&&Object.getOwnPropertyDescriptor,G3=kLe(jse,"name"),PLe=G3&&function(){}.name==="something",ILe=G3&&(!bN||bN&&ALe(jse,"name").configurable),QS={EXISTS:G3,PROPER:PLe,CONFIGURABLE:ILe},MLe=Yt,DLe=en,wN=z3,$Le=MLe(Function.toString);DLe(wN.inspectSource)||(wN.inspectSource=function(e){return $Le(e)});var Use=wN.inspectSource,NLe=zr,LLe=en,F7=NLe.WeakMap,zse=LLe(F7)&&/native code/.test(String(F7)),FLe=dc,HLe=Rk,H7=FLe("keys"),Pk=function(e){return H7[e]||(H7[e]=HLe(e))},e1={},BLe=zse,Gse=zr,VLe=Ln,WLe=jd,MM=mn,DM=z3,jLe=Pk,ULe=e1,B7="Object already initialized",_N=Gse.TypeError,zLe=Gse.WeakMap,TE,Cw,OE,GLe=function(e){return OE(e)?Cw(e):TE(e,{})},YLe=function(e){return function(t){var r;if(!VLe(t)||(r=Cw(t)).type!==e)throw _N("Incompatible receiver, "+e+" required");return r}};if(BLe||DM.state){var Hs=DM.state||(DM.state=new zLe);Hs.get=Hs.get,Hs.has=Hs.has,Hs.set=Hs.set,TE=function(e,t){if(Hs.has(e))throw _N(B7);return t.facade=e,Hs.set(e,t),t},Cw=function(e){return Hs.get(e)||{}},OE=function(e){return Hs.has(e)}}else{var Dv=jLe("state");ULe[Dv]=!0,TE=function(e,t){if(MM(e,Dv))throw _N(B7);return t.facade=e,WLe(e,Dv,t),t},Cw=function(e){return MM(e,Dv)?e[Dv]:{}},OE=function(e){return MM(e,Dv)}}var Wu={set:TE,get:Cw,has:OE,enforce:GLe,getterFor:YLe},Y3=Yt,KLe=Lt,XLe=en,Ex=mn,SN=Nn,qLe=QS.CONFIGURABLE,ZLe=Use,Yse=Wu,JLe=Yse.enforce,QLe=Yse.get,V7=String,rO=Object.defineProperty,eFe=Y3("".slice),tFe=Y3("".replace),rFe=Y3([].join),nFe=SN&&!KLe(function(){return rO(function(){},"length",{value:8}).length!==8}),iFe=String(String).split("String"),aFe=RLe.exports=function(e,t,r){eFe(V7(t),0,7)==="Symbol("&&(t="["+tFe(V7(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Ex(e,"name")||qLe&&e.name!==t)&&(SN?rO(e,"name",{value:t,configurable:!0}):e.name=t),nFe&&r&&Ex(r,"arity")&&e.length!==r.arity&&rO(e,"length",{value:r.arity});try{r&&Ex(r,"constructor")&&r.constructor?SN&&rO(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=JLe(e);return Ex(n,"source")||(n.source=rFe(iFe,typeof t=="string"?t:"")),e};Function.prototype.toString=aFe(function(){return XLe(this)&&QLe(this).source||ZLe(this)},"toString");var oFe=en,sFe=la,lFe=xE,uFe=U3,Vo=function(e,t,r,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:t;if(oFe(r)&&lFe(r,a,n),n.global)i?e[t]=r:uFe(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:sFe.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Ud={},fFe=Math.ceil,cFe=Math.floor,hFe=Math.trunc||function(t){var r=+t;return(r>0?cFe:fFe)(r)},dFe=hFe,Sc=function(e){var t=+e;return t!==t||t===0?0:dFe(t)},vFe=Sc,pFe=Math.max,gFe=Math.min,t1=function(e,t){var r=vFe(e);return r<0?pFe(r+t,0):gFe(r,t)},yFe=Sc,mFe=Math.min,zd=function(e){return e>0?mFe(yFe(e),9007199254740991):0},bFe=zd,Wo=function(e){return bFe(e.length)},wFe=Qa,_Fe=t1,SFe=Wo,W7=function(e){return function(t,r,n){var i=wFe(t),a=SFe(i),o=_Fe(n,a),s;if(e&&r!=r){for(;a>o;)if(s=i[o++],s!=s)return!0}else for(;a>o;o++)if((e||o in i)&&i[o]===r)return e||o||0;return!e&&-1}},K3={includes:W7(!0),indexOf:W7(!1)},CFe=Yt,$M=mn,xFe=Qa,TFe=K3.indexOf,OFe=e1,j7=CFe([].push),Kse=function(e,t){var r=xFe(e),n=0,i=[],a;for(a in r)!$M(OFe,a)&&$M(r,a)&&j7(i,a);for(;t.length>n;)$M(r,a=t[n++])&&(~TFe(i,a)||j7(i,a));return i},X3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],EFe=Kse,RFe=X3,kFe=RFe.concat("length","prototype");Ud.f=Object.getOwnPropertyNames||function(t){return EFe(t,kFe)};var r1={};r1.f=Object.getOwnPropertySymbols;var AFe=Vu,PFe=Yt,IFe=Ud,MFe=r1,DFe=Tn,$Fe=PFe([].concat),Xse=AFe("Reflect","ownKeys")||function(t){var r=IFe.f(DFe(t)),n=MFe.f;return n?$Fe(r,n(t)):r},U7=mn,NFe=Xse,LFe=pl,FFe=la,qse=function(e,t,r){for(var n=NFe(t),i=FFe.f,a=LFe.f,o=0;o<n.length;o++){var s=n[o];!U7(e,s)&&!(r&&U7(r,s))&&i(e,s,a(t,s))}},HFe=Lt,BFe=en,VFe=/#|\.prototype\./,n1=function(e,t){var r=jFe[WFe(e)];return r==zFe?!0:r==UFe?!1:BFe(t)?HFe(t):!!t},WFe=n1.normalize=function(e){return String(e).replace(VFe,".").toLowerCase()},jFe=n1.data={},UFe=n1.NATIVE="N",zFe=n1.POLYFILL="P",Ik=n1,NM=zr,GFe=pl.f,YFe=jd,KFe=Vo,XFe=U3,qFe=qse,ZFe=Ik,Ot=function(e,t){var r=e.target,n=e.global,i=e.stat,a,o,s,l,u,f;if(n?o=NM:i?o=NM[r]||XFe(r,{}):o=(NM[r]||{}).prototype,o)for(s in t){if(u=t[s],e.dontCallGetSet?(f=GFe(o,s),l=f&&f.value):l=o[s],a=ZFe(n?s:r+(i?".":"#")+s,e.forced),!a&&l!==void 0){if(typeof u==typeof l)continue;qFe(u,l)}(e.sham||l&&l.sham)&&YFe(u,"sham",!0),KFe(o,s,u,e)}},JFe=Xr,QFe=JFe("toStringTag"),Zse={};Zse[QFe]="z";var q3=String(Zse)==="[object z]",eHe=q3,tHe=en,nO=gl,rHe=Xr,nHe=rHe("toStringTag"),iHe=Object,aHe=nO(function(){return arguments}())=="Arguments",oHe=function(e,t){try{return e[t]}catch{}},Mk=eHe?nO:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=oHe(t=iHe(e),nHe))=="string"?r:aHe?nO(t):(n=nO(t))=="Object"&&tHe(t.callee)?"Arguments":n},sHe=Mk,lHe=String,Fn=function(e){if(sHe(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return lHe(e)},Z3={},uHe=Kse,fHe=X3,i1=Object.keys||function(t){return uHe(t,fHe)},cHe=Nn,hHe=Wse,dHe=la,vHe=Tn,pHe=Qa,gHe=i1;Z3.f=cHe&&!hHe?Object.defineProperties:function(t,r){vHe(t);for(var n=pHe(r),i=gHe(r),a=i.length,o=0,s;a>o;)dHe.f(t,s=i[o++],n[s]);return t};var yHe=Vu,Jse=yHe("document","documentElement"),mHe=Tn,bHe=Z3,z7=X3,wHe=e1,_He=Jse,SHe=Ak,CHe=Pk,G7=">",Y7="<",CN="prototype",xN="script",Qse=CHe("IE_PROTO"),LM=function(){},ele=function(e){return Y7+xN+G7+e+Y7+"/"+xN+G7},K7=function(e){e.write(ele("")),e.close();var t=e.parentWindow.Object;return e=null,t},xHe=function(){var e=SHe("iframe"),t="java"+xN+":",r;return e.style.display="none",_He.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(ele("document.F=Object")),r.close(),r.F},Rx,iO=function(){try{Rx=new ActiveXObject("htmlfile")}catch{}iO=typeof document<"u"?document.domain&&Rx?K7(Rx):xHe():K7(Rx);for(var e=z7.length;e--;)delete iO[CN][z7[e]];return iO()};wHe[Qse]=!0;var xm=Object.create||function(t,r){var n;return t!==null?(LM[CN]=mHe(t),n=new LM,LM[CN]=null,n[Qse]=t):n=iO(),r===void 0?n:bHe.f(n,r)},Dk={},THe=kk,OHe=la,EHe=XS,Tm=function(e,t,r){var n=THe(t);n in e?OHe.f(e,n,EHe(0,r)):e[n]=r},X7=t1,RHe=Wo,kHe=Tm,AHe=Array,PHe=Math.max,J3=function(e,t,r){for(var n=RHe(e),i=X7(t,n),a=X7(r===void 0?n:r,n),o=AHe(PHe(a-i,0)),s=0;i<a;i++,s++)kHe(o,s,e[i]);return o.length=s,o},IHe=gl,MHe=Qa,tle=Ud.f,DHe=J3,rle=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],$He=function(e){try{return tle(e)}catch{return DHe(rle)}};Dk.f=function(t){return rle&&IHe(t)=="Window"?$He(t):tle(MHe(t))};var q7=xE,NHe=la,a1=function(e,t,r){return r.get&&q7(r.get,t,{getter:!0}),r.set&&q7(r.set,t,{setter:!0}),NHe.f(e,t,r)},Q3={},LHe=Xr;Q3.f=LHe;var FHe=zr,nle=FHe,Z7=nle,HHe=mn,BHe=Q3,VHe=la.f,e4=function(e){var t=Z7.Symbol||(Z7.Symbol={});HHe(t,e)||VHe(t,e,{value:BHe.f(e)})},WHe=Gn,jHe=Vu,UHe=Xr,zHe=Vo,ile=function(){var e=jHe("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=UHe("toPrimitive");t&&!t[n]&&zHe(t,n,function(i){return WHe(r,this)},{arity:1})},GHe=la.f,YHe=mn,KHe=Xr,J7=KHe("toStringTag"),$k=function(e,t,r){e&&!r&&(e=e.prototype),e&&!YHe(e,J7)&&GHe(e,J7,{configurable:!0,value:t})},XHe=gl,qHe=Yt,o1=function(e){if(XHe(e)==="Function")return qHe(e)},Q7=o1,ZHe=Vd,JHe=YS,QHe=Q7(Q7.bind),s1=function(e,t){return ZHe(e),t===void 0?e:JHe?QHe(e,t):function(){return e.apply(t,arguments)}},eBe=gl,Om=Array.isArray||function(t){return eBe(t)=="Array"},tBe=Yt,rBe=Lt,ale=en,nBe=Mk,iBe=Vu,aBe=Use,ole=function(){},oBe=[],sle=iBe("Reflect","construct"),t4=/^\s*(?:class|function)\b/,sBe=tBe(t4.exec),lBe=!t4.exec(ole),x0=function(t){if(!ale(t))return!1;try{return sle(ole,oBe,t),!0}catch{return!1}},lle=function(t){if(!ale(t))return!1;switch(nBe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return lBe||!!sBe(t4,aBe(t))}catch{return!0}};lle.sham=!0;var Nk=!sle||rBe(function(){var e;return x0(x0.call)||!x0(Object)||!x0(function(){e=!0})||e})?lle:x0,e9=Om,uBe=Nk,fBe=Ln,cBe=Xr,hBe=cBe("species"),t9=Array,dBe=function(e){var t;return e9(e)&&(t=e.constructor,uBe(t)&&(t===t9||e9(t.prototype))?t=void 0:fBe(t)&&(t=t[hBe],t===null&&(t=void 0))),t===void 0?t9:t},vBe=dBe,r4=function(e,t){return new(vBe(e))(t===0?0:t)},pBe=s1,gBe=Yt,yBe=qS,mBe=Aa,bBe=Wo,wBe=r4,r9=gBe([].push),vf=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,a=e==6,o=e==7,s=e==5||a;return function(l,u,f,c){for(var h=mBe(l),d=yBe(h),v=pBe(u,f),g=bBe(d),y=0,b=c||wBe,w=t?b(l,g):r||o?b(l,0):void 0,_,x;g>y;y++)if((s||y in d)&&(_=d[y],x=v(_,y,h),e))if(t)w[y]=x;else if(x)switch(e){case 3:return!0;case 5:return _;case 6:return y;case 2:r9(w,_)}else switch(e){case 4:return!1;case 7:r9(w,_)}return a?-1:n||i?i:w}},Gd={forEach:vf(0),map:vf(1),filter:vf(2),some:vf(3),every:vf(4),find:vf(5),findIndex:vf(6),filterReject:vf(7)},Lk=Ot,n4=zr,i4=Gn,_Be=Yt,ag=Nn,og=Sm,SBe=Lt,li=mn,CBe=_c,TN=Tn,Fk=Qa,a4=kk,xBe=Fn,ON=XS,xw=xm,ule=i1,TBe=Ud,fle=Dk,OBe=r1,cle=pl,hle=la,EBe=Z3,dle=KS,FM=Vo,RBe=a1,o4=dc,kBe=Pk,vle=e1,n9=Rk,ABe=Xr,PBe=Q3,IBe=e4,MBe=ile,DBe=$k,ple=Wu,Hk=Gd.forEach,Ca=kBe("hidden"),Bk="Symbol",Tw="prototype",$Be=ple.set,i9=ple.getterFor(Bk),Do=Object[Tw],fd=n4.Symbol,ub=fd&&fd[Tw],NBe=n4.TypeError,HM=n4.QObject,gle=cle.f,Th=hle.f,yle=fle.f,LBe=dle.f,mle=_Be([].push),Iu=o4("symbols"),l1=o4("op-symbols"),FBe=o4("wks"),EN=!HM||!HM[Tw]||!HM[Tw].findChild,RN=ag&&SBe(function(){return xw(Th({},"a",{get:function(){return Th(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=gle(Do,t);n&&delete Do[t],Th(e,t,r),n&&e!==Do&&Th(Do,t,n)}:Th,BM=function(e,t){var r=Iu[e]=xw(ub);return $Be(r,{type:Bk,tag:e,description:t}),ag||(r.description=t),r},Vk=function(t,r,n){t===Do&&Vk(l1,r,n),TN(t);var i=a4(r);return TN(n),li(Iu,i)?(n.enumerable?(li(t,Ca)&&t[Ca][i]&&(t[Ca][i]=!1),n=xw(n,{enumerable:ON(0,!1)})):(li(t,Ca)||Th(t,Ca,ON(1,{})),t[Ca][i]=!0),RN(t,i,n)):Th(t,i,n)},s4=function(t,r){TN(t);var n=Fk(r),i=ule(n).concat(_le(n));return Hk(i,function(a){(!ag||i4(kN,n,a))&&Vk(t,a,n[a])}),t},HBe=function(t,r){return r===void 0?xw(t):s4(xw(t),r)},kN=function(t){var r=a4(t),n=i4(LBe,this,r);return this===Do&&li(Iu,r)&&!li(l1,r)?!1:n||!li(this,r)||!li(Iu,r)||li(this,Ca)&&this[Ca][r]?n:!0},ble=function(t,r){var n=Fk(t),i=a4(r);if(!(n===Do&&li(Iu,i)&&!li(l1,i))){var a=gle(n,i);return a&&li(Iu,i)&&!(li(n,Ca)&&n[Ca][i])&&(a.enumerable=!0),a}},wle=function(t){var r=yle(Fk(t)),n=[];return Hk(r,function(i){!li(Iu,i)&&!li(vle,i)&&mle(n,i)}),n},_le=function(e){var t=e===Do,r=yle(t?l1:Fk(e)),n=[];return Hk(r,function(i){li(Iu,i)&&(!t||li(Do,i))&&mle(n,Iu[i])}),n};og||(fd=function(){if(CBe(ub,this))throw NBe("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:xBe(arguments[0]),r=n9(t),n=function(i){this===Do&&i4(n,l1,i),li(this,Ca)&&li(this[Ca],r)&&(this[Ca][r]=!1),RN(this,r,ON(1,i))};return ag&&EN&&RN(Do,r,{configurable:!0,set:n}),BM(r,t)},ub=fd[Tw],FM(ub,"toString",function(){return i9(this).tag}),FM(fd,"withoutSetter",function(e){return BM(n9(e),e)}),dle.f=kN,hle.f=Vk,EBe.f=s4,cle.f=ble,TBe.f=fle.f=wle,OBe.f=_le,PBe.f=function(e){return BM(ABe(e),e)},ag&&(RBe(ub,"description",{configurable:!0,get:function(){return i9(this).description}}),FM(Do,"propertyIsEnumerable",kN,{unsafe:!0})));Lk({global:!0,constructor:!0,wrap:!0,forced:!og,sham:!og},{Symbol:fd});Hk(ule(FBe),function(e){IBe(e)});Lk({target:Bk,stat:!0,forced:!og},{useSetter:function(){EN=!0},useSimple:function(){EN=!1}});Lk({target:"Object",stat:!0,forced:!og,sham:!ag},{create:HBe,defineProperty:Vk,defineProperties:s4,getOwnPropertyDescriptor:ble});Lk({target:"Object",stat:!0,forced:!og},{getOwnPropertyNames:wle});MBe();DBe(fd,Bk);vle[Ca]=!0;var BBe=Sm,Sle=BBe&&!!Symbol.for&&!!Symbol.keyFor,VBe=Ot,WBe=Vu,jBe=mn,UBe=Fn,Cle=dc,zBe=Sle,VM=Cle("string-to-symbol-registry"),GBe=Cle("symbol-to-string-registry");VBe({target:"Symbol",stat:!0,forced:!zBe},{for:function(e){var t=UBe(e);if(jBe(VM,t))return VM[t];var r=WBe("Symbol")(t);return VM[t]=r,GBe[r]=t,r}});var YBe=Ot,KBe=mn,XBe=JS,qBe=Cm,ZBe=dc,JBe=Sle,a9=ZBe("symbol-to-string-registry");YBe({target:"Symbol",stat:!0,forced:!JBe},{keyFor:function(t){if(!XBe(t))throw TypeError(qBe(t)+" is not a symbol");if(KBe(a9,t))return a9[t]}});var QBe=YS,xle=Function.prototype,o9=xle.apply,s9=xle.call,Yd=typeof Reflect=="object"&&Reflect.apply||(QBe?s9.bind(o9):function(){return s9.apply(o9,arguments)}),e3e=Yt,u1=e3e([].slice),t3e=Yt,l9=Om,r3e=en,u9=gl,n3e=Fn,f9=t3e([].push),i3e=function(e){if(r3e(e))return e;if(l9(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?f9(r,i):(typeof i=="number"||u9(i)=="Number"||u9(i)=="String")&&f9(r,n3e(i))}var a=r.length,o=!0;return function(s,l){if(o)return o=!1,l;if(l9(this))return l;for(var u=0;u<a;u++)if(r[u]===s)return l}}},a3e=Ot,Tle=Vu,Ole=Yd,o3e=Gn,f1=Yt,Ele=Lt,c9=en,h9=JS,Rle=u1,s3e=i3e,l3e=Sm,u3e=String,Uf=Tle("JSON","stringify"),kx=f1(/./.exec),d9=f1("".charAt),f3e=f1("".charCodeAt),c3e=f1("".replace),h3e=f1(1 .toString),d3e=/[\uD800-\uDFFF]/g,v9=/^[\uD800-\uDBFF]$/,p9=/^[\uDC00-\uDFFF]$/,g9=!l3e||Ele(function(){var e=Tle("Symbol")();return Uf([e])!="[null]"||Uf({a:e})!="{}"||Uf(Object(e))!="{}"}),y9=Ele(function(){return Uf("\uDF06\uD834")!=='"\\udf06\\ud834"'||Uf("\uDEAD")!=='"\\udead"'}),v3e=function(e,t){var r=Rle(arguments),n=s3e(t);if(!(!c9(n)&&(e===void 0||h9(e))))return r[1]=function(i,a){if(c9(n)&&(a=o3e(n,this,u3e(i),a)),!h9(a))return a},Ole(Uf,null,r)},p3e=function(e,t,r){var n=d9(r,t-1),i=d9(r,t+1);return kx(v9,e)&&!kx(p9,i)||kx(p9,e)&&!kx(v9,n)?"\\u"+h3e(f3e(e,0),16):e};Uf&&a3e({target:"JSON",stat:!0,arity:3,forced:g9||y9},{stringify:function(t,r,n){var i=Rle(arguments),a=Ole(g9?v3e:Uf,null,i);return y9&&typeof a=="string"?c3e(a,d3e,p3e):a}});var g3e=Ot,y3e=Sm,m3e=Lt,kle=r1,b3e=Aa,w3e=!y3e||m3e(function(){kle.f(1)});g3e({target:"Object",stat:!0,forced:w3e},{getOwnPropertySymbols:function(t){var r=kle.f;return r?r(b3e(t)):[]}});var _3e=Ot,S3e=Nn,C3e=zr,Ax=Yt,x3e=mn,T3e=en,O3e=_c,E3e=Fn,R3e=a1,k3e=qse,Wl=C3e.Symbol,oh=Wl&&Wl.prototype;if(S3e&&T3e(Wl)&&(!("description"in oh)||Wl().description!==void 0)){var m9={},Px=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:E3e(arguments[0]),r=O3e(oh,this)?new Wl(t):t===void 0?Wl():Wl(t);return t===""&&(m9[r]=!0),r};k3e(Px,Wl),Px.prototype=oh,oh.constructor=Px;var A3e=String(Wl("test"))=="Symbol(test)",P3e=Ax(oh.valueOf),I3e=Ax(oh.toString),M3e=/^Symbol\((.*)\)[^)]+$/,D3e=Ax("".replace),$3e=Ax("".slice);R3e(oh,"description",{configurable:!0,get:function(){var t=P3e(this);if(x3e(m9,t))return"";var r=I3e(t),n=A3e?$3e(r,7,-1):D3e(r,M3e,"$1");return n===""?void 0:n}}),_3e({global:!0,constructor:!0,forced:!0},{Symbol:Px})}var N3e=e4;N3e("iterator");var L3e=Nn,F3e=QS.EXISTS,Ale=Yt,H3e=a1,Ple=Function.prototype,B3e=Ale(Ple.toString),Ile=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,V3e=Ale(Ile.exec),W3e="name";L3e&&!F3e&&H3e(Ple,W3e,{configurable:!0,get:function(){try{return V3e(Ile,B3e(this))[1]}catch{return""}}});var j3e=Lt,l4=!j3e(function(){return Object.isExtensible(Object.preventExtensions({}))}),bd={},U3e={get exports(){return bd},set exports(e){bd=e}},z3e=Lt,G3e=z3e(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),Y3e=Lt,K3e=Ln,X3e=gl,b9=G3e,aO=Object.isExtensible,q3e=Y3e(function(){aO(1)}),Z3e=q3e||b9?function(t){return!K3e(t)||b9&&X3e(t)=="ArrayBuffer"?!1:aO?aO(t):!0}:aO,J3e=Ot,Q3e=Yt,e4e=e1,t4e=Ln,u4=mn,r4e=la.f,w9=Ud,n4e=Dk,f4=Z3e,i4e=Rk,a4e=l4,Mle=!1,Mu=i4e("meta"),o4e=0,c4=function(e){r4e(e,Mu,{value:{objectID:"O"+o4e++,weakData:{}}})},s4e=function(e,t){if(!t4e(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!u4(e,Mu)){if(!f4(e))return"F";if(!t)return"E";c4(e)}return e[Mu].objectID},l4e=function(e,t){if(!u4(e,Mu)){if(!f4(e))return!0;if(!t)return!1;c4(e)}return e[Mu].weakData},u4e=function(e){return a4e&&Mle&&f4(e)&&!u4(e,Mu)&&c4(e),e},f4e=function(){c4e.enable=function(){},Mle=!0;var e=w9.f,t=Q3e([].splice),r={};r[Mu]=1,e(r).length&&(w9.f=function(n){for(var i=e(n),a=0,o=i.length;a<o;a++)if(i[a]===Mu){t(i,a,1);break}return i},J3e({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:n4e.f}))},c4e=U3e.exports={enable:f4e,fastKey:s4e,getWeakData:l4e,onFreeze:u4e};e4e[Mu]=!0;var h4e=Ot,d4e=l4,v4e=Lt,p4e=Ln,g4e=bd.onFreeze,AN=Object.freeze,y4e=v4e(function(){AN(1)});h4e({target:"Object",stat:!0,forced:y4e,sham:!d4e},{freeze:function(t){return AN&&p4e(t)?AN(g4e(t)):t}});var m4e=Xr,b4e=xm,w4e=la.f,PN=m4e("unscopables"),IN=Array.prototype;IN[PN]==null&&w4e(IN,PN,{configurable:!0,value:b4e(null)});var c1=function(e){IN[PN][e]=!0},h1={},_4e=Lt,Dle=!_4e(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),S4e=mn,C4e=en,x4e=Aa,T4e=Pk,O4e=Dle,_9=T4e("IE_PROTO"),MN=Object,E4e=MN.prototype,Wk=O4e?MN.getPrototypeOf:function(e){var t=x4e(e);if(S4e(t,_9))return t[_9];var r=t.constructor;return C4e(r)&&t instanceof r?r.prototype:t instanceof MN?E4e:null},R4e=Lt,k4e=en,A4e=Ln,S9=Wk,P4e=Vo,I4e=Xr,DN=I4e("iterator"),$le=!1,wd,WM,jM;[].keys&&(jM=[].keys(),"next"in jM?(WM=S9(S9(jM)),WM!==Object.prototype&&(wd=WM)):$le=!0);var M4e=!A4e(wd)||R4e(function(){var e={};return wd[DN].call(e)!==e});M4e&&(wd={});k4e(wd[DN])||P4e(wd,DN,function(){return this});var Nle={IteratorPrototype:wd,BUGGY_SAFARI_ITERATORS:$le},D4e=Nle.IteratorPrototype,$4e=xm,N4e=XS,L4e=$k,F4e=h1,H4e=function(){return this},B4e=function(e,t,r,n){var i=t+" Iterator";return e.prototype=$4e(D4e,{next:N4e(+!n,r)}),L4e(e,i,!1),F4e[i]=H4e,e},V4e=Yt,W4e=Vd,j4e=function(e,t,r){try{return V4e(W4e(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},U4e=en,z4e=String,G4e=TypeError,Y4e=function(e){if(typeof e=="object"||U4e(e))return e;throw G4e("Can't set "+z4e(e)+" as a prototype")},K4e=j4e,X4e=Tn,q4e=Y4e,h4=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=K4e(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,a){return X4e(i),q4e(a),e?r(i,a):i.__proto__=a,i}}():void 0),Z4e=Ot,J4e=Gn,Lle=QS,Q4e=en,eVe=B4e,C9=Wk,x9=h4,tVe=$k,rVe=jd,UM=Vo,nVe=Xr,iVe=h1,Fle=Nle,aVe=Lle.PROPER,oVe=Lle.CONFIGURABLE,T9=Fle.IteratorPrototype,Ix=Fle.BUGGY_SAFARI_ITERATORS,T0=nVe("iterator"),O9="keys",O0="values",E9="entries",sVe=function(){return this},d4=function(e,t,r,n,i,a,o){eVe(r,t,n);var s=function(b){if(b===i&&h)return h;if(!Ix&&b in f)return f[b];switch(b){case O9:return function(){return new r(this,b)};case O0:return function(){return new r(this,b)};case E9:return function(){return new r(this,b)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,f=e.prototype,c=f[T0]||f["@@iterator"]||i&&f[i],h=!Ix&&c||s(i),d=t=="Array"&&f.entries||c,v,g,y;if(d&&(v=C9(d.call(new e)),v!==Object.prototype&&v.next&&(C9(v)!==T9&&(x9?x9(v,T9):Q4e(v[T0])||UM(v,T0,sVe)),tVe(v,l,!0))),aVe&&i==O0&&c&&c.name!==O0&&(oVe?rVe(f,"name",O0):(u=!0,h=function(){return J4e(c,this)})),i)if(g={values:s(O0),keys:a?h:s(O9),entries:s(E9)},o)for(y in g)(Ix||u||!(y in f))&&UM(f,y,g[y]);else Z4e({target:t,proto:!0,forced:Ix||u},g);return f[T0]!==h&&UM(f,T0,h,{name:i}),iVe[t]=h,g},v4=function(e,t){return{value:e,done:t}},lVe=Qa,p4=c1,R9=h1,Hle=Wu,uVe=la.f,fVe=d4,Mx=v4,cVe=Nn,Ble="Array Iterator",hVe=Hle.set,dVe=Hle.getterFor(Ble),vVe=fVe(Array,"Array",function(e,t){hVe(this,{type:Ble,target:lVe(e),index:0,kind:t})},function(){var e=dVe(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Mx(void 0,!0)):r=="keys"?Mx(n,!1):r=="values"?Mx(t[n],!1):Mx([n,t[n]],!1)},"values"),k9=R9.Arguments=R9.Array;p4("keys");p4("values");p4("entries");if(cVe&&k9.name!=="values")try{uVe(k9,"name",{value:"values"})}catch{}var pVe=q3,gVe=Mk,yVe=pVe?{}.toString:function(){return"[object "+gVe(this)+"]"},mVe=q3,bVe=Vo,wVe=yVe;mVe||bVe(Object.prototype,"toString",wVe,{unsafe:!0});var _Ve=Xr,SVe=h1,CVe=_Ve("iterator"),xVe=Array.prototype,Vle=function(e){return e!==void 0&&(SVe.Array===e||xVe[CVe]===e)},TVe=Mk,A9=Wd,OVe=As,EVe=h1,RVe=Xr,kVe=RVe("iterator"),g4=function(e){if(!OVe(e))return A9(e,kVe)||A9(e,"@@iterator")||EVe[TVe(e)]},AVe=Gn,PVe=Vd,IVe=Tn,MVe=Cm,DVe=g4,$Ve=TypeError,Wle=function(e,t){var r=arguments.length<2?DVe(e):t;if(PVe(r))return IVe(AVe(r,e));throw $Ve(MVe(e)+" is not iterable")},NVe=Gn,P9=Tn,LVe=Wd,jle=function(e,t,r){var n,i;P9(e);try{if(n=LVe(e,"return"),!n){if(t==="throw")throw r;return r}n=NVe(n,e)}catch(a){i=!0,n=a}if(t==="throw")throw r;if(i)throw n;return P9(n),r},FVe=s1,HVe=Gn,BVe=Tn,VVe=Cm,WVe=Vle,jVe=Wo,I9=_c,UVe=Wle,zVe=g4,M9=jle,GVe=TypeError,oO=function(e,t){this.stopped=e,this.result=t},D9=oO.prototype,y4=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),a=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=FVe(t,n),u,f,c,h,d,v,g,y=function(w){return u&&M9(u,"normal",w),new oO(!0,w)},b=function(w){return i?(BVe(w),s?l(w[0],w[1],y):l(w[0],w[1])):s?l(w,y):l(w)};if(a)u=e.iterator;else if(o)u=e;else{if(f=zVe(e),!f)throw GVe(VVe(e)+" is not iterable");if(WVe(f)){for(c=0,h=jVe(e);h>c;c++)if(d=b(e[c]),d&&I9(D9,d))return d;return new oO(!1)}u=UVe(e,f)}for(v=a?e.next:u.next;!(g=HVe(v,u)).done;){try{d=b(g.value)}catch(w){M9(u,"throw",w)}if(typeof d=="object"&&d&&I9(D9,d))return d}return new oO(!1)},YVe=_c,KVe=TypeError,m4=function(e,t){if(YVe(t,e))return e;throw KVe("Incorrect invocation")},XVe=Xr,Ule=XVe("iterator"),zle=!1;try{var qVe=0,$9={next:function(){return{done:!!qVe++}},return:function(){zle=!0}};$9[Ule]=function(){return this},Array.from($9,function(){throw 2})}catch{}var Gle=function(e,t){if(!t&&!zle)return!1;var r=!1;try{var n={};n[Ule]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},ZVe=en,JVe=Ln,N9=h4,b4=function(e,t,r){var n,i;return N9&&ZVe(n=t.constructor)&&n!==r&&JVe(i=n.prototype)&&i!==r.prototype&&N9(e,i),e},QVe=Ot,eWe=zr,tWe=Yt,L9=Ik,rWe=Vo,nWe=bd,iWe=y4,aWe=m4,oWe=en,sWe=As,zM=Ln,GM=Lt,lWe=Gle,uWe=$k,fWe=b4,jk=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,a=n?"set":"add",o=eWe[e],s=o&&o.prototype,l=o,u={},f=function(b){var w=tWe(s[b]);rWe(s,b,b=="add"?function(x){return w(this,x===0?0:x),this}:b=="delete"?function(_){return i&&!zM(_)?!1:w(this,_===0?0:_)}:b=="get"?function(x){return i&&!zM(x)?void 0:w(this,x===0?0:x)}:b=="has"?function(x){return i&&!zM(x)?!1:w(this,x===0?0:x)}:function(x,T){return w(this,x===0?0:x,T),this})},c=L9(e,!oWe(o)||!(i||s.forEach&&!GM(function(){new o().entries().next()})));if(c)l=r.getConstructor(t,e,n,a),nWe.enable();else if(L9(e,!0)){var h=new l,d=h[a](i?{}:-0,1)!=h,v=GM(function(){h.has(1)}),g=lWe(function(b){new o(b)}),y=!i&&GM(function(){for(var b=new o,w=5;w--;)b[a](w,w);return!b.has(-0)});g||(l=t(function(b,w){aWe(b,s);var _=fWe(new o,b,l);return sWe(w)||iWe(w,_[a],{that:_,AS_ENTRIES:n}),_}),l.prototype=s,s.constructor=l),(v||y)&&(f("delete"),f("has"),n&&f("get")),(y||d)&&f(a),i&&s.clear&&delete s.clear}return u[e]=l,QVe({global:!0,constructor:!0,forced:l!=o},u),uWe(l,e),i||r.setStrong(l,e,n),l},cWe=Vo,w4=function(e,t,r){for(var n in t)cWe(e,n,t[n],r);return e},hWe=Vu,dWe=a1,vWe=Xr,pWe=Nn,F9=vWe("species"),Yle=function(e){var t=hWe(e);pWe&&t&&!t[F9]&&dWe(t,F9,{configurable:!0,get:function(){return this}})},gWe=xm,yWe=a1,H9=w4,mWe=s1,bWe=m4,wWe=As,_We=y4,SWe=d4,Dx=v4,CWe=Yle,E0=Nn,B9=bd.fastKey,Kle=Wu,V9=Kle.set,YM=Kle.getterFor,Xle={getConstructor:function(e,t,r,n){var i=e(function(u,f){bWe(u,a),V9(u,{type:t,index:gWe(null),first:void 0,last:void 0,size:0}),E0||(u.size=0),wWe(f)||_We(f,u[n],{that:u,AS_ENTRIES:r})}),a=i.prototype,o=YM(t),s=function(u,f,c){var h=o(u),d=l(u,f),v,g;return d?d.value=c:(h.last=d={index:g=B9(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),E0?h.size++:u.size++,g!=="F"&&(h.index[g]=d)),u},l=function(u,f){var c=o(u),h=B9(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return H9(a,{clear:function(){for(var f=this,c=o(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,E0?c.size=0:f.size=0},delete:function(u){var f=this,c=o(f),h=l(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),E0?c.size--:f.size--}return!!h},forEach:function(f){for(var c=o(this),h=mWe(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!l(this,f)}}),H9(a,r?{get:function(f){var c=l(this,f);return c&&c.value},set:function(f,c){return s(this,f===0?0:f,c)}}:{add:function(f){return s(this,f=f===0?0:f,f)}}),E0&&yWe(a,"size",{configurable:!0,get:function(){return o(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=YM(t),a=YM(n);SWe(e,t,function(o,s){V9(this,{type:n,target:o,state:i(o),kind:s,last:void 0})},function(){for(var o=a(this),s=o.kind,l=o.last;l&&l.removed;)l=l.previous;return!o.target||!(o.last=l=l?l.next:o.state.first)?(o.target=void 0,Dx(void 0,!0)):s=="keys"?Dx(l.key,!1):s=="values"?Dx(l.value,!1):Dx([l.key,l.value],!1)},r?"entries":"values",!r,!0),CWe(t)}},xWe=jk,TWe=Xle;xWe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},TWe);var _4=Yt,OWe=Sc,EWe=Fn,RWe=ka,kWe=_4("".charAt),W9=_4("".charCodeAt),AWe=_4("".slice),j9=function(e){return function(t,r){var n=EWe(RWe(t)),i=OWe(r),a=n.length,o,s;return i<0||i>=a?e?"":void 0:(o=W9(n,i),o<55296||o>56319||i+1===a||(s=W9(n,i+1))<56320||s>57343?e?kWe(n,i):o:e?AWe(n,i,i+2):(o-55296<<10)+(s-56320)+65536)}},S4={codeAt:j9(!1),charAt:j9(!0)},PWe=S4.charAt,IWe=Fn,qle=Wu,MWe=d4,U9=v4,Zle="String Iterator",DWe=qle.set,$We=qle.getterFor(Zle);MWe(String,"String",function(e){DWe(this,{type:Zle,string:IWe(e),index:0})},function(){var t=$We(this),r=t.string,n=t.index,i;return n>=r.length?U9(void 0,!0):(i=PWe(r,n),t.index+=i.length,U9(i,!1))});var Jle={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},NWe=Ak,KM=NWe("span").classList,z9=KM&&KM.constructor&&KM.constructor.prototype,Qle=z9===Object.prototype?void 0:z9,G9=zr,eue=Jle,LWe=Qle,fb=vVe,XM=jd,tue=Xr,qM=tue("iterator"),Y9=tue("toStringTag"),ZM=fb.values,rue=function(e,t){if(e){if(e[qM]!==ZM)try{XM(e,qM,ZM)}catch{e[qM]=ZM}if(e[Y9]||XM(e,Y9,t),eue[t]){for(var r in fb)if(e[r]!==fb[r])try{XM(e,r,fb[r])}catch{e[r]=fb[r]}}}};for(var JM in eue)rue(G9[JM]&&G9[JM].prototype,JM);rue(LWe,"DOMTokenList");var FWe=Ot,HWe=K3.includes,BWe=Lt,VWe=c1,WWe=BWe(function(){return!Array(1).includes()});FWe({target:"Array",proto:!0,forced:WWe},{includes:function(t){return HWe(this,t,arguments.length>1?arguments[1]:void 0)}});VWe("includes");var K9=Cm,jWe=TypeError,nue=function(e,t){if(!delete e[t])throw jWe("Cannot delete property "+K9(t)+" of "+K9(e))},X9=J3,UWe=Math.floor,$N=function(e,t){var r=e.length,n=UWe(r/2);return r<8?zWe(e,t):GWe(e,$N(X9(e,0,n),t),$N(X9(e,n),t),t)},zWe=function(e,t){for(var r=e.length,n=1,i,a;n<r;){for(a=n,i=e[n];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==n++&&(e[a]=i)}return e},GWe=function(e,t,r,n){for(var i=t.length,a=r.length,o=0,s=0;o<i||s<a;)e[o+s]=o<i&&s<a?n(t[o],r[s])<=0?t[o++]:r[s++]:o<i?t[o++]:r[s++];return e},YWe=$N,KWe=Lt,Em=function(e,t){var r=[][e];return!!r&&KWe(function(){r.call(null,t||function(){return 1},1)})},XWe=Bd,q9=XWe.match(/firefox\/(\d+)/i),qWe=!!q9&&+q9[1],ZWe=Bd,JWe=/MSIE|Trident/.test(ZWe),QWe=Bd,Z9=QWe.match(/AppleWebKit\/(\d+)\./),eje=!!Z9&&+Z9[1],tje=Ot,iue=Yt,rje=Vd,nje=Aa,J9=Wo,ije=nue,Q9=Fn,C4=Lt,aje=YWe,oje=Em,eY=qWe,sje=JWe,tY=ZS,rY=eje,Nf=[],nY=iue(Nf.sort),lje=iue(Nf.push),uje=C4(function(){Nf.sort(void 0)}),fje=C4(function(){Nf.sort(null)}),cje=oje("sort"),aue=!C4(function(){if(tY)return tY<70;if(!(eY&&eY>3)){if(sje)return!0;if(rY)return rY<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)Nf.push({k:r+i,v:n})}for(Nf.sort(function(a,o){return o.v-a.v}),i=0;i<Nf.length;i++)r=Nf[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),hje=uje||!fje||!cje||!aue,dje=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:Q9(t)>Q9(r)?1:-1}};tje({target:"Array",proto:!0,forced:hje},{sort:function(t){t!==void 0&&rje(t);var r=nje(this);if(aue)return t===void 0?nY(r):nY(r,t);var n=[],i=J9(r),a,o;for(o=0;o<i;o++)o in r&&lje(n,r[o]);for(aje(n,dje(t)),a=J9(n),o=0;o<a;)r[o]=n[o++];for(;o<i;)ije(r,o++);return r}});var vje=Nn,pje=Om,gje=TypeError,yje=Object.getOwnPropertyDescriptor,mje=vje&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),bje=mje?function(e,t){if(pje(e)&&!yje(e,"length").writable)throw gje("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},wje=TypeError,_je=9007199254740991,oue=function(e){if(e>_je)throw wje("Maximum allowed index exceeded");return e},Sje=Lt,Cje=Xr,xje=ZS,Tje=Cje("species"),d1=function(e){return xje>=51||!Sje(function(){var t=[],r=t.constructor={};return r[Tje]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Oje=Ot,Eje=Aa,Rje=t1,kje=Sc,Aje=Wo,Pje=bje,Ije=oue,Mje=r4,Dje=Tm,QM=nue,$je=d1,Nje=$je("splice"),Lje=Math.max,Fje=Math.min;Oje({target:"Array",proto:!0,forced:!Nje},{splice:function(t,r){var n=Eje(this),i=Aje(n),a=Rje(t,i),o=arguments.length,s,l,u,f,c,h;for(o===0?s=l=0:o===1?(s=0,l=i-a):(s=o-2,l=Fje(Lje(kje(r),0),i-a)),Ije(i+s-l),u=Mje(n,l),f=0;f<l;f++)c=a+f,c in n&&Dje(u,f,n[c]);if(u.length=l,s<l){for(f=a;f<i-l;f++)c=f+l,h=f+s,c in n?n[h]=n[c]:QM(n,h);for(f=i;f>i-l+s;f--)QM(n,f-1)}else if(s>l)for(f=i-l;f>a;f--)c=f+l-1,h=f+s-1,c in n?n[h]=n[c]:QM(n,h);for(f=0;f<s;f++)n[f+a]=arguments[f+2];return Pje(n,i-l+s),u}});var Hje=Ln,Bje=Math.floor,Vje=Number.isInteger||function(t){return!Hje(t)&&isFinite(t)&&Bje(t)===t},Wje=Ot,jje=Vje;Wje({target:"Number",stat:!0},{isInteger:jje});var Uje=Yt,sue=Uje(1 .valueOf),lue=`	
\v\f\r                　\u2028\u2029\uFEFF`,zje=Yt,Gje=ka,Yje=Fn,NN=lue,iY=zje("".replace),Kje=RegExp("^["+NN+"]+"),Xje=RegExp("(^|[^"+NN+"])["+NN+"]+$"),e2=function(e){return function(t){var r=Yje(Gje(t));return e&1&&(r=iY(r,Kje,"")),e&2&&(r=iY(r,Xje,"$1")),r}},uue={start:e2(1),end:e2(2),trim:e2(3)},qje=Ot,fue=RNe,Zje=Nn,cue=zr,hue=nle,due=Yt,Jje=Ik,aY=mn,Qje=b4,eUe=_c,tUe=JS,vue=Bse,rUe=Lt,nUe=Ud.f,iUe=pl.f,aUe=la.f,oUe=sue,sUe=uue.trim,Uk="Number",Dp=cue[Uk];hue[Uk];var x4=Dp.prototype,lUe=cue.TypeError,uUe=due("".slice),$x=due("".charCodeAt),fUe=function(e){var t=vue(e,"number");return typeof t=="bigint"?t:cUe(t)},cUe=function(e){var t=vue(e,"number"),r,n,i,a,o,s,l,u;if(tUe(t))throw lUe("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=sUe(t),r=$x(t,0),r===43||r===45){if(n=$x(t,2),n===88||n===120)return NaN}else if(r===48){switch($x(t,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(o=uUe(t,2),s=o.length,l=0;l<s;l++)if(u=$x(o,l),u<48||u>a)return NaN;return parseInt(o,i)}}return+t},T4=Jje(Uk,!Dp(" 0o1")||!Dp("0b1")||Dp("+0x1")),hUe=function(e){return eUe(x4,e)&&rUe(function(){oUe(e)})},zk=function(t){var r=arguments.length<1?0:Dp(fUe(t));return hUe(this)?Qje(Object(r),this,zk):r};zk.prototype=x4;T4&&!fue&&(x4.constructor=zk);qje({global:!0,constructor:!0,wrap:!0,forced:T4},{Number:zk});var dUe=function(e,t){for(var r=Zje?nUe(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)aY(t,i=r[n])&&!aY(e,i)&&aUe(e,i,iUe(t,i))};(T4||fue)&&dUe(hue[Uk],Dp);var vUe=Ot,oY=Om,pUe=Nk,gUe=Ln,sY=t1,yUe=Wo,mUe=Qa,bUe=Tm,wUe=Xr,_Ue=d1,SUe=u1,CUe=_Ue("slice"),xUe=wUe("species"),t2=Array,TUe=Math.max;vUe({target:"Array",proto:!0,forced:!CUe},{slice:function(t,r){var n=mUe(this),i=yUe(n),a=sY(t,i),o=sY(r===void 0?i:r,i),s,l,u;if(oY(n)&&(s=n.constructor,pUe(s)&&(s===t2||oY(s.prototype))?s=void 0:gUe(s)&&(s=s[xUe],s===null&&(s=void 0)),s===t2||s===void 0))return SUe(n,a,o);for(l=new(s===void 0?t2:s)(TUe(o-a,0)),u=0;a<o;a++,u++)a in n&&bUe(l,u,n[a]);return l.length=u,l}});var OUe=Ot,EUe=Lt,RUe=Om,kUe=Ln,AUe=Aa,PUe=Wo,lY=oue,uY=Tm,IUe=r4,MUe=d1,DUe=Xr,$Ue=ZS,pue=DUe("isConcatSpreadable"),NUe=$Ue>=51||!EUe(function(){var e=[];return e[pue]=!1,e.concat()[0]!==e}),LUe=function(e){if(!kUe(e))return!1;var t=e[pue];return t!==void 0?!!t:RUe(e)},FUe=!NUe||!MUe("concat");OUe({target:"Array",proto:!0,arity:1,forced:FUe},{concat:function(t){var r=AUe(this),n=IUe(r,0),i=0,a,o,s,l,u;for(a=-1,s=arguments.length;a<s;a++)if(u=a===-1?r:arguments[a],LUe(u))for(l=PUe(u),lY(i+l),o=0;o<l;o++,i++)o in u&&uY(n,i,u[o]);else lY(i+1),uY(n,i++,u);return n.length=i,n}});var HUe=Aa,fY=t1,BUe=Wo,VUe=function(t){for(var r=HUe(this),n=BUe(r),i=arguments.length,a=fY(i>1?arguments[1]:void 0,n),o=i>2?arguments[2]:void 0,s=o===void 0?n:fY(o,n);s>a;)r[a++]=t;return r},WUe=Ot,jUe=VUe,UUe=c1;WUe({target:"Array",proto:!0},{fill:jUe});UUe("fill");var zUe=Ot,GUe=Gd.map,YUe=d1,KUe=YUe("map");zUe({target:"Array",proto:!0,forced:!KUe},{map:function(t){return GUe(this,t,arguments.length>1?arguments[1]:void 0)}});var XUe=Tn,gue=function(){var e=XUe(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},O4=Lt,qUe=zr,E4=qUe.RegExp,R4=O4(function(){var e=E4("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),ZUe=R4||O4(function(){return!E4("a","y").sticky}),JUe=R4||O4(function(){var e=E4("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),k4={BROKEN_CARET:JUe,MISSED_STICKY:ZUe,UNSUPPORTED_Y:R4},QUe=Lt,e8e=zr,t8e=e8e.RegExp,yue=QUe(function(){var e=t8e(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),r8e=Lt,n8e=zr,i8e=n8e.RegExp,mue=r8e(function(){var e=i8e("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),xp=Gn,Gk=Yt,a8e=Fn,o8e=gue,s8e=k4,l8e=dc,u8e=xm,f8e=Wu.get,c8e=yue,h8e=mue,d8e=l8e("native-string-replace",String.prototype.replace),EE=RegExp.prototype.exec,LN=EE,v8e=Gk("".charAt),p8e=Gk("".indexOf),g8e=Gk("".replace),r2=Gk("".slice),FN=function(){var e=/a/,t=/b*/g;return xp(EE,e,"a"),xp(EE,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),bue=s8e.BROKEN_CARET,HN=/()??/.exec("")[1]!==void 0,y8e=FN||HN||bue||c8e||h8e;y8e&&(LN=function(t){var r=this,n=f8e(r),i=a8e(t),a=n.raw,o,s,l,u,f,c,h;if(a)return a.lastIndex=r.lastIndex,o=xp(LN,a,i),r.lastIndex=a.lastIndex,o;var d=n.groups,v=bue&&r.sticky,g=xp(o8e,r),y=r.source,b=0,w=i;if(v&&(g=g8e(g,"y",""),p8e(g,"g")===-1&&(g+="g"),w=r2(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&v8e(i,r.lastIndex-1)!==`
`)&&(y="(?: "+y+")",w=" "+w,b++),s=new RegExp("^(?:"+y+")",g)),HN&&(s=new RegExp("^"+y+"$(?!\\s)",g)),FN&&(l=r.lastIndex),u=xp(EE,v?s:r,w),v?u?(u.input=r2(u.input,b),u[0]=r2(u[0],b),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:FN&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),HN&&u&&u.length>1&&xp(d8e,u[0],s,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=u8e(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var Yk=LN,m8e=Ot,cY=Yk;m8e({target:"RegExp",proto:!0,forced:/./.exec!==cY},{exec:cY});var hY=o1,dY=Vo,b8e=Yk,vY=Lt,wue=Xr,w8e=jd,_8e=wue("species"),n2=RegExp.prototype,Kk=function(e,t,r,n){var i=wue(e),a=!vY(function(){var u={};return u[i]=function(){return 7},""[e](u)!=7}),o=a&&!vY(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[_8e]=function(){return f},f.flags="",f[i]=/./[i]),f.exec=function(){return u=!0,null},f[i](""),!u});if(!a||!o||r){var s=hY(/./[i]),l=t(i,""[e],function(u,f,c,h,d){var v=hY(u),g=f.exec;return g===b8e||g===n2.exec?a&&!d?{done:!0,value:s(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});dY(String.prototype,e,l[0]),dY(n2,i,l[1])}n&&w8e(n2[i],"sham",!0)},S8e=S4.charAt,A4=function(e,t,r){return t+(r?S8e(e,t).length:1)},P4=Yt,C8e=Aa,x8e=Math.floor,i2=P4("".charAt),T8e=P4("".replace),a2=P4("".slice),O8e=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,E8e=/\$([$&'`]|\d{1,2})/g,R8e=function(e,t,r,n,i,a){var o=r+e.length,s=n.length,l=E8e;return i!==void 0&&(i=C8e(i),l=O8e),T8e(a,l,function(u,f){var c;switch(i2(f,0)){case"$":return"$";case"&":return e;case"`":return a2(t,0,r);case"'":return a2(t,o);case"<":c=i[a2(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>s){var d=x8e(h/10);return d===0?u:d<=s?n[d-1]===void 0?i2(f,1):n[d-1]+i2(f,1):u}c=n[h-1]}return c===void 0?"":c})},pY=Gn,k8e=Tn,A8e=en,P8e=gl,I8e=Yk,M8e=TypeError,Xk=function(e,t){var r=e.exec;if(A8e(r)){var n=pY(r,e,t);return n!==null&&k8e(n),n}if(P8e(e)==="RegExp")return pY(I8e,e,t);throw M8e("RegExp#exec called on incompatible receiver")},D8e=Yd,gY=Gn,qk=Yt,$8e=Kk,N8e=Lt,L8e=Tn,F8e=en,H8e=As,B8e=Sc,V8e=zd,$v=Fn,W8e=ka,j8e=A4,U8e=Wd,z8e=R8e,G8e=Xk,Y8e=Xr,BN=Y8e("replace"),K8e=Math.max,X8e=Math.min,q8e=qk([].concat),o2=qk([].push),yY=qk("".indexOf),mY=qk("".slice),Z8e=function(e){return e===void 0?e:String(e)},J8e=function(){return"a".replace(/./,"$0")==="$0"}(),bY=function(){return/./[BN]?/./[BN]("a","$0")==="":!1}(),Q8e=!N8e(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});$8e("replace",function(e,t,r){var n=bY?"$":"$0";return[function(a,o){var s=W8e(this),l=H8e(a)?void 0:U8e(a,BN);return l?gY(l,a,s,o):gY(t,$v(s),a,o)},function(i,a){var o=L8e(this),s=$v(i);if(typeof a=="string"&&yY(a,n)===-1&&yY(a,"$<")===-1){var l=r(t,o,s,a);if(l.done)return l.value}var u=F8e(a);u||(a=$v(a));var f=o.global;if(f){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var d=G8e(o,s);if(d===null||(o2(h,d),!f))break;var v=$v(d[0]);v===""&&(o.lastIndex=j8e(s,V8e(o.lastIndex),c))}for(var g="",y=0,b=0;b<h.length;b++){d=h[b];for(var w=$v(d[0]),_=K8e(X8e(B8e(d.index),s.length),0),x=[],T=1;T<d.length;T++)o2(x,Z8e(d[T]));var O=d.groups;if(u){var E=q8e([w],x,_,s);O!==void 0&&o2(E,O);var M=$v(D8e(a,void 0,E))}else M=z8e(w,s,_,x,O,a);_>=y&&(g+=mY(s,y,_)+M,y=_+w.length)}return g+mY(s,y)}]},!Q8e||!J8e||bY);var e5e=Tn,t5e=jle,r5e=function(e,t,r,n){try{return n?t(e5e(r)[0],r[1]):t(r)}catch(i){t5e(e,"throw",i)}},n5e=s1,i5e=Gn,a5e=Aa,o5e=r5e,s5e=Vle,l5e=Nk,u5e=Wo,wY=Tm,f5e=Wle,c5e=g4,_Y=Array,h5e=function(t){var r=a5e(t),n=l5e(this),i=arguments.length,a=i>1?arguments[1]:void 0,o=a!==void 0;o&&(a=n5e(a,i>2?arguments[2]:void 0));var s=c5e(r),l=0,u,f,c,h,d,v;if(s&&!(this===_Y&&s5e(s)))for(h=f5e(r,s),d=h.next,f=n?new this:[];!(c=i5e(d,h)).done;l++)v=o?o5e(h,a,[c.value,l],!0):c.value,wY(f,l,v);else for(u=u5e(r),f=n?new this(u):_Y(u);u>l;l++)v=o?a(r[l],l):r[l],wY(f,l,v);return f.length=l,f},d5e=Ot,v5e=h5e,p5e=Gle,g5e=!p5e(function(e){Array.from(e)});d5e({target:"Array",stat:!0,forced:g5e},{from:v5e});var y5e=Ot,m5e=o1,b5e=K3.indexOf,w5e=Em,VN=m5e([].indexOf),_ue=!!VN&&1/VN([1],1,-0)<0,_5e=_ue||!w5e("indexOf");y5e({target:"Array",proto:!0,forced:_5e},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return _ue?VN(this,t,r)||0:b5e(this,t,r)}});var S5e=Ot,C5e=Yt,x5e=Om,T5e=C5e([].reverse),SY=[1,2];S5e({target:"Array",proto:!0,forced:String(SY)===String(SY.reverse())},{reverse:function(){return x5e(this)&&(this.length=this.length),T5e(this)}});var O5e=Gd.forEach,E5e=Em,R5e=E5e("forEach"),k5e=R5e?[].forEach:function(t){return O5e(this,t,arguments.length>1?arguments[1]:void 0)},CY=zr,xY=Jle,A5e=Qle,s2=k5e,P5e=jd,Sue=function(e){if(e&&e.forEach!==s2)try{P5e(e,"forEach",s2)}catch{e.forEach=s2}};for(var l2 in xY)xY[l2]&&Sue(CY[l2]&&CY[l2].prototype);Sue(A5e);var I5e=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",M5e=TypeError,Cue=function(e,t){if(e<t)throw M5e("Not enough arguments");return e},xue=zr,D5e=Yd,$5e=en,N5e=I5e,L5e=Bd,F5e=u1,H5e=Cue,B5e=xue.Function,V5e=/MSIE .\./.test(L5e)||N5e&&function(){var e=xue.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),I4=function(e,t){var r=t?2:1;return V5e?function(n,i){var a=H5e(arguments.length,1)>r,o=$5e(n)?n:B5e(n),s=a?F5e(arguments,r):[],l=a?function(){D5e(o,this,s)}:o;return t?e(l,i):e(l)}:e},W5e=Ot,Tue=zr,j5e=I4,TY=j5e(Tue.setInterval,!0);W5e({global:!0,bind:!0,forced:Tue.setInterval!==TY},{setInterval:TY});var U5e=Ot,Oue=zr,z5e=I4,OY=z5e(Oue.setTimeout,!0);U5e({global:!0,bind:!0,forced:Oue.setTimeout!==OY},{setTimeout:OY});var G5e=Bd,Y5e=/(?:ipad|iphone|ipod).*applewebkit/i.test(G5e),K5e=gl,Eue=typeof process<"u"&&K5e(process)=="process",Ya=zr,X5e=Yd,q5e=s1,EY=en,Z5e=mn,Rue=Lt,RY=Jse,J5e=u1,kY=Ak,Q5e=Cue,e6e=Y5e,t6e=Eue,WN=Ya.setImmediate,jN=Ya.clearImmediate,r6e=Ya.process,u2=Ya.Dispatch,n6e=Ya.Function,AY=Ya.MessageChannel,i6e=Ya.String,f2=0,Db={},PY="onreadystatechange",Ow,sh,c2,h2;Rue(function(){Ow=Ya.location});var M4=function(e){if(Z5e(Db,e)){var t=Db[e];delete Db[e],t()}},d2=function(e){return function(){M4(e)}},IY=function(e){M4(e.data)},MY=function(e){Ya.postMessage(i6e(e),Ow.protocol+"//"+Ow.host)};(!WN||!jN)&&(WN=function(t){Q5e(arguments.length,1);var r=EY(t)?t:n6e(t),n=J5e(arguments,1);return Db[++f2]=function(){X5e(r,void 0,n)},sh(f2),f2},jN=function(t){delete Db[t]},t6e?sh=function(e){r6e.nextTick(d2(e))}:u2&&u2.now?sh=function(e){u2.now(d2(e))}:AY&&!e6e?(c2=new AY,h2=c2.port2,c2.port1.onmessage=IY,sh=q5e(h2.postMessage,h2)):Ya.addEventListener&&EY(Ya.postMessage)&&!Ya.importScripts&&Ow&&Ow.protocol!=="file:"&&!Rue(MY)?(sh=MY,Ya.addEventListener("message",IY,!1)):PY in kY("script")?sh=function(e){RY.appendChild(kY("script"))[PY]=function(){RY.removeChild(this),M4(e)}}:sh=function(e){setTimeout(d2(e),0)});var kue={set:WN,clear:jN},a6e=Ot,o6e=zr,DY=kue.clear;a6e({global:!0,bind:!0,enumerable:!0,forced:o6e.clearImmediate!==DY},{clearImmediate:DY});var s6e=Ot,Aue=zr,$Y=kue.set,l6e=I4,NY=Aue.setImmediate?l6e($Y,!1):$Y;s6e({global:!0,bind:!0,enumerable:!0,forced:Aue.setImmediate!==NY},{setImmediate:NY});var u6e=jk,f6e=Xle;u6e("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},f6e);var c6e=Ot,h6e=Lt,d6e=Aa,Pue=Wk,v6e=Dle,p6e=h6e(function(){Pue(1)});c6e({target:"Object",stat:!0,forced:p6e,sham:!v6e},{getPrototypeOf:function(t){return Pue(d6e(t))}});var g6e=Ln,y6e=gl,m6e=Xr,b6e=m6e("match"),D4=function(e){var t;return g6e(e)&&((t=e[b6e])!==void 0?!!t:y6e(e)=="RegExp")},w6e=D4,_6e=TypeError,$4=function(e){if(w6e(e))throw _6e("The method doesn't accept regular expressions");return e},S6e=Xr,C6e=S6e("match"),N4=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[C6e]=!1,"/./"[e](t)}catch{}}return!1},x6e=Ot,T6e=Yt,O6e=$4,E6e=ka,LY=Fn,R6e=N4,k6e=T6e("".indexOf);x6e({target:"String",proto:!0,forced:!R6e("includes")},{includes:function(t){return!!~k6e(LY(E6e(this)),LY(O6e(t)),arguments.length>1?arguments[1]:void 0)}});var A6e=Ot,P6e=Gd.filter,I6e=d1,M6e=I6e("filter");A6e({target:"Array",proto:!0,forced:!M6e},{filter:function(t){return P6e(this,t,arguments.length>1?arguments[1]:void 0)}});var D6e=Gn,$6e=mn,N6e=_c,L6e=gue,FY=RegExp.prototype,Iue=function(e){var t=e.flags;return t===void 0&&!("flags"in FY)&&!$6e(e,"flags")&&N6e(FY,e)?D6e(L6e,e):t},F6e=la.f,H6e=function(e,t,r){r in e||F6e(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},B6e=Nn,L4=zr,v1=Yt,V6e=Ik,W6e=b4,j6e=jd,U6e=Ud.f,HY=_c,z6e=D4,BY=Fn,G6e=Iue,Mue=k4,Y6e=H6e,K6e=Vo,X6e=Lt,q6e=mn,Z6e=Wu.enforce,J6e=Yle,Q6e=Xr,Due=yue,$ue=mue,eze=Q6e("match"),zf=L4.RegExp,vp=zf.prototype,tze=L4.SyntaxError,rze=v1(vp.exec),RE=v1("".charAt),VY=v1("".replace),WY=v1("".indexOf),nze=v1("".slice),ize=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,cd=/a/g,v2=/a/g,aze=new zf(cd)!==cd,Nue=Mue.MISSED_STICKY,oze=Mue.UNSUPPORTED_Y,sze=B6e&&(!aze||Nue||Due||$ue||X6e(function(){return v2[eze]=!1,zf(cd)!=cd||zf(v2)==v2||zf(cd,"i")!="/a/i"})),lze=function(e){for(var t=e.length,r=0,n="",i=!1,a;r<=t;r++){if(a=RE(e,r),a==="\\"){n+=a+RE(e,++r);continue}!i&&a==="."?n+="[\\s\\S]":(a==="["?i=!0:a==="]"&&(i=!1),n+=a)}return n},uze=function(e){for(var t=e.length,r=0,n="",i=[],a={},o=!1,s=!1,l=0,u="",f;r<=t;r++){if(f=RE(e,r),f==="\\")f=f+RE(e,++r);else if(f==="]")o=!1;else if(!o)switch(!0){case f==="[":o=!0;break;case f==="(":rze(ize,nze(e,r+1))&&(r+=2,s=!0),n+=f,l++;continue;case(f===">"&&s):if(u===""||q6e(a,u))throw new tze("Invalid capture group name");a[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=f:n+=f}return[n,i]};if(V6e("RegExp",sze)){for(var lh=function(t,r){var n=HY(vp,this),i=z6e(t),a=r===void 0,o=[],s=t,l,u,f,c,h,d;if(!n&&i&&a&&t.constructor===lh)return t;if((i||HY(vp,t))&&(t=t.source,a&&(r=G6e(s))),t=t===void 0?"":BY(t),r=r===void 0?"":BY(r),s=t,Due&&"dotAll"in cd&&(u=!!r&&WY(r,"s")>-1,u&&(r=VY(r,/s/g,""))),l=r,Nue&&"sticky"in cd&&(f=!!r&&WY(r,"y")>-1,f&&oze&&(r=VY(r,/y/g,""))),$ue&&(c=uze(t),t=c[0],o=c[1]),h=W6e(zf(t,r),n?this:vp,lh),(u||f||o.length)&&(d=Z6e(h),u&&(d.dotAll=!0,d.raw=lh(lze(t),l)),f&&(d.sticky=!0),o.length&&(d.groups=o)),t!==s)try{j6e(h,"source",s===""?"(?:)":s)}catch{}return h},jY=U6e(zf),UY=0;jY.length>UY;)Y6e(lh,zf,jY[UY++]);vp.constructor=lh,lh.prototype=vp,K6e(L4,"RegExp",lh,{constructor:!0})}J6e("RegExp");var fze=QS.PROPER,cze=Vo,hze=Tn,zY=Fn,dze=Lt,vze=Iue,F4="toString",pze=RegExp.prototype,Lue=pze[F4],gze=dze(function(){return Lue.call({source:"a",flags:"b"})!="/a/b"}),yze=fze&&Lue.name!=F4;(gze||yze)&&cze(RegExp.prototype,F4,function(){var t=hze(this),r=zY(t.source),n=zY(vze(t));return"/"+r+"/"+n},{unsafe:!0});var mze=Ot,bze=Yt,wze=qS,_ze=Qa,Sze=Em,Cze=bze([].join),xze=wze!=Object,Tze=xze||!Sze("join",",");mze({target:"Array",proto:!0,forced:Tze},{join:function(t){return Cze(_ze(this),t===void 0?",":t)}});var Oze=QS.PROPER,Eze=Lt,GY=lue,YY="​᠎",Rze=function(e){return Eze(function(){return!!GY[e]()||YY[e]()!==YY||Oze&&GY[e].name!==e})},kze=Ot,Aze=uue.trim,Pze=Rze;kze({target:"String",proto:!0,forced:Pze("trim")},{trim:function(){return Aze(this)}});function UN(e){return UN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UN(e)}function Zk(e){return window.requestAnimationFrame(e)}function Fue(){return!!document.documentElement.classList}function Hue(){return!!document.createTextNode("test").textContent}function Bue(){return!!window.getComputedStyle}function Ew(e){window.cancelAnimationFrame(e)}function H4(){return"ontouchstart"in window}var zN;function Ize(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),zN=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function B4(){return zN===void 0&&Ize(),zN}var Nv;function Vue(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nv||((typeof Intl>"u"?"undefined":UN(Intl))==="object"?Nv=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?Nv=function(n,i){return"".concat(n).localeCompare(i)}:Nv=function(n,i){return n===i?0:n>i?-1:1},Nv)}var R0;function Wue(){if(R0!==void 0)return R0;try{var e={get passive(){R0=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{R0=!1}return R0}const Mze=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Ew,getComparisonFunction:Vue,hasCaptionProblem:B4,isClassListSupported:Fue,isGetComputedStyleSupported:Bue,isPassiveEventSupported:Wue,isTextContentSupported:Hue,isTouchSupported:H4,requestAnimationFrame:Zk},Symbol.toStringTag,{value:"Module"}));var Dze=e4,$ze=ile;Dze("toPrimitive");$ze();var Nze=Tn,Lze=Hse,Fze=TypeError,Hze=function(e){if(Nze(this),e==="string"||e==="default")e="string";else if(e!=="number")throw Fze("Incorrect hint");return Lze(this,e)},Bze=mn,Vze=Vo,Wze=Hze,jze=Xr,KY=jze("toPrimitive"),XY=Date.prototype;Bze(XY,KY)||Vze(XY,KY,Wze);var Uze=Nk,zze=Cm,Gze=TypeError,jue=function(e){if(Uze(e))return e;throw Gze(zze(e)+" is not a constructor")},qY=Tn,Yze=jue,Kze=As,Xze=Xr,qze=Xze("species"),Zze=function(e,t){var r=qY(e).constructor,n;return r===void 0||Kze(n=qY(r)[qze])?t:Yze(n)},Jze=Yd,k0=Gn,V4=Yt,Qze=Kk,eGe=Tn,tGe=As,rGe=D4,ZY=ka,nGe=Zze,iGe=A4,aGe=zd,p2=Fn,oGe=Wd,JY=J3,QY=Xk,sGe=Yk,lGe=k4,uGe=Lt,Lv=lGe.UNSUPPORTED_Y,eK=4294967295,fGe=Math.min,Uue=[].push,cGe=V4(/./.exec),Fv=V4(Uue),A0=V4("".slice),hGe=!uGe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});Qze("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var o=p2(ZY(this)),s=a===void 0?eK:a>>>0;if(s===0)return[];if(i===void 0)return[o];if(!rGe(i))return k0(t,o,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),f=0,c=new RegExp(i.source,u+"g"),h,d,v;(h=k0(sGe,c,o))&&(d=c.lastIndex,!(d>f&&(Fv(l,A0(o,f,h.index)),h.length>1&&h.index<o.length&&Jze(Uue,l,JY(h,1)),v=h[0].length,f=d,l.length>=s)));)c.lastIndex===h.index&&c.lastIndex++;return f===o.length?(v||!cGe(c,""))&&Fv(l,""):Fv(l,A0(o,f)),l.length>s?JY(l,0,s):l}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:k0(t,this,i,a)}:n=t,[function(a,o){var s=ZY(this),l=tGe(a)?void 0:oGe(a,e);return l?k0(l,a,s,o):k0(n,p2(s),a,o)},function(i,a){var o=eGe(this),s=p2(i),l=r(n,o,s,a,n!==t);if(l.done)return l.value;var u=nGe(o,RegExp),f=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(Lv?"g":"y"),h=new u(Lv?"^(?:"+o.source+")":o,c),d=a===void 0?eK:a>>>0;if(d===0)return[];if(s.length===0)return QY(h,s)===null?[s]:[];for(var v=0,g=0,y=[];g<s.length;){h.lastIndex=Lv?0:g;var b=QY(h,Lv?A0(s,g):s),w;if(b===null||(w=fGe(aGe(h.lastIndex+(Lv?g:0)),s.length))===v)g=iGe(s,g,f);else{if(Fv(y,A0(s,v,g)),y.length===d)return y;for(var _=1;_<=b.length-1;_++)if(Fv(y,b[_]),y.length===d)return y;g=v=w}}return Fv(y,A0(s,v)),y}]},!hGe,Lv);function zue(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function GN(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function $b(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var a=0;a<n;a++)t[a]||(t[a]=[]),t[a][i]=e[i][a];return t}function On(e,t,r,n){var i=-1,a=e,o=r;Array.isArray(e)||(a=Array.from(e));var s=a.length;for(n&&s&&(i+=1,o=a[i]),i+=1;i<s;)o=t(o,a[i],i,a),i+=1;return o}function qa(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];t(s,r,n)&&(o+=1,a[o]=s),r+=1}return a}function Ut(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];o+=1,a[o]=t(s,r,n),r+=1}return a}function ue(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function Gue(e){return On(e,function(t,r){return t+r},0)}function dGe(e){return On(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function vGe(e){return On(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function pGe(e){return e.length?Gue(e)/e.length:0}function Yue(e){return On(e,function(t,r){return t.concat(Array.isArray(r)?Yue(r):r)},[])}function W4(e){var t=[];return ue(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function YN(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ue(a,function(s){o=o.filter(function(l){return!s.includes(l)})}),o}function gGe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ue(a,function(s){o=o.filter(function(l){return s.includes(l)})}),o}function yGe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=new Set(i);return ue(a,function(s){ue(s,function(l){o.has(l)||o.add(l)})}),Array.from(o)}function KN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const mGe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:pGe,arrayEach:ue,arrayFilter:qa,arrayFlatten:Yue,arrayMap:Ut,arrayMax:dGe,arrayMin:vGe,arrayReduce:On,arraySum:Gue,arrayUnique:W4,extendArray:GN,getDifferenceOfArrays:YN,getIntersectionOfArrays:gGe,getUnionOfArrays:yGe,pivot:$b,stringToArray:KN,to2dArray:zue},Symbol.toStringTag,{value:"Module"}));function tK(e,t,r){return t=bGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bGe(e){var t=wGe(e,"string");return Du(t)==="symbol"?t:String(t)}function wGe(e,t){if(Du(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Du(e){return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Du(e)}function sg(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},Gt(e,function(r,n){n!=="__children"&&(r&&Du(r)==="object"&&!Array.isArray(r)?t[n]=sg(r):Array.isArray(r)?r.length&&Du(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[sg(r[0])]:t[n]=[]:t[n]=null)})),t}function ju(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function $n(e,t,r){var n=Array.isArray(r);return Gt(t,function(i,a){(n===!1||r.includes(a))&&(e[a]=i)}),e}function p1(e,t){Gt(t,function(r,n){t[n]&&Du(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),p1(e[n],t[n])):e[n]=t[n]})}function Mi(e){return Du(e)==="object"?JSON.parse(JSON.stringify(e)):e}function ta(e){var t={};return Gt(e,function(r,n){t[n]=r}),t}function Br(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ue(r,function(i){e.MIXINS.push(i.MIXIN_NAME),Gt(i,function(a,o){if(e.prototype[o]!==void 0)throw new Error("Mixin conflict. Property '".concat(o,"' already exist and cannot be overwritten."));if(typeof a=="function")e.prototype[o]=a;else{var s=function(f,c){var h="_".concat(f),d=function(g){var y=g;return(Array.isArray(y)||zt(y))&&(y=Mi(y)),y};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},l=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,o,{get:s(o,a),set:l(o),configurable:!0})}})}),e}function j4(e,t){return JSON.stringify(e)===JSON.stringify(t)}function zt(e){return Object.prototype.toString.call(e)==="[object Object]"}function yl(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function Gt(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function Kue(e,t){var r=t.split("."),n=e;return Gt(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function sO(e,t,r){var n=t.split("."),i=e;n.forEach(function(a,o){o!==n.length-1?(gn(i,a)||(i[a]={}),i=i[a]):i[a]=r})}function Jk(e){if(!zt(e))return 0;var t=function r(n){var i=0;return zt(n)?Gt(n,function(a,o){o!=="__children"&&(i+=r(a))}):i+=1,i};return t(e)}function _d(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},tK(t,n,e),tK(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(o){this._touched=!0,this[n]=o},enumerable:!0,configurable:!0}),i}function gn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const _Ge=Object.freeze(Object.defineProperty({__proto__:null,clone:ta,createObjectPropListener:_d,deepClone:Mi,deepExtend:p1,deepObjectSize:Jk,defineGetter:yl,duckSchema:sg,extend:$n,getProperty:Kue,hasOwnProperty:gn,inherit:ju,isObject:zt,isObjectEqual:j4,mixin:Br,objectEach:Gt,setProperty:sO},Symbol.toStringTag,{value:"Module"}));var wa=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},Za={chrome:wa(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:wa(function(e){return/CriOS/.test(e)}),edge:wa(function(e){return/Edge/.test(e)}),edgeWebKit:wa(function(e){return/EdgiOS/.test(e)}),firefox:wa(function(e){return/Firefox/.test(e)}),firefoxWebKit:wa(function(e){return/FxiOS/.test(e)}),ie:wa(function(e){return/Trident/.test(e)}),ie9:wa(function(){return!!document.documentMode}),mobile:wa(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:wa(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Rm={mac:wa(function(e){return/^Mac/.test(e)}),win:wa(function(e){return/^Win/.test(e)}),linux:wa(function(e){return/^Linux/.test(e)}),ios:wa(function(e){return/iPhone|iPad|iPod/i.test(e)})};function Xue(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;Gt(Za,function(a){var o=a.test;return void o(r,i)})}function que(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;Gt(Rm,function(n){var i=n.test;return void i(r)})}Xue();que();function U4(){return Za.chrome.value}function Zue(){return Za.chromeWebKit.value}function lO(){return Za.firefox.value}function Jue(){return Za.firefoxWebKit.value}function Que(){return Za.safari.value}function efe(){return Za.edge.value}function SGe(){return Za.edgeWebKit.value}function tfe(){return Za.ie.value}function rfe(){return Za.ie9.value}function CGe(){return Za.ie.value||Za.edge.value}function ms(){return Za.mobile.value}function z4(){return Rm.ios.value}function G4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Rm.mac.value}function XN(){return Rm.win.value}function kE(){return Rm.mac.value}function xGe(){return Rm.linux.value}const TGe=Object.freeze(Object.defineProperty({__proto__:null,isChrome:U4,isChromeWebKit:Zue,isEdge:efe,isEdgeWebKit:SGe,isFirefox:lO,isFirefoxWebKit:Jue,isIE:tfe,isIE9:rfe,isIOS:z4,isIpadOS:G4,isLinuxOS:xGe,isMSBrowser:CGe,isMacOS:kE,isMobileBrowser:ms,isSafari:Que,isWindowsOS:XN,setBrowserMeta:Xue,setPlatformMeta:que},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function Rf(e){return Rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rf(e)}function qN(e,t){return qN=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},qN(e,t)}function OGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uO(e,t,r){return OGe()?uO=Reflect.construct:uO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&qN(u,o.prototype),u},uO.apply(null,arguments)}function ss(e){return EGe(e)||RGe(e)||kGe(e)||AGe()}function EGe(e){if(Array.isArray(e))return ZN(e)}function RGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kGe(e,t){if(e){if(typeof e=="string")return ZN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZN(e,t)}}function ZN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var PGe=Object.hasOwnProperty,rK=Object.setPrototypeOf,IGe=Object.isFrozen,MGe=Object.getPrototypeOf,DGe=Object.getOwnPropertyDescriptor,oa=Object.freeze,Cs=Object.seal,$Ge=Object.create,nfe=typeof Reflect<"u"&&Reflect,AE=nfe.apply,JN=nfe.construct;AE||(AE=function(t,r,n){return t.apply(r,n)});oa||(oa=function(t){return t});Cs||(Cs=function(t){return t});JN||(JN=function(t,r){return uO(t,ss(r))});var NGe=Fo(Array.prototype.forEach),nK=Fo(Array.prototype.pop),P0=Fo(Array.prototype.push),fO=Fo(String.prototype.toLowerCase),g2=Fo(String.prototype.toString),LGe=Fo(String.prototype.match),ts=Fo(String.prototype.replace),FGe=Fo(String.prototype.indexOf),HGe=Fo(String.prototype.trim),Wi=Fo(RegExp.prototype.test),y2=BGe(TypeError);function Fo(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return AE(e,t,n)}}function BGe(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return JN(e,r)}}function Jt(e,t,r){r=r||fO,rK&&rK(e,null);for(var n=t.length;n--;){var i=t[n];if(typeof i=="string"){var a=r(i);a!==i&&(IGe(t)||(t[n]=a),i=a)}e[i]=!0}return e}function uh(e){var t=$Ge(null),r;for(r in e)AE(PGe,e,[r])===!0&&(t[r]=e[r]);return t}function Nx(e,t){for(;e!==null;){var r=DGe(e,t);if(r){if(r.get)return Fo(r.get);if(typeof r.value=="function")return Fo(r.value)}e=MGe(e)}function n(i){return console.warn("fallback value for",i),null}return n}var iK=oa(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),m2=oa(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),b2=oa(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),VGe=oa(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),w2=oa(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),WGe=oa(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),aK=oa(["#text"]),oK=oa(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),_2=oa(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sK=oa(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Lx=oa(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),jGe=Cs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),UGe=Cs(/<%[\w\W]*|[\w\W]*%>/gm),zGe=Cs(/\${[\w\W]*}/gm),GGe=Cs(/^data-[\-\w.\u00B7-\uFFFF]/),YGe=Cs(/^aria-[\-\w]+$/),KGe=Cs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),XGe=Cs(/^(?:\w+script|data):/i),qGe=Cs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ZGe=Cs(/^html$/i),JGe=function(){return typeof window>"u"?null:window},QGe=function(t,r){if(Rf(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var a="dompurify"+(n?"#"+n:"");try{return t.createPolicy(a,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}};function ife(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:JGe(),t=function(K){return ife(K)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,a=e.HTMLTemplateElement,o=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=s.prototype,g=Nx(v,"cloneNode"),y=Nx(v,"nextSibling"),b=Nx(v,"childNodes"),w=Nx(v,"parentNode");if(typeof a=="function"){var _=n.createElement("template");_.content&&_.content.ownerDocument&&(n=_.content.ownerDocument)}var x=QGe(d,r),T=x?x.createHTML(""):"",O=n,E=O.implementation,M=O.createNodeIterator,P=O.createDocumentFragment,N=O.getElementsByTagName,D=r.importNode,L={};try{L=uh(n).documentMode?n.documentMode:{}}catch{}var V={};t.isSupported=typeof w=="function"&&E&&typeof E.createHTMLDocument<"u"&&L!==9;var ee=jGe,ie=UGe,le=zGe,_e=GGe,U=YGe,C=XGe,R=qGe,I=KGe,k=null,F=Jt({},[].concat(ss(iK),ss(m2),ss(b2),ss(w2),ss(aK))),H=null,W=Jt({},[].concat(ss(oK),ss(_2),ss(sK),ss(Lx))),Q=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),se=null,we=null,pe=!0,me=!0,Ie=!1,z=!0,Le=!1,ye=!1,Xe=!1,Ge=!1,De=!1,tt=!1,Qe=!1,G=!0,Z=!1,ae="user-content-",Se=!0,fe=!1,Te={},ve=null,ge=Jt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Oe=null,Ce=Jt({},["audio","video","img","source","image","track"]),be=null,He=Jt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),qe="http://www.w3.org/1998/Math/MathML",Je="http://www.w3.org/2000/svg",mt="http://www.w3.org/1999/xhtml",It=mt,ur=!1,Et=null,St=Jt({},[qe,Je,mt],g2),tr,rr=["application/xhtml+xml","text/html"],Qt="text/html",Ht,Bt=null,qr=n.createElement("form"),_r=function(K){return K instanceof RegExp||K instanceof Function},fr=function(K){Bt&&Bt===K||((!K||Rf(K)!=="object")&&(K={}),K=uh(K),tr=rr.indexOf(K.PARSER_MEDIA_TYPE)===-1?tr=Qt:tr=K.PARSER_MEDIA_TYPE,Ht=tr==="application/xhtml+xml"?g2:fO,k="ALLOWED_TAGS"in K?Jt({},K.ALLOWED_TAGS,Ht):F,H="ALLOWED_ATTR"in K?Jt({},K.ALLOWED_ATTR,Ht):W,Et="ALLOWED_NAMESPACES"in K?Jt({},K.ALLOWED_NAMESPACES,g2):St,be="ADD_URI_SAFE_ATTR"in K?Jt(uh(He),K.ADD_URI_SAFE_ATTR,Ht):He,Oe="ADD_DATA_URI_TAGS"in K?Jt(uh(Ce),K.ADD_DATA_URI_TAGS,Ht):Ce,ve="FORBID_CONTENTS"in K?Jt({},K.FORBID_CONTENTS,Ht):ge,se="FORBID_TAGS"in K?Jt({},K.FORBID_TAGS,Ht):{},we="FORBID_ATTR"in K?Jt({},K.FORBID_ATTR,Ht):{},Te="USE_PROFILES"in K?K.USE_PROFILES:!1,pe=K.ALLOW_ARIA_ATTR!==!1,me=K.ALLOW_DATA_ATTR!==!1,Ie=K.ALLOW_UNKNOWN_PROTOCOLS||!1,z=K.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Le=K.SAFE_FOR_TEMPLATES||!1,ye=K.WHOLE_DOCUMENT||!1,De=K.RETURN_DOM||!1,tt=K.RETURN_DOM_FRAGMENT||!1,Qe=K.RETURN_TRUSTED_TYPE||!1,Ge=K.FORCE_BODY||!1,G=K.SANITIZE_DOM!==!1,Z=K.SANITIZE_NAMED_PROPS||!1,Se=K.KEEP_CONTENT!==!1,fe=K.IN_PLACE||!1,I=K.ALLOWED_URI_REGEXP||I,It=K.NAMESPACE||mt,Q=K.CUSTOM_ELEMENT_HANDLING||{},K.CUSTOM_ELEMENT_HANDLING&&_r(K.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Q.tagNameCheck=K.CUSTOM_ELEMENT_HANDLING.tagNameCheck),K.CUSTOM_ELEMENT_HANDLING&&_r(K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Q.attributeNameCheck=K.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),K.CUSTOM_ELEMENT_HANDLING&&typeof K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Q.allowCustomizedBuiltInElements=K.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Le&&(me=!1),tt&&(De=!0),Te&&(k=Jt({},ss(aK)),H=[],Te.html===!0&&(Jt(k,iK),Jt(H,oK)),Te.svg===!0&&(Jt(k,m2),Jt(H,_2),Jt(H,Lx)),Te.svgFilters===!0&&(Jt(k,b2),Jt(H,_2),Jt(H,Lx)),Te.mathMl===!0&&(Jt(k,w2),Jt(H,sK),Jt(H,Lx))),K.ADD_TAGS&&(k===F&&(k=uh(k)),Jt(k,K.ADD_TAGS,Ht)),K.ADD_ATTR&&(H===W&&(H=uh(H)),Jt(H,K.ADD_ATTR,Ht)),K.ADD_URI_SAFE_ATTR&&Jt(be,K.ADD_URI_SAFE_ATTR,Ht),K.FORBID_CONTENTS&&(ve===ge&&(ve=uh(ve)),Jt(ve,K.FORBID_CONTENTS,Ht)),Se&&(k["#text"]=!0),ye&&Jt(k,["html","head","body"]),k.table&&(Jt(k,["tbody"]),delete se.tbody),oa&&oa(K),Bt=K)},or=Jt({},["mi","mo","mn","ms","mtext"]),Yo=Jt({},["foreignobject","desc","title","annotation-xml"]),to=Jt({},["title","style","font","a","script"]),ro=Jt({},m2);Jt(ro,b2),Jt(ro,VGe);var Oc=Jt({},w2);Jt(Oc,WGe);var Yu=function(K){var xe=w(K);(!xe||!xe.tagName)&&(xe={namespaceURI:It,tagName:"template"});var Pe=fO(K.tagName),je=fO(xe.tagName);return Et[K.namespaceURI]?K.namespaceURI===Je?xe.namespaceURI===mt?Pe==="svg":xe.namespaceURI===qe?Pe==="svg"&&(je==="annotation-xml"||or[je]):!!ro[Pe]:K.namespaceURI===qe?xe.namespaceURI===mt?Pe==="math":xe.namespaceURI===Je?Pe==="math"&&Yo[je]:!!Oc[Pe]:K.namespaceURI===mt?xe.namespaceURI===Je&&!Yo[je]||xe.namespaceURI===qe&&!or[je]?!1:!Oc[Pe]&&(to[Pe]||!ro[Pe]):!!(tr==="application/xhtml+xml"&&Et[K.namespaceURI]):!1},fa=function(K){P0(t.removed,{element:K});try{K.parentNode.removeChild(K)}catch{try{K.outerHTML=T}catch{K.remove()}}},Ec=function(K,xe){try{P0(t.removed,{attribute:xe.getAttributeNode(K),from:xe})}catch{P0(t.removed,{attribute:null,from:xe})}if(xe.removeAttribute(K),K==="is"&&!H[K])if(De||tt)try{fa(xe)}catch{}else try{xe.setAttribute(K,"")}catch{}},av=function(K){var xe,Pe;if(Ge)K="<remove></remove>"+K;else{var je=LGe(K,/^[\r\n\t ]+/);Pe=je&&je[0]}tr==="application/xhtml+xml"&&It===mt&&(K='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+K+"</body></html>");var Ve=x?x.createHTML(K):K;if(It===mt)try{xe=new h().parseFromString(Ve,tr)}catch{}if(!xe||!xe.documentElement){xe=E.createDocument(It,"template",null);try{xe.documentElement.innerHTML=ur?T:Ve}catch{}}var Ke=xe.body||xe.documentElement;return K&&Pe&&Ke.insertBefore(n.createTextNode(Pe),Ke.childNodes[0]||null),It===mt?N.call(xe,ye?"html":"body")[0]:ye?xe.documentElement:Ke},j=function(K){return M.call(K.ownerDocument||K,K,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},te=function(K){return K instanceof c&&(typeof K.nodeName!="string"||typeof K.textContent!="string"||typeof K.removeChild!="function"||!(K.attributes instanceof f)||typeof K.removeAttribute!="function"||typeof K.setAttribute!="function"||typeof K.namespaceURI!="string"||typeof K.insertBefore!="function"||typeof K.hasChildNodes!="function")},q=function(K){return Rf(o)==="object"?K instanceof o:K&&Rf(K)==="object"&&typeof K.nodeType=="number"&&typeof K.nodeName=="string"},J=function(K,xe,Pe){V[K]&&NGe(V[K],function(je){je.call(t,xe,Pe,Bt)})},re=function(K){var xe;if(J("beforeSanitizeElements",K,null),te(K)||Wi(/[\u0080-\uFFFF]/,K.nodeName))return fa(K),!0;var Pe=Ht(K.nodeName);if(J("uponSanitizeElement",K,{tagName:Pe,allowedTags:k}),K.hasChildNodes()&&!q(K.firstElementChild)&&(!q(K.content)||!q(K.content.firstElementChild))&&Wi(/<[/\w]/g,K.innerHTML)&&Wi(/<[/\w]/g,K.textContent)||Pe==="select"&&Wi(/<template/i,K.innerHTML))return fa(K),!0;if(!k[Pe]||se[Pe]){if(!se[Pe]&&Ae(Pe)&&(Q.tagNameCheck instanceof RegExp&&Wi(Q.tagNameCheck,Pe)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(Pe)))return!1;if(Se&&!ve[Pe]){var je=w(K)||K.parentNode,Ve=b(K)||K.childNodes;if(Ve&&je)for(var Ke=Ve.length,pt=Ke-1;pt>=0;--pt)je.insertBefore(g(Ve[pt],!0),y(K))}return fa(K),!0}return K instanceof s&&!Yu(K)||(Pe==="noscript"||Pe==="noembed")&&Wi(/<\/no(script|embed)/i,K.innerHTML)?(fa(K),!0):(Le&&K.nodeType===3&&(xe=K.textContent,xe=ts(xe,ee," "),xe=ts(xe,ie," "),xe=ts(xe,le," "),K.textContent!==xe&&(P0(t.removed,{element:K.cloneNode()}),K.textContent=xe)),J("afterSanitizeElements",K,null),!1)},ne=function(K,xe,Pe){if(G&&(xe==="id"||xe==="name")&&(Pe in n||Pe in qr))return!1;if(!(me&&!we[xe]&&Wi(_e,xe))){if(!(pe&&Wi(U,xe))){if(!H[xe]||we[xe]){if(!(Ae(K)&&(Q.tagNameCheck instanceof RegExp&&Wi(Q.tagNameCheck,K)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(K))&&(Q.attributeNameCheck instanceof RegExp&&Wi(Q.attributeNameCheck,xe)||Q.attributeNameCheck instanceof Function&&Q.attributeNameCheck(xe))||xe==="is"&&Q.allowCustomizedBuiltInElements&&(Q.tagNameCheck instanceof RegExp&&Wi(Q.tagNameCheck,Pe)||Q.tagNameCheck instanceof Function&&Q.tagNameCheck(Pe))))return!1}else if(!be[xe]){if(!Wi(I,ts(Pe,R,""))){if(!((xe==="src"||xe==="xlink:href"||xe==="href")&&K!=="script"&&FGe(Pe,"data:")===0&&Oe[K])){if(!(Ie&&!Wi(C,ts(Pe,R,"")))){if(Pe)return!1}}}}}}return!0},Ae=function(K){return K.indexOf("-")>0},$e=function(K){var xe,Pe,je,Ve;J("beforeSanitizeAttributes",K,null);var Ke=K.attributes;if(Ke){var pt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H};for(Ve=Ke.length;Ve--;){xe=Ke[Ve];var Tr=xe,Dt=Tr.name,fn=Tr.namespaceURI;if(Pe=Dt==="value"?xe.value:HGe(xe.value),je=Ht(Dt),pt.attrName=je,pt.attrValue=Pe,pt.keepAttr=!0,pt.forceKeepAttr=void 0,J("uponSanitizeAttribute",K,pt),Pe=pt.attrValue,!pt.forceKeepAttr&&(Ec(Dt,K),!!pt.keepAttr)){if(!z&&Wi(/\/>/i,Pe)){Ec(Dt,K);continue}Le&&(Pe=ts(Pe,ee," "),Pe=ts(Pe,ie," "),Pe=ts(Pe,le," "));var Ko=Ht(K.nodeName);if(ne(Ko,je,Pe)){if(Z&&(je==="id"||je==="name")&&(Ec(Dt,K),Pe=ae+Pe),x&&Rf(d)==="object"&&typeof d.getAttributeType=="function"&&!fn)switch(d.getAttributeType(Ko,je)){case"TrustedHTML":Pe=x.createHTML(Pe);break;case"TrustedScriptURL":Pe=x.createScriptURL(Pe);break}try{fn?K.setAttributeNS(fn,Dt,Pe):K.setAttribute(Dt,Pe),nK(t.removed)}catch{}}}}J("afterSanitizeAttributes",K,null)}},ke=function he(K){var xe,Pe=j(K);for(J("beforeSanitizeShadowDOM",K,null);xe=Pe.nextNode();)J("uponSanitizeShadowNode",xe,null),!re(xe)&&(xe.content instanceof i&&he(xe.content),$e(xe));J("afterSanitizeShadowDOM",K,null)};return t.sanitize=function(he){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},xe,Pe,je,Ve,Ke;if(ur=!he,ur&&(he="<!-->"),typeof he!="string"&&!q(he)){if(typeof he.toString!="function")throw y2("toString is not a function");if(he=he.toString(),typeof he!="string")throw y2("dirty is not a string, aborting")}if(!t.isSupported){if(Rf(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof he=="string")return e.toStaticHTML(he);if(q(he))return e.toStaticHTML(he.outerHTML)}return he}if(Xe||fr(K),t.removed=[],typeof he=="string"&&(fe=!1),fe){if(he.nodeName){var pt=Ht(he.nodeName);if(!k[pt]||se[pt])throw y2("root node is forbidden and cannot be sanitized in-place")}}else if(he instanceof o)xe=av("<!---->"),Pe=xe.ownerDocument.importNode(he,!0),Pe.nodeType===1&&Pe.nodeName==="BODY"||Pe.nodeName==="HTML"?xe=Pe:xe.appendChild(Pe);else{if(!De&&!Le&&!ye&&he.indexOf("<")===-1)return x&&Qe?x.createHTML(he):he;if(xe=av(he),!xe)return De?null:Qe?T:""}xe&&Ge&&fa(xe.firstChild);for(var Tr=j(fe?he:xe);je=Tr.nextNode();)je.nodeType===3&&je===Ve||re(je)||(je.content instanceof i&&ke(je.content),$e(je),Ve=je);if(Ve=null,fe)return he;if(De){if(tt)for(Ke=P.call(xe.ownerDocument);xe.firstChild;)Ke.appendChild(xe.firstChild);else Ke=xe;return(H.shadowroot||H.shadowrootmod)&&(Ke=D.call(r,Ke,!0)),Ke}var Dt=ye?xe.outerHTML:xe.innerHTML;return ye&&k["!doctype"]&&xe.ownerDocument&&xe.ownerDocument.doctype&&xe.ownerDocument.doctype.name&&Wi(ZGe,xe.ownerDocument.doctype.name)&&(Dt="<!DOCTYPE "+xe.ownerDocument.doctype.name+`>
`+Dt),Le&&(Dt=ts(Dt,ee," "),Dt=ts(Dt,ie," "),Dt=ts(Dt,le," ")),x&&Qe?x.createHTML(Dt):Dt},t.setConfig=function(he){fr(he),Xe=!0},t.clearConfig=function(){Bt=null,Xe=!1},t.isValidAttribute=function(he,K,xe){Bt||fr({});var Pe=Ht(he),je=Ht(K);return ne(Pe,je,xe)},t.addHook=function(he,K){typeof K=="function"&&(V[he]=V[he]||[],P0(V[he],K))},t.removeHook=function(he){if(V[he])return nK(V[he])},t.removeHooks=function(he){V[he]&&(V[he]=[])},t.removeAllHooks=function(){V={}},t}var e7e=ife(),t7e=Ot,r7e=S4.codeAt;t7e({target:"String",proto:!0},{codePointAt:function(t){return r7e(this,t)}});var n7e=Sc,i7e=Fn,a7e=ka,o7e=RangeError,afe=function(t){var r=i7e(a7e(this)),n="",i=n7e(t);if(i<0||i==1/0)throw o7e("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},ofe=Yt,s7e=zd,lK=Fn,l7e=afe,u7e=ka,f7e=ofe(l7e),c7e=ofe("".slice),h7e=Math.ceil,uK=function(e){return function(t,r,n){var i=lK(u7e(t)),a=s7e(r),o=i.length,s=n===void 0?" ":lK(n),l,u;return a<=o||s==""?i:(l=a-o,u=f7e(s,h7e(l/s.length)),u.length>l&&(u=c7e(u,0,l)),e?i+u:u+i)}},d7e={start:uK(!1),end:uK(!0)},v7e=Bd,p7e=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(v7e),g7e=Ot,y7e=d7e.start,m7e=p7e;g7e({target:"String",proto:!0,forced:m7e},{padStart:function(t){return y7e(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var sfe;function ze(){return sfe.apply(null,arguments)}function b7e(e){sfe=e}function xs(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function hd(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Sr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Y4(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Sr(e,t))return!1;return!0}function ma(e){return e===void 0}function $u(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function g1(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function lfe(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function Lf(e,t){for(var r in t)Sr(t,r)&&(e[r]=t[r]);return Sr(t,"toString")&&(e.toString=t.toString),Sr(t,"valueOf")&&(e.valueOf=t.valueOf),e}function ml(e,t,r,n){return Ife(e,t,r,n,!0).utc()}function w7e(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Xt(e){return e._pf==null&&(e._pf=w7e()),e._pf}var QN;Array.prototype.some?QN=Array.prototype.some:QN=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function K4(e){if(e._isValid==null){var t=Xt(e),r=QN.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function Qk(e){var t=ml(NaN);return e!=null?Lf(Xt(t),e):Xt(t).userInvalidated=!0,t}var fK=ze.momentProperties=[],S2=!1;function X4(e,t){var r,n,i,a=fK.length;if(ma(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),ma(t._i)||(e._i=t._i),ma(t._f)||(e._f=t._f),ma(t._l)||(e._l=t._l),ma(t._strict)||(e._strict=t._strict),ma(t._tzm)||(e._tzm=t._tzm),ma(t._isUTC)||(e._isUTC=t._isUTC),ma(t._offset)||(e._offset=t._offset),ma(t._pf)||(e._pf=Xt(t)),ma(t._locale)||(e._locale=t._locale),a>0)for(r=0;r<a;r++)n=fK[r],i=t[n],ma(i)||(e[n]=i);return e}function y1(e){X4(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),S2===!1&&(S2=!0,ze.updateOffset(this),S2=!1)}function Ts(e){return e instanceof y1||e!=null&&e._isAMomentObject!=null}function ufe(e){ze.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function jo(e,t){var r=!0;return Lf(function(){if(ze.deprecationHandler!=null&&ze.deprecationHandler(null,e),r){var n=[],i,a,o,s=arguments.length;for(a=0;a<s;a++){if(i="",typeof arguments[a]=="object"){i+=`
[`+a+"] ";for(o in arguments[0])Sr(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[a];n.push(i)}ufe(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var cK={};function ffe(e,t){ze.deprecationHandler!=null&&ze.deprecationHandler(e,t),cK[e]||(ufe(t),cK[e]=!0)}ze.suppressDeprecationWarnings=!1;ze.deprecationHandler=null;function bl(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function _7e(e){var t,r;for(r in e)Sr(e,r)&&(t=e[r],bl(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function eL(e,t){var r=Lf({},e),n;for(n in t)Sr(t,n)&&(hd(e[n])&&hd(t[n])?(r[n]={},Lf(r[n],e[n]),Lf(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Sr(e,n)&&!Sr(t,n)&&hd(e[n])&&(r[n]=Lf({},r[n]));return r}function q4(e){e!=null&&this.set(e)}var tL;Object.keys?tL=Object.keys:tL=function(e){var t,r=[];for(t in e)Sr(e,t)&&r.push(t);return r};var S7e={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function C7e(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return bl(n)?n.call(t,r):n}function fl(e,t,r){var n=""+Math.abs(e),i=t-n.length,a=e>=0;return(a?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var Z4=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Fx=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,C2={},$p={};function wt(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&($p[e]=i),t&&($p[t[0]]=function(){return fl(i.apply(this,arguments),t[1],t[2])}),r&&($p[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function x7e(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function T7e(e){var t=e.match(Z4),r,n;for(r=0,n=t.length;r<n;r++)$p[t[r]]?t[r]=$p[t[r]]:t[r]=x7e(t[r]);return function(i){var a="",o;for(o=0;o<n;o++)a+=bl(t[o])?t[o].call(i,e):t[o];return a}}function cO(e,t){return e.isValid()?(t=cfe(t,e.localeData()),C2[t]=C2[t]||T7e(t),C2[t](e)):e.localeData().invalidDate()}function cfe(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(Fx.lastIndex=0;r>=0&&Fx.test(e);)e=e.replace(Fx,n),Fx.lastIndex=0,r-=1;return e}var O7e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function E7e(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Z4).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var R7e="Invalid date";function k7e(){return this._invalidDate}var A7e="%d",P7e=/\d{1,2}/;function I7e(e){return this._ordinal.replace("%d",e)}var M7e={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function D7e(e,t,r,n){var i=this._relativeTime[r];return bl(i)?i(e,t,r,n):i.replace(/%d/i,e)}function $7e(e,t){var r=this._relativeTime[e>0?"future":"past"];return bl(r)?r(t):r.replace(/%s/i,t)}var Nb={};function $i(e,t){var r=e.toLowerCase();Nb[r]=Nb[r+"s"]=Nb[t]=e}function Uo(e){return typeof e=="string"?Nb[e]||Nb[e.toLowerCase()]:void 0}function J4(e){var t={},r,n;for(n in e)Sr(e,n)&&(r=Uo(n),r&&(t[r]=e[n]));return t}var hfe={};function Ni(e,t){hfe[e]=t}function N7e(e){var t=[],r;for(r in e)Sr(e,r)&&t.push({unit:r,priority:hfe[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function eA(e){return e%4===0&&e%100!==0||e%400===0}function Ao(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ar(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Ao(t)),r}function km(e,t){return function(r){return r!=null?(dfe(this,e,r),ze.updateOffset(this,t),this):PE(this,e)}}function PE(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function dfe(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&eA(e.year())&&e.month()===1&&e.date()===29?(r=ar(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),oA(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function L7e(e){return e=Uo(e),bl(this[e])?this[e]():this}function F7e(e,t){if(typeof e=="object"){e=J4(e);var r=N7e(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=Uo(e),bl(this[e]))return this[e](t);return this}var vfe=/\d/,eo=/\d\d/,pfe=/\d{3}/,Q4=/\d{4}/,tA=/[+-]?\d{6}/,tn=/\d\d?/,gfe=/\d\d\d\d?/,yfe=/\d\d\d\d\d\d?/,rA=/\d{1,3}/,eV=/\d{1,4}/,nA=/[+-]?\d{1,6}/,Am=/\d+/,iA=/[+-]?\d+/,H7e=/Z|[+-]\d\d:?\d\d/gi,aA=/Z|[+-]\d\d(?::?\d\d)?/gi,B7e=/[+-]?\d+(\.\d{1,3})?/,m1=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,IE;IE={};function vt(e,t,r){IE[e]=bl(t)?t:function(n,i){return n&&r?r:t}}function V7e(e,t){return Sr(IE,e)?IE[e](t._strict,t._locale):new RegExp(W7e(e))}function W7e(e){return Wa(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,a){return r||n||i||a}))}function Wa(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var rL={};function Vr(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),$u(t)&&(n=function(a,o){o[t]=ar(a)}),i=e.length,r=0;r<i;r++)rL[e[r]]=n}function b1(e,t){Vr(e,function(r,n,i,a){i._w=i._w||{},t(r,i._w,i,a)})}function j7e(e,t,r){t!=null&&Sr(rL,e)&&rL[e](t,r._a,r,e)}var ki=0,ql=1,nl=2,Zn=3,bs=4,Zl=5,Ih=6,U7e=7,z7e=8;function G7e(e,t){return(e%t+t)%t}var Pn;Array.prototype.indexOf?Pn=Array.prototype.indexOf:Pn=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function oA(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=G7e(t,12);return e+=(t-r)/12,r===1?eA(e)?29:28:31-r%7%2}wt("M",["MM",2],"Mo",function(){return this.month()+1});wt("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});wt("MMMM",0,0,function(e){return this.localeData().months(this,e)});$i("month","M");Ni("month",8);vt("M",tn);vt("MM",tn,eo);vt("MMM",function(e,t){return t.monthsShortRegex(e)});vt("MMMM",function(e,t){return t.monthsRegex(e)});Vr(["M","MM"],function(e,t){t[ql]=ar(e)-1});Vr(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[ql]=i:Xt(r).invalidMonth=e});var Y7e="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),mfe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),bfe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,K7e=m1,X7e=m1;function q7e(e,t){return e?xs(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||bfe).test(t)?"format":"standalone"][e.month()]:xs(this._months)?this._months:this._months.standalone}function Z7e(e,t){return e?xs(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[bfe.test(t)?"format":"standalone"][e.month()]:xs(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function J7e(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=ml([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return r?t==="MMM"?(i=Pn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=Pn.call(this._longMonthsParse,o),i!==-1?i:null):t==="MMM"?(i=Pn.call(this._shortMonthsParse,o),i!==-1?i:(i=Pn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=Pn.call(this._longMonthsParse,o),i!==-1?i:(i=Pn.call(this._shortMonthsParse,o),i!==-1?i:null))}function Q7e(e,t,r){var n,i,a;if(this._monthsParseExact)return J7e.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=ml([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function wfe(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=ar(t);else if(t=e.localeData().monthsParse(t),!$u(t))return e}return r=Math.min(e.date(),oA(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function _fe(e){return e!=null?(wfe(this,e),ze.updateOffset(this,!0),this):PE(this,"Month")}function e9e(){return oA(this.year(),this.month())}function t9e(e){return this._monthsParseExact?(Sr(this,"_monthsRegex")||Sfe.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Sr(this,"_monthsShortRegex")||(this._monthsShortRegex=K7e),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function r9e(e){return this._monthsParseExact?(Sr(this,"_monthsRegex")||Sfe.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Sr(this,"_monthsRegex")||(this._monthsRegex=X7e),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Sfe(){function e(o,s){return s.length-o.length}var t=[],r=[],n=[],i,a;for(i=0;i<12;i++)a=ml([2e3,i]),t.push(this.monthsShort(a,"")),r.push(this.months(a,"")),n.push(this.months(a,"")),n.push(this.monthsShort(a,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=Wa(t[i]),r[i]=Wa(r[i]);for(i=0;i<24;i++)n[i]=Wa(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}wt("Y",0,0,function(){var e=this.year();return e<=9999?fl(e,4):"+"+e});wt(0,["YY",2],0,function(){return this.year()%100});wt(0,["YYYY",4],0,"year");wt(0,["YYYYY",5],0,"year");wt(0,["YYYYYY",6,!0],0,"year");$i("year","y");Ni("year",1);vt("Y",iA);vt("YY",tn,eo);vt("YYYY",eV,Q4);vt("YYYYY",nA,tA);vt("YYYYYY",nA,tA);Vr(["YYYYY","YYYYYY"],ki);Vr("YYYY",function(e,t){t[ki]=e.length===2?ze.parseTwoDigitYear(e):ar(e)});Vr("YY",function(e,t){t[ki]=ze.parseTwoDigitYear(e)});Vr("Y",function(e,t){t[ki]=parseInt(e,10)});function Lb(e){return eA(e)?366:365}ze.parseTwoDigitYear=function(e){return ar(e)+(ar(e)>68?1900:2e3)};var Cfe=km("FullYear",!0);function n9e(){return eA(this.year())}function i9e(e,t,r,n,i,a,o){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,i,a,o),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,i,a,o),s}function Rw(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function ME(e,t,r){var n=7+t-r,i=(7+Rw(e,0,n).getUTCDay()-t)%7;return-i+n-1}function xfe(e,t,r,n,i){var a=(7+r-n)%7,o=ME(e,n,i),s=1+7*(t-1)+a+o,l,u;return s<=0?(l=e-1,u=Lb(l)+s):s>Lb(e)?(l=e+1,u=s-Lb(e)):(l=e,u=s),{year:l,dayOfYear:u}}function kw(e,t,r){var n=ME(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;return i<1?(o=e.year()-1,a=i+Ou(o,t,r)):i>Ou(e.year(),t,r)?(a=i-Ou(e.year(),t,r),o=e.year()+1):(o=e.year(),a=i),{week:a,year:o}}function Ou(e,t,r){var n=ME(e,t,r),i=ME(e+1,t,r);return(Lb(e)-n+i)/7}wt("w",["ww",2],"wo","week");wt("W",["WW",2],"Wo","isoWeek");$i("week","w");$i("isoWeek","W");Ni("week",5);Ni("isoWeek",5);vt("w",tn);vt("ww",tn,eo);vt("W",tn);vt("WW",tn,eo);b1(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=ar(e)});function a9e(e){return kw(e,this._week.dow,this._week.doy).week}var o9e={dow:0,doy:6};function s9e(){return this._week.dow}function l9e(){return this._week.doy}function u9e(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function f9e(e){var t=kw(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}wt("d",0,"do","day");wt("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});wt("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});wt("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});wt("e",0,0,"weekday");wt("E",0,0,"isoWeekday");$i("day","d");$i("weekday","e");$i("isoWeekday","E");Ni("day",11);Ni("weekday",11);Ni("isoWeekday",11);vt("d",tn);vt("e",tn);vt("E",tn);vt("dd",function(e,t){return t.weekdaysMinRegex(e)});vt("ddd",function(e,t){return t.weekdaysShortRegex(e)});vt("dddd",function(e,t){return t.weekdaysRegex(e)});b1(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:Xt(r).invalidWeekday=e});b1(["d","e","E"],function(e,t,r,n){t[n]=ar(e)});function c9e(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function h9e(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function tV(e,t){return e.slice(t,7).concat(e.slice(0,t))}var d9e="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Tfe="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),v9e="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),p9e=m1,g9e=m1,y9e=m1;function m9e(e,t){var r=xs(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?tV(r,this._week.dow):e?r[e.day()]:r}function b9e(e){return e===!0?tV(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function w9e(e){return e===!0?tV(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function _9e(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=ml([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return r?t==="dddd"?(i=Pn.call(this._weekdaysParse,o),i!==-1?i:null):t==="ddd"?(i=Pn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=Pn.call(this._minWeekdaysParse,o),i!==-1?i:null):t==="dddd"?(i=Pn.call(this._weekdaysParse,o),i!==-1||(i=Pn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=Pn.call(this._minWeekdaysParse,o),i!==-1?i:null)):t==="ddd"?(i=Pn.call(this._shortWeekdaysParse,o),i!==-1||(i=Pn.call(this._weekdaysParse,o),i!==-1)?i:(i=Pn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=Pn.call(this._minWeekdaysParse,o),i!==-1||(i=Pn.call(this._weekdaysParse,o),i!==-1)?i:(i=Pn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function S9e(e,t,r){var n,i,a;if(this._weekdaysParseExact)return _9e.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=ml([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function C9e(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=c9e(e,this.localeData()),this.add(e-t,"d")):t}function x9e(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function T9e(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=h9e(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function O9e(e){return this._weekdaysParseExact?(Sr(this,"_weekdaysRegex")||rV.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Sr(this,"_weekdaysRegex")||(this._weekdaysRegex=p9e),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function E9e(e){return this._weekdaysParseExact?(Sr(this,"_weekdaysRegex")||rV.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Sr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=g9e),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function R9e(e){return this._weekdaysParseExact?(Sr(this,"_weekdaysRegex")||rV.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Sr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=y9e),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function rV(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],i=[],a,o,s,l,u;for(a=0;a<7;a++)o=ml([2e3,1]).day(a),s=Wa(this.weekdaysMin(o,"")),l=Wa(this.weekdaysShort(o,"")),u=Wa(this.weekdays(o,"")),t.push(s),r.push(l),n.push(u),i.push(s),i.push(l),i.push(u);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function nV(){return this.hours()%12||12}function k9e(){return this.hours()||24}wt("H",["HH",2],0,"hour");wt("h",["hh",2],0,nV);wt("k",["kk",2],0,k9e);wt("hmm",0,0,function(){return""+nV.apply(this)+fl(this.minutes(),2)});wt("hmmss",0,0,function(){return""+nV.apply(this)+fl(this.minutes(),2)+fl(this.seconds(),2)});wt("Hmm",0,0,function(){return""+this.hours()+fl(this.minutes(),2)});wt("Hmmss",0,0,function(){return""+this.hours()+fl(this.minutes(),2)+fl(this.seconds(),2)});function Ofe(e,t){wt(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}Ofe("a",!0);Ofe("A",!1);$i("hour","h");Ni("hour",13);function Efe(e,t){return t._meridiemParse}vt("a",Efe);vt("A",Efe);vt("H",tn);vt("h",tn);vt("k",tn);vt("HH",tn,eo);vt("hh",tn,eo);vt("kk",tn,eo);vt("hmm",gfe);vt("hmmss",yfe);vt("Hmm",gfe);vt("Hmmss",yfe);Vr(["H","HH"],Zn);Vr(["k","kk"],function(e,t,r){var n=ar(e);t[Zn]=n===24?0:n});Vr(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});Vr(["h","hh"],function(e,t,r){t[Zn]=ar(e),Xt(r).bigHour=!0});Vr("hmm",function(e,t,r){var n=e.length-2;t[Zn]=ar(e.substr(0,n)),t[bs]=ar(e.substr(n)),Xt(r).bigHour=!0});Vr("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[Zn]=ar(e.substr(0,n)),t[bs]=ar(e.substr(n,2)),t[Zl]=ar(e.substr(i)),Xt(r).bigHour=!0});Vr("Hmm",function(e,t,r){var n=e.length-2;t[Zn]=ar(e.substr(0,n)),t[bs]=ar(e.substr(n))});Vr("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[Zn]=ar(e.substr(0,n)),t[bs]=ar(e.substr(n,2)),t[Zl]=ar(e.substr(i))});function A9e(e){return(e+"").toLowerCase().charAt(0)==="p"}var P9e=/[ap]\.?m?\.?/i,I9e=km("Hours",!0);function M9e(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var Rfe={calendar:S7e,longDateFormat:O7e,invalidDate:R7e,ordinal:A7e,dayOfMonthOrdinalParse:P7e,relativeTime:M7e,months:Y7e,monthsShort:mfe,week:o9e,weekdays:d9e,weekdaysMin:v9e,weekdaysShort:Tfe,meridiemParse:P9e},rn={},I0={},Aw;function D9e(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function hK(e){return e&&e.toLowerCase().replace("_","-")}function $9e(e){for(var t=0,r,n,i,a;t<e.length;){for(a=hK(e[t]).split("-"),r=a.length,n=hK(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=sA(a.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&D9e(a,n)>=r-1)break;r--}t++}return Aw}function N9e(e){return e.match("^[^/\\\\]*$")!=null}function sA(e){var t=null,r;if(rn[e]===void 0&&typeof module<"u"&&module&&module.exports&&N9e(e))try{t=Aw._abbr,r=require,r("./locale/"+e),Gf(t)}catch{rn[e]=null}return rn[e]}function Gf(e,t){var r;return e&&(ma(t)?r=Uu(e):r=iV(e,t),r?Aw=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Aw._abbr}function iV(e,t){if(t!==null){var r,n=Rfe;if(t.abbr=e,rn[e]!=null)ffe("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=rn[e]._config;else if(t.parentLocale!=null)if(rn[t.parentLocale]!=null)n=rn[t.parentLocale]._config;else if(r=sA(t.parentLocale),r!=null)n=r._config;else return I0[t.parentLocale]||(I0[t.parentLocale]=[]),I0[t.parentLocale].push({name:e,config:t}),null;return rn[e]=new q4(eL(n,t)),I0[e]&&I0[e].forEach(function(i){iV(i.name,i.config)}),Gf(e),rn[e]}else return delete rn[e],null}function L9e(e,t){if(t!=null){var r,n,i=Rfe;rn[e]!=null&&rn[e].parentLocale!=null?rn[e].set(eL(rn[e]._config,t)):(n=sA(e),n!=null&&(i=n._config),t=eL(i,t),n==null&&(t.abbr=e),r=new q4(t),r.parentLocale=rn[e],rn[e]=r),Gf(e)}else rn[e]!=null&&(rn[e].parentLocale!=null?(rn[e]=rn[e].parentLocale,e===Gf()&&Gf(e)):rn[e]!=null&&delete rn[e]);return rn[e]}function Uu(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Aw;if(!xs(e)){if(t=sA(e),t)return t;e=[e]}return $9e(e)}function F9e(){return tL(rn)}function aV(e){var t,r=e._a;return r&&Xt(e).overflow===-2&&(t=r[ql]<0||r[ql]>11?ql:r[nl]<1||r[nl]>oA(r[ki],r[ql])?nl:r[Zn]<0||r[Zn]>24||r[Zn]===24&&(r[bs]!==0||r[Zl]!==0||r[Ih]!==0)?Zn:r[bs]<0||r[bs]>59?bs:r[Zl]<0||r[Zl]>59?Zl:r[Ih]<0||r[Ih]>999?Ih:-1,Xt(e)._overflowDayOfYear&&(t<ki||t>nl)&&(t=nl),Xt(e)._overflowWeeks&&t===-1&&(t=U7e),Xt(e)._overflowWeekday&&t===-1&&(t=z7e),Xt(e).overflow=t),e}var H9e=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,B9e=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,V9e=/Z|[+-]\d\d(?::?\d\d)?/,Hx=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],x2=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],W9e=/^\/?Date\((-?\d+)/i,j9e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,U9e={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function kfe(e){var t,r,n=e._i,i=H9e.exec(n)||B9e.exec(n),a,o,s,l,u=Hx.length,f=x2.length;if(i){for(Xt(e).iso=!0,t=0,r=u;t<r;t++)if(Hx[t][1].exec(i[1])){o=Hx[t][0],a=Hx[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(i[3]){for(t=0,r=f;t<r;t++)if(x2[t][1].exec(i[3])){s=(i[2]||" ")+x2[t][0];break}if(s==null){e._isValid=!1;return}}if(!a&&s!=null){e._isValid=!1;return}if(i[4])if(V9e.exec(i[4]))l="Z";else{e._isValid=!1;return}e._f=o+(s||"")+(l||""),sV(e)}else e._isValid=!1}function z9e(e,t,r,n,i,a){var o=[G9e(e),mfe.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return a&&o.push(parseInt(a,10)),o}function G9e(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Y9e(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function K9e(e,t,r){if(e){var n=Tfe.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return Xt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function X9e(e,t,r){if(e)return U9e[e];if(t)return 0;var n=parseInt(r,10),i=n%100,a=(n-i)/100;return a*60+i}function Afe(e){var t=j9e.exec(Y9e(e._i)),r;if(t){if(r=z9e(t[4],t[3],t[2],t[5],t[6],t[7]),!K9e(t[1],r,e))return;e._a=r,e._tzm=X9e(t[8],t[9],t[10]),e._d=Rw.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Xt(e).rfc2822=!0}else e._isValid=!1}function q9e(e){var t=W9e.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(kfe(e),e._isValid===!1)delete e._isValid;else return;if(Afe(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ze.createFromInputFallback(e)}ze.createFromInputFallback=jo("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function pp(e,t,r){return e??t??r}function Z9e(e){var t=new Date(ze.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function oV(e){var t,r,n=[],i,a,o;if(!e._d){for(i=Z9e(e),e._w&&e._a[nl]==null&&e._a[ql]==null&&J9e(e),e._dayOfYear!=null&&(o=pp(e._a[ki],i[ki]),(e._dayOfYear>Lb(o)||e._dayOfYear===0)&&(Xt(e)._overflowDayOfYear=!0),r=Rw(o,0,e._dayOfYear),e._a[ql]=r.getUTCMonth(),e._a[nl]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Zn]===24&&e._a[bs]===0&&e._a[Zl]===0&&e._a[Ih]===0&&(e._nextDay=!0,e._a[Zn]=0),e._d=(e._useUTC?Rw:i9e).apply(null,n),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Zn]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==a&&(Xt(e).weekdayMismatch=!0)}}function J9e(e){var t,r,n,i,a,o,s,l,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(a=1,o=4,r=pp(t.GG,e._a[ki],kw(Qr(),1,4).year),n=pp(t.W,1),i=pp(t.E,1),(i<1||i>7)&&(l=!0)):(a=e._locale._week.dow,o=e._locale._week.doy,u=kw(Qr(),a,o),r=pp(t.gg,e._a[ki],u.year),n=pp(t.w,u.week),t.d!=null?(i=t.d,(i<0||i>6)&&(l=!0)):t.e!=null?(i=t.e+a,(t.e<0||t.e>6)&&(l=!0)):i=a),n<1||n>Ou(r,a,o)?Xt(e)._overflowWeeks=!0:l!=null?Xt(e)._overflowWeekday=!0:(s=xfe(r,n,i,a,o),e._a[ki]=s.year,e._dayOfYear=s.dayOfYear)}ze.ISO_8601=function(){};ze.RFC_2822=function(){};function sV(e){if(e._f===ze.ISO_8601){kfe(e);return}if(e._f===ze.RFC_2822){Afe(e);return}e._a=[],Xt(e).empty=!0;var t=""+e._i,r,n,i,a,o,s=t.length,l=0,u,f;for(i=cfe(e._f,e._locale).match(Z4)||[],f=i.length,r=0;r<f;r++)a=i[r],n=(t.match(V7e(a,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&Xt(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),l+=n.length),$p[a]?(n?Xt(e).empty=!1:Xt(e).unusedTokens.push(a),j7e(a,n,e)):e._strict&&!n&&Xt(e).unusedTokens.push(a);Xt(e).charsLeftOver=s-l,t.length>0&&Xt(e).unusedInput.push(t),e._a[Zn]<=12&&Xt(e).bigHour===!0&&e._a[Zn]>0&&(Xt(e).bigHour=void 0),Xt(e).parsedDateParts=e._a.slice(0),Xt(e).meridiem=e._meridiem,e._a[Zn]=Q9e(e._locale,e._a[Zn],e._meridiem),u=Xt(e).era,u!==null&&(e._a[ki]=e._locale.erasConvertYear(u,e._a[ki])),oV(e),aV(e)}function Q9e(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function eYe(e){var t,r,n,i,a,o,s=!1,l=e._f.length;if(l===0){Xt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<l;i++)a=0,o=!1,t=X4({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],sV(t),K4(t)&&(o=!0),a+=Xt(t).charsLeftOver,a+=Xt(t).unusedTokens.length*10,Xt(t).score=a,s?a<n&&(n=a,r=t):(n==null||a<n||o)&&(n=a,r=t,o&&(s=!0));Lf(e,r||t)}function tYe(e){if(!e._d){var t=J4(e._i),r=t.day===void 0?t.date:t.day;e._a=lfe([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),oV(e)}}function rYe(e){var t=new y1(aV(Pfe(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Pfe(e){var t=e._i,r=e._f;return e._locale=e._locale||Uu(e._l),t===null||r===void 0&&t===""?Qk({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),Ts(t)?new y1(aV(t)):(g1(t)?e._d=t:xs(r)?eYe(e):r?sV(e):nYe(e),K4(e)||(e._d=null),e))}function nYe(e){var t=e._i;ma(t)?e._d=new Date(ze.now()):g1(t)?e._d=new Date(t.valueOf()):typeof t=="string"?q9e(e):xs(t)?(e._a=lfe(t.slice(0),function(r){return parseInt(r,10)}),oV(e)):hd(t)?tYe(e):$u(t)?e._d=new Date(t):ze.createFromInputFallback(e)}function Ife(e,t,r,n,i){var a={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(hd(e)&&Y4(e)||xs(e)&&e.length===0)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=r,a._i=e,a._f=t,a._strict=n,rYe(a)}function Qr(e,t,r,n){return Ife(e,t,r,n,!1)}var iYe=jo("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Qr.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:Qk()}),aYe=jo("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Qr.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:Qk()});function Mfe(e,t){var r,n;if(t.length===1&&xs(t[0])&&(t=t[0]),!t.length)return Qr();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function oYe(){var e=[].slice.call(arguments,0);return Mfe("isBefore",e)}function sYe(){var e=[].slice.call(arguments,0);return Mfe("isAfter",e)}var lYe=function(){return Date.now?Date.now():+new Date},M0=["year","quarter","month","week","day","hour","minute","second","millisecond"];function uYe(e){var t,r=!1,n,i=M0.length;for(t in e)if(Sr(e,t)&&!(Pn.call(M0,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[M0[n]]){if(r)return!1;parseFloat(e[M0[n]])!==ar(e[M0[n]])&&(r=!0)}return!0}function fYe(){return this._isValid}function cYe(){return Ps(NaN)}function lA(e){var t=J4(e),r=t.year||0,n=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=uYe(t),this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60,this._days=+o+a*7,this._months=+i+n*3+r*12,this._data={},this._locale=Uu(),this._bubble()}function hO(e){return e instanceof lA}function nL(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function hYe(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0,o;for(o=0;o<n;o++)(r&&e[o]!==t[o]||!r&&ar(e[o])!==ar(t[o]))&&a++;return a+i}function Dfe(e,t){wt(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+fl(~~(r/60),2)+t+fl(~~r%60,2)})}Dfe("Z",":");Dfe("ZZ","");vt("Z",aA);vt("ZZ",aA);Vr(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=lV(aA,e)});var dYe=/([\+\-]|\d\d)/gi;function lV(e,t){var r=(t||"").match(e),n,i,a;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(dYe)||["-",0,0],a=+(i[1]*60)+ar(i[2]),a===0?0:i[0]==="+"?a:-a)}function uV(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(Ts(e)||g1(e)?e.valueOf():Qr(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ze.updateOffset(r,!1),r):Qr(e).local()}function iL(e){return-Math.round(e._d.getTimezoneOffset())}ze.updateOffset=function(){};function vYe(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=lV(aA,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=iL(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?Lfe(this,Ps(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ze.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:iL(this)}function pYe(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function gYe(e){return this.utcOffset(0,e)}function yYe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(iL(this),"m")),this}function mYe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=lV(H7e,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function bYe(e){return this.isValid()?(e=e?Qr(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function wYe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function _Ye(){if(!ma(this._isDSTShifted))return this._isDSTShifted;var e={},t;return X4(e,this),e=Pfe(e),e._a?(t=e._isUTC?ml(e._a):Qr(e._a),this._isDSTShifted=this.isValid()&&hYe(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function SYe(){return this.isValid()?!this._isUTC:!1}function CYe(){return this.isValid()?this._isUTC:!1}function $fe(){return this.isValid()?this._isUTC&&this._offset===0:!1}var xYe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,TYe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ps(e,t){var r=e,n=null,i,a,o;return hO(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:$u(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=xYe.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:ar(n[nl])*i,h:ar(n[Zn])*i,m:ar(n[bs])*i,s:ar(n[Zl])*i,ms:ar(nL(n[Ih]*1e3))*i}):(n=TYe.exec(e))?(i=n[1]==="-"?-1:1,r={y:fh(n[2],i),M:fh(n[3],i),w:fh(n[4],i),d:fh(n[5],i),h:fh(n[6],i),m:fh(n[7],i),s:fh(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=OYe(Qr(r.from),Qr(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),a=new lA(r),hO(e)&&Sr(e,"_locale")&&(a._locale=e._locale),hO(e)&&Sr(e,"_isValid")&&(a._isValid=e._isValid),a}Ps.fn=lA.prototype;Ps.invalid=cYe;function fh(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function dK(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function OYe(e,t){var r;return e.isValid()&&t.isValid()?(t=uV(t,e),e.isBefore(t)?r=dK(e,t):(r=dK(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function Nfe(e,t){return function(r,n){var i,a;return n!==null&&!isNaN(+n)&&(ffe(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=r,r=n,n=a),i=Ps(r,n),Lfe(this,i,e),this}}function Lfe(e,t,r,n){var i=t._milliseconds,a=nL(t._days),o=nL(t._months);e.isValid()&&(n=n??!0,o&&wfe(e,PE(e,"Month")+o*r),a&&dfe(e,"Date",PE(e,"Date")+a*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&ze.updateOffset(e,a||o))}var EYe=Nfe(1,"add"),RYe=Nfe(-1,"subtract");function Ffe(e){return typeof e=="string"||e instanceof String}function kYe(e){return Ts(e)||g1(e)||Ffe(e)||$u(e)||PYe(e)||AYe(e)||e===null||e===void 0}function AYe(e){var t=hd(e)&&!Y4(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,a,o=n.length;for(i=0;i<o;i+=1)a=n[i],r=r||Sr(e,a);return t&&r}function PYe(e){var t=xs(e),r=!1;return t&&(r=e.filter(function(n){return!$u(n)&&Ffe(e)}).length===0),t&&r}function IYe(e){var t=hd(e)&&!Y4(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,a;for(i=0;i<n.length;i+=1)a=n[i],r=r||Sr(e,a);return t&&r}function MYe(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function DYe(e,t){arguments.length===1&&(arguments[0]?kYe(arguments[0])?(e=arguments[0],t=void 0):IYe(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Qr(),n=uV(r,this).startOf("day"),i=ze.calendarFormat(this,n)||"sameElse",a=t&&(bl(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,Qr(r)))}function $Ye(){return new y1(this)}function NYe(e,t){var r=Ts(e)?e:Qr(e);return this.isValid()&&r.isValid()?(t=Uo(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function LYe(e,t){var r=Ts(e)?e:Qr(e);return this.isValid()&&r.isValid()?(t=Uo(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function FYe(e,t,r,n){var i=Ts(e)?e:Qr(e),a=Ts(t)?t:Qr(t);return this.isValid()&&i.isValid()&&a.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(a,r):!this.isAfter(a,r))):!1}function HYe(e,t){var r=Ts(e)?e:Qr(e),n;return this.isValid()&&r.isValid()?(t=Uo(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function BYe(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function VYe(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function WYe(e,t,r){var n,i,a;if(!this.isValid())return NaN;if(n=uV(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=Uo(t),t){case"year":a=dO(this,n)/12;break;case"month":a=dO(this,n);break;case"quarter":a=dO(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return r?a:Ao(a)}function dO(e,t){if(e.date()<t.date())return-dO(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,a;return t-n<0?(i=e.clone().add(r-1,"months"),a=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),a=(t-n)/(i-n)),-(r+a)||0}ze.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ze.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function jYe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function UYe(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?cO(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):bl(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",cO(r,"Z")):cO(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function zYe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,a;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",a=t+'[")]',this.format(r+n+i+a)}function GYe(e){e||(e=this.isUtc()?ze.defaultFormatUtc:ze.defaultFormat);var t=cO(this,e);return this.localeData().postformat(t)}function YYe(e,t){return this.isValid()&&(Ts(e)&&e.isValid()||Qr(e).isValid())?Ps({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function KYe(e){return this.from(Qr(),e)}function XYe(e,t){return this.isValid()&&(Ts(e)&&e.isValid()||Qr(e).isValid())?Ps({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function qYe(e){return this.to(Qr(),e)}function Hfe(e){var t;return e===void 0?this._locale._abbr:(t=Uu(e),t!=null&&(this._locale=t),this)}var Bfe=jo("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function Vfe(){return this._locale}var DE=1e3,Np=60*DE,$E=60*Np,Wfe=(365*400+97)*24*$E;function Lp(e,t){return(e%t+t)%t}function jfe(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-Wfe:new Date(e,t,r).valueOf()}function Ufe(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-Wfe:Date.UTC(e,t,r)}function ZYe(e){var t,r;if(e=Uo(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Ufe:jfe,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Lp(t+(this._isUTC?0:this.utcOffset()*Np),$E);break;case"minute":t=this._d.valueOf(),t-=Lp(t,Np);break;case"second":t=this._d.valueOf(),t-=Lp(t,DE);break}return this._d.setTime(t),ze.updateOffset(this,!0),this}function JYe(e){var t,r;if(e=Uo(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Ufe:jfe,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=$E-Lp(t+(this._isUTC?0:this.utcOffset()*Np),$E)-1;break;case"minute":t=this._d.valueOf(),t+=Np-Lp(t,Np)-1;break;case"second":t=this._d.valueOf(),t+=DE-Lp(t,DE)-1;break}return this._d.setTime(t),ze.updateOffset(this,!0),this}function QYe(){return this._d.valueOf()-(this._offset||0)*6e4}function eKe(){return Math.floor(this.valueOf()/1e3)}function tKe(){return new Date(this.valueOf())}function rKe(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function nKe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function iKe(){return this.isValid()?this.toISOString():null}function aKe(){return K4(this)}function oKe(){return Lf({},Xt(this))}function sKe(){return Xt(this).overflow}function lKe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}wt("N",0,0,"eraAbbr");wt("NN",0,0,"eraAbbr");wt("NNN",0,0,"eraAbbr");wt("NNNN",0,0,"eraName");wt("NNNNN",0,0,"eraNarrow");wt("y",["y",1],"yo","eraYear");wt("y",["yy",2],0,"eraYear");wt("y",["yyy",3],0,"eraYear");wt("y",["yyyy",4],0,"eraYear");vt("N",fV);vt("NN",fV);vt("NNN",fV);vt("NNNN",bKe);vt("NNNNN",wKe);Vr(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?Xt(r).era=i:Xt(r).invalidEra=e});vt("y",Am);vt("yy",Am);vt("yyy",Am);vt("yyyy",Am);vt("yo",_Ke);Vr(["y","yy","yyy","yyyy"],ki);Vr(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[ki]=r._locale.eraYearOrdinalParse(e,i):t[ki]=parseInt(e,10)});function uKe(e,t){var r,n,i,a=this._eras||Uu("en")._eras;for(r=0,n=a.length;r<n;++r){switch(typeof a[r].since){case"string":i=ze(a[r].since).startOf("day"),a[r].since=i.valueOf();break}switch(typeof a[r].until){case"undefined":a[r].until=1/0;break;case"string":i=ze(a[r].until).startOf("day").valueOf(),a[r].until=i.valueOf();break}}return a}function fKe(e,t,r){var n,i,a=this.eras(),o,s,l;for(e=e.toUpperCase(),n=0,i=a.length;n<i;++n)if(o=a[n].name.toUpperCase(),s=a[n].abbr.toUpperCase(),l=a[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return a[n];break;case"NNNN":if(o===e)return a[n];break;case"NNNNN":if(l===e)return a[n];break}else if([o,s,l].indexOf(e)>=0)return a[n]}function cKe(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ze(e.since).year():ze(e.since).year()+(t-e.offset)*r}function hKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function dKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function vKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function pKe(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-ze(i[e].since).year())*r+i[e].offset;return this.year()}function gKe(e){return Sr(this,"_erasNameRegex")||cV.call(this),e?this._erasNameRegex:this._erasRegex}function yKe(e){return Sr(this,"_erasAbbrRegex")||cV.call(this),e?this._erasAbbrRegex:this._erasRegex}function mKe(e){return Sr(this,"_erasNarrowRegex")||cV.call(this),e?this._erasNarrowRegex:this._erasRegex}function fV(e,t){return t.erasAbbrRegex(e)}function bKe(e,t){return t.erasNameRegex(e)}function wKe(e,t){return t.erasNarrowRegex(e)}function _Ke(e,t){return t._eraYearOrdinalRegex||Am}function cV(){var e=[],t=[],r=[],n=[],i,a,o=this.eras();for(i=0,a=o.length;i<a;++i)t.push(Wa(o[i].name)),e.push(Wa(o[i].abbr)),r.push(Wa(o[i].narrow)),n.push(Wa(o[i].name)),n.push(Wa(o[i].abbr)),n.push(Wa(o[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}wt(0,["gg",2],0,function(){return this.weekYear()%100});wt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function uA(e,t){wt(0,[e,e.length],0,t)}uA("gggg","weekYear");uA("ggggg","weekYear");uA("GGGG","isoWeekYear");uA("GGGGG","isoWeekYear");$i("weekYear","gg");$i("isoWeekYear","GG");Ni("weekYear",1);Ni("isoWeekYear",1);vt("G",iA);vt("g",iA);vt("GG",tn,eo);vt("gg",tn,eo);vt("GGGG",eV,Q4);vt("gggg",eV,Q4);vt("GGGGG",nA,tA);vt("ggggg",nA,tA);b1(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=ar(e)});b1(["gg","GG"],function(e,t,r,n){t[n]=ze.parseTwoDigitYear(e)});function SKe(e){return zfe.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function CKe(e){return zfe.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function xKe(){return Ou(this.year(),1,4)}function TKe(){return Ou(this.isoWeekYear(),1,4)}function OKe(){var e=this.localeData()._week;return Ou(this.year(),e.dow,e.doy)}function EKe(){var e=this.localeData()._week;return Ou(this.weekYear(),e.dow,e.doy)}function zfe(e,t,r,n,i){var a;return e==null?kw(this,n,i).year:(a=Ou(e,n,i),t>a&&(t=a),RKe.call(this,e,t,r,n,i))}function RKe(e,t,r,n,i){var a=xfe(e,t,r,n,i),o=Rw(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}wt("Q",0,"Qo","quarter");$i("quarter","Q");Ni("quarter",7);vt("Q",vfe);Vr("Q",function(e,t){t[ql]=(ar(e)-1)*3});function kKe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}wt("D",["DD",2],"Do","date");$i("date","D");Ni("date",9);vt("D",tn);vt("DD",tn,eo);vt("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});Vr(["D","DD"],nl);Vr("Do",function(e,t){t[nl]=ar(e.match(tn)[0])});var Gfe=km("Date",!0);wt("DDD",["DDDD",3],"DDDo","dayOfYear");$i("dayOfYear","DDD");Ni("dayOfYear",4);vt("DDD",rA);vt("DDDD",pfe);Vr(["DDD","DDDD"],function(e,t,r){r._dayOfYear=ar(e)});function AKe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}wt("m",["mm",2],0,"minute");$i("minute","m");Ni("minute",14);vt("m",tn);vt("mm",tn,eo);Vr(["m","mm"],bs);var PKe=km("Minutes",!1);wt("s",["ss",2],0,"second");$i("second","s");Ni("second",15);vt("s",tn);vt("ss",tn,eo);Vr(["s","ss"],Zl);var IKe=km("Seconds",!1);wt("S",0,0,function(){return~~(this.millisecond()/100)});wt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});wt(0,["SSS",3],0,"millisecond");wt(0,["SSSS",4],0,function(){return this.millisecond()*10});wt(0,["SSSSS",5],0,function(){return this.millisecond()*100});wt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});wt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});wt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});wt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});$i("millisecond","ms");Ni("millisecond",16);vt("S",rA,vfe);vt("SS",rA,eo);vt("SSS",rA,pfe);var Ff,Yfe;for(Ff="SSSS";Ff.length<=9;Ff+="S")vt(Ff,Am);function MKe(e,t){t[Ih]=ar(("0."+e)*1e3)}for(Ff="S";Ff.length<=9;Ff+="S")Vr(Ff,MKe);Yfe=km("Milliseconds",!1);wt("z",0,0,"zoneAbbr");wt("zz",0,0,"zoneName");function DKe(){return this._isUTC?"UTC":""}function $Ke(){return this._isUTC?"Coordinated Universal Time":""}var Ye=y1.prototype;Ye.add=EYe;Ye.calendar=DYe;Ye.clone=$Ye;Ye.diff=WYe;Ye.endOf=JYe;Ye.format=GYe;Ye.from=YYe;Ye.fromNow=KYe;Ye.to=XYe;Ye.toNow=qYe;Ye.get=L7e;Ye.invalidAt=sKe;Ye.isAfter=NYe;Ye.isBefore=LYe;Ye.isBetween=FYe;Ye.isSame=HYe;Ye.isSameOrAfter=BYe;Ye.isSameOrBefore=VYe;Ye.isValid=aKe;Ye.lang=Bfe;Ye.locale=Hfe;Ye.localeData=Vfe;Ye.max=aYe;Ye.min=iYe;Ye.parsingFlags=oKe;Ye.set=F7e;Ye.startOf=ZYe;Ye.subtract=RYe;Ye.toArray=rKe;Ye.toObject=nKe;Ye.toDate=tKe;Ye.toISOString=UYe;Ye.inspect=zYe;typeof Symbol<"u"&&Symbol.for!=null&&(Ye[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Ye.toJSON=iKe;Ye.toString=jYe;Ye.unix=eKe;Ye.valueOf=QYe;Ye.creationData=lKe;Ye.eraName=hKe;Ye.eraNarrow=dKe;Ye.eraAbbr=vKe;Ye.eraYear=pKe;Ye.year=Cfe;Ye.isLeapYear=n9e;Ye.weekYear=SKe;Ye.isoWeekYear=CKe;Ye.quarter=Ye.quarters=kKe;Ye.month=_fe;Ye.daysInMonth=e9e;Ye.week=Ye.weeks=u9e;Ye.isoWeek=Ye.isoWeeks=f9e;Ye.weeksInYear=OKe;Ye.weeksInWeekYear=EKe;Ye.isoWeeksInYear=xKe;Ye.isoWeeksInISOWeekYear=TKe;Ye.date=Gfe;Ye.day=Ye.days=C9e;Ye.weekday=x9e;Ye.isoWeekday=T9e;Ye.dayOfYear=AKe;Ye.hour=Ye.hours=I9e;Ye.minute=Ye.minutes=PKe;Ye.second=Ye.seconds=IKe;Ye.millisecond=Ye.milliseconds=Yfe;Ye.utcOffset=vYe;Ye.utc=gYe;Ye.local=yYe;Ye.parseZone=mYe;Ye.hasAlignedHourOffset=bYe;Ye.isDST=wYe;Ye.isLocal=SYe;Ye.isUtcOffset=CYe;Ye.isUtc=$fe;Ye.isUTC=$fe;Ye.zoneAbbr=DKe;Ye.zoneName=$Ke;Ye.dates=jo("dates accessor is deprecated. Use date instead.",Gfe);Ye.months=jo("months accessor is deprecated. Use month instead",_fe);Ye.years=jo("years accessor is deprecated. Use year instead",Cfe);Ye.zone=jo("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pYe);Ye.isDSTShifted=jo("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",_Ye);function NKe(e){return Qr(e*1e3)}function LKe(){return Qr.apply(null,arguments).parseZone()}function Kfe(e){return e}var Cr=q4.prototype;Cr.calendar=C7e;Cr.longDateFormat=E7e;Cr.invalidDate=k7e;Cr.ordinal=I7e;Cr.preparse=Kfe;Cr.postformat=Kfe;Cr.relativeTime=D7e;Cr.pastFuture=$7e;Cr.set=_7e;Cr.eras=uKe;Cr.erasParse=fKe;Cr.erasConvertYear=cKe;Cr.erasAbbrRegex=yKe;Cr.erasNameRegex=gKe;Cr.erasNarrowRegex=mKe;Cr.months=q7e;Cr.monthsShort=Z7e;Cr.monthsParse=Q7e;Cr.monthsRegex=r9e;Cr.monthsShortRegex=t9e;Cr.week=a9e;Cr.firstDayOfYear=l9e;Cr.firstDayOfWeek=s9e;Cr.weekdays=m9e;Cr.weekdaysMin=w9e;Cr.weekdaysShort=b9e;Cr.weekdaysParse=S9e;Cr.weekdaysRegex=O9e;Cr.weekdaysShortRegex=E9e;Cr.weekdaysMinRegex=R9e;Cr.isPM=A9e;Cr.meridiem=M9e;function NE(e,t,r,n){var i=Uu(),a=ml().set(n,t);return i[r](a,e)}function Xfe(e,t,r){if($u(e)&&(t=e,e=void 0),e=e||"",t!=null)return NE(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=NE(e,n,r,"month");return i}function hV(e,t,r,n){typeof e=="boolean"?($u(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,$u(t)&&(r=t,t=void 0),t=t||"");var i=Uu(),a=e?i._week.dow:0,o,s=[];if(r!=null)return NE(t,(r+a)%7,n,"day");for(o=0;o<7;o++)s[o]=NE(t,(o+a)%7,n,"day");return s}function FKe(e,t){return Xfe(e,t,"months")}function HKe(e,t){return Xfe(e,t,"monthsShort")}function BKe(e,t,r){return hV(e,t,r,"weekdays")}function VKe(e,t,r){return hV(e,t,r,"weekdaysShort")}function WKe(e,t,r){return hV(e,t,r,"weekdaysMin")}Gf("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=ar(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ze.lang=jo("moment.lang is deprecated. Use moment.locale instead.",Gf);ze.langData=jo("moment.langData is deprecated. Use moment.localeData instead.",Uu);var Dl=Math.abs;function jKe(){var e=this._data;return this._milliseconds=Dl(this._milliseconds),this._days=Dl(this._days),this._months=Dl(this._months),e.milliseconds=Dl(e.milliseconds),e.seconds=Dl(e.seconds),e.minutes=Dl(e.minutes),e.hours=Dl(e.hours),e.months=Dl(e.months),e.years=Dl(e.years),this}function qfe(e,t,r,n){var i=Ps(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function UKe(e,t){return qfe(this,e,t,1)}function zKe(e,t){return qfe(this,e,t,-1)}function vK(e){return e<0?Math.floor(e):Math.ceil(e)}function GKe(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,a,o,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=vK(aL(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=Ao(e/1e3),n.seconds=i%60,a=Ao(i/60),n.minutes=a%60,o=Ao(a/60),n.hours=o%24,t+=Ao(o/24),l=Ao(Zfe(t)),r+=l,t-=vK(aL(l)),s=Ao(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function Zfe(e){return e*4800/146097}function aL(e){return e*146097/4800}function YKe(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Uo(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+Zfe(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(aL(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function KKe(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+ar(this._months/12)*31536e6:NaN}function zu(e){return function(){return this.as(e)}}var XKe=zu("ms"),qKe=zu("s"),ZKe=zu("m"),JKe=zu("h"),QKe=zu("d"),eXe=zu("w"),tXe=zu("M"),rXe=zu("Q"),nXe=zu("y");function iXe(){return Ps(this)}function aXe(e){return e=Uo(e),this.isValid()?this[e+"s"]():NaN}function Kd(e){return function(){return this.isValid()?this._data[e]:NaN}}var oXe=Kd("milliseconds"),sXe=Kd("seconds"),lXe=Kd("minutes"),uXe=Kd("hours"),fXe=Kd("days"),cXe=Kd("months"),hXe=Kd("years");function dXe(){return Ao(this.days()/7)}var jl=Math.round,Tp={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function vXe(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function pXe(e,t,r,n){var i=Ps(e).abs(),a=jl(i.as("s")),o=jl(i.as("m")),s=jl(i.as("h")),l=jl(i.as("d")),u=jl(i.as("M")),f=jl(i.as("w")),c=jl(i.as("y")),h=a<=r.ss&&["s",a]||a<r.s&&["ss",a]||o<=1&&["m"]||o<r.m&&["mm",o]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,vXe.apply(null,h)}function gXe(e){return e===void 0?jl:typeof e=="function"?(jl=e,!0):!1}function yXe(e,t){return Tp[e]===void 0?!1:t===void 0?Tp[e]:(Tp[e]=t,e==="s"&&(Tp.ss=t-1),!0)}function mXe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Tp,i,a;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Tp,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),a=pXe(this,!r,n,i),r&&(a=i.pastFuture(+this,a)),i.postformat(a)}var T2=Math.abs;function Hv(e){return(e>0)-(e<0)||+e}function fA(){if(!this.isValid())return this.localeData().invalidDate();var e=T2(this._milliseconds)/1e3,t=T2(this._days),r=T2(this._months),n,i,a,o,s=this.asSeconds(),l,u,f,c;return s?(n=Ao(e/60),i=Ao(n/60),e%=60,n%=60,a=Ao(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=Hv(this._months)!==Hv(s)?"-":"",f=Hv(this._days)!==Hv(s)?"-":"",c=Hv(this._milliseconds)!==Hv(s)?"-":"",l+"P"+(a?u+a+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(i||n||e?"T":"")+(i?c+i+"H":"")+(n?c+n+"M":"")+(e?c+o+"S":"")):"P0D"}var yr=lA.prototype;yr.isValid=fYe;yr.abs=jKe;yr.add=UKe;yr.subtract=zKe;yr.as=YKe;yr.asMilliseconds=XKe;yr.asSeconds=qKe;yr.asMinutes=ZKe;yr.asHours=JKe;yr.asDays=QKe;yr.asWeeks=eXe;yr.asMonths=tXe;yr.asQuarters=rXe;yr.asYears=nXe;yr.valueOf=KKe;yr._bubble=GKe;yr.clone=iXe;yr.get=aXe;yr.milliseconds=oXe;yr.seconds=sXe;yr.minutes=lXe;yr.hours=uXe;yr.days=fXe;yr.weeks=dXe;yr.months=cXe;yr.years=hXe;yr.humanize=mXe;yr.toISOString=fA;yr.toString=fA;yr.toJSON=fA;yr.locale=Hfe;yr.localeData=Vfe;yr.toIsoString=jo("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",fA);yr.lang=Bfe;wt("X",0,0,"unix");wt("x",0,0,"valueOf");vt("x",iA);vt("X",B7e);Vr("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});Vr("x",function(e,t,r){r._d=new Date(ar(e))});//! moment.js
ze.version="2.29.4";b7e(Qr);ze.fn=Ye;ze.min=oYe;ze.max=sYe;ze.now=lYe;ze.utc=ml;ze.unix=NKe;ze.months=FKe;ze.isDate=g1;ze.locale=Gf;ze.invalid=Qk;ze.duration=Ps;ze.isMoment=Ts;ze.weekdays=BKe;ze.parseZone=LKe;ze.localeData=Uu;ze.isDuration=hO;ze.monthsShort=HKe;ze.weekdaysMin=WKe;ze.defineLocale=iV;ze.updateLocale=L9e;ze.locales=F9e;ze.weekdaysShort=VKe;ze.normalizeUnits=Uo;ze.relativeTimeRounding=gXe;ze.relativeTimeThreshold=yXe;ze.calendarFormat=MYe;ze.prototype=Ye;ze.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const bXe=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}));function Ir(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=On(e,function(a,o,s){var l=o.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return a+l+u},"");return i.trim()}var pK,gK,yK,mK,bK,wK;function Fp(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function oL(e){return oL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oL(e)}function yn(e){var t;switch(oL(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function lt(e){return typeof e<"u"}function Lr(e){return typeof e>"u"}function Un(e){return e===null||e===""||Lr(e)}function Jfe(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var cb="length",Fb=function(t){return parseInt(t,16)},_K=function(t){return parseInt(t,10)},LE=function(t,r,n){return t.substr(r,n)},Hb=function(t){return t.codePointAt(0)-65},sL=function(t){return"".concat(t).replace(/\-/g,"")},wXe=function(t){return Fb(LE(sL(t),Fb("12"),Hb("F")))/(Fb(LE(sL(t),Hb("B"),~~![][cb]))||9)},_Xe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},SK=!1,CK={invalid:function(){return Ir(pK||(pK=Fp([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Ir(gK||(gK=Fp([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Ir(yK||(yK=Fp([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},xK={invalid:function(){return Ir(mK||(mK=Fp([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Ir(bK||(bK=Fp([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Ir(wK||(wK=Fp([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function Qfe(e,t){var r=!Un(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",a,o="invalid",s="invalid";e=sL(e||"");var l=SXe(e);if(r||n||l)if(l){var u=ze("28/03/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=wXe(e);a=ze((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(o="expired",s="expired"):(o="valid",s="valid")}else n?(o="non_commercial",s="valid"):(o="invalid",s="invalid");else o="missing",s="missing";if(_Xe()&&(o="valid",s="valid"),!SK&&o!=="valid"){var h=CK[o]({keyValidityDate:a,hotVersion:i});h&&console[o==="non_commercial"?"info":"warn"](CK[o]({keyValidityDate:a,hotVersion:i})),SK=!0}if(s!=="valid"&&t.parentNode){var d=xK[s]({keyValidityDate:a,hotVersion:i});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=xK[s]({keyValidityDate:a,hotVersion:i}),t.parentNode.insertBefore(v,t.nextSibling)}}}function SXe(e){var t=[][cb],r=t;if(e[cb]!==Hb("Z"))return!1;for(var n="",i="B<H4P+".split(""),a=Hb(i.shift());a;a=Hb(i.shift()||"A"))--a<""[cb]?r=r|(_K("".concat(_K(Fb(n)+(Fb(LE(e,Math.abs(a),2))+[]).padStart(2,"0"))))%97||2)>>1:n=LE(e,a,a?i[cb]===1?9:8:6);return r===t}const CXe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Qfe,isDefined:lt,isEmpty:Un,isRegExp:Jfe,isUndefined:Lr,stringify:yn},Symbol.toStringTag,{value:"Module"}));function Oa(e){return e[0].toUpperCase()+e.substr(1)}function xXe(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=r.length;i;){i-=1;var a=yn(r[i]).toLowerCase();e.indexOf(a)===-1&&e.push(a)}return e.length===1}function dV(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function vV(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function pV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function lL(e){return cA("".concat(e),{ALLOWED_TAGS:[]})}function cA(e,t){return e7e.sanitize(e,t)}const TXe=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:xXe,isPercentValue:vV,randomString:dV,sanitize:cA,stripTags:lL,substitute:pV,toUpperCaseFirst:Oa},Symbol.toStringTag,{value:"Module"}));function TK(e){return kXe(e)||RXe(e)||EXe(e)||OXe()}function OXe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EXe(e,t){if(e){if(typeof e=="string")return uL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uL(e,t)}}function RXe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kXe(e){if(Array.isArray(e))return uL(e)}function uL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ece(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function tce(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Pw(e){return tce(e)&&e.parent}function AXe(e){return!!Object.getPrototypeOf(e.parent)}function Yf(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,a=n.DOCUMENT_FRAGMENT_NODE,o=e;o!=null&&o!==r;){var s=o,l=s.nodeType,u=s.nodeName;if(l===i&&(t.includes(u)||t.includes(o)))return o;var f=o,c=f.host;c&&l===a?o=c:o=o.parentNode}return null}function hb(e,t,r){for(var n=[],i=e;i&&(i=Yf(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var a=n.length;return a?n[a-1]:null}function Kf(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function rce(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Tf(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var fL,cL,hL;function Bx(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(Fue()){var OK=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};fL=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},cL=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=Bx(i),i.length>0)if(OK(n)){var a;(a=t.classList).add.apply(a,TK(i))}else for(var o=0;i[o];)t.classList.add(i[o]),o+=1},hL=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=Bx(i),i.length>0)if(OK(n)){var a;(a=t.classList).remove.apply(a,TK(i))}else for(var o=0;i[o];)t.classList.remove(i[o]),o+=1}}else{var O2=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};fL=function(t,r){return t.className!==void 0&&O2(r).test(t.className)},cL=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=Bx(i),n==="")n=i.join(" ");else for(var a=0;a<i.length;a++)i[a]&&!O2(i[a]).test(n)&&(n+=" ".concat(i[a]));t.className=n},hL=function(t,r){var n=0,i=t.className,a=r;for(typeof a=="string"&&(a=a.split(" ")),a=Bx(a);a[n];)i=i.replace(O2(a[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function Pt(e,t){return fL(e,t)}function Ue(e,t){cL(e,t)}function Mt(e,t){hL(e,t)}function gV(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)gV(t[r])}function Os(e){for(var t;t=e.lastChild;)e.removeChild(t)}var nce=/(<(.*)>|&(.*);)/;function Xd(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;nce.test(t)?e.innerHTML=r?cA(t):t:vc(e,t)}function vc(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?Hue?r.textContent=t:r.data=t:(Os(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function lg(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return lg(r.host.impl);if(r.host)return lg(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Dn(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,a,o,s,l;if(B4()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(a=i.offsetLeft,o=i.offsetTop,s=i;(i=i.offsetParent)&&i!==t.body;)a+=i.offsetLeft,o+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(a+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:a,top:o}}function ug(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Sd(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function Iw(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?ug(t):e.scrollTop}function FE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Sd(t):e.scrollLeft}function Mw(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=Bue(),a=e.parentNode;a&&a.style&&t.body!==a;){var o=a.style,s=o.overflow,l=o.overflowX,u=o.overflowY;if([s,l,u].includes("scroll"))return a;if(i){var f=r.getComputedStyle(a);if(s=f.overflow,l=f.overflowX,u=f.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return a}if(a.clientHeight<=a.scrollHeight+1&&(n.includes(u)||n.includes(s))||a.clientWidth<=a.scrollWidth+1&&(n.includes(l)||n.includes(s)))return a;a=a.parentNode}return r}function fg(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=pc(n,r),a=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(a.includes(o)||a.includes(s)||a.includes(l))return n;n=n.parentNode}return r}function cg(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=pc(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function PXe(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function pc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function $r(e){return e.offsetWidth}function ln(e){return B4()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function Jl(e){return e.clientHeight||e.innerHeight}function Bb(e){return e.clientWidth||e.innerWidth}function IXe(e,t,r){e.addEventListener(t,r,!1)}function MXe(e,t,r){e.removeEventListener(t,r,!1)}function yV(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function ice(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function ace(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function dL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function w1(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var E2;function DXe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function ei(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return E2===void 0&&(E2=DXe(e)),E2}function oce(e){return e.offsetWidth!==e.clientWidth}function sce(e){return e.offsetHeight!==e.clientHeight}function hA(e,t,r){rfe()?(e.style.top=r,e.style.left=t):Que()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function $Xe(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function _1(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Dw(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function dA(e){return Dw(e)&&e.hasAttribute("data-hot-input")===!1}function lce(e){var t=e.ownerDocument.activeElement;dA(t)||e.select()}function mV(e){return!e.parentNode}function uce(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(a){a.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const NXe=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:nce,addClass:Ue,addEvent:IXe,clearTextSelection:dL,closest:Yf,closestDown:hb,empty:Os,fastInnerHTML:Xd,fastInnerText:vc,getCaretPosition:yV,getComputedStyle:pc,getCssTransform:$Xe,getFrameElement:tce,getParent:ece,getParentWindow:Pw,getScrollLeft:FE,getScrollTop:Iw,getScrollableElement:Mw,getScrollbarWidth:ei,getSelectionEndPosition:ice,getSelectionText:ace,getStyle:cg,getTrimmingContainer:fg,getWindowScrollLeft:Sd,getWindowScrollTop:ug,hasAccessToParentWindow:AXe,hasClass:Pt,hasHorizontalScrollbar:sce,hasVerticalScrollbar:oce,index:rce,innerHeight:Jl,innerWidth:Bb,isChildOf:Kf,isDetached:mV,isInput:Dw,isOutsideInput:dA,isVisible:lg,matchesCSSRules:PXe,observeVisibilityChangeOnce:uce,offset:Dn,outerHeight:ln,outerWidth:$r,overlayContainsElement:Tf,removeClass:Mt,removeEvent:MXe,removeTextNodes:gV,resetCssTransform:_1,selectElementIfAllowed:lce,setCaretPosition:w1,setOverlayPosition:hA},Symbol.toStringTag,{value:"Module"}));function jr(e){return typeof e=="function"}function fce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},i=null;function a(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,l)):(i&&clearTimeout(i),i=setTimeout(function(){n.lastCallThrottled=!1,e.apply(o,l),r=0,i=void 0},h)),n}return a}function LXe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=fce(e,t),i=r;function a(){i=r}function o(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return i?(i-=1,e.apply(this,l)):n.apply(this,l)}return o.clearHits=a,o}function bV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var a=this,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(a,s)},t),n}return i}function FXe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t.slice(1);return function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return On(i,function(u,f){return f(u)},n.apply(this,s))}}function wV(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return e.apply(this,r.concat(o))}}function cce(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function HXe(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o.reverse()),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function HE(e,t,r,n,i,a,o,s){return lt(s)?e.call(t,r,n,i,a,o,s):lt(o)?e.call(t,r,n,i,a,o):lt(a)?e.call(t,r,n,i,a):lt(i)?e.call(t,r,n,i):lt(n)?e.call(t,r,n):lt(r)?e.call(t,r):e.call(t)}const BXe=Object.freeze(Object.defineProperty({__proto__:null,curry:cce,curryRight:HXe,debounce:bV,fastCall:HE,isFunction:jr,partial:wV,pipe:FXe,throttle:fce,throttleAfterHits:LXe},Symbol.toStringTag,{value:"Module"}));function Fr(){if(lt(console)){var e;(e=console).warn.apply(e,arguments)}}function _V(){if(lt(console)){var e;(e=console).error.apply(e,arguments)}}var VXe=Yt,EK=w4,Vx=bd.getWeakData,WXe=m4,jXe=Tn,UXe=As,R2=Ln,zXe=y4,hce=Gd,RK=mn,dce=Wu,GXe=dce.set,YXe=dce.getterFor,KXe=hce.find,XXe=hce.findIndex,qXe=VXe([].splice),ZXe=0,Wx=function(e){return e.frozen||(e.frozen=new vce)},vce=function(){this.entries=[]},k2=function(e,t){return KXe(e.entries,function(r){return r[0]===t})};vce.prototype={get:function(e){var t=k2(this,e);if(t)return t[1]},has:function(e){return!!k2(this,e)},set:function(e,t){var r=k2(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=XXe(this.entries,function(r){return r[0]===e});return~t&&qXe(this.entries,t,1),!!~t}};var pce={getConstructor:function(e,t,r,n){var i=e(function(l,u){WXe(l,a),GXe(l,{type:t,id:ZXe++,frozen:void 0}),UXe(u)||zXe(u,l[n],{that:l,AS_ENTRIES:r})}),a=i.prototype,o=YXe(t),s=function(l,u,f){var c=o(l),h=Vx(jXe(u),!0);return h===!0?Wx(c).set(u,f):h[c.id]=f,l};return EK(a,{delete:function(l){var u=o(this);if(!R2(l))return!1;var f=Vx(l);return f===!0?Wx(u).delete(l):f&&RK(f,u.id)&&delete f[u.id]},has:function(u){var f=o(this);if(!R2(u))return!1;var c=Vx(u);return c===!0?Wx(f).has(u):c&&RK(c,f.id)}}),EK(a,r?{get:function(u){var f=o(this);if(R2(u)){var c=Vx(u);return c===!0?Wx(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return s(this,u,f)}}:{add:function(u){return s(this,u,!0)}}),i}},JXe=l4,kK=zr,vO=Yt,AK=w4,QXe=bd,eqe=jk,gce=pce,jx=Ln,Ux=Wu.enforce,tqe=Lt,rqe=zse,S1=Object,nqe=Array.isArray,zx=S1.isExtensible,yce=S1.isFrozen,iqe=S1.isSealed,mce=S1.freeze,aqe=S1.seal,PK={},IK={},oqe=!kK.ActiveXObject&&"ActiveXObject"in kK,D0,bce=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},wce=eqe("WeakMap",bce,gce),gp=wce.prototype,pO=vO(gp.set),sqe=function(){return JXe&&tqe(function(){var e=mce([]);return pO(new wce,e,1),!yce(e)})};if(rqe)if(oqe){D0=gce.getConstructor(bce,"WeakMap",!0),QXe.enable();var MK=vO(gp.delete),Gx=vO(gp.has),DK=vO(gp.get);AK(gp,{delete:function(e){if(jx(e)&&!zx(e)){var t=Ux(this);return t.frozen||(t.frozen=new D0),MK(this,e)||t.frozen.delete(e)}return MK(this,e)},has:function(t){if(jx(t)&&!zx(t)){var r=Ux(this);return r.frozen||(r.frozen=new D0),Gx(this,t)||r.frozen.has(t)}return Gx(this,t)},get:function(t){if(jx(t)&&!zx(t)){var r=Ux(this);return r.frozen||(r.frozen=new D0),Gx(this,t)?DK(this,t):r.frozen.get(t)}return DK(this,t)},set:function(t,r){if(jx(t)&&!zx(t)){var n=Ux(this);n.frozen||(n.frozen=new D0),Gx(this,t)?pO(this,t,r):n.frozen.set(t,r)}else pO(this,t,r);return this}})}else sqe()&&AK(gp,{set:function(t,r){var n;return nqe(t)&&(yce(t)?n=PK:iqe(t)&&(n=IK)),pO(this,t,r),n==PK&&mce(t),n==IK&&aqe(t),this}});var ht={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:lO()?182:174,AUDIO_MUTE:lO()?181:173,AUDIO_UP:lO()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},lqe=[ht.ALT,ht.ARROW_DOWN,ht.ARROW_LEFT,ht.ARROW_RIGHT,ht.ARROW_UP,ht.AUDIO_DOWN,ht.AUDIO_MUTE,ht.AUDIO_UP,ht.BACKSPACE,ht.CAPS_LOCK,ht.DELETE,ht.END,ht.ENTER,ht.ESCAPE,ht.F1,ht.F2,ht.F3,ht.F4,ht.F5,ht.F6,ht.F7,ht.F8,ht.F9,ht.F10,ht.F11,ht.F12,ht.F13,ht.F14,ht.F15,ht.F16,ht.F17,ht.F18,ht.F19,ht.HOME,ht.INSERT,ht.MEDIA_NEXT,ht.MEDIA_PLAY_PAUSE,ht.MEDIA_PREV,ht.MEDIA_STOP,ht.NULL,ht.NUM_LOCK,ht.PAGE_DOWN,ht.PAGE_UP,ht.PAUSE,ht.SCROLL_LOCK,ht.SHIFT,ht.TAB];function _ce(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function SV(e){return lqe.includes(e)}function uqe(e){var t=[];return kE()?t.push(ht.COMMAND_LEFT,ht.COMMAND_RIGHT,ht.COMMAND_FIREFOX):t.push(ht.CONTROL),t.includes(e)}function Sce(e){return[ht.CONTROL,ht.COMMAND_LEFT,ht.COMMAND_RIGHT,ht.COMMAND_FIREFOX].includes(e)}function hg(e,t){var r=t.split("|"),n=!1;return ue(r,function(i){if(e===ht[i])return n=!0,!1}),n}const fqe=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ht,isCtrlKey:uqe,isCtrlMetaKey:Sce,isFunctionKey:SV,isKey:hg,isPrintableChar:_ce},Symbol.toStringTag,{value:"Module"}));function Es(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Oh(e){return e.isImmediatePropagationEnabled===!1}function gc(e){return e.button===2}function vA(e){return e.button===0}const cqe=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Oh,isLeftClick:vA,isRightClick:gc,stopImmediatePropagation:Es},Symbol.toStringTag,{value:"Module"}));function $w(e){return $w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$w(e)}var $K;function hqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vqe(n.key),n)}}function dqe(e,t,r){return t&&NK(e.prototype,t),r&&NK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vqe(e){var t=pqe(e,"string");return $w(t)==="symbol"?t:String(t)}function pqe(e,t){if($w(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($w(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gqe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Bv=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],yqe=Ir($K||($K=gqe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),A2=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),P2=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),Cce=function(){function e(){hqe(this,e),this.globalBucket=this.createEmptyBucket()}return dqe(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return ue(Bv,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))ue(n,function(l){return i.add(r,l,a)});else{A2.has(r)&&Fr(pV(yqe,{hookName:r,removedInVersion:A2.get(r)})),P2.has(r)&&Fr(P2.get(r));var o=this.getBucket(a);if(typeof o[r]>"u"&&(this.register(r),o[r]=[]),n.skip=!1,o[r].indexOf(n)===-1){var s=!1;n.initialHook&&ue(o[r],function(l,u){if(l.initialHook)return o[r][u]=n,s=!0,!1}),s||o[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?ue(n,function(o){return i.once(r,o,a)}):(n.runOnce=!0,this.add(r,n,a))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=this.getBucket(i);return typeof a[r]<"u"&&a[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,a,o,s,l,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=HE(f[h],r,i,a,o,s,l,u);d!==void 0&&(i=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],g=v?v.length:0,y=0;if(g)for(;y<g;){if(!v[y]||v[y].skip){y+=1;continue}var b=HE(v[y],r,i,a,o,s,l,u);b!==void 0&&(i=b),v[y]&&v[y].runOnce&&this.remove(n,v[y],r),y+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Gt(this.getBucket(r),function(n,i,a){return a[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||Bv.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&Bv.splice(Bv.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return P2.has(r)||A2.has(r)}},{key:"isRegistered",value:function(r){return Bv.indexOf(r)>=0}},{key:"getRegistered",value:function(){return Bv}}],[{key:"getSingleton",value:function(){return bqe()}}]),e}(),mqe=new Cce;function bqe(){return mqe}const ft=Cce;function LK(e){return Cqe(e)||Sqe(e)||_qe(e)||wqe()}function wqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _qe(e,t){if(e){if(typeof e=="string")return vL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vL(e,t)}}function Sqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cqe(e){if(Array.isArray(e))return vL(e)}function vL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I2=new Map;function zo(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";I2.has(e)||I2.set(e,new Map);var t=I2.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function i(s){return t.has(s)}function a(){return LK(t.keys())}function o(){return LK(t.values())}return{register:r,getItem:n,hasItem:i,getNames:a,getValues:o}}var pL=new WeakMap,C1=zo("editors"),xqe=C1.register,xce=C1.getItem,Tce=C1.hasItem,Tqe=C1.getNames;C1.getValues;function Oqe(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},ft.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function Oce(e,t){var r;if(typeof e=="function")pL.get(e)||ba(null,e),r=pL.get(e);else if(typeof e=="string")r=xce(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function BE(e){if(typeof e=="function")return e;if(!Tce(e))throw Error('No registered editor found under "'.concat(e,'" name'));return xce(e).getConstructor()}function ba(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new Oqe(t);typeof e=="string"&&xqe(e,r),pL.set(t,r)}function Nw(e){return Nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nw(e)}function Eqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kqe(n.key),n)}}function Rqe(e,t,r){return t&&FK(e.prototype,t),r&&FK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kqe(e){var t=Aqe(e,"string");return Nw(t)==="symbol"?t:String(t)}function Aqe(e,t){if(Nw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gO=0,Pqe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Eqe(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Rqe(e,[{key:"addEventListener",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,Iqe(l))}return typeof o!="boolean"&&!Wue()&&(o=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:o,eventManager:this}),r.addEventListener(n,s,o),gO+=1,function(){a.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===r){if(i&&i!==s.callback||a&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),gO-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),gO-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,a=r;i||(i=r.ownerDocument?r.ownerDocument:r,a=i.defaultView);var o={bubbles:!0,cancelable:n!=="mousemove",view:a,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),e}();function Iqe(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Es(this)},e}const un=Pqe;function Mqe(){return gO}function Lw(e){return Lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lw(e)}function Dqe(e,t){return Fqe(e)||Lqe(e,t)||Nqe(e,t)||$qe()}function $qe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nqe(e,t){if(e){if(typeof e=="string")return HK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HK(e,t)}}function HK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Fqe(e){if(Array.isArray(e))return e}function Hqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vqe(n.key),n)}}function Bqe(e,t,r){return t&&BK(e.prototype,t),r&&BK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vqe(e){var t=Wqe(e,"string");return Lw(t)==="symbol"?t:String(t)}function Wqe(e,t){if(Lw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pA="editorManager.navigation",Vb="editorManager.handlingEditor",gL=function(){function e(t,r,n){var i=this;Hqe(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new un(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var a=this.instance.getShortcutManager();a.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(o){!i.destroyed&&i.instance.isListening()&&i.openEditor("",o)}),this.instance.view._wt.update("onCellDblClick",function(o,s,l){return i.onCellDblClick(o,s,l)})}return Bqe(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),a=n.getContext("editor"),o={group:Vb};a.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],o),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),Es(l)}}],o)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(g){g&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance.runHooks("modifyGetCellCoords",i,a),s=i,l=a;if(Array.isArray(o)){var u=Dqe(o,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var f=this.instance.rootDocument.activeElement;if(f&&dA(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(i,a,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=Oce(h,this.instance),this.activeEditor.prepare(i,a,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var a=this.instance.getSelectedRangeLast().highlight,o=a.row,s=a.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance,s=o.rowIndexMapper,l=o.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(a));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var a=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!SV(i)&&!Sce(i)&&!a&&!this.isEditorOpened()){var o=this.instance.getShortcutManager(),s=o.getContext("editor"),l={runOnlyIf:function(){return lt(n.instance.getSelected())},group:pA};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),VK=new WeakMap;gL.getInstance=function(e,t,r){var n=VK.get(e);return n||(n=new gL(e,t,r),VK.set(e,n)),n};const jqe=gL;var Uqe=Ot,zqe=Aa,Ece=i1,Gqe=Lt,Yqe=Gqe(function(){Ece(1)});Uqe({target:"Object",stat:!0,forced:Yqe},{keys:function(t){return Ece(zqe(t))}});var Kqe=Gn,Xqe=Kk,qqe=Tn,Zqe=As,Jqe=zd,M2=Fn,Qqe=ka,eZe=Wd,tZe=A4,WK=Xk;Xqe("match",function(e,t,r){return[function(i){var a=Qqe(this),o=Zqe(i)?void 0:eZe(i,e);return o?Kqe(o,i,a):new RegExp(i)[e](M2(a))},function(n){var i=qqe(this),a=M2(n),o=r(t,i,a);if(o.done)return o.value;if(!i.global)return WK(i,a);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,f;(f=WK(i,a))!==null;){var c=M2(f[0]);l[u]=c,c===""&&(i.lastIndex=tZe(a,Jqe(i.lastIndex),s)),u++}return u===0?null:l}]});var rZe=Yd,nZe=Qa,iZe=Sc,aZe=Wo,oZe=Em,sZe=Math.min,yL=[].lastIndexOf,Rce=!!yL&&1/[1].lastIndexOf(1,-0)<0,lZe=oZe("lastIndexOf"),uZe=Rce||!lZe,fZe=uZe?function(t){if(Rce)return rZe(yL,this,arguments)||0;var r=nZe(this),n=aZe(r),i=n-1;for(arguments.length>1&&(i=sZe(i,iZe(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:yL,cZe=Ot,jK=fZe;cZe({target:"Array",proto:!0,forced:jK!==[].lastIndexOf},{lastIndexOf:jK});var hZe=Vd,dZe=Aa,vZe=qS,pZe=Wo,gZe=TypeError,UK=function(e){return function(t,r,n,i){hZe(r);var a=dZe(t),o=vZe(a),s=pZe(a),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in o){i=o[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw gZe("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in o&&(i=r(i,o[l],l,a));return i}},yZe={left:UK(!1),right:UK(!0)},mZe=Ot,bZe=yZe.left,wZe=Em,zK=ZS,_Ze=Eue,SZe=!_Ze&&zK>79&&zK<83,CZe=SZe||!wZe("reduce");mZe({target:"Array",proto:!0,forced:CZe},{reduce:function(t){var r=arguments.length;return bZe(this,t,r,r>1?arguments[1]:void 0)}});var xZe=Ot,TZe=Gd.findIndex,OZe=c1,mL="findIndex",kce=!0;mL in[]&&Array(1)[mL](function(){kce=!1});xZe({target:"Array",proto:!0,forced:kce},{findIndex:function(t){return TZe(this,t,arguments.length>1?arguments[1]:void 0)}});OZe(mL);function D2(e){return AZe(e)||kZe(e)||RZe(e)||EZe()}function EZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RZe(e,t){if(e){if(typeof e=="string")return bL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bL(e,t)}}function kZe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function AZe(e){if(Array.isArray(e))return bL(e)}function bL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ace={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},PZe=new RegExp(Object.keys(Ace).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function IZe(e){return(e&&e.nodeName||"")==="TABLE"}function wL(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),a=i.length,o=a>0?i[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<a;h+=1){for(var d=t&&h===0,v=[],g=0;g<o;g+=1){var y=!d&&r&&g===0,b="";if(d)b="<th>".concat(e.getColHeader(g-f),"</th>");else if(y)b="<th>".concat(e.getRowHeader(h-c),"</th>");else{var w=i[h][g],_=e.getCellMeta(h-c,g-f),x=_.hidden,T=_.rowspan,O=_.colspan;if(!x){var E=[];if(T&&E.push('rowspan="'.concat(T,'"')),O&&E.push('colspan="'.concat(O,'"')),Un(w))b="<td ".concat(E.join(" "),"></td>");else{var M=w.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b="<td ".concat(E.join(" "),">").concat(M,"</td>")}}}v.push(b)}var P=["<tr>"].concat(v,["</tr>"]).join("");d?l.splice(1,0,P):u.splice(-1,0,P)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function _L(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var i=e[n],a=i.length,o=[];n===0&&r.push("<tbody>");for(var s=0;s<a;s+=1){var l=i[s],u=Un(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");o.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(o,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function Pce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);var a=e;if(typeof a=="string"){var o=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(k){var F=k.match(/<td\b[^>]*?>/g)[0],H=k.substring(F.length,k.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),W="</td>";return"".concat(F).concat(H).concat(W)});i.insertAdjacentHTML("afterbegin","".concat(o)),a=i.querySelector("table")}if(!(!a||!IZe(a))){var s=i.querySelector('meta[name$="enerator"]'),l=a.querySelector("tbody th")!==null,u=a.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(k,F){return k+F.colSpan},0)-(l?1:0):0,c=a.tFoot&&Array.from(a.tFoot.rows)||[],h=[],d=!1,v=0,g=0;if(a.tHead){var y=Array.from(a.tHead.rows).filter(function(k){var F=k.querySelector("td")!==null;return F&&h.push(k),!F});v=y.length,d=v>0,v>1?r.nestedHeaders=Array.from(y).reduce(function(k,F){var H=Array.from(F.cells).reduce(function(W,Q,se){if(l&&se===0)return W;var we=Q.colSpan,pe=Q.innerHTML,me=we>1?{label:pe,colspan:we}:pe;return W.push(me),W},[]);return k.push(H),k},[]):d&&(r.colHeaders=Array.from(y[0].children).reduce(function(k,F,H){return l&&H===0||k.push(F.innerHTML),k},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var b=[].concat(h,D2(Array.from(a.tBodies).reduce(function(k,F){return k.push.apply(k,D2(Array.from(F.rows))),k},[])),D2(c));g=b.length;for(var w=new Array(g),_=0;_<g;_++)w[_]=new Array(f);for(var x=[],T=[],O=0;O<g;O++)for(var E=b[O],M=Array.from(E.cells),P=M.length,N=0;N<P;N++){var D=M[N],L=D.nodeName,V=D.innerHTML,ee=D.rowSpan,ie=D.colSpan,le=w[O].findIndex(function(k){return k===void 0});if(L==="TD"){if(ee>1||ie>1){for(var _e=O;_e<O+ee;_e++)if(_e<g)for(var U=le;U<le+ie;U++)w[_e][U]=null;var C=D.getAttribute("style"),R=C&&C.includes("mso-ignore:colspan");R||x.push({col:le,row:O,rowspan:ee,colspan:ie})}var I="";s&&/excel/gi.test(s.content)?I=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):I=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),w[O][le]=I.replace(PZe,function(k){return Ace[k]})}else T.push(V)}return x.length&&(r.mergeCells=x),T.length&&(r.rowHeaders=T),w.length&&(r.data=w),r}}const MZe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:_L,htmlToGridSettings:Pce,instanceToHTML:wL},Symbol.toStringTag,{value:"Module"}));function DZe(e){return FZe(e)||LZe(e)||NZe(e)||$Ze()}function $Ze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NZe(e,t){if(e){if(typeof e=="string")return SL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SL(e,t)}}function LZe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FZe(e){if(Array.isArray(e))return SL(e)}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CL(e){return CL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CL(e)}function ja(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=CL(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(DZe(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function Ice(e){return ja(e,[","])}function yt(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function VE(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function CV(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const HZe=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:ja,isNumericLike:Ice,rangeEach:yt,rangeEachReverse:VE,valueAccordingPercent:CV},Symbol.toStringTag,{value:"Module"}));function BZe(e){return jZe(e)||WZe(e)||Mce(e)||VZe()}function VZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WZe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jZe(e){if(Array.isArray(e))return xL(e)}function UZe(e,t){return YZe(e)||GZe(e,t)||Mce(e,t)||zZe()}function zZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mce(e,t){if(e){if(typeof e=="string")return xL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xL(e,t)}}function xL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function YZe(e){if(Array.isArray(e))return e}var TL="asc",KZe="desc",GK=new Map([[TL,[-1,1]],[KZe,[1,-1]]]),XZe=function(t){return"The priority '".concat(t,"' is already declared in a map.")},qZe=function(t){return"The priority '".concat(t,"' is not a number.")};function ZZe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=jr(t)?t:XZe,r=jr(r)?r:qZe;function i(o,s){if(!ja(o))throw new Error(r(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function a(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:TL,s=GK.get(o)||GK.get(TL),l=UZe(s,2),u=l[0],f=l[1];return BZe(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:i,getItems:a}}var JZe=Ot,QZe=Gd.find,eJe=c1,OL="find",Dce=!0;OL in[]&&Array(1)[OL](function(){Dce=!1});JZe({target:"Array",proto:!0,forced:Dce},{find:function(t){return QZe(this,t,arguments.length>1?arguments[1]:void 0)}});eJe(OL);function tJe(e){return iJe(e)||nJe(e)||$ce(e)||rJe()}function rJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iJe(e){if(Array.isArray(e))return EL(e)}function YK(e,t){return sJe(e)||oJe(e,t)||$ce(e,t)||aJe()}function aJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ce(e,t){if(e){if(typeof e=="string")return EL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EL(e,t)}}function EL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sJe(e){if(Array.isArray(e))return e}var lJe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function gA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=jr(t)?t:lJe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function i(f){return r.delete(f)}function a(){r.clear()}function o(f){var c=l().find(function(v){var g=YK(v,2),y=g[0],b=g[1];return f===b?y:!1})||[null],h=YK(c,1),d=h[0];return d}function s(f){return r.get(f)}function l(){return tJe(r)}function u(f){return r.has(f)}return{addItem:n,clear:a,getId:o,getItem:s,getItems:l,hasItem:u,removeItem:i}}function uJe(e){return dJe(e)||hJe(e)||cJe(e)||fJe()}function fJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cJe(e,t){if(e){if(typeof e=="string")return RL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RL(e,t)}}function hJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dJe(e){if(Array.isArray(e))return RL(e)}function RL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var vJe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function pJe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=jr(t)?t:vJe;function n(o){if(r.has(o))throw new Error(t(o));r.add(o)}function i(){return uJe(r)}function a(){r.clear()}return{addItem:n,clear:a,getItems:i}}function gJe(e,t){return bJe(e)||mJe(e,t)||Nce(e,t)||yJe()}function yJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function bJe(e){if(Array.isArray(e))return e}function KK(e){return SJe(e)||_Je(e)||Nce(e)||wJe()}function wJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nce(e,t){if(e){if(typeof e=="string")return kL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kL(e,t)}}function _Je(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SJe(e){if(Array.isArray(e))return kL(e)}function kL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xV=function(t){return'There is already registered "'.concat(t,'" plugin.')},CJe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},xJe=function(t){return'The priority "'.concat(t,'" is not a number.')},Lce=ZZe({errorPriorityExists:CJe,errorPriorityNaN:xJe}),Fce=pJe({errorItemExists:xV}),AL=gA({errorIdExists:xV});function TV(){return[].concat(KK(Lce.getItems()),KK(Fce.getItems()))}function x1(e){var t=Oa(e);return AL.getItem(t)}function TJe(e){return!!x1(e)}function dr(e,t,r){var n=EJe(e,t,r),i=gJe(n,3);e=i[0],t=i[1],r=i[2],x1(e)===void 0&&OJe(e,t,r)}function OJe(e,t,r){var n=Oa(e);if(AL.hasItem(n))throw new Error(xV(n));r===void 0?Fce.addItem(n):Lce.addItem(r,n),AL.addItem(n,t)}function EJe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var T1=zo("renderers"),RJe=T1.register,kJe=T1.getItem,Hce=T1.hasItem,AJe=T1.getNames;T1.getValues;function WE(e){if(typeof e=="function")return e;if(!Hce(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return kJe(e)}function Zs(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),RJe(e,t)}var O1=zo("validators"),PJe=O1.register,IJe=O1.getItem,Bce=O1.hasItem,MJe=O1.getNames;O1.getValues;function OV(e){if(typeof e=="function")return e;if(!Bce(e))throw Error('No registered validator found under "'.concat(e,'" name'));return IJe(e)}function Op(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),PJe(e,t)}var Eh=1,Ti=2;function Fw(e){return Fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fw(e)}function DJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NJe(n.key),n)}}function $Je(e,t,r){return t&&XK(e.prototype,t),r&&XK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NJe(e){var t=LJe(e,"string");return Fw(t)==="symbol"?t:String(t)}function LJe(e,t){if(Fw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vv=new WeakMap,FJe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;DJe(this,e),Vv.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:a,overrideFn:o,calculationType:s,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return $Je(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],a,o=0,s=0,l=Vv.get(this),u=l.calculationType,f=l.overrideFn,c=l.scrollOffset,h=Math.max(l.scrollOffset,0),d=l.totalColumns,v=l.viewportWidth,g=h>0?v+1:v,y=0;y<d;y++)if(a=this._getColumnWidth(y),r<=h&&u!==Ti&&(this.startColumn=y,o=a),r>=h&&r+(u===Ti?a:0)<=h+g&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,o=a),this.endColumn=y),i.push(r),r+=a,s=a,u!==Ti&&(this.endColumn=y),r>=h+v){n=!1;break}var b=c+v-g,w=u===Ti?0:s,_=u===Ti?o:0;if(b<-1*l.inlineStartOffset||c>i.at(-1)+w||-1*l.scrollOffset-l.viewportWidth>-1*_?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var x=i[this.endColumn]+a-i[this.startColumn-1];if((x<=v||u!==Ti)&&(this.startColumn-=1),x>v)break}u===Eh&&this.startColumn!==null&&f&&f(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=Vv.get(this),a=i.totalColumns,o=0,s=0;s<a;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:o+=l}var f=n-o;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(a-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,a=Vv.get(this),o=a.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=a.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Vv.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Vv.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const EV=FJe;function Hw(e){return Hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hw(e)}function HJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VJe(n.key),n)}}function BJe(e,t,r){return t&&qK(e.prototype,t),r&&qK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VJe(e){var t=WJe(e,"string");return Hw(t)==="symbol"?t:String(t)}function WJe(e,t){if(Hw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZK=new WeakMap,jJe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;HJe(this,e),ZK.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:a,overrideFn:o,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return BJe(e,[{key:"calculate",value:function(){for(var r=ZK.get(this),n=r.calculationType,i=r.overrideFn,a=r.rowHeightFn,o=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,g=0,y=0,b=0;b<l;b++)if(v=a(b),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=s&&n!==Ti&&(this.startRow=b,g=v),c>=s&&c+(n===Ti?v:0)<=s+u-f&&(this.startRow===null&&(this.startRow=b,g=v),this.endRow=b),d.push(c),c+=v,y=v,n!==Ti&&(this.endRow=b),c>=s+u-f){h=!1;break}var w=o+u-f,_=n===Ti?g:0,x=n===Ti?0:y;if(w<_||o>d.at(-1)+x?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var T=d[this.endRow]+v-d[this.startRow-1];if((T<=u-f||n!==Ti)&&(this.startRow-=1),T>=u-f)break}n===Eh&&this.startRow!==null&&i&&i(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const Vce=jJe;function Bw(e){return Bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bw(e)}function UJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wce(n.key),n)}}function zJe(e,t,r){return t&&JK(e.prototype,t),r&&JK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GJe(e,t,r){YJe(e,t),t.set(e,r)}function YJe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QK(e,t,r){return t=Wce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wce(e){var t=KJe(e,"string");return Bw(t)==="symbol"?t:String(t)}function KJe(e,t){if(Bw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $0(e,t){var r=jce(e,t,"get");return XJe(e,r)}function XJe(e,t){return t.get?t.get.call(e):t.value}function qJe(e,t,r){var n=jce(e,t,"set");return ZJe(e,n,r),r}function jce(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ZJe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ch=new WeakMap,JJe=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;UJe(this,e),QK(this,"row",null),QK(this,"col",null),GJe(this,ch,{writable:!0,value:!1}),qJe(this,ch,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return zJe(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&($0(this,ch)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&($0(this,ch)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&($0(this,ch)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&($0(this,ch)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,$0(this,ch))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const jE=JJe;function Vw(e){return Vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vw(e)}function QJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uce(n.key),n)}}function eQe(e,t,r){return t&&eX(e.prototype,t),r&&eX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tQe(e,t,r){rQe(e,t),t.set(e,r)}function rQe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $2(e,t,r){return t=Uce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uce(e){var t=nQe(e,"string");return Vw(t)==="symbol"?t:String(t)}function nQe(e,t){if(Vw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bs(e,t){var r=zce(e,t,"get");return iQe(e,r)}function iQe(e,t){return t.get?t.get.call(e):t.value}function aQe(e,t,r){var n=zce(e,t,"set");return oQe(e,n,r),r}function zce(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function oQe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var po=new WeakMap,sQe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;QJe(this,e),$2(this,"highlight",null),$2(this,"from",null),$2(this,"to",null),tQe(this,po,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),aQe(this,po,i)}return eQe(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,a=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return a.row<=n&&o.row>=n&&a.col<=i&&o.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=this.getDirection(),o=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),f=Math.max(i.row,s.row),c=Math.max(i.col,s.col),h=this._createCellCoords(l,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(a),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var a=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=a[0],this.to=a[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Bs(this,po)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Bs(this,po)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Bs(this,po)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Bs(this,po)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Bs(this,po)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Bs(this,po)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Bs(this,po)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Bs(this,po)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof jE))return!1;if(n){var i=n.from,a=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,a.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(a.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(a.row,a.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},a=[];return n.top===i.top&&a.push("top"),n.right===i.right&&a.push("right"),n.bottom===i.bottom&&a.push("bottom"),n.left===i.left&&a.push("left"),a}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)!(this.from.row===a&&this.from.col===o)&&!(this.to.row===a&&this.to.col===o)&&i.push(this._createCellCoords(a,o));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)r.row===a&&r.col===o?i.push(r):n.row===a&&n.col===o?i.push(n):i.push(this._createCellCoords(a,o));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=n.row;a<=i.row;a++)for(var o=n.col;o<=i.col;o++){var s=r(a,o);if(s===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Bs(this,po))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new jE(r,n,Bs(this,po))}}]),e}();const RV=sQe;var lQe=Ot,uQe=h4;lQe({target:"Object",stat:!0},{setPrototypeOf:uQe});var Gce=Yt,fQe=Vd,cQe=Ln,hQe=mn,tX=u1,dQe=YS,Yce=Function,vQe=Gce([].concat),pQe=Gce([].join),N2={},gQe=function(e,t,r){if(!hQe(N2,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";N2[t]=Yce("C,a","return new C("+pQe(n,",")+")")}return N2[t](e,r)},yQe=dQe?Yce.bind:function(t){var r=fQe(this),n=r.prototype,i=tX(arguments,1),a=function(){var s=vQe(i,tX(arguments));return this instanceof a?gQe(r,s.length,s):r.apply(t,s)};return cQe(n)&&(a.prototype=n),a},mQe=Ot,bQe=Vu,L2=Yd,wQe=yQe,rX=jue,_Qe=Tn,nX=Ln,SQe=xm,Kce=Lt,kV=bQe("Reflect","construct"),CQe=Object.prototype,xQe=[].push,Xce=Kce(function(){function e(){}return!(kV(function(){},[],e)instanceof e)}),qce=!Kce(function(){kV(function(){})}),iX=Xce||qce;mQe({target:"Reflect",stat:!0,forced:iX,sham:iX},{construct:function(t,r){rX(t),_Qe(r);var n=arguments.length<3?t:rX(arguments[2]);if(qce&&!Xce)return kV(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return L2(xQe,i,r),new(L2(wQe,t,i))}var a=n.prototype,o=SQe(nX(a)?a:CQe),s=L2(t,o,r);return nX(s)?s:o}});function Ww(e){return Ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ww(e)}function TQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EQe(n.key),n)}}function OQe(e,t,r){return t&&aX(e.prototype,t),r&&aX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EQe(e){var t=RQe(e,"string");return Ww(t)==="symbol"?t:String(t)}function RQe(e,t){if(Ww(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ww(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wv=new WeakMap,kQe=function(){function e(t,r,n,i,a,o){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;TQe(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=a,this.selections=o,this.parent=s,this.eventManager=i,this.facadeGetter=t,Wv.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return OQe(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(a){return r.onContextMenu(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(a){return r.onMouseOver(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(a){return r.onMouseOut(a)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(o){return r.onTouchStart(o)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(o){return r.onTouchEnd(o)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(o){return r.onMouseUp(o)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(o){return r.onMouseDown(o)})};ms()?n():(H4()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=Wv.get(this),i=this.parentCell(r),a=i.coords;if(n.selectedCellBeforeTouchEnd&&a){var o=[a.row,n.selectedCellBeforeTouchEnd.from.row],s=o[0],l=o[1],u=[a.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return s===l&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,a=hb(r,["TD","TH"],i);return a?(n.coords=this.wtTable.getCoords(a),n.TD=a):Pt(r,"wtBorder")&&Pt(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Pt(r,"wtBorder")&&Pt(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Wv.get(this),i=this.domBindings.rootDocument.activeElement,a=wV(ece,r.target),o=r.target;if(!(o===i||a(0)===i||a(1)===i)){var s=this.parentCell(o);Pt(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,o):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=hb(r.target,["TD","TH"],n),a=this.parent||this;i&&i!==a.lastMouseOver&&Kf(i,n)&&(a.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=hb(r.target,["TD","TH"],n),a=hb(r.relatedTarget,["TD","TH"],n);i&&i!==a&&Kf(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=Wv.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(Pt(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Wv.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,a=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=lt(a)&&a.row>=0&&a.col>=0,s=r.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];z4()&&(Zue()||Jue())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,a){var o=this.wtSettings.getSettingPure(r);o&&o(n,i,a,this.facadeGetter())}},{key:"destroy",value:function(){var r=Wv.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const Zce=kQe;function jw(e){return jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jw(e)}function AQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IQe(n.key),n)}}function PQe(e,t,r){return t&&oX(e.prototype,t),r&&oX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IQe(e){var t=MQe(e,"string");return jw(t)==="symbol"?t:String(t)}function MQe(e,t){if(jw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DQe=function(){function e(t,r,n){AQe(this,e),this.offset=t,this.total=r,this.countTH=n}return PQe(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const $Qe=DQe;function Uw(e){return Uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uw(e)}function NQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FQe(n.key),n)}}function LQe(e,t,r){return t&&sX(e.prototype,t),r&&sX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FQe(e){var t=HQe(e,"string");return Uw(t)==="symbol"?t:String(t)}function HQe(e,t){if(Uw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BQe=function(){function e(t,r,n){NQe(this,e),this.offset=t,this.total=r,this.countTH=n}return LQe(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const VQe=BQe;var WQe=0,UE=1,zE=2;function zw(e){return zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zw(e)}function jQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zQe(n.key),n)}}function UQe(e,t,r){return t&&lX(e.prototype,t),r&&lX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zQe(e){var t=GQe(e,"string");return zw(t)==="symbol"?t:String(t)}function GQe(e,t){if(zw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uX=function(){function e(){jQe(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return UQe(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function Gw(e){return Gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gw(e)}function YQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XQe(n.key),n)}}function KQe(e,t,r){return t&&fX(e.prototype,t),r&&fX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XQe(e){var t=qQe(e,"string");return Gw(t)==="symbol"?t:String(t)}function qQe(e,t){if(Gw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZQe=function(){function e(){YQe(this,e),this.size=new uX,this.workingSpace=WQe,this.sharedSize=null}return KQe(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof uX}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=UE,r.workingSpace=zE,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=zE,r.workingSpace=UE,this.sharedSize=r.getViewSize()}}]),e}();function Yw(e){return Yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yw(e)}function JQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eet(n.key),n)}}function QQe(e,t,r){return t&&cX(e.prototype,t),r&&cX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eet(e){var t=tet(e,"string");return Yw(t)==="symbol"?t:String(t)}function tet(e,t){if(Yw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jce=function(){function e(t,r,n){JQe(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new ZQe,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return QQe(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var a=r.firstElementChild;a;){if(a.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(UE))break;a=a.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),a=n.getViewSize(),o=a.nextSize,s=this.getRenderedChildCount();s<o;){var l=this.nodesPool();!i||i&&n.isPlaceOn(zE)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(UE);s>o;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(zE)&&(i+=n.sharedSize.nextSize);var a=r.childNodes[i];if(a.tagName!==this.childNodeType){var o=this.nodesPool();r.replaceChild(o,a),a=o}this.collectedNodes.push(a),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function dg(e){return dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dg(e)}function ret(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iet(n.key),n)}}function net(e,t,r){return t&&hX(e.prototype,t),r&&hX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iet(e){var t=aet(e,"string");return dg(t)==="symbol"?t:String(t)}function aet(e,t){if(dg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PL(e,t)}function PL(e,t){return PL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PL(e,t)}function set(e){var t=cet();return function(){var n=GE(e),i;if(t){var a=GE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return uet(this,i)}}function uet(e,t){if(t&&(dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fet(e)}function fet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function GE(e){return GE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GE(e)}var Qce=function(e){oet(r,e);var t=set(r);function r(){return ret(this,r),t.apply(this,arguments)}return net(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(Jce);function Kw(e){return Kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kw(e)}function het(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vet(n.key),n)}}function det(e,t,r){return t&&dX(e.prototype,t),r&&dX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vet(e){var t=pet(e,"string");return Kw(t)==="symbol"?t:String(t)}function pet(e,t){if(Kw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var get=function(){function e(t){het(this,e),this.nodeType=t.toUpperCase()}return det(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function Xw(e){return Xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xw(e)}function yet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bet(n.key),n)}}function met(e,t,r){return t&&vX(e.prototype,t),r&&vX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bet(e){var t=wet(e,"string");return Xw(t)==="symbol"?t:String(t)}function wet(e,t){if(Xw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E1=function(){function e(t,r){yet(this,e),this.nodesPool=typeof t=="string"?new get(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return met(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function vg(e){return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(e)}function _et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xet(n.key),n)}}function Cet(e,t,r){return t&&pX(e.prototype,t),r&&pX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xet(e){var t=Tet(e,"string");return vg(t)==="symbol"?t:String(t)}function Tet(e,t){if(vg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IL(e,t)}function IL(e,t){return IL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IL(e,t)}function Eet(e){var t=Aet();return function(){var n=YE(e),i;if(t){var a=YE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ret(this,i)}}function Ret(e,t){if(t&&(vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ket(e)}function ket(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function YE(e){return YE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YE(e)}var Pet=function(e){Oet(r,e);var t=Eet(r);function r(){var n;return _et(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Cet(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new Qce(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,f=0;f<a;f++){var c=this.table.renderedRowToSource(f),h=l.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var g=0;g<s;g++){d.render();var y=d.getCurrentNode();y.className="",y.removeAttribute("style"),o[g](c,y,g)}d.end()}}}]),r}(E1);function pg(e){return pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pg(e)}function Iet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Det(n.key),n)}}function Met(e,t,r){return t&&gX(e.prototype,t),r&&gX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Det(e){var t=$et(e,"string");return pg(t)==="symbol"?t:String(t)}function $et(e,t){if(pg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Net(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ML(e,t)}function ML(e,t){return ML=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ML(e,t)}function Let(e){var t=Bet();return function(){var n=KE(e),i;if(t){var a=KE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Fet(this,i)}}function Fet(e,t){if(t&&(pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Het(e)}function Het(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function KE(e){return KE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},KE(e)}var Vet=function(e){Net(r,e);var t=Let(r);function r(n){return Iet(this,r),t.call(this,null,n)}return Met(r,[{key:"adjust",value:function(){var i=this.table,a=i.columnHeadersCount,o=i.rowHeadersCount,s=this.rootNode.firstChild;if(a){for(var l=this.table.columnsToRender,u=l+o,f=0,c=a;f<c;f++){for(s=this.rootNode.childNodes[f],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>a)for(var d=a;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&Os(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,a=0;a<i;a+=1)for(var o=this.table,s=o.columnHeaderFunctions,l=o.columnsToRender,u=o.rowHeadersCount,f=this.rootNode.childNodes[a],c=-1*u;c<l;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),s[a](h,d,a)}}}]),r}(E1);function gg(e){return gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gg(e)}function Wet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uet(n.key),n)}}function jet(e,t,r){return t&&yX(e.prototype,t),r&&yX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uet(e){var t=zet(e,"string");return gg(t)==="symbol"?t:String(t)}function zet(e,t){if(gg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Get(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DL(e,t)}function DL(e,t){return DL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DL(e,t)}function Yet(e){var t=qet();return function(){var n=XE(e),i;if(t){var a=XE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ket(this,i)}}function Ket(e,t){if(t&&(gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xet(e)}function Xet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function XE(e){return XE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XE(e)}var Zet=function(e){Get(r,e);var t=Yet(r);function r(n){return Wet(this,r),t.call(this,null,n)}return jet(r,[{key:"adjust",value:function(){for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=a+o;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=0;s<o;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var f=0;f<a;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+o].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&Ue(d,"rowHeader")}}]),r}(E1);function yg(e){return yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yg(e)}var mX;function Jet(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Qet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ttt(n.key),n)}}function ett(e,t,r){return t&&bX(e.prototype,t),r&&bX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ttt(e){var t=rtt(e,"string");return yg(t)==="symbol"?t:String(t)}function rtt(e,t){if(yg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ntt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$L(e,t)}function $L(e,t){return $L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$L(e,t)}function itt(e){var t=stt();return function(){var n=qE(e),i;if(t){var a=qE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return att(this,i)}}function att(e,t){if(t&&(yg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ott(e)}function ott(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function stt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qE(e){return qE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qE(e)}var wX=!1,ltt=function(e){ntt(r,e);var t=itt(r);function r(n){var i;return Qet(this,r),i=t.call(this,"TR",n),i.orderView=new Jce(n,function(a){return i.nodesPool.obtain(a)},i.nodeType),i}return ett(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!wX&&i>1e3&&(wX=!0,Fr(Ir(mX||(mX=Jet([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var a=0;a<i;a++)this.orderView.render();this.orderView.end()}}]),r}(E1);function mg(e){return mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mg(e)}function utt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ctt(n.key),n)}}function ftt(e,t,r){return t&&_X(e.prototype,t),r&&_X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ctt(e){var t=htt(e,"string");return mg(t)==="symbol"?t:String(t)}function htt(e,t){if(mg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dtt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NL(e,t)}function NL(e,t){return NL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NL(e,t)}function vtt(e){var t=ytt();return function(){var n=ZE(e),i;if(t){var a=ZE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ptt(this,i)}}function ptt(e,t){if(t&&(mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gtt(e)}function gtt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ytt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ZE(e){return ZE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ZE(e)}var mtt=function(e){dtt(r,e);var t=vtt(r);function r(){var n;return utt(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return ftt(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new Qce(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<a;u++){var f=this.table.renderedRowToSource(u),c=s.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=l.obtainOrderView(c);h.prependView(d).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<o;v++){h.render();var g=h.getCurrentNode(),y=this.table.renderedColumnToSource(v);Pt(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),this.table.cellRenderer(f,y,g)}h.end()}}}]),r}(E1);function qw(e){return qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qw(e)}function btt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_tt(n.key),n)}}function wtt(e,t,r){return t&&SX(e.prototype,t),r&&SX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _tt(e){var t=Stt(e,"string");return qw(t)==="symbol"?t:String(t)}function Stt(e,t){if(qw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ctt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;btt(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return wtt(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,a=r.colGroup,o=r.rows,s=r.cells;n.setTable(this),i.setTable(this),a.setTable(this),o.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=a,this.rows=o,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var a=n.getRenderedNode(i);if(a.firstChild){var o=this.renderedRowToSource(i),s=this.rowUtils.getHeight(o);s?a.firstChild.style.height="".concat(s-1,"px"):a.firstChild.style.height=""}}}}]),e}();function Zw(e){return Zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zw(e)}function xtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ott(n.key),n)}}function Ttt(e,t,r){return t&&CX(e.prototype,t),r&&CX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ott(e){var t=Ett(e,"string");return Zw(t)==="symbol"?t:String(t)}function Ett(e,t){if(Zw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rtt=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,a=t.TBODY,o=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;xtt(this,e),this.renderer=new Ctt(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new Pet,columnHeaders:new Vet(n),colGroup:new Zet(i),rows:new ltt(a),cells:new mtt}),this.renderer.setAxisUtils(o,s)}return Ttt(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function Jw(e){return Jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jw(e)}function ktt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ptt(n.key),n)}}function Att(e,t,r){return t&&xX(e.prototype,t),r&&xX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ptt(e){var t=Itt(e,"string");return Jw(t)==="symbol"?t:String(t)}function Itt(e,t){if(Jw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mtt=function(){function e(t,r){ktt(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return Att(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var a=n.getStretchedColumnWidth(r,i);a&&(i=a)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,a=n.wtViewport,o=n.cloneSource,s=o?o.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?ei():0,u=r.getSetting("rowHeaderWidth");if(a.columnsRenderCalculator.refreshStretching(a.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function Qw(e){return Qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qw(e)}function Dtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ntt(n.key),n)}}function $tt(e,t,r){return t&&TX(e.prototype,t),r&&TX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ntt(e){var t=Ltt(e,"string");return Qw(t)==="symbol"?t:String(t)}function Ltt(e,t){if(Qw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ftt=function(){function e(t,r){Dtt(this,e),this.dataAccessObject=t,this.wtSettings=r}return $tt(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function e_(e){return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e_(e)}function Htt(e){return Wtt(e)||Vtt(e)||ehe(e)||Btt()}function Btt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vtt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wtt(e){if(Array.isArray(e))return LL(e)}function jtt(e,t){return Gtt(e)||ztt(e,t)||ehe(e,t)||Utt()}function Utt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ehe(e,t){if(e){if(typeof e=="string")return LL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LL(e,t)}}function LL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ztt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Gtt(e){if(Array.isArray(e))return e}function Ytt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,the(n.key),n)}}function Ktt(e,t,r){return t&&OX(e.prototype,t),r&&OX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vs(e,t,r){return t=the(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function the(e){var t=Xtt(e,"string");return e_(t)==="symbol"?t:String(t)}function Xtt(e,t){if(e_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(e_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qtt=function(){function e(t,r,n,i,a){var o=this;Ytt(this,e),Vs(this,"wtSettings",null),Vs(this,"domBindings",void 0),Vs(this,"TBODY",null),Vs(this,"THEAD",null),Vs(this,"COLGROUP",null),Vs(this,"hasTableHeight",!0),Vs(this,"hasTableWidth",!0),Vs(this,"isTableVisible",!1),Vs(this,"tableOffset",0),Vs(this,"holderOffset",0),this.domBindings=n,this.isMaster=a==="master",this.name=a,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,gV(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return o._modifyRowHeaderWidth(s)}),this.rowUtils=new Ftt(this.dataAccessObject,this.wtSettings),this.columnUtils=new Mtt(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Rtt({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Ktt(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,a=i.wtOverlays,o=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=Dn(this.holder),v=o.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var g=a.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,y!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=a.updateStateOfRendering()),v)this.isMaster&&o.createVisibleCalculators(),a&&a.refresh(!0);else{this.isMaster?this.tableOffset=Dn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var b=s>0?this.getFirstRenderedRow():0,w=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new VQe(b,s,h),this.columnFilter=new $Qe(w,l,f);var _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var x={};this.wtSettings.getSetting("beforeDraw",!0,x),_=x.skipRender!==!0}if(_){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(il)||this.is(Xf))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var T;if(this.isMaster&&(T=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(il))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var O=$r(this.hider),E=$r(this.TABLE);O!==0&&E!==O&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),T!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(il)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var M=!1;return this.isMaster&&(M=a.topOverlay.resetFixedPosition(),a.bottomOverlay.clone&&(M=a.bottomOverlay.resetFixedPosition()||M),M=a.inlineStartOverlay.resetFixedPosition()||M,a.topInlineStartCornerOverlay&&a.topInlineStartCornerOverlay.resetFixedPosition(),a.bottomInlineStartCornerOverlay&&a.bottomInlineStartCornerOverlay.clone&&a.bottomInlineStartCornerOverlay.resetFixedPosition()),M?(a.refreshAll(),a.adjustElementsSize()):this.refreshSelections(v),d&&a.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,a=this.wtSettings.getSetting("defaultRowHeight"),o,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=Jl(s),(!o&&a<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,a=r.getSetting("columnHeaders"),o=0,s=a.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height="".concat(i[o],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(il))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),a=0;a<i;a++){var o=this.rowFilter.renderedToSource(a);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,a=n.length;i<a;i++)Mt(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var a=Array.from(i),o=a.length;if(r){for(var s=[],l=0;l<o;l++){for(var u=a[l].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=a[l].classNames,v=d.length,g=0;g<v;g++)s.includes(d[g])||s.push(d[g]);f&&!s.includes(f)&&s.push(f),c&&!s.includes(c)&&s.push(c),h&&!s.includes(h)&&s.push(h)}var y=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(y))for(var b=0;b<y.length;b++)s.push(y[b]);for(var w=s.length,_=0;_<w;_++)this.removeClassFromCells(s[_])}for(var x=0;x<o;x++)a[x].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,a=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(a&&Array.isArray(a)){var o=jtt(a,2);n=o[0],i=o[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(a){var o=a.childNodes[i];o&&n.push(o)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return a==null?void 0:a.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,a=0;a<i;a++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=o==null?void 0:o.childNodes[a];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Yf(n,["TD","TH"])),n===null)return null;var i=n.parentNode,a=i.parentNode,o=rce(i),s=n.cellIndex;if(Tf(Td,n,this.wtRootElement)||Tf(Cd,n,this.wtRootElement))a.nodeName==="THEAD"&&(o-=a.childNodes.length);else if(Tf(Xf,n,this.wtRootElement)||Tf(il,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");o=l-a.childNodes.length+o}else a===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o);return Tf(Td,n,this.wtRootElement)||Tf(xd,n,this.wtRootElement)||Tf(Xf,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=Jl(this.TBODY)-1,a,o,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),a=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?o=Jl(u):o=Jl(l)-1,(!a&&this.wtSettings.getSetting("defaultRowHeight")<o||a<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return $r(this.TABLE)}},{key:"getHeight",value:function(){return ln(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=$r(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=ln(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return lg(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=jr(r)?r():null;return Array.isArray(n)?(n=Htt(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Pm=qtt;var Ztt="stickyRowsBottom",rhe={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};yl(rhe,"MIXIN_NAME",Ztt,{writable:!1,enumerable:!1});const nhe=rhe;var Jtt="stickyColumnsStart",ihe={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};yl(ihe,"MIXIN_NAME",Jtt,{writable:!1,enumerable:!1});const AV=ihe;function bg(e){return bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bg(e)}function EX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ert(n.key),n)}}function Qtt(e,t,r){return t&&EX(e.prototype,t),r&&EX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ert(e){var t=trt(e,"string");return bg(t)==="symbol"?t:String(t)}function trt(e,t){if(bg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FL(e,t)}function FL(e,t){return FL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FL(e,t)}function irt(e){var t=srt();return function(){var n=JE(e),i;if(t){var a=JE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return art(this,i)}}function art(e,t){if(t&&(bg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ort(e)}function ort(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function srt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function JE(e){return JE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},JE(e)}var PV=function(e){nrt(r,e);var t=irt(r);function r(n,i,a,o){return rrt(this,r),t.call(this,n,i,a,o,Xf)}return Qtt(r)}(Pm);Br(PV,nhe);Br(PV,AV);const lrt=PV;var Cd="top",il="bottom",xd="inline_start",Td="top_inline_start_corner",Xf="bottom_inline_start_corner",urt=[Cd,il,xd,Td,Xf],frt=new Map([[Cd,"ht_clone_".concat(Cd)],[il,"ht_clone_".concat(il)],[xd,"ht_clone_".concat(xd," ht_clone_left")],[Td,"ht_clone_".concat(Td," ht_clone_top_left_corner")],[Xf,"ht_clone_".concat(Xf," ht_clone_bottom_left_corner")]]);function t_(e){return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function crt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ahe(n.key),n)}}function hrt(e,t,r){return t&&RX(e.prototype,t),r&&RX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F2(e,t,r){return t=ahe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ahe(e){var t=drt(e,"string");return t_(t)==="symbol"?t:String(t)}function drt(e,t){if(t_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vrt=function(){function e(t){crt(this,e),F2(this,"dataAccessObject",void 0),F2(this,"lastScrolledColumnPos",-1),F2(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return hrt(e,[{key:"scrollViewport",value:function(r,n,i,a,o){var s=this.scrollViewportHorizontally(r.col,i,o),l=this.scrollViewportVertically(r.row,n,a);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalColumns;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return l===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<l||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalRows;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>s-h-1))return!1;var g=!1;return l===-1?g=v.scrollTo(r,f?r>this.lastScrolledRowPos:i):(f&&(r<l||r>u)||!f)&&(g=v.scrollTo(r,f?r>u:i)),g&&(this.lastScrolledRowPos=r),g}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var f=Dn(i.wtRootElement),c=Jl(i.hider),h=Jl(l),d=Iw(l,l);if(f.top+c-h<=d){var v=a.getColumnHeaderHeight();v+=n.sumCellSizes(0,s);for(var g=o;g>0;g--)if(v+=n.sumCellSizes(g-1,g),f.top+c-v<=d){u=g;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=Dn(i.wtRootElement),f=Iw(s,s);if(u.top>f){for(var c=Jl(s),h=a.getColumnHeaderHeight(),d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=Dn(i.wtRootElement),f=Bb(i.hider),c=Bb(s),h=Math.abs(FE(s,s));if(u.left+f-c<=h){for(var d=a.getRowHeaderWidth(),v=o;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){l=v;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,a=r.wtTable,o=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=a.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var f=n.getSetting("rtlMode"),c=null;if(f){var h=a.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var g=Dn(a.wtRootElement);c=g.left}var y=Math.abs(FE(l,l));if(c>y){for(var b=Bb(l),w=o.getRowHeaderWidth(),_=1;_<=s;_++)if(w+=i.sumCellSizes(_-1,_),c+w-y>=b){u=_-2;break}}}return u}}]),e}();const prt=vrt;function r_(e){return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r_(e)}function grt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ohe(n.key),n)}}function yrt(e,t,r){return t&&kX(e.prototype,t),r&&kX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rs(e,t,r){return t=ohe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ohe(e){var t=mrt(e,"string");return r_(t)==="symbol"?t:String(t)}function mrt(e,t){if(r_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IV=function(){function e(t,r){grt(this,e),rs(this,"wtTable",void 0),rs(this,"wtScroll",void 0),rs(this,"wtViewport",void 0),rs(this,"wtOverlays",void 0),rs(this,"selections",void 0),rs(this,"wtEvent",void 0),rs(this,"guid","wt_".concat(dV())),rs(this,"drawInterrupted",!1),rs(this,"drawn",!1),rs(this,"domBindings",void 0),rs(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new prt(this.createScrollDao())}return yrt(e,[{key:"eventManager",get:function(){return new un(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(a,o){vc(o,r[a])}])}}},{key:"createCellCoords",value:function(r,n){return new jE(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new RV(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),a=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<a&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<a)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,a,o){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function wg(e){return wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wg(e)}function AX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,she(n.key),n)}}function brt(e,t,r){return t&&AX(e.prototype,t),r&&AX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _rt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HL(e,t)}function HL(e,t){return HL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HL(e,t)}function Srt(e){var t=xrt();return function(){var n=QE(e),i;if(t){var a=QE(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Crt(this,i)}}function Crt(e,t){if(t&&(wg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yO(e)}function yO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function QE(e){return QE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QE(e)}function PX(e,t,r){return t=she(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function she(e){var t=Trt(e,"string");return wg(t)==="symbol"?t:String(t)}function Trt(e,t){if(wg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ort=function(e){_rt(r,e);var t=Srt(r);function r(n,i,a){var o;wrt(this,r),o=t.call(this,n,i),PX(yO(o),"cloneSource",void 0),PX(yO(o),"cloneOverlay",void 0);var s=o.wtSettings.getSetting("facade",yO(o));return o.cloneSource=a.source,o.cloneOverlay=a.overlay,o.wtTable=o.cloneOverlay.createTable(o.getTableDao(),s,o.domBindings,o.wtSettings),o.wtViewport=a.viewport,o.selections=a.selections,o.wtEvent=new Zce(s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections,a.event),o.findOriginalHeaders(),o}return brt(r)}(IV);function n_(e){return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}function Ert(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lhe(n.key),n)}}function Rrt(e,t,r){return t&&IX(e.prototype,t),r&&IX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function krt(e,t,r){return t=lhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lhe(e){var t=Art(e,"string");return n_(t)==="symbol"?t:String(t)}function Art(e,t){if(n_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R1=function(){function e(t,r,n,i,a){Ert(this,e),krt(this,"wtSettings",null),yl(this,"wot",t,{writable:!1}),this.domBindings=a,this.facadeGetter=r,this.wtSettings=i;var o=this.wot.wtTable,s=o.TABLE,l=o.hider,u=o.spreader,f=o.holder,c=o.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=fg(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Rrt(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=fg(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Mw(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){Fr("The provided element is not a child of the ".concat(this.type," overlay"));return}var a=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return a?h=this.getRelativeCellPositionWithinWindow(s,o,c,f):h=this.getRelativeCellPositionWithinHolder(s,l,o,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,a){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=a.start;else{var u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+ei())),s=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();l=f.top-o.top}else l=a.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,a,o){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-o.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=s.vertical-o.top);return{start:a.start-l,top:a.top-u}}},{key:"makeClone",value:function(){if(urt.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;o.className="".concat(frt.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,s.className=r.TABLE.className,o.appendChild(s),l.appendChild(o);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Cd||u==="vertical"&&this.type===xd?this.mainTableScrollableElement=a:a.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Mw(r.TABLE),new Ort(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,a=n.style,o=r.parentNode.style;ue([i,a,o],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function _g(e){return _g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_g(e)}function mO(e,t,r){return uhe()?mO=Reflect.construct.bind():mO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&eR(u,o.prototype),u},mO.apply(null,arguments)}function Prt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mrt(n.key),n)}}function Irt(e,t,r){return t&&MX(e.prototype,t),r&&MX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mrt(e){var t=Drt(e,"string");return _g(t)==="symbol"?t:String(t)}function Drt(e,t){if(_g(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $rt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eR(e,t)}function eR(e,t){return eR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eR(e,t)}function Nrt(e){var t=uhe();return function(){var n=tR(e),i;if(t){var a=tR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Lrt(this,i)}}function Lrt(e,t){if(t&&(_g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Frt(e)}function Frt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tR(e){return tR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tR(e)}var Hrt=function(e){$rt(r,e);var t=Nrt(r);function r(n,i,a,o,s,l){var u;return Prt(this,r),u=t.call(this,n,i,Xf,a,o),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return Irt(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return mO(lrt,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var a=this.clone.wtTable.holder.parentNode;if(a.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();a.style[this.isRtl()?"right":"left"]="".concat(o,"px"),a.style.bottom="".concat(s,"px")}else _1(a),this.repositionOverlay();var l=ln(this.clone.wtTable.TABLE),u=$r(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),a.style.height="".concat(l,"px"),a.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=ei(s)),l.style.bottom="".concat(u,"px")}}]),r}(R1),Brt="calculatedColumns",fhe={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};yl(fhe,"MIXIN_NAME",Brt,{writable:!1,enumerable:!1});const MV=fhe;function Sg(e){return Sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sg(e)}function DX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wrt(n.key),n)}}function Vrt(e,t,r){return t&&DX(e.prototype,t),r&&DX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wrt(e){var t=jrt(e,"string");return Sg(t)==="symbol"?t:String(t)}function jrt(e,t){if(Sg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Urt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BL(e,t)}function BL(e,t){return BL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BL(e,t)}function Grt(e){var t=Xrt();return function(){var n=rR(e),i;if(t){var a=rR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Yrt(this,i)}}function Yrt(e,t){if(t&&(Sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Krt(e)}function Krt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rR(e){return rR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rR(e)}var DV=function(e){zrt(r,e);var t=Grt(r);function r(n,i,a,o){return Urt(this,r),t.call(this,n,i,a,o,il)}return Vrt(r)}(Pm);Br(DV,nhe);Br(DV,MV);const qrt=DV;function Cg(e){return Cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cg(e)}function bO(e,t,r){return hhe()?bO=Reflect.construct.bind():bO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&nR(u,o.prototype),u},bO.apply(null,arguments)}function Zrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dhe(n.key),n)}}function Jrt(e,t,r){return t&&$X(e.prototype,t),r&&$X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nR(e,t)}function nR(e,t){return nR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nR(e,t)}function ent(e){var t=hhe();return function(){var n=iR(e),i;if(t){var a=iR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return tnt(this,i)}}function tnt(e,t){if(t&&(Cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return che(e)}function che(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iR(e){return iR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iR(e)}function rnt(e,t,r){return t=dhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dhe(e){var t=nnt(e,"string");return Cg(t)==="symbol"?t:String(t)}function nnt(e,t){if(Cg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var int=function(e){Qrt(r,e);var t=ent(r);function r(n,i,a,o){var s;return Zrt(this,r),s=t.call(this,n,i,il,a,o),rnt(che(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return Jrt(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return bO(qrt,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode;a.style.top="";var o=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(o=this.getOverlayOffset(),a.style.bottom="".concat(o,"px")):(o=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=ei(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a?(a.scrollTo(Sd(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wot,s=o.wtTable,l=o.wtSettings,u=l.getSetting("defaultRowHeight"),f=i,c=0;f<a;){var h=s.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,f=ei(l),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=o.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,a.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var g=ln(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(g=0),h.height="".concat(g,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;a&&l.offsetHeight!==l.clientHeight&&(u=ei(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Iw(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,f=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+s,0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==a,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((o||a===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,f=Pt(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(Ue(u,"innerBorderBottom"),l=!f):(Mt(u,"innerBorderBottom"),l=f)}return l}}]),r}(R1),ant="calculatedRows",vhe={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};yl(vhe,"MIXIN_NAME",ant,{writable:!1,enumerable:!1});const phe=vhe;function xg(e){return xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xg(e)}function NX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,snt(n.key),n)}}function ont(e,t,r){return t&&NX(e.prototype,t),r&&NX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function snt(e){var t=lnt(e,"string");return xg(t)==="symbol"?t:String(t)}function lnt(e,t){if(xg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function unt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VL(e,t)}function VL(e,t){return VL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},VL(e,t)}function cnt(e){var t=vnt();return function(){var n=aR(e),i;if(t){var a=aR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return hnt(this,i)}}function hnt(e,t){if(t&&(xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dnt(e)}function dnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function aR(e){return aR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aR(e)}var $V=function(e){fnt(r,e);var t=cnt(r);function r(n,i,a,o){return unt(this,r),t.call(this,n,i,a,o,xd)}return ont(r)}(Pm);Br($V,phe);Br($V,AV);const pnt=$V;function Tg(e){return Tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tg(e)}function wO(e,t,r){return ghe()?wO=Reflect.construct.bind():wO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&oR(u,o.prototype),u},wO.apply(null,arguments)}function gnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mnt(n.key),n)}}function ynt(e,t,r){return t&&LX(e.prototype,t),r&&LX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mnt(e){var t=bnt(e,"string");return Tg(t)==="symbol"?t:String(t)}function bnt(e,t){if(Tg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oR(e,t)}function oR(e,t){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oR(e,t)}function _nt(e){var t=ghe();return function(){var n=sR(e),i;if(t){var a=sR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Snt(this,i)}}function Snt(e,t){if(t&&(Tg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cnt(e)}function Cnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ghe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sR(e){return sR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sR(e)}var xnt=function(e){wnt(r,e);var t=_nt(r);function r(n,i,a,o){return gnt(this,r),t.call(this,n,i,xd,a,o)}return ynt(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return wO(pnt,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var a=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===a&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),hA(o,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),_1(o));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===a&&a.scrollX!==i?(a.scrollTo(i,ug(a)),o=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<a;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||o,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=ei(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=$r(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,a.style.height=a.parentNode.style.height,a.style.width="".concat(parseInt(a.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),a=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[a]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[a]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(a){var f=this.wot.wtTable.getColumnWidth(i),c=this.wot.wtViewport.getViewportWidth();f>c&&(a=!1)}return a&&l.offsetWidth!==l.clientWidth&&(u=ei(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),a=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(a=this.wot.wtTable.holderOffset.left),a}},{key:"getScrollPosition",value:function(){return Math.abs(FE(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="horizontal")){this.isRtl()?o=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?Mt(a,"emptyRows"):Ue(a,"emptyRows");var u=!1;if(s&&!o.length)Ue(a,"innerBorderLeft innerBorderInlineStart");else if(!s&&o.length){var f=Pt(a,"innerBorderInlineStart");i?(Ue(a,"innerBorderLeft innerBorderInlineStart"),u=!f):(Mt(a,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(R1),Tnt="stickyRowsTop",yhe={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};yl(yhe,"MIXIN_NAME",Tnt,{writable:!1,enumerable:!1});const mhe=yhe;function Og(e){return Og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Og(e)}function FX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ent(n.key),n)}}function Ont(e,t,r){return t&&FX(e.prototype,t),r&&FX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ent(e){var t=Rnt(e,"string");return Og(t)==="symbol"?t:String(t)}function Rnt(e,t){if(Og(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Og(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function knt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ant(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WL(e,t)}function WL(e,t){return WL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WL(e,t)}function Pnt(e){var t=Dnt();return function(){var n=lR(e),i;if(t){var a=lR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Int(this,i)}}function Int(e,t){if(t&&(Og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mnt(e)}function Mnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lR(e){return lR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lR(e)}var NV=function(e){Ant(r,e);var t=Pnt(r);function r(n,i,a,o){return knt(this,r),t.call(this,n,i,a,o,Td)}return Ont(r)}(Pm);Br(NV,mhe);Br(NV,AV);const $nt=NV;function Eg(e){return Eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eg(e)}function _O(e,t,r){return bhe()?_O=Reflect.construct.bind():_O=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&uR(u,o.prototype),u},_O.apply(null,arguments)}function Nnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,whe(n.key),n)}}function Lnt(e,t,r){return t&&HX(e.prototype,t),r&&HX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uR(e,t)}function uR(e,t){return uR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uR(e,t)}function Hnt(e){var t=bhe();return function(){var n=fR(e),i;if(t){var a=fR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Bnt(this,i)}}function Bnt(e,t){if(t&&(Eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jL(e)}function jL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fR(e){return fR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fR(e)}function BX(e,t,r){return t=whe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function whe(e){var t=Vnt(e,"string");return Eg(t)==="symbol"?t:String(t)}function Vnt(e,t){if(Eg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wnt=function(e){Fnt(r,e);var t=Hnt(r);function r(n,i,a,o,s,l){var u;return Nnt(this,r),u=t.call(this,n,i,Td,a,o),BX(jL(u),"topOverlay",void 0),BX(jL(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return Lnt(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return _O($nt,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();hA(i,"".concat(a,"px"),"".concat(o,"px"))}else _1(i);var s=ln(this.clone.wtTable.TABLE),l=$r(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}(R1);function Rg(e){return Rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rg(e)}function VX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Unt(n.key),n)}}function jnt(e,t,r){return t&&VX(e.prototype,t),r&&VX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Unt(e){var t=znt(e,"string");return Rg(t)==="symbol"?t:String(t)}function znt(e,t){if(Rg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ynt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UL(e,t)}function UL(e,t){return UL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UL(e,t)}function Knt(e){var t=Znt();return function(){var n=cR(e),i;if(t){var a=cR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Xnt(this,i)}}function Xnt(e,t){if(t&&(Rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qnt(e)}function qnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Znt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cR(e){return cR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cR(e)}var LV=function(e){Ynt(r,e);var t=Knt(r);function r(n,i,a,o){return Gnt(this,r),t.call(this,n,i,a,o,Cd)}return jnt(r)}(Pm);Br(LV,mhe);Br(LV,MV);const Jnt=LV;function kg(e){return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kg(e)}function SO(e,t,r){return She()?SO=Reflect.construct.bind():SO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&hR(u,o.prototype),u},SO.apply(null,arguments)}function Qnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Che(n.key),n)}}function eit(e,t,r){return t&&WX(e.prototype,t),r&&WX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hR(e,t)}function hR(e,t){return hR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hR(e,t)}function rit(e){var t=She();return function(){var n=dR(e),i;if(t){var a=dR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nit(this,i)}}function nit(e,t){if(t&&(kg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _he(e)}function _he(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function She(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dR(e){return dR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dR(e)}function iit(e,t,r){return t=Che(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Che(e){var t=ait(e,"string");return kg(t)==="symbol"?t:String(t)}function ait(e,t){if(kg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oit=function(e){tit(r,e);var t=rit(r);function r(n,i,a,o){var s;return Qnt(this,r),s=t.call(this,n,i,Cd,a,o),iit(_he(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return eit(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return SO(Jnt,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,a=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===a&&(!o||o!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=i.offsetHeight;l=c===h,s=this.getOverlayOffset(),hA(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),_1(i);var d=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a&&a.scrollY!==i?(a.scrollTo(Sd(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<a;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?o:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=ei(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=ln(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,a.style.width=a.parentNode.style.width,a.style.height="".concat(parseInt(a.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.wot,s=this.wtSettings,l=o.cloneSource?o.cloneSource:o,u=l.wtTable.holder,f=this.getTableParentOffset(),c=0;if(a){var h=this.wot.wtTable.getRowHeight(i),d=this.wot.wtViewport.getViewportHeight();h>d&&(a=!1)}if(a&&u.offsetHeight!==u.clientHeight&&(c=ei(this.domBindings.rootDocument)),a){var v=s.getSetting("fixedRowsBottom"),g=s.getSetting("totalRows");f+=this.sumCellSizes(0,i+1),f-=o.wtViewport.getViewportHeight()-this.sumCellSizes(g-v,g),f+=1}else f+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Iw(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?Mt(o,"emptyColumns"):Ue(o,"emptyColumns");var l=!1;if(!a){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=Pt(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(Ue(o,"innerBorderTop"),l=!h):(Mt(o,"innerBorderTop"),l=h)}}return l}}]),r}(R1);function i_(e){return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function kf(e,t,r){return sit()?kf=Reflect.construct.bind():kf=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&zL(u,o.prototype),u},kf.apply(null,arguments)}function sit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zL(e,t){return zL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zL(e,t)}function lit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xhe(n.key),n)}}function uit(e,t,r){return t&&jX(e.prototype,t),r&&jX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $l(e,t,r){return t=xhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xhe(e){var t=fit(e,"string");return i_(t)==="symbol"?t:String(t)}function fit(e,t){if(i_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cit=function(){function e(t,r,n,i,a,o){var s=this;lit(this,e),$l(this,"wot",null),$l(this,"topOverlay",null),$l(this,"bottomOverlay",null),$l(this,"inlineStartOverlay",null),$l(this,"topInlineStartCornerOverlay",null),$l(this,"bottomInlineStartCornerOverlay",null),$l(this,"browserLineHeight",void 0),$l(this,"wtSettings",null),$l(this,"resizeObserver",new ResizeObserver(function(h){Zk(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;var l=this.domBindings,u=l.rootDocument,f=l.rootWindow;this.instance=this.wot,this.eventManager=a,this.scrollbarSize=ei(u);var c=f.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:Mw(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return uit(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,a=n.getComputedStyle(i.body),o=parseInt(a.lineHeight,10),s=parseInt(a.fontSize,10)*1.2;this.browserLineHeight=o||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=kf(oit,r),this.bottomOverlay=kf(int,r),this.inlineStartOverlay=kf(xnt,r),this.topInlineStartCornerOverlay=kf(Wnt,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=kf(Hrt,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),o!==s&&this.eventManager.addEventListener(s,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var l=a.devicePixelRatio&&a.devicePixelRatio>1,u=this.scrollableElement===a,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||l||!U4())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var g=v.clone.wtTable.holder;r.eventManager.addEventListener(g,"wheel",function(y){return r.onCloneWheel(y,f)},c)}});var d;this.eventManager.addEventListener(a,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,o=r.target;this.keyPressed&&(a!==n&&o!==n&&!r.target.contains(a)||i!==n&&o!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,a=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=r.target,l=o!==i&&s!==i&&!s.contains(o),u=a!==i&&s!==i&&!s.contains(a);if(!(this.keyPressed&&(l||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=hg(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var a=this.scrollVertically(n),o=this.scrollHorizontally(i);return a||o}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,a=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=a[0],s=a[1];if(this.horizontalScrolling=n.scrollLeft!==o||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=o;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=o)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Mw(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,a=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return a&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),a}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,a=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,a),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var f=i.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=i.holder,v=d.scrollHeight,g=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<g,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return ue(n,function(a){a&&a.clone&&a.clone.wtTable.TABLE.contains(r)&&(i=a.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];ue(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const hit=cit;function a_(e){return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function dit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,The(n.key),n)}}function vit(e,t,r){return t&&UX(e.prototype,t),r&&UX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zX(e,t,r){return t=The(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function The(e){var t=pit(e,"string");return a_(t)==="symbol"?t:String(t)}function pit(e,t){if(a_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var git=function(){function e(t){var r=this;dit(this,e),zX(this,"settings",{}),zX(this,"defaults",Object.freeze(this.getDefaults())),Gt(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return vit(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,a,o){var s=r.getSetting("data",i,a);vc(o,s??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?Gt(r,function(a,o){i.settings[o]=a}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,a,o){return typeof this.settings[r]=="function"?this.settings[r](n,i,a,o):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Ag(e){return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}function yit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bit(n.key),n)}}function mit(e,t,r){return t&&GX(e.prototype,t),r&&GX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bit(e){var t=wit(e,"string");return Ag(t)==="symbol"?t:String(t)}function wit(e,t){if(Ag(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ag(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _it(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GL(e,t)}function GL(e,t){return GL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GL(e,t)}function Sit(e){var t=Tit();return function(){var n=vR(e),i;if(t){var a=vR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Cit(this,i)}}function Cit(e,t){if(t&&(Ag(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xit(e)}function xit(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vR(e){return vR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vR(e)}var FV=function(e){_it(r,e);var t=Sit(r);function r(n,i,a,o){return yit(this,r),t.call(this,n,i,a,o,"master")}return mit(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=fg(this.wtRootElement),a=this.domBindings.rootWindow;if(i===a){var o=this.wtSettings.getSetting("preventOverflow");o||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=cg(i,"height",a),u=cg(i,"overflow",a),f=this.holder.style,c=i.scrollWidth,h=i.scrollHeight,d=i.getBoundingClientRect(),v=d.width,g=d.height,y=["auto","hidden","scroll"];if(s&&y.includes(u)){var b=i.cloneNode(!1);b.style.overflow="auto",b.style.position="absolute",i.nextElementSibling?s.insertBefore(b,i.nextElementSibling):s.appendChild(b);var w=parseInt(pc(b,a).height,10);s.removeChild(b),w===0&&(g=0)}g=Math.min(g,h),f.height=l==="auto"?"auto":"".concat(g,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:g>0,this.hasTableWidth=v>0}this.isTableVisible=lg(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,a=this.dataAccessObject.wtViewport,o="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!a.hasOversizedColumnHeadersMarked[o]){for(var u=i.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<l;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);a.hasOversizedColumnHeadersMarked[o]=!0}}}]),r}(Pm);Br(FV,phe);Br(FV,MV);const Oit=FV;function o_(e){return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o_(e)}function Eit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kit(n.key),n)}}function Rit(e,t,r){return t&&YX(e.prototype,t),r&&YX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kit(e){var t=Ait(e,"string");return o_(t)==="symbol"?t:String(t)}function Ait(e,t){if(o_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(o_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pit=function(){function e(t,r,n,i,a){var o=this;Eit(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=a,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){o.clientHeight=o.getWorkspaceHeight()})}return Rit(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var a=ln(n);i=a>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-s:c.left,d=s-h,v,g;if(u)return $r(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,s):v=Math.min(this.getContainerFillWidth(),d,s),o===a&&l>0&&this.sumColumnWidths(0,l-1)>v)return i.documentElement.clientWidth;if(o!==a&&(g=cg(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",a),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(v,o.clientWidth);var y=r.getSetting("stretchH");return y==="none"||!y?Math.max(v,$r(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,a=r;a<n;)i+=this.wtTable.getColumnWidth(a),a+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return Dn(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ln(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,a=n.length;i<a;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)o?(this.rowHeaderWidth+=$r(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Eh,n=this.wtSettings,i=this.wtTable,a,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Eh?a=1/0:a=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,a-=s),f&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),a-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=ei(this.domBindings.rootDocument),new Vce({viewportSize:a,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return i.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:o})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Eh,n=this.wtSettings,i=this.wtTable,a=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&o>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=l,a-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(a-=ei(this.domBindings.rootDocument)),new EV({viewportSize:a,scrollOffset:o,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return i.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(Ti),a=this.createColumnsCalculator(Ti);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(a)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Eh),this.columnsRenderCalculator=this.createColumnsCalculator(Eh)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Ti),this.columnsVisibleCalculator=this.createColumnsCalculator(Ti)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.rowsRenderCalculator,s=o.startRow,l=o.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.columnsRenderCalculator,s=o.startColumn,l=o.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Gt(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const Iit=Pit;function Pg(e){return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pg(e)}function Mit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$it(n.key),n)}}function Dit(e,t,r){return t&&KX(e.prototype,t),r&&KX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $it(e){var t=Nit(e,"string");return Pg(t)==="symbol"?t:String(t)}function Nit(e,t){if(Pg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YL(e,t)}function YL(e,t){return YL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YL(e,t)}function Fit(e){var t=Bit();return function(){var n=pR(e),i;if(t){var a=pR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Hit(this,i)}}function Hit(e,t){if(t&&(Pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KL(e)}function KL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pR(e){return pR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pR(e)}var Vit=function(e){Lit(r,e);var t=Fit(r);function r(n,i){var a;Mit(this,r),a=t.call(this,n,new git(i));var o=a.wtSettings.getSetting("facade",KL(a));return a.wtTable=new Oit(a.getTableDao(),o,a.domBindings,a.wtSettings),a.wtViewport=new Iit(a.getViewportDao(),a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.selections=a.wtSettings.getSetting("selections"),a.wtEvent=new Zce(o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections),a.wtOverlays=new hit(KL(a),o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.exportSettingsAsClassNames(),a.findOriginalHeaders(),a}return Dit(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,a={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},o=[],s=[];Gt(a,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),o.push(l)}),Mt(this.wtTable.wtRootElement.parentNode,o),Ue(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(IV);function s_(e){return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function Wit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uit(n.key),n)}}function jit(e,t,r){return t&&XX(e.prototype,t),r&&XX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uit(e){var t=zit(e,"string");return s_(t)==="symbol"?t:String(t)}function zit(e,t){if(s_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Git=function(){function e(t){Wit(this,e),t instanceof IV?this._wot=t:this._initFromSettings(t)}return jit(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new Vit(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wot.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,a,o){return this._wot.wtSettings.getSetting(r,n,i,a,o)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),Yit=Nn,Ohe=Yt,Kit=i1,Xit=Qa,qit=KS.f,Zit=Ohe(qit),Jit=Ohe([].push),qX=function(e){return function(t){for(var r=Xit(t),n=Kit(r),i=n.length,a=0,o=[],s;i>a;)s=n[a++],(!Yit||Zit(r,s))&&Jit(o,e?[s,r[s]]:r[s]);return o}},Qit={entries:qX(!0),values:qX(!1)},eat=Ot,tat=Qit.values;eat({target:"Object",stat:!0},{values:function(t){return tat(t)}});function l_(e){return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function H2(e,t){return aat(e)||iat(e,t)||nat(e,t)||rat()}function rat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nat(e,t){if(e){if(typeof e=="string")return ZX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZX(e,t)}}function ZX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iat(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function aat(e){if(Array.isArray(e))return e}function oat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lat(n.key),n)}}function sat(e,t,r){return t&&JX(e.prototype,t),r&&JX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lat(e){var t=uat(e,"string");return l_(t)==="symbol"?t:String(t)}function uat(e,t){if(l_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fat=function(){function e(t,r){oat(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return sat(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[l])})},a=0,o=this.main.childNodes.length;a<o;a++)i(a)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Es(r);var i=this,a=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(a,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(a,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],a=this.main.style;a.position="absolute",a.top=0,a.left=0;for(var o=0;o<5;o++){var s=i[o],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),a=l.style,a.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,a.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),a.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ms()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,a=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(a,"px"),width:"".concat(a,"px"),"border-radius":"".concat(parseInt(a/1.5,10),"px")};Gt(o,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Gt(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,a,o,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,g=parseInt(c.borderWidth,10),y=parseInt(c.width,10),b=parseInt(h.width,10),w=this.wot.wtTable.getWidth(),_=this.wot.wtTable.getHeight();c.top="".concat(parseInt(i-y-1,10),"px"),c[u]="".concat(parseInt(a-y-1,10),"px"),h.top="".concat(parseInt(i-b/4*3,10),"px"),h[u]="".concat(parseInt(a-b/4*3,10),"px");var x=Math.min(parseInt(a+o,10),w-y-g*2),T=Math.min(parseInt(a+o-b/4,10),w-b-g*2);d[u]="".concat(x,"px"),v[u]="".concat(T,"px");var O=Math.min(parseInt(i+s,10),_-y-g*2),E=Math.min(parseInt(i+s-b/4,10),_-b-g*2);d.top="".concat(O,"px"),v.top="".concat(E,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,a=n.rootDocument,o=n.rootWindow,s,l,u,f,c,h,d=i.getRenderedRowsCount(),v=0;v<d;v+=1){var g=i.rowFilter.renderedToSource(v);if(g>=r[0]&&g<=r[2]){s=g,c=r[0];break}}for(var y=d-1;y>=0;y-=1){var b=i.rowFilter.renderedToSource(y);if(b>=r[0]&&b<=r[2]){l=b;break}}for(var w=i.getRenderedColumnsCount(),_=0;_<w;_+=1){var x=i.columnFilter.renderedToSource(_);if(x>=r[1]&&x<=r[3]){u=x,h=r[1];break}}for(var T=w-1;T>=0;T-=1){var O=i.columnFilter.renderedToSource(T);if(O>=r[1]&&O<=r[3]){f=O;break}}if(s===void 0||u===void 0){this.disappear();return}var E=i.getCell(this.wot.createCellCoords(s,u)),M=s!==l||u!==f,P=M?i.getCell(this.wot.createCellCoords(l,f)):E,N=Dn(E),D=M?Dn(P):N,L=Dn(i.TABLE),V=$r(i.TABLE),ee=N.top,ie=N.left,le=this.wot.wtSettings.getSetting("rtlMode"),_e=0,U=0;if(le){var C=$r(E),R=o.innerWidth-L.left-V;U=ie+C-D.left,_e=o.innerWidth-ie-C-R-1}else U=D.left+$r(P)-ie,_e=ie-L.left-1;if(this.isEntireColumnSelected(s,l)){var I=this.getDimensionsFromHeader("columns",u,f,c,L),k=null;if(I){var F=H2(I,3);k=F[0],_e=F[1],U=F[2]}k&&(E=k)}var H=ee-L.top-1,W=D.top+ln(P)-ee;if(this.isEntireRowSelected(u,f)){var Q=this.getDimensionsFromHeader("rows",s,l,h,L),se=null;if(Q){var we=H2(Q,3);se=we[0],H=we[1],W=we[2]}se&&(E=se)}var pe=pc(E,o);parseInt(pe.borderTopWidth,10)>0&&(H+=1,W=W>0?W-1:0),parseInt(pe[le?"borderRightWidth":"borderLeftWidth"],10)>0&&(_e+=1,U=U>0?U-1:0);var me=le?"right":"left";this.topStyle.top="".concat(H,"px"),this.topStyle[me]="".concat(_e,"px"),this.topStyle.width="".concat(U,"px"),this.topStyle.display="block",this.startStyle.top="".concat(H,"px"),this.startStyle[me]="".concat(_e,"px"),this.startStyle.height="".concat(W,"px"),this.startStyle.display="block";var Ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(H+W-Ie,"px"),this.bottomStyle[me]="".concat(_e,"px"),this.bottomStyle.width="".concat(U,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(H,"px"),this.endStyle[me]="".concat(_e+U-Ie,"px"),this.endStyle.height="".concat(W+1,"px"),this.endStyle.display="block";var z=this.settings.border.cornerVisible;z=typeof z=="function"?z(this.settings.layerLevel):z;var Le=this.wot.getSetting("onModifyGetCellCoords",l,f),ye=l,Xe=f;if(Le&&Array.isArray(Le)){var Ge=H2(Le,4);ye=Ge[2],Xe=Ge[3]}if(ms()||!z||this.isPartRange(ye,Xe))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(H+W+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[me]="".concat(_e+U+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var De=fg(i.TABLE),tt=De===o;tt&&(De=a.documentElement);var Qe=parseInt(this.cornerDefaultStyle.width,10)/2,G=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var Z=tt?P.getBoundingClientRect().left:P.offsetLeft,ae=!1,Se=0;le?(Se=Z-parseInt(this.cornerDefaultStyle.width,10)/2,ae=Se<0):(Se=Z+$r(P)+parseInt(this.cornerDefaultStyle.width,10)/2,ae=Se>=Bb(De)),ae&&(this.cornerStyle[me]="".concat(Math.floor(_e+U+this.cornerCenterPointOffset-Qe),"px"),this.cornerStyle[le?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var fe=tt?P.getBoundingClientRect().top:P.offsetTop,Te=fe+ln(P)+parseInt(this.cornerDefaultStyle.height,10)/2,ve=Te>=Jl(De);ve&&(this.cornerStyle.top="".concat(Math.floor(H+W+this.cornerCenterPointOffset-G),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}ms()&&this.updateMultipleSelectionHandlesPosition(l,f,H,_e,U,W)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,a,o){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,g=null,y=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},f=function(){return ln.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},f=function(){return $r.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(l.classList.contains(c)){var b=this.wot.getSetting("columnHeaders").length;if(g=u(n,b-a),y=u(i,b-a),!g||!y)return!1;var w=Dn(g),_=Dn(y);return g&&y&&(h=w[v]-o[v]-1,d=_[v]+f(y)-w[v]),[g,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,a=n[r];!a||a.hide?Ue(this[r],"hidden"):(Pt(this[r],"hidden")&&Mt(this[r],"hidden"),i.backgroundColor=a.color,(r==="top"||r==="bottom")&&(i.height="".concat(a.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(a.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?Ue(this[r],"hidden"):Mt(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ms()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const cat=fat;function hat(e,t){return gat(e)||pat(e,t)||vat(e,t)||dat()}function dat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vat(e,t){if(e){if(typeof e=="string")return QX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QX(e,t)}}function QX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pat(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function gat(e){if(Array.isArray(e))return e}function Ig(e){return Ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ig(e)}function yat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bat(n.key),n)}}function mat(e,t,r){return t&&eq(e.prototype,t),r&&eq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bat(e){var t=wat(e,"string");return Ig(t)==="symbol"?t:String(t)}function wat(e,t){if(Ig(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ig(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _at=function(){function e(t,r){yat(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return mat(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new cat(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(Ig(s)==="object"){var l=a;o&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),Ue(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||o===0)return r;var s=o>=0?o:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(Pt(a,u)){var f=s+1;l="".concat(r,"-").concat(f)}else l=i(a,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),a=this.getCorners(),o=hat(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,g=c.highlightOnlyClosestHeader,y=c.selectionType,b=y===void 0||["active-header","header"].includes(y);if(b&&l!==null&&f!==null)for(var w=0,_=0;_<i;_+=1){var x=r.wtTable.columnFilter.renderedToSource(_);if(x>=l&&x<=f){var T=r.wtTable.getColumnHeaders(x),O=T.length-1;g&&T.length>1&&(T=[T[O]]);for(var E=0;E<T.length;E+=1){var M=[],P=T[E];h&&M.push(h),d&&M.push(d),E=g?O:E;var N=r.getSetting("onBeforeHighlightingColumnHeader",x,E,{selectionType:y,columnCursor:w,selectionWidth:f-l+1,classNames:M});N!==x&&(P=r.wtTable.getColumnHeader(N,E)),Ue(P,M)}w+=1}}if(s!==null&&u!==null)for(var D=0,L=0;L<n;L+=1){var V=r.wtTable.rowFilter.renderedToSource(L);if(b&&V>=s&&V<=u){var ee=r.wtTable.getRowHeaders(V),ie=ee.length-1;g&&ee.length>1&&(ee=[ee[ie]]);for(var le=0;le<ee.length;le+=1){var _e=[],U=ee[le];h&&_e.push(h),v&&_e.push(v),le=g?ie:le;var C=r.getSetting("onBeforeHighlightingRowHeader",V,le,{selectionType:y,rowCursor:D,selectionHeight:u-s+1,classNames:_e});C!==V&&(U=r.wtTable.getRowHeader(C,le)),Ue(U,_e)}D+=1}if(l!==null&&f!==null)for(var R=0;R<i;R+=1){var I=r.wtTable.columnFilter.renderedToSource(R);V>=s&&V<=u&&I>=l&&I<=f?this.settings.className&&this.addClassAtCoords(r,V,I,this.settings.className,this.settings.markIntersections):V>=s&&V<=u?v&&this.addClassAtCoords(r,V,I,v):I>=l&&I<=f&&d&&this.addClassAtCoords(r,V,I,d);var k=r.getSetting("onAfterDrawSelection",V,I,this.settings.layerLevel);typeof k=="string"&&this.addClassAtCoords(r,V,I,k)}}r.getSetting("onBeforeDrawBorders",a,this.settings.className),this.settings.border&&this.getBorder(r).appear(a)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const Sat=_at;function tq(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,a=e.selection,o=e.controller,s=e.cellCoordsFactory,l=a.isSelected()?a.getSelectedRange().current():null,u=a.isSelectedByCorner(),f=a.isSelectedByRowHeader();if(t&&l)i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(i):(u||f)&&i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!o.column?a.setRangeEnd(s(l.to.row,i.col)):f&&i.col<0&&!o.row?a.setRangeEnd(s(i.row,l.to.col)):(!u&&!f&&i.col<0||u&&i.col<0)&&!o.row?a.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!f&&i.row<0||f&&i.row<0)&&!o.column&&a.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var c=!a.inInSelection(i),h=r||n&&c;i.row<0&&i.col>=0&&!o.column?h&&a.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?h&&a.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?h&&a.setRangeStart(i):i.col<0&&i.row<0&&a.selectAll(!0,!0)}}function Cat(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,a=e.cellCoordsFactory;if(t){var o=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(a(u-1,r.col)):o&&!i.row?n.setRangeEnd(a(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var xat=new Map([["mousedown",tq],["mouseover",Cat],["touchstart",tq]]);function rq(e,t){var r=t.coords,n=t.selection,i=t.controller,a=t.cellCoordsFactory;xat.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:a,isShiftKey:e.shiftKey,isLeftClick:vA(e)||e.type==="touchstart",isRightClick:gc(e)})}var Ehe=new WeakMap,HV=Symbol("rootInstance");function Tat(e){Ehe.set(e,!0)}function Oat(e){return e===HV}function XL(e){return Ehe.has(e)}function u_(e){return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(e)}function N0(e,t){return kat(e)||Rat(e,t)||Rhe(e,t)||Eat()}function Eat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rat(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function kat(e){if(Array.isArray(e))return e}function nq(e){return Iat(e)||Pat(e)||Rhe(e)||Aat()}function Aat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rhe(e,t){if(e){if(typeof e=="string")return qL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qL(e,t)}}function Pat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Iat(e){if(Array.isArray(e))return qL(e)}function qL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,khe(n.key),n)}}function Dat(e,t,r){return t&&iq(e.prototype,t),r&&iq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aq(e,t,r){$at(e,t),t.set(e,r)}function $at(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pf(e,t,r){return t=khe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function khe(e){var t=Nat(e,"string");return u_(t)==="symbol"?t:String(t)}function Nat(e,t){if(u_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(u_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oq(e,t){var r=Ahe(e,t,"get");return Lat(e,r)}function Lat(e,t){return t.get?t.get.call(e):t.value}function sq(e,t,r){var n=Ahe(e,t,"set");return Fat(e,n,r),r}function Ahe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Fat(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var hh=new WeakMap,B2=new WeakMap,V2=new WeakMap,Hat=function(){function e(t){Mat(this,e),pf(this,"instance",void 0),pf(this,"eventManager",void 0),pf(this,"settings",void 0),pf(this,"THEAD",void 0),pf(this,"TBODY",void 0),pf(this,"_wt",void 0),pf(this,"activeWt",void 0),aq(this,B2,{writable:!0,value:0}),aq(this,V2,{writable:!0,value:0}),pf(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new un(this.instance),this.settings=this.instance.getSettings(),hh.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Dat(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wt.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=hh.get(this),n=this.instance,i=n.rootElement,a=n.rootDocument,o=i.getAttribute("style");o&&i.setAttribute("data-originalstyle",o),Ue(i,"handsontable"),r.table=a.createElement("TABLE"),Ue(r.table,"htCore"),this.instance.getSettings().tableClassName&&Ue(r.table,this.instance.getSettings().tableClassName),this.THEAD=a.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=a.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=hh.get(this),i=this.instance,a=i.rootElement,o=i.rootDocument,s=i.selection,l=o.documentElement;this.eventManager.addEventListener(a,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;dL(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(a,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(a,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&dL(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&vA(u)&&s.finish(),n.mouseDown=!1,(dA(o.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!a.contains(u.target)&&!gc(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&gc(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!a||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var g=ei(o);if(o.elementFromPoint(c+g,h)!==v||o.elementFromPoint(c,h+g)!==v)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===a)return;d=d.parentNode}var y=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;y?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Dw(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,a=r.col;return(n=this.instance)._createCellCoords.apply(n,nq(this.translateFromRenderableToVisualIndex(i,a)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,a=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),a===null&&(a=n),[i,a]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),a=r.getNearestNotHiddenIndex(i-1,-1);return a===null?0:r.getRenderableFromVisualIndex(a)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,a){if(isNaN(r)||r<0)return 0;var o=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=a-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=hh.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return XL(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,nq(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),sq(r,V2,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),sq(r,B2,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=N0(d,2),g=v[0],y=v[1],b=r.instance.runHooks("modifyGetCellCoords",g,y),w=g,_=y;if(Array.isArray(b)){var x=N0(b,2);w=x[0],_=x[1]}var T=r.instance.getCellMeta(w,_),O=r.instance.colToProp(_),E=r.instance.getDataAtRowProp(w,O);r.instance.hasHook("beforeValueRender")&&(E=r.instance.runHooks("beforeValueRender",E,T)),r.instance.runHooks("beforeRenderer",h,g,y,O,E,T),r.instance.getCellRenderer(T)(r.instance,h,g,y,O,E,T),r.instance.runHooks("afterRenderer",h,g,y,O,E,T)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,g),!Oh(f)&&(rq(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(b,w){return r.instance._createCellCoords(b,w)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!Oh(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!Oh(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,g),!Oh(f)&&(n.mouseDown&&rq(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(b,w){return r.instance._createCellCoords(b,w)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(Oh(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),g=N0(v,2),y=g[0],b=g[1],w=r.instance.selection.getSelectedRange(),_=w.size();if(_>0){var x=(h??0)+1-_,T=w.peekByIndex(x);d=[T.from.row,T.from.col,T.to.row,T.to.col]}return r.instance.runHooks("afterDrawSelection",y,b,d,h)},onBeforeDrawBorders:function(f,c){var h=N0(f,4),d=h[0],v=h[1],g=h[2],y=h[3],b=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(g),r.instance.columnIndexMapper.getVisualFromRenderableIndex(y)];return r.instance.runHooks("beforeDrawBorders",b,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,g=c>=0?v.getVisualFromRenderableIndex(c):c,y=f>=0?d.getVisualFromRenderableIndex(f):f,b=r.instance.runHooks("modifyGetCellCoords",y,g,h);if(Array.isArray(b)){var w=N0(b,4),_=w[0],x=w[1],T=w[2],O=w[3];return[_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,1)):_,x>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(x,1)):x,T>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(T,-1)):T,O>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(O,-1)):O]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var g=Math.ceil(v/h*12);f.startRow=Math.max(d-g,0),f.endRow=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var g=Math.ceil(v/h*6);f.startColumn=Math.max(d-g,0),f.endColumn=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new Git(i),this.activeWt=this._wt;var a=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),s=o.width,l=o.height;this.setLastSize(s,l),this.eventManager.addEventListener(a,"mousedown",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(a,"contextmenu",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Dw(r))return!0;var n=Kf(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return hh.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!Pt(i,"relative")){Os(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var a=this.instance,o=a.rootDocument,s=a.getRowHeader,l=o.createElement("div"),u=o.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var o=n.firstChild;Pt(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),r,i,a):(Os(n),this.appendColHeader(r,n,i,a))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,a),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,a)}},{key:"updateCellHeader",value:function(r,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Pt(r,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Pt(r,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Xd(r,i(n,a)):(vc(r,String.fromCharCode(160)),Ue(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=hh.get(this),a=[r,n];i.lastWidth=a[0],i.lastHeight=a[1]}},{key:"getLastSize",value:function(){var r=hh.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return oq(this,B2)}},{key:"getRowHeadersCount",value:function(){return oq(this,V2)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const Bat=Hat;function ZL(e){return ZL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZL(e)}var Phe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",JL=Phe.length;function yA(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%JL,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/JL,10);return r}function Vat(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(JL,n)*(Phe.indexOf(e[r])+1);return t-=1,t}function Wat(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a=[];for(i=0;i<t;i++)a.push(yA(i)+(n+1));r.push(a)}return r}function jat(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a={};for(i=0;i<t;i++)a["prop".concat(i)]=yA(i)+(n+1);r.push(a)}return r}function Uat(e,t){for(var r=[],n,i=0;i<e;i++){n=[];for(var a=0;a<t;a++)n.push("");r.push(n)}return r}function QL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(i,a){Array.isArray(i)?i.forEach(function(o,s){n.push([a+t,s,o])}):Object.keys(i).forEach(function(o){n.push([a+t,o,i[o]])})}),n}function BV(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&zt(e[0])&&(t=Jk(e[0]))),t}function Ihe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function Mhe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return ZL(t)==="object"&&!Array.isArray(t)&&t!==null}))}const zat=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:BV,createEmptySpreadsheetData:Uat,createSpreadsheetData:Wat,createSpreadsheetObjectData:jat,dataRowToChangesArray:QL,isArrayOfArrays:Ihe,isArrayOfObjects:Mhe,spreadsheetColumnIndex:Vat,spreadsheetColumnLabel:yA},Symbol.toStringTag,{value:"Module"}));function f_(e){return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f_(e)}function Gat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kat(n.key),n)}}function Yat(e,t,r){return t&&lq(e.prototype,t),r&&lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kat(e){var t=Xat(e,"string");return f_(t)==="symbol"?t:String(t)}function Xat(e,t){if(f_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qat=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Gat(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Yat(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return ue(this.data,function(a,o){var s=n.getAtCell(o,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=a.getAtPhysicalCell(r,d,l)}):yt(n,i,function(h){u[h-n]=a.getAtPhysicalCell(r,h,l)});else if(zt(l)||jr(l))if(o?u=[]:u={},!s||o){var f=0,c=this.countFirstRowKeys()-1;yt(f,c,function(h){var d=a.colToProp(h);if(h>=(n||f)&&h<=(i||c)&&!Number.isInteger(d)){var v=a.getAtPhysicalCell(r,d,l);o?u.push(v):sO(u,d,v)}})}else Gt(l,function(h,d){sO(u,d,a.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var a=_d(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),a,"set"),a.isTouched()&&(i=a.value)}Number.isInteger(n)?this.data[r][n]=i:sO(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var a=null;if(i&&(typeof n=="string"?a=Kue(i,n):typeof n=="function"?a=n(i):a=i[n]),this.hot.hasHook("modifySourceData")){var o=_d(a);this.hot.runHooks("modifySourceData",r,this.colToProp(n),o,"get"),o.isTouched()&&(a=o.value)}return a}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=null,l=null,u=null,f=null;n===null||i===null?(o=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),f=Math.max(n.col,i.col));var c=[];return yt(s,u,function(h){c.push(o?r.getAtRow(h,void 0,void 0,a):r.getAtRow(h,l,f,a))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return BV(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const Zat=qat;var uq=mn,Jat=function(e){return e!==void 0&&(uq(e,"value")||uq(e,"writable"))},Qat=Ot,eot=Gn,tot=Ln,rot=Tn,not=Jat,iot=pl,aot=Wk;function Dhe(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(rot(e)===r)return e[t];if(n=iot.f(e,t),n)return not(n)?n.value:n.get===void 0?void 0:eot(n.get,r);if(tot(i=aot(e)))return Dhe(i,t,r)}Qat({target:"Reflect",stat:!0},{get:Dhe});var oot=Ot,sot=Lt,lot=Qa,$he=pl.f,Nhe=Nn,uot=!Nhe||sot(function(){$he(1)});oot({target:"Object",stat:!0,forced:uot,sham:!Nhe},{getOwnPropertyDescriptor:function(t,r){return $he(lot(t),r)}});var fot="localHooks",Lhe={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,a,o,s){if(this._localHooks[t])for(var l=this._localHooks[t].length,u=0;u<l;u++)HE(this._localHooks[t][u],this,r,n,i,a,o,s)},clearLocalHooks:function(){return this._localHooks={},this}};yl(Lhe,"MIXIN_NAME",fot,{writable:!1,enumerable:!1});const Pa=Lhe;function c_(e){return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c_(e)}function cot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dot(n.key),n)}}function hot(e,t,r){return t&&fq(e.prototype,t),r&&fq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dot(e){var t=vot(e,"string");return c_(t)==="symbol"?t:String(t)}function vot(e,t){if(c_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qd=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;cot(this,e),this.indexedValues=[],this.initValueOrFn=t}return hot(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,jr(this.initValueOrFn)?yt(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):yt(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();Br(qd,Pa);function W2(e){return mot(e)||yot(e)||got(e)||pot()}function pot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function got(e,t){if(e){if(typeof e=="string")return eF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eF(e,t)}}function yot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mot(e){if(Array.isArray(e))return eF(e)}function eF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VV(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(W2(e.slice(0,i)),W2(r.map(function(a,o){return jr(n)?n(a,o):n})),W2(i===void 0?[]:e.slice(i)))}function WV(e,t){return qa(e,function(r,n){return t.includes(n)===!1})}function Mg(e){return Mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mg(e)}function bot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ot(n.key),n)}}function wot(e,t,r){return t&&cq(e.prototype,t),r&&cq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ot(e){var t=Sot(e,"string");return Mg(t)==="symbol"?t:String(t)}function Sot(e,t){if(Mg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wb(){return typeof Reflect<"u"&&Reflect.get?Wb=Reflect.get.bind():Wb=function(t,r,n){var i=Cot(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Wb.apply(this,arguments)}function Cot(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Od(e),e!==null););return e}function xot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tF(e,t)}function tF(e,t){return tF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tF(e,t)}function Tot(e){var t=Rot();return function(){var n=Od(e),i;if(t){var a=Od(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Oot(this,i)}}function Oot(e,t){if(t&&(Mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eot(e)}function Eot(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rot(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Od(e){return Od=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Od(e)}var Cc=function(e){xot(r,e);var t=Tot(r);function r(){return bot(this,r),t.apply(this,arguments)}return wot(r,[{key:"insert",value:function(i,a){this.indexedValues=VV(this.indexedValues,i,a,this.initValueOrFn),Wb(Od(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=WV(this.indexedValues,i),Wb(Od(r.prototype),"remove",this).call(this,i)}}]),r}(qd);function Dg(e){return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dg(e)}function kot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pot(n.key),n)}}function Aot(e,t,r){return t&&hq(e.prototype,t),r&&hq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pot(e){var t=Iot(e,"string");return Dg(t)==="symbol"?t:String(t)}function Iot(e,t){if(Dg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rF(e,t)}function rF(e,t){return rF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rF(e,t)}function Dot(e){var t=Lot();return function(){var n=gR(e),i;if(t){var a=gR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return $ot(this,i)}}function $ot(e,t){if(t&&(Dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Not(e)}function Not(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lot(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gR(e){return gR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gR(e)}var mA=function(e){Mot(r,e);var t=Dot(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return kot(this,r),t.call(this,n)}return Aot(r,[{key:"getHiddenIndexes",value:function(){return On(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}(Cc);function j2(e){return Vot(e)||Bot(e)||Hot(e)||Fot()}function Fot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hot(e,t){if(e){if(typeof e=="string")return nF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nF(e,t)}}function Bot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vot(e){if(Array.isArray(e))return nF(e)}function nF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jV(e,t,r){return[].concat(j2(e.slice(0,t)),j2(r),j2(e.slice(t)))}function h_(e,t){return qa(e,function(r){return t.includes(r)===!1})}function UV(e,t){return Ut(e,function(r){return r-t.filter(function(n){return n<r}).length})}function zV(e,t){var r=t[0],n=t.length;return Ut(e,function(i){return i>=r?i+n:i})}function $g(e){return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$g(e)}function Wot(e){return Got(e)||zot(e)||Uot(e)||jot()}function jot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uot(e,t){if(e){if(typeof e=="string")return iF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iF(e,t)}}function zot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Got(e){if(Array.isArray(e))return iF(e)}function iF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hhe(n.key),n)}}function Kot(e,t,r){return t&&dq(e.prototype,t),r&&dq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zl(){return typeof Reflect<"u"&&Reflect.get?zl=Reflect.get.bind():zl=function(t,r,n){var i=Xot(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},zl.apply(this,arguments)}function Xot(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ds(e),e!==null););return e}function qot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aF(e,t)}function aF(e,t){return aF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aF(e,t)}function Zot(e){var t=Qot();return function(){var n=ds(e),i;if(t){var a=ds(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Jot(this,i)}}function Jot(e,t){if(t&&($g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fhe(e)}function Fhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qot(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ds(e){return ds=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ds(e)}function est(e,t,r){return t=Hhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hhe(e){var t=tst(e,"string");return $g(t)==="symbol"?t:String(t)}function tst(e,t){if($g(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bA=function(e){qot(r,e);var t=Zot(r);function r(){var n;Yot(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),est(Fhe(n),"orderOfIndexes",[]),n}return Kot(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return i.indexedValues[a]})}},{key:"setValues",value:function(i){this.orderOfIndexes=Wot(Array(i.length).keys()),zl(ds(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=a,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(o,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=h_(this.orderOfIndexes,[i]),jr(this.initValueOrFn)?zl(ds(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):zl(ds(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,zl(ds(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,a){this.indexedValues=VV(this.indexedValues,i,a,this.initValueOrFn),this.orderOfIndexes=zV(this.orderOfIndexes,a),zl(ds(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=WV(this.indexedValues,i),this.orderOfIndexes=h_(this.orderOfIndexes,i),this.orderOfIndexes=UV(this.orderOfIndexes,i),zl(ds(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return[a,i.getValueAtIndex(a)]})}}]),r}(qd);function Ng(e){return Ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ng(e)}function rst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ist(n.key),n)}}function nst(e,t,r){return t&&vq(e.prototype,t),r&&vq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ist(e){var t=ast(e,"string");return Ng(t)==="symbol"?t:String(t)}function ast(e,t){if(Ng(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ng(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ost(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oF(e,t)}function oF(e,t){return oF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oF(e,t)}function sst(e){var t=fst();return function(){var n=yR(e),i;if(t){var a=yR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return lst(this,i)}}function lst(e,t){if(t&&(Ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ust(e)}function ust(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yR(e){return yR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yR(e)}var k1=function(e){ost(r,e);var t=sst(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return rst(this,r),t.call(this,n)}return nst(r,[{key:"getTrimmedIndexes",value:function(){return On(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}(Cc),pq=new Map([["indexesSequence",{getListWithInsertedItems:jV,getListWithRemovedItems:h_}],["physicallyIndexed",{getListWithInsertedItems:VV,getListWithRemovedItems:WV}]]),Bhe=function(t){if(pq.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return pq.get(t)};function Lg(e){return Lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lg(e)}function cst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dst(n.key),n)}}function hst(e,t,r){return t&&gq(e.prototype,t),r&&gq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dst(e){var t=vst(e,"string");return Lg(t)==="symbol"?t:String(t)}function vst(e,t){if(Lg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jb(){return typeof Reflect<"u"&&Reflect.get?jb=Reflect.get.bind():jb=function(t,r,n){var i=pst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},jb.apply(this,arguments)}function pst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ed(e),e!==null););return e}function gst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sF(e,t)}function sF(e,t){return sF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sF(e,t)}function yst(e){var t=wst();return function(){var n=Ed(e),i;if(t){var a=Ed(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mst(this,i)}}function mst(e,t){if(t&&(Lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bst(e)}function bst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ed(e){return Ed=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ed(e)}var Vhe=function(e){gst(r,e);var t=yst(r);function r(){return cst(this,r),t.call(this,function(n){return n})}return hst(r,[{key:"insert",value:function(i,a){var o=zV(this.indexedValues,a);this.indexedValues=jV(o,i,a),jb(Ed(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=h_(this.indexedValues,i);this.indexedValues=UV(a,i),jb(Ed(r.prototype),"remove",this).call(this,i)}}]),r}(qd),yq=new Map([["hiding",mA],["index",qd],["linkedPhysicalIndexToValue",bA],["physicalIndexToValue",Cc],["trimming",k1]]);function _st(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!yq.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(yq.get(e))(t)}function d_(e){return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d_(e)}function Sst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xst(n.key),n)}}function Cst(e,t,r){return t&&mq(e.prototype,t),r&&mq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xst(e){var t=Tst(e,"string");return d_(t)==="symbol"?t:String(t)}function Tst(e,t){if(d_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(d_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lF=0,GV=function(){function e(){Sst(this,e),this.collection=new Map}return Cst(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}),lF+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);lt(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),lF-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return Lr(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();Br(GV,Pa);function Ost(){return lF}function Fg(e){return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fg(e)}function Est(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kst(n.key),n)}}function Rst(e,t,r){return t&&bq(e.prototype,t),r&&bq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kst(e){var t=Ast(e,"string");return Fg(t)==="symbol"?t:String(t)}function Ast(e,t){if(Fg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uF(e,t)}function uF(e,t){return uF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uF(e,t)}function Ist(e){var t=$st();return function(){var n=mR(e),i;if(t){var a=mR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Mst(this,i)}}function Mst(e,t){if(t&&(Fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dst(e)}function Dst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $st(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mR(e){return mR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mR(e)}var wq=function(e){Pst(r,e);var t=Ist(r);function r(n,i){var a;return Est(this,r),a=t.call(this),a.mergedValuesCache=[],a.aggregationFunction=n,a.fallbackValue=i,a}return Rst(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var a=Ut(this.get(),function(c){return c.getValues()}),o=[],s=lt(a[0])&&a[0].length||0,l=0;l<s;l+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(a[f][l]);o.push(u)}return Ut(o,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,a){var o=this.getMergedValues(a)[i];return lt(o)?o:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(GV);function v_(e){return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}function Nst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fst(n.key),n)}}function Lst(e,t,r){return t&&_q(e.prototype,t),r&&_q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fst(e){var t=Hst(e,"string");return v_(t)==="symbol"?t:String(t)}function Hst(e,t){if(v_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(v_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bst(e,t,r){Vst(e,t),t.set(e,r)}function Vst(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wst(e,t,r){var n=Whe(e,t,"set");return jst(e,n,r),r}function jst(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ust(e,t){var r=Whe(e,t,"get");return zst(e,r)}function Whe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function zst(e,t){return t.get?t.get.call(e):t.value}var U2=new WeakMap,jhe=function(){function e(){Nst(this,e),Bst(this,U2,{writable:!0,value:[]})}return Lst(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(Ust(this,U2)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){Wst(this,U2,r)}}]),e}();Br(jhe,Pa);function Sq(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function p_(e){return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}function Gst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kst(n.key),n)}}function Yst(e,t,r){return t&&Cq(e.prototype,t),r&&Cq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kst(e){var t=Xst(e,"string");return p_(t)==="symbol"?t:String(t)}function Xst(e,t){if(p_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L0(e,t,r){qst(e,t),t.set(e,r)}function qst(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function go(e,t){var r=Uhe(e,t,"get");return Zst(e,r)}function Zst(e,t){return t.get?t.get.call(e):t.value}function Yx(e,t,r){var n=Uhe(e,t,"set");return Jst(e,n,r),r}function Uhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Jst(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Kx=new WeakMap,F0=new WeakMap,Xx=new WeakMap,qx=new WeakMap,Zx=new WeakMap,Qst=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;Gst(this,e),L0(this,Kx,{writable:!0,value:new Set}),L0(this,F0,{writable:!0,value:[]}),L0(this,Xx,{writable:!0,value:[]}),L0(this,qx,{writable:!0,value:!1}),L0(this,Zx,{writable:!0,value:!1}),Yx(this,Zx,r??!1)}return Yst(e,[{key:"createObserver",value:function(){var r=this,n=new jhe;return go(this,Kx).add(n),n.addLocalHook("unsubscribe",function(){go(r,Kx).delete(n)}),n._writeInitialChanges(Sq(go(this,F0),go(this,Xx))),n}},{key:"emit",value:function(r){var n=go(this,Xx);(!go(this,qx)||go(this,F0).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(go(this,Zx)):Yx(this,F0,new Array(r.length).fill(go(this,Zx))),go(this,qx)||(Yx(this,qx,!0),n=go(this,F0)));var i=Sq(n,r);go(this,Kx).forEach(function(a){return a._write(i)}),Yx(this,Xx,r)}}]),e}();function g_(e){return g_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g_(e)}var xq;function z2(e){return nlt(e)||rlt(e)||tlt(e)||elt()}function elt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tlt(e,t){if(e){if(typeof e=="string")return fF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fF(e,t)}}function rlt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nlt(e){if(Array.isArray(e))return fF(e)}function fF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ilt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function alt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,slt(n.key),n)}}function olt(e,t,r){return t&&Tq(e.prototype,t),r&&Tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function slt(e){var t=llt(e,"string");return g_(t)==="symbol"?t:String(t)}function llt(e,t){if(g_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(g_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oq=new Set(["getFirstNotHiddenIndex"]),cF=function(){function e(){var t=this;alt(this,e),this.indexesSequence=new Vhe,this.trimmingMapsCollection=new wq(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new wq(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new GV,this.hidingChangesObservable=new Qst({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return olt(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,_st(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof k1?this.trimmingMapsCollection.register(r,n):n instanceof mA?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return lt(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return lt(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return lt(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return lt(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;Oq.has("getFirstNotHiddenIndex")&&(Oq.delete("getFirstNotHiddenIndex"),Fr(Ir(xq||(xq=ilt([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var o=this.getPhysicalFromVisualIndex(r);return o===null?i===!0&&a!==r-n?this.getFirstNotHiddenIndex(a,-n,!1,a):null:this.isHidden(o)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,a)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.getPhysicalFromVisualIndex(r);if(a===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=o.findIndex(function(l){return l>r}):s=o.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:o[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=z2(new Array(r).keys()),this.notHiddenIndexesCache=z2(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=z2(Array(this.getNumberOfIndexes()-r).keys()).map(function(a){return a+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isTrimmed(a)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var a=Ut(r,function(c){return i.getPhysicalFromVisualIndex(c)}),o=this.getNotTrimmedIndexesLength(),s=r.length,l=h_(this.getIndexesSequence(),a),u=o-s;if(n+s<o){var f=l.filter(function(c){return i.isTrimmed(c)===!1})[n];u=l.indexOf(f)}this.setIndexesSequence(jV(l,u,a))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],a=lt(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=Ut(new Array(n).fill(a),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(o,s),this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),a=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(a,n)}}}]),e}();Br(cF,Pa);var Eq;function ult(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function flt(e,t){return Gt(t,function(r,n){Lr(e[n])&&(e[n]=r)}),e}function zhe(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function Ghe(e){lt(e)&&_V(Ir(Eq||(Eq=ult(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function clt(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var Yhe=zo("phraseFormatters"),hlt=Yhe.register,dlt=Yhe.getValues;function vlt(e,t){hlt(e,t)}function plt(){return dlt()}vlt("pluralize",clt);var Khe="ContextMenu:items",Ft=Khe,YV="".concat(Ft,".noItems"),KV="".concat(Ft,".insertRowAbove"),XV="".concat(Ft,".insertRowBelow"),qV="".concat(Ft,".insertColumnOnTheLeft"),ZV="".concat(Ft,".insertColumnOnTheRight"),JV="".concat(Ft,".removeRow"),QV="".concat(Ft,".removeColumn"),eW="".concat(Ft,".undo"),tW="".concat(Ft,".redo"),rW="".concat(Ft,".readOnly"),nW="".concat(Ft,".clearColumn"),iW="".concat(Ft,".copy"),aW="".concat(Ft,".copyWithHeaders"),oW="".concat(Ft,".copyWithGroupHeaders"),sW="".concat(Ft,".copyHeadersOnly"),lW="".concat(Ft,".cut"),uW="".concat(Ft,".freezeColumn"),fW="".concat(Ft,".unfreezeColumn"),cW="".concat(Ft,".mergeCells"),hW="".concat(Ft,".unmergeCells"),dW="".concat(Ft,".addComment"),vW="".concat(Ft,".editComment"),pW="".concat(Ft,".removeComment"),gW="".concat(Ft,".readOnlyComment"),yW="".concat(Ft,".align"),mW="".concat(Ft,".align.left"),bW="".concat(Ft,".align.center"),wW="".concat(Ft,".align.right"),_W="".concat(Ft,".align.justify"),SW="".concat(Ft,".align.top"),CW="".concat(Ft,".align.middle"),xW="".concat(Ft,".align.bottom"),TW="".concat(Ft,".borders"),OW="".concat(Ft,".borders.top"),EW="".concat(Ft,".borders.right"),RW="".concat(Ft,".borders.bottom"),kW="".concat(Ft,".borders.left"),AW="".concat(Ft,".borders.remove"),PW="".concat(Ft,".nestedHeaders.insertChildRow"),IW="".concat(Ft,".nestedHeaders.detachFromParent"),MW="".concat(Ft,".hideColumn"),DW="".concat(Ft,".showColumn"),$W="".concat(Ft,".hideRow"),NW="".concat(Ft,".showRow"),ua="Filters:",bn="".concat(ua,"conditions"),wA="".concat(bn,".none"),LW="".concat(bn,".isEmpty"),FW="".concat(bn,".isNotEmpty"),HW="".concat(bn,".isEqualTo"),BW="".concat(bn,".isNotEqualTo"),VW="".concat(bn,".beginsWith"),WW="".concat(bn,".endsWith"),jW="".concat(bn,".contains"),UW="".concat(bn,".doesNotContain"),glt="".concat(bn,".byValue"),zW="".concat(bn,".greaterThan"),GW="".concat(bn,".greaterThanOrEqualTo"),YW="".concat(bn,".lessThan"),KW="".concat(bn,".lessThanOrEqualTo"),XW="".concat(bn,".isBetween"),qW="".concat(bn,".isNotBetween"),ZW="".concat(bn,".after"),JW="".concat(bn,".before"),QW="".concat(bn,".today"),ej="".concat(bn,".tomorrow"),tj="".concat(bn,".yesterday"),rj="".concat(ua,"labels.filterByCondition"),nj="".concat(ua,"labels.filterByValue"),ij="".concat(ua,"labels.conjunction"),_A="".concat(ua,"labels.disjunction"),bR="".concat(ua,"values.blankCells"),aj="".concat(ua,"buttons.selectAll"),oj="".concat(ua,"buttons.clear"),sj="".concat(ua,"buttons.ok"),lj="".concat(ua,"buttons.cancel"),uj="".concat(ua,"buttons.placeholder.search"),fj="".concat(ua,"buttons.placeholder.value"),cj="".concat(ua,"buttons.placeholder.secondValue");const ylt=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:dW,CONTEXTMENU_ITEMS_ALIGNMENT:yW,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:xW,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:bW,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:_W,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:mW,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:CW,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:wW,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:SW,CONTEXTMENU_ITEMS_BORDERS:TW,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:RW,CONTEXTMENU_ITEMS_BORDERS_LEFT:kW,CONTEXTMENU_ITEMS_BORDERS_RIGHT:EW,CONTEXTMENU_ITEMS_BORDERS_TOP:OW,CONTEXTMENU_ITEMS_CLEAR_COLUMN:nW,CONTEXTMENU_ITEMS_COPY:iW,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:sW,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:oW,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:aW,CONTEXTMENU_ITEMS_CUT:lW,CONTEXTMENU_ITEMS_EDIT_COMMENT:vW,CONTEXTMENU_ITEMS_FREEZE_COLUMN:uW,CONTEXTMENU_ITEMS_HIDE_COLUMN:MW,CONTEXTMENU_ITEMS_HIDE_ROW:$W,CONTEXTMENU_ITEMS_INSERT_LEFT:qV,CONTEXTMENU_ITEMS_INSERT_RIGHT:ZV,CONTEXTMENU_ITEMS_MERGE_CELLS:cW,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:IW,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:PW,CONTEXTMENU_ITEMS_NO_ITEMS:YV,CONTEXTMENU_ITEMS_READ_ONLY:rW,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:gW,CONTEXTMENU_ITEMS_REDO:tW,CONTEXTMENU_ITEMS_REMOVE_BORDERS:AW,CONTEXTMENU_ITEMS_REMOVE_COLUMN:QV,CONTEXTMENU_ITEMS_REMOVE_COMMENT:pW,CONTEXTMENU_ITEMS_REMOVE_ROW:JV,CONTEXTMENU_ITEMS_ROW_ABOVE:KV,CONTEXTMENU_ITEMS_ROW_BELOW:XV,CONTEXTMENU_ITEMS_SHOW_COLUMN:DW,CONTEXTMENU_ITEMS_SHOW_ROW:NW,CONTEXTMENU_ITEMS_UNDO:eW,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:fW,CONTEXTMENU_ITEMS_UNMERGE_CELLS:hW,CONTEXT_MENU_ITEMS_NAMESPACE:Khe,FILTERS_BUTTONS_CANCEL:lj,FILTERS_BUTTONS_CLEAR:oj,FILTERS_BUTTONS_OK:sj,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:uj,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:cj,FILTERS_BUTTONS_PLACEHOLDER_VALUE:fj,FILTERS_BUTTONS_SELECT_ALL:aj,FILTERS_CONDITIONS_AFTER:ZW,FILTERS_CONDITIONS_BEFORE:JW,FILTERS_CONDITIONS_BEGINS_WITH:VW,FILTERS_CONDITIONS_BETWEEN:XW,FILTERS_CONDITIONS_BY_VALUE:glt,FILTERS_CONDITIONS_CONTAINS:jW,FILTERS_CONDITIONS_EMPTY:LW,FILTERS_CONDITIONS_ENDS_WITH:WW,FILTERS_CONDITIONS_EQUAL:HW,FILTERS_CONDITIONS_GREATER_THAN:zW,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:GW,FILTERS_CONDITIONS_LESS_THAN:YW,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:KW,FILTERS_CONDITIONS_NAMESPACE:bn,FILTERS_CONDITIONS_NONE:wA,FILTERS_CONDITIONS_NOT_BETWEEN:qW,FILTERS_CONDITIONS_NOT_CONTAIN:UW,FILTERS_CONDITIONS_NOT_EMPTY:FW,FILTERS_CONDITIONS_NOT_EQUAL:BW,FILTERS_CONDITIONS_TODAY:QW,FILTERS_CONDITIONS_TOMORROW:ej,FILTERS_CONDITIONS_YESTERDAY:tj,FILTERS_DIVS_FILTER_BY_CONDITION:rj,FILTERS_DIVS_FILTER_BY_VALUE:nj,FILTERS_LABELS_CONJUNCTION:ij,FILTERS_LABELS_DISJUNCTION:_A,FILTERS_NAMESPACE:ua,FILTERS_VALUES_BLANK_CELLS:bR},Symbol.toStringTag,{value:"Module"}));function y_(e){return y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y_(e)}var et;function nt(e,t,r){return t=mlt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mlt(e){var t=blt(e,"string");return y_(t)==="symbol"?t:String(t)}function blt(e,t){if(y_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(y_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wlt=(et={languageCode:"en-US"},nt(et,YV,"No available options"),nt(et,KV,"Insert row above"),nt(et,XV,"Insert row below"),nt(et,qV,"Insert column left"),nt(et,ZV,"Insert column right"),nt(et,JV,["Remove row","Remove rows"]),nt(et,QV,["Remove column","Remove columns"]),nt(et,eW,"Undo"),nt(et,tW,"Redo"),nt(et,rW,"Read only"),nt(et,nW,"Clear column"),nt(et,yW,"Alignment"),nt(et,mW,"Left"),nt(et,bW,"Center"),nt(et,wW,"Right"),nt(et,_W,"Justify"),nt(et,SW,"Top"),nt(et,CW,"Middle"),nt(et,xW,"Bottom"),nt(et,uW,"Freeze column"),nt(et,fW,"Unfreeze column"),nt(et,TW,"Borders"),nt(et,OW,"Top"),nt(et,EW,"Right"),nt(et,RW,"Bottom"),nt(et,kW,"Left"),nt(et,AW,"Remove border(s)"),nt(et,dW,"Add comment"),nt(et,vW,"Edit comment"),nt(et,pW,"Delete comment"),nt(et,gW,"Read-only comment"),nt(et,cW,"Merge cells"),nt(et,hW,"Unmerge cells"),nt(et,iW,"Copy"),nt(et,aW,["Copy with header","Copy with headers"]),nt(et,oW,["Copy with group header","Copy with group headers"]),nt(et,sW,["Copy header only","Copy headers only"]),nt(et,lW,"Cut"),nt(et,PW,"Insert child row"),nt(et,IW,"Detach from parent"),nt(et,MW,["Hide column","Hide columns"]),nt(et,DW,["Show column","Show columns"]),nt(et,$W,["Hide row","Hide rows"]),nt(et,NW,["Show row","Show rows"]),nt(et,wA,"None"),nt(et,LW,"Is empty"),nt(et,FW,"Is not empty"),nt(et,HW,"Is equal to"),nt(et,BW,"Is not equal to"),nt(et,VW,"Begins with"),nt(et,WW,"Ends with"),nt(et,jW,"Contains"),nt(et,UW,"Does not contain"),nt(et,zW,"Greater than"),nt(et,GW,"Greater than or equal to"),nt(et,YW,"Less than"),nt(et,KW,"Less than or equal to"),nt(et,XW,"Is between"),nt(et,qW,"Is not between"),nt(et,ZW,"After"),nt(et,JW,"Before"),nt(et,QW,"Today"),nt(et,ej,"Tomorrow"),nt(et,tj,"Yesterday"),nt(et,bR,"Blank cells"),nt(et,rj,"Filter by condition"),nt(et,nj,"Filter by value"),nt(et,ij,"And"),nt(et,_A,"Or"),nt(et,aj,"Select all"),nt(et,oj,"Clear"),nt(et,sj,"OK"),nt(et,lj,"Cancel"),nt(et,uj,"Search"),nt(et,fj,"Value"),nt(et,cj,"Second value"),et);const Xhe=wlt;var hF=Xhe.languageCode,SA=zo("languagesDictionaries"),_lt=SA.register,qhe=SA.getItem,Slt=SA.hasItem,Clt=SA.getValues;Zhe(Xhe);function Zhe(e,t){var r=e,n=t;return zt(e)&&(n=e,r=n.languageCode),xlt(r,n),_lt(r,Mi(n)),Mi(n)}function xlt(e,t){e!==hF&&flt(t,qhe(hF))}function Jhe(e){return hj(e)?Mi(qhe(e)):null}function hj(e){return Slt(e)}function Tlt(){return Clt()}function Qhe(e,t,r){var n=Jhe(e);if(n===null)return null;var i=n[t];if(Lr(i))return null;var a=Olt(i,r);return Array.isArray(a)?a[0]:a}function Olt(e,t){var r=e;return ue(plt(),function(n){r=n(e,t)}),r}function Elt(e){var t=zhe(e);return hj(t)||(t=hF,Ghe(e)),t}var Rlt=Ot,klt=Nn,Alt=Xse,Plt=Qa,Ilt=pl,Mlt=Tm;Rlt({target:"Object",stat:!0,sham:!klt},{getOwnPropertyDescriptors:function(t){for(var r=Plt(t),n=Ilt.f,i=Alt(r),a={},o=0,s,l;i.length>o;)l=n(r,s=i[o++]),l!==void 0&&Mlt(a,s,l);return a}});var CA="active-header",xA="area",m_="cell",dj="fill",A1="header",vj="custom-selection";function Hg(e){return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hg(e)}function Dlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tde(n.key),n)}}function $lt(e,t,r){return t&&Rq(e.prototype,t),r&&Rq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CO(){return typeof Reflect<"u"&&Reflect.get?CO=Reflect.get.bind():CO=function(t,r,n){var i=Nlt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},CO.apply(this,arguments)}function Nlt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bg(e),e!==null););return e}function Llt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dF(e,t)}function dF(e,t){return dF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dF(e,t)}function Flt(e){var t=Blt();return function(){var n=Bg(e),i;if(t){var a=Bg(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Hlt(this,i)}}function Hlt(e,t){if(t&&(Hg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ede(e)}function ede(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Blt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bg(e){return Bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bg(e)}function Vlt(e,t,r){return t=tde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tde(e){var t=Wlt(e,"string");return Hg(t)==="symbol"?t:String(t)}function Wlt(e,t){if(Hg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jlt=function(e){Llt(r,e);var t=Flt(r);function r(n,i){var a;return Dlt(this,r),a=t.call(this,n,null),Vlt(ede(a),"visualCellRange",null),a.visualCellRange=i||null,a.commit(),a}return $lt(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,CO(Bg(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var a=i.from,o=i.to,s=this.getNearestNotHiddenCoords(a,1),l=this.getNearestNotHiddenCoords(o,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=a,l=o}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,a);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,o);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,a,o){if(a<0)return a;var s=i.getNearestNotHiddenIndex(a,o),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var a=i.getVerticalDirection()==="N-S"?1:-1,o=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),a,o);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,a=i.from,o=i.to,s=a.row===null||o.row===null,l=a.col===null||o.col===null,u=this.settings.createCellCoords(s?null:Math.min(a.row,o.row),l?null:Math.min(a.col,o.col)),f=this.settings.createCellCoords(s?null:Math.max(a.row,o.row),l?null:Math.max(a.col,o.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),a=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,a.row,a.col]}},{key:"createRenderableCellRange",value:function(i,a){var o=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(a);return this.settings.createCellRange(o,o,s)}}]),r}(Sat);const Im=jlt;function b_(e){return b_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b_(e)}var Ult=["activeHeaderClassName"];function kq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Aq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kq(Object(r),!0).forEach(function(n){zlt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zlt(e,t,r){return t=Glt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Glt(e){var t=Ylt(e,"string");return b_(t)==="symbol"?t:String(t)}function Ylt(e,t){if(b_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(b_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Klt(e,t){if(e==null)return{};var r=Xlt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Xlt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function qlt(e){var t=e.activeHeaderClassName,r=Klt(e,Ult),n=new Im(Aq(Aq({highlightHeaderClassName:t},r),{},{selectionType:CA}));return n}function w_(e){return w_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w_(e)}var Zlt=["layerLevel","areaCornerVisible"];function Pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Iq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pq(Object(r),!0).forEach(function(n){Jlt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jlt(e,t,r){return t=Qlt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qlt(e){var t=eut(e,"string");return w_(t)==="symbol"?t:String(t)}function eut(e,t){if(w_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(w_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tut(e,t){if(e==null)return{};var r=rut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function nut(e){var t=e.layerLevel,r=e.areaCornerVisible,n=tut(e,Zlt),i=new Im(Iq(Iq({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:xA}));return i}function __(e){return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__(e)}var iut=["cellCornerVisible"];function Mq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Dq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mq(Object(r),!0).forEach(function(n){aut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aut(e,t,r){return t=out(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function out(e){var t=sut(e,"string");return __(t)==="symbol"?t:String(t)}function sut(e,t){if(__(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(__(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lut(e,t){if(e==null)return{};var r=uut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function fut(e){var t=e.cellCornerVisible,r=lut(e,iut),n=new Im(Dq(Dq({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:m_}));return n}function S_(e){return S_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S_(e)}var cut=["border","visualCellRange"];function $q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function G2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$q(Object(r),!0).forEach(function(n){hut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hut(e,t,r){return t=dut(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dut(e){var t=vut(e,"string");return S_(t)==="symbol"?t:String(t)}function vut(e,t){if(S_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function put(e,t){if(e==null)return{};var r=gut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function yut(e){var t=e.border,r=e.visualCellRange,n=put(e,cut),i=new Im(G2(G2(G2({},t),n),{},{selectionType:vj}),r);return i}var Nq=Nn,mut=Yt,but=Gn,wut=Lt,Y2=i1,_ut=r1,Sut=KS,Cut=Aa,xut=qS,jv=Object.assign,Lq=Object.defineProperty,Tut=mut([].concat),Out=!jv||wut(function(){if(Nq&&jv({b:1},jv(Lq({},"a",{enumerable:!0,get:function(){Lq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),jv({},e)[r]!=7||Y2(jv({},t)).join("")!=n})?function(t,r){for(var n=Cut(t),i=arguments.length,a=1,o=_ut.f,s=Sut.f;i>a;)for(var l=xut(arguments[a++]),u=o?Tut(Y2(l),o(l)):Y2(l),f=u.length,c=0,h;f>c;)h=u[c++],(!Nq||but(s,l,h))&&(n[h]=l[h]);return n}:jv,Eut=Ot,Fq=Out;Eut({target:"Object",stat:!0,arity:2,forced:Object.assign!==Fq},{assign:Fq});function C_(e){return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(e)}function Hq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hq(Object(r),!0).forEach(function(n){Rut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rut(e,t,r){return t=kut(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kut(e){var t=Aut(e,"string");return C_(t)==="symbol"?t:String(t)}function Aut(e,t){if(C_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(C_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Put(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function Iut(e){var t=Object.assign({},(Put(e),e)),r=new Im(Bq(Bq({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:dj}));return r}function x_(e){return x_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x_(e)}var Mut=["headerClassName","rowClassName","columnClassName"];function Vq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Wq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vq(Object(r),!0).forEach(function(n){Dut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dut(e,t,r){return t=$ut(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ut(e){var t=Nut(e,"string");return x_(t)==="symbol"?t:String(t)}function Nut(e,t){if(x_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(x_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lut(e,t){if(e==null)return{};var r=Fut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Hut(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=Lut(e,Mut),a=new Im(Wq(Wq({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:A1}));return a}function T_(e){return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T_(e)}function jq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function But(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jq(Object(r),!0).forEach(function(n){Vut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vut(e,t,r){return t=Wut(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wut(e){var t=jut(e,"string");return T_(t)==="symbol"?t:String(t)}function jut(e,t){if(T_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rde=zo("highlight/types"),Mm=rde.register,Uut=rde.getItem;Mm(CA,qlt);Mm(xA,nut);Mm(m_,fut);Mm(vj,yut);Mm(dj,Iut);Mm(A1,Hut);function Uv(e,t){return Uut(e)(But({type:e},t))}function O_(e){return O_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O_(e)}function gf(e){return Kut(e)||Yut(e)||Gut(e)||zut()}function zut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gut(e,t){if(e){if(typeof e=="string")return vF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vF(e,t)}}function Yut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kut(e){if(Array.isArray(e))return vF(e)}function vF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function H0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uq(Object(r),!0).forEach(function(n){Xut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xut(e,t,r){return t=nde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nde(n.key),n)}}function Zut(e,t,r){return t&&zq(e.prototype,t),r&&zq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nde(e){var t=Jut(e,"string");return O_(t)==="symbol"?t:String(t)}function Jut(e,t){if(O_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qut=function(e){function t(r){qut(this,t),this.options=r,this.layerLevel=0,this.cell=Uv(m_,r),this.fill=Uv(dj,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Zut(t,[{key:"isEnabledFor",value:function(n,i){var a=n;n===m_&&(a="current");var o=this.options.disabledCellSelection(i.row,i.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(a)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=Uv(xA,H0({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return gf(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=Uv(A1,H0({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return gf(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=Uv(CA,H0({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return gf(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return gf(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(Uv(vj,H0(H0({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),ue(this.areas.values(),function(n){return void n.clear()}),ue(this.headers.values(),function(n){return void n.clear()}),ue(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(gf(this.areas.values()),gf(this.headers.values()),gf(this.activeHeaders.values()),gf(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const eft=Qut;function E_(e){return E_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E_(e)}function tft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nft(n.key),n)}}function rft(e,t,r){return t&&Gq(e.prototype,t),r&&Gq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nft(e){var t=ift(e,"string");return E_(t)==="symbol"?t:String(t)}function ift(e,t){if(E_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aft=function(e){function t(r){tft(this,t),this.ranges=[],this.createCellRange=r}return rft(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,a;return i>=0&&(a=this.ranges[i]),a}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const oft=aft;function R_(e){return R_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R_(e)}function sft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uft(n.key),n)}}function lft(e,t,r){return t&&Yq(e.prototype,t),r&&Yq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uft(e){var t=fft(e,"string");return R_(t)==="symbol"?t:String(t)}function fft(e,t){if(R_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(R_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ide=function(){function e(t,r){sft(this,e),this.range=t,this.options=r}return lft(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.options.createCellCoords(r,n),o=this.range.current().highlight,s=this.options.visualToRenderableCoords(o),l=s.row,u=s.col,f=o,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",a),l!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),g=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),b=this.options.minSpareCols(),w=this.options.autoWrapRow(),_=this.options.autoWrapCol();l+r>d-1?i&&y>0&&!(g&&l>=d-g-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):_&&(a.row=1-d,a.col=u+a.col===v-1?1-v:1):_&&l+a.row<0&&u+a.col>=0&&(a.row=d-1,a.col=u+a.col===0?v-1:-1),u+a.col>v-1?i&&b>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):w&&(a.row=l+a.row===d-1?1-d:1,a.col=1-v):w&&u+a.col<0&&l+a.row>=0&&(a.row=l+a.row===0?d-1:-1,a.col=v-1);var x=this.options.createCellCoords(l+a.row,u+a.col);c=0,h=0,x.row<0?(c=-1,x.row=0):x.row>0&&x.row>=d&&(c=1,x.row=d-1),x.col<0?(h=-1,x.col=0):x.col>0&&x.col>=v&&(h=1,x.col=v-1),f=this.options.renderableToVisualCoords(x)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),a=this.range.current(),o=a.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(a.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(a.to),g=v.row,y=v.col,b=this.options.createCellCoords(g+i.row,y+i.col);s=0,l=0,b.row<0?(s=-1,b.row=0):b.row>0&&b.row>=h&&(s=1,b.row=h-1),b.col<0?(l=-1,b.col=0):b.col>0&&b.col>=d&&(l=1,b.col=d-1),o=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformEnd",o,s,l),o}}]),e}();Br(ide,Pa);const cft=ide;function ade(e,t){return pft(e)||vft(e,t)||dft(e,t)||hft()}function hft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dft(e,t){if(e){if(typeof e=="string")return Kq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kq(e,t)}}function Kq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vft(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function pft(e){if(Array.isArray(e))return e}function pF(e){return pF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pF(e)}var TA=0,OA=1,ode=2,pj=3,gft=[pj,ode],yft=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],K2=Symbol("root"),Xq=Symbol("child");function Vg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:K2;if(t!==K2&&t!==Xq)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===K2,i=TA;if(r){var a=e[0];if(e.length===0)i=OA;else if(n&&a instanceof RV)i=pj;else if(n&&Array.isArray(a))i=Vg(a,Xq);else if(e.length>=2&&e.length<=4){var o=!e.some(function(s,l){return!yft[l].includes(pF(s))});o&&(i=ode)}}return i}function k_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!gft.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(a){var o=e===pj,s=o?a.from.row:a[0],l=o?a.from.col:a[1],u=o?a.to.row:a[2],f=o?a.to.col:a[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof f=="string"&&(f=i(f))),Lr(u)&&(u=s),Lr(f)&&(f=l),!n){var c=s,h=l,d=u,v=f;s=Math.min(c,d),l=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[s,l,u,f]}}function mft(e){var t=Vg(e);if(t===TA||t===OA)return[];var r=k_(t),n=new Set;ue(e,function(o){var s=r(o),l=ade(s,4),u=l[1],f=l[3],c=Math.max(u,0),h=f-c+1;ue(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=On(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function bft(e){var t=Vg(e);if(t===TA||t===OA)return[];var r=k_(t),n=new Set;ue(e,function(o){var s=r(o),l=ade(s,3),u=l[0],f=l[2],c=Math.max(u,0),h=f-c+1;ue(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=On(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function yf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function A_(e){return A_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A_(e)}var qq;function Zq(e,t){return Cft(e)||Sft(e,t)||_ft(e,t)||wft()}function wft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ft(e,t){if(e){if(typeof e=="string")return Jq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jq(e,t)}}function Jq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sft(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Cft(e){if(Array.isArray(e))return e}function xft(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Tft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eft(n.key),n)}}function Oft(e,t,r){return t&&Qq(e.prototype,t),r&&Qq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eft(e){var t=Rft(e,"string");return A_(t)==="symbol"?t:String(t)}function Rft(e,t){if(A_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(A_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sde=function(){function e(t,r){var n=this;Tft(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new oft(function(i,a,o){return n.tableProps.createCellRange(i,a,o)}),this.highlight=new eft({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(a,o){return n.tableProps.isDisabledCellSelection(a,o)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},createCellRange:function(a,o,s){return n.tableProps.createCellRange(a,o,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new cft(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(a))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertColRequire"].concat(a))})}return Oft(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.settings.selectionMode==="multiple",o=Lr(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),f),(!a||a&&!o&&Lr(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(m_,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var a=this.getLayerLevel();a<this.highlight.layerLevel&&(ue(this.highlight.getAreas(),function(g){return void g.clear()}),ue(this.highlight.getHeaders(),function(g){return void g.clear()}),ue(this.highlight.getActiveHeaders(),function(g){return void g.clear()})),this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(xA,i.highlight)&&(this.isMultiple()||a>=1)&&(o.add(i.from).add(i.to).commit(),a===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(a-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(A1,i.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=i;if((f||c)&&(h=i.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===i.getWidth();d&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===i.getHeight();v&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=_d(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),a=this.tableProps.countCols();if(!(!r&&!n&&(i===0||a===0))){var o=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,a-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=Vg(r);if(i===OA)return!1;if(i===TA)throw new Error(Ir(qq||(qq=xft([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var a=k_(i,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var f=a(u),c=Zq(f,4),h=c[0],d=c[1],v=c[2],g=c[3],y=yf(h,o)&&yf(d,s)&&yf(v,o)&&yf(g,s);return!y});return l&&(this.clear(),ue(r,function(u){var f=a(u),c=Zq(f,4),h=c[0],d=c[1],v=c[2],g=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,g)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=typeof r=="string"?this.tableProps.propToCol(r):r,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=yf(a,s)&&yf(o,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,a)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,o)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=this.tableProps.countRows(),o=this.tableProps.countCols(),s=yf(r,a)&&yf(n,a);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,o-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var a=0;a<this.selectedRange.size();a+=1){this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();o.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),e}();Br(sde,Pa);const kft=sde;var Aft=Ot,lde=o1,Pft=pl.f,Ift=zd,eZ=Fn,Mft=$4,Dft=ka,$ft=N4,tZ=lde("".startsWith),Nft=lde("".slice),Lft=Math.min,ude=$ft("startsWith"),Fft=!ude&&!!function(){var e=Pft(String.prototype,"startsWith");return e&&!e.writable}();Aft({target:"String",proto:!0,forced:!Fft&&!ude},{startsWith:function(t){var r=eZ(Dft(this));Mft(t);var n=Ift(Lft(arguments.length>1?arguments[1]:void 0,r.length)),i=eZ(t);return tZ?tZ(r,i,n):Nft(r,n,n+i.length)===i}});var rZ=/^(\r\n|\n\r|\r|\n)/,Hft=/^[^\t\r\n]+/,nZ=/^\t/;function Bft(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,i;e.length>0&&i!==e.length;)if(i=e.length,e.match(nZ))e=e.replace(nZ,""),r+=1,t[n][r]="";else if(e.match(rZ))e=e.replace(rZ,""),r=0,n+=1,t[n]=[""];else{var a="";if(e.startsWith('"')){for(var o=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(o+=1),a+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&o%2===0)&&(s=!1)}a=a.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(Hft);a=u?u[0]:"",e=e.slice(a.length)}t[n][r]=a}return t}function Ub(e){var t,r,n,i,a="",o;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(a+="	"),o=e[t][n],typeof o=="string"?o.indexOf(`
`)>-1?a+='"'.concat(o.replace(/"/g,'""'),'"'):a+=o:o==null?a+="":a+=o;t!==r-1&&(a+=`
`)}return a}function X2(e){return Uft(e)||jft(e)||Wft(e)||Vft()}function Vft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wft(e,t){if(e){if(typeof e=="string")return gF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gF(e,t)}}function jft(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Uft(e){if(Array.isArray(e))return gF(e)}function gF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wg(e){return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wg(e)}function zft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yft(n.key),n)}}function Gft(e,t,r){return t&&iZ(e.prototype,t),r&&iZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yft(e){var t=Kft(e,"string");return Wg(t)==="symbol"?t:String(t)}function Kft(e,t){if(Wg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xft=function(){function e(t,r,n){zft(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return Gft(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var a=0,o=0,s=!1;if(typeof n=="function"){var l=Jk(r);a=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;a=Math.min(u,n.length)}for(i=0;i<a;i++){var f=s?n(i):n[i];if(zt(f)){if(typeof f.data<"u"){var c=s?o:i;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}o+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return BV(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var a=this,o=n,s=i,l;return typeof o>"u"&&(o=0,s=""),Wg(r)==="object"&&!Array.isArray(r)&&Gt(r,function(u,f){u===null?(l=s+f,a.colToPropCache.push(l),a.propToColCache.set(l,o),o+=1):o=a.recursiveDuckColumns(u,o,"".concat(f,"."))}),o}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&lt(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(lt(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?sg(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.source,s=a.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,i,o);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,g=this.getSchema().length,y=[],b=function(){var x=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?x=Mi(n.getSchema()):(x=[],yt(g-1,function(){return x.push(null)})):n.instance.dataType==="function"?x=n.tableMeta.dataSchema(h+c):(x={},p1(x,n.getSchema())),y.push(x),c+=1};c<i&&u+c<v;)b();this.instance.rowIndexMapper.insertIndexes(h,c),l==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,y);var w=this.instance.toVisualRow(f);return this.instance.countSourceRows()===y.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):o!=="auto"&&this.metaManager.createRow(f,i)),this.instance.runHooks("afterCreateRow",w,c,o),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,o=i.mode,s=o===void 0?"start":o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,a);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),g=this.instance.countCols(),y=0,b=d;s==="end"&&(b=Math.min(b+1,f));for(var w=b;y<n&&g<u;){if(typeof c!="number"||c>=g)if(v>0)for(var _=0;_<v;_+=1)typeof l[_]>"u"&&(l[_]=[]),l[_].push(null);else l.push([null]);else for(var x=0;x<v;x++)l[x].splice(b,0,null);y+=1,b+=1,g+=1}this.instance.columnIndexMapper.insertIndexes(c,y),y>0&&(r==null?this.metaManager.createColumn(null,y):a!=="auto"&&this.metaManager.createColumn(w,n));var T=this.instance.toVisualColumn(w);return this.instance.runHooks("afterCreateCol",T,y,a),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:y,startPhysicalIndex:w}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(o,i),l=this.instance.countSourceRows();o=(l+o)%l;var u=this.instance.runHooks("beforeRemoveRow",o,s.length,s,a);if(u===!1)return!1;var f=s.length;if(this.filterData(o,f,s),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var c=lt(this.tableMeta.columns)||lt(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=s.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",o,f,s,a),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var a=typeof r!="number"?-n:r;a=(this.instance.countCols()+a)%this.instance.countCols();var o=this.visualColumnsToPhysical(a,n),s=o.slice(0).sort(function(w,_){return _-w}),l=this.instance.runHooks("beforeRemoveCol",a,n,o,i);if(l===!1)return!1;for(var u=!0,f=s.length,c=this.dataSource,h=0;h<f;h++)u&&o[0]!==o[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(var g=0,y=this.instance.countSourceRows();g<y;g++)for(var b=0;b<f;b++)c[g].splice(s[b],1),g===0&&this.metaManager.removeColumn(s[b],1);return a<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",a,n,o,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var a=this.instance.getDataAtCol(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];GN(u,s);for(var c=0;c<i;)u.push(null),c+=1;return zue(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(r,n,i){for(var a=this.instance.getSourceDataAtRow(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];GN(u,s);for(var c=0;c<i;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),o}},{key:"spliceData",value:function(r,n,i){var a=this,o=this.instance.runHooks("beforeDataSplice",r,n,i);if(o!==!1){var s=[].concat(X2(this.dataSource.slice(0,r)),X2(i),X2(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return a.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var a=this.instance.runHooks("filterData",r,n,i);Array.isArray(a)===!1&&(a=this.dataSource.filter(function(o,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,a)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),a=this.dataSource[i],o=this.instance.runHooks("modifyRowData",i);a=isNaN(o)?o:a;var s=null;if(a&&a.hasOwnProperty&&gn(a,n))s=a[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=a;if(!u)return null;for(var f=0,c=l.length;f<c;f++)if(u=u[l[f]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=_d(s);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var a=this.instance.toPhysicalRow(r),o=i,s=this.dataSource[a],l=this.instance.runHooks("modifyRowData",a);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=_d(o);this.instance.runHooks("modifyData",a,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}if(s&&s.hasOwnProperty&&gn(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=s,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=o}else typeof n=="function"?n(this.dataSource.slice(a,a+1)[0],o):s[n]=o}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),a=[],o=(i+r)%i,s=n,l;o<i&&s;)l=this.instance.toPhysicalRow(o),a.push(l),s-=1,o+=1;return a}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),a=[],o=(i+r)%i,s=n;o<i&&s;){var l=this.instance.toPhysicalColumn(o);a.push(l),s-=1,o+=1}return a}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var a=[],o,s,l,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(o=Math.min(r.row,n.row);o<=h;o++){l=[];var v=o>=0?this.instance.toPhysicalRow(o):o;for(s=Math.min(r.col,n.col);s<=d&&v!==null;s++)l.push(c.call(this,o,this.colToProp(s)));v!==null&&a.push(l)}return a}},{key:"getText",value:function(r,n){return Ub(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Ub(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const qft=Xft;var P1=zo("cellTypes"),Zft=P1.register,Jft=P1.getItem,fde=P1.hasItem,Qft=P1.getNames;P1.getValues;function gj(e){if(!fde(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Jft(e)}function fs(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,a=r.validator;n&&ba(e,n),i&&Zs(e,i),a&&Op(e,a),Zft(e,t)}function ect(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!gn(t,e)}function EA(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?gj(t.type):t.type;if(e._automaticallyAssignedMetaProps&&Gt(t,function(a,o){return void e._automaticallyAssignedMetaProps.delete(o)}),!!zt(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};Gt(n,function(a,o){if(ect(o,r)){var s;i[o]=a,(s=e._automaticallyAssignedMetaProps)===null||s===void 0||s.add(o)}}),$n(e,i)}}function tct(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}ju(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function xO(e){return Number.isInteger(e)&&e>=0}function TO(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function Jx(e){return e==null}function yF(e){return yF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yF(e)}const cde=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),Un(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,a;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),Un(i)===!1)return yF(i)==="object"?(a=this.getCellMeta(t,r),j4(this.getSchema()[a.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function P_(e){return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P_(e)}function aZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aZ(Object(r),!0).forEach(function(n){rct(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rct(e,t,r){return t=dde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dde(n.key),n)}}function hde(e,t,r){return t&&sZ(e.prototype,t),r&&sZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dde(e){var t=nct(e,"string");return P_(t)==="symbol"?t:String(t)}function nct(e,t){if(P_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ict(){return hde(function e(){vde(this,e)})}var act=function(){function e(t){vde(this,e),this.metaCtor=ict(),this.meta=this.metaCtor.prototype,$n(this.meta,cde()),this.meta.instance=t}return hde(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;$n(this.meta,r),EA(this.meta,oZ(oZ({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function I_(e){return I_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I_(e)}function oct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lct(n.key),n)}}function sct(e,t,r){return t&&lZ(e.prototype,t),r&&lZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lct(e){var t=uct(e,"string");return I_(t)==="symbol"?t:String(t)}function uct(e,t){if(I_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(I_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fct=function(){function e(t){oct(this,e);var r=t.getMetaConstructor();this.meta=new r}return sct(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){$n(this.meta,r),EA(this.meta,r,r)}}]),e}();function M_(e){return M_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M_(e)}function uZ(e){return vct(e)||dct(e)||hct(e)||cct()}function cct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hct(e,t){if(e){if(typeof e=="string")return mF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mF(e,t)}}function dct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vct(e){if(Array.isArray(e))return mF(e)}function mF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yct(n.key),n)}}function gct(e,t,r){return t&&fZ(e.prototype,t),r&&fZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yct(e){var t=mct(e,"string");return M_(t)==="symbol"?t:String(t)}function mct(e,t){if(M_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bF=function(e){function t(r){pct(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return gct(t,[{key:"obtain",value:function(n){TO(function(){return xO(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),a;if(i>=0)a=this.data[i],a===void 0&&(a=this.valueFactory(n),this.data[i]=a);else if(a=this.valueFactory(n),this.holes.size>0){var o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=a,this.index[n]=o}else this.data.push(a),this.index[n]=this.data.length-1;return a}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;TO(function(){return xO(n)||Jx(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=[],o=this.data.length,s=0;s<i;s++)a.push(o+s),this.data.push(void 0);var l=Jx(n)?this.index.length:n;this.index=[].concat(uZ(this.index.slice(0,l)),a,uZ(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;TO(function(){return xO(n)||Jx(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=this.index.splice(Jx(n)?this.index.length-i:n,i),o=0;o<a.length;o++){var s=a[o];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return qa(this.data,function(i,a){return!n.holes.has(a)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var a=this._getKeyByStorageIndex(i);a!==-1&&n.push([a,this.data[i]])}var o=0;return{next:function(){if(o<n.length){var l=n[o];return o+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function D_(e){return D_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D_(e)}function bct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ct(n.key),n)}}function wct(e,t,r){return t&&cZ(e.prototype,t),r&&cZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ct(e){var t=Sct(e,"string");return D_(t)==="symbol"?t:String(t)}function Sct(e,t){if(D_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(D_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cct=["data","width"],xct=function(){function e(t){var r=this;bct(this,e),this.globalMeta=t,this.metas=new bF(function(){return r._createMeta()})}return wct(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);$n(i,n),EA(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return tct(this.globalMeta.getMetaConstructor(),Cct).prototype}}]),e}();function $_(e){return $_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$_(e)}function Tct(e){return kct(e)||Rct(e)||Ect(e)||Oct()}function Oct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ect(e,t){if(e){if(typeof e=="string")return wF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wF(e,t)}}function Rct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kct(e){if(Array.isArray(e))return wF(e)}function wF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Act(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ict(n.key),n)}}function Pct(e,t,r){return t&&hZ(e.prototype,t),r&&hZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ict(e){var t=Mct(e,"string");return $_(t)==="symbol"?t:String(t)}function Mct(e,t){if($_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dct=function(){function e(t){var r=this;Act(this,e),this.columnMeta=t,this.metas=new bF(function(){return r._createRow()})}return Pct(e,[{key:"updateMeta",value:function(r,n,i){var a=this.getMeta(r,n);$n(a,i),EA(a,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);return i===void 0?a:a[i]}},{key:"setMeta",value:function(r,n,i,a){var o,s=this.metas.obtain(r).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=a}},{key:"removeMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);delete a[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,Tct(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){TO(function(){return xO(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new bF(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function N_(e){return N_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N_(e)}function $ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lct(n.key),n)}}function Nct(e,t,r){return t&&dZ(e.prototype,t),r&&dZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lct(e){var t=Fct(e,"string");return N_(t)==="symbol"?t:String(t)}function Fct(e,t){if(N_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pde=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];$ct(this,e),this.hot=t,this.globalMeta=new act(t),this.tableMeta=new fct(this.globalMeta),this.columnMeta=new xct(this.globalMeta),this.cellMeta=new Dct(this.columnMeta),i.forEach(function(a){return new a(r)}),this.globalMeta.updateMeta(n)}return Nct(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var a=i.visualRow,o=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=a,s.visualCol=o,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,a){this.cellMeta.setMeta(r,n,i,a)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();Br(pde,Pa);function wR(e){return wR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wR(e)}function vZ(e,t,r,n){var i=n.hotInstance,a=n.dataMap,o=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,f=n.firstRun,c=Oa(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":jr(h.dataSchema)?i.dataType="function":i.dataType="object",a&&a.destroy(),e=i.runHooks("before".concat(c),e,f,l);var d=new qft(i,e,u);if(t(d),wR(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var g,y=0,b=0;for(y=0,b=h.startRows;y<b;y++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)g=Mi(v),e.push(g);else if(i.dataType==="array")g=Mi(v[0]),e.push(g);else{g=[];for(var w=0,_=h.startCols;w<_;w++)g.push(null);e.push(g)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(wR(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),h.data=e,d.dataSource=e,o.data=e,o.dataType=i.dataType,o.colToProp=d.colToProp.bind(d),o.propToCol=d.propToCol.bind(d),o.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks("after".concat(c),e,f,l),f||(i.runHooks("afterChange",null,s),i.render())}function L_(e){return L_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L_(e)}function Hct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vct(n.key),n)}}function Bct(e,t,r){return t&&pZ(e.prototype,t),r&&pZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vct(e){var t=Wct(e,"string");return L_(t)==="symbol"?t:String(t)}function Wct(e,t){if(L_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(L_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jct=function(){function e(t){var r=this;Hct(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ft.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return Bct(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,a=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(a))){var o=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",o,s,r);var f=gn(r,"type")?r.type:null,c=jr(r.cells)?r.cells(i,a,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(i,a,c),l.runHooks("afterGetCellMeta",o,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(a)}}}]),e}();function F_(e){return F_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F_(e)}function Uct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gct(n.key),n)}}function zct(e,t,r){return t&&gZ(e.prototype,t),r&&gZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gct(e){var t=Yct(e,"string");return F_(t)==="symbol"?t:String(t)}function Yct(e,t){if(F_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kct=function(){function e(t){Uct(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,a){if(!a)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return zct(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var a=n.target,o=n.onChange,s=o===void 0?function(){}:o,l=typeof a=="string",u=l?a:i,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,f,s),l&&r.installPropWatcher(a,f,s)})}},{key:"installPropWatcher",value:function(r,n,i){var a=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!a.usageTracker.has(r);a.usageTracker.add(r),i.call(a,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),e}(),yZ=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Qx=function(t){return t.map(function(r){var n=r.toLowerCase();return yZ.has(n)?yZ.get(n):n}).sort().join("+")},Xct=function(t){return t.split("+")},mZ=function(t){return t.toLowerCase()},bZ;function qct(e){return Qct(e)||Jct(e)||gde(e)||Zct()}function Zct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qct(e){if(Array.isArray(e))return _F(e)}function eht(e,t){return nht(e)||rht(e,t)||gde(e,t)||tht()}function tht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gde(e,t){if(e){if(typeof e=="string")return _F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _F(e,t)}}function _F(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function nht(e){if(Array.isArray(e))return e}function iht(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var aht=function(t){var r=gA({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,g=v===void 0?function(){return!0}:v,y=f.captureCtrl,b=y===void 0?!1:y,w=f.preventDefault,_=w===void 0?!0:w,x=f.stopPropagation,T=x===void 0?!1:x,O=f.relativeToGroup,E=f.position;if(Lr(d))throw new Error("You need to define the shortcut's group.");if(jr(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(Ir(bZ||(bZ=iht([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var M={callback:h,group:d,runOnlyIf:g,captureCtrl:b,preventDefault:_,stopPropagation:T};if(lt(O)){var P=[O,E];M.relativeToGroup=P[0],M.position=P[1]}c.forEach(function(N){var D=Qx(N),L=r.hasItem(D);if(L){var V=r.getItem(D),ee=V.findIndex(function(ie){return ie.group===O});ee!==-1?E==="before"?ee-=1:ee+=1:ee=V.length,V.splice(ee,0,M)}else r.addItem(D,[M])})},i=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){Gt(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},a=function(f){var c=Qx(f);r.removeItem(c)},o=function(f){var c=r.getItems();c.forEach(function(h){var d=eht(h,2),v=d[0],g=d[1],y=g.filter(function(b){return b.group!==f});y.length===0?a(Xct(v)):(g.length=0,g.push.apply(g,qct(y)))})},s=function(f){var c=Qx(f),h=r.getItem(c);return lt(h)?h.slice():[]},l=function(f){var c=Qx(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:a,removeShortcutsByGroup:o}};function oht(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var sht=["meta","alt","shift","control"],B0=oht();function lht(e,t,r,n,i){var a=function(d){return sht.includes(d)},o=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return d.altKey&&g.push("alt"),v&&(d.ctrlKey||d.metaKey)?g.push("control/meta"):(d.ctrlKey&&g.push("control"),d.metaKey&&g.push("meta")),d.shiftKey&&g.push("shift"),g},s=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Oh(d))){var g=mZ(d.key),y=[];a(g)?B0.press(g):y=o(d);var b=[g].concat(y),w=i(d,b);!w&&(kE()&&y.includes("meta")||!kE()&&y.includes("control"))&&i(d,[g].concat(o(d,!0))),n(d)}}},l=function(d){if(t(d)!==!1){var v=mZ(d.key);a(v)!==!1&&B0.release(v)}},u=function(){B0.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",s),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=Pw(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",s),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=Pw(d)};return{mount:f,unmount:c,isPressed:function(d){return B0.isPressed(d)},releasePressedKeys:function(){return B0.releaseAll()}}}var uht=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,a=t.afterKeyDown,o=gA({errorIdExists:function(g){return'The "'.concat(g,'" context name is already registered.')}}),s="grid",l=function(g){var y=aht(g);return o.addItem(g,y),y},u=function(){return s},f=function(g){return o.getItem(g)},c=function(g){s=g},h=!1,d=lht(r,n,i,a,function(v,g){var y=f(u()),b=!1;if(!y.hasShortcut(g))return b;for(var w=y.getShortcuts(g),_=0;_<w.length;_++){var x=w[_],T=x.callback,O=x.runOnlyIf,E=x.preventDefault,M=x.stopPropagation,P=x.captureCtrl;if(O(v)!==!1&&(h=P,b=T(v,g)===!1,h=!1,E&&v.preventDefault(),M&&v.stopPropagation(),b))break}return b});return d.mount(),{addContext:l,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},wZ,_Z;function ya(e){return ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ya(e)}function SZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ws(e,t){return hht(e)||cht(e,t)||yde(e,t)||fht()}function fht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function hht(e){if(Array.isArray(e))return e}function zv(e){return pht(e)||vht(e)||yde(e)||dht()}function dht(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yde(e,t){if(e){if(typeof e=="string")return SF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SF(e,t)}}function vht(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pht(e){if(Array.isArray(e))return SF(e)}function SF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ght="gridDefault",q2=null,eT=new Set;function yj(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,o=this,s=new un(o),l,u,f,c,h=!0;Oat(i)&&Tat(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=Elt(t.language);var g=new pde(o,t,[jct,Kct]),y=g.getTableMeta(),b=g.getGlobalMeta(),w=gA();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),XL(this)&&Qfe(t.licenseKey,e),this.guid="ht_".concat(dV()),this.columnIndexMapper=new cF,this.rowIndexMapper=new cF,u=new Zat(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var _=function(R){var I=R.row,k=R.col;return o._createCellCoords(I>=0?o.rowIndexMapper.getRenderableFromVisualIndex(I):I,k>=0?o.columnIndexMapper.getRenderableFromVisualIndex(k):k)},x=function(R){var I=R.row,k=R.col;return o._createCellCoords(I>=0?o.rowIndexMapper.getVisualFromRenderableIndex(I):I,k>=0?o.columnIndexMapper.getVisualFromRenderableIndex(k):k)},T=new kft(y,{rowIndexMapper:function(){return o.rowIndexMapper},columnIndexMapper:function(){return o.columnIndexMapper},countCols:function(){return o.countCols()},countRows:function(){return o.countRows()},propToCol:function(R){return l.propToCol(R)},isEditorOpened:function(){return o.getActiveEditor()?o.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return o.getShortcutManager()},createCellCoords:function(R,I){return o._createCellCoords(R,I)},createCellRange:function(R,I,k){return o._createCellRange(R,I,k)},visualToRenderableCoords:_,renderableToVisualCoords:x,isDisabledCellSelection:function(R,I){return o.getCellMeta(R,I).disableVisualSelection}});this.selection=T;var O=function(R){var I=R.hiddenIndexesChanged;I&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",O),this.rowIndexMapper.addLocalHook("cacheUpdated",O),this.selection.addLocalHook("beforeSetRangeStart",function(C){n.runHooks("beforeSetRangeStart",C)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(C){n.runHooks("beforeSetRangeStartOnly",C)}),this.selection.addLocalHook("beforeSetRangeEnd",function(C){n.runHooks("beforeSetRangeEnd",C),C.row<0&&(C.row=n.view._wt.wtTable.getFirstVisibleRow()),C.col<0&&(C.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(C){var R=_d(!1),I=n.selection.getSelectedRange(),k=I.current(),F=k.from,H=k.to,W=I.size()-1;n.runHooks("afterSelection",F.row,F.col,H.row,H.col,R,W),n.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),H.row,o.colToProp(H.col),R,W);var Q=n.selection.isSelectedByAnyHeader(),se=n.selection.selectedRange.current(),we=!0;a&&(we=!1),R.isTouched()&&(we=!R.value);var pe=n.selection.isSelectedByRowHeader(),me=n.selection.isSelectedByColumnHeader();we!==!1&&(Q?pe?n.view.scrollViewportVertically(o.rowIndexMapper.getRenderableFromVisualIndex(C.row)):me&&n.view.scrollViewportHorizontally(o.columnIndexMapper.getRenderableFromVisualIndex(C.col)):se&&!n.selection.isMultiple()?n.view.scrollViewport(_(se.from)):n.view.scrollViewport(_(C))),pe&&me?Ue(n.rootElement,["ht__selection--rows","ht__selection--columns"]):pe?(Mt(n.rootElement,"ht__selection--columns"),Ue(n.rootElement,"ht__selection--rows")):me?(Mt(n.rootElement,"ht__selection--rows"),Ue(n.rootElement,"ht__selection--columns")):Mt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(C){var R=C.length-1,I=C[R],k=I.from,F=I.to;n.runHooks("afterSelectionEnd",k.row,k.col,F.row,F.col,R),n.runHooks("afterSelectionEndByProp",k.row,o.colToProp(k.col),F.row,o.colToProp(F.col),R)}),this.selection.addLocalHook("afterIsMultipleSelection",function(C){var R=n.runHooks("afterIsMultipleSelection",C.value);C.value&&(C.value=R)}),this.selection.addLocalHook("beforeModifyTransformStart",function(C){n.runHooks("modifyTransformStart",C)}),this.selection.addLocalHook("afterModifyTransformStart",function(C,R,I){n.runHooks("afterModifyTransformStart",C,R,I)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(C){n.runHooks("modifyTransformEnd",C)}),this.selection.addLocalHook("afterModifyTransformEnd",function(C,R,I){n.runHooks("afterModifyTransformEnd",C,R,I)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Mt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(C){n.alter("insert_row_above",C,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(C){n.alter("insert_col_start",C,1,"auto")}),f={alter:function(R,I){var k,F,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,W=arguments.length>3?arguments[3]:void 0,Q=arguments.length>4?arguments[4]:void 0,se=function(Et){if(Et.length===0)return[];var St=zv(Et);St.sort(function(rr,Qt){var Ht=Ws(rr,1),Bt=Ht[0],qr=Ws(Qt,1),_r=qr[0];return Bt===_r?0:Bt>_r?1:-1});var tr=On(St,function(rr,Qt){var Ht=Ws(Qt,2),Bt=Ht[0],qr=Ht[1],_r=rr[rr.length-1],fr=Ws(_r,2),or=fr[0],Yo=fr[1],to=or+Yo;if(Bt<=to){var ro=Math.max(qr-(to-Bt),0);_r[1]+=ro}else rr.push([Bt,qr]);return rr},[St[0]]);return tr};switch(R){case"insert_row":eT.has(R)||(eT.add(R),Fr(Ir(wZ||(wZ=SZ(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),R)));case"insert_row_below":case"insert_row_above":var we=o.countSourceRows();if(y.maxRows===we)return;var pe=R==="insert_row_below"?"below":"above";I=(k=I)!==null&&k!==void 0?k:R==="insert_row"||pe==="below"?we:0;var me=l.createRow(I,H,{source:W,mode:pe}),Ie=me.delta,z=me.startPhysicalIndex;if(Ie){var Le=T.selectedRange.current(),ye=Le==null?void 0:Le.from,Xe=ye==null?void 0:ye.row,Ge=o.toVisualRow(z);if(T.isSelectedByCorner())o.selectAll();else if(lt(Xe)&&Xe>=Ge){var De=Le.to,tt=De.row,Qe=De.col,G=ye.col;T.isSelectedByRowHeader()&&(G=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(o._createCellCoords(Xe+Ie,G),!0),T.setRangeEnd(o._createCellCoords(tt+Ie,Qe))}else o._refreshBorders()}break;case"insert_col":eT.has(R)||(eT.add(R),Fr(Ir(_Z||(_Z=SZ(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),R)));case"insert_col_start":case"insert_col_end":var Z=R==="insert_col_end"?"end":"start";I=(F=I)!==null&&F!==void 0?F:R==="insert_col"||Z==="end"?o.countSourceCols():0;var ae=l.createCol(I,H,{source:W,mode:Z}),Se=ae.delta,fe=ae.startPhysicalIndex;if(Se){if(Array.isArray(y.colHeaders)){var Te=[o.toVisualColumn(fe),0];Te.length+=Se,Array.prototype.splice.apply(y.colHeaders,Te)}var ve=T.selectedRange.current(),ge=ve==null?void 0:ve.from,Oe=ge==null?void 0:ge.col,Ce=o.toVisualColumn(fe);if(T.isSelectedByCorner())o.selectAll();else if(lt(Oe)&&Oe>=Ce){var be=ve.to,He=be.row,qe=be.col,Je=ge.row;T.isSelectedByColumnHeader()&&(Je=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(o._createCellCoords(Je,Oe+Se),!0),T.setRangeEnd(o._createCellCoords(He,qe+Se))}else o._refreshBorders()}break;case"remove_row":var mt=function(Et){var St=0;ue(Et,function(tr){var rr=Ws(tr,2),Qt=rr[0],Ht=rr[1],Bt=Un(Qt)?o.countRows()-1:Math.max(Qt-St,0);Number.isInteger(Qt)&&(Qt=Math.max(Qt-St,0));var qr=l.removeRow(Qt,Ht,W);if(qr){var _r=o.countRows(),fr=y.fixedRowsTop;fr>=Bt+1&&(y.fixedRowsTop-=Math.min(Ht,fr-Bt));var or=y.fixedRowsBottom;or&&Bt>=_r-or&&(y.fixedRowsBottom-=Math.min(Ht,or)),St+=Ht}})};Array.isArray(I)?mt(se(I)):mt([[I,H]]),f.adjustRowsAndCols(),o._refreshBorders();break;case"remove_col":var It=function(Et){var St=0;ue(Et,function(tr){var rr=Ws(tr,2),Qt=rr[0],Ht=rr[1],Bt=Un(Qt)?o.countCols()-1:Math.max(Qt-St,0),qr=o.toPhysicalColumn(Bt);Number.isInteger(Qt)&&(Qt=Math.max(Qt-St,0));var _r=l.removeCol(Qt,Ht,W);if(_r){var fr=y.fixedColumnsStart;fr>=Bt+1&&(y.fixedColumnsStart-=Math.min(Ht,fr-Bt)),Array.isArray(y.colHeaders)&&(typeof qr>"u"&&(qr=-1),y.colHeaders.splice(qr,Ht)),St+=Ht}})};Array.isArray(I)?It(se(I)):It([[I,H]]),f.adjustRowsAndCols(),o._refreshBorders();break;default:throw new Error('There is no such action "'.concat(R,'"'))}Q||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var R=y.minRows,I=y.minSpareRows,k=y.minCols,F=y.minSpareCols;if(o.countRows()===0&&o.countCols()===0&&T.deselect(),R){var H=o.countRows();H<R&&l.createRow(H,R-H,{source:"auto"})}if(I){var W=o.countEmptyRows(!0);if(W<I){var Q=I-W,se=Math.min(Q,y.maxRows-o.countSourceRows());l.createRow(o.countRows(),se,{source:"auto"})}}{var we;(k||F)&&(we=o.countEmptyCols(!0));var pe=o.countCols();if(k&&!y.columns&&pe<k){var me=k-pe;we+=me,l.createCol(pe,me,{source:"auto"})}if(F&&!y.columns&&o.dataType==="array"&&we<F){pe=o.countCols();var Ie=F-we,z=Math.min(Ie,y.maxCols-pe);l.createCol(pe,z,{source:"auto"})}}if(T.isSelected()){var Le=o.countRows(),ye=o.countCols();ue(T.selectedRange,function(Xe){var Ge=!1,De=Xe.from.row,tt=Xe.from.col,Qe=Xe.to.row,G=Xe.to.col;De>Le-1?(De=Le-1,Ge=!0,Qe>De&&(Qe=De)):Qe>Le-1&&(Qe=Le-1,Ge=!0,De>Qe&&(De=Qe)),tt>ye-1?(tt=ye-1,Ge=!0,G>tt&&(G=tt)):G>ye-1&&(G=ye-1,Ge=!0,tt>G&&(tt=G)),Ge&&o.selectCell(De,tt,Qe,G)})}o.view&&o.view.adjustElementsSize()},populateFromArray:function(R,I,k,F,H,W,Q){var se,we,pe,me,Ie=[],z={},Le=[],ye=R.row,Xe=R.col;if(we=I.length,we===0)return!1;var Ge=0,De=0;switch(zt(k)&&(Ge=k.col-Xe+1,De=k.row-ye+1),H){case"shift_down":var tt=$b(I),Qe=tt.length,G=Math.max(Qe,Ge),Z=o.getData().slice(ye),ae=$b(Z).slice(Xe,Xe+G);for(pe=0;pe<G;pe+=1)if(pe<Qe){for(se=0,we=tt[pe].length;se<De-we;se+=1)tt[pe].push(tt[pe][se%we]);pe<ae.length?Le.push(tt[pe].concat(ae[pe])):Le.push(tt[pe].concat(new Array(Z.length).fill(null)))}else Le.push(tt[pe%Qe].concat(ae[pe]));o.populateFromArray(ye,Xe,$b(Le));break;case"shift_right":var Se=I.length,fe=Math.max(Se,De),Te=o.getData().slice(ye).map(function(fr){return fr.slice(Xe)});for(se=0;se<fe;se+=1)if(se<Se){for(pe=0,me=I[se].length;pe<Ge-me;pe+=1)I[se].push(I[se][pe%me]);if(se<Te.length)for(var ve=0;ve<Te[se].length;ve+=1)I[se].push(Te[se][ve]);else{var ge;(ge=I[se]).push.apply(ge,zv(new Array(Te[0].length).fill(null)))}}else I.push(I[se%we].slice(0,fe).concat(Te[se]));o.populateFromArray(ye,Xe,I);break;case"overwrite":default:z.row=R.row,z.col=R.col;var Oe={row:k&&R?k.row-R.row+1:1,col:k&&R?k.col-R.col+1:1},Ce=0,be=0,He=!0,qe,Je=function(or){var Yo=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,to=I[or%I.length];return Yo!==null?to[Yo%to.length]:to},mt=I.length,It=k?k.row-R.row+1:0;for(k?we=It:we=Math.max(mt,It),se=0;se<we&&!(k&&z.row>k.row&&It>mt||!y.allowInsertRow&&z.row>o.countRows()-1||z.row>=y.maxRows);se++){var ur=se-Ce,Et=Je(ur).length,St=k?k.col-R.col+1:0;if(k?me=St:me=Math.max(Et,St),z.col=R.col,qe=o.getCellMeta(z.row,z.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&qe.skipRowOnPaste){Ce+=1,z.row+=1,we+=1;continue}for(be=0,pe=0;pe<me&&!(k&&z.col>k.col&&St>Et||!y.allowInsertColumn&&z.col>o.countCols()-1||z.col>=y.maxCols);pe++){if(qe=o.getCellMeta(z.row,z.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&qe.skipColumnOnPaste){be+=1,z.col+=1,me+=1;continue}if(qe.readOnly&&F!=="UndoRedo.undo"){z.col+=1;continue}var tr=pe-be,rr=Je(ur,tr),Qt=o.getDataAtCell(z.row,z.col),Ht={row:ur,col:tr};if(F==="Autofill.fill"){var Bt=o.runHooks("beforeAutofillInsidePopulate",Ht,W,I,Q,{},Oe);Bt&&(rr=Lr(Bt.value)?rr:Bt.value)}if(rr!==null&&ya(rr)==="object")if(Array.isArray(rr)&&Qt===null&&(Qt=[]),Qt===null||ya(Qt)!=="object")He=!1;else{var qr=sg(Array.isArray(Qt)?Qt:Qt[0]||Qt),_r=sg(Array.isArray(rr)?rr:rr[0]||rr);j4(qr,_r)||Array.isArray(qr)&&Array.isArray(_r)?rr=Mi(rr):He=!1}else Qt!==null&&ya(Qt)==="object"&&(He=!1);He&&Ie.push([z.row,z.col,rr]),He=!0,z.col+=1}z.row+=1}o.setDataAtCell(Ie,null,null,F||"populateFromArray");break}}};function E(C){var R=zhe(C);hj(R)?(o.runHooks("beforeLanguageChange",R),b.language=R,o.runHooks("afterLanguageChange",R)):Ghe(C)}function M(C,R){var I=C==="className"?o.rootElement:o.table;if(h)Ue(I,R);else{var k=[],F=[];b[C]&&(k=Array.isArray(b[C])?b[C]:KN(b[C])),R&&(F=Array.isArray(R)?R:KN(R));var H=YN(k,F),W=YN(F,k);H.length&&Mt(I,H),W.length&&Ue(I,W)}b[C]=R}this.init=function(){u.setData(y.data),o.runHooks("beforeInit"),(ms()||G4())&&Ue(o.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new Bat(this),c=jqe.getInstance(o,y,T),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&o.rootElement.offsetParent===null&&uce(o.rootElement,function(){o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),ya(h)==="object"&&(o.runHooks("afterChange",h[0],h[1]),h=!1),o.runHooks("afterInit")};function P(){var C=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,C=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&C===!1&&(C=!0,this.onQueueEmpty(this.valid))}}}function N(C){var R=C.replace(",",".");return isNaN(parseFloat(R))===!1?parseFloat(R):C}function D(C,R,I){if(C.length){var k=o.getActiveEditor(),F=o.runHooks("beforeChange",C,R||"edit"),H=!0;if(F===!1){k&&k.cancelChanges();return}var W=new P;W.onQueueEmpty=function(Le){k&&H&&k.cancelChanges(),I(Le)};for(var Q=C.length-1;Q>=0;Q--)if(C[Q]===null)C.splice(Q,1);else{var se=Ws(C[Q],4),we=se[0],pe=se[1],me=se[3],Ie=l.propToCol(pe),z=o.getCellMeta(we,Ie);z.type==="numeric"&&typeof me=="string"&&Ice(me)&&(C[Q][3]=N(me)),o.getCellValidator(z)&&(W.addValidatorToQueue(),o.validateCell(C[Q][3],z,function(Le,ye){return function(Xe){if(typeof Xe!="boolean")throw new Error("Validation error: result is not boolean");if(Xe===!1&&ye.allowInvalid===!1){H=!1,C.splice(Le,1),ye.valid=!0;var Ge=o.getCell(ye.visualRow,ye.visualCol);Ge!==null&&Mt(Ge,y.invalidCellClassName)}W.removeValidatorFormQueue()}}(Q,z),R))}W.checkIfQueueIsEmpty()}}function L(C,R){var I=C.length-1;if(!(I<0)){for(;I>=0;I--){var k=!1;if(C[I]===null){C.splice(I,1);continue}if(!((C[I][2]===null||C[I][2]===void 0)&&(C[I][3]===null||C[I][3]===void 0))){if(y.allowInsertRow)for(;C[I][0]>o.countRows()-1;){var F=l.createRow(void 0,void 0,{source:R}),H=F.delta;if(H===0){k=!0;break}}if(o.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(C[I][1])>o.countCols()-1;){var W=l.createCol(void 0,void 0,{source:R}),Q=W.delta;if(Q===0){k=!0;break}}k||l.set(C[I][0],C[I][1],C[I][3])}}o.forceFullRender=!0,f.adjustRowsAndCols(),o.runHooks("beforeChangeRender",C,R),c.lockEditor(),o._refreshBorders(null),c.unlockEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",C,R||"edit");var se=o.getActiveEditor();se&&lt(se.refreshValue)&&se.refreshValue()}}this._createCellCoords=function(C,R){return o.view._wt.createCellCoords(C,R)},this._createCellRange=function(C,R,I){return o.view._wt.createCellRange(C,R,I)},this.validateCell=function(C,R,I,k){var F=o.getCellValidator(R);function H(W){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!Q||R.hidden===!0){I(W);return}var se=R.visualCol,we=R.visualRow,pe=o.getCell(we,se,!0);if(pe&&pe.nodeName!=="TH"){var me=o.rowIndexMapper.getRenderableFromVisualIndex(we),Ie=o.columnIndexMapper.getRenderableFromVisualIndex(se);o.view._wt.getSetting("cellRenderer",me,Ie,pe)}I(W)}Jfe(F)&&(F=function(W){return function(Q,se){se(W.test(Q))}}(F)),jr(F)?(C=o.runHooks("beforeValidate",C,R.visualRow,R.prop,k),o._registerImmediate(function(){F.call(R,C,function(W){o&&(W=o.runHooks("afterValidate",W,C,R.visualRow,R.prop,k),R.valid=W,H(W),o.runHooks("postAfterValidate",W,C,R.visualRow,R.prop,k))})})):o._registerImmediate(function(){R.valid=!0,H(R.valid,!1)})};function V(C,R,I){return Array.isArray(C)?C:[[C,R,I]]}this.setDataAtCell=function(C,R,I,k){var F=V(C,R,I),H=[],W=k,Q,se,we;for(Q=0,se=F.length;Q<se;Q++){if(ya(F[Q])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[Q][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[Q][1]>=this.countCols()?we=F[Q][1]:we=l.colToProp(F[Q][1]),H.push([F[Q][0],we,u.getAtCell(this.toPhysicalRow(F[Q][0]),F[Q][1]),F[Q][2]])}!W&&ya(C)==="object"&&(W=R),o.runHooks("afterSetDataAtCell",H,W),D(H,W,function(){L(H,W)})},this.setDataAtRowProp=function(C,R,I,k){var F=V(C,R,I),H=[],W=k,Q,se;for(Q=0,se=F.length;Q<se;Q++)H.push([F[Q][0],F[Q][1],u.getAtCell(this.toPhysicalRow(F[Q][0]),F[Q][1]),F[Q][2]]);!W&&ya(C)==="object"&&(W=R),o.runHooks("afterSetDataAtRowProp",H,W),D(H,W,function(){L(H,W)})},this.listen=function(){o&&!o.isListening()&&(q2=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(q2=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return q2===o.guid},this.destroyEditor=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o._refreshBorders(C,R)},this.populateFromArray=function(C,R,I,k,F,H,W,Q,se){if(!(ya(I)==="object"&&ya(I[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var we=typeof k=="number"?o._createCellCoords(k,F):null;return f.populateFromArray(o._createCellCoords(C,R),I,we,H,W,Q,se)},this.spliceCol=function(C,R,I){for(var k,F=arguments.length,H=new Array(F>3?F-3:0),W=3;W<F;W++)H[W-3]=arguments[W];return(k=l).spliceCol.apply(k,[C,R,I].concat(H))},this.spliceRow=function(C,R,I){for(var k,F=arguments.length,H=new Array(F>3?F-3:0),W=3;W<F;W++)H[W-3]=arguments[W];return(k=l).spliceRow.apply(k,[C,R,I].concat(H))},this.getSelected=function(){if(T.isSelected())return Ut(T.getSelectedRange(),function(C){var R=C.from,I=C.to;return[R.row,R.col,I.row,I.col]})},this.getSelectedLast=function(){var C=this.getSelected(),R;return C&&C.length>0&&(R=C[C.length-1]),R},this.getSelectedRange=function(){if(T.isSelected())return Array.from(T.getSelectedRange())},this.getSelectedRangeLast=function(){var C=this.getSelectedRange(),R;return C&&C.length>0&&(R=C[C.length-1]),R},this.emptySelectedCells=function(C){var R=this;if(!(!T.isSelected()||this.countRows()===0||this.countCols()===0)){var I=[];ue(T.getSelectedRange(),function(k){var F=k.getTopStartCorner(),H=k.getBottomEndCorner();yt(F.row,H.row,function(W){yt(F.col,H.col,function(Q){R.getCellMeta(W,Q).readOnly||I.push([W,Q,null])})})}),I.length>0&&this.setDataAtCell(I,C)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var C=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(C,0),!this.isRenderSuspended()&&C===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(C){this.suspendRender();var R=C();return this.resumeRender(),R},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(R,0),(!this.isExecutionSuspended()&&R===this.executionSuspendedCounter||C)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(C){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var I=C();return this.resumeExecution(R),I},this.batch=function(C){this.suspendRender(),this.suspendExecution();var R=C();return this.resumeExecution(),this.resumeRender(),R},this.refreshDimensions=function(){if(o.view){var C=o.view.getLastSize(),R=C.width,I=C.height,k=o.rootElement.getBoundingClientRect(),F=k.width,H=k.height,W=F!==R||H!==I,Q=o.runHooks("beforeRefreshDimensions",{width:R,height:I},{width:F,height:H},W)===!1;Q||((W||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(F,H),o.render()),o.runHooks("afterRefreshDimensions",{width:R,height:I},{width:F,height:H},W))}},this.updateData=function(C,R){var I=this;vZ(C,function(k){l=k},function(k){l=k,o.columnIndexMapper.fitToLength(I.getInitialColumnCount()),o.rowIndexMapper.fitToLength(I.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:R,metaManager:g,firstRun:h})},this.loadData=function(C,R){vZ(C,function(I){l=I},function(){g.clearCellsCache(),o.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:R,metaManager:g,firstRun:h})},this.getInitialColumnCount=function(){var C=y.columns,R=0;if(Array.isArray(C))R=C.length;else if(jr(C))if(o.dataType==="array")for(var I=this.countSourceCols(),k=0;k<I;k+=1)C(k)&&(R+=1);else(o.dataType==="object"||o.dataType==="function")&&(R=l.colToPropCache.length);else if(lt(y.dataSchema)){var F=l.getSchema();R=Array.isArray(F)?F.length:Jk(F)}else R=this.countSourceCols();return R},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(C,R,I,k){return Lr(C)?l.getAll():l.getRange(o._createCellCoords(C,R),o._createCellCoords(I,k),l.DESTINATION_RENDERER)},this.getCopyableText=function(C,R,I,k){return l.getCopyableText(o._createCellCoords(C,R),o._createCellCoords(I,k))},this.getCopyableData=function(C,R){return l.getCopyable(C,l.colToProp(R))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(C){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=(h?o.loadData:o.updateData).bind(this),k=!1,F,H;if(lt(C.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(lt(C.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(lt(C.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(F in C)F==="data"||(F==="language"?E(C.language):F==="className"?M("className",C.className):F==="tableClassName"&&o.table?(M("tableClassName",C.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):ft.getSingleton().isRegistered(F)||ft.getSingleton().isDeprecated(F)?(jr(C[F])||Array.isArray(C[F]))&&(C[F].initialHook=!0,o.addHook(F,C[F])):!R&&gn(C,F)&&(b[F]=C[F]));C.data===void 0&&y.data===void 0?I(null,"updateSettings"):C.data!==void 0?I(C.data,"updateSettings"):C.columns!==void 0&&(l.createMap(),o.initIndexMappers());var W=o.countCols(),Q=y.columns;if(Q&&jr(Q)&&(k=!0),(C.cell!==void 0||C.cells!==void 0||C.columns!==void 0)&&g.clearCache(),W>0)for(F=0,H=0;F<W;F++){if(Q){var se=k?Q(F):Q[H];se&&g.updateColumnMeta(H,se)}H+=1}lt(C.cell)&&Gt(C.cell,function(Le){o.setCellMetaObject(Le.row,Le.col,Le)}),o.runHooks("afterCellMetaReset");var we=o.rootElement.style.height;we!==""&&(we=parseInt(o.rootElement.style.height,10));var pe=C.height;if(jr(pe)&&(pe=pe()),R){var me=o.rootElement.getAttribute("style");me&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(pe===null){var Ie=o.rootElement.getAttribute("data-initialstyle");Ie&&(Ie.indexOf("height")>-1||Ie.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",Ie):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else pe!==void 0&&(o.rootElement.style.height=isNaN(pe)?"".concat(pe):"".concat(pe,"px"),o.rootElement.style.overflow="hidden");if(typeof C.width<"u"){var z=C.width;jr(z)&&(z=z()),o.rootElement.style.width=isNaN(z)?"".concat(z):"".concat(z,"px")}R||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",C)),f.adjustRowsAndCols(),o.view&&!h&&(o.forceFullRender=!0,c.lockEditor(),o._refreshBorders(null),o.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!R&&o.view&&(we===""||pe===""||pe===void 0)&&we!==pe&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var C=o.getSelectedLast();if(y.getValue){if(jr(y.getValue))return y.getValue.call(o);if(C)return o.getData()[C[0][0]][y.getValue]}else if(C)return o.getDataAtCell(C[0],C[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(C,R,I,k,F){f.alter(C,R,I,k,F)},this.getCell=function(C,R){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,k=R,F=C;if(R>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(R)))return null;k=this.columnIndexMapper.getRenderableFromVisualIndex(R)}if(C>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(C)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(C)}return F===null||k===null?null:o.view.getCellAtCoords(o._createCellCoords(F,k),I)},this.getCoords=function(C){var R=this.view._wt.wtTable.getCoords(C);if(R===null)return null;var I=R.row,k=R.col,F=I,H=k;return I>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(I)),k>=0&&(H=this.columnIndexMapper.getVisualFromRenderableIndex(k)),o._createCellCoords(F,H)},this.colToProp=function(C){return l.colToProp(C)},this.propToCol=function(C){return l.propToCol(C)},this.toVisualRow=function(C){return n.rowIndexMapper.getVisualFromPhysicalIndex(C)},this.toVisualColumn=function(C){return n.columnIndexMapper.getVisualFromPhysicalIndex(C)},this.toPhysicalRow=function(C){return n.rowIndexMapper.getPhysicalFromVisualIndex(C)},this.toPhysicalColumn=function(C){return n.columnIndexMapper.getPhysicalFromVisualIndex(C)},this.getDataAtCell=function(C,R){return l.get(C,l.colToProp(R))},this.getDataAtRowProp=function(C,R){return l.get(C,R)},this.getDataAtCol=function(C){for(var R=[],I=l.getRange(o._createCellCoords(0,C),o._createCellCoords(y.data.length-1,C),l.DESTINATION_RENDERER),k=0;k<I.length;k+=1)for(var F=0;F<I[k].length;F+=1)R.push(I[k][F]);return R},this.getDataAtProp=function(C){for(var R=[],I=l.getRange(o._createCellCoords(0,l.propToCol(C)),o._createCellCoords(y.data.length-1,l.propToCol(C)),l.DESTINATION_RENDERER),k=0;k<I.length;k+=1)for(var F=0;F<I[k].length;F+=1)R.push(I[k][F]);return R},this.getSourceData=function(C,R,I,k){var F;return C===void 0?F=u.getData():F=u.getByRange(o._createCellCoords(C,R),o._createCellCoords(I,k)),F},this.getSourceDataArray=function(C,R,I,k){var F;return C===void 0?F=u.getData(!0):F=u.getByRange(o._createCellCoords(C,R),o._createCellCoords(I,k),!0),F},this.getSourceDataAtCol=function(C){return u.getAtColumn(C)},this.setSourceDataAtCell=function(C,R,I,k){var F=V(C,R,I),H=this.hasHook("afterSetSourceDataAtCell"),W=[];H&&ue(F,function(se){var we=Ws(se,3),pe=we[0],me=we[1],Ie=we[2];W.push([pe,me,u.getAtCell(pe,me),Ie])}),ue(F,function(se){var we=Ws(se,3),pe=we[0],me=we[1],Ie=we[2];u.setAtCell(pe,me,Ie)}),H&&this.runHooks("afterSetSourceDataAtCell",W,k),this.render();var Q=o.getActiveEditor();Q&&lt(Q.refreshValue)&&Q.refreshValue()},this.getSourceDataAtRow=function(C){return u.getAtRow(C)},this.getSourceDataAtCell=function(C,R){return u.getAtCell(C,R)},this.getDataAtRow=function(C){var R=l.getRange(o._createCellCoords(C,0),o._createCellCoords(C,this.countCols()-1),l.DESTINATION_RENDERER);return R[0]||[]},this.getDataType=function(C,R,I,k){var F=this,H=C===void 0?[0,0,this.countRows(),this.countCols()]:[C,R,I,k],W=H[0],Q=H[1],se=H[2],we=H[3],pe=null,me=null;se===void 0&&(se=W),we===void 0&&(we=Q);var Ie="mixed";return yt(Math.max(Math.min(W,se),0),Math.max(W,se),function(z){var Le=!0;return yt(Math.max(Math.min(Q,we),0),Math.max(Q,we),function(ye){var Xe=F.getCellMeta(z,ye);return me=Xe.type,pe?Le=pe===me:pe=me,Le}),Ie=Le?me:"mixed",Le}),Ie},this.removeCellMeta=function(C,R,I){var k=[this.toPhysicalRow(C),this.toPhysicalColumn(R)],F=k[0],H=k[1],W=g.getCellMetaKeyValue(F,H,I),Q=o.runHooks("beforeRemoveCellMeta",C,R,I,W);Q!==!1&&(g.removeCellMeta(F,H,I),o.runHooks("afterRemoveCellMeta",C,R,I,W)),W=null},this.spliceCellsMeta=function(C){for(var R=this,I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=arguments.length,F=new Array(k>2?k-2:0),H=2;H<k;H++)F[H-2]=arguments[H];if(F.length>0&&!Array.isArray(F[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");I>0&&g.removeRow(this.toPhysicalRow(C),I),F.length>0&&ue(F.reverse(),function(W){g.createRow(R.toPhysicalRow(C)),ue(W,function(Q,se){return R.setCellMetaObject(C,se,Q)})}),o.render()},this.setCellMetaObject=function(C,R,I){var k=this;ya(I)==="object"&&Gt(I,function(F,H){k.setCellMeta(C,R,H,F)})},this.setCellMeta=function(C,R,I,k){var F=o.runHooks("beforeSetCellMeta",C,R,I,k);if(F!==!1){var H=C,W=R;C<this.countRows()&&(H=this.toPhysicalRow(C)),R<this.countCols()&&(W=this.toPhysicalColumn(R)),g.setCellMeta(H,W,I,k),o.runHooks("afterSetCellMeta",C,R,I,k)}},this.getCellsMeta=function(){return g.getCellsMeta()},this.getCellMeta=function(C,R){var I=this.toPhysicalRow(C),k=this.toPhysicalColumn(R);return I===null&&(I=C),k===null&&(k=R),g.getCellMeta(I,k,{visualRow:C,visualColumn:R})},this.getCellMetaAtRow=function(C){return g.getCellsMetaAtRow(C)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||y.columns)},this.getCellRenderer=function(C,R){var I=typeof C=="number"?o.getCellMeta(C,R).renderer:C.renderer;return typeof I=="string"?WE(I):Lr(I)?WE("text"):I},this.getCellEditor=function(C,R){var I=typeof C=="number"?o.getCellMeta(C,R).editor:C.editor;return typeof I=="string"?BE(I):Lr(I)?BE("text"):I},this.getCellValidator=function(C,R){var I=typeof C=="number"?o.getCellMeta(C,R).validator:C.validator;return typeof I=="string"?OV(I):I},this.validateCells=function(C){this._validateCells(C)},this.validateRows=function(C,R){if(!Array.isArray(C))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(R,C)},this.validateColumns=function(C,R){if(!Array.isArray(C))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(R,void 0,C)},this._validateCells=function(C,R,I){var k=new P;C&&(k.onQueueEmpty=C);for(var F=o.countRows()-1;F>=0;){if(R!==void 0&&R.indexOf(F)===-1){F-=1;continue}for(var H=o.countCols()-1;H>=0;){if(I!==void 0&&I.indexOf(H)===-1){H-=1;continue}k.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,H),o.getCellMeta(F,H),function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&(k.valid=!1),k.removeValidatorFormQueue()},"validateCells"),H-=1}F-=1}k.checkIfQueueIsEmpty()},this.getRowHeader=function(C){var R=y.rowHeaders,I=C;return I!==void 0&&(I=o.runHooks("modifyRowHeader",I)),I===void 0?(R=[],yt(o.countRows()-1,function(k){R.push(o.getRowHeader(k))})):Array.isArray(R)&&R[I]!==void 0?R=R[I]:jr(R)?R=R(I):R&&typeof R!="string"&&typeof R!="number"&&(R=I+1),R},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(var C=0,R=o.countCols();C<R;C++)if(o.getColHeader(C))return!0;return!1},this.getColHeader=function(C){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,I=o.runHooks("modifyColHeader",C);if(I===void 0){for(var k=[],F=o.countCols(),H=0;H<F;H++)k.push(o.getColHeader(H));return k}var W=y.colHeaders,Q=function(me){for(var Ie=[],z=o.countCols(),Le=0;Le<z;Le++)jr(y.columns)&&y.columns(Le)&&Ie.push(Le);return Ie[me]},se=o.toPhysicalColumn(I),we=Q(se);return y.colHeaders===!1?W=null:y.columns&&jr(y.columns)&&y.columns(we)&&y.columns(we).title?W=y.columns(we).title:y.columns&&y.columns[se]&&y.columns[se].title?W=y.columns[se].title:Array.isArray(y.colHeaders)&&y.colHeaders[se]!==void 0?W=y.colHeaders[se]:jr(y.colHeaders)?W=y.colHeaders(se):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(W=yA(I)),W=o.runHooks("modifyColumnHeaderValue",W,C,R),W},this._getColWidthFromSettings=function(C){var R;if(C>=0){var I=o.getCellMeta(0,C);R=I.width}if((R===void 0||R===y.width)&&(R=y.colWidths),R!=null){switch(ya(R)){case"object":R=R[C];break;case"function":R=R(C);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getColWidth=function(C){var R=o._getColWidthFromSettings(C);return R=o.runHooks("modifyColWidth",R,C),R===void 0&&(R=EV.DEFAULT_WIDTH),R},this._getRowHeightFromSettings=function(C){var R=y.rowHeights;if(R!=null){switch(ya(R)){case"object":R=R[C];break;case"function":R=R(C);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getRowHeight=function(C){var R=o._getRowHeightFromSettings(C);return R=o.runHooks("modifyRowHeight",R,C),R},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var C=y.maxCols,R=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(C,R)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return VE(o.countRows()-1,function(I){if(o.isEmptyRow(I))R+=1;else if(C===!0)return!1}),R},this.countEmptyCols=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return VE(o.countCols()-1,function(I){if(o.isEmptyCol(I))R+=1;else if(C===!0)return!1}),R},this.isEmptyRow=function(C){return y.isEmptyRow.call(o,C)},this.isEmptyCol=function(C){return y.isEmptyCol.call(o,C)},this.selectCell=function(C,R,I,k){var F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,H=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Lr(C)||Lr(R)?!1:this.selectCells([[C,R,I,k]],F,H)},this.selectCells=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R===!1&&(a=!0);var k=T.selectCells(C);return k&&I&&o.listen(),a=!1,k},this.selectColumns=function(C){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C;return T.selectColumns(C,R)},this.selectRows=function(C){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C;return T.selectRows(C,R)},this.deselectCell=function(){T.deselect()},this.selectAll=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,R=C&&this.hasRowHeaders(),I=C&&this.hasColHeaders();a=!0,T.selectAll(R,I),a=!1};var ee=function(R,I){return R.getNearestNotHiddenIndex(I,1,!0)};this.scrollViewportTo=function(C,R){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,H=!I,W=!k,Q=C,se=R;if(F){var we=Number.isInteger(C),pe=Number.isInteger(R),me=we?ee(this.rowIndexMapper,C):void 0,Ie=pe?ee(this.columnIndexMapper,R):void 0;if(me===null||Ie===null)return!1;Q=we?o.rowIndexMapper.getRenderableFromVisualIndex(me):void 0,se=pe?o.columnIndexMapper.getRenderableFromVisualIndex(Ie):void 0}var z=Number.isInteger(Q),Le=Number.isInteger(se);return z&&Le?o.view.scrollViewport(o._createCellCoords(Q,se),H,k,I,W):z&&Le===!1?o.view.scrollViewportVertically(Q,H,I):Le&&z===!1?o.view.scrollViewportHorizontally(se,k,W):!1},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),g.clearCache(),XL(o)){var C=this.rootDocument.querySelector(".hot-display-license-info");C&&C.parentNode.removeChild(C)}Os(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(function(){o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),w.getItems().forEach(function(R){var I=Ws(R,2),k=I[1];k.destroy()}),w.clear(),o.runHooks("afterDestroy")},!0),ft.getSingleton().destroy(o),Gt(o,function(R,I,k){jr(R)?k[I]=ie(I):I!=="guid"&&(k[I]=null)}),o.isDestroyed=!0,l&&l.destroy(),o.rowIndexMapper=null,o.columnIndexMapper=null,l=null,f=null,T=null,c=null,o=null};function ie(C){return function(){throw new Error('The "'.concat(C,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(C){var R=Oa(C);return R==="UndoRedo"?this.undoRedo:w.getItem(R)},this.getPluginName=function(C){return C===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:w.getId(C)},this.getInstance=function(){return o},this.addHook=function(C,R){ft.getSingleton().add(C,R,o)},this.hasHook=function(C){return ft.getSingleton().has(C,o)||ft.getSingleton().has(C)},this.addHookOnce=function(C,R){ft.getSingleton().once(C,R,o)},this.removeHook=function(C,R){ft.getSingleton().remove(C,R,o)},this.runHooks=function(C,R,I,k,F,H,W){return ft.getSingleton().run(o,C,R,I,k,F,H,W)},this.getTranslatedPhrase=function(C,R){return Qhe(y.language,C,R)},this.toHTML=function(){return wL(n)},this.toTableElement=function(){var C=n.rootDocument.createElement("div");return C.insertAdjacentHTML("afterbegin",wL(n)),C.firstElementChild},this.timeouts=[],this._registerTimeout=function(C){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=C;typeof I=="function"&&(I=setTimeout(I,R)),this.timeouts.push(I)},this._clearTimeouts=function(){ue(this.timeouts,function(C){clearTimeout(C)})},this.immediates=[],this._registerImmediate=function(C){this.immediates.push(setImmediate(C))},this._clearImmediates=function(){ue(this.immediates,function(C){clearImmediate(C)})},this._refreshBorders=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(C),o.view.render(),R&&T.isSelected()&&c.prepareEditor()},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};var le=uht({handleEvent:function(R){var I=o.isListening(),k=(R==null?void 0:R.key)!==void 0;return I&&k},beforeKeyDown:function(R){return n.runHooks("beforeKeyDown",R)},afterKeyDown:function(R){n.isDestroyed||o.runHooks("afterDocumentKeyDown",R)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(C){C.ctrlKey===!1&&C.metaKey===!1&&le.releasePressedKeys()}),this.getShortcutManager=function(){return le};var _e=le.addContext("grid"),U={runOnlyIf:function(){return lt(o.getSelected())&&o.countRenderedRows()>0&&o.countRenderedCols()>0},group:ght};le.setActiveContextName("grid"),_e.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){o.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var R=o.getSelectedRange(),I=R[R.length-1].highlight,k=I.row,F=I.col,H=o.getDataAtCell(k,F),W=new Map,Q=0;Q<R.length;Q++)R[Q].forAll(function(se,we){if(se>=0&&we>=0&&(se!==k||we!==F)){var pe=o.getCellMeta(se,we),me=pe.readOnly;me||W.set("".concat(se,"x").concat(we),[se,we,H])}});o.setDataAtCell(Array.from(W.values()))},runOnlyIf:function(){return o.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){T.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(0,1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){T.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R=o.getSelectedRangeLast(),I=R.from,k=R.to,F=o.rowIndexMapper.getNearestNotHiddenIndex(0,1);T.setRangeStart(I.clone()),T.setRangeEnd(o._createCellCoords(F,k.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){T.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){T.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R=o.getSelectedRangeLast(),I=R.from,k=R.to,F=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1);T.setRangeStart(I.clone()),T.setRangeEnd(o._createCellCoords(F,k.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){T.transformStart(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var R,I=o.getSelectedRangeLast().highlight.row,k=(R=o.columnIndexMapper).getNearestNotHiddenIndex.apply(R,zv(o.isRtl()?[o.countCols()-1,-1]:[0,1]));T.setRangeStart(o._createCellCoords(I,k))}},{keys:[["ArrowLeft","Shift"]],callback:function(){T.transformEnd(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R,I=o.getSelectedRangeLast(),k=I.from,F=I.to,H=(R=o.columnIndexMapper).getNearestNotHiddenIndex.apply(R,zv(o.isRtl()?[o.countCols()-1,-1]:[0,1]));T.setRangeStart(k.clone()),T.setRangeEnd(o._createCellCoords(F.row,H))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){T.transformStart(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var R,I=o.getSelectedRangeLast().highlight.row,k=(R=o.columnIndexMapper).getNearestNotHiddenIndex.apply(R,zv(o.isRtl()?[0,1]:[o.countCols()-1,-1]));T.setRangeStart(o._createCellCoords(I,k))}},{keys:[["ArrowRight","Shift"]],callback:function(){T.transformEnd(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R,I=o.getSelectedRangeLast(),k=I.from,F=I.to,H=(R=o.columnIndexMapper).getNearestNotHiddenIndex.apply(R,zv(o.isRtl()?[0,1]:[o.countCols()-1,-1]));T.setRangeStart(k.clone()),T.setRangeEnd(o._createCellCoords(F.row,H))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var R=parseInt(o.getSettings().fixedColumnsStart,10),I=o.getSelectedRangeLast().highlight.row,k=o.columnIndexMapper.getNearestNotHiddenIndex(R,1);T.setRangeStart(o._createCellCoords(I,k))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){T.setRangeEnd(o._createCellCoords(T.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var R=parseInt(o.getSettings().fixedRowsTop,10),I=parseInt(o.getSettings().fixedColumnsStart,10),k=o.rowIndexMapper.getNearestNotHiddenIndex(R,1),F=o.columnIndexMapper.getNearestNotHiddenIndex(I,1);T.setRangeStart(o._createCellCoords(k,F))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){T.setRangeStart(o._createCellCoords(o.getSelectedRangeLast().highlight.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){T.setRangeEnd(o._createCellCoords(T.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var R=parseInt(o.getSettings().fixedRowsBottom,10),I=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-R-1,-1),k=o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1);T.setRangeStart(o._createCellCoords(I,k))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){T.transformStart(-o.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var R=o.getSelectedRangeLast(),I=R.to,k=Math.max(I.row-o.countVisibleRows(),0),F=o.rowIndexMapper.getNearestNotHiddenIndex(k,1);if(F!==null){var H=o._createCellCoords(F,I.col),W=I.row-o.view.getFirstFullyVisibleRow(),Q=Math.max(H.row-W,0);T.setRangeEnd(H),o.scrollViewportTo(Q)}}},{keys:[["PageDown"]],callback:function(){T.transformStart(o.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var R=o.getSelectedRangeLast(),I=R.to,k=Math.min(I.row+o.countVisibleRows(),o.countRows()-1),F=o.rowIndexMapper.getNearestNotHiddenIndex(k,-1);if(F!==null){var H=o._createCellCoords(F,I.col),W=I.row-o.view.getFirstFullyVisibleRow(),Q=Math.min(H.row-W,o.countRows()-1);T.setRangeEnd(H),o.scrollViewportTo(Q)}}},{keys:[["Tab"]],callback:function(R){var I=typeof y.tabMoves=="function"?y.tabMoves(R):y.tabMoves;T.transformStart(I.row,I.col,!0)}},{keys:[["Shift","Tab"]],callback:function(R){var I=typeof y.tabMoves=="function"?y.tabMoves(R):y.tabMoves;T.transformStart(-I.row,-I.col)}}],U),TV().forEach(function(C){var R=x1(C);w.addItem(C,new R(n))}),ft.getSingleton().run(o,"construct")}var yht="hooksRefRegisterer",mde={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;ue(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;Gt(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};yl(mde,"MIXIN_NAME",yht,{writable:!1,enumerable:!1});const mht=mde;function jg(e){return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jg(e)}function bht(e,t){return Cht(e)||Sht(e,t)||_ht(e,t)||wht()}function wht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ht(e,t){if(e){if(typeof e=="string")return CZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CZ(e,t)}}function CZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Cht(e){if(Array.isArray(e))return e}function xht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CF(e,t)}function CF(e,t){return CF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CF(e,t)}function Tht(e){var t=Rht();return function(){var n=_R(e),i;if(t){var a=_R(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Oht(this,i)}}function Oht(e,t){if(t&&(jg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eht(e)}function Eht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _R(e){return _R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_R(e)}function xZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kht(n.key),n)}}function OZ(e,t,r){return t&&TZ(e.prototype,t),r&&TZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kht(e){var t=Aht(e,"string");return jg(t)==="symbol"?t:String(t)}function Aht(e,t){if(jg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pht="base",ni=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),xF="baseEditor",Dm=function(){function e(t){xZ(this,e),this.hot=t,this.instance=t,this.state=ni.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return OZ(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,a,o,s){this.TD=a,this.row=r,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=ni.VIRGIN}},{key:"extend",value:function(){return function(r){xht(i,r);var n=Tht(i);function i(){return xZ(this,i),n.apply(this,arguments)}return OZ(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,a,o,s,l;if(n){var u=this.hot.getSelectedLast();a=Math.max(Math.min(u[0],u[2]),0),o=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];a=f[0],o=f[1],s=f[2],l=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",a,o);if(Array.isArray(c)){var h=bht(c,2);a=h[0],o=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),g={runOnlyIf:function(){return lt(i.hot.getSelected())},group:xF};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],g),this.hot.populateFromArray(a,o,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===ni.VIRGIN){var i=this.hot,a=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(a,o)),this.state=ni.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:yn(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var a=this,o;if(i){var s=this._closeCallback;this._closeCallback=function(c){s&&s(c),i(c),a.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(xF),u.removeShortcutsByGroup(pA),this.state===ni.VIRGIN){this.hot._registerTimeout(function(){a._fireCallbacks(!0)});return}if(this.state===ni.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:o=[[f]],this.state=ni.WAITING,this.saveValue(o,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){a.state=ni.FINISHED,a.discardEditor(c)}):(this.state=ni.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=ni.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===ni.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=ni.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ni.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===ni.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,a=i.wtOverlays,o=i.wtViewport,s=this.hot.rootWindow,l=Dn(n),u=$r(n),f=Dn(this.hot.rootElement),c=$r(this.hot.rootElement),h=a.topOverlay.holder,d=a.inlineStartOverlay.holder,v=h!==s?h.scrollTop:0,g=d!==s?d.scrollLeft:0,y=s.innerWidth-f.left-c,b=(r=a.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,w=b.wtTable,_=w.name,x=["master","inline_start"].includes(_)?v:0,T=["master","top","bottom"].includes(_)?g:0,O=l.top===f.top?0:1,E=l.top-f.top-O-x,M=0;this.hot.isRtl()?M=s.innerWidth-l.left-u-y-1+T:M=l.left-f.left-1-T,["top","top_inline_start_corner"].includes(_)&&(E+=a.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(_)&&(M+=Math.abs(a.inlineStartOverlay.getOverlayOffset()));var P=this.hot.hasColHeaders(),N=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),D=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),L=this.hot.rowIndexMapper.getRenderableIndexesLength(),V=L-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&N<=0||N===V)&&(E+=1),D<=0&&(M+=1);var ee=o.rowsRenderCalculator.startPosition,ie=o.columnsRenderCalculator.startPosition,le=Math.abs(a.inlineStartOverlay.getScrollPosition()),_e=a.topOverlay.getScrollPosition(),U=ei(this.hot.rootDocument),C=n.offsetTop+ee-_e,R=0;if(this.hot.isRtl()){var I=n.offsetLeft;I>=0?R=w.getWidth()-n.offsetLeft:R=Math.abs(I),R+=ie-le-u}else R=n.offsetLeft+ie-le;var k=pc(this.TD,this.hot.rootWindow),F=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",H=parseInt(k[F],10)>0?0:1,W=parseInt(k.borderTopWidth,10)>0?0:1,Q=$r(n)+H,se=ln(n)+W,we=oce(h)?U:0,pe=sce(d)?U:0,me=this.hot.view.maximumVisibleElementWidth(R)-we+H,Ie=Math.max(this.hot.view.maximumVisibleElementHeight(C)-pe+W,23);return{top:E,start:M,height:se,maxHeight:Ie,width:Q,maxWidth:me}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return Pht}}]),e}();Br(Dm,mht);function Iht(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),a=function(d,v,g){d.addEventListener(v,g,!1)},o=function(d,v,g){d.removeEventListener(v,g,!1)},s=function(d){var v,g;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,i.style.position="absolute",i.style.fontSize=c(t).fontSize,i.style.fontFamily=c(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),v=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",g=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>g?t.style.height=e.minHeight+"px":e.maxHeight<g?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=g+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var g=parseInt(d.maxHeight);isNaN(g)||(e.maxHeight=g)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var y=parseInt(d.minWidth);isNaN(y)||(e.minWidth=y)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var b=parseInt(d.maxWidth);isNaN(b)||(e.maxWidth=b)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},f=function(d,v,g){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),g&&(a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)),s()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,g){f(d,v,g)},unObserve:function(){o(t,"change",s),o(t,"cut",l),o(t,"paste",l),o(t,"drop",l),o(t,"keydown",l),o(t,"focus",s),o(t,"compositionstart",l),o(t,"compositionupdate",l),o(t,"compositionend",l)},resize:s}}function EZ(e,t){for(var r=yV(t),n=t.value.split(`
`),i=r,a=0,o=0;o<n.length;o++){var s=n[o];o!==0&&(a+=n[o-1].length+1);var l=a+s.length;if(e==="home"?i=a:e==="end"&&(i=l),r<=l)break}w1(t,i)}function Ug(e){return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ug(e)}function RZ(e,t){return Nht(e)||$ht(e,t)||Dht(e,t)||Mht()}function Mht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dht(e,t){if(e){if(typeof e=="string")return kZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kZ(e,t)}}function kZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $ht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Nht(e){if(Array.isArray(e))return e}function Lht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hht(n.key),n)}}function Fht(e,t,r){return t&&AZ(e.prototype,t),r&&AZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hht(e){var t=Bht(e,"string");return Ug(t)==="symbol"?t:String(t)}function Bht(e,t){if(Ug(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zb(){return typeof Reflect<"u"&&Reflect.get?zb=Reflect.get.bind():zb=function(t,r,n){var i=Vht(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},zb.apply(this,arguments)}function Vht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Rd(e),e!==null););return e}function Wht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TF(e,t)}function TF(e,t){return TF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TF(e,t)}function jht(e){var t=zht();return function(){var n=Rd(e),i;if(t){var a=Rd(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Uht(this,i)}}function Uht(e,t){if(t&&(Ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bde(e)}function bde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rd(e){return Rd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rd(e)}var Ght="ht_editor_visible",tT="ht_editor_hidden",PZ="textEditor",Yht="text",Zd=function(e){Wht(r,e);var t=jht(r);function r(n){var i;return Lht(this,r),i=t.call(this,n),i.eventManager=new un(bde(i)),i.autoResize=Iht(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return Fht(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var a=this.hot.getShortcutManager();a.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this.state;if(zb(Rd(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==ni.FINISHED&&this.hideEditableElement();var d=!h;d&&!ms()&&this.focus()}}},{key:"beginEditing",value:function(i,a){this.state===ni.VIRGIN&&(this.TEXTAREA.value="",zb(Rd(r.prototype),"beginEditing",this).call(this,i,a))}},{key:"focus",value:function(){this.TEXTAREA.select(),w1(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ue(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),Ue(this.TEXTAREA_PARENT,"handsontableInputHolder"),Pt(this.TEXTAREA_PARENT,this.layerClass)&&Mt(this.TEXTAREA_PARENT,this.layerClass),Ue(this.TEXTAREA_PARENT,tT),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(tfe()||efe())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Mt(this.TEXTAREA_PARENT,this.layerClass),Ue(this.TEXTAREA_PARENT,tT)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,a=!1;yt(i.length-1,function(o){var s=i[o];if(Pt(s,"handsontableEditor"))return a=!0,!1}),Pt(this.TEXTAREA_PARENT,tT)&&Mt(this.TEXTAREA_PARENT,tT),a?(this.layerClass=Ght,Ue(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ue(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),a=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=a,this.setValue(a),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==ni.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var a=this.getEditedCellRect(),o=a.top,s=a.start,l=a.width,u=a.maxWidth,f=a.height,c=a.maxHeight;this.textareaParentStyle.top="".concat(o,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var h=pc(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=pc(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),g=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),y=l-v,b=f-g,w=u-v,_=c-g;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(y,w),minHeight:Math.min(b,_),maxWidth:w,maxHeight:_},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(a){return a.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(a){return a.stopPropagation()}),z4()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={runOnlyIf:function(){return lt(i.hot.getSelected())},group:PZ},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};o.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(f){return!i.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:Vb,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:Vb,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:Vb,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=RZ(c,1),d=h[0];EZ(d,i.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=RZ(c,1),d=h[0];EZ(d,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(pA),a.removeShortcutsByGroup(PZ),a.removeShortcutsByGroup(xF)}},{key:"onAfterDocumentKeyDown",value:function(i){var a=[ht.ARROW_UP,ht.ARROW_RIGHT,ht.ARROW_DOWN,ht.ARROW_LEFT];a.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return Yht}}]),r}(Dm),Kht="base";function I1(e,t,r,n,i,a,o){var s=[],l=[];o.className&&Ue(t,o.className),o.readOnly&&s.push(o.readOnlyCellClassName),o.valid===!1&&o.invalidCellClassName?s.push(o.invalidCellClassName):l.push(o.invalidCellClassName),o.wordWrap===!1&&o.noWordWrapClassName&&s.push(o.noWordWrapClassName),!a&&o.placeholder&&s.push(o.placeholderCellClassName),Mt(t,l),Ue(t,s)}I1.RENDERER_TYPE=Kht;var Xht="text";function xc(e,t,r,n,i,a,o){I1.apply(this,[e,t,r,n,i,a,o]);var s=a;if(!s&&o.placeholder&&(s=o.placeholder),s=yn(s),o.trimWhitespace&&(s=s.trim()),o.rendererTemplate){Os(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else vc(t,s)}xc.RENDERER_TYPE=Xht;var qht="text",wde={CELL_TYPE:qht,editor:Zd,renderer:xc};fs(wde);_t.editors={BaseEditor:Dm};function _t(e,t){var r=new yj(e,t||{},HV);return r.init(),r}_t.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new yj(e,t,HV)};_t.DefaultSettings=cde();_t.hooks=ft.getSingleton();_t.CellCoords=jE;_t.CellRange=RV;_t.packageName="handsontable";_t.buildDate="28/03/2023 12:24:11";_t.version="12.3.3";_t.languages={dictionaryKeys:ylt,getLanguageDictionary:Jhe,getLanguagesDictionaries:Tlt,registerLanguageDictionary:Zhe,getTranslatedPhrase:Qhe};var Hp=Symbol("unassigned"),Zht="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function SR(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _de(e){var t=_t.hooks.getRegistered(),r={};Object.assign(r,_t.DefaultSettings);for(var n in r)r[n]={default:Hp};for(var i=0;i<t.length;i++)r[t[i]]={default:Hp};return r.settings={default:Hp},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function Sde(e){var t={},r=e.settings;if(r!==Hp)for(var n in r)SR(r,n)&&r[n]!==Hp&&(t[n]=r[n]);for(var i in e)SR(e,i)&&i!=="settings"&&e[i]!==Hp&&(t[i]=e[i]);return t}function IZ(e,t){var r=Sde(e),n=e.settings?e.settings:r,i=e.settings?r:null,a={};for(var o in n)SR(n,o)&&n[o]!==void 0&&(!(t&&o!=="data")||!MZ(t[o],n[o]))&&(a[o]=n[o]);for(var s in i)SR(i,s)&&s!=="id"&&s!=="settings"&&i[s]!==void 0&&(!(t&&s!=="data")||!MZ(t[s],i[s]))&&(a[s]=i[s]);return a}function MZ(e,t){return JSON.stringify(e)===JSON.stringify(t)}var Jht="12.3.3",mj=Fu({name:"HotTable",props:_de("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=IZ(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Zht),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=IZ(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=$1e(new _t.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],i=[],a=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),o=this.hotInstance.isColumnModificationAllowed(),s=0;if(r&&r.length!==a&&r.length<a)for(var l=r.length;l<a;l++)n.push(l);if(o){var u;if(s=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==s&&r[0].length<s)for(var f=r[0].length;f<s;f++)i.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(a-1,r.length-a),o&&r.length!==0&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(s-1,r[0].length-s))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:Jht}),Qht=["id"];function edt(e,t,r,n,i,a){return ii(),ai("div",{id:e.id},[N1e(e.$slots,"default")],8,Qht)}mj.render=edt;mj.__file="src/HotTable.vue";function DZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tdt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DZ(Object(r),!0).forEach(function(n){rdt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rdt(e,t,r){return t=idt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ndt(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function idt(e){var t=ndt(e,"string");return typeof t=="symbol"?t:String(t)}var adt=Fu({name:"HotColumn",props:_de("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=Sde(this.$props),r=tdt({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});adt.__file="src/HotColumn.vue";function zg(e){return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zg(e)}function odt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ldt(n.key),n)}}function sdt(e,t,r){return t&&$Z(e.prototype,t),r&&$Z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ldt(e){var t=udt(e,"string");return zg(t)==="symbol"?t:String(t)}function udt(e,t){if(zg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cs(){return typeof Reflect<"u"&&Reflect.get?cs=Reflect.get.bind():cs=function(t,r,n){var i=fdt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},cs.apply(this,arguments)}function fdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Va(e),e!==null););return e}function cdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OF(e,t)}function OF(e,t){return OF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OF(e,t)}function hdt(e){var t=pdt();return function(){var n=Va(e),i;if(t){var a=Va(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ddt(this,i)}}function ddt(e,t){if(t&&(zg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vdt(e)}function vdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(e){return Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Va(e)}var NZ="handsontableEditor",gdt="handsontable",bj=function(e){cdt(r,e);var t=hdt(r);function r(){return odt(this,r),t.apply(this,arguments)}return sdt(r,[{key:"open",value:function(){cs(Va(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),w1(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),cs(Va(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,a,o,s,l,u){cs(Va(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var g=this.getSourceData(v.row,v.col);g!==void 0&&f.setValue(g),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&$n(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(i,a){var o=this.hot.getSettings().onBeginEditing;o&&o()===!1||cs(Va(r.prototype),"beginEditing",this).call(this,i,a)}},{key:"createElements",value:function(){cs(Va(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,a,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}cs(Va(r.prototype),"finishEditing",this).call(this,i,a,o)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor");cs(Va(r.prototype),"registerShortcuts",this).call(this);var s={group:NZ,relativeToGroup:pA,position:"before"},l=function(f,c){var h=i.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),Es(c),i.hot.listen(),i.TEXTAREA.focus(),!1};o.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),l(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return l(h,f)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){cs(Va(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(NZ)}}],[{key:"EDITOR_TYPE",get:function(){return gdt}}]),r}(Zd);function Gg(e){return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gg(e)}function ydt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cde(n.key),n)}}function mdt(e,t,r){return t&&LZ(e.prototype,t),r&&LZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mh(){return typeof Reflect<"u"&&Reflect.get?Mh=Reflect.get.bind():Mh=function(t,r,n){var i=bdt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Mh.apply(this,arguments)}function bdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ql(e),e!==null););return e}function wdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EF(e,t)}function EF(e,t){return EF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EF(e,t)}function _dt(e){var t=Cdt();return function(){var n=Ql(e),i;if(t){var a=Ql(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Sdt(this,i)}}function Sdt(e,t){if(t&&(Gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RF(e)}function RF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ql(e){return Ql=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ql(e)}function xdt(e,t,r){return t=Cde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cde(e){var t=Tdt(e,"string");return Gg(t)==="symbol"?t:String(t)}function Tdt(e,t){if(Gg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z2=new WeakMap,Odt="autocomplete",wj=function(e){wdt(r,e);var t=_dt(r);function r(n){var i;return ydt(this,r),i=t.call(this,n),xdt(RF(i),"sortByRelevance",function(a,o,s){var l=[],u=[],f=a.length,c=o.length,h,d,v,g;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=lL(yn(o[v])),s)g=d.indexOf(a);else{var y=this.cellProperties.locale;g=d.toLocaleLowerCase(y).indexOf(a.toLocaleLowerCase(y))}g!==-1&&(h=d.length-g-f,l.push({baseIndex:v,index:g,charsLeft:h,value:d}))}for(l.sort(function(b,w){if(w.index===-1)return-1;if(b.index===-1)return 1;if(b.index<w.index)return-1;if(w.index<b.index)return 1;if(b.index===w.index){if(b.charsLeft<w.charsLeft)return-1;if(b.charsLeft>w.charsLeft)return 1}return 0}),v=0,c=l.length;v<c;v++)u.push(l[v].baseIndex);return u}),i.query=null,i.strippedChoices=[],i.rawChoices=[],Z2.set(RF(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return mdt(r,[{key:"getValue",value:function(){var i=this,a=this.rawChoices.find(function(o){var s=i.stripValueIfNeeded(o);return s===i.TEXTAREA.value});return lt(a)?a:this.TEXTAREA.value}},{key:"createElements",value:function(){Mh(Ql(r.prototype),"createElements",this).call(this),Ue(this.htContainer,"autocompleteEditor"),Ue(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,a=Z2.get(this);Mh(Ql(r.prototype),"open",this).call(this);var o=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=ei();l===0&&a.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return i.onBeforeKeyDown(u)}),o.updateSettings({colWidths:s?[$r(this.TEXTAREA)-2]:void 0,width:s?$r(this.TEXTAREA)+l:void 0,renderer:function(f,c,h,d,v,g,y){xc(f,c,h,d,v,g,y);var b=i.cellProperties,w=b.filteringCaseSensitive,_=b.allowHtml,x=b.locale,T=i.query,O=yn(g),E,M;O&&!_&&(E=w===!0?O.indexOf(T):O.toLocaleLowerCase(x).indexOf(T.toLocaleLowerCase(x)),E!==-1&&(M=O.substr(E,T.length),O=O.replace(M,"<strong>".concat(M,"</strong>")))),c.innerHTML=O},autoColumnSize:!0}),a.skipOne&&(a.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Mh(Ql(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Mh(Ql(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var a=this,o=this.cellProperties.source;this.query=i,typeof o=="function"?o.call(this.cellProperties,i,function(s){a.rawChoices=s,a.updateChoicesList(a.stripValuesIfNeeded(s))}):Array.isArray(o)?(this.rawChoices=o,this.updateChoicesList(this.stripValuesIfNeeded(o))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var a=yV(this.TEXTAREA),o=ice(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,f=null,c=i;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(f=u[0]);else{for(var d=[],v=0,g=c.length;v<g&&!(s&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData($b([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),w1(this.TEXTAREA,a,a===o?void 0:o)}},{key:"flipDropdownIfNeeded",value:function(){var i=fg(this.hot.view._wt.wtTable.TABLE),a=i===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(a||!a&&(o||o==="horizontal"))return!1;var s=Dn(this.TEXTAREA),l=ln(this.TEXTAREA),u=this.getDropdownHeight(),f=i.scrollTop,c=ln(this.hot.view._wt.wtTable.THEAD),h=Dn(i),d=s.top-h.top-c+f,v=i.scrollHeight-d-c-l,g=u>v&&d>v;return g?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(g?d:v,u),g}},{key:"limitDropdownIfNeeded",value:function(i,a){if(a>i){var o=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=l,s+=1;while(o<i);u=o-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+a-u,"px")),this.setDropdownHeight(o-l)}}},{key:"flipDropdown",value:function(i){var a=this.htEditor.rootElement.style;a.position="absolute",a.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+ei(this.hot.rootDocument)+2,a=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:a?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,a=this.cellProperties.visibleRows;return this.strippedChoices.length>=a?a*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var a=this.cellProperties.allowHtml,o=Ut(i,function(l){return yn(l)}),s=Ut(o,function(l){return a?l:lL(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var a=this.htEditor.getSelectedRangeLast(),o={row:a?a.from.row:-1},s=!1;return i===ht.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(s=!0),i===ht.ARROW_UP&&o.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var a=this,o=Z2.get(this);if(o.skipOne=!1,_ce(i.keyCode)||i.keyCode===ht.BACKSPACE||i.keyCode===ht.DELETE||i.keyCode===ht.INSERT){var s=10;if(i.keyCode===ht.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){a.queryChoices(a.TEXTAREA.value),o.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return Odt}}]),r}(bj);function Yg(e){return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yg(e)}function Edt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kdt(n.key),n)}}function Rdt(e,t,r){return t&&FZ(e.prototype,t),r&&FZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kdt(e){var t=Adt(e,"string");return Yg(t)==="symbol"?t:String(t)}function Adt(e,t){if(Yg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kF(e,t)}function kF(e,t){return kF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kF(e,t)}function Idt(e){var t=$dt();return function(){var n=CR(e),i;if(t){var a=CR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Mdt(this,i)}}function Mdt(e,t){if(t&&(Yg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ddt(e)}function Ddt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $dt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function CR(e){return CR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},CR(e)}var Ndt="checkbox",xde=function(e){Pdt(r,e);var t=Idt(r);function r(){return Edt(this,r),t.apply(this,arguments)}return Rdt(r,[{key:"beginEditing",value:function(i,a){if(a&&a.type==="mouseup"){var o=this.TD.querySelector('input[type="checkbox"]');Pt(o,"htBadValue")||o.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return Ndt}}]),r}(Dm),AF={},Ldt={get exports(){return AF},set exports(e){AF=e}};const Fdt=L1e(bXe);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var i;{try{i=Fdt}catch{}e.exports=n(i)}})(Ef,function(r){var n=typeof r=="function",i=!!window.addEventListener,a=window.document,o=window.setTimeout,s=function(U,C,R,I){i?U.addEventListener(C,R,!!I):U.attachEvent("on"+C,R)},l=function(U,C,R,I){i?U.removeEventListener(C,R,!!I):U.detachEvent("on"+C,R)},u=function(U){return U.trim?U.trim():U.replace(/^\s+|\s+$/g,"")},f=function(U,C){return(" "+U.className+" ").indexOf(" "+C+" ")!==-1},c=function(U,C){f(U,C)||(U.className=U.className===""?C:U.className+" "+C)},h=function(U,C){U.className=u((" "+U.className+" ").replace(" "+C+" "," "))},d=function(U){return/Array/.test(Object.prototype.toString.call(U))},v=function(U){return/Date/.test(Object.prototype.toString.call(U))&&!isNaN(U.getTime())},g=function(U){var C=U.getDay();return C===0||C===6},y=function(U){return U%4===0&&U%100!==0||U%400===0},b=function(U,C){return[31,y(U)?29:28,31,30,31,30,31,31,30,31,30,31][C]},w=function(U){v(U)&&U.setHours(0,0,0,0)},_=function(U,C){return U.getTime()===C.getTime()},x=function(U,C,R){var I,k;for(I in C)k=U[I]!==void 0,k&&typeof C[I]=="object"&&C[I]!==null&&C[I].nodeName===void 0?v(C[I])?R&&(U[I]=new Date(C[I].getTime())):d(C[I])?R&&(U[I]=C[I].slice(0)):U[I]=x({},C[I],R):(R||!k)&&(U[I]=C[I]);return U},T=function(U,C,R){var I;a.createEvent?(I=a.createEvent("HTMLEvents"),I.initEvent(C,!0,!1),I=x(I,R),U.dispatchEvent(I)):a.createEventObject&&(I=a.createEventObject(),I=x(I,R),U.fireEvent("on"+C,I))},O=function(U){return U.month<0&&(U.year-=Math.ceil(Math.abs(U.month)/12),U.month+=12),U.month>11&&(U.year+=Math.floor(Math.abs(U.month)/12),U.month-=12),U},E={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},M=function(U,C,R){for(C+=U.firstDay;C>=7;)C-=7;return R?U.i18n.weekdaysShort[C]:U.i18n.weekdays[C]},P=function(U){var C=[],R="false";if(U.isEmpty)if(U.showDaysInNextAndPreviousMonths)C.push("is-outside-current-month"),U.enableSelectionDaysInNextAndPreviousMonths||C.push("is-selection-disabled");else return'<td class="is-empty"></td>';return U.isDisabled&&C.push("is-disabled"),U.isToday&&C.push("is-today"),U.isSelected&&(C.push("is-selected"),R="true"),U.hasEvent&&C.push("has-event"),U.isInRange&&C.push("is-inrange"),U.isStartRange&&C.push("is-startrange"),U.isEndRange&&C.push("is-endrange"),'<td data-day="'+U.day+'" class="'+C.join(" ")+'" aria-selected="'+R+'"><button class="pika-button pika-day" type="button" data-pika-year="'+U.year+'" data-pika-month="'+U.month+'" data-pika-day="'+U.day+'">'+U.day+"</button></td>"},N=function(U,C){U.setHours(0,0,0,0);var R=U.getDate(),I=U.getDay(),k=C,F=k-1,H=7,W=function(me){return(me+H-1)%H};U.setDate(R+F-W(I));var Q=new Date(U.getFullYear(),0,k),se=24*60*60*1e3,we=(U.getTime()-Q.getTime())/se,pe=1+Math.round((we-F+W(Q.getDay()))/H);return pe},D=function(U,C,R,I){var k=new Date(R,C,U),F=n?r(k).isoWeek():N(k,I);return'<td class="pika-week">'+F+"</td>"},L=function(U,C,R,I){return'<tr class="pika-row'+(R?" pick-whole-week":"")+(I?" is-selected":"")+'">'+(C?U.reverse():U).join("")+"</tr>"},V=function(U){return"<tbody>"+U.join("")+"</tbody>"},ee=function(U){var C,R=[];for(U.showWeekNumber&&R.push("<th></th>"),C=0;C<7;C++)R.push('<th scope="col"><abbr title="'+M(U,C)+'">'+M(U,C,!0)+"</abbr></th>");return"<thead><tr>"+(U.isRTL?R.reverse():R).join("")+"</tr></thead>"},ie=function(U,C,R,I,k,F){var H,W,Q,se=U._o,we=R===se.minYear,pe=R===se.maxYear,me='<div id="'+F+'" class="pika-title" role="heading" aria-live="assertive">',Ie,z,Le=!0,ye=!0;for(Q=[],H=0;H<12;H++)Q.push('<option value="'+(R===k?H-C:12+H-C)+'"'+(H===I?' selected="selected"':"")+(we&&H<se.minMonth||pe&&H>se.maxMonth?' disabled="disabled"':"")+">"+se.i18n.months[H]+"</option>");for(Ie='<div class="pika-label">'+se.i18n.months[I]+'<select class="pika-select pika-select-month" tabindex="-1">'+Q.join("")+"</select></div>",d(se.yearRange)?(H=se.yearRange[0],W=se.yearRange[1]+1):(H=R-se.yearRange,W=1+R+se.yearRange),Q=[];H<W&&H<=se.maxYear;H++)H>=se.minYear&&Q.push('<option value="'+H+'"'+(H===R?' selected="selected"':"")+">"+H+"</option>");return z='<div class="pika-label">'+R+se.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+Q.join("")+"</select></div>",se.showMonthAfterYear?me+=z+Ie:me+=Ie+z,we&&(I===0||se.minMonth>=I)&&(Le=!1),pe&&(I===11||se.maxMonth<=I)&&(ye=!1),C===0&&(me+='<button class="pika-prev'+(Le?"":" is-disabled")+'" type="button">'+se.i18n.previousMonth+"</button>"),C===U._o.numberOfMonths-1&&(me+='<button class="pika-next'+(ye?"":" is-disabled")+'" type="button">'+se.i18n.nextMonth+"</button>"),me+="</div>"},le=function(U,C,R){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+R+'">'+ee(U)+V(C)+"</table>"},_e=function(U){var C=this,R=C.config(U);C._onMouseDown=function(k){if(C._v){k=k||window.event;var F=k.target||k.srcElement;if(F)if(f(F,"is-disabled")||(f(F,"pika-button")&&!f(F,"is-empty")&&!f(F.parentNode,"is-disabled")?(C.setDate(new Date(F.getAttribute("data-pika-year"),F.getAttribute("data-pika-month"),F.getAttribute("data-pika-day"))),R.bound&&o(function(){C.hide(),R.blurFieldOnSelect&&R.field&&R.field.blur()},100)):f(F,"pika-prev")?C.prevMonth():f(F,"pika-next")&&C.nextMonth()),f(F,"pika-select"))C._c=!0;else if(k.preventDefault)k.preventDefault();else return k.returnValue=!1,!1}},C._onChange=function(k){k=k||window.event;var F=k.target||k.srcElement;F&&(f(F,"pika-select-month")?C.gotoMonth(F.value):f(F,"pika-select-year")&&C.gotoYear(F.value))},C._onKeyChange=function(k){if(k=k||window.event,C.isVisible())switch(k.keyCode){case 13:case 27:R.field&&R.field.blur();break;case 37:C.adjustDate("subtract",1);break;case 38:C.adjustDate("subtract",7);break;case 39:C.adjustDate("add",1);break;case 40:C.adjustDate("add",7);break;case 8:case 46:C.setDate(null);break}},C._parseFieldValue=function(){if(R.parse)return R.parse(R.field.value,R.format);if(n){var k=r(R.field.value,R.format,R.formatStrict);return k&&k.isValid()?k.toDate():null}else return new Date(Date.parse(R.field.value))},C._onInputChange=function(k){var F;k.firedBy!==C&&(F=C._parseFieldValue(),v(F)&&C.setDate(F),C._v||C.show())},C._onInputFocus=function(){C.show()},C._onInputClick=function(){C.show()},C._onInputBlur=function(){var k=a.activeElement;do if(f(k,"pika-single"))return;while(k=k.parentNode);C._c||(C._b=o(function(){C.hide()},50)),C._c=!1},C._onClick=function(k){k=k||window.event;var F=k.target||k.srcElement,H=F;if(F){!i&&f(F,"pika-select")&&(F.onchange||(F.setAttribute("onchange","return;"),s(F,"change",C._onChange)));do if(f(H,"pika-single")||H===R.trigger)return;while(H=H.parentNode);C._v&&F!==R.trigger&&H!==R.trigger&&C.hide()}},C.el=a.createElement("div"),C.el.className="pika-single"+(R.isRTL?" is-rtl":"")+(R.theme?" "+R.theme:""),s(C.el,"mousedown",C._onMouseDown,!0),s(C.el,"touchend",C._onMouseDown,!0),s(C.el,"change",C._onChange),R.keyboardInput&&s(a,"keydown",C._onKeyChange),R.field&&(R.container?R.container.appendChild(C.el):R.bound?a.body.appendChild(C.el):R.field.parentNode.insertBefore(C.el,R.field.nextSibling),s(R.field,"change",C._onInputChange),R.defaultDate||(R.defaultDate=C._parseFieldValue(),R.setDefaultDate=!0));var I=R.defaultDate;v(I)?R.setDefaultDate?C.setDate(I,!0):C.gotoDate(I):C.gotoDate(new Date),R.bound?(this.hide(),C.el.className+=" is-bound",s(R.trigger,"click",C._onInputClick),s(R.trigger,"focus",C._onInputFocus),s(R.trigger,"blur",C._onInputBlur)):this.show()};return _e.prototype={config:function(U){this._o||(this._o=x({},E,!0));var C=x(this._o,U,!0);C.isRTL=!!C.isRTL,C.field=C.field&&C.field.nodeName?C.field:null,C.theme=typeof C.theme=="string"&&C.theme?C.theme:null,C.bound=!!(C.bound!==void 0?C.field&&C.bound:C.field),C.trigger=C.trigger&&C.trigger.nodeName?C.trigger:C.field,C.disableWeekends=!!C.disableWeekends,C.disableDayFn=typeof C.disableDayFn=="function"?C.disableDayFn:null;var R=parseInt(C.numberOfMonths,10)||1;if(C.numberOfMonths=R>4?4:R,v(C.minDate)||(C.minDate=!1),v(C.maxDate)||(C.maxDate=!1),C.minDate&&C.maxDate&&C.maxDate<C.minDate&&(C.maxDate=C.minDate=!1),C.minDate&&this.setMinDate(C.minDate),C.maxDate&&this.setMaxDate(C.maxDate),d(C.yearRange)){var I=new Date().getFullYear()-10;C.yearRange[0]=parseInt(C.yearRange[0],10)||I,C.yearRange[1]=parseInt(C.yearRange[1],10)||I}else C.yearRange=Math.abs(parseInt(C.yearRange,10))||E.yearRange,C.yearRange>100&&(C.yearRange=100);return C},toString:function(U){return U=U||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,U):n?r(this._d).format(U):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(U,C){n&&r.isMoment(U)&&this.setDate(U.toDate(),C)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(U,C){if(!U)return this._d=null,this._o.field&&(this._o.field.value="",T(this._o.field,"change",{firedBy:this})),this.draw();if(typeof U=="string"&&(U=new Date(Date.parse(U))),!!v(U)){var R=this._o.minDate,I=this._o.maxDate;v(R)&&U<R?U=R:v(I)&&U>I&&(U=I),this._d=new Date(U.getTime()),w(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),T(this._o.field,"change",{firedBy:this})),!C&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(U){var C=!0;if(v(U)){if(this.calendars){var R=new Date(this.calendars[0].year,this.calendars[0].month,1),I=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),k=U.getTime();I.setMonth(I.getMonth()+1),I.setDate(I.getDate()-1),C=k<R.getTime()||I.getTime()<k}C&&(this.calendars=[{month:U.getMonth(),year:U.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(U,C){var R=this.getDate()||new Date,I=parseInt(C)*24*60*60*1e3,k;U==="add"?k=new Date(R.valueOf()+I):U==="subtract"&&(k=new Date(R.valueOf()-I)),this.setDate(k)},adjustCalendars:function(){this.calendars[0]=O(this.calendars[0]);for(var U=1;U<this._o.numberOfMonths;U++)this.calendars[U]=O({month:this.calendars[0].month+U,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(U){isNaN(U)||(this.calendars[0].month=parseInt(U,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(U){isNaN(U)||(this.calendars[0].year=parseInt(U,10),this.adjustCalendars())},setMinDate:function(U){U instanceof Date?(w(U),this._o.minDate=U,this._o.minYear=U.getFullYear(),this._o.minMonth=U.getMonth()):(this._o.minDate=E.minDate,this._o.minYear=E.minYear,this._o.minMonth=E.minMonth,this._o.startRange=E.startRange),this.draw()},setMaxDate:function(U){U instanceof Date?(w(U),this._o.maxDate=U,this._o.maxYear=U.getFullYear(),this._o.maxMonth=U.getMonth()):(this._o.maxDate=E.maxDate,this._o.maxYear=E.maxYear,this._o.maxMonth=E.maxMonth,this._o.endRange=E.endRange),this.draw()},setStartRange:function(U){this._o.startRange=U},setEndRange:function(U){this._o.endRange=U},draw:function(U){if(!(!this._v&&!U)){var C=this._o,R=C.minYear,I=C.maxYear,k=C.minMonth,F=C.maxMonth,H="",W;this._y<=R&&(this._y=R,!isNaN(k)&&this._m<k&&(this._m=k)),this._y>=I&&(this._y=I,!isNaN(F)&&this._m>F&&(this._m=F));for(var Q=0;Q<C.numberOfMonths;Q++)W="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),H+='<div class="pika-lendar">'+ie(this,Q,this.calendars[Q].year,this.calendars[Q].month,this.calendars[0].year,W)+this.render(this.calendars[Q].year,this.calendars[Q].month,W)+"</div>";this.el.innerHTML=H,C.bound&&C.field.type!=="hidden"&&o(function(){C.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),C.bound&&C.field.setAttribute("aria-label",C.ariaLabel)}},adjustPosition:function(){var U,C,R,I,k,F,H,W,Q,se,we,pe;if(!this._o.container){if(this.el.style.position="absolute",U=this._o.trigger,C=U,R=this.el.offsetWidth,I=this.el.offsetHeight,k=window.innerWidth||a.documentElement.clientWidth,F=window.innerHeight||a.documentElement.clientHeight,H=window.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop,we=!0,pe=!0,typeof U.getBoundingClientRect=="function")se=U.getBoundingClientRect(),W=se.left+window.pageXOffset,Q=se.bottom+window.pageYOffset;else for(W=C.offsetLeft,Q=C.offsetTop+C.offsetHeight;C=C.offsetParent;)W+=C.offsetLeft,Q+=C.offsetTop;(this._o.reposition&&W+R>k||this._o.position.indexOf("right")>-1&&W-R+U.offsetWidth>0)&&(W=W-R+U.offsetWidth,we=!1),(this._o.reposition&&Q+I>F+H||this._o.position.indexOf("top")>-1&&Q-I-U.offsetHeight>0)&&(Q=Q-I-U.offsetHeight,pe=!1),this.el.style.left=W+"px",this.el.style.top=Q+"px",c(this.el,we?"left-aligned":"right-aligned"),c(this.el,pe?"bottom-aligned":"top-aligned"),h(this.el,we?"right-aligned":"left-aligned"),h(this.el,pe?"top-aligned":"bottom-aligned")}},render:function(U,C,R){var I=this._o,k=new Date,F=b(U,C),H=new Date(U,C,1).getDay(),W=[],Q=[];w(k),I.firstDay>0&&(H-=I.firstDay,H<0&&(H+=7));for(var se=C===0?11:C-1,we=C===11?0:C+1,pe=C===0?U-1:U,me=C===11?U+1:U,Ie=b(pe,se),z=F+H,Le=z;Le>7;)Le-=7;z+=7-Le;for(var ye=!1,Xe=0,Ge=0;Xe<z;Xe++){var De=new Date(U,C,1+(Xe-H)),tt=v(this._d)?_(De,this._d):!1,Qe=_(De,k),G=I.events.indexOf(De.toDateString())!==-1,Z=Xe<H||Xe>=F+H,ae=1+(Xe-H),Se=C,fe=U,Te=I.startRange&&_(I.startRange,De),ve=I.endRange&&_(I.endRange,De),ge=I.startRange&&I.endRange&&I.startRange<De&&De<I.endRange,Oe=I.minDate&&De<I.minDate||I.maxDate&&De>I.maxDate||I.disableWeekends&&g(De)||I.disableDayFn&&I.disableDayFn(De);Z&&(Xe<H?(ae=Ie+ae,Se=se,fe=pe):(ae=ae-F,Se=we,fe=me));var Ce={day:ae,month:Se,year:fe,hasEvent:G,isSelected:tt,isToday:Qe,isDisabled:Oe,isEmpty:Z,isStartRange:Te,isEndRange:ve,isInRange:ge,showDaysInNextAndPreviousMonths:I.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:I.enableSelectionDaysInNextAndPreviousMonths};I.pickWholeWeek&&tt&&(ye=!0),Q.push(P(Ce)),++Ge===7&&(I.showWeekNumber&&Q.unshift(D(Xe-H,C,U,I.firstWeekOfYearMinDays)),W.push(L(Q,I.isRTL,I.pickWholeWeek,ye)),Q=[],Ge=0,ye=!1)}return le(I,W,R)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(a,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var U=this._v;U!==!1&&(this._o.bound&&l(a,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,U!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var U=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),U.keyboardInput&&l(a,"keydown",this._onKeyChange),U.field&&(l(U.field,"change",this._onInputChange),U.bound&&(l(U.trigger,"click",this._onInputClick),l(U.trigger,"focus",this._onInputFocus),l(U.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},_e})})(Ldt);const HZ=AF;function Kg(e){return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kg(e)}function Hdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vdt(n.key),n)}}function Bdt(e,t,r){return t&&BZ(e.prototype,t),r&&BZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vdt(e){var t=Wdt(e,"string");return Kg(t)==="symbol"?t:String(t)}function Wdt(e,t){if(Kg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gl(){return typeof Reflect<"u"&&Reflect.get?Gl=Reflect.get.bind():Gl=function(t,r,n){var i=jdt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Gl.apply(this,arguments)}function jdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vs(e),e!==null););return e}function Udt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PF(e,t)}function PF(e,t){return PF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PF(e,t)}function zdt(e){var t=Kdt();return function(){var n=vs(e),i;if(t){var a=vs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Gdt(this,i)}}function Gdt(e,t){if(t&&(Kg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ydt(e)}function Ydt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vs(e){return vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vs(e)}var Tde="date",VZ="dateEditor",Ode=function(e){Udt(r,e);var t=zdt(r);function r(n){var i;return Hdt(this,r),i=t.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return Bdt(r,[{key:"init",value:function(){var i=this;if(typeof ze!="function")throw new Error("You need to include moment.js to your project.");if(typeof HZ!="function")throw new Error("You need to include Pikaday to your project.");Gl(vs(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){Gl(vs(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ue(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new un(this);i.addEventListener(this.datePicker,"mousedown",function(a){return a.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,a,o,s,l,u){Gl(vs(r.prototype),"prepare",this).call(this,i,a,o,s,l,u)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=this.hot.getShortcutManager(),o=a.getContext("editor");Gl(vs(r.prototype),"open",this).call(this),this.showDatepicker(i),o.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:VZ})}},{key:"close",value:function(){var i,a=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){a.instance._refreshBorders()});var o=this.hot.getShortcutManager(),s=o.getContext("editor");s.removeShortcutsByGroup(VZ),Gl(vs(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var o=this.originalValue;o!==void 0&&this.setValue(o)}Gl(vs(r.prototype),"finishEditing",this).call(this,i,a)}},{key:"showDatepicker",value:function(i){var a=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?SV(i.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new HZ(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+a.top+ln(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=a.right-$r(this.datePicker):f=a.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,ze(u,o,!0).isValid()&&this.$datePicker.setMoment(ze(u,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,ze(u,o,!0).isValid()&&this.$datePicker.setMoment(ze(u,o),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,a=this.TEXTAREA,o={};this.cellProperties&&this.cellProperties.datePickerConfig&&p1(o,this.cellProperties.datePickerConfig);var s=o.onSelect,l=o.onClose;return o.field=a,o.trigger=a,o.container=this.datePicker,o.bound=!1,o.format=o.format||this.defaultDateFormat,o.reposition=o.reposition||!1,o.isRTL=!1,o.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=ze(f).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(f),i.hideDatepicker(),s&&s()},o.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},o}}],[{key:"EDITOR_TYPE",get:function(){return Tde}}]),r}(Zd);function Xg(e){return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xg(e)}function Xdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zdt(n.key),n)}}function qdt(e,t,r){return t&&WZ(e.prototype,t),r&&WZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zdt(e){var t=Jdt(e,"string");return Xg(t)==="symbol"?t:String(t)}function Jdt(e,t){if(Xg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OO(){return typeof Reflect<"u"&&Reflect.get?OO=Reflect.get.bind():OO=function(t,r,n){var i=Qdt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},OO.apply(this,arguments)}function Qdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qg(e),e!==null););return e}function evt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IF(e,t)}function IF(e,t){return IF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IF(e,t)}function tvt(e){var t=ivt();return function(){var n=qg(e),i;if(t){var a=qg(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rvt(this,i)}}function rvt(e,t){if(t&&(Xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nvt(e)}function nvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ivt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qg(e){return qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qg(e)}var avt="dropdown",_j=function(e){evt(r,e);var t=tvt(r);function r(){return Xdt(this,r),t.apply(this,arguments)}return qdt(r,[{key:"prepare",value:function(i,a,o,s,l,u){OO(qg(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return avt}}]),r}(wj);ft.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===_j&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Zg(e){return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zg(e)}function ovt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lvt(n.key),n)}}function svt(e,t,r){return t&&jZ(e.prototype,t),r&&jZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lvt(e){var t=uvt(e,"string");return Zg(t)==="symbol"?t:String(t)}function uvt(e,t){if(Zg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MF(e,t)}function MF(e,t){return MF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MF(e,t)}function cvt(e){var t=vvt();return function(){var n=xR(e),i;if(t){var a=xR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return hvt(this,i)}}function hvt(e,t){if(t&&(Zg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dvt(e)}function dvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xR(e){return xR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xR(e)}var pvt="numeric",Ede=function(e){fvt(r,e);var t=cvt(r);function r(){return ovt(this,r),t.apply(this,arguments)}return svt(r,null,[{key:"EDITOR_TYPE",get:function(){return pvt}}]),r}(Zd);function Jg(e){return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jg(e)}function gvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mvt(n.key),n)}}function yvt(e,t,r){return t&&UZ(e.prototype,t),r&&UZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mvt(e){var t=bvt(e,"string");return Jg(t)==="symbol"?t:String(t)}function bvt(e,t){if(Jg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EO(){return typeof Reflect<"u"&&Reflect.get?EO=Reflect.get.bind():EO=function(t,r,n){var i=wvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},EO.apply(this,arguments)}function wvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qg(e),e!==null););return e}function _vt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DF(e,t)}function DF(e,t){return DF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DF(e,t)}function Svt(e){var t=Tvt();return function(){var n=Qg(e),i;if(t){var a=Qg(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Cvt(this,i)}}function Cvt(e,t){if(t&&(Jg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xvt(e)}function xvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qg(e){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qg(e)}var Ovt="password",Rde=function(e){_vt(r,e);var t=Svt(r);function r(){return gvt(this,r),t.apply(this,arguments)}return yvt(r,[{key:"createElements",value:function(){EO(Qg(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Os(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return Ovt}}]),r}(Zd);function kd(e){return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function Evt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kvt(n.key),n)}}function Rvt(e,t,r){return t&&zZ(e.prototype,t),r&&zZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kvt(e){var t=Avt(e,"string");return kd(t)==="symbol"?t:String(t)}function Avt(e,t){if(kd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RO(){return typeof Reflect<"u"&&Reflect.get?RO=Reflect.get.bind():RO=function(t,r,n){var i=Pvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},RO.apply(this,arguments)}function Pvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ey(e),e!==null););return e}function Ivt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$F(e,t)}function $F(e,t){return $F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$F(e,t)}function Mvt(e){var t=Nvt();return function(){var n=ey(e),i;if(t){var a=ey(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Dvt(this,i)}}function Dvt(e,t){if(t&&(kd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $vt(e)}function $vt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ey(e){return ey=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ey(e)}var J2="ht_editor_visible",GZ="selectEditor",Lvt="select",Fvt=function(e){Ivt(r,e);var t=Mvt(r);function r(){return Evt(this,r),t.apply(this,arguments)}return Rvt(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Ue(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Pt(this.select,J2)&&Mt(this.select,J2),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this;RO(ey(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),Os(this.select),Gt(h,function(d,v){var g=f.hot.rootDocument.createElement("OPTION");g.value=v,Xd(g,d),f.select.appendChild(g)})}},{key:"prepareOptions",value:function(i){var a={};if(Array.isArray(i))for(var o=0,s=i.length;o<s;o++)a[i[o]]=i[o];else kd(i)==="object"&&(a=i);return a}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===ni.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),a=i.top,o=i.start,s=i.width,l=i.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(a,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),u.margin="0px",Ue(this.select,J2)}}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={group:GZ};this.isInFullEditMode()!==!1&&o.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=i.select.selectedIndex-1;u>=0&&(i.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=i.select.selectedIndex+1;u<=i.select.length-1&&(i.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(GZ)}}],[{key:"EDITOR_TYPE",get:function(){return Lvt}}]),r}(Dm);function ty(e){return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ty(e)}function Hvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vvt(n.key),n)}}function Bvt(e,t,r){return t&&YZ(e.prototype,t),r&&YZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vvt(e){var t=Wvt(e,"string");return ty(t)==="symbol"?t:String(t)}function Wvt(e,t){if(ty(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kO(){return typeof Reflect<"u"&&Reflect.get?kO=Reflect.get.bind():kO=function(t,r,n){var i=jvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},kO.apply(this,arguments)}function jvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ry(e),e!==null););return e}function Uvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NF(e,t)}function NF(e,t){return NF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NF(e,t)}function zvt(e){var t=Kvt();return function(){var n=ry(e),i;if(t){var a=ry(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Gvt(this,i)}}function Gvt(e,t){if(t&&(ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yvt(e)}function Yvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ry(e){return ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ry(e)}var Xvt="time",kde=function(e){Uvt(r,e);var t=zvt(r);function r(){return Hvt(this,r),t.apply(this,arguments)}return Bvt(r,[{key:"prepare",value:function(i,a,o,s,l,u){kO(ry(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return Xvt}}]),r}(Zd);function qvt(){ba(Dm),ba(wj),ba(xde),ba(Ode),ba(_j),ba(bj),ba(Ede),ba(Rde),ba(Fvt),ba(Zd),ba(kde)}var Zvt="html";function Sj(e,t,r,n,i,a,o){I1.apply(this,[e,t,r,n,i,a,o]),Xd(t,a??"",!1)}Sj.RENDERER_TYPE=Zvt;var Jvt="autocomplete";function $m(e,t,r,n,i,a,o){var s=e.rootDocument,l=o.allowHtml?Sj:xc,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,r,n,i,a,o]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),Ue(t,"htAutocomplete"),!e.acArrowListener){var f=new un(e);e.acArrowListener=function(c){Pt(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}$m.RENDERER_TYPE=Jvt;var KZ=new WeakMap,XZ=new WeakMap,Qvt="htBadValue",ny="data-row",iy="data-col",ept="checkboxRenderer",Ade="checkbox";ft.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,i=t.type,a=t.row,o=t.column,s=t.prop;if(i===Ade){if(n){var l=n.value,u=n.property,f=r;if(l)f=typeof l=="function"?l(a,o,s,r):l;else if(u){var c=this.getDataAtRowProp(a,u);f=c!==null?c:r}e=f}return e}});function Cj(e,t,r,n,i,a,o){var s=e.rootDocument;I1.apply(this,[e,t,r,n,i,a,o]),tpt(e);var l=rpt(s),u=o.label,f=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Os(t),a===o.checkedTemplate||yn(a).toLocaleLowerCase(o.locale)===yn(o.checkedTemplate).toLocaleLowerCase(o.locale)?l.checked=!0:a===o.uncheckedTemplate||yn(a).toLocaleLowerCase(o.locale)===yn(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?l.checked=!1:Un(a)?Ue(l,"noValue"):(l.style.display="none",Ue(l,Qvt),f=!0),l.setAttribute(ny,r),l.setAttribute(iy,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,i,a):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=npt(s,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(l),t.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&t.appendChild(l),f&&t.appendChild(s.createTextNode("#bad-value#")),KZ.has(e)||(KZ.set(e,!0),v());function v(){var b=e.getShortcutManager(),w=b.getContext("grid"),_={group:ept};w.addShortcuts([{keys:[["space"]],callback:function(){return g(),!y()}},{keys:[["enter"]],callback:function(){return g(),!y()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return g(!0),!y()},relativeToGroup:Vb,position:"before"}],_)}function g(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=e.getSelectedRange();if(w)for(var _=0;_<w.length;_++){for(var x=w[_].getTopStartCorner(),T=x.row,O=x.col,E=w[_].getBottomEndCorner(),M=E.row,P=E.col,N=[],D=T;D<=M;D+=1)for(var L=O;L<=P;L+=1){var V=e.getCellMeta(D,L);if(V.type!=="checkbox")return;if(V.readOnly!==!0){typeof V.checkedTemplate>"u"&&(V.checkedTemplate=!0),typeof V.uncheckedTemplate>"u"&&(V.uncheckedTemplate=!1);var ee=e.getDataAtCell(D,L);b===!1?[V.checkedTemplate,V.checkedTemplate.toString()].includes(ee)?N.push([D,L,V.uncheckedTemplate]):[V.uncheckedTemplate,V.uncheckedTemplate.toString(),null,void 0].includes(ee)&&N.push([D,L,V.checkedTemplate]):N.push([D,L,V.uncheckedTemplate])}}N.length>0&&e.setDataAtCell(N)}}function y(){var b=e.getSelectedRange();if(b){for(var w=0;w<b.length;w++)for(var _=b[w].getTopStartCorner(),x=b[w].getBottomEndCorner(),T=_.row;T<=x.row;T++)for(var O=_.col;O<=x.col;O++){var E=e.getCellMeta(T,O);if(E.type!=="checkbox")return!1;var M=e.getCell(T,O);if(M==null)return!0;var P=M.querySelectorAll("input[type=checkbox]");if(P.length>0&&!E.readOnly)return!0}return!1}}}Cj.RENDERER_TYPE=Ade;function tpt(e){var t=XZ.get(e);if(!t){var r=e.rootElement;t=new un(e),t.addEventListener(r,"click",function(n){return apt(n,e)}),t.addEventListener(r,"mouseup",function(n){return ipt(n,e)}),t.addEventListener(r,"change",function(n){return opt(n,e)}),XZ.set(e,t)}return t}function rpt(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function npt(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function ipt(e,t){var r=e.target;xj(r)&&(!r.hasAttribute(ny)||!r.hasAttribute(iy)||setTimeout(t.listen,10))}function apt(e,t){var r=e.target;if(xj(r)&&!(!r.hasAttribute(ny)||!r.hasAttribute(iy))){var n=parseInt(r.getAttribute(ny),10),i=parseInt(r.getAttribute(iy),10),a=t.getCellMeta(n,i);a.readOnly&&e.preventDefault()}}function opt(e,t){var r=e.target;if(xj(r)&&!(!r.hasAttribute(ny)||!r.hasAttribute(iy))){var n=parseInt(r.getAttribute(ny),10),i=parseInt(r.getAttribute(iy),10),a=t.getCellMeta(n,i);if(!a.readOnly){var o=null;e.target.checked?o=a.uncheckedTemplate===void 0?!0:a.checkedTemplate:o=a.uncheckedTemplate===void 0?!1:a.uncheckedTemplate,t.setDataAtCell(n,i,o)}}}function xj(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function rT(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var LF={},spt={get exports(){return LF},set exports(e){LF=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,a){function o(u,f){if(!i[u]){if(!n[u]){var c=typeof rT=="function"&&rT;if(!f&&c)return c(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(v){return o(n[u][1][v]||v)},d,d.exports,r,n,i,a)}return i[u].exports}for(var s=typeof rT=="function"&&rT,l=0;l<a.length;l++)o(a[l]);return o}({1:[function(r,n,i){(function(a){var o,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,b=1e9;function w(P){var N=0|P;return 0<P||P===N?N:N-1}function _(P){for(var N,D,L=1,V=P.length,ee=P[0]+"";L<V;){for(N=P[L++]+"",D=d-N.length;D--;N="0"+N);ee+=N}for(V=ee.length;ee.charCodeAt(--V)===48;);return ee.slice(0,V+1||1)}function x(P,N){var D,L,V=P.c,ee=N.c,ie=P.s,le=N.s,_e=P.e,U=N.e;if(!ie||!le)return null;if(D=V&&!V[0],L=ee&&!ee[0],D||L)return D?L?0:-le:ie;if(ie!=le)return ie;if(D=ie<0,L=_e==U,!V||!ee)return L?0:!V^D?1:-1;if(!L)return U<_e^D?1:-1;for(le=(_e=V.length)<(U=ee.length)?_e:U,ie=0;ie<le;ie++)if(V[ie]!=ee[ie])return V[ie]>ee[ie]^D?1:-1;return _e==U?0:U<_e^D?1:-1}function T(P,N,D,L){if(P<N||D<P||P!==(P<0?l(P):u(P)))throw Error(f+(L||"Argument")+(typeof P=="number"?P<N||D<P?" out of range: ":" not an integer: ":" not a primitive number: ")+String(P))}function O(P){var N=P.c.length-1;return w(P.e/d)==N&&P.c[N]%2!=0}function E(P,N){return(1<P.length?P.charAt(0)+"."+P.slice(1):P)+(N<0?"e":"e+")+N}function M(P,N,D){var L,V;if(N<0){for(V=D+".";++N;V+=D);P=V+P}else if(++N>(L=P.length)){for(V=D,N-=L;--N;V+=D);P+=V}else N<L&&(P=P.slice(0,N)+"."+P.slice(N));return P}(o=function P(N){var D,L,V,ee,ie,le,_e,U,C,R,I=ye.prototype={constructor:ye,toString:null,valueOf:null},k=new ye(1),F=20,H=4,W=-7,Q=21,se=-1e7,we=1e7,pe=!1,me=1,Ie=0,z={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Le="0123456789abcdefghijklmnopqrstuvwxyz";function ye(G,Z){var ae,Se,fe,Te,ve,ge,Oe,Ce,be=this;if(!(be instanceof ye))return new ye(G,Z);if(Z==null){if(G instanceof ye)return be.s=G.s,be.e=G.e,void(be.c=(G=G.c)?G.slice():G);if((ge=typeof G=="number")&&0*G==0){if(be.s=1/G<0?(G=-G,-1):1,G===~~G){for(Te=0,ve=G;10<=ve;ve/=10,Te++);return be.e=Te,void(be.c=[G])}Ce=String(G)}else{if(Ce=String(G),!s.test(Ce))return V(be,Ce,ge);be.s=Ce.charCodeAt(0)==45?(Ce=Ce.slice(1),-1):1}-1<(Te=Ce.indexOf("."))&&(Ce=Ce.replace(".","")),0<(ve=Ce.search(/e/i))?(Te<0&&(Te=ve),Te+=+Ce.slice(ve+1),Ce=Ce.substring(0,ve)):Te<0&&(Te=Ce.length)}else{if(T(Z,2,Le.length,"Base"),Ce=String(G),Z==10)return tt(be=new ye(G instanceof ye?G:Ce),F+be.e+1,H);if(ge=typeof G=="number"){if(0*G!=0)return V(be,Ce,ge,Z);if(be.s=1/G<0?(Ce=Ce.slice(1),-1):1,ye.DEBUG&&15<Ce.replace(/^0\.0*|\./,"").length)throw Error(c+G);ge=!1}else be.s=Ce.charCodeAt(0)===45?(Ce=Ce.slice(1),-1):1;for(ae=Le.slice(0,Z),Te=ve=0,Oe=Ce.length;ve<Oe;ve++)if(ae.indexOf(Se=Ce.charAt(ve))<0){if(Se=="."){if(Te<ve){Te=Oe;continue}}else if(!fe&&(Ce==Ce.toUpperCase()&&(Ce=Ce.toLowerCase())||Ce==Ce.toLowerCase()&&(Ce=Ce.toUpperCase()))){fe=!0,ve=-1,Te=0;continue}return V(be,String(G),ge,Z)}-1<(Te=(Ce=L(Ce,Z,10,be.s)).indexOf("."))?Ce=Ce.replace(".",""):Te=Ce.length}for(ve=0;Ce.charCodeAt(ve)===48;ve++);for(Oe=Ce.length;Ce.charCodeAt(--Oe)===48;);if(Ce=Ce.slice(ve,++Oe)){if(Oe-=ve,ge&&ye.DEBUG&&15<Oe&&(v<G||G!==u(G)))throw Error(c+be.s*G);if(we<(Te=Te-ve-1))be.c=be.e=null;else if(Te<se)be.c=[be.e=0];else{if(be.e=Te,be.c=[],ve=(Te+1)%d,Te<0&&(ve+=d),ve<Oe){for(ve&&be.c.push(+Ce.slice(0,ve)),Oe-=d;ve<Oe;)be.c.push(+Ce.slice(ve,ve+=d));Ce=Ce.slice(ve),ve=d-Ce.length}else ve-=Oe;for(;ve--;Ce+="0");be.c.push(+Ce)}}else be.c=[be.e=0]}function Xe(G,Z,ae,Se){var fe,Te,ve,ge,Oe;if(ae==null?ae=H:T(ae,0,8),!G.c)return G.toString();if(fe=G.c[0],ve=G.e,Z==null)Oe=_(G.c),Oe=Se==1||Se==2&&(ve<=W||Q<=ve)?E(Oe,ve):M(Oe,ve,"0");else if(Te=(G=tt(new ye(G),Z,ae)).e,ge=(Oe=_(G.c)).length,Se==1||Se==2&&(Z<=Te||Te<=W)){for(;ge<Z;Oe+="0",ge++);Oe=E(Oe,Te)}else if(Z-=ve,Oe=M(Oe,Te,"0"),ge<Te+1){if(0<--Z)for(Oe+=".";Z--;Oe+="0");}else if(0<(Z+=Te-ge))for(Te+1==ge&&(Oe+=".");Z--;Oe+="0");return G.s<0&&fe?"-"+Oe:Oe}function Ge(G,Z){for(var ae,Se=1,fe=new ye(G[0]);Se<G.length;Se++){if(!(ae=new ye(G[Se])).s){fe=ae;break}Z.call(fe,ae)&&(fe=ae)}return fe}function De(G,Z,ae){for(var Se=1,fe=Z.length;!Z[--fe];Z.pop());for(fe=Z[0];10<=fe;fe/=10,Se++);return(ae=Se+ae*d-1)>we?G.c=G.e=null:G.c=ae<se?[G.e=0]:(G.e=ae,Z),G}function tt(G,Z,ae,Se){var fe,Te,ve,ge,Oe,Ce,be,He=G.c,qe=g;if(He){e:{for(fe=1,ge=He[0];10<=ge;ge/=10,fe++);if((Te=Z-fe)<0)Te+=d,ve=Z,be=(Oe=He[Ce=0])/qe[fe-ve-1]%10|0;else if((Ce=l((Te+1)/d))>=He.length){if(!Se)break e;for(;He.length<=Ce;He.push(0));Oe=be=0,ve=(Te%=d)-d+(fe=1)}else{for(Oe=ge=He[Ce],fe=1;10<=ge;ge/=10,fe++);be=(ve=(Te%=d)-d+fe)<0?0:Oe/qe[fe-ve-1]%10|0}if(Se=Se||Z<0||He[Ce+1]!=null||(ve<0?Oe:Oe%qe[fe-ve-1]),Se=ae<4?(be||Se)&&(ae==0||ae==(G.s<0?3:2)):5<be||be==5&&(ae==4||Se||ae==6&&(0<Te?0<ve?Oe/qe[fe-ve]:0:He[Ce-1])%10&1||ae==(G.s<0?8:7)),Z<1||!He[0])return He.length=0,Se?(Z-=G.e+1,He[0]=qe[(d-Z%d)%d],G.e=-Z||0):He[0]=G.e=0,G;if(Te==0?(He.length=Ce,ge=1,Ce--):(He.length=Ce+1,ge=qe[d-Te],He[Ce]=0<ve?u(Oe/qe[fe-ve]%qe[ve])*ge:0),Se)for(;;){if(Ce==0){for(Te=1,ve=He[0];10<=ve;ve/=10,Te++);for(ve=He[0]+=ge,ge=1;10<=ve;ve/=10,ge++);Te!=ge&&(G.e++,He[0]==h&&(He[0]=1));break}if(He[Ce]+=ge,He[Ce]!=h)break;He[Ce--]=0,ge=1}for(Te=He.length;He[--Te]===0;He.pop());}G.e>we?G.c=G.e=null:G.e<se&&(G.c=[G.e=0])}return G}function Qe(G){var Z,ae=G.e;return ae===null?G.toString():(Z=_(G.c),Z=ae<=W||Q<=ae?E(Z,ae):M(Z,ae,"0"),G.s<0?"-"+Z:Z)}return ye.clone=P,ye.ROUND_UP=0,ye.ROUND_DOWN=1,ye.ROUND_CEIL=2,ye.ROUND_FLOOR=3,ye.ROUND_HALF_UP=4,ye.ROUND_HALF_DOWN=5,ye.ROUND_HALF_EVEN=6,ye.ROUND_HALF_CEIL=7,ye.ROUND_HALF_FLOOR=8,ye.EUCLID=9,ye.config=ye.set=function(G){var Z,ae;if(G!=null){if(typeof G!="object")throw Error(f+"Object expected: "+G);if(G.hasOwnProperty(Z="DECIMAL_PLACES")&&(T(ae=G[Z],0,b,Z),F=ae),G.hasOwnProperty(Z="ROUNDING_MODE")&&(T(ae=G[Z],0,8,Z),H=ae),G.hasOwnProperty(Z="EXPONENTIAL_AT")&&((ae=G[Z])&&ae.pop?(T(ae[0],-b,0,Z),T(ae[1],0,b,Z),W=ae[0],Q=ae[1]):(T(ae,-b,b,Z),W=-(Q=ae<0?-ae:ae))),G.hasOwnProperty(Z="RANGE"))if((ae=G[Z])&&ae.pop)T(ae[0],-b,-1,Z),T(ae[1],1,b,Z),se=ae[0],we=ae[1];else{if(T(ae,-b,b,Z),!ae)throw Error(f+Z+" cannot be zero: "+ae);se=-(we=ae<0?-ae:ae)}if(G.hasOwnProperty(Z="CRYPTO")){if((ae=G[Z])!==!!ae)throw Error(f+Z+" not true or false: "+ae);if(ae){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw pe=!ae,Error(f+"crypto unavailable");pe=ae}else pe=ae}if(G.hasOwnProperty(Z="MODULO_MODE")&&(T(ae=G[Z],0,9,Z),me=ae),G.hasOwnProperty(Z="POW_PRECISION")&&(T(ae=G[Z],0,b,Z),Ie=ae),G.hasOwnProperty(Z="FORMAT")){if(typeof(ae=G[Z])!="object")throw Error(f+Z+" not an object: "+ae);z=ae}if(G.hasOwnProperty(Z="ALPHABET")){if(typeof(ae=G[Z])!="string"||/^.$|[+-.\s]|(.).*\1/.test(ae))throw Error(f+Z+" invalid: "+ae);Le=ae}}return{DECIMAL_PLACES:F,ROUNDING_MODE:H,EXPONENTIAL_AT:[W,Q],RANGE:[se,we],CRYPTO:pe,MODULO_MODE:me,POW_PRECISION:Ie,FORMAT:z,ALPHABET:Le}},ye.isBigNumber=function(G){return G instanceof ye||G&&G._isBigNumber===!0||!1},ye.maximum=ye.max=function(){return Ge(arguments,I.lt)},ye.minimum=ye.min=function(){return Ge(arguments,I.gt)},ye.random=(ee=9007199254740992,ie=Math.random()*ee&2097151?function(){return u(Math.random()*ee)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(G){var Z,ae,Se,fe,Te,ve=0,ge=[],Oe=new ye(k);if(G==null?G=F:T(G,0,b),fe=l(G/d),pe)if(crypto.getRandomValues){for(Z=crypto.getRandomValues(new Uint32Array(fe*=2));ve<fe;)9e15<=(Te=131072*Z[ve]+(Z[ve+1]>>>11))?(ae=crypto.getRandomValues(new Uint32Array(2)),Z[ve]=ae[0],Z[ve+1]=ae[1]):(ge.push(Te%1e14),ve+=2);ve=fe/2}else{if(!crypto.randomBytes)throw pe=!1,Error(f+"crypto unavailable");for(Z=crypto.randomBytes(fe*=7);ve<fe;)9e15<=(Te=281474976710656*(31&Z[ve])+1099511627776*Z[ve+1]+4294967296*Z[ve+2]+16777216*Z[ve+3]+(Z[ve+4]<<16)+(Z[ve+5]<<8)+Z[ve+6])?crypto.randomBytes(7).copy(Z,ve):(ge.push(Te%1e14),ve+=7);ve=fe/7}if(!pe)for(;ve<fe;)(Te=ie())<9e15&&(ge[ve++]=Te%1e14);for(fe=ge[--ve],G%=d,fe&&G&&(Te=g[d-G],ge[ve]=u(fe/Te)*Te);ge[ve]===0;ge.pop(),ve--);if(ve<0)ge=[Se=0];else{for(Se=-1;ge[0]===0;ge.splice(0,1),Se-=d);for(ve=1,Te=ge[0];10<=Te;Te/=10,ve++);ve<d&&(Se-=d-ve)}return Oe.e=Se,Oe.c=ge,Oe}),ye.sum=function(){for(var G=1,Z=arguments,ae=new ye(Z[0]);G<Z.length;)ae=ae.plus(Z[G++]);return ae},L=function(){var G="0123456789";function Z(ae,Se,fe,Te){for(var ve,ge,Oe=[0],Ce=0,be=ae.length;Ce<be;){for(ge=Oe.length;ge--;Oe[ge]*=Se);for(Oe[0]+=Te.indexOf(ae.charAt(Ce++)),ve=0;ve<Oe.length;ve++)Oe[ve]>fe-1&&(Oe[ve+1]==null&&(Oe[ve+1]=0),Oe[ve+1]+=Oe[ve]/fe|0,Oe[ve]%=fe)}return Oe.reverse()}return function(ae,Se,fe,Te,ve){var ge,Oe,Ce,be,He,qe,Je,mt,It=ae.indexOf("."),ur=F,Et=H;for(0<=It&&(be=Ie,Ie=0,ae=ae.replace(".",""),qe=(mt=new ye(Se)).pow(ae.length-It),Ie=be,mt.c=Z(M(_(qe.c),qe.e,"0"),10,fe,G),mt.e=mt.c.length),Ce=be=(Je=Z(ae,Se,fe,ve?(ge=Le,G):(ge=G,Le))).length;Je[--be]==0;Je.pop());if(!Je[0])return ge.charAt(0);if(It<0?--Ce:(qe.c=Je,qe.e=Ce,qe.s=Te,Je=(qe=D(qe,mt,ur,Et,fe)).c,He=qe.r,Ce=qe.e),It=Je[Oe=Ce+ur+1],be=fe/2,He=He||Oe<0||Je[Oe+1]!=null,He=Et<4?(It!=null||He)&&(Et==0||Et==(qe.s<0?3:2)):be<It||It==be&&(Et==4||He||Et==6&&1&Je[Oe-1]||Et==(qe.s<0?8:7)),Oe<1||!Je[0])ae=He?M(ge.charAt(1),-ur,ge.charAt(0)):ge.charAt(0);else{if(Je.length=Oe,He)for(--fe;++Je[--Oe]>fe;)Je[Oe]=0,Oe||(++Ce,Je=[1].concat(Je));for(be=Je.length;!Je[--be];);for(It=0,ae="";It<=be;ae+=ge.charAt(Je[It++]));ae=M(ae,Ce,ge.charAt(0))}return ae}}(),D=function(){function G(Se,fe,Te){var ve,ge,Oe,Ce,be=0,He=Se.length,qe=fe%y,Je=fe/y|0;for(Se=Se.slice();He--;)be=((ge=qe*(Oe=Se[He]%y)+(ve=Je*Oe+(Ce=Se[He]/y|0)*qe)%y*y+be)/Te|0)+(ve/y|0)+Je*Ce,Se[He]=ge%Te;return be&&(Se=[be].concat(Se)),Se}function Z(Se,fe,Te,ve){var ge,Oe;if(Te!=ve)Oe=ve<Te?1:-1;else for(ge=Oe=0;ge<Te;ge++)if(Se[ge]!=fe[ge]){Oe=Se[ge]>fe[ge]?1:-1;break}return Oe}function ae(Se,fe,Te,ve){for(var ge=0;Te--;)Se[Te]-=ge,ge=Se[Te]<fe[Te]?1:0,Se[Te]=ge*ve+Se[Te]-fe[Te];for(;!Se[0]&&1<Se.length;Se.splice(0,1));}return function(Se,fe,Te,ve,ge){var Oe,Ce,be,He,qe,Je,mt,It,ur,Et,St,tr,rr,Qt,Ht,Bt,qr,_r=Se.s==fe.s?1:-1,fr=Se.c,or=fe.c;if(!(fr&&fr[0]&&or&&or[0]))return new ye(Se.s&&fe.s&&(fr?!or||fr[0]!=or[0]:or)?fr&&fr[0]==0||!or?0*_r:_r/0:NaN);for(ur=(It=new ye(_r)).c=[],_r=Te+(Ce=Se.e-fe.e)+1,ge||(ge=h,Ce=w(Se.e/d)-w(fe.e/d),_r=_r/d|0),be=0;or[be]==(fr[be]||0);be++);if(or[be]>(fr[be]||0)&&Ce--,_r<0)ur.push(1),He=!0;else{for(Qt=fr.length,Bt=or.length,_r+=2,1<(qe=u(ge/(or[be=0]+1)))&&(or=G(or,qe,ge),fr=G(fr,qe,ge),Bt=or.length,Qt=fr.length),rr=Bt,St=(Et=fr.slice(0,Bt)).length;St<Bt;Et[St++]=0);qr=or.slice(),qr=[0].concat(qr),Ht=or[0],or[1]>=ge/2&&Ht++;do{if(qe=0,(Oe=Z(or,Et,Bt,St))<0){if(tr=Et[0],Bt!=St&&(tr=tr*ge+(Et[1]||0)),1<(qe=u(tr/Ht)))for(ge<=qe&&(qe=ge-1),mt=(Je=G(or,qe,ge)).length,St=Et.length;Z(Je,Et,mt,St)==1;)qe--,ae(Je,Bt<mt?qr:or,mt,ge),mt=Je.length,Oe=1;else qe==0&&(Oe=qe=1),mt=(Je=or.slice()).length;if(mt<St&&(Je=[0].concat(Je)),ae(Et,Je,St,ge),St=Et.length,Oe==-1)for(;Z(or,Et,Bt,St)<1;)qe++,ae(Et,Bt<St?qr:or,St,ge),St=Et.length}else Oe===0&&(qe++,Et=[0]);ur[be++]=qe,Et[0]?Et[St++]=fr[rr]||0:(Et=[fr[rr]],St=1)}while((rr++<Qt||Et[0]!=null)&&_r--);He=Et[0]!=null,ur[0]||ur.splice(0,1)}if(ge==h){for(be=1,_r=ur[0];10<=_r;_r/=10,be++);tt(It,Te+(It.e=be+Ce*d-1)+1,ve,He)}else It.e=Ce,It.r=+He;return It}}(),le=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_e=/^([^.]+)\.$/,U=/^\.([^.]+)$/,C=/^-?(Infinity|NaN)$/,R=/^\s*\+(?=[\w.])|^\s+|\s+$/g,V=function(G,Z,ae,Se){var fe,Te=ae?Z:Z.replace(R,"");if(C.test(Te))G.s=isNaN(Te)?null:Te<0?-1:1,G.c=G.e=null;else{if(!ae&&(Te=Te.replace(le,function(ve,ge,Oe){return fe=(Oe=Oe.toLowerCase())=="x"?16:Oe=="b"?2:8,Se&&Se!=fe?ve:ge}),Se&&(fe=Se,Te=Te.replace(_e,"$1").replace(U,"0.$1")),Z!=Te))return new ye(Te,fe);if(ye.DEBUG)throw Error(f+"Not a"+(Se?" base "+Se:"")+" number: "+Z);G.c=G.e=G.s=null}},I.absoluteValue=I.abs=function(){var G=new ye(this);return G.s<0&&(G.s=1),G},I.comparedTo=function(G,Z){return x(this,new ye(G,Z))},I.decimalPlaces=I.dp=function(G,Z){var ae,Se,fe;if(G!=null)return T(G,0,b),Z==null?Z=H:T(Z,0,8),tt(new ye(this),G+this.e+1,Z);if(!(ae=this.c))return null;if(Se=((fe=ae.length-1)-w(this.e/d))*d,fe=ae[fe])for(;fe%10==0;fe/=10,Se--);return Se<0&&(Se=0),Se},I.dividedBy=I.div=function(G,Z){return D(this,new ye(G,Z),F,H)},I.dividedToIntegerBy=I.idiv=function(G,Z){return D(this,new ye(G,Z),0,1)},I.exponentiatedBy=I.pow=function(G,Z){var ae,Se,fe,Te,ve,ge,Oe,Ce,be=this;if((G=new ye(G)).c&&!G.isInteger())throw Error(f+"Exponent not an integer: "+Qe(G));if(Z!=null&&(Z=new ye(Z)),ve=14<G.e,!be.c||!be.c[0]||be.c[0]==1&&!be.e&&be.c.length==1||!G.c||!G.c[0])return Ce=new ye(Math.pow(+Qe(be),ve?2-O(G):+Qe(G))),Z?Ce.mod(Z):Ce;if(ge=G.s<0,Z){if(Z.c?!Z.c[0]:!Z.s)return new ye(NaN);(Se=!ge&&be.isInteger()&&Z.isInteger())&&(be=be.mod(Z))}else{if(9<G.e&&(0<be.e||be.e<-1||(be.e==0?1<be.c[0]||ve&&24e7<=be.c[1]:be.c[0]<8e13||ve&&be.c[0]<=9999975e7)))return Te=be.s<0&&O(G)?-0:0,-1<be.e&&(Te=1/Te),new ye(ge?1/Te:Te);Ie&&(Te=l(Ie/d+2))}for(Oe=ve?(ae=new ye(.5),ge&&(G.s=1),O(G)):(fe=Math.abs(+Qe(G)))%2,Ce=new ye(k);;){if(Oe){if(!(Ce=Ce.times(be)).c)break;Te?Ce.c.length>Te&&(Ce.c.length=Te):Se&&(Ce=Ce.mod(Z))}if(fe){if((fe=u(fe/2))===0)break;Oe=fe%2}else if(tt(G=G.times(ae),G.e+1,1),14<G.e)Oe=O(G);else{if((fe=+Qe(G))==0)break;Oe=fe%2}be=be.times(be),Te?be.c&&be.c.length>Te&&(be.c.length=Te):Se&&(be=be.mod(Z))}return Se?Ce:(ge&&(Ce=k.div(Ce)),Z?Ce.mod(Z):Te?tt(Ce,Ie,H,void 0):Ce)},I.integerValue=function(G){var Z=new ye(this);return G==null?G=H:T(G,0,8),tt(Z,Z.e+1,G)},I.isEqualTo=I.eq=function(G,Z){return x(this,new ye(G,Z))===0},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(G,Z){return 0<x(this,new ye(G,Z))},I.isGreaterThanOrEqualTo=I.gte=function(G,Z){return(Z=x(this,new ye(G,Z)))===1||Z===0},I.isInteger=function(){return!!this.c&&w(this.e/d)>this.c.length-2},I.isLessThan=I.lt=function(G,Z){return x(this,new ye(G,Z))<0},I.isLessThanOrEqualTo=I.lte=function(G,Z){return(Z=x(this,new ye(G,Z)))===-1||Z===0},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return 0<this.s},I.isZero=function(){return!!this.c&&this.c[0]==0},I.minus=function(G,Z){var ae,Se,fe,Te,ve=this,ge=ve.s;if(Z=(G=new ye(G,Z)).s,!ge||!Z)return new ye(NaN);if(ge!=Z)return G.s=-Z,ve.plus(G);var Oe=ve.e/d,Ce=G.e/d,be=ve.c,He=G.c;if(!Oe||!Ce){if(!be||!He)return be?(G.s=-Z,G):new ye(He?ve:NaN);if(!be[0]||!He[0])return He[0]?(G.s=-Z,G):new ye(be[0]?ve:H==3?-0:0)}if(Oe=w(Oe),Ce=w(Ce),be=be.slice(),ge=Oe-Ce){for((fe=(Te=ge<0)?(ge=-ge,be):(Ce=Oe,He)).reverse(),Z=ge;Z--;fe.push(0));fe.reverse()}else for(Se=(Te=(ge=be.length)<(Z=He.length))?ge:Z,ge=Z=0;Z<Se;Z++)if(be[Z]!=He[Z]){Te=be[Z]<He[Z];break}if(Te&&(fe=be,be=He,He=fe,G.s=-G.s),0<(Z=(Se=He.length)-(ae=be.length)))for(;Z--;be[ae++]=0);for(Z=h-1;ge<Se;){if(be[--Se]<He[Se]){for(ae=Se;ae&&!be[--ae];be[ae]=Z);--be[ae],be[Se]+=h}be[Se]-=He[Se]}for(;be[0]==0;be.splice(0,1),--Ce);return be[0]?De(G,be,Ce):(G.s=H==3?-1:1,G.c=[G.e=0],G)},I.modulo=I.mod=function(G,Z){var ae,Se,fe=this;return G=new ye(G,Z),!fe.c||!G.s||G.c&&!G.c[0]?new ye(NaN):!G.c||fe.c&&!fe.c[0]?new ye(fe):(me==9?(Se=G.s,G.s=1,ae=D(fe,G,0,3),G.s=Se,ae.s*=Se):ae=D(fe,G,0,me),(G=fe.minus(ae.times(G))).c[0]||me!=1||(G.s=fe.s),G)},I.multipliedBy=I.times=function(G,Z){var ae,Se,fe,Te,ve,ge,Oe,Ce,be,He,qe,Je,mt,It,ur,Et=this,St=Et.c,tr=(G=new ye(G,Z)).c;if(!(St&&tr&&St[0]&&tr[0]))return!Et.s||!G.s||St&&!St[0]&&!tr||tr&&!tr[0]&&!St?G.c=G.e=G.s=null:(G.s*=Et.s,St&&tr?(G.c=[0],G.e=0):G.c=G.e=null),G;for(Se=w(Et.e/d)+w(G.e/d),G.s*=Et.s,(Oe=St.length)<(He=tr.length)&&(mt=St,St=tr,tr=mt,fe=Oe,Oe=He,He=fe),fe=Oe+He,mt=[];fe--;mt.push(0));for(It=h,ur=y,fe=He;0<=--fe;){for(ae=0,qe=tr[fe]%ur,Je=tr[fe]/ur|0,Te=fe+(ve=Oe);fe<Te;)ae=((Ce=qe*(Ce=St[--ve]%ur)+(ge=Je*Ce+(be=St[ve]/ur|0)*qe)%ur*ur+mt[Te]+ae)/It|0)+(ge/ur|0)+Je*be,mt[Te--]=Ce%It;mt[Te]=ae}return ae?++Se:mt.splice(0,1),De(G,mt,Se)},I.negated=function(){var G=new ye(this);return G.s=-G.s||null,G},I.plus=function(G,Z){var ae,Se=this,fe=Se.s;if(Z=(G=new ye(G,Z)).s,!fe||!Z)return new ye(NaN);if(fe!=Z)return G.s=-Z,Se.minus(G);var Te=Se.e/d,ve=G.e/d,ge=Se.c,Oe=G.c;if(!Te||!ve){if(!ge||!Oe)return new ye(fe/0);if(!ge[0]||!Oe[0])return Oe[0]?G:new ye(ge[0]?Se:0*fe)}if(Te=w(Te),ve=w(ve),ge=ge.slice(),fe=Te-ve){for((ae=0<fe?(ve=Te,Oe):(fe=-fe,ge)).reverse();fe--;ae.push(0));ae.reverse()}for((fe=ge.length)-(Z=Oe.length)<0&&(ae=Oe,Oe=ge,ge=ae,Z=fe),fe=0;Z;)fe=(ge[--Z]=ge[Z]+Oe[Z]+fe)/h|0,ge[Z]=h===ge[Z]?0:ge[Z]%h;return fe&&(ge=[fe].concat(ge),++ve),De(G,ge,ve)},I.precision=I.sd=function(G,Z){var ae,Se,fe;if(G!=null&&G!==!!G)return T(G,1,b),Z==null?Z=H:T(Z,0,8),tt(new ye(this),G,Z);if(!(ae=this.c))return null;if(Se=(fe=ae.length-1)*d+1,fe=ae[fe]){for(;fe%10==0;fe/=10,Se--);for(fe=ae[0];10<=fe;fe/=10,Se++);}return G&&this.e+1>Se&&(Se=this.e+1),Se},I.shiftedBy=function(G){return T(G,-v,v),this.times("1e"+G)},I.squareRoot=I.sqrt=function(){var G,Z,ae,Se,fe,Te=this,ve=Te.c,ge=Te.s,Oe=Te.e,Ce=F+4,be=new ye("0.5");if(ge!==1||!ve||!ve[0])return new ye(!ge||ge<0&&(!ve||ve[0])?NaN:ve?Te:1/0);if((ae=(ge=Math.sqrt(+Qe(Te)))==0||ge==1/0?(((Z=_(ve)).length+Oe)%2==0&&(Z+="0"),ge=Math.sqrt(+Z),Oe=w((Oe+1)/2)-(Oe<0||Oe%2),new ye(Z=ge==1/0?"1e"+Oe:(Z=ge.toExponential()).slice(0,Z.indexOf("e")+1)+Oe)):new ye(ge+"")).c[0]){for((ge=(Oe=ae.e)+Ce)<3&&(ge=0);;)if(fe=ae,ae=be.times(fe.plus(D(Te,fe,Ce,1))),_(fe.c).slice(0,ge)===(Z=_(ae.c)).slice(0,ge)){if(ae.e<Oe&&--ge,(Z=Z.slice(ge-3,ge+1))!="9999"&&(Se||Z!="4999")){+Z&&(+Z.slice(1)||Z.charAt(0)!="5")||(tt(ae,ae.e+F+2,1),G=!ae.times(ae).eq(Te));break}if(!Se&&(tt(fe,fe.e+F+2,0),fe.times(fe).eq(Te))){ae=fe;break}Ce+=4,ge+=4,Se=1}}return tt(ae,ae.e+F+1,H,G)},I.toExponential=function(G,Z){return G!=null&&(T(G,0,b),G++),Xe(this,G,Z,1)},I.toFixed=function(G,Z){return G!=null&&(T(G,0,b),G=G+this.e+1),Xe(this,G,Z)},I.toFormat=function(G,Z,ae){var Se;if(ae==null)G!=null&&Z&&typeof Z=="object"?(ae=Z,Z=null):G&&typeof G=="object"?(ae=G,G=Z=null):ae=z;else if(typeof ae!="object")throw Error(f+"Argument not an object: "+ae);if(Se=this.toFixed(G,Z),this.c){var fe,Te=Se.split("."),ve=+ae.groupSize,ge=+ae.secondaryGroupSize,Oe=ae.groupSeparator||"",Ce=Te[0],be=Te[1],He=this.s<0,qe=He?Ce.slice(1):Ce,Je=qe.length;if(ge&&(fe=ve,ve=ge,Je-=ge=fe),0<ve&&0<Je){for(fe=Je%ve||ve,Ce=qe.substr(0,fe);fe<Je;fe+=ve)Ce+=Oe+qe.substr(fe,ve);0<ge&&(Ce+=Oe+qe.slice(fe)),He&&(Ce="-"+Ce)}Se=be?Ce+(ae.decimalSeparator||"")+((ge=+ae.fractionGroupSize)?be.replace(new RegExp("\\d{"+ge+"}\\B","g"),"$&"+(ae.fractionGroupSeparator||"")):be):Ce}return(ae.prefix||"")+Se+(ae.suffix||"")},I.toFraction=function(G){var Z,ae,Se,fe,Te,ve,ge,Oe,Ce,be,He,qe,Je=this,mt=Je.c;if(G!=null&&(!(ge=new ye(G)).isInteger()&&(ge.c||ge.s!==1)||ge.lt(k)))throw Error(f+"Argument "+(ge.isInteger()?"out of range: ":"not an integer: ")+Qe(ge));if(!mt)return new ye(Je);for(Z=new ye(k),Ce=ae=new ye(k),Se=Oe=new ye(k),qe=_(mt),Te=Z.e=qe.length-Je.e-1,Z.c[0]=g[(ve=Te%d)<0?d+ve:ve],G=!G||0<ge.comparedTo(Z)?0<Te?Z:Ce:ge,ve=we,we=1/0,ge=new ye(qe),Oe.c[0]=0;be=D(ge,Z,0,1),(fe=ae.plus(be.times(Se))).comparedTo(G)!=1;)ae=Se,Se=fe,Ce=Oe.plus(be.times(fe=Ce)),Oe=fe,Z=ge.minus(be.times(fe=Z)),ge=fe;return fe=D(G.minus(ae),Se,0,1),Oe=Oe.plus(fe.times(Ce)),ae=ae.plus(fe.times(Se)),Oe.s=Ce.s=Je.s,He=D(Ce,Se,Te*=2,H).minus(Je).abs().comparedTo(D(Oe,ae,Te,H).minus(Je).abs())<1?[Ce,Se]:[Oe,ae],we=ve,He},I.toNumber=function(){return+Qe(this)},I.toPrecision=function(G,Z){return G!=null&&T(G,1,b),Xe(this,G,Z,2)},I.toString=function(G){var Z,ae=this,Se=ae.s,fe=ae.e;return fe===null?Se?(Z="Infinity",Se<0&&(Z="-"+Z)):Z="NaN":(Z=G==null?fe<=W||Q<=fe?E(_(ae.c),fe):M(_(ae.c),fe,"0"):G===10?M(_((ae=tt(new ye(ae),F+fe+1,H)).c),ae.e,"0"):(T(G,2,Le.length,"Base"),L(M(_(ae.c),fe,"0"),10,G,Se,!0)),Se<0&&ae.c[0]&&(Z="-"+Z)),Z},I.valueOf=I.toJSON=function(){return Qe(this)},I._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(I[Symbol.toStringTag]="BigNumber",I[Symbol.for("nodejs.util.inspect.custom")]=I.valueOf),N!=null&&ye.set(N),ye}()).default=o.BigNumber=o,n!==void 0&&n.exports?n.exports=o:(a||(a=typeof self<"u"&&self?self:window),a.BigNumber=o)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(a){var o=a%10;return~~(a%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function a(w,_){return function(x){if(Array.isArray(x))return x}(w)||function(x,T){var O=[],E=!0,M=!1,P=void 0;try{for(var N,D=x[Symbol.iterator]();!(E=(N=D.next()).done)&&(O.push(N.value),!T||O.length!==T);E=!0);}catch(L){M=!0,P=L}finally{try{E||D.return==null||D.return()}finally{if(M)throw P}}return O}(w,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(w){var _=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},x=2<arguments.length?arguments[2]:void 0;if(typeof _=="string"&&(_=l.parseFormat(_)),!s.validateFormat(_))return"ERROR: invalid format";var T=_.prefix||"",O=_.postfix||"",E=function(M,P,N){switch(P.output){case"currency":return P=b(P,o.currentCurrencyDefaultFormat()),function(Le,ye,Xe){var Ge=Xe.currentCurrency(),De=Object.assign({},c,ye),tt=void 0,Qe="",G=!!De.totalLength||!!De.forceAverage||De.average,Z=ye.currencyPosition||Ge.position,ae=ye.currencySymbol||Ge.symbol;De.spaceSeparated&&(Qe=" "),Z==="infix"&&(tt=Qe+ae+Qe);var Se=y({instance:Le,providedFormat:ye,state:Xe,decimalSeparator:tt});return Z==="prefix"&&(Se=Le._value<0&&De.negative==="sign"?"-".concat(Qe).concat(ae).concat(Se.slice(1)):ae+Qe+Se),Z&&Z!=="postfix"||(Se=Se+(Qe=G?"":Qe)+ae),Se}(M,P,o);case"percent":return P=b(P,o.currentPercentageDefaultFormat()),function(Le,ye,Xe,Ge){var De=ye.prefixSymbol,tt=y({instance:Ge(100*Le._value),providedFormat:ye,state:Xe}),Qe=Object.assign({},c,ye);return De?"%".concat(Qe.spaceSeparated?" ":"").concat(tt):"".concat(tt).concat(Qe.spaceSeparated?" ":"","%")}(M,P,o,N);case"byte":return P=b(P,o.currentByteDefaultFormat()),k=M,H=o,W=N,Q=(F=P).base||"binary",se=f[Q],we=d(k._value,se.suffixes,se.scale),pe=we.value,me=we.suffix,Ie=y({instance:W(pe),providedFormat:F,state:H,defaults:H.currentByteDefaultFormat()}),z=H.currentAbbreviations(),"".concat(Ie).concat(z.spaced?" ":"").concat(me);case"time":return P=b(P,o.currentTimeDefaultFormat()),U=M,C=Math.floor(U._value/60/60),R=Math.floor((U._value-60*C*60)/60),I=Math.round(U._value-60*C*60-60*R),"".concat(C,":").concat(R<10?"0":"").concat(R,":").concat(I<10?"0":"").concat(I);case"ordinal":return P=b(P,o.currentOrdinalDefaultFormat()),D=M,L=P,ee=(V=o).currentOrdinal(),ie=Object.assign({},c,L),le=y({instance:D,providedFormat:L,state:V}),_e=ee(D._value),"".concat(le).concat(ie.spaceSeparated?" ":"").concat(_e);case"number":default:return y({instance:M,providedFormat:P,numbro:N})}var D,L,V,ee,ie,le,_e,U,C,R,I,k,F,H,W,Q,se,we,pe,me,Ie,z}(w,_,x);return E=(E=T+E)+O}function d(w,_,x){var T=_[0],O=Math.abs(w);if(x<=O){for(var E=1;E<_.length;++E){var M=Math.pow(x,E),P=Math.pow(x,E+1);if(M<=O&&O<P){T=_[E],w/=M;break}}T===_[0]&&(w/=Math.pow(x,_.length-1),T=_[_.length-1])}return{value:w,suffix:T}}function v(w){for(var _="",x=0;x<w;x++)_+="0";return _}function g(w,_){return w.toString().indexOf("e")!==-1?function(x,T){var O=x.toString(),E=a(O.split("e"),2),M=E[0],P=E[1],N=a(M.split("."),2),D=N[0],L=N[1],V=L===void 0?"":L;if(0<+P)O=D+V+v(P-V.length);else{var ee=".";ee=+D<0?"-0".concat(ee):"0".concat(ee);var ie=(v(-P-1)+Math.abs(D)+V).substr(0,T);ie.length<T&&(ie+=v(T-ie.length)),O=ee+ie}return 0<+P&&0<T&&(O+=".".concat(v(T))),O}(w,_):(Math.round(+"".concat(w,"e+").concat(_))/Math.pow(10,_)).toFixed(_)}function y(w){var _=w.instance,x=w.providedFormat,T=w.state,O=T===void 0?o:T,E=w.decimalSeparator,M=w.defaults,P=M===void 0?O.currentDefaults():M,N=_._value;if(N===0&&O.hasZeroFormat())return O.getZeroFormat();if(!isFinite(N))return N.toString();var D,L,V,ee,ie,le,_e,U,C=Object.assign({},c,P,x),R=C.totalLength,I=R?0:C.characteristic,k=C.optionalCharacteristic,F=C.forceAverage,H=!!R||!!F||C.average,W=R?-1:H&&x.mantissa===void 0?0:C.mantissa,Q=!R&&(x.optionalMantissa===void 0?W===-1:C.optionalMantissa),se=C.trimMantissa,we=C.thousandSeparated,pe=C.spaceSeparated,me=C.negative,Ie=C.forceSign,z=C.exponential,Le="";if(H){var ye=function(G){var Z=G.value,ae=G.forceAverage,Se=G.abbreviations,fe=G.spaceSeparated,Te=fe!==void 0&&fe,ve=G.totalLength,ge=ve===void 0?0:ve,Oe="",Ce=Math.abs(Z),be=-1;if(Ce>=Math.pow(10,12)&&!ae||ae==="trillion"?(Oe=Se.trillion,Z/=Math.pow(10,12)):Ce<Math.pow(10,12)&&Ce>=Math.pow(10,9)&&!ae||ae==="billion"?(Oe=Se.billion,Z/=Math.pow(10,9)):Ce<Math.pow(10,9)&&Ce>=Math.pow(10,6)&&!ae||ae==="million"?(Oe=Se.million,Z/=Math.pow(10,6)):(Ce<Math.pow(10,6)&&Ce>=Math.pow(10,3)&&!ae||ae==="thousand")&&(Oe=Se.thousand,Z/=Math.pow(10,3)),Oe&&(Oe=(Te?" ":"")+Oe),ge){var He=Z.toString().split(".")[0];be=Math.max(ge-He.length,0)}return{value:Z,abbreviation:Oe,mantissaPrecision:be}}({value:N,forceAverage:F,abbreviations:O.currentAbbreviations(),spaceSeparated:pe,totalLength:R});N=ye.value,Le+=ye.abbreviation,R&&(W=ye.mantissaPrecision)}if(z){var Xe=(L=(D={value:N,characteristicPrecision:I}).value,V=D.characteristicPrecision,ee=V===void 0?0:V,ie=a(L.toExponential().split("e"),2),le=ie[0],_e=ie[1],U=+le,ee&&1<ee&&(U*=Math.pow(10,ee-1),_e=0<=(_e=+_e-(ee-1))?"+".concat(_e):_e),{value:U,abbreviation:"e".concat(_e)});N=Xe.value,Le=Xe.abbreviation+Le}var Ge,De,tt,Qe=function(G,Z,ae,Se,fe){if(Se===-1)return G;var Te=g(Z,Se),ve=a(Te.toString().split("."),2),ge=ve[0],Oe=ve[1],Ce=Oe===void 0?"":Oe;if(Ce.match(/^0+$/)&&(ae||fe))return ge;var be=Ce.match(/0+$/);return fe&&be?"".concat(ge,".").concat(Ce.toString().slice(0,be.index)):Te.toString()}(N.toString(),N,Q,W,se);return Qe=function(G,Z,ae,Se,fe){var Te=Se.currentDelimiters(),ve=Te.thousands;fe=fe||Te.decimal;var ge=Te.thousandsSize||3,Oe=G.toString(),Ce=Oe.split(".")[0],be=Oe.split(".")[1];return ae&&(Z<0&&(Ce=Ce.slice(1)),function(He,qe){for(var Je=[],mt=0,It=He;0<It;It--)mt===qe&&(Je.unshift(It),mt=0),mt++;return Je}(Ce.length,ge).forEach(function(He,qe){Ce=Ce.slice(0,He+qe)+ve+Ce.slice(He+qe)}),Z<0&&(Ce="-".concat(Ce))),Oe=be?Ce+fe+be:Ce}(Qe=function(G,Z,ae,Se){var fe=G,Te=a(fe.toString().split("."),2),ve=Te[0],ge=Te[1];if(ve.match(/^-?0$/)&&ae)return ge?"".concat(ve.replace("0",""),".").concat(ge):ve.replace("0","");if(ve.length<Se)for(var Oe=Se-ve.length,Ce=0;Ce<Oe;Ce++)fe="0".concat(fe);return fe.toString()}(Qe,0,k,I),N,we,O,E),(H||z)&&(Qe=Qe+Le),(Ie||N<0)&&(Ge=Qe,tt=me,Qe=(De=N)===0?Ge:+Ge==0?Ge.replace("-",""):0<De?"+".concat(Ge):tt==="sign"?Ge:"(".concat(Ge.replace("-",""),")")),Qe}function b(w,_){if(!w)return _;var x=Object.keys(w);return x.length===1&&x[0]==="output"?_:w}n.exports=function(w){return{format:function(){for(var _=arguments.length,x=new Array(_),T=0;T<_;T++)x[T]=arguments[T];return h.apply(void 0,x.concat([w]))},getByteUnit:function(){for(var _=arguments.length,x=new Array(_),T=0;T<_;T++)x[T]=arguments[T];return function(O){var E=f.general;return d(O._value,E.suffixes,E.scale).suffix}.apply(void 0,x.concat([w]))},getBinaryByteUnit:function(){for(var _=arguments.length,x=new Array(_),T=0;T<_;T++)x[T]=arguments[T];return function(O){var E=f.binary;return d(O._value,E.suffixes,E.scale).suffix}.apply(void 0,x.concat([w]))},getDecimalByteUnit:function(){for(var _=arguments.length,x=new Array(_),T=0;T<_;T++)x[T]=arguments[T];return function(O){var E=f.decimal;return d(O._value,E.suffixes,E.scale).suffix}.apply(void 0,x.concat([w]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var a=r("./en-US"),o=r("./validating"),s=r("./parsing"),l={},u=void 0,f={},c=null,h={};function d(g){u=g}function v(){return f[u]}l.languages=function(){return Object.assign({},f)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return v().currency},l.currentAbbreviations=function(){return v().abbreviations},l.currentDelimiters=function(){return v().delimiters},l.currentOrdinal=function(){return v().ordinal},l.currentDefaults=function(){return Object.assign({},v().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().timeFormat)},l.setDefaults=function(g){g=s.parseFormat(g),o.validateFormat(g)&&(h=g)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(g){return c=typeof g=="string"?g:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(g){if(g){if(f[g])return f[g];throw new Error('Unknown tag "'.concat(g,'"'))}return v()},l.registerLanguage=function(g){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(g))throw new Error("Invalid language data");f[g.languageTag]=g,y&&d(g.languageTag)},l.setLanguage=function(g){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.languageTag;if(!f[g]){var b=g.split("-")[0],w=Object.keys(f).find(function(_){return _.split("-")[0]===b});return f[w]?void d(w):void d(y)}d(g)},l.registerLanguage(a),u=a.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(a){return{loadLanguagesInNode:function(o){return s=a,void o.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,i){var a=r("bignumber.js");function o(s,l,u){var f=new a(s._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new a(c),s._value=f.minus(c).toNumber(),s}n.exports=function(s){return{add:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(l,u){return o(l,u,s)},multiply:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(l,u){return f=l,h=c=u,s.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(l,u){return f=u,o(h=(c=s)(l._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,i){function a(y,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(y,_.key,_)}}var o=r("./globalState"),s=r("./validating"),l=r("./loading")(g),u=r("./unformatting"),f=r("./formatting")(g),c=r("./manipulating")(g),h=r("./parsing"),d=function(){function y(_){(function(x,T){if(!(x instanceof T))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=_}var b,w;return b=y,(w=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,_)}},{key:"formatCurrency",value:function(_){return typeof _=="string"&&(_=h.parseFormat(_)),(_=f.formatOrDefault(_,o.currentCurrencyDefaultFormat())).output="currency",f.format(this,_)}},{key:"formatTime",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return _.output="time",f.format(this,_)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(_){return c.difference(this,_)}},{key:"add",value:function(_){return c.add(this,_)}},{key:"subtract",value:function(_){return c.subtract(this,_)}},{key:"multiply",value:function(_){return c.multiply(this,_)}},{key:"divide",value:function(_){return c.divide(this,_)}},{key:"set",value:function(_){return c.set(this,v(_))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&a(b.prototype,w),y}();function v(y){var b=y;return g.isNumbro(y)?b=y._value:typeof y=="string"?b=g.unformat(y):isNaN(y)&&(b=NaN),b}function g(y){return new d(v(y))}g.version="2.1.2",g.isNumbro=function(y){return y instanceof d},g.language=o.currentLanguage,g.registerLanguage=o.registerLanguage,g.setLanguage=o.setLanguage,g.languages=o.languages,g.languageData=o.languageData,g.zeroFormat=o.setZeroFormat,g.defaultFormat=o.currentDefaults,g.setDefaults=o.setDefaults,g.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,g.validate=s.validate,g.loadLanguagesInNode=l.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(a){var o,s,l,u,f,c,h,d,v,g,y,b,w,_,x,T,O,E,M,P,N=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof a!="string"?a:(s=N,a=(l=(o=a).match(/^{([^}]*)}/))?(s.prefix=l[1],o.slice(l[0].length)):o,f=N,function(D,L){if(D.indexOf("$")===-1){if(D.indexOf("%")===-1)return D.indexOf("bd")!==-1?(L.output="byte",L.base="general"):D.indexOf("b")!==-1?(L.output="byte",L.base="binary"):D.indexOf("d")!==-1?(L.output="byte",L.base="decimal"):D.indexOf(":")===-1?D.indexOf("o")!==-1&&(L.output="ordinal"):L.output="time";L.output="percent"}else L.output="currency"}(a=(c=(u=a).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,N),h=N,(d=a.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=N,(g=a.split(".")[0].match(/0+/))&&(v.characteristic=g[0].length),function(D,L){if(D.indexOf(".")!==-1){var V=D.split(".")[0];L.optionalCharacteristic=V.indexOf("0")===-1}}(a,N),y=N,a.indexOf("a")!==-1&&(y.average=!0),w=N,(b=a).indexOf("K")!==-1?w.forceAverage="thousand":b.indexOf("M")!==-1?w.forceAverage="million":b.indexOf("B")!==-1?w.forceAverage="billion":b.indexOf("T")!==-1&&(w.forceAverage="trillion"),function(D,L){var V=D.split(".")[1];if(V){var ee=V.match(/0+/);ee&&(L.mantissa=ee[0].length)}}(a,N),x=N,(_=a).match(/\[\.]/)?x.optionalMantissa=!0:_.match(/\./)&&(x.optionalMantissa=!1),T=N,a.indexOf(",")!==-1&&(T.thousandSeparated=!0),O=N,a.indexOf(" ")!==-1&&(O.spaceSeparated=!0),M=N,(E=a).match(/^\+?\([^)]*\)$/)&&(M.negative="parenthesis"),E.match(/^\+?-/)&&(M.negative="sign"),P=N,a.match(/^\+/)&&(P.forceSign=!0),N)}}},{}],9:[function(r,n,i){var a=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function g(y,b){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=3<arguments.length?arguments[3]:void 0,x=4<arguments.length?arguments[4]:void 0,T=5<arguments.length?arguments[5]:void 0,O=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var E="",M=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(M!==y)return-1*g(M,b,w,_,x,T,O);for(var P=0;P<a.length;P++){var N=a[P];if((E=y.replace(N.key,""))!==y)return g(E,b,w,_,x,T,O)*N.factor}if((E=y.replace("%",""))!==y)return g(E,b,w,_,x,T,O)/100;var D=parseFloat(y);if(!isNaN(D)){var L=_(D);if(L&&L!=="."&&(E=y.replace(new RegExp("".concat(o(L),"$")),""))!==y)return g(E,b,w,_,x,T,O);var V={};Object.keys(T).forEach(function(R){V[T[R]]=R});for(var ee=Object.keys(V).sort().reverse(),ie=ee.length,le=0;le<ie;le++){var _e=ee[le],U=V[_e];if((E=y.replace(_e,""))!==y){var C=void 0;switch(U){case"thousand":C=Math.pow(10,3);break;case"million":C=Math.pow(10,6);break;case"billion":C=Math.pow(10,9);break;case"trillion":C=Math.pow(10,12)}return g(E,b,w,_,x,T,O)*C}}}}(function(g,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=g.replace(b,"");return w=(w=w.replace(new RegExp("([0-9])".concat(o(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,f),u,f,c,h,d,v)}n.exports={unformat:function(l,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),g=d.currentCurrency().symbol,y=d.currentOrdinal(),b=d.getZeroFormat(),w=d.currentAbbreviations(),_=void 0;if(typeof l=="string")_=function(x,T){if(!x.indexOf(":")||T.thousands===":")return!1;var O=x.split(":");if(O.length!==3)return!1;var E=+O[0],M=+O[1],P=+O[2];return!isNaN(E)&&!isNaN(M)&&!isNaN(P)}(l,v)?(f=l.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):s(l,v,g,y,b,w,u);else{if(typeof l!="number")return;_=l}if(_!==void 0)return _}}},{"./globalState":4}],10:[function(r,n,i){function a(v){return function(g){if(Array.isArray(g)){for(var y=0,b=new Array(g.length);y<g.length;y++)b[y]=g[y];return b}}(v)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(v)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!s.unformat(v)}function h(v,g,y){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],w=Object.keys(v).map(function(_){if(!g[_])return console.error("".concat(y," Invalid key: ").concat(_)),!1;var x=v[_],T=g[_];if(typeof T=="string"&&(T={type:T}),T.type==="format"){if(!h(x,u,"[Validate ".concat(_,"]"),!0))return!1}else if(o(x)!==T.type)return console.error("".concat(y," ").concat(_,' type mismatched: "').concat(T.type,'" expected, "').concat(o(x),'" provided')),!1;if(T.restrictions&&T.restrictions.length)for(var O=T.restrictions.length,E=0;E<O;E++){var M=T.restrictions[E],P=M.restriction,N=M.message;if(!P(x,v))return console.error("".concat(y," ").concat(_," invalid value: ").concat(N)),!1}return T.restriction&&!T.restriction(x,v)?(console.error("".concat(y," ").concat(_," invalid value: ").concat(T.message)),!1):T.validValues&&T.validValues.indexOf(x)===-1?(console.error("".concat(y," ").concat(_," invalid value: must be among ").concat(JSON.stringify(T.validValues),', "').concat(x,'" provided')),!1):!(T.children&&!h(x,T.children,"[Validate ".concat(_,"]")))});return b||w.push.apply(w,a(Object.keys(g).map(function(_){var x=g[_];if(typeof x=="string"&&(x={type:x}),x.mandatory){var T=x.mandatory;if(typeof T=="function"&&(T=T(v)),T&&v[_]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(_,'"')),!1}return!0}))),w.reduce(function(_,x){return _&&x},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,g){var y=c(v),b=d(g);return y&&b},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(spt);const dh=LF;var lpt="numeric";function Tj(e,t,r,n,i,a,o){var s=a;if(ja(s)){var l=o.numericFormat,u=l&&l.culture||"-",f=l&&l.pattern,c=o.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!dh.languages()[u]){var d=u.replace("-",""),v=dh.allLanguages?dh.allLanguages[u]:dh[d];v&&dh.registerLanguage(v)}dh.setLanguage(u),s=dh(s).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),o.className=h.join(" "),t.dir="ltr"}xc(e,t,r,n,i,s,o)}Tj.RENDERER_TYPE=lpt;var upt="password";function Oj(e,t,r,n,i,a,o){xc.apply(this,[e,t,r,n,i,a,o]);var s=o.hashLength||t.innerHTML.length,l=o.hashSymbol||"*",u="";yt(s-1,function(){u+=l}),Xd(t,u)}Oj.RENDERER_TYPE=upt;var fpt="time";function Ej(e,t,r,n,i,a,o){xc.apply(this,[e,t,r,n,i,a,o]),t.dir="ltr"}Ej.RENDERER_TYPE=fpt;function cpt(){Zs($m),Zs(I1),Zs(Cj),Zs(Sj),Zs(Tj),Zs(Oj),Zs(xc),Zs(Ej)}var hpt="autocomplete";function RA(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,qZ(r,t)):qZ(r,t)(this.source):t(!0)}RA.VALIDATOR_TYPE=hpt;function qZ(e,t){var r=e;return function(n){for(var i=!1,a=0,o=n.length;a<o;a++)if(r===n[a]){i=!0;break}t(i)}}var dpt=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},vpt=Gn,ppt=Kk,gpt=Tn,ypt=As,mpt=ka,ZZ=dpt,JZ=Fn,bpt=Wd,wpt=Xk;ppt("search",function(e,t,r){return[function(i){var a=mpt(this),o=ypt(i)?void 0:bpt(i,e);return o?vpt(o,i,a):new RegExp(i)[e](JZ(a))},function(n){var i=gpt(this),a=JZ(n),o=r(t,i,a);if(o.done)return o.value;var s=i.lastIndex;ZZ(s,0)||(i.lastIndex=0);var l=wpt(i,a);return ZZ(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function Pde(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const _pt=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:Pde},Symbol.toStringTag,{value:"Module"}));var Spt="date";function Rj(e,t){var r=Oce(Tde,this.instance),n=e,i=!0;n==null&&(n="");var a=ze(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=ze(new Date(n)).isValid()||a;if(this.allowEmpty&&n===""&&(o=!0,a=!0),o||(i=!1),!o&&a&&(i=!0),o&&!a)if(this.correctFormat===!0){var s=Cpt(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;t(i)}Rj.VALIDATOR_TYPE=Spt;function Cpt(e,t){var r=ze(Pde(e)),n=ze(e,t),i=e.search(/[A-z]/g)>-1,a;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?a=r:a=n,a.format(t)}var xpt="numeric";function kj(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:ja(e))}kj.VALIDATOR_TYPE=xpt;var Tpt=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Opt="time";function Aj(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,i=e;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var a=/^\d{1,2}$/.test(i);a&&(i+=":00");var o=ze(i,Tpt,!0).isValid()?ze(i):ze(i,r),s=o.isValid(),l=ze(i,r,!0).isValid()&&!a;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=o.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}Aj.VALIDATOR_TYPE=Opt;function Ept(){Op(RA),Op(Rj),Op(kj),Op(Aj)}var Rpt="autocomplete",kpt={CELL_TYPE:Rpt,editor:wj,renderer:$m,validator:RA},Apt="checkbox",Ppt={CELL_TYPE:Apt,editor:xde,renderer:Cj},Ipt="date",Mpt={CELL_TYPE:Ipt,editor:Ode,renderer:$m,validator:Rj},Dpt="dropdown",$pt={CELL_TYPE:Dpt,editor:_j,renderer:$m,validator:RA},Npt="handsontable",Lpt={CELL_TYPE:Npt,editor:bj,renderer:$m},Fpt="numeric",Hpt={CELL_TYPE:Fpt,editor:Ede,renderer:Tj,validator:kj,dataType:"number"},Bpt="password",Vpt={CELL_TYPE:Bpt,editor:Rde,renderer:Oj,copyable:!1},Wpt="time",jpt={CELL_TYPE:Wpt,editor:kde,renderer:Ej,validator:Aj};function Upt(){fs(kpt),fs(Ppt),fs(Mpt),fs($pt),fs(Lpt),fs(Hpt),fs(Vpt),fs(wde),fs(jpt)}var zpt=jk,Gpt=pce;zpt("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Gpt);function H_(e){return H_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H_(e)}function Ypt(e,t){return Zpt(e)||qpt(e,t)||Xpt(e,t)||Kpt()}function Kpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xpt(e,t){if(e){if(typeof e=="string")return QZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QZ(e,t)}}function QZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qpt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Zpt(e){if(Array.isArray(e))return e}function Jpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,egt(n.key),n)}}function Qpt(e,t,r){return t&&eJ(e.prototype,t),r&&eJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function egt(e){var t=tgt(e,"string");return H_(t)==="symbol"?t:String(t)}function tgt(e,t){if(H_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(H_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rgt(e,t){ngt(e,t),t.add(e)}function ngt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function igt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var tJ=new Map([["plugin",TJe],["cell-type",fde],["editor",Tce],["renderer",Hce],["validator",Bce]]),agt="base",vh=new WeakMap,Q2=[],js=null,rJ=new WeakSet,wr=function(){function e(t){var r=this;Jpt(this,e),rgt(this,rJ),yl(this,"hot",t,{writable:!1}),vh.set(this,{hooks:{}}),js=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Qpt(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var a=[];if(i.forEach(function(u){var f=u.split(":"),c=Ypt(f,2),h=c[0],d=c[1];if(!tJ.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));tJ.get(h)(d)||a.push(" - ".concat(d," (").concat(h,")"))}),a.length>0){var o=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(a.join(`
`),`
`)].join("");Q2.push(o)}}js||(js=TV()),js.indexOf("UndoRedo")>=0&&js.splice(js.indexOf("UndoRedo"),1),js.indexOf(this.pluginName)>=0&&js.splice(js.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=js.length===0;if(s){if(Q2.length>0){var l=["".concat(Q2.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){vh.get(this).hooks[r]=vh.get(this).hooks[r]||[];var i=vh.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),vh.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;ue(vh.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=vh.get(this).hooks;Gt(n,function(i,a){return r.removeHooks(a)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){ue(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=igt(this,rJ,ogt).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Gt(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return agt}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function ogt(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function B_(e){return B_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B_(e)}function sgt(e,t){return cgt(e)||fgt(e,t)||ugt(e,t)||lgt()}function lgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ugt(e,t){if(e){if(typeof e=="string")return nJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nJ(e,t)}}function nJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fgt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function cgt(e){if(Array.isArray(e))return e}function hgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vgt(n.key),n)}}function dgt(e,t,r){return t&&iJ(e.prototype,t),r&&iJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vgt(e){var t=pgt(e,"string");return B_(t)==="symbol"?t:String(t)}function pgt(e,t){if(B_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(B_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ggt=function(){function e(t){hgt(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return dgt(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),ue(this.rows,function(n){r(n.row,ln(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),ue(this.columns,function(n){var i=n.table.getBoundingClientRect(),a=i.width;r(n.col,Math.ceil(a))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){ue(i.strings,function(a){n.appendChild(r.createColElement(a.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment(),o=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,o),a.appendChild(o)),this.samples.forEach(function(s){ue(s.strings,function(l){var u=l.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=i.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),l.value,f),a.appendChild(h)})}),a}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),a=[];if(this.hot.hasRowHeaders()){var o=n.createElement("th");a.push([-1,o]),i.appendChild(o)}this.samples.forEach(function(s){ue(s.strings,function(l){var u=l.col,f=n.createElement("th");a.push([u,f]),i.appendChild(f)})}),this.table.tHead.appendChild(i),ue(a,function(s){var l=sgt(s,2),u=l[0],f=l[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment();return this.samples.forEach(function(o){ue(o.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var f=n.hot.getCellRenderer(u),c=i.createElement("td"),h=i.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(c),a.appendChild(h)})}),a}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&a.appendChild(l),this.isHorizontal()&&(u.appendChild(f),o.appendChild(u),a.style.tableLayout="auto",a.style.width="auto"),a.appendChild(o),this.isVertical()&&s.appendChild(u),a.appendChild(s),Ue(a,r),i.appendChild(a),{fragment:i,table:a,tHead:o,tBody:s,colGroup:l,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("div"),o="htGhostTable htAutoSize ".concat(r.trim());return Ue(a,o),i.appendChild(a),{fragment:i,container:a}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const Pj=ggt;function V_(e){return V_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V_(e)}function ygt(e,t,r){return t=Ide(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ide(n.key),n)}}function bgt(e,t,r){return t&&aJ(e.prototype,t),r&&aJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ide(e){var t=wgt(e,"string");return V_(t)==="symbol"?t:String(t)}function wgt(e,t){if(V_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(V_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _gt=function(){function e(t){mgt(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return bgt(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var a=this,o=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return yt(l,u,function(f){var c=a.generateSample(r,n,f);o.set(f,c)}),o}},{key:"generateSample",value:function(r,n,i){var a=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var o=new Map,s=r==="row"?"col":"row",l=[];return yt(n.from,n.to,function(u){var f=r==="row"?a.dataFactory(i,u):a.dataFactory(u,i),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:zt(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(yn(c).length),o.has(v)||o.set(v,{needed:a.getSampleCount(),strings:[]});var g=o.get(v);if(g.needed){var y=l.indexOf(c)>-1;(!y||a.allowDuplicates||d)&&(g.strings.push(ygt({value:c},s,u)),l.push(c),g.needed-=1)}}),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const Mde=_gt;function ay(e){return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ay(e)}function oJ(e,t){return Tgt(e)||xgt(e,t)||Cgt(e,t)||Sgt()}function Sgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cgt(e,t){if(e){if(typeof e=="string")return sJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sJ(e,t)}}function sJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xgt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Tgt(e){if(Array.isArray(e))return e}function Ogt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rgt(n.key),n)}}function Egt(e,t,r){return t&&lJ(e.prototype,t),r&&lJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rgt(e){var t=kgt(e,"string");return ay(t)==="symbol"?t:String(t)}function kgt(e,t){if(ay(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dh(){return typeof Reflect<"u"&&Reflect.get?Dh=Reflect.get.bind():Dh=function(t,r,n){var i=Agt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Dh.apply(this,arguments)}function Agt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=eu(e),e!==null););return e}function Pgt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FF(e,t)}function FF(e,t){return FF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FF(e,t)}function Igt(e){var t=Dgt();return function(){var n=eu(e),i;if(t){var a=eu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Mgt(this,i)}}function Mgt(e,t){if(t&&(ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dde(e)}function Dde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eu(e){return eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eu(e)}ft.getSingleton().register("modifyAutoColumnSizeSeed");var V0="autoColumnSize",$gt=10,eD=new WeakMap,Ngt="autoColumnSize",Lgt=function(e){Pgt(r,e);var t=Igt(r);function r(n){var i;return Ogt(this,r),i=t.call(this,n),eD.set(Dde(i),{cachedColumnHeaders:[]}),i.ghostTable=new Pj(i.hot),i.samplesGenerator=new Mde(function(a,o){var s=i.hot.getCellMeta(a,o),l="";s.spanned||(l=i.hot.getDataAtCell(a,o));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new Cc,i.hot.columnIndexMapper.registerMap(Ngt,i.columnWidthsMap),i.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),i}return Egt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[V0]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[V0];a&&a.useHeaders!==null&&a.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",a.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("afterFormulasValuesUpdate",function(o){return i.onAfterFormulasValuesUpdate(o)}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyColWidth",function(o,s){return i.getColumnWidth(s,o)}),this.addHook("afterInit",function(){return i.onAfterInit()}),Dh(eu(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),Dh(eu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;Dh(eu(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var a=this.hot.renderCall,o=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();o===-1||s===-1||this.calculateColumnsWidth({from:o,to:s},void 0,a)}}},{key:"calculateColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;yt(l.from,l.to,function(f){var c=i.hot.toPhysicalColumn(f);if(c===null&&(c=f),s||i.columnWidthsMap.getValueAtIndex(c)===null&&!i.hot._getColWidthFromSettings(c)){var h=i.samplesGenerator.generateColumnSamples(f,u);ue(h,function(d){var v=oJ(d,2),g=v[0],y=v[1];return i.ghostTable.addColumn(g,y)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(f,c){var h=i.hot.toPhysicalColumn(f);i.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){Ew(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=Zk(c):(Ew(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[V0],a=i&&gn(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&gn(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[V0],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countCols()-1;return zt(i)&&(a=i.syncLimit,vV(a)?a=CV(o,a):a>>=0),Math.min(a,o)}},{key:"getColumnWidth",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=a;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),o&&typeof s=="number"&&(s=Math.max(s,EV.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getFirstVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getFirstRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getLastVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getLastRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),a=eD.get(this),o=a.cachedColumnHeaders,s=On(i,function(l,u,f){var c=o.length;return(c-1<f||o[f]!==u)&&l.push(f),c-1<f?o.push(u):o[f]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];a.length?this.hot.batchExecution(function(){ue(a,function(o){i.columnWidthsMap.setValueAtIndex(o,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!qa(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var a=this,o=Ut(i,function(s){var l=oJ(s,2),u=l[1];return a.hot.toPhysicalColumn(a.hot.propToCol(u))});this.clearCache(Array.from(new Set(o)))}},{key:"onBeforeColumnResize",value:function(i,a,o){var s=i;return o&&(this.calculateColumnsWidth(a,void 0,!0),s=this.getColumnWidth(a,void 0,!1)),s}},{key:"onAfterInit",value:function(){eD.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var a=qa(i,function(s){var l;return lt((l=s.address)===null||l===void 0?void 0:l.col)}),o=Ut(a,function(s){return s.address.col});this.clearCache(Array.from(new Set(o)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Dh(eu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return V0}},{key:"PLUGIN_PRIORITY",get:function(){return $gt}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(wr),$h={horizontal:"horizontal",vertical:"vertical"};function Fgt(e,t,r,n){var i=r.length,a=r?r[0].length:0,o=[],s=t.row-e.row,l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<l;f++){var c=parseInt(r[0][f],10),h=parseInt(r[i-1][f],10),d=(n==="down"?h-c:c-h)/(i-1)||0;u.push(d)}o.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<s;v++){var g=parseInt(r[v][0],10),y=parseInt(r[v][a-1],10),b=(n==="right"?y-g:g-y)/(a-1)||0;o.push([b])}return o}function Hgt(e,t,r){var n,i,a;return t[0]===e[0]&&t[1]<e[1]?(a="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(a="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(a="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(a="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:a,startOfDragCoords:n,endOfDragCoords:i}}function Bgt(e){var t={};return e===!0?(t.directions=Object.keys($h),t.autoInsertRow=!0):zt(e)?(lt(e.autoInsertRow)?e.direction===$h.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,lt(e.direction)?t.directions=[e.direction]:t.directions=Object.keys($h)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function oy(e){return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oy(e)}function Vgt(e){return Ugt(e)||jgt(e)||$de(e)||Wgt()}function Wgt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ugt(e){if(Array.isArray(e))return HF(e)}function zgt(e,t){return Kgt(e)||Ygt(e,t)||$de(e,t)||Ggt()}function Ggt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $de(e,t){if(e){if(typeof e=="string")return HF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HF(e,t)}}function HF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ygt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Kgt(e){if(Array.isArray(e))return e}function Xgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zgt(n.key),n)}}function qgt(e,t,r){return t&&uJ(e.prototype,t),r&&uJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zgt(e){var t=Jgt(e,"string");return oy(t)==="symbol"?t:String(t)}function Jgt(e,t){if(oy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nh(){return typeof Reflect<"u"&&Reflect.get?Nh=Reflect.get.bind():Nh=function(t,r,n){var i=Qgt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Nh.apply(this,arguments)}function Qgt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tu(e),e!==null););return e}function eyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BF(e,t)}function BF(e,t){return BF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BF(e,t)}function tyt(e){var t=nyt();return function(){var n=tu(e),i;if(t){var a=tu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ryt(this,i)}}function ryt(e,t){if(t&&(oy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nde(e)}function Nde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tu(e){return tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tu(e)}ft.getSingleton().register("modifyAutofillRange");ft.getSingleton().register("beforeAutofill");ft.getSingleton().register("afterAutofill");var fJ="autofill",iyt=20,ayt=["fillHandle"],oyt="insert_row_below",syt=200,lyt=function(e){eyt(r,e);var t=tyt(r);function r(n){var i;return Xgt(this,r),i=t.call(this,n),i.eventManager=new un(Nde(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return qgt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(a){return i.onAfterCellCornerMouseDown(a)}),this.addHook("afterOnCellCornerDblClick",function(a){return i.onCellCornerDblClick(a)}),this.addHook("beforeOnCellMouseOver",function(a,o){return i.onBeforeCellMouseOver(o)}),Nh(tu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Nh(tu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Nh(tu(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,a=this.hot.getSelectedRangeLast(),o=a.getTopStartCorner(),s=o.row,l=o.col,u=a.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:f,endCol:c}]),d=[],v=[],g=[];return ue(h,function(y){for(var b=y.startRow;b<=y.endRow;b+=1)d.indexOf(b)===-1&&d.push(b);for(var w=y.startCol;w<=y.endCol;w+=1)v.indexOf(w)===-1&&v.push(w)}),ue(d,function(y){var b=[];ue(v,function(w){b.push(i.hot.getCopyableData(y,w))}),g.push(b)}),g}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var a=this.hot.selection.highlight.getFill().getVisualCorners(),o=zgt(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],g=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,s),Math.min(h.col,l),Math.max(d.row,u),Math.max(d.col,f)],v),y=Hgt(v,g,function(U,C){return i.hot._createCellCoords(U,C)}),b=y.directionOfDrag,w=y.startOfDragCoords,_=y.endOfDragCoords;if(w&&w.row>-1&&w.col>-1){var x=this.getSelectionData(),T=c.clone(),O=this.hot._createCellRange(w,w,_),E=this.hot.runHooks("beforeAutofill",x,T,O,b);if(E===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var M=Fgt(w,_,x,b),P=E,N=E;if(["up","left"].indexOf(b)>-1&&!(N.length===1&&N[0].length===0))if(P=[],b==="up")for(var D=_.row-w.row+1,L=D%N.length,V=0;V<D;V++)P.push(N[(V+(N.length-L))%N.length]);else for(var ee=_.col-w.col+1,ie=ee%N[0].length,le=0;le<N.length;le++){P.push([]);for(var _e=0;_e<ee;_e++)P[le].push(N[le][(_e+(N[le].length-ie))%N[le].length])}this.hot.populateFromArray(w.row,w.col,P,_.row,_.col,"".concat(this.pluginName,".fill"),null,b,M),this.setSelection(g),this.hot.runHooks("afterAutofill",P,T,O,b),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var a=this.hot.getSelectedRangeLast(),o=a.getBottomEndCorner(),s=i;if(this.directions.includes($h.vertical)&&this.directions.includes($h.horizontal)){var l=a.getTopStartCorner();(o.col<=i.col||l.col>=i.col)&&(s=this.hot._createCellCoords(o.row,i.col)),(o.row<i.row||l.row>i.row)&&(s=this.hot._createCellCoords(i.row,o.col))}else if(this.directions.includes($h.vertical))s=this.hot._createCellCoords(i.row,o.col);else if(this.directions.includes($h.horizontal))s=this.hot._createCellCoords(o.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var a=this.getCoordsOfDragAndDropBorders(i);a&&this.redrawBorders(a)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(oyt,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},syt)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),a=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();i[2]<o-1&&a[2]===o-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var a=this.hot.getData(),o=this.hot.countRows(),s,l=i[2]+1;l<o;l++){for(var u=i[1];u<=i[3];u++){var f=a[l][u];if(f)return-1}var c=a[l][i[1]-1],h=a[l][i[3]+1];(c||h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,a){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(a,i[3])).commit()}},{key:"setSelection",value:function(i){var a;(a=this.hot).selectCell.apply(a,Vgt(Ut(i,function(o){return Math.max(o,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),a=this.getIndexOfLastAdjacentFilledInRow(i);return a===-1||a===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,a),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var a=this.hot.rootDocument.documentElement,o=Dn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||a.scrollTop)+ln(this.hot.table),s=Dn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||a.scrollLeft)+$r(this.hot.table);return i.clientY>o&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var a=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&a?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=Bgt(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){Nh(tu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fJ}},{key:"PLUGIN_PRIORITY",get:function(){return iyt}},{key:"SETTING_KEYS",get:function(){return[fJ].concat(ayt)}}]),r}(wr);function sy(e){return sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sy(e)}function uyt(e,t){return dyt(e)||hyt(e,t)||cyt(e,t)||fyt()}function fyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cyt(e,t){if(e){if(typeof e=="string")return cJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cJ(e,t)}}function cJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function dyt(e){if(Array.isArray(e))return e}function vyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gyt(n.key),n)}}function pyt(e,t,r){return t&&hJ(e.prototype,t),r&&hJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gyt(e){var t=yyt(e,"string");return sy(t)==="symbol"?t:String(t)}function yyt(e,t){if(sy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bp(){return typeof Reflect<"u"&&Reflect.get?Bp=Reflect.get.bind():Bp=function(t,r,n){var i=myt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Bp.apply(this,arguments)}function myt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qf(e),e!==null););return e}function byt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VF(e,t)}function VF(e,t){return VF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},VF(e,t)}function wyt(e){var t=Cyt();return function(){var n=qf(e),i;if(t){var a=qf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _yt(this,i)}}function _yt(e,t){if(t&&(sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Syt(e)}function Syt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qf(e){return qf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qf(e)}var nT="autoRowSize",xyt=40,Tyt="autoRowSize",Oyt=function(e){byt(r,e);var t=wyt(r);function r(n){var i;return vyt(this,r),i=t.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new Pj(i.hot),i.samplesGenerator=new Mde(function(a,o){var s;return a>=0?s=i.hot.getDataAtCell(a,o):a===-1&&(s=i.hot.getColHeader(o)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new Cc,i.hot.rowIndexMapper.registerMap(Tyt,i.rowHeightsMap),i.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)}),i}return pyt(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[nT];return i===!0||zt(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyRowHeight",function(a,o){return i.getRowHeight(o,a)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),Bp(qf(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,Bp(qf(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}yt(l.from,l.to,function(c){if(s||i.rowHeightsMap.getValueAtIndex(c)===null){var h=i.samplesGenerator.generateRowSamples(c,u);ue(h,function(d){var v=uyt(d,2),g=v[0],y=v[1];return i.ghostTable.addRow(g,y)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(c,h){c<0?i.headerHeight=h:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){Ew(l),i.inProgress=!1;return}i.calculateRowsHeight({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=Zk(c):(Ew(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[nT],a=i&&gn(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&gn(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllRowsHeight",value:function(){lg(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[nT],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countRows()-1;return zt(i)&&(a=i.syncLimit,vV(a)?a=CV(o,a):a>>=0),Math.min(a,o)}},{key:"getRowHeight",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=a;return o!==null&&o>(a||0)&&(s=o),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var a=this,o=typeof i=="number"?{from:i,to:i}:i,s=o.from,l=o.to;this.hot.batchExecution(function(){yt(Math.min(s,l),Math.max(s,l),function(u){a.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!qa(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,a=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(o===-1||s===-1)){if(this.calculateRowsHeight({from:o,to:s},void 0,i),a){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-a,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,a){this.clearCacheByRange({from:i,to:a}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,a,o){var s=i;return o&&(this.calculateRowsHeight(a,void 0,!0),s=this.getRowHeight(a)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var a=null;i.length===1?a=i[0][0]:i.length>1&&(a={from:i[0][0],to:i[i.length-1][0]}),a!==null&&this.clearCacheByRange(a)}},{key:"destroy",value:function(){this.ghostTable.clean(),Bp(qf(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nT}},{key:"PLUGIN_PRIORITY",get:function(){return xyt}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(wr);function ly(e){return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ly(e)}function Eyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kyt(n.key),n)}}function Ryt(e,t,r){return t&&dJ(e.prototype,t),r&&dJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kyt(e){var t=Ayt(e,"string");return ly(t)==="symbol"?t:String(t)}function Ayt(e,t){if(ly(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gb(){return typeof Reflect<"u"&&Reflect.get?Gb=Reflect.get.bind():Gb=function(t,r,n){var i=Pyt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Gb.apply(this,arguments)}function Pyt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ad(e),e!==null););return e}function Iyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WF(e,t)}function WF(e,t){return WF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WF(e,t)}function Myt(e){var t=Nyt();return function(){var n=Ad(e),i;if(t){var a=Ad(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Dyt(this,i)}}function Dyt(e,t){if(t&&(ly(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $yt(e)}function $yt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ad(e){return Ad=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ad(e)}var Lde=Bhe("physicallyIndexed"),Lyt=Lde.getListWithInsertedItems,Fyt=Lde.getListWithRemovedItems,Hyt=function(e){Iyt(r,e);var t=Myt(r);function r(){return Eyt(this,r),t.call(this,function(n){return n})}return Ryt(r,[{key:"insert",value:function(i,a){var o=zV(this.indexedValues,a);this.indexedValues=Lyt(o,i,a,this.initValueOrFn),Gb(Ad(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=Fyt(this.indexedValues,i);this.indexedValues=UV(a,i),Gb(Ad(r.prototype),"remove",this).call(this,i)}}]),r}(qd);const Byt=Hyt;function uy(e){return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(e)}function Vyt(e){return zyt(e)||Uyt(e)||jyt(e)||Wyt()}function Wyt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jyt(e,t){if(e){if(typeof e=="string")return jF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jF(e,t)}}function Uyt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zyt(e){if(Array.isArray(e))return jF(e)}function jF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kyt(n.key),n)}}function Yyt(e,t,r){return t&&vJ(e.prototype,t),r&&vJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kyt(e){var t=Xyt(e,"string");return uy(t)==="symbol"?t:String(t)}function Xyt(e,t){if(uy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yb(){return typeof Reflect<"u"&&Reflect.get?Yb=Reflect.get.bind():Yb=function(t,r,n){var i=qyt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Yb.apply(this,arguments)}function qyt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pd(e),e!==null););return e}function Zyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UF(e,t)}function UF(e,t){return UF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UF(e,t)}function Jyt(e){var t=tmt();return function(){var n=Pd(e),i;if(t){var a=Pd(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Qyt(this,i)}}function Qyt(e,t){if(t&&(uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return emt(e)}function emt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pd(e){return Pd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pd(e)}var Fde=Bhe("physicallyIndexed"),rmt=Fde.getListWithInsertedItems,nmt=Fde.getListWithRemovedItems,imt=function(e){Zyt(r,e);var t=Jyt(r);function r(){return Gyt(this,r),t.call(this,function(n){return n})}return Yyt(r,[{key:"insert",value:function(i,a){var o=this;this.indexedValues=rmt(this.indexedValues,i,a,function(s,l){return o.getNextValue(l)}),Yb(Pd(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=nmt(this.indexedValues,i),Yb(Pd(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,Vyt(this.getValues()))+1+i}}]),r}(qd);const amt=imt;function fy(e){return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fy(e)}function omt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lmt(n.key),n)}}function smt(e,t,r){return t&&pJ(e.prototype,t),r&&pJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lmt(e){var t=umt(e,"string");return fy(t)==="symbol"?t:String(t)}function umt(e,t){if(fy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vp(){return typeof Reflect<"u"&&Reflect.get?Vp=Reflect.get.bind():Vp=function(t,r,n){var i=fmt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Vp.apply(this,arguments)}function fmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zf(e),e!==null););return e}function cmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zF(e,t)}function zF(e,t){return zF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zF(e,t)}function hmt(e){var t=pmt();return function(){var n=Zf(e),i;if(t){var a=Zf(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dmt(this,i)}}function dmt(e,t){if(t&&(fy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vmt(e)}function vmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zf(e){return Zf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zf(e)}var tD="bindRowsWithHeaders",gmt=210,ymt="loose",mmt=new Map([["loose",Byt],["strict",amt]]),bmt=function(e){cmt(r,e);var t=hmt(r);function r(n){var i;return omt(this,r),i=t.call(this,n),i.headerIndexes=null,i}return smt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[tD];typeof a!="string"&&(a=ymt);var o=mmt.get(a);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new o),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),Vp(Zf(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Vp(Zf(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){Vp(Zf(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tD}},{key:"PLUGIN_PRIORITY",get:function(){return gmt}}]),r}(wr);function cy(e){return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cy(e)}function gJ(e){return Cmt(e)||Smt(e)||_mt(e)||wmt()}function wmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _mt(e,t){if(e){if(typeof e=="string")return GF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GF(e,t)}}function Smt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cmt(e){if(Array.isArray(e))return GF(e)}function GF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hde(n.key),n)}}function Tmt(e,t,r){return t&&yJ(e.prototype,t),r&&yJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lh(){return typeof Reflect<"u"&&Reflect.get?Lh=Reflect.get.bind():Lh=function(t,r,n){var i=Omt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Lh.apply(this,arguments)}function Omt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ru(e),e!==null););return e}function Emt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YF(e,t)}function YF(e,t){return YF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YF(e,t)}function Rmt(e){var t=Amt();return function(){var n=ru(e),i;if(t){var a=ru(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return kmt(this,i)}}function kmt(e,t){if(t&&(cy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yp(e)}function yp(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Amt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ru(e){return ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ru(e)}function Pmt(e,t,r){Imt(e,t),t.set(e,r)}function Imt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rD(e,t,r){return t=Hde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hde(e){var t=Mmt(e,"string");return cy(t)==="symbol"?t:String(t)}function Mmt(e,t){if(cy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mJ(e,t){var r=Bde(e,t,"get");return Dmt(e,r)}function Dmt(e,t){return t.get?t.get.call(e):t.value}function nD(e,t,r){var n=Bde(e,t,"set");return $mt(e,n,r),r}function Bde(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $mt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var iD="collapsibleColumns",Nmt=290,Lmt=["nestedHeaders"],Gv="collapsibleIndicator",bJ=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Yv=new WeakMap,Fmt=function(e){Emt(r,e);var t=Rmt(r);function r(){var n;xmt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),rD(yp(n),"nestedHeadersPlugin",null),rD(yp(n),"eventManager",new un(yp(n))),rD(yp(n),"headerStateManager",null),Pmt(yp(n),Yv,{writable:!0,value:null}),n}return Tmt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[iD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;o||Fr("You need to configure the Nested Headers plugin in order to use collapsible headers."),nD(this,Yv,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return i.onBeforeOnCellMouseDown(s,l,u)}),Lh(ru(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),a=i.collapsibleColumns;typeof a=="boolean"?this.headerStateManager.mapState(function(o){return{collapsible:o.origColspan>1}}):Array.isArray(a)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(a))}Lh(ru(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),nD(this,Yv,null),this.nestedHeadersPlugin=null,this.clearButtons(),Lh(ru(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,a=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(f){f&&f.parentNode.removeChild(f)};yt(0,i-1,function(u){var f=a.childNodes[u],c=o.childNodes[u],h=s?s.childNodes[u]:null;yt(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(Gv));l(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(Gv)),l(v)),s&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(Gv)),l(v))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var a=this,o=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,f=s.headerLevel,c=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&i==="expand"||!h&&i==="collapse"))return{row:a.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(o,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,a){var o=this;if(!bJ.has(a))throw new Error("Unsupported action is passed (".concat(a,")."));if(Array.isArray(i)){var s=qa(i,function(y){var b=y.row;return b<0}),l=s.length>0;ue(s,function(y){var b,w=y.row,_=y.col,x=(b=o.headerStateManager.getHeaderSettings(w,_))!==null&&b!==void 0?b:{},T=x.collapsible,O=x.isCollapsed;if(!T||O&&a==="collapse"||!O&&a==="expand")return l=!1,!1});var u=[],f=[];l&&ue(s,function(y){var b=y.row,w=y.col,_=o.headerStateManager.triggerNodeModification(a,b,w),x=_.colspanCompensation,T=_.affectedColumns,O=_.rollbackModification;x>0&&(f.push.apply(f,gJ(T)),u.push(O))});var c=this.getCollapsedColumns(),h=[];a==="collapse"?h=W4([].concat(gJ(c),f)):a==="expand"&&(h=qa(c,function(y){return!f.includes(y)}));var d=bJ.get(a),v=this.hot.runHooks(d.beforeHook,c,h,l);if(v===!1){ue(u,function(y){y()});return}this.hot.batchExecution(function(){ue(f,function(y){mJ(o,Yv).setValueAtIndex(o.hot.toPhysicalColumn(y),d.hideColumn)})},!0);var g=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,l,g),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return mJ(this,Yv).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,a,o){var s,l=(s=this.headerStateManager.getHeaderSettings(o,i))!==null&&s!==void 0?s:{},u=l.collapsible,f=l.origColspan,c=l.isCollapsed,h=u&&f>1&&i>=this.hot.getSettings().fixedColumnsStart,d=a.querySelector(".".concat(Gv));if(h)d||(d=this.hot.rootDocument.createElement("div"),Ue(d,Gv),a.querySelector("div:first-child").appendChild(d)),Mt(d,["collapsed","expanded"]),c?(Ue(d,"collapsed"),vc(d,"+")):(Ue(d,"expanded"),vc(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,a){Pt(i.target,Gv)&&(Pt(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"collapse")):Pt(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"expand")),Es(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){nD(this,Yv,null),Lh(ru(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return iD}},{key:"PLUGIN_PRIORITY",get:function(){return Nmt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[iD].concat(Lmt)}}]),r}(wr);function W_(e){return W_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W_(e)}function wJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hmt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wJ(Object(r),!0).forEach(function(n){Bmt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bmt(e,t,r){return t=Vde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _J(e,t){return Umt(e)||jmt(e,t)||Wmt(e,t)||Vmt()}function Vmt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wmt(e,t){if(e){if(typeof e=="string")return SJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SJ(e,t)}}function SJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jmt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Umt(e){if(Array.isArray(e))return e}function zmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vde(n.key),n)}}function Gmt(e,t,r){return t&&CJ(e.prototype,t),r&&CJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vde(e){var t=Ymt(e,"string");return W_(t)==="symbol"?t:String(t)}function Ymt(e,t){if(W_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(W_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kmt=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Xmt=!1,qmt=!0,Zmt=!0,Jmt=function(){function e(t,r){zmt(this,e),this.hot=t,this.sortingStates=new bA,this.sortEmptyCells=Xmt,this.indicator=qmt,this.headerAction=Zmt,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return Gmt(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;zt(r)&&Gt(r,function(i,a){Kmt.includes(a)&&(n[a]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=_J(n,1),a=i[0];return a===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return zt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var a=_J(i,2),o=a[0],s=a[1];return Hmt({column:r.hot.toVisualColumn(o)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(lt(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),TR="asc",OR="desc",Qmt="colHeader";function e0t(e){if(zt(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[TR,OR].includes(r)}function t0t(e){if(e.some(function(r){return e0t(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function xJ(e){if(e!==OR)return e===TR?OR:TR}function TJ(e){var t=e.querySelector(".".concat(Qmt));return t}function OJ(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function KF(e,t,r){return e===-1&&t>=0&&gc(r)===!1}var r0t="ascending",n0t="descending",Wde="indicatorDisabled",jde="columnSorting",Ude="sortAction",zde=new Map([[TR,r0t],[OR,n0t]]);function i0t(e,t,r,n){var i=[jde];if(n&&i.push(Ude),r===!1)return i.push(Wde),i;var a=e.getSortOrderOfColumn(t);return lt(a)&&i.push(zde.get(a)),i}function a0t(){return Array.from(zde.values()).concat(Ude,Wde,jde)}function Gde(e,t,r){var n=t.locale;return function(i,a){var o=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof a=="string"&&(a=a.toLocaleLowerCase(n)),i===a?ul:Un(i)?Un(a)?ul:o&&e==="asc"?vn:pn:Un(a)?o&&e==="asc"?pn:vn:isNaN(i)&&!isNaN(a)?e==="asc"?pn:vn:!isNaN(i)&&isNaN(a)||(isNaN(i)||isNaN(a)||(i=parseFloat(i),a=parseFloat(a)),i<a)?e==="asc"?vn:pn:i>a?e==="asc"?pn:vn:ul}}var Yde="default";function o0t(e,t,r){return function(n,i){var a=parseFloat(n),o=parseFloat(i),s=r.sortEmptyCells;if(a===o||isNaN(a)&&isNaN(o))return ul;if(s){if(Un(n))return e==="asc"?vn:pn;if(Un(i))return e==="asc"?pn:vn}return isNaN(a)?pn:isNaN(o)?vn:a<o?e==="asc"?vn:pn:a>o?e==="asc"?pn:vn:ul}}var s0t="numeric";function l0t(e,t,r){var n=t.checkedTemplate,i=t.uncheckedTemplate,a=r.sortEmptyCells;return function(o,s){var l=Un(o),u=Un(s),f=l?i:o,c=u?i:s,h=f===i||f===n,d=c===i||c===n;if(a===!1){if(l&&u===!1)return pn;if(l===!1&&u)return vn}return h===!1&&d?e==="asc"?vn:pn:h&&d===!1?e==="asc"?pn:vn:h===!1&&d===!1?Gde(e,t,r)(o,s):f===i&&c===n?e==="asc"?vn:pn:f===n&&c===i?e==="asc"?pn:vn:ul}}var u0t="checkbox";function f0t(e,t,r){return function(n,i){var a=r.sortEmptyCells;if(n===i)return ul;if(Un(n))return Un(i)?ul:a&&e==="asc"?vn:pn;if(Un(i))return a&&e==="asc"?pn:vn;var o=t.dateFormat,s=ze(n,o),l=ze(i,o);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?vn:pn:l.isBefore(s)?e==="asc"?pn:vn:ul:vn:pn}}var c0t="date",Ij=zo("sorting.compareFunctionFactory"),kA=Ij.register,EJ=Ij.getItem,h0t=Ij.hasItem,Kde=zo("sorting.mainSortComparator"),Xde=Kde.register,d0t=Kde.getItem;function qde(e){return h0t(e)?EJ(e):EJ(Yde)}kA(s0t,o0t);kA(u0t,l0t);kA(c0t,f0t);kA(Yde,Gde);var ul=0,vn=-1,pn=1;function v0t(e,t){for(var r=d0t(t),n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];e.sort(r.apply(void 0,i))}function RJ(e){return m0t(e)||y0t(e)||g0t(e)||p0t()}function p0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g0t(e,t){if(e){if(typeof e=="string")return kJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kJ(e,t)}}function kJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m0t(e){if(Array.isArray(e))return e}function b0t(e,t){return function(r,n){var i=RJ(r),a=i.slice(1),o=RJ(n),s=o.slice(1);return function(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.columnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:qde(c.type),y=g(f,c,v)(h,d);return y}(0)}}function hy(e){return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(e)}var w0t=["column"],_0t=["column"];function Kv(e){return T0t(e)||x0t(e)||C0t(e)||S0t()}function S0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C0t(e,t){if(e){if(typeof e=="string")return XF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XF(e,t)}}function x0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function T0t(e){if(Array.isArray(e))return XF(e)}function XF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function PJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AJ(Object(r),!0).forEach(function(n){O0t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O0t(e,t,r){return t=Zde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IJ(e,t){if(e==null)return{};var r=E0t(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function E0t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function R0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zde(n.key),n)}}function k0t(e,t,r){return t&&MJ(e.prototype,t),r&&MJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zde(e){var t=A0t(e,"string");return hy(t)==="symbol"?t:String(t)}function A0t(e,t){if(hy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fh(){return typeof Reflect<"u"&&Reflect.get?Fh=Reflect.get.bind():Fh=function(t,r,n){var i=P0t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Fh.apply(this,arguments)}function P0t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nu(e),e!==null););return e}function I0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qF(e,t)}function qF(e,t){return qF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qF(e,t)}function M0t(e){var t=N0t();return function(){var n=nu(e),i;if(t){var a=nu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return D0t(this,i)}}function D0t(e,t){if(t&&(hy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $0t(e)}function $0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nu(e){return nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nu(e)}var ZF="columnSorting",L0t=50,DJ="append",F0t="replace";Xde(ZF,b0t);ft.getSingleton().register("beforeColumnSort");ft.getSingleton().register("afterColumnSort");var Jde=function(e){I0t(r,e);var t=M0t(r);function r(n){var i;return R0t(this,r),i=t.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=ZF,i.indexesSequenceCache=null,i}return k0t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new Jmt(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Cc(function(a){var o=i.hot.toVisualColumn(a);return o===null&&(o=a),i.getMergedPluginSettings(o)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(a,o){return i.onAfterOnCellMouseDown(a,o)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Fh(nu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,a=function(s,l){var u=TJ(l);OJ(s,l)===!1||u===null||i.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",a)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Fh(nu(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var a=this.getSortConfig(),o=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(o),l=this.hot.runHooks("beforeColumnSort",a,o,s);l!==!1&&(a.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Vhe),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",a,s?o:a,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return lt(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var a=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(a)&&this.columnStatesManager.setSortStates(a)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var a=this.hot.countCols();return t0t(i)&&i.every(function(o){var s=o.column;return s<=a&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var a=this,o=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var f=u.column,c=IJ(u,w0t);return PJ({column:a.hot.toPhysicalColumn(f)},c)};o.initialConfig=Ut(i,s),this.hot.runHooks("persistentStateSave","columnSorting",o)}},{key:"getAllSavedSortSettings",value:function(){var i=this,a={};this.hot.runHooks("persistentStateLoad","columnSorting",a);var o=a.value,s=function(u){var f=u.column,c=IJ(u,_0t);return PJ({column:i.hot.toVisualColumn(f)},c)};return lt(o)&&Array.isArray(o.initialConfig)&&(o.initialConfig=Ut(o.initialConfig,s)),o}},{key:"getColumnNextConfig",value:function(i){var a=this.columnStatesManager.getSortOrderOfColumn(i);if(lt(a)){var o=xJ(a);return lt(o)?{column:i,sortOrder:o}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:xJ()}}},{key:"getNextSortConfig",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DJ,o=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=o!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(i);if(s){if(Lr(u))return[].concat(Kv(l.slice(0,o)),Kv(l.slice(o+1)));if(a===DJ)return[].concat(Kv(l.slice(0,o)),Kv(l.slice(o+1)),[u]);if(a===F0t)return[].concat(Kv(l.slice(0,o)),[u],Kv(l.slice(o+1)))}return lt(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(i){if(zt(i)){var a=i[this.pluginKey];if(zt(a))return a}return{}}},{key:"getMergedPluginSettings",value:function(i){var a=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns[i])):jr(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns(i))):Object.assign(o,a)}},{key:"getFirstCellSettings",value:function(i){var a=this.hot.getCellMeta(0,i),o=Object.create(a);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),o}},{key:"getNumberOfRowsToSort",value:function(i){var a=this.hot.getSettings();return a.maxRows<=i?a.maxRows:i-a.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var a=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var o=[],s=this.hot.countRows(),l=function(y){return Ut(i,function(b){return a.hot.getDataAtCell(y,b.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)o.push([this.hot.toPhysicalRow(u)].concat(l(u)));var f=Ut(o,function(g){return g[0]});v0t(o,this.pluginKey,Ut(i,function(g){return g.sortOrder}),Ut(i,function(g){return a.getFirstCellSettings(g.column)}));for(var c=o.length;c<s;c+=1)o.push([c].concat(l(c)));var h=Ut(o,function(g){return g[0]}),d=new Map(Ut(f,function(g,y){return[g,h[y]]})),v=Ut(this.hot.rowIndexMapper.getIndexesSequence(),function(g){return d.has(g)?d.get(g):g});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(zt(i))this.sortBySettings(i);else{var a=this.hot.getSettings()[this.pluginKey];this.sortBySettings(a)}}},{key:"sortBySettings",value:function(i){if(zt(i)){this.columnStatesManager.updateAllColumnsProperties(i);var a=i.initialConfig;(Array.isArray(a)||zt(a))&&this.sort(a)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,a){var o=TJ(a);if(!(OJ(i,a)===!1||o===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(o,this.columnStatesManager,i,l,u)}}},{key:"updateHeaderClasses",value:function(i){if(Mt(i,a0t()),this.enabled!==!1){for(var a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];Ue(i,i0t.apply(void 0,o))}}},{key:"onUpdateSettings",value:function(i){Fh(nu(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),lt(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,a){var o=this.getFirstCellSettings(a)[this.pluginKey],s=o.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){KF(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){KF(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(a.col)),this.sort(this.getColumnNextConfig(a.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Fh(nu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ZF}},{key:"PLUGIN_PRIORITY",get:function(){return L0t}}]),r}(wr),H0t=Ot,Mj=Yt,B0t=Sc,V0t=sue,W0t=afe,$J=Lt,j0t=RangeError,Qde=String,eve=Math.floor,JF=Mj(W0t),NJ=Mj("".slice),W0=Mj(1 .toFixed),Ep=function(e,t,r){return t===0?r:t%2===1?Ep(e,t-1,r*e):Ep(e*e,t/2,r)},U0t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},Xv=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=eve(i/1e7)},aD=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=eve(n/t),n=n%t*1e7},LJ=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=Qde(e[t]);r=r===""?n:r+JF("0",7-n.length)+n}return r},z0t=$J(function(){return W0(8e-5,3)!=="0.000"||W0(.9,0)!=="1"||W0(1.255,2)!=="1.25"||W0(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!$J(function(){W0({})});H0t({target:"Number",proto:!0,forced:z0t},{toFixed:function(t){var r=V0t(this),n=B0t(t),i=[0,0,0,0,0,0],a="",o="0",s,l,u,f;if(n<0||n>20)throw j0t("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return Qde(r);if(r<0&&(a="-",r=-r),r>1e-21)if(s=U0t(r*Ep(2,69,1))-69,l=s<0?r*Ep(2,-s,1):r/Ep(2,s,1),l*=4503599627370496,s=52-s,s>0){for(Xv(i,0,l),u=n;u>=7;)Xv(i,1e7,0),u-=7;for(Xv(i,Ep(10,u,1),0),u=s-1;u>=23;)aD(i,1<<23),u-=23;aD(i,1<<u),Xv(i,1,1),aD(i,2),o=LJ(i)}else Xv(i,0,l),Xv(i,1<<-s,0),o=LJ(i)+JF("0",n);return n>0?(f=o.length,o=a+(f<=n?"0."+JF("0",n-f)+o:NJ(o,0,f-n)+"."+NJ(o,f-n))):o=a+o,o}});function j_(e){return j_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j_(e)}function G0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K0t(n.key),n)}}function Y0t(e,t,r){return t&&FJ(e.prototype,t),r&&FJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K0t(e){var t=X0t(e,"string");return j_(t)==="symbol"?t:String(t)}function X0t(e,t){if(j_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q0t=function(){function e(t,r){G0t(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return Y0t(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],a=r;if(!a&&typeof this.settings=="function"){this.settingsType="function";return}return a||(a=this.settings),ue(a,function(o){var s={};n.assignSetting(o,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(o,s,"reversedRowCoords",!1),n.assignSetting(o,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"sourceColumn",o.destinationColumn),n.assignSetting(o,s,"type","sum"),n.assignSetting(o,s,"forceNumeric",!1),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"customFunction",null),n.assignSetting(o,s,"readOnly",!0),n.assignSetting(o,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(r,n,i,a){if(i==="ranges"&&r[i]===void 0){n[i]=a;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(a instanceof Error)throw a;n[i]=a}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var a=r.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();ue(o,function(s){a==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=i:r==="remove_row"&&(s.alterRowOffset=-1*i)),a==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=i:r==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,a,o){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function g(){return s.hot.removeHook("beforeViewRender",g),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;ue(h,function(g){f==="row"&&g.destinationRow>=v&&(g.alterRowOffset=c*i),f==="col"&&g.destinationColumn>=v&&(g.alterColumnOffset=c*i)}),this.resetAllEndpoints(h,!d),d?ue(h,function(g){s.extendEndpointRanges(g,v,a[0],a.length),s.recreatePhysicalRanges(g),s.clearOffsetInformation(g)}):ue(h,function(g){s.shiftEndpointCoordinates(g,v)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,a){ue(r.ranges,function(o){o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=a:i<o[0]&&(o[0]-=a):i>=o[0]&&i<=o[1]&&(o[1]-=a,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,a=[],o=[];ue(i,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));o.push(l)}),ue(o,function(s){var l=[];ue(s,function(u,f){f===0?l.push(u):s[f]!==s[f-1]+1&&(l.push(s[f-1]),a.push(l),l=[],l.push(u)),f===s.length-1&&(l.push(u),a.push(l))})}),r.ranges=a}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,ue(r.ranges,function(i){ue(i,function(a,o){a>=n&&(i[o]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=n.some(function(o){var s=o.alterRowOffset||0,l=o.alterColumnOffset||0;return o.destinationRow+s>=r.hot.countRows()||o.destinationColumn+l>=r.hot.countCols()});a||(this.cellsToSetCache=[],ue(n,function(o){r.resetEndpointValue(o,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],ue(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],ue(r,function(a,o,s){"".concat(a[2]||"")!=="".concat(a[3])&&ue(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[o][1])===l.sourceColumn&&i.indexOf(u)===-1&&i.push(u)})}),ue(i,function(a){n.refreshEndpoint(n.getEndpoint(a))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,a=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?a:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var o=this.hot.toVisualRow(r.destinationRow);if(o!==null){var s=this.hot.getCellMeta(o,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(a,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([a,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){Fr("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const Z0t=q0t;function oD(e){return e==null||isNaN(e)}function dy(e){return dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dy(e)}var HJ;function J0t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Q0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tbt(n.key),n)}}function ebt(e,t,r){return t&&BJ(e.prototype,t),r&&BJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tbt(e){var t=rbt(e,"string");return dy(t)==="symbol"?t:String(t)}function rbt(e,t){if(dy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AO(){return typeof Reflect<"u"&&Reflect.get?AO=Reflect.get.bind():AO=function(t,r,n){var i=nbt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},AO.apply(this,arguments)}function nbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vy(e),e!==null););return e}function ibt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QF(e,t)}function QF(e,t){return QF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QF(e,t)}function abt(e){var t=lbt();return function(){var n=vy(e),i;if(t){var a=vy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return obt(this,i)}}function obt(e,t){if(t&&(dy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sbt(e)}function sbt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vy(e){return vy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vy(e)}var sD="columnSummary",ubt=220,fbt=function(e){ibt(r,e);var t=abt(r);function r(n){var i;return Q0t(this,r),i=t.call(this,n),i.endpoints=null,i}return ebt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[sD],this.endpoints=new Z0t(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",a,o,null,s)}),this.addHook("beforeCreateCol",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",a,o,null,s)}),this.addHook("beforeRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",a,o,null,s)}),this.addHook("afterCreateCol",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",a,o,null,s)}),this.addHook("afterRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),AO(vy(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var a=this,o=0;return Gt(i.ranges,function(s){o+=a.getPartialSum(s,i.sourceColumn)}),o}},{key:"getPartialSum",value:function(i,a){var o=0,s=i[1]||i[0],l=null,u=0;do{if(l=this.getCellValue(s,a),l=oD(l)?null:l,l!==null){var f=("".concat(l).split(".")[1]||[]).length||1;f>u&&(u=f)}o+=l||0,s-=1}while(s>=i[0]);return Math.round(o*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(i,a){var o=this,s=null;return Gt(i.ranges,function(l){var u=o.getPartialMinMax(l,i.sourceColumn,a);if(s===null&&u!==null&&(s=u),u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,a,o){var s=null,l=i[1]||i[0],u;do{if(u=this.getCellValue(l,a),u=oD(u)?null:u,s===null)s=u;else if(u!==null)switch(o){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,a){var o,s=0,l=i[1]||i[0];do o=this.getCellValue(l,a),o=oD(o)?null:o,o===null&&(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var a=this,o=0,s=i.ranges;return Gt(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,f=a.countEmpty(l,i.sourceColumn);o+=u,o-=f}),o}},{key:"calculateAverage",value:function(i){var a=this.calculateSum(i),o=this.countEntries(i);return a/o}},{key:"getCellValue",value:function(i,a){var o=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(a),l=this.hot.getSourceDataAtCell(i,a),u="";if(o!==null&&s!==null&&(u=this.hot.getCellMeta(o,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ir(HJ||(HJ=J0t(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,a));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,a){i&&a!=="ColumnSummary.reset"&&a!=="ColumnSummary.set"&&a!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,a){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",a,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return sD}},{key:"PLUGIN_PRIORITY",get:function(){return ubt}}]),r}(wr);function U_(e){return U_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U_(e)}function cbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dbt(n.key),n)}}function hbt(e,t,r){return t&&VJ(e.prototype,t),r&&VJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dbt(e){var t=vbt(e,"string");return U_(t)==="symbol"?t:String(t)}function vbt(e,t){if(U_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(U_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pbt=function(){function e(t,r){cbt(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return hbt(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:$r(this.getInputElement()),height:ln(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ue(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ue(r,e.CLASS_EDITOR),Ue(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const gbt=pbt;var qt="---------";function ybt(){return{name:qt}}function mbt(e){return Ut(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function iT(e){return Pt(e,"htSeparator")}function bbt(e){return Pt(e,"htSubmenu")}function aT(e){return Pt(e,"htDisabled")}function oT(e){return Pt(e,"htSelectionDisabled")}function Jd(e){var t=e.getSelected();return!t||t[0]<0?null:t}function wbt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function _bt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function ph(e,t){var r={};return ue(e,function(n){n.forAll(function(i,a){i>=0&&a>=0&&(r[i]||(r[i]=[]),r[i][a]=t(i,a))})}),r}function Of(e,t,r,n,i){ue(e,function(a){a.forAll(function(o,s){o>=0&&s>=0&&Sbt(o,s,t,r,n,i)})})}function Sbt(e,t,r,n,i,a){var o=i(e,t),s=n;o.className&&(r==="vertical"?s=wbt(o.className,n):s=_bt(o.className,n)),a(e,t,"className",s)}function Qs(e,t){var r=!1;return Array.isArray(e)&&ue(e,function(n){return n.forAll(function(i,a){if(i>=0&&a>=0&&t(i,a))return r=!0,!1}),r}),r}function Ul(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Cbt(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function tve(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function xbt(e,t){var r=e.slice(0);return r.reverse(),r=tve(r,t),r.reverse(),r}function Tbt(e){var t=[];return ue(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function Obt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qt,r=e.slice(0);return r=tve(r,t),r=xbt(r,t),r=Tbt(r),r}function z_(e){return z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z_(e)}function Ebt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kbt(n.key),n)}}function Rbt(e,t,r){return t&&WJ(e.prototype,t),r&&WJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kbt(e){var t=Abt(e,"string");return z_(t)==="symbol"?t:String(t)}function Abt(e,t){if(z_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pbt=250,Ibt=250,rve=function(){function e(t){Ebt(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return Rbt(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},Ibt)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pbt;this.showDebounced=bV(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();Br(rve,Pa);const Mbt=rve;function py(e){return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function lD(e,t,r){return t=nve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nve(n.key),n)}}function $bt(e,t,r){return t&&jJ(e.prototype,t),r&&jJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nve(e){var t=Nbt(e,"string");return py(t)==="symbol"?t:String(t)}function Nbt(e,t){if(py(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hh(){return typeof Reflect<"u"&&Reflect.get?Hh=Reflect.get.bind():Hh=function(t,r,n){var i=Lbt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Hh.apply(this,arguments)}function Lbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=iu(e),e!==null););return e}function Fbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eH(e,t)}function eH(e,t){return eH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eH(e,t)}function Hbt(e){var t=Vbt();return function(){var n=iu(e),i;if(t){var a=iu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Bbt(this,i)}}function Bbt(e,t){if(t&&(py(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ive(e)}function ive(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iu(e){return iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iu(e)}var uD="comments",Wbt=60,sT=new WeakMap,Us="comment",qv="value",UJ="style",lT="readOnly",jbt=function(e){Fbt(r,e);var t=Hbt(r);function r(n){var i;return Dbt(this,r),i=t.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,sT.set(ive(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return $bt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[uD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new gbt(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new un(this)),this.displaySwitch||(this.displaySwitch=new Mbt(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(a){return i.addToContextMenu(a)}),this.addHook("afterRenderer",function(a,o,s,l,u,f){return i.onAfterRenderer(a,f)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(a,o){return i.showAtCell(a,o)}),this.registerListeners(),Hh(iu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Hh(iu(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Hh(iu(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,a=this.hot.rootDocument;this.eventManager.addEventListener(a,"mouseover",function(o){return i.onMouseOver(o)}),this.eventManager.addEventListener(a,"mousedown",function(o){return i.onMouseDown(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(o){return i.onEditorMouseDown(o)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(o){return i.onEditorMouseUp(o)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var a=Yf(i.target,"TD","TBODY");return!!(a&&Pt(a,"htCommentCell")&&Yf(a,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.editor.getValue(),o="";i!=null?o=i:a!=null&&(o=a);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,lD({},qv,o)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,a,o){this.setRange({from:this.hot._createCellCoords(i,a)}),this.setComment(o)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Us),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,a)}),this.removeComment(o)}},{key:"getComment",value:function(){var i=this.range.from.row,a=this.range.from.col;return this.getCommentMeta(i,a,qv)}},{key:"getCommentAtCell",value:function(i,a){return this.getCommentMeta(i,a,qv)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,a=i.row,o=i.col;if(a<0||a>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[Us]?s[Us][qv]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,a){return this.setRange({from:this.hot._createCellCoords(i,a)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,a,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!o&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=l.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),g=d===null;this.editor.setPosition(0,0),d===null&&(d=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var y=d===null,b=v===null;d=(i=d)!==null&&i!==void 0?i:0,v=(a=v)!==null&&a!==void 0?a:0;var w=this.hot,_=w.rootWindow,x=w.view._wt,T=x.wtTable,O=x.getCell({row:d,col:v},!0),E=this.getCommentMeta(c,h,UJ);E?this.editor.setSize(E.width,E.height):this.editor.resetSize();var M=b?0:T.getStretchedColumnWidth(v),P=g&&!y?ln(O):0,N=O.getBoundingClientRect(),D=N.left,L=N.top,V=N.width,ee=N.height,ie=this.editor.getSize(),le=ie.width,_e=ie.height,U=this.hot.rootWindow,C=U.innerWidth,R=U.innerHeight,I=this.hot.rootDocument.documentElement,k=D+_.scrollX+M,F=L+_.scrollY+P;this.hot.isRtl()&&(k-=le+M),this.hot.isLtr()&&D+V+le>C?k=D+_.scrollX-le-1:this.hot.isRtl()&&k<-(I.scrollWidth-I.clientWidth)&&(k=D+_.scrollX+M+1),L+_e>R&&(F-=_e-ee+1),this.editor.setPosition(k,F),this.editor.setReadOnlyState(this.getCommentMeta(c,h,lT))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var a=!1,o=i.getTopStartCorner();return this.getCommentMeta(o.row,o.col,qv)&&(a=!0),a}},{key:"updateCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a)[Us],l;s?(l=Mi(s),p1(l,o)):l=o,this.hot.setCellMeta(i,a,Us,l)}},{key:"getCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a);if(s[Us])return s[Us][o]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var a=Yf(i.target,"TD","TBODY"),o=null;a&&(o=this.hot.getCoords(a)),(!a||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var a=sT.get(this),o=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Pt(i.target,"wtBorder")||a.cellBelowCursor===i.target||!this.editor))if(a.cellBelowCursor=o.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var s=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(s)}else Kf(i.target,o)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,a){a[Us]&&a[Us][qv]&&Ue(i,a.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var a=sT.get(this);a.tempEditorDimensions={width:$r(i.target),height:ln(i.target)}}},{key:"onEditorMouseUp",value:function(i){var a=sT.get(this),o=$r(i.target),s=ln(i.target);(o!==a.tempEditorDimensions.width+1||s!==a.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,lD({},UJ,{width:o,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){o>=0&&s>=0&&i.removeCommentAtCell(o,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){if(o>=0&&s>=0){var l=!!i.getCommentMeta(o,s,lT);i.updateCommentMeta(o,s,lD({},lT,!l))}})}},{key:"addToContextMenu",value:function(i){var a=this,o=function(){return a.hot.rowIndexMapper.getRenderableIndexesLength()>0&&a.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return a.checkSelectionCommentsConsistency()?a.hot.getTranslatedPhrase(vW):a.hot.getTranslatedPhrase(dW)},callback:function(){return a.onContextMenuAddComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(pW)},callback:function(){return a.onContextMenuRemoveComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(gW),f=Qs(this.getSelectedRangeLast(),function(c,h){var d=l.getCellMeta(c,h)[Us];if(d&&(d=d[lT]),d)return!0});return f&&(u=Ul(u)),u},callback:function(){return a.onContextMenuMakeReadOnly()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner())||!a.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[uD];if(zt(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Hh(iu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return uD}},{key:"PLUGIN_PRIORITY",get:function(){return Wbt}}]),r}(wr);function G_(e){return G_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G_(e)}function Ubt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gbt(n.key),n)}}function zbt(e,t,r){return t&&zJ(e.prototype,t),r&&zJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gbt(e){var t=Ybt(e,"string");return G_(t)==="symbol"?t:String(t)}function Ybt(e,t){if(G_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kbt=function(){function e(t){Ubt(this,e),this.hot=t,this.commands={},this.commonCallback=null}return zbt(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,f=this.commands[l];if(!f)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&f.submenu&&(f=Xbt(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!gn(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),a.unshift(s.join(":")),ue(c,function(h){return h.apply(n.hot,a)})}}}]),e}();function Xbt(e,t){var r;return ue(t,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===e)return r=n,!1}),r}const ave=Kbt;var To="alignment";function qbt(){return{key:To,name:function(){return this.getTranslatedPhrase(yW)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(To,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(mW),n=Qs(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htLeft")!==-1)return!0});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ph(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htLeft";this.runHooks("beforeCellAlignment",n,r,i,a),Of(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(To,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(bW),n=Qs(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htCenter")!==-1)return!0});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ph(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htCenter";this.runHooks("beforeCellAlignment",n,r,i,a),Of(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(To,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(wW),n=Qs(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htRight")!==-1)return!0});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ph(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htRight";this.runHooks("beforeCellAlignment",n,r,i,a),Of(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(To,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(_W),n=Qs(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htJustify")!==-1)return!0});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ph(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htJustify";this.runHooks("beforeCellAlignment",n,r,i,a),Of(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{name:qt},{key:"".concat(To,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(SW),n=Qs(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htTop")!==-1)return!0});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ph(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htTop";this.runHooks("beforeCellAlignment",n,r,i,a),Of(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(To,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(CW),n=Qs(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htMiddle")!==-1)return!0});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ph(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,a),Of(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(To,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(xW),n=Qs(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htBottom")!==-1)return!0});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ph(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htBottom";this.runHooks("beforeCellAlignment",n,r,i,a),Of(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1}]}}}var AA="clear_column";function Zbt(){return{key:AA,name:function(){return this.getTranslatedPhrase(nW)},callback:function(t,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=Jd(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var M1="col_left";function Jbt(){return{key:M1,name:function(){return this.getTranslatedPhrase(qV)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Jd(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var D1="col_right";function Qbt(){return{key:D1,name:function(){return this.getTranslatedPhrase(ZV)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Jd(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var $1="make_read_only";function ewt(){return{key:$1,name:function(){var t=this,r=this.getTranslatedPhrase(rW),n=Qs(this.getSelectedRange(),function(i,a){return t.getCellMeta(i,a).readOnly});return n&&(r=Ul(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Qs(r,function(i,a){return t.getCellMeta(i,a).readOnly});ue(r,function(i){i.forAll(function(a,o){a>=0&&o>=0&&t.setCellMeta(a,o,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var PA="redo";function twt(){return{key:PA,name:function(){return this.getTranslatedPhrase(tW)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function rwt(e,t){return owt(e)||awt(e,t)||iwt(e,t)||nwt()}function nwt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iwt(e,t){if(e){if(typeof e=="string")return GJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GJ(e,t)}}function GJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function awt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function owt(e){if(Array.isArray(e))return e}var N1="remove_col";function swt(){return{key:N1,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=rwt(t[0],4),i=n[1],a=n[3];i-a!==0&&(r=1)}return this.getTranslatedPhrase(QV,r)},callback:function(){this.alter("remove_col",mft(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Jd(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function lwt(e,t){return hwt(e)||cwt(e,t)||fwt(e,t)||uwt()}function uwt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fwt(e,t){if(e){if(typeof e=="string")return YJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YJ(e,t)}}function YJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cwt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function hwt(e){if(Array.isArray(e))return e}var IA="remove_row";function dwt(){return{key:IA,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=lwt(t[0],3),i=n[0],a=n[2];i-a!==0&&(r=1)}return this.getTranslatedPhrase(JV,r)},callback:function(){this.alter("remove_row",bft(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=Jd(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var MA="row_above";function vwt(){return{key:MA,name:function(){return this.getTranslatedPhrase(KV)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=Jd(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var DA="row_below";function pwt(){return{key:DA,name:function(){return this.getTranslatedPhrase(XV)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=Jd(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Y_="no_items";function gwt(){return{key:Y_,name:function(){return this.getTranslatedPhrase(YV)},disabled:!0,isCommand:!1}}var $A="undo";function ywt(){return{key:$A,name:function(){return this.getTranslatedPhrase(eW)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function K_(e){return K_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K_(e)}var ji;function Na(e,t,r){return t=mwt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mwt(e){var t=bwt(e,"string");return K_(t)==="symbol"?t:String(t)}function bwt(e,t){if(K_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wwt=[MA,DA,M1,D1,AA,IA,N1,$A,PA,$1,To,qt,Y_],_wt=(ji={},Na(ji,qt,ybt),Na(ji,Y_,gwt),Na(ji,MA,vwt),Na(ji,DA,pwt),Na(ji,M1,Jbt),Na(ji,D1,Qbt),Na(ji,AA,Zbt),Na(ji,IA,dwt),Na(ji,N1,swt),Na(ji,$A,ywt),Na(ji,PA,twt),Na(ji,$1,ewt),Na(ji,To,qbt),ji);function ove(){var e={};return Gt(_wt,function(t,r){e[r]=t()}),e}function X_(e){return X_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X_(e)}function Swt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xwt(n.key),n)}}function Cwt(e,t,r){return t&&KJ(e.prototype,t),r&&KJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xwt(e){var t=Twt(e,"string");return X_(t)==="symbol"?t:String(t)}function Twt(e,t){if(X_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Owt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Swt(this,e),this.hot=t,this.predefinedItems=ove(),this.defaultOrderPattern=r}return Cwt(e,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,Gt(r,function(a,o){var s="";a.name===qt?(i[qt]=a,s=qt):isNaN(parseInt(o,10))?(a.key=a.key===void 0?o:a.key,i[o]=a,s=a.key):(i[a.key]=a,s=a.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Ewt(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function Ewt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=e;return i&&i.items?i=i.items:Array.isArray(i)||(i=t),zt(i)?Gt(i,function(a,o){var s=r[typeof a=="string"?a:o];s||(s=a),zt(a)?$n(s,a):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=o),n.push(s)}):ue(i,function(a,o){var s=r[a];!s&&wwt.indexOf(a)>=0||(s||(s={name:a,key:"".concat(o)}),zt(a)&&$n(s,a),s.key===void 0&&(s.key=o),n.push(s))}),n}const sve=Owt;function q_(e){return q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q_(e)}function Rwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Awt(n.key),n)}}function kwt(e,t,r){return t&&XJ(e.prototype,t),r&&XJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Awt(e){var t=Pwt(e,"string");return q_(t)==="symbol"?t:String(t)}function Pwt(e,t){if(q_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iwt=function(){function e(t,r){Rwt(this,e);var n=ug(r),i=Sd(r),a,o,s,l,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(a=parseInt(t.top,10),s=parseInt(t.left,10),u=t.height||0,f=t.width||0,o=a,l=s,a+=n,s+=i):this.type==="event"&&(a=parseInt(t.pageY,10),s=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,o=a-n,l=s-i),this.top=a,this.topRelative=o,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=f}return kwt(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const Mwt=Iwt;function Z_(e){return Z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z_(e)}function qJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ZJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qJ(Object(r),!0).forEach(function(n){Dwt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dwt(e,t,r){return t=lve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $wt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lve(n.key),n)}}function Nwt(e,t,r){return t&&JJ(e.prototype,t),r&&JJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lve(e){var t=Lwt(e,"string");return Z_(t)==="symbol"?t:String(t)}function Lwt(e,t){if(Z_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QJ=215,uve="menu",Fwt=uve,fve=function(){function e(t,r){$wt(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:QJ,container:this.hot.rootDocument.documentElement},this.eventManager=new un(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return Nwt(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=Pw(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=bV(function(d){return r.openSubMenu(d)},300),i=this.options.minWidth||QJ,a=!1,o=qa(this.menuItems,function(d){return d.key===Y_&&(a=!0),Cbt(d,r.hot)});if(o.length<1&&!a)o.push(ove()[Y_]);else if(o.length===0)return;o=Obt(o,qt);var s=!1,l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return lt(v)&&v<i?i:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,g,y,b,w,_){return r.menuItemRenderer(v,g,y,b,w,_)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,g){r.isAllSubMenusClosed()?n(g.row):r.openSubMenu(g.row)},rowHeights:function(v){return o[v].name===qt?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),XN()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!XN()||!gc(v))&&s&&r.hasSelectedItem()&&(ms()||G4()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new yj(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(Fwt),c={group:uve},h=ZJ(ZJ({},c),{},{runOnlyIf:function(v){return Dw(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var g=r.openSubMenu(v[0]);g&&g.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var g=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(g[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!bbt(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),a=new e(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return a.setMenuItems(i.submenu.items),a.open(),a.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=a,a}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;ue(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),a=i?mbt(i):[];this.runLocalHooks("executeCommand",n.key,a,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,a,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,a=r.disabled,o=r.submenu,s=a===!0||typeof a=="function"&&a.call(this.hot)===!0;return n===!1||i===qt||s===!0||o}},{key:"setPosition",value:function(r){var n=new Mwt(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.right;n+=r.cellWidth+a-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.left;n-=r.left-a}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);iT(r)||aT(r)||oT(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);iT(n)||aT(n)||oT(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,a=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;a&&(iT(a)||aT(a)||oT(a)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,a=i>=0?this.hotMenu.getCell(i,n):null;a&&(iT(a)||aT(a)||oT(a)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,a,o,s){var l=this,u=r.getSourceDataAtRow(i),f=this.hot.rootDocument.createElement("div"),c=function(b){return gn(b,"submenu")},h=function(b){return new RegExp(qt,"i").test(b.name)},d=function(b){return b.disabled===!0||typeof b.disabled=="function"&&b.disabled.call(l.hot)===!0},v=function(b){return b.disableSelection},g=s;typeof g=="function"&&(g=g.call(this.hot)),Os(n),Ue(f,"htItemWrapper"),n.appendChild(f),h(u)?Ue(n,"htSeparator"):typeof u.renderer=="function"?(Ue(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,i,a,o,g))):Xd(f,g),d(u)?(Ue(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(Ue(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(Ue(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)})):(Mt(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,a;return i&&(jr(i)&&(i=i.call(this.hot),i===null||Lr(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),a=n.querySelector(".".concat(this.options.className,".").concat(i))),a||(a=n.createElement("div"),Ue(a,"htMenu ".concat(this.options.className)),i&&Ue(a,i),this.options.container.appendChild(a)),a}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,a=r.holder.style,o=parseInt(i.width,10),s=On(n,function(l,u){return l+(u.name===qt?1:26)},0);a.width="".concat(o+3,"px"),a.height="".concat(s+3,"px"),i.height=a.height}},{key:"onAfterSelection",value:function(r,n,i,a,o){this.keyEvent===!1&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Kf(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Kf(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&Pt(r.target,"htCore")&&Kf(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();Br(fve,Pa);const Dj=fve;function gy(e){return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gy(e)}function Hwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vwt(n.key),n)}}function Bwt(e,t,r){return t&&eQ(e.prototype,t),r&&eQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vwt(e){var t=Wwt(e,"string");return gy(t)==="symbol"?t:String(t)}function Wwt(e,t){if(gy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bh(){return typeof Reflect<"u"&&Reflect.get?Bh=Reflect.get.bind():Bh=function(t,r,n){var i=jwt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Bh.apply(this,arguments)}function jwt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=au(e),e!==null););return e}function Uwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tH(e,t)}function tH(e,t){return tH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tH(e,t)}function zwt(e){var t=Ywt();return function(){var n=au(e),i;if(t){var a=au(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Gwt(this,i)}}function Gwt(e,t){if(t&&(gy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cve(e)}function cve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ywt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function au(e){return au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},au(e)}var uT="contextMenu",Kwt=70;ft.getSingleton().register("afterContextMenuDefaultOptions");ft.getSingleton().register("beforeContextMenuShow");ft.getSingleton().register("afterContextMenuShow");ft.getSingleton().register("afterContextMenuHide");ft.getSingleton().register("afterContextMenuExecute");var hve=function(e){Uwt(r,e);var t=zwt(r);function r(n){var i;return Hwt(this,r),i=t.call(this,n),i.eventManager=new un(cve(i)),i.commandExecutor=new ave(i.hot),i.itemsFactory=null,i.menu=null,i}return Bwt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[uT]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[uT];typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),this.menu=new Dj(this.hot,{className:"htContextMenu",keepInViewport:!0,container:a.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var o,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(o=i.executeCommand).call.apply(o,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(o){return i.onAfterOnCellContextMenu(o)}),Bh(au(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Bh(au(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Bh(au(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u-ug(i.view),o=f-Sd(i.view)}else a=-1*ug(this.menu.hotMenu.rootWindow),o=-1*Sd(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+a,left:parseInt(i.pageX,10)+o})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var a;this.itemsFactory===null&&this.prepareMenuItems();for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new sve(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[uT],o={items:this.itemsFactory.getItems(a)};this.hot.runHooks("afterContextMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);var s=this.itemsFactory.getItems(a);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),ue(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var a=this.hot.getSettings(),o=a.rowHeaders,s=a.colHeaders;function l(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=i.target;this.close(),!Pt(u,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(o||s)&&!l(u)&&!(Pt(u,"current")&&Pt(u,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Bh(au(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return uT}},{key:"PLUGIN_PRIORITY",get:function(){return Kwt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[MA,DA,qt,M1,D1,qt,IA,N1,qt,$A,PA,qt,$1,qt,To]}}]),r}(wr);hve.SEPARATOR={name:qt};function Xwt(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(iW)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function qwt(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(sW,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Zwt(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(oW,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Jwt(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(aW,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Qwt(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(lW)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function J_(e){return J_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J_(e)}function e_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r_t(n.key),n)}}function t_t(e,t,r){return t&&tQ(e.prototype,t),r&&tQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r_t(e){var t=n_t(e,"string");return J_(t)==="symbol"?t:String(t)}function n_t(e,t){if(J_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(J_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i_t=function(){function e(){e_t(this,e),this.data={}}return t_t(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function Q_(e){return Q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q_(e)}function rQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o_t(n.key),n)}}function a_t(e,t,r){return t&&rQ(e.prototype,t),r&&rQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o_t(e){var t=s_t(e,"string");return Q_(t)==="symbol"?t:String(t)}function s_t(e,t){if(Q_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u_t=a_t(function e(){l_t(this,e),this.clipboardData=new i_t});function eS(e){return eS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eS(e)}function f_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h_t(n.key),n)}}function c_t(e,t,r){return t&&nQ(e.prototype,t),r&&nQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h_t(e){var t=d_t(e,"string");return eS(t)==="symbol"?t:String(t)}function d_t(e,t){if(eS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $j=function(){function e(t){f_t(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new un(this),this.listenersCount=new WeakSet,this.container=t}return c_t(e,[{key:"useSecondaryElement",value:function(){var r=g_t(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),iQ(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),iQ(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",ms()||lce(this.mainElement)}}]),e}();Br($j,Pa);var ER=new WeakMap;function v_t(e){var t=new $j(e),r=ER.get(e);return r=isNaN(r)?0:r,ER.set(e,r+1),t}function p_t(e){e.eventManager.clear()}var fD=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function iQ(e,t,r){e.addEventListener(t,"copy",fD("copy",r)),e.addEventListener(t,"cut",fD("cut",r)),e.addEventListener(t,"paste",fD("paste",r))}var RR=new WeakMap;function g_t(e){var t=RR.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return RR.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function aQ(e){if(e instanceof $j){var t=ER.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),p_t(e),t<=0){t=0;var r=RR.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),RR.delete(e.container)),e.mainElement=null}ER.set(e.container,t)}}function tS(e){return tS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tS(e)}function y_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b_t(n.key),n)}}function m_t(e,t,r){return t&&oQ(e.prototype,t),r&&oQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b_t(e){var t=w_t(e,"string");return tS(t)==="symbol"?t:String(t)}function w_t(e,t){if(tS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sQ(e,t){dve(e,t),t.add(e)}function Zv(e,t,r){dve(e,t),t.set(e,r)}function dve(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fT(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Yi(e,t){var r=vve(e,t,"get");return __t(e,r)}function __t(e,t){return t.get?t.get.call(e):t.value}function Jv(e,t,r){var n=vve(e,t,"set");return S_t(e,n,r),r}function vve(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function S_t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var mf=new WeakMap,cD=new WeakMap,j0=new WeakMap,rH=new WeakMap,nH=new WeakMap,U0=new WeakMap,cT=new WeakSet,lQ=new WeakSet,C_t=function(){function e(t){var r=t.countRows,n=t.countColumns,i=t.rowsLimit,a=t.columnsLimit,o=t.countColumnHeaders;y_t(this,e),sQ(this,lQ),sQ(this,cT),Zv(this,mf,{writable:!0,value:void 0}),Zv(this,cD,{writable:!0,value:void 0}),Zv(this,j0,{writable:!0,value:void 0}),Zv(this,rH,{writable:!0,value:void 0}),Zv(this,nH,{writable:!0,value:void 0}),Zv(this,U0,{writable:!0,value:void 0}),Jv(this,cD,r),Jv(this,j0,n),Jv(this,rH,i),Jv(this,nH,a),Jv(this,U0,o)}return m_t(e,[{key:"setSelectedRange",value:function(r){Jv(this,mf,r)}},{key:"getCellsRange",value:function(){if(Yi(this,cD).call(this)===0||Yi(this,j0).call(this)===0)return null;var r=Yi(this,mf).getTopStartCorner(),n=r.row,i=r.col,a=Yi(this,mf).getBottomEndCorner(),o=a.row,s=a.col,l=fT(this,lQ,x_t).call(this,n,o),u=fT(this,cT,hD).call(this,i,s),f=o!==l||s!==u;return{isRangeTrimmed:f,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(Yi(this,j0).call(this)===0||Yi(this,U0).call(this)===0)return null;var r=Yi(this,mf).getTopStartCorner(),n=r.col,i=Yi(this,mf).getBottomEndCorner(),a=i.col,o=fT(this,cT,hD).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:o}}},{key:"getAllColumnHeadersRange",value:function(){if(Yi(this,j0).call(this)===0||Yi(this,U0).call(this)===0)return null;var r=Yi(this,mf).getTopStartCorner(),n=r.col,i=Yi(this,mf).getBottomEndCorner(),a=i.col,o=fT(this,cT,hD).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-Yi(this,U0).call(this),startCol:n,endRow:-1,endCol:o}}}]),e}();function hD(e,t){return Math.min(t,Math.max(e+Yi(this,nH).call(this)-1,e))}function x_t(e,t){return Math.min(t,Math.max(e+Yi(this,rH).call(this)-1,e))}function pve(e){var t=[],r=[];return ue(e,function(n){var i=Math.min(n.startRow,n.endRow),a=Math.max(n.startRow,n.endRow);yt(i,a,function(l){t.indexOf(l)===-1&&t.push(l)});var o=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);yt(o,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:t,columns:r}}function T_t(e,t){return k_t(e)||R_t(e,t)||E_t(e,t)||O_t()}function O_t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E_t(e,t){if(e){if(typeof e=="string")return uQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uQ(e,t)}}function uQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R_t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function k_t(e){if(Array.isArray(e))return e}function Id(e){return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function A_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yve(n.key),n)}}function P_t(e,t,r){return t&&fQ(e.prototype,t),r&&fQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vh(){return typeof Reflect<"u"&&Reflect.get?Vh=Reflect.get.bind():Vh=function(t,r,n){var i=I_t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Vh.apply(this,arguments)}function I_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ou(e),e!==null););return e}function M_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iH(e,t)}function iH(e,t){return iH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iH(e,t)}function D_t(e){var t=N_t();return function(){var n=ou(e),i;if(t){var a=ou(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return $_t(this,i)}}function $_t(e,t){if(t&&(Id(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gi(e)}function Gi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ou(e){return ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ou(e)}function L_t(e,t){gve(e,t),t.add(e)}function gh(e,t,r){gve(e,t),t.set(e,r)}function gve(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qv(e,t,r){return t=yve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yve(e){var t=F_t(e,"string");return Id(t)==="symbol"?t:String(t)}function F_t(e,t){if(Id(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H_t(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function La(e,t){var r=mve(e,t,"get");return B_t(e,r)}function B_t(e,t){return t.get?t.get.call(e):t.value}function Nl(e,t,r){var n=mve(e,t,"set");return V_t(e,n,r),r}function mve(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function V_t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ft.getSingleton().register("afterCopyLimit");ft.getSingleton().register("modifyCopyableRange");ft.getSingleton().register("beforeCut");ft.getSingleton().register("afterCut");ft.getSingleton().register("beforePaste");ft.getSingleton().register("afterPaste");ft.getSingleton().register("beforeCopy");ft.getSingleton().register("afterCopy");var hT="copyPaste",W_t=80,j_t=["fragmentSelection"],cQ=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),dD=new WeakMap,vD=new WeakMap,pD=new WeakMap,ep=new WeakMap,dT=new WeakMap,vT=new WeakMap,tp=new WeakMap,hQ=new WeakSet,U_t=function(e){M_t(r,e);var t=D_t(r);function r(){var n;A_t(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),L_t(Gi(n),hQ),Qv(Gi(n),"columnsLimit",1/0),Qv(Gi(n),"rowsLimit",1/0),Qv(Gi(n),"pasteMode","overwrite"),Qv(Gi(n),"uiContainer",n.hot.rootDocument.body),gh(Gi(n),dD,{writable:!0,value:!1}),gh(Gi(n),vD,{writable:!0,value:!1}),gh(Gi(n),pD,{writable:!0,value:!1}),gh(Gi(n),ep,{writable:!0,value:"cells-only"}),gh(Gi(n),dT,{writable:!0,value:!1}),gh(Gi(n),vT,{writable:!0,value:!1}),gh(Gi(n),tp,{writable:!0,value:new C_t({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Qv(Gi(n),"copyableRanges",[]),Qv(Gi(n),"focusableElement",void 0),n}return P_t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hT]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a[hT];if(Id(o)==="object"){var s,l;this.pasteMode=(s=o.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(o.rowsLimit)?this.rowsLimit:o.rowsLimit,this.columnsLimit=isNaN(o.columnsLimit)?this.columnsLimit:o.columnsLimit,Nl(this,dD,!!o.copyColumnHeaders),Nl(this,vD,!!o.copyColumnGroupHeaders),Nl(this,pD,!!o.copyColumnHeadersOnly),this.uiContainer=(l=o.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=v_t(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),Vh(ou(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Vh(ou(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&aQ(this.focusableElement),Vh(ou(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Nl(this,ep,i),Nl(this,dT,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Nl(this,vT,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return Ub(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var a=this,o=[],s=pve(i),l=s.rows,u=s.columns;return ue(l,function(f){var c=[];ue(u,function(h){f<0?c.push(a.hot.getColHeader(h,f)):c.push(a.hot.getCopyableData(f,h))}),o.push(c)}),o}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!a)){var o=new u_t;i&&o.clipboardData.setData("text/plain",i),a&&o.clipboardData.setData("text/html",a),this.getOrCreateFocusableElement(),this.onPaste(o)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){La(this,tp).setSelectedRange(i);var a=new Map([["headers",null],["cells",null]]);La(this,ep)==="column-headers-only"?a.set("headers",La(this,tp).getMostBottomColumnHeadersRange()):(La(this,ep)==="with-column-headers"?a.set("headers",La(this,tp).getMostBottomColumnHeadersRange()):La(this,ep)==="with-column-group-headers"&&a.set("headers",La(this,tp).getAllColumnHeadersRange()),a.set("cells",La(this,tp).getCellsRange())),this.copyableRanges=Array.from(a.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,g=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:g}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var o=a.get("cells");if(o!==null&&o.isRangeTrimmed){var s=o.startRow,l=o.startCol,u=o.endRow,f=o.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,f-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,a=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;a?this.focusableElement.setFocusableElement(a):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var o=i.length,s=i[0].length,l=[],u=a.getTopStartCorner(),f=u.row,c=u.col,h=a.getBottomEndCorner(),d=h.row,v=h.col,g=f,y=c,b=f,w=c;l.length<o||g<=d;){var _=this.hot.getCellMeta(g,c),x=_.skipRowOnPaste,T=_.visualRow;if(g=T+1,x!==!0){b=T,y=c;for(var O=[],E=l.length%o;O.length<s||y<=v;){var M=this.hot.getCellMeta(f,y),P=M.skipColumnOnPaste,N=M.visualCol;if(y=N+1,P!==!0){w=N;var D=O.length%s;O.push(i[E][D])}}l.push(O)}}return this.hot.populateFromArray(f,c,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,b,w]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!La(this,dT)||this.isEditorOpened())){this.setCopyableText(),Nl(this,dT,!1);var a=this.getRangedData(this.copyableRanges),o=H_t(this,hQ,z_t).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges,o);if(s){var l=Ub(a);if(i&&i.clipboardData){var u=_L(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[cQ,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",a,this.copyableRanges,o)}Nl(this,ep,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!La(this,vT)||this.isEditorOpened())){this.setCopyableText(),Nl(this,vT,!1);var a=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(o){var s=Ub(a);if(i&&i.clipboardData){var l=_L(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[cQ,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var a;if(i&&typeof i.clipboardData<"u"){var o=cA(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){var s=Pce(o,this.hot.rootDocument);a=s.data}else a=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(a=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof a=="string"&&(a=Bft(a)),!(a&&a.length===0)&&this.hot.runHooks("beforePaste",a,this.copyableRanges)!==!1){var l=this.populateValues(a),u=T_t(l,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",a,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},Xwt(this)),La(this,dD)&&i.items.push(Jwt(this)),La(this,vD)&&i.items.push(Zwt(this)),La(this,pD)&&i.items.push(qwt(this)),i.items.push(Qwt(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&ace())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,a=this.hot.getActiveEditor();!a||i!==this.focusableElement.getFocusableElement()&&i!==a.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(aQ(this.focusableElement),this.focusableElement=null),Vh(ou(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hT}},{key:"SETTING_KEYS",get:function(){return[hT].concat(j_t)}},{key:"PLUGIN_PRIORITY",get:function(){return W_t}}]),r}(wr);function z_t(e){for(var t=pve(e),r=t.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function bve(e,t){return"border_row".concat(e,"col").concat(t)}function db(){return{width:1,color:"#000"}}function su(){return{hide:!0}}function G_t(){return{width:1,color:"#000",cornerVisible:!1}}function gD(e){if(lt(e.start)||lt(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(lt(e.end)||lt(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function z0(e){return lt(e.start)&&(e.left=e.start),lt(e.end)&&(e.right=e.end),e}function yD(e,t){return{id:bve(e,t),border:G_t(),row:e,col:t,top:su(),bottom:su(),start:su(),end:su()}}function Y_t(e,t){return gn(t,"border")&&t.border&&(e.border=t.border),gn(t,"top")&&lt(t.top)&&(t.top?(zt(t.top)||(t.top=db()),e.top=t.top):(t.top=su(),e.top=t.top)),gn(t,"bottom")&&lt(t.bottom)&&(t.bottom?(zt(t.bottom)||(t.bottom=db()),e.bottom=t.bottom):(t.bottom=su(),e.bottom=t.bottom)),gn(t,"start")&&lt(t.start)&&(t.start?(zt(t.start)||(t.start=db()),e.start=t.start):(t.start=su(),e.start=t.start)),gn(t,"end")&&lt(t.end)&&(t.end?(zt(t.end)||(t.end=db()),e.end=t.end):(t.end=su(),e.end=t.end)),e}function Nu(e,t){var r=!1;return ue(e.getSelectedRange(),function(n){n.forAll(function(i,a){if(!(i<0||a<0)){var o=e.getCellMeta(i,a).borders;if(o)if(t){if(!gn(o[t],"hide")||o[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function NA(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function K_t(e){return e.some(function(t){return lt(t.left)||lt(t.right)})}function X_t(e){return e.some(function(t){return lt(t.start)||lt(t.end)})}var q_t=new Map([["left","start"],["right","end"]]);function Z_t(e){var t;return(t=q_t.get(e))!==null&&t!==void 0?t:e}function J_t(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(RW),n=Nu(this,"bottom");return n&&(r=NA(r)),r},callback:function(r,n){var i=Nu(this,"bottom");e.prepareBorder(n,"bottom",i)}}}function Q_t(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(kW),i=Nu(this,t);return i&&(n=NA(n)),n},callback:function(n,i){var a=Nu(this,t);e.prepareBorder(i,t,a)}}}function eSt(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(AW)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Nu(this)}}}function tSt(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(EW),i=Nu(this,t);return i&&(n=NA(n)),n},callback:function(n,i){var a=Nu(this,t);e.prepareBorder(i,t,a)}}}function rSt(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(OW),n=Nu(this,"top");return n&&(r=NA(r)),r},callback:function(r,n){var i=Nu(this,"top");e.prepareBorder(n,"top",i)}}}function yy(e){return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yy(e)}function dQ(e,t){return oSt(e)||aSt(e,t)||iSt(e,t)||nSt()}function nSt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iSt(e,t){if(e){if(typeof e=="string")return vQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vQ(e,t)}}function vQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aSt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function oSt(e){if(Array.isArray(e))return e}function sSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ve(n.key),n)}}function lSt(e,t,r){return t&&pQ(e.prototype,t),r&&pQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wh(){return typeof Reflect<"u"&&Reflect.get?Wh=Reflect.get.bind():Wh=function(t,r,n){var i=uSt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Wh.apply(this,arguments)}function uSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lu(e),e!==null););return e}function fSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aH(e,t)}function aH(e,t){return aH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aH(e,t)}function cSt(e){var t=dSt();return function(){var n=lu(e),i;if(t){var a=lu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return hSt(this,i)}}function hSt(e,t){if(t&&(yy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wve(e)}function wve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lu(e){return lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lu(e)}function vSt(e,t,r){return t=_ve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ve(e){var t=pSt(e,"string");return yy(t)==="symbol"?t:String(t)}function pSt(e,t){if(yy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pT="customBorders",gSt=90,ySt=function(e){fSt(r,e);var t=cSt(r);function r(){var n;sSt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),vSt(wve(n),"savedBorders",[]),n}return lSt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[pT]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.onAfterContextMenuDefaultOptions(a)}),this.addHook("init",function(){return i.onAfterInit()}),Wh(lu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Wh(lu(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Wh(lu(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,a){var o=this,s=["top","bottom","start","end"],l=null;a&&(this.checkSettingsCohesion([a]),s=Object.keys(a),l=gD(a));var u=Vg(i),f=k_(u);ue(i,function(c){for(var h=f(c),d=dQ(h,4),v=d[0],g=d[1],y=d[2],b=d[3],w=function(T){for(var O=function(P){ue(s,function(N){o.prepareBorderFromCustomAdded(T,P,l,Z_t(N))})},E=g;E<=b;E+=1)O(E)},_=v;_<=y;_+=1)w(_)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var a=this;if(!Array.isArray(i))return this.savedBorders;var o=Vg(i),s=k_(o),l=[];return ue(i,function(u){for(var f=s(u),c=dQ(f,4),h=c[0],d=c[1],v=c[2],g=c[3],y=function(_){for(var x=function(E){ue(a.savedBorders,function(M){M.row===_&&M.col===E&&l.push(z0(M))})},T=d;T<=g;T+=1)x(T)},b=h;b<=v;b+=1)y(b)}),l}},{key:"clearBorders",value:function(i){var a=this;i?this.setBorders(i):(ue(this.savedBorders,function(o){a.clearBordersFromSelectionSettings(o.id),a.clearNullCellRange(),a.hot.removeCellMeta(o.row,o.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,a){var o=this.checkSavedBorders(i);o||this.savedBorders.push(i);var s=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),l=this.checkCustomSelections(i,s,a);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,a,o,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(i>=l||a>=u)){var f=yD(i,a);o&&(f=Y_t(f,o),ue(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,o),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(i,a,"borders",z0(f)),this.insertBorderIntoSettings(f,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,a){var o=this,s=Math.min(i.to.row,this.hot.countRows()-1),l=Math.min(i.to.col,this.hot.countCols()-1);yt(i.from.row,s,function(u){yt(i.from.col,l,function(f){var c=yD(u,f),h=0;u===i.from.row&&gn(a,"top")&&(h+=1,c.top=a.top),u===i.to.row&&gn(a,"bottom")&&(h+=1,c.bottom=a.bottom),f===i.from.col&&gn(a,"start")&&(h+=1,c.start=a.start),f===i.to.col&&gn(a,"end")&&(h+=1,c.end=a.end),h>0&&(o.hot.setCellMeta(u,f,"borders",z0(c)),o.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(i,a){var o=bve(i,a);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(i,a,"borders")}},{key:"setBorder",value:function(i,a,o,s){var l=this.hot.getCellMeta(i,a).borders;if(!l||l.border===void 0?l=yD(i,a):l=gD(l),s){l[o]=su();var u=this.countHide(l);if(u===4)this.removeAllBorders(i,a);else{var f=this.checkCustomSelectionsFromContextMenu(l,o,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",z0(l))}}else{l[o]=db();var c=this.checkCustomSelectionsFromContextMenu(l,o,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",z0(l))}}},{key:"prepareBorder",value:function(i,a,o){var s=this;ue(i,function(l){var u=l.start,f=l.end;if(u.row===f.row&&u.col===f.col)a==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,a,o);else switch(a){case"noBorders":yt(u.col,f.col,function(c){yt(u.row,f.row,function(h){s.removeAllBorders(h,c)})});break;case"top":yt(u.col,f.col,function(c){s.setBorder(u.row,c,a,o)});break;case"bottom":yt(u.col,f.col,function(c){s.setBorder(f.row,c,a,o)});break;case"start":yt(u.row,f.row,function(c){s.setBorder(c,u.col,a,o)});break;case"end":yt(u.row,f.row,function(c){s.setBorder(c,f.col,a,o)});break}})}},{key:"createCustomBorders",value:function(i){var a=this;ue(i,function(o){var s=gD(o);o.range?a.prepareBorderFromCustomAddedRange(o.range,s):a.prepareBorderFromCustomAdded(o.row,o.col,s)})}},{key:"countHide",value:function(i){var a=i.top,o=i.bottom,s=i.start,l=i.end,u=[a,o,s,l];return On(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var a=Ut(this.hot.selection.highlight.customSelections,function(o){return o.settings.id}).indexOf(i);a>-1&&this.hot.selection.highlight.customSelections[a].clear()}},{key:"clearNullCellRange",value:function(){var i=this;ue(this.hot.selection.highlight.customSelections,function(a,o){if(a.cellRange===null)return i.hot.selection.highlight.customSelections[o].destroy(),i.hot.selection.highlight.customSelections.splice(o,1),!1})}},{key:"hideBorders",value:function(){var i=this;ue(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var a=Ut(this.savedBorders,function(o){return o.id}).indexOf(i);a>-1&&this.savedBorders.splice(a,1)}},{key:"checkSavedBorders",value:function(i){var a=this,o=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),o=!0):ue(this.savedBorders,function(l,u){if(i.id===l.id)return a.savedBorders[u]=i,o=!0,!1}),o}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,a,o){var s=!1;return ue(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return Gt(l.instanceBorders,function(u){u.toggleHiddenClass(a,o)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,a,o){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):ue(this.hot.selection.highlight.customSelections,function(u){if(i.id===u.settings.id)return u.visualCellRange=a,u.commit(),o&&Gt(u.instanceBorders,function(f){f.changeBorderStyle(o,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[pT];if(Array.isArray(i)){var a=Mi(i);this.checkSettingsCohesion(a),a.length||(this.savedBorders=a),this.createCustomBorders(a)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var a=K_t(i),o=X_t(i);if(a&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&a)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){this.hot.getSettings()[pT]&&i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(TW)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[rSt(this),tSt(this),J_t(this),Q_t(this),eSt(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Wh(lu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pT}},{key:"PLUGIN_PRIORITY",get:function(){return gSt}}]),r}(wr);function my(e){return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(e)}function mSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wSt(n.key),n)}}function bSt(e,t,r){return t&&gQ(e.prototype,t),r&&gQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wSt(e){var t=_St(e,"string");return my(t)==="symbol"?t:String(t)}function _St(e,t){if(my(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(my(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jh(){return typeof Reflect<"u"&&Reflect.get?jh=Reflect.get.bind():jh=function(t,r,n){var i=SSt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},jh.apply(this,arguments)}function SSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uu(e),e!==null););return e}function CSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oH(e,t)}function oH(e,t){return oH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oH(e,t)}function xSt(e){var t=OSt();return function(){var n=uu(e),i;if(t){var a=uu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return TSt(this,i)}}function TSt(e,t){if(t&&(my(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sve(e)}function Sve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uu(e){return uu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uu(e)}var yQ="dragToScroll",ESt=100,RSt=function(e){CSt(r,e);var t=xSt(r);function r(n){var i;return mSt(this,r),i=t.call(this,n),i.eventManager=new un(Sve(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return bSt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[yQ]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(a){return i.setupListening(a)}),this.addHook("afterOnCellCornerMouseDown",function(a){return i.setupListening(a)}),this.registerEvents(),jh(uu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),jh(uu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),jh(uu(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,a){var o=0,s=0;a<this.boundaries.top?s=a-this.boundaries.top:a>this.boundaries.bottom&&(s=a-this.boundaries.bottom),i<this.boundaries.left?o=i-this.boundaries.left:i>this.boundaries.right&&(o=i-this.boundaries.right),this.callback(o,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,a=this.hot.rootWindow,o=a;o;)this.eventManager.addEventListener(o.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mousemove",function(s){return i.onMouseMove(s)}),o=Pw(o)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!gc(i)){var a=this.hot.view._wt.wtTable.holder;a!==this.hot.rootWindow&&(this.setBoundaries(a.getBoundingClientRect()),this.setCallback(function(o,s){o<0?a.scrollLeft-=50:o>0&&(a.scrollLeft+=50),s<0?a.scrollTop-=20:s>0&&(a.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){jh(uu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yQ}},{key:"PLUGIN_PRIORITY",get:function(){return ESt}}]),r}(wr);function by(e){return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},by(e)}function kSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PSt(n.key),n)}}function ASt(e,t,r){return t&&mQ(e.prototype,t),r&&mQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PSt(e){var t=ISt(e,"string");return by(t)==="symbol"?t:String(t)}function ISt(e,t){if(by(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(by(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uh(){return typeof Reflect<"u"&&Reflect.get?Uh=Reflect.get.bind():Uh=function(t,r,n){var i=MSt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Uh.apply(this,arguments)}function MSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fu(e),e!==null););return e}function DSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sH(e,t)}function sH(e,t){return sH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sH(e,t)}function $St(e){var t=LSt();return function(){var n=fu(e),i;if(t){var a=fu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return NSt(this,i)}}function NSt(e,t){if(t&&(by(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cve(e)}function Cve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fu(e){return fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fu(e)}ft.getSingleton().register("afterDropdownMenuDefaultOptions");ft.getSingleton().register("beforeDropdownMenuShow");ft.getSingleton().register("afterDropdownMenuShow");ft.getSingleton().register("afterDropdownMenuHide");ft.getSingleton().register("afterDropdownMenuExecute");var mD="dropdownMenu",FSt=230,bD="changeType",xve=function(e){DSt(r,e);var t=$St(r);function r(n){var i;return kSt(this,r),i=t.call(this,n),i.eventManager=new un(Cve(i)),i.commandExecutor=new ave(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return ASt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[mD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new sve(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[mD],o={items:this.itemsFactory.getItems(a)};this.registerEvents(),typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),Uh(fu(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",o),i.itemsFactory.setPredefinedItems(o.items);var s=i.itemsFactory.getItems(a);i.menu&&i.menu.destroy(),i.menu=new Dj(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:a.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(l=i.executeCommand).call.apply(l,[i].concat(f))}),ue(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Uh(fu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Uh(fu(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(a){return i.onTableClick(a)})}},{key:"open",value:function(i){this.menu&&(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),Pt(i.target,bD)&&!this.menu.isOpened()){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u,o=f}var c=i.target.getBoundingClientRect();this.open({left:c.left+o,top:c.top+i.target.offsetHeight+3+a,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(i,a){var o=a.parentNode;if(o){var s=o.parentNode.childNodes,l=Array.prototype.indexOf.call(s,o);if(!(i<0||l!==s.length-1)){var u=a.querySelector(".".concat(bD));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=bD,f.type="button",f.onclick=function(){return!1},a.firstChild.insertBefore(f,a.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Uh(fu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return mD}},{key:"PLUGIN_PRIORITY",get:function(){return FSt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[M1,D1,qt,N1,qt,AA,qt,$1,qt,To]}}]),r}(wr);xve.SEPARATOR={name:qt};function rS(e){return rS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rS(e)}function HSt(e,t){return jSt(e)||WSt(e,t)||VSt(e,t)||BSt()}function BSt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VSt(e,t){if(e){if(typeof e=="string")return bQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bQ(e,t)}}function bQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WSt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function jSt(e){if(Array.isArray(e))return e}function USt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GSt(n.key),n)}}function zSt(e,t,r){return t&&wQ(e.prototype,t),r&&wQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GSt(e){var t=YSt(e,"string");return rS(t)==="symbol"?t:String(t)}function YSt(e,t){if(rS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KSt=function(){function e(t){USt(this,e),this.hot=t,this.options={}}return zSt(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,a=n.startCol,o=n.endRow,s=n.endCol,l=this.options,u=[];return yt(i,o,function(f){var c=[];!l.exportHiddenRows&&r._isHiddenRow(f)||(yt(a,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),a=i.startRow,o=i.endRow,s=this.hot.getRowHeader();yt(a,o,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),a=i.startCol,o=i.endCol,s=this.hot.getColHeader();yt(a,o,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=HSt(this.options.range,4),a=i[0],o=a===void 0?0:a,s=i[1],l=s===void 0?0:s,u=i[2],f=u===void 0?n:u,c=i[3],h=c===void 0?r:c;return o=Math.max(o,0),l=Math.max(l,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:o,startCol:l,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const XSt=KSt;function nS(e){return nS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nS(e)}function qSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JSt(n.key),n)}}function ZSt(e,t,r){return t&&_Q(e.prototype,t),r&&_Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JSt(e){var t=QSt(e,"string");return nS(t)==="symbol"?t:String(t)}function QSt(e,t){if(nS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var e1t=function(){function e(t,r){qSt(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return ZSt(e,[{key:"_mergeOptions",value:function(r){var n=ta(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=$n(ta(e.DEFAULT_OPTIONS),n),n=$n(n,r),n.filename=pV(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const t1t=e1t;function wy(e){return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function r1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i1t(n.key),n)}}function n1t(e,t,r){return t&&SQ(e.prototype,t),r&&SQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i1t(e){var t=a1t(e,"string");return wy(t)==="symbol"?t:String(t)}function a1t(e,t){if(wy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lH(e,t)}function lH(e,t){return lH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lH(e,t)}function s1t(e){var t=f1t();return function(){var n=kR(e),i;if(t){var a=kR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return l1t(this,i)}}function l1t(e,t){if(t&&(wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u1t(e)}function u1t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kR(e){return kR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kR(e)}var c1t=String.fromCharCode(13),h1t=String.fromCharCode(34),d1t=String.fromCharCode(10),v1t=function(e){o1t(r,e);var t=s1t(r);function r(){return r1t(this,r),t.apply(this,arguments)}return n1t(r,[{key:"export",value:function(){var i=this,a=this.options,o=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=a.bom?String.fromCharCode(65279):"";return l&&(s=Ut(s,function(h){return i._escapeCell(h,!0)}),f&&(c+=a.columnDelimiter),c+=s.join(a.columnDelimiter),c+=a.rowDelimiter),ue(o,function(h,d){d>0&&(c+=a.rowDelimiter),f&&(c+=i._escapeCell(u[d])+a.columnDelimiter),c+=h.map(function(v){return i._escapeCell(v)}).join(a.columnDelimiter)}),c}},{key:"_escapeCell",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=yn(i);return o!==""&&(a||o.indexOf(c1t)>=0||o.indexOf(h1t)>=0||o.indexOf(d1t)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o='"'.concat(o,'"')),o}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(t1t);const p1t=v1t;function iS(e){return iS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iS(e)}function g1t(e,t,r){return t=y1t(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y1t(e){var t=m1t(e,"string");return iS(t)==="symbol"?t:String(t)}function m1t(e,t){if(iS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b1t="csv",uH=g1t({},b1t,p1t);function w1t(e,t,r){return typeof uH[e]=="function"?new uH[e](t,r):null}function _y(e){return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_y(e)}function _1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C1t(n.key),n)}}function S1t(e,t,r){return t&&CQ(e.prototype,t),r&&CQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C1t(e){var t=x1t(e,"string");return _y(t)==="symbol"?t:String(t)}function x1t(e,t){if(_y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fH(e,t)}function fH(e,t){return fH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fH(e,t)}function O1t(e){var t=k1t();return function(){var n=AR(e),i;if(t){var a=AR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return E1t(this,i)}}function E1t(e,t){if(t&&(_y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R1t(e)}function R1t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function AR(e){return AR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},AR(e)}var A1t="exportFile",P1t=240,I1t=function(e){T1t(r,e);var t=O1t(r);function r(){return _1t(this,r),t.apply(this,arguments)}return S1t(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,a).export()}},{key:"exportAsBlob",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,a))}},{key:"downloadFile",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.hot,s=o.rootDocument,l=o.rootWindow,u=this._createTypeFormatter(i,a),f=this._createBlob(u),c=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!uH[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return w1t(i,new XSt(this.hot),a)}},{key:"_createBlob",value:function(i){var a=null;return typeof Blob<"u"&&(a=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),a}}],[{key:"PLUGIN_KEY",get:function(){return A1t}},{key:"PLUGIN_PRIORITY",get:function(){return P1t}}]),r}(wr);function aS(e){return aS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aS(e)}function M1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$1t(n.key),n)}}function D1t(e,t,r){return t&&xQ(e.prototype,t),r&&xQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $1t(e){var t=N1t(e,"string");return aS(t)==="symbol"?t:String(t)}function N1t(e,t){if(aS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(aS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tve=function(){function e(t,r){var n=r.id,i=r.stateless,a=i===void 0?!0:i;M1t(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=a?null:this.hot.columnIndexMapper.registerMap(this.stateId,new bA)}return D1t(e,[{key:"reset",value:function(){ue(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),ue(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();Br(Tve,Pa);const LA=Tve;var oS={};function yc(e,t){if(!oS[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=oS[e],n=r.condition,i=r.descriptor,a=t;return i.inputValuesDecorator&&(a=i.inputValuesDecorator(a)),function(o){return n.apply(o.meta.instance,[].concat([o],[a]))}}function zh(e){if(!oS[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return oS[e].descriptor}function Hn(e,t,r){r.key=e,oS[e]={condition:t,descriptor:r}}var oi="none";function L1t(){return!0}Hn(oi,L1t,{name:wA,inputsCount:0,showOperators:!1});var Kb="empty";function F1t(e){return Un(e.value)}Hn(Kb,F1t,{name:LW,inputsCount:0,showOperators:!0});var PO="not_empty";function H1t(e,t){return!yc(Kb,t)(e)}Hn(PO,H1t,{name:FW,inputsCount:0,showOperators:!0});function B1t(e,t){return U1t(e)||j1t(e,t)||W1t(e,t)||V1t()}function V1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W1t(e,t){if(e){if(typeof e=="string")return TQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TQ(e,t)}}function TQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j1t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function U1t(e){if(Array.isArray(e))return e}var Xb="eq";function z1t(e,t){var r=B1t(t,1),n=r[0];return yn(e.value).toLocaleLowerCase(e.meta.locale)===yn(n)}Hn(Xb,z1t,{name:HW,inputsCount:1,showOperators:!0});var IO="neq";function G1t(e,t){return!yc(Xb,t)(e)}Hn(IO,G1t,{name:BW,inputsCount:1,showOperators:!0});function Y1t(e,t){return Z1t(e)||q1t(e,t)||X1t(e,t)||K1t()}function K1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X1t(e,t){if(e){if(typeof e=="string")return OQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OQ(e,t)}}function OQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q1t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Z1t(e){if(Array.isArray(e))return e}var Ove="gt";function J1t(e,t){var r=Y1t(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>i}Hn(Ove,J1t,{name:zW,inputsCount:1,showOperators:!0});function Q1t(e,t){return nCt(e)||rCt(e,t)||tCt(e,t)||eCt()}function eCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tCt(e,t){if(e){if(typeof e=="string")return EQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EQ(e,t)}}function EQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function nCt(e){if(Array.isArray(e))return e}var Eve="gte";function iCt(e,t){var r=Q1t(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>=i}Hn(Eve,iCt,{name:GW,inputsCount:1,showOperators:!0});function aCt(e,t){return uCt(e)||lCt(e,t)||sCt(e,t)||oCt()}function oCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sCt(e,t){if(e){if(typeof e=="string")return RQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RQ(e,t)}}function RQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function uCt(e){if(Array.isArray(e))return e}var Rve="lt";function fCt(e,t){var r=aCt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<i}Hn(Rve,fCt,{name:YW,inputsCount:1,showOperators:!0});function cCt(e,t){return pCt(e)||vCt(e,t)||dCt(e,t)||hCt()}function hCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dCt(e,t){if(e){if(typeof e=="string")return kQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kQ(e,t)}}function kQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function pCt(e){if(Array.isArray(e))return e}var kve="lte";function gCt(e,t){var r=cCt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<=i}Hn(kve,gCt,{name:KW,inputsCount:1,showOperators:!0});function yCt(e,t){return _Ct(e)||wCt(e,t)||bCt(e,t)||mCt()}function mCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bCt(e,t){if(e){if(typeof e=="string")return AQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AQ(e,t)}}function AQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function _Ct(e){if(Array.isArray(e))return e}var Nj="date_after";function SCt(e,t){var r=yCt(t,1),n=r[0],i=ze(e.value,e.meta.dateFormat),a=ze(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)>=0}Hn(Nj,SCt,{name:ZW,inputsCount:1,showOperators:!0});function CCt(e,t){return ECt(e)||OCt(e,t)||TCt(e,t)||xCt()}function xCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TCt(e,t){if(e){if(typeof e=="string")return PQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PQ(e,t)}}function PQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ECt(e){if(Array.isArray(e))return e}var Lj="date_before";function RCt(e,t){var r=CCt(t,1),n=r[0],i=ze(e.value,e.meta.dateFormat),a=ze(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)<=0}Hn(Lj,RCt,{name:JW,inputsCount:1,showOperators:!0});function kCt(e,t){return MCt(e)||ICt(e,t)||PCt(e,t)||ACt()}function ACt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PCt(e,t){if(e){if(typeof e=="string")return IQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IQ(e,t)}}function IQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ICt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function MCt(e){if(Array.isArray(e))return e}var PR="between";function DCt(e,t){var r=kCt(t,2),n=r[0],i=r[1],a=n,o=i;if(e.meta.type==="numeric"){var s=parseFloat(a,10),l=parseFloat(o,10);a=Math.min(s,l),o=Math.max(s,l)}else if(e.meta.type==="date"){var u=yc(Lj,[o]),f=yc(Nj,[a]);return u(e)&&f(e)}return e.value>=a&&e.value<=o}Hn(PR,DCt,{name:XW,inputsCount:2,showOperators:!0});var Ave="not_between";function $Ct(e,t){return!yc(PR,t)(e)}Hn(Ave,$Ct,{name:qW,inputsCount:2,showOperators:!0});function NCt(e,t){return BCt(e)||HCt(e,t)||FCt(e,t)||LCt()}function LCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FCt(e,t){if(e){if(typeof e=="string")return MQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MQ(e,t)}}function MQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function BCt(e){if(Array.isArray(e))return e}var Pve="begins_with";function VCt(e,t){var r=NCt(t,1),n=r[0];return yn(e.value).toLocaleLowerCase(e.meta.locale).startsWith(yn(n))}Hn(Pve,VCt,{name:VW,inputsCount:1,showOperators:!0});var WCt=Ot,Ive=o1,jCt=pl.f,UCt=zd,DQ=Fn,zCt=$4,GCt=ka,YCt=N4,$Q=Ive("".endsWith),KCt=Ive("".slice),XCt=Math.min,Mve=YCt("endsWith"),qCt=!Mve&&!!function(){var e=jCt(String.prototype,"endsWith");return e&&!e.writable}();WCt({target:"String",proto:!0,forced:!qCt&&!Mve},{endsWith:function(t){var r=DQ(GCt(this));zCt(t);var n=arguments.length>1?arguments[1]:void 0,i=r.length,a=n===void 0?i:XCt(UCt(n),i),o=DQ(t);return $Q?$Q(r,o,a):KCt(r,a-o.length,a)===o}});function ZCt(e,t){return txt(e)||ext(e,t)||QCt(e,t)||JCt()}function JCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QCt(e,t){if(e){if(typeof e=="string")return NQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NQ(e,t)}}function NQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ext(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function txt(e){if(Array.isArray(e))return e}var Dve="ends_with";function rxt(e,t){var r=ZCt(t,1),n=r[0];return yn(e.value).toLocaleLowerCase(e.meta.locale).endsWith(yn(n))}Hn(Dve,rxt,{name:WW,inputsCount:1,showOperators:!0});function nxt(e,t){return sxt(e)||oxt(e,t)||axt(e,t)||ixt()}function ixt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function axt(e,t){if(e){if(typeof e=="string")return LQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LQ(e,t)}}function LQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sxt(e){if(Array.isArray(e))return e}var Fj="contains";function lxt(e,t){var r=nxt(t,1),n=r[0];return yn(e.value).toLocaleLowerCase(e.meta.locale).indexOf(yn(n))>=0}Hn(Fj,lxt,{name:jW,inputsCount:1,showOperators:!0});var $ve="not_contains";function uxt(e,t){return!yc(Fj,t)(e)}Hn($ve,uxt,{name:UW,inputsCount:1,showOperators:!0});var Nve="date_tomorrow";function fxt(e){var t=ze(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ze().subtract(-1,"days").startOf("day"),"d"):!1}Hn(Nve,fxt,{name:ej,inputsCount:0});var Lve="date_today";function cxt(e){var t=ze(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ze().startOf("day"),"d"):!1}Hn(Lve,cxt,{name:QW,inputsCount:0});var Fve="date_yesterday";function hxt(e){var t=ze(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(ze().subtract(1,"days").startOf("day"),"d"):!1}Hn(Fve,hxt,{name:tj,inputsCount:0});Vue();function dxt(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var cH=new Set([1]).has(1),vxt=cH&&typeof Array.from=="function";function L1(e){var t=e;return cH&&(t=new Set(t)),function(r){var n;return cH?n=t.has(r):n=!!~t.indexOf(r),n}}function Hve(e){return e??""}function hH(e){var t=e;return vxt?t=Array.from(new Set(t)):t=W4(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function FQ(e,t,r,n){var i=[],a=e===t,o;return a||(o=L1(t)),ue(e,function(s){var l=!1;(a||o(s))&&(l=!0);var u={checked:l,value:s,visualValue:dxt(s,r)};n&&n(u),i.push(u)}),i}function Bve(e,t){return mxt(e)||yxt(e,t)||gxt(e,t)||pxt()}function pxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gxt(e,t){if(e){if(typeof e=="string")return HQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HQ(e,t)}}function HQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function mxt(e){if(Array.isArray(e))return e}var Gh="by_value";function bxt(e,t){var r=Bve(t,1),n=r[0];return n(e.value)}Hn(Gh,bxt,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=Bve(t,1),n=r[0];return[L1(n)]},showOperators:!1});var sS={};function wxt(e){if(!sS[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=sS[e].func;return function(r,n){return t(r,n)}}function _xt(e){return sS[e].name}function Hj(e,t,r){sS[e]={name:t,func:r}}var Jf="conjunction",Sxt=ij;function Cxt(e,t){return e.every(function(r){return r.func(t)})}Hj(Jf,Sxt,Cxt);var IR="disjunction",xxt=_A;function Txt(e,t){return e.some(function(r){return r.func(t)})}Hj(IR,xxt,Txt);var Bj="disjunctionWithExtraCondition",Oxt=_A;function Ext(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}Hj(Bj,Oxt,Ext);function lS(e){return lS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lS(e)}var G0;function wD(e,t,r){return t=Rxt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rxt(e){var t=kxt(e,"string");return lS(t)==="symbol"?t:String(t)}function kxt(e,t){if(lS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Axt="numeric",Vve="text",Pxt="date",BQ=(G0={},wD(G0,Axt,[oi,qt,Kb,PO,qt,Xb,IO,qt,Ove,Eve,Rve,kve,PR,Ave]),wD(G0,Vve,[oi,qt,Kb,PO,qt,Xb,IO,qt,Pve,Dve,qt,Fj,$ve]),wD(G0,Pxt,[oi,qt,Kb,PO,qt,Xb,IO,qt,Lj,Nj,PR,qt,Nve,Lve,Fve]),G0);function Ixt(e){var t=[],r=e;return BQ[r]||(r=Vve),ue(BQ[r],function(n){var i;n===qt?i={name:qt}:i=ta(zh(n)),t.push(i)}),t}function uS(e){return uS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uS(e)}function Mxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$xt(n.key),n)}}function Dxt(e,t,r){return t&&VQ(e.prototype,t),r&&VQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $xt(e){var t=Nxt(e,"string");return uS(t)==="symbol"?t:String(t)}function Nxt(e,t){if(uS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _D="built",SD="building",WQ=["click","input","keydown","keypress","keyup","focus","blur","change"],Wve=function(){function e(t,r){Mxt(this,e),this.hot=t,this.eventManager=new un(this),this.options=$n(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return Dxt(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===SD?this._element:this.buildState===_D?(this.update(),this._element):(this.buildState=SD,this.build(),this.buildState=_D,this._element)}},{key:"isBuilt",value:function(){return this.buildState===_D}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(ua)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(o,s){r.eventManager.addEventListener(o,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=SD),this.options.className&&Ue(this._element,this.options.className),this.options.children.length)ue(this.options.children,function(a){return r._element.appendChild(a.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);Gt(this.options,function(a,o){i[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(i[o]=r.translateIfPossible(a))}),this._element.appendChild(i),ue(WQ,function(a){return n(i,a)})}else ue(WQ,function(a){return n(r._element,a)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return ta({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();Br(Wve,Pa);const Qf=Wve;function Sy(e){return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function Lxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hxt(n.key),n)}}function Fxt(e,t,r){return t&&jQ(e.prototype,t),r&&jQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hxt(e){var t=Bxt(e,"string");return Sy(t)==="symbol"?t:String(t)}function Bxt(e,t){if(Sy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MO(){return typeof Reflect<"u"&&Reflect.get?MO=Reflect.get.bind():MO=function(t,r,n){var i=Vxt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},MO.apply(this,arguments)}function Vxt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cy(e),e!==null););return e}function Wxt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dH(e,t)}function dH(e,t){return dH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dH(e,t)}function jxt(e){var t=zxt();return function(){var n=Cy(e),i;if(t){var a=Cy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Uxt(this,i)}}function Uxt(e,t){if(t&&(Sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jve(e)}function jve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zxt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cy(e){return Cy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cy(e)}var gT=new WeakMap,Gxt=function(e){Wxt(r,e);var t=jxt(r);function r(n,i){var a;return Lxt(this,r),a=t.call(this,n,$n(r.DEFAULTS,i)),gT.set(jve(a),{}),a.registerHooks(),a}return Fxt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(a){return i.onKeyup(a)})}},{key:"build",value:function(){MO(Cy(r.prototype),"build",this).call(this);var i=gT.get(this),a=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,Ue(this._element,"htUIInput"),Ue(a,"htUIInputIcon"),this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=gT.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&gT.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return ta({placeholder:"",type:"text",tagName:"input"})}}]),r}(Qf);const Wp=Gxt;function xy(e){return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function Yxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xxt(n.key),n)}}function Kxt(e,t,r){return t&&UQ(e.prototype,t),r&&UQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xxt(e){var t=qxt(e,"string");return xy(t)==="symbol"?t:String(t)}function qxt(e,t){if(xy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jp(){return typeof Reflect<"u"&&Reflect.get?jp=Reflect.get.bind():jp=function(t,r,n){var i=Zxt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},jp.apply(this,arguments)}function Zxt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ec(e),e!==null););return e}function Jxt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vH(e,t)}function vH(e,t){return vH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vH(e,t)}function Qxt(e){var t=tTt();return function(){var n=ec(e),i;if(t){var a=ec(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return eTt(this,i)}}function eTt(e,t){if(t&&(xy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uve(e)}function Uve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ec(e){return ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ec(e)}var yT=new WeakMap,rTt=function(e){Jxt(r,e);var t=Qxt(r);function r(n,i){var a;return Yxt(this,r),a=t.call(this,n,$n(r.DEFAULTS,i)),yT.set(Uve(a),{}),a.menu=null,a.items=[],a.registerHooks(),a}return Kxt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var a=this;return ue(i,function(o){o.name=a.translateIfPossible(o.name)}),i}},{key:"build",value:function(){var i=this;jp(ec(r.prototype),"build",this).call(this),this.menu=new Dj(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var a=new Qf(this.hot,{className:"htUISelectCaption"}),o=new Qf(this.hot,{className:"htUISelectDropdown"}),s=yT.get(this);s.caption=a,s.captionElement=a.element,s.dropdown=o,ue([a,o],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(wA),yT.get(this).captionElement.textContent=i,jp(ec(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==qt&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=yT.get(this),a=i.caption,o=i.dropdown;a&&a.destroy(),o&&o.destroy(),jp(ec(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return ta({className:"htUISelect",wrapIt:!1})}}]),r}(Qf);const zQ=rTt;function Ty(e){return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function nTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aTt(n.key),n)}}function iTt(e,t,r){return t&&GQ(e.prototype,t),r&&GQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aTt(e){var t=oTt(e,"string");return Ty(t)==="symbol"?t:String(t)}function oTt(e,t){if(Ty(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DO(){return typeof Reflect<"u"&&Reflect.get?DO=Reflect.get.bind():DO=function(t,r,n){var i=sTt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},DO.apply(this,arguments)}function sTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Oy(e),e!==null););return e}function lTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pH(e,t)}function pH(e,t){return pH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pH(e,t)}function uTt(e){var t=hTt();return function(){var n=Oy(e),i;if(t){var a=Oy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fTt(this,i)}}function fTt(e,t){if(t&&(Ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cTt(e)}function cTt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oy(e){return Oy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oy(e)}var dTt=function(e){lTt(r,e);var t=uTt(r);function r(n,i){var a;return nTt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.addSeparator=i.addSeparator,a.elements.push(new zQ(a.hot,{menuContainer:i.menuContainer})),a.elements.push(new Wp(a.hot,{placeholder:fj})),a.elements.push(new Wp(a.hot,{placeholder:cj})),a.registerHooks(),a}return iTt(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(a){return i.onConditionSelect(a)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),ue(this.getInputElements(),function(a){a.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})})}},{key:"setState",value:function(i){var a=this;if(this.reset(),!!i){var o=ta(i.command);o.name.startsWith(bn)&&(o.name=this.hot.getTranslatedPhrase(o.name)),this.getSelectElement().setValue(o),ue(i.args,function(s,l){if(l>o.inputsCount-1)return!1;var u=a.getInputElement(l);u.setValue(s),u[o.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||zh(oi),a=[];return ue(this.getInputElements(),function(o,s){i.inputsCount>s&&a.push(o.getValue())}),{command:i,args:a}}},{key:"updateState",value:function(i,a){var o=zh(i?i.name:oi);this.state.setValueAtIndex(a,{command:o,args:i?i.args:[]}),i||ue(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof zQ})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof Wp})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){Ue(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&Ue(s.parentNode,"border");var h=i.hot.rootDocument.createElement("div");return Ue(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ue(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),a=[zh(oi)];if(i!==null){var o=i.visualIndex;a=Ixt(this.hot.getDataType(0,o,this.hot.countRows(),o))}ue(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(a),DO(Oy(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(a[0])}},{key:"onConditionSelect",value:function(i){ue(this.getInputElements(),function(a,o){a[i.inputsCount>o?"show":"hide"](),o===0&&setTimeout(function(){return a.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){hg(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),Es(i)):hg(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Es(i))}}]),r}(LA);const CD=dTt;function Ey(e){return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ey(e)}function vTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gTt(n.key),n)}}function pTt(e,t,r){return t&&YQ(e.prototype,t),r&&YQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gTt(e){var t=yTt(e,"string");return Ey(t)==="symbol"?t:String(t)}function yTt(e,t){if(Ey(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ey(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $O(){return typeof Reflect<"u"&&Reflect.get?$O=Reflect.get.bind():$O=function(t,r,n){var i=mTt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},$O.apply(this,arguments)}function mTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ry(e),e!==null););return e}function bTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gH(e,t)}function gH(e,t){return gH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gH(e,t)}function wTt(e){var t=STt();return function(){var n=Ry(e),i;if(t){var a=Ry(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _Tt(this,i)}}function _Tt(e,t){if(t&&(Ey(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zve(e)}function zve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function STt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ry(e){return Ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ry(e)}var mT=new WeakMap,CTt=function(e){bTt(r,e);var t=wTt(r);function r(n,i){var a;return vTt(this,r),a=t.call(this,n,$n(r.DEFAULTS,i)),mT.set(zve(a),{}),a}return pTt(r,[{key:"build",value:function(){$O(Ry(r.prototype),"build",this).call(this);var i=mT.get(this);i.input=this._element.firstChild;var a=this.hot.rootDocument.createElement("label");a.textContent=this.translateIfPossible(this.options.label.textContent),a.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=a,this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=mT.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&mT.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return ta({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(Qf);const KQ=CTt;function ky(e){return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}var XQ;function xTt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function TTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ETt(n.key),n)}}function OTt(e,t,r){return t&&qQ(e.prototype,t),r&&qQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ETt(e){var t=RTt(e,"string");return ky(t)==="symbol"?t:String(t)}function RTt(e,t){if(ky(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yH(e,t)}function yH(e,t){return yH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yH(e,t)}function ATt(e){var t=MTt();return function(){var n=MR(e),i;if(t){var a=MR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return PTt(this,i)}}function PTt(e,t){if(t&&(ky(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ITt(e)}function ITt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function MR(e){return MR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},MR(e)}var ZQ=0,DTt=function(e){kTt(r,e);var t=ATt(r);function r(n,i){var a;return TTt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.buildOperatorsElement(),a}return OTt(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return Ue(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||ue(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,a=[Jf,IR];ue(a,function(o){var s=new KQ(i.hot,{name:"operator",label:{htmlFor:o,textContent:_xt(o)},value:o,checked:o===a[ZQ],id:o});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(Ir(XQ||(XQ=xTt(["Radio button with index "," doesn't exist."])),i));ue(this.elements,function(a,o){a.setChecked(o===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(a){return a instanceof KQ&&a.isChecked()});return i?i.getValue():Jf}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&ue(this.elements,function(a){a.setChecked(a.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jf,a=arguments.length>1?arguments[1]:void 0,o=i;o===Bj&&(o=IR),this.state.setValueAtIndex(a,o)}},{key:"reset",value:function(){this.setChecked(ZQ)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(LA);const $Tt=DTt;var NTt=Yt,LTt=ka,JQ=Fn,FTt=/"/g,HTt=NTt("".replace),BTt=function(e,t,r,n){var i=JQ(LTt(e)),a="<"+t;return r!==""&&(a+=" "+r+'="'+HTt(JQ(n),FTt,"&quot;")+'"'),a+">"+i+"</"+t+">"},VTt=Lt,WTt=function(e){return VTt(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},jTt=Ot,UTt=BTt,zTt=WTt;jTt({target:"String",proto:!0,forced:zTt("link")},{link:function(t){return UTt(this,"a","href",t)}});function Ay(e){return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function GTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KTt(n.key),n)}}function YTt(e,t,r){return t&&QQ(e.prototype,t),r&&QQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KTt(e){var t=XTt(e,"string");return Ay(t)==="symbol"?t:String(t)}function XTt(e,t){if(Ay(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NO(){return typeof Reflect<"u"&&Reflect.get?NO=Reflect.get.bind():NO=function(t,r,n){var i=qTt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},NO.apply(this,arguments)}function qTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Py(e),e!==null););return e}function ZTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mH(e,t)}function mH(e,t){return mH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mH(e,t)}function JTt(e){var t=eOt();return function(){var n=Py(e),i;if(t){var a=Py(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return QTt(this,i)}}function QTt(e,t){if(t&&(Ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gve(e)}function Gve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Py(e){return Py=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Py(e)}var xD=new WeakMap,tOt=function(e){ZTt(r,e);var t=JTt(r);function r(n,i){var a;return GTt(this,r),a=t.call(this,n,$n(r.DEFAULTS,i)),xD.set(Gve(a),{}),a}return YTt(r,[{key:"build",value:function(){NO(Py(r.prototype),"build",this).call(this);var i=xD.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(xD.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return ta({href:"#",tagName:"a"})}}]),r}(Qf);const eee=tOt;function Iy(e){return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}function tee(e){return aOt(e)||iOt(e)||nOt(e)||rOt()}function rOt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nOt(e,t){if(e){if(typeof e=="string")return bH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bH(e,t)}}function iOt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aOt(e){if(Array.isArray(e))return bH(e)}function bH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ree(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lOt(n.key),n)}}function sOt(e,t,r){return t&&ree(e.prototype,t),r&&ree(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lOt(e){var t=uOt(e,"string");return Iy(t)==="symbol"?t:String(t)}function uOt(e,t){if(Iy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Up(){return typeof Reflect<"u"&&Reflect.get?Up=Reflect.get.bind():Up=function(t,r,n){var i=fOt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Up.apply(this,arguments)}function fOt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tc(e),e!==null););return e}function cOt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wH(e,t)}function wH(e,t){return wH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wH(e,t)}function hOt(e){var t=vOt();return function(){var n=tc(e),i;if(t){var a=tc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dOt(this,i)}}function dOt(e,t){if(t&&(Iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yve(e)}function Yve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tc(e){return tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tc(e)}var pOt=new WeakMap,gOt="multipleSelect.itemBox",yOt=function(e){cOt(r,e);var t=hOt(r);function r(n,i){var a;return oOt(this,r),a=t.call(this,n,$n(r.DEFAULTS,i)),pOt.set(Yve(a),{}),a.searchInput=new Wp(a.hot,{placeholder:uj,className:"htUIMultipleSelectSearch"}),a.selectAllUI=new eee(a.hot,{textContent:aj,className:"htUISelectAll"}),a.clearAllUI=new eee(a.hot,{textContent:oj,className:"htUIClearAll"}),a.items=[],a.itemsBox=null,a.registerHooks(),a}return sOt(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)}),this.searchInput.addLocalHook("input",function(a){return i.onInput(a)}),this.selectAllUI.addLocalHook("click",function(a){return i.onSelectAllClick(a)}),this.clearAllUI.addLocalHook("click",function(a){return i.onClearAllClick(a)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return tee(this.items)}},{key:"getValue",value:function(){return bOt(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;Up(tc(r.prototype),"build",this).call(this);var a=this.hot.rootDocument,o=a.createElement("div"),s=new Qf(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(o);var l=function(f){if(i._element){i.itemsBox&&i.itemsBox.destroy(),Ue(f,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(f,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,g,y,b,w,_){v.title=_.instance.getDataAtRowProp(g,_.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-ei(a)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var c=i.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){i.runLocalHooks("keydown",v,i)},group:gOt})}};l(o),setTimeout(function(){return l(o)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(mOt(this.items,this.options.value)),Up(tc(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Up(tc(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var a=this,o=i.target.value.toLocaleLowerCase(this.getLocale()),s;o===""?s=tee(this.items):s=qa(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(a.getLocale()).indexOf(o)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var a=wV(hg,i.keyCode);a("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Es(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var a=[];i.preventDefault(),ue(this.itemsBox.getSourceData(),function(o,s){o.checked=!0,a.push(QL(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}},{key:"onClearAllClick",value:function(i){var a=[];i.preventDefault(),ue(this.itemsBox.getSourceData(),function(o,s){o.checked=!1,a.push(QL(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}}],[{key:"DEFAULTS",get:function(){return ta({className:"htUIMultipleSelect",value:[]})}}]),r}(Qf);const nee=yOt;function mOt(e,t){var r=L1(t);return Ut(e,function(n){return n.checked=r(n.value),n})}function bOt(e){var t=[];return ue(e,function(r){r.checked&&t.push(r.value)}),t}function My(e){return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},My(e)}function wOt(e,t){return xOt(e)||COt(e,t)||SOt(e,t)||_Ot()}function _Ot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SOt(e,t){if(e){if(typeof e=="string")return iee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iee(e,t)}}function iee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function COt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function xOt(e){if(Array.isArray(e))return e}function TOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EOt(n.key),n)}}function OOt(e,t,r){return t&&aee(e.prototype,t),r&&aee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EOt(e){var t=ROt(e,"string");return My(t)==="symbol"?t:String(t)}function ROt(e,t){if(My(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(My(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LO(){return typeof Reflect<"u"&&Reflect.get?LO=Reflect.get.bind():LO=function(t,r,n){var i=kOt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},LO.apply(this,arguments)}function kOt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Dy(e),e!==null););return e}function AOt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_H(e,t)}function _H(e,t){return _H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_H(e,t)}function POt(e){var t=DOt();return function(){var n=Dy(e),i;if(t){var a=Dy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return IOt(this,i)}}function IOt(e,t){if(t&&(My(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MOt(e)}function MOt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dy(e){return Dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dy(e)}var $Ot=function(e){AOt(r,e);var t=POt(r);function r(n,i){var a;return TOt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.elements.push(new nee(a.hot)),a.registerHooks(),a}return OOt(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===Gh){var a=this.getMultipleSelectElement();a.setItems(i.itemsSnapshot),a.setValue(i.args[0]),a.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),a=i.getItems();return{command:{key:i.isSelectedAllValues()||!a.length?oi:Gh},args:[i.getValue()],itemsSnapshot:a}}},{key:"updateState",value:function(i){var a=this,o=function(l,u,f,c,h){var d=qa(u,function(O){return O.name===Gh}),v=wOt(d,1),g=v[0],y={},b=a.hot.getTranslatedPhrase(bR);if(g){var w=hH(Ut(c(l,h),function(O){return O.value}));f&&(g.args[0]=f);var _=[],x=FQ(w,g.args[0],b,function(O){O.checked&&_.push(O.value)}),T=i.editedConditionStack.column;y.locale=a.hot.getCellMeta(0,T).locale,y.args=[_],y.command=zh(Gh),y.itemsSnapshot=x}else y.args=[],y.command=zh(oi);a.state.setValueAtIndex(l,y)};o(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&o(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof nee})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){Ue(s.parentNode,"htFiltersMenuValue");var h=i.hot.rootDocument.createElement("div");return Ue(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ue(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(bR),a=hH(this._getColumnVisibleValues()),o=FQ(a,a,i);this.getMultipleSelectElement().setItems(o),LO(Dy(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(a);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){hg(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Es(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:Ut(this.hot.getDataAtCol(i.visualIndex),function(a){return Hve(a)})}}]),r}(LA);const NOt=$Ot;function $y(e){return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(e)}function LOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HOt(n.key),n)}}function FOt(e,t,r){return t&&oee(e.prototype,t),r&&oee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HOt(e){var t=BOt(e,"string");return $y(t)==="symbol"?t:String(t)}function BOt(e,t){if($y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VOt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SH(e,t)}function SH(e,t){return SH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SH(e,t)}function WOt(e){var t=zOt();return function(){var n=DR(e),i;if(t){var a=DR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return jOt(this,i)}}function jOt(e,t){if(t&&($y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UOt(e)}function UOt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function DR(e){return DR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DR(e)}var GOt=function(e){VOt(r,e);var t=WOt(r);function r(n,i){var a;return LOt(this,r),a=t.call(this,n,{id:i.id,stateless:!0}),a.name=i.name,a.elements.push(new Wp(a.hot,{type:"button",value:sj,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),a.elements.push(new Wp(a.hot,{type:"button",value:lj,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),a.registerHooks(),a}return FOt(r,[{key:"registerHooks",value:function(){var i=this;ue(this.elements,function(a){a.addLocalHook("click",function(o,s){return i.onButtonClick(o,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return Ue(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||ue(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,a){a.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(LA);const YOt=GOt;function fS(e){return fS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fS(e)}var see,lee;function uee(e,t){return ZOt(e)||qOt(e,t)||XOt(e,t)||KOt()}function KOt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XOt(e,t){if(e){if(typeof e=="string")return fee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fee(e,t)}}function fee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qOt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ZOt(e){if(Array.isArray(e))return e}function cee(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function JOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eEt(n.key),n)}}function QOt(e,t,r){return t&&hee(e.prototype,t),r&&hee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eEt(e){var t=tEt(e,"string");return fS(t)==="symbol"?t:String(t)}function tEt(e,t){if(fS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dee="ConditionCollection.filteringStates",Kve=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;JOt(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new bA,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(dee,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return QOt(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,a=this.filteringStates.getValueAtIndex(n),o=(i=a==null?void 0:a.conditions)!==null&&i!==void 0?i:[],s=a==null?void 0:a.operation;return this.isMatchInConditions(o,r,s)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jf;return r.length?wxt(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jf,a=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,r).locale,s=Ut(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(o):c}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==i)throw Error(Ir(see||(see=cee(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(Lr(sS[i]))throw new Error(Ir(lee||(lee=cee(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:l,args:s,func:yc(l,s)}]},a):f.push({name:l,args:s,func:yc(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=uee(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return On(this.filteringStates.getEntries(),function(r,n){var i=uee(n,2),a=i[0],o=i[1],s=o.operation,l=o.conditions;return r.push({column:a,operation:s,conditions:Ut(l,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),ue(r,function(i){ue(i.conditions,function(a){return n.addCondition(i.column,a)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(a){return a.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(dee),this.filteringStates=null,this.clearLocalHooks()}}]),e}();Br(Kve,Pa);const Xve=Kve;function cS(e){return cS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cS(e)}function rEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iEt(n.key),n)}}function nEt(e,t,r){return t&&vee(e.prototype,t),r&&vee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iEt(e){var t=aEt(e,"string");return cS(t)==="symbol"?t:String(t)}function aEt(e,t){if(cS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oEt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};rEt(this,e),this.conditionCollection=t,this.columnDataFactory=r}return nEt(e,[{key:"filter",value:function(){var r=this,n=[];return ue(this.conditionCollection.getFilteredColumns(),function(i,a){var o=r.columnDataFactory(i);a&&(o=r._getIntersectData(o,n)),n=r.filterByColumn(i,o)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[];return ue(i,function(o){o!==void 0&&n.conditionCollection.isMatch(o,r)&&a.push(o)}),a}},{key:"_getIntersectData",value:function(r,n){var i=[];return ue(n,function(a){var o=a.meta.visualRow;r[o]!==void 0&&(i[o]=r[o])}),i}}]),e}();const qve=oEt;function hS(e){return hS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hS(e)}function sEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uEt(n.key),n)}}function lEt(e,t,r){return t&&pee(e.prototype,t),r&&pee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uEt(e){var t=fEt(e,"string");return hS(t)==="symbol"?t:String(t)}function fEt(e,t){if(hS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zve=function(){function e(t,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};sEt(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(a){return n._onConditionBeforeModify(a)}),this.conditionCollection.addLocalHook("afterRemove",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("afterAdd",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return lEt(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,ue(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var a=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(r);o===-1&&(o=this.latestEditedColumnPosition);var s=a.slice(0,o),l=a.slice(o);l.length&&l[0].column===r&&l.shift();var u=cce(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new Xve(i.hot,!1),g=[].concat(c,d);v.importAllConditions(g);var y=i.columnDataFactory(h),b;v.isEmpty()?b=y:b=new qve(v,function(_){return i.columnDataFactory(_)}).filter(),b=Ut(b,function(_){return _.meta.visualRow});var w=L1(b);return v.destroy(),qa(y,function(_){return w(_.meta.visualRow)})})(s),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;ue(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),Gt(this,function(n,i){r[i]=null})}}]),e}();Br(Zve,Pa);const cEt=Zve;function Ny(e){return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ny(e)}var gee;function hEt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function dEt(e,t){return yEt(e)||gEt(e,t)||pEt(e,t)||vEt()}function vEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pEt(e,t){if(e){if(typeof e=="string")return yee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yee(e,t)}}function yee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gEt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function yEt(e){if(Array.isArray(e))return e}function mEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wEt(n.key),n)}}function bEt(e,t,r){return t&&mee(e.prototype,t),r&&mee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wEt(e){var t=_Et(e,"string");return Ny(t)==="symbol"?t:String(t)}function _Et(e,t){if(Ny(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ny(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zp(){return typeof Reflect<"u"&&Reflect.get?zp=Reflect.get.bind():zp=function(t,r,n){var i=SEt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},zp.apply(this,arguments)}function SEt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=rc(e),e!==null););return e}function CEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CH(e,t)}function CH(e,t){return CH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CH(e,t)}function xEt(e){var t=OEt();return function(){var n=rc(e),i;if(t){var a=rc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return TEt(this,i)}}function TEt(e,t){if(t&&(Ny(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jve(e)}function Jve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rc(e){return rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rc(e)}var bee="filters",EEt=250,REt=function(e){CEt(r,e);var t=xEt(r);function r(n){var i;return mEt(this,r),i=t.call(this,n),i.eventManager=new un(Jve(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return bEt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bee]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new k1),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var a=this.hot.getSettings().dropdownMenu,o=a&&a.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return i.onComponentChange(d,v)}),d},l=function(){return"".concat(i.hot.getTranslatedPhrase(rj),":")},u=function(){return"".concat(i.hot.getTranslatedPhrase(nj),":")};if(!this.components.get("filter_by_condition")){var f=new CD(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:o});f.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new $Tt(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new CD(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:o});c.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new NOt(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new YOt(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Xve(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new cEt(this.hot,this.conditionCollection,function(h){return i.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return i.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return i.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return i.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return i.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),zp(rc(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var a;(a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(o,s){o.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}zp(rc(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Jf,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:a},args:o},s)}},{key:"removeConditions",value:function(i){var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}}},{key:"filter",value:function(){var i=this,a=this._createDataFilter(),o=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(o){var f=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=Ut(a.filter(),function(h){return h.meta.visualRow});var c=L1(s);yt(i.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),ue(f,function(h){i.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return a?{visualIndex:a.col,physicalIndex:this.hot.toPhysicalColumn(a.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var a=this,o=this.hot.toVisualColumn(i),s=[];return ue(this.hot.getSourceDataAtCol(o),function(l,u){var f,c=a.hot.getCellMeta(u,o),h=c.row,d=c.col,v=c.visualCol,g=c.visualRow,y=c.type,b=c.instance,w=c.dateFormat,_=c.locale,x=(f=a.hot.getDataAtCell(a.hot.toVisualRow(u),o))!==null&&f!==void 0?f:l;s.push({meta:{row:h,col:d,visualCol:v,visualRow:g,type:y,instance:b,dateFormat:w,locale:_},value:Hve(x)})}),s}},{key:"onAfterChange",value:function(i){var a=this;i&&ue(i,function(o){var s=dEt(o,2),l=s[1],u=a.hot.propToCol(l);a.conditionCollection.hasConditions(u)&&a.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(i){var a=this.hot.getDataAtCol(i),o=hH(a);this.conditionUpdateObserver.updateStatesAtColumn(i,o)}},{key:"restoreComponents",value:function(i){var a,o=(a=this.getSelectedColumn())===null||a===void 0?void 0:a.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(o)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:qt}),this.components.forEach(function(a){i.items.push(a.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,a,o,s){var l=i;return l===IR&&a.command.key!==oi&&o.command.key!==oi&&s.command.key!==oi?l=Bj:s.command.key!==oi&&(a.command.key===oi||o.command.key===oi)&&(l=Jf),l}},{key:"onActionBarSubmit",value:function(i){var a;if(i==="accept"){var o=this.getSelectedColumn();if(o===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=o.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(l);d===-1&&(d=void 0),this.conditionCollection.removeConditions(l),u.command.key!==oi&&(this.conditionCollection.addCondition(l,u,h,d),f.command.key!==oi&&this.conditionCollection.addCondition(l,f,h,d)),c.command.key!==oi&&this.conditionCollection.addCondition(l,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(a=this.dropdownMenuPlugin)===null||a===void 0||a.close()}},{key:"onComponentChange",value:function(i,a){this.updateDependentComponentsVisibility(),i.constructor===CD&&!a.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),a=i.getState(),o=a.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];o.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,a){var o=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(o)?Ue(a,"htFiltersActive"):Mt(a,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new qve(a,function(o){return i.getDataMapAtColumn(o)})}},{key:"updateComponents",value:function(i){var a;if((a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled){var o=i.editedConditionStack,s=o.conditions,l=o.column,u=s.filter(function(h){return h.name===Gh}),f=s.filter(function(h){return h.name!==Gh});if(u.length>=2||f.length>=3)Fr(Ir(gee||(gee=hEt([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(f[0],l),this.components.get("filter_by_condition2").updateState(f[1],l),this.components.get("filter_operators").updateState(c,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var a=this.dropdownMenuPlugin.menu,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return ue(s,function(u){ue(a.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&i.push(c)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var a=this.dropdownMenuPlugin.menu,o=a.hotMenu,s=o.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);i?s.showRows(c):s.hideRows(c),o.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!1].concat(a))}},{key:"showComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!0].concat(a))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(a,o){a!==null&&(a.destroy(),i.components.set(o,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),zp(rc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bee}},{key:"PLUGIN_PRIORITY",get:function(){return EEt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(wr);function dS(e){return dS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dS(e)}function wee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wee(Object(r),!0).forEach(function(n){kEt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wee(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kEt(e,t,r){return t=AEt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AEt(e){var t=PEt(e,"string");return dS(t)==="symbol"?t:String(t)}function PEt(e,t){if(dS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qve="internal-use-in-handsontable",IEt={licenseKey:Qve,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function epe(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[Zi])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function tpe(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function MEt(e){var t,r=e[Zi],n=tpe(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=epe(e);return qb(qb(qb({},IEt),n),i)}function DEt(e){var t,r=e[Zi],n=tpe(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=epe(e);return qb(qb({},n),i)}function xH(e){return xH=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xH(e)}function FA(){var e="engine_relationship",t=zo(Zi);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function Vj(){var e="shared_engine_usage",t=zo(Zi);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function $Et(e){var t=e.getSettings(),r=t[Zi],n=r==null?void 0:r.engine;if(r===!0||Lr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return NEt((i=n.hyperformula)!==null&&i!==void 0?i:n,t,e)}else if(xH(n)==="object"&&Lr(n.hyperformula)){var a=FA(),o=Vj().get(n);return a.has(n)||a.set(n,[]),a.get(n).push(e),o&&o.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Qve}),n}return null}function NEt(e,t,r){var n=t[Zi],i=MEt(t),a=FA(),o=Vj();LEt(e,n.functions),FEt(e,n.language);var s=e.buildEmpty(i);return a.set(s,[r]),o.set(s,[r.guid]),HEt(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function _ee(e){var t,r=FA(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function See(e,t){if(e){var r=FA(),n=r.get(e),i=Vj(),a=i.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),a&&a.includes(t.guid)&&(a.splice(a.indexOf(t.guid),1),a.length===0&&(i.delete(e),e.destroy()))}}function LEt(e,t){t&&t.forEach(function(r){var n=r.name,i=r.plugin,a=r.translations;try{e.registerFunction(n,i,a)}catch(o){Fr(o.message)}})}function FEt(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){Fr(n.message)}}}function HEt(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,i=r.expression,a=r.scope,o=r.options;try{e.addNamedExpression(n,i,a,o)}catch(s){Fr(s.message)}}),e.resumeEvaluation())}function BEt(e,t){return(Lr(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function rpe(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function VEt(e){return rpe(e)?e.substr(1):e}function WEt(e){return zEt(e)||UEt(e)||npe(e)||jEt()}function jEt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UEt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zEt(e){if(Array.isArray(e))return TH(e)}function Cee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cee(Object(r),!0).forEach(function(n){FO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cee(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mc(e){return mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(e)}function rp(e,t){return KEt(e)||YEt(e,t)||npe(e,t)||GEt()}function GEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function npe(e,t){if(e){if(typeof e=="string")return TH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TH(e,t)}}function TH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function YEt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function KEt(e){if(Array.isArray(e))return e}function XEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ipe(n.key),n)}}function qEt(e,t,r){return t&&Tee(e.prototype,t),r&&Tee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yh(){return typeof Reflect<"u"&&Reflect.get?Yh=Reflect.get.bind():Yh=function(t,r,n){var i=ZEt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Yh.apply(this,arguments)}function ZEt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cu(e),e!==null););return e}function JEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OH(e,t)}function OH(e,t){return OH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OH(e,t)}function QEt(e){var t=tRt();return function(){var n=cu(e),i;if(t){var a=cu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return eRt(this,i)}}function eRt(e,t){if(t&&(mc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ch(e)}function Ch(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tRt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cu(e){return cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cu(e)}function FO(e,t,r){return t=ipe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ipe(e){var t=rRt(e,"string");return mc(t)==="symbol"?t:String(t)}function rRt(e,t){if(mc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TD(e,t,r){nRt(e,t),t.set(e,r)}function nRt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function np(e,t,r){var n=ape(e,t,"set");return iRt(e,n,r),r}function iRt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function ip(e,t){var r=ape(e,t,"get");return aRt(e,r)}function ape(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function aRt(e,t){return t.get?t.get.call(e):t.value}var Zi="formulas",oRt=260,Oee="row_move";ft.getSingleton().register("afterNamedExpressionAdded");ft.getSingleton().register("afterNamedExpressionRemoved");ft.getSingleton().register("afterSheetAdded");ft.getSingleton().register("afterSheetRemoved");ft.getSingleton().register("afterSheetRenamed");ft.getSingleton().register("afterFormulasValuesUpdate");var ap=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},yh=new WeakMap,OD=new WeakMap,Y0=new WeakMap,sRt=function(e){JEt(r,e);var t=QEt(r);function r(){var n;XEt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),TD(Ch(n),yh,{writable:!0,value:!1}),TD(Ch(n),OD,{writable:!0,value:!1}),TD(Ch(n),Y0,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),FO(Ch(n),"staticRegister",zo("formulas")),FO(Ch(n),"engine",null),FO(Ch(n),"sheetName",null),n}return qEt(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zi]}},{key:"enablePlugin",value:function(){var i,a=this;if(!this.enabled){if(this.engine=(i=$Et(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){Fr("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var o=this.addSheet(this.sheetName,this.hot.getSourceDataArray());o!==!1&&(this.sheetName=o)}this.addHook("beforeLoadData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterLoadData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("beforeUpdateData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterUpdateData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("modifyData",function(){return a.onModifyData.apply(a,arguments)}),this.addHook("modifySourceData",function(){return a.onModifySourceData.apply(a,arguments)}),this.addHook("beforeValidate",function(){return a.onBeforeValidate.apply(a,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return a.onAfterSetSourceDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtCell",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("beforeCreateRow",function(){return a.onBeforeCreateRow.apply(a,arguments)}),this.addHook("beforeCreateCol",function(){return a.onBeforeCreateCol.apply(a,arguments)}),this.addHook("afterCreateRow",function(){return a.onAfterCreateRow.apply(a,arguments)}),this.addHook("afterCreateCol",function(){return a.onAfterCreateCol.apply(a,arguments)}),this.addHook("beforeRemoveRow",function(){return a.onBeforeRemoveRow.apply(a,arguments)}),this.addHook("beforeRemoveCol",function(){return a.onBeforeRemoveCol.apply(a,arguments)}),this.addHook("afterRemoveRow",function(){return a.onAfterRemoveRow.apply(a,arguments)}),this.addHook("afterRemoveCol",function(){return a.onAfterRemoveCol.apply(a,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==Oee&&a.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==Oee&&a.engine.redo()}),this.addHook("afterDetachChild",function(){return a.onAfterDetachChild.apply(a,arguments)}),this.addHook("beforeAutofill",function(){return a.onBeforeAutofill.apply(a,arguments)}),ip(this,Y0).forEach(function(s){var l=rp(s,2),u=l[0],f=l[1];return a.engine.on(u,f)}),Yh(cu(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;ip(this,Y0).forEach(function(a){var o=rp(a,2),s=o[0],l=o[1];return i.engine.off(s,l)}),See(this.engine,this.hot),this.engine=null,Yh(cu(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(DEt(this.hot.getSettings()));var a=this.hot.getSettings()[Zi];if(lt(a)&&lt(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!i.data&&this.sheetName===null){var o=this.hot.getSettings()[Zi].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}Yh(cu(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;ip(this,Y0).forEach(function(a){var o,s=rp(a,2),l=s[0],u=s[1];return(o=i.engine)===null||o===void 0?void 0:o.off(l,u)}),np(this,Y0,null),See(this.engine,this.hot),this.engine=null,Yh(cu(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,a,o,s,l){return!l&&i>=o?s+(i-o):a}},{key:"toPhysicalRowPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),a)}},{key:"toPhysicalColumnPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),a)}},{key:"addSheet",value:function(i,a){if(lt(a)&&!Ihe(a))return Fr("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return Fr("Sheet with the provided name already exists."),!1;try{var o=this.engine.addSheet(i??void 0);return a&&this.engine.setSheetContent(this.engine.getSheetId(o),a),o}catch(s){return Fr(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){_V("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var a=this.engine.getSheetSerialized(this.sheetId);a.length>0&&this.hot.loadData(a,"".concat(Oa(Zi),".switchSheet"))}},{key:"getCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s!==null&&l!==null?this.engine.getCellType({sheet:o,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:o,row:s,col:l})}},{key:"renderDependentSheets",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var u,f=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(s.has(f)||s.add(f))}),_ee(this.engine).forEach(function(l,u){if((o||u!==a.sheetId)&&s.has(u)){var f;l.render(),(f=l.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,g=h.sheet;return lt(g)?"".concat(g,":").concat(d,"x").concat(v):""},l=new Set(o.map(function(u){return s(u)}));i.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col,g=lt(d)?a.hot.toVisualRow(d):null,y=lt(v)?a.hot.toVisualColumn(v):null;if(!(g===null||y===null)){var b=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,w=s(u);if(b!==void 0&&!l.has(w)){var _=_ee(a.engine).get(b);if(!_)return;_.validateCell(_.getDataAtCell(g,y),_.getCellMeta(g,y),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,a,o){var s={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(a),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){Fr("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,o)}},{key:"onBeforeValidate",value:function(i,a,o){var s=this.hot.propToCol(o);if(this.isFormulaCellType(a,s)){var l={row:this.hot.toPhysicalRow(a),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return mc(u)==="object"&&u!==null?u.value:u}return i}},{key:"onBeforeAutofill",value:function(i,a,o){var s=this,l=function(h){return xee(xee({},h),{},{sheet:s.sheetId})},u={start:l(a.getTopStartCorner()),end:l(a.getBottomEndCorner())},f={start:l(o.getTopStartCorner()),end:l(o.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(f)===!1?!1:this.engine.getFillRangeData(u,f)}},{key:"onBeforeLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";o.includes(Oa(Zi))||np(this,OD,Lr(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!o.includes(Oa(Zi)))if(this.sheetName=BEt(this.engine,this.hot.getSettings()[Zi].sheetName),ip(this,OD))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){np(this,yh,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),np(this,yh,!1)}}}},{key:"onModifyData",value:function(i,a,o,s){if(!(s!=="get"||ip(this,yh)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.isFormulaCellType(l,a);if(!u){var f=this.getCellType(l,a);if(f!=="ARRAY"){rpe(o.value)&&(o.value=VEt(o.value));return}}var c={row:i,col:this.toPhysicalColumnPosition(a),sheet:this.sheetId},h=this.engine.getCellValue(c),d=mc(h)==="object"&&h!==null?h.value:h;o.value=d}}},{key:"onModifySourceData",value:function(i,a,o,s){if(!(s!=="get"||ip(this,yh)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.hot.propToCol(a),f=this.isFormulaCellType(l,u);if(!f){var c=this.getCellType(l,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:i,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};o.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(i,a){var o=this;if(!ap(a)){var s=[],l=[],u=this.engine.batch(function(){i.forEach(function(f){var c=rp(f,4),h=c[0],d=c[1],v=c[3],g=o.hot.propToCol(d),y=o.hot.toPhysicalRow(h),b=o.hot.toPhysicalColumn(g),w={row:y,col:b,sheet:o.sheetId};y!==null&&b!==null?o.syncChangeWithEngine(h,g,v):s.push([h,g,v]),l.push({address:w})})});s.length&&this.hot.addHookOnce("afterChange",function(){var f=o.engine.batch(function(){s.forEach(function(c){var h=rp(c,3),d=h[0],v=h[1],g=h[2];o.syncChangeWithEngine(d,v,g)})});o.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,a){var o=this;if(!ap(a)){var s=[],l=[];i.forEach(function(u){var f=rp(u,4),c=f[0],h=f[1],d=f[3],v=o.hot.propToCol(h);if(ja(v)){var g={row:c,col:o.toPhysicalColumnPosition(v),sheet:o.sheetId};if(!o.engine.isItPossibleToSetCellContents(g)){Fr("Not possible to set source cell data at ".concat(JSON.stringify(g)));return}l.push({address:g}),s.push.apply(s,WEt(o.engine.setCellContents(g,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),a]))return!1}},{key:"onBeforeCreateCol",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]))return!1}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,a,o){if(!ap(o)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,a,o){if(!ap(o)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(!ap(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeRows(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(i,a,o,s){var l=this;if(!ap(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeColumns(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(i,a,o){var s,l=this;np(this,yh,!0);var u=this.hot.getSourceDataArray(o,0,o+(((s=a.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());np(this,yh,!1),u.forEach(function(f,c){f.forEach(function(h,d){l.engine.setCellContents({col:d,row:o+c,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,a){this.hot.runHooks("afterNamedExpressionAdded",i,a)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,a){this.hot.runHooks("afterNamedExpressionRemoved",i,a)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,a){this.hot.runHooks("afterSheetRenamed",i,a)}},{key:"onEngineSheetRemoved",value:function(i,a){this.hot.runHooks("afterSheetRemoved",i,a)}}],[{key:"PLUGIN_KEY",get:function(){return Zi}},{key:"PLUGIN_PRIORITY",get:function(){return oRt}}]),r}(wr);function lRt(e,t){return hRt(e)||cRt(e,t)||fRt(e,t)||uRt()}function uRt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fRt(e,t){if(e){if(typeof e=="string")return Eee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Eee(e,t)}}function Eee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cRt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function hRt(e){if(Array.isArray(e))return e}function dRt(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=lRt(r,4),a=i[1],o=i[3];a-o!==0&&(n=1)}return this.getTranslatedPhrase(MW,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.col,i.col),0),o=Math.max(n.col,i.col),s=[],l=a;l<=o;l+=1)s.push(l);e.hideColumns(s);var u=s[s.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function bT(e){return yRt(e)||gRt(e)||pRt(e)||vRt()}function vRt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pRt(e,t){if(e){if(typeof e=="string")return EH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EH(e,t)}}function gRt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yRt(e){if(Array.isArray(e))return EH(e)}function EH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mRt(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(DW,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countCols();s||this.selectColumns(a,o)}},disabled:!1,hidden:function(){var n=this,i=Ut(e.getHiddenColumns(),function(w){return n.toPhysicalColumn(w)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().col,s=a.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var g=c.slice(o,s+1);h.push.apply(h,bT(g.filter(function(w){return i.includes(w)})))}}else if(u===0&&u<o)h.push.apply(h,bT(c.slice(0,o)));else if(u===null)h.push.apply(h,bT(c.slice(0,this.countCols())));else{var y=this.countCols()-1,b=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));f===b&&y>s&&h.push.apply(h,bT(c.slice(s+1)))}return ue(h,function(w){t.push(n.toVisualColumn(w))}),t.length===0}}}function Ly(e){return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ly(e)}function bRt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ree(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Rt(n.key),n)}}function wRt(e,t,r){return t&&Ree(e.prototype,t),r&&Ree(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Rt(e){var t=SRt(e,"string");return Ly(t)==="symbol"?t:String(t)}function SRt(e,t){if(Ly(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kh(){return typeof Reflect<"u"&&Reflect.get?Kh=Reflect.get.bind():Kh=function(t,r,n){var i=CRt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Kh.apply(this,arguments)}function CRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hu(e),e!==null););return e}function xRt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RH(e,t)}function RH(e,t){return RH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RH(e,t)}function TRt(e){var t=ERt();return function(){var n=hu(e),i;if(t){var a=hu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ORt(this,i)}}function ORt(e,t){if(t&&(Ly(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kH(e)}function kH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ERt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hu(e){return hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hu(e)}function kee(e,t,r){RRt(e,t),t.set(e,r)}function RRt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fa(e,t){var r=ope(e,t,"get");return kRt(e,r)}function kRt(e,t){return t.get?t.get.call(e):t.value}function K0(e,t,r){var n=ope(e,t,"set");return ARt(e,n,r),r}function ope(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function ARt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ft.getSingleton().register("beforeHideColumns");ft.getSingleton().register("afterHideColumns");ft.getSingleton().register("beforeUnhideColumns");ft.getSingleton().register("afterUnhideColumns");var ED="hiddenColumns",PRt=310,zs=new WeakMap,Gs=new WeakMap,IRt=function(e){xRt(r,e);var t=TRt(r);function r(){var n;bRt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),kee(kH(n),zs,{writable:!0,value:{}}),kee(kH(n),Gs,{writable:!0,value:null}),n}return wRt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ED]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[ED];zt(a)&&(K0(this,zs,a),Lr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),K0(this,Gs,new mA),Fa(this,Gs).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Fa(this,Gs)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyColWidth",function(o,s){return i.onModifyColWidth(o,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),Kh(hu(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Kh(hu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),K0(this,zs,{}),Kh(hu(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o,u=Fa(this,Gs).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalColumn(d)});ue(c,function(d){u[d]=!1}),l=On(u,function(d,v,g){return v&&d.push(a.hot.toVisualColumn(g)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",o,l,s&&f);h!==!1&&(s&&f&&Fa(this,Gs).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",o,l,s&&f,s&&l.length<o.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showColumns(a)}},{key:"hideColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideColumns",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ue(i,function(f){Fa(a,Gs).setValueAtIndex(a.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",o,l,s,s&&l.length>o.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideColumns(a)}},{key:"getHiddenColumns",value:function(){var i=this;return Ut(Fa(this,Gs).getHiddenIndexes(),function(a){return i.hot.toVisualColumn(a)})}},{key:"isHidden",value:function(i){return Fa(this,Gs).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ue(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,a){if(this.isHidden(a))return 0;if(Fa(this,zs).indicators&&(this.isHidden(a+1)||this.isHidden(a-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(Fa(this,zs).copyPasteEnabled===!1&&this.isHidden(a)&&(o.skipColumnOnPaste=!0),this.isHidden(a-1))o.className=o.className||"",o.className.indexOf("afterHiddenColumn")===-1&&(o.className+=" afterHiddenColumn");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(Fa(this,zs).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ue(i,function(l){var u=!0,f=0;yt(l.startCol,l.endCol,function(c){a.isHidden(c)?(u||s(l.startRow,l.endRow,f,c-1),u=!0):(u&&(f=c),c===l.endCol&&s(l.startRow,l.endRow,f,c),u=!1)})}),o}},{key:"onAfterGetColHeader",value:function(i,a){if(!(!Fa(this,zs).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&o.push("beforeHiddenColumn"),Ue(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:qt},dRt(this),mRt(this))}},{key:"onMapInit",value:function(){Array.isArray(Fa(this,zs).columns)&&this.hideColumns(Fa(this,zs).columns)}},{key:"destroy",value:function(){K0(this,zs,null),K0(this,Gs,null),Kh(hu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ED}},{key:"PLUGIN_PRIORITY",get:function(){return PRt}}]),r}(wr);function MRt(e,t){return LRt(e)||NRt(e,t)||$Rt(e,t)||DRt()}function DRt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Rt(e,t){if(e){if(typeof e=="string")return Aee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Aee(e,t)}}function Aee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NRt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function LRt(e){if(Array.isArray(e))return e}function FRt(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=MRt(r,3),a=i[0],o=i[2];a-o!==0&&(n=1)}return this.getTranslatedPhrase($W,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.row,i.row),0),o=Math.max(n.row,i.row),s=[],l=a;l<=o;l+=1)s.push(l);e.hideRows(s);var u=s[s.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function wT(e){return WRt(e)||VRt(e)||BRt(e)||HRt()}function HRt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BRt(e,t){if(e){if(typeof e=="string")return AH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AH(e,t)}}function VRt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WRt(e){if(Array.isArray(e))return AH(e)}function AH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jRt(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(NW,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countRows();s||this.selectRows(a,o)}},disabled:!1,hidden:function(){var n=this,i=Ut(e.getHiddenRows(),function(w){return n.toPhysicalRow(w)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().row,s=a.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var g=c.slice(o,s+1);h.push.apply(h,wT(g.filter(function(w){return i.includes(w)})))}}else if(u===0&&u<o)h.push.apply(h,wT(c.slice(0,o)));else if(u===null)h.push.apply(h,wT(c.slice(0,this.countRows())));else{var y=this.countRows()-1,b=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));f===b&&y>s&&h.push.apply(h,wT(c.slice(s+1)))}return ue(h,function(w){t.push(n.toVisualRow(w))}),t.length===0}}}function Fy(e){return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fy(e)}function URt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GRt(n.key),n)}}function zRt(e,t,r){return t&&Pee(e.prototype,t),r&&Pee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GRt(e){var t=YRt(e,"string");return Fy(t)==="symbol"?t:String(t)}function YRt(e,t){if(Fy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xh(){return typeof Reflect<"u"&&Reflect.get?Xh=Reflect.get.bind():Xh=function(t,r,n){var i=KRt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Xh.apply(this,arguments)}function KRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=du(e),e!==null););return e}function XRt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PH(e,t)}function PH(e,t){return PH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PH(e,t)}function qRt(e){var t=JRt();return function(){var n=du(e),i;if(t){var a=du(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ZRt(this,i)}}function ZRt(e,t){if(t&&(Fy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IH(e)}function IH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JRt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function du(e){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},du(e)}function Iee(e,t,r){QRt(e,t),t.set(e,r)}function QRt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yo(e,t){var r=spe(e,t,"get");return ekt(e,r)}function ekt(e,t){return t.get?t.get.call(e):t.value}function X0(e,t,r){var n=spe(e,t,"set");return tkt(e,n,r),r}function spe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function tkt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}ft.getSingleton().register("beforeHideRows");ft.getSingleton().register("afterHideRows");ft.getSingleton().register("beforeUnhideRows");ft.getSingleton().register("afterUnhideRows");var RD="hiddenRows",rkt=320,Ll=new WeakMap,Ys=new WeakMap,nkt=function(e){XRt(r,e);var t=qRt(r);function r(){var n;URt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Iee(IH(n),Ll,{writable:!0,value:{}}),Iee(IH(n),Ys,{writable:!0,value:null}),n}return zRt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[RD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[RD];zt(a)&&(X0(this,Ll,a),Lr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),X0(this,Ys,new mA),yo(this,Ys).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,yo(this,Ys)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyRowHeight",function(o,s){return i.onModifyRowHeight(o,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),Xh(du(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Xh(du(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),X0(this,Ll,{}),Xh(du(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o,u=yo(this,Ys).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalRow(d)});ue(c,function(d){u[d]=!1}),l=On(u,function(d,v,g){return v&&d.push(a.hot.toVisualRow(g)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",o,l,s&&f);h!==!1&&(s&&f&&yo(this,Ys).setValues(u),this.hot.runHooks("afterUnhideRows",o,l,s&&f,s&&l.length<o.length))}},{key:"showRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showRows(a)}},{key:"hideRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideRows",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ue(i,function(f){yo(a,Ys).setValueAtIndex(a.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",o,l,s,s&&l.length>o.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideRows(a)}},{key:"getHiddenRows",value:function(){var i=this;return Ut(yo(this,Ys).getHiddenIndexes(),function(a){return i.hot.toVisualRow(a)})}},{key:"isHidden",value:function(i){return yo(this,Ys).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ue(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,a){return this.isHidden(a)?0:i}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(yo(this,Ll).copyPasteEnabled===!1&&this.isHidden(i)&&(o.skipRowOnPaste=!0),this.isHidden(i-1))o.className=o.className||"",o.className.indexOf("afterHiddenRow")===-1&&(o.className+=" afterHiddenRow");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(yo(this,Ll).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ue(i,function(l){var u=!0,f=0;yt(l.startRow,l.endRow,function(c){a.isHidden(c)?(u||s(f,c-1,l.startCol,l.endCol),u=!0):(u&&(f=c),c===l.endRow&&s(f,c,l.startCol,l.endCol),u=!1)})}),o}},{key:"onAfterGetRowHeader",value:function(i,a){if(!(!yo(this,Ll).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&o.push("beforeHiddenRow"),Ue(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:qt},FRt(this),jRt(this))}},{key:"onMapInit",value:function(){Array.isArray(yo(this,Ll).rows)&&this.hideRows(yo(this,Ll).rows)}},{key:"destroy",value:function(){X0(this,Ll,null),X0(this,Ys,null),Xh(du(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return RD}},{key:"PLUGIN_PRIORITY",get:function(){return rkt}}]),r}(wr);function ikt(e,t){return lkt(e)||skt(e,t)||okt(e,t)||akt()}function akt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function okt(e,t){if(e){if(typeof e=="string")return Mee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mee(e,t)}}function Mee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function skt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function lkt(e){if(Array.isArray(e))return e}function ukt(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(uW)},callback:function(r,n){var i=ikt(n,1),a=i[0].start.col;e.freezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function fkt(e,t){return vkt(e)||dkt(e,t)||hkt(e,t)||ckt()}function ckt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hkt(e,t){if(e){if(typeof e=="string")return Dee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dee(e,t)}}function Dee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dkt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function vkt(e){if(Array.isArray(e))return e}function pkt(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(fW)},callback:function(r,n){var i=fkt(n,1),a=i[0].start.col;e.unfreezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Hy(e){return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hy(e)}function gkt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mkt(n.key),n)}}function ykt(e,t,r){return t&&$ee(e.prototype,t),r&&$ee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mkt(e){var t=bkt(e,"string");return Hy(t)==="symbol"?t:String(t)}function bkt(e,t){if(Hy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gp(){return typeof Reflect<"u"&&Reflect.get?Gp=Reflect.get.bind():Gp=function(t,r,n){var i=wkt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Gp.apply(this,arguments)}function wkt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nc(e),e!==null););return e}function _kt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MH(e,t)}function MH(e,t){return MH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MH(e,t)}function Skt(e){var t=xkt();return function(){var n=nc(e),i;if(t){var a=nc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ckt(this,i)}}function Ckt(e,t){if(t&&(Hy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lpe(e)}function lpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xkt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nc(e){return nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nc(e)}ft.getSingleton().register("beforeColumnFreeze");ft.getSingleton().register("afterColumnFreeze");ft.getSingleton().register("beforeColumnUnfreeze");ft.getSingleton().register("afterColumnUnfreeze");var Nee="manualColumnFreeze",Tkt=110,q0=new WeakMap,Okt=function(e){_kt(r,e);var t=Skt(r);function r(n){var i;return gkt(this,r),i=t.call(this,n),q0.set(lpe(i),{afterFirstUse:!1}),i}return ykt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Nee]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.addContextMenuEntry(a)}),this.addHook("beforeColumnMove",function(a,o){return i.onBeforeColumnMove(a,o)}),Gp(nc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=q0.get(this);i.afterFirstUse=!1,Gp(nc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Gp(nc(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var a=q0.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart<this.hot.countCols()&&i>o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",i,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart),o._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,s))}},{key:"unfreezeColumn",value:function(i){var a=q0.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart>0&&i<=o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",i,s);l!==!1&&(s&&(o._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,s))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},ukt(this),pkt(this))}},{key:"onBeforeColumnMove",value:function(i,a){var o=q0.get(this);if(o.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(a<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return Nee}},{key:"PLUGIN_PRIORITY",get:function(){return Tkt}}]),r}(wr);function vS(e){return vS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vS(e)}function Ekt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kkt(n.key),n)}}function Rkt(e,t,r){return t&&Lee(e.prototype,t),r&&Lee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kkt(e){var t=Akt(e,"string");return vS(t)==="symbol"?t:String(t)}function Akt(e,t){if(vS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kD=0,Fee=1,Hee=2,op="px",Pkt=function(){function e(t){Ekt(this,e),this.hot=t,this._element=null,this.state=kD,this.inlineProperty=t.isRtl()?"right":"left"}return Rkt(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=Hee}},{key:"build",value:function(){this.state===kD&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Fee)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=kD}},{key:"isAppended",value:function(){return this.state===Hee}},{key:"isBuilt",value:function(){return this.state>=Fee}},{key:"setPosition",value:function(r,n){ja(r)&&(this._element.style.top=r+op),ja(n)&&(this._element.style[this.inlineProperty]=n+op)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){ja(r)&&(this._element.style.width=r+op),ja(n)&&(this._element.style.height=n+op)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){ja(r)&&(this._element.style.marginTop=r+op),ja(n)&&(this._element.style["margin".concat(Oa(this.inlineProperty))]=n+op)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(Oa(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const upe=Pkt;function By(e){return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},By(e)}function Ikt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dkt(n.key),n)}}function Mkt(e,t,r){return t&&Bee(e.prototype,t),r&&Bee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dkt(e){var t=$kt(e,"string");return By(t)==="symbol"?t:String(t)}function $kt(e,t){if(By(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(By(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HO(){return typeof Reflect<"u"&&Reflect.get?HO=Reflect.get.bind():HO=function(t,r,n){var i=Nkt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},HO.apply(this,arguments)}function Nkt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vy(e),e!==null););return e}function Lkt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DH(e,t)}function DH(e,t){return DH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DH(e,t)}function Fkt(e){var t=Vkt();return function(){var n=Vy(e),i;if(t){var a=Vy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Hkt(this,i)}}function Hkt(e,t){if(t&&(By(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bkt(e)}function Bkt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vkt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vy(e){return Vy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vy(e)}var Wkt="ht__manualColumnMove--backlight",jkt=function(e){Lkt(r,e);var t=Fkt(r);function r(){return Ikt(this,r),t.apply(this,arguments)}return Mkt(r,[{key:"build",value:function(){HO(Vy(r.prototype),"build",this).call(this),Ue(this._element,Wkt)}}]),r}(upe);const Ukt=jkt;function Wy(e){return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wy(e)}function zkt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ykt(n.key),n)}}function Gkt(e,t,r){return t&&Vee(e.prototype,t),r&&Vee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ykt(e){var t=Kkt(e,"string");return Wy(t)==="symbol"?t:String(t)}function Kkt(e,t){if(Wy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BO(){return typeof Reflect<"u"&&Reflect.get?BO=Reflect.get.bind():BO=function(t,r,n){var i=Xkt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},BO.apply(this,arguments)}function Xkt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=jy(e),e!==null););return e}function qkt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$H(e,t)}function $H(e,t){return $H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$H(e,t)}function Zkt(e){var t=eAt();return function(){var n=jy(e),i;if(t){var a=jy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Jkt(this,i)}}function Jkt(e,t){if(t&&(Wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qkt(e)}function Qkt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jy(e){return jy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jy(e)}var tAt="ht__manualColumnMove--guideline",rAt=function(e){qkt(r,e);var t=Zkt(r);function r(){return zkt(this,r),t.apply(this,arguments)}return Gkt(r,[{key:"build",value:function(){BO(jy(r.prototype),"build",this).call(this),Ue(this._element,tAt)}}]),r}(upe);const nAt=rAt;function Uy(e){return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uy(e)}function iAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oAt(n.key),n)}}function aAt(e,t,r){return t&&Wee(e.prototype,t),r&&Wee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oAt(e){var t=sAt(e,"string");return Uy(t)==="symbol"?t:String(t)}function sAt(e,t){if(Uy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qh(){return typeof Reflect<"u"&&Reflect.get?qh=Reflect.get.bind():qh=function(t,r,n){var i=lAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},qh.apply(this,arguments)}function lAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vu(e),e!==null););return e}function uAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NH(e,t)}function NH(e,t){return NH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NH(e,t)}function fAt(e){var t=hAt();return function(){var n=vu(e),i;if(t){var a=vu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return cAt(this,i)}}function cAt(e,t){if(t&&(Uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LH(e)}function LH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vu(e)}ft.getSingleton().register("beforeColumnMove");ft.getSingleton().register("afterColumnMove");var AD="manualColumnMove",dAt=120,bf=new WeakMap,jee="ht__manualColumnMove",_T="show-ui",PD="on-moving--columns",ID="after-selection--columns",vAt=function(e){uAt(r,e);var t=fAt(r);function r(n){var i;return iAt(this,r),i=t.call(this,n),bf.set(LH(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new un(LH(i)),i.backlight=new Ukt(n),i.guideline=new nAt(n),i}return aAt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[AD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Ue(this.hot.rootElement,jee),qh(vu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),qh(vu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Mt(this.hot.rootElement,jee),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),qh(vu(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,a){return this.moveColumns([i],a)}},{key:"moveColumns",value:function(i,a){var o=bf.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeColumnMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,a);var f=l&&this.isColumnOrderChanged(i,a);return this.hot.runHooks("afterColumnMove",i,a,s,l,f),f}}},{key:"dragColumn",value:function(i,a){return this.dragColumns([i],a)}},{key:"dragColumns",value:function(i,a){var o=this.countFinalIndex(i,a),s=bf.get(this);return s.cachedDropIndex=a,this.moveColumns(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isColumnOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=On(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getColumnsWidth",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=0,l=i;l<=a;l+=1){var u=o.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[AD];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveColumns(a,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,a){var o=[];return yt(i,a,function(s){o.push(s)}),o}},{key:"refreshPositions",value:function(){var i=bf.get(this),a=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&a>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1));var o=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),f=o.hider.offsetWidth,c=o.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,g=0;if(this.hot.isRtl()){var y=this.hot.rootWindow,b=$r(this.hot.rootElement),w=y.innerWidth-i.rootElementOffset-b;g=y.innerWidth-i.target.eventPageX-w-(s.scrollX===void 0?l:0)}else g=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=v,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=a>0?a-1:a;else if(i.target.TD.offsetWidth/2+u<=g){var _=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=_+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var x=g,T=u;g+d+h>=f?x=f-d-h:g+h<c+v&&(x=c+v+Math.abs(h)),u>=f-1?T=f-1:T===0?T=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(T-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,x),this.guideline.setPosition(null,T)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=bf.get(this),h=Pt(i.target,"sortAction");if(!f||!u||c.pressed||i.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Mt(this.hot.rootElement,[PD,_T]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var g=f.from,y=f.to,b=Math.min(g.col,y.col),w=Math.max(g.col,y.col);if(a.row<0&&a.col>=b&&a.col<=w){s.column=!0,c.pressed=!0,c.target.eventPageX=i.pageX,c.target.eventOffsetX=i.offsetX,c.hoveredColumn=a.col,c.target.TD=o,c.target.col=a.col,c.columnsToMove=this.prepareColumnsToMoving(b,w),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Dn(this.hot.rootElement).left;var _=c.hasRowHeaders?-1:0,x=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,T=a.col<c.fixedColumnsStart,O=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),E=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),M=this.getColumnsWidth(b,a.col-1)+E,P=this.getColumnsWidth(_,b-1)+(T?O:0)+M;this.backlight.setPosition(x,P),this.backlight.setSize(this.getColumnsWidth(b,w),l.hider.offsetHeight-x),this.backlight.setOffset(null,-M),Ue(this.hot.rootElement,PD)}else Mt(this.hot.rootElement,ID),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=bf.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(o)})}a.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=bf.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(a.col)>-1?Mt(this.hot.rootElement,_T):Ue(this.hot.rootElement,_T),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=a.col,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=bf.get(this),a=i.target.col,o=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,Mt(this.hot.rootElement,[PD,_T,ID]),this.hot.selection.isSelectedByColumnHeader()&&Ue(this.hot.rootElement,ID),!(o<1||a===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,a);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(l),c=f+o-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,a=i.getColumnHeaderHeight(0)+1,o=i.holder.scrollTop,s=a+o;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),qh(vu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return AD}},{key:"PLUGIN_PRIORITY",get:function(){return dAt}}]),r}(wr);function zy(e){return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zy(e)}function pAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yAt(n.key),n)}}function gAt(e,t,r){return t&&Uee(e.prototype,t),r&&Uee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yAt(e){var t=mAt(e,"string");return zy(t)==="symbol"?t:String(t)}function mAt(e,t){if(zy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zh(){return typeof Reflect<"u"&&Reflect.get?Zh=Reflect.get.bind():Zh=function(t,r,n){var i=bAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Zh.apply(this,arguments)}function bAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pu(e),e!==null););return e}function wAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FH(e,t)}function FH(e,t){return FH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FH(e,t)}function _At(e){var t=CAt();return function(){var n=pu(e),i;if(t){var a=pu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return SAt(this,i)}}function SAt(e,t){if(t&&(zy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HH(e)}function HH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pu(e){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pu(e)}var ST="manualColumnResize",xAt=130,zee="manualColumnWidths",MD=new WeakMap,TAt=function(e){wAt(r,e);var t=_At(r);function r(n){var i;pAt(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new un(HH(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,MD.set(HH(i),{config:void 0}),Ue(i.handle,"manualColumnResizer"),Ue(i.guide,"manualColumnResizerGuide"),i}return gAt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[ST]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new Cc,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(a,o){return i.onModifyColWidth(a,o)}),this.addHook("beforeStretchingColumnWidth",function(a,o){return i.onBeforeStretchingColumnWidth(a,o)}),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),this.bindEvents(),Zh(pu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Zh(pu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=MD.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Zh(pu(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",zee,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",zee,i),i.value}},{key:"setManualSize",value:function(i,a){var o=Math.max(a,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,o),o}},{key:"clearManualSize",value:function(i){var a=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(a,null)}},{key:"onMapInit",value:function(){var i=this,a=MD.get(this),o=this.hot.getSettings()[ST],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(o)?(this.hot.batchExecution(function(){o.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0),a.config=o):o===!0&&Array.isArray(a.config)&&this.hot.batchExecution(function(){a.config.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var a=this;if(i.parentNode){this.currentTH=i;var o=this.hot.view._wt,s=o.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=ln(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=l<o.getSetting("fixedColumnsStart"),h;c&&(h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=o.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();ue(v,function(g){var y=g.getTopStartCorner().col,b=g.getBottomEndCorner().col;yt(y,b,function(w){a.selectedCols.includes(w)||a.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(ln(this.handle),10),a=parseInt(this.handle.style.top,10)+i,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ue(this.handle,"active"),Ue(this.guide,"active"),this.guide.style.top="".concat(a,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Mt(this.handle,"active"),Mt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!Yf(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!mV(i.target)&&this.checkIfColumnHeader(i.target)){var a=this.getClosestTHParent(i.target);if(!a)return;var o=a.getAttribute("colspan");a&&(o===null||o==="1")&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeColumnResize",i.newSize,u,!0);c!==void 0&&(i.newSize=c),i.hot.getSettings().stretchH==="all"?i.clearManualSize(u):i.setManualSize(u,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(ue(this.selectedCols,function(l){o(l)}),a()):ue(this.selectedCols,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;Pt(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var a=this;if(this.pressed){var o=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+o,ue(this.selectedCols,function(s){a.newSize=a.setManualSize(s,a.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeColumnResize",i.newSize,u,!1),f&&a(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(ue(this.selectedCols,function(l){o(l)}),a()):ue(this.selectedCols,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootWindow,s=a.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(o,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalColumn(a),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[ST]&&l&&(o=l)}return o}},{key:"onBeforeStretchingColumnWidth",value:function(i,a){var o=this.columnWidthsMap.getValueAtIndex(a);return o===null&&(o=i),o}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Zh(pu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ST}},{key:"PLUGIN_PRIORITY",get:function(){return xAt}}]),r}(wr);function pS(e){return pS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pS(e)}function OAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RAt(n.key),n)}}function EAt(e,t,r){return t&&Gee(e.prototype,t),r&&Gee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RAt(e){var t=kAt(e,"string");return pS(t)==="symbol"?t:String(t)}function kAt(e,t){if(pS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DD=0,Yee=1,Kee=2,sp="px",AAt=function(){function e(t){OAt(this,e),this.hot=t,this._element=null,this.state=DD}return EAt(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=Kee}},{key:"build",value:function(){this.state===DD&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Yee)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=DD}},{key:"isAppended",value:function(){return this.state===Kee}},{key:"isBuilt",value:function(){return this.state>=Yee}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+sp),n!==void 0&&(this._element.style.left=n+sp)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+sp),n&&(this._element.style.height=n+sp)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+sp),n&&(this._element.style.marginLeft=n+sp)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const fpe=AAt;function Gy(e){return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gy(e)}function PAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MAt(n.key),n)}}function IAt(e,t,r){return t&&Xee(e.prototype,t),r&&Xee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MAt(e){var t=DAt(e,"string");return Gy(t)==="symbol"?t:String(t)}function DAt(e,t){if(Gy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VO(){return typeof Reflect<"u"&&Reflect.get?VO=Reflect.get.bind():VO=function(t,r,n){var i=$At(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},VO.apply(this,arguments)}function $At(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yy(e),e!==null););return e}function NAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BH(e,t)}function BH(e,t){return BH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BH(e,t)}function LAt(e){var t=BAt();return function(){var n=Yy(e),i;if(t){var a=Yy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return FAt(this,i)}}function FAt(e,t){if(t&&(Gy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HAt(e)}function HAt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yy(e){return Yy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yy(e)}var VAt="ht__manualRowMove--backlight",WAt=function(e){NAt(r,e);var t=LAt(r);function r(){return PAt(this,r),t.apply(this,arguments)}return IAt(r,[{key:"build",value:function(){VO(Yy(r.prototype),"build",this).call(this),Ue(this._element,VAt)}}]),r}(fpe);const jAt=WAt;function Ky(e){return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ky(e)}function UAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GAt(n.key),n)}}function zAt(e,t,r){return t&&qee(e.prototype,t),r&&qee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GAt(e){var t=YAt(e,"string");return Ky(t)==="symbol"?t:String(t)}function YAt(e,t){if(Ky(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WO(){return typeof Reflect<"u"&&Reflect.get?WO=Reflect.get.bind():WO=function(t,r,n){var i=KAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},WO.apply(this,arguments)}function KAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xy(e),e!==null););return e}function XAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VH(e,t)}function VH(e,t){return VH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},VH(e,t)}function qAt(e){var t=QAt();return function(){var n=Xy(e),i;if(t){var a=Xy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ZAt(this,i)}}function ZAt(e,t){if(t&&(Ky(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JAt(e)}function JAt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xy(e){return Xy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xy(e)}var ePt="ht__manualRowMove--guideline",tPt=function(e){XAt(r,e);var t=qAt(r);function r(){return UAt(this,r),t.apply(this,arguments)}return zAt(r,[{key:"build",value:function(){WO(Xy(r.prototype),"build",this).call(this),Ue(this._element,ePt)}}]),r}(fpe);const rPt=tPt;function qy(e){return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qy(e)}function nPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aPt(n.key),n)}}function iPt(e,t,r){return t&&Zee(e.prototype,t),r&&Zee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aPt(e){var t=oPt(e,"string");return qy(t)==="symbol"?t:String(t)}function oPt(e,t){if(qy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jh(){return typeof Reflect<"u"&&Reflect.get?Jh=Reflect.get.bind():Jh=function(t,r,n){var i=sPt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Jh.apply(this,arguments)}function sPt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gu(e),e!==null););return e}function lPt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WH(e,t)}function WH(e,t){return WH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WH(e,t)}function uPt(e){var t=cPt();return function(){var n=gu(e),i;if(t){var a=gu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fPt(this,i)}}function fPt(e,t){if(t&&(qy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jH(e)}function jH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cPt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gu(e){return gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gu(e)}ft.getSingleton().register("beforeRowMove");ft.getSingleton().register("afterRowMove");var $D="manualRowMove",hPt=140,wf=new WeakMap,Jee="ht__manualRowMove",CT="show-ui",ND="on-moving--rows",LD="after-selection--rows",dPt=function(e){lPt(r,e);var t=uPt(r);function r(n){var i;return nPt(this,r),i=t.call(this,n),wf.set(jH(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new un(jH(i)),i.backlight=new jAt(n),i.guideline=new rPt(n),i}return iPt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$D]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Ue(this.hot.rootElement,Jee),Jh(gu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Jh(gu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Mt(this.hot.rootElement,Jee),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Jh(gu(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,a){return this.moveRows([i],a)}},{key:"moveRows",value:function(i,a){var o=wf.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeRowMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,a);var f=l&&this.isRowOrderChanged(i,a);return this.hot.runHooks("afterRowMove",i,a,s,l,f),f}}},{key:"dragRow",value:function(i,a){return this.dragRows([i],a)}},{key:"dragRows",value:function(i,a){var o=this.countFinalIndex(i,a),s=wf.get(this);return s.cachedDropIndex=a,this.moveRows(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isRowOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=On(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getRowsHeight",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=0,l=i;l<=a;l++){var u=o.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[$D];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveRows(a,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),a=[];if(!i)return a;var o=i.from,s=i.to,l=Math.min(o.row,s.row),u=Math.max(o.row,s.row);return yt(l,u,function(f){a.push(f)}),a}},{key:"refreshPositions",value:function(){var i=wf.get(this),a=i.target.coords,o=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(a.row)&&o>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1)),this.isFixedRowBottom(a.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=i.target.TD,c=Dn(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,a.row-1),d=i.target.eventPageY-c.top+u.holder.scrollTop,v=u.hider.offsetHeight,g=u.TBODY.offsetTop,y=this.backlight.getOffset().top,b=this.backlight.getSize().height;this.isFixedRowTop(a.row)&&(h+=u.holder.scrollTop),a.row<0?i.target.row=o>0?o-1:o:f.offsetHeight/2+h<=d?(i.target.row=a.row+1,h+=a.row===0?f.offsetHeight-1:f.offsetHeight):i.target.row=a.row;var w=d,_=h;d+b+y>=v?w=v-b-y:d+y<g&&(w=g+Math.abs(y)),h>=v-1&&(_=v-1),this.backlight.setPosition(w),this.guideline.setPosition(_)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt,u=l.wtTable,f=l.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=wf.get(this);if(!h||!c||d.pressed||i.button!==0){d.pressed=!1,d.rowsToMove.length=0,Mt(this.hot.rootElement,[ND,CT]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&g&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var y=h.from,b=h.to,w=Math.min(y.row,b.row),_=Math.max(y.row,b.row);if(a.col<0&&a.row>=w&&a.row<=_){s.row=!0,d.pressed=!0,d.target.eventPageY=i.pageY,d.target.coords=a,d.target.TD=o,d.rowsToMove=this.prepareRowsToMoving();var x=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,x),this.backlight.setSize(u.hider.offsetWidth-x,this.getRowsHeight(w,_)),this.backlight.setOffset((this.getRowsHeight(w,a.row-1)+i.offsetY)*-1,null),Ue(this.hot.rootElement,ND),this.refreshPositions()}else Mt(this.hot.rootElement,LD),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=wf.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,o)})}a.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=wf.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(a.row)>-1?Mt(this.hot.rootElement,CT):Ue(this.hot.rootElement,CT),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=a,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=wf.get(this),a=i.target.row,o=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,Mt(this.hot.rootElement,[ND,CT,LD]),this.hot.selection.isSelectedByRowHeader()&&Ue(this.hot.rootElement,LD),!(o<1||a===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(i.rowsToMove,a);if(i.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(l),c=f+o-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=i.holder.scrollLeft,s=a+o;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Jh(gu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $D}},{key:"PLUGIN_PRIORITY",get:function(){return hPt}}]),r}(wr);function Zy(e){return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zy(e)}function vPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gPt(n.key),n)}}function pPt(e,t,r){return t&&Qee(e.prototype,t),r&&Qee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gPt(e){var t=yPt(e,"string");return Zy(t)==="symbol"?t:String(t)}function yPt(e,t){if(Zy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qh(){return typeof Reflect<"u"&&Reflect.get?Qh=Reflect.get.bind():Qh=function(t,r,n){var i=mPt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Qh.apply(this,arguments)}function mPt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=yu(e),e!==null););return e}function bPt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UH(e,t)}function UH(e,t){return UH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UH(e,t)}function wPt(e){var t=SPt();return function(){var n=yu(e),i;if(t){var a=yu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _Pt(this,i)}}function _Pt(e,t){if(t&&(Zy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zH(e)}function zH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SPt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yu(e){return yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yu(e)}var xT="manualRowResize",CPt=30,ete="manualRowHeights",FD=new WeakMap,xPt=function(e){bPt(r,e);var t=wPt(r);function r(n){var i;vPt(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new un(zH(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,FD.set(zH(i),{config:void 0}),Ue(i.handle,"manualRowResizer"),Ue(i.guide,"manualRowResizerGuide"),i}return pPt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[xT]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new Cc,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(a,o){return i.onModifyRowHeight(a,o)}),this.bindEvents(),Qh(yu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qh(yu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=FD.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Qh(yu(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",ete,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",ete,i),i.value}},{key:"setManualSize",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=Math.max(a,Vce.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(o,s),s}},{key:"setupHandlePosition",value:function(i){var a=this;this.currentTH=i;var o=this.hot.view,s=o._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var f=$r(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=o.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),v;h?v=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(v=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),v||(v=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){var y=this.hot.getSelectedRange();ue(y,function(b){var w=b.getTopStartCorner().row,_=b.getBottomStartCorner().row;yt(w,_,function(x){a.selectedRows.includes(x)||a.selectedRows.push(x)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt($r(this.handle),10),a=parseInt(this.handle.style[this.inlineDir],10)+i,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ue(this.handle,"active"),Ue(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(a,"px"),this.guide.style.width="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Mt(this.handle,"active"),Mt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var a,o,s=Yf(i,["TH"],this.hot.rootElement);return s&&((a=i.parentNode)===null||a===void 0||(o=a.parentNode)===null||o===void 0?void 0:o.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var a=this.hot.view._wt.wtTable.getRowHeight(i);return a!==void 0&&this.newSize<a?a:this.newSize}},{key:"onMouseOver",value:function(i){if(!mV(i.target)&&this.checkIfRowHeader(i.target)){var a=this.getClosestTHParent(i.target);a&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!0);c!==void 0&&(i.newSize=c),i.setManualSize(u,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(ue(this.selectedRows,function(l){o(l)}),a()):ue(this.selectedRows,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;Pt(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var a=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),ue(this.selectedRows,function(o){a.newSize=a.setManualSize(o,a.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!1),f&&a(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(ue(this.selectedRows,function(l){o(l)}),a()):ue(this.selectedRows,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootElement,s=a.rootWindow;this.eventManager.addEventListener(o,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(o,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalRow(a),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[xT]&&l&&(o=l)}return o}},{key:"onMapInit",value:function(){var i=this,a=FD.get(this),o=this.hot.getSettings()[xT],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(o)?(o.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}),a.config=o):o===!0&&Array.isArray(a.config)&&a.config.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){Qh(yu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xT}},{key:"PLUGIN_PRIORITY",get:function(){return CPt}}]),r}(wr);function gS(e){return gS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gS(e)}var tte,rte,nte,ite;function TT(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function TPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ate(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EPt(n.key),n)}}function OPt(e,t,r){return t&&ate(e.prototype,t),r&&ate(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EPt(e){var t=RPt(e,"string");return gS(t)==="symbol"?t:String(t)}function RPt(e,t){if(gS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kPt=function(){function e(t,r,n,i,a,o){TPt(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=a,this.cellRangeFactory=o}return OPt(e,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],a=n+Math.abs(r[0]||r[1])-1,o=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,a),u=Math.max(n,a),f=this[s],c=this[s]+this[o]-1;if(f>=n&&(this[s]+=i),i>0)n<=c&&n>f&&(this[o]+=i);else if(i<0){if(l<=f&&u>=c)return this.removed=!0,!1;if(f>=l&&f<=u){var h=u-f+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(f<=l&&c>=u)this[o]+=i;else if(f<=l&&c>=l&&c<u){var v=c-l+1;this[o]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Ir(tte||(tte=TT(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Ir(rte||(rte=TT(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Ir(nte||(nte=TT(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Ir(ite||(ite=TT(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),e}();const Js=kPt;function GH(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function yS(e){return yS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yS(e)}var ote;function APt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ste(e){return DPt(e)||MPt(e)||IPt(e)||PPt()}function PPt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IPt(e,t){if(e){if(typeof e=="string")return YH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YH(e,t)}}function MPt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DPt(e){if(Array.isArray(e))return YH(e)}function YH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LPt(n.key),n)}}function NPt(e,t,r){return t&&lte(e.prototype,t),r&&lte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LPt(e){var t=FPt(e,"string");return yS(t)==="symbol"?t:String(t)}function FPt(e,t){if(yS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HPt=function(){function e(t){$Pt(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return NPt(e,[{key:"get",value:function(r,n){var i=this.mergedCells,a=!1;return ue(i,function(o){return o.row<=r&&o.row+o.rowspan-1>=r&&o.col<=n&&o.col+o.colspan-1>=n?(a=o,!1):!0}),a}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return ue(n,function(a){return a.row<=r.from.row&&a.row+a.rowspan-1>=r.to.row&&a.col<=r.from.col&&a.col+a.colspan-1>=r.to.col?(i=a,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCells,o=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return ue(a,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);i?s.overlaps(d)&&o.push(f):s.includesRange(d)&&o.push(f)}),o.length?o:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,a=r.col,o=r.rowspan,s=r.colspan,l=new Js(i,a,o,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(i,a),f=this.isOverlapping(l);return!u&&!f?(this.hot&&l.normalize(this.hot),n.push(l),l):(Fr(e.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,a=this.get(r,n),o=a?this.mergedCells.indexOf(a):-1;return a&&o!==-1?(i.splice(o,1),a):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],a=[];ue(n,function(o){var s=r.hot.getCell(o.row,o.col);s&&i.push([s,r.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,ue(i,function(o,s){yt(0,o.rowspan-1,function(l){yt(0,o.colspan-1,function(u){if(u!==0||l!==0){var f=r.hot.getCell(o.row+l,o.col+u);f&&a.push([f,null,null,null])}})}),i[s][1]=null}),ue(i,function(o){GH.apply(void 0,ste(o))}),ue(a,function(o){GH.apply(void 0,ste(o))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),a=!1;return ue(this.mergedCells,function(o){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(o.row,o.col),n.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1));return s.overlaps(i)?(a=!0,!1):!0}),a}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var a=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(a,o)}},{key:"shiftCollections",value:function(r,n,i){var a=this,o=[0,0];switch(r){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break}ue(this.mergedCells,function(s){s.shift(o,n)}),VE(this.mergedCells.length-1,0,function(s){var l=a.mergedCells[s];l&&l.removed&&a.mergedCells.splice(a.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Ir(ote||(ote=APt(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const BPt=HPt;function mS(e){return mS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mS(e)}function mh(e,t){return UPt(e)||jPt(e,t)||WPt(e,t)||VPt()}function VPt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WPt(e,t){if(e){if(typeof e=="string")return ute(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ute(e,t)}}function ute(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jPt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function UPt(e){if(Array.isArray(e))return e}function zPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YPt(n.key),n)}}function GPt(e,t,r){return t&&fte(e.prototype,t),r&&fte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YPt(e){var t=KPt(e,"string");return mS(t)==="symbol"?t:String(t)}function KPt(e,t){if(mS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XPt=function(){function e(t){zPt(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return GPt(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,a){var o=n.slice(0),s=this.getAutofillSize(r,n,i),l=mh(r,4),u=l[0],f=l[1],c=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,v=d?c-u+1:h-f+1,g=Math.floor(s/v)*v,y=s-g,b=this.getFarthestCollection(r,n,i,a);if(b){if(i==="down"){var w=b.row+b.rowspan-u-y,_=o[2]+w;_>=this.plugin.hot.countRows()?o[2]-=y:o[2]+=y?w:0}else if(i==="right"){var x=b.col+b.colspan-f-y,T=o[3]+x;T>=this.plugin.hot.countCols()?o[3]-=y:o[3]+=y?x:0}else if(i==="up"){var O=c-y-b.row+1,E=o[0]+O;E<0?o[0]+=y:o[0]-=y?O:0}else if(i==="left"){var M=h-y-b.col+1,P=o[1]+M;P<0?o[1]+=y:o[1]-=y?M:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:a,fillSize:s,dragArea:o,cycleLength:v}),o}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),$n(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var a=mh(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=mh(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return o-c;case"down":return d-l;case"left":return s-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,i){var a=mh(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=mh(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return[c,h,o-1,u];case"down":return[l+1,s,d,u];case"left":return[c,h,l,s-1];case"right":return[o,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,a){var o=mh(r,4),s=o[0],l=o[1],u=o[2],f=o[3],c=["up","down"].indexOf(i)>-1,h=c?u:f,d=c?s:l,v=this.getAutofillSize(r,n,i),g=c?u-s+1:f-l+1,y=Math.floor(v/g)*g,b=v-y,w=null,_=null,x=null;switch(i){case"up":w="includesVertically",x=h-b+1;break;case"left":w="includesHorizontally",x=h-b+1;break;case"down":w="includesVertically",x=d+b-1;break;case"right":w="includesHorizontally",x=d+b-1;break}return ue(a,function(T){T[w](x)&&T.isFarther(_,i)&&(_=T)}),_}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,a=this.currentFillData.dragDirection,o=function(h,d){switch(a){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var f=0;f<i.length;f+=1){if(l=i[f],s=u*this.currentFillData.cycleLength,o(l,s))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}f===i.length-1&&(u+=1)}while(o(l,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},a={min:null,max:null};return ue(r,function(o){var s=o[0],l=n.plugin.hot.propToCol(o[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(a.min===null||l<a.min)&&(a.min=l),(a.max===null||l>a.max)&&(a.max=l)}),{from:{row:i.min,column:a.min},to:{row:i.max,column:a.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var a=this.getDragArea(r,n,i),o=mh(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.plugin.hot._createCellCoords(s,l),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const qPt=XPt;function bS(e){return bS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bS(e)}function ZPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QPt(n.key),n)}}function JPt(e,t,r){return t&&cte(e.prototype,t),r&&cte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QPt(e){var t=eIt(e,"string");return bS(t)==="symbol"?t:String(t)}function eIt(e,t){if(bS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tIt=function(){function e(t){ZPt(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return JPt(e,[{key:"snapDelta",value:function(r,n,i){var a=n.to,o=a.row+r.row,s=a.col+r.col;r.row?this.jumpOverMergedCell(r,i,o):r.col&&this.jumpOverMergedCell(r,i,s)}},{key:"jumpOverMergedCell",value:function(r,n,i){var a=r.row||r.col,o=null,s=null,l=null;r.row?(o=n.includesVertically(i),s=n.row,l=n.getLastRow()):r.col&&(o=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),a!==0&&(a>0?o&&i!==s&&(a+=l-i+1):o&&i!==l&&(a-=i-s+1),r.row?r.row=a:r.col&&(r.col=a))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,a){var o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(a!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=o<=c.row&&s<=c.col&&l>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(a);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var a=0;a<r.rowspan;a+=1)for(var o=0;o<r.colspan;o+=1)i.push(this.hot._createCellCoords(r.row+a,r.col+o));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const rIt=tIt;function nIt(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(hW)}return this.getTranslatedPhrase(cW)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Js.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Jy(e){return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jy(e)}function iIt(e,t){return sIt(e)||oIt(e,t)||cpe(e,t)||aIt()}function aIt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oIt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sIt(e){if(Array.isArray(e))return e}function lIt(e){return cIt(e)||fIt(e)||cpe(e)||uIt()}function uIt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cpe(e,t){if(e){if(typeof e=="string")return KH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KH(e,t)}}function fIt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cIt(e){if(Array.isArray(e))return KH(e)}function KH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vIt(n.key),n)}}function dIt(e,t,r){return t&&hte(e.prototype,t),r&&hte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vIt(e){var t=pIt(e,"string");return Jy(t)==="symbol"?t:String(t)}function pIt(e,t){if(Jy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yp(){return typeof Reflect<"u"&&Reflect.get?Yp=Reflect.get.bind():Yp=function(t,r,n){var i=gIt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Yp.apply(this,arguments)}function gIt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ic(e),e!==null););return e}function yIt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XH(e,t)}function XH(e,t){return XH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XH(e,t)}function mIt(e){var t=wIt();return function(){var n=ic(e),i;if(t){var a=ic(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return bIt(this,i)}}function bIt(e,t){if(t&&(Jy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hpe(e)}function hpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wIt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ic(e){return ic=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ic(e)}ft.getSingleton().register("beforeMergeCells");ft.getSingleton().register("afterMergeCells");ft.getSingleton().register("beforeUnmergeCells");ft.getSingleton().register("afterUnmergeCells");var vb="mergeCells",_It=150,dte=new WeakMap,vte=vb,SIt=function(e){yIt(r,e);var t=mIt(r);function r(n){var i;return hIt(this,r),i=t.call(this,n),dte.set(hpe(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return dIt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vb]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new BPt(this),this.autofillCalculations=new qPt(this),this.selectionCalculations=new rIt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(a,o){if(o==="MergeCells")return!1}),this.registerShortcuts(),Yp(ic(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Yp(ic(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[vb];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),Yp(ic(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(U4()){var a=[],o=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,f=l+1;f<l+u;f++)o.push(f)}),o=lIt(new Set(o)),o.forEach(function(s){var l=i.hot.rowIndexMapper.getRenderableFromVisualIndex(s);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(l);f&&(f.style.background=cg(f,"backgroundColor").replace(")",", 0.99)"),a.push(f))})}),this.hot._registerTimeout(function(){a.forEach(function(s){s.style.background=cg(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var a=!0;return i?(Js.containsNegativeValues(i)?(Fr(Js.NEGATIVE_VALUES_WARNING(i)),a=!1):Js.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(Fr(Js.IS_OUT_OF_BOUNDS_WARNING(i)),a=!1):Js.isSingleCell(i)?(Fr(Js.IS_SINGLE_CELL(i)),a=!1):Js.containsZeroSpan(i)&&(Fr(Js.ZERO_SPAN_WARNING(i)),a=!1),a):!1}},{key:"generateFromSettings",value:function(i){var a=this;if(Array.isArray(i)){var o=[];if(ue(i,function(s){if(a.validateSetting(s)){var l=a.hot._createCellCoords(s.row,s.col),u=a.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),f=a.hot._createCellRange(l,l,u);a.mergeRange(f,!0,!0),yt(s.row,s.row+s.rowspan-1,function(c){yt(s.col,s.col+s.colspan-1,function(h){c===s.row&&h===s.col||o.push([c,h,null])})})}}),o.length===0)return;this.hot.setDataAtCell(o)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return a?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.toggleMerge(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){var a=i.from,o=i.to;this.unmergeRange(i,!0),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopStartCorner(),u=i.getBottomEndCorner(),f={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},c=[],h=null;if(!this.canMergeRange(f,o))return!1;this.hot.runHooks("beforeMergeCells",i,o),yt(0,f.rowspan-1,function(v){yt(0,f.colspan-1,function(g){var y=null;c[v]||(c[v]=[]),v===0&&g===0?y=a.hot.getSourceDataAtCell(a.hot.toPhysicalRow(f.row),a.hot.toPhysicalColumn(f.col)):a.hot.setCellMeta(f.row+v,f.col+g,"hidden",!0),c[v][g]=y})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(s?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),o||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,f,o),h):!0}},{key:"unmergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);s&&(this.hot.runHooks("beforeUnmergeCells",i,o),ue(s,function(l){a.mergedCellsCollection.remove(l.row,l.col),yt(0,l.rowspan-1,function(u){yt(0,l.colspan-1,function(f){a.hot.removeCellMeta(l.row+u,l.col+f,"hidden")})}),a.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,o),this.hot.render())}},{key:"toggleMerge",value:function(i){var a=this.mergedCellsCollection.get(i.from.row,i.from.col),o=a.row===i.from.row&&a.col===i.from.col&&a.row+a.rowspan-1===i.to.row&&a.col+a.colspan-1===i.to.col;o?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[vb]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("grid");o.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(l){return!l.altKey},group:vte})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("grid");a.removeShortcutsByGroup(vte)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var a=this.mergedCellsCollection.mergedCells,o=this.hot.getSelectedRangeLast(),s=0;s<a.length;s+=1)if(o.from.row===a[s].row&&o.from.col===a[s].col&&o.to.row===a[s].row+a[s].rowspan-1&&o.to.col===a[s].col+a[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var a=dte.get(this),o=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,u=this.hot._createCellCoords(o.highlight.row,o.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(a.lastDesiredCoords||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(a.lastDesiredCoords)||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=a.lastDesiredCoords.row?a.lastDesiredCoords.row-u.row:s.row,s.col=a.lastDesiredCoords.col?a.lastDesiredCoords.col-u.col:s.col,i.row>0?s.row=f.row+f.rowspan-1-u.row+i.row:i.row<0&&(s.row=u.row-f.row+i.row),i.col>0?s.col=f.col+f.colspan-1-u.col+i.col:i.col<0&&(s.col=u.col-f.col+i.col)}l=this.hot._createCellCoords(o.highlight.row+s.row,o.highlight.col+s.col);var v=this.mergedCellsCollection.get(l.row,l.col);if(v){var g=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);a.lastDesiredCoords=l,s={row:g.row-u.row,col:g.col-u.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var a=this,o=this.hot.getSelectedRangeLast(),s=ta(i),l=this.selectionCalculations.getUpdatedSelectionRange(o,i),u=ta(s),f=this.mergedCellsCollection.getWithinRange(l,!0);do u=ta(s),this.selectionCalculations.getUpdatedSelectionRange(o,s),ue(f,function(c){a.selectionCalculations.snapDelta(s,o,c)});while(s.row!==u.row||s.col!==u.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,a){if(!(i<0||a<0)){var o=this.mergedCellsCollection.get(i,a);if(o){var s=o.row,l=o.col,u=o.colspan,f=o.rowspan;return[s,l,s+f-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},nIt(this))}},{key:"onAfterRenderer",value:function(i,a,o){var s=this.mergedCellsCollection.get(a,o),l=zt(s)?ta(s):void 0;if(zt(l)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=l.row,d=l.col,v=l.colspan,g=l.rowspan,y=this.translateMergedCellToRenderable(h,g,d,v),b=iIt(y,2),w=b[0],_=b[1],x=f.getRenderableFromVisualIndex(a),T=c.getRenderableFromVisualIndex(o),O=w-x+1,E=_-T+1;l.row=f.getNearestNotHiddenIndex(l.row,1),l.col=c.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,O),l.colspan=Math.min(l.colspan,E)}GH(i,l,a,o)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var a=this.mergedCellsCollection.get(i.row,i.col),o=[a.row,a.col];i.row=o[0],i.col=o[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var a=this.hot.getSelectedRangeLast();a.highlight=this.hot._createCellCoords(a.highlight.row,a.highlight.col),a.to=i;var o=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{o=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();a.expandByRange(u)&&(i.row=a.to.row,i.col=a.to.col,o=!0)}}while(o)}},{key:"onAfterGetCellMeta",value:function(i,a,o){var s=this.mergedCellsCollection.get(i,a);s&&(s.row!==i||s.col!==a?o.copyable=!1:(o.rowspan=s.rowspan,o.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var a=this.hot.countCols();this.modifyViewportRowStart(i,a),this.modifyViewportRowEnd(i,a)}},{key:"modifyViewportRowStart",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.startRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(zt(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.row,1));if(f<i.startRow){i.startRow=f,this.modifyViewportRowStart(i,a);return}}}}},{key:"modifyViewportRowEnd",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.endRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(zt(u)){var f=u.row+u.rowspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endRow){i.endRow=c,this.modifyViewportRowEnd(i,a);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var a=this.hot.countRows();this.modifyViewportColumnStart(i,a),this.modifyViewportColumnEnd(i,a)}},{key:"modifyViewportColumnStart",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.startColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(zt(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.col,1));if(f<i.startColumn){i.startColumn=f,this.modifyViewportColumnStart(i,a);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.endColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(zt(u)){var f=u.col+u.colspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endColumn){i.endColumn=c,this.modifyViewportColumnEnd(i,a);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,a,o,s){var l=this.hot,u=l.rowIndexMapper,f=l.columnIndexMapper,c,h;a===0?c=u.getNearestNotHiddenIndex(i,1):c=u.getNearestNotHiddenIndex(i+a-1,-1),s===0?h=f.getNearestNotHiddenIndex(o,1):h=f.getNearestNotHiddenIndex(o+s-1,-1);var d=i>=0?u.getRenderableFromVisualIndex(c):i,v=o>=0?f.getRenderableFromVisualIndex(h):o;return[d,v]}},{key:"onModifyAutofillRange",value:function(i,a){this.autofillCalculations.correctSelectionAreaSize(a);var o=this.autofillCalculations.getDirection(a,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(a,s,o))return s=a,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:a[0],col:a[1]},to:{row:a[2],col:a[3]}});return l&&(s=this.autofillCalculations.snapDragArea(a,s,o,l)),s}},{key:"onAfterCreateCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("right",i,a)}},{key:"onAfterRemoveCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("left",i,a)}},{key:"onAfterCreateRow",value:function(i,a,o){o!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,a)}},{key:"onAfterRemoveRow",value:function(i,a){this.mergedCellsCollection.shiftCollections("up",i,a)}},{key:"onAfterChange",value:function(i,a){a==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,a){if(a&&a==="area"){var o=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(o);ue(s,function(l){o.getBottomEndCorner().row===l.getLastRow()&&o.getBottomEndCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,a,o){if(this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(s){var l=a>0,u=a<0,f=o<0,c=o>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,v=s.col+s.colspan-1===this.hot.countCols()-1,g=s.col===0;(l&&h||u&&d||c&&v||f&&g)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,a,o,s){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(i,a,o,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return vb}},{key:"PLUGIN_PRIORITY",get:function(){return _It}}]),r}(wr);function pte(e){return OIt(e)||TIt(e)||xIt(e)||CIt()}function CIt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xIt(e,t){if(e){if(typeof e=="string")return gte(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gte(e,t)}}function gte(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TIt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function OIt(e){if(Array.isArray(e))return e}function EIt(e,t){return function(r,n){var i=pte(r),a=i.slice(1),o=pte(n),s=o.slice(1);return function l(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.multiColumnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:qde(c.type),y=g(f,c,v)(h,d);if(y===ul){var b=u+1;if(typeof t[b]<"u")return l(b)}return y}(0)}}var yte;function RIt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function mte(){Fr(Ir(yte||(yte=RIt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var dpe="sort";function kIt(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(dpe,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function AIt(e){var t=e.className.split(" "),r=new RegExp("^".concat(dpe,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Qy(e){return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qy(e)}function PIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MIt(n.key),n)}}function IIt(e,t,r){return t&&bte(e.prototype,t),r&&bte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MIt(e){var t=DIt(e,"string");return Qy(t)==="symbol"?t:String(t)}function DIt(e,t){if(Qy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ba(){return typeof Reflect<"u"&&Reflect.get?Ba=Reflect.get.bind():Ba=function(t,r,n){var i=$It(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Ba.apply(this,arguments)}function $It(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ki(e),e!==null););return e}function NIt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qH(e,t)}function qH(e,t){return qH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qH(e,t)}function LIt(e){var t=BIt();return function(){var n=Ki(e),i;if(t){var a=Ki(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return FIt(this,i)}}function FIt(e,t){if(t&&(Qy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HIt(e)}function HIt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BIt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ki(e){return Ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ki(e)}var ZH="multiColumnSorting",VIt=170,WIt="append",wte="columnSorting";Xde(ZH,EIt);var jIt=function(e){NIt(r,e);var t=LIt(r);function r(n){var i;return PIt(this,r),i=t.call(this,n),i.pluginKey=ZH,i}return IIt(r,[{key:"isEnabled",value:function(){return Ba(Ki(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[wte]&&mte(),Ba(Ki(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ba(Ki(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){Ba(Ki(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){Ba(Ki(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Ba(Ki(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return Ba(Ki(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){Ba(Ki(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=Ba(Ki(r.prototype),"updateHeaderClasses",this)).call.apply(a,[this,i].concat(s)),Mt(i,AIt(i)),this.enabled!==!1&&Ue(i,kIt.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[wte]&&mte(),Ba(Ki(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,a){KF(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(a.col),this.sort(this.getNextSortConfig(a.col,WIt))):this.sort(this.getColumnNextConfig(a.col)))}}],[{key:"PLUGIN_KEY",get:function(){return ZH}},{key:"PLUGIN_PRIORITY",get:function(){return VIt}}]),r}(Jde);function em(e){return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},em(e)}function UIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GIt(n.key),n)}}function zIt(e,t,r){return t&&_te(e.prototype,t),r&&_te(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GIt(e){var t=YIt(e,"string");return em(t)==="symbol"?t:String(t)}function YIt(e,t){if(em(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(em(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jO(){return typeof Reflect<"u"&&Reflect.get?jO=Reflect.get.bind():jO=function(t,r,n){var i=KIt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},jO.apply(this,arguments)}function KIt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tm(e),e!==null););return e}function XIt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JH(e,t)}function JH(e,t){return JH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JH(e,t)}function qIt(e){var t=QIt();return function(){var n=tm(e),i;if(t){var a=tm(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ZIt(this,i)}}function ZIt(e,t){if(t&&(em(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JIt(e)}function JIt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QIt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tm(e)}var eMt="multipleSelectionHandles",tMt=160,rMt=function(e){XIt(r,e);var t=qIt(r);function r(n){var i;return UIt(this,r),i=t.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return zIt(r,[{key:"isEnabled",value:function(){return ms()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new un(this)),this.registerListeners(),jO(tm(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,a=this,o=this.hot.rootElement;function s(l){if(a.dragged.length===1)return a.dragged.splice(0,a.dragged.length),!0;var u=a.dragged.indexOf(l);if(u===-1)return!1;u===0?a.dragged=a.dragged.slice(0,1):u===1&&(a.dragged=a.dragged.slice(-1))}this.eventManager.addEventListener(o,"touchstart",function(l){var u;if(Pt(l.target,"topSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("top"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(Pt(l.target,"bottomSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("bottom"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchend",function(l){if(Pt(l.target,"topSelectionHandle-HitArea"))return s.call(a,"top"),a.touchStartRange=void 0,l.preventDefault(),!1;if(Pt(l.target,"bottomSelectionHandle-HitArea"))return s.call(a,"bottom"),a.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchmove",function(l){var u=i.hot.rootDocument,f,c,h,d,v,g;if(a.dragged.length!==0){var y=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!y||y===a.lastSetCell||((y.nodeName==="TD"||y.nodeName==="TH")&&(f=a.hot.getCoords(y),f.col===-1&&(f.col=0),c=a.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&a.hot.selection.setRangeEnd(f),g=a.getCurrentRangeCoords(c,f,a.touchStartRange.direction,v,a.dragged[0]),g.start!==null&&a.hot.selection.setRangeStart(g.start),a.hot.selection.setRangeEnd(g.end),a.lastSetCell=y),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,a,o,s,l){var u=i.getTopStartCorner(),f=i.getBottomEndCorner(),c=i.getBottomStartCorner(),h=i.getTopEndCorner(),d={start:null,end:null};switch(o){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?d={start:this.hot._createCellCoords(a.row,i.highlight.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,u.col)};break;case"SE-NW":l==="bottom"&&(d={start:this.hot._createCellCoords(f.row,a.col),end:this.hot._createCellCoords(a.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?d={start:a,end:c}:d.end=a;break;case"NW-SE":l==="top"?d={start:a,end:f}:d.end=a;break;case"SE-NW":l==="top"?d={start:a,end:u}:d.end=a;break;case"SW-NE":l==="top"?d={start:a,end:h}:d.end=a;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(u.row,a.col),end:this.hot._createCellCoords(a.row,f.col)};break;case"SW-NE":l==="top"?d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,f.col)}:d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(u.row,a.col)};break;case"SE-NW":l==="bottom"?d={start:this.hot._createCellCoords(a.row,h.col),end:this.hot._createCellCoords(u.row,a.col)}:l==="top"&&(d={start:c,end:a});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(d.end=a);break;case"SE-NW":l==="top"?d.end=a:d={start:a,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return eMt}},{key:"PLUGIN_PRIORITY",get:function(){return tMt}}]),r}(wr);function QH(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,i=n===void 0?1:n,a=e.origColspan,o=a===void 0?1:a,s=e.collapsible,l=s===void 0?!1:s,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,g=e.isRoot,y=g===void 0?!1:g,b=e.isPlaceholder,w=b===void 0?!1:b;return{label:r,colspan:i,origColspan:o,collapsible:l,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:y,isPlaceholder:w}}function vpe(){return{label:"",isPlaceholder:!0}}function Ste(e){return oMt(e)||aMt(e)||iMt(e)||nMt()}function nMt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iMt(e,t){if(e){if(typeof e=="string")return eB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eB(e,t)}}function aMt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oMt(e){if(Array.isArray(e))return eB(e)}function eB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sMt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;ue(e,function(i){var a=[],o=0;r.push(a),ue(i,function(s){var l=QH();if(zt(s)){var u=s.label,f=s.colspan;l.label=yn(u),typeof f=="number"&&f>1&&(l.colspan=f,l.origColspan=f)}else l.label=yn(s);o+=l.origColspan;var c=!1;if(o>=t&&(l.colspan=l.origColspan-(o-t),l.origColspan=l.colspan,c=!0),a.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)a.push(vpe());return!c})});var n=Math.max.apply(Math,Ste(Ut(r,function(i){return i.length})));return ue(r,function(i){if(i.length<n){var a=Ut(new Array(n-i.length),function(){return QH()});i.splice.apply(i,[i.length,0].concat(Ste(a)))}}),r}function wS(e){return wS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wS(e)}var lMt=["row","col"];function Cte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uMt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cte(Object(r),!0).forEach(function(n){fMt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fMt(e,t,r){return t=ppe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cMt(e,t){if(e==null)return{};var r=hMt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hMt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function dMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ppe(n.key),n)}}function vMt(e,t,r){return t&&xte(e.prototype,t),r&&xte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ppe(e){var t=pMt(e,"string");return wS(t)==="symbol"?t:String(t)}function pMt(e,t){if(wS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HD(e,t,r){gMt(e,t),t.set(e,r)}function gMt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ns(e,t){var r=gpe(e,t,"get");return yMt(e,r)}function yMt(e,t){return t.get?t.get.call(e):t.value}function Z0(e,t,r){var n=gpe(e,t,"set");return mMt(e,n,r),r}function gpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mMt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Tte=["label","collapsible"],Fl=new WeakMap,bh=new WeakMap,BD=new WeakMap,bMt=function(){function e(){dMt(this,e),HD(this,Fl,{writable:!0,value:[]}),HD(this,bh,{writable:!0,value:0}),HD(this,BD,{writable:!0,value:1/0})}return vMt(e,[{key:"setColumnsLimit",value:function(r){Z0(this,BD,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Z0(this,Fl,sMt(r,ns(this,BD))),Z0(this,bh,ns(this,Fl).length)}},{key:"getData",value:function(){return ns(this,Fl)}},{key:"mergeWith",value:function(r){var n=this;ue(r,function(i){var a=i.row,o=i.col,s=cMt(i,lMt),l=n.getHeaderSettings(a,o);l!==null&&$n(l,s,Tte)})}},{key:"map",value:function(r){ue(ns(this,Fl),function(n){ue(n,function(i){var a=r(uMt({},i));zt(a)&&$n(i,a,Tte)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=ns(this,bh)||r<0)return null;var a=ns(this,Fl)[r];return n>=a.length?null:(i=a[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=[];if(r>=ns(this,bh)||r<0)return a;for(var o=ns(this,Fl)[r],s=0,l=n;l<o.length;l++){var u=o[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,a.push(u),u.colspan>1&&(l+=u.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return a}},{key:"getLayersCount",value:function(){return ns(this,bh)}},{key:"getColumnsCount",value:function(){return ns(this,bh)>0?ns(this,Fl)[0].length:0}},{key:"clear",value:function(){Z0(this,Fl,[]),Z0(this,bh,0)}}]),e}();function _S(e){return _S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_S(e)}function Ote(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ete(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ote(Object(r),!0).forEach(function(n){UO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ote(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ype(n.key),n)}}function _Mt(e,t,r){return t&&Rte(e.prototype,t),r&&Rte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UO(e,t,r){return t=ype(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ype(e){var t=SMt(e,"string");return _S(t)==="symbol"?t:String(t)}function SMt(e,t){if(_S(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_S(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CMt(e){return EMt(e)||OMt(e)||TMt(e)||xMt()}function xMt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TMt(e,t){if(e){if(typeof e=="string")return tB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tB(e,t)}}function OMt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EMt(e){if(Array.isArray(e))return tB(e)}function tB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var RMt="DF-pre-order";function mpe(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=mpe.call(this.childs[n],e,t)}return r}var kMt="DF-post-order";function bpe(e,t){for(var r=0;r<this.childs.length;r++){var n=bpe.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var wpe="BF";function AMt(e,t){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,CMt(i.childs)),e.call(t,i)!==!1&&n()}}n()}var PMt=wpe,kte=new Map([[RMt,mpe],[kMt,bpe],[wpe,AMt]]),Ate=function(){function e(t){wMt(this,e),UO(this,"data",{}),UO(this,"parent",null),UO(this,"childs",[]),this.data=t}return _Mt(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(Ete({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=Ete({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:PMt;if(!kte.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));kte.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function a(o){var s=r.call(n,o);s!==!1&&o.parent!==null&&a(o.parent)};i(this)}}]),e}();function SS(e){return SS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SS(e)}function Pte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ite(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pte(Object(r),!0).forEach(function(n){IMt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IMt(e,t,r){return t=_pe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MMt(e,t){return LMt(e)||NMt(e,t)||$Mt(e,t)||DMt()}function DMt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Mt(e,t){if(e){if(typeof e=="string")return Mte(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mte(e,t)}}function Mte(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NMt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function LMt(e){if(Array.isArray(e))return e}function FMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_pe(n.key),n)}}function HMt(e,t,r){return t&&Dte(e.prototype,t),r&&Dte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _pe(e){var t=BMt(e,"string");return SS(t)==="symbol"?t:String(t)}function BMt(e,t){if(SS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(SS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VD(e,t,r){VMt(e,t),t.set(e,r)}function VMt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ui(e,t){var r=Spe(e,t,"get");return WMt(e,r)}function WMt(e,t){return t.get?t.get.call(e):t.value}function jMt(e,t,r){var n=Spe(e,t,"set");return UMt(e,n,r),r}function Spe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function UMt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var lp=new WeakMap,wh=new WeakMap,up=new WeakMap,zMt=function(){function e(t){FMt(this,e),VD(this,lp,{writable:!0,value:new Map}),VD(this,wh,{writable:!0,value:new Map}),VD(this,up,{writable:!0,value:null}),jMt(this,up,t)}return HMt(e,[{key:"getRoots",value:function(){return Array.from(Ui(this,lp).values())}},{key:"getRootByColumn",value:function(r){var n;return Ui(this,wh).has(r)&&(n=Ui(this,lp).get(Ui(this,wh).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(i){var a=n-Ui(this,wh).get(n),o=0,s;return i.walkDown(function(l){var u=l.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(a>=o&&a<=o+f-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;o+=f}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;Ui(this,wh).clear(),ue(Ui(this,lp),function(i){for(var a=MMt(i,2),o=a[1].data.colspan,s=n;s<n+o;s++)Ui(r,wh).set(s,n);n+=o})}},{key:"buildTree",value:function(){this.clear();for(var r=Ui(this,up).getColumnsCount(),n=0;n<r;){var i=Ui(this,up).getHeaderSettings(0,n),a=new Ate;Ui(this,lp).set(n,a),this.buildLeaves(a,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=Ui(this,up).getHeadersSettings(i,n,o);i+=1,ue(s,function(l){var u=Ite(Ite({},l),{},{headerLevel:i-1,columnIndex:n}),f;i===1?(r.data=u,f=r):(f=new Ate(u),r.addChild(f)),i<Ui(a,up).getLayersCount()&&a.buildLeaves(f,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){Ui(this,lp).clear(),Ui(this,wh).clear()}}]),e}();function Cpe(e,t){e.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(t(n.columnIndex),i.length===0))for(var a=1;a<n.colspan;a++)t(n.columnIndex+a)})}function $R(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function NR(e){return $R(e,"origColspan")===e.data.origColspan}function Wj(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=NR(e);if(n)return Wj(r[0]);t.isCollapsed=!1;var i=r.slice(1),a=new Set,o=0;if(i.length>0)ue(i,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;o+=h.colspan,Cpe(c,function(d){a.add(d)})});else{var s=t.colspan,l=t.origColspan,u=t.columnIndex;o=l-s;for(var f=1;f<l;f++)a.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=o,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):NR(c)&&(h.isCollapsed=$R(c,"isCollapsed"))}),{rollbackModification:function(){return jj(e)},affectedColumns:Array.from(a),colspanCompensation:o}}function jj(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=NR(e);if(i)return jj(n[0]);r.isCollapsed=!0;var a=n.slice(1),o=new Set;if(a.length>0)ue(a,function(h){Cpe(h,function(d){o.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var f=l+u;o.add(f)}var c=r.colspan-((t=$R(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):NR(h)&&(d.isCollapsed=$R(h,"isCollapsed"))}),{rollbackModification:function(){return Wj(e)},affectedColumns:Array.from(o),colspanCompensation:c}}var $te;function GMt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YMt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Ir($te||($te=GMt([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.push(t),a.colspan>1?a.colspan-=1:a.isHidden=!0})}}var Nte;function KMt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function XMt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Ir(Nte||(Nte=KMt([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.splice(a.crossHiddenColumns.indexOf(t),1),!a.isHidden&&a.colspan<a.origColspan&&(a.colspan+=1),a.isHidden=!1})}}var Lte=new Map([["collapse",jj],["expand",Wj],["hide-column",YMt],["show-column",XMt]]);function qMt(e,t,r){if(!Lte.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return Lte.get(e)(t,r)}var ZMt=["crossHiddenColumns"];function JMt(e,t){if(e==null)return{};var r=QMt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function QMt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function OT(e){var t=[];return ue(e,function(r){r.walkDown(function(n){for(var i=n.data,a=i.origColspan,o=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,u=t2t(t,s),f=!1,c=o;c<o+a;c++){var h=l.includes(c);if(h||f)u.push(vpe());else{var d=e2t(i);d.isRoot=!0,u.push(d),f=!0}}})}),t}function e2t(e){var t=QH(e);t.crossHiddenColumns;var r=JMt(t,ZMt);return r}function t2t(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function CS(e){return CS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CS(e)}var r2t=["row"];function Fte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fte(Object(r),!0).forEach(function(n){n2t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n2t(e,t,r){return t=xpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i2t(e,t){if(e==null)return{};var r=a2t(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function a2t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function o2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xpe(n.key),n)}}function s2t(e,t,r){return t&&Bte(e.prototype,t),r&&Bte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xpe(e){var t=l2t(e,"string");return CS(t)==="symbol"?t:String(t)}function l2t(e,t){if(CS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(CS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WD(e,t,r){u2t(e,t),t.set(e,r)}function u2t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J0(e,t,r){var n=Tpe(e,t,"set");return f2t(e,n,r),r}function f2t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function _n(e,t){var r=Tpe(e,t,"get");return c2t(e,r)}function Tpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function c2t(e,t){return t.get?t.get.call(e):t.value}var Ks=new WeakMap,Ha=new WeakMap,_h=new WeakMap,h2t=function(){function e(){o2t(this,e),WD(this,Ks,{writable:!0,value:new bMt}),WD(this,Ha,{writable:!0,value:new zMt(_n(this,Ks))}),WD(this,_h,{writable:!0,value:[[]]})}return s2t(e,[{key:"setState",value:function(r){_n(this,Ks).setData(r);var n=!1;try{_n(this,Ha).buildTree()}catch{_n(this,Ha).clear(),_n(this,Ks).clear(),n=!0}return J0(this,_h,OT(_n(this,Ha).getRoots())),n}},{key:"setColumnsLimit",value:function(r){_n(this,Ks).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=Ut(r,function(a){var o=a.row,s=i2t(a,r2t);return Hte({row:o<0?n.rowCoordsToLevel(o):o},s)});_n(this,Ks).mergeWith(i),_n(this,Ha).buildTree(),J0(this,_h,OT(_n(this,Ha).getRoots()))}},{key:"mapState",value:function(r){_n(this,Ks).map(r),_n(this,Ha).buildTree(),J0(this,_h,OT(_n(this,Ha).getRoots()))}},{key:"mapNodes",value:function(r){return On(_n(this,Ha).getRoots(),function(n,i){return i.walkDown(function(a){var o=r(a.data);o!==void 0&&n.push(o)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var a=_n(this,Ha).getNode(n,i),o;return a&&(o=qMt(r,a,i),J0(this,_h,OT(_n(this,Ha).getRoots()))),o}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,a;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(a=_n(this,_h)[r])===null||a===void 0?void 0:a[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=_n(this,Ha).getNode(r,n);return i?Hte({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,a=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},o=a.isRoot;if(o)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},f=u.isRoot;if(f)break;s-=1}return s}},{key:"getLayersCount",value:function(){return _n(this,Ks).getLayersCount()}},{key:"getColumnsCount",value:function(){return _n(this,Ks).getColumnsCount()}},{key:"clear",value:function(){J0(this,_h,[]),_n(this,Ks).clear(),_n(this,Ha).clear()}}]),e}();function xS(e){return xS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xS(e)}function d2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ope(n.key),n)}}function v2t(e,t,r){return t&&Vte(e.prototype,t),r&&Vte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q0(e,t,r){return t=Ope(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ope(e){var t=p2t(e,"string");return xS(t)==="symbol"?t:String(t)}function p2t(e,t){if(xS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g2t=function(){function e(t,r){d2t(this,e),Q0(this,"hot",void 0),Q0(this,"nestedHeaderSettingsGetter",void 0),Q0(this,"layersCount",0),Q0(this,"container",void 0),Q0(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return v2t(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(a);this.widthsMap.setValueAtIndex(o,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,a=n.columnIndexMapper,o=i.createDocumentFragment(),s=i.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=a.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=i.createElement("tr"),h=0;h<u;h++){var d=a.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=i.createElement("th"),g=this.nestedHeaderSettingsGetter(f,d);if(g&&(!g.isPlaceholder||g.isHidden)){var y=g.label;l&&(y+='<button class="changeType"></button>'),Xd(v,y),v.colSpan=g.colspan,c.appendChild(v)}}s.appendChild(c)}o.appendChild(s),r.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const y2t=g2t;function rm(e){return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rm(e)}var Wte,jte;function Ute(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Epe(n.key),n)}}function b2t(e,t,r){return t&&zte(e.prototype,t),r&&zte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ed(){return typeof Reflect<"u"&&Reflect.get?ed=Reflect.get.bind():ed=function(t,r,n){var i=w2t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ed.apply(this,arguments)}function w2t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mu(e),e!==null););return e}function _2t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rB(e,t)}function rB(e,t){return rB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rB(e,t)}function S2t(e){var t=x2t();return function(){var n=mu(e),i;if(t){var a=mu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return C2t(this,i)}}function C2t(e,t){if(t&&(rm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pb(e)}function pb(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x2t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mu(e)}function Gte(e,t,r){return t=Epe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Epe(e){var t=T2t(e,"string");return rm(t)==="symbol"?t:String(t)}function T2t(e,t){if(rm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yte(e,t,r){O2t(e,t),t.set(e,r)}function O2t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ET(e,t,r){var n=Rpe(e,t,"set");return E2t(e,n,r),r}function E2t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function dn(e,t){var r=Rpe(e,t,"get");return R2t(e,r)}function Rpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function R2t(e,t){return t.get?t.get.call(e):t.value}var Kte="nestedHeaders",k2t=280,kn=new WeakMap,_f=new WeakMap,A2t=function(e){_2t(r,e);var t=S2t(r);function r(){var n;m2t(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Yte(pb(n),kn,{writable:!0,value:new h2t}),Yte(pb(n),_f,{writable:!0,value:null}),Gte(pb(n),"ghostTable",new y2t(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),Gte(pb(n),"detectedOverlappedHeaders",!1),n}return b2t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Kte]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;(!Array.isArray(o)||!Array.isArray(o[0]))&&Fr(Ir(Wte||(Wte=Ute([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),ed(mu(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(this.hot.view){var a=this.hot.getSettings(),o=a.nestedHeaders;dn(this,kn).setColumnsLimit(this.hot.countCols()),Array.isArray(o)&&(this.detectedOverlappedHeaders=dn(this,kn).setState(o)),this.detectedOverlappedHeaders&&Fr(Ir(jte||(jte=Ute([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";dn(i,kn).triggerColumnModification(u,l)}),!dn(this,_f)&&this.enabled&&ET(this,_f,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,f=l.index,c=l.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";dn(i,kn).triggerColumnModification(h,f)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),ed(mu(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),dn(this,kn).clear(),dn(this,_f).unsubscribe(),ET(this,_f,null),this.ghostTable.clear(),ed(mu(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return dn(this,kn)}},{key:"getLayersCount",value:function(){return dn(this,kn).getLayersCount()}},{key:"getHeaderSettings",value:function(i,a){return dn(this,kn).getHeaderSettings(i,a)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var i=this.hot.view._wt,a=i.getSetting("columnHeaders").length,o=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<a;u++){var f=o.childNodes[u];if(!f)break;for(var c=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Mt(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Mt(c.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Mt(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var a=this,o=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,f=a.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(s);d===null&&(d=s),l.removeAttribute("colspan"),Mt(l,"hiddenHeader");var v=(u=dn(a,kn).getHeaderSettings(i,d))!==null&&u!==void 0?u:{label:""},g=v.colspan,y=v.isHidden,b=v.isPlaceholder;if(b||y)Ue(l,"hiddenHeader");else if(g>1){var w,_,x=h._wt.wtOverlays,T=(w=x.topInlineStartCornerOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(l),O=(_=x.inlineStartOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(l),E=T||O?Math.min(g,o-s):g;E>1&&l.setAttribute("colspan",E)}a.hot.view.appendColHeader(d,l,function(){return a.getColumnHeaderValue.apply(a,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,a){var o,s=(o=dn(this,kn).getHeaderSettings(a,i))!==null&&o!==void 0?o:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(i,a)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,a,o){var s=dn(this,kn).getHeaderTreeNodeData(a,i);if(!s)return i;var l=o.classNames,u=o.columnCursor,f=o.selectionType,c=o.selectionWidth,h=dn(this,kn).getHeaderSettings(a,i),d=h.isRoot,v=h.colspan;if(f===A1){if(!d)return s.columnIndex}else f===CA&&(v>c-u||!d)&&(l.length=0);return i}},{key:"onBeforeCopy",value:function(i,a,o){var s=o.columnHeadersCount;if(s!==0)for(var l=0;l<a.length;l++){var u=a[l],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,g=c-d+1;if(f>=0||g===1)break;for(var y=c;y<=d;y++)for(var b=f;b<=h;b++){var w,_=v+b,x=y-c;if(x!==0){var T=(w=dn(this,kn).getHeaderTreeNodeData(b,y))===null||w===void 0?void 0:w.isRoot;T===!1&&(i[_][x]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this._getHeaderTreeNodeDataByCoords(a);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){var o=this._getHeaderTreeNodeDataByCoords(a);if(o){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],f=o.columnIndex,c=o.origColspan,h=!s.inInSelection(a);i.shiftKey&&l?a.col<l.from.col?u.push(l.getTopEndCorner().col,f,a.row):a.col>l.from.col?u.push(l.getTopStartCorner().col,f+c-1,a.row):u.push(f,f+c-1,a.row):(vA(i)||gc(i)&&h)&&u.push(f,f+c-1,a.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(a);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),g=h.from;s.column=!0,s.cell=!0;var y=[];a.col<g.col?y.push(v.col,f):a.col>g.col?y.push(d.col,f+c-1):y.push(f,f+c-1),(l=this.hot).selectColumns.apply(l,y)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var a=0;a<dn(this,kn).getLayersCount();a++)i.push(this.headerRendererFactory(a))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var a=dn(this,kn).getLayersCount(),o=i.startColumn,s=!!a,l=0;l<a;l++){var u=dn(this,kn).findLeftMostColumnIndex(l,i.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),ja(f)&&f<i.startColumn){o=f;break}}i.startColumn=s?dn(this,kn).getHeaderTreeNodeData(0,o).columnIndex:o}},{key:"onModifyColWidth",value:function(i,a){var o=this.ghostTable.getWidth(a);return i>o?i:o}},{key:"onModifyColumnHeaderValue",value:function(i,a,o){var s,l=(s=dn(this,kn).getHeaderTreeNodeData(o,a))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){ET(this,kn,null),dn(this,_f)!==null&&(dn(this,_f).unsubscribe(),ET(this,_f,null)),ed(mu(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return dn(this,kn).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return Kte}},{key:"PLUGIN_PRIORITY",get:function(){return k2t}}]),r}(wr);function Xte(e){return D2t(e)||M2t(e)||I2t(e)||P2t()}function P2t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I2t(e,t){if(e){if(typeof e=="string")return nB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nB(e,t)}}function M2t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function D2t(e){if(Array.isArray(e))return nB(e)}function nB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nm(e){return nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nm(e)}function $2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L2t(n.key),n)}}function N2t(e,t,r){return t&&qte(e.prototype,t),r&&qte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L2t(e){var t=F2t(e,"string");return nm(t)==="symbol"?t:String(t)}function F2t(e,t){if(nm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H2t=function(){function e(t,r){$2t(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return N2t(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},yt(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var a=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&ue(r.__children,function(o){a.cacheNode(o,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,a){var o=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:u,end:!0}:a!=null&&u===a?{result:l,end:!0}:(l+=1,u.__children&&ue(u.__children,function(f){if(o.parentReference.set(f,s?null:u),l=o.readTreeNodes(f,l,i,a),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return Gt(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,a=r;return isNaN(a)||(a=this.getDataObject(a)),!a||!a.__children?0:(ue(a.__children,function(o){i+=1,o.__children&&(i+=n.countChildren(o))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||nm(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var a=null;r&&(a=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",a+this.countChildren(r)+1,1);var o=r;r||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var a=i,o;if(a||(a=this.mockNode()),this.hot.runHooks("beforeAddChild",r,a,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,a),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),o=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);a=this.getDataObject(o),this.hot.runHooks("afterAddChild",r,a,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),a=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(a,o+1,null);break;case"above":this.addChildAtIndex(a,o,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=null,o=[];Array.isArray(r)?(yt(r[0],r[2],function(b){var w=n.translateTrimmedRow(b);o.push(n.getDataObject(w))}),yt(0,o.length-2,function(b){n.detachFromParent(o[b],!1)}),a=o[o.length-1]):a=r;var s=this.getRowIndex(a),l=this.countChildren(a),u=this.getRowIndexWithinParent(a),f=this.getRowParent(a),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,a),u!=null){var v=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var g=this.getChild(c,this.countChildren(c)-1),y=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",y+1,l+1,this.plugin.pluginName),c.__children.push(a)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(a)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,a,this.getRowIndex(a)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var a=this,o=[];ue(i,function(s){o.push(a.getDataObject(s))}),ue(o,function(s){var l=a.getRowIndexWithinParent(s),u=a.getRowParent(s);u===null?a.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var a=this.getDataObject(r-1),o=null,s=r;if(a&&a.__children&&a.__children.length===0?(o=a,s=0):r<this.countAllRows()&&(o=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),o)if(i){var l;(l=o.__children).splice.apply(l,[s,n].concat(Xte(i)))}else o.__children.splice(s,n);else if(i){var u;(u=this.data).splice.apply(u,[s,n].concat(Xte(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,a){var o=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),f=r>n,c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=o||i||a?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,u[0]),s.__children.splice(l+(f&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const B2t=H2t;function TS(e){return TS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TS(e)}function Zte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W2t(n.key),n)}}function V2t(e,t,r){return t&&Zte(e.prototype,t),r&&Zte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W2t(e){var t=j2t(e,"string");return TS(t)==="symbol"?t:String(t)}function j2t(e,t){if(TS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(TS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var z2t=V2t(function e(t,r){U2t(this,e),this.hot=r,this.plugin=t});const Uj=z2t;function im(e){return im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},im(e)}function G2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K2t(n.key),n)}}function Y2t(e,t,r){return t&&Jte(e.prototype,t),r&&Jte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K2t(e){var t=X2t(e,"string");return im(t)==="symbol"?t:String(t)}function X2t(e,t){if(im(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(im(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q2t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iB(e,t)}function iB(e,t){return iB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iB(e,t)}function Z2t(e){var t=eDt();return function(){var n=LR(e),i;if(t){var a=LR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return J2t(this,i)}}function J2t(e,t){if(t&&(im(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q2t(e)}function Q2t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eDt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function LR(e){return LR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LR(e)}var tDt=function(e){q2t(r,e);var t=Z2t(r);function r(n,i){var a;return G2t(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsingUI=a.plugin.collapsingUI,a.rowHeaderWidthCache=null,a}return Y2t(r,[{key:"appendLevelIndicators",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(o),l=this.dataManager.getDataObject(o),u=a.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(ue(c,function(g){g&&u.removeChild(g)}),Ue(a,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",yt(0,s-1,function(){var g=h.createElement("SPAN");Ue(g,r.CSS_CLASSES.emptyIndicator),u.appendChild(g)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var v=this.hot.rootDocument.createElement("DIV");Ue(a,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?Ue(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):Ue(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(i){var a=i;a||(a=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*a+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(Uj);const kpe=tDt;function am(e){return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},am(e)}function Qte(e){return aDt(e)||iDt(e)||nDt(e)||rDt()}function rDt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nDt(e,t){if(e){if(typeof e=="string")return aB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aB(e,t)}}function iDt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aDt(e){if(Array.isArray(e))return aB(e)}function aB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ere(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lDt(n.key),n)}}function sDt(e,t,r){return t&&ere(e.prototype,t),r&&ere(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lDt(e){var t=uDt(e,"string");return am(t)==="symbol"?t:String(t)}function uDt(e,t){if(am(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(am(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fDt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oB(e,t)}function oB(e,t){return oB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oB(e,t)}function cDt(e){var t=vDt();return function(){var n=FR(e),i;if(t){var a=FR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return hDt(this,i)}}function hDt(e,t){if(t&&(am(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dDt(e)}function dDt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vDt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function FR(e){return FR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FR(e)}var pDt=function(e){fDt(r,e);var t=cDt(r);function r(n,i){var a;return oDt(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsedRows=[],a.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;a.lastCollapsedRows=a.collapsedRows.slice(0),a.expandMultipleChildren(a.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),ue(a.lastCollapsedRows,function(f,c){f>=s&&f<l&&(a.lastCollapsedRows[c]=f+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;a.collapseMultipleChildren(a.lastCollapsedRows,s),a.lastCollapsedRows=void 0},trimStash:function(s,l){yt(s,s+l-1,function(u){var f=a.lastCollapsedRows.indexOf(u);f>-1&&a.lastCollapsedRows.splice(f,1)})}},a}return sDt(r,[{key:"collapseChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(i),f=i),this.dataManager.hasChildren(u)&&ue(u.__children,function(h){l.push(a.dataManager.getRowIndex(h))}),c=this.collapseRows(l,!0,!1),s&&this.trimRows(c),o&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ue(i,function(u){l.push.apply(l,Qte(a.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),o&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],a)}},{key:"collapseRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ue(i,function(u){l.push(u),o&&a.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ue(l.__children,function(u){var f=a.dataManager.getRowIndex(u);o.push(f),a.collapseChildRows(f,o)})}s&&this.trimRows(o)}},{key:"expandRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],a)}},{key:"expandRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ue(i,function(u){l.push(u),o&&a.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ue(l.__children,function(u){if(!a.isAnyParentCollapsed(u)){var f=a.dataManager.getRowIndex(u);o.push(f),a.expandChildRows(f,o)}})}s&&this.untrimRows(o)}},{key:"expandChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(i)):(u=this.dataManager.getDataObject(i),f=i),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&ue(u.__children,function(h){var d=a.dataManager.getRowIndex(h);l.push(d)}),c=this.expandRows(l,!0,!1),s&&this.untrimRows(c),o&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ue(i,function(u){l.push.apply(l,Qte(a.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),o&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ue(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.collapseMultipleChildren(o),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ue(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.expandMultipleChildren(o),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ue(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"untrimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ue(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var a=this,o=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return o===null&&(o={__children:this.dataManager.data}),this.dataManager.hasChildren(o)&&ue(o.__children,function(l){var u=a.dataManager.getRowIndex(l);if(!a.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var a=i;a!==null;){a=this.dataManager.getRowParent(a);var o=this.dataManager.getRowIndex(a);if(this.collapsedRows.indexOf(o)>-1)return!0}return!1}},{key:"toggleState",value:function(i,a){if(!(a.col>=0)){var o=this.translateTrimmedRow(a.row);Pt(i.target,kpe.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),Es(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(Uj);const gDt=pDt;function om(e){return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},om(e)}function yDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bDt(n.key),n)}}function mDt(e,t,r){return t&&tre(e.prototype,t),r&&tre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bDt(e){var t=wDt(e,"string");return om(t)==="symbol"?t:String(t)}function wDt(e,t){if(om(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(om(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Dt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sB(e,t)}function sB(e,t){return sB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sB(e,t)}function SDt(e){var t=xDt();return function(){var n=HR(e),i;if(t){var a=HR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return CDt(this,i)}}function CDt(e,t){if(t&&(om(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ape(e)}function Ape(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xDt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function HR(e){return HR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},HR(e)}var rre=new WeakMap,TDt=function(e){_Dt(r,e);var t=SDt(r);function r(n,i){var a;return yDt(this,r),a=t.call(this,n,i),rre.set(Ape(a),{row_above:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"below")}}),a.dataManager=a.plugin.dataManager,a}return mDt(r,[{key:"appendOptions",value:function(i){var a=this,o=[{key:"add_child",name:function(){return this.getTranslatedPhrase(PW)},callback:function(){var l=a.dataManager.translateTrimmedRow(a.hot.getSelectedLast()[0]),u=a.dataManager.getDataObject(l);a.dataManager.addChild(u)},disabled:function(){var l=a.hot.getSelectedLast();return!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(IW)},callback:function(){a.dataManager.detachFromParent(a.hot.getSelectedLast())},disabled:function(){var l=a.hot.getSelectedLast(),u=a.dataManager.translateTrimmedRow(l[0]),f=a.dataManager.getRowParent(u);return!f||!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{name:"---------"}];return yt(0,i.items.length-1,function(s){if(s===0)return ue(o,function(l,u){i.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var a=rre.get(this);return yt(0,i.items.length-1,function(o){var s=a[i.items[o].key];s!=null&&(i.items[o].callback=s)}),i}}]),r}(Uj);const ODt=TDt;function OS(e){return OS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OS(e)}var nre;function ire(e){return ADt(e)||kDt(e)||RDt(e)||EDt()}function EDt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RDt(e,t){if(e){if(typeof e=="string")return lB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lB(e,t)}}function kDt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ADt(e){if(Array.isArray(e))return lB(e)}function lB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PDt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function IDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function are(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DDt(n.key),n)}}function MDt(e,t,r){return t&&are(e.prototype,t),r&&are(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DDt(e){var t=$Dt(e,"string");return OS(t)==="symbol"?t:String(t)}function $Dt(e,t){if(OS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(OS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NDt=function(){function e(t){IDt(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return MDt(e,[{key:"onBeforeRowMove",value:function(r,n,i,a){var o=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:a});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),f=!0,c=r.map(function(y){if(!f)return!1;var b=o.dataManager.translateTrimmedRow(y);return f=o.shouldAllowMoving(b,u),b}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(l,u),g=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,g),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,a,a&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,a=r.dropIndex,o=r.movePossible,s=!1;return Lr(a)&&(Fr(Ir(nre||(nre=PDt([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,a,o,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,ire(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var a=this,o=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(s){a.dataManager.moveRow(s,n,a.movedToCollapsed,o)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,a,o=[],s=Math.max.apply(Math,ire(r))<n;r.forEach(function(l){o.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(a=this.hot).spliceCellsMeta.apply(a,[n-(s?o.length:0),0].concat(o))}},{key:"selectCells",value:function(r,n){var i=r.length,a=0,o=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[i-1]<n?u=this.dataManager.translateTrimmedRow(n-i):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);a=this.dataManager.untranslateTrimmedRow(c),o=a}else r[i-1]<n?(o=n-1,a=o-i+1):(a=n,o=a+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(a,0)),s.setRangeEnd(this.hot._createCellCoords(o,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,a){return i-a!==n})}}]),e}();function sm(e){return sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sm(e)}function LDt(e){return VDt(e)||BDt(e)||HDt(e)||FDt()}function FDt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HDt(e,t){if(e){if(typeof e=="string")return uB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uB(e,t)}}function BDt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VDt(e){if(Array.isArray(e))return uB(e)}function uB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ore(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UDt(n.key),n)}}function jDt(e,t,r){return t&&ore(e.prototype,t),r&&ore(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UDt(e){var t=zDt(e,"string");return sm(t)==="symbol"?t:String(t)}function zDt(e,t){if(sm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function td(){return typeof Reflect<"u"&&Reflect.get?td=Reflect.get.bind():td=function(t,r,n){var i=GDt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},td.apply(this,arguments)}function GDt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function YDt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fB(e,t)}function fB(e,t){return fB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fB(e,t)}function KDt(e){var t=qDt();return function(){var n=bu(e),i;if(t){var a=bu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return XDt(this,i)}}function XDt(e,t){if(t&&(sm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ppe(e)}function Ppe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qDt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var jD="nestedRows",ZDt=300,Hl=new WeakMap,JDt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",QDt=function(e){YDt(r,e);var t=KDt(r);function r(n){var i;return WDt(this,r),i=t.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,Hl.set(Ppe(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return jDt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new k1),this.dataManager=new B2t(this,this.hot),this.collapsingUI=new gDt(this,this.hot),this.headersUI=new kpe(this,this.hot),this.contextMenuUI=new ODt(this,this.hot),this.rowMoveController=new NDt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(a){return i.onBeforeLoadData(a)}),this.addHook("beforeUpdateData",function(a){return i.onBeforeLoadData(a)}),td(bu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),td(bu(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),td(bu(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,a,o,s){return this.rowMoveController.onBeforeRowMove(i,a,o,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=Hl.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=Hl.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o){this.collapsingUI.toggleState(i,a,o)}},{key:"onModifyRowData",value:function(i){var a=Hl.get(this);if(!a.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=Hl.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,a,o){var s=Hl.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,a,o),!1)}},{key:"onFilterData",value:function(i,a,o){var s=Hl.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],a),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*a),this.dataManager.filterData(i,a,o),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,a){this.headersUI.appendLevelIndicators(i,a)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(s!==this.pluginName){var u=Hl.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=Array.from(o.reduce(function(u,f){if(s.dataManager.isParent(f)){var c=s.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));o.length=0,o.push.apply(o,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,a){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(a)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,a,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,LDt(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,a){var o=Hl.get(this);o.skipRender&&(a.skipRender=!0)}},{key:"destroy",value:function(){td(bu(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!Mhe(i)){_V(JDt),this.hot.getSettings()[jD]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return jD}},{key:"PLUGIN_PRIORITY",get:function(){return ZDt}}]),r}(wr);function ES(e){return ES=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ES(e)}function e$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r$t(n.key),n)}}function t$t(e,t,r){return t&&sre(e.prototype,t),r&&sre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r$t(e){var t=n$t(e,"string");return ES(t)==="symbol"?t:String(t)}function n$t(e,t){if(ES(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ES(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i$t=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;e$t(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return t$t(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,a=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return a===null?void 0:JSON.parse(a)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;ue(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const a$t=i$t;function lm(e){return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lm(e)}function o$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l$t(n.key),n)}}function s$t(e,t,r){return t&&lre(e.prototype,t),r&&lre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l$t(e){var t=u$t(e,"string");return lm(t)==="symbol"?t:String(t)}function u$t(e,t){if(lm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rd(){return typeof Reflect<"u"&&Reflect.get?rd=Reflect.get.bind():rd=function(t,r,n){var i=f$t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},rd.apply(this,arguments)}function f$t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wu(e),e!==null););return e}function c$t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cB(e,t)}function cB(e,t){return cB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cB(e,t)}function h$t(e){var t=p$t();return function(){var n=wu(e),i;if(t){var a=wu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return d$t(this,i)}}function d$t(e,t){if(t&&(lm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v$t(e)}function v$t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p$t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wu(e){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wu(e)}ft.getSingleton().register("persistentStateSave");ft.getSingleton().register("persistentStateLoad");ft.getSingleton().register("persistentStateReset");var ure="persistentState",g$t=0,y$t=function(e){c$t(r,e);var t=h$t(r);function r(n){var i;return o$t(this,r),i=t.call(this,n),i.storage=void 0,i}return s$t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ure]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new a$t(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(a,o){return i.saveValue(a,o)}),this.addHook("persistentStateLoad",function(a,o){return i.loadValue(a,o)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),rd(wu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,rd(wu(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),rd(wu(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,a){a.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,a){this.storage.saveValue(i,a)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){rd(wu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ure}},{key:"PLUGIN_PRIORITY",get:function(){return g$t}}]),r}(wr);function um(e){return um=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},um(e)}function m$t(e){return S$t(e)||_$t(e)||w$t(e)||b$t()}function b$t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w$t(e,t){if(e){if(typeof e=="string")return hB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hB(e,t)}}function _$t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function S$t(e){if(Array.isArray(e))return hB(e)}function hB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T$t(n.key),n)}}function x$t(e,t,r){return t&&fre(e.prototype,t),r&&fre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T$t(e){var t=O$t(e,"string");return um(t)==="symbol"?t:String(t)}function O$t(e,t){if(um(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(um(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nd(){return typeof Reflect<"u"&&Reflect.get?nd=Reflect.get.bind():nd=function(t,r,n){var i=E$t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},nd.apply(this,arguments)}function E$t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_u(e),e!==null););return e}function R$t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dB(e,t)}function dB(e,t){return dB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dB(e,t)}function k$t(e){var t=I$t();return function(){var n=_u(e),i;if(t){var a=_u(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return A$t(this,i)}}function A$t(e,t){if(t&&(um(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P$t(e)}function P$t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I$t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _u(e){return _u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_u(e)}var UD="search",M$t=190,D$t="htSearchResult",$$t=function(t,r,n,i,a){t.getCellMeta(r,n).isSearchResult=a},N$t=function(t,r,n){return Lr(t)||t===null||!t.toLocaleLowerCase||t.length===0||Lr(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},L$t=function(e){R$t(r,e);var t=k$t(r);function r(n){var i;return C$t(this,r),i=t.call(this,n),i.callback=$$t,i.queryMethod=N$t,i.searchResultClass=D$t,i}return x$t(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[UD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[UD];this.updatePluginSettings(a),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),nd(_u(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,a=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",a)}),nd(_u(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),nd(_u(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return yt(0,l-1,function(h){yt(0,u-1,function(d){var v=a.hot.getDataAtCell(h,d),g=a.hot.getCellMeta(h,d),y=g.search.callback||o,b=g.search.queryMethod||s,w=b(i,v,g);if(w){var _={row:h,col:d,data:v};f.push(_)}y&&y(c,h,d,v,w)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){zt(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,a,o,s,l,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,m$t(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){nd(_u(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return UD}},{key:"PLUGIN_PRIORITY",get:function(){return M$t}}]),r}(wr);function fm(e){return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fm(e)}function F$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B$t(n.key),n)}}function H$t(e,t,r){return t&&cre(e.prototype,t),r&&cre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B$t(e){var t=V$t(e,"string");return fm(t)==="symbol"?t:String(t)}function V$t(e,t){if(fm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kp(){return typeof Reflect<"u"&&Reflect.get?Kp=Reflect.get.bind():Kp=function(t,r,n){var i=W$t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Kp.apply(this,arguments)}function W$t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ac(e),e!==null););return e}function j$t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vB(e,t)}function vB(e,t){return vB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vB(e,t)}function U$t(e){var t=Y$t();return function(){var n=ac(e),i;if(t){var a=ac(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return z$t(this,i)}}function z$t(e,t){if(t&&(fm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G$t(e)}function G$t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y$t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ac(e){return ac=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ac(e)}var K$t="touchScroll",X$t=200,q$t=function(e){j$t(r,e);var t=U$t(r);function r(n){var i;return F$t(this,r),i=t.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return H$t(r,[{key:"isEnabled",value:function(){return H4()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),Kp(ac(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Kp(ac(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Kp(ac(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,a=i.topOverlay,o=i.bottomOverlay,s=i.inlineStartOverlay,l=i.topInlineStartCornerOverlay,u=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(a),o.clone&&this.scrollbars.push(o),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,ue(this.clones,function(i){Ue(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,ue(this.clones,function(a){Mt(a,"hide-tween"),Ue(a,"show-tween")}),this.hot._registerTimeout(function(){ue(i.clones,function(a){Mt(a,"show-tween")})},400),ue(this.scrollbars,function(a){a.refresh(),a.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return K$t}},{key:"PLUGIN_PRIORITY",get:function(){return X$t}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(wr);function cm(e){return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cm(e)}function Z$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q$t(n.key),n)}}function J$t(e,t,r){return t&&hre(e.prototype,t),r&&hre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q$t(e){var t=eNt(e,"string");return cm(t)==="symbol"?t:String(t)}function eNt(e,t){if(cm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function id(){return typeof Reflect<"u"&&Reflect.get?id=Reflect.get.bind():id=function(t,r,n){var i=tNt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},id.apply(this,arguments)}function tNt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Su(e),e!==null););return e}function rNt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pB(e,t)}function pB(e,t){return pB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pB(e,t)}function nNt(e){var t=oNt();return function(){var n=Su(e),i;if(t){var a=Su(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return iNt(this,i)}}function iNt(e,t){if(t&&(cm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aNt(e)}function aNt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Su(e)}var RT="trimRows",sNt=330,lNt=function(e){rNt(r,e);var t=nNt(r);function r(n){var i;return Z$t(this,r),i=t.call(this,n),i.trimmedRowsMap=null,i}return J$t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[RT]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new k1),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),id(Su(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,a=this.hot.getSettings()[RT];Array.isArray(a)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),ue(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),id(Su(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),id(Su(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var a=this,o=this.getTrimmedRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeTrimRow",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ue(i,function(f){a.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",o,l,s,s&&l.length>o.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.trimRows(a)}},{key:"untrimRows",value:function(i){var a=this.getTrimmedRows(),o=this.isValidConfig(i),s=a,l=this.trimmedRowsMap.getValues().slice(),u=i.length>0;o&&u&&(ue(i,function(c){l[c]=!1}),s=On(l,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",a,s,o&&u);f!==!1&&(o&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",a,s,o&&u,o&&s.length<a.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.untrimRows(a)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var a=this.hot.countSourceRows();return i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a})}},{key:"onMapInit",value:function(){var i=this,a=this.hot.getSettings()[RT];Array.isArray(a)&&this.hot.batchExecution(function(){ue(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"destroy",value:function(){id(Su(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return RT}},{key:"PLUGIN_PRIORITY",get:function(){return sNt}}]),r}(wr);function hm(e){return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hm(e)}function Ipe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uNt(n.key),n)}}function Mpe(e,t,r){return t&&dre(e.prototype,t),r&&dre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uNt(e){var t=fNt(e,"string");return hm(t)==="symbol"?t:String(t)}function fNt(e,t){if(hm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gB(e,t)}function gB(e,t){return gB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gB(e,t)}function $pe(e){var t=dNt();return function(){var n=BR(e),i;if(t){var a=BR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return cNt(this,i)}}function cNt(e,t){if(t&&(hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hNt(e)}function hNt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function BR(e){return BR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BR(e)}function vNt(e){return yNt(e)||gNt(e)||Lpe(e)||pNt()}function pNt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gNt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yNt(e){if(Array.isArray(e))return yB(e)}function Npe(e,t){return wNt(e)||bNt(e,t)||Lpe(e,t)||mNt()}function mNt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lpe(e,t){if(e){if(typeof e=="string")return yB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yB(e,t)}}function yB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bNt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function wNt(e){if(Array.isArray(e))return e}var Fpe="undoRedo",_Nt="undoRedo";function ut(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var i=this,a=r&&r.length;if(a){var o=r.find(function(l){var u=Npe(l,4),f=u[2],c=u[3];return f!==c});if(o){var s=function(){var u=r.reduce(function(c,h){return c.push(vNt(h)),c},[]);ue(u,function(c){c[1]=e.propToCol(c[1])});var f=a>1?i.getSelected():[[u[0][0],u[0][1]]];return new ut.ChangeAction(u,f)};t.done(s,n)}}}),e.addHook("afterCreateRow",function(r,n,i){t.done(function(){return new ut.CreateRowAction(r,n)},i)}),e.addHook("beforeRemoveRow",function(r,n,i,a){var o=function(){var l=e.toPhysicalRow(r),u=Mi(t.instance.getSourceData(l,0,l+n-1,t.instance.countSourceCols()-1));return new ut.RemoveRowAction(l,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(o,a)}),e.addHook("afterCreateCol",function(r,n,i){t.done(function(){return new ut.CreateColumnAction(r,n)},i)}),e.addHook("beforeRemoveCol",function(r,n,i,a){var o=function(){var l=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];yt(l.length-1,function(g){var y=[],b=l[g];yt(u,u+(n-1),function(w){y.push(b[e.toPhysicalColumn(w)])}),f.push(y)}),yt(n-1,function(g){h.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&yt(n-1,function(g){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new ut.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(o,a)}),e.addHook("beforeCellAlignment",function(r,n,i,a){t.done(function(){return new ut.CellAlignmentAction(r,n,i,a)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new ut.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new ut.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new ut.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new ut.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}ut.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,t);if(i!==!1){var a=e(),o=this.undoneActions.slice();this.doneActions.push(a),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())}}}};ut.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=Mi(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",a),t.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};ut.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=Mi(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",a),t.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",a,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};ut.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ut.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ut.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ut.prototype.isEnabled=function(){return this.enabled};ut.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,xNt(e),this.registerShortcuts(),e.addHook("afterChange",Hpe)}};ut.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,TNt(e),this.unregisterShortcuts(),e.removeHook("afterChange",Hpe)}};ut.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ut.Action=function(){};ut.Action.prototype.undo=function(){};ut.Action.prototype.redo=function(){};ut.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};ju(ut.ChangeAction,ut.Action);ut.ChangeAction.prototype.undo=function(e,t){for(var r=Mi(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0),a=0,o=r.length;a<o;a++)r[a].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=Npe(r[s],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};ut.ChangeAction.prototype.redo=function(e,t){for(var r=Mi(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};ut.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};ju(ut.CreateRowAction,ut.Action);ut.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ut.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ut.RemoveRowAction=function(e,t,r,n,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};ju(ut.RemoveRowAction,ut.Action);ut.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(a,o){Object.keys(a).forEach(function(s){var l=parseInt(s,10);i.push([r.index+o,isNaN(l)?s:l,a[s]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ut.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ut.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};ju(ut.CreateColumnAction,ut.Action);ut.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ut.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ut.RemoveColumnAction=function(e,t,r,n,i,a,o){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=a.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o};ju(ut.RemoveColumnAction,ut.Action);ut.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),a=function(h,d,v){return v[r.indexes.indexOf(i[d])]},o=this.data.length,s=[],l=0;l<o;l++)s.push(Ut(this.data[l],a));var u=Ut(this.headers,a),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),ue(e.getSourceDataArray(),function(c,h){ue(i,function(d,v){c[d]=s[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&ue(u,function(c,h){e.getSettings().colHeaders[i[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};ut.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ut.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};ut.CellAlignmentAction.prototype.undo=function(e,t){var r=this;ue(this.range,function(n){n.forAll(function(i,a){i>=0&&a>=0&&e.setCellMeta(i,a,"className",r.stateBefore[i][a]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};ut.CellAlignmentAction.prototype.redo=function(e,t){Of(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,i,a){return e.setCellMeta(r,n,i,a)}),e.addHookOnce("afterViewRender",t),e.render()};ut.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};ju(ut.FiltersAction,ut.Action);ut.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};ut.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var SNt=function(e){Dpe(r,e);var t=$pe(r);function r(n,i){var a;Ipe(this,r),a=t.call(this),a.cellRange=i;var o=a.cellRange.getTopStartCorner(),s=a.cellRange.getBottomEndCorner();return a.rangeData=n.getData(o.row,o.col,s.row,s.col),a}return Mpe(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange)}}]),r}(ut.Action);ut.MergeCellsAction=SNt;var CNt=function(e){Dpe(r,e);var t=$pe(r);function r(n,i){var a;return Ipe(this,r),a=t.call(this),a.cellRange=i,a}return Mpe(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0),i.render()}}]),r}(ut.Action);ut.UnmergeCellsAction=CNt;ut.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};ju(ut.RowMoveAction,ut.Action);ut.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),i=[].concat(this.rows),a=i.filter(function(f){return f>r.finalIndex}),o=i.filter(function(f){return f<=r.finalIndex}),s=a.sort(function(f,c){return c-f}).concat(o.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ut.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ut.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ut.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(o){return!o.altKey},i={runOnlyIf:n,group:Fpe};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],i)};ut.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(Fpe)};function Hpe(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function xNt(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function TNt(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var F1=ft.getSingleton();F1.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});F1.register("beforeUndo");F1.register("afterUndo");F1.register("beforeRedo");F1.register("afterRedo");ut.PLUGIN_KEY=_Nt;ut.SETTING_KEYS=!0;function ONt(){dr(Lgt),dr(lyt),dr(Oyt),dr(bmt),dr(Fmt),dr(Jde),dr(fbt),dr(jbt),dr(hve),dr(U_t),dr(ySt),dr(RSt),dr(xve),dr(I1t),dr(REt),dr(sRt),dr(IRt),dr(nkt),dr(Okt),dr(vAt),dr(TAt),dr(dPt),dr(xPt),dr(SIt),dr(jIt),dr(rMt),dr(A2t),dr(QDt),dr(y$t),dr(L$t),dr(q$t),dr(lNt),dr(ut)}function Bpe(){qvt(),cpt(),Ept(),Upt(),ONt()}var ENt=Ot,RNt=Lt,kNt=Dk.f,ANt=RNt(function(){return!Object.getOwnPropertyNames(1)});ENt({target:"Object",stat:!0,forced:ANt},{getOwnPropertyNames:kNt});function PNt(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),i=n.data("handsontable");if(typeof r!="string"){var a=r||{};return i?i.updateSettings(a):(i=new e.Core(n[0],a),n.data("handsontable",i),i.init()),n}var o;if(i)if(typeof i[r]<"u"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];o=(s=i[r]).call.apply(s,[i].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return o})}var zD,GD,YD,KD,XD;Bpe();PNt(_t);_t.__GhostTable=Pj;_t._getListenersCounter=Mqe;_t._getRegisteredMapsCounter=Ost;_t.EventManager=un;var INt=[mGe,TGe,zat,_pt,Mze,BXe,CXe,HZe,_Ge,TXe,fqe,MZe],MNt=[NXe,cqe];_t.helper={};_t.dom={};ue(INt,function(e){ue(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(_t.helper[t]=e[t])})});ue(MNt,function(e){ue(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(_t.dom[t]=e[t])})});_t.cellTypes=(zD=_t.cellTypes)!==null&&zD!==void 0?zD:{};ue(Qft(),function(e){_t.cellTypes[e]=gj(e)});_t.cellTypes.registerCellType=fs;_t.cellTypes.getCellType=gj;_t.editors=(GD=_t.editors)!==null&&GD!==void 0?GD:{};ue(Tqe(),function(e){_t.editors["".concat(Oa(e),"Editor")]=BE(e)});_t.editors.registerEditor=ba;_t.editors.getEditor=BE;_t.renderers=(YD=_t.renderers)!==null&&YD!==void 0?YD:{};ue(AJe(),function(e){var t=WE(e);e==="base"&&(_t.renderers.cellDecorator=t),_t.renderers["".concat(Oa(e),"Renderer")]=t});_t.renderers.registerRenderer=Zs;_t.renderers.getRenderer=WE;_t.validators=(KD=_t.validators)!==null&&KD!==void 0?KD:{};ue(MJe(),function(e){_t.validators["".concat(Oa(e),"Validator")]=OV(e)});_t.validators.registerValidator=Op;_t.validators.getValidator=OV;_t.plugins=(XD=_t.plugins)!==null&&XD!==void 0?XD:{};ue(TV(),function(e){_t.plugins[e]=x1(e)});_t.plugins["".concat(Oa(wr.PLUGIN_KEY),"Plugin")]=wr;_t.plugins.registerPlugin=dr;_t.plugins.getPlugin=x1;function RS(e){return RS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RS(e)}var rt;function it(e,t,r){return t=DNt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DNt(e){var t=$Nt(e,"string");return RS(t)==="symbol"?t:String(t)}function $Nt(e,t){if(RS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(RS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var at=_t.languages.dictionaryKeys,NNt=(rt={languageCode:"zh-CN"},it(rt,at.CONTEXTMENU_ITEMS_ROW_ABOVE,"上方插入行"),it(rt,at.CONTEXTMENU_ITEMS_ROW_BELOW,"下方插入行"),it(rt,at.CONTEXTMENU_ITEMS_INSERT_LEFT,"左方插入列"),it(rt,at.CONTEXTMENU_ITEMS_INSERT_RIGHT,"右方插入列"),it(rt,at.CONTEXTMENU_ITEMS_REMOVE_ROW,["移除该行","移除多行"]),it(rt,at.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["移除该列","移除多列"]),it(rt,at.CONTEXTMENU_ITEMS_UNDO,"撤销"),it(rt,at.CONTEXTMENU_ITEMS_REDO,"恢复"),it(rt,at.CONTEXTMENU_ITEMS_READ_ONLY,"只读"),it(rt,at.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"清空该列"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT,"对齐"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"左对齐"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"水平居中"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"右对齐"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"两端对齐"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"顶端对齐"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"垂直居中"),it(rt,at.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"底端对齐"),it(rt,at.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"冻结该列"),it(rt,at.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"取消冻结"),it(rt,at.CONTEXTMENU_ITEMS_BORDERS,"边框"),it(rt,at.CONTEXTMENU_ITEMS_BORDERS_TOP,"上"),it(rt,at.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"右"),it(rt,at.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"下"),it(rt,at.CONTEXTMENU_ITEMS_BORDERS_LEFT,"左"),it(rt,at.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"移除边框"),it(rt,at.CONTEXTMENU_ITEMS_ADD_COMMENT,"插入批注"),it(rt,at.CONTEXTMENU_ITEMS_EDIT_COMMENT,"编辑批注"),it(rt,at.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"删除批注"),it(rt,at.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"只读批注"),it(rt,at.CONTEXTMENU_ITEMS_MERGE_CELLS,"合并"),it(rt,at.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"取消合并"),it(rt,at.CONTEXTMENU_ITEMS_COPY,"复制"),it(rt,at.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,"带标题的复制"),it(rt,at.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,"带标题组的复制"),it(rt,at.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,"仅复制标题"),it(rt,at.CONTEXTMENU_ITEMS_CUT,"剪切"),it(rt,at.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"插入子行"),it(rt,at.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"与母行分离"),it(rt,at.CONTEXTMENU_ITEMS_HIDE_COLUMN,["隐藏该列","隐藏多列"]),it(rt,at.CONTEXTMENU_ITEMS_SHOW_COLUMN,["显示该列","显示多列"]),it(rt,at.CONTEXTMENU_ITEMS_HIDE_ROW,["隐藏该行","隐藏多行"]),it(rt,at.CONTEXTMENU_ITEMS_SHOW_ROW,["显示该行","显示多行"]),it(rt,at.FILTERS_CONDITIONS_NONE,"无"),it(rt,at.FILTERS_CONDITIONS_EMPTY,"为空"),it(rt,at.FILTERS_CONDITIONS_NOT_EMPTY,"不为空"),it(rt,at.FILTERS_CONDITIONS_EQUAL,"等于"),it(rt,at.FILTERS_CONDITIONS_NOT_EQUAL,"不等于"),it(rt,at.FILTERS_CONDITIONS_BEGINS_WITH,"开头是"),it(rt,at.FILTERS_CONDITIONS_ENDS_WITH,"结尾是"),it(rt,at.FILTERS_CONDITIONS_CONTAINS,"包含"),it(rt,at.FILTERS_CONDITIONS_NOT_CONTAIN,"不包含"),it(rt,at.FILTERS_CONDITIONS_GREATER_THAN,"大于"),it(rt,at.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"大于或等于"),it(rt,at.FILTERS_CONDITIONS_LESS_THAN,"小于"),it(rt,at.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"小于或等于"),it(rt,at.FILTERS_CONDITIONS_BETWEEN,"在此范围"),it(rt,at.FILTERS_CONDITIONS_NOT_BETWEEN,"不在此范围"),it(rt,at.FILTERS_CONDITIONS_AFTER,"之后"),it(rt,at.FILTERS_CONDITIONS_BEFORE,"之前"),it(rt,at.FILTERS_CONDITIONS_TODAY,"今天"),it(rt,at.FILTERS_CONDITIONS_TOMORROW,"明天"),it(rt,at.FILTERS_CONDITIONS_YESTERDAY,"昨天"),it(rt,at.FILTERS_VALUES_BLANK_CELLS,"空白单元格"),it(rt,at.FILTERS_DIVS_FILTER_BY_CONDITION,"按条件过滤"),it(rt,at.FILTERS_DIVS_FILTER_BY_VALUE,"按值过滤"),it(rt,at.FILTERS_LABELS_CONJUNCTION,"且"),it(rt,at.FILTERS_LABELS_DISJUNCTION,"或"),it(rt,at.FILTERS_BUTTONS_SELECT_ALL,"全选"),it(rt,at.FILTERS_BUTTONS_CLEAR,"清除"),it(rt,at.FILTERS_BUTTONS_OK,"确认"),it(rt,at.FILTERS_BUTTONS_CANCEL,"取消"),it(rt,at.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"搜索"),it(rt,at.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"值"),it(rt,at.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"第二值"),rt);_t.languages.registerLanguageDictionary(NNt);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Vpe=1252,LNt=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zj={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Gj=function(e){LNt.indexOf(e)!=-1&&(Vpe=zj[0]=e)};function FNt(){Gj(1252)}var ws=function(e){Gj(e)};function Wpe(){ws(1200),FNt()}function vre(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function HNt(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function jpe(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var gb=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?HNt(e.slice(2)):t==254&&r==255?jpe(e.slice(2)):t==65279?e.slice(1):e},kT=function(t){return String.fromCharCode(t)},pre=function(t){return String.fromCharCode(t)},Af,Hf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gre(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),t+=Hf.charAt(a)+Hf.charAt(o)+Hf.charAt(s)+Hf.charAt(l);return t}function Ja(e){var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Hf.indexOf(e.charAt(u++)),o=Hf.indexOf(e.charAt(u++)),r=a<<2|o>>4,t+=String.fromCharCode(r),s=Hf.indexOf(e.charAt(u++)),n=(o&15)<<4|s>>2,s!==64&&(t+=String.fromCharCode(n)),l=Hf.indexOf(e.charAt(u++)),i=(s&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var hr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qd=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function bc(e){return hr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function yre(e){return hr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ps=function(t){return hr?Qd(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ev(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Yj(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yj(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Pf=hr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Qd(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function BNt(e){for(var t=[],r=0,n=e.length+250,i=bc(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|s>>6&15|(o&3)<<4,i[r++]=128|s&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=bc(65535),n=65530)}return t.push(i.slice(0,r)),Pf(t)}var ia=/\u0000/g,yb=/[\u0001-\u0006]/g;function Xp(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function _s(e,t){var r=""+e;return r.length>=t?r:Cn("0",t-r.length)+r}function Kj(e,t){var r=""+e;return r.length>=t?r:Cn(" ",t-r.length)+r}function VR(e,t){var r=""+e;return r.length>=t?r:r+Cn(" ",t-r.length)}function VNt(e,t){var r=""+Math.round(e);return r.length>=t?r:Cn("0",t-r.length)+r}function WNt(e,t){var r=""+e;return r.length>=t?r:Cn("0",t-r.length)+r}var mre=Math.pow(2,32);function fp(e,t){if(e>mre||e<-mre)return VNt(e,t);var r=Math.round(e);return WNt(r,t)}function WR(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var bre=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qD=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jNt(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var jt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},wre={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},UNt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jR(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,o=1,s=0,l=1,u=0,f=0,c=Math.floor(i);u<t&&(c=Math.floor(i),s=c*o+a,f=c*u+l,!(i-c<5e-8));)i=1/(i-c),a=o,o=s,l=u,u=f;if(f>t&&(u>t?(f=l,s=a):(f=u,s=o)),!r)return[0,n*s,f];var h=Math.floor(n*s/f);return[h,n*s-h*f,f]}function ad(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],s={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,++i==86400&&(s.T=i=0,++n,++s.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=qNt(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=a,s}var Upe=new Date(1899,11,31,0,0,0),zNt=Upe.getTime(),GNt=new Date(1900,2,1,0,0,0);function zpe(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=GNt&&(r+=24*60*60*1e3),(r-(zNt+(e.getTimezoneOffset()-Upe.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Xj(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function YNt(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function KNt(e){var t=e<0?12:11,r=Xj(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function XNt(e){var t=Xj(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function kS(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=KNt(e):t===10?r=e.toFixed(10).substr(0,12):r=XNt(e),Xj(YNt(r.toUpperCase()))}function Md(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):kS(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ho(14,zpe(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function qNt(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ZNt(e,t,r,n){var i="",a=0,o=0,s=r.y,l,u=0;switch(e){case 98:s=r.y+543;case 121:switch(t.length){case 1:case 2:l=s%100,u=2;break;default:l=s%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return qD[r.m-1][1];case 5:return qD[r.m-1][0];default:return qD[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return bre[r.q][0];default:return bre[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?_s(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=_s(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=s,u=1;break}var f=u>0?_s(l,u):"";return f}function Bf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Gpe=/%/g;function JNt(e,t,r){var n=t.replace(Gpe,""),i=t.length-n.length;return Eu(e,n,r*Math.pow(10,2*i))+Cn("%",i)}function QNt(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Eu(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Ype(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Ype(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Kpe=/# (\?+)( ?)\/( ?)(\d+)/;function eLt(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),o=i-a*n,s=n;return r+(a===0?"":""+a)+" "+(o===0?Cn(" ",e[1].length+1+e[4].length):Kj(o,e[1].length)+e[2]+"/"+e[3]+_s(s,e[4].length))}function tLt(e,t,r){return r+(t===0?"":""+t)+Cn(" ",e[1].length+2+e[4].length)}var Xpe=/^#*0*\.([0#]+)/,qpe=/\).*[0#]/,Zpe=/\(###\) ###\\?-####/;function Ji(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function _re(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Sre(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function rLt(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function nLt(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function wo(e,t,r){if(e.charCodeAt(0)===40&&!t.match(qpe)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wo("n",n,r):"("+wo("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return QNt(e,t,r);if(t.indexOf("%")!==-1)return JNt(e,t,r);if(t.indexOf("E")!==-1)return Ype(t,r);if(t.charCodeAt(0)===36)return"$"+wo(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+fp(l,t.length);if(t.match(/^[#?]+$/))return i=fp(r,0),i==="0"&&(i=""),i.length>t.length?i:Ji(t.substr(0,t.length-i.length))+i;if(a=t.match(Kpe))return eLt(a,l,u);if(t.match(/^#+0+$/))return u+fp(l,t.length-t.indexOf("0"));if(a=t.match(Xpe))return i=_re(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Ji(a[1])).replace(/\.$/,"."+Ji(a[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+Cn("0",Ji(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+_re(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Bf(fp(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wo(e,t,-r):Bf(""+(Math.floor(r)+rLt(r,a[1].length)))+"."+_s(Sre(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return wo(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Xp(wo(e,t.replace(/[\\-]/g,""),r)),o=0,Xp(Xp(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(Zpe))return i=wo(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=jR(l,Math.pow(10,o)-1,!1),i=""+u,f=Eu("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=VR(s[2],o),f.length<a[4].length&&(f=Ji(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=jR(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?Kj(s[1],o)+a[2]+"/"+a[3]+VR(s[2],o):Cn(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=fp(r,0),t.length<=i.length?i:Ji(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return Ji(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=Sre(r,a[1].length),r<0?"-"+wo(e,t,-r):Bf(nLt(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?_s(0,3-v.length):"")+v})+"."+_s(o,a[1].length);switch(t){case"###,##0.00":return wo(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Bf(fp(l,0));return d!=="0"?u+d:"";case"###,###.00":return wo(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return wo(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function iLt(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Eu(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function aLt(e,t,r){var n=t.replace(Gpe,""),i=t.length-n.length;return Eu(e,n,r*Math.pow(10,2*i))+Cn("%",i)}function Jpe(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Jpe(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function qs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(qpe)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qs("n",n,r):"("+qs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return iLt(e,t,r);if(t.indexOf("%")!==-1)return aLt(e,t,r);if(t.indexOf("E")!==-1)return Jpe(t,r);if(t.charCodeAt(0)===36)return"$"+qs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+_s(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Ji(t.substr(0,t.length-i.length))+i;if(a=t.match(Kpe))return tLt(a,l,u);if(t.match(/^#+0+$/))return u+_s(l,t.length-t.indexOf("0"));if(a=t.match(Xpe))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Ji(a[1])).replace(/\.$/,"."+Ji(a[1])),i=i.replace(/\.(\d*)$/,function(v,g){return"."+g+Cn("0",Ji(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Bf(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qs(e,t,-r):Bf(""+r)+"."+Cn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return qs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Xp(qs(e,t.replace(/[\\-]/g,""),r)),o=0,Xp(Xp(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(Zpe))return i=qs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=jR(l,Math.pow(10,o)-1,!1),i=""+u,f=Eu("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=VR(s[2],o),f.length<a[4].length&&(f=Ji(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=jR(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?Kj(s[1],o)+a[2]+"/"+a[3]+VR(s[2],o):Cn(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Ji(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return Ji(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+qs(e,t,-r):Bf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?_s(0,3-v.length):"")+v})+"."+_s(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Bf(""+l);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return qs(e,t.slice(0,t.lastIndexOf(".")),r)+Ji(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Eu(e,t,r){return(r|0)===r?qs(e,t,r):wo(e,t,r)}function oLt(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Qpe=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Nm(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":WR(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Qpe))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function sLt(e,t,r,n){for(var i=[],a="",o=0,s="",l="t",u,f,c,h="H";o<e.length;)switch(s=e.charAt(o)){case"G":if(!WR(e,o))throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(c=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(c);i[i.length]={t:"t",v:a},++o;break;case"\\":var d=e.charAt(++o),v=d==="("||d===")"?d:"t";i[i.length]={t:v,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=ad(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ad(t,r),u==null))return"";for(a=s;++o<e.length&&e.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&l.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=h),i[i.length]={t:s,v:a},l=s;break;case"A":case"a":case"上":var g={t:s,v:s};if(u==null&&(u=ad(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",o+=5,h="h"):(g.t="t",++o),u==null&&g.t==="T")return"";i[i.length]=g,l=s;break;case"[":for(a=s;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Qpe)){if(u==null&&(u=ad(t,r),u==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Nm(e)||(i[i.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=s;++o<e.length&&(s=e.charAt(o))==="0";)a+=s;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<e.length&&"0#?.,E+-%".indexOf(s=e.charAt(o))>-1;)a+=s;i[i.length]={t:"n",v:a};break;case"?":for(a=s;e.charAt(++o)===s;)a+=s;i[i.length]={t:s,v:a},l=s;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"t",v:s},++o;break}var y=0,b=0,w;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,l="h",y<1&&(y=1);break;case"s":(w=i[o].v.match(/\.0+$/))&&(b=Math.max(b,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",x;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=ZNt(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(x=o+1;i[x]!=null&&((s=i[x].t)==="?"||s==="D"||(s===" "||s==="t")&&i[x+1]!=null&&(i[x+1].t==="?"||i[x+1].t==="t"&&i[x+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[x].v==="/"||i[x].v===" "&&i[x+1]!=null&&i[x+1].t=="?"));)i[o].v+=i[x].v,i[x]={v:"",t:";"},++x;_+=i[o].v,o=x-1;break;case"G":i[o].t="t",i[o].v=Md(t,r);break}var T="",O,E;if(_.length>0){_.charCodeAt(0)==40?(O=t<0&&_.charCodeAt(0)===45?-t:t,E=Eu("n",_,O)):(O=t<0&&n>1?-t:t,E=Eu("n",_,O),O<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),x=E.length-1;var M=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){M=o;break}var P=i.length;if(M===i.length&&E.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(x>=i[o].v.length-1?(x-=i[o].v.length,i[o].v=E.substr(x+1,i[o].v.length)):x<0?i[o].v="":(i[o].v=E.substr(0,x+1),x=-1),i[o].t="t",P=o);x>=0&&P<i.length&&(i[P].v=E.substr(0,x+1)+i[P].v)}else if(M!==i.length&&E.indexOf("E")===-1){for(x=E.indexOf(".")-1,o=M;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(f=i[o].v.indexOf(".")>-1&&o===M?i[o].v.indexOf(".")-1:i[o].v.length-1,T=i[o].v.substr(f+1);f>=0;--f)x>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#")&&(T=E.charAt(x--)+T);i[o].v=T,i[o].t="t",P=o}for(x>=0&&P<i.length&&(i[P].v=E.substr(0,x+1)+i[P].v),x=E.indexOf(".")+1,o=M;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==M)){for(f=i[o].v.indexOf(".")>-1&&o===M?i[o].v.indexOf(".")+1:0,T=i[o].v.substr(0,f);f<i[o].v.length;++f)x<E.length&&(T+=E.charAt(x++));i[o].v=T,i[o].t="t",P=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(O=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Eu(i[o].t,i[o].v,O),i[o].t="t");var N="";for(o=0;o!==i.length;++o)i[o]!=null&&(N+=i[o].v);return N}var Cre=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xre(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function lLt(e,t){var r=oLt(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Cre),s=r[1].match(Cre);return xre(t,o)?[n,r[0]]:xre(t,s)?[n,r[1]]:[n,r[o!=null&&s!=null?2:1]]}return[n,a]}function Ho(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:jt)[e],n==null&&(n=r.table&&r.table[wre[e]]||jt[wre[e]]),n==null&&(n=UNt[e]||"General");break}if(WR(n,0))return Md(t,r);t instanceof Date&&(t=zpe(t,r.date1904));var i=lLt(n,t);if(WR(i[1]))return Md(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return sLt(i[1],t,r,i[0])}function dd(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(jt[r]==null){t<0&&(t=r);continue}if(jt[r]==e){t=r;break}}t<0&&(t=391)}return jt[t]=e,t}function ege(){jt=jNt()}var uLt={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},tge=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fLt(e){var t=typeof e=="number"?jt[e]:e;return t=t.replace(tge,"(\\d+)"),new RegExp("^"+t+"$")}function cLt(e,t,r){var n=-1,i=-1,a=-1,o=-1,s=-1,l=-1;(t.match(tge)||[]).forEach(function(c,h){var d=parseInt(r[h+1],10);switch(c.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?s=d:i=d;break}}),l>=0&&s==-1&&i>=0&&(s=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&s==-1&&l==-1?u:n==-1&&i==-1&&a==-1?f:u+"T"+f}var hLt=function(){var e={};e.version="1.2.0";function t(){for(var E=0,M=new Array(256),P=0;P!=256;++P)E=P,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,M[P]=E;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(E){var M=0,P=0,N=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)D[N]=E[N];for(N=0;N!=256;++N)for(P=E[N],M=256+N;M<4096;M+=256)P=D[M]=P>>>8^E[P&255];var L=[];for(N=1;N!=16;++N)L[N-1]=typeof Int32Array<"u"?D.subarray(N*256,N*256+256):D.slice(N*256,N*256+256);return L}var i=n(r),a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],f=i[5],c=i[6],h=i[7],d=i[8],v=i[9],g=i[10],y=i[11],b=i[12],w=i[13],_=i[14];function x(E,M){for(var P=M^-1,N=0,D=E.length;N<D;)P=P>>>8^r[(P^E.charCodeAt(N++))&255];return~P}function T(E,M){for(var P=M^-1,N=E.length-15,D=0;D<N;)P=_[E[D++]^P&255]^w[E[D++]^P>>8&255]^b[E[D++]^P>>16&255]^y[E[D++]^P>>>24]^g[E[D++]]^v[E[D++]]^d[E[D++]]^h[E[D++]]^c[E[D++]]^f[E[D++]]^u[E[D++]]^l[E[D++]]^s[E[D++]]^o[E[D++]]^a[E[D++]]^r[E[D++]];for(N+=15;D<N;)P=P>>>8^r[(P^E[D++])&255];return~P}function O(E,M){for(var P=M^-1,N=0,D=E.length,L=0,V=0;N<D;)L=E.charCodeAt(N++),L<128?P=P>>>8^r[(P^L)&255]:L<2048?(P=P>>>8^r[(P^(192|L>>6&31))&255],P=P>>>8^r[(P^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,V=E.charCodeAt(N++)&1023,P=P>>>8^r[(P^(240|L>>8&7))&255],P=P>>>8^r[(P^(128|L>>2&63))&255],P=P>>>8^r[(P^(128|V>>6&15|(L&3)<<4))&255],P=P>>>8^r[(P^(128|V&63))&255]):(P=P>>>8^r[(P^(224|L>>12&15))&255],P=P>>>8^r[(P^(128|L>>6&63))&255],P=P>>>8^r[(P^(128|L&63))&255]);return~P}return e.table=r,e.bstr=x,e.buf=T,e.str=O,e}(),vr=function(){var t={};t.version="1.2.1";function r(j,te){for(var q=j.split("/"),J=te.split("/"),re=0,ne=0,Ae=Math.min(q.length,J.length);re<Ae;++re){if(ne=q[re].length-J[re].length)return ne;if(q[re]!=J[re])return q[re]<J[re]?-1:1}return q.length-J.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var te=j.lastIndexOf("/");return te===-1?j:j.slice(0,te+1)}function i(j){if(j.charAt(j.length-1)=="/")return i(j.slice(0,-1));var te=j.lastIndexOf("/");return te===-1?j:j.slice(te+1)}function a(j,te){typeof te=="string"&&(te=new Date(te));var q=te.getHours();q=q<<6|te.getMinutes(),q=q<<5|te.getSeconds()>>>1,j.write_shift(2,q);var J=te.getFullYear()-1980;J=J<<4|te.getMonth()+1,J=J<<5|te.getDate(),j.write_shift(2,J)}function o(j){var te=j.read_shift(2)&65535,q=j.read_shift(2)&65535,J=new Date,re=q&31;q>>>=5;var ne=q&15;q>>>=4,J.setMilliseconds(0),J.setFullYear(q+1980),J.setMonth(ne-1),J.setDate(re);var Ae=te&31;te>>>=5;var $e=te&63;return te>>>=6,J.setHours(te),J.setMinutes($e),J.setSeconds(Ae<<1),J}function s(j){vi(j,0);for(var te={},q=0;j.l<=j.length-4;){var J=j.read_shift(2),re=j.read_shift(2),ne=j.l+re,Ae={};switch(J){case 21589:q=j.read_shift(1),q&1&&(Ae.mtime=j.read_shift(4)),re>5&&(q&2&&(Ae.atime=j.read_shift(4)),q&4&&(Ae.ctime=j.read_shift(4))),Ae.mtime&&(Ae.mt=new Date(Ae.mtime*1e3));break}j.l=ne,te[J]=Ae}return te}var l;function u(){return l||(l={})}function f(j,te){if(j[0]==80&&j[1]==75)return rr(j,te);if((j[0]|32)==109&&(j[1]|32)==105)return to(j,te);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var q=3,J=512,re=0,ne=0,Ae=0,$e=0,ke=0,he=[],K=j.slice(0,512);vi(K,0);var xe=c(K);switch(q=xe[0],q){case 3:J=512;break;case 4:J=4096;break;case 0:if(xe[1]==0)return rr(j,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}J!==512&&(K=j.slice(0,J),vi(K,28));var Pe=j.slice(0,J);h(K,q);var je=K.read_shift(4,"i");if(q===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);K.l+=4,Ae=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),$e=K.read_shift(4,"i"),re=K.read_shift(4,"i"),ke=K.read_shift(4,"i"),ne=K.read_shift(4,"i");for(var Ve=-1,Ke=0;Ke<109&&(Ve=K.read_shift(4,"i"),!(Ve<0));++Ke)he[Ke]=Ve;var pt=d(j,J);y(ke,ne,pt,J,he);var Tr=w(pt,Ae,he,J);Tr[Ae].name="!Directory",re>0&&$e!==V&&(Tr[$e].name="!MiniFAT"),Tr[he[0]].name="!FAT",Tr.fat_addrs=he,Tr.ssz=J;var Dt={},fn=[],Ko=[],Ku=[];_(Ae,Tr,pt,fn,re,Dt,Ko,$e),v(Ko,Ku,fn),fn.shift();var Rc={FileIndex:Ko,FullPaths:Ku};return te&&te.raw&&(Rc.raw={header:Pe,sectors:pt}),Rc}function c(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(ee,"Header Signature: "),j.l+=16;var te=j.read_shift(2,"u");return[j.read_shift(2,"u"),te]}function h(j,te){var q=9;switch(j.l+=2,q=j.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function d(j,te){for(var q=Math.ceil(j.length/te)-1,J=[],re=1;re<q;++re)J[re-1]=j.slice(re*te,(re+1)*te);return J[q-1]=j.slice(q*te),J}function v(j,te,q){for(var J=0,re=0,ne=0,Ae=0,$e=0,ke=q.length,he=[],K=[];J<ke;++J)he[J]=K[J]=J,te[J]=q[J];for(;$e<K.length;++$e)J=K[$e],re=j[J].L,ne=j[J].R,Ae=j[J].C,he[J]===J&&(re!==-1&&he[re]!==re&&(he[J]=he[re]),ne!==-1&&he[ne]!==ne&&(he[J]=he[ne])),Ae!==-1&&(he[Ae]=J),re!==-1&&J!=he[J]&&(he[re]=he[J],K.lastIndexOf(re)<$e&&K.push(re)),ne!==-1&&J!=he[J]&&(he[ne]=he[J],K.lastIndexOf(ne)<$e&&K.push(ne));for(J=1;J<ke;++J)he[J]===J&&(ne!==-1&&he[ne]!==ne?he[J]=he[ne]:re!==-1&&he[re]!==re&&(he[J]=he[re]));for(J=1;J<ke;++J)if(j[J].type!==0){if($e=J,$e!=he[$e])do $e=he[$e],te[J]=te[$e]+"/"+te[J];while($e!==0&&he[$e]!==-1&&$e!=he[$e]);he[J]=-1}for(te[0]+="/",J=1;J<ke;++J)j[J].type!==2&&(te[J]+="/")}function g(j,te,q){for(var J=j.start,re=j.size,ne=[],Ae=J;q&&re>0&&Ae>=0;)ne.push(te.slice(Ae*L,Ae*L+L)),re-=L,Ae=Rh(q,Ae*4);return ne.length===0?Xn(0):Pf(ne).slice(0,j.size)}function y(j,te,q,J,re){var ne=V;if(j===V){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var Ae=q[j],$e=(J>>>2)-1;if(!Ae)return;for(var ke=0;ke<$e&&(ne=Rh(Ae,ke*4))!==V;++ke)re.push(ne);y(Rh(Ae,J-4),te-1,q,J,re)}}function b(j,te,q,J,re){var ne=[],Ae=[];re||(re=[]);var $e=J-1,ke=0,he=0;for(ke=te;ke>=0;){re[ke]=!0,ne[ne.length]=ke,Ae.push(j[ke]);var K=q[Math.floor(ke*4/J)];if(he=ke*4&$e,J<4+he)throw new Error("FAT boundary crossed: "+ke+" 4 "+J);if(!j[K])break;ke=Rh(j[K],he)}return{nodes:ne,data:Dre([Ae])}}function w(j,te,q,J){var re=j.length,ne=[],Ae=[],$e=[],ke=[],he=J-1,K=0,xe=0,Pe=0,je=0;for(K=0;K<re;++K)if($e=[],Pe=K+te,Pe>=re&&(Pe-=re),!Ae[Pe]){ke=[];var Ve=[];for(xe=Pe;xe>=0;){Ve[xe]=!0,Ae[xe]=!0,$e[$e.length]=xe,ke.push(j[xe]);var Ke=q[Math.floor(xe*4/J)];if(je=xe*4&he,J<4+je)throw new Error("FAT boundary crossed: "+xe+" 4 "+J);if(!j[Ke]||(xe=Rh(j[Ke],je),Ve[xe]))break}ne[Pe]={nodes:$e,data:Dre([ke])}}return ne}function _(j,te,q,J,re,ne,Ae,$e){for(var ke=0,he=J.length?2:0,K=te[j].data,xe=0,Pe=0,je;xe<K.length;xe+=128){var Ve=K.slice(xe,xe+128);vi(Ve,64),Pe=Ve.read_shift(2),je=eU(Ve,0,Pe-he),J.push(je);var Ke={name:je,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},pt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);pt!==0&&(Ke.ct=x(Ve,Ve.l-8));var Tr=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Tr!==0&&(Ke.mt=x(Ve,Ve.l-8)),Ke.start=Ve.read_shift(4,"i"),Ke.size=Ve.read_shift(4,"i"),Ke.size<0&&Ke.start<0&&(Ke.size=Ke.type=0,Ke.start=V,Ke.name=""),Ke.type===5?(ke=Ke.start,re>0&&ke!==V&&(te[ke].name="!StreamData")):Ke.size>=4096?(Ke.storage="fat",te[Ke.start]===void 0&&(te[Ke.start]=b(q,Ke.start,te.fat_addrs,te.ssz)),te[Ke.start].name=Ke.name,Ke.content=te[Ke.start].data.slice(0,Ke.size)):(Ke.storage="minifat",Ke.size<0?Ke.size=0:ke!==V&&Ke.start!==V&&te[ke]&&(Ke.content=g(Ke,te[ke].data,(te[$e]||{}).data))),Ke.content&&vi(Ke.content,0),ne[je]=Ke,Ae.push(Ke)}}function x(j,te){return new Date((Ua(j,te+4)/1e7*Math.pow(2,32)+Ua(j,te)/1e7-11644473600)*1e3)}function T(j,te){return u(),f(l.readFileSync(j),te)}function O(j,te){var q=te&&te.type;switch(q||hr&&Buffer.isBuffer(j)&&(q="buffer"),q||"base64"){case"file":return T(j,te);case"base64":return f(ps(Ja(j)),te);case"binary":return f(ps(j),te)}return f(j,te)}function E(j,te){var q=te||{},J=q.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=J+"/",j.FileIndex[0]={name:J,type:5}),q.CLSID&&(j.FileIndex[0].clsid=q.CLSID),M(j)}function M(j){var te="Sh33tJ5";if(!vr.find(j,"/"+te)){var q=Xn(4);q[0]=55,q[1]=q[3]=50,q[2]=54,j.FileIndex.push({name:te,type:2,content:q,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+te),P(j)}}function P(j,te){E(j);for(var q=!1,J=!1,re=j.FullPaths.length-1;re>=0;--re){var ne=j.FileIndex[re];switch(ne.type){case 0:J?q=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:J=!0,isNaN(ne.R*ne.L*ne.C)&&(q=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!te)){var Ae=new Date(1987,1,19),$e=0,ke=Object.create?Object.create(null):{},he=[];for(re=0;re<j.FullPaths.length;++re)ke[j.FullPaths[re]]=!0,j.FileIndex[re].type!==0&&he.push([j.FullPaths[re],j.FileIndex[re]]);for(re=0;re<he.length;++re){var K=n(he[re][0]);J=ke[K],J||(he.push([K,{name:i(K).replace("/",""),type:1,clsid:le,ct:Ae,mt:Ae,content:null}]),ke[K]=!0)}for(he.sort(function(je,Ve){return r(je[0],Ve[0])}),j.FullPaths=[],j.FileIndex=[],re=0;re<he.length;++re)j.FullPaths[re]=he[re][0],j.FileIndex[re]=he[re][1];for(re=0;re<he.length;++re){var xe=j.FileIndex[re],Pe=j.FullPaths[re];if(xe.name=i(Pe).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||le,re===0)xe.C=he.length>1?1:-1,xe.size=0,xe.type=5;else if(Pe.slice(-1)=="/"){for($e=re+1;$e<he.length&&n(j.FullPaths[$e])!=Pe;++$e);for(xe.C=$e>=he.length?-1:$e,$e=re+1;$e<he.length&&n(j.FullPaths[$e])!=n(Pe);++$e);xe.R=$e>=he.length?-1:$e,xe.type=1}else n(j.FullPaths[re+1]||"")==n(Pe)&&(xe.R=re+1),xe.type=2}}}function N(j,te){var q=te||{};if(q.fileType=="mad")return ro(j,q);switch(P(j),q.fileType){case"zip":return Ht(j,q)}var J=function(je){for(var Ve=0,Ke=0,pt=0;pt<je.FileIndex.length;++pt){var Tr=je.FileIndex[pt];if(Tr.content){var Dt=Tr.content.length;Dt>0&&(Dt<4096?Ve+=Dt+63>>6:Ke+=Dt+511>>9)}}for(var fn=je.FullPaths.length+3>>2,Ko=Ve+7>>3,Ku=Ve+127>>7,Rc=Ko+Ke+fn+Ku,Sl=Rc+127>>7,Hm=Sl<=109?0:Math.ceil((Sl-109)/127);Rc+Sl+Hm+127>>7>Sl;)Hm=++Sl<=109?0:Math.ceil((Sl-109)/127);var no=[1,Hm,Sl,Ku,fn,Ke,Ve,0];return je.FileIndex[0].size=Ve<<6,no[7]=(je.FileIndex[0].start=no[0]+no[1]+no[2]+no[3]+no[4]+no[5])+(no[6]+7>>3),no}(j),re=Xn(J[7]<<9),ne=0,Ae=0;{for(ne=0;ne<8;++ne)re.write_shift(1,ie[ne]);for(ne=0;ne<8;++ne)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ne=0;ne<3;++ne)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,J[2]),re.write_shift(4,J[0]+J[1]+J[2]+J[3]-1),re.write_shift(4,0),re.write_shift(4,1<<12),re.write_shift(4,J[3]?J[0]+J[1]+J[2]-1:V),re.write_shift(4,J[3]),re.write_shift(-4,J[1]?J[0]-1:V),re.write_shift(4,J[1]),ne=0;ne<109;++ne)re.write_shift(-4,ne<J[2]?J[1]+ne:-1)}if(J[1])for(Ae=0;Ae<J[1];++Ae){for(;ne<236+Ae*127;++ne)re.write_shift(-4,ne<J[2]?J[1]+ne:-1);re.write_shift(-4,Ae===J[1]-1?V:Ae+1)}var $e=function(je){for(Ae+=je;ne<Ae-1;++ne)re.write_shift(-4,ne+1);je&&(++ne,re.write_shift(-4,V))};for(Ae=ne=0,Ae+=J[1];ne<Ae;++ne)re.write_shift(-4,_e.DIFSECT);for(Ae+=J[2];ne<Ae;++ne)re.write_shift(-4,_e.FATSECT);$e(J[3]),$e(J[4]);for(var ke=0,he=0,K=j.FileIndex[0];ke<j.FileIndex.length;++ke)K=j.FileIndex[ke],K.content&&(he=K.content.length,!(he<4096)&&(K.start=Ae,$e(he+511>>9)));for($e(J[6]+7>>3);re.l&511;)re.write_shift(-4,_e.ENDOFCHAIN);for(Ae=ne=0,ke=0;ke<j.FileIndex.length;++ke)K=j.FileIndex[ke],K.content&&(he=K.content.length,!(!he||he>=4096)&&(K.start=Ae,$e(he+63>>6)));for(;re.l&511;)re.write_shift(-4,_e.ENDOFCHAIN);for(ne=0;ne<J[4]<<2;++ne){var xe=j.FullPaths[ne];if(!xe||xe.length===0){for(ke=0;ke<17;++ke)re.write_shift(4,0);for(ke=0;ke<3;++ke)re.write_shift(4,-1);for(ke=0;ke<12;++ke)re.write_shift(4,0);continue}K=j.FileIndex[ne],ne===0&&(K.start=K.size?K.start-1:V);var Pe=ne===0&&q.root||K.name;if(he=2*(Pe.length+1),re.write_shift(64,Pe,"utf16le"),re.write_shift(2,he),re.write_shift(1,K.type),re.write_shift(1,K.color),re.write_shift(-4,K.L),re.write_shift(-4,K.R),re.write_shift(-4,K.C),K.clsid)re.write_shift(16,K.clsid,"hex");else for(ke=0;ke<4;++ke)re.write_shift(4,0);re.write_shift(4,K.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,K.start),re.write_shift(4,K.size),re.write_shift(4,0)}for(ne=1;ne<j.FileIndex.length;++ne)if(K=j.FileIndex[ne],K.size>=4096)if(re.l=K.start+1<<9,hr&&Buffer.isBuffer(K.content))K.content.copy(re,re.l,0,K.size),re.l+=K.size+511&-512;else{for(ke=0;ke<K.size;++ke)re.write_shift(1,K.content[ke]);for(;ke&511;++ke)re.write_shift(1,0)}for(ne=1;ne<j.FileIndex.length;++ne)if(K=j.FileIndex[ne],K.size>0&&K.size<4096)if(hr&&Buffer.isBuffer(K.content))K.content.copy(re,re.l,0,K.size),re.l+=K.size+63&-64;else{for(ke=0;ke<K.size;++ke)re.write_shift(1,K.content[ke]);for(;ke&63;++ke)re.write_shift(1,0)}if(hr)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function D(j,te){var q=j.FullPaths.map(function(ke){return ke.toUpperCase()}),J=q.map(function(ke){var he=ke.split("/");return he[he.length-(ke.slice(-1)=="/"?2:1)]}),re=!1;te.charCodeAt(0)===47?(re=!0,te=q[0].slice(0,-1)+te):re=te.indexOf("/")!==-1;var ne=te.toUpperCase(),Ae=re===!0?q.indexOf(ne):J.indexOf(ne);if(Ae!==-1)return j.FileIndex[Ae];var $e=!ne.match(yb);for(ne=ne.replace(ia,""),$e&&(ne=ne.replace(yb,"!")),Ae=0;Ae<q.length;++Ae)if(($e?q[Ae].replace(yb,"!"):q[Ae]).replace(ia,"")==ne||($e?J[Ae].replace(yb,"!"):J[Ae]).replace(ia,"")==ne)return j.FileIndex[Ae];return null}var L=64,V=-2,ee="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],le="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function U(j,te,q){u();var J=N(j,q);l.writeFileSync(te,J)}function C(j){for(var te=new Array(j.length),q=0;q<j.length;++q)te[q]=String.fromCharCode(j[q]);return te.join("")}function R(j,te){var q=N(j,te);switch(te&&te.type||"buffer"){case"file":return u(),l.writeFileSync(te.filename,q),q;case"binary":return typeof q=="string"?q:C(q);case"base64":return gre(typeof q=="string"?q:C(q));case"buffer":if(hr)return Buffer.isBuffer(q)?q:Qd(q);case"array":return typeof q=="string"?ps(q):q}return q}var I;function k(j){try{var te=j.InflateRaw,q=new te;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)I=j;else throw new Error("zlib does not expose bytesRead")}catch(J){console.error("cannot use native zlib: "+(J.message||J))}}function F(j,te){if(!I)return St(j,te);var q=I.InflateRaw,J=new q,re=J._processChunk(j.slice(j.l),J._finishFlushFlag);return j.l+=J.bytesRead,re}function H(j){return I?I.deflateRawSync(j):be(j)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(j){var te=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(te>>16|te>>8|te)&255}for(var pe=typeof Uint8Array<"u",me=pe?new Uint8Array(1<<8):[],Ie=0;Ie<1<<8;++Ie)me[Ie]=we(Ie);function z(j,te){var q=me[j&255];return te<=8?q>>>8-te:(q=q<<8|me[j>>8&255],te<=16?q>>>16-te:(q=q<<8|me[j>>16&255],q>>>24-te))}function Le(j,te){var q=te&7,J=te>>>3;return(j[J]|(q<=6?0:j[J+1]<<8))>>>q&3}function ye(j,te){var q=te&7,J=te>>>3;return(j[J]|(q<=5?0:j[J+1]<<8))>>>q&7}function Xe(j,te){var q=te&7,J=te>>>3;return(j[J]|(q<=4?0:j[J+1]<<8))>>>q&15}function Ge(j,te){var q=te&7,J=te>>>3;return(j[J]|(q<=3?0:j[J+1]<<8))>>>q&31}function De(j,te){var q=te&7,J=te>>>3;return(j[J]|(q<=1?0:j[J+1]<<8))>>>q&127}function tt(j,te,q){var J=te&7,re=te>>>3,ne=(1<<q)-1,Ae=j[re]>>>J;return q<8-J||(Ae|=j[re+1]<<8-J,q<16-J)||(Ae|=j[re+2]<<16-J,q<24-J)||(Ae|=j[re+3]<<24-J),Ae&ne}function Qe(j,te,q){var J=te&7,re=te>>>3;return J<=5?j[re]|=(q&7)<<J:(j[re]|=q<<J&255,j[re+1]=(q&7)>>8-J),te+3}function G(j,te,q){var J=te&7,re=te>>>3;return q=(q&1)<<J,j[re]|=q,te+1}function Z(j,te,q){var J=te&7,re=te>>>3;return q<<=J,j[re]|=q&255,q>>>=8,j[re+1]=q,te+8}function ae(j,te,q){var J=te&7,re=te>>>3;return q<<=J,j[re]|=q&255,q>>>=8,j[re+1]=q&255,j[re+2]=q>>>8,te+16}function Se(j,te){var q=j.length,J=2*q>te?2*q:te+5,re=0;if(q>=te)return j;if(hr){var ne=yre(J);if(j.copy)j.copy(ne);else for(;re<j.length;++re)ne[re]=j[re];return ne}else if(pe){var Ae=new Uint8Array(J);if(Ae.set)Ae.set(j);else for(;re<q;++re)Ae[re]=j[re];return Ae}return j.length=J,j}function fe(j){for(var te=new Array(j),q=0;q<j;++q)te[q]=0;return te}function Te(j,te,q){var J=1,re=0,ne=0,Ae=0,$e=0,ke=j.length,he=pe?new Uint16Array(32):fe(32);for(ne=0;ne<32;++ne)he[ne]=0;for(ne=ke;ne<q;++ne)j[ne]=0;ke=j.length;var K=pe?new Uint16Array(ke):fe(ke);for(ne=0;ne<ke;++ne)he[re=j[ne]]++,J<re&&(J=re),K[ne]=0;for(he[0]=0,ne=1;ne<=J;++ne)he[ne+16]=$e=$e+he[ne-1]<<1;for(ne=0;ne<ke;++ne)$e=j[ne],$e!=0&&(K[ne]=he[$e+16]++);var xe=0;for(ne=0;ne<ke;++ne)if(xe=j[ne],xe!=0)for($e=z(K[ne],J)>>J-xe,Ae=(1<<J+4-xe)-1;Ae>=0;--Ae)te[$e|Ae<<xe]=xe&15|ne<<4;return J}var ve=pe?new Uint16Array(512):fe(512),ge=pe?new Uint16Array(32):fe(32);if(!pe){for(var Oe=0;Oe<512;++Oe)ve[Oe]=0;for(Oe=0;Oe<32;++Oe)ge[Oe]=0}(function(){for(var j=[],te=0;te<32;te++)j.push(5);Te(j,ge,32);var q=[];for(te=0;te<=143;te++)q.push(8);for(;te<=255;te++)q.push(9);for(;te<=279;te++)q.push(7);for(;te<=287;te++)q.push(8);Te(q,ve,288)})();var Ce=function(){for(var te=pe?new Uint8Array(32768):[],q=0,J=0;q<se.length-1;++q)for(;J<se[q+1];++J)te[J]=q;for(;J<32768;++J)te[J]=29;var re=pe?new Uint8Array(259):[];for(q=0,J=0;q<Q.length-1;++q)for(;J<Q[q+1];++J)re[J]=q;function ne($e,ke){for(var he=0;he<$e.length;){var K=Math.min(65535,$e.length-he),xe=he+K==$e.length;for(ke.write_shift(1,+xe),ke.write_shift(2,K),ke.write_shift(2,~K&65535);K-- >0;)ke[ke.l++]=$e[he++]}return ke.l}function Ae($e,ke){for(var he=0,K=0,xe=pe?new Uint16Array(32768):[];K<$e.length;){var Pe=Math.min(65535,$e.length-K);if(Pe<10){for(he=Qe(ke,he,+(K+Pe==$e.length)),he&7&&(he+=8-(he&7)),ke.l=he/8|0,ke.write_shift(2,Pe),ke.write_shift(2,~Pe&65535);Pe-- >0;)ke[ke.l++]=$e[K++];he=ke.l*8;continue}he=Qe(ke,he,+(K+Pe==$e.length)+2);for(var je=0;Pe-- >0;){var Ve=$e[K];je=(je<<5^Ve)&32767;var Ke=-1,pt=0;if((Ke=xe[je])&&(Ke|=K&-32768,Ke>K&&(Ke-=32768),Ke<K))for(;$e[Ke+pt]==$e[K+pt]&&pt<250;)++pt;if(pt>2){Ve=re[pt],Ve<=22?he=Z(ke,he,me[Ve+1]>>1)-1:(Z(ke,he,3),he+=5,Z(ke,he,me[Ve-23]>>5),he+=3);var Tr=Ve<8?0:Ve-4>>2;Tr>0&&(ae(ke,he,pt-Q[Ve]),he+=Tr),Ve=te[K-Ke],he=Z(ke,he,me[Ve]>>3),he-=3;var Dt=Ve<4?0:Ve-2>>1;Dt>0&&(ae(ke,he,K-Ke-se[Ve]),he+=Dt);for(var fn=0;fn<pt;++fn)xe[je]=K&32767,je=(je<<5^$e[K])&32767,++K;Pe-=pt-1}else Ve<=143?Ve=Ve+48:he=G(ke,he,1),he=Z(ke,he,me[Ve]),xe[je]=K&32767,++K}he=Z(ke,he,0)-1}return ke.l=(he+7)/8|0,ke.l}return function(ke,he){return ke.length<8?ne(ke,he):Ae(ke,he)}}();function be(j){var te=Xn(50+Math.floor(j.length*1.1)),q=Ce(j,te);return te.slice(0,q)}var He=pe?new Uint16Array(32768):fe(32768),qe=pe?new Uint16Array(32768):fe(32768),Je=pe?new Uint16Array(128):fe(128),mt=1,It=1;function ur(j,te){var q=Ge(j,te)+257;te+=5;var J=Ge(j,te)+1;te+=5;var re=Xe(j,te)+4;te+=4;for(var ne=0,Ae=pe?new Uint8Array(19):fe(19),$e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,he=pe?new Uint8Array(8):fe(8),K=pe?new Uint8Array(8):fe(8),xe=Ae.length,Pe=0;Pe<re;++Pe)Ae[W[Pe]]=ne=ye(j,te),ke<ne&&(ke=ne),he[ne]++,te+=3;var je=0;for(he[0]=0,Pe=1;Pe<=ke;++Pe)K[Pe]=je=je+he[Pe-1]<<1;for(Pe=0;Pe<xe;++Pe)(je=Ae[Pe])!=0&&($e[Pe]=K[je]++);var Ve=0;for(Pe=0;Pe<xe;++Pe)if(Ve=Ae[Pe],Ve!=0){je=me[$e[Pe]]>>8-Ve;for(var Ke=(1<<7-Ve)-1;Ke>=0;--Ke)Je[je|Ke<<Ve]=Ve&7|Pe<<3}var pt=[];for(ke=1;pt.length<q+J;)switch(je=Je[De(j,te)],te+=je&7,je>>>=3){case 16:for(ne=3+Le(j,te),te+=2,je=pt[pt.length-1];ne-- >0;)pt.push(je);break;case 17:for(ne=3+ye(j,te),te+=3;ne-- >0;)pt.push(0);break;case 18:for(ne=11+De(j,te),te+=7;ne-- >0;)pt.push(0);break;default:pt.push(je),ke<je&&(ke=je);break}var Tr=pt.slice(0,q),Dt=pt.slice(q);for(Pe=q;Pe<286;++Pe)Tr[Pe]=0;for(Pe=J;Pe<30;++Pe)Dt[Pe]=0;return mt=Te(Tr,He,286),It=Te(Dt,qe,30),te}function Et(j,te){if(j[0]==3&&!(j[1]&3))return[bc(te),2];for(var q=0,J=0,re=yre(te||1<<18),ne=0,Ae=re.length>>>0,$e=0,ke=0;!(J&1);){if(J=ye(j,q),q+=3,J>>>1)J>>1==1?($e=9,ke=5):(q=ur(j,q),$e=mt,ke=It);else{q&7&&(q+=8-(q&7));var he=j[q>>>3]|j[(q>>>3)+1]<<8;if(q+=32,he>0)for(!te&&Ae<ne+he&&(re=Se(re,ne+he),Ae=re.length);he-- >0;)re[ne++]=j[q>>>3],q+=8;continue}for(;;){!te&&Ae<ne+32767&&(re=Se(re,ne+32767),Ae=re.length);var K=tt(j,q,$e),xe=J>>>1==1?ve[K]:He[K];if(q+=xe&15,xe>>>=4,!(xe>>>8&255))re[ne++]=xe;else{if(xe==256)break;xe-=257;var Pe=xe<8?0:xe-4>>2;Pe>5&&(Pe=0);var je=ne+Q[xe];Pe>0&&(je+=tt(j,q,Pe),q+=Pe),K=tt(j,q,ke),xe=J>>>1==1?ge[K]:qe[K],q+=xe&15,xe>>>=4;var Ve=xe<4?0:xe-2>>1,Ke=se[xe];for(Ve>0&&(Ke+=tt(j,q,Ve),q+=Ve),!te&&Ae<je&&(re=Se(re,je+100),Ae=re.length);ne<je;)re[ne]=re[ne-Ke],++ne}}}return te?[re,q+7>>>3]:[re.slice(0,ne),q+7>>>3]}function St(j,te){var q=j.slice(j.l||0),J=Et(q,te);return j.l+=J[1],J[0]}function tr(j,te){if(j)typeof console<"u"&&console.error(te);else throw new Error(te)}function rr(j,te){var q=j;vi(q,0);var J=[],re=[],ne={FileIndex:J,FullPaths:re};E(ne,{root:te.root});for(var Ae=q.length-4;(q[Ae]!=80||q[Ae+1]!=75||q[Ae+2]!=5||q[Ae+3]!=6)&&Ae>=0;)--Ae;q.l=Ae+4,q.l+=4;var $e=q.read_shift(2);q.l+=6;var ke=q.read_shift(4);for(q.l=ke,Ae=0;Ae<$e;++Ae){q.l+=20;var he=q.read_shift(4),K=q.read_shift(4),xe=q.read_shift(2),Pe=q.read_shift(2),je=q.read_shift(2);q.l+=8;var Ve=q.read_shift(4),Ke=s(q.slice(q.l+xe,q.l+xe+Pe));q.l+=xe+Pe+je;var pt=q.l;q.l=Ve+4,Qt(q,he,K,ne,Ke),q.l=pt}return ne}function Qt(j,te,q,J,re){j.l+=2;var ne=j.read_shift(2),Ae=j.read_shift(2),$e=o(j);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var ke=j.read_shift(4),he=j.read_shift(4),K=j.read_shift(4),xe=j.read_shift(2),Pe=j.read_shift(2),je="",Ve=0;Ve<xe;++Ve)je+=String.fromCharCode(j[j.l++]);if(Pe){var Ke=s(j.slice(j.l,j.l+Pe));(Ke[21589]||{}).mt&&($e=Ke[21589].mt),((re||{})[21589]||{}).mt&&($e=re[21589].mt)}j.l+=Pe;var pt=j.slice(j.l,j.l+he);switch(Ae){case 8:pt=F(j,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ae)}var Tr=!1;ne&8&&(ke=j.read_shift(4),ke==134695760&&(ke=j.read_shift(4),Tr=!0),he=j.read_shift(4),K=j.read_shift(4)),he!=te&&tr(Tr,"Bad compressed size: "+te+" != "+he),K!=q&&tr(Tr,"Bad uncompressed size: "+q+" != "+K),Yu(J,je,pt,{unsafe:!0,mt:$e})}function Ht(j,te){var q=te||{},J=[],re=[],ne=Xn(1),Ae=q.compression?8:0,$e=0,ke=0,he=0,K=0,xe=0,Pe=j.FullPaths[0],je=Pe,Ve=j.FileIndex[0],Ke=[],pt=0;for(ke=1;ke<j.FullPaths.length;++ke)if(je=j.FullPaths[ke].slice(Pe.length),Ve=j.FileIndex[ke],!(!Ve.size||!Ve.content||je=="Sh33tJ5")){var Tr=K,Dt=Xn(je.length);for(he=0;he<je.length;++he)Dt.write_shift(1,je.charCodeAt(he)&127);Dt=Dt.slice(0,Dt.l),Ke[xe]=hLt.buf(Ve.content,0);var fn=Ve.content;Ae==8&&(fn=H(fn)),ne=Xn(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,$e),ne.write_shift(2,Ae),Ve.mt?a(ne,Ve.mt):ne.write_shift(4,0),ne.write_shift(-4,Ke[xe]),ne.write_shift(4,fn.length),ne.write_shift(4,Ve.content.length),ne.write_shift(2,Dt.length),ne.write_shift(2,0),K+=ne.length,J.push(ne),K+=Dt.length,J.push(Dt),K+=fn.length,J.push(fn),ne=Xn(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,$e),ne.write_shift(2,Ae),ne.write_shift(4,0),ne.write_shift(-4,Ke[xe]),ne.write_shift(4,fn.length),ne.write_shift(4,Ve.content.length),ne.write_shift(2,Dt.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,Tr),pt+=ne.l,re.push(ne),pt+=Dt.length,re.push(Dt),++xe}return ne=Xn(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,xe),ne.write_shift(2,xe),ne.write_shift(4,pt),ne.write_shift(4,K),ne.write_shift(2,0),Pf([Pf(J),Pf(re),ne])}var Bt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qr(j,te){if(j.ctype)return j.ctype;var q=j.name||"",J=q.match(/\.([^\.]+)$/);return J&&Bt[J[1]]||te&&(J=(q=te).match(/[\.\\]([^\.\\])+$/),J&&Bt[J[1]])?Bt[J[1]]:"application/octet-stream"}function _r(j){for(var te=gre(j),q=[],J=0;J<te.length;J+=76)q.push(te.slice(J,J+76));return q.join(`\r
`)+`\r
`}function fr(j){var te=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var K=he.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],J=te.split(`\r
`),re=0;re<J.length;++re){var ne=J[re];if(ne.length==0){q.push("");continue}for(var Ae=0;Ae<ne.length;){var $e=76,ke=ne.slice(Ae,Ae+$e);ke.charAt($e-1)=="="?$e--:ke.charAt($e-2)=="="?$e-=2:ke.charAt($e-3)=="="&&($e-=3),ke=ne.slice(Ae,Ae+$e),Ae+=$e,Ae<ne.length&&(ke+="="),q.push(ke)}}return q.join(`\r
`)}function or(j){for(var te=[],q=0;q<j.length;++q){for(var J=j[q];q<=j.length&&J.charAt(J.length-1)=="=";)J=J.slice(0,J.length-1)+j[++q];te.push(J)}for(var re=0;re<te.length;++re)te[re]=te[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return ps(te.join(`\r
`))}function Yo(j,te,q){for(var J="",re="",ne="",Ae,$e=0;$e<10;++$e){var ke=te[$e];if(!ke||ke.match(/^\s*$/))break;var he=ke.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":J=he[2].trim();break;case"content-type":ne=he[2].trim();break;case"content-transfer-encoding":re=he[2].trim();break}}switch(++$e,re.toLowerCase()){case"base64":Ae=ps(Ja(te.slice($e).join("")));break;case"quoted-printable":Ae=or(te.slice($e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var K=Yu(j,J.slice(q.length),Ae,{unsafe:!0});ne&&(K.ctype=ne)}function to(j,te){if(C(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=te&&te.root||"",J=(hr&&Buffer.isBuffer(j)?j.toString("binary"):C(j)).split(`\r
`),re=0,ne="";for(re=0;re<J.length;++re)if(ne=J[re],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),q||(q=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),ne.slice(0,q.length)!=q););var Ae=(J[1]||"").match(/boundary="(.*?)"/);if(!Ae)throw new Error("MAD cannot find boundary");var $e="--"+(Ae[1]||""),ke=[],he=[],K={FileIndex:ke,FullPaths:he};E(K);var xe,Pe=0;for(re=0;re<J.length;++re){var je=J[re];je!==$e&&je!==$e+"--"||(Pe++&&Yo(K,J.slice(xe,re),q),xe=re)}return K}function ro(j,te){var q=te||{},J=q.boundary||"SheetJS";J="------="+J;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+J.slice(2)+'"',"","",""],ne=j.FullPaths[0],Ae=ne,$e=j.FileIndex[0],ke=1;ke<j.FullPaths.length;++ke)if(Ae=j.FullPaths[ke].slice(ne.length),$e=j.FileIndex[ke],!(!$e.size||!$e.content||Ae=="Sh33tJ5")){Ae=Ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pt){return"_x"+pt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pt){return"_u"+pt.charCodeAt(0).toString(16)+"_"});for(var he=$e.content,K=hr&&Buffer.isBuffer(he)?he.toString("binary"):C(he),xe=0,Pe=Math.min(1024,K.length),je=0,Ve=0;Ve<=Pe;++Ve)(je=K.charCodeAt(Ve))>=32&&je<128&&++xe;var Ke=xe>=Pe*4/5;re.push(J),re.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+Ae),re.push("Content-Transfer-Encoding: "+(Ke?"quoted-printable":"base64")),re.push("Content-Type: "+qr($e,Ae)),re.push(""),re.push(Ke?fr(K):_r(K))}return re.push(J+`--\r
`),re.join(`\r
`)}function Oc(j){var te={};return E(te,j),te}function Yu(j,te,q,J){var re=J&&J.unsafe;re||E(j);var ne=!re&&vr.find(j,te);if(!ne){var Ae=j.FullPaths[0];te.slice(0,Ae.length)==Ae?Ae=te:(Ae.slice(-1)!="/"&&(Ae+="/"),Ae=(Ae+te).replace("//","/")),ne={name:i(te),type:2},j.FileIndex.push(ne),j.FullPaths.push(Ae),re||vr.utils.cfb_gc(j)}return ne.content=q,ne.size=q?q.length:0,J&&(J.CLSID&&(ne.clsid=J.CLSID),J.mt&&(ne.mt=J.mt),J.ct&&(ne.ct=J.ct)),ne}function fa(j,te){E(j);var q=vr.find(j,te);if(q){for(var J=0;J<j.FileIndex.length;++J)if(j.FileIndex[J]==q)return j.FileIndex.splice(J,1),j.FullPaths.splice(J,1),!0}return!1}function Ec(j,te,q){E(j);var J=vr.find(j,te);if(J){for(var re=0;re<j.FileIndex.length;++re)if(j.FileIndex[re]==J)return j.FileIndex[re].name=i(q),j.FullPaths[re]=q,!0}return!1}function av(j){P(j,!0)}return t.find=D,t.read=O,t.parse=f,t.write=R,t.writeFile=U,t.utils={cfb_new:Oc,cfb_add:Yu,cfb_del:fa,cfb_mov:Ec,cfb_gc:av,ReadShift:Zb,CheckField:xge,prep_blob:vi,bconcat:Pf,use_zlib:k,_deflateRaw:be,_inflateRaw:St,consts:_e},t}();function dLt(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function cl(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function qj(e){for(var t=[],r=cl(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var UR=new Date(1899,11,30,0,0,0);function sa(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=UR.getTime()+(e.getTimezoneOffset()-UR.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var rge=new Date,vLt=UR.getTime()+(rge.getTimezoneOffset()-UR.getTimezoneOffset())*6e4,Tre=rge.getTimezoneOffset();function HA(e){var t=new Date;return t.setTime(e*24*60*60*1e3+vLt),t.getTimezoneOffset()!==Tre&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Tre)*6e4),t}function pLt(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var Ore=new Date("2017-02-19T19:06:09.000Z"),nge=isNaN(Ore.getFullYear())?new Date("2/19/17"):Ore,gLt=nge.getFullYear()==2017;function ui(e,t){var r=new Date(e);if(gLt)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(nge.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Dd(e,t){if(hr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return bb(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return bb(jpe(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return bb(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return bb(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function pi(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=pi(e[r]));return t}function Cn(e,t){for(var r="";r.length<t;)r+=e;return r}function Ss(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var yLt=["january","february","march","april","may","june","july","august","september","october","november","december"];function dm(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&yLt.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var mLt=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],s=1;s<a.length;++s)o.push(i),o.push(a[s]);return o}}();function ige(e){return e?e.content&&e.type?Dd(e.content,!0):e.data?gb(e.data):e.asNodeBuffer&&hr?gb(e.asNodeBuffer().toString("binary")):e.asBinary?gb(e.asBinary()):e._data&&e._data.getContent?gb(Dd(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function age(e){if(!e)return null;if(e.data)return vre(e.data);if(e.asNodeBuffer&&hr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?vre(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function bLt(e){return e&&e.name.slice(-4)===".bin"?age(e):ige(e)}function Co(e,t){for(var r=e.FullPaths||cl(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Zj(e,t){var r=Co(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Vn(e,t,r){if(!r)return bLt(Zj(e,t));if(!t)return null;try{return Vn(e,t)}catch{return null}}function Ga(e,t,r){if(!r)return ige(Zj(e,t));if(!t)return null;try{return Ga(e,t)}catch{return null}}function oge(e,t,r){if(!r)return age(Zj(e,t));if(!t)return null;try{return oge(e,t)}catch{return null}}function Ere(e){for(var t=e.FullPaths||cl(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function wLt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return hr?n=Qd(r):n=BNt(r),vr.utils.cfb_add(e,t,n)}vr.utils.cfb_add(e,t,r)}else e.file(t,r)}function sge(e,t){switch(t.type){case"base64":return vr.read(e,{type:"base64"});case"binary":return vr.read(e,{type:"binary"});case"buffer":case"array":return vr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function mb(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var lge=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_Lt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Rre=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,SLt=/<[^>]*>/g,Li=lge.match(Rre)?Rre:SLt,CLt=/<\w*:/,xLt=/<(\/?)\w+:/;function At(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(_Lt),s=0,l="",u=0,f="",c="",h=1;if(o)for(u=0;u!=o.length;++u){for(c=o[u],a=0;a!=c.length&&c.charCodeAt(a)!==61;++a);for(f=c.slice(0,a).trim();c.charCodeAt(a+1)==32;)++a;for(h=(i=c.charCodeAt(a+1))==34||i==39?1:0,l=c.slice(a+1+h,c.length-h),s=0;s!=f.length&&f.charCodeAt(s)!==58;++s);if(s===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,r||(n[f.toLowerCase()]=l);else{var d=(s===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(s+1);if(n[d]&&f.slice(s-3,s)=="ext")continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function wl(e){return e.replace(xLt,"<$1")}var uge={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},TLt=qj(uge),br=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(s,l){return uge[s]||String.fromCharCode(parseInt(l,s.indexOf("x")>-1?16:10))||s}).replace(t,function(s,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),OLt=/[&<>'"]/g,ELt=/[\u0000-\u001f]/g;function Jj(e){var t=e+"";return t.replace(OLt,function(r){return TLt[r]}).replace(/\n/g,"<br/>").replace(ELt,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var kre=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function an(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ZD(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),s=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(s&1023))}return t}function Are(e){var t=bc(2*e.length),r,n,i=1,a=0,o=0,s;for(n=0;n<e.length;n+=i)i=1,(s=e.charCodeAt(n))<128?r=s:s<224?(r=(s&31)*64+(e.charCodeAt(n+1)&63),i=2):s<240?(r=(s&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(s&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Pre(e){return Qd(e,"binary").toString("utf8")}var AT="foo bar bazâð£",Kr=hr&&(Pre(AT)==ZD(AT)&&Pre||Are(AT)==ZD(AT)&&Are)||ZD,bb=hr?function(e){return Qd(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},AS=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),fge=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),RLt=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),kLt=/<\/?(?:vt:)?variant>/g,ALt=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ire(e,t){var r=At(e),n=e.match(RLt(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(kLt,"").match(ALt);o&&i.push({v:Kr(o[2]),t:o[1]})}),i}var PLt=/(^\s|\s$|\n)/;function ILt(e){return cl(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function MLt(e,t,r){return"<"+e+(r!=null?ILt(r):"")+(t!=null?(t.match(PLt)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Qj(e){if(hr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Kr(ev(Yj(e)));throw new Error("Bad input format: expected Buffer or string")}var PS=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,DLt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$Lt=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function NLt(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function LLt(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=n?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var s=0;s<=5;++s,a/=256)e[r+s]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Mre=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Dre=hr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Qd(t)})):Mre(e)}:Mre,$re=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Cu(e,i)));return n.join("").replace(ia,"")},eU=hr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ia,""):$re(e,t,r)}:$re,Nre=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},cge=hr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Nre(e,t,r)}:Nre,Lre=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(mp(e,i)));return n.join("")},H1=hr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Lre(t,r,n)}:Lre,hge=function(e,t){var r=Ua(e,t);return r>0?H1(e,t+4,t+4+r-1):""},dge=hge,vge=function(e,t){var r=Ua(e,t);return r>0?H1(e,t+4,t+4+r-1):""},pge=vge,gge=function(e,t){var r=2*Ua(e,t);return r>0?H1(e,t+4,t+4+r-1):""},yge=gge,mge=function(t,r){var n=Ua(t,r);return n>0?eU(t,r+4,r+4+n):""},bge=mge,wge=function(e,t){var r=Ua(e,t);return r>0?H1(e,t+4,t+4+r):""},_ge=wge,Sge=function(e,t){return NLt(e,t)},zR=Sge,Cge=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};hr&&(dge=function(t,r){if(!Buffer.isBuffer(t))return hge(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},pge=function(t,r){if(!Buffer.isBuffer(t))return vge(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},yge=function(t,r){if(!Buffer.isBuffer(t))return gge(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},bge=function(t,r){if(!Buffer.isBuffer(t))return mge(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},_ge=function(t,r){if(!Buffer.isBuffer(t))return wge(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},zR=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Sge(t,r)},Cge=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var mp=function(e,t){return e[t]},Cu=function(e,t){return e[t+1]*(1<<8)+e[t]},FLt=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ua=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Rh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},HLt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Zb(e,t){var r="",n,i,a=[],o,s,l,u;switch(t){case"dbcs":if(u=this.l,hr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Cu(this,u)),u+=2;e*=2;break;case"utf8":r=H1(this,this.l,this.l+e);break;case"utf16le":e*=2,r=eU(this,this.l,this.l+e);break;case"wstr":return Zb.call(this,e,"dbcs");case"lpstr-ansi":r=dge(this,this.l),e=4+Ua(this,this.l);break;case"lpstr-cp":r=pge(this,this.l),e=4+Ua(this,this.l);break;case"lpwstr":r=yge(this,this.l),e=4+2*Ua(this,this.l);break;case"lpp4":e=4+Ua(this,this.l),r=bge(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ua(this,this.l),r=_ge(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=mp(this,this.l+e++))!==0;)a.push(kT(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=Cu(this,this.l+e))!==0;)a.push(kT(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=mp(this,u),this.l=u+1,s=Zb.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(kT(Cu(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=mp(this,u),this.l=u+1,s=Zb.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(kT(mp(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=mp(this,this.l),this.l++,n;case 2:return n=(t==="i"?FLt:Cu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Rh:HLt)(this,this.l),this.l+=4,n):(i=Ua(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=zR(this,this.l):i=zR([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=cge(this,this.l,e);break}}return this.l+=e,r}var BLt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},VLt=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},WLt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function jLt(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)WLt(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,BLt(this,t,this.l);break;case 8:if(n=8,r==="f"){LLt(this,t,this.l);break}case 16:break;case-4:n=4,VLt(this,t,this.l);break}return this.l+=n,this}function xge(e,t){var r=cge(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function vi(e,t){e.l=t,e.read_shift=Zb,e.chk=xge,e.write_shift=jLt}function Di(e,t){e.l+=t}function Xn(e){var t=bc(e);return vi(t,0),t}function Gu(e,t,r){if(e){var n,i,a;vi(e,e.l||0);for(var o=e.length,s=0,l=0;e.l<o;){s=e.read_shift(1),s&128&&(s=(s&127)+((e.read_shift(1)&127)<<7));var u=ZR[s]||ZR[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;l=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=l,t(f,u,s))return}}}function mB(){var e=[],t=hr?256:2048,r=function(u){var f=Xn(u);return vi(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Pf(e)},s=function(u){i(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:s,end:o,_bufs:e}}function Jb(e,t,r){var n=pi(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Fre(e,t,r){var n=pi(e);return n.s=Jb(n.s,t.s,r),n.e=Jb(n.e,t.s,r),n}function Qb(e,t){if(e.cRel&&e.c<0)for(e=pi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=$t(e);return!e.cRel&&e.cRel!=null&&(r=GLt(r)),!e.rRel&&e.rRel!=null&&(r=ULt(r)),r}function JD(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Jn(e.s.c)+":"+(e.e.cRel?"":"$")+Jn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+gi(e.s.r)+":"+(e.e.rRel?"":"$")+gi(e.e.r):Qb(e.s,t.biff)+":"+Qb(e.e,t.biff)}function tU(e){return parseInt(zLt(e),10)-1}function gi(e){return""+(e+1)}function ULt(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function zLt(e){return e.replace(/\$(\d+)$/,"$1")}function rU(e){for(var t=YLt(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Jn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function GLt(e){return e.replace(/^([A-Z])/,"$$$1")}function YLt(e){return e.replace(/^\$([A-Z])/,"$1")}function KLt(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ra(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function $t(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Lm(e){var t=e.indexOf(":");return t==-1?{s:ra(e),e:ra(e)}:{s:ra(e.slice(0,t)),e:ra(e.slice(t+1))}}function gr(e,t){return typeof t>"u"||typeof t=="number"?gr(e.s,e.e):(typeof e!="string"&&(e=$t(e)),typeof t!="string"&&(t=$t(t)),e==t?e:e+":"+t)}function xn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Hre(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ho(e.z,r?sa(t):t)}catch{}try{return e.w=Ho((e.XF||{}).numFmtId||(r?14:0),r?sa(t):t)}catch{return""+t}}function Lu(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?nv[e.v]||e.v:t==null?Hre(e,e.v):Hre(e,t))}function Tc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Tge(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),o=0,s=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?ra(n.origin):n.origin;o=l.r,s=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=xn(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(u.e.r=o=f.e.r+1)}for(var c=0;c!=t.length;++c)if(t[c]){if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[c].length;++h)if(!(typeof t[c][h]>"u")){var d={v:t[c][h]},v=o+c,g=s+h;if(u.s.r>v&&(u.s.r=v),u.s.c>g&&(u.s.c=g),u.e.r<v&&(u.e.r=v),u.e.c<g&&(u.e.c=g),t[c][h]&&typeof t[c][h]=="object"&&!Array.isArray(t[c][h])&&!(t[c][h]instanceof Date))d=t[c][h];else if(Array.isArray(d.v)&&(d.f=t[c][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||jt[14],n.cellDates?(d.t="d",d.w=Ho(d.z,sa(d.v))):(d.t="n",d.v=sa(d.v),d.w=Ho(d.z,d.v))):d.t="s";if(i)a[v]||(a[v]=[]),a[v][g]&&a[v][g].z&&(d.z=a[v][g].z),a[v][g]=d;else{var y=$t({c:g,r:v});a[y]&&a[y].z&&(d.z=a[y].z),a[y]=d}}}return u.s.c<1e7&&(a["!ref"]=gr(u)),a}function Fm(e,t){return Tge(null,e,t)}function XLt(e){return e.read_shift(4,"i")}function Ai(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function qLt(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function nU(e,t){var r=e.l,n=e.read_shift(1),i=Ai(e),a=[],o={t:i,h:i};if(n&1){for(var s=e.read_shift(4),l=0;l!=s;++l)a.push(qLt(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var ZLt=nU;function Go(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function tv(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var JLt=Ai;function iU(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var QLt=Ai,bB=iU;function aU(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?zR([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Rh(t,0)>>2;return r?i/100:i}function Oge(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var rv=Oge;function Oi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function eFt(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=vd[i];u&&(t.rgb=MS(u));break;case 2:t.rgb=MS([o,s,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function tFt(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Ege(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function rFt(e){return Ege(e,1)}function nFt(e){return Ege(e,2)}var oU=2,_a=3,PT=11,Bre=12,GR=19,IT=64,iFt=65,aFt=71,oFt=4108,sFt=4126,si=80,Rge=81,lFt=[si,Rge],uFt={1:{n:"CodePage",t:oU},2:{n:"Category",t:si},3:{n:"PresentationFormat",t:si},4:{n:"ByteCount",t:_a},5:{n:"LineCount",t:_a},6:{n:"ParagraphCount",t:_a},7:{n:"SlideCount",t:_a},8:{n:"NoteCount",t:_a},9:{n:"HiddenCount",t:_a},10:{n:"MultimediaClipCount",t:_a},11:{n:"ScaleCrop",t:PT},12:{n:"HeadingPairs",t:oFt},13:{n:"TitlesOfParts",t:sFt},14:{n:"Manager",t:si},15:{n:"Company",t:si},16:{n:"LinksUpToDate",t:PT},17:{n:"CharacterCount",t:_a},19:{n:"SharedDoc",t:PT},22:{n:"HyperlinksChanged",t:PT},23:{n:"AppVersion",t:_a,p:"version"},24:{n:"DigSig",t:iFt},26:{n:"ContentType",t:si},27:{n:"ContentStatus",t:si},28:{n:"Language",t:si},29:{n:"Version",t:si},255:{},2147483648:{n:"Locale",t:GR},2147483651:{n:"Behavior",t:GR},1919054434:{}},fFt={1:{n:"CodePage",t:oU},2:{n:"Title",t:si},3:{n:"Subject",t:si},4:{n:"Author",t:si},5:{n:"Keywords",t:si},6:{n:"Comments",t:si},7:{n:"Template",t:si},8:{n:"LastAuthor",t:si},9:{n:"RevNumber",t:si},10:{n:"EditTime",t:IT},11:{n:"LastPrinted",t:IT},12:{n:"CreatedDate",t:IT},13:{n:"ModifiedDate",t:IT},14:{n:"PageCount",t:_a},15:{n:"WordCount",t:_a},16:{n:"CharCount",t:_a},17:{n:"Thumbnail",t:aFt},18:{n:"Application",t:si},19:{n:"DocSecurity",t:_a},255:{},2147483648:{n:"Locale",t:GR},2147483651:{n:"Behavior",t:GR},1919054434:{}},Vre={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cFt=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function hFt(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var dFt=hFt([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vd=pi(dFt),nv={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},kge={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Wre={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function vFt(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pFt(e){var t=vFt();if(!e||!e.match)return t;var r={};if((e.match(Li)||[]).forEach(function(n){var i=At(n);switch(i[0].replace(CLt,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Wre[i.ContentType]]!==void 0&&t[Wre[i.ContentType]].push(i.PartName);break}}),t.xmlns!==DLt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Rp={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wB(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ew(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Li)||[]).forEach(function(i){var a=At(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var s=a.TargetMode==="External"?a.Target:mb(a.Target,t);r[s]=o,n[a.Id]=o}}),r["!id"]=n,r}var gFt="application/vnd.oasis.opendocument.spreadsheet";function yFt(e,t){for(var r=Qj(e),n,i;n=PS.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=At(n[0],!1),i.path=="/"&&i.type!==gFt)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var tw=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],mFt=function(){for(var e=new Array(tw.length),t=0;t<tw.length;++t){var r=tw[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Age(e){var t={};e=Kr(e);for(var r=0;r<tw.length;++r){var n=tw[r],i=e.match(mFt[r]);i!=null&&i.length>0&&(t[n[1]]=br(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ui(t[n[1]]))}return t}var bFt=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Pge(e,t,r,n){var i=[];if(typeof e=="string")i=Ire(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(f){return{v:f}}));var o=typeof t=="string"?Ire(t,n).map(function(f){return f.v}):t,s=0,l=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=o.slice(s,s+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(s,s+l);break}s+=l}}function wFt(e,t,r){var n={};return t||(t={}),e=Kr(e),bFt.forEach(function(i){var a=(e.match(AS(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=br(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Pge(n.HeadingPairs,n.TitlesOfParts,t,r),t}var _Ft=/<[^>]+>[^<]*/g;function SFt(e,t){var r={},n="",i=e.match(_Ft);if(i)for(var a=0;a!=i.length;++a){var o=i[a],s=At(o);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":n=br(s.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=br(f);break;case"bool":r[n]=an(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=ui(f);break;case"cy":case"error":r[n]=br(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var CFt={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},QD;function xFt(e,t,r){QD||(QD=qj(CFt)),t=QD[t]||t,e[t]=r}function sU(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ige(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Mge(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Dge(e,t,r){return t===31?Mge(e):Ige(e,t,r)}function _B(e,t,r){return Dge(e,t,r===!1?0:4)}function TFt(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Dge(e,t,0)}function OFt(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ia,""),e.l-i&2&&(e.l+=2)}return r}function EFt(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ia,"");return r}function RFt(e){var t=e.l,r=YR(e,Rge);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=YR(e,_a);return[r,n]}function kFt(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(RFt(e));return r}function jre(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(ia,"").replace(yb,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function $ge(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function AFt(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function YR(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==Bre&&n!==t&&lFt.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Bre?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Ige(e,n,4).replace(ia,"");case 31:return Mge(e);case 64:return sU(e);case 65:return $ge(e);case 71:return AFt(e);case 80:return _B(e,n,!a.raw).replace(ia,"");case 81:return TFt(e,n).replace(ia,"");case 4108:return kFt(e);case 4126:case 4127:return n==4127?OFt(e):EFt(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Ure(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,s=0,l=-1,u={};for(o=0;o!=i;++o){var f=e.read_shift(4),c=e.read_shift(4);a[o]=[f,c+r]}a.sort(function(w,_){return w[1]-_[1]});var h={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var d=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(d=!1,e.l=a[o][1]),d)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[a[o][0]];if(h[v.n]=YR(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ws(s=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(a[o][0]===1){if(s=h.CodePage=YR(e,oU),ws(s),l!==-1){var g=e.l;e.l=a[l][1],u=jre(e,s),e.l=g}}else if(a[o][0]===0){if(s===0){l=o,e.l=a[o+1][1];continue}u=jre(e,s)}else{var y=u[a[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=$ge(e);break;case 30:e.l+=4,b=_B(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=_B(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=An(e,4);break;case 64:e.l+=4,b=ui(sU(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=b}}return e.l=r+n,h}function zre(e,t,r){var n=e.content;if(!n)return{};vi(n,0);var i,a,o,s,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==vr.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),s=n.read_shift(4),i===1&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var c=Ure(n,t),h={SystemIdentifier:u};for(var d in c)h[d]=c[d];if(h.FMTID=a,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=Ure(n,null)}catch{}for(d in v)h[d]=v[d];return h.FMTID=[a,o],h}function Sf(e,t){return e.read_shift(t),null}function PFt(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function An(e,t){return e.read_shift(t)===1}function Wn(e){return e.read_shift(2,"u")}function Nge(e,t){return PFt(e,t,Wn)}function IFt(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function B1(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function MFt(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,s,l={};i&&(o=e.read_shift(2)),n&&(s=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=s),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function $d(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function V1(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):$d(e,n,r)}function iv(e,t,r){if(r.biff>5)return V1(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function DFt(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function $Ft(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ia,"");return n&&(e.l+=24),i}function NFt(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(ia,"");return r+o}function LFt(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return $Ft(e);case"0303000000000000c000000000000046":return NFt(e);default:throw new Error("Unsupported Moniker "+r)}}function MT(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ia,""):"";return r}function FFt(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,s,l,u="",f,c;i&16&&(a=MT(e,r-e.l)),i&128&&(o=MT(e,r-e.l)),(i&257)===257&&(s=MT(e,r-e.l)),(i&257)===1&&(l=LFt(e,r-e.l)),i&8&&(u=MT(e,r-e.l)),i&32&&(f=e.read_shift(16)),i&64&&(c=sU(e)),e.l=r;var h=o||s||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return f&&(d.guid=f),c&&(d.time=c),a&&(d.Tooltip=a),d}function Lge(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function Fge(e,t){var r=Lge(e);return r[3]=0,r}function _l(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function HFt(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function BFt(e,t,r){return t===0?"":iv(e,t,r)}function VFt(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function Hge(e){var t=e.read_shift(2),r=aU(e);return[t,r]}function WFt(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=B1(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function BA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Bge(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var jFt=Bge;function Vge(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function UFt(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function zFt(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function _i(e){e.l+=2,e.l+=e.read_shift(2)}var GFt={0:_i,4:_i,5:_i,6:_i,7:zFt,8:_i,9:_i,10:_i,11:_i,12:_i,13:UFt,14:_i,15:_i,16:_i,17:_i,18:_i,19:_i,20:_i,21:Vge};function YFt(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(GFt[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function DT(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function KFt(e,t){return t===0||e.read_shift(2),1200}function XFt(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=iv(e,0,r);return e.read_shift(t+n-e.l),i}function qFt(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ZFt(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=B1(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function JFt(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<r;++o)a.push(MFt(e));return a.Count=n,a.Unique=i,a}function QFt(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function eHt(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function tHt(e){var t=HFt(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function rHt(e){return e.read_shift(2),e.read_shift(4)}function Gre(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function nHt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:s,Selected:l,TabRatio:u}}function iHt(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function aHt(){}function oHt(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=B1(e,0,r),n}function sHt(e){var t=_l(e);return t.isst=e.read_shift(4),t}function lHt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=_l(e);r.biff==2&&e.l++;var a=V1(e,n-e.l,r);return i.val=a,i}function uHt(e,t,r){var n=e.read_shift(2),i=iv(e,0,r);return[n,i]}var fHt=iv;function Yre(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),s=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:s},e:{r:o,c:l}}}function cHt(e){var t=e.read_shift(2),r=e.read_shift(2),n=Hge(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function hHt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(Hge(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function dHt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function vHt(e,t,r,n){var i={},a=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(2);return i.patternType=cFt[s>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=s&127,i.icvBottom=s>>7&127,i.icvDiag=s>>14&127,i.dgDiag=s>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function pHt(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=vHt(e,t,n.fStyle,r),n}function gHt(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Kre(e,t,r){var n=_l(e);(r.biff==2||t==9)&&++e.l;var i=IFt(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function yHt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_l(e),i=Oi(e);return n.val=i,n}var Xre=BFt;function mHt(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=$d(e,a),s=[];n>e.l;)s.push(V1(e));return[a,i,o,s]}function qre(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=WFt(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var bHt=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Zre(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=$d(e,o,r);i&32&&(u=bHt[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var c=n==e.l||s===0||!(f>0)?[]:eVt(e,f,r,s);return{chKey:a,Name:u,itab:l,rgce:c}}function Wge(e,t,r){if(r.biff<8)return wHt(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(VFt(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function wHt(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=B1(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _Ht(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=$d(e,n,r),o=$d(e,i,r);return[a,o]}function SHt(e,t,r){var n=Bge(e);e.l++;var i=e.read_shift(1);return t-=8,[tVt(e,t,r),i,n]}function Jre(e,t,r){var n=jFt(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,J4t(e,t,r)]}function CHt(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function xHt(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=iv(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},s,o,a]}}function THt(e,t,r){return xHt(e,t,r)}function OHt(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(BA(e));return r}function EHt(e,t,r){if(r&&r.biff<8)return kHt(e,t,r);var n=Vge(e),i=YFt(e,t-22,n[1]);return{cmo:n,ft:i}}var RHt={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function kHt(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((RHt[n]||Di)(e,t,r)),{cmo:[i,n,a],ft:o}}function AHt(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=DFt(e,6,r);var s=e.read_shift(2);e.read_shift(2),Wn(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],c=$d(e,e.lens[u+1]-e.lens[u]-1);if(i+=c,i.length>=(f?s:2*s))break}if(i.length!==s&&i.length!==s*2)throw new Error("cchText: "+s+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function PHt(e,t){var r=BA(e);e.l+=16;var n=FFt(e,t-24);return[r,n]}function IHt(e,t){e.read_shift(2);var r=BA(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ia,""),[r,n]}function MHt(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Vre[r]||r,r=e.read_shift(2),t[1]=Vre[r]||r,t}function DHt(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Fge(e));return r}function $Ht(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Fge(e));return r}function NHt(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function jge(e,t,r){if(!r.cellStyles)return Di(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:a,w:o,ixfe:s,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function LHt(e,t){var r={};return t<32||(e.l+=16,r.header=Oi(e),r.footer=Oi(e),e.l+=2),r}function FHt(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var HHt=_l,BHt=Nge,VHt=V1;function WHt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function jHt(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_l(e);++e.l;var i=iv(e,t-7,r);return n.t="str",n.val=i,n}function UHt(e){var t=_l(e);++e.l;var r=Oi(e);return t.t="n",t.val=r,t}function zHt(e){var t=_l(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function GHt(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function YHt(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function KHt(e,t,r){var n=e.l+t,i=_l(e),a=e.read_shift(2),o=$d(e,a,r);return e.l=n,i.t="str",i.val=o,i}var XHt=[2,3,48,49,131,139,140,245],Qre=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=qj({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(s,l){var u=[],f=bc(1);switch(l.type){case"base64":f=ps(Ja(s));break;case"binary":f=ps(s);break;case"buffer":case"array":f=s;break}vi(f,0);var c=f.read_shift(1),h=!!(c&136),d=!1,v=!1;switch(c){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+c.toString(16))}var g=0,y=521;c==2&&(g=f.read_shift(2)),f.l+=3,c!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),c!=2&&(y=f.read_shift(2));var b=f.read_shift(2),w=l.codepage||1252;c!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var _=[],x={},T=Math.min(f.length,c==2?521:y-10-(d?264:0)),O=v?32:11;f.l<T&&f[f.l]!=13;)switch(x={},x.name=Af.utils.decode(w,f.slice(f.l,f.l+O)).replace(/[\u0000\r\n].*$/g,""),f.l+=O,x.type=String.fromCharCode(f.read_shift(1)),c!=2&&!v&&(x.offset=f.read_shift(4)),x.len=f.read_shift(1),c==2&&(x.offset=f.read_shift(2)),x.dec=f.read_shift(1),x.name.length&&_.push(x),c!=2&&(f.l+=v?13:14),x.type){case"B":(!d||x.len!=8)&&l.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+x.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var E=0,M=0;for(u[0]=[],M=0;M!=_.length;++M)u[0][M]=_[M].name;for(;g-- >0;){if(f[f.l]===42){f.l+=b;continue}for(++f.l,u[++E]=[],M=0,M=0;M!=_.length;++M){var P=f.slice(f.l,f.l+_[M].len);f.l+=_[M].len,vi(P,0);var N=Af.utils.decode(w,P);switch(_[M].type){case"C":N.trim().length&&(u[E][M]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[E][M]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[E][M]=N;break;case"F":u[E][M]=parseFloat(N.trim());break;case"+":case"I":u[E][M]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[E][M]=!0;break;case"N":case"F":u[E][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+c.toString(16));u[E][M]="##MEMO##"+(v?parseInt(N.trim(),10):P.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[E][M]=+N||0);break;case"@":u[E][M]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[E][M]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[E][M]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][M]=-P.read_shift(-8,"f");break;case"B":if(d&&_[M].len==8){u[E][M]=P.read_shift(8,"f");break}case"G":case"P":P.l+=_[M].len;break;case"0":if(_[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[M].type)}}}if(c!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(s,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Fm(r(s,u),u);return f["!cols"]=u.DBF.map(function(c){return{wch:c.len,DBF:c}}),delete u.DBF,f}function i(s,l){try{return Tc(n(s,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,l){var u=l||{};if(+u.codepage>=0&&ws(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=mB(),c=RB(s,{header:1,raw:!0,cellDates:!0}),h=c[0],d=c.slice(1),v=s["!cols"]||[],g=0,y=0,b=0,w=1;for(g=0;g<h.length;++g){if(((v[g]||{}).DBF||{}).name){h[g]=v[g].DBF.name,++b;continue}if(h[g]!=null){if(++b,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var _=xn(s["!ref"]),x=[],T=[],O=[];for(g=0;g<=_.e.c-_.s.c;++g){var E="",M="",P=0,N=[];for(y=0;y<d.length;++y)d[y][g]!=null&&N.push(d[y][g]);if(N.length==0||h[g]==null){x[g]="?";continue}for(y=0;y<N.length;++y){switch(typeof N[y]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=N[y]instanceof Date?"D":"C";break;default:M="C"}P=Math.max(P,String(N[y]).length),E=E&&E!=M?"C":M}P>250&&(P=250),M=((v[g]||{}).DBF||{}).type,M=="C"&&v[g].DBF.len>P&&(P=v[g].DBF.len),E=="B"&&M=="N"&&(E="N",O[g]=v[g].DBF.dec,P=v[g].DBF.len),T[g]=E=="C"||M=="N"?P:a[E]||0,w+=T[g],x[g]=E}var D=f.next(32);for(D.write_shift(4,318902576),D.write_shift(4,d.length),D.write_shift(2,296+32*b),D.write_shift(2,w),g=0;g<4;++g)D.write_shift(4,0);for(D.write_shift(4,0|(+t[Vpe]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var L=f.next(32),V=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,V,"sbcs"),L.write_shift(1,x[g]=="?"?"C":x[g],"sbcs"),L.write_shift(4,y),L.write_shift(1,T[g]||a[x[g]]||0),L.write_shift(1,O[g]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),y+=T[g]||a[x[g]]||0}var ee=f.next(264);for(ee.write_shift(4,13),g=0;g<65;++g)ee.write_shift(4,0);for(g=0;g<d.length;++g){var ie=f.next(w);for(ie.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(x[y]){case"L":ie.write_shift(1,d[g][y]==null?63:d[g][y]?84:70);break;case"B":ie.write_shift(8,d[g][y]||0,"f");break;case"N":var le="0";for(typeof d[g][y]=="number"&&(le=d[g][y].toFixed(O[y]||0)),b=0;b<T[y]-le.length;++b)ie.write_shift(1,32);ie.write_shift(1,le,"sbcs");break;case"D":d[g][y]?(ie.write_shift(4,("0000"+d[g][y].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(d[g][y].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+d[g][y].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(d[g][y]!=null?d[g][y]:"").slice(0,T[y]);for(ie.write_shift(1,_e,"sbcs"),b=0;b<T[y]-_e.length;++b)ie.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),qHt=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+cl(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var v=e[d];return typeof v=="number"?pre(v):v},n=function(h,d,v){var g=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?h:pre(g)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return a(Ja(h),d);case"binary":return a(h,d);case"buffer":return a(hr&&Buffer.isBuffer(h)?h.toString("binary"):ev(h),d);case"array":return a(Dd(h),d)}throw new Error("Unrecognized type "+d.type)}function a(h,d){var v=h.split(/[\n\r]+/),g=-1,y=-1,b=0,w=0,_=[],x=[],T=null,O={},E=[],M=[],P=[],N=0,D;for(+d.codepage>=0&&ws(+d.codepage);b!==v.length;++b){N=0;var L=v[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=L.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),ee=V[0],ie;if(L.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&x.push(L.slice(3).replace(/;;/g,";"));break;case"C":var le=!1,_e=!1,U=!1,C=!1,R=-1,I=-1;for(w=1;w<V.length;++w)switch(V[w].charAt(0)){case"A":break;case"X":y=parseInt(V[w].slice(1))-1,_e=!0;break;case"Y":for(g=parseInt(V[w].slice(1))-1,_e||(y=0),D=_.length;D<=g;++D)_[D]=[];break;case"K":ie=V[w].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(Ss(ie))?isNaN(dm(ie).getDate())||(ie=ui(ie)):(ie=Ss(ie),T!==null&&Nm(T)&&(ie=HA(ie))),le=!0;break;case"E":C=!0;var k=qp(V[w].slice(1),{r:g,c:y});_[g][y]=[_[g][y],k];break;case"S":U=!0,_[g][y]=[_[g][y],"S5S"];break;case"G":break;case"R":R=parseInt(V[w].slice(1))-1;break;case"C":I=parseInt(V[w].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}if(le&&(_[g][y]&&_[g][y].length==2?_[g][y][0]=ie:_[g][y]=ie,T=null),U){if(C)throw new Error("SYLK shared formula cannot have own formula");var F=R>-1&&_[R][I];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");_[g][y][1]=Qge(F[1],{r:g-R,c:y-I})}break;case"F":var H=0;for(w=1;w<V.length;++w)switch(V[w].charAt(0)){case"X":y=parseInt(V[w].slice(1))-1,++H;break;case"Y":for(g=parseInt(V[w].slice(1))-1,D=_.length;D<=g;++D)_[D]=[];break;case"M":N=parseInt(V[w].slice(1))/20;break;case"F":break;case"G":break;case"P":T=x[parseInt(V[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=V[w].slice(1).split(" "),D=parseInt(P[0],10);D<=parseInt(P[1],10);++D)N=parseInt(P[2],10),M[D-1]=N===0?{hidden:!0}:{wch:N},vm(M[D-1]);break;case"C":y=parseInt(V[w].slice(1))-1,M[y]||(M[y]={});break;case"R":g=parseInt(V[w].slice(1))-1,E[g]||(E[g]={}),N>0?(E[g].hpt=N,E[g].hpx=DS(N)):N===0&&(E[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}H<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}}return E.length>0&&(O["!rows"]=E),M.length>0&&(O["!cols"]=M),d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),[_,O]}function o(h,d){var v=i(h,d),g=v[0],y=v[1],b=Fm(g,d);return cl(y).forEach(function(w){b[w]=y[w]}),b}function s(h,d){return Tc(o(h,d),d)}function l(h,d,v,g){var y="C;Y"+(v+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+N3t(h.f,{r:v,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,d){d.forEach(function(v,g){var y="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=XR(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=qR(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function f(h,d){d.forEach(function(v,g){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*qge(v.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function c(h,d){var v=["ID;PWXL;N;E"],g=[],y=xn(h["!ref"]),b,w=Array.isArray(h),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&u(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var x=y.s.r;x<=y.e.r;++x)for(var T=y.s.c;T<=y.e.c;++T){var O=$t({r:x,c:T});b=w?(h[x]||[])[T]:h[O],!(!b||b.v==null&&(!b.f||b.F))&&g.push(l(b,h,x,T))}return v.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:s,to_sheet:o,from_sheet:c}}(),ZHt=function(){function e(a,o){switch(o.type){case"base64":return t(Ja(a),o);case"binary":return t(a,o);case"buffer":return t(hr&&Buffer.isBuffer(a)?a.toString("binary"):ev(a),o);case"array":return t(Dd(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var s=a.split(`
`),l=-1,u=-1,f=0,c=[];f!==s.length;++f){if(s[f].trim()==="BOT"){c[++l]=[],u=0;continue}if(!(l<0)){var h=s[f].trim().split(","),d=h[0],v=h[1];++f;for(var g=s[f]||"";(g.match(/["]/g)||[]).length&1&&f<s.length-1;)g+=`
`+s[++f];switch(g=g.trim(),+d){case-1:if(g==="BOT"){c[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?c[l][u]=!0:g==="FALSE"?c[l][u]=!1:isNaN(Ss(v))?isNaN(dm(v).getDate())?c[l][u]=v:c[l][u]=ui(v):c[l][u]=Ss(v),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),c[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(c=c.slice(0,o.sheetRows)),c}function r(a,o){return Fm(e(a,o),o)}function n(a,o){return Tc(r(a,o),o)}var i=function(){var a=function(l,u,f,c,h){l.push(u),l.push(f+","+c),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,u,f,c){l.push(u+","+f),l.push(u==1?'"'+c.replace(/"/g,'""')+'"':c)};return function(l){var u=[],f=xn(l["!ref"]),c,h=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){o(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var g=$t({r:d,c:v});if(c=h?(l[d]||[])[v]:l[g],!c){o(u,1,0,"");continue}switch(c.t){case"n":var y=c.w;!y&&c.v!=null&&(y=c.v),y==null?c.f&&!c.F?o(u,1,0,"="+c.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,c.v?1:0,c.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(c.v)?c.v:'="'+c.v+'"');break;case"d":c.w||(c.w=Ho(c.z||jt[14],sa(ui(c.v)))),o(u,0,c.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,w=u.join(b);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),JHt=function(){function e(c){return c.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(c){return c.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(c,h){for(var d=c.split(`
`),v=-1,g=-1,y=0,b=[];y!==d.length;++y){var w=d[y].trim().split(":");if(w[0]==="cell"){var _=ra(w[1]);if(b.length<=_.r)for(v=b.length;v<=_.r;++v)b[v]||(b[v]=[]);switch(v=_.r,g=_.c,w[2]){case"t":b[v][g]=e(w[3]);break;case"v":b[v][g]=+w[3];break;case"vtf":var x=w[w.length-1];case"vtc":switch(w[3]){case"nl":b[v][g]=!!+w[4];break;default:b[v][g]=+w[4];break}w[2]=="vtf"&&(b[v][g]=[b[v][g],x])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(c,h){return Fm(r(c,h),h)}function i(c,h){return Tc(n(c,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(c){if(!c||!c["!ref"])return"";for(var h=[],d=[],v,g="",y=Lm(c["!ref"]),b=Array.isArray(c),w=y.s.r;w<=y.e.r;++w)for(var _=y.s.c;_<=y.e.c;++_)if(g=$t({r:w,c:_}),v=b?(c[w]||[])[_]:c[g],!(!v||v.v==null||v.t==="z")){switch(d=["cell",g,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var x=sa(ui(v.v));d[2]="vtc",d[3]="nd",d[4]=""+x,d[5]=v.w||Ho(v.z||jt[14],x);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(c){return[a,o,s,o,u(c),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),IS=function(){function e(f,c,h,d,v){v.raw?c[h][d]=f:f===""||(f==="TRUE"?c[h][d]=!0:f==="FALSE"?c[h][d]=!1:isNaN(Ss(f))?isNaN(dm(f).getDate())?c[h][d]=f:c[h][d]=ui(f):c[h][d]=Ss(f))}function t(f,c){var h=c||{},d=[];if(!f||f.length===0)return d;for(var v=f.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var y=10,b=0,w=0;w<=g;++w)b=v[w].indexOf(" "),b==-1?b=v[w].length:b++,y=Math.max(y,b);for(w=0;w<=g;++w){d[w]=[];var _=0;for(e(v[w].slice(0,y).trim(),d,w,_,h),_=1;_<=(v[w].length-y)/10+1;++_)e(v[w].slice(y+(_-1)*10,y+_*10).trim(),d,w,_,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var c={},h=!1,d=0,v=0;d<f.length;++d)(v=f.charCodeAt(d))==34?h=!h:!h&&v in r&&(c[v]=(c[v]||0)+1);v=[];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d]);if(!v.length){c=n;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d])}return v.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[v.pop()[1]]||44}function a(f,c){var h=c||{},d="",v=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=i(f.slice(0,1024)):h&&h.FS?d=h.FS:d=i(f.slice(0,1024));var y=0,b=0,w=0,_=0,x=0,T=d.charCodeAt(0),O=!1,E=0,M=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?fLt(h.dateNF):null;function N(){var D=f.slice(_,x),L={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)L.t="z";else if(h.raw)L.t="s",L.v=D;else if(D.trim().length===0)L.t="s",L.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(L.t="s",L.v=D.slice(2,-1).replace(/""/g,'"')):F3t(D)?(L.t="n",L.f=D.slice(1)):(L.t="s",L.v=D);else if(D=="TRUE")L.t="b",L.v=!0;else if(D=="FALSE")L.t="b",L.v=!1;else if(!isNaN(w=Ss(D)))L.t="n",h.cellText!==!1&&(L.w=D),L.v=w;else if(!isNaN(dm(D).getDate())||P&&D.match(P)){L.z=h.dateNF||jt[14];var V=0;P&&D.match(P)&&(D=cLt(D,h.dateNF,D.match(P)||[]),V=1),h.cellDates?(L.t="d",L.v=ui(D,V)):(L.t="n",L.v=sa(ui(D,V))),h.cellText!==!1&&(L.w=Ho(L.z,L.v instanceof Date?sa(L.v):L.v)),h.cellNF||delete L.z}else L.t="s",L.v=D;if(L.t=="z"||(h.dense?(v[y]||(v[y]=[]),v[y][b]=L):v[$t({c:b,r:y})]=L),_=x+1,M=f.charCodeAt(_),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),E==T)++b;else if(b=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;x<f.length;++x)switch(E=f.charCodeAt(x)){case 34:M===34&&(O=!O);break;case T:case 10:case 13:if(!O&&N())break e;break}return x-_>0&&N(),v["!ref"]=gr(g),v}function o(f,c){return!(c&&c.PRN)||c.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,c):Fm(t(f,c),c)}function s(f,c){var h="",d=c.type=="string"?[0,0,0,0]:pU(f,c);switch(c.type){case"base64":h=Ja(f);break;case"binary":h=f;break;case"buffer":c.codepage==65001?h=f.toString("utf8"):c.codepage&&typeof Af<"u"?h=Af.utils.decode(c.codepage,f):h=hr&&Buffer.isBuffer(f)?f.toString("binary"):ev(f);break;case"array":h=Dd(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+c.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Kr(h.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?h=Kr(h):c.type=="binary"&&typeof Af<"u"&&c.codepage&&(h=Af.utils.decode(c.codepage,Af.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?JHt.to_sheet(c.type=="string"?h:Kr(h),c):o(h,c)}function l(f,c){return Tc(s(f,c),c)}function u(f){for(var c=[],h=xn(f["!ref"]),d,v=Array.isArray(f),g=h.s.r;g<=h.e.r;++g){for(var y=[],b=h.s.c;b<=h.e.c;++b){var w=$t({r:g,c:b});if(d=v?(f[g]||[])[b]:f[w],!d||d.v==null){y.push("          ");continue}for(var _=(d.w||(Lu(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";y.push(_+(b===0?" ":""))}c.push(y.join(""))}return c.join(`
`)}return{to_workbook:l,to_sheet:s,from_sheet:u}}();function QHt(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=qHt.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return IS.to_workbook(e,t)}}var rw=function(){function e(k,F,H){if(k){vi(k,k.l||0);for(var W=H.Enum||R;k.l<k.length;){var Q=k.read_shift(2),se=W[Q]||W[65535],we=k.read_shift(2),pe=k.l+we,me=se.f&&se.f(k,we,H);if(k.l=pe,F(me,se,Q))return}}}function t(k,F){switch(F.type){case"base64":return r(ps(Ja(k)),F);case"binary":return r(ps(k),F);case"buffer":case"array":return r(k,F)}throw"Unsupported type "+F.type}function r(k,F){if(!k)return k;var H=F||{},W=H.dense?[]:{},Q="Sheet1",se="",we=0,pe={},me=[],Ie=[],z={s:{r:0,c:0},e:{r:0,c:0}},Le=H.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)H.Enum=R,e(k,function(De,tt,Qe){switch(Qe){case 0:H.vers=De,De>=4096&&(H.qpro=!0);break;case 6:z=De;break;case 204:De&&(se=De);break;case 222:se=De;break;case 15:case 51:H.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Qe==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=H.dateNF||jt[14],H.cellDates&&(De[1].t="d",De[1].v=HA(De[1].v))),H.qpro&&De[3]>we&&(W["!ref"]=gr(z),pe[Q]=W,me.push(Q),W=H.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},we=De[3],Q=se||"Sheet"+(we+1),se="");var G=H.dense?(W[De[0].r]||[])[De[0].c]:W[$t(De[0])];if(G){G.t=De[1].t,G.v=De[1].v,De[1].z!=null&&(G.z=De[1].z),De[1].f!=null&&(G.f=De[1].f);break}H.dense?(W[De[0].r]||(W[De[0].r]=[]),W[De[0].r][De[0].c]=De[1]):W[$t(De[0])]=De[1];break}},H);else if(k[2]==26||k[2]==14)H.Enum=I,k[2]==14&&(H.qpro=!0,k.l=0),e(k,function(De,tt,Qe){switch(Qe){case 204:Q=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>we&&(W["!ref"]=gr(z),pe[Q]=W,me.push(Q),W=H.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},we=De[3],Q="Sheet"+(we+1)),Le>0&&De[0].r>=Le)break;H.dense?(W[De[0].r]||(W[De[0].r]=[]),W[De[0].r][De[0].c]=De[1]):W[$t(De[0])]=De[1],z.e.c<De[0].c&&(z.e.c=De[0].c),z.e.r<De[0].r&&(z.e.r=De[0].r);break;case 27:De[14e3]&&(Ie[De[14e3][0]]=De[14e3][1]);break;case 1537:Ie[De[0]]=De[1],De[0]==we&&(Q=De[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(W["!ref"]=gr(z),pe[se||Q]=W,me.push(se||Q),!Ie.length)return{SheetNames:me,Sheets:pe};for(var ye={},Xe=[],Ge=0;Ge<Ie.length;++Ge)pe[me[Ge]]?(Xe.push(Ie[Ge]||me[Ge]),ye[Ie[Ge]]=pe[Ie[Ge]]||pe[me[Ge]]):(Xe.push(Ie[Ge]),ye[Ie[Ge]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:ye}}function n(k,F){var H=F||{};if(+H.codepage>=0&&ws(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var W=mB(),Q=xn(k["!ref"]),se=Array.isArray(k),we=[];as(W,0,a(1030)),as(W,6,l(Q));for(var pe=Math.min(Q.e.r,8191),me=Q.s.r;me<=pe;++me)for(var Ie=gi(me),z=Q.s.c;z<=Q.e.c;++z){me===Q.s.r&&(we[z]=Jn(z));var Le=we[z]+Ie,ye=se?(k[me]||[])[z]:k[Le];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?as(W,13,d(me,z,ye.v)):as(W,14,g(me,z,ye.v));else{var Xe=Lu(ye);as(W,15,c(me,z,Xe.slice(0,239)))}}return as(W,1),W.end()}function i(k,F){var H=F||{};if(+H.codepage>=0&&ws(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var W=mB();as(W,0,o(k));for(var Q=0,se=0;Q<k.SheetNames.length;++Q)(k.Sheets[k.SheetNames[Q]]||{})["!ref"]&&as(W,27,C(k.SheetNames[Q],se++));var we=0;for(Q=0;Q<k.SheetNames.length;++Q){var pe=k.Sheets[k.SheetNames[Q]];if(!(!pe||!pe["!ref"])){for(var me=xn(pe["!ref"]),Ie=Array.isArray(pe),z=[],Le=Math.min(me.e.r,8191),ye=me.s.r;ye<=Le;++ye)for(var Xe=gi(ye),Ge=me.s.c;Ge<=me.e.c;++Ge){ye===me.s.r&&(z[Ge]=Jn(Ge));var De=z[Ge]+Xe,tt=Ie?(pe[ye]||[])[Ge]:pe[De];if(!(!tt||tt.t=="z"))if(tt.t=="n")as(W,23,N(ye,Ge,we,tt.v));else{var Qe=Lu(tt);as(W,22,E(ye,Ge,we,Qe.slice(0,239)))}}++we}}return as(W,1),W.end()}function a(k){var F=Xn(2);return F.write_shift(2,k),F}function o(k){var F=Xn(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var H=0,W=0,Q=0,se=0;se<k.SheetNames.length;++se){var we=k.SheetNames[se],pe=k.Sheets[we];if(!(!pe||!pe["!ref"])){++Q;var me=Lm(pe["!ref"]);H<me.e.r&&(H=me.e.r),W<me.e.c&&(W=me.e.c)}}return H>8191&&(H=8191),F.write_shift(2,H),F.write_shift(1,Q),F.write_shift(1,W),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function s(k,F,H){var W={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&H.qpro?(W.s.c=k.read_shift(1),k.l++,W.s.r=k.read_shift(2),W.e.c=k.read_shift(1),k.l++,W.e.r=k.read_shift(2),W):(W.s.c=k.read_shift(2),W.s.r=k.read_shift(2),F==12&&H.qpro&&(k.l+=2),W.e.c=k.read_shift(2),W.e.r=k.read_shift(2),F==12&&H.qpro&&(k.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(k){var F=Xn(8);return F.write_shift(2,k.s.c),F.write_shift(2,k.s.r),F.write_shift(2,k.e.c),F.write_shift(2,k.e.r),F}function u(k,F,H){var W=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(W[0].c=k.read_shift(1),W[3]=k.read_shift(1),W[0].r=k.read_shift(2),k.l+=2):(W[2]=k.read_shift(1),W[0].c=k.read_shift(2),W[0].r=k.read_shift(2)),W}function f(k,F,H){var W=k.l+F,Q=u(k,F,H);if(Q[1].t="s",H.vers==20768){k.l++;var se=k.read_shift(1);return Q[1].v=k.read_shift(se,"utf8"),Q}return H.qpro&&k.l++,Q[1].v=k.read_shift(W-k.l,"cstr"),Q}function c(k,F,H){var W=Xn(7+H.length);W.write_shift(1,255),W.write_shift(2,F),W.write_shift(2,k),W.write_shift(1,39);for(var Q=0;Q<W.length;++Q){var se=H.charCodeAt(Q);W.write_shift(1,se>=128?95:se)}return W.write_shift(1,0),W}function h(k,F,H){var W=u(k,F,H);return W[1].v=k.read_shift(2,"i"),W}function d(k,F,H){var W=Xn(7);return W.write_shift(1,255),W.write_shift(2,F),W.write_shift(2,k),W.write_shift(2,H,"i"),W}function v(k,F,H){var W=u(k,F,H);return W[1].v=k.read_shift(8,"f"),W}function g(k,F,H){var W=Xn(13);return W.write_shift(1,255),W.write_shift(2,F),W.write_shift(2,k),W.write_shift(8,H,"f"),W}function y(k,F,H){var W=k.l+F,Q=u(k,F,H);if(Q[1].v=k.read_shift(8,"f"),H.qpro)k.l=W;else{var se=k.read_shift(2);x(k.slice(k.l,k.l+se),Q),k.l+=se}return Q}function b(k,F,H){var W=F&32768;return F&=-32769,F=(W?k:0)+(F>=8192?F-16384:F),(W?"":"$")+(H?Jn(F):gi(F))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function x(k,F){vi(k,0);for(var H=[],W=0,Q="",se="",we="",pe="";k.l<k.length;){var me=k[k.l++];switch(me){case 0:H.push(k.read_shift(8,"f"));break;case 1:se=b(F[0].c,k.read_shift(2),!0),Q=b(F[0].r,k.read_shift(2),!1),H.push(se+Q);break;case 2:{var Ie=b(F[0].c,k.read_shift(2),!0),z=b(F[0].r,k.read_shift(2),!1);se=b(F[0].c,k.read_shift(2),!0),Q=b(F[0].r,k.read_shift(2),!1),H.push(Ie+z+":"+se+Q)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(k.read_shift(2));break;case 6:{for(var Le="";me=k[k.l++];)Le+=String.fromCharCode(me);H.push('"'+Le.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:pe=H.pop(),we=H.pop(),H.push(["AND","OR"][me-20]+"("+we+","+pe+")");break;default:if(me<32&&_[me])pe=H.pop(),we=H.pop(),H.push(we+_[me]+pe);else if(w[me]){if(W=w[me][1],W==69&&(W=k[k.l++]),W>H.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+H.join("|")+"|");return}var ye=H.slice(-W);H.length-=W,H.push(w[me][0]+"("+ye.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}H.length==1?F[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function T(k){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=k.read_shift(2),F[3]=k[k.l++],F[0].c=k[k.l++],F}function O(k,F){var H=T(k);return H[1].t="s",H[1].v=k.read_shift(F-4,"cstr"),H}function E(k,F,H,W){var Q=Xn(6+W.length);Q.write_shift(2,k),Q.write_shift(1,H),Q.write_shift(1,F),Q.write_shift(1,39);for(var se=0;se<W.length;++se){var we=W.charCodeAt(se);Q.write_shift(1,we>=128?95:we)}return Q.write_shift(1,0),Q}function M(k,F){var H=T(k);H[1].v=k.read_shift(2);var W=H[1].v>>1;if(H[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return H[1].v=W,H}function P(k,F){var H=T(k),W=k.read_shift(4),Q=k.read_shift(4),se=k.read_shift(2);if(se==65535)return W===0&&Q===3221225472?(H[1].t="e",H[1].v=15):W===0&&Q===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var we=se&32768;return se=(se&32767)-16446,H[1].v=(1-we*2)*(Q*Math.pow(2,se+32)+W*Math.pow(2,se)),H}function N(k,F,H,W){var Q=Xn(14);if(Q.write_shift(2,k),Q.write_shift(1,H),Q.write_shift(1,F),W==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var se=0,we=0,pe=0,me=0;return W<0&&(se=1,W=-W),we=Math.log2(W)|0,W/=Math.pow(2,we-31),me=W>>>0,me&2147483648||(W/=2,++we,me=W>>>0),W-=me,me|=2147483648,me>>>=0,W*=Math.pow(2,32),pe=W>>>0,Q.write_shift(4,pe),Q.write_shift(4,me),we+=16383+(se?32768:0),Q.write_shift(2,we),Q}function D(k,F){var H=P(k);return k.l+=F-14,H}function L(k,F){var H=T(k),W=k.read_shift(4);return H[1].v=W>>6,H}function V(k,F){var H=T(k),W=k.read_shift(8,"f");return H[1].v=W,H}function ee(k,F){var H=V(k);return k.l+=F-10,H}function ie(k,F){return k[k.l+F-1]==0?k.read_shift(F,"cstr"):""}function le(k,F){var H=k[k.l++];H>F-1&&(H=F-1);for(var W="";W.length<H;)W+=String.fromCharCode(k[k.l++]);return W}function _e(k,F,H){if(!(!H.qpro||F<21)){var W=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var Q=k.read_shift(F-21,"cstr");return[W,Q]}}function U(k,F){for(var H={},W=k.l+F;k.l<W;){var Q=k.read_shift(2);if(Q==14e3){for(H[Q]=[0,""],H[Q][0]=k.read_shift(2);k[k.l];)H[Q][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return H}function C(k,F){var H=Xn(5+k.length);H.write_shift(2,14e3),H.write_shift(2,F);for(var W=0;W<k.length;++W){var Q=k.charCodeAt(W);H[H.l++]=Q>127?95:Q}return H[H.l++]=0,H}var R={0:{n:"BOF",f:Wn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:le},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:U},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function eBt(e){var t={},r=e.match(Li),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=At(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=zj[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var tBt=function(){var e=AS("t"),t=AS("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var s={t:"s",v:br(o[1])},l=a.match(t);return l&&(s.s=eBt(l[1])),s}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(s){return s.v})}}(),rBt=function(){var t=/(\r\n|\n)/g;function r(i,a,o){var s=[];i.u&&s.push("text-decoration: underline;"),i.uval&&s.push("text-underline-style:"+i.uval+";"),i.sz&&s.push("font-size:"+i.sz+"pt;"),i.outline&&s.push("text-effect: outline;"),i.shadow&&s.push("text-shadow: auto;"),a.push('<span style="'+s.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),nBt=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,iBt=/<(?:\w+:)?r>/,aBt=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function lU(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=br(Kr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Kr(e),r&&(n.h=Jj(n.t))):e.match(iBt)&&(n.r=Kr(e),n.t=br(Kr((e.replace(aBt,"").match(nBt)||[]).join("").replace(Li,""))),r&&(n.h=rBt(tBt(n.r)))),n):{t:""}}var oBt=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sBt=/<(?:\w+:)?(?:si|sstItem)>/g,lBt=/<\/(?:\w+:)?(?:si|sstItem)>/;function uBt(e,t){var r=[],n="";if(!e)return r;var i=e.match(oBt);if(i){n=i[2].replace(sBt,"").split(lBt);for(var a=0;a!=n.length;++a){var o=lU(n[a].trim(),t);o!=null&&(r[r.length]=o)}i=At(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function fBt(e){return[e.read_shift(4),e.read_shift(4)]}function cBt(e,t){var r=[],n=!1;return Gu(e,function(a,o,s){switch(s){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}function Uge(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ru(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function hBt(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ru(e,4),t.U=Ru(e,4),t.W=Ru(e,4),t}function dBt(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function vBt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(dBt(e));return t}function pBt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function gBt(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ru(e,4),t.U=Ru(e,4),t.W=Ru(e,4),t}function yBt(e){var t=gBt(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function zge(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Gge(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function mBt(e){var t=Ru(e);switch(t.Minor){case 2:return[t.Minor,bBt(e)];case 3:return[t.Minor,wBt()];case 4:return[t.Minor,_Bt(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function bBt(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=zge(e,r),i=Gge(e,e.length-e.l);return{t:"Std",h:n,v:i}}function wBt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _Bt(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Li,function(a){var o=At(a);switch(wl(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(s){n[s]=o[s]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function SBt(e,t){var r={},n=r.EncryptionVersionInfo=Ru(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=zge(e,i),t-=i,r.EncryptionVerifier=Gge(e,t),r}function CBt(e){var t={},r=t.EncryptionVersionInfo=Ru(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function xBt(e){var t=0,r,n=Uge(e),i=n.length+1,a,o,s,l,u;for(r=bc(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],s=t&16384?1:0,l=t<<1&32767,u=s|l,t=u^o;return t^52811}var Yge=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,s){return n(o^s)},a=function(o){for(var s=t[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var f=o[u],c=0;c!=7;++c)f&64&&(s^=r[l]),f*=2,--l;return s};return function(o){for(var s=Uge(o),l=a(s),u=s.length,f=bc(16),c=0;c!=16;++c)f[c]=0;var h,d,v;for((u&1)===1&&(h=l>>8,f[u]=i(e[0],h),--u,h=l&255,d=s[s.length-1],f[u]=i(d,h));u>0;)--u,h=l>>8,f[u]=i(s[u],h),--u,h=l&255,f[u]=i(s[u],h);for(u=15,v=15-s.length;v>0;)h=l>>8,f[u]=i(e[v],h),--u,--v,h=l&255,f[u]=i(s[u],h),--u,--v;return f}}(),TBt=function(e,t,r,n,i){i||(i=t),n||(n=Yge(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},OBt=function(e){var t=0,r=Yge(e);return function(n){var i=TBt("",n,t,r);return t=i[1],i[0]}};function EBt(e,t,r,n){var i={key:Wn(e),verificationBytes:Wn(e)};return r.password&&(i.verifier=xBt(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=OBt(r.password)),i}function RBt(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=CBt(e):n.Data=SBt(e,t),n}function kBt(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?RBt(e,t-2,n):EBt(e,r.biff>=8?t:t-2,r,n),n}var ABt=function(){function e(i,a){switch(a.type){case"base64":return t(Ja(i),a);case"binary":return t(i,a);case"buffer":return t(hr&&Buffer.isBuffer(i)?i.toString("binary"):ev(i),a);case"array":return t(Dd(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},s=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,c){Array.isArray(s)&&(s[c]=[]);for(var h=/\\\w+\b/g,d=0,v,g=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var y=f.slice(d,h.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(s)?s[c][g]=b:s[$t({r:c,c:g})]=b}break}d=h.lastIndex}g>u.e.c&&(u.e.c=g)}),s["!ref"]=gr(u),s}function r(i,a){return Tc(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=xn(i["!ref"]),s,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var c=$t({r:u,c:f});s=l?(i[u]||[])[f]:i[c],!(!s||s.v==null&&(!s.f||s.F))&&(a.push(" "+(s.w||(Lu(s),s.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function PBt(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function MS(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function IBt(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var s=0,l=0,u=i+a;switch(l=o/(u>1?2-u:u),i){case t:s=((r-n)/o+6)%6;break;case r:s=(n-t)/o+2;break;case n:s=(t-r)/o+4;break}return[s/6,l,u/2]}function MBt(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],s=6*t,l;if(r!==0)switch(s|0){case 0:case 6:l=i*s,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-s),o[0]+=l,o[1]+=i;break;case 2:l=i*(s-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-s),o[1]+=l,o[2]+=i;break;case 4:l=i*(s-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-s),o[2]+=l,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function KR(e,t){if(t===0)return e;var r=IBt(PBt(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),MS(MBt(r))}var Kge=6,DBt=15,$Bt=1,ea=Kge;function XR(e){return Math.floor((e+Math.round(128/ea)/256)*ea)}function qR(e){return Math.floor((e-5)/ea*100+.5)/100}function SB(e){return Math.round((e*ea+5)/ea*256)/256}function e$(e){return SB(qR(XR(e)))}function uU(e){var t=Math.abs(e-e$(e)),r=ea;if(t>.005)for(ea=$Bt;ea<DBt;++ea)Math.abs(e-e$(e))<=t&&(t=Math.abs(e-e$(e)),r=ea);ea=r}function vm(e){e.width?(e.wpx=XR(e.width),e.wch=qR(e.wpx),e.MDW=ea):e.wpx?(e.wch=qR(e.wpx),e.width=SB(e.wch),e.MDW=ea):typeof e.wch=="number"&&(e.width=SB(e.wch),e.wpx=XR(e.width),e.MDW=ea),e.customWidth&&delete e.customWidth}var NBt=96,Xge=NBt;function qge(e){return e*96/Xge}function DS(e){return e*Xge/96}var LBt={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function FBt(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(Li)||[]).forEach(function(o){var s=At(o);switch(wl(s[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},s.diagonalUp&&(i.diagonalUp=an(s.diagonalUp)),s.diagonalDown&&(i.diagonalDown=an(s.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in borders")}})}function HBt(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(Li)||[]).forEach(function(o){var s=At(o);switch(wl(s[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":s.patternType&&(i.patternType=s.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),s.indexed&&(i.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(i.bgColor.theme=parseInt(s.theme,10)),s.tint&&(i.bgColor.tint=parseFloat(s.tint)),s.rgb&&(i.bgColor.rgb=s.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),s.theme&&(i.fgColor.theme=parseInt(s.theme,10)),s.tint&&(i.fgColor.tint=parseFloat(s.tint)),s.rgb!=null&&(i.fgColor.rgb=s.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fills")}})}function BBt(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(Li)||[]).forEach(function(o){var s=At(o);switch(wl(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=Kr(s.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=s.val?an(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?an(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?an(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?an(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?an(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?an(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?an(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(s.val=="1")break;s.codepage=zj[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=an(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var l=vd[i.color.index];i.color.index==81&&(l=vd[1]),l||(l=vd[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=KR(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fonts")}})}function VBt(e,t,r){t.NumberFmt=[];for(var n=cl(jt),i=0;i<n.length;++i)t.NumberFmt[n[i]]=jt[n[i]];var a=e[0].match(Li);if(a)for(i=0;i<a.length;++i){var o=At(a[i]);switch(wl(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var s=br(Kr(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=s}dd(s,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var $T=["numFmtId","fillId","fontId","borderId","xfId"],NT=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function WBt(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Li)||[]).forEach(function(a){var o=At(a),s=0;switch(wl(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],s=0;s<$T.length;++s)n[$T[s]]&&(n[$T[s]]=parseInt(n[$T[s]],10));for(s=0;s<NT.length;++s)n[NT[s]]&&(n[NT[s]]=an(n[NT[s]]));if(t.NumberFmt&&n.numFmtId>392){for(s=392;s>60;--s)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[s]){n.numFmtId=s;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=an(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var jBt=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,l,u){var f={};if(!s)return f;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var c;return(c=s.match(t))&&VBt(c,f,u),(c=s.match(i))&&BBt(c,f,l,u),(c=s.match(n))&&HBt(c,f,l,u),(c=s.match(a))&&FBt(c,f,l,u),(c=s.match(r))&&WBt(c,f,u),f}}();function UBt(e,t){var r=e.read_shift(2),n=Ai(e);return[r,n]}function zBt(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=tFt(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var s=e.read_shift(1);s>0&&(n.family=s);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=eFt(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ai(e),n}var GBt=Di;function YBt(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var KBt=Di;function XBt(e,t,r){var n={};n.NumberFmt=[];for(var i in jt)n.NumberFmt[i]=jt[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Gu(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],dd(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=KR(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f),o=!0;break;case 38:a.pop(),o=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var qBt=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ZBt(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Li)||[]).forEach(function(i){var a=At(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[qBt.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function JBt(){}function QBt(){}var e3t=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,t3t=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,r3t=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function n3t(e,t,r){t.themeElements={};var n;[["clrScheme",e3t,ZBt],["fontScheme",t3t,JBt],["fmtScheme",r3t,QBt]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var i3t=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Zge(e,t){(!e||e.length===0)&&(e=a3t());var r,n={};if(!(r=e.match(i3t)))throw new Error("themeElements not found in theme");return n3t(r[0],n,t),n.raw=e,n}function a3t(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[lge];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function o3t(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=sge(a,{type:"array"})}catch{return}var s=Ga(o,"theme/theme/theme1.xml",!0);if(s)return Zge(s,r)}}function s3t(e){return e.read_shift(4)}function l3t(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=u3t(e,4);break;case 2:t.xclrValue=Lge(e);break;case 3:t.xclrValue=s3t(e);break;case 4:e.l+=4;break}return e.l+=8,t}function u3t(e,t){return Di(e,t)}function f3t(e,t){return Di(e,t)}function c3t(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=l3t(e);break;case 6:n[1]=f3t(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function h3t(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(c3t(e,r-e.l));return{ixfe:n,ext:a}}function d3t(e,t){t.forEach(function(r){switch(r[0]){}})}function v3t(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ai(e)}}function p3t(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function g3t(e){return e.l+=4,e.read_shift(4)!=0}function y3t(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,s=2;return Gu(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(c){s==1?n.Cell.push({type:n.Types[c[0]-1].name,index:c[1]}):s==0&&n.Value.push({type:n.Types[c[0]-1].name,index:c[1]})});break;case 337:s=l?1:0;break;case 338:s=2;break;case 35:a.push(f),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function m3t(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(Li,function(s){var l=At(s);switch(wl(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return s}),n}function b3t(e){var t=[];if(!e)return t;var r=1;return(e.match(Li)||[]).forEach(function(n){var i=At(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function w3t(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=$t(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function _3t(e,t,r){var n=[];return Gu(e,function(a,o,s){switch(s){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+s.toString(16))}}),n}function S3t(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Gu(e,function(s,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function C3t(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function ene(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(o){var s=ra(o.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[o.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[o.ref]=a;var l=xn(e["!ref"]||"BDWGO1000001:A1");l.s.r>s.r&&(l.s.r=s.r),l.e.r<s.r&&(l.e.r=s.r),l.s.c>s.c&&(l.s.c=s.c),l.e.c<s.c&&(l.e.c=s.c);var u=gr(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:o.author,t:o.t,r:o.r,T:r};o.h&&(f.h=o.h);for(var c=a.c.length-1;c>=0;--c){if(!r&&a.c[c].T)return;r&&!a.c[c].T&&a.c.splice(c,1)}if(r&&n){for(c=0;c<n.length;++c)if(f.a==n[c].id){f.a=n[c].name||f.a;break}}a.c.push(f)})}function x3t(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&r.push(s[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?comment[^>]*>/);if(s){var l=At(s[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=ra(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var c=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!c&&!!c[1]&&lU(c[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function T3t(e,t){var r=[],n=!1,i={},a=0;return e.replace(Li,function(s,l){var u=At(s);switch(wl(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=l+s.length;break;case"</text>":i.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return s}),r}function O3t(e,t){var r=[],n=!1;return e.replace(Li,function(a){var o=At(a);switch(wl(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function E3t(e){var t={};t.iauthor=e.read_shift(4);var r=rv(e);return t.rfx=r.s,t.ref=$t(r.s),e.l+=16,t}var R3t=Ai;function k3t(e,t){var r=[],n=[],i={},a=!1;return Gu(e,function(s,l,u){switch(u){case 632:n.push(s);break;case 635:i=s;break;case 637:i.t=s.t,i.h=s.h,i.r=s.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var A3t="application/vnd.ms-office.vbaProject";function P3t(e){var t=vr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vr.utils.cfb_add(t,i,e.FileIndex[n].content)}}),vr.write(t)}function I3t(){return{"!type":"dialog"}}function M3t(){return{"!type":"dialog"}}function D3t(){return{"!type":"macro"}}function $3t(){return{"!type":"macro"}}var qp=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,o){var s=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return s?f+=t.c:--f,l?u+=t.r:--u,i+(s?"":"$")+Jn(f)+(l?"":"$")+gi(u)}return function(i,a){return t=a,i.replace(e,r)}}(),Jge=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,N3t=function(){return function(t,r){return t.replace(Jge,function(n,i,a,o,s,l){var u=rU(o)-(a?0:r.c),f=tU(l)-(s?0:r.r),c=f==0?"":s?f+1:"["+f+"]",h=u==0?"":a?u+1:"["+u+"]";return i+"R"+c+"C"+h})}}();function Qge(e,t){return e.replace(Jge,function(r,n,i,a,o,s){return n+(i=="$"?i+a:Jn(rU(a)+t.c))+(o=="$"?o+s:gi(tU(s)+t.r))})}function L3t(e,t,r){var n=Lm(t),i=n.s,a=ra(r),o={r:a.r-i.r,c:a.c-i.c};return Qge(e,o)}function F3t(e){return e.length!=1}function tne(e){return e.replace(/_xlfn\./g,"")}function Bn(e){e.l+=1}function wc(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function eye(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return tye(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=wc(e,2),s=wc(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function tye(e){var t=wc(e,2),r=wc(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function H3t(e,t,r){if(r.biff<8)return tye(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=wc(e,2),o=wc(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function rye(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return B3t(e);var n=e.read_shift(r&&r.biff==12?4:2),i=wc(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function B3t(e){var t=wc(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function V3t(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function W3t(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return j3t(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function j3t(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function U3t(e,t,r){var n=(e[e.l++]&96)>>5,i=eye(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function z3t(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=eye(e,a,r);return[n,i,o]}function G3t(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Y3t(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function K3t(e,t,r){var n=(e[e.l++]&96)>>5,i=H3t(e,t-1,r);return[n,i]}function X3t(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function rne(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function q3t(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Z3t(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function J3t(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Q3t(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function e4t(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function nye(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function t4t(e){return e.read_shift(2),nye(e)}function r4t(e){return e.read_shift(2),nye(e)}function n4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=rye(e,0,r);return[n,i]}function i4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=W3t(e,0,r);return[n,i]}function a4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=rye(e,0,r);return[n,i,a]}function o4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[sVt[i],oye[i],n]}function s4t(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:l4t(e);return[i,(a[0]===0?oye:oVt)[a[1]]]}function l4t(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function u4t(e,t,r){e.l+=r&&r.biff==2?3:4}function f4t(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function c4t(e){return e.l++,nv[e.read_shift(1)]}function h4t(e){return e.l++,e.read_shift(2)}function d4t(e){return e.l++,e.read_shift(1)!==0}function v4t(e){return e.l++,Oi(e)}function p4t(e,t,r){return e.l++,B1(e,t-1,r)}function g4t(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=An(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=nv[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Oi(e);break;case 2:r[1]=iv(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function y4t(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?rv:BA)(e));return i}function m4t(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=g4t(e,r.biff);return o}function b4t(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function w4t(e,t,r){if(r.biff==5)return _4t(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function _4t(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function S4t(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function C4t(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function x4t(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function T4t(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var O4t=Di,E4t=Di,R4t=Di;function W1(e,t,r){return e.l+=2,[V3t(e)]}function fU(e){return e.l+=6,[]}var k4t=W1,A4t=fU,P4t=fU,I4t=W1;function iye(e){return e.l+=2,[Wn(e),e.read_shift(2)&1]}var M4t=W1,D4t=iye,$4t=fU,N4t=W1,L4t=W1,F4t=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function H4t(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=F4t[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function B4t(e){return e.l+=2,[e.read_shift(4)]}function V4t(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function W4t(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function j4t(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function U4t(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function z4t(e){return e.l+=4,[0,0]}var nne={1:{n:"PtgExp",f:f4t},2:{n:"PtgTbl",f:R4t},3:{n:"PtgAdd",f:Bn},4:{n:"PtgSub",f:Bn},5:{n:"PtgMul",f:Bn},6:{n:"PtgDiv",f:Bn},7:{n:"PtgPower",f:Bn},8:{n:"PtgConcat",f:Bn},9:{n:"PtgLt",f:Bn},10:{n:"PtgLe",f:Bn},11:{n:"PtgEq",f:Bn},12:{n:"PtgGe",f:Bn},13:{n:"PtgGt",f:Bn},14:{n:"PtgNe",f:Bn},15:{n:"PtgIsect",f:Bn},16:{n:"PtgUnion",f:Bn},17:{n:"PtgRange",f:Bn},18:{n:"PtgUplus",f:Bn},19:{n:"PtgUminus",f:Bn},20:{n:"PtgPercent",f:Bn},21:{n:"PtgParen",f:Bn},22:{n:"PtgMissArg",f:Bn},23:{n:"PtgStr",f:p4t},26:{n:"PtgSheet",f:V4t},27:{n:"PtgEndSheet",f:W4t},28:{n:"PtgErr",f:c4t},29:{n:"PtgBool",f:d4t},30:{n:"PtgInt",f:h4t},31:{n:"PtgNum",f:v4t},32:{n:"PtgArray",f:X3t},33:{n:"PtgFunc",f:o4t},34:{n:"PtgFuncVar",f:s4t},35:{n:"PtgName",f:b4t},36:{n:"PtgRef",f:n4t},37:{n:"PtgArea",f:U3t},38:{n:"PtgMemArea",f:S4t},39:{n:"PtgMemErr",f:O4t},40:{n:"PtgMemNoMem",f:E4t},41:{n:"PtgMemFunc",f:C4t},42:{n:"PtgRefErr",f:x4t},43:{n:"PtgAreaErr",f:G3t},44:{n:"PtgRefN",f:i4t},45:{n:"PtgAreaN",f:K3t},46:{n:"PtgMemAreaN",f:j4t},47:{n:"PtgMemNoMemN",f:U4t},57:{n:"PtgNameX",f:w4t},58:{n:"PtgRef3d",f:a4t},59:{n:"PtgArea3d",f:z3t},60:{n:"PtgRefErr3d",f:T4t},61:{n:"PtgAreaErr3d",f:Y3t},255:{}},G4t={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Y4t={1:{n:"PtgElfLel",f:iye},2:{n:"PtgElfRw",f:N4t},3:{n:"PtgElfCol",f:k4t},6:{n:"PtgElfRwV",f:L4t},7:{n:"PtgElfColV",f:I4t},10:{n:"PtgElfRadical",f:M4t},11:{n:"PtgElfRadicalS",f:$4t},13:{n:"PtgElfColS",f:A4t},15:{n:"PtgElfColSV",f:P4t},16:{n:"PtgElfRadicalLel",f:D4t},25:{n:"PtgList",f:H4t},29:{n:"PtgSxName",f:B4t},255:{}},K4t={0:{n:"PtgAttrNoop",f:z4t},1:{n:"PtgAttrSemi",f:e4t},2:{n:"PtgAttrIf",f:J3t},4:{n:"PtgAttrChoose",f:q3t},8:{n:"PtgAttrGoto",f:Z3t},16:{n:"PtgAttrSum",f:u4t},32:{n:"PtgAttrBaxcel",f:rne},33:{n:"PtgAttrBaxcel",f:rne},64:{n:"PtgAttrSpace",f:t4t},65:{n:"PtgAttrSpaceSemi",f:r4t},128:{n:"PtgAttrIfError",f:Q3t},255:{}};function j1(e,t,r,n){if(n.biff<8)return Di(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=m4t(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=y4t(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(Di(e,t)),a}function U1(e,t,r){for(var n=e.l+t,i,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],i=nne[a]||nne[G4t[a]],(a===24||a===25)&&(i=(a===24?Y4t:K4t)[e[e.l+1]]),!i||!i.f?Di(e,t):o.push([i.n,i.f(e,t,r)]);return o}function X4t(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var q4t={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Z4t(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function aye(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ine(e,t,r){var n=aye(e,t,r);return n=="#REF"?n:Z4t(n,r)}function xi(e,t,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],l,u,f,c=0,h=0,d,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,w=e[0].length;b<w;++b){var _=e[0][b];switch(_[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=s.pop(),u=s.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=Cn(" ",e[0][g][1][1]);break;case 1:y=Cn("\r",e[0][g][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}s.push(u+q4t[_[0]]+l);break;case"PtgIsect":l=s.pop(),u=s.pop(),s.push(u+" "+l);break;case"PtgUnion":l=s.pop(),u=s.pop(),s.push(u+","+l);break;case"PtgRange":l=s.pop(),u=s.pop(),s.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Jb(_[1][1],o,i),s.push(Qb(f,a));break;case"PtgRefN":f=r?Jb(_[1][1],r,i):_[1][1],s.push(Qb(f,a));break;case"PtgRef3d":c=_[1][1],f=Jb(_[1][2],o,i),v=ine(n,c,i),s.push(v+"!"+Qb(f,a));break;case"PtgFunc":case"PtgFuncVar":var x=_[1][0],T=_[1][1];x||(x=0),x&=127;var O=x==0?[]:s.slice(-x);s.length-=x,T==="User"&&(T=O.shift()),s.push(T+"("+O.join(",")+")");break;case"PtgBool":s.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(_[1]);break;case"PtgNum":s.push(String(_[1]));break;case"PtgStr":s.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(_[1]);break;case"PtgAreaN":d=Fre(_[1][1],r?{s:r}:o,i),s.push(JD(d,i));break;case"PtgArea":d=Fre(_[1][1],o,i),s.push(JD(d,i));break;case"PtgArea3d":c=_[1][1],d=_[1][2],v=ine(n,c,i),s.push(v+"!"+JD(d,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],M=E?E.Name:"SH33TJSNAME"+String(h);M&&M.slice(0,6)=="_xlfn."&&!i.xlfn&&(M=M.slice(6)),s.push(M);break;case"PtgNameX":var P=_[1][1];h=_[1][2];var N;if(i.biff<=5)P<0&&(P=-P),n[P]&&(N=n[P][h]);else{var D="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(D=n.SheetNames[n[P][h].itab-1]+"!"):D=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])D+=n[P][h].Name;else if(n[0]&&n[0][h])D+=n[0][h].Name;else{var L=(aye(n,P,i)||"").split(";;");L[h-1]?D=L[h-1]:D+="SH33TJSERRX"}s.push(D);break}N||(N={Name:"SH33TJSERRY"}),s.push(N.Name);break;case"PtgParen":var V="(",ee=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:V=Cn(" ",e[0][g][1][1])+V;break;case 3:V=Cn("\r",e[0][g][1][1])+V;break;case 4:ee=Cn(" ",e[0][g][1][1])+ee;break;case 5:ee=Cn("\r",e[0][g][1][1])+ee;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}s.push(V+s.pop()+ee);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var ie={c:r.c,r:r.r};if(n.sharedf[$t(f)]){var le=n.sharedf[$t(f)];s.push(xi(le,o,ie,n,i))}else{var _e=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){s.push(xi(u[1],o,ie,n,i)),_e=!0;break}_e||s.push(_[1])}break;case"PtgArray":s.push("{"+X4t(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var U=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&U.indexOf(e[0][b][0])==-1){_=e[0][g];var C=!0;switch(_[1][0]){case 4:C=!1;case 0:y=Cn(" ",_[1][1]);break;case 5:C=!1;case 1:y=Cn("\r",_[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}s.push((C?y:"")+s.pop()+(C?"":y)),g=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function J4t(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Di(e,t-2)];var s=U1(e,o,r);return t!==o+i&&(a=j1(e,t-o-i,s,r)),e.l=n,[s,a]}function Q4t(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Di(e,t-2)];var s=U1(e,o,r);return t!==o+i&&(a=j1(e,t-o-i,s,r)),e.l=n,[s,a]}function eVt(e,t,r,n){var i=e.l+t,a=U1(e,n,r),o;return i!==e.l&&(o=j1(e,i-e.l,a,r)),[a,o]}function tVt(e,t,r){var n=e.l+t,i,a=e.read_shift(2),o=U1(e,a,r);return a==65535?[[],Di(e,t-2)]:(t!==a+2&&(i=j1(e,n-a-2,o,r)),[o,i])}function rVt(e){var t;if(Cu(e,e.l+6)!==65535)return[Oi(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function t$(e,t,r){var n=e.l+t,i=_l(e);r.biff==2&&++e.l;var a=rVt(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var s=Q4t(e,n-e.l,r);return{cell:i,val:a[0],formula:s,shared:o>>3&1,tt:a[1]}}function VA(e,t,r){var n=e.read_shift(4),i=U1(e,n,r),a=e.read_shift(4),o=a>0?j1(e,a,i,r):null;return[i,o]}var nVt=VA,WA=VA,iVt=VA,aVt=VA,oVt={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oye={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sVt={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ane(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function r$(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var nw={},Zp={};function iw(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function sye(e,t,r,n,i,a){try{n.cellNF&&(e.z=jt[t])}catch(s){if(n.WTF)throw s}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ui(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(jt[t]==null&&dd(uLt[t]||"General",t),e.t==="e")e.w=e.w||nv[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kS(e.v);else if(e.t==="d"){var o=sa(e.v);(o|0)===o?e.w=o.toString(10):e.w=kS(o)}else{if(e.v===void 0)return"";e.w=Md(e.v,Zp)}else e.t==="d"?e.w=Ho(t,sa(e.v),Zp):e.w=Ho(t,e.v,Zp)}catch(s){if(n.WTF)throw s}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=KR(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=KR(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(n.WTF&&a.Fills)throw s}}}function lVt(e,t){var r=xn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=gr(r))}var uVt=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fVt=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cVt=/<(?:\w:)?hyperlink [^>]*>/mg,hVt=/"(\w*:\w*)"/,dVt=/<(?:\w:)?col\b[^>]*[\/]?>/g,vVt=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pVt=/<(?:\w:)?pageMargins[^>]*\/>/g,lye=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,gVt=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yVt=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function mVt(e,t,r,n,i,a,o){if(!e)return e;n||(n={"!id":{}});var s=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",c=e.match(fVt);c?(u=e.slice(0,c.index),f=e.slice(c.index+c[0].length)):u=f=e;var h=u.match(lye);h?cU(h[0],s,i,r):(h=u.match(gVt))&&bVt(h[0],h[1]||"",s,i,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=u.slice(d,d+50).match(hVt);v&&lVt(s,v[1])}var g=u.match(yVt);g&&g[1]&&TVt(g[1],i);var y=[];if(t.cellStyles){var b=u.match(dVt);b&&SVt(y,b)}c&&OVt(c[1],s,t,l,a,o);var w=f.match(vVt);w&&(s["!autofilter"]=CVt(w[0]));var _=[],x=f.match(uVt);if(x)for(d=0;d!=x.length;++d)_[d]=xn(x[d].slice(x[d].indexOf('"')+1));var T=f.match(cVt);T&&wVt(s,T,n);var O=f.match(pVt);if(O&&(s["!margins"]=_Vt(At(O[0]))),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=gr(l)),t.sheetRows>0&&s["!ref"]){var E=xn(s["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),s["!fullref"]=s["!ref"],s["!ref"]=gr(E))}return y.length>0&&(s["!cols"]=y),_.length>0&&(s["!merges"]=_),s}function cU(e,t,r,n){var i=At(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=br(Kr(i.codeName)))}function bVt(e,t,r,n,i){cU(e.slice(0,e.indexOf(">")),r,n,i)}function wVt(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=At(Kr(t[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+br(a.location))):(a.Target="#"+br(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var s=xn(a.ref),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var f=$t({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function _Vt(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function SVt(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=At(t[n],!0);i.hidden&&(i.hidden=an(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,uU(i.width)),vm(i);a<=o;)e[a++]=pi(i)}}function CVt(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var xVt=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function TVt(e,t){t.Views||(t.Views=[{}]),(e.match(xVt)||[]).forEach(function(r,n){var i=At(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),an(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var OVt=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=AS("v"),o=AS("f");return function(l,u,f,c,h,d){for(var v=0,g="",y=[],b=[],w=0,_=0,x=0,T="",O,E,M=0,P=0,N,D,L=0,V=0,ee=Array.isArray(d.CellXf),ie,le=[],_e=[],U=Array.isArray(u),C=[],R={},I=!1,k=!!f.sheetStubs,F=l.split(t),H=0,W=F.length;H!=W;++H){g=F[H].trim();var Q=g.length;if(Q!==0){var se=0;e:for(v=0;v<Q;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(E=At(g.slice(se,v),!0),M=E.r!=null?parseInt(E.r,10):M+1,P=-1,f.sheetRows&&f.sheetRows<M)continue;R={},I=!1,E.ht&&(I=!0,R.hpt=parseFloat(E.ht),R.hpx=DS(R.hpt)),E.hidden=="1"&&(I=!0,R.hidden=!0),E.outlineLevel!=null&&(I=!0,R.level=+E.outlineLevel),I&&(C[M-1]=R)}break;case"<":se=v;break}if(se>=v)break;if(E=At(g.slice(se,v),!0),M=E.r!=null?parseInt(E.r,10):M+1,P=-1,!(f.sheetRows&&f.sheetRows<M)){c.s.r>M-1&&(c.s.r=M-1),c.e.r<M-1&&(c.e.r=M-1),f&&f.cellStyles&&(R={},I=!1,E.ht&&(I=!0,R.hpt=parseFloat(E.ht),R.hpx=DS(R.hpt)),E.hidden=="1"&&(I=!0,R.hidden=!0),E.outlineLevel!=null&&(I=!0,R.level=+E.outlineLevel),I&&(C[M-1]=R)),y=g.slice(v).split(e);for(var we=0;we!=y.length&&y[we].trim().charAt(0)=="<";++we);for(y=y.slice(we),v=0;v!=y.length;++v)if(g=y[v].trim(),g.length!==0){if(b=g.match(r),w=v,_=0,x=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(w=0,T=b[1],_=0;_!=T.length&&!((x=T.charCodeAt(_)-64)<1||x>26);++_)w=26*w+x;--w,P=w}else++P;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,E=At(g.slice(0,_),!0),E.r||(E.r=$t({r:M-1,c:P})),T=g.slice(_),O={t:""},(b=T.match(a))!=null&&b[1]!==""&&(O.v=br(b[1])),f.cellFormula){if((b=T.match(o))!=null&&b[1]!==""){if(O.f=br(Kr(b[1])).replace(/\r\n/g,`
`),f.xlfn||(O.f=tne(O.f)),b[0].indexOf('t="array"')>-1)O.F=(T.match(i)||[])[1],O.F.indexOf(":")>-1&&le.push([xn(O.F),O.F]);else if(b[0].indexOf('t="shared"')>-1){D=At(b[0]);var pe=br(Kr(b[1]));f.xlfn||(pe=tne(pe)),_e[parseInt(D.si,10)]=[D,pe,E.r]}}else(b=T.match(/<f[^>]*\/>/))&&(D=At(b[0]),_e[D.si]&&(O.f=L3t(_e[D.si][1],_e[D.si][2],E.r)));var me=ra(E.r);for(_=0;_<le.length;++_)me.r>=le[_][0].s.r&&me.r<=le[_][0].e.r&&me.c>=le[_][0].s.c&&me.c<=le[_][0].e.c&&(O.F=le[_][1])}if(E.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(k)O.t="z";else continue;else O.t=E.t||"n";switch(c.s.c>P&&(c.s.c=P),c.e.c<P&&(c.e.c=P),O.t){case"n":if(O.v==""||O.v==null){if(!k)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!k)continue;O.t="z"}else N=nw[parseInt(O.v,10)],O.v=N.t,O.r=N.r,f.cellHTML&&(O.h=N.h);break;case"str":O.t="s",O.v=O.v!=null?Kr(O.v):"",f.cellHTML&&(O.h=Jj(O.v));break;case"inlineStr":b=T.match(n),O.t="s",b!=null&&(N=lU(b[1]))?(O.v=N.t,f.cellHTML&&(O.h=N.h)):O.v="";break;case"b":O.v=an(O.v);break;case"d":f.cellDates?O.v=ui(O.v,1):(O.v=sa(ui(O.v,1)),O.t="n");break;case"e":(!f||f.cellText!==!1)&&(O.w=O.v),O.v=kge[O.v];break}if(L=V=0,ie=null,ee&&E.s!==void 0&&(ie=d.CellXf[E.s],ie!=null&&(ie.numFmtId!=null&&(L=ie.numFmtId),f.cellStyles&&ie.fillId!=null&&(V=ie.fillId))),sye(O,L,V,f,h,d),f.cellDates&&ee&&O.t=="n"&&Nm(jt[L])&&(O.t="d",O.v=HA(O.v)),E.cm&&f.xlmeta){var Ie=(f.xlmeta.Cell||[])[+E.cm-1];Ie&&Ie.type=="XLDAPR"&&(O.D=!0)}if(U){var z=ra(E.r);u[z.r]||(u[z.r]=[]),u[z.r][z.c]=O}else u[E.r]=O}}}}C.length>0&&(u["!rows"]=C)}}();function EVt(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var RVt=rv;function kVt(){}function AVt(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=JLt(e),r}function PVt(e){var t=Go(e);return[t]}function IVt(e){var t=tv(e);return[t]}function MVt(e){var t=Go(e),r=e.read_shift(1);return[t,r,"b"]}function DVt(e){var t=tv(e),r=e.read_shift(1);return[t,r,"b"]}function $Vt(e){var t=Go(e),r=e.read_shift(1);return[t,r,"e"]}function NVt(e){var t=tv(e),r=e.read_shift(1);return[t,r,"e"]}function LVt(e){var t=Go(e),r=e.read_shift(4);return[t,r,"s"]}function FVt(e){var t=tv(e),r=e.read_shift(4);return[t,r,"s"]}function HVt(e){var t=Go(e),r=Oi(e);return[t,r,"n"]}function uye(e){var t=tv(e),r=Oi(e);return[t,r,"n"]}function BVt(e){var t=Go(e),r=aU(e);return[t,r,"n"]}function VVt(e){var t=tv(e),r=aU(e);return[t,r,"n"]}function WVt(e){var t=Go(e),r=nU(e);return[t,r,"is"]}function jVt(e){var t=Go(e),r=Ai(e);return[t,r,"str"]}function UVt(e){var t=tv(e),r=Ai(e);return[t,r,"str"]}function zVt(e,t,r){var n=e.l+t,i=Go(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var s=WA(e,n-e.l,r);o[3]=xi(s,null,i,r.supbooks,r)}else e.l=n;return o}function GVt(e,t,r){var n=e.l+t,i=Go(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var s=WA(e,n-e.l,r);o[3]=xi(s,null,i,r.supbooks,r)}else e.l=n;return o}function YVt(e,t,r){var n=e.l+t,i=Go(e);i.r=r["!row"];var a=Oi(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var s=WA(e,n-e.l,r);o[3]=xi(s,null,i,r.supbooks,r)}else e.l=n;return o}function KVt(e,t,r){var n=e.l+t,i=Go(e);i.r=r["!row"];var a=Ai(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var s=WA(e,n-e.l,r);o[3]=xi(s,null,i,r.supbooks,r)}else e.l=n;return o}var XVt=rv;function qVt(e,t){var r=e.l+t,n=rv(e),i=iU(e),a=Ai(e),o=Ai(e),s=Ai(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:s};return o&&(l.Tooltip=o),l}function ZVt(){}function JVt(e,t,r){var n=e.l+t,i=Oge(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var s=nVt(e,n-e.l,r);o[1]=s}else e.l=n;return o}function QVt(e,t,r){var n=e.l+t,i=rv(e),a=[i];if(r.cellFormula){var o=aVt(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}var eWt=["left","right","top","bottom","header","footer"];function tWt(e){var t={};return eWt.forEach(function(r){t[r]=Oi(e)}),t}function rWt(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function nWt(){}function iWt(){}function aWt(e,t,r,n,i,a,o){if(!e)return e;var s=t||{};n||(n={"!id":{}});var l=s.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},c=!1,h=!1,d,v,g,y,b,w,_,x,T,O=[];s.biff=12,s["!row"]=0;var E=0,M=!1,P=[],N={},D=s.supbooks||i.supbooks||[[]];if(D.sharedf=N,D.arrayf=P,D.SheetNames=i.SheetNames||i.Sheets.map(function(U){return U.name}),!s.supbooks&&(s.supbooks=D,i.Names))for(var L=0;L<i.Names.length;++L)D[0][L+1]=i.Names[L];var V=[],ee=[],ie=!1;ZR[16]={n:"BrtShortReal",f:uye};var le;if(Gu(e,function(C,R,I){if(!h)switch(I){case 148:u=C;break;case 0:d=C,s.sheetRows&&s.sheetRows<=d.r&&(h=!0),x=gi(y=d.r),s["!row"]=d.r,(C.hidden||C.hpt||C.level!=null)&&(C.hpt&&(C.hpx=DS(C.hpt)),ee[C.r]=C);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:C[2]},C[2]){case"n":v.v=C[1];break;case"s":_=nw[C[1]],v.v=_.t,v.r=_.r;break;case"b":v.v=!!C[1];break;case"e":v.v=C[1],s.cellText!==!1&&(v.w=nv[v.v]);break;case"str":v.t="s",v.v=C[1];break;case"is":v.t="s",v.v=C[1].t;break}if((g=o.CellXf[C[0].iStyleRef])&&sye(v,g.numFmtId,null,s,a,o),b=C[0].c==-1?b+1:C[0].c,s.dense?(l[y]||(l[y]=[]),l[y][b]=v):l[Jn(b)+x]=v,s.cellFormula){for(M=!1,E=0;E<P.length;++E){var k=P[E];d.r>=k[0].s.r&&d.r<=k[0].e.r&&b>=k[0].s.c&&b<=k[0].e.c&&(v.F=gr(k[0]),M=!0)}!M&&C.length>3&&(v.f=C[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>b&&(f.s.c=b),f.e.r<d.r&&(f.e.r=d.r),f.e.c<b&&(f.e.c=b),s.cellDates&&g&&v.t=="n"&&Nm(jt[g.numFmtId])){var F=ad(v.v);F&&(v.t="d",v.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}le&&(le.type=="XLDAPR"&&(v.D=!0),le=void 0);break;case 1:case 12:if(!s.sheetStubs||c)break;v={t:"z",v:void 0},b=C[0].c==-1?b+1:C[0].c,s.dense?(l[y]||(l[y]=[]),l[y][b]=v):l[Jn(b)+x]=v,f.s.r>d.r&&(f.s.r=d.r),f.s.c>b&&(f.s.c=b),f.e.r<d.r&&(f.e.r=d.r),f.e.c<b&&(f.e.c=b),le&&(le.type=="XLDAPR"&&(v.D=!0),le=void 0);break;case 176:O.push(C);break;case 49:le=((s.xlmeta||{}).Cell||[])[C-1];break;case 494:var H=n["!id"][C.relId];for(H?(C.Target=H.Target,C.loc&&(C.Target+="#"+C.loc),C.Rel=H):C.relId==""&&(C.Target="#"+C.loc),y=C.rfx.s.r;y<=C.rfx.e.r;++y)for(b=C.rfx.s.c;b<=C.rfx.e.c;++b)s.dense?(l[y]||(l[y]=[]),l[y][b]||(l[y][b]={t:"z",v:void 0}),l[y][b].l=C):(w=$t({c:b,r:y}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=C);break;case 426:if(!s.cellFormula)break;P.push(C),T=s.dense?l[y][b]:l[Jn(b)+x],T.f=xi(C[1],f,{r:d.r,c:b},D,s),T.F=gr(C[0]);break;case 427:if(!s.cellFormula)break;N[$t(C[0].s)]=C[1],T=s.dense?l[y][b]:l[Jn(b)+x],T.f=xi(C[1],f,{r:d.r,c:b},D,s);break;case 60:if(!s.cellStyles)break;for(;C.e>=C.s;)V[C.e--]={width:C.w/256,hidden:!!(C.flags&1),level:C.level},ie||(ie=!0,uU(C.w/256)),vm(V[C.e+1]);break;case 161:l["!autofilter"]={ref:gr(C)};break;case 476:l["!margins"]=C;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),C.name&&(i.Sheets[r].CodeName=C.name),(C.above||C.left)&&(l["!outline"]={above:C.above,left:C.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),C.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:c=!0;break;case 36:c=!1;break;case 37:c=!0;break;case 38:c=!1;break;default:if(!R.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}},s),delete s.supbooks,delete s["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=gr(u||f)),s.sheetRows&&l["!ref"]){var _e=xn(l["!ref"]);s.sheetRows<=+_e.e.r&&(_e.e.r=s.sheetRows-1,_e.e.r>f.e.r&&(_e.e.r=f.e.r),_e.e.r<_e.s.r&&(_e.s.r=_e.e.r),_e.e.c>f.e.c&&(_e.e.c=f.e.c),_e.e.c<_e.s.c&&(_e.s.c=_e.e.c),l["!fullref"]=l["!ref"],l["!ref"]=gr(_e))}return O.length>0&&(l["!merges"]=O),V.length>0&&(l["!cols"]=V),ee.length>0&&(l["!rows"]=ee),l}function oWt(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=br((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function sWt(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var s=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(c){var h=oWt(c);f.s.r=f.s.c=0,f.e.c=s,u=Jn(s),h[0].forEach(function(d,v){o[u+gi(v)]={t:"n",v:d,z:h[1]},l=v}),f.e.r<l&&(f.e.r=l),++s}),s>0&&(o["!ref"]=gr(f)),o}function lWt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,s=e.match(lye);return s&&cU(s[0],a,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function uWt(e,t){e.l+=10;var r=Ai(e);return{name:r}}function fWt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Gu(e,function(l,u,f){switch(f){case 550:a["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var fye=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cWt=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hWt=[],dWt=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function one(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=an(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function sne(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=an(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function cye(e){sne(e.WBProps,fye),sne(e.CalcPr,dWt),one(e.WBView,cWt),one(e.Sheets,hWt),Zp.date1904=an(e.WBProps.date1904)}var vWt="][*?/\\".split("");function pWt(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return vWt.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var gWt=/<\w+:workbook/;function yWt(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(Li,function(l,u){var f=At(l);switch(wl(f[0])){case"<?xml":break;case"<workbook":l.match(gWt)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":fye.forEach(function(c){if(f[c[0]]!=null)switch(c[2]){case"bool":r.WBProps[c[0]]=an(f[c[0]]);break;case"int":r.WBProps[c[0]]=parseInt(f[c[0]],10);break;default:r.WBProps[c[0]]=f[c[0]]}}),f.codeName&&(r.WBProps.CodeName=Kr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=br(Kr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Kr(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),an(f.hidden||"0")&&(a.Hidden=!0),o=u+l.length;break;case"</definedName>":a.Ref=br(Kr(e.slice(o,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),$Lt.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return cye(r),r}function mWt(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=bB(e),r.name=Ai(e),r}function bWt(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ai(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function wWt(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _Wt(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=QLt(e),o=iVt(e,0,r),s=iU(e);e.l=n;var l={Name:a,Ptg:o};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}function SWt(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],ZR[16]={n:"BrtFRTArchID$",f:wWt},Gu(e,function(l,u,f){switch(f){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=xi(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,l]):o[0]=[f,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),cye(r),r.Names=a,r.supbooks=o,r}function CWt(e,t,r){return t.slice(-4)===".bin"?SWt(e,r):yWt(e,r)}function xWt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?aWt(e,n,r,i,a,o,s):mVt(e,n,r,i,a,o,s)}function TWt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?fWt(e,n,r,i,a):lWt(e,n,r,i,a)}function OWt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?D3t():$3t()}function EWt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?I3t():M3t()}function RWt(e,t,r,n){return t.slice(-4)===".bin"?XBt(e,r,n):jBt(e,r,n)}function kWt(e,t,r){return Zge(e,r)}function AWt(e,t,r){return t.slice(-4)===".bin"?cBt(e,r):uBt(e,r)}function PWt(e,t,r){return t.slice(-4)===".bin"?k3t(e,r):x3t(e,r)}function IWt(e,t,r){return t.slice(-4)===".bin"?_3t(e):b3t(e)}function MWt(e,t,r,n){return r.slice(-4)===".bin"?S3t(e,t,r,n):void 0}function DWt(e,t,r){return t.slice(-4)===".bin"?y3t(e,t,r):m3t(e,t,r)}var hye=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,dye=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function is(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(hye),a,o,s,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(dye),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),n[s]=a[2].slice(1,a[2].length-1));return n}function $Wt(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(hye),i,a,o,s;if(n)for(s=0;s!=n.length;++s)i=n[s].match(dye),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var aw;function NWt(e,t){var r=aw[e]||br(e);return r==="General"?Md(t):Ho(r,t)}function LWt(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=an(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ui(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[br(t)]=i}function FWt(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||nv[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kS(e.v):e.w=Md(e.v):e.w=NWt(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=aw[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Nm(n)){var i=ad(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function HWt(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=LBt[n.Pattern]||n.Pattern)}e[t.ID]=t}function BWt(e,t,r,n,i,a,o,s,l,u){var f="General",c=n.StyleID,h={};u=u||{};var d=[],v=0;for(c===void 0&&s&&(c=s.StyleID),c===void 0&&o&&(c=o.StyleID);a[c]!==void 0&&(a[c].nf&&(f=a[c].nf),a[c].Interior&&d.push(a[c].Interior),!!a[c].Parent);)c=a[c].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=an(e);break;case"String":n.t="s",n.r=kre(br(e)),n.v=e.indexOf("<")>-1?br(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ui(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=br(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=kge[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=kre(t||e));break}if(FWt(n,f,u),u.cellFormula!==!1)if(n.Formula){var g=br(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=qp(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=qp("RC:RC",i):n.ArrayRange&&(n.F=qp(n.ArrayRange,i),l.push([xn(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);u.cellStyles&&(d.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function VWt(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function n$(e,t){var r=t||{};ege();var n=gb(Qj(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Kr(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=pi(r);return o.type="string",IS.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){i.indexOf("<"+tt)>=0&&(a=!0)}),a)return qWt(n,r);aw={"General Number":"General","General Date":jt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":jt[15],"Short Date":jt[14],"Long Time":jt[19],"Medium Time":jt[18],"Short Time":jt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:jt[2],Standard:jt[4],Percent:jt[10],Scientific:jt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,l=[],u,f={},c=[],h=r.dense?[]:{},d="",v={},g={},y=is('<Data ss:Type="String">'),b=0,w=0,_=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},O={},E="",M=0,P=[],N={},D={},L=0,V=[],ee=[],ie={},le=[],_e,U=!1,C=[],R=[],I={},k=0,F=0,H={Sheets:[],WBProps:{date1904:!1}},W={};PS.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";s=PS.exec(n);)switch(s[3]=(Q=s[3]).toLowerCase()){case"data":if(Q=="data"){if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break}if(l[l.length-1][1])break;s[1]==="/"?BWt(n.slice(b,s.index),E,y,l[l.length-1][0]=="comment"?ie:v,{c:w,r:_},T,le[w],g,C,r):(E="",y=is(s[0]),b=s.index+s[0].length);break;case"cell":if(s[1]==="/")if(ee.length>0&&(v.c=ee),(!r.sheetRows||r.sheetRows>_)&&v.v!==void 0&&(r.dense?(h[_]||(h[_]=[]),h[_][w]=v):h[Jn(w)+gi(_)]=v),v.HRef&&(v.l={Target:br(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(k=w+(parseInt(v.MergeAcross,10)|0),F=_+(parseInt(v.MergeDown,10)|0),P.push({s:{c:w,r:_},e:{c:k,r:F}})),!r.sheetStubs)v.MergeAcross?w=k+1:++w;else if(v.MergeAcross||v.MergeDown){for(var se=w;se<=k;++se)for(var we=_;we<=F;++we)(se>w||we>_)&&(r.dense?(h[we]||(h[we]=[]),h[we][se]={t:"z"}):h[Jn(se)+gi(we)]={t:"z"});w=k+1}else++w;else v=$Wt(s[0]),v.Index&&(w=+v.Index-1),w<x.s.c&&(x.s.c=w),w>x.e.c&&(x.e.c=w),s[0].slice(-2)==="/>"&&++w,ee=[];break;case"row":s[1]==="/"||s[0].slice(-2)==="/>"?(_<x.s.r&&(x.s.r=_),_>x.e.r&&(x.e.r=_),s[0].slice(-2)==="/>"&&(g=is(s[0]),g.Index&&(_=+g.Index-1)),w=0,++_):(g=is(s[0]),g.Index&&(_=+g.Index-1),I={},(g.AutoFitHeight=="0"||g.Height)&&(I.hpx=parseInt(g.Height,10),I.hpt=qge(I.hpx),R[_]=I),g.Hidden=="1"&&(I.hidden=!0,R[_]=I));break;case"worksheet":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));c.push(d),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(h["!ref"]=gr(x),r.sheetRows&&r.sheetRows<=x.e.r&&(h["!fullref"]=h["!ref"],x.e.r=r.sheetRows-1,h["!ref"]=gr(x))),P.length&&(h["!merges"]=P),le.length>0&&(h["!cols"]=le),R.length>0&&(h["!rows"]=R),f[d]=h}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=w=0,l.push([s[3],!1]),u=is(s[0]),d=br(u.Name),h=r.dense?[]:{},P=[],C=[],R=[],W={name:d,Hidden:0},H.Sheets.push(W);break;case"table":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else{if(s[0].slice(-2)=="/>")break;l.push([s[3],!1]),le=[],U=!1}break;case"style":s[1]==="/"?HWt(T,O,r):O=is(s[0]);break;case"numberformat":O.nf=br(is(s[0]).Format||"General"),aw[O.nf]&&(O.nf=aw[O.nf]);for(var pe=0;pe!=392&&jt[pe]!=O.nf;++pe);if(pe==392){for(pe=57;pe!=392;++pe)if(jt[pe]==null){dd(O.nf,pe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(_e=is(s[0]),_e.Hidden&&(_e.hidden=!0,delete _e.Hidden),_e.Width&&(_e.wpx=parseInt(_e.Width,10)),!U&&_e.wpx>10){U=!0,ea=Kge;for(var me=0;me<le.length;++me)le[me]&&vm(le[me])}U&&vm(_e),le[_e.Index-1||le.length]=_e;for(var Ie=0;Ie<+_e.Span;++Ie)le[le.length]=pi(_e);break;case"namedrange":if(s[1]==="/")break;H.Names||(H.Names=[]);var z=At(s[0]),Le={Name:z.Name,Ref:qp(z.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(Le.Sheet=H.Sheets.length-1),H.Names.push(Le);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(s[0].slice(-2)==="/>")break;s[1]==="/"?E+=n.slice(M,s.index):M=s.index+s[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=is(s[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(s[0].slice(-2)==="/>")break;s[1]==="/"?xFt(N,Q,n.slice(L,s.index)):L=s.index+s[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else l.push([s[3],!1]);break;case"comment":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));VWt(ie),ee.push(ie)}else l.push([s[3],!1]),u=is(s[0]),ie={a:u.Author};break;case"autofilter":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else if(s[0].charAt(s[0].length-2)!=="/"){var ye=is(s[0]);h["!autofilter"]={ref:qp(ye.Range).replace(/\$/g,"")},l.push([s[3],!0])}break;case"name":break;case"datavalidation":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"null":break;default:if(l.length==0&&s[3]=="document"||l.length==0&&s[3]=="uof")return dne(n,r);var Xe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(s[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(s[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if(s[0].slice(-2)!=="/>")if(s[1]==="/")switch(n.slice(L,s.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else L=s.index+s[0].length;break;case"header":h["!margins"]||iw(h["!margins"]={},"xlml"),isNaN(+At(s[0]).Margin)||(h["!margins"].header=+At(s[0]).Margin);break;case"footer":h["!margins"]||iw(h["!margins"]={},"xlml"),isNaN(+At(s[0]).Margin)||(h["!margins"].footer=+At(s[0]).Margin);break;case"pagemargins":var Ge=At(s[0]);h["!margins"]||iw(h["!margins"]={},"xlml"),isNaN(+Ge.Top)||(h["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(h["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(h["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(h["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(s[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||s[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(s[0].slice(-2)==="/>")break;s[1]==="/"?LWt(D,Q,V,n.slice(L,s.index)):(V=s,L=s.index+s[0].length);break}if(r.WTF)throw"Unrecognized tag: "+s[3]+"|"+l.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=f),De.SheetNames=c,De.Workbook=H,De.SSF=pi(jt),De.Props=N,De.Custprops=D,De}function CB(e,t){switch(vU(t=t||{}),t.type||"base64"){case"base64":return n$(Ja(e),t);case"binary":case"buffer":case"file":return n$(e,t);case"array":return n$(ev(e),t)}}function WWt(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=rFt(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=nFt(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var jWt=[60,1084,2066,2165,2175];function UWt(e,t,r,n,i){var a=n,o=[],s=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(s)}o.push(s),r.l+=a;for(var l=Cu(r,r.l),u=xB[l],f=0;u!=null&&jWt.indexOf(l)>-1;)a=Cu(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),s=r.slice(f,r.l+4+a),o.push(s),r.l+=4+a,u=xB[l=Cu(r,r.l)];var c=Pf(o);vi(c,0);var h=0;c.lens=[];for(var d=0;d<o.length;++d)c.lens.push(h),h+=o[d].length;if(c.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+c.length+" < "+n;return t.f(c,c.length,i)}function Xs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=jt[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||nv[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kS(e.v):e.w=Md(e.v):e.w=Ho(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Nm(jt[n]||String(n))){var i=ad(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function LT(e,t,r){return{v:e,ixfe:t,t:r}}function zWt(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},o={},s=null,l=[],u="",f={},c,h="",d,v,g,y,b={},w=[],_,x,T=[],O=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},P=function(be){return be<8?vd[be]:be<64&&O[be-8]||vd[be]},N=function(be,He,qe){var Je=He.XF.data;if(!(!Je||!Je.patternType||!qe||!qe.cellStyles)){He.s={},He.s.patternType=Je.patternType;var mt;(mt=MS(P(Je.icvFore)))&&(He.s.fgColor={rgb:mt}),(mt=MS(P(Je.icvBack)))&&(He.s.bgColor={rgb:mt})}},D=function(be,He,qe){if(!(I>1)&&!(qe.sheetRows&&be.r>=qe.sheetRows)){if(qe.cellStyles&&He.XF&&He.XF.data&&N(be,He,qe),delete He.ixfe,delete He.XF,c=be,h=$t(be),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),be.r<o.s.r&&(o.s.r=be.r),be.c<o.s.c&&(o.s.c=be.c),be.r+1>o.e.r&&(o.e.r=be.r+1),be.c+1>o.e.c&&(o.e.c=be.c+1),qe.cellFormula&&He.f){for(var Je=0;Je<w.length;++Je)if(!(w[Je][0].s.c>be.c||w[Je][0].s.r>be.r)&&!(w[Je][0].e.c<be.c||w[Je][0].e.r<be.r)){He.F=gr(w[Je][0]),(w[Je][0].s.c!=be.c||w[Je][0].s.r!=be.r)&&delete He.f,He.f&&(He.f=""+xi(w[Je][1],o,be,C,L));break}}qe.dense?(i[be.r]||(i[be.r]=[]),i[be.r][be.c]=He):i[h]=He}},L={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var V,ee=[],ie=[],le=[],_e=[],U=!1,C=[];C.SheetNames=L.snames,C.sharedf=L.sharedf,C.arrayf=L.arrayf,C.names=[],C.XTI=[];var R=0,I=0,k=0,F=[],H=[],W;L.codepage=1200,ws(1200);for(var Q=!1;e.l<e.length-1;){var se=e.l,we=e.read_shift(2);if(we===0&&R===10)break;var pe=e.l===e.length?0:e.read_shift(2),me=xB[we];if(me&&me.f){if(t.bookSheets&&R===133&&we!==133)break;if(R=we,me.r===2||me.r==12){var Ie=e.read_shift(2);if(pe-=2,!L.enc&&Ie!==we&&((Ie&255)<<8|Ie>>8)!==we)throw new Error("rt mismatch: "+Ie+"!="+we);me.r==12&&(e.l+=10,pe-=10)}var z={};if(we===10?z=me.f(e,pe,L):z=UWt(we,me,e,pe,L),I==0&&[9,521,1033,2057].indexOf(R)===-1)continue;switch(we){case 34:r.opts.Date1904=E.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=z;break;case 66:var Le=Number(z);switch(Le){case 21010:Le=1200;break;case 32768:Le=1e4;break;case 32769:Le=1252;break}ws(L.codepage=Le),Q=!0;break;case 317:L.rrtabid=z;break;case 25:L.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:L.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(i["!type"]="dialog"),z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(z);break;case 430:C.push([z]),C[C.length-1].XTI=[];break;case 35:case 547:C[C.length-1].push(z);break;case 24:case 536:W={Name:z.Name,Ref:xi(z.rgce,o,null,C,L)},z.itab>0&&(W.Sheet=z.itab-1),C.names.push(W),C[0]||(C[0]=[],C[0].XTI=[]),C[C.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(H[z.itab-1]={ref:gr(z.rgce[0][0][1][2])});break;case 22:L.ExternCount=z;break;case 23:C.length==0&&(C[0]=[],C[0].XTI=[]),C[C.length-1].XTI=C[C.length-1].XTI.concat(z),C.XTI=C.XTI.concat(z);break;case 2196:if(L.biff<8)break;W!=null&&(W.Comment=z[1]);break;case 18:i["!protect"]=z;break;case 19:z!==0&&L.WTF&&console.error("Password verifier: "+z);break;case 133:a[z.pos]=z,L.snames.push(z.name);break;case 10:{if(--I)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=gr(o),t.sheetRows&&t.sheetRows<=o.e.r){var ye=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=gr(o),o.e.r=ye}o.e.r++,o.e.c++}ee.length>0&&(i["!merges"]=ee),ie.length>0&&(i["!objects"]=ie),le.length>0&&(i["!cols"]=le),_e.length>0&&(i["!rows"]=_e),E.Sheets.push(M)}u===""?f=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),L.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(L.biff=5,Q=!0,ws(L.codepage=28591)),L.biff==8&&z.BIFFVer==0&&z.dt==16&&(L.biff=2),I++)break;if(i=t.dense?[]:{},L.biff<8&&!Q&&(Q=!0,ws(L.codepage=t.codepage||1252)),L.biff<5||z.BIFFVer==0&&z.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:e.l-pe,name:u};a[Xe.pos]=Xe,L.snames.push(u)}else u=(a[se]||{name:""}).name;z.dt==32&&(i["!type"]="chart"),z.dt==64&&(i["!type"]="macro"),ee=[],ie=[],L.arrayf=w=[],le=[],_e=[],U=!1,M={Hidden:(a[se]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[z.r]||[])[z.c]:i[$t({c:z.c,r:z.r})])&&++z.c,_={ixfe:z.ixfe,XF:T[z.ixfe]||{},v:z.val,t:"n"},k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:z.c,r:z.r},_,t);break;case 5:case 517:_={ixfe:z.ixfe,XF:T[z.ixfe],v:z.val,t:z.t},k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:z.c,r:z.r},_,t);break;case 638:_={ixfe:z.ixfe,XF:T[z.ixfe],v:z.rknum,t:"n"},k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:z.c,r:z.r},_,t);break;case 189:for(var Ge=z.c;Ge<=z.C;++Ge){var De=z.rkrec[Ge-z.c][0];_={ixfe:De,XF:T[De],v:z.rkrec[Ge-z.c][1],t:"n"},k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:Ge,r:z.r},_,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){s=z;break}if(_=LT(z.val,z.cell.ixfe,z.tt),_.XF=T[_.ixfe],t.cellFormula){var tt=z.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var Qe=tt[0][0][1][0],G=tt[0][0][1][1],Z=$t({r:Qe,c:G});b[Z]?_.f=""+xi(z.formula,o,z.cell,C,L):_.F=((t.dense?(i[Qe]||[])[G]:i[Z])||{}).F}else _.f=""+xi(z.formula,o,z.cell,C,L)}k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D(z.cell,_,t),s=z}break;case 7:case 519:if(s)s.val=z,_=LT(z,s.cell.ixfe,"s"),_.XF=T[_.ixfe],t.cellFormula&&(_.f=""+xi(s.formula,o,s.cell,C,L)),k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D(s.cell,_,t),s=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(z);var ae=$t(z[0].s);if(d=t.dense?(i[z[0].s.r]||[])[z[0].s.c]:i[ae],t.cellFormula&&d){if(!s||!ae||!d)break;d.f=""+xi(z[1],o,z[0],C,L),d.F=gr(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!s)break;b[$t(s.cell)]=z[0],d=t.dense?(i[s.cell.r]||[])[s.cell.c]:i[$t(s.cell)],(d||{}).f=""+xi(z[0],o,c,C,L)}}break;case 253:_=LT(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(_.h=l[z.isst].h),_.XF=T[_.ixfe],k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:z.c,r:z.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:z.ixfe,XF:T[z.ixfe],t:"z"},k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:z.c,r:z.r},_,t));break;case 190:if(t.sheetStubs)for(var Se=z.c;Se<=z.C;++Se){var fe=z.ixfe[Se-z.c];_={ixfe:fe,XF:T[fe],t:"z"},k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:Se,r:z.r},_,t)}break;case 214:case 516:case 4:_=LT(z.val,z.ixfe,"s"),_.XF=T[_.ixfe],k>0&&(_.z=F[_.ixfe>>8&63]),Xs(_,t,r.opts.Date1904),D({c:z.c,r:z.r},_,t);break;case 0:case 512:I===1&&(o=z);break;case 252:l=z;break;case 1054:if(L.biff==4){F[k++]=z[1];for(var Te=0;Te<k+163&&jt[Te]!=z[1];++Te);Te>=163&&dd(z[1],k+163)}else dd(z[1],z[0]);break;case 30:{F[k++]=z;for(var ve=0;ve<k+163&&jt[ve]!=z;++ve);ve>=163&&dd(z,k+163)}break;case 229:ee=ee.concat(z);break;case 93:ie[z.cmo[0]]=L.lastobj=z;break;case 438:L.lastobj.TxO=z;break;case 127:L.lastobj.ImData=z;break;case 440:for(y=z[0].s.r;y<=z[0].e.r;++y)for(g=z[0].s.c;g<=z[0].e.c;++g)d=t.dense?(i[y]||[])[g]:i[$t({c:g,r:y})],d&&(d.l=z[1]);break;case 2048:for(y=z[0].s.r;y<=z[0].e.r;++y)for(g=z[0].s.c;g<=z[0].e.c;++g)d=t.dense?(i[y]||[])[g]:i[$t({c:g,r:y})],d&&d.l&&(d.l.Tooltip=z[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;d=t.dense?(i[z[0].r]||[])[z[0].c]:i[$t(z[0])];var ge=ie[z[2]];d||(t.dense?(i[z[0].r]||(i[z[0].r]=[]),d=i[z[0].r][z[0].c]={t:"z"}):d=i[$t(z[0])]={t:"z"},o.e.r=Math.max(o.e.r,z[0].r),o.s.r=Math.min(o.s.r,z[0].r),o.e.c=Math.max(o.e.c,z[0].c),o.s.c=Math.min(o.s.c,z[0].c)),d.c||(d.c=[]),v={a:z[1],t:ge.TxO.t},d.c.push(v)}break;case 2173:d3t(T[z.ixfe],z.ext);break;case 125:{if(!L.cellStyles)break;for(;z.e>=z.s;)le[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},U||(U=!0,uU(z.w/256)),vm(le[z.e+1])}break;case 520:{var Oe={};z.level!=null&&(_e[z.r]=Oe,Oe.level=z.level),z.hidden&&(_e[z.r]=Oe,Oe.hidden=!0),z.hpt&&(_e[z.r]=Oe,Oe.hpt=z.hpt,Oe.hpx=DS(z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||iw(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=z;break;case 161:i["!margins"]||iw(i["!margins"]={}),i["!margins"].header=z.header,i["!margins"].footer=z.footer;break;case 574:z.RTL&&(E.Views[0].RTL=!0);break;case 146:O=z;break;case 2198:V=z;break;case 140:x=z;break;case 442:u?M.CodeName=z||M.name:E.WBProps.CodeName=z||"ThisWorkbook";break}}else me||console.error("Missing Info for XLS Record 0x"+we.toString(16)),e.l+=pe}return r.SheetNames=cl(a).sort(function(Ce,be){return Number(Ce)-Number(be)}).map(function(Ce){return a[Ce].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&H.forEach(function(Ce,be){r.Sheets[r.SheetNames[be]]["!autofilter"]=Ce}),r.Strings=l,r.SSF=pi(jt),L.enc&&(r.Encryption=L.enc),V&&(r.Themes=V),r.Metadata={},x!==void 0&&(r.Metadata.Country=x),C.names.length>0&&(E.Names=C.names),r.Workbook=E,r}var lne={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function GWt(e,t,r){var n=vr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=zre(n,uFt,lne.DSI);for(var a in i)t[a]=i[a]}catch(u){if(r.WTF)throw u}var o=vr.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=zre(o,fFt,lne.SI);for(var l in s)t[l]==null&&(t[l]=s[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Pge(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vye(e,t){t||(t={}),vU(t),Wpe(),t.codepage&&Gj(t.codepage);var r,n;if(e.FullPaths){if(vr.find(e,"/encryption"))throw new Error("File is password-protected");r=vr.find(e,"!CompObj"),n=vr.find(e,"/Workbook")||vr.find(e,"/Book")}else{switch(t.type){case"base64":e=ps(Ja(e));break;case"binary":e=ps(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}vi(e,0),n={content:e}}var i,a;if(r&&WWt(r),t.bookProps&&!t.bookSheets)i={};else{var o=hr?"buffer":"array";if(n&&n.content)i=zWt(n.content,t);else if((a=vr.find(e,"PerfectOffice_MAIN"))&&a.content)i=rw.to_workbook(a.content,(t.type=o,t));else if((a=vr.find(e,"NativeContent_MAIN"))&&a.content)i=rw.to_workbook(a.content,(t.type=o,t));else throw(a=vr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&vr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=P3t(e))}var s={};return e.FullPaths&&GWt(e,s,t),i.Props=i.Custprops=s,t.bookFiles&&(i.cfb=e),i}var ZR={0:{f:EVt},1:{f:PVt},2:{f:BVt},3:{f:$Vt},4:{f:MVt},5:{f:HVt},6:{f:jVt},7:{f:LVt},8:{f:KVt},9:{f:YVt},10:{f:zVt},11:{f:GVt},12:{f:IVt},13:{f:VVt},14:{f:NVt},15:{f:DVt},16:{f:uye},17:{f:UVt},18:{f:FVt},19:{f:nU},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_Wt},40:{},42:{},43:{f:zBt},44:{f:UBt},45:{f:GBt},46:{f:KBt},47:{f:YBt},48:{},49:{f:XLt},50:{},51:{f:p3t},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jge},62:{f:WVt},63:{f:w3t},64:{f:nWt},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Di,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rWt},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:AVt},148:{f:RVt,p:16},151:{f:ZVt},152:{},153:{f:bWt},154:{},155:{},156:{f:mWt},157:{},158:{},159:{T:1,f:fBt},160:{T:-1},161:{T:1,f:rv},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XVt},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:v3t},336:{T:-1},337:{f:g3t,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bB},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Wge},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:JVt},427:{f:QVt},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tWt},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kVt},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qVt},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bB},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:R3t},633:{T:1},634:{T:-1},635:{T:1,f:E3t},636:{T:-1},637:{f:ZLt},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uWt},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:iWt},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},xB={6:{f:t$},10:{f:Sf},12:{f:Wn},13:{f:Wn},14:{f:An},15:{f:An},16:{f:Oi},17:{f:An},18:{f:An},19:{f:Wn},20:{f:Xre},21:{f:Xre},23:{f:Wge},24:{f:Zre},25:{f:An},26:{},27:{},28:{f:THt},29:{},34:{f:An},35:{f:qre},38:{f:Oi},39:{f:Oi},40:{f:Oi},41:{f:Oi},42:{f:An},43:{f:An},47:{f:kBt},49:{f:oHt},51:{f:Wn},60:{},61:{f:nHt},64:{f:An},65:{f:aHt},66:{f:Wn},77:{},80:{},81:{},82:{},85:{f:Wn},89:{},90:{},91:{},92:{f:XFt},93:{f:EHt},94:{},95:{f:An},96:{},97:{},99:{f:An},125:{f:jge},128:{f:gHt},129:{f:qFt},130:{f:Wn},131:{f:An},132:{f:An},133:{f:ZFt},134:{},140:{f:MHt},141:{f:Wn},144:{},146:{f:$Ht},151:{},152:{},153:{},154:{},155:{},156:{f:Wn},157:{},158:{},160:{f:BHt},161:{f:LHt},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:hHt},190:{f:dHt},193:{f:Sf},197:{},198:{},199:{},200:{},201:{},202:{f:An},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Wn},220:{},221:{f:An},222:{},224:{f:pHt},225:{f:KFt},226:{f:Sf},227:{},229:{f:OHt},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:JFt},253:{f:sHt},255:{f:QFt},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Nge},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:An},353:{f:Sf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:mHt},431:{f:An},432:{},433:{},434:{},437:{},438:{f:AHt},439:{f:An},440:{f:PHt},441:{},442:{f:V1},443:{},444:{f:Wn},445:{},446:{},448:{f:Sf},449:{f:rHt,r:2},450:{f:Sf},512:{f:Yre},513:{f:HHt},515:{f:yHt},516:{f:lHt},517:{f:Kre},519:{f:VHt},520:{f:eHt},523:{},545:{f:Jre},549:{f:Gre},566:{},574:{f:iHt},638:{f:cHt},659:{},1048:{},1054:{f:uHt},1084:{},1212:{f:SHt},2048:{f:IHt},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:DT},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Sf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:NHt,r:12},2173:{f:h3t,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:An,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_Ht,r:12},2197:{},2198:{f:o3t,r:12},2199:{},2200:{},2201:{},2202:{f:CHt,r:12},2203:{f:Sf},2204:{},2205:{},2206:{},2207:{},2211:{f:tHt},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Wn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:FHt},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:DHt},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Yre},1:{},2:{f:zHt},3:{f:UHt},4:{f:jHt},5:{f:Kre},7:{f:GHt},8:{},9:{f:DT},11:{},22:{f:Wn},30:{f:fHt},31:{},32:{},33:{f:Jre},36:{},37:{f:Gre},50:{f:YHt},62:{},52:{},67:{},68:{f:Wn},69:{},86:{},126:{},127:{f:WHt},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:KHt},223:{},234:{},354:{},421:{},518:{f:t$},521:{f:DT},536:{f:Zre},547:{f:qre},561:{},579:{},1030:{f:t$},1033:{f:DT},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function as(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Cge(r)&&e.push(r)}}function une(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,s=a&&a.index||e.length,l=mLt(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,c=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<l.length;++o){var g=l[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(y!="<td"&&y!="<th")){var b=g.split(/<\/t[dh]>/i);for(s=0;s<b.length;++s){var w=b[s].trim();if(w.match(/<t[dh]/i)){for(var _=w,x=0;_.charAt(0)=="<"&&(x=_.indexOf(">"))>-1;)_=_.slice(x+1);for(var T=0;T<v.length;++T){var O=v[T];O.s.c==f&&O.s.r<u&&u<=O.e.r&&(f=O.e.c+1,T=-1)}var E=At(w.slice(0,w.indexOf(">")));h=E.colspan?+E.colspan:1,((c=+E.rowspan)>1||h>1)&&v.push({s:{r:u,c:f},e:{r:u+(c||1)-1,c:f+h-1}});var M=E.t||E["data-t"]||"";if(!_.length){f+=h;continue}if(_=fge(_),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!_.length){f+=h;continue}var P={t:"s",v:_};r.raw||!_.trim().length||M=="s"||(_==="TRUE"?P={t:"b",v:!0}:_==="FALSE"?P={t:"b",v:!1}:isNaN(Ss(_))?isNaN(dm(_).getDate())||(P={t:"d",v:ui(_)},r.cellDates||(P={t:"n",v:sa(P.v)}),P.z=r.dateNF||jt[14]):P={t:"n",v:Ss(_)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=P):n[$t({r:u,c:f})]=P,f+=h}}}}return n["!ref"]=gr(d),v.length&&(n["!merges"]=v),n}function YWt(e,t,r,n){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){s=-1;break}s=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(s<0)){var f=$t({r,c:o}),c=n.dense?(e[r]||[])[o]:e[f],h=c&&c.v!=null&&(c.h||Jj(c.w||(Lu(c),c.w)||""))||"",d={};s>1&&(d.rowspan=s),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":c&&(d["data-t"]=c&&c.t||"z",c.v!=null&&(d["data-v"]=c.v),c.z!=null&&(d["data-z"]=c.z),c.l&&(c.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+c.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+f,a.push(MLt("td",h,d))}}var v="<tr>";return v+a.join("")+"</tr>"}var KWt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XWt="</body></html>";function qWt(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Tc(une(r[0],t),t);var n=gU();return r.forEach(function(i,a){yU(n,une(i,t),"Sheet"+(a+1))}),n}function ZWt(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function JWt(e,t){var r=t||{},n=r.header!=null?r.header:KWt,i=r.footer!=null?r.footer:XWt,a=[n],o=Lm(e["!ref"]);r.dense=Array.isArray(e),a.push(ZWt(e,o,r));for(var s=o.s.r;s<=o.e.r;++s)a.push(YWt(e,o,s,r));return a.push("</table>"+i),a.join("")}function pye(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?ra(n.origin):n.origin;i=o.r,a=o.c}var s=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),u={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var f=Lm(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var c=[],h=0,d=e["!rows"]||(e["!rows"]=[]),v=0,g=0,y=0,b=0,w=0,_=0;for(e["!cols"]||(e["!cols"]=[]);v<s.length&&g<l;++v){var x=s[v];if(fne(x)){if(n.display)continue;d[g]={hidden:!0}}var T=x.children;for(y=b=0;y<T.length;++y){var O=T[y];if(!(n.display&&fne(O))){var E=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):fge(O.innerHTML),M=O.getAttribute("data-z")||O.getAttribute("z");for(h=0;h<c.length;++h){var P=c[h];P.s.c==b+a&&P.s.r<g+i&&g+i<=P.e.r&&(b=P.e.c+1-a,h=-1)}_=+O.getAttribute("colspan")||1,((w=+O.getAttribute("rowspan")||1)>1||_>1)&&c.push({s:{r:g+i,c:b+a},e:{r:g+i+(w||1)-1,c:b+a+(_||1)-1}});var N={t:"s",v:E},D=O.getAttribute("data-t")||O.getAttribute("t")||"";E!=null&&(E.length==0?N.t=D||"z":n.raw||E.trim().length==0||D=="s"||(E==="TRUE"?N={t:"b",v:!0}:E==="FALSE"?N={t:"b",v:!1}:isNaN(Ss(E))?isNaN(dm(E).getDate())||(N={t:"d",v:ui(E)},n.cellDates||(N={t:"n",v:sa(N.v)}),N.z=n.dateNF||jt[14]):N={t:"n",v:Ss(E)})),N.z===void 0&&M!=null&&(N.z=M);var L="",V=O.getElementsByTagName("A");if(V&&V.length)for(var ee=0;ee<V.length&&!(V[ee].hasAttribute("href")&&(L=V[ee].getAttribute("href"),L.charAt(0)!="#"));++ee);L&&L.charAt(0)!="#"&&(N.l={Target:L}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+a]=N):e[$t({c:b+a,r:g+i})]=N,u.e.c<b+a&&(u.e.c=b+a),b+=_}}++g}return c.length&&(e["!merges"]=(e["!merges"]||[]).concat(c)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=gr(u),g>=l&&(e["!fullref"]=gr((u.e.r=s.length-v+g-1+i,u))),e}function gye(e,t){var r=t||{},n=r.dense?[]:{};return pye(n,e,t)}function QWt(e,t){return Tc(gye(e,t),t)}function fne(e){var t="",r=ejt(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function ejt(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function tjt(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=br(t.replace(/<[^>]*>/g,""));return[r]}var cne={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yye(e,t){var r=t||{},n=Qj(e),i=[],a,o,s={name:""},l="",u=0,f,c,h={},d=[],v=r.dense?[]:{},g,y,b={value:""},w="",_=0,x=[],T=-1,O=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,P={},N=[],D={},L=0,V=0,ee=[],ie=1,le=1,_e=[],U={Names:[]},C={},R=["",""],I=[],k={},F="",H=0,W=!1,Q=!1,se=0;for(PS.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=PS.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?v["!ref"]=gr(E):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(v["!fullref"]=v["!ref"],E.e.r=r.sheetRows-1,v["!ref"]=gr(E)),N.length&&(v["!merges"]=N),ee.length&&(v["!rows"]=ee),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),h[f.name]=v,Q=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=At(g[0],!1),T=O=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,v=r.dense?[]:{},N=[],ee=[],Q=!0);break;case"table-row-group":g[1]==="/"?--M:++M;break;case"table-row":case"行":if(g[1]==="/"){T+=ie,ie=1;break}if(c=At(g[0],!1),c.行号?T=c.行号-1:T==-1&&(T=0),ie=+c["number-rows-repeated"]||1,ie<10)for(se=0;se<ie;++se)M>0&&(ee[T+se]={level:M});O=-1;break;case"covered-table-cell":g[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(v[T]||(v[T]=[]),v[T][O]={t:"z"}):v[$t({r:T,c:O})]={t:"z"}),w="",x=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++O,b=At(g[0],!1),le=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=ane(br(b.formula))),(b.数据类型||b["value-type"])=="string"&&(y.t="s",y.v=br(b["string-value"]||""),r.dense?(v[T]||(v[T]=[]),v[T][O]=y):v[$t({r:T,c:O})]=y),O+=le-1;else if(g[1]!=="/"){++O,w="",_=0,x=[],le=1;var we=ie?T+ie-1:T;if(O>E.e.c&&(E.e.c=O),O<E.s.c&&(E.s.c=O),T<E.s.r&&(E.s.r=T),we>E.e.r&&(E.e.r=we),b=At(g[0],!1),I=[],k={},y={t:b.数据类型||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=br(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(L=parseInt(b["number-matrix-rows-spanned"],10)||0,V=parseInt(b["number-matrix-columns-spanned"],10)||0,D={s:{r:T,c:O},e:{r:T+L-1,c:O+V-1}},y.F=gr(D),_e.push([D,y.F])),b.formula)y.f=ane(b.formula);else for(se=0;se<_e.length;++se)T>=_e[se][0].s.r&&T<=_e[se][0].e.r&&O>=_e[se][0].s.c&&O<=_e[se][0].e.c&&(y.F=_e[se][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(L=parseInt(b["number-rows-spanned"],10)||0,V=parseInt(b["number-columns-spanned"],10)||0,D={s:{r:T,c:O},e:{r:T+L-1,c:O+V-1}},N.push(D)),b["number-columns-repeated"]&&(le=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=an(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=ui(b["date-value"]),r.cellDates||(y.t="n",y.v=sa(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=pLt(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=HA(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(w=br(b["string-value"]),x=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(W=!1,y.t==="s"&&(y.v=w||"",x.length&&(y.R=x),W=_==0),C.Target&&(y.l=C),I.length>0&&(y.c=I,I=[]),w&&r.cellText!==!1&&(y.w=w),W&&(y.t="z",delete y.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var pe=0;pe<ie;++pe){if(le=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(v[T+pe]||(v[T+pe]=[]),v[T+pe][O]=pe==0?y:pi(y);--le>0;)v[T+pe][O+le]=pi(y);else for(v[$t({r:T+pe,c:O})]=y;--le>0;)v[$t({r:T+pe,c:O+le})]=pi(y);E.e.c<=O&&(E.e.c=O)}le=parseInt(b["number-columns-repeated"]||"1",10),O+=le-1,le=0,y={},w="",x=[]}C={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a;k.t=w,x.length&&(k.R=x),k.a=F,I.push(k)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);F="",H=0,w="",_=0,x=[];break;case"creator":g[1]==="/"?F=n.slice(H,g.index):H=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);w="",_=0,x=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(P[s.name]=l,(a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",s=At(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=At(g[0],!1),l+=cne[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=At(g[0],!1),l+=cne[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=At(g[0],!1),R=r$(o["cell-range-address"]);var me={Name:o.name,Ref:R[0]+"!"+R[1]};Q&&(me.Sheet=d.length),U.Names.push(me);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var Ie=tjt(n.slice(_,g.index));w=(w.length>0?w+`
`:"")+Ie[0]}else At(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{R=r$(At(g[0])["target-range-address"]),h[R[0]]["!autofilter"]={ref:R[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(C=At(g[0],!1),!C.href)break;C.Target=br(C.href),delete C.href,C.Target.charAt(0)=="#"&&C.Target.indexOf(".")>-1?(R=r$(C.Target.slice(1)),C.Target="#"+R[0]+"!"+R[1]):C.Target.match(/^\.\.[\\\/]/)&&(C.Target=C.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var z={Sheets:h,SheetNames:d,Workbook:U};return r.bookSheets&&delete z.Sheets,z}function hne(e,t){t=t||{},Co(e,"META-INF/manifest.xml")&&yFt(Vn(e,"META-INF/manifest.xml"),t);var r=Ga(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=yye(Kr(r),t);return Co(e,"meta.xml")&&(n.Props=Age(Vn(e,"meta.xml"))),n}function dne(e,t){return yye(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function hU(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function TB(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Kr(ev(e))}function OB(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function vne(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function rjt(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function $S(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ti(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ri(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=$S(e,r),a=i&7;i=Math.floor(i/8);var o=0,s;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);s=e.slice(l,r[0])}break;case 5:o=4,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=$S(e,r),s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var u={data:s,type:a};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function dU(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function njt(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=$S(e,n),a=Ri(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:ti(a[1][0].data),messages:[]};a[2].forEach(function(s){var l=Ri(s.data),u=ti(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(o.merge=ti(a[3][0].data)>>>0>0),r.push(o)}return r}function ijt(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=$S(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var s=o-59;o=t[r[0]],s>1&&(o|=t[r[0]+1]<<8),s>2&&(o|=t[r[0]+2]<<16),s>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=s}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[OB(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=OB(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function ajt(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ijt(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return OB(t)}function ojt(e,t,r,n){var i=hU(e),a=i.getUint32(4,!0),o=(n>1?12:8)+vne(a&(n>1?3470:398))*4,s=-1,l=-1,u=NaN,f=new Date(2001,0,1);a&512&&(s=i.getUint32(o,!0),o+=4),o+=vne(a&(n>1?12288:4096))*4,a&16&&(l=i.getUint32(o,!0),o+=4),a&32&&(u=i.getFloat64(o,!0),o+=8),a&64&&(f.setTime(f.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var c;switch(e[2]){case 0:break;case 2:c={t:"n",v:u};break;case 3:c={t:"s",v:t[l]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(s>-1)c={t:"s",v:r[s]};else if(l>-1)c={t:"s",v:t[l]};else if(!isNaN(u))c={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return c}function sjt(e,t,r){var n=hU(e),i=n.getUint32(8,!0),a=12,o=-1,s=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=rjt(e,a),a+=16),i&2&&(u=n.getFloat64(a,!0),a+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(s=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var c;switch(e[1]){case 0:break;case 2:c={t:"n",v:l};break;case 3:c={t:"s",v:t[s]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(o>-1)c={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:c={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return c}function ljt(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return ojt(e,t,r,e[0]);case 5:return sjt(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function oc(e){var t=Ri(e);return $S(t[1][0].data)}function pne(e,t){var r=Ri(t.data),n=ti(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var s=Ri(o.data),l=ti(s[1][0].data)>>>0;switch(n){case 1:a[l]=TB(s[3][0].data);break;case 8:{var u=e[oc(s[9][0].data)][0],f=Ri(u.data),c=e[oc(f[1][0].data)][0],h=ti(c.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=Ri(c.data);a[l]=d[3].map(function(v){return TB(v.data)}).join("")}break}}),a}function ujt(e,t){var r,n,i,a,o,s,l,u,f,c,h,d,v,g,y=Ri(e),b=ti(y[1][0].data)>>>0,w=ti(y[2][0].data)>>>0,_=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&ti(y[8][0].data)>0||!1,x,T;if((a=(i=y[7])==null?void 0:i[0])!=null&&a.data&&t!=0)x=(s=(o=y[7])==null?void 0:o[0])==null?void 0:s.data,T=(u=(l=y[6])==null?void 0:l[0])==null?void 0:u.data;else if((c=(f=y[4])==null?void 0:f[0])!=null&&c.data&&t!=1)x=(d=(h=y[4])==null?void 0:h[0])==null?void 0:d.data,T=(g=(v=y[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=_?4:1,E=hU(x),M=[],P=0;P<x.length/2;++P){var N=E.getUint16(P*2,!0);N<65535&&M.push([P,N])}if(M.length!=w)throw"Expected ".concat(w," cells, found ").concat(M.length);var D=[];for(P=0;P<M.length-1;++P)D[M[P][0]]=T.subarray(M[P][1]*O,M[P+1][1]*O);return M.length>=1&&(D[M[M.length-1][0]]=T.subarray(M[M.length-1][1]*O)),{R:b,cells:D}}function fjt(e,t){var r,n=Ri(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?ti(n[7][0].data)>>>0>0?1:0:-1,a=dU(n[5],function(o){return ujt(o,i)});return{nrows:ti(n[4][0].data)>>>0,data:a.reduce(function(o,s){return o[s.R]||(o[s.R]=[]),s.cells.forEach(function(l,u){if(o[s.R][u])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(u));o[s.R][u]=l}),o},[])}}function cjt(e,t,r){var n,i=Ri(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ti(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(ti(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=gr(a);var o=Ri(i[4][0].data),s=pne(e,e[oc(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?pne(e,e[oc(o[17][0].data)][0]):[],u=Ri(o[3][0].data),f=0;u[1].forEach(function(c){var h=Ri(c.data),d=e[oc(h[2][0].data)][0],v=ti(d.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=fjt(e,d);g.data.forEach(function(y,b){y.forEach(function(w,_){var x=$t({r:f+b,c:_}),T=ljt(w,s,l);T&&(r[x]=T)})}),f+=g.nrows})}function hjt(e,t){var r=Ri(t.data),n={"!ref":"A1"},i=e[oc(r[2][0].data)],a=ti(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return cjt(e,i[0],n),n}function djt(e,t){var r,n=Ri(t.data),i={name:(r=n[1])!=null&&r[0]?TB(n[1][0].data):"",sheets:[]},a=dU(n[2],oc);return a.forEach(function(o){e[o].forEach(function(s){var l=ti(s.meta[1][0].data);l==6e3&&i.sheets.push(hjt(e,s))})}),i}function vjt(e,t){var r=gU(),n=Ri(t.data),i=dU(n[1],oc);if(i.forEach(function(a){e[a].forEach(function(o){var s=ti(o.meta[1][0].data);if(s==2){var l=djt(e,o);l.sheets.forEach(function(u,f){yU(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function i$(e){var t,r,n,i,a={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=ajt(l.content)}catch(c){return console.log("?? "+l.content.length+" "+(c.message||c))}var f;try{f=njt(u)}catch(c){return console.log("## "+(c.message||c))}f.forEach(function(c){a[c.id]=c.messages,o.push(c.id)})}}),!o.length)throw new Error("File has no messages");var s=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&ti(a[1][0].meta[1][0].data)==1&&a[1][0];if(s||o.forEach(function(l){a[l].forEach(function(u){var f=ti(u.meta[1][0].data)>>>0;if(f==1)if(!s)s=u;else throw new Error("Document has multiple roots")})}),!s)throw new Error("Cannot find Document root");return vjt(a,s)}function pjt(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function vU(e){pjt([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function gjt(e){return Rp.WS.indexOf(e)>-1?"sheet":e==Rp.CS?"chart":e==Rp.DS?"dialog":e==Rp.MS?"macro":e&&e.length?e:"sheet"}function yjt(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,gjt(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function mjt(e,t,r,n,i,a,o,s,l,u,f,c){try{a[n]=ew(Ga(e,r,!0),t);var h=Vn(e,t),d;switch(s){case"sheet":d=xWt(h,t,i,l,a[n],u,f,c);break;case"chart":if(d=TWt(h,t,i,l,a[n],u,f,c),!d||!d["!drawel"])break;var v=mb(d["!drawel"].Target,t),g=wB(v),y=C3t(Ga(e,v,!0),ew(Ga(e,g,!0),v)),b=mb(y,v),w=wB(b);d=sWt(Ga(e,b,!0),b,l,ew(Ga(e,w,!0),b),u,d);break;case"macro":d=OWt(h,t,i,l,a[n],u,f,c);break;case"dialog":d=EWt(h,t,i,l,a[n],u,f,c);break;default:throw new Error("Unrecognized sheet type "+s)}o[n]=d;var _=[];a&&a[n]&&cl(a[n]).forEach(function(x){var T="";if(a[n][x].Type==Rp.CMNT){T=mb(a[n][x].Target,t);var O=PWt(Vn(e,T,!0),T,l);if(!O||!O.length)return;ene(d,O,!1)}a[n][x].Type==Rp.TCMNT&&(T=mb(a[n][x].Target,t),_=_.concat(T3t(Vn(e,T,!0),l)))}),_&&_.length&&ene(d,_,!0,l.people||[])}catch(x){if(l.WTF)throw x}}function mo(e){return e.charAt(0)=="/"?e.slice(1):e}function bjt(e,t){if(ege(),t=t||{},vU(t),Co(e,"META-INF/manifest.xml")||Co(e,"objectdata.xml"))return hne(e,t);if(Co(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof i$<"u"){if(e.FileIndex)return i$(e);var r=vr.utils.cfb_new();return Ere(e).forEach(function(ee){wLt(r,ee,oge(e,ee))}),i$(r)}throw new Error("Unsupported NUMBERS file")}if(!Co(e,"[Content_Types].xml"))throw Co(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Co(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ere(e),i=pFt(Ga(e,"[Content_Types].xml")),a=!1,o,s;if(i.workbooks.length===0&&(s="xl/workbook.xml",Vn(e,s,!0)&&i.workbooks.push(s)),i.workbooks.length===0){if(s="xl/workbook.bin",!Vn(e,s,!0))throw new Error("Could not find workbook");i.workbooks.push(s),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(nw=[],i.sst)try{nw=AWt(Vn(e,mo(i.sst)),i.sst,t)}catch(ee){if(t.WTF)throw ee}t.cellStyles&&i.themes.length&&(l=kWt(Ga(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=RWt(Vn(e,mo(i.style)),i.style,l,t))}i.links.map(function(ee){try{var ie=ew(Ga(e,wB(mo(ee))),ee);return MWt(Vn(e,mo(ee)),ie,ee,t)}catch{}});var f=CWt(Vn(e,mo(i.workbooks[0])),i.workbooks[0],t),c={},h="";i.coreprops.length&&(h=Vn(e,mo(i.coreprops[0]),!0),h&&(c=Age(h)),i.extprops.length!==0&&(h=Vn(e,mo(i.extprops[0]),!0),h&&wFt(h,c,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Ga(e,mo(i.custprops[0]),!0),h&&(d=SFt(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?o=f.Sheets.map(function(ie){return ie.name}):c.Worksheets&&c.SheetNames.length>0&&(o=c.SheetNames),t.bookProps&&(v.Props=c,v.Custprops=d),t.bookSheets&&typeof o<"u"&&(v.SheetNames=o),t.bookSheets?v.SheetNames:t.bookProps))return v;o={};var g={};t.bookDeps&&i.calcchain&&(g=IWt(Vn(e,mo(i.calcchain)),i.calcchain));var y=0,b={},w,_;{var x=f.Sheets;c.Worksheets=x.length,c.SheetNames=[];for(var T=0;T!=x.length;++T)c.SheetNames[T]=x[T].name}var O=a?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),M=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Co(e,M)||(M="xl/_rels/workbook."+O+".rels");var P=ew(Ga(e,M,!0),M.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=DWt(Vn(e,mo(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=O3t(Vn(e,mo(i.people[0])),t)),P&&(P=yjt(P,f.Sheets));var N=Vn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=c.Worksheets;++y){var D="sheet";if(P&&P[y]?(w="xl/"+P[y][1].replace(/[\/]?xl\//,""),Co(e,w)||(w=P[y][1]),Co(e,w)||(w=M.replace(/_rels\/.*$/,"")+P[y][1]),D=P[y][2]):(w="xl/worksheets/sheet"+(y+1-N)+"."+O,w=w.replace(/sheet0\./,"sheet.")),_=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(c.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==y&&(L=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==c.SheetNames[y].toLowerCase()&&(L=1);if(!L)continue e}}mjt(e,w,_,c.SheetNames[y],y,b,o,D,t,f,l,u)}return v={Directory:i,Workbook:f,Props:c,Custprops:d,Deps:g,Sheets:o,SheetNames:c.SheetNames,Strings:nw,Styles:u,Themes:l,SSF:pi(jt)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(ee,ie){ee=ee.replace(/^Root Entry[\/]/,""),v.keys.push(ee),v.files[ee]=e.FileIndex[ie]}))),t&&t.bookVBA&&(i.vba.length>0?v.vbaraw=Vn(e,mo(i.vba[0]),!0):i.defaults&&i.defaults.bin===A3t&&(v.vbaraw=Vn(e,"xl/vbaProject.bin",!0))),v}function wjt(e,t){var r=t||{},n="Workbook",i=vr.find(e,n);try{if(n="/!DataSpaces/Version",i=vr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(hBt(i.content),n="/!DataSpaces/DataSpaceMap",i=vr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=vBt(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=vr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=pBt(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=vr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);yBt(i.content)}catch{}if(n="/EncryptionInfo",i=vr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=mBt(i.content);if(n="/EncryptedPackage",i=vr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(s[1],i.content,r.password||"",r);if(s[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(s[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function pU(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ja(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _jt(e,t){return vr.find(e,"EncryptedPackage")?wjt(e,t):vye(e,t)}function Sjt(e,t){var r,n=e,i=t||{};return i.type||(i.type=hr&&Buffer.isBuffer(e)?"buffer":"base64"),r=sge(n,i),bjt(r,i)}function mye(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return CB(e.slice(r),t);default:break e}return IS.to_workbook(e,t)}function Cjt(e,t){var r="",n=pU(e,t);switch(t.type){case"base64":r=Ja(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Dd(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Kr(r)),t.type="binary",mye(r,t)}function xjt(e,t){var r=e;return t.type=="base64"&&(r=Ja(r)),r=Af.utils.decode(1200,r.slice(2),"str"),t.type="binary",mye(r,t)}function Tjt(e){return e.match(/[^\x00-\x7F]/)?bb(e):e}function a$(e,t,r,n){return n?(r.type="string",IS.to_workbook(e,r)):IS.to_workbook(t,r)}function EB(e,t){Wpe();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return EB(new Uint8Array(e),(r=pi(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Zp={},r.dateNF&&(Zp.dateNF=r.dateNF),r.type||(r.type=hr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=hr?"buffer":"binary",n=dLt(e),typeof Uint8Array<"u"&&!hr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Tjt(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return r=pi(r),r.type="array",EB(Yj(n),r)}switch((i=pU(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return _jt(vr.read(n,r),r);break;case 9:if(i[1]<=8)return vye(n,r);break;case 60:return CB(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return QHt(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return ZHt.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?Sjt(n,r):a$(e,n,r,a);case 239:return i[3]===60?CB(n,r):a$(e,n,r,a);case 255:if(i[1]===254)return xjt(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return rw.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return rw.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Qre.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return ABt.to_workbook(n,r);break;case 10:case 13:case 32:return Cjt(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XHt.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Qre.to_workbook(n,r):a$(e,n,r,a)}function Ojt(e,t,r,n,i,a,o,s){var l=gi(r),u=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),c=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=o?e[r][d]:e[n[d]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;a[d]!=null&&(h[a[d]]=u);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[d]!=null){if(g==null)if(v.t=="e"&&g===null)h[a[d]]=null;else if(u!==void 0)h[a[d]]=u;else if(f&&g===null)h[a[d]]=null;else continue;else h[a[d]]=f&&(v.t!=="n"||v.t==="n"&&s.rawNumbers!==!1)?g:Lu(v,g,s);g!=null&&(c=!1)}}return{row:h,isempty:c}}function RB(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=xn(f);break;case"number":l=xn(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var c=gi(l.s.r),h=[],d=[],v=0,g=0,y=Array.isArray(e),b=l.s.r,w=0,_={};y&&!e[b]&&(e[b]=[]);var x=u.skipHidden&&e["!cols"]||[],T=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(x[w]||{}).hidden)switch(h[w]=Jn(w),r=y?e[b][w]:e[h[w]+c],n){case 1:a[w]=w-l.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),s=o=Lu(r,null,u),g=_[o]||0,!g)_[o]=1;else{do s=o+"_"+g++;while(_[s]);_[o]=g,_[s]=1}a[w]=s}for(b=l.s.r+i;b<=l.e.r;++b)if(!(T[b]||{}).hidden){var O=Ojt(e,l,b,h,n,a,y,u);(O.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[v++]=O.row)}return d.length=v,d}var gne=/"/g;function Ejt(e,t,r,n,i,a,o,s){for(var l=!0,u=[],f="",c=gi(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=s.dense?(e[r]||[])[h]:e[n[h]+c];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(s.rawNumbers&&d.t=="n"?d.v:Lu(d,null,s));for(var v=0,g=0;v!==f.length;++v)if((g=f.charCodeAt(v))===i||g===a||g===34||s.forceQuotes){f='"'+f.replace(gne,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(gne,'""')+'"')):f="";u.push(f)}return s.blankrows===!1&&l?null:u.join(o)}function bye(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=xn(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),s=n.RS!==void 0?n.RS:`
`,l=s.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",c=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(h[v]||{}).hidden||(c[v]=Jn(v));for(var g=0,y=i.s.r;y<=i.e.r;++y)(d[y]||{}).hidden||(f=Ejt(e,i,y,c,o,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?s:"")+f)));return delete n.dense,r.join("")}function Rjt(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=bye(e,t);return r}function kjt(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=xn(e["!ref"]),a="",o=[],s,l=[],u=Array.isArray(e);for(s=i.s.c;s<=i.e.c;++s)o[s]=Jn(s);for(var f=i.s.r;f<=i.e.r;++f)for(a=gi(f),s=i.s.c;s<=i.e.c;++s)if(t=o[s]+a,r=u?(e[f]||[])[s]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function wye(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},o=0,s=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?ra(n.origin):n.origin;o=l.r,s=l.c}var u,f={s:{c:0,r:0},e:{c:s,r:o+t.length-1+i}};if(a["!ref"]){var c=xn(a["!ref"]);f.e.c=Math.max(f.e.c,c.e.c),f.e.r=Math.max(f.e.r,c.e.r),o==-1&&(o=c.e.r+1,f.e.r=o+t.length-1+i)}else o==-1&&(o=0,f.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(g,y){cl(g).forEach(function(b){(d=h.indexOf(b))==-1&&(h[d=h.length]=b);var w=g[b],_="z",x="",T=$t({c:s+d,r:o+y+i});u=NS(a,T),w&&typeof w=="object"&&!(w instanceof Date)?a[T]=w:(typeof w=="number"?_="n":typeof w=="boolean"?_="b":typeof w=="string"?_="s":w instanceof Date?(_="d",n.cellDates||(_="n",w=sa(w)),x=n.dateNF||jt[14]):w===null&&n.nullError&&(_="e",w=0),u?(u.t=_,u.v=w,delete u.w,delete u.R,x&&(u.z=x)):a[T]=u={t:_,v:w},x&&(u.z=x))})}),f.e.c=Math.max(f.e.c,s+h.length-1);var v=gi(o);if(i)for(d=0;d<h.length;++d)a[Jn(d+s)+v]={t:"s",v:h[d]};return a["!ref"]=gr(f),a}function Ajt(e,t){return wye(null,e,t)}function NS(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ra(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?NS(e,$t(t)):NS(e,$t({r:t,c:r||0}))}function Pjt(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function gU(){return{SheetNames:[],Sheets:{}}}function yU(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(pWt(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Ijt(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Pjt(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Mjt(e,t){return e.z=t,e}function _ye(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Djt(e,t,r){return _ye(e,"#"+t,r)}function $jt(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Njt(e,t,r,n){for(var i=typeof t!="string"?t:xn(t),a=typeof t=="string"?t:gr(t),o=i.s.r;o<=i.e.r;++o)for(var s=i.s.c;s<=i.e.c;++s){var l=NS(e,o,s);l.t="n",l.F=a,delete l.v,o==i.s.r&&s==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var yne={encode_col:Jn,encode_row:gi,encode_cell:$t,encode_range:gr,decode_col:rU,decode_row:tU,split_cell:KLt,decode_cell:ra,decode_range:Lm,format_cell:Lu,sheet_add_aoa:Tge,sheet_add_json:wye,sheet_add_dom:pye,aoa_to_sheet:Fm,json_to_sheet:Ajt,table_to_sheet:gye,table_to_book:QWt,sheet_to_csv:bye,sheet_to_txt:Rjt,sheet_to_json:RB,sheet_to_html:JWt,sheet_to_formulae:kjt,sheet_to_row_object_array:RB,sheet_get_cell:NS,book_new:gU,book_append_sheet:yU,book_set_sheet_visibility:Ijt,cell_set_number_format:Mjt,cell_set_hyperlink:_ye,cell_set_internal_link:Djt,cell_add_comment:$jt,sheet_set_array_formula:Njt,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ljt={class:"table-wrapper"},Fjt={class:"toolbar"},Hjt={class:"left"},Bjt={class:"table-box"},Vjt=Fu({__name:"dataTable",props:{chart:{type:Object,default:()=>({})}},setup(e){const t=e;Bpe();const r=Jp(null),n=el(()=>{var l,u;return((u=(l=t.chart)==null?void 0:l.config)==null?void 0:u.data)||null});eb(()=>n.value,()=>{r.value.hotInstance.updateData(gs.cloneDeep(n.value))},{deep:!0});const i=()=>{wne(()=>{const u=r.value.hotInstance.getSourceData().map(c=>c.filter(h=>h!==null)).filter(c=>c.length),f=gs.isEqual(u,n.value);if(n.value&&!f&&u.length){const c={...t.chart};c.config.data=u,LS.emit("updateChart",gs.cloneDeep(c))}})},a=l=>{try{const u=new FileReader;u.onload=f=>{const c=f.target.result,h=EB(c,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],v=yne.decode_range(d["!ref"]);var g=[];for(let y=v.s.r;y<=v.e.r;y++){let b=g.length;g.push([]);for(let w=v.s.c;w<=v.e.c;w++){let _=d[yne.encode_cell({r:y,c:w})];_&&g[b].push(_.v)}}r.value.hotInstance.updateData(g),F1e.success("导出成功")},u.readAsBinaryString(l)}catch(u){console.log("err: ",u)}return!1},o=()=>{r.value.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:t.chart.name})};kB(()=>{n.value&&r.value.hotInstance.updateData(gs.cloneDeep(n.value))});const s=el(()=>({language:"zh-CN",licenseKey:"non-commercial-and-evaluation",width:"auto",data:null,startRows:30,startCols:15,minSpareRows:30,minSpareCols:15,colHeaders:!0,rowHeaders:!0,colWidths:100,dropdownMenu:!1,autoWrapRow:!0,fixedRowsTop:0,fixedColumnsLeft:1,fillHandle:!0,manualRowMove:!0,afterChange(){i()},afterCreateCol(){i()},afterCreateRow(){i()},afterRemoveCol(){i()},afterRemoveRow(){i()},contextMenu:{items:{row_above:{name:"上面插入一行"},row_below:{name:"下面插入一行"},col_left:{name:"左侧插入一列"},col_right:{name:"右侧插入一列"},remove_row:{name:"移除本行"},remove_col:{name:"移除本列"},alignment:{name:"对齐方式"},make_read_only:{name:"只读"},copy:{name:"复制"},cut:{name:"剪切"},separator:_t.plugins.ContextMenu.SEPARATOR}}}));return(l,u)=>{const f=o$("el-button"),c=o$("el-upload");return ii(),ai("div",Ljt,[kr("div",Fjt,[kr("div",Hjt,[Io(c,{"before-upload":a},{default:FT(()=>[Io(f,{type:"primary",class:"import-btn"},{default:FT(()=>[ow("导入数据")]),_:1})]),_:1}),Io(f,{plain:"",type:"primary",onClick:o},{default:FT(()=>[ow("下载数据")]),_:1})])]),kr("div",Bjt,[Io(Mo(mj),{ref_key:"hotTableComponent",ref:r,settings:Mo(s)},null,8,["settings"])])])}}});const Wjt=pm(Vjt,[["__scopeId","data-v-635327b9"]]),jjt={class:"setting-block"},Ujt={class:"tabs"},zjt=["onClick"],Gjt={key:0,class:"data-table"},Yjt={key:1,class:"chart-setting"},Kjt=Fu({__name:"settingBlock",props:{chart:{type:Object,default:()=>({})}},setup(e){const t=[{value:"data",label:"编辑数据"},{value:"chart",label:"编辑图表"}],r=Jp("chart"),n=i=>{r.value=i};return(i,a)=>(ii(),ai("div",jjt,[kr("div",Ujt,[(ii(),ai(HT,null,BT(t,o=>kr("div",{key:o.value,class:cp(["item",{active:r.value===o.value}]),onClick:s=>n(o.value)},zO(o.label),11,zjt)),64))]),r.value==="data"?(ii(),ai("div",Gjt,[Io(Mo(Wjt),{chart:e.chart},null,8,["chart"])])):GO("",!0),r.value==="chart"?(ii(),ai("div",Yjt," chart ")):GO("",!0)]))}});const Xjt=pm(Kjt,[["__scopeId","data-v-69f411eb"]]),qjt={class:"chart-wrapper"},Zjt={class:"container"},Jjt=Fu({__name:"chart",setup(e){const t=k1e(),r=H1e(),n=el(()=>+r.params.id),i=Jp({}),a=async()=>{const s=await t.get(n.value);i.value=s};LS.on("updateChart",async s=>{s.updatedTime=new Date().getTime(),await t.set(s),await a(),o()});const o=()=>{new BroadcastChannel("chart").postMessage("updateChart")};return kB(()=>{a()}),(s,l)=>(ii(),ai("div",qjt,[Io(Mo(Q1e),{chart:i.value},null,8,["chart"]),kr("div",Zjt,[Io(Mo(dCe),{chart:i.value},null,8,["chart"]),Io(Mo(z$e),{chart:i.value},null,8,["chart"]),Io(Mo(Xjt),{chart:i.value},null,8,["chart"])])]))}});const tUt=pm(Jjt,[["__scopeId","data-v-b1ebb219"]]);export{tUt as default};
