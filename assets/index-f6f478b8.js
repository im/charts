import{e as Wo,_ as j1e,a as z1e,P as G1e,c as Y1e,D as K1e,d as X1e,u as q1e}from"./index-3fd11225.js";import{B as db,d as ba,o as Cr,a as Gr,b as fr,e as li,w as Du,t as hg,j as ln,f as mc,g as JO,q as WB,s as VB,_ as Xo,D as Lf,r as da,F as Wp,v as Vp,l as QO,G as g$,H as Ff,y as Td,m as km,E as Z1e,z as J1e,I as uI,J as Q1e,c as _s,K as eCe,L as kp,M as K5,i as Yd,N as tCe,O as rCe,p as eE,P as Ine,Q as Mne,R as nCe,S as Dne,T as iCe,A as aCe,U as oCe,u as sCe,V as lCe}from"./index-f831ef1d.js";const _l=Symbol("CHART");function Xu(e,t){const r=db(e,t);if(!r)throw new Error(`Could not resolve ${e.description}`);return r}const $ne=e=>(WB("data-v-722fad7b"),e=e(),VB(),e),uCe={class:"topbar"},fCe={class:"left"},cCe={class:"logo",title:"charts"},hCe=$ne(()=>fr("img",{src:j1e,alt:"charts"},null,-1)),dCe={class:"center"},vCe={class:"name-box"},pCe={class:"name"},gCe={class:"right"},yCe={class:"operation"},mCe=$ne(()=>fr("div",null,[fr("i",{class:"iconfont icon-xiazai"}),fr("div",{class:"text"},"下载")],-1)),bCe=[mCe],wCe=ba({__name:"topbar",setup(e){const t=Xu(_l),r=n=>{Wo.emit("handleChart",n)};return(n,i)=>{const a=mc("router-link");return Cr(),Gr("div",uCe,[fr("div",fCe,[fr("h1",cCe,[li(a,{tag:"a",to:{name:"home"}},{default:Du(()=>[hCe,JO(" Charts ")]),_:1})])]),fr("div",dCe,[fr("div",vCe,[fr("div",pCe,hg(ln(t).name)+" ",1)])]),fr("div",gCe,[fr("div",yCe,[fr("div",{class:"item",onClick:i[0]||(i[0]=o=>r("download"))},bCe)])])])}}});const _Ce=Xo(wCe,[["__scopeId","data-v-722fad7b"]]);var tE={},SCe={get exports(){return tE},set exports(e){tE=e}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright JS Foundation and other contributors <https://js.foundation/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(e,t){(function(){var r,n="4.17.11",i=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",s="__lodash_hash_undefined__",l=500,u="__lodash_placeholder__",f=1,c=2,h=4,d=1,v=2,g=1,y=2,b=4,w=8,_=16,x=32,E=64,R=128,A=256,N=512,I=30,F="...",H=800,W=16,z=1,te=2,ie=3,fe=1/0,Te=9007199254740991,M=17976931348623157e292,S=0/0,T=4294967295,k=T-1,O=T>>>1,D=[["ary",R],["bind",g],["bindKey",y],["curry",w],["curryRight",_],["flip",N],["partial",x],["partialRight",E],["rearg",A]],L="[object Arguments]",B="[object Array]",Y="[object AsyncFunction]",Q="[object Boolean]",he="[object Date]",ce="[object DOMException]",le="[object Error]",xe="[object Function]",U="[object GeneratorFunction]",De="[object Map]",de="[object Number]",He="[object Null]",Be="[object Object]",Ae="[object Promise]",Ke="[object Proxy]",Xe="[object RegExp]",G="[object Set]",q="[object String]",ae="[object Symbol]",be="[object Undefined]",se="[object WeakMap]",Oe="[object WeakSet]",pe="[object ArrayBuffer]",ge="[object DataView]",me="[object Float32Array]",Ce="[object Float64Array]",Se="[object Int8Array]",Le="[object Int16Array]",qe="[object Int32Array]",Qe="[object Uint8Array]",wt="[object Uint8ClampedArray]",Pt="[object Uint16Array]",Jt="[object Uint32Array]",Ot=/\b__p \+= '';/g,Et=/\b(__p \+=) '' \+/g,jt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,qt=/&(?:amp|lt|gt|quot|#39);/g,zt=/[&<>"']/g,Ht=RegExp(qt.source),At=RegExp(zt.source),st=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,_t=/<%=([\s\S]+?)%>/g,tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tt=/^\w*$/,nt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ht=/[\\^$.*+?()[\]{}|]/g,cr=RegExp(ht.source),dr=/^\s+|\s+$/g,br=/^\s+/,ni=/\s+$/,Dr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,j=/\{\n\/\* \[wrapped with (.+)\] \*/,re=/,? & /,J=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ee=/\\(\\)?/g,ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,oe=/\w*$/,Ie=/^[-+]0x[0-9a-f]+$/i,Ne=/^0b[01]+$/i,Pe=/^\[object .+?Constructor\]$/,we=/^0o[0-7]+$/i,X=/^(?:0|[1-9]\d*)$/,Ee=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Me=/($^)/,ze=/['\n\r\u2028\u2029\\]/g,Ue="\\ud800-\\udfff",Je="\\u0300-\\u036f",St="\\ufe20-\\ufe2f",$r="\\u20d0-\\u20ff",Ut=Je+St+$r,wn="\\u2700-\\u27bf",ns="a-z\\xdf-\\xf6\\xf8-\\xff",af="\\xac\\xb1\\xd7\\xf7",Fc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Il="\\u2000-\\u206f",Jm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vo="A-Z\\xc0-\\xd6\\xd8-\\xde",Pj="\\ufe0e\\ufe0f",Ij=af+Fc+Il+Jm,QA="['’]",Vye="["+Ue+"]",Mj="["+Ij+"]",nC="["+Ut+"]",Dj="\\d+",Uye="["+wn+"]",$j="["+ns+"]",Nj="[^"+Ue+Ij+Dj+wn+ns+vo+"]",eP="\\ud83c[\\udffb-\\udfff]",jye="(?:"+nC+"|"+eP+")",Lj="[^"+Ue+"]",tP="(?:\\ud83c[\\udde6-\\uddff]){2}",rP="[\\ud800-\\udbff][\\udc00-\\udfff]",yv="["+vo+"]",Fj="\\u200d",Hj="(?:"+$j+"|"+Nj+")",zye="(?:"+yv+"|"+Nj+")",Bj="(?:"+QA+"(?:d|ll|m|re|s|t|ve))?",Wj="(?:"+QA+"(?:D|LL|M|RE|S|T|VE))?",Vj=jye+"?",Uj="["+Pj+"]?",Gye="(?:"+Fj+"(?:"+[Lj,tP,rP].join("|")+")"+Uj+Vj+")*",Yye="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Kye="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",jj=Uj+Vj+Gye,Xye="(?:"+[Uye,tP,rP].join("|")+")"+jj,qye="(?:"+[Lj+nC+"?",nC,tP,rP,Vye].join("|")+")",Zye=RegExp(QA,"g"),Jye=RegExp(nC,"g"),nP=RegExp(eP+"(?="+eP+")|"+qye+jj,"g"),Qye=RegExp([yv+"?"+$j+"+"+Bj+"(?="+[Mj,yv,"$"].join("|")+")",zye+"+"+Wj+"(?="+[Mj,yv+Hj,"$"].join("|")+")",yv+"?"+Hj+"+"+Bj,yv+"+"+Wj,Kye,Yye,Dj,Xye].join("|"),"g"),eme=RegExp("["+Fj+Ue+Ut+Pj+"]"),tme=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rme=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],nme=-1,sn={};sn[me]=sn[Ce]=sn[Se]=sn[Le]=sn[qe]=sn[Qe]=sn[wt]=sn[Pt]=sn[Jt]=!0,sn[L]=sn[B]=sn[pe]=sn[Q]=sn[ge]=sn[he]=sn[le]=sn[xe]=sn[De]=sn[de]=sn[Be]=sn[Xe]=sn[G]=sn[q]=sn[se]=!1;var rn={};rn[L]=rn[B]=rn[pe]=rn[ge]=rn[Q]=rn[he]=rn[me]=rn[Ce]=rn[Se]=rn[Le]=rn[qe]=rn[De]=rn[de]=rn[Be]=rn[Xe]=rn[G]=rn[q]=rn[ae]=rn[Qe]=rn[wt]=rn[Pt]=rn[Jt]=!0,rn[le]=rn[xe]=rn[se]=!1;var ime={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ame={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ome={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},sme={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},lme=parseFloat,ume=parseInt,zj=typeof Lf=="object"&&Lf&&Lf.Object===Object&&Lf,fme=typeof self=="object"&&self&&self.Object===Object&&self,wi=zj||fme||Function("return this")(),iP=t&&!t.nodeType&&t,Hc=iP&&!0&&e&&!e.nodeType&&e,Gj=Hc&&Hc.exports===iP,aP=Gj&&zj.process,po=function(){try{var Re=Hc&&Hc.require&&Hc.require("util").types;return Re||aP&&aP.binding&&aP.binding("util")}catch{}}(),Yj=po&&po.isArrayBuffer,Kj=po&&po.isDate,Xj=po&&po.isMap,qj=po&&po.isRegExp,Zj=po&&po.isSet,Jj=po&&po.isTypedArray;function Ua(Re,Fe,$e){switch($e.length){case 0:return Re.call(Fe);case 1:return Re.call(Fe,$e[0]);case 2:return Re.call(Fe,$e[0],$e[1]);case 3:return Re.call(Fe,$e[0],$e[1],$e[2])}return Re.apply(Fe,$e)}function cme(Re,Fe,$e,gt){for(var Zt=-1,Mr=Re==null?0:Re.length;++Zt<Mr;){var ii=Re[Zt];Fe(gt,ii,$e(ii),Re)}return gt}function go(Re,Fe){for(var $e=-1,gt=Re==null?0:Re.length;++$e<gt&&Fe(Re[$e],$e,Re)!==!1;);return Re}function hme(Re,Fe){for(var $e=Re==null?0:Re.length;$e--&&Fe(Re[$e],$e,Re)!==!1;);return Re}function Qj(Re,Fe){for(var $e=-1,gt=Re==null?0:Re.length;++$e<gt;)if(!Fe(Re[$e],$e,Re))return!1;return!0}function of(Re,Fe){for(var $e=-1,gt=Re==null?0:Re.length,Zt=0,Mr=[];++$e<gt;){var ii=Re[$e];Fe(ii,$e,Re)&&(Mr[Zt++]=ii)}return Mr}function iC(Re,Fe){var $e=Re==null?0:Re.length;return!!$e&&mv(Re,Fe,0)>-1}function oP(Re,Fe,$e){for(var gt=-1,Zt=Re==null?0:Re.length;++gt<Zt;)if($e(Fe,Re[gt]))return!0;return!1}function _n(Re,Fe){for(var $e=-1,gt=Re==null?0:Re.length,Zt=Array(gt);++$e<gt;)Zt[$e]=Fe(Re[$e],$e,Re);return Zt}function sf(Re,Fe){for(var $e=-1,gt=Fe.length,Zt=Re.length;++$e<gt;)Re[Zt+$e]=Fe[$e];return Re}function sP(Re,Fe,$e,gt){var Zt=-1,Mr=Re==null?0:Re.length;for(gt&&Mr&&($e=Re[++Zt]);++Zt<Mr;)$e=Fe($e,Re[Zt],Zt,Re);return $e}function dme(Re,Fe,$e,gt){var Zt=Re==null?0:Re.length;for(gt&&Zt&&($e=Re[--Zt]);Zt--;)$e=Fe($e,Re[Zt],Zt,Re);return $e}function lP(Re,Fe){for(var $e=-1,gt=Re==null?0:Re.length;++$e<gt;)if(Fe(Re[$e],$e,Re))return!0;return!1}var vme=uP("length");function pme(Re){return Re.split("")}function gme(Re){return Re.match(J)||[]}function e8(Re,Fe,$e){var gt;return $e(Re,function(Zt,Mr,ii){if(Fe(Zt,Mr,ii))return gt=Mr,!1}),gt}function aC(Re,Fe,$e,gt){for(var Zt=Re.length,Mr=$e+(gt?1:-1);gt?Mr--:++Mr<Zt;)if(Fe(Re[Mr],Mr,Re))return Mr;return-1}function mv(Re,Fe,$e){return Fe===Fe?Rme(Re,Fe,$e):aC(Re,t8,$e)}function yme(Re,Fe,$e,gt){for(var Zt=$e-1,Mr=Re.length;++Zt<Mr;)if(gt(Re[Zt],Fe))return Zt;return-1}function t8(Re){return Re!==Re}function r8(Re,Fe){var $e=Re==null?0:Re.length;return $e?cP(Re,Fe)/$e:S}function uP(Re){return function(Fe){return Fe==null?r:Fe[Re]}}function fP(Re){return function(Fe){return Re==null?r:Re[Fe]}}function n8(Re,Fe,$e,gt,Zt){return Zt(Re,function(Mr,ii,Jr){$e=gt?(gt=!1,Mr):Fe($e,Mr,ii,Jr)}),$e}function mme(Re,Fe){var $e=Re.length;for(Re.sort(Fe);$e--;)Re[$e]=Re[$e].value;return Re}function cP(Re,Fe){for(var $e,gt=-1,Zt=Re.length;++gt<Zt;){var Mr=Fe(Re[gt]);Mr!==r&&($e=$e===r?Mr:$e+Mr)}return $e}function hP(Re,Fe){for(var $e=-1,gt=Array(Re);++$e<Re;)gt[$e]=Fe($e);return gt}function bme(Re,Fe){return _n(Fe,function($e){return[$e,Re[$e]]})}function ja(Re){return function(Fe){return Re(Fe)}}function dP(Re,Fe){return _n(Fe,function($e){return Re[$e]})}function Qm(Re,Fe){return Re.has(Fe)}function i8(Re,Fe){for(var $e=-1,gt=Re.length;++$e<gt&&mv(Fe,Re[$e],0)>-1;);return $e}function a8(Re,Fe){for(var $e=Re.length;$e--&&mv(Fe,Re[$e],0)>-1;);return $e}function wme(Re,Fe){for(var $e=Re.length,gt=0;$e--;)Re[$e]===Fe&&++gt;return gt}var _me=fP(ime),Sme=fP(ame);function Cme(Re){return"\\"+sme[Re]}function xme(Re,Fe){return Re==null?r:Re[Fe]}function bv(Re){return eme.test(Re)}function Tme(Re){return tme.test(Re)}function Ome(Re){for(var Fe,$e=[];!(Fe=Re.next()).done;)$e.push(Fe.value);return $e}function vP(Re){var Fe=-1,$e=Array(Re.size);return Re.forEach(function(gt,Zt){$e[++Fe]=[Zt,gt]}),$e}function o8(Re,Fe){return function($e){return Re(Fe($e))}}function lf(Re,Fe){for(var $e=-1,gt=Re.length,Zt=0,Mr=[];++$e<gt;){var ii=Re[$e];(ii===Fe||ii===u)&&(Re[$e]=u,Mr[Zt++]=$e)}return Mr}function oC(Re){var Fe=-1,$e=Array(Re.size);return Re.forEach(function(gt){$e[++Fe]=gt}),$e}function Eme(Re){var Fe=-1,$e=Array(Re.size);return Re.forEach(function(gt){$e[++Fe]=[gt,gt]}),$e}function Rme(Re,Fe,$e){for(var gt=$e-1,Zt=Re.length;++gt<Zt;)if(Re[gt]===Fe)return gt;return-1}function kme(Re,Fe,$e){for(var gt=$e+1;gt--;)if(Re[gt]===Fe)return gt;return gt}function wv(Re){return bv(Re)?Pme(Re):vme(Re)}function is(Re){return bv(Re)?Ime(Re):pme(Re)}var Ame=fP(ome);function Pme(Re){for(var Fe=nP.lastIndex=0;nP.test(Re);)++Fe;return Fe}function Ime(Re){return Re.match(nP)||[]}function Mme(Re){return Re.match(Qye)||[]}var Dme=function Re(Fe){Fe=Fe==null?wi:_v.defaults(wi.Object(),Fe,_v.pick(wi,rme));var $e=Fe.Array,gt=Fe.Date,Zt=Fe.Error,Mr=Fe.Function,ii=Fe.Math,Jr=Fe.Object,pP=Fe.RegExp,$me=Fe.String,yo=Fe.TypeError,sC=$e.prototype,Nme=Mr.prototype,Sv=Jr.prototype,lC=Fe["__core-js_shared__"],uC=Nme.toString,nn=Sv.hasOwnProperty,Lme=0,s8=function(){var p=/[^.]+$/.exec(lC&&lC.keys&&lC.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),fC=Sv.toString,Fme=uC.call(Jr),Hme=wi._,Bme=pP("^"+uC.call(nn).replace(ht,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cC=Gj?Fe.Buffer:r,uf=Fe.Symbol,hC=Fe.Uint8Array,l8=cC?cC.allocUnsafe:r,dC=o8(Jr.getPrototypeOf,Jr),u8=Jr.create,f8=Sv.propertyIsEnumerable,vC=sC.splice,c8=uf?uf.isConcatSpreadable:r,e0=uf?uf.iterator:r,Bc=uf?uf.toStringTag:r,pC=function(){try{var p=jc(Jr,"defineProperty");return p({},"",{}),p}catch{}}(),Wme=Fe.clearTimeout!==wi.clearTimeout&&Fe.clearTimeout,Vme=gt&&gt.now!==wi.Date.now&&gt.now,Ume=Fe.setTimeout!==wi.setTimeout&&Fe.setTimeout,gC=ii.ceil,yC=ii.floor,gP=Jr.getOwnPropertySymbols,jme=cC?cC.isBuffer:r,zme=Fe.isFinite,Gme=sC.join,Yme=o8(Jr.keys,Jr),ai=ii.max,Ei=ii.min,Kme=gt.now,Xme=Fe.parseInt,h8=ii.random,qme=sC.reverse,yP=jc(Fe,"DataView"),t0=jc(Fe,"Map"),mP=jc(Fe,"Promise"),Cv=jc(Fe,"Set"),r0=jc(Fe,"WeakMap"),n0=jc(Jr,"create"),mC=r0&&new r0,i0={},Zme=zc(yP),Jme=zc(t0),Qme=zc(mP),e0e=zc(Cv),t0e=zc(r0),bC=uf?uf.prototype:r,a0=bC?bC.valueOf:r,d8=bC?bC.toString:r;function K(p){if(An(p)&&!Qt(p)&&!(p instanceof wr)){if(p instanceof mo)return p;if(nn.call(p,"__wrapped__"))return d5(p)}return new mo(p)}var xv=function(){function p(){}return function(m){if(!Sn(m))return{};if(u8)return u8(m);p.prototype=m;var C=new p;return p.prototype=r,C}}();function wC(){}function mo(p,m){this.__wrapped__=p,this.__actions__=[],this.__chain__=!!m,this.__index__=0,this.__values__=r}K.templateSettings={escape:st,evaluate:rt,interpolate:_t,variable:"",imports:{_:K}},K.prototype=wC.prototype,K.prototype.constructor=K,mo.prototype=xv(wC.prototype),mo.prototype.constructor=mo;function wr(p){this.__wrapped__=p,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=T,this.__views__=[]}function r0e(){var p=new wr(this.__wrapped__);return p.__actions__=Sa(this.__actions__),p.__dir__=this.__dir__,p.__filtered__=this.__filtered__,p.__iteratees__=Sa(this.__iteratees__),p.__takeCount__=this.__takeCount__,p.__views__=Sa(this.__views__),p}function n0e(){if(this.__filtered__){var p=new wr(this);p.__dir__=-1,p.__filtered__=!0}else p=this.clone(),p.__dir__*=-1;return p}function i0e(){var p=this.__wrapped__.value(),m=this.__dir__,C=Qt(p),P=m<0,V=C?p.length:0,Z=ybe(0,V,this.__views__),ue=Z.start,_e=Z.end,ke=_e-ue,Ve=P?_e:ue-1,We=this.__iteratees__,je=We.length,ft=0,Ct=Ei(ke,this.__takeCount__);if(!C||!P&&V==ke&&Ct==ke)return L8(p,this.__actions__);var Ft=[];e:for(;ke--&&ft<Ct;){Ve+=m;for(var yr=-1,Dt=p[Ve];++yr<je;){var mr=We[yr],Lr=mr.iteratee,qi=mr.type,Zi=Lr(Dt);if(qi==te)Dt=Zi;else if(!Zi){if(qi==z)continue e;break e}}Ft[ft++]=Dt}return Ft}wr.prototype=xv(wC.prototype),wr.prototype.constructor=wr;function Wc(p){var m=-1,C=p==null?0:p.length;for(this.clear();++m<C;){var P=p[m];this.set(P[0],P[1])}}function a0e(){this.__data__=n0?n0(null):{},this.size=0}function o0e(p){var m=this.has(p)&&delete this.__data__[p];return this.size-=m?1:0,m}function s0e(p){var m=this.__data__;if(n0){var C=m[p];return C===s?r:C}return nn.call(m,p)?m[p]:r}function l0e(p){var m=this.__data__;return n0?m[p]!==r:nn.call(m,p)}function u0e(p,m){var C=this.__data__;return this.size+=this.has(p)?0:1,C[p]=n0&&m===r?s:m,this}Wc.prototype.clear=a0e,Wc.prototype.delete=o0e,Wc.prototype.get=s0e,Wc.prototype.has=l0e,Wc.prototype.set=u0e;function Ml(p){var m=-1,C=p==null?0:p.length;for(this.clear();++m<C;){var P=p[m];this.set(P[0],P[1])}}function f0e(){this.__data__=[],this.size=0}function c0e(p){var m=this.__data__,C=_C(m,p);if(C<0)return!1;var P=m.length-1;return C==P?m.pop():vC.call(m,C,1),--this.size,!0}function h0e(p){var m=this.__data__,C=_C(m,p);return C<0?r:m[C][1]}function d0e(p){return _C(this.__data__,p)>-1}function v0e(p,m){var C=this.__data__,P=_C(C,p);return P<0?(++this.size,C.push([p,m])):C[P][1]=m,this}Ml.prototype.clear=f0e,Ml.prototype.delete=c0e,Ml.prototype.get=h0e,Ml.prototype.has=d0e,Ml.prototype.set=v0e;function Dl(p){var m=-1,C=p==null?0:p.length;for(this.clear();++m<C;){var P=p[m];this.set(P[0],P[1])}}function p0e(){this.size=0,this.__data__={hash:new Wc,map:new(t0||Ml),string:new Wc}}function g0e(p){var m=MC(this,p).delete(p);return this.size-=m?1:0,m}function y0e(p){return MC(this,p).get(p)}function m0e(p){return MC(this,p).has(p)}function b0e(p,m){var C=MC(this,p),P=C.size;return C.set(p,m),this.size+=C.size==P?0:1,this}Dl.prototype.clear=p0e,Dl.prototype.delete=g0e,Dl.prototype.get=y0e,Dl.prototype.has=m0e,Dl.prototype.set=b0e;function Vc(p){var m=-1,C=p==null?0:p.length;for(this.__data__=new Dl;++m<C;)this.add(p[m])}function w0e(p){return this.__data__.set(p,s),this}function _0e(p){return this.__data__.has(p)}Vc.prototype.add=Vc.prototype.push=w0e,Vc.prototype.has=_0e;function as(p){var m=this.__data__=new Ml(p);this.size=m.size}function S0e(){this.__data__=new Ml,this.size=0}function C0e(p){var m=this.__data__,C=m.delete(p);return this.size=m.size,C}function x0e(p){return this.__data__.get(p)}function T0e(p){return this.__data__.has(p)}function O0e(p,m){var C=this.__data__;if(C instanceof Ml){var P=C.__data__;if(!t0||P.length<i-1)return P.push([p,m]),this.size=++C.size,this;C=this.__data__=new Dl(P)}return C.set(p,m),this.size=C.size,this}as.prototype.clear=S0e,as.prototype.delete=C0e,as.prototype.get=x0e,as.prototype.has=T0e,as.prototype.set=O0e;function v8(p,m){var C=Qt(p),P=!C&&Gc(p),V=!C&&!P&&vf(p),Z=!C&&!P&&!V&&kv(p),ue=C||P||V||Z,_e=ue?hP(p.length,$me):[],ke=_e.length;for(var Ve in p)(m||nn.call(p,Ve))&&!(ue&&(Ve=="length"||V&&(Ve=="offset"||Ve=="parent")||Z&&(Ve=="buffer"||Ve=="byteLength"||Ve=="byteOffset")||Fl(Ve,ke)))&&_e.push(Ve);return _e}function p8(p){var m=p.length;return m?p[kP(0,m-1)]:r}function E0e(p,m){return DC(Sa(p),Uc(m,0,p.length))}function R0e(p){return DC(Sa(p))}function bP(p,m,C){(C!==r&&!os(p[m],C)||C===r&&!(m in p))&&$l(p,m,C)}function o0(p,m,C){var P=p[m];(!(nn.call(p,m)&&os(P,C))||C===r&&!(m in p))&&$l(p,m,C)}function _C(p,m){for(var C=p.length;C--;)if(os(p[C][0],m))return C;return-1}function k0e(p,m,C,P){return ff(p,function(V,Z,ue){m(P,V,C(V),ue)}),P}function g8(p,m){return p&&Vs(m,vi(m),p)}function A0e(p,m){return p&&Vs(m,xa(m),p)}function $l(p,m,C){m=="__proto__"&&pC?pC(p,m,{configurable:!0,enumerable:!0,value:C,writable:!0}):p[m]=C}function wP(p,m){for(var C=-1,P=m.length,V=$e(P),Z=p==null;++C<P;)V[C]=Z?r:eI(p,m[C]);return V}function Uc(p,m,C){return p===p&&(C!==r&&(p=p<=C?p:C),m!==r&&(p=p>=m?p:m)),p}function bo(p,m,C,P,V,Z){var ue,_e=m&f,ke=m&c,Ve=m&h;if(C&&(ue=V?C(p,P,V,Z):C(p)),ue!==r)return ue;if(!Sn(p))return p;var We=Qt(p);if(We){if(ue=bbe(p),!_e)return Sa(p,ue)}else{var je=Ri(p),ft=je==xe||je==U;if(vf(p))return H8(p,_e);if(je==Be||je==L||ft&&!V){if(ue=ke||ft?{}:i5(p),!_e)return ke?lbe(p,A0e(ue,p)):sbe(p,g8(ue,p))}else{if(!rn[je])return V?p:{};ue=wbe(p,je,_e)}}Z||(Z=new as);var Ct=Z.get(p);if(Ct)return Ct;if(Z.set(p,ue),M5(p))return p.forEach(function(Dt){ue.add(bo(Dt,m,C,Dt,p,Z))}),ue;if(P5(p))return p.forEach(function(Dt,mr){ue.set(mr,bo(Dt,m,C,mr,p,Z))}),ue;var Ft=Ve?ke?BP:HP:ke?xa:vi,yr=We?r:Ft(p);return go(yr||p,function(Dt,mr){yr&&(mr=Dt,Dt=p[mr]),o0(ue,mr,bo(Dt,m,C,mr,p,Z))}),ue}function P0e(p){var m=vi(p);return function(C){return y8(C,p,m)}}function y8(p,m,C){var P=C.length;if(p==null)return!P;for(p=Jr(p);P--;){var V=C[P],Z=m[V],ue=p[V];if(ue===r&&!(V in p)||!Z(ue))return!1}return!0}function m8(p,m,C){if(typeof p!="function")throw new yo(o);return d0(function(){p.apply(r,C)},m)}function s0(p,m,C,P){var V=-1,Z=iC,ue=!0,_e=p.length,ke=[],Ve=m.length;if(!_e)return ke;C&&(m=_n(m,ja(C))),P?(Z=oP,ue=!1):m.length>=i&&(Z=Qm,ue=!1,m=new Vc(m));e:for(;++V<_e;){var We=p[V],je=C==null?We:C(We);if(We=P||We!==0?We:0,ue&&je===je){for(var ft=Ve;ft--;)if(m[ft]===je)continue e;ke.push(We)}else Z(m,je,P)||ke.push(We)}return ke}var ff=j8(Ws),b8=j8(SP,!0);function I0e(p,m){var C=!0;return ff(p,function(P,V,Z){return C=!!m(P,V,Z),C}),C}function SC(p,m,C){for(var P=-1,V=p.length;++P<V;){var Z=p[P],ue=m(Z);if(ue!=null&&(_e===r?ue===ue&&!Ga(ue):C(ue,_e)))var _e=ue,ke=Z}return ke}function M0e(p,m,C,P){var V=p.length;for(C=ar(C),C<0&&(C=-C>V?0:V+C),P=P===r||P>V?V:ar(P),P<0&&(P+=V),P=C>P?0:$5(P);C<P;)p[C++]=m;return p}function w8(p,m){var C=[];return ff(p,function(P,V,Z){m(P,V,Z)&&C.push(P)}),C}function _i(p,m,C,P,V){var Z=-1,ue=p.length;for(C||(C=Sbe),V||(V=[]);++Z<ue;){var _e=p[Z];m>0&&C(_e)?m>1?_i(_e,m-1,C,P,V):sf(V,_e):P||(V[V.length]=_e)}return V}var _P=z8(),_8=z8(!0);function Ws(p,m){return p&&_P(p,m,vi)}function SP(p,m){return p&&_8(p,m,vi)}function CC(p,m){return of(m,function(C){return Hl(p[C])})}function Tv(p,m){m=hf(m,p);for(var C=0,P=m.length;p!=null&&C<P;)p=p[Us(m[C++])];return C&&C==P?p:r}function S8(p,m,C){var P=m(p);return Qt(p)?P:sf(P,C(p))}function Ki(p){return p==null?p===r?be:He:Bc&&Bc in Jr(p)?gbe(p):kbe(p)}function CP(p,m){return p>m}function D0e(p,m){return p!=null&&nn.call(p,m)}function $0e(p,m){return p!=null&&m in Jr(p)}function N0e(p,m,C){return p>=Ei(m,C)&&p<ai(m,C)}function xP(p,m,C){for(var P=C?oP:iC,V=p[0].length,Z=p.length,ue=Z,_e=$e(Z),ke=1/0,Ve=[];ue--;){var We=p[ue];ue&&m&&(We=_n(We,ja(m))),ke=Ei(We.length,ke),_e[ue]=!C&&(m||V>=120&&We.length>=120)?new Vc(ue&&We):r}We=p[0];var je=-1,ft=_e[0];e:for(;++je<V&&Ve.length<ke;){var Ct=We[je],Ft=m?m(Ct):Ct;if(Ct=C||Ct!==0?Ct:0,!(ft?Qm(ft,Ft):P(Ve,Ft,C))){for(ue=Z;--ue;){var yr=_e[ue];if(!(yr?Qm(yr,Ft):P(p[ue],Ft,C)))continue e}ft&&ft.push(Ft),Ve.push(Ct)}}return Ve}function L0e(p,m,C,P){return Ws(p,function(V,Z,ue){m(P,C(V),Z,ue)}),P}function l0(p,m,C){m=hf(m,p),p=l5(p,m);var P=p==null?p:p[Us(_o(m))];return P==null?r:Ua(P,p,C)}function C8(p){return An(p)&&Ki(p)==L}function F0e(p){return An(p)&&Ki(p)==pe}function H0e(p){return An(p)&&Ki(p)==he}function u0(p,m,C,P,V){return p===m?!0:p==null||m==null||!An(p)&&!An(m)?p!==p&&m!==m:B0e(p,m,C,P,u0,V)}function B0e(p,m,C,P,V,Z){var ue=Qt(p),_e=Qt(m),ke=ue?B:Ri(p),Ve=_e?B:Ri(m);ke=ke==L?Be:ke,Ve=Ve==L?Be:Ve;var We=ke==Be,je=Ve==Be,ft=ke==Ve;if(ft&&vf(p)){if(!vf(m))return!1;ue=!0,We=!1}if(ft&&!We)return Z||(Z=new as),ue||kv(p)?t5(p,m,C,P,V,Z):vbe(p,m,ke,C,P,V,Z);if(!(C&d)){var Ct=We&&nn.call(p,"__wrapped__"),Ft=je&&nn.call(m,"__wrapped__");if(Ct||Ft){var yr=Ct?p.value():p,Dt=Ft?m.value():m;return Z||(Z=new as),V(yr,Dt,C,P,Z)}}return ft?(Z||(Z=new as),pbe(p,m,C,P,V,Z)):!1}function W0e(p){return An(p)&&Ri(p)==De}function TP(p,m,C,P){var V=C.length,Z=V,ue=!P;if(p==null)return!Z;for(p=Jr(p);V--;){var _e=C[V];if(ue&&_e[2]?_e[1]!==p[_e[0]]:!(_e[0]in p))return!1}for(;++V<Z;){_e=C[V];var ke=_e[0],Ve=p[ke],We=_e[1];if(ue&&_e[2]){if(Ve===r&&!(ke in p))return!1}else{var je=new as;if(P)var ft=P(Ve,We,ke,p,m,je);if(!(ft===r?u0(We,Ve,d|v,P,je):ft))return!1}}return!0}function x8(p){if(!Sn(p)||xbe(p))return!1;var m=Hl(p)?Bme:Pe;return m.test(zc(p))}function V0e(p){return An(p)&&Ki(p)==Xe}function U0e(p){return An(p)&&Ri(p)==G}function j0e(p){return An(p)&&BC(p.length)&&!!sn[Ki(p)]}function T8(p){return typeof p=="function"?p:p==null?Ta:typeof p=="object"?Qt(p)?R8(p[0],p[1]):E8(p):G5(p)}function OP(p){if(!h0(p))return Yme(p);var m=[];for(var C in Jr(p))nn.call(p,C)&&C!="constructor"&&m.push(C);return m}function z0e(p){if(!Sn(p))return Rbe(p);var m=h0(p),C=[];for(var P in p)P=="constructor"&&(m||!nn.call(p,P))||C.push(P);return C}function EP(p,m){return p<m}function O8(p,m){var C=-1,P=Ca(p)?$e(p.length):[];return ff(p,function(V,Z,ue){P[++C]=m(V,Z,ue)}),P}function E8(p){var m=VP(p);return m.length==1&&m[0][2]?o5(m[0][0],m[0][1]):function(C){return C===p||TP(C,p,m)}}function R8(p,m){return jP(p)&&a5(m)?o5(Us(p),m):function(C){var P=eI(C,p);return P===r&&P===m?tI(C,p):u0(m,P,d|v)}}function xC(p,m,C,P,V){p!==m&&_P(m,function(Z,ue){if(Sn(Z))V||(V=new as),G0e(p,m,ue,C,xC,P,V);else{var _e=P?P(GP(p,ue),Z,ue+"",p,m,V):r;_e===r&&(_e=Z),bP(p,ue,_e)}},xa)}function G0e(p,m,C,P,V,Z,ue){var _e=GP(p,C),ke=GP(m,C),Ve=ue.get(ke);if(Ve){bP(p,C,Ve);return}var We=Z?Z(_e,ke,C+"",p,m,ue):r,je=We===r;if(je){var ft=Qt(ke),Ct=!ft&&vf(ke),Ft=!ft&&!Ct&&kv(ke);We=ke,ft||Ct||Ft?Qt(_e)?We=_e:Ln(_e)?We=Sa(_e):Ct?(je=!1,We=H8(ke,!0)):Ft?(je=!1,We=B8(ke,!0)):We=[]:v0(ke)||Gc(ke)?(We=_e,Gc(_e)?We=N5(_e):(!Sn(_e)||Hl(_e))&&(We=i5(ke))):je=!1}je&&(ue.set(ke,We),V(We,ke,P,Z,ue),ue.delete(ke)),bP(p,C,We)}function k8(p,m){var C=p.length;if(C)return m+=m<0?C:0,Fl(m,C)?p[m]:r}function A8(p,m,C){var P=-1;m=_n(m.length?m:[Ta],ja(Mt()));var V=O8(p,function(Z,ue,_e){var ke=_n(m,function(Ve){return Ve(Z)});return{criteria:ke,index:++P,value:Z}});return mme(V,function(Z,ue){return obe(Z,ue,C)})}function Y0e(p,m){return P8(p,m,function(C,P){return tI(p,P)})}function P8(p,m,C){for(var P=-1,V=m.length,Z={};++P<V;){var ue=m[P],_e=Tv(p,ue);C(_e,ue)&&f0(Z,hf(ue,p),_e)}return Z}function K0e(p){return function(m){return Tv(m,p)}}function RP(p,m,C,P){var V=P?yme:mv,Z=-1,ue=m.length,_e=p;for(p===m&&(m=Sa(m)),C&&(_e=_n(p,ja(C)));++Z<ue;)for(var ke=0,Ve=m[Z],We=C?C(Ve):Ve;(ke=V(_e,We,ke,P))>-1;)_e!==p&&vC.call(_e,ke,1),vC.call(p,ke,1);return p}function I8(p,m){for(var C=p?m.length:0,P=C-1;C--;){var V=m[C];if(C==P||V!==Z){var Z=V;Fl(V)?vC.call(p,V,1):IP(p,V)}}return p}function kP(p,m){return p+yC(h8()*(m-p+1))}function X0e(p,m,C,P){for(var V=-1,Z=ai(gC((m-p)/(C||1)),0),ue=$e(Z);Z--;)ue[P?Z:++V]=p,p+=C;return ue}function AP(p,m){var C="";if(!p||m<1||m>Te)return C;do m%2&&(C+=p),m=yC(m/2),m&&(p+=p);while(m);return C}function hr(p,m){return YP(s5(p,m,Ta),p+"")}function q0e(p){return p8(Av(p))}function Z0e(p,m){var C=Av(p);return DC(C,Uc(m,0,C.length))}function f0(p,m,C,P){if(!Sn(p))return p;m=hf(m,p);for(var V=-1,Z=m.length,ue=Z-1,_e=p;_e!=null&&++V<Z;){var ke=Us(m[V]),Ve=C;if(V!=ue){var We=_e[ke];Ve=P?P(We,ke,_e):r,Ve===r&&(Ve=Sn(We)?We:Fl(m[V+1])?[]:{})}o0(_e,ke,Ve),_e=_e[ke]}return p}var M8=mC?function(p,m){return mC.set(p,m),p}:Ta,J0e=pC?function(p,m){return pC(p,"toString",{configurable:!0,enumerable:!1,value:nI(m),writable:!0})}:Ta;function Q0e(p){return DC(Av(p))}function wo(p,m,C){var P=-1,V=p.length;m<0&&(m=-m>V?0:V+m),C=C>V?V:C,C<0&&(C+=V),V=m>C?0:C-m>>>0,m>>>=0;for(var Z=$e(V);++P<V;)Z[P]=p[P+m];return Z}function ebe(p,m){var C;return ff(p,function(P,V,Z){return C=m(P,V,Z),!C}),!!C}function TC(p,m,C){var P=0,V=p==null?P:p.length;if(typeof m=="number"&&m===m&&V<=O){for(;P<V;){var Z=P+V>>>1,ue=p[Z];ue!==null&&!Ga(ue)&&(C?ue<=m:ue<m)?P=Z+1:V=Z}return V}return PP(p,m,Ta,C)}function PP(p,m,C,P){m=C(m);for(var V=0,Z=p==null?0:p.length,ue=m!==m,_e=m===null,ke=Ga(m),Ve=m===r;V<Z;){var We=yC((V+Z)/2),je=C(p[We]),ft=je!==r,Ct=je===null,Ft=je===je,yr=Ga(je);if(ue)var Dt=P||Ft;else Ve?Dt=Ft&&(P||ft):_e?Dt=Ft&&ft&&(P||!Ct):ke?Dt=Ft&&ft&&!Ct&&(P||!yr):Ct||yr?Dt=!1:Dt=P?je<=m:je<m;Dt?V=We+1:Z=We}return Ei(Z,k)}function D8(p,m){for(var C=-1,P=p.length,V=0,Z=[];++C<P;){var ue=p[C],_e=m?m(ue):ue;if(!C||!os(_e,ke)){var ke=_e;Z[V++]=ue===0?0:ue}}return Z}function $8(p){return typeof p=="number"?p:Ga(p)?S:+p}function za(p){if(typeof p=="string")return p;if(Qt(p))return _n(p,za)+"";if(Ga(p))return d8?d8.call(p):"";var m=p+"";return m=="0"&&1/p==-fe?"-0":m}function cf(p,m,C){var P=-1,V=iC,Z=p.length,ue=!0,_e=[],ke=_e;if(C)ue=!1,V=oP;else if(Z>=i){var Ve=m?null:hbe(p);if(Ve)return oC(Ve);ue=!1,V=Qm,ke=new Vc}else ke=m?[]:_e;e:for(;++P<Z;){var We=p[P],je=m?m(We):We;if(We=C||We!==0?We:0,ue&&je===je){for(var ft=ke.length;ft--;)if(ke[ft]===je)continue e;m&&ke.push(je),_e.push(We)}else V(ke,je,C)||(ke!==_e&&ke.push(je),_e.push(We))}return _e}function IP(p,m){return m=hf(m,p),p=l5(p,m),p==null||delete p[Us(_o(m))]}function N8(p,m,C,P){return f0(p,m,C(Tv(p,m)),P)}function OC(p,m,C,P){for(var V=p.length,Z=P?V:-1;(P?Z--:++Z<V)&&m(p[Z],Z,p););return C?wo(p,P?0:Z,P?Z+1:V):wo(p,P?Z+1:0,P?V:Z)}function L8(p,m){var C=p;return C instanceof wr&&(C=C.value()),sP(m,function(P,V){return V.func.apply(V.thisArg,sf([P],V.args))},C)}function MP(p,m,C){var P=p.length;if(P<2)return P?cf(p[0]):[];for(var V=-1,Z=$e(P);++V<P;)for(var ue=p[V],_e=-1;++_e<P;)_e!=V&&(Z[V]=s0(Z[V]||ue,p[_e],m,C));return cf(_i(Z,1),m,C)}function F8(p,m,C){for(var P=-1,V=p.length,Z=m.length,ue={};++P<V;){var _e=P<Z?m[P]:r;C(ue,p[P],_e)}return ue}function DP(p){return Ln(p)?p:[]}function $P(p){return typeof p=="function"?p:Ta}function hf(p,m){return Qt(p)?p:jP(p,m)?[p]:h5(Nr(p))}var tbe=hr;function df(p,m,C){var P=p.length;return C=C===r?P:C,!m&&C>=P?p:wo(p,m,C)}var rbe=Wme||function(p){return wi.clearTimeout(p)};function H8(p,m){if(m)return p.slice();var C=p.length,P=l8?l8(C):new p.constructor(C);return p.copy(P),P}function NP(p){var m=new p.constructor(p.byteLength);return new hC(m).set(new hC(p)),m}function nbe(p,m){var C=m?NP(p.buffer):p.buffer;return new p.constructor(C,p.byteOffset,p.byteLength)}function ibe(p){var m=new p.constructor(p.source,oe.exec(p));return m.lastIndex=p.lastIndex,m}function abe(p){return a0?Jr(a0.call(p)):{}}function B8(p,m){var C=m?NP(p.buffer):p.buffer;return new p.constructor(C,p.byteOffset,p.length)}function W8(p,m){if(p!==m){var C=p!==r,P=p===null,V=p===p,Z=Ga(p),ue=m!==r,_e=m===null,ke=m===m,Ve=Ga(m);if(!_e&&!Ve&&!Z&&p>m||Z&&ue&&ke&&!_e&&!Ve||P&&ue&&ke||!C&&ke||!V)return 1;if(!P&&!Z&&!Ve&&p<m||Ve&&C&&V&&!P&&!Z||_e&&C&&V||!ue&&V||!ke)return-1}return 0}function obe(p,m,C){for(var P=-1,V=p.criteria,Z=m.criteria,ue=V.length,_e=C.length;++P<ue;){var ke=W8(V[P],Z[P]);if(ke){if(P>=_e)return ke;var Ve=C[P];return ke*(Ve=="desc"?-1:1)}}return p.index-m.index}function V8(p,m,C,P){for(var V=-1,Z=p.length,ue=C.length,_e=-1,ke=m.length,Ve=ai(Z-ue,0),We=$e(ke+Ve),je=!P;++_e<ke;)We[_e]=m[_e];for(;++V<ue;)(je||V<Z)&&(We[C[V]]=p[V]);for(;Ve--;)We[_e++]=p[V++];return We}function U8(p,m,C,P){for(var V=-1,Z=p.length,ue=-1,_e=C.length,ke=-1,Ve=m.length,We=ai(Z-_e,0),je=$e(We+Ve),ft=!P;++V<We;)je[V]=p[V];for(var Ct=V;++ke<Ve;)je[Ct+ke]=m[ke];for(;++ue<_e;)(ft||V<Z)&&(je[Ct+C[ue]]=p[V++]);return je}function Sa(p,m){var C=-1,P=p.length;for(m||(m=$e(P));++C<P;)m[C]=p[C];return m}function Vs(p,m,C,P){var V=!C;C||(C={});for(var Z=-1,ue=m.length;++Z<ue;){var _e=m[Z],ke=P?P(C[_e],p[_e],_e,C,p):r;ke===r&&(ke=p[_e]),V?$l(C,_e,ke):o0(C,_e,ke)}return C}function sbe(p,m){return Vs(p,UP(p),m)}function lbe(p,m){return Vs(p,r5(p),m)}function EC(p,m){return function(C,P){var V=Qt(C)?cme:k0e,Z=m?m():{};return V(C,p,Mt(P,2),Z)}}function Ov(p){return hr(function(m,C){var P=-1,V=C.length,Z=V>1?C[V-1]:r,ue=V>2?C[2]:r;for(Z=p.length>3&&typeof Z=="function"?(V--,Z):r,ue&&Xi(C[0],C[1],ue)&&(Z=V<3?r:Z,V=1),m=Jr(m);++P<V;){var _e=C[P];_e&&p(m,_e,P,Z)}return m})}function j8(p,m){return function(C,P){if(C==null)return C;if(!Ca(C))return p(C,P);for(var V=C.length,Z=m?V:-1,ue=Jr(C);(m?Z--:++Z<V)&&P(ue[Z],Z,ue)!==!1;);return C}}function z8(p){return function(m,C,P){for(var V=-1,Z=Jr(m),ue=P(m),_e=ue.length;_e--;){var ke=ue[p?_e:++V];if(C(Z[ke],ke,Z)===!1)break}return m}}function ube(p,m,C){var P=m&g,V=c0(p);function Z(){var ue=this&&this!==wi&&this instanceof Z?V:p;return ue.apply(P?C:this,arguments)}return Z}function G8(p){return function(m){m=Nr(m);var C=bv(m)?is(m):r,P=C?C[0]:m.charAt(0),V=C?df(C,1).join(""):m.slice(1);return P[p]()+V}}function Ev(p){return function(m){return sP(j5(U5(m).replace(Zye,"")),p,"")}}function c0(p){return function(){var m=arguments;switch(m.length){case 0:return new p;case 1:return new p(m[0]);case 2:return new p(m[0],m[1]);case 3:return new p(m[0],m[1],m[2]);case 4:return new p(m[0],m[1],m[2],m[3]);case 5:return new p(m[0],m[1],m[2],m[3],m[4]);case 6:return new p(m[0],m[1],m[2],m[3],m[4],m[5]);case 7:return new p(m[0],m[1],m[2],m[3],m[4],m[5],m[6])}var C=xv(p.prototype),P=p.apply(C,m);return Sn(P)?P:C}}function fbe(p,m,C){var P=c0(p);function V(){for(var Z=arguments.length,ue=$e(Z),_e=Z,ke=Rv(V);_e--;)ue[_e]=arguments[_e];var Ve=Z<3&&ue[0]!==ke&&ue[Z-1]!==ke?[]:lf(ue,ke);if(Z-=Ve.length,Z<C)return Z8(p,m,RC,V.placeholder,r,ue,Ve,r,r,C-Z);var We=this&&this!==wi&&this instanceof V?P:p;return Ua(We,this,ue)}return V}function Y8(p){return function(m,C,P){var V=Jr(m);if(!Ca(m)){var Z=Mt(C,3);m=vi(m),C=function(_e){return Z(V[_e],_e,V)}}var ue=p(m,C,P);return ue>-1?V[Z?m[ue]:ue]:r}}function K8(p){return Ll(function(m){var C=m.length,P=C,V=mo.prototype.thru;for(p&&m.reverse();P--;){var Z=m[P];if(typeof Z!="function")throw new yo(o);if(V&&!ue&&IC(Z)=="wrapper")var ue=new mo([],!0)}for(P=ue?P:C;++P<C;){Z=m[P];var _e=IC(Z),ke=_e=="wrapper"?WP(Z):r;ke&&zP(ke[0])&&ke[1]==(R|w|x|A)&&!ke[4].length&&ke[9]==1?ue=ue[IC(ke[0])].apply(ue,ke[3]):ue=Z.length==1&&zP(Z)?ue[_e]():ue.thru(Z)}return function(){var Ve=arguments,We=Ve[0];if(ue&&Ve.length==1&&Qt(We))return ue.plant(We).value();for(var je=0,ft=C?m[je].apply(this,Ve):We;++je<C;)ft=m[je].call(this,ft);return ft}})}function RC(p,m,C,P,V,Z,ue,_e,ke,Ve){var We=m&R,je=m&g,ft=m&y,Ct=m&(w|_),Ft=m&N,yr=ft?r:c0(p);function Dt(){for(var mr=arguments.length,Lr=$e(mr),qi=mr;qi--;)Lr[qi]=arguments[qi];if(Ct)var Zi=Rv(Dt),pf=wme(Lr,Zi);if(P&&(Lr=V8(Lr,P,V,Ct)),Z&&(Lr=U8(Lr,Z,ue,Ct)),mr-=pf,Ct&&mr<Ve){var Fn=lf(Lr,Zi);return Z8(p,m,RC,Dt.placeholder,C,Lr,Fn,_e,ke,Ve-mr)}var ss=je?C:this,Wl=ft?ss[p]:p;return mr=Lr.length,_e?Lr=Abe(Lr,_e):Ft&&mr>1&&Lr.reverse(),We&&ke<mr&&(Lr.length=ke),this&&this!==wi&&this instanceof Dt&&(Wl=yr||c0(Wl)),Wl.apply(ss,Lr)}return Dt}function X8(p,m){return function(C,P){return L0e(C,p,m(P),{})}}function kC(p,m){return function(C,P){var V;if(C===r&&P===r)return m;if(C!==r&&(V=C),P!==r){if(V===r)return P;typeof C=="string"||typeof P=="string"?(C=za(C),P=za(P)):(C=$8(C),P=$8(P)),V=p(C,P)}return V}}function LP(p){return Ll(function(m){return m=_n(m,ja(Mt())),hr(function(C){var P=this;return p(m,function(V){return Ua(V,P,C)})})})}function AC(p,m){m=m===r?" ":za(m);var C=m.length;if(C<2)return C?AP(m,p):m;var P=AP(m,gC(p/wv(m)));return bv(m)?df(is(P),0,p).join(""):P.slice(0,p)}function cbe(p,m,C,P){var V=m&g,Z=c0(p);function ue(){for(var _e=-1,ke=arguments.length,Ve=-1,We=P.length,je=$e(We+ke),ft=this&&this!==wi&&this instanceof ue?Z:p;++Ve<We;)je[Ve]=P[Ve];for(;ke--;)je[Ve++]=arguments[++_e];return Ua(ft,V?C:this,je)}return ue}function q8(p){return function(m,C,P){return P&&typeof P!="number"&&Xi(m,C,P)&&(C=P=r),m=Bl(m),C===r?(C=m,m=0):C=Bl(C),P=P===r?m<C?1:-1:Bl(P),X0e(m,C,P,p)}}function PC(p){return function(m,C){return typeof m=="string"&&typeof C=="string"||(m=So(m),C=So(C)),p(m,C)}}function Z8(p,m,C,P,V,Z,ue,_e,ke,Ve){var We=m&w,je=We?ue:r,ft=We?r:ue,Ct=We?Z:r,Ft=We?r:Z;m|=We?x:E,m&=~(We?E:x),m&b||(m&=~(g|y));var yr=[p,m,V,Ct,je,Ft,ft,_e,ke,Ve],Dt=C.apply(r,yr);return zP(p)&&u5(Dt,yr),Dt.placeholder=P,f5(Dt,p,m)}function FP(p){var m=ii[p];return function(C,P){if(C=So(C),P=P==null?0:Ei(ar(P),292),P){var V=(Nr(C)+"e").split("e"),Z=m(V[0]+"e"+(+V[1]+P));return V=(Nr(Z)+"e").split("e"),+(V[0]+"e"+(+V[1]-P))}return m(C)}}var hbe=Cv&&1/oC(new Cv([,-0]))[1]==fe?function(p){return new Cv(p)}:oI;function J8(p){return function(m){var C=Ri(m);return C==De?vP(m):C==G?Eme(m):bme(m,p(m))}}function Nl(p,m,C,P,V,Z,ue,_e){var ke=m&y;if(!ke&&typeof p!="function")throw new yo(o);var Ve=P?P.length:0;if(Ve||(m&=~(x|E),P=V=r),ue=ue===r?ue:ai(ar(ue),0),_e=_e===r?_e:ar(_e),Ve-=V?V.length:0,m&E){var We=P,je=V;P=V=r}var ft=ke?r:WP(p),Ct=[p,m,C,P,V,We,je,Z,ue,_e];if(ft&&Ebe(Ct,ft),p=Ct[0],m=Ct[1],C=Ct[2],P=Ct[3],V=Ct[4],_e=Ct[9]=Ct[9]===r?ke?0:p.length:ai(Ct[9]-Ve,0),!_e&&m&(w|_)&&(m&=~(w|_)),!m||m==g)var Ft=ube(p,m,C);else m==w||m==_?Ft=fbe(p,m,_e):(m==x||m==(g|x))&&!V.length?Ft=cbe(p,m,C,P):Ft=RC.apply(r,Ct);var yr=ft?M8:u5;return f5(yr(Ft,Ct),p,m)}function Q8(p,m,C,P){return p===r||os(p,Sv[C])&&!nn.call(P,C)?m:p}function e5(p,m,C,P,V,Z){return Sn(p)&&Sn(m)&&(Z.set(m,p),xC(p,m,r,e5,Z),Z.delete(m)),p}function dbe(p){return v0(p)?r:p}function t5(p,m,C,P,V,Z){var ue=C&d,_e=p.length,ke=m.length;if(_e!=ke&&!(ue&&ke>_e))return!1;var Ve=Z.get(p);if(Ve&&Z.get(m))return Ve==m;var We=-1,je=!0,ft=C&v?new Vc:r;for(Z.set(p,m),Z.set(m,p);++We<_e;){var Ct=p[We],Ft=m[We];if(P)var yr=ue?P(Ft,Ct,We,m,p,Z):P(Ct,Ft,We,p,m,Z);if(yr!==r){if(yr)continue;je=!1;break}if(ft){if(!lP(m,function(Dt,mr){if(!Qm(ft,mr)&&(Ct===Dt||V(Ct,Dt,C,P,Z)))return ft.push(mr)})){je=!1;break}}else if(!(Ct===Ft||V(Ct,Ft,C,P,Z))){je=!1;break}}return Z.delete(p),Z.delete(m),je}function vbe(p,m,C,P,V,Z,ue){switch(C){case ge:if(p.byteLength!=m.byteLength||p.byteOffset!=m.byteOffset)return!1;p=p.buffer,m=m.buffer;case pe:return!(p.byteLength!=m.byteLength||!Z(new hC(p),new hC(m)));case Q:case he:case de:return os(+p,+m);case le:return p.name==m.name&&p.message==m.message;case Xe:case q:return p==m+"";case De:var _e=vP;case G:var ke=P&d;if(_e||(_e=oC),p.size!=m.size&&!ke)return!1;var Ve=ue.get(p);if(Ve)return Ve==m;P|=v,ue.set(p,m);var We=t5(_e(p),_e(m),P,V,Z,ue);return ue.delete(p),We;case ae:if(a0)return a0.call(p)==a0.call(m)}return!1}function pbe(p,m,C,P,V,Z){var ue=C&d,_e=HP(p),ke=_e.length,Ve=HP(m),We=Ve.length;if(ke!=We&&!ue)return!1;for(var je=ke;je--;){var ft=_e[je];if(!(ue?ft in m:nn.call(m,ft)))return!1}var Ct=Z.get(p);if(Ct&&Z.get(m))return Ct==m;var Ft=!0;Z.set(p,m),Z.set(m,p);for(var yr=ue;++je<ke;){ft=_e[je];var Dt=p[ft],mr=m[ft];if(P)var Lr=ue?P(mr,Dt,ft,m,p,Z):P(Dt,mr,ft,p,m,Z);if(!(Lr===r?Dt===mr||V(Dt,mr,C,P,Z):Lr)){Ft=!1;break}yr||(yr=ft=="constructor")}if(Ft&&!yr){var qi=p.constructor,Zi=m.constructor;qi!=Zi&&"constructor"in p&&"constructor"in m&&!(typeof qi=="function"&&qi instanceof qi&&typeof Zi=="function"&&Zi instanceof Zi)&&(Ft=!1)}return Z.delete(p),Z.delete(m),Ft}function Ll(p){return YP(s5(p,r,g5),p+"")}function HP(p){return S8(p,vi,UP)}function BP(p){return S8(p,xa,r5)}var WP=mC?function(p){return mC.get(p)}:oI;function IC(p){for(var m=p.name+"",C=i0[m],P=nn.call(i0,m)?C.length:0;P--;){var V=C[P],Z=V.func;if(Z==null||Z==p)return V.name}return m}function Rv(p){var m=nn.call(K,"placeholder")?K:p;return m.placeholder}function Mt(){var p=K.iteratee||iI;return p=p===iI?T8:p,arguments.length?p(arguments[0],arguments[1]):p}function MC(p,m){var C=p.__data__;return Cbe(m)?C[typeof m=="string"?"string":"hash"]:C.map}function VP(p){for(var m=vi(p),C=m.length;C--;){var P=m[C],V=p[P];m[C]=[P,V,a5(V)]}return m}function jc(p,m){var C=xme(p,m);return x8(C)?C:r}function gbe(p){var m=nn.call(p,Bc),C=p[Bc];try{p[Bc]=r;var P=!0}catch{}var V=fC.call(p);return P&&(m?p[Bc]=C:delete p[Bc]),V}var UP=gP?function(p){return p==null?[]:(p=Jr(p),of(gP(p),function(m){return f8.call(p,m)}))}:sI,r5=gP?function(p){for(var m=[];p;)sf(m,UP(p)),p=dC(p);return m}:sI,Ri=Ki;(yP&&Ri(new yP(new ArrayBuffer(1)))!=ge||t0&&Ri(new t0)!=De||mP&&Ri(mP.resolve())!=Ae||Cv&&Ri(new Cv)!=G||r0&&Ri(new r0)!=se)&&(Ri=function(p){var m=Ki(p),C=m==Be?p.constructor:r,P=C?zc(C):"";if(P)switch(P){case Zme:return ge;case Jme:return De;case Qme:return Ae;case e0e:return G;case t0e:return se}return m});function ybe(p,m,C){for(var P=-1,V=C.length;++P<V;){var Z=C[P],ue=Z.size;switch(Z.type){case"drop":p+=ue;break;case"dropRight":m-=ue;break;case"take":m=Ei(m,p+ue);break;case"takeRight":p=ai(p,m-ue);break}}return{start:p,end:m}}function mbe(p){var m=p.match(j);return m?m[1].split(re):[]}function n5(p,m,C){m=hf(m,p);for(var P=-1,V=m.length,Z=!1;++P<V;){var ue=Us(m[P]);if(!(Z=p!=null&&C(p,ue)))break;p=p[ue]}return Z||++P!=V?Z:(V=p==null?0:p.length,!!V&&BC(V)&&Fl(ue,V)&&(Qt(p)||Gc(p)))}function bbe(p){var m=p.length,C=new p.constructor(m);return m&&typeof p[0]=="string"&&nn.call(p,"index")&&(C.index=p.index,C.input=p.input),C}function i5(p){return typeof p.constructor=="function"&&!h0(p)?xv(dC(p)):{}}function wbe(p,m,C){var P=p.constructor;switch(m){case pe:return NP(p);case Q:case he:return new P(+p);case ge:return nbe(p,C);case me:case Ce:case Se:case Le:case qe:case Qe:case wt:case Pt:case Jt:return B8(p,C);case De:return new P;case de:case q:return new P(p);case Xe:return ibe(p);case G:return new P;case ae:return abe(p)}}function _be(p,m){var C=m.length;if(!C)return p;var P=C-1;return m[P]=(C>1?"& ":"")+m[P],m=m.join(C>2?", ":" "),p.replace(Dr,`{
/* [wrapped with `+m+`] */
`)}function Sbe(p){return Qt(p)||Gc(p)||!!(c8&&p&&p[c8])}function Fl(p,m){var C=typeof p;return m=m??Te,!!m&&(C=="number"||C!="symbol"&&X.test(p))&&p>-1&&p%1==0&&p<m}function Xi(p,m,C){if(!Sn(C))return!1;var P=typeof m;return(P=="number"?Ca(C)&&Fl(m,C.length):P=="string"&&m in C)?os(C[m],p):!1}function jP(p,m){if(Qt(p))return!1;var C=typeof p;return C=="number"||C=="symbol"||C=="boolean"||p==null||Ga(p)?!0:Tt.test(p)||!tt.test(p)||m!=null&&p in Jr(m)}function Cbe(p){var m=typeof p;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?p!=="__proto__":p===null}function zP(p){var m=IC(p),C=K[m];if(typeof C!="function"||!(m in wr.prototype))return!1;if(p===C)return!0;var P=WP(C);return!!P&&p===P[0]}function xbe(p){return!!s8&&s8 in p}var Tbe=lC?Hl:lI;function h0(p){var m=p&&p.constructor,C=typeof m=="function"&&m.prototype||Sv;return p===C}function a5(p){return p===p&&!Sn(p)}function o5(p,m){return function(C){return C==null?!1:C[p]===m&&(m!==r||p in Jr(C))}}function Obe(p){var m=FC(p,function(P){return C.size===l&&C.clear(),P}),C=m.cache;return m}function Ebe(p,m){var C=p[1],P=m[1],V=C|P,Z=V<(g|y|R),ue=P==R&&C==w||P==R&&C==A&&p[7].length<=m[8]||P==(R|A)&&m[7].length<=m[8]&&C==w;if(!(Z||ue))return p;P&g&&(p[2]=m[2],V|=C&g?0:b);var _e=m[3];if(_e){var ke=p[3];p[3]=ke?V8(ke,_e,m[4]):_e,p[4]=ke?lf(p[3],u):m[4]}return _e=m[5],_e&&(ke=p[5],p[5]=ke?U8(ke,_e,m[6]):_e,p[6]=ke?lf(p[5],u):m[6]),_e=m[7],_e&&(p[7]=_e),P&R&&(p[8]=p[8]==null?m[8]:Ei(p[8],m[8])),p[9]==null&&(p[9]=m[9]),p[0]=m[0],p[1]=V,p}function Rbe(p){var m=[];if(p!=null)for(var C in Jr(p))m.push(C);return m}function kbe(p){return fC.call(p)}function s5(p,m,C){return m=ai(m===r?p.length-1:m,0),function(){for(var P=arguments,V=-1,Z=ai(P.length-m,0),ue=$e(Z);++V<Z;)ue[V]=P[m+V];V=-1;for(var _e=$e(m+1);++V<m;)_e[V]=P[V];return _e[m]=C(ue),Ua(p,this,_e)}}function l5(p,m){return m.length<2?p:Tv(p,wo(m,0,-1))}function Abe(p,m){for(var C=p.length,P=Ei(m.length,C),V=Sa(p);P--;){var Z=m[P];p[P]=Fl(Z,C)?V[Z]:r}return p}function GP(p,m){if(m!="__proto__")return p[m]}var u5=c5(M8),d0=Ume||function(p,m){return wi.setTimeout(p,m)},YP=c5(J0e);function f5(p,m,C){var P=m+"";return YP(p,_be(P,Pbe(mbe(P),C)))}function c5(p){var m=0,C=0;return function(){var P=Kme(),V=W-(P-C);if(C=P,V>0){if(++m>=H)return arguments[0]}else m=0;return p.apply(r,arguments)}}function DC(p,m){var C=-1,P=p.length,V=P-1;for(m=m===r?P:m;++C<m;){var Z=kP(C,V),ue=p[Z];p[Z]=p[C],p[C]=ue}return p.length=m,p}var h5=Obe(function(p){var m=[];return p.charCodeAt(0)===46&&m.push(""),p.replace(nt,function(C,P,V,Z){m.push(V?Z.replace(ee,"$1"):P||C)}),m});function Us(p){if(typeof p=="string"||Ga(p))return p;var m=p+"";return m=="0"&&1/p==-fe?"-0":m}function zc(p){if(p!=null){try{return uC.call(p)}catch{}try{return p+""}catch{}}return""}function Pbe(p,m){return go(D,function(C){var P="_."+C[0];m&C[1]&&!iC(p,P)&&p.push(P)}),p.sort()}function d5(p){if(p instanceof wr)return p.clone();var m=new mo(p.__wrapped__,p.__chain__);return m.__actions__=Sa(p.__actions__),m.__index__=p.__index__,m.__values__=p.__values__,m}function Ibe(p,m,C){(C?Xi(p,m,C):m===r)?m=1:m=ai(ar(m),0);var P=p==null?0:p.length;if(!P||m<1)return[];for(var V=0,Z=0,ue=$e(gC(P/m));V<P;)ue[Z++]=wo(p,V,V+=m);return ue}function Mbe(p){for(var m=-1,C=p==null?0:p.length,P=0,V=[];++m<C;){var Z=p[m];Z&&(V[P++]=Z)}return V}function Dbe(){var p=arguments.length;if(!p)return[];for(var m=$e(p-1),C=arguments[0],P=p;P--;)m[P-1]=arguments[P];return sf(Qt(C)?Sa(C):[C],_i(m,1))}var $be=hr(function(p,m){return Ln(p)?s0(p,_i(m,1,Ln,!0)):[]}),Nbe=hr(function(p,m){var C=_o(m);return Ln(C)&&(C=r),Ln(p)?s0(p,_i(m,1,Ln,!0),Mt(C,2)):[]}),Lbe=hr(function(p,m){var C=_o(m);return Ln(C)&&(C=r),Ln(p)?s0(p,_i(m,1,Ln,!0),r,C):[]});function Fbe(p,m,C){var P=p==null?0:p.length;return P?(m=C||m===r?1:ar(m),wo(p,m<0?0:m,P)):[]}function Hbe(p,m,C){var P=p==null?0:p.length;return P?(m=C||m===r?1:ar(m),m=P-m,wo(p,0,m<0?0:m)):[]}function Bbe(p,m){return p&&p.length?OC(p,Mt(m,3),!0,!0):[]}function Wbe(p,m){return p&&p.length?OC(p,Mt(m,3),!0):[]}function Vbe(p,m,C,P){var V=p==null?0:p.length;return V?(C&&typeof C!="number"&&Xi(p,m,C)&&(C=0,P=V),M0e(p,m,C,P)):[]}function v5(p,m,C){var P=p==null?0:p.length;if(!P)return-1;var V=C==null?0:ar(C);return V<0&&(V=ai(P+V,0)),aC(p,Mt(m,3),V)}function p5(p,m,C){var P=p==null?0:p.length;if(!P)return-1;var V=P-1;return C!==r&&(V=ar(C),V=C<0?ai(P+V,0):Ei(V,P-1)),aC(p,Mt(m,3),V,!0)}function g5(p){var m=p==null?0:p.length;return m?_i(p,1):[]}function Ube(p){var m=p==null?0:p.length;return m?_i(p,fe):[]}function jbe(p,m){var C=p==null?0:p.length;return C?(m=m===r?1:ar(m),_i(p,m)):[]}function zbe(p){for(var m=-1,C=p==null?0:p.length,P={};++m<C;){var V=p[m];P[V[0]]=V[1]}return P}function y5(p){return p&&p.length?p[0]:r}function Gbe(p,m,C){var P=p==null?0:p.length;if(!P)return-1;var V=C==null?0:ar(C);return V<0&&(V=ai(P+V,0)),mv(p,m,V)}function Ybe(p){var m=p==null?0:p.length;return m?wo(p,0,-1):[]}var Kbe=hr(function(p){var m=_n(p,DP);return m.length&&m[0]===p[0]?xP(m):[]}),Xbe=hr(function(p){var m=_o(p),C=_n(p,DP);return m===_o(C)?m=r:C.pop(),C.length&&C[0]===p[0]?xP(C,Mt(m,2)):[]}),qbe=hr(function(p){var m=_o(p),C=_n(p,DP);return m=typeof m=="function"?m:r,m&&C.pop(),C.length&&C[0]===p[0]?xP(C,r,m):[]});function Zbe(p,m){return p==null?"":Gme.call(p,m)}function _o(p){var m=p==null?0:p.length;return m?p[m-1]:r}function Jbe(p,m,C){var P=p==null?0:p.length;if(!P)return-1;var V=P;return C!==r&&(V=ar(C),V=V<0?ai(P+V,0):Ei(V,P-1)),m===m?kme(p,m,V):aC(p,t8,V,!0)}function Qbe(p,m){return p&&p.length?k8(p,ar(m)):r}var ewe=hr(m5);function m5(p,m){return p&&p.length&&m&&m.length?RP(p,m):p}function twe(p,m,C){return p&&p.length&&m&&m.length?RP(p,m,Mt(C,2)):p}function rwe(p,m,C){return p&&p.length&&m&&m.length?RP(p,m,r,C):p}var nwe=Ll(function(p,m){var C=p==null?0:p.length,P=wP(p,m);return I8(p,_n(m,function(V){return Fl(V,C)?+V:V}).sort(W8)),P});function iwe(p,m){var C=[];if(!(p&&p.length))return C;var P=-1,V=[],Z=p.length;for(m=Mt(m,3);++P<Z;){var ue=p[P];m(ue,P,p)&&(C.push(ue),V.push(P))}return I8(p,V),C}function KP(p){return p==null?p:qme.call(p)}function awe(p,m,C){var P=p==null?0:p.length;return P?(C&&typeof C!="number"&&Xi(p,m,C)?(m=0,C=P):(m=m==null?0:ar(m),C=C===r?P:ar(C)),wo(p,m,C)):[]}function owe(p,m){return TC(p,m)}function swe(p,m,C){return PP(p,m,Mt(C,2))}function lwe(p,m){var C=p==null?0:p.length;if(C){var P=TC(p,m);if(P<C&&os(p[P],m))return P}return-1}function uwe(p,m){return TC(p,m,!0)}function fwe(p,m,C){return PP(p,m,Mt(C,2),!0)}function cwe(p,m){var C=p==null?0:p.length;if(C){var P=TC(p,m,!0)-1;if(os(p[P],m))return P}return-1}function hwe(p){return p&&p.length?D8(p):[]}function dwe(p,m){return p&&p.length?D8(p,Mt(m,2)):[]}function vwe(p){var m=p==null?0:p.length;return m?wo(p,1,m):[]}function pwe(p,m,C){return p&&p.length?(m=C||m===r?1:ar(m),wo(p,0,m<0?0:m)):[]}function gwe(p,m,C){var P=p==null?0:p.length;return P?(m=C||m===r?1:ar(m),m=P-m,wo(p,m<0?0:m,P)):[]}function ywe(p,m){return p&&p.length?OC(p,Mt(m,3),!1,!0):[]}function mwe(p,m){return p&&p.length?OC(p,Mt(m,3)):[]}var bwe=hr(function(p){return cf(_i(p,1,Ln,!0))}),wwe=hr(function(p){var m=_o(p);return Ln(m)&&(m=r),cf(_i(p,1,Ln,!0),Mt(m,2))}),_we=hr(function(p){var m=_o(p);return m=typeof m=="function"?m:r,cf(_i(p,1,Ln,!0),r,m)});function Swe(p){return p&&p.length?cf(p):[]}function Cwe(p,m){return p&&p.length?cf(p,Mt(m,2)):[]}function xwe(p,m){return m=typeof m=="function"?m:r,p&&p.length?cf(p,r,m):[]}function XP(p){if(!(p&&p.length))return[];var m=0;return p=of(p,function(C){if(Ln(C))return m=ai(C.length,m),!0}),hP(m,function(C){return _n(p,uP(C))})}function b5(p,m){if(!(p&&p.length))return[];var C=XP(p);return m==null?C:_n(C,function(P){return Ua(m,r,P)})}var Twe=hr(function(p,m){return Ln(p)?s0(p,m):[]}),Owe=hr(function(p){return MP(of(p,Ln))}),Ewe=hr(function(p){var m=_o(p);return Ln(m)&&(m=r),MP(of(p,Ln),Mt(m,2))}),Rwe=hr(function(p){var m=_o(p);return m=typeof m=="function"?m:r,MP(of(p,Ln),r,m)}),kwe=hr(XP);function Awe(p,m){return F8(p||[],m||[],o0)}function Pwe(p,m){return F8(p||[],m||[],f0)}var Iwe=hr(function(p){var m=p.length,C=m>1?p[m-1]:r;return C=typeof C=="function"?(p.pop(),C):r,b5(p,C)});function w5(p){var m=K(p);return m.__chain__=!0,m}function Mwe(p,m){return m(p),p}function $C(p,m){return m(p)}var Dwe=Ll(function(p){var m=p.length,C=m?p[0]:0,P=this.__wrapped__,V=function(Z){return wP(Z,p)};return m>1||this.__actions__.length||!(P instanceof wr)||!Fl(C)?this.thru(V):(P=P.slice(C,+C+(m?1:0)),P.__actions__.push({func:$C,args:[V],thisArg:r}),new mo(P,this.__chain__).thru(function(Z){return m&&!Z.length&&Z.push(r),Z}))});function $we(){return w5(this)}function Nwe(){return new mo(this.value(),this.__chain__)}function Lwe(){this.__values__===r&&(this.__values__=D5(this.value()));var p=this.__index__>=this.__values__.length,m=p?r:this.__values__[this.__index__++];return{done:p,value:m}}function Fwe(){return this}function Hwe(p){for(var m,C=this;C instanceof wC;){var P=d5(C);P.__index__=0,P.__values__=r,m?V.__wrapped__=P:m=P;var V=P;C=C.__wrapped__}return V.__wrapped__=p,m}function Bwe(){var p=this.__wrapped__;if(p instanceof wr){var m=p;return this.__actions__.length&&(m=new wr(this)),m=m.reverse(),m.__actions__.push({func:$C,args:[KP],thisArg:r}),new mo(m,this.__chain__)}return this.thru(KP)}function Wwe(){return L8(this.__wrapped__,this.__actions__)}var Vwe=EC(function(p,m,C){nn.call(p,C)?++p[C]:$l(p,C,1)});function Uwe(p,m,C){var P=Qt(p)?Qj:I0e;return C&&Xi(p,m,C)&&(m=r),P(p,Mt(m,3))}function jwe(p,m){var C=Qt(p)?of:w8;return C(p,Mt(m,3))}var zwe=Y8(v5),Gwe=Y8(p5);function Ywe(p,m){return _i(NC(p,m),1)}function Kwe(p,m){return _i(NC(p,m),fe)}function Xwe(p,m,C){return C=C===r?1:ar(C),_i(NC(p,m),C)}function _5(p,m){var C=Qt(p)?go:ff;return C(p,Mt(m,3))}function S5(p,m){var C=Qt(p)?hme:b8;return C(p,Mt(m,3))}var qwe=EC(function(p,m,C){nn.call(p,C)?p[C].push(m):$l(p,C,[m])});function Zwe(p,m,C,P){p=Ca(p)?p:Av(p),C=C&&!P?ar(C):0;var V=p.length;return C<0&&(C=ai(V+C,0)),WC(p)?C<=V&&p.indexOf(m,C)>-1:!!V&&mv(p,m,C)>-1}var Jwe=hr(function(p,m,C){var P=-1,V=typeof m=="function",Z=Ca(p)?$e(p.length):[];return ff(p,function(ue){Z[++P]=V?Ua(m,ue,C):l0(ue,m,C)}),Z}),Qwe=EC(function(p,m,C){$l(p,C,m)});function NC(p,m){var C=Qt(p)?_n:O8;return C(p,Mt(m,3))}function e_e(p,m,C,P){return p==null?[]:(Qt(m)||(m=m==null?[]:[m]),C=P?r:C,Qt(C)||(C=C==null?[]:[C]),A8(p,m,C))}var t_e=EC(function(p,m,C){p[C?0:1].push(m)},function(){return[[],[]]});function r_e(p,m,C){var P=Qt(p)?sP:n8,V=arguments.length<3;return P(p,Mt(m,4),C,V,ff)}function n_e(p,m,C){var P=Qt(p)?dme:n8,V=arguments.length<3;return P(p,Mt(m,4),C,V,b8)}function i_e(p,m){var C=Qt(p)?of:w8;return C(p,HC(Mt(m,3)))}function a_e(p){var m=Qt(p)?p8:q0e;return m(p)}function o_e(p,m,C){(C?Xi(p,m,C):m===r)?m=1:m=ar(m);var P=Qt(p)?E0e:Z0e;return P(p,m)}function s_e(p){var m=Qt(p)?R0e:Q0e;return m(p)}function l_e(p){if(p==null)return 0;if(Ca(p))return WC(p)?wv(p):p.length;var m=Ri(p);return m==De||m==G?p.size:OP(p).length}function u_e(p,m,C){var P=Qt(p)?lP:ebe;return C&&Xi(p,m,C)&&(m=r),P(p,Mt(m,3))}var f_e=hr(function(p,m){if(p==null)return[];var C=m.length;return C>1&&Xi(p,m[0],m[1])?m=[]:C>2&&Xi(m[0],m[1],m[2])&&(m=[m[0]]),A8(p,_i(m,1),[])}),LC=Vme||function(){return wi.Date.now()};function c_e(p,m){if(typeof m!="function")throw new yo(o);return p=ar(p),function(){if(--p<1)return m.apply(this,arguments)}}function C5(p,m,C){return m=C?r:m,m=p&&m==null?p.length:m,Nl(p,R,r,r,r,r,m)}function x5(p,m){var C;if(typeof m!="function")throw new yo(o);return p=ar(p),function(){return--p>0&&(C=m.apply(this,arguments)),p<=1&&(m=r),C}}var qP=hr(function(p,m,C){var P=g;if(C.length){var V=lf(C,Rv(qP));P|=x}return Nl(p,P,m,C,V)}),T5=hr(function(p,m,C){var P=g|y;if(C.length){var V=lf(C,Rv(T5));P|=x}return Nl(m,P,p,C,V)});function O5(p,m,C){m=C?r:m;var P=Nl(p,w,r,r,r,r,r,m);return P.placeholder=O5.placeholder,P}function E5(p,m,C){m=C?r:m;var P=Nl(p,_,r,r,r,r,r,m);return P.placeholder=E5.placeholder,P}function R5(p,m,C){var P,V,Z,ue,_e,ke,Ve=0,We=!1,je=!1,ft=!0;if(typeof p!="function")throw new yo(o);m=So(m)||0,Sn(C)&&(We=!!C.leading,je="maxWait"in C,Z=je?ai(So(C.maxWait)||0,m):Z,ft="trailing"in C?!!C.trailing:ft);function Ct(Fn){var ss=P,Wl=V;return P=V=r,Ve=Fn,ue=p.apply(Wl,ss),ue}function Ft(Fn){return Ve=Fn,_e=d0(mr,m),We?Ct(Fn):ue}function yr(Fn){var ss=Fn-ke,Wl=Fn-Ve,Y5=m-ss;return je?Ei(Y5,Z-Wl):Y5}function Dt(Fn){var ss=Fn-ke,Wl=Fn-Ve;return ke===r||ss>=m||ss<0||je&&Wl>=Z}function mr(){var Fn=LC();if(Dt(Fn))return Lr(Fn);_e=d0(mr,yr(Fn))}function Lr(Fn){return _e=r,ft&&P?Ct(Fn):(P=V=r,ue)}function qi(){_e!==r&&rbe(_e),Ve=0,P=ke=V=_e=r}function Zi(){return _e===r?ue:Lr(LC())}function pf(){var Fn=LC(),ss=Dt(Fn);if(P=arguments,V=this,ke=Fn,ss){if(_e===r)return Ft(ke);if(je)return _e=d0(mr,m),Ct(ke)}return _e===r&&(_e=d0(mr,m)),ue}return pf.cancel=qi,pf.flush=Zi,pf}var h_e=hr(function(p,m){return m8(p,1,m)}),d_e=hr(function(p,m,C){return m8(p,So(m)||0,C)});function v_e(p){return Nl(p,N)}function FC(p,m){if(typeof p!="function"||m!=null&&typeof m!="function")throw new yo(o);var C=function(){var P=arguments,V=m?m.apply(this,P):P[0],Z=C.cache;if(Z.has(V))return Z.get(V);var ue=p.apply(this,P);return C.cache=Z.set(V,ue)||Z,ue};return C.cache=new(FC.Cache||Dl),C}FC.Cache=Dl;function HC(p){if(typeof p!="function")throw new yo(o);return function(){var m=arguments;switch(m.length){case 0:return!p.call(this);case 1:return!p.call(this,m[0]);case 2:return!p.call(this,m[0],m[1]);case 3:return!p.call(this,m[0],m[1],m[2])}return!p.apply(this,m)}}function p_e(p){return x5(2,p)}var g_e=tbe(function(p,m){m=m.length==1&&Qt(m[0])?_n(m[0],ja(Mt())):_n(_i(m,1),ja(Mt()));var C=m.length;return hr(function(P){for(var V=-1,Z=Ei(P.length,C);++V<Z;)P[V]=m[V].call(this,P[V]);return Ua(p,this,P)})}),ZP=hr(function(p,m){var C=lf(m,Rv(ZP));return Nl(p,x,r,m,C)}),k5=hr(function(p,m){var C=lf(m,Rv(k5));return Nl(p,E,r,m,C)}),y_e=Ll(function(p,m){return Nl(p,A,r,r,r,m)});function m_e(p,m){if(typeof p!="function")throw new yo(o);return m=m===r?m:ar(m),hr(p,m)}function b_e(p,m){if(typeof p!="function")throw new yo(o);return m=m==null?0:ai(ar(m),0),hr(function(C){var P=C[m],V=df(C,0,m);return P&&sf(V,P),Ua(p,this,V)})}function w_e(p,m,C){var P=!0,V=!0;if(typeof p!="function")throw new yo(o);return Sn(C)&&(P="leading"in C?!!C.leading:P,V="trailing"in C?!!C.trailing:V),R5(p,m,{leading:P,maxWait:m,trailing:V})}function __e(p){return C5(p,1)}function S_e(p,m){return ZP($P(m),p)}function C_e(){if(!arguments.length)return[];var p=arguments[0];return Qt(p)?p:[p]}function x_e(p){return bo(p,h)}function T_e(p,m){return m=typeof m=="function"?m:r,bo(p,h,m)}function O_e(p){return bo(p,f|h)}function E_e(p,m){return m=typeof m=="function"?m:r,bo(p,f|h,m)}function R_e(p,m){return m==null||y8(p,m,vi(m))}function os(p,m){return p===m||p!==p&&m!==m}var k_e=PC(CP),A_e=PC(function(p,m){return p>=m}),Gc=C8(function(){return arguments}())?C8:function(p){return An(p)&&nn.call(p,"callee")&&!f8.call(p,"callee")},Qt=$e.isArray,P_e=Yj?ja(Yj):F0e;function Ca(p){return p!=null&&BC(p.length)&&!Hl(p)}function Ln(p){return An(p)&&Ca(p)}function I_e(p){return p===!0||p===!1||An(p)&&Ki(p)==Q}var vf=jme||lI,M_e=Kj?ja(Kj):H0e;function D_e(p){return An(p)&&p.nodeType===1&&!v0(p)}function $_e(p){if(p==null)return!0;if(Ca(p)&&(Qt(p)||typeof p=="string"||typeof p.splice=="function"||vf(p)||kv(p)||Gc(p)))return!p.length;var m=Ri(p);if(m==De||m==G)return!p.size;if(h0(p))return!OP(p).length;for(var C in p)if(nn.call(p,C))return!1;return!0}function N_e(p,m){return u0(p,m)}function L_e(p,m,C){C=typeof C=="function"?C:r;var P=C?C(p,m):r;return P===r?u0(p,m,r,C):!!P}function JP(p){if(!An(p))return!1;var m=Ki(p);return m==le||m==ce||typeof p.message=="string"&&typeof p.name=="string"&&!v0(p)}function F_e(p){return typeof p=="number"&&zme(p)}function Hl(p){if(!Sn(p))return!1;var m=Ki(p);return m==xe||m==U||m==Y||m==Ke}function A5(p){return typeof p=="number"&&p==ar(p)}function BC(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=Te}function Sn(p){var m=typeof p;return p!=null&&(m=="object"||m=="function")}function An(p){return p!=null&&typeof p=="object"}var P5=Xj?ja(Xj):W0e;function H_e(p,m){return p===m||TP(p,m,VP(m))}function B_e(p,m,C){return C=typeof C=="function"?C:r,TP(p,m,VP(m),C)}function W_e(p){return I5(p)&&p!=+p}function V_e(p){if(Tbe(p))throw new Zt(a);return x8(p)}function U_e(p){return p===null}function j_e(p){return p==null}function I5(p){return typeof p=="number"||An(p)&&Ki(p)==de}function v0(p){if(!An(p)||Ki(p)!=Be)return!1;var m=dC(p);if(m===null)return!0;var C=nn.call(m,"constructor")&&m.constructor;return typeof C=="function"&&C instanceof C&&uC.call(C)==Fme}var QP=qj?ja(qj):V0e;function z_e(p){return A5(p)&&p>=-Te&&p<=Te}var M5=Zj?ja(Zj):U0e;function WC(p){return typeof p=="string"||!Qt(p)&&An(p)&&Ki(p)==q}function Ga(p){return typeof p=="symbol"||An(p)&&Ki(p)==ae}var kv=Jj?ja(Jj):j0e;function G_e(p){return p===r}function Y_e(p){return An(p)&&Ri(p)==se}function K_e(p){return An(p)&&Ki(p)==Oe}var X_e=PC(EP),q_e=PC(function(p,m){return p<=m});function D5(p){if(!p)return[];if(Ca(p))return WC(p)?is(p):Sa(p);if(e0&&p[e0])return Ome(p[e0]());var m=Ri(p),C=m==De?vP:m==G?oC:Av;return C(p)}function Bl(p){if(!p)return p===0?p:0;if(p=So(p),p===fe||p===-fe){var m=p<0?-1:1;return m*M}return p===p?p:0}function ar(p){var m=Bl(p),C=m%1;return m===m?C?m-C:m:0}function $5(p){return p?Uc(ar(p),0,T):0}function So(p){if(typeof p=="number")return p;if(Ga(p))return S;if(Sn(p)){var m=typeof p.valueOf=="function"?p.valueOf():p;p=Sn(m)?m+"":m}if(typeof p!="string")return p===0?p:+p;p=p.replace(dr,"");var C=Ne.test(p);return C||we.test(p)?ume(p.slice(2),C?2:8):Ie.test(p)?S:+p}function N5(p){return Vs(p,xa(p))}function Z_e(p){return p?Uc(ar(p),-Te,Te):p===0?p:0}function Nr(p){return p==null?"":za(p)}var J_e=Ov(function(p,m){if(h0(m)||Ca(m)){Vs(m,vi(m),p);return}for(var C in m)nn.call(m,C)&&o0(p,C,m[C])}),L5=Ov(function(p,m){Vs(m,xa(m),p)}),VC=Ov(function(p,m,C,P){Vs(m,xa(m),p,P)}),Q_e=Ov(function(p,m,C,P){Vs(m,vi(m),p,P)}),eSe=Ll(wP);function tSe(p,m){var C=xv(p);return m==null?C:g8(C,m)}var rSe=hr(function(p,m){p=Jr(p);var C=-1,P=m.length,V=P>2?m[2]:r;for(V&&Xi(m[0],m[1],V)&&(P=1);++C<P;)for(var Z=m[C],ue=xa(Z),_e=-1,ke=ue.length;++_e<ke;){var Ve=ue[_e],We=p[Ve];(We===r||os(We,Sv[Ve])&&!nn.call(p,Ve))&&(p[Ve]=Z[Ve])}return p}),nSe=hr(function(p){return p.push(r,e5),Ua(F5,r,p)});function iSe(p,m){return e8(p,Mt(m,3),Ws)}function aSe(p,m){return e8(p,Mt(m,3),SP)}function oSe(p,m){return p==null?p:_P(p,Mt(m,3),xa)}function sSe(p,m){return p==null?p:_8(p,Mt(m,3),xa)}function lSe(p,m){return p&&Ws(p,Mt(m,3))}function uSe(p,m){return p&&SP(p,Mt(m,3))}function fSe(p){return p==null?[]:CC(p,vi(p))}function cSe(p){return p==null?[]:CC(p,xa(p))}function eI(p,m,C){var P=p==null?r:Tv(p,m);return P===r?C:P}function hSe(p,m){return p!=null&&n5(p,m,D0e)}function tI(p,m){return p!=null&&n5(p,m,$0e)}var dSe=X8(function(p,m,C){m!=null&&typeof m.toString!="function"&&(m=fC.call(m)),p[m]=C},nI(Ta)),vSe=X8(function(p,m,C){m!=null&&typeof m.toString!="function"&&(m=fC.call(m)),nn.call(p,m)?p[m].push(C):p[m]=[C]},Mt),pSe=hr(l0);function vi(p){return Ca(p)?v8(p):OP(p)}function xa(p){return Ca(p)?v8(p,!0):z0e(p)}function gSe(p,m){var C={};return m=Mt(m,3),Ws(p,function(P,V,Z){$l(C,m(P,V,Z),P)}),C}function ySe(p,m){var C={};return m=Mt(m,3),Ws(p,function(P,V,Z){$l(C,V,m(P,V,Z))}),C}var mSe=Ov(function(p,m,C){xC(p,m,C)}),F5=Ov(function(p,m,C,P){xC(p,m,C,P)}),bSe=Ll(function(p,m){var C={};if(p==null)return C;var P=!1;m=_n(m,function(Z){return Z=hf(Z,p),P||(P=Z.length>1),Z}),Vs(p,BP(p),C),P&&(C=bo(C,f|c|h,dbe));for(var V=m.length;V--;)IP(C,m[V]);return C});function wSe(p,m){return H5(p,HC(Mt(m)))}var _Se=Ll(function(p,m){return p==null?{}:Y0e(p,m)});function H5(p,m){if(p==null)return{};var C=_n(BP(p),function(P){return[P]});return m=Mt(m),P8(p,C,function(P,V){return m(P,V[0])})}function SSe(p,m,C){m=hf(m,p);var P=-1,V=m.length;for(V||(V=1,p=r);++P<V;){var Z=p==null?r:p[Us(m[P])];Z===r&&(P=V,Z=C),p=Hl(Z)?Z.call(p):Z}return p}function CSe(p,m,C){return p==null?p:f0(p,m,C)}function xSe(p,m,C,P){return P=typeof P=="function"?P:r,p==null?p:f0(p,m,C,P)}var B5=J8(vi),W5=J8(xa);function TSe(p,m,C){var P=Qt(p),V=P||vf(p)||kv(p);if(m=Mt(m,4),C==null){var Z=p&&p.constructor;V?C=P?new Z:[]:Sn(p)?C=Hl(Z)?xv(dC(p)):{}:C={}}return(V?go:Ws)(p,function(ue,_e,ke){return m(C,ue,_e,ke)}),C}function OSe(p,m){return p==null?!0:IP(p,m)}function ESe(p,m,C){return p==null?p:N8(p,m,$P(C))}function RSe(p,m,C,P){return P=typeof P=="function"?P:r,p==null?p:N8(p,m,$P(C),P)}function Av(p){return p==null?[]:dP(p,vi(p))}function kSe(p){return p==null?[]:dP(p,xa(p))}function ASe(p,m,C){return C===r&&(C=m,m=r),C!==r&&(C=So(C),C=C===C?C:0),m!==r&&(m=So(m),m=m===m?m:0),Uc(So(p),m,C)}function PSe(p,m,C){return m=Bl(m),C===r?(C=m,m=0):C=Bl(C),p=So(p),N0e(p,m,C)}function ISe(p,m,C){if(C&&typeof C!="boolean"&&Xi(p,m,C)&&(m=C=r),C===r&&(typeof m=="boolean"?(C=m,m=r):typeof p=="boolean"&&(C=p,p=r)),p===r&&m===r?(p=0,m=1):(p=Bl(p),m===r?(m=p,p=0):m=Bl(m)),p>m){var P=p;p=m,m=P}if(C||p%1||m%1){var V=h8();return Ei(p+V*(m-p+lme("1e-"+((V+"").length-1))),m)}return kP(p,m)}var MSe=Ev(function(p,m,C){return m=m.toLowerCase(),p+(C?V5(m):m)});function V5(p){return rI(Nr(p).toLowerCase())}function U5(p){return p=Nr(p),p&&p.replace(Ee,_me).replace(Jye,"")}function DSe(p,m,C){p=Nr(p),m=za(m);var P=p.length;C=C===r?P:Uc(ar(C),0,P);var V=C;return C-=m.length,C>=0&&p.slice(C,V)==m}function $Se(p){return p=Nr(p),p&&At.test(p)?p.replace(zt,Sme):p}function NSe(p){return p=Nr(p),p&&cr.test(p)?p.replace(ht,"\\$&"):p}var LSe=Ev(function(p,m,C){return p+(C?"-":"")+m.toLowerCase()}),FSe=Ev(function(p,m,C){return p+(C?" ":"")+m.toLowerCase()}),HSe=G8("toLowerCase");function BSe(p,m,C){p=Nr(p),m=ar(m);var P=m?wv(p):0;if(!m||P>=m)return p;var V=(m-P)/2;return AC(yC(V),C)+p+AC(gC(V),C)}function WSe(p,m,C){p=Nr(p),m=ar(m);var P=m?wv(p):0;return m&&P<m?p+AC(m-P,C):p}function VSe(p,m,C){p=Nr(p),m=ar(m);var P=m?wv(p):0;return m&&P<m?AC(m-P,C)+p:p}function USe(p,m,C){return C||m==null?m=0:m&&(m=+m),Xme(Nr(p).replace(br,""),m||0)}function jSe(p,m,C){return(C?Xi(p,m,C):m===r)?m=1:m=ar(m),AP(Nr(p),m)}function zSe(){var p=arguments,m=Nr(p[0]);return p.length<3?m:m.replace(p[1],p[2])}var GSe=Ev(function(p,m,C){return p+(C?"_":"")+m.toLowerCase()});function YSe(p,m,C){return C&&typeof C!="number"&&Xi(p,m,C)&&(m=C=r),C=C===r?T:C>>>0,C?(p=Nr(p),p&&(typeof m=="string"||m!=null&&!QP(m))&&(m=za(m),!m&&bv(p))?df(is(p),0,C):p.split(m,C)):[]}var KSe=Ev(function(p,m,C){return p+(C?" ":"")+rI(m)});function XSe(p,m,C){return p=Nr(p),C=C==null?0:Uc(ar(C),0,p.length),m=za(m),p.slice(C,C+m.length)==m}function qSe(p,m,C){var P=K.templateSettings;C&&Xi(p,m,C)&&(m=r),p=Nr(p),m=VC({},m,P,Q8);var V=VC({},m.imports,P.imports,Q8),Z=vi(V),ue=dP(V,Z),_e,ke,Ve=0,We=m.interpolate||Me,je="__p += '",ft=pP((m.escape||Me).source+"|"+We.source+"|"+(We===_t?ne:Me).source+"|"+(m.evaluate||Me).source+"|$","g"),Ct="//# sourceURL="+("sourceURL"in m?m.sourceURL:"lodash.templateSources["+ ++nme+"]")+`
`;p.replace(ft,function(Dt,mr,Lr,qi,Zi,pf){return Lr||(Lr=qi),je+=p.slice(Ve,pf).replace(ze,Cme),mr&&(_e=!0,je+=`' +
__e(`+mr+`) +
'`),Zi&&(ke=!0,je+=`';
`+Zi+`;
__p += '`),Lr&&(je+=`' +
((__t = (`+Lr+`)) == null ? '' : __t) +
'`),Ve=pf+Dt.length,Dt}),je+=`';
`;var Ft=m.variable;Ft||(je=`with (obj) {
`+je+`
}
`),je=(ke?je.replace(Ot,""):je).replace(Et,"$1").replace(jt,"$1;"),je="function("+(Ft||"obj")+`) {
`+(Ft?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_e?", __e = _.escape":"")+(ke?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+je+`return __p
}`;var yr=z5(function(){return Mr(Z,Ct+"return "+je).apply(r,ue)});if(yr.source=je,JP(yr))throw yr;return yr}function ZSe(p){return Nr(p).toLowerCase()}function JSe(p){return Nr(p).toUpperCase()}function QSe(p,m,C){if(p=Nr(p),p&&(C||m===r))return p.replace(dr,"");if(!p||!(m=za(m)))return p;var P=is(p),V=is(m),Z=i8(P,V),ue=a8(P,V)+1;return df(P,Z,ue).join("")}function e1e(p,m,C){if(p=Nr(p),p&&(C||m===r))return p.replace(ni,"");if(!p||!(m=za(m)))return p;var P=is(p),V=a8(P,is(m))+1;return df(P,0,V).join("")}function t1e(p,m,C){if(p=Nr(p),p&&(C||m===r))return p.replace(br,"");if(!p||!(m=za(m)))return p;var P=is(p),V=i8(P,is(m));return df(P,V).join("")}function r1e(p,m){var C=I,P=F;if(Sn(m)){var V="separator"in m?m.separator:V;C="length"in m?ar(m.length):C,P="omission"in m?za(m.omission):P}p=Nr(p);var Z=p.length;if(bv(p)){var ue=is(p);Z=ue.length}if(C>=Z)return p;var _e=C-wv(P);if(_e<1)return P;var ke=ue?df(ue,0,_e).join(""):p.slice(0,_e);if(V===r)return ke+P;if(ue&&(_e+=ke.length-_e),QP(V)){if(p.slice(_e).search(V)){var Ve,We=ke;for(V.global||(V=pP(V.source,Nr(oe.exec(V))+"g")),V.lastIndex=0;Ve=V.exec(We);)var je=Ve.index;ke=ke.slice(0,je===r?_e:je)}}else if(p.indexOf(za(V),_e)!=_e){var ft=ke.lastIndexOf(V);ft>-1&&(ke=ke.slice(0,ft))}return ke+P}function n1e(p){return p=Nr(p),p&&Ht.test(p)?p.replace(qt,Ame):p}var i1e=Ev(function(p,m,C){return p+(C?" ":"")+m.toUpperCase()}),rI=G8("toUpperCase");function j5(p,m,C){return p=Nr(p),m=C?r:m,m===r?Tme(p)?Mme(p):gme(p):p.match(m)||[]}var z5=hr(function(p,m){try{return Ua(p,r,m)}catch(C){return JP(C)?C:new Zt(C)}}),a1e=Ll(function(p,m){return go(m,function(C){C=Us(C),$l(p,C,qP(p[C],p))}),p});function o1e(p){var m=p==null?0:p.length,C=Mt();return p=m?_n(p,function(P){if(typeof P[1]!="function")throw new yo(o);return[C(P[0]),P[1]]}):[],hr(function(P){for(var V=-1;++V<m;){var Z=p[V];if(Ua(Z[0],this,P))return Ua(Z[1],this,P)}})}function s1e(p){return P0e(bo(p,f))}function nI(p){return function(){return p}}function l1e(p,m){return p==null||p!==p?m:p}var u1e=K8(),f1e=K8(!0);function Ta(p){return p}function iI(p){return T8(typeof p=="function"?p:bo(p,f))}function c1e(p){return E8(bo(p,f))}function h1e(p,m){return R8(p,bo(m,f))}var d1e=hr(function(p,m){return function(C){return l0(C,p,m)}}),v1e=hr(function(p,m){return function(C){return l0(p,C,m)}});function aI(p,m,C){var P=vi(m),V=CC(m,P);C==null&&!(Sn(m)&&(V.length||!P.length))&&(C=m,m=p,p=this,V=CC(m,vi(m)));var Z=!(Sn(C)&&"chain"in C)||!!C.chain,ue=Hl(p);return go(V,function(_e){var ke=m[_e];p[_e]=ke,ue&&(p.prototype[_e]=function(){var Ve=this.__chain__;if(Z||Ve){var We=p(this.__wrapped__),je=We.__actions__=Sa(this.__actions__);return je.push({func:ke,args:arguments,thisArg:p}),We.__chain__=Ve,We}return ke.apply(p,sf([this.value()],arguments))})}),p}function p1e(){return wi._===this&&(wi._=Hme),this}function oI(){}function g1e(p){return p=ar(p),hr(function(m){return k8(m,p)})}var y1e=LP(_n),m1e=LP(Qj),b1e=LP(lP);function G5(p){return jP(p)?uP(Us(p)):K0e(p)}function w1e(p){return function(m){return p==null?r:Tv(p,m)}}var _1e=q8(),S1e=q8(!0);function sI(){return[]}function lI(){return!1}function C1e(){return{}}function x1e(){return""}function T1e(){return!0}function O1e(p,m){if(p=ar(p),p<1||p>Te)return[];var C=T,P=Ei(p,T);m=Mt(m),p-=T;for(var V=hP(P,m);++C<p;)m(C);return V}function E1e(p){return Qt(p)?_n(p,Us):Ga(p)?[p]:Sa(h5(Nr(p)))}function R1e(p){var m=++Lme;return Nr(p)+m}var k1e=kC(function(p,m){return p+m},0),A1e=FP("ceil"),P1e=kC(function(p,m){return p/m},1),I1e=FP("floor");function M1e(p){return p&&p.length?SC(p,Ta,CP):r}function D1e(p,m){return p&&p.length?SC(p,Mt(m,2),CP):r}function $1e(p){return r8(p,Ta)}function N1e(p,m){return r8(p,Mt(m,2))}function L1e(p){return p&&p.length?SC(p,Ta,EP):r}function F1e(p,m){return p&&p.length?SC(p,Mt(m,2),EP):r}var H1e=kC(function(p,m){return p*m},1),B1e=FP("round"),W1e=kC(function(p,m){return p-m},0);function V1e(p){return p&&p.length?cP(p,Ta):0}function U1e(p,m){return p&&p.length?cP(p,Mt(m,2)):0}return K.after=c_e,K.ary=C5,K.assign=J_e,K.assignIn=L5,K.assignInWith=VC,K.assignWith=Q_e,K.at=eSe,K.before=x5,K.bind=qP,K.bindAll=a1e,K.bindKey=T5,K.castArray=C_e,K.chain=w5,K.chunk=Ibe,K.compact=Mbe,K.concat=Dbe,K.cond=o1e,K.conforms=s1e,K.constant=nI,K.countBy=Vwe,K.create=tSe,K.curry=O5,K.curryRight=E5,K.debounce=R5,K.defaults=rSe,K.defaultsDeep=nSe,K.defer=h_e,K.delay=d_e,K.difference=$be,K.differenceBy=Nbe,K.differenceWith=Lbe,K.drop=Fbe,K.dropRight=Hbe,K.dropRightWhile=Bbe,K.dropWhile=Wbe,K.fill=Vbe,K.filter=jwe,K.flatMap=Ywe,K.flatMapDeep=Kwe,K.flatMapDepth=Xwe,K.flatten=g5,K.flattenDeep=Ube,K.flattenDepth=jbe,K.flip=v_e,K.flow=u1e,K.flowRight=f1e,K.fromPairs=zbe,K.functions=fSe,K.functionsIn=cSe,K.groupBy=qwe,K.initial=Ybe,K.intersection=Kbe,K.intersectionBy=Xbe,K.intersectionWith=qbe,K.invert=dSe,K.invertBy=vSe,K.invokeMap=Jwe,K.iteratee=iI,K.keyBy=Qwe,K.keys=vi,K.keysIn=xa,K.map=NC,K.mapKeys=gSe,K.mapValues=ySe,K.matches=c1e,K.matchesProperty=h1e,K.memoize=FC,K.merge=mSe,K.mergeWith=F5,K.method=d1e,K.methodOf=v1e,K.mixin=aI,K.negate=HC,K.nthArg=g1e,K.omit=bSe,K.omitBy=wSe,K.once=p_e,K.orderBy=e_e,K.over=y1e,K.overArgs=g_e,K.overEvery=m1e,K.overSome=b1e,K.partial=ZP,K.partialRight=k5,K.partition=t_e,K.pick=_Se,K.pickBy=H5,K.property=G5,K.propertyOf=w1e,K.pull=ewe,K.pullAll=m5,K.pullAllBy=twe,K.pullAllWith=rwe,K.pullAt=nwe,K.range=_1e,K.rangeRight=S1e,K.rearg=y_e,K.reject=i_e,K.remove=iwe,K.rest=m_e,K.reverse=KP,K.sampleSize=o_e,K.set=CSe,K.setWith=xSe,K.shuffle=s_e,K.slice=awe,K.sortBy=f_e,K.sortedUniq=hwe,K.sortedUniqBy=dwe,K.split=YSe,K.spread=b_e,K.tail=vwe,K.take=pwe,K.takeRight=gwe,K.takeRightWhile=ywe,K.takeWhile=mwe,K.tap=Mwe,K.throttle=w_e,K.thru=$C,K.toArray=D5,K.toPairs=B5,K.toPairsIn=W5,K.toPath=E1e,K.toPlainObject=N5,K.transform=TSe,K.unary=__e,K.union=bwe,K.unionBy=wwe,K.unionWith=_we,K.uniq=Swe,K.uniqBy=Cwe,K.uniqWith=xwe,K.unset=OSe,K.unzip=XP,K.unzipWith=b5,K.update=ESe,K.updateWith=RSe,K.values=Av,K.valuesIn=kSe,K.without=Twe,K.words=j5,K.wrap=S_e,K.xor=Owe,K.xorBy=Ewe,K.xorWith=Rwe,K.zip=kwe,K.zipObject=Awe,K.zipObjectDeep=Pwe,K.zipWith=Iwe,K.entries=B5,K.entriesIn=W5,K.extend=L5,K.extendWith=VC,aI(K,K),K.add=k1e,K.attempt=z5,K.camelCase=MSe,K.capitalize=V5,K.ceil=A1e,K.clamp=ASe,K.clone=x_e,K.cloneDeep=O_e,K.cloneDeepWith=E_e,K.cloneWith=T_e,K.conformsTo=R_e,K.deburr=U5,K.defaultTo=l1e,K.divide=P1e,K.endsWith=DSe,K.eq=os,K.escape=$Se,K.escapeRegExp=NSe,K.every=Uwe,K.find=zwe,K.findIndex=v5,K.findKey=iSe,K.findLast=Gwe,K.findLastIndex=p5,K.findLastKey=aSe,K.floor=I1e,K.forEach=_5,K.forEachRight=S5,K.forIn=oSe,K.forInRight=sSe,K.forOwn=lSe,K.forOwnRight=uSe,K.get=eI,K.gt=k_e,K.gte=A_e,K.has=hSe,K.hasIn=tI,K.head=y5,K.identity=Ta,K.includes=Zwe,K.indexOf=Gbe,K.inRange=PSe,K.invoke=pSe,K.isArguments=Gc,K.isArray=Qt,K.isArrayBuffer=P_e,K.isArrayLike=Ca,K.isArrayLikeObject=Ln,K.isBoolean=I_e,K.isBuffer=vf,K.isDate=M_e,K.isElement=D_e,K.isEmpty=$_e,K.isEqual=N_e,K.isEqualWith=L_e,K.isError=JP,K.isFinite=F_e,K.isFunction=Hl,K.isInteger=A5,K.isLength=BC,K.isMap=P5,K.isMatch=H_e,K.isMatchWith=B_e,K.isNaN=W_e,K.isNative=V_e,K.isNil=j_e,K.isNull=U_e,K.isNumber=I5,K.isObject=Sn,K.isObjectLike=An,K.isPlainObject=v0,K.isRegExp=QP,K.isSafeInteger=z_e,K.isSet=M5,K.isString=WC,K.isSymbol=Ga,K.isTypedArray=kv,K.isUndefined=G_e,K.isWeakMap=Y_e,K.isWeakSet=K_e,K.join=Zbe,K.kebabCase=LSe,K.last=_o,K.lastIndexOf=Jbe,K.lowerCase=FSe,K.lowerFirst=HSe,K.lt=X_e,K.lte=q_e,K.max=M1e,K.maxBy=D1e,K.mean=$1e,K.meanBy=N1e,K.min=L1e,K.minBy=F1e,K.stubArray=sI,K.stubFalse=lI,K.stubObject=C1e,K.stubString=x1e,K.stubTrue=T1e,K.multiply=H1e,K.nth=Qbe,K.noConflict=p1e,K.noop=oI,K.now=LC,K.pad=BSe,K.padEnd=WSe,K.padStart=VSe,K.parseInt=USe,K.random=ISe,K.reduce=r_e,K.reduceRight=n_e,K.repeat=jSe,K.replace=zSe,K.result=SSe,K.round=B1e,K.runInContext=Re,K.sample=a_e,K.size=l_e,K.snakeCase=GSe,K.some=u_e,K.sortedIndex=owe,K.sortedIndexBy=swe,K.sortedIndexOf=lwe,K.sortedLastIndex=uwe,K.sortedLastIndexBy=fwe,K.sortedLastIndexOf=cwe,K.startCase=KSe,K.startsWith=XSe,K.subtract=W1e,K.sum=V1e,K.sumBy=U1e,K.template=qSe,K.times=O1e,K.toFinite=Bl,K.toInteger=ar,K.toLength=$5,K.toLower=ZSe,K.toNumber=So,K.toSafeInteger=Z_e,K.toString=Nr,K.toUpper=JSe,K.trim=QSe,K.trimEnd=e1e,K.trimStart=t1e,K.truncate=r1e,K.unescape=n1e,K.uniqueId=R1e,K.upperCase=i1e,K.upperFirst=rI,K.each=_5,K.eachRight=S5,K.first=y5,aI(K,function(){var p={};return Ws(K,function(m,C){nn.call(K.prototype,C)||(p[C]=m)}),p}(),{chain:!1}),K.VERSION=n,go(["bind","bindKey","curry","curryRight","partial","partialRight"],function(p){K[p].placeholder=K}),go(["drop","take"],function(p,m){wr.prototype[p]=function(C){C=C===r?1:ai(ar(C),0);var P=this.__filtered__&&!m?new wr(this):this.clone();return P.__filtered__?P.__takeCount__=Ei(C,P.__takeCount__):P.__views__.push({size:Ei(C,T),type:p+(P.__dir__<0?"Right":"")}),P},wr.prototype[p+"Right"]=function(C){return this.reverse()[p](C).reverse()}}),go(["filter","map","takeWhile"],function(p,m){var C=m+1,P=C==z||C==ie;wr.prototype[p]=function(V){var Z=this.clone();return Z.__iteratees__.push({iteratee:Mt(V,3),type:C}),Z.__filtered__=Z.__filtered__||P,Z}}),go(["head","last"],function(p,m){var C="take"+(m?"Right":"");wr.prototype[p]=function(){return this[C](1).value()[0]}}),go(["initial","tail"],function(p,m){var C="drop"+(m?"":"Right");wr.prototype[p]=function(){return this.__filtered__?new wr(this):this[C](1)}}),wr.prototype.compact=function(){return this.filter(Ta)},wr.prototype.find=function(p){return this.filter(p).head()},wr.prototype.findLast=function(p){return this.reverse().find(p)},wr.prototype.invokeMap=hr(function(p,m){return typeof p=="function"?new wr(this):this.map(function(C){return l0(C,p,m)})}),wr.prototype.reject=function(p){return this.filter(HC(Mt(p)))},wr.prototype.slice=function(p,m){p=ar(p);var C=this;return C.__filtered__&&(p>0||m<0)?new wr(C):(p<0?C=C.takeRight(-p):p&&(C=C.drop(p)),m!==r&&(m=ar(m),C=m<0?C.dropRight(-m):C.take(m-p)),C)},wr.prototype.takeRightWhile=function(p){return this.reverse().takeWhile(p).reverse()},wr.prototype.toArray=function(){return this.take(T)},Ws(wr.prototype,function(p,m){var C=/^(?:filter|find|map|reject)|While$/.test(m),P=/^(?:head|last)$/.test(m),V=K[P?"take"+(m=="last"?"Right":""):m],Z=P||/^find/.test(m);V&&(K.prototype[m]=function(){var ue=this.__wrapped__,_e=P?[1]:arguments,ke=ue instanceof wr,Ve=_e[0],We=ke||Qt(ue),je=function(mr){var Lr=V.apply(K,sf([mr],_e));return P&&ft?Lr[0]:Lr};We&&C&&typeof Ve=="function"&&Ve.length!=1&&(ke=We=!1);var ft=this.__chain__,Ct=!!this.__actions__.length,Ft=Z&&!ft,yr=ke&&!Ct;if(!Z&&We){ue=yr?ue:new wr(this);var Dt=p.apply(ue,_e);return Dt.__actions__.push({func:$C,args:[je],thisArg:r}),new mo(Dt,ft)}return Ft&&yr?p.apply(this,_e):(Dt=this.thru(je),Ft?P?Dt.value()[0]:Dt.value():Dt)})}),go(["pop","push","shift","sort","splice","unshift"],function(p){var m=sC[p],C=/^(?:push|sort|unshift)$/.test(p)?"tap":"thru",P=/^(?:pop|shift)$/.test(p);K.prototype[p]=function(){var V=arguments;if(P&&!this.__chain__){var Z=this.value();return m.apply(Qt(Z)?Z:[],V)}return this[C](function(ue){return m.apply(Qt(ue)?ue:[],V)})}}),Ws(wr.prototype,function(p,m){var C=K[m];if(C){var P=C.name+"",V=i0[P]||(i0[P]=[]);V.push({name:m,func:C})}}),i0[RC(r,y).name]=[{name:"wrapper",func:r}],wr.prototype.clone=r0e,wr.prototype.reverse=n0e,wr.prototype.value=i0e,K.prototype.at=Dwe,K.prototype.chain=$we,K.prototype.commit=Nwe,K.prototype.next=Lwe,K.prototype.plant=Hwe,K.prototype.reverse=Bwe,K.prototype.toJSON=K.prototype.valueOf=K.prototype.value=Wwe,K.prototype.first=K.prototype.head,e0&&(K.prototype[e0]=Fwe),K},_v=Dme();Hc?((Hc.exports=_v)._=_v,iP._=_v):wi._=_v}).call(Lf)})(SCe,tE);const io=tE,Nne=e=>(WB("data-v-c30cc333"),e=e(),VB(),e),CCe={class:"chart-list"},xCe=["onClick"],TCe=Nne(()=>fr("i",{class:"icon-sanjiaoyou iconfont"},null,-1)),OCe={key:0,class:"chart-wrapper"},ECe=["onClick"],RCe={class:"preview"},kCe={class:"name-box"},ACe={class:"chart-nav"},PCe=["onClick"],ICe=Nne(()=>fr("i",{class:"iconfont icon-shouqi"},null,-1)),MCe={key:0,class:"text"},DCe=ba({__name:"typeBlock",setup(e){const t=Xu(_l),r=da(z1e().map(o=>({...o,open:!0}))),n=o=>{o.open=!o.open},i=da(!1),a=o=>{Z1e.confirm("切换图表类型将会替换原图表的数据，你确定要切换吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Wo.emit("chartClear");const s=io.cloneDeep(t==null?void 0:t.value),l=K1e[o.value];s.config.data=l,s.type=o.value,Wo.emit("updateChart",s)})};return(o,s)=>{const l=mc("el-tooltip");return Cr(),Gr("div",{class:Ff(["type-block",{expand:i.value}])},[fr("div",CCe,[(Cr(!0),Gr(Wp,null,Vp(r.value,u=>QO((Cr(),Gr("div",{key:u.value},[fr("div",{class:Ff(["tab",{open:u.open}]),onClick:f=>n(u)},[TCe,JO(" "+hg(u.label),1)],10,xCe),u.open?(Cr(),Gr("div",OCe,[(Cr(!0),Gr(Wp,null,Vp(u.children,f=>(Cr(),Gr("div",{key:f.value,class:Ff([{active:f.value===ln(t).type},"chart-block"]),onClick:c=>a(f)},[fr("div",RCe,[li(ln(G1e),{chart:f},null,8,["chart"])]),fr("div",kCe,hg(f.label),1)],10,ECe))),128))])):Td("",!0)])),[[g$,i.value]])),128)),QO(fr("div",ACe,[(Cr(!0),Gr(Wp,null,Vp(ln(Y1e),u=>(Cr(),km(l,{key:u.value,content:u.label,placement:"right"},{default:Du(()=>[fr("div",{class:Ff({active:u.value===ln(t).type}),onClick:f=>a(u)},[fr("i",{class:Ff(["iconfont",[u.icon]])},null,2)],10,PCe)]),_:2},1032,["content"]))),128))],512),[[g$,!i.value]])]),fr("div",{class:"bottom",onClick:s[0]||(s[0]=u=>i.value=!i.value)},[fr("div",null,[ICe,i.value?(Cr(),Gr("span",MCe,"收起")):Td("",!0)])])],2)}}});const $Ce=Xo(DCe,[["__scopeId","data-v-c30cc333"]]),NCe={key:0,class:"download-loading"},LCe={class:"wrapper","element-loading-background":"transparent","element-loading-text":"下载中, 请稍后..."},FCe=ba({__name:"loading",setup(e){const t=da(!1);return Wo.on("chartLoading",r=>{t.value=r}),(r,n)=>{const i=J1e("loading");return t.value?(Cr(),Gr("div",NCe,[QO(fr("div",LCe,null,512),[[i,!0]])])):Td("",!0)}}});const HCe=Xo(FCe,[["__scopeId","data-v-39f8190a"]]),BCe={color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],backgroundColor:"transparent",textStyle:{},title:{textStyle:{color:"#516b91"},subtextStyle:{color:"#93b7e3"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"circle",smooth:!0},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"circle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#edafda",color0:"transparent",borderColor:"#d680bc",borderColor0:"#8fd3e8",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:"6",symbol:"circle",smooth:!0,color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},geo:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#8fd3e8",width:1},itemStyle:{color:"#8fd3e8",borderWidth:1},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},checkpointStyle:{color:"#8fd3e8",borderColor:"#8a7ca8"},label:{color:"#8fd3e8"},emphasis:{itemStyle:{color:"#8fd3e8"},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},label:{color:"#8fd3e8"}}},visualMap:{color:["#516b91","#59c4e6","#a5e7f0"]},dataZoom:{backgroundColor:"rgba(0,0,0,0)",dataBackgroundColor:"rgba(255,255,255,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var y$=function(e,t){return y$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},y$(e,t)};function ct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");y$(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var WCe=function(){function e(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return e}(),VCe=function(){function e(){this.browser=new WCe,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return e}(),Ih=new VCe;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(Ih.wxa=!0,Ih.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?Ih.worker=!0:typeof navigator>"u"?(Ih.node=!0,Ih.svgSupported=!0):UCe(navigator.userAgent,Ih);function UCe(e,t){var r=t.browser,n=e.match(/Firefox\/([\d.]+)/),i=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),a=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);n&&(r.firefox=!0,r.version=n[1]),i&&(r.ie=!0,r.version=i[1]),a&&(r.edge=!0,r.version=a[1],r.newEdge=+a[1].split(".")[0]>18),o&&(r.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,t.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),t.domSupported=typeof document<"u";var s=document.documentElement.style;t.transform3dSupported=(r.ie&&"transition"in s||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||r.ie&&+r.version>=9}const vr=Ih;var UB=12,jCe="sans-serif",Od=UB+"px "+jCe,zCe=20,GCe=100,YCe="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function KCe(e){var t={};if(typeof JSON>"u")return t;for(var r=0;r<e.length;r++){var n=String.fromCharCode(r+32),i=(e.charCodeAt(r)-zCe)/GCe;t[n]=i}return t}var XCe=KCe(YCe),Am={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var e,t;return function(r,n){if(!e){var i=Am.createCanvas();e=i&&i.getContext("2d")}if(e)return t!==n&&(t=e.font=n||Od),e.measureText(r);r=r||"",n=n||Od;var a=/(\d+)px/.exec(n),o=a&&+a[1]||UB,s=0;if(n.indexOf("mono")>=0)s=o*r.length;else for(var l=0;l<r.length;l++){var u=XCe[r[l]];s+=u==null?o:u*o}return{width:s}}}(),loadImage:function(e,t,r){var n=new Image;return n.onload=t,n.onerror=r,n.src=e,n}},Lne=bc(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),Fne=bc(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),XS=Object.prototype.toString,ok=Array.prototype,qCe=ok.forEach,ZCe=ok.filter,jB=ok.slice,JCe=ok.map,X5=function(){}.constructor,UC=X5?X5.prototype:null,zB="__proto__",QCe=2311;function Hne(){return QCe++}function GB(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];typeof console<"u"&&console.error.apply(console,e)}function Rr(e){if(e==null||typeof e!="object")return e;var t=e,r=XS.call(e);if(r==="[object Array]"){if(!Db(e)){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=Rr(e[n])}}else if(Fne[r]){if(!Db(e)){var a=e.constructor;if(a.from)t=a.from(e);else{t=new a(e.length);for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}}}else if(!Lne[r]&&!Db(e)&&!rE(e)){t={};for(var o in e)e.hasOwnProperty(o)&&o!==zB&&(t[o]=Rr(e[o]))}return t}function Hr(e,t,r){if(!$t(t)||!$t(e))return r?Rr(t):e;for(var n in t)if(t.hasOwnProperty(n)&&n!==zB){var i=e[n],a=t[n];$t(a)&&$t(i)&&!mt(a)&&!mt(i)&&!rE(a)&&!rE(i)&&!q5(a)&&!q5(i)&&!Db(a)&&!Db(i)?Hr(i,a,r):(r||!(n in e))&&(e[n]=Rr(t[n]))}return e}function et(e,t){if(Object.assign)Object.assign(e,t);else for(var r in t)t.hasOwnProperty(r)&&r!==zB&&(e[r]=t[r]);return e}function Vr(e,t,r){for(var n=yn(t),i=0;i<n.length;i++){var a=n[i];(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}return e}function Xr(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return-1}function exe(e,t){var r=e.prototype;function n(){}n.prototype=t.prototype,e.prototype=new n;for(var i in r)r.hasOwnProperty(i)&&(e.prototype[i]=r[i]);e.prototype.constructor=e,e.superClass=t}function Sl(e,t,r){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var a=n[i];a!=="constructor"&&(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}else Vr(e,t,r)}function Fa(e){return!e||typeof e=="string"?!1:typeof e.length=="number"}function ye(e,t,r){if(e&&t)if(e.forEach&&e.forEach===qCe)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(r,e[a],a,e)}function Lt(e,t,r){if(!e)return[];if(!t)return YB(e);if(e.map&&e.map===JCe)return e.map(t,r);for(var n=[],i=0,a=e.length;i<a;i++)n.push(t.call(r,e[i],i,e));return n}function bc(e,t,r,n){if(e&&t){for(var i=0,a=e.length;i<a;i++)r=t.call(n,r,e[i],i,e);return r}}function ua(e,t,r){if(!e)return[];if(!t)return YB(e);if(e.filter&&e.filter===ZCe)return e.filter(t,r);for(var n=[],i=0,a=e.length;i<a;i++)t.call(r,e[i],i,e)&&n.push(e[i]);return n}function yn(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}function txe(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){return e.apply(t,r.concat(jB.call(arguments)))}}var un=UC&&lr(UC.bind)?UC.call.bind(UC.bind):txe;function Un(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){return e.apply(this,t.concat(jB.call(arguments)))}}function mt(e){return Array.isArray?Array.isArray(e):XS.call(e)==="[object Array]"}function lr(e){return typeof e=="function"}function Rt(e){return typeof e=="string"}function m$(e){return XS.call(e)==="[object String]"}function en(e){return typeof e=="number"}function $t(e){var t=typeof e;return t==="function"||!!e&&t==="object"}function q5(e){return!!Lne[XS.call(e)]}function so(e){return!!Fne[XS.call(e)]}function rE(e){return typeof e=="object"&&typeof e.nodeType=="number"&&typeof e.ownerDocument=="object"}function sk(e){return e.colorStops!=null}function rxe(e){return e.image!=null}function nE(e){return e!==e}function bw(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e.length;r<n;r++)if(e[r]!=null)return e[r]}function Tr(e,t){return e??t}function Mb(e,t,r){return e??t??r}function YB(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return jB.apply(e,t)}function Bne(e){if(typeof e=="number")return[e,e,e,e];var t=e.length;return t===2?[e[0],e[1],e[0],e[1]]:t===3?[e[0],e[1],e[2],e[1]]:e}function Bu(e,t){if(!e)throw new Error(t)}function dl(e){return e==null?null:typeof e.trim=="function"?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var Wne="__ec_primitive__";function b$(e){e[Wne]=!0}function Db(e){return e[Wne]}var nxe=function(){function e(){this.data={}}return e.prototype.delete=function(t){var r=this.has(t);return r&&delete this.data[t],r},e.prototype.has=function(t){return this.data.hasOwnProperty(t)},e.prototype.get=function(t){return this.data[t]},e.prototype.set=function(t,r){return this.data[t]=r,this},e.prototype.keys=function(){return yn(this.data)},e.prototype.forEach=function(t){var r=this.data;for(var n in r)r.hasOwnProperty(n)&&t(r[n],n)},e}(),Vne=typeof Map=="function";function ixe(){return Vne?new Map:new nxe}var axe=function(){function e(t){var r=mt(t);this.data=ixe();var n=this;t instanceof e?t.each(i):t&&ye(t,i);function i(a,o){r?n.set(a,o):n.set(o,a)}}return e.prototype.hasKey=function(t){return this.data.has(t)},e.prototype.get=function(t){return this.data.get(t)},e.prototype.set=function(t,r){return this.data.set(t,r),r},e.prototype.each=function(t,r){this.data.forEach(function(n,i){t.call(r,n,i)})},e.prototype.keys=function(){var t=this.data.keys();return Vne?Array.from(t):t},e.prototype.removeKey=function(t){this.data.delete(t)},e}();function pr(e){return new axe(e)}function oxe(e,t){for(var r=new e.constructor(e.length+t.length),n=0;n<e.length;n++)r[n]=e[n];for(var i=e.length,n=0;n<t.length;n++)r[n+i]=t[n];return r}function lk(e,t){var r;if(Object.create)r=Object.create(e);else{var n=function(){};n.prototype=e,r=new n}return t&&et(r,t),r}function Une(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function dg(e,t){return e.hasOwnProperty(t)}function Na(){}var sxe=180/Math.PI;function Pm(e,t){return e==null&&(e=0),t==null&&(t=0),[e,t]}function lxe(e){return[e[0],e[1]]}function Z5(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function uxe(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function fxe(e){return Math.sqrt(cxe(e))}function cxe(e){return e[0]*e[0]+e[1]*e[1]}function fI(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function hxe(e,t){var r=fxe(t);return r===0?(e[0]=0,e[1]=0):(e[0]=t[0]/r,e[1]=t[1]/r),e}function w$(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var _$=w$;function dxe(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var Up=dxe;function cI(e,t,r,n){return e[0]=t[0]+n*(r[0]-t[0]),e[1]=t[1]+n*(r[1]-t[1]),e}function jo(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function Ap(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Pp(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}var Pv=function(){function e(t,r){this.target=t,this.topTarget=r&&r.topTarget}return e}(),vxe=function(){function e(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(t){for(var r=t.target;r&&!r.draggable;)r=r.parent||r.__hostTarget;r&&(this._draggingTarget=r,r.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new Pv(r,t),"dragstart",t.event))},e.prototype._drag=function(t){var r=this._draggingTarget;if(r){var n=t.offsetX,i=t.offsetY,a=n-this._x,o=i-this._y;this._x=n,this._y=i,r.drift(a,o,t),this.handler.dispatchToElement(new Pv(r,t),"drag",t.event);var s=this.handler.findHover(n,i,r).target,l=this._dropTarget;this._dropTarget=s,r!==s&&(l&&s!==l&&this.handler.dispatchToElement(new Pv(l,t),"dragleave",t.event),s&&s!==l&&this.handler.dispatchToElement(new Pv(s,t),"dragenter",t.event))}},e.prototype._dragEnd=function(t){var r=this._draggingTarget;r&&(r.dragging=!1),this.handler.dispatchToElement(new Pv(r,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new Pv(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},e}();const pxe=vxe;var gxe=function(){function e(t){t&&(this._$eventProcessor=t)}return e.prototype.on=function(t,r,n,i){this._$handlers||(this._$handlers={});var a=this._$handlers;if(typeof r=="function"&&(i=n,n=r,r=null),!n||!t)return this;var o=this._$eventProcessor;r!=null&&o&&o.normalizeQuery&&(r=o.normalizeQuery(r)),a[t]||(a[t]=[]);for(var s=0;s<a[t].length;s++)if(a[t][s].h===n)return this;var l={h:n,query:r,ctx:i||this,callAtLast:n.zrEventfulCallAtLast},u=a[t].length-1,f=a[t][u];return f&&f.callAtLast?a[t].splice(u,0,l):a[t].push(l),this},e.prototype.isSilent=function(t){var r=this._$handlers;return!r||!r[t]||!r[t].length},e.prototype.off=function(t,r){var n=this._$handlers;if(!n)return this;if(!t)return this._$handlers={},this;if(r){if(n[t]){for(var i=[],a=0,o=n[t].length;a<o;a++)n[t][a].h!==r&&i.push(n[t][a]);n[t]=i}n[t]&&n[t].length===0&&delete n[t]}else delete n[t];return this},e.prototype.trigger=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=i.length,l=0;l<s;l++){var u=i[l];if(!(a&&a.filter&&u.query!=null&&!a.filter(t,u.query)))switch(o){case 0:u.h.call(u.ctx);break;case 1:u.h.call(u.ctx,r[0]);break;case 2:u.h.call(u.ctx,r[0],r[1]);break;default:u.h.apply(u.ctx,r);break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e.prototype.triggerWithContext=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=r[o-1],l=i.length,u=0;u<l;u++){var f=i[u];if(!(a&&a.filter&&f.query!=null&&!a.filter(t,f.query)))switch(o){case 0:f.h.call(s);break;case 1:f.h.call(s,r[0]);break;case 2:f.h.call(s,r[0],r[1]);break;default:f.h.apply(s,r.slice(1,o-1));break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e}();const Cl=gxe;var yxe=Math.log(2);function S$(e,t,r,n,i,a){var o=n+"-"+i,s=e.length;if(a.hasOwnProperty(o))return a[o];if(t===1){var l=Math.round(Math.log((1<<s)-1&~i)/yxe);return e[r][l]}for(var u=n|1<<r,f=r+1;n&1<<f;)f++;for(var c=0,h=0,d=0;h<s;h++){var v=1<<h;v&i||(c+=(d%2?-1:1)*e[r][h]*S$(e,t-1,f,u,i|v,a),d++)}return a[o]=c,c}function J5(e,t){var r=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],n={},i=S$(r,8,0,0,0,n);if(i!==0){for(var a=[],o=0;o<8;o++)for(var s=0;s<8;s++)a[s]==null&&(a[s]=0),a[s]+=((o+s)%2?-1:1)*S$(r,7,o===0?1:0,1<<o,1<<s,n)/i*t[o];return function(l,u,f){var c=u*a[6]+f*a[7]+1;l[0]=(u*a[0]+f*a[1]+a[2])/c,l[1]=(u*a[3]+f*a[4]+a[5])/c}}}var Q5="___zrEVENTSAVED",hI=[];function mxe(e,t,r,n,i){return C$(hI,t,n,i,!0)&&C$(e,r,hI[0],hI[1])}function C$(e,t,r,n,i){if(t.getBoundingClientRect&&vr.domSupported&&!jne(t)){var a=t[Q5]||(t[Q5]={}),o=bxe(t,a),s=wxe(o,a,i);if(s)return s(e,r,n),!0}return!1}function bxe(e,t){var r=t.markers;if(r)return r;r=t.markers=[];for(var n=["left","right"],i=["top","bottom"],a=0;a<4;a++){var o=document.createElement("div"),s=o.style,l=a%2,u=(a>>1)%2;s.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[l]+":0",i[u]+":0",n[1-l]+":auto",i[1-u]+":auto",""].join("!important;"),e.appendChild(o),r.push(o)}return r}function wxe(e,t,r){for(var n=r?"invTrans":"trans",i=t[n],a=t.srcCoords,o=[],s=[],l=!0,u=0;u<4;u++){var f=e[u].getBoundingClientRect(),c=2*u,h=f.left,d=f.top;o.push(h,d),l=l&&a&&h===a[c]&&d===a[c+1],s.push(e[u].offsetLeft,e[u].offsetTop)}return l&&i?i:(t.srcCoords=o,t[n]=r?J5(s,o):J5(o,s))}function jne(e){return e.nodeName.toUpperCase()==="CANVAS"}var _xe=/([&<>"'])/g,Sxe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function No(e){return e==null?"":(e+"").replace(_xe,function(t,r){return Sxe[r]})}var Cxe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,dI=[],xxe=vr.browser.firefox&&+vr.browser.version.split(".")[0]<39;function x$(e,t,r,n){return r=r||{},n?e6(e,t,r):xxe&&t.layerX!=null&&t.layerX!==t.offsetX?(r.zrX=t.layerX,r.zrY=t.layerY):t.offsetX!=null?(r.zrX=t.offsetX,r.zrY=t.offsetY):e6(e,t,r),r}function e6(e,t,r){if(vr.domSupported&&e.getBoundingClientRect){var n=t.clientX,i=t.clientY;if(jne(e)){var a=e.getBoundingClientRect();r.zrX=n-a.left,r.zrY=i-a.top;return}else if(C$(dI,e,n,i)){r.zrX=dI[0],r.zrY=dI[1];return}}r.zrX=r.zrY=0}function KB(e){return e||window.event}function Po(e,t,r){if(t=KB(t),t.zrX!=null)return t;var n=t.type,i=n&&n.indexOf("touch")>=0;if(i){var o=n!=="touchend"?t.targetTouches[0]:t.changedTouches[0];o&&x$(e,o,t,r)}else{x$(e,t,t,r);var a=Txe(t);t.zrDelta=a?a/120:-(t.detail||0)/3}var s=t.button;return t.which==null&&s!==void 0&&Cxe.test(t.type)&&(t.which=s&1?1:s&2?3:s&4?2:0),t}function Txe(e){var t=e.wheelDelta;if(t)return t;var r=e.deltaX,n=e.deltaY;if(r==null||n==null)return t;var i=Math.abs(n!==0?n:r),a=n>0?-1:n<0?1:r>0?-1:1;return 3*i*a}function Oxe(e,t,r,n){e.addEventListener(t,r,n)}function Exe(e,t,r,n){e.removeEventListener(t,r,n)}var zne=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0},Rxe=function(){function e(){this._track=[]}return e.prototype.recognize=function(t,r,n){return this._doTrack(t,r,n),this._recognize(t)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(t,r,n){var i=t.touches;if(i){for(var a={points:[],touches:[],target:r,event:t},o=0,s=i.length;o<s;o++){var l=i[o],u=x$(n,l,{});a.points.push([u.zrX,u.zrY]),a.touches.push(l)}this._track.push(a)}},e.prototype._recognize=function(t){for(var r in vI)if(vI.hasOwnProperty(r)){var n=vI[r](this._track,t);if(n)return n}},e}();function t6(e){var t=e[1][0]-e[0][0],r=e[1][1]-e[0][1];return Math.sqrt(t*t+r*r)}function kxe(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}var vI={pinch:function(e,t){var r=e.length;if(r){var n=(e[r-1]||{}).points,i=(e[r-2]||{}).points||n;if(i&&i.length>1&&n&&n.length>1){var a=t6(n)/t6(i);!isFinite(a)&&(a=1),t.pinchScale=a;var o=kxe(n);return t.pinchX=o[0],t.pinchY=o[1],{type:"pinch",target:e[0].target,event:t}}}}};function ww(){return[1,0,0,1,0,0]}function XB(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Axe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function jp(e,t,r){var n=t[0]*r[0]+t[2]*r[1],i=t[1]*r[0]+t[3]*r[1],a=t[0]*r[2]+t[2]*r[3],o=t[1]*r[2]+t[3]*r[3],s=t[0]*r[4]+t[2]*r[5]+t[4],l=t[1]*r[4]+t[3]*r[5]+t[5];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e}function T$(e,t,r){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+r[0],e[5]=t[5]+r[1],e}function qB(e,t,r){var n=t[0],i=t[2],a=t[4],o=t[1],s=t[3],l=t[5],u=Math.sin(r),f=Math.cos(r);return e[0]=n*f+o*u,e[1]=-n*u+o*f,e[2]=i*f+s*u,e[3]=-i*u+f*s,e[4]=f*a+u*l,e[5]=f*l-u*a,e}function Pxe(e,t,r){var n=r[0],i=r[1];return e[0]=t[0]*n,e[1]=t[1]*i,e[2]=t[2]*n,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*i,e}function ZB(e,t){var r=t[0],n=t[2],i=t[4],a=t[1],o=t[3],s=t[5],l=r*o-a*n;return l?(l=1/l,e[0]=o*l,e[1]=-a*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*s-o*i)*l,e[5]=(a*i-r*s)*l,e):null}var Ixe=function(){function e(t,r){this.x=t||0,this.y=r||0}return e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(t,r){return this.x=t,this.y=r,this},e.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.scaleAndAdd=function(t,r){this.x+=t.x*r,this.y+=t.y*r},e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},e.prototype.distance=function(t){var r=this.x-t.x,n=this.y-t.y;return Math.sqrt(r*r+n*n)},e.prototype.distanceSquare=function(t){var r=this.x-t.x,n=this.y-t.y;return r*r+n*n},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(t){if(t){var r=this.x,n=this.y;return this.x=t[0]*r+t[2]*n+t[4],this.y=t[1]*r+t[3]*n+t[5],this}},e.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},e.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},e.set=function(t,r,n){t.x=r,t.y=n},e.copy=function(t,r){t.x=r.x,t.y=r.y},e.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.lenSquare=function(t){return t.x*t.x+t.y*t.y},e.dot=function(t,r){return t.x*r.x+t.y*r.y},e.add=function(t,r,n){t.x=r.x+n.x,t.y=r.y+n.y},e.sub=function(t,r,n){t.x=r.x-n.x,t.y=r.y-n.y},e.scale=function(t,r,n){t.x=r.x*n,t.y=r.y*n},e.scaleAndAdd=function(t,r,n,i){t.x=r.x+n.x*i,t.y=r.y+n.y*i},e.lerp=function(t,r,n,i){var a=1-i;t.x=a*r.x+i*n.x,t.y=a*r.y+i*n.y},e}();const Yt=Ixe;var jC=Math.min,zC=Math.max,Yc=new Yt,Kc=new Yt,Xc=new Yt,qc=new Yt,p0=new Yt,g0=new Yt,Mxe=function(){function e(t,r,n,i){n<0&&(t=t+n,n=-n),i<0&&(r=r+i,i=-i),this.x=t,this.y=r,this.width=n,this.height=i}return e.prototype.union=function(t){var r=jC(t.x,this.x),n=jC(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=zC(t.x+t.width,this.x+this.width)-r:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=zC(t.y+t.height,this.y+this.height)-n:this.height=t.height,this.x=r,this.y=n},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(t){var r=this,n=t.width/r.width,i=t.height/r.height,a=ww();return T$(a,a,[-r.x,-r.y]),Pxe(a,a,[n,i]),T$(a,a,[t.x,t.y]),a},e.prototype.intersect=function(t,r){if(!t)return!1;t instanceof e||(t=e.create(t));var n=this,i=n.x,a=n.x+n.width,o=n.y,s=n.y+n.height,l=t.x,u=t.x+t.width,f=t.y,c=t.y+t.height,h=!(a<l||u<i||s<f||c<o);if(r){var d=1/0,v=0,g=Math.abs(a-l),y=Math.abs(u-i),b=Math.abs(s-f),w=Math.abs(c-o),_=Math.min(g,y),x=Math.min(b,w);a<l||u<i?_>v&&(v=_,g<y?Yt.set(g0,-g,0):Yt.set(g0,y,0)):_<d&&(d=_,g<y?Yt.set(p0,g,0):Yt.set(p0,-y,0)),s<f||c<o?x>v&&(v=x,b<w?Yt.set(g0,0,-b):Yt.set(g0,0,w)):_<d&&(d=_,b<w?Yt.set(p0,0,b):Yt.set(p0,0,-w))}return r&&Yt.copy(r,h?p0:g0),h},e.prototype.contain=function(t,r){var n=this;return t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return this.width===0||this.height===0},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(t,r){t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height},e.applyTransform=function(t,r,n){if(!n){t!==r&&e.copy(t,r);return}if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var i=n[0],a=n[3],o=n[4],s=n[5];t.x=r.x*i+o,t.y=r.y*a+s,t.width=r.width*i,t.height=r.height*a,t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height);return}Yc.x=Xc.x=r.x,Yc.y=qc.y=r.y,Kc.x=qc.x=r.x+r.width,Kc.y=Xc.y=r.y+r.height,Yc.transform(n),qc.transform(n),Kc.transform(n),Xc.transform(n),t.x=jC(Yc.x,Kc.x,Xc.x,qc.x),t.y=jC(Yc.y,Kc.y,Xc.y,qc.y);var l=zC(Yc.x,Kc.x,Xc.x,qc.x),u=zC(Yc.y,Kc.y,Xc.y,qc.y);t.width=l-t.x,t.height=u-t.y},e}();const Br=Mxe;var Gne="silent";function Dxe(e,t,r){return{type:e,event:r,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:$xe}}function $xe(){zne(this.event)}var Nxe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.handler=null,r}return t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(Cl),y0=function(){function e(t,r){this.x=t,this.y=r}return e}(),Lxe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],pI=new Br(0,0,0,0),Yne=function(e){ct(t,e);function t(r,n,i,a,o){var s=e.call(this)||this;return s._hovered=new y0(0,0),s.storage=r,s.painter=n,s.painterRoot=a,s._pointerSize=o,i=i||new Nxe,s.proxy=null,s.setHandlerProxy(i),s._draggingMgr=new pxe(s),s}return t.prototype.setHandlerProxy=function(r){this.proxy&&this.proxy.dispose(),r&&(ye(Lxe,function(n){r.on&&r.on(n,this[n],this)},this),r.handler=this),this.proxy=r},t.prototype.mousemove=function(r){var n=r.zrX,i=r.zrY,a=Kne(this,n,i),o=this._hovered,s=o.target;s&&!s.__zr&&(o=this.findHover(o.x,o.y),s=o.target);var l=this._hovered=a?new y0(n,i):this.findHover(n,i),u=l.target,f=this.proxy;f.setCursor&&f.setCursor(u?u.cursor:"default"),s&&u!==s&&this.dispatchToElement(o,"mouseout",r),this.dispatchToElement(l,"mousemove",r),u&&u!==s&&this.dispatchToElement(l,"mouseover",r)},t.prototype.mouseout=function(r){var n=r.zrEventControl;n!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",r),n!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:r})},t.prototype.resize=function(){this._hovered=new y0(0,0)},t.prototype.dispatch=function(r,n){var i=this[r];i&&i.call(this,n)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(r){var n=this.proxy;n.setCursor&&n.setCursor(r)},t.prototype.dispatchToElement=function(r,n,i){r=r||{};var a=r.target;if(!(a&&a.silent)){for(var o="on"+n,s=Dxe(n,r,i);a&&(a[o]&&(s.cancelBubble=!!a[o].call(a,s)),a.trigger(n,s),a=a.__hostTarget?a.__hostTarget:a.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(n,s),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[o]=="function"&&l[o].call(l,s),l.trigger&&l.trigger(n,s)}))}},t.prototype.findHover=function(r,n,i){var a=this.storage.getDisplayList(),o=new y0(r,n);if(r6(a,o,r,n,i),this._pointerSize&&!o.target){for(var s=[],l=this._pointerSize,u=l/2,f=new Br(r-u,n-u,l,l),c=a.length-1;c>=0;c--){var h=a[c];h!==i&&!h.ignore&&!h.ignoreCoarsePointer&&(!h.parent||!h.parent.ignoreCoarsePointer)&&(pI.copy(h.getBoundingRect()),h.transform&&pI.applyTransform(h.transform),pI.intersect(f)&&s.push(h))}if(s.length)for(var d=4,v=Math.PI/12,g=Math.PI*2,y=0;y<u;y+=d)for(var b=0;b<g;b+=v){var w=r+y*Math.cos(b),_=n+y*Math.sin(b);if(r6(s,o,w,_,i),o.target)return o}}return o},t.prototype.processGesture=function(r,n){this._gestureMgr||(this._gestureMgr=new Rxe);var i=this._gestureMgr;n==="start"&&i.clear();var a=i.recognize(r,this.findHover(r.zrX,r.zrY,null).target,this.proxy.dom);if(n==="end"&&i.clear(),a){var o=a.type;r.gestureEvent=o;var s=new y0;s.target=a.target,this.dispatchToElement(s,o,a.event)}},t}(Cl);ye(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){Yne.prototype[e]=function(t){var r=t.zrX,n=t.zrY,i=Kne(this,r,n),a,o;if((e!=="mouseup"||!i)&&(a=this.findHover(r,n),o=a.target),e==="mousedown")this._downEl=o,this._downPoint=[t.zrX,t.zrY],this._upEl=o;else if(e==="mouseup")this._upEl=o;else if(e==="click"){if(this._downEl!==this._upEl||!this._downPoint||_$(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,e,t)}});function Fxe(e,t,r){if(e[e.rectHover?"rectContain":"contain"](t,r)){for(var n=e,i=void 0,a=!1;n;){if(n.ignoreClip&&(a=!0),!a){var o=n.getClipPath();if(o&&!o.contain(t,r))return!1;n.silent&&(i=!0)}var s=n.__hostTarget;n=s||n.parent}return i?Gne:!0}return!1}function r6(e,t,r,n,i){for(var a=e.length-1;a>=0;a--){var o=e[a],s=void 0;if(o!==i&&!o.ignore&&(s=Fxe(o,r,n))&&(!t.topTarget&&(t.topTarget=o),s!==Gne)){t.target=o;break}}}function Kne(e,t,r){var n=e.painter;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}const Hxe=Yne;var Xne=32,m0=7;function Bxe(e){for(var t=0;e>=Xne;)t|=e&1,e>>=1;return e+t}function n6(e,t,r,n){var i=t+1;if(i===r)return 1;if(n(e[i++],e[t])<0){for(;i<r&&n(e[i],e[i-1])<0;)i++;Wxe(e,t,i)}else for(;i<r&&n(e[i],e[i-1])>=0;)i++;return i-t}function Wxe(e,t,r){for(r--;t<r;){var n=e[t];e[t++]=e[r],e[r--]=n}}function i6(e,t,r,n,i){for(n===t&&n++;n<r;n++){for(var a=e[n],o=t,s=n,l;o<s;)l=o+s>>>1,i(a,e[l])<0?s=l:o=l+1;var u=n-o;switch(u){case 3:e[o+3]=e[o+2];case 2:e[o+2]=e[o+1];case 1:e[o+1]=e[o];break;default:for(;u>0;)e[o+u]=e[o+u-1],u--}e[o]=a}}function gI(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])>0){for(s=n-i;l<s&&a(e,t[r+i+l])>0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}else{for(s=i+1;l<s&&a(e,t[r+i-l])<=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])>0?o=f+1:l=f}return l}function yI(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])<0){for(s=i+1;l<s&&a(e,t[r+i-l])<0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}else{for(s=n-i;l<s&&a(e,t[r+i+l])>=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])<0?l=f:o=f+1}return l}function Vxe(e,t){var r=m0,n,i,a=0;e.length;var o=[];n=[],i=[];function s(d,v){n[a]=d,i[a]=v,a+=1}function l(){for(;a>1;){var d=a-2;if(d>=1&&i[d-1]<=i[d]+i[d+1]||d>=2&&i[d-2]<=i[d]+i[d-1])i[d-1]<i[d+1]&&d--;else if(i[d]>i[d+1])break;f(d)}}function u(){for(;a>1;){var d=a-2;d>0&&i[d-1]<i[d+1]&&d--,f(d)}}function f(d){var v=n[d],g=i[d],y=n[d+1],b=i[d+1];i[d]=g+b,d===a-3&&(n[d+1]=n[d+2],i[d+1]=i[d+2]),a--;var w=yI(e[y],e,v,g,0,t);v+=w,g-=w,g!==0&&(b=gI(e[v+g-1],e,y,b,b-1,t),b!==0&&(g<=b?c(v,g,y,b):h(v,g,y,b)))}function c(d,v,g,y){var b=0;for(b=0;b<v;b++)o[b]=e[d+b];var w=0,_=g,x=d;if(e[x++]=e[_++],--y===0){for(b=0;b<v;b++)e[x+b]=o[w+b];return}if(v===1){for(b=0;b<y;b++)e[x+b]=e[_+b];e[x+y]=o[w];return}for(var E=r,R,A,N;;){R=0,A=0,N=!1;do if(t(e[_],o[w])<0){if(e[x++]=e[_++],A++,R=0,--y===0){N=!0;break}}else if(e[x++]=o[w++],R++,A=0,--v===1){N=!0;break}while((R|A)<E);if(N)break;do{if(R=yI(e[_],o,w,v,0,t),R!==0){for(b=0;b<R;b++)e[x+b]=o[w+b];if(x+=R,w+=R,v-=R,v<=1){N=!0;break}}if(e[x++]=e[_++],--y===0){N=!0;break}if(A=gI(o[w],e,_,y,0,t),A!==0){for(b=0;b<A;b++)e[x+b]=e[_+b];if(x+=A,_+=A,y-=A,y===0){N=!0;break}}if(e[x++]=o[w++],--v===1){N=!0;break}E--}while(R>=m0||A>=m0);if(N)break;E<0&&(E=0),E+=2}if(r=E,r<1&&(r=1),v===1){for(b=0;b<y;b++)e[x+b]=e[_+b];e[x+y]=o[w]}else{if(v===0)throw new Error;for(b=0;b<v;b++)e[x+b]=o[w+b]}}function h(d,v,g,y){var b=0;for(b=0;b<y;b++)o[b]=e[g+b];var w=d+v-1,_=y-1,x=g+y-1,E=0,R=0;if(e[x--]=e[w--],--v===0){for(E=x-(y-1),b=0;b<y;b++)e[E+b]=o[b];return}if(y===1){for(x-=v,w-=v,R=x+1,E=w+1,b=v-1;b>=0;b--)e[R+b]=e[E+b];e[x]=o[_];return}for(var A=r;;){var N=0,I=0,F=!1;do if(t(o[_],e[w])<0){if(e[x--]=e[w--],N++,I=0,--v===0){F=!0;break}}else if(e[x--]=o[_--],I++,N=0,--y===1){F=!0;break}while((N|I)<A);if(F)break;do{if(N=v-yI(o[_],e,d,v,v-1,t),N!==0){for(x-=N,w-=N,v-=N,R=x+1,E=w+1,b=N-1;b>=0;b--)e[R+b]=e[E+b];if(v===0){F=!0;break}}if(e[x--]=o[_--],--y===1){F=!0;break}if(I=y-gI(e[w],o,0,y,y-1,t),I!==0){for(x-=I,_-=I,y-=I,R=x+1,E=_+1,b=0;b<I;b++)e[R+b]=o[E+b];if(y<=1){F=!0;break}}if(e[x--]=e[w--],--v===0){F=!0;break}A--}while(N>=m0||I>=m0);if(F)break;A<0&&(A=0),A+=2}if(r=A,r<1&&(r=1),y===1){for(x-=v,w-=v,R=x+1,E=w+1,b=v-1;b>=0;b--)e[R+b]=e[E+b];e[x]=o[_]}else{if(y===0)throw new Error;for(E=x-(y-1),b=0;b<y;b++)e[E+b]=o[b]}}return{mergeRuns:l,forceMergeRuns:u,pushRun:s}}function KT(e,t,r,n){r||(r=0),n||(n=e.length);var i=n-r;if(!(i<2)){var a=0;if(i<Xne){a=n6(e,r,n,t),i6(e,r,n,r+a,t);return}var o=Vxe(e,t),s=Bxe(i);do{if(a=n6(e,r,n,t),a<s){var l=i;l>s&&(l=s),i6(e,r,r+l,r+a,t),a=l}o.pushRun(r,a),o.mergeRuns(),i-=a,r+=a}while(i!==0);o.forceMergeRuns()}}var ro=1,vb=2,Sp=4,a6=!1;function mI(){a6||(a6=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function o6(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var Uxe=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=o6}return e.prototype.traverse=function(t,r){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,r)},e.prototype.getDisplayList=function(t,r){r=r||!1;var n=this._displayList;return(t||!n.length)&&this.updateDisplayList(r),n},e.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var r=this._roots,n=this._displayList,i=0,a=r.length;i<a;i++)this._updateAndAddDisplayable(r[i],null,t);n.length=this._displayListLen,KT(n,o6)},e.prototype._updateAndAddDisplayable=function(t,r,n){if(!(t.ignore&&!n)){t.beforeUpdate(),t.update(),t.afterUpdate();var i=t.getClipPath();if(t.ignoreClip)r=null;else if(i){r?r=r.slice():r=[];for(var a=i,o=t;a;)a.parent=o,a.updateTransform(),r.push(a),o=a,a=a.getClipPath()}if(t.childrenRef){for(var s=t.childrenRef(),l=0;l<s.length;l++){var u=s[l];t.__dirty&&(u.__dirty|=ro),this._updateAndAddDisplayable(u,r,n)}t.__dirty=0}else{var f=t;r&&r.length?f.__clipPaths=r:f.__clipPaths&&f.__clipPaths.length>0&&(f.__clipPaths=[]),isNaN(f.z)&&(mI(),f.z=0),isNaN(f.z2)&&(mI(),f.z2=0),isNaN(f.zlevel)&&(mI(),f.zlevel=0),this._displayList[this._displayListLen++]=f}var c=t.getDecalElement&&t.getDecalElement();c&&this._updateAndAddDisplayable(c,r,n);var h=t.getTextGuideLine();h&&this._updateAndAddDisplayable(h,r,n);var d=t.getTextContent();d&&this._updateAndAddDisplayable(d,r,n)}},e.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},e.prototype.delRoot=function(t){if(t instanceof Array){for(var r=0,n=t.length;r<n;r++)this.delRoot(t[r]);return}var i=Xr(this._roots,t);i>=0&&this._roots.splice(i,1)},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}();const jxe=Uxe;var qne;qne=vr.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};const O$=qne;var XT={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return .5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},exponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)))},elasticOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},elasticInOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)):r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-XT.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?XT.bounceIn(e*2)*.5:XT.bounceOut(e*2-1)*.5+.5}};const Zne=XT;var GC=Math.pow,Jf=Math.sqrt,iE=1e-8,Jne=1e-4,s6=Jf(3),YC=1/3,ul=Pm(),Lo=Pm(),zp=Pm();function Uf(e){return e>-iE&&e<iE}function Qne(e){return e>iE||e<-iE}function si(e,t,r,n,i){var a=1-i;return a*a*(a*e+3*i*t)+i*i*(i*n+3*a*r)}function l6(e,t,r,n,i){var a=1-i;return 3*(((t-e)*a+2*(r-t)*i)*a+(n-r)*i*i)}function aE(e,t,r,n,i,a){var o=n+3*(t-r)-e,s=3*(r-t*2+e),l=3*(t-e),u=e-i,f=s*s-3*o*l,c=s*l-9*o*u,h=l*l-3*s*u,d=0;if(Uf(f)&&Uf(c))if(Uf(s))a[0]=0;else{var v=-l/s;v>=0&&v<=1&&(a[d++]=v)}else{var g=c*c-4*f*h;if(Uf(g)){var y=c/f,v=-s/o+y,b=-y/2;v>=0&&v<=1&&(a[d++]=v),b>=0&&b<=1&&(a[d++]=b)}else if(g>0){var w=Jf(g),_=f*s+1.5*o*(-c+w),x=f*s+1.5*o*(-c-w);_<0?_=-GC(-_,YC):_=GC(_,YC),x<0?x=-GC(-x,YC):x=GC(x,YC);var v=(-s-(_+x))/(3*o);v>=0&&v<=1&&(a[d++]=v)}else{var E=(2*f*s-3*o*c)/(2*Jf(f*f*f)),R=Math.acos(E)/3,A=Jf(f),N=Math.cos(R),v=(-s-2*A*N)/(3*o),b=(-s+A*(N+s6*Math.sin(R)))/(3*o),I=(-s+A*(N-s6*Math.sin(R)))/(3*o);v>=0&&v<=1&&(a[d++]=v),b>=0&&b<=1&&(a[d++]=b),I>=0&&I<=1&&(a[d++]=I)}}return d}function eie(e,t,r,n,i){var a=6*r-12*t+6*e,o=9*t+3*n-3*e-9*r,s=3*t-3*e,l=0;if(Uf(o)){if(Qne(a)){var u=-s/a;u>=0&&u<=1&&(i[l++]=u)}}else{var f=a*a-4*o*s;if(Uf(f))i[0]=-a/(2*o);else if(f>0){var c=Jf(f),u=(-a+c)/(2*o),h=(-a-c)/(2*o);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function oE(e,t,r,n,i,a){var o=(t-e)*i+e,s=(r-t)*i+t,l=(n-r)*i+r,u=(s-o)*i+o,f=(l-s)*i+s,c=(f-u)*i+u;a[0]=e,a[1]=o,a[2]=u,a[3]=c,a[4]=c,a[5]=f,a[6]=l,a[7]=n}function zxe(e,t,r,n,i,a,o,s,l,u,f){var c,h=.005,d=1/0,v,g,y,b;ul[0]=l,ul[1]=u;for(var w=0;w<1;w+=.05)Lo[0]=si(e,r,i,o,w),Lo[1]=si(t,n,a,s,w),y=Up(ul,Lo),y<d&&(c=w,d=y);d=1/0;for(var _=0;_<32&&!(h<Jne);_++)v=c-h,g=c+h,Lo[0]=si(e,r,i,o,v),Lo[1]=si(t,n,a,s,v),y=Up(Lo,ul),v>=0&&y<d?(c=v,d=y):(zp[0]=si(e,r,i,o,g),zp[1]=si(t,n,a,s,g),b=Up(zp,ul),g<=1&&b<d?(c=g,d=b):h*=.5);return f&&(f[0]=si(e,r,i,o,c),f[1]=si(t,n,a,s,c)),Jf(d)}function Gxe(e,t,r,n,i,a,o,s,l){for(var u=e,f=t,c=0,h=1/l,d=1;d<=l;d++){var v=d*h,g=si(e,r,i,o,v),y=si(t,n,a,s,v),b=g-u,w=y-f;c+=Math.sqrt(b*b+w*w),u=g,f=y}return c}function Ii(e,t,r,n){var i=1-n;return i*(i*e+2*n*t)+n*n*r}function u6(e,t,r,n){return 2*((1-n)*(t-e)+n*(r-t))}function Yxe(e,t,r,n,i){var a=e-2*t+r,o=2*(t-e),s=e-n,l=0;if(Uf(a)){if(Qne(o)){var u=-s/o;u>=0&&u<=1&&(i[l++]=u)}}else{var f=o*o-4*a*s;if(Uf(f)){var u=-o/(2*a);u>=0&&u<=1&&(i[l++]=u)}else if(f>0){var c=Jf(f),u=(-o+c)/(2*a),h=(-o-c)/(2*a);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function tie(e,t,r){var n=e+r-2*t;return n===0?.5:(e-t)/n}function sE(e,t,r,n,i){var a=(t-e)*n+e,o=(r-t)*n+t,s=(o-a)*n+a;i[0]=e,i[1]=a,i[2]=s,i[3]=s,i[4]=o,i[5]=r}function Kxe(e,t,r,n,i,a,o,s,l){var u,f=.005,c=1/0;ul[0]=o,ul[1]=s;for(var h=0;h<1;h+=.05){Lo[0]=Ii(e,r,i,h),Lo[1]=Ii(t,n,a,h);var d=Up(ul,Lo);d<c&&(u=h,c=d)}c=1/0;for(var v=0;v<32&&!(f<Jne);v++){var g=u-f,y=u+f;Lo[0]=Ii(e,r,i,g),Lo[1]=Ii(t,n,a,g);var d=Up(Lo,ul);if(g>=0&&d<c)u=g,c=d;else{zp[0]=Ii(e,r,i,y),zp[1]=Ii(t,n,a,y);var b=Up(zp,ul);y<=1&&b<c?(u=y,c=b):f*=.5}}return l&&(l[0]=Ii(e,r,i,u),l[1]=Ii(t,n,a,u)),Jf(c)}function Xxe(e,t,r,n,i,a,o){for(var s=e,l=t,u=0,f=1/o,c=1;c<=o;c++){var h=c*f,d=Ii(e,r,i,h),v=Ii(t,n,a,h),g=d-s,y=v-l;u+=Math.sqrt(g*g+y*y),s=d,l=v}return u}var qxe=/cubic-bezier\(([0-9,\.e ]+)\)/;function rie(e){var t=e&&qxe.exec(e);if(t){var r=t[1].split(","),n=+dl(r[0]),i=+dl(r[1]),a=+dl(r[2]),o=+dl(r[3]);if(isNaN(n+i+a+o))return;var s=[];return function(l){return l<=0?0:l>=1?1:aE(0,n,a,1,l,s)&&si(0,i,o,1,s[0])}}}var Zxe=function(){function e(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||Na,this.ondestroy=t.ondestroy||Na,this.onrestart=t.onrestart||Na,t.easing&&this.setEasing(t.easing)}return e.prototype.step=function(t,r){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=r;return}var n=this._life,i=t-this._startTime-this._pausedTime,a=i/n;a<0&&(a=0),a=Math.min(a,1);var o=this.easingFunc,s=o?o(a):a;if(this.onframe(s),a===1)if(this.loop){var l=i%n;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(t){this.easing=t,this.easingFunc=lr(t)?t:Zne[t]||rie(t)},e}();const Jxe=Zxe;var nie=function(){function e(t){this.value=t}return e}(),Qxe=function(){function e(){this._len=0}return e.prototype.insert=function(t){var r=new nie(t);return this.insertEntry(r),r},e.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},e.prototype.remove=function(t){var r=t.prev,n=t.next;r?r.next=n:this.head=n,n?n.prev=r:this.tail=r,t.next=t.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),eTe=function(){function e(t){this._list=new Qxe,this._maxSize=10,this._map={},this._maxSize=t}return e.prototype.put=function(t,r){var n=this._list,i=this._map,a=null;if(i[t]==null){var o=n.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var l=n.head;n.remove(l),delete i[l.key],a=l.value,this._lastRemovedEntry=l}s?s.value=r:s=new nie(r),s.key=t,n.insertEntry(s),i[t]=s}return a},e.prototype.get=function(t){var r=this._map[t],n=this._list;if(r!=null)return r!==n.tail&&(n.remove(r),n.insertEntry(r)),r.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}();const qS=eTe;var f6={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Qf(e){return e=Math.round(e),e<0?0:e>255?255:e}function E$(e){return e<0?0:e>1?1:e}function bI(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?Qf(parseFloat(t)/100*255):Qf(parseInt(t,10))}function $b(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?E$(parseFloat(t)/100):E$(parseFloat(t))}function wI(e,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?e+(t-e)*r*6:r*2<1?t:r*3<2?e+(t-e)*(2/3-r)*6:e}function KC(e,t,r){return e+(t-e)*r}function ko(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function R$(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var iie=new qS(20),XC=null;function Iv(e,t){XC&&R$(XC,t),XC=iie.put(e,XC||t.slice())}function $u(e,t){if(e){t=t||[];var r=iie.get(e);if(r)return R$(t,r);e=e+"";var n=e.replace(/ /g,"").toLowerCase();if(n in f6)return R$(t,f6[n]),Iv(e,t),t;var i=n.length;if(n.charAt(0)==="#"){if(i===4||i===5){var a=parseInt(n.slice(1,4),16);if(!(a>=0&&a<=4095)){ko(t,0,0,0,1);return}return ko(t,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,i===5?parseInt(n.slice(4),16)/15:1),Iv(e,t),t}else if(i===7||i===9){var a=parseInt(n.slice(1,7),16);if(!(a>=0&&a<=16777215)){ko(t,0,0,0,1);return}return ko(t,(a&16711680)>>16,(a&65280)>>8,a&255,i===9?parseInt(n.slice(7),16)/255:1),Iv(e,t),t}return}var o=n.indexOf("("),s=n.indexOf(")");if(o!==-1&&s+1===i){var l=n.substr(0,o),u=n.substr(o+1,s-(o+1)).split(","),f=1;switch(l){case"rgba":if(u.length!==4)return u.length===3?ko(t,+u[0],+u[1],+u[2],1):ko(t,0,0,0,1);f=$b(u.pop());case"rgb":if(u.length>=3)return ko(t,bI(u[0]),bI(u[1]),bI(u[2]),u.length===3?f:$b(u[3])),Iv(e,t),t;ko(t,0,0,0,1);return;case"hsla":if(u.length!==4){ko(t,0,0,0,1);return}return u[3]=$b(u[3]),c6(u,t),Iv(e,t),t;case"hsl":if(u.length!==3){ko(t,0,0,0,1);return}return c6(u,t),Iv(e,t),t;default:return}}ko(t,0,0,0,1)}}function c6(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=$b(e[1]),i=$b(e[2]),a=i<=.5?i*(n+1):i+n-i*n,o=i*2-a;return t=t||[],ko(t,Qf(wI(o,a,r+1/3)*255),Qf(wI(o,a,r)*255),Qf(wI(o,a,r-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function h6(e,t){var r=$u(e);if(r){for(var n=0;n<3;n++)t<0?r[n]=r[n]*(1-t)|0:r[n]=(255-r[n])*t+r[n]|0,r[n]>255?r[n]=255:r[n]<0&&(r[n]=0);return uk(r,r.length===4?"rgba":"rgb")}}function tTe(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=$u(t[i]),s=$u(t[a]),l=n-i,u=uk([Qf(KC(o[0],s[0],l)),Qf(KC(o[1],s[1],l)),Qf(KC(o[2],s[2],l)),E$(KC(o[3],s[3],l))],"rgba");return r?{color:u,leftIndex:i,rightIndex:a,value:n}:u}}function uk(e,t){if(!(!e||!e.length)){var r=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+e[3]),t+"("+r+")"}}function lE(e,t){var r=$u(e);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*t:0}function rTe(e){return e.type==="linear"}function nTe(e){return e.type==="radial"}(function(){return vr.hasGlobalWindow&&lr(window.btoa)?function(e){return window.btoa(unescape(encodeURIComponent(e)))}:typeof Buffer<"u"?function(e){return Buffer.from(e).toString("base64")}:function(e){return null}})();var k$=Array.prototype.slice;function ql(e,t,r){return(t-e)*r+e}function _I(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=ql(t[a],r[a],n);return e}function iTe(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=ql(t[o][s],r[o][s],n)}return e}function qC(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=t[a]+r[a]*n;return e}function d6(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=t[o][s]+r[o][s]*n}return e}function aTe(e,t){for(var r=e.length,n=t.length,i=r>n?t:e,a=Math.min(r,n),o=i[a-1]||{color:[0,0,0,0],offset:0},s=a;s<Math.max(r,n);s++)i.push({offset:o.offset,color:o.color.slice()})}function oTe(e,t,r){var n=e,i=t;if(!(!n.push||!i.push)){var a=n.length,o=i.length;if(a!==o){var s=a>o;if(s)n.length=o;else for(var l=a;l<o;l++)n.push(r===1?i[l]:k$.call(i[l]))}for(var u=n[0]&&n[0].length,l=0;l<n.length;l++)if(r===1)isNaN(n[l])&&(n[l]=i[l]);else for(var f=0;f<u;f++)isNaN(n[l][f])&&(n[l][f]=i[l][f])}}function qT(e){if(Fa(e)){var t=e.length;if(Fa(e[0])){for(var r=[],n=0;n<t;n++)r.push(k$.call(e[n]));return r}return k$.call(e)}return e}function ZT(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=e[3]==null?1:e[3],"rgba("+e.join(",")+")"}function sTe(e){return Fa(e&&e[0])?2:1}var ZC=0,JT=1,aie=2,pb=3,A$=4,P$=5,v6=6;function p6(e){return e===A$||e===P$}function JC(e){return e===JT||e===aie}var b0=[0,0,0,0],lTe=function(){function e(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(t,r,n){this._needsSort=!0;var i=this.keyframes,a=i.length,o=!1,s=v6,l=r;if(Fa(r)){var u=sTe(r);s=u,(u===1&&!en(r[0])||u===2&&!en(r[0][0]))&&(o=!0)}else if(en(r)&&!nE(r))s=ZC;else if(Rt(r))if(!isNaN(+r))s=ZC;else{var f=$u(r);f&&(l=f,s=pb)}else if(sk(r)){var c=et({},l);c.colorStops=Lt(r.colorStops,function(d){return{offset:d.offset,color:$u(d.color)}}),rTe(r)?s=A$:nTe(r)&&(s=P$),l=c}a===0?this.valType=s:(s!==this.valType||s===v6)&&(o=!0),this.discrete=this.discrete||o;var h={time:t,value:l,rawValue:r,percent:0};return n&&(h.easing=n,h.easingFunc=lr(n)?n:Zne[n]||rie(n)),i.push(h),h},e.prototype.prepare=function(t,r){var n=this.keyframes;this._needsSort&&n.sort(function(g,y){return g.time-y.time});for(var i=this.valType,a=n.length,o=n[a-1],s=this.discrete,l=JC(i),u=p6(i),f=0;f<a;f++){var c=n[f],h=c.value,d=o.value;c.percent=c.time/t,s||(l&&f!==a-1?oTe(h,d,i):u&&aTe(h.colorStops,d.colorStops))}if(!s&&i!==P$&&r&&this.needsAnimate()&&r.needsAnimate()&&i===r.valType&&!r._finished){this._additiveTrack=r;for(var v=n[0].value,f=0;f<a;f++)i===ZC?n[f].additiveValue=n[f].value-v:i===pb?n[f].additiveValue=qC([],n[f].value,v,-1):JC(i)&&(n[f].additiveValue=i===JT?qC([],n[f].value,v,-1):d6([],n[f].value,v,-1))}},e.prototype.step=function(t,r){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var n=this._additiveTrack!=null,i=n?"additiveValue":"value",a=this.valType,o=this.keyframes,s=o.length,l=this.propName,u=a===pb,f,c=this._lastFr,h=Math.min,d,v;if(s===1)d=v=o[0];else{if(r<0)f=0;else if(r<this._lastFrP){var g=h(c+1,s-1);for(f=g;f>=0&&!(o[f].percent<=r);f--);f=h(f,s-2)}else{for(f=c;f<s&&!(o[f].percent>r);f++);f=h(f-1,s-2)}v=o[f+1],d=o[f]}if(d&&v){this._lastFr=f,this._lastFrP=r;var y=v.percent-d.percent,b=y===0?1:h((r-d.percent)/y,1);v.easingFunc&&(b=v.easingFunc(b));var w=n?this._additiveValue:u?b0:t[l];if((JC(a)||u)&&!w&&(w=this._additiveValue=[]),this.discrete)t[l]=b<1?d.rawValue:v.rawValue;else if(JC(a))a===JT?_I(w,d[i],v[i],b):iTe(w,d[i],v[i],b);else if(p6(a)){var _=d[i],x=v[i],E=a===A$;t[l]={type:E?"linear":"radial",x:ql(_.x,x.x,b),y:ql(_.y,x.y,b),colorStops:Lt(_.colorStops,function(A,N){var I=x.colorStops[N];return{offset:ql(A.offset,I.offset,b),color:ZT(_I([],A.color,I.color,b))}}),global:x.global},E?(t[l].x2=ql(_.x2,x.x2,b),t[l].y2=ql(_.y2,x.y2,b)):t[l].r=ql(_.r,x.r,b)}else if(u)_I(w,d[i],v[i],b),n||(t[l]=ZT(w));else{var R=ql(d[i],v[i],b);n?this._additiveValue=R:t[l]=R}n&&this._addToTarget(t)}}},e.prototype._addToTarget=function(t){var r=this.valType,n=this.propName,i=this._additiveValue;r===ZC?t[n]=t[n]+i:r===pb?($u(t[n],b0),qC(b0,b0,i,1),t[n]=ZT(b0)):r===JT?qC(t[n],t[n],i,1):r===aie&&d6(t[n],t[n],i,1)},e}(),uTe=function(){function e(t,r,n,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=r,r&&i){GB("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=n}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(t){this._target=t},e.prototype.when=function(t,r,n){return this.whenWithKeys(t,r,yn(r),n)},e.prototype.whenWithKeys=function(t,r,n,i){for(var a=this._tracks,o=0;o<n.length;o++){var s=n[o],l=a[s];if(!l){l=a[s]=new lTe(s);var u=void 0,f=this._getAdditiveTrack(s);if(f){var c=f.keyframes,h=c[c.length-1];u=h&&h.value,f.valType===pb&&u&&(u=ZT(u))}else u=this._target[s];if(u==null)continue;t>0&&l.addKeyframe(0,qT(u),i),this._trackKeys.push(s)}l.addKeyframe(t,qT(r[s]),i)}return this._maxTime=Math.max(this._maxTime,t),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var r=t.length,n=0;n<r;n++)t[n].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,r=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,r)for(var n=0;n<r.length;n++)r[n].call(this)},e.prototype._setTracksFinished=function(){for(var t=this._tracks,r=this._trackKeys,n=0;n<r.length;n++)t[r[n]].setFinished()},e.prototype._getAdditiveTrack=function(t){var r,n=this._additiveAnimators;if(n)for(var i=0;i<n.length;i++){var a=n[i].getTrack(t);a&&(r=a)}return r},e.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var r=this,n=[],i=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var o=this._trackKeys[a],s=this._tracks[o],l=this._getAdditiveTrack(o),u=s.keyframes,f=u.length;if(s.prepare(i,l),s.needsAnimate())if(!this._allowDiscrete&&s.discrete){var c=u[f-1];c&&(r._target[s.propName]=c.rawValue),s.setFinished()}else n.push(s)}if(n.length||this._force){var h=new Jxe({life:i,loop:this._loop,delay:this._delay||0,onframe:function(d){r._started=2;var v=r._additiveAnimators;if(v){for(var g=!1,y=0;y<v.length;y++)if(v[y]._clip){g=!0;break}g||(r._additiveAnimators=null)}for(var y=0;y<n.length;y++)n[y].step(r._target,d);var b=r._onframeCbs;if(b)for(var y=0;y<b.length;y++)b[y](r._target,d)},ondestroy:function(){r._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),t&&h.setEasing(t)}else this._doneCallback();return this}},e.prototype.stop=function(t){if(this._clip){var r=this._clip;t&&r.onframe(1),this._abortedCallback()}},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},e.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},e.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(t){return this._tracks[t]},e.prototype.getTracks=function(){var t=this;return Lt(this._trackKeys,function(r){return t._tracks[r]})},e.prototype.stopTracks=function(t,r){if(!t.length||!this._clip)return!0;for(var n=this._tracks,i=this._trackKeys,a=0;a<t.length;a++){var o=n[t[a]];o&&!o.isFinished()&&(r?o.step(this._target,1):this._started===1&&o.step(this._target,0),o.setFinished())}for(var s=!0,a=0;a<i.length;a++)if(!n[i[a]].isFinished()){s=!1;break}return s&&this._abortedCallback(),s},e.prototype.saveTo=function(t,r,n){if(t){r=r||this._trackKeys;for(var i=0;i<r.length;i++){var a=r[i],o=this._tracks[a];if(!(!o||o.isFinished())){var s=o.keyframes,l=s[n?0:s.length-1];l&&(t[a]=qT(l.rawValue))}}}},e.prototype.__changeFinalValue=function(t,r){r=r||yn(t);for(var n=0;n<r.length;n++){var i=r[n],a=this._tracks[i];if(a){var o=a.keyframes;if(o.length>1){var s=o.pop();a.addKeyframe(s.time,t[i]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},e}();const JB=uTe;function Ip(){return new Date().getTime()}var fTe=function(e){ct(t,e);function t(r){var n=e.call(this)||this;return n._running=!1,n._time=0,n._pausedTime=0,n._pauseStart=0,n._paused=!1,r=r||{},n.stage=r.stage||{},n}return t.prototype.addClip=function(r){r.animation&&this.removeClip(r),this._head?(this._tail.next=r,r.prev=this._tail,r.next=null,this._tail=r):this._head=this._tail=r,r.animation=this},t.prototype.addAnimator=function(r){r.animation=this;var n=r.getClip();n&&this.addClip(n)},t.prototype.removeClip=function(r){if(r.animation){var n=r.prev,i=r.next;n?n.next=i:this._head=i,i?i.prev=n:this._tail=n,r.next=r.prev=r.animation=null}},t.prototype.removeAnimator=function(r){var n=r.getClip();n&&this.removeClip(n),r.animation=null},t.prototype.update=function(r){for(var n=Ip()-this._pausedTime,i=n-this._time,a=this._head;a;){var o=a.next,s=a.step(n,i);s&&(a.ondestroy(),this.removeClip(a)),a=o}this._time=n,r||(this.trigger("frame",i),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var r=this;this._running=!0;function n(){r._running&&(O$(n),!r._paused&&r.update())}O$(n)},t.prototype.start=function(){this._running||(this._time=Ip(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=Ip(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=Ip()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var r=this._head;r;){var n=r.next;r.prev=r.next=r.animation=null,r=n}this._head=this._tail=null},t.prototype.isFinished=function(){return this._head==null},t.prototype.animate=function(r,n){n=n||{},this.start();var i=new JB(r,n.loop);return this.addAnimator(i),i},t}(Cl);const cTe=fTe;var hTe=300,SI=vr.domSupported,CI=function(){var e=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t=["touchstart","touchend","touchmove"],r={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},n=Lt(e,function(i){var a=i.replace("mouse","pointer");return r.hasOwnProperty(a)?a:i});return{mouse:e,touch:t,pointer:n}}(),g6={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},y6=!1;function I$(e){var t=e.pointerType;return t==="pen"||t==="touch"}function dTe(e){e.touching=!0,e.touchTimer!=null&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout(function(){e.touching=!1,e.touchTimer=null},700)}function xI(e){e&&(e.zrByTouch=!0)}function vTe(e,t){return Po(e.dom,new pTe(e,t),!0)}function oie(e,t){for(var r=t,n=!1;r&&r.nodeType!==9&&!(n=r.domBelongToZr||r!==t&&r===e.painterRoot);)r=r.parentNode;return n}var pTe=function(){function e(t,r){this.stopPropagation=Na,this.stopImmediatePropagation=Na,this.preventDefault=Na,this.type=r.type,this.target=this.currentTarget=t.dom,this.pointerType=r.pointerType,this.clientX=r.clientX,this.clientY=r.clientY}return e}(),ys={mousedown:function(e){e=Po(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=Po(this.dom,e);var t=this.__mayPointerCapture;t&&(e.zrX!==t[0]||e.zrY!==t[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=Po(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){e=Po(this.dom,e);var t=e.toElement||e.relatedTarget;oie(this,t)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){y6=!0,e=Po(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){y6||(e=Po(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){e=Po(this.dom,e),xI(e),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),ys.mousemove.call(this,e),ys.mousedown.call(this,e)},touchmove:function(e){e=Po(this.dom,e),xI(e),this.handler.processGesture(e,"change"),ys.mousemove.call(this,e)},touchend:function(e){e=Po(this.dom,e),xI(e),this.handler.processGesture(e,"end"),ys.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<hTe&&ys.click.call(this,e)},pointerdown:function(e){ys.mousedown.call(this,e)},pointermove:function(e){I$(e)||ys.mousemove.call(this,e)},pointerup:function(e){ys.mouseup.call(this,e)},pointerout:function(e){I$(e)||ys.mouseout.call(this,e)}};ye(["click","dblclick","contextmenu"],function(e){ys[e]=function(t){t=Po(this.dom,t),this.trigger(e,t)}});var M$={pointermove:function(e){I$(e)||M$.mousemove.call(this,e)},pointerup:function(e){M$.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function gTe(e,t){var r=t.domHandlers;vr.pointerEventsSupported?ye(CI.pointer,function(n){QT(t,n,function(i){r[n].call(e,i)})}):(vr.touchEventsSupported&&ye(CI.touch,function(n){QT(t,n,function(i){r[n].call(e,i),dTe(t)})}),ye(CI.mouse,function(n){QT(t,n,function(i){i=KB(i),t.touching||r[n].call(e,i)})}))}function yTe(e,t){vr.pointerEventsSupported?ye(g6.pointer,r):vr.touchEventsSupported||ye(g6.mouse,r);function r(n){function i(a){a=KB(a),oie(e,a.target)||(a=vTe(e,a),t.domHandlers[n].call(e,a))}QT(t,n,i,{capture:!0})}}function QT(e,t,r,n){e.mounted[t]=r,e.listenerOpts[t]=n,Oxe(e.domTarget,t,r,n)}function TI(e){var t=e.mounted;for(var r in t)t.hasOwnProperty(r)&&Exe(e.domTarget,r,t[r],e.listenerOpts[r]);e.mounted={}}var m6=function(){function e(t,r){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=r}return e}(),mTe=function(e){ct(t,e);function t(r,n){var i=e.call(this)||this;return i.__pointerCapturing=!1,i.dom=r,i.painterRoot=n,i._localHandlerScope=new m6(r,ys),SI&&(i._globalHandlerScope=new m6(document,M$)),gTe(i,i._localHandlerScope),i}return t.prototype.dispose=function(){TI(this._localHandlerScope),SI&&TI(this._globalHandlerScope)},t.prototype.setCursor=function(r){this.dom.style&&(this.dom.style.cursor=r||"default")},t.prototype.__togglePointerCapture=function(r){if(this.__mayPointerCapture=null,SI&&+this.__pointerCapturing^+r){this.__pointerCapturing=r;var n=this._globalHandlerScope;r?yTe(this,n):TI(n)}},t}(Cl);const bTe=mTe;var sie=1;vr.hasGlobalWindow&&(sie=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var uE=sie,D$=.4,$$="#333",N$="#ccc",wTe="#eee",b6=XB,w6=5e-5;function Zc(e){return e>w6||e<-w6}var Jc=[],Mv=[],OI=ww(),EI=Math.abs,QB=function(){function e(){}return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},e.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},e.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},e.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},e.prototype.needLocalTransform=function(){return Zc(this.rotation)||Zc(this.x)||Zc(this.y)||Zc(this.scaleX-1)||Zc(this.scaleY-1)||Zc(this.skewX)||Zc(this.skewY)},e.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,r=this.needLocalTransform(),n=this.transform;if(!(r||t)){n&&b6(n);return}n=n||ww(),r?this.getLocalTransform(n):b6(n),t&&(r?jp(n,t,n):Axe(n,t)),this.transform=n,this._resolveGlobalScaleRatio(n)},e.prototype._resolveGlobalScaleRatio=function(t){var r=this.globalScaleRatio;if(r!=null&&r!==1){this.getGlobalScale(Jc);var n=Jc[0]<0?-1:1,i=Jc[1]<0?-1:1,a=((Jc[0]-n)*r+n)/Jc[0]||0,o=((Jc[1]-i)*r+i)/Jc[1]||0;t[0]*=a,t[1]*=a,t[2]*=o,t[3]*=o}this.invTransform=this.invTransform||ww(),ZB(this.invTransform,t)},e.prototype.getComputedTransform=function(){for(var t=this,r=[];t;)r.push(t),t=t.parent;for(;t=r.pop();)t.updateTransform();return this.transform},e.prototype.setLocalTransform=function(t){if(t){var r=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],i=Math.atan2(t[1],t[0]),a=Math.PI/2+i-Math.atan2(t[3],t[2]);n=Math.sqrt(n)*Math.cos(a),r=Math.sqrt(r),this.skewX=a,this.skewY=0,this.rotation=-i,this.x=+t[4],this.y=+t[5],this.scaleX=r,this.scaleY=n,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,r=this.transform;t&&t.transform&&(jp(Mv,t.invTransform,r),r=Mv);var n=this.originX,i=this.originY;(n||i)&&(OI[4]=n,OI[5]=i,jp(Mv,r,OI),Mv[4]-=n,Mv[5]-=i,r=Mv),this.setLocalTransform(r)}},e.prototype.getGlobalScale=function(t){var r=this.transform;return t=t||[],r?(t[0]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),t[1]=Math.sqrt(r[2]*r[2]+r[3]*r[3]),r[0]<0&&(t[0]=-t[0]),r[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},e.prototype.transformCoordToLocal=function(t,r){var n=[t,r],i=this.invTransform;return i&&jo(n,n,i),n},e.prototype.transformCoordToGlobal=function(t,r){var n=[t,r],i=this.transform;return i&&jo(n,n,i),n},e.prototype.getLineScale=function(){var t=this.transform;return t&&EI(t[0]-1)>1e-10&&EI(t[3]-1)>1e-10?Math.sqrt(EI(t[0]*t[3]-t[2]*t[1])):1},e.prototype.copyTransform=function(t){_Te(this,t)},e.getLocalTransform=function(t,r){r=r||[];var n=t.originX||0,i=t.originY||0,a=t.scaleX,o=t.scaleY,s=t.anchorX,l=t.anchorY,u=t.rotation||0,f=t.x,c=t.y,h=t.skewX?Math.tan(t.skewX):0,d=t.skewY?Math.tan(-t.skewY):0;if(n||i||s||l){var v=n+s,g=i+l;r[4]=-v*a-h*g*o,r[5]=-g*o-d*v*a}else r[4]=r[5]=0;return r[0]=a,r[3]=o,r[1]=d*a,r[2]=h*o,u&&qB(r,r,u),r[4]+=n+f,r[5]+=i+c,r},e.initDefaultProps=function(){var t=e.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),e}(),_w=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function _Te(e,t){for(var r=0;r<_w.length;r++){var n=_w[r];e[n]=t[n]}}var _6={};function oo(e,t){t=t||Od;var r=_6[t];r||(r=_6[t]=new qS(500));var n=r.get(e);return n==null&&(n=Am.measureText(e,t).width,r.put(e,n)),n}function S6(e,t,r,n){var i=oo(e,t),a=t3(t),o=gb(0,i,r),s=Cp(0,a,n),l=new Br(o,s,i,a);return l}function e3(e,t,r,n){var i=((e||"")+"").split(`
`),a=i.length;if(a===1)return S6(i[0],t,r,n);for(var o=new Br(0,0,0,0),s=0;s<i.length;s++){var l=S6(i[s],t,r,n);s===0?o.copy(l):o.union(l)}return o}function gb(e,t,r){return r==="right"?e-=t:r==="center"&&(e-=t/2),e}function Cp(e,t,r){return r==="middle"?e-=t/2:r==="bottom"&&(e-=t),e}function t3(e){return oo("国",e)}function wc(e,t){return typeof e=="string"?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function fE(e,t,r){var n=t.position||"inside",i=t.distance!=null?t.distance:5,a=r.height,o=r.width,s=a/2,l=r.x,u=r.y,f="left",c="top";if(n instanceof Array)l+=wc(n[0],r.width),u+=wc(n[1],r.height),f=null,c=null;else switch(n){case"left":l-=i,u+=s,f="right",c="middle";break;case"right":l+=i+o,u+=s,c="middle";break;case"top":l+=o/2,u-=i,f="center",c="bottom";break;case"bottom":l+=o/2,u+=a+i,f="center";break;case"inside":l+=o/2,u+=s,f="center",c="middle";break;case"insideLeft":l+=i,u+=s,c="middle";break;case"insideRight":l+=o-i,u+=s,f="right",c="middle";break;case"insideTop":l+=o/2,u+=i,f="center";break;case"insideBottom":l+=o/2,u+=a-i,f="center",c="bottom";break;case"insideTopLeft":l+=i,u+=i;break;case"insideTopRight":l+=o-i,u+=i,f="right";break;case"insideBottomLeft":l+=i,u+=a-i,c="bottom";break;case"insideBottomRight":l+=o-i,u+=a-i,f="right",c="bottom";break}return e=e||{},e.x=l,e.y=u,e.align=f,e.verticalAlign=c,e}var RI="__zr_normal__",kI=_w.concat(["ignore"]),STe=bc(_w,function(e,t){return e[t]=!0,e},{ignore:!1}),Dv={},CTe=new Br(0,0,0,0),r3=function(){function e(t){this.id=Hne(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return e.prototype._init=function(t){this.attr(t)},e.prototype.drift=function(t,r,n){switch(this.draggable){case"horizontal":r=0;break;case"vertical":t=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=r,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(t){var r=this._textContent;if(r&&(!r.ignore||t)){this.textConfig||(this.textConfig={});var n=this.textConfig,i=n.local,a=r.innerTransformable,o=void 0,s=void 0,l=!1;a.parent=i?this:null;var u=!1;if(a.copyTransform(r),n.position!=null){var f=CTe;n.layoutRect?f.copy(n.layoutRect):f.copy(this.getBoundingRect()),i||f.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(Dv,n,f):fE(Dv,n,f),a.x=Dv.x,a.y=Dv.y,o=Dv.align,s=Dv.verticalAlign;var c=n.origin;if(c&&n.rotation!=null){var h=void 0,d=void 0;c==="center"?(h=f.width*.5,d=f.height*.5):(h=wc(c[0],f.width),d=wc(c[1],f.height)),u=!0,a.originX=-a.x+h+(i?0:f.x),a.originY=-a.y+d+(i?0:f.y)}}n.rotation!=null&&(a.rotation=n.rotation);var v=n.offset;v&&(a.x+=v[0],a.y+=v[1],u||(a.originX=-v[0],a.originY=-v[1]));var g=n.inside==null?typeof n.position=="string"&&n.position.indexOf("inside")>=0:n.inside,y=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),b=void 0,w=void 0,_=void 0;g&&this.canBeInsideText()?(b=n.insideFill,w=n.insideStroke,(b==null||b==="auto")&&(b=this.getInsideTextFill()),(w==null||w==="auto")&&(w=this.getInsideTextStroke(b),_=!0)):(b=n.outsideFill,w=n.outsideStroke,(b==null||b==="auto")&&(b=this.getOutsideFill()),(w==null||w==="auto")&&(w=this.getOutsideStroke(b),_=!0)),b=b||"#000",(b!==y.fill||w!==y.stroke||_!==y.autoStroke||o!==y.align||s!==y.verticalAlign)&&(l=!0,y.fill=b,y.stroke=w,y.autoStroke=_,y.align=o,y.verticalAlign=s,r.setDefaultTextStyle(y)),r.__dirty|=ro,l&&r.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(t){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?N$:$$},e.prototype.getOutsideStroke=function(t){var r=this.__zr&&this.__zr.getBackgroundColor(),n=typeof r=="string"&&$u(r);n||(n=[255,255,255,1]);for(var i=n[3],a=this.__zr.isDarkMode(),o=0;o<3;o++)n[o]=n[o]*i+(a?0:255)*(1-i);return n[3]=1,uk(n,"rgba")},e.prototype.traverse=function(t,r){},e.prototype.attrKV=function(t,r){t==="textConfig"?this.setTextConfig(r):t==="textContent"?this.setTextContent(r):t==="clipPath"?this.setClipPath(r):t==="extra"?(this.extra=this.extra||{},et(this.extra,r)):this[t]=r},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(t,r){if(typeof t=="string")this.attrKV(t,r);else if($t(t))for(var n=t,i=yn(n),a=0;a<i.length;a++){var o=i[a];this.attrKV(o,t[o])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var r=this._normalState,n=0;n<this.animators.length;n++){var i=this.animators[n],a=i.__fromStateTransition;if(!(i.getLoop()||a&&a!==RI)){var o=i.targetName,s=o?r[o]:r;i.saveTo(s)}}},e.prototype._innerSaveToNormal=function(t){var r=this._normalState;r||(r=this._normalState={}),t.textConfig&&!r.textConfig&&(r.textConfig=this.textConfig),this._savePrimaryToNormal(t,r,kI)},e.prototype._savePrimaryToNormal=function(t,r,n){for(var i=0;i<n.length;i++){var a=n[i];t[a]!=null&&!(a in r)&&(r[a]=this[a])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(t){return this.states[t]},e.prototype.ensureState=function(t){var r=this.states;return r[t]||(r[t]={}),r[t]},e.prototype.clearStates=function(t){this.useState(RI,!1,t)},e.prototype.useState=function(t,r,n,i){var a=t===RI,o=this.hasState();if(!(!o&&a)){var s=this.currentStates,l=this.stateTransition;if(!(Xr(s,t)>=0&&(r||s.length===1))){var u;if(this.stateProxy&&!a&&(u=this.stateProxy(t)),u||(u=this.states&&this.states[t]),!u&&!a){GB("State "+t+" not exists.");return}a||this.saveCurrentToNormalState(u);var f=!!(u&&u.hoverLayer||i);f&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,u,this._normalState,r,!n&&!this.__inHover&&l&&l.duration>0,l);var c=this._textContent,h=this._textGuide;return c&&c.useState(t,r,n,f),h&&h.useState(t,r,n,f),a?(this.currentStates=[],this._normalState={}):r?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!f&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~ro),u}}},e.prototype.useStates=function(t,r,n){if(!t.length)this.clearStates();else{var i=[],a=this.currentStates,o=t.length,s=o===a.length;if(s){for(var l=0;l<o;l++)if(t[l]!==a[l]){s=!1;break}}if(s)return;for(var l=0;l<o;l++){var u=t[l],f=void 0;this.stateProxy&&(f=this.stateProxy(u,t)),f||(f=this.states[u]),f&&i.push(f)}var c=i[o-1],h=!!(c&&c.hoverLayer||n);h&&this._toggleHoverLayerFlag(!0);var d=this._mergeStates(i),v=this.stateTransition;this.saveCurrentToNormalState(d),this._applyStateObj(t.join(","),d,this._normalState,!1,!r&&!this.__inHover&&v&&v.duration>0,v);var g=this._textContent,y=this._textGuide;g&&g.useStates(t,r,h),y&&y.useStates(t,r,h),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~ro)}},e.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var r=this.animators[t];r.targetName&&r.changeTarget(this[r.targetName])}},e.prototype.removeState=function(t){var r=Xr(this.currentStates,t);if(r>=0){var n=this.currentStates.slice();n.splice(r,1),this.useStates(n)}},e.prototype.replaceState=function(t,r,n){var i=this.currentStates.slice(),a=Xr(i,t),o=Xr(i,r)>=0;a>=0?o?i.splice(a,1):i[a]=r:n&&!o&&i.push(r),this.useStates(i)},e.prototype.toggleState=function(t,r){r?this.useState(t,!0):this.removeState(t)},e.prototype._mergeStates=function(t){for(var r={},n,i=0;i<t.length;i++){var a=t[i];et(r,a),a.textConfig&&(n=n||{},et(n,a.textConfig))}return n&&(r.textConfig=n),r},e.prototype._applyStateObj=function(t,r,n,i,a,o){var s=!(r&&i);r&&r.textConfig?(this.textConfig=et({},i?this.textConfig:n.textConfig),et(this.textConfig,r.textConfig)):s&&n.textConfig&&(this.textConfig=n.textConfig);for(var l={},u=!1,f=0;f<kI.length;f++){var c=kI[f],h=a&&STe[c];r&&r[c]!=null?h?(u=!0,l[c]=r[c]):this[c]=r[c]:s&&n[c]!=null&&(h?(u=!0,l[c]=n[c]):this[c]=n[c])}if(!a)for(var f=0;f<this.animators.length;f++){var d=this.animators[f],v=d.targetName;d.getLoop()||d.__changeFinalValue(v?(r||n)[v]:r||n)}u&&this._transitionState(t,l,o)},e.prototype._attachComponent=function(t){if(!(t.__zr&&!t.__hostTarget)&&t!==this){var r=this.__zr;r&&t.addSelfToZr(r),t.__zr=r,t.__hostTarget=this}},e.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},e.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(t){var r=this._textContent;r!==t&&(r&&r!==t&&this.removeTextContent(),t.innerTransformable=new QB,this._attachComponent(t),this._textContent=t,this.markRedraw())},e.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),et(this.textConfig,t),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=ro;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var r=this._textContent,n=this._textGuide;r&&(r.__inHover=t),n&&(n.__inHover=t)},e.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.addAnimator(r[n]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.removeAnimator(r[n]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},e.prototype.animate=function(t,r,n){var i=t?this[t]:this,a=new JB(i,r,n);return t&&(a.targetName=t),this.addAnimator(a,t),a},e.prototype.addAnimator=function(t,r){var n=this.__zr,i=this;t.during(function(){i.updateDuringAnimation(r)}).done(function(){var a=i.animators,o=Xr(a,t);o>=0&&a.splice(o,1)}),this.animators.push(t),n&&n.animation.addAnimator(t),n&&n.wakeUp()},e.prototype.updateDuringAnimation=function(t){this.markRedraw()},e.prototype.stopAnimation=function(t,r){for(var n=this.animators,i=n.length,a=[],o=0;o<i;o++){var s=n[o];!t||t===s.scope?s.stop(r):a.push(s)}return this.animators=a,this},e.prototype.animateTo=function(t,r,n){AI(this,t,r,n)},e.prototype.animateFrom=function(t,r,n){AI(this,t,r,n,!0)},e.prototype._transitionState=function(t,r,n,i){for(var a=AI(this,r,n,i),o=0;o<a.length;o++)a[o].__fromStateTransition=t},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=ro;function r(n,i,a,o){Object.defineProperty(t,n,{get:function(){if(!this[i]){var l=this[i]=[];s(this,l)}return this[i]},set:function(l){this[a]=l[0],this[o]=l[1],this[i]=l,s(this,l)}});function s(l,u){Object.defineProperty(u,0,{get:function(){return l[a]},set:function(f){l[a]=f}}),Object.defineProperty(u,1,{get:function(){return l[o]},set:function(f){l[o]=f}})}}Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),e}();Sl(r3,Cl);Sl(r3,QB);function AI(e,t,r,n,i){r=r||{};var a=[];lie(e,"",e,t,r,n,a,i);var o=a.length,s=!1,l=r.done,u=r.aborted,f=function(){s=!0,o--,o<=0&&(s?l&&l():u&&u())},c=function(){o--,o<=0&&(s?l&&l():u&&u())};o||l&&l(),a.length>0&&r.during&&a[0].during(function(v,g){r.during(g)});for(var h=0;h<a.length;h++){var d=a[h];f&&d.done(f),c&&d.aborted(c),r.force&&d.duration(r.duration),d.start(r.easing)}return a}function PI(e,t,r){for(var n=0;n<r;n++)e[n]=t[n]}function xTe(e){return Fa(e[0])}function TTe(e,t,r){if(Fa(t[r]))if(Fa(e[r])||(e[r]=[]),so(t[r])){var n=t[r].length;e[r].length!==n&&(e[r]=new t[r].constructor(n),PI(e[r],t[r],n))}else{var i=t[r],a=e[r],o=i.length;if(xTe(i))for(var s=i[0].length,l=0;l<o;l++)a[l]?PI(a[l],i[l],s):a[l]=Array.prototype.slice.call(i[l]);else PI(a,i,o);a.length=i.length}else e[r]=t[r]}function OTe(e,t){return e===t||Fa(e)&&Fa(t)&&ETe(e,t)}function ETe(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function lie(e,t,r,n,i,a,o,s){for(var l=yn(n),u=i.duration,f=i.delay,c=i.additive,h=i.setToFinal,d=!$t(a),v=e.animators,g=[],y=0;y<l.length;y++){var b=l[y],w=n[b];if(w!=null&&r[b]!=null&&(d||a[b]))if($t(w)&&!Fa(w)&&!sk(w)){if(t){s||(r[b]=w,e.updateDuringAnimation(t));continue}lie(e,b,r[b],w,i,a&&a[b],o,s)}else g.push(b);else s||(r[b]=w,e.updateDuringAnimation(t),g.push(b))}var _=g.length;if(!c&&_)for(var x=0;x<v.length;x++){var E=v[x];if(E.targetName===t){var R=E.stopTracks(g);if(R){var A=Xr(v,E);v.splice(A,1)}}}if(i.force||(g=ua(g,function(H){return!OTe(n[H],r[H])}),_=g.length),_>0||i.force&&!o.length){var N=void 0,I=void 0,F=void 0;if(s){I={},h&&(N={});for(var x=0;x<_;x++){var b=g[x];I[b]=r[b],h?N[b]=n[b]:r[b]=n[b]}}else if(h){F={};for(var x=0;x<_;x++){var b=g[x];F[b]=qT(r[b]),TTe(r,n,b)}}var E=new JB(r,!1,!1,c?ua(v,function(W){return W.targetName===t}):null);E.targetName=t,i.scope&&(E.scope=i.scope),h&&N&&E.whenWithKeys(0,N,g),F&&E.whenWithKeys(0,F,g),E.whenWithKeys(u??500,s?I:n,g).delay(f||0),e.addAnimator(E,t),o.push(E)}}const uie=r3;var fie=function(e){ct(t,e);function t(r){var n=e.call(this)||this;return n.isGroup=!0,n._children=[],n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(r){return this._children[r]},t.prototype.childOfName=function(r){for(var n=this._children,i=0;i<n.length;i++)if(n[i].name===r)return n[i]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(r){return r&&r!==this&&r.parent!==this&&(this._children.push(r),this._doAdd(r)),this},t.prototype.addBefore=function(r,n){if(r&&r!==this&&r.parent!==this&&n&&n.parent===this){var i=this._children,a=i.indexOf(n);a>=0&&(i.splice(a,0,r),this._doAdd(r))}return this},t.prototype.replace=function(r,n){var i=Xr(this._children,r);return i>=0&&this.replaceAt(n,i),this},t.prototype.replaceAt=function(r,n){var i=this._children,a=i[n];if(r&&r!==this&&r.parent!==this&&r!==a){i[n]=r,a.parent=null;var o=this.__zr;o&&a.removeSelfFromZr(o),this._doAdd(r)}return this},t.prototype._doAdd=function(r){r.parent&&r.parent.remove(r),r.parent=this;var n=this.__zr;n&&n!==r.__zr&&r.addSelfToZr(n),n&&n.refresh()},t.prototype.remove=function(r){var n=this.__zr,i=this._children,a=Xr(i,r);return a<0?this:(i.splice(a,1),r.parent=null,n&&r.removeSelfFromZr(n),n&&n.refresh(),this)},t.prototype.removeAll=function(){for(var r=this._children,n=this.__zr,i=0;i<r.length;i++){var a=r[i];n&&a.removeSelfFromZr(n),a.parent=null}return r.length=0,this},t.prototype.eachChild=function(r,n){for(var i=this._children,a=0;a<i.length;a++){var o=i[a];r.call(n,o,a)}return this},t.prototype.traverse=function(r,n){for(var i=0;i<this._children.length;i++){var a=this._children[i],o=r.call(n,a);a.isGroup&&!o&&a.traverse(r,n)}return this},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.addSelfToZr(r)}},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.removeSelfFromZr(r)}},t.prototype.getBoundingRect=function(r){for(var n=new Br(0,0,0,0),i=r||this._children,a=[],o=null,s=0;s<i.length;s++){var l=i[s];if(!(l.ignore||l.invisible)){var u=l.getBoundingRect(),f=l.getLocalTransform(a);f?(Br.applyTransform(n,u,f),o=o||n.clone(),o.union(n)):(o=o||u.clone(),o.union(u))}}return o||n},t}(uie);fie.prototype.type="group";const Wi=fie;/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var eO={},cie={};function RTe(e){delete cie[e]}function kTe(e){if(!e)return!1;if(typeof e=="string")return lE(e,1)<D$;if(e.colorStops){for(var t=e.colorStops,r=0,n=t.length,i=0;i<n;i++)r+=lE(t[i].color,1);return r/=n,r<D$}return!1}var ATe=function(){function e(t,r,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=r,this.id=t;var a=new jxe,o=n.renderer||"canvas";eO[o]||(o=yn(eO)[0]),n.useDirtyRect=n.useDirtyRect==null?!1:n.useDirtyRect;var s=new eO[o](r,a,n,t),l=n.ssr||s.ssrOnly;this.storage=a,this.painter=s;var u=!vr.node&&!vr.worker&&!l?new bTe(s.getViewportRoot(),s.root):null,f=n.useCoarsePointer,c=f==null||f==="auto"?vr.touchEventsSupported:!!f,h=44,d;c&&(d=Tr(n.pointerSize,h)),this.handler=new Hxe(a,s,u,s.root,d),this.animation=new cTe({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return e.prototype.add=function(t){t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},e.prototype.remove=function(t){t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(t,r){this.painter.configLayer&&this.painter.configLayer(t,r),this.refresh()},e.prototype.setBackgroundColor=function(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=kTe(t)},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(t){this._darkMode=t},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(t){t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},e.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},e.prototype.flush=function(){this._flush(!1)},e.prototype._flush=function(t){var r,n=Ip();this._needsRefresh&&(r=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var i=Ip();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},e.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover()},e.prototype.resize=function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},e.prototype.clearAnimation=function(){this.animation.clear()},e.prototype.getWidth=function(){return this.painter.getWidth()},e.prototype.getHeight=function(){return this.painter.getHeight()},e.prototype.setCursorStyle=function(t){this.handler.setCursorStyle(t)},e.prototype.findHover=function(t,r){return this.handler.findHover(t,r)},e.prototype.on=function(t,r,n){return this.handler.on(t,r,n),this},e.prototype.off=function(t,r){this.handler.off(t,r)},e.prototype.trigger=function(t,r){this.handler.trigger(t,r)},e.prototype.clear=function(){for(var t=this.storage.getRoots(),r=0;r<t.length;r++)t[r]instanceof Wi&&t[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},e.prototype.dispose=function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,RTe(this.id)},e}();function C6(e,t){var r=new ATe(Hne(),e,t);return cie[r.id]=r,r}function PTe(e,t){eO[e]=t}var x6=1e-4,hie=20;function ITe(e){return e.replace(/^\s+|\s+$/g,"")}function L$(e,t,r,n){var i=t[0],a=t[1],o=r[0],s=r[1],l=a-i,u=s-o;if(l===0)return u===0?o:(o+s)/2;if(n)if(l>0){if(e<=i)return o;if(e>=a)return s}else{if(e>=i)return o;if(e<=a)return s}else{if(e===i)return o;if(e===a)return s}return(e-i)/l*u+o}function gn(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%";break}return Rt(e)?ITe(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):e==null?NaN:+e}function Qn(e,t,r){return t==null&&(t=10),t=Math.min(Math.max(0,t),hie),e=(+e).toFixed(t),r?e:+e}function nu(e){if(e=+e,isNaN(e))return 0;if(e>1e-14){for(var t=1,r=0;r<15;r++,t*=10)if(Math.round(e*t)/t===e)return r}return MTe(e)}function MTe(e){var t=e.toString().toLowerCase(),r=t.indexOf("e"),n=r>0?+t.slice(r+1):0,i=r>0?r:t.length,a=t.indexOf("."),o=a<0?0:i-1-a;return Math.max(0,o-n)}function DTe(e,t){var r=Math.log,n=Math.LN10,i=Math.floor(r(e[1]-e[0])/n),a=Math.round(r(Math.abs(t[1]-t[0]))/n),o=Math.min(Math.max(-i+a,0),20);return isFinite(o)?o:20}function $Te(e,t){var r=bc(e,function(d,v){return d+(isNaN(v)?0:v)},0);if(r===0)return[];for(var n=Math.pow(10,t),i=Lt(e,function(d){return(isNaN(d)?0:d)/r*n*100}),a=n*100,o=Lt(i,function(d){return Math.floor(d)}),s=bc(o,function(d,v){return d+v},0),l=Lt(i,function(d,v){return d-o[v]});s<a;){for(var u=Number.NEGATIVE_INFINITY,f=null,c=0,h=l.length;c<h;++c)l[c]>u&&(u=l[c],f=c);++o[f],l[f]=0,++s}return Lt(o,function(d){return d/n})}function NTe(e,t){var r=Math.max(nu(e),nu(t)),n=e+t;return r>hie?n:Qn(n,r)}function die(e){var t=Math.PI*2;return(e%t+t)%t}function cE(e){return e>-x6&&e<x6}var LTe=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Wu(e){if(e instanceof Date)return e;if(Rt(e)){var t=LTe.exec(e);if(!t)return new Date(NaN);if(t[8]){var r=+t[4]||0;return t[8].toUpperCase()!=="Z"&&(r-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,r,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}else return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}else if(e==null)return new Date(NaN);return new Date(Math.round(e))}function FTe(e){return Math.pow(10,n3(e))}function n3(e){if(e===0)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return e/Math.pow(10,t)>=10&&t++,t}function vie(e,t){var r=n3(e),n=Math.pow(10,r),i=e/n,a;return t?i<1.5?a=1:i<2.5?a=2:i<4?a=3:i<7?a=5:a=10:i<1?a=1:i<2?a=2:i<3?a=3:i<5?a=5:a=10,e=a*n,r>=-20?+e.toFixed(r<0?-r:0):e}function hE(e){var t=parseFloat(e);return t==e&&(t!==0||!Rt(e)||e.indexOf("x")<=0)?t:NaN}function HTe(e){return!isNaN(hE(e))}function pie(){return Math.round(Math.random()*9)}function gie(e,t){return t===0?e:gie(t,e%t)}function T6(e,t){return e==null?t:t==null?e:e*t/gie(e,t)}function Ma(e){throw new Error(e)}function O6(e,t,r){return(t-e)*r+e}var yie="series\0",BTe="\0_ec_\0";function va(e){return e instanceof Array?e:e==null?[]:[e]}function F$(e,t,r){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var n=0,i=r.length;n<i;n++){var a=r[n];!e.emphasis[t].hasOwnProperty(a)&&e[t].hasOwnProperty(a)&&(e.emphasis[t][a]=e[t][a])}}}var E6=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function ZS(e){return $t(e)&&!mt(e)&&!(e instanceof Date)?e.value:e}function WTe(e){return $t(e)&&!(e instanceof Array)}function VTe(e,t,r){var n=r==="normalMerge",i=r==="replaceMerge",a=r==="replaceAll";e=e||[],t=(t||[]).slice();var o=pr();ye(t,function(l,u){if(!$t(l)){t[u]=null;return}});var s=UTe(e,o,r);return(n||i)&&jTe(s,e,o,t),n&&zTe(s,t),n||i?GTe(s,t,i):a&&YTe(s,t),KTe(s),s}function UTe(e,t,r){var n=[];if(r==="replaceAll")return n;for(var i=0;i<e.length;i++){var a=e[i];a&&a.id!=null&&t.set(a.id,i),n.push({existing:r==="replaceMerge"||Sw(a)?null:a,newOption:null,keyInfo:null,brandNew:null})}return n}function jTe(e,t,r,n){ye(n,function(i,a){if(!(!i||i.id==null)){var o=Nb(i.id),s=r.get(o);if(s!=null){var l=e[s];Bu(!l.newOption,'Duplicated option on id "'+o+'".'),l.newOption=i,l.existing=t[s],n[a]=null}}})}function zTe(e,t){ye(t,function(r,n){if(!(!r||r.name==null))for(var i=0;i<e.length;i++){var a=e[i].existing;if(!e[i].newOption&&a&&(a.id==null||r.id==null)&&!Sw(r)&&!Sw(a)&&mie("name",a,r)){e[i].newOption=r,t[n]=null;return}}})}function GTe(e,t,r){ye(t,function(n){if(n){for(var i,a=0;(i=e[a])&&(i.newOption||Sw(i.existing)||i.existing&&n.id!=null&&!mie("id",n,i.existing));)a++;i?(i.newOption=n,i.brandNew=r):e.push({newOption:n,brandNew:r,existing:null,keyInfo:null}),a++}})}function YTe(e,t){ye(t,function(r){e.push({newOption:r,brandNew:!0,existing:null,keyInfo:null})})}function KTe(e){var t=pr();ye(e,function(r){var n=r.existing;n&&t.set(n.id,r)}),ye(e,function(r){var n=r.newOption;Bu(!n||n.id==null||!t.get(n.id)||t.get(n.id)===r,"id duplicates: "+(n&&n.id)),n&&n.id!=null&&t.set(n.id,r),!r.keyInfo&&(r.keyInfo={})}),ye(e,function(r,n){var i=r.existing,a=r.newOption,o=r.keyInfo;if($t(a)){if(o.name=a.name!=null?Nb(a.name):i?i.name:yie+n,i)o.id=Nb(i.id);else if(a.id!=null)o.id=Nb(a.id);else{var s=0;do o.id="\0"+o.name+"\0"+s++;while(t.get(o.id))}t.set(o.id,r)}})}function mie(e,t,r){var n=gl(t[e],null),i=gl(r[e],null);return n!=null&&i!=null&&n===i}function Nb(e){return gl(e,"")}function gl(e,t){return e==null?t:Rt(e)?e:en(e)||m$(e)?e+"":t}function i3(e){var t=e.name;return!!(t&&t.indexOf(yie))}function Sw(e){return e&&e.id!=null&&Nb(e.id).indexOf(BTe)===0}function XTe(e,t,r){ye(e,function(n){var i=n.newOption;$t(i)&&(n.keyInfo.mainType=t,n.keyInfo.subType=qTe(t,i,n.existing,r))})}function qTe(e,t,r,n){var i=t.type?t.type:r?r.subType:n.determineSubType(e,t);return i}function Ed(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return mt(t.dataIndex)?Lt(t.dataIndex,function(r){return e.indexOfRawIndex(r)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return mt(t.name)?Lt(t.name,function(r){return e.indexOfName(r)}):e.indexOfName(t.name)}function ti(){var e="__ec_inner_"+ZTe++;return function(t){return t[e]||(t[e]={})}}var ZTe=pie();function II(e,t,r){var n=a3(t,r),i=n.mainTypeSpecified,a=n.queryOptionMap,o=n.others,s=o,l=r?r.defaultMainType:null;return!i&&l&&a.set(l,{}),a.each(function(u,f){var c=JS(e,f,u,{useDefault:l===f,enableAll:r&&r.enableAll!=null?r.enableAll:!0,enableNone:r&&r.enableNone!=null?r.enableNone:!0});s[f+"Models"]=c.models,s[f+"Model"]=c.models[0]}),s}function a3(e,t){var r;if(Rt(e)){var n={};n[e+"Index"]=0,r=n}else r=e;var i=pr(),a={},o=!1;return ye(r,function(s,l){if(l==="dataIndex"||l==="dataIndexInside"){a[l]=s;return}var u=l.match(/^(\w+)(Index|Id|Name)$/)||[],f=u[1],c=(u[2]||"").toLowerCase();if(!(!f||!c||t&&t.includeMainTypes&&Xr(t.includeMainTypes,f)<0)){o=o||!!f;var h=i.get(f)||i.set(f,{});h[c]=s}}),{mainTypeSpecified:o,queryOptionMap:i,others:a}}var Os={useDefault:!0,enableAll:!1,enableNone:!1};function JS(e,t,r,n){n=n||Os;var i=r.index,a=r.id,o=r.name,s={models:null,specified:i!=null||a!=null||o!=null};if(!s.specified){var l=void 0;return s.models=n.useDefault&&(l=e.getComponent(t))?[l]:[],s}return i==="none"||i===!1?(Bu(n.enableNone,'`"none"` or `false` is not a valid value on index option.'),s.models=[],s):(i==="all"&&(Bu(n.enableAll,'`"all"` is not a valid value on index option.'),i=a=o=null),s.models=e.queryComponents({mainType:t,index:i,id:a,name:o}),s)}function bie(e,t,r){e.setAttribute?e.setAttribute(t,r):e[t]=r}function JTe(e,t){return e.getAttribute?e.getAttribute(t):e[t]}function QTe(e){return e==="auto"?vr.domSupported?"html":"richText":e||"html"}function eOe(e,t,r,n,i){var a=t==null||t==="auto";if(n==null)return n;if(en(n)){var o=O6(r||0,n,i);return Qn(o,a?Math.max(nu(r||0),nu(n)):t)}else{if(Rt(n))return i<1?r:n;for(var s=[],l=r,u=n,f=Math.max(l?l.length:0,u.length),c=0;c<f;++c){var h=e.getDimensionInfo(c);if(h&&h.type==="ordinal")s[c]=(i<1&&l?l:u)[c];else{var d=l&&l[c]?l[c]:0,v=u[c],o=O6(d,v,i);s[c]=Qn(o,a?Math.max(nu(d),nu(v)):t)}}return s}}var tOe=".",Qc="___EC__COMPONENT__CONTAINER___",wie="___EC__EXTENDED_CLASS___";function vl(e){var t={main:"",sub:""};if(e){var r=e.split(tOe);t.main=r[0]||"",t.sub=r[1]||""}return t}function rOe(e){Bu(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function nOe(e){return!!(e&&e[wie])}function o3(e,t){e.$constructor=e,e.extend=function(r){var n=this,i;return iOe(n)?i=function(a){ct(o,a);function o(){return a.apply(this,arguments)||this}return o}(n):(i=function(){(r.$constructor||n).apply(this,arguments)},exe(i,this)),et(i.prototype,r),i[wie]=!0,i.extend=this.extend,i.superCall=sOe,i.superApply=lOe,i.superClass=n,i}}function iOe(e){return lr(e)&&/^class\s/.test(Function.prototype.toString.call(e))}function _ie(e,t){e.extend=t.extend}var aOe=Math.round(Math.random()*10);function oOe(e){var t=["__\0is_clz",aOe++].join("_");e.prototype[t]=!0,e.isInstance=function(r){return!!(r&&r[t])}}function sOe(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.superClass.prototype[t].apply(e,r)}function lOe(e,t,r){return this.superClass.prototype[t].apply(e,r)}function fk(e){var t={};e.registerClass=function(n){var i=n.type||n.prototype.type;if(i){rOe(i),n.prototype.type=i;var a=vl(i);if(!a.sub)t[a.main]=n;else if(a.sub!==Qc){var o=r(a);o[a.sub]=n}}return n},e.getClass=function(n,i,a){var o=t[n];if(o&&o[Qc]&&(o=i?o[i]:null),a&&!o)throw new Error(i?"Component "+n+"."+(i||"")+" is used but not imported.":n+".type should be specified.");return o},e.getClassesByMainType=function(n){var i=vl(n),a=[],o=t[i.main];return o&&o[Qc]?ye(o,function(s,l){l!==Qc&&a.push(s)}):a.push(o),a},e.hasClass=function(n){var i=vl(n);return!!t[i.main]},e.getAllClassMainTypes=function(){var n=[];return ye(t,function(i,a){n.push(a)}),n},e.hasSubTypes=function(n){var i=vl(n),a=t[i.main];return a&&a[Qc]};function r(n){var i=t[n.main];return(!i||!i[Qc])&&(i=t[n.main]={},i[Qc]=!0),i}}function Cw(e,t){for(var r=0;r<e.length;r++)e[r][1]||(e[r][1]=e[r][0]);return t=t||!1,function(n,i,a){for(var o={},s=0;s<e.length;s++){var l=e[s][1];if(!(i&&Xr(i,l)>=0||a&&Xr(a,l)<0)){var u=n.getShallow(l,t);u!=null&&(o[e[s][0]]=u)}}return o}}var uOe=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],fOe=Cw(uOe),cOe=function(){function e(){}return e.prototype.getAreaStyle=function(t,r){return fOe(this,t,r)},e}(),H$=new qS(50);function hOe(e){if(typeof e=="string"){var t=H$.get(e);return t&&t.image}else return e}function Sie(e,t,r,n,i){if(e)if(typeof e=="string"){if(t&&t.__zrImageSrc===e||!r)return t;var a=H$.get(e),o={hostEl:r,cb:n,cbPayload:i};return a?(t=a.image,!ck(t)&&a.pending.push(o)):(t=Am.loadImage(e,R6,R6),t.__zrImageSrc=e,H$.put(e,t.__cachedImgObj={image:t,pending:[o]})),t}else return e;else return t}function R6(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var r=e.pending[t],n=r.cb;n&&n(this,r.cbPayload),r.hostEl.dirty()}e.pending.length=0}function ck(e){return e&&e.width&&e.height}var MI=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function dOe(e,t,r,n,i){if(!t)return"";var a=(e+"").split(`
`);i=Cie(t,r,n,i);for(var o=0,s=a.length;o<s;o++)a[o]=xie(a[o],i);return a.join(`
`)}function Cie(e,t,r,n){n=n||{};var i=et({},n);i.font=t,r=Tr(r,"..."),i.maxIterations=Tr(n.maxIterations,2);var a=i.minChar=Tr(n.minChar,0);i.cnCharWidth=oo("国",t);var o=i.ascCharWidth=oo("a",t);i.placeholder=Tr(n.placeholder,"");for(var s=e=Math.max(0,e-1),l=0;l<a&&s>=o;l++)s-=o;var u=oo(r,t);return u>s&&(r="",u=0),s=e-u,i.ellipsis=r,i.ellipsisWidth=u,i.contentWidth=s,i.containerWidth=e,i}function xie(e,t){var r=t.containerWidth,n=t.font,i=t.contentWidth;if(!r)return"";var a=oo(e,n);if(a<=r)return e;for(var o=0;;o++){if(a<=i||o>=t.maxIterations){e+=t.ellipsis;break}var s=o===0?vOe(e,i,t.ascCharWidth,t.cnCharWidth):a>0?Math.floor(e.length*i/a):0;e=e.substr(0,s),a=oo(e,n)}return e===""&&(e=t.placeholder),e}function vOe(e,t,r,n){for(var i=0,a=0,o=e.length;a<o&&i<t;a++){var s=e.charCodeAt(a);i+=0<=s&&s<=127?r:n}return a}function pOe(e,t){e!=null&&(e+="");var r=t.overflow,n=t.padding,i=t.font,a=r==="truncate",o=t3(i),s=Tr(t.lineHeight,o),l=!!t.backgroundColor,u=t.lineOverflow==="truncate",f=t.width,c;f!=null&&(r==="break"||r==="breakAll")?c=e?Tie(e,t.font,f,r==="breakAll",0).lines:[]:c=e?e.split(`
`):[];var h=c.length*s,d=Tr(t.height,h);if(h>d&&u){var v=Math.floor(d/s);c=c.slice(0,v)}if(e&&a&&f!=null)for(var g=Cie(f,i,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),y=0;y<c.length;y++)c[y]=xie(c[y],g);for(var b=d,w=0,y=0;y<c.length;y++)w=Math.max(oo(c[y],i),w);f==null&&(f=w);var _=w;return n&&(b+=n[0]+n[2],_+=n[1]+n[3],f+=n[1]+n[3]),l&&(_=f),{lines:c,height:d,outerWidth:_,outerHeight:b,lineHeight:s,calculatedLineHeight:o,contentWidth:w,contentHeight:h,width:f}}var gOe=function(){function e(){}return e}(),k6=function(){function e(t){this.tokens=[],t&&(this.tokens=t)}return e}(),yOe=function(){function e(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return e}();function mOe(e,t){var r=new yOe;if(e!=null&&(e+=""),!e)return r;for(var n=t.width,i=t.height,a=t.overflow,o=(a==="break"||a==="breakAll")&&n!=null?{width:n,accumWidth:0,breakAll:a==="breakAll"}:null,s=MI.lastIndex=0,l;(l=MI.exec(e))!=null;){var u=l.index;u>s&&DI(r,e.substring(s,u),t,o),DI(r,l[2],t,o,l[1]),s=MI.lastIndex}s<e.length&&DI(r,e.substring(s,e.length),t,o);var f=[],c=0,h=0,d=t.padding,v=a==="truncate",g=t.lineOverflow==="truncate";function y(M,S,T){M.width=S,M.lineHeight=T,c+=T,h=Math.max(h,S)}e:for(var b=0;b<r.lines.length;b++){for(var w=r.lines[b],_=0,x=0,E=0;E<w.tokens.length;E++){var R=w.tokens[E],A=R.styleName&&t.rich[R.styleName]||{},N=R.textPadding=A.padding,I=N?N[1]+N[3]:0,F=R.font=A.font||t.font;R.contentHeight=t3(F);var H=Tr(A.height,R.contentHeight);if(R.innerHeight=H,N&&(H+=N[0]+N[2]),R.height=H,R.lineHeight=Mb(A.lineHeight,t.lineHeight,H),R.align=A&&A.align||t.align,R.verticalAlign=A&&A.verticalAlign||"middle",g&&i!=null&&c+R.lineHeight>i){E>0?(w.tokens=w.tokens.slice(0,E),y(w,x,_),r.lines=r.lines.slice(0,b+1)):r.lines=r.lines.slice(0,b);break e}var W=A.width,z=W==null||W==="auto";if(typeof W=="string"&&W.charAt(W.length-1)==="%")R.percentWidth=W,f.push(R),R.contentWidth=oo(R.text,F);else{if(z){var te=A.backgroundColor,ie=te&&te.image;ie&&(ie=hOe(ie),ck(ie)&&(R.width=Math.max(R.width,ie.width*H/ie.height)))}var fe=v&&n!=null?n-x:null;fe!=null&&fe<R.width?!z||fe<I?(R.text="",R.width=R.contentWidth=0):(R.text=dOe(R.text,fe-I,F,t.ellipsis,{minChar:t.truncateMinChar}),R.width=R.contentWidth=oo(R.text,F)):R.contentWidth=oo(R.text,F)}R.width+=I,x+=R.width,A&&(_=Math.max(_,R.lineHeight))}y(w,x,_)}r.outerWidth=r.width=Tr(n,h),r.outerHeight=r.height=Tr(i,c),r.contentHeight=c,r.contentWidth=h,d&&(r.outerWidth+=d[1]+d[3],r.outerHeight+=d[0]+d[2]);for(var b=0;b<f.length;b++){var R=f[b],Te=R.percentWidth;R.width=parseInt(Te,10)/100*r.width}return r}function DI(e,t,r,n,i){var a=t==="",o=i&&r.rich[i]||{},s=e.lines,l=o.font||r.font,u=!1,f,c;if(n){var h=o.padding,d=h?h[1]+h[3]:0;if(o.width!=null&&o.width!=="auto"){var v=wc(o.width,n.width)+d;s.length>0&&v+n.accumWidth>n.width&&(f=t.split(`
`),u=!0),n.accumWidth=v}else{var g=Tie(t,l,n.width,n.breakAll,n.accumWidth);n.accumWidth=g.accumWidth+d,c=g.linesWidths,f=g.lines}}else f=t.split(`
`);for(var y=0;y<f.length;y++){var b=f[y],w=new gOe;if(w.styleName=i,w.text=b,w.isLineHolder=!b&&!a,typeof o.width=="number"?w.width=o.width:w.width=c?c[y]:oo(b,l),!y&&!u){var _=(s[s.length-1]||(s[0]=new k6)).tokens,x=_.length;x===1&&_[0].isLineHolder?_[0]=w:(b||!x||a)&&_.push(w)}else s.push(new k6([w]))}}function bOe(e){var t=e.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var wOe=bc(",&?/;] ".split(""),function(e,t){return e[t]=!0,e},{});function _Oe(e){return bOe(e)?!!wOe[e]:!0}function Tie(e,t,r,n,i){for(var a=[],o=[],s="",l="",u=0,f=0,c=0;c<e.length;c++){var h=e.charAt(c);if(h===`
`){l&&(s+=l,f+=u),a.push(s),o.push(f),s="",l="",u=0,f=0;continue}var d=oo(h,t),v=n?!1:!_Oe(h);if(a.length?f+d>r:i+f+d>r){f?(s||l)&&(v?(s||(s=l,l="",u=0,f=u),a.push(s),o.push(f-u),l+=h,u+=d,s="",f=u):(l&&(s+=l,l="",u=0),a.push(s),o.push(f),s=h,f=d)):v?(a.push(l),o.push(u),l=h,u=d):(a.push(h),o.push(d));continue}f+=d,v?(l+=h,u+=d):(l&&(s+=l,l="",u=0),s+=h)}return!a.length&&!s&&(s=e,l="",u=0),l&&(s+=l),s&&(a.push(s),o.push(f)),a.length===1&&(f+=i),{accumWidth:f,lines:a,linesWidths:o}}var B$="__zr_style_"+Math.round(Math.random()*10),gd={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},hk={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};gd[B$]=!0;var A6=["z","z2","invisible"],SOe=["invisible"],COe=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype._init=function(r){for(var n=yn(r),i=0;i<n.length;i++){var a=n[i];a==="style"?this.useStyle(r[a]):e.prototype.attrKV.call(this,a,r[a])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(r,n,i,a){var o=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&xOe(this,r,n)||o&&!o[0]&&!o[3])return!1;if(i&&this.__clipPaths){for(var s=0;s<this.__clipPaths.length;++s)if(this.__clipPaths[s].isZeroArea())return!1}if(a&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},t.prototype.contain=function(r,n){return this.rectContain(r,n)},t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.rectContain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();return a.contain(i[0],i[1])},t.prototype.getPaintRect=function(){var r=this._paintRect;if(!this._paintRect||this.__dirty){var n=this.transform,i=this.getBoundingRect(),a=this.style,o=a.shadowBlur||0,s=a.shadowOffsetX||0,l=a.shadowOffsetY||0;r=this._paintRect||(this._paintRect=new Br(0,0,0,0)),n?Br.applyTransform(r,i,n):r.copy(i),(o||s||l)&&(r.width+=o*2+Math.abs(s),r.height+=o*2+Math.abs(l),r.x=Math.min(r.x,r.x+s-o),r.y=Math.min(r.y,r.y+l-o));var u=this.dirtyRectTolerance;r.isZero()||(r.x=Math.floor(r.x-u),r.y=Math.floor(r.y-u),r.width=Math.ceil(r.width+1+u*2),r.height=Math.ceil(r.height+1+u*2))}return r},t.prototype.setPrevPaintRect=function(r){r?(this._prevPaintRect=this._prevPaintRect||new Br(0,0,0,0),this._prevPaintRect.copy(r)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(r){return this.animate("style",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(r,n){r!=="style"?e.prototype.attrKV.call(this,r,n):this.style?this.setStyle(n):this.useStyle(n)},t.prototype.setStyle=function(r,n){return typeof r=="string"?this.style[r]=n:et(this.style,r),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(r){r||this.markRedraw(),this.__dirty|=vb,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&vb)},t.prototype.styleUpdated=function(){this.__dirty&=~vb},t.prototype.createStyle=function(r){return lk(gd,r)},t.prototype.useStyle=function(r){r[B$]||(r=this.createStyle(r)),this.__inHover?this.__hoverStyle=r:this.style=r,this.dirtyStyle()},t.prototype.isStyleObject=function(r){return r[B$]},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(r,n,A6)},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.style?o?a?u=n.style:(u=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(u,n.style)):(u=this._mergeStyle(this.createStyle(),a?this.style:i.style),this._mergeStyle(u,n.style)):l&&(u=i.style),u)if(o){var f=this.style;if(this.style=this.createStyle(l?{}:f),l)for(var c=yn(f),h=0;h<c.length;h++){var d=c[h];d in u&&(u[d]=u[d],this.style[d]=f[d])}for(var v=yn(u),h=0;h<v.length;h++){var d=v[h];this.style[d]=this.style[d]}this._transitionState(r,{style:u},s,this.getAnimationStyleProps())}else this.useStyle(u);for(var g=this.__inHover?SOe:A6,h=0;h<g.length;h++){var d=g[h];n&&n[d]!=null?this[d]=n[d]:l&&i[d]!=null&&(this[d]=i[d])}},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.style&&(i=i||{},this._mergeStyle(i,o.style))}return i&&(n.style=i),n},t.prototype._mergeStyle=function(r,n){return et(r,n),r},t.prototype.getAnimationStyleProps=function(){return hk},t.initDefaultProps=function(){var r=t.prototype;r.type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,r.__dirty=ro|vb}(),t}(uie),$I=new Br(0,0,0,0),NI=new Br(0,0,0,0);function xOe(e,t,r){return $I.copy(e.getBoundingRect()),e.transform&&$I.applyTransform(e.transform),NI.width=t,NI.height=r,!$I.intersect(NI)}const QS=COe;var Fo=Math.min,Ho=Math.max,LI=Math.sin,FI=Math.cos,eh=Math.PI*2,QC=Pm(),ex=Pm(),tx=Pm();function P6(e,t,r,n,i,a){i[0]=Fo(e,r),i[1]=Fo(t,n),a[0]=Ho(e,r),a[1]=Ho(t,n)}var I6=[],M6=[];function TOe(e,t,r,n,i,a,o,s,l,u){var f=eie,c=si,h=f(e,r,i,o,I6);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<h;d++){var v=c(e,r,i,o,I6[d]);l[0]=Fo(v,l[0]),u[0]=Ho(v,u[0])}h=f(t,n,a,s,M6);for(var d=0;d<h;d++){var g=c(t,n,a,s,M6[d]);l[1]=Fo(g,l[1]),u[1]=Ho(g,u[1])}l[0]=Fo(e,l[0]),u[0]=Ho(e,u[0]),l[0]=Fo(o,l[0]),u[0]=Ho(o,u[0]),l[1]=Fo(t,l[1]),u[1]=Ho(t,u[1]),l[1]=Fo(s,l[1]),u[1]=Ho(s,u[1])}function OOe(e,t,r,n,i,a,o,s){var l=tie,u=Ii,f=Ho(Fo(l(e,r,i),1),0),c=Ho(Fo(l(t,n,a),1),0),h=u(e,r,i,f),d=u(t,n,a,c);o[0]=Fo(e,i,h),o[1]=Fo(t,a,d),s[0]=Ho(e,i,h),s[1]=Ho(t,a,d)}function EOe(e,t,r,n,i,a,o,s,l){var u=Ap,f=Pp,c=Math.abs(i-a);if(c%eh<1e-4&&c>1e-4){s[0]=e-r,s[1]=t-n,l[0]=e+r,l[1]=t+n;return}if(QC[0]=FI(i)*r+e,QC[1]=LI(i)*n+t,ex[0]=FI(a)*r+e,ex[1]=LI(a)*n+t,u(s,QC,ex),f(l,QC,ex),i=i%eh,i<0&&(i=i+eh),a=a%eh,a<0&&(a=a+eh),i>a&&!o?a+=eh:i<a&&o&&(i+=eh),o){var h=a;a=i,i=h}for(var d=0;d<a;d+=Math.PI/2)d>i&&(tx[0]=FI(d)*r+e,tx[1]=LI(d)*n+t,u(s,tx,s),f(l,tx,l))}var Fr={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},th=[],rh=[],js=[],gf=[],zs=[],Gs=[],HI=Math.min,BI=Math.max,nh=Math.cos,ih=Math.sin,Vl=Math.abs,W$=Math.PI,Mf=W$*2,WI=typeof Float32Array<"u",w0=[];function VI(e){var t=Math.round(e/W$*1e8)/1e8;return t%2*W$}function ROe(e,t){var r=VI(e[0]);r<0&&(r+=Mf);var n=r-e[0],i=e[1];i+=n,!t&&i-r>=Mf?i=r+Mf:t&&r-i>=Mf?i=r-Mf:!t&&r>i?i=r+(Mf-VI(r-i)):t&&r<i&&(i=r-(Mf-VI(i-r))),e[0]=r,e[1]=i}var kOe=function(){function e(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(t,r,n){n=n||0,n>0&&(this._ux=Vl(n/uE/t)||0,this._uy=Vl(n/uE/r)||0)},e.prototype.setDPR=function(t){this.dpr=t},e.prototype.setContext=function(t){this._ctx=t},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(t,r){return this._drawPendingPt(),this.addData(Fr.M,t,r),this._ctx&&this._ctx.moveTo(t,r),this._x0=t,this._y0=r,this._xi=t,this._yi=r,this},e.prototype.lineTo=function(t,r){var n=Vl(t-this._xi),i=Vl(r-this._yi),a=n>this._ux||i>this._uy;if(this.addData(Fr.L,t,r),this._ctx&&a&&this._ctx.lineTo(t,r),a)this._xi=t,this._yi=r,this._pendingPtDist=0;else{var o=n*n+i*i;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=r,this._pendingPtDist=o)}return this},e.prototype.bezierCurveTo=function(t,r,n,i,a,o){return this._drawPendingPt(),this.addData(Fr.C,t,r,n,i,a,o),this._ctx&&this._ctx.bezierCurveTo(t,r,n,i,a,o),this._xi=a,this._yi=o,this},e.prototype.quadraticCurveTo=function(t,r,n,i){return this._drawPendingPt(),this.addData(Fr.Q,t,r,n,i),this._ctx&&this._ctx.quadraticCurveTo(t,r,n,i),this._xi=n,this._yi=i,this},e.prototype.arc=function(t,r,n,i,a,o){this._drawPendingPt(),w0[0]=i,w0[1]=a,ROe(w0,o),i=w0[0],a=w0[1];var s=a-i;return this.addData(Fr.A,t,r,n,n,i,s,0,o?0:1),this._ctx&&this._ctx.arc(t,r,n,i,a,o),this._xi=nh(a)*n+t,this._yi=ih(a)*n+r,this},e.prototype.arcTo=function(t,r,n,i,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,r,n,i,a),this},e.prototype.rect=function(t,r,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,r,n,i),this.addData(Fr.R,t,r,n,i),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(Fr.Z);var t=this._ctx,r=this._x0,n=this._y0;return t&&t.closePath(),this._xi=r,this._yi=n,this},e.prototype.fill=function(t){t&&t.fill(),this.toStatic()},e.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(t){var r=t.length;!(this.data&&this.data.length===r)&&WI&&(this.data=new Float32Array(r));for(var n=0;n<r;n++)this.data[n]=t[n];this._len=r},e.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var r=t.length,n=0,i=this._len,a=0;a<r;a++)n+=t[a].len();WI&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(var a=0;a<r;a++)for(var o=t[a].data,s=0;s<o.length;s++)this.data[i++]=o[s];this._len=i},e.prototype.addData=function(t,r,n,i,a,o,s,l,u){if(this._saveData){var f=this.data;this._len+arguments.length>f.length&&(this._expandData(),f=this.data);for(var c=0;c<arguments.length;c++)f[this._len++]=arguments[c]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],r=0;r<this._len;r++)t[r]=this.data[r];this.data=t}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,WI&&this._len>11&&(this.data=new Float32Array(t)))}},e.prototype.getBoundingRect=function(){js[0]=js[1]=zs[0]=zs[1]=Number.MAX_VALUE,gf[0]=gf[1]=Gs[0]=Gs[1]=-Number.MAX_VALUE;var t=this.data,r=0,n=0,i=0,a=0,o;for(o=0;o<this._len;){var s=t[o++],l=o===1;switch(l&&(r=t[o],n=t[o+1],i=r,a=n),s){case Fr.M:r=i=t[o++],n=a=t[o++],zs[0]=i,zs[1]=a,Gs[0]=i,Gs[1]=a;break;case Fr.L:P6(r,n,t[o],t[o+1],zs,Gs),r=t[o++],n=t[o++];break;case Fr.C:TOe(r,n,t[o++],t[o++],t[o++],t[o++],t[o],t[o+1],zs,Gs),r=t[o++],n=t[o++];break;case Fr.Q:OOe(r,n,t[o++],t[o++],t[o],t[o+1],zs,Gs),r=t[o++],n=t[o++];break;case Fr.A:var u=t[o++],f=t[o++],c=t[o++],h=t[o++],d=t[o++],v=t[o++]+d;o+=1;var g=!t[o++];l&&(i=nh(d)*c+u,a=ih(d)*h+f),EOe(u,f,c,h,d,v,g,zs,Gs),r=nh(v)*c+u,n=ih(v)*h+f;break;case Fr.R:i=r=t[o++],a=n=t[o++];var y=t[o++],b=t[o++];P6(i,a,i+y,a+b,zs,Gs);break;case Fr.Z:r=i,n=a;break}Ap(js,js,zs),Pp(gf,gf,Gs)}return o===0&&(js[0]=js[1]=gf[0]=gf[1]=0),new Br(js[0],js[1],gf[0]-js[0],gf[1]-js[1])},e.prototype._calculateLength=function(){var t=this.data,r=this._len,n=this._ux,i=this._uy,a=0,o=0,s=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var u=this._pathSegLen,f=0,c=0,h=0;h<r;){var d=t[h++],v=h===1;v&&(a=t[h],o=t[h+1],s=a,l=o);var g=-1;switch(d){case Fr.M:a=s=t[h++],o=l=t[h++];break;case Fr.L:{var y=t[h++],b=t[h++],w=y-a,_=b-o;(Vl(w)>n||Vl(_)>i||h===r-1)&&(g=Math.sqrt(w*w+_*_),a=y,o=b);break}case Fr.C:{var x=t[h++],E=t[h++],y=t[h++],b=t[h++],R=t[h++],A=t[h++];g=Gxe(a,o,x,E,y,b,R,A,10),a=R,o=A;break}case Fr.Q:{var x=t[h++],E=t[h++],y=t[h++],b=t[h++];g=Xxe(a,o,x,E,y,b,10),a=y,o=b;break}case Fr.A:var N=t[h++],I=t[h++],F=t[h++],H=t[h++],W=t[h++],z=t[h++],te=z+W;h+=1,t[h++],v&&(s=nh(W)*F+N,l=ih(W)*H+I),g=BI(F,H)*HI(Mf,Math.abs(z)),a=nh(te)*F+N,o=ih(te)*H+I;break;case Fr.R:{s=a=t[h++],l=o=t[h++];var ie=t[h++],fe=t[h++];g=ie*2+fe*2;break}case Fr.Z:{var w=s-a,_=l-o;g=Math.sqrt(w*w+_*_),a=s,o=l;break}}g>=0&&(u[c++]=g,f+=g)}return this._pathLen=f,f},e.prototype.rebuildPath=function(t,r){var n=this.data,i=this._ux,a=this._uy,o=this._len,s,l,u,f,c,h,d=r<1,v,g,y=0,b=0,w,_=0,x,E;if(!(d&&(this._pathSegLen||this._calculateLength(),v=this._pathSegLen,g=this._pathLen,w=r*g,!w)))e:for(var R=0;R<o;){var A=n[R++],N=R===1;switch(N&&(u=n[R],f=n[R+1],s=u,l=f),A!==Fr.L&&_>0&&(t.lineTo(x,E),_=0),A){case Fr.M:s=u=n[R++],l=f=n[R++],t.moveTo(u,f);break;case Fr.L:{c=n[R++],h=n[R++];var I=Vl(c-u),F=Vl(h-f);if(I>i||F>a){if(d){var H=v[b++];if(y+H>w){var W=(w-y)/H;t.lineTo(u*(1-W)+c*W,f*(1-W)+h*W);break e}y+=H}t.lineTo(c,h),u=c,f=h,_=0}else{var z=I*I+F*F;z>_&&(x=c,E=h,_=z)}break}case Fr.C:{var te=n[R++],ie=n[R++],fe=n[R++],Te=n[R++],M=n[R++],S=n[R++];if(d){var H=v[b++];if(y+H>w){var W=(w-y)/H;oE(u,te,fe,M,W,th),oE(f,ie,Te,S,W,rh),t.bezierCurveTo(th[1],rh[1],th[2],rh[2],th[3],rh[3]);break e}y+=H}t.bezierCurveTo(te,ie,fe,Te,M,S),u=M,f=S;break}case Fr.Q:{var te=n[R++],ie=n[R++],fe=n[R++],Te=n[R++];if(d){var H=v[b++];if(y+H>w){var W=(w-y)/H;sE(u,te,fe,W,th),sE(f,ie,Te,W,rh),t.quadraticCurveTo(th[1],rh[1],th[2],rh[2]);break e}y+=H}t.quadraticCurveTo(te,ie,fe,Te),u=fe,f=Te;break}case Fr.A:var T=n[R++],k=n[R++],O=n[R++],D=n[R++],L=n[R++],B=n[R++],Y=n[R++],Q=!n[R++],he=O>D?O:D,ce=Vl(O-D)>.001,le=L+B,xe=!1;if(d){var H=v[b++];y+H>w&&(le=L+B*(w-y)/H,xe=!0),y+=H}if(ce&&t.ellipse?t.ellipse(T,k,O,D,Y,L,le,Q):t.arc(T,k,he,L,le,Q),xe)break e;N&&(s=nh(L)*O+T,l=ih(L)*D+k),u=nh(le)*O+T,f=ih(le)*D+k;break;case Fr.R:s=u=n[R],l=f=n[R+1],c=n[R++],h=n[R++];var U=n[R++],De=n[R++];if(d){var H=v[b++];if(y+H>w){var de=w-y;t.moveTo(c,h),t.lineTo(c+HI(de,U),h),de-=U,de>0&&t.lineTo(c+U,h+HI(de,De)),de-=De,de>0&&t.lineTo(c+BI(U-de,0),h+De),de-=U,de>0&&t.lineTo(c,h+BI(De-de,0));break e}y+=H}t.rect(c,h,U,De);break;case Fr.Z:if(d){var H=v[b++];if(y+H>w){var W=(w-y)/H;t.lineTo(u*(1-W)+s*W,f*(1-W)+l*W);break e}y+=H}t.closePath(),u=s,f=l}}},e.prototype.clone=function(){var t=new e,r=this.data;return t.data=r.slice?r.slice():Array.prototype.slice.call(r),t._len=this._len,t},e.CMD=Fr,e.initDefaultProps=function(){var t=e.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),e}();const _c=kOe;function $v(e,t,r,n,i,a,o){if(i===0)return!1;var s=i,l=0,u=e;if(o>t+s&&o>n+s||o<t-s&&o<n-s||a>e+s&&a>r+s||a<e-s&&a<r-s)return!1;if(e!==r)l=(t-n)/(e-r),u=(e*n-r*t)/(e-r);else return Math.abs(a-e)<=s/2;var f=l*a-o+u,c=f*f/(l*l+1);return c<=s/2*s/2}function AOe(e,t,r,n,i,a,o,s,l,u,f){if(l===0)return!1;var c=l;if(f>t+c&&f>n+c&&f>a+c&&f>s+c||f<t-c&&f<n-c&&f<a-c&&f<s-c||u>e+c&&u>r+c&&u>i+c&&u>o+c||u<e-c&&u<r-c&&u<i-c&&u<o-c)return!1;var h=zxe(e,t,r,n,i,a,o,s,u,f,null);return h<=c/2}function POe(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;if(l>t+u&&l>n+u&&l>a+u||l<t-u&&l<n-u&&l<a-u||s>e+u&&s>r+u&&s>i+u||s<e-u&&s<r-u&&s<i-u)return!1;var f=Kxe(e,t,r,n,i,a,s,l,null);return f<=u/2}var D6=Math.PI*2;function rx(e){return e%=D6,e<0&&(e+=D6),e}var _0=Math.PI*2;function IOe(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;s-=e,l-=t;var f=Math.sqrt(s*s+l*l);if(f-u>r||f+u<r)return!1;if(Math.abs(n-i)%_0<1e-4)return!0;if(a){var c=n;n=rx(i),i=rx(c)}else n=rx(n),i=rx(i);n>i&&(i+=_0);var h=Math.atan2(l,s);return h<0&&(h+=_0),h>=n&&h<=i||h+_0>=n&&h+_0<=i}function ah(e,t,r,n,i,a){if(a>t&&a>n||a<t&&a<n||n===t)return 0;var o=(a-t)/(n-t),s=n<t?1:-1;(o===1||o===0)&&(s=n<t?.5:-.5);var l=o*(r-e)+e;return l===i?1/0:l>i?s:0}var yf=_c.CMD,oh=Math.PI*2,MOe=1e-4;function DOe(e,t){return Math.abs(e-t)<MOe}var aa=[-1,-1,-1],Do=[-1,-1];function $Oe(){var e=Do[0];Do[0]=Do[1],Do[1]=e}function NOe(e,t,r,n,i,a,o,s,l,u){if(u>t&&u>n&&u>a&&u>s||u<t&&u<n&&u<a&&u<s)return 0;var f=aE(t,n,a,s,u,aa);if(f===0)return 0;for(var c=0,h=-1,d=void 0,v=void 0,g=0;g<f;g++){var y=aa[g],b=y===0||y===1?.5:1,w=si(e,r,i,o,y);w<l||(h<0&&(h=eie(t,n,a,s,Do),Do[1]<Do[0]&&h>1&&$Oe(),d=si(t,n,a,s,Do[0]),h>1&&(v=si(t,n,a,s,Do[1]))),h===2?y<Do[0]?c+=d<t?b:-b:y<Do[1]?c+=v<d?b:-b:c+=s<v?b:-b:y<Do[0]?c+=d<t?b:-b:c+=s<d?b:-b)}return c}function LOe(e,t,r,n,i,a,o,s){if(s>t&&s>n&&s>a||s<t&&s<n&&s<a)return 0;var l=Yxe(t,n,a,s,aa);if(l===0)return 0;var u=tie(t,n,a);if(u>=0&&u<=1){for(var f=0,c=Ii(t,n,a,u),h=0;h<l;h++){var d=aa[h]===0||aa[h]===1?.5:1,v=Ii(e,r,i,aa[h]);v<o||(aa[h]<u?f+=c<t?d:-d:f+=a<c?d:-d)}return f}else{var d=aa[0]===0||aa[0]===1?.5:1,v=Ii(e,r,i,aa[0]);return v<o?0:a<t?d:-d}}function FOe(e,t,r,n,i,a,o,s){if(s-=t,s>r||s<-r)return 0;var l=Math.sqrt(r*r-s*s);aa[0]=-l,aa[1]=l;var u=Math.abs(n-i);if(u<1e-4)return 0;if(u>=oh-1e-4){n=0,i=oh;var f=a?1:-1;return o>=aa[0]+e&&o<=aa[1]+e?f:0}if(n>i){var c=n;n=i,i=c}n<0&&(n+=oh,i+=oh);for(var h=0,d=0;d<2;d++){var v=aa[d];if(v+e>o){var g=Math.atan2(s,v),f=a?1:-1;g<0&&(g=oh+g),(g>=n&&g<=i||g+oh>=n&&g+oh<=i)&&(g>Math.PI/2&&g<Math.PI*1.5&&(f=-f),h+=f)}}return h}function Oie(e,t,r,n,i){for(var a=e.data,o=e.len(),s=0,l=0,u=0,f=0,c=0,h,d,v=0;v<o;){var g=a[v++],y=v===1;switch(g===yf.M&&v>1&&(r||(s+=ah(l,u,f,c,n,i))),y&&(l=a[v],u=a[v+1],f=l,c=u),g){case yf.M:f=a[v++],c=a[v++],l=f,u=c;break;case yf.L:if(r){if($v(l,u,a[v],a[v+1],t,n,i))return!0}else s+=ah(l,u,a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case yf.C:if(r){if(AOe(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=NOe(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case yf.Q:if(r){if(POe(l,u,a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=LOe(l,u,a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case yf.A:var b=a[v++],w=a[v++],_=a[v++],x=a[v++],E=a[v++],R=a[v++];v+=1;var A=!!(1-a[v++]);h=Math.cos(E)*_+b,d=Math.sin(E)*x+w,y?(f=h,c=d):s+=ah(l,u,h,d,n,i);var N=(n-b)*x/_+b;if(r){if(IOe(b,w,x,E,E+R,A,t,N,i))return!0}else s+=FOe(b,w,x,E,E+R,A,N,i);l=Math.cos(E+R)*_+b,u=Math.sin(E+R)*x+w;break;case yf.R:f=l=a[v++],c=u=a[v++];var I=a[v++],F=a[v++];if(h=f+I,d=c+F,r){if($v(f,c,h,c,t,n,i)||$v(h,c,h,d,t,n,i)||$v(h,d,f,d,t,n,i)||$v(f,d,f,c,t,n,i))return!0}else s+=ah(h,c,h,d,n,i),s+=ah(f,d,f,c,n,i);break;case yf.Z:if(r){if($v(l,u,f,c,t,n,i))return!0}else s+=ah(l,u,f,c,n,i);l=f,u=c;break}}return!r&&!DOe(u,c)&&(s+=ah(l,u,f,c,n,i)||0),s!==0}function HOe(e,t,r){return Oie(e,0,!1,t,r)}function BOe(e,t,r,n){return Oie(e,t,!0,r,n)}var Eie=Vr({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},gd),WOe={style:Vr({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},hk.style)},UI=_w.concat(["invisible","culling","z","z2","zlevel","parent"]),VOe=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.update=function(){var r=this;e.prototype.update.call(this);var n=this.style;if(n.decal){var i=this._decalEl=this._decalEl||new t;i.buildPath===t.prototype.buildPath&&(i.buildPath=function(l){r.buildPath(l,r.shape)}),i.silent=!0;var a=i.style;for(var o in n)a[o]!==n[o]&&(a[o]=n[o]);a.fill=n.fill?n.decal:null,a.decal=null,a.shadowColor=null,n.strokeFirst&&(a.stroke=null);for(var s=0;s<UI.length;++s)i[UI[s]]=this[UI[s]];i.__dirty|=ro}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(r){var n=yn(r);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var a=0;a<n.length;a++){var o=n[a],s=r[o];o==="style"?this.style?et(this.style,s):this.useStyle(s):o==="shape"?et(this.shape,s):e.prototype.attrKV.call(this,o,s)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var r=this.style.fill;if(r!=="none"){if(Rt(r)){var n=lE(r,0);return n>.5?$$:n>.2?wTe:N$}else if(r)return N$}return $$},t.prototype.getInsideTextStroke=function(r){var n=this.style.fill;if(Rt(n)){var i=this.__zr,a=!!(i&&i.isDarkMode()),o=lE(r,0)<D$;if(a===o)return n}},t.prototype.buildPath=function(r,n,i){},t.prototype.pathUpdated=function(){this.__dirty&=~Sp},t.prototype.getUpdatedPathProxy=function(r){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,r),this.path},t.prototype.createPathProxy=function(){this.path=new _c(!1)},t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return!(n==null||n==="none"||!(r.lineWidth>0))},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.getBoundingRect=function(){var r=this._rect,n=this.style,i=!r;if(i){var a=!1;this.path||(a=!0,this.createPathProxy());var o=this.path;(a||this.__dirty&Sp)&&(o.beginPath(),this.buildPath(o,this.shape,!1),this.pathUpdated()),r=o.getBoundingRect()}if(this._rect=r,this.hasStroke()&&this.path&&this.path.len()>0){var s=this._rectStroke||(this._rectStroke=r.clone());if(this.__dirty||i){s.copy(r);var l=n.strokeNoScale?this.getLineScale():1,u=n.lineWidth;if(!this.hasFill()){var f=this.strokeContainThreshold;u=Math.max(u,f??4)}l>1e-10&&(s.width+=u/l,s.height+=u/l,s.x-=u/l/2,s.y-=u/l/2)}return s}return r},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect(),o=this.style;if(r=i[0],n=i[1],a.contain(r,n)){var s=this.path;if(this.hasStroke()){var l=o.lineWidth,u=o.strokeNoScale?this.getLineScale():1;if(u>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),BOe(s,l/u,r,n)))return!0}if(this.hasFill())return HOe(s,r,n)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=Sp,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(r){return this.animate("shape",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():r==="shape"?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(r,n){r==="shape"?this.setShape(n):e.prototype.attrKV.call(this,r,n)},t.prototype.setShape=function(r,n){var i=this.shape;return i||(i=this.shape={}),typeof r=="string"?i[r]=n:et(i,r),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&Sp)},t.prototype.createStyle=function(r){return lk(Eie,r)},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.shape&&!n.shape&&(n.shape=et({},this.shape))},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.shape?o?a?u=n.shape:(u=et({},i.shape),et(u,n.shape)):(u=et({},a?this.shape:i.shape),et(u,n.shape)):l&&(u=i.shape),u)if(o){this.shape=et({},this.shape);for(var f={},c=yn(u),h=0;h<c.length;h++){var d=c[h];typeof u[d]=="object"?this.shape[d]=u[d]:f[d]=u[d]}this._transitionState(r,{shape:f},s)}else this.shape=u,this.dirtyShape()},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.shape&&(i=i||{},this._mergeStyle(i,o.shape))}return i&&(n.shape=i),n},t.prototype.getAnimationStyleProps=function(){return WOe},t.prototype.isZeroArea=function(){return!1},t.extend=function(r){var n=function(a){ct(o,a);function o(s){var l=a.call(this,s)||this;return r.init&&r.init.call(l,s),l}return o.prototype.getDefaultStyle=function(){return Rr(r.style)},o.prototype.getDefaultShape=function(){return Rr(r.shape)},o}(t);for(var i in r)typeof r[i]=="function"&&(n.prototype[i]=r[i]);return n},t.initDefaultProps=function(){var r=t.prototype;r.type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,r.__dirty=ro|vb|Sp}(),t}(QS);const zr=VOe;var UOe=Vr({strokeFirst:!0,font:Od,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Eie),Rie=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return n!=null&&n!=="none"&&r.lineWidth>0},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.createStyle=function(r){return lk(UOe,r)},t.prototype.setBoundingRect=function(r){this._rect=r},t.prototype.getBoundingRect=function(){var r=this.style;if(!this._rect){var n=r.text;n!=null?n+="":n="";var i=e3(n,r.font,r.textAlign,r.textBaseline);if(i.x+=r.x||0,i.y+=r.y||0,this.hasStroke()){var a=r.lineWidth;i.x-=a/2,i.y-=a/2,i.width+=a,i.height+=a}this._rect=i}return this._rect},t.initDefaultProps=function(){var r=t.prototype;r.dirtyRectTolerance=10}(),t}(QS);Rie.prototype.type="tspan";const V$=Rie;var jOe=Vr({x:0,y:0},gd),zOe={style:Vr({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},hk.style)};function GOe(e){return!!(e&&typeof e!="string"&&e.width&&e.height)}var kie=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.createStyle=function(r){return lk(jOe,r)},t.prototype._getSize=function(r){var n=this.style,i=n[r];if(i!=null)return i;var a=GOe(n.image)?n.image:this.__image;if(!a)return 0;var o=r==="width"?"height":"width",s=n[o];return s==null?a[r]:a[r]/a[o]*s},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return zOe},t.prototype.getBoundingRect=function(){var r=this.style;return this._rect||(this._rect=new Br(r.x||0,r.y||0,this.getWidth(),this.getHeight())),this._rect},t}(QS);kie.prototype.type="image";const Kd=kie;function YOe(e,t){var r=t.x,n=t.y,i=t.width,a=t.height,o=t.r,s,l,u,f;i<0&&(r=r+i,i=-i),a<0&&(n=n+a,a=-a),typeof o=="number"?s=l=u=f=o:o instanceof Array?o.length===1?s=l=u=f=o[0]:o.length===2?(s=u=o[0],l=f=o[1]):o.length===3?(s=o[0],l=f=o[1],u=o[2]):(s=o[0],l=o[1],u=o[2],f=o[3]):s=l=u=f=0;var c;s+l>i&&(c=s+l,s*=i/c,l*=i/c),u+f>i&&(c=u+f,u*=i/c,f*=i/c),l+u>a&&(c=l+u,l*=a/c,u*=a/c),s+f>a&&(c=s+f,s*=a/c,f*=a/c),e.moveTo(r+s,n),e.lineTo(r+i-l,n),l!==0&&e.arc(r+i-l,n+l,l,-Math.PI/2,0),e.lineTo(r+i,n+a-u),u!==0&&e.arc(r+i-u,n+a-u,u,0,Math.PI/2),e.lineTo(r+f,n+a),f!==0&&e.arc(r+f,n+a-f,f,Math.PI/2,Math.PI),e.lineTo(r,n+s),s!==0&&e.arc(r+s,n+s,s,Math.PI,Math.PI*1.5)}var Mp=Math.round;function Aie(e,t,r){if(t){var n=t.x1,i=t.x2,a=t.y1,o=t.y2;e.x1=n,e.x2=i,e.y1=a,e.y2=o;var s=r&&r.lineWidth;return s&&(Mp(n*2)===Mp(i*2)&&(e.x1=e.x2=Hh(n,s,!0)),Mp(a*2)===Mp(o*2)&&(e.y1=e.y2=Hh(a,s,!0))),e}}function Pie(e,t,r){if(t){var n=t.x,i=t.y,a=t.width,o=t.height;e.x=n,e.y=i,e.width=a,e.height=o;var s=r&&r.lineWidth;return s&&(e.x=Hh(n,s,!0),e.y=Hh(i,s,!0),e.width=Math.max(Hh(n+a,s,!1)-e.x,a===0?0:1),e.height=Math.max(Hh(i+o,s,!1)-e.y,o===0?0:1)),e}}function Hh(e,t,r){if(!t)return e;var n=Mp(e*2);return(n+Mp(t))%2===0?n/2:(n+(r?1:-1))/2}var KOe=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0}return e}(),XOe={},Iie=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new KOe},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=Pie(XOe,n,this.style);i=l.x,a=l.y,o=l.width,s=l.height,l.r=n.r,n=l}else i=n.x,a=n.y,o=n.width,s=n.height;n.r?YOe(r,n):r.rect(i,a,o,s)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(zr);Iie.prototype.type="rect";const ci=Iie;var $6={fill:"#000"},N6=2,qOe={style:Vr({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},hk.style)},Mie=function(e){ct(t,e);function t(r){var n=e.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=$6,n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var r=0;r<this._children.length;r++){var n=this._children[r];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},t.prototype.updateTransform=function(){var r=this.innerTransformable;r?(r.updateTransform(),r.transform&&(this.transform=r.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(r){var n=this.innerTransformable;return n?n.getLocalTransform(r):e.prototype.getLocalTransform.call(this,r)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,tEe(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=r},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var r=new Br(0,0,0,0),n=this._children,i=[],a=null,o=0;o<n.length;o++){var s=n[o],l=s.getBoundingRect(),u=s.getLocalTransform(i);u?(r.copy(l),r.applyTransform(u),a=a||r.clone(),a.union(r)):(a=a||l.clone(),a.union(l))}this._rect=a||r}return this._rect},t.prototype.setDefaultTextStyle=function(r){this._defaultStyle=r||$6},t.prototype.setTextContent=function(r){},t.prototype._mergeStyle=function(r,n){if(!n)return r;var i=n.rich,a=r.rich||i&&{};return et(r,n),i&&a?(this._mergeRich(a,i),r.rich=a):a&&(r.rich=a),r},t.prototype._mergeRich=function(r,n){for(var i=yn(n),a=0;a<i.length;a++){var o=i[a];r[o]=r[o]||{},et(r[o],n[o])}},t.prototype.getAnimationStyleProps=function(){return qOe},t.prototype._getOrCreateChild=function(r){var n=this._children[this._childCursor];return(!n||!(n instanceof r))&&(n=new r),this._children[this._childCursor++]=n,n.__zr=this.__zr,n.parent=this,n},t.prototype._updatePlainTexts=function(){var r=this.style,n=r.font||Od,i=r.padding,a=U6(r),o=pOe(a,r),s=jI(r),l=!!r.backgroundColor,u=o.outerHeight,f=o.outerWidth,c=o.contentWidth,h=o.lines,d=o.lineHeight,v=this._defaultStyle,g=r.x||0,y=r.y||0,b=r.align||v.align||"left",w=r.verticalAlign||v.verticalAlign||"top",_=g,x=Cp(y,o.contentHeight,w);if(s||i){var E=gb(g,f,b),R=Cp(y,u,w);s&&this._renderBackground(r,r,E,R,f,u)}x+=d/2,i&&(_=V6(g,b,i),w==="top"?x+=i[0]:w==="bottom"&&(x-=i[2]));for(var A=0,N=!1,I=W6("fill"in r?r.fill:(N=!0,v.fill)),F=B6("stroke"in r?r.stroke:!l&&(!v.autoStroke||N)?(A=N6,v.stroke):null),H=r.textShadowBlur>0,W=r.width!=null&&(r.overflow==="truncate"||r.overflow==="break"||r.overflow==="breakAll"),z=o.calculatedLineHeight,te=0;te<h.length;te++){var ie=this._getOrCreateChild(V$),fe=ie.createStyle();ie.useStyle(fe),fe.text=h[te],fe.x=_,fe.y=x,b&&(fe.textAlign=b),fe.textBaseline="middle",fe.opacity=r.opacity,fe.strokeFirst=!0,H&&(fe.shadowBlur=r.textShadowBlur||0,fe.shadowColor=r.textShadowColor||"transparent",fe.shadowOffsetX=r.textShadowOffsetX||0,fe.shadowOffsetY=r.textShadowOffsetY||0),fe.stroke=F,fe.fill=I,F&&(fe.lineWidth=r.lineWidth||A,fe.lineDash=r.lineDash,fe.lineDashOffset=r.lineDashOffset||0),fe.font=n,F6(fe,r),x+=d,W&&ie.setBoundingRect(new Br(gb(fe.x,r.width,fe.textAlign),Cp(fe.y,z,fe.textBaseline),c,z))}},t.prototype._updateRichTexts=function(){var r=this.style,n=U6(r),i=mOe(n,r),a=i.width,o=i.outerWidth,s=i.outerHeight,l=r.padding,u=r.x||0,f=r.y||0,c=this._defaultStyle,h=r.align||c.align,d=r.verticalAlign||c.verticalAlign,v=gb(u,o,h),g=Cp(f,s,d),y=v,b=g;l&&(y+=l[3],b+=l[0]);var w=y+a;jI(r)&&this._renderBackground(r,r,v,g,o,s);for(var _=!!r.backgroundColor,x=0;x<i.lines.length;x++){for(var E=i.lines[x],R=E.tokens,A=R.length,N=E.lineHeight,I=E.width,F=0,H=y,W=w,z=A-1,te=void 0;F<A&&(te=R[F],!te.align||te.align==="left");)this._placeToken(te,r,N,b,H,"left",_),I-=te.width,H+=te.width,F++;for(;z>=0&&(te=R[z],te.align==="right");)this._placeToken(te,r,N,b,W,"right",_),I-=te.width,W-=te.width,z--;for(H+=(a-(H-y)-(w-W)-I)/2;F<=z;)te=R[F],this._placeToken(te,r,N,b,H+te.width/2,"center",_),H+=te.width,F++;b+=N}},t.prototype._placeToken=function(r,n,i,a,o,s,l){var u=n.rich[r.styleName]||{};u.text=r.text;var f=r.verticalAlign,c=a+i/2;f==="top"?c=a+r.height/2:f==="bottom"&&(c=a+i-r.height/2);var h=!r.isLineHolder&&jI(u);h&&this._renderBackground(u,n,s==="right"?o-r.width:s==="center"?o-r.width/2:o,c-r.height/2,r.width,r.height);var d=!!u.backgroundColor,v=r.textPadding;v&&(o=V6(o,s,v),c-=r.height/2-v[0]-r.innerHeight/2);var g=this._getOrCreateChild(V$),y=g.createStyle();g.useStyle(y);var b=this._defaultStyle,w=!1,_=0,x=W6("fill"in u?u.fill:"fill"in n?n.fill:(w=!0,b.fill)),E=B6("stroke"in u?u.stroke:"stroke"in n?n.stroke:!d&&!l&&(!b.autoStroke||w)?(_=N6,b.stroke):null),R=u.textShadowBlur>0||n.textShadowBlur>0;y.text=r.text,y.x=o,y.y=c,R&&(y.shadowBlur=u.textShadowBlur||n.textShadowBlur||0,y.shadowColor=u.textShadowColor||n.textShadowColor||"transparent",y.shadowOffsetX=u.textShadowOffsetX||n.textShadowOffsetX||0,y.shadowOffsetY=u.textShadowOffsetY||n.textShadowOffsetY||0),y.textAlign=s,y.textBaseline="middle",y.font=r.font||Od,y.opacity=Mb(u.opacity,n.opacity,1),F6(y,u),E&&(y.lineWidth=Mb(u.lineWidth,n.lineWidth,_),y.lineDash=Tr(u.lineDash,n.lineDash),y.lineDashOffset=n.lineDashOffset||0,y.stroke=E),x&&(y.fill=x);var A=r.contentWidth,N=r.contentHeight;g.setBoundingRect(new Br(gb(y.x,A,y.textAlign),Cp(y.y,N,y.textBaseline),A,N))},t.prototype._renderBackground=function(r,n,i,a,o,s){var l=r.backgroundColor,u=r.borderWidth,f=r.borderColor,c=l&&l.image,h=l&&!c,d=r.borderRadius,v=this,g,y;if(h||r.lineHeight||u&&f){g=this._getOrCreateChild(ci),g.useStyle(g.createStyle()),g.style.fill=null;var b=g.shape;b.x=i,b.y=a,b.width=o,b.height=s,b.r=d,g.dirtyShape()}if(h){var w=g.style;w.fill=l||null,w.fillOpacity=Tr(r.fillOpacity,1)}else if(c){y=this._getOrCreateChild(Kd),y.onload=function(){v.dirtyStyle()};var _=y.style;_.image=l.image,_.x=i,_.y=a,_.width=o,_.height=s}if(u&&f){var w=g.style;w.lineWidth=u,w.stroke=f,w.strokeOpacity=Tr(r.strokeOpacity,1),w.lineDash=r.borderDash,w.lineDashOffset=r.borderDashOffset||0,g.strokeContainThreshold=0,g.hasFill()&&g.hasStroke()&&(w.strokeFirst=!0,w.lineWidth*=2)}var x=(g||y).style;x.shadowBlur=r.shadowBlur||0,x.shadowColor=r.shadowColor||"transparent",x.shadowOffsetX=r.shadowOffsetX||0,x.shadowOffsetY=r.shadowOffsetY||0,x.opacity=Mb(r.opacity,n.opacity,1)},t.makeFont=function(r){var n="";return eEe(r)&&(n=[r.fontStyle,r.fontWeight,QOe(r.fontSize),r.fontFamily||"sans-serif"].join(" ")),n&&dl(n)||r.textFont||r.font},t}(QS),ZOe={left:!0,right:1,center:1},JOe={top:1,bottom:1,middle:1},L6=["fontStyle","fontWeight","fontSize","fontFamily"];function QOe(e){return typeof e=="string"&&(e.indexOf("px")!==-1||e.indexOf("rem")!==-1||e.indexOf("em")!==-1)?e:isNaN(+e)?UB+"px":e+"px"}function F6(e,t){for(var r=0;r<L6.length;r++){var n=L6[r],i=t[n];i!=null&&(e[n]=i)}}function eEe(e){return e.fontSize!=null||e.fontFamily||e.fontWeight}function tEe(e){return H6(e),ye(e.rich,H6),e}function H6(e){if(e){e.font=Mie.makeFont(e);var t=e.align;t==="middle"&&(t="center"),e.align=t==null||ZOe[t]?t:"left";var r=e.verticalAlign;r==="center"&&(r="middle"),e.verticalAlign=r==null||JOe[r]?r:"top";var n=e.padding;n&&(e.padding=Bne(e.padding))}}function B6(e,t){return e==null||t<=0||e==="transparent"||e==="none"?null:e.image||e.colorStops?"#000":e}function W6(e){return e==null||e==="none"?null:e.image||e.colorStops?"#000":e}function V6(e,t,r){return t==="right"?e-r[1]:t==="center"?e+r[3]/2-r[1]/2:e+r[3]}function U6(e){var t=e.text;return t!=null&&(t+=""),t}function jI(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}const Vi=Mie;var Ur=ti(),rEe=function(e,t,r,n){if(n){var i=Ur(n);i.dataIndex=r,i.dataType=t,i.seriesIndex=e,n.type==="group"&&n.traverse(function(a){var o=Ur(a);o.seriesIndex=e,o.dataIndex=r,o.dataType=t})}},j6=1,z6={},Die=ti(),s3=ti(),l3=0,dk=1,vk=2,Go=["emphasis","blur","select"],dE=["normal","emphasis","blur","select"],nEe=10,iEe=9,yd="highlight",tO="downplay",Lb="select",rO="unselect",Fb="toggleSelect";function Nv(e){return e!=null&&e!=="none"}var G6=new qS(100);function Y6(e){if(Rt(e)){var t=G6.get(e);return t||(t=h6(e,-.1),G6.put(e,t)),t}else if(sk(e)){var r=et({},e);return r.colorStops=Lt(e.colorStops,function(n){return{offset:n.offset,color:h6(n.color,-.1)}}),r}return e}function pk(e,t,r){e.onHoverStateChange&&(e.hoverState||0)!==r&&e.onHoverStateChange(t),e.hoverState=r}function $ie(e){pk(e,"emphasis",vk)}function Nie(e){e.hoverState===vk&&pk(e,"normal",l3)}function u3(e){pk(e,"blur",dk)}function Lie(e){e.hoverState===dk&&pk(e,"normal",l3)}function aEe(e){e.selected=!0}function oEe(e){e.selected=!1}function K6(e,t,r){t(e,r)}function qu(e,t,r){K6(e,t,r),e.isGroup&&e.traverse(function(n){K6(n,t,r)})}function X6(e,t){switch(t){case"emphasis":e.hoverState=vk;break;case"normal":e.hoverState=l3;break;case"blur":e.hoverState=dk;break;case"select":e.selected=!0}}function sEe(e,t,r,n){for(var i=e.style,a={},o=0;o<t.length;o++){var s=t[o],l=i[s];a[s]=l??(n&&n[s])}for(var o=0;o<e.animators.length;o++){var u=e.animators[o];u.__fromStateTransition&&u.__fromStateTransition.indexOf(r)<0&&u.targetName==="style"&&u.saveTo(a,t)}return a}function lEe(e,t,r,n){var i=r&&Xr(r,"select")>=0,a=!1;if(e instanceof zr){var o=Die(e),s=i&&o.selectFill||o.normalFill,l=i&&o.selectStroke||o.normalStroke;if(Nv(s)||Nv(l)){n=n||{};var u=n.style||{};u.fill==="inherit"?(a=!0,n=et({},n),u=et({},u),u.fill=s):!Nv(u.fill)&&Nv(s)?(a=!0,n=et({},n),u=et({},u),u.fill=Y6(s)):!Nv(u.stroke)&&Nv(l)&&(a||(n=et({},n),u=et({},u)),u.stroke=Y6(l)),n.style=u}}if(n&&n.z2==null){a||(n=et({},n));var f=e.z2EmphasisLift;n.z2=e.z2+(f??nEe)}return n}function uEe(e,t,r){if(r&&r.z2==null){r=et({},r);var n=e.z2SelectLift;r.z2=e.z2+(n??iEe)}return r}function fEe(e,t,r){var n=Xr(e.currentStates,t)>=0,i=e.style.opacity,a=n?null:sEe(e,["opacity"],t,{opacity:1});r=r||{};var o=r.style||{};return o.opacity==null&&(r=et({},r),o=et({opacity:n?i:a.opacity*.1},o),r.style=o),r}function zI(e,t){var r=this.states[e];if(this.style){if(e==="emphasis")return lEe(this,e,t,r);if(e==="blur")return fEe(this,e,r);if(e==="select")return uEe(this,e,r)}return r}function cEe(e){e.stateProxy=zI;var t=e.getTextContent(),r=e.getTextGuideLine();t&&(t.stateProxy=zI),r&&(r.stateProxy=zI)}function q6(e,t){!Wie(e,t)&&!e.__highByOuter&&qu(e,$ie)}function Z6(e,t){!Wie(e,t)&&!e.__highByOuter&&qu(e,Nie)}function vE(e,t){e.__highByOuter|=1<<(t||0),qu(e,$ie)}function pE(e,t){!(e.__highByOuter&=~(1<<(t||0)))&&qu(e,Nie)}function hEe(e){qu(e,u3)}function Fie(e){qu(e,Lie)}function Hie(e){qu(e,aEe)}function Bie(e){qu(e,oEe)}function Wie(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function Vie(e){var t=e.getModel(),r=[],n=[];t.eachComponent(function(i,a){var o=s3(a),s=i==="series",l=s?e.getViewOfSeriesModel(a):e.getViewOfComponentModel(a);!s&&n.push(l),o.isBlured&&(l.group.traverse(function(u){Lie(u)}),s&&r.push(a)),o.isBlured=!1}),ye(n,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(r,!1,t)})}function U$(e,t,r,n){var i=n.getModel();r=r||"coordinateSystem";function a(u,f){for(var c=0;c<f.length;c++){var h=u.getItemGraphicEl(f[c]);h&&Fie(h)}}if(e!=null&&!(!t||t==="none")){var o=i.getSeriesByIndex(e),s=o.coordinateSystem;s&&s.master&&(s=s.master);var l=[];i.eachSeries(function(u){var f=o===u,c=u.coordinateSystem;c&&c.master&&(c=c.master);var h=c&&s?c===s:f;if(!(r==="series"&&!f||r==="coordinateSystem"&&!h||t==="series"&&f)){var d=n.getViewOfSeriesModel(u);if(d.group.traverse(function(y){u3(y)}),Fa(t))a(u.getData(),t);else if($t(t))for(var v=yn(t),g=0;g<v.length;g++)a(u.getData(v[g]),t[v[g]]);l.push(u),s3(u).isBlured=!0}}),i.eachComponent(function(u,f){if(u!=="series"){var c=n.getViewOfComponentModel(f);c&&c.toggleBlurSeries&&c.toggleBlurSeries(l,!0,i)}})}}function j$(e,t,r){if(!(e==null||t==null)){var n=r.getModel().getComponent(e,t);if(n){s3(n).isBlured=!0;var i=r.getViewOfComponentModel(n);!i||!i.focusBlurEnabled||i.group.traverse(function(a){u3(a)})}}}function dEe(e,t,r){var n=e.seriesIndex,i=e.getData(t.dataType);if(i){var a=Ed(i,t);a=(mt(a)?a[0]:a)||0;var o=i.getItemGraphicEl(a);if(!o)for(var s=i.count(),l=0;!o&&l<s;)o=i.getItemGraphicEl(l++);if(o){var u=Ur(o);U$(n,u.focus,u.blurScope,r)}else{var f=e.get(["emphasis","focus"]),c=e.get(["emphasis","blurScope"]);f!=null&&U$(n,f,c,r)}}}function f3(e,t,r,n){var i={focusSelf:!1,dispatchers:null};if(e==null||e==="series"||t==null||r==null)return i;var a=n.getModel().getComponent(e,t);if(!a)return i;var o=n.getViewOfComponentModel(a);if(!o||!o.findHighDownDispatchers)return i;for(var s=o.findHighDownDispatchers(r),l,u=0;u<s.length;u++)if(Ur(s[u]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:s}}function vEe(e,t,r){var n=Ur(e),i=f3(n.componentMainType,n.componentIndex,n.componentHighDownName,r),a=i.dispatchers,o=i.focusSelf;a?(o&&j$(n.componentMainType,n.componentIndex,r),ye(a,function(s){return q6(s,t)})):(U$(n.seriesIndex,n.focus,n.blurScope,r),n.focus==="self"&&j$(n.componentMainType,n.componentIndex,r),q6(e,t))}function pEe(e,t,r){Vie(r);var n=Ur(e),i=f3(n.componentMainType,n.componentIndex,n.componentHighDownName,r).dispatchers;i?ye(i,function(a){return Z6(a,t)}):Z6(e,t)}function gEe(e,t,r){if(Y$(t)){var n=t.dataType,i=e.getData(n),a=Ed(i,t);mt(a)||(a=[a]),e[t.type===Fb?"toggleSelect":t.type===Lb?"select":"unselect"](a,n)}}function J6(e){var t=e.getAllData();ye(t,function(r){var n=r.data,i=r.type;n.eachItemGraphicEl(function(a,o){e.isSelected(o,i)?Hie(a):Bie(a)})})}function yEe(e){var t=[];return e.eachSeries(function(r){var n=r.getAllData();ye(n,function(i){i.data;var a=i.type,o=r.getSelectedDataIndices();if(o.length>0){var s={dataIndex:o,seriesIndex:r.seriesIndex};a!=null&&(s.dataType=a),t.push(s)}})}),t}function z$(e,t,r){Uie(e,!0),qu(e,cEe),bEe(e,t,r)}function mEe(e){Uie(e,!1)}function xw(e,t,r,n){n?mEe(e):z$(e,t,r)}function bEe(e,t,r){var n=Ur(e);t!=null?(n.focus=t,n.blurScope=r):n.focus&&(n.focus=null)}var Q6=["emphasis","blur","select"],wEe={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function gE(e,t,r,n){r=r||"itemStyle";for(var i=0;i<Q6.length;i++){var a=Q6[i],o=t.getModel([a,r]),s=e.ensureState(a);s.style=n?n(o):o[wEe[r]]()}}function Uie(e,t){var r=t===!1,n=e;e.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=e.highDownSilentOnTouch),(!r||n.__highDownDispatcher)&&(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!r)}function G$(e){return!!(e&&e.__highDownDispatcher)}function _Ee(e){var t=z6[e];return t==null&&j6<=32&&(t=z6[e]=j6++),t}function Y$(e){var t=e.type;return t===Lb||t===rO||t===Fb}function ez(e){var t=e.type;return t===yd||t===tO}function SEe(e){var t=Die(e);t.normalFill=e.style.fill,t.normalStroke=e.style.stroke;var r=e.states.select||{};t.selectFill=r.style&&r.style.fill||null,t.selectStroke=r.style&&r.style.stroke||null}var Lv=_c.CMD,CEe=[[],[],[]],tz=Math.sqrt,xEe=Math.atan2;function TEe(e,t){if(t){var r=e.data,n=e.len(),i,a,o,s,l,u,f=Lv.M,c=Lv.C,h=Lv.L,d=Lv.R,v=Lv.A,g=Lv.Q;for(o=0,s=0;o<n;){switch(i=r[o++],s=o,a=0,i){case f:a=1;break;case h:a=1;break;case c:a=3;break;case g:a=2;break;case v:var y=t[4],b=t[5],w=tz(t[0]*t[0]+t[1]*t[1]),_=tz(t[2]*t[2]+t[3]*t[3]),x=xEe(-t[1]/_,t[0]/w);r[o]*=w,r[o++]+=y,r[o]*=_,r[o++]+=b,r[o++]*=w,r[o++]*=_,r[o++]+=x,r[o++]+=x,o+=2,s=o;break;case d:u[0]=r[o++],u[1]=r[o++],jo(u,u,t),r[s++]=u[0],r[s++]=u[1],u[0]+=r[o++],u[1]+=r[o++],jo(u,u,t),r[s++]=u[0],r[s++]=u[1]}for(l=0;l<a;l++){var E=CEe[l];E[0]=r[o++],E[1]=r[o++],jo(E,E,t),r[s++]=E[0],r[s++]=E[1]}}e.increaseVersion()}}var GI=Math.sqrt,nx=Math.sin,ix=Math.cos,S0=Math.PI;function rz(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function K$(e,t){return(e[0]*t[0]+e[1]*t[1])/(rz(e)*rz(t))}function nz(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(K$(e,t))}function iz(e,t,r,n,i,a,o,s,l,u,f){var c=l*(S0/180),h=ix(c)*(e-r)/2+nx(c)*(t-n)/2,d=-1*nx(c)*(e-r)/2+ix(c)*(t-n)/2,v=h*h/(o*o)+d*d/(s*s);v>1&&(o*=GI(v),s*=GI(v));var g=(i===a?-1:1)*GI((o*o*(s*s)-o*o*(d*d)-s*s*(h*h))/(o*o*(d*d)+s*s*(h*h)))||0,y=g*o*d/s,b=g*-s*h/o,w=(e+r)/2+ix(c)*y-nx(c)*b,_=(t+n)/2+nx(c)*y+ix(c)*b,x=nz([1,0],[(h-y)/o,(d-b)/s]),E=[(h-y)/o,(d-b)/s],R=[(-1*h-y)/o,(-1*d-b)/s],A=nz(E,R);if(K$(E,R)<=-1&&(A=S0),K$(E,R)>=1&&(A=0),A<0){var N=Math.round(A/S0*1e6)/1e6;A=S0*2+N%2*S0}f.addData(u,w,_,o,s,x,A,c,a)}var OEe=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,EEe=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function REe(e){var t=new _c;if(!e)return t;var r=0,n=0,i=r,a=n,o,s=_c.CMD,l=e.match(OEe);if(!l)return t;for(var u=0;u<l.length;u++){for(var f=l[u],c=f.charAt(0),h=void 0,d=f.match(EEe)||[],v=d.length,g=0;g<v;g++)d[g]=parseFloat(d[g]);for(var y=0;y<v;){var b=void 0,w=void 0,_=void 0,x=void 0,E=void 0,R=void 0,A=void 0,N=r,I=n,F=void 0,H=void 0;switch(c){case"l":r+=d[y++],n+=d[y++],h=s.L,t.addData(h,r,n);break;case"L":r=d[y++],n=d[y++],h=s.L,t.addData(h,r,n);break;case"m":r+=d[y++],n+=d[y++],h=s.M,t.addData(h,r,n),i=r,a=n,c="l";break;case"M":r=d[y++],n=d[y++],h=s.M,t.addData(h,r,n),i=r,a=n,c="L";break;case"h":r+=d[y++],h=s.L,t.addData(h,r,n);break;case"H":r=d[y++],h=s.L,t.addData(h,r,n);break;case"v":n+=d[y++],h=s.L,t.addData(h,r,n);break;case"V":n=d[y++],h=s.L,t.addData(h,r,n);break;case"C":h=s.C,t.addData(h,d[y++],d[y++],d[y++],d[y++],d[y++],d[y++]),r=d[y-2],n=d[y-1];break;case"c":h=s.C,t.addData(h,d[y++]+r,d[y++]+n,d[y++]+r,d[y++]+n,d[y++]+r,d[y++]+n),r+=d[y-2],n+=d[y-1];break;case"S":b=r,w=n,F=t.len(),H=t.data,o===s.C&&(b+=r-H[F-4],w+=n-H[F-3]),h=s.C,N=d[y++],I=d[y++],r=d[y++],n=d[y++],t.addData(h,b,w,N,I,r,n);break;case"s":b=r,w=n,F=t.len(),H=t.data,o===s.C&&(b+=r-H[F-4],w+=n-H[F-3]),h=s.C,N=r+d[y++],I=n+d[y++],r+=d[y++],n+=d[y++],t.addData(h,b,w,N,I,r,n);break;case"Q":N=d[y++],I=d[y++],r=d[y++],n=d[y++],h=s.Q,t.addData(h,N,I,r,n);break;case"q":N=d[y++]+r,I=d[y++]+n,r+=d[y++],n+=d[y++],h=s.Q,t.addData(h,N,I,r,n);break;case"T":b=r,w=n,F=t.len(),H=t.data,o===s.Q&&(b+=r-H[F-4],w+=n-H[F-3]),r=d[y++],n=d[y++],h=s.Q,t.addData(h,b,w,r,n);break;case"t":b=r,w=n,F=t.len(),H=t.data,o===s.Q&&(b+=r-H[F-4],w+=n-H[F-3]),r+=d[y++],n+=d[y++],h=s.Q,t.addData(h,b,w,r,n);break;case"A":_=d[y++],x=d[y++],E=d[y++],R=d[y++],A=d[y++],N=r,I=n,r=d[y++],n=d[y++],h=s.A,iz(N,I,r,n,R,A,_,x,E,h,t);break;case"a":_=d[y++],x=d[y++],E=d[y++],R=d[y++],A=d[y++],N=r,I=n,r+=d[y++],n+=d[y++],h=s.A,iz(N,I,r,n,R,A,_,x,E,h,t);break}}(c==="z"||c==="Z")&&(h=s.Z,t.addData(h),r=i,n=a),o=h}return t.toStatic(),t}var jie=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.applyTransform=function(r){},t}(zr);function zie(e){return e.setData!=null}function Gie(e,t){var r=REe(e),n=et({},t);return n.buildPath=function(i){if(zie(i)){i.setData(r.data);var a=i.getContext();a&&i.rebuildPath(a,1)}else{var a=i;r.rebuildPath(a,1)}},n.applyTransform=function(i){TEe(r,i),this.dirtyShape()},n}function kEe(e,t){return new jie(Gie(e,t))}function AEe(e,t){var r=Gie(e,t),n=function(i){ct(a,i);function a(o){var s=i.call(this,o)||this;return s.applyTransform=r.applyTransform,s.buildPath=r.buildPath,s}return a}(jie);return n}function PEe(e,t){for(var r=[],n=e.length,i=0;i<n;i++){var a=e[i];r.push(a.getUpdatedPathProxy(!0))}var o=new zr(t);return o.createPathProxy(),o.buildPath=function(s){if(zie(s)){s.appendPath(r);var l=s.getContext();l&&s.rebuildPath(l,1)}},o}var IEe=function(){function e(){this.cx=0,this.cy=0,this.r=0}return e}(),Yie=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new IEe},t.prototype.buildPath=function(r,n){r.moveTo(n.cx+n.r,n.cy),r.arc(n.cx,n.cy,n.r,0,Math.PI*2)},t}(zr);Yie.prototype.type="circle";const c3=Yie;var MEe=function(){function e(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return e}(),Kie=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new MEe},t.prototype.buildPath=function(r,n){var i=.5522848,a=n.cx,o=n.cy,s=n.rx,l=n.ry,u=s*i,f=l*i;r.moveTo(a-s,o),r.bezierCurveTo(a-s,o-f,a-u,o-l,a,o-l),r.bezierCurveTo(a+u,o-l,a+s,o-f,a+s,o),r.bezierCurveTo(a+s,o+f,a+u,o+l,a,o+l),r.bezierCurveTo(a-u,o+l,a-s,o+f,a-s,o),r.closePath()},t}(zr);Kie.prototype.type="ellipse";const Xie=Kie;var qie=Math.PI,YI=qie*2,sh=Math.sin,Fv=Math.cos,DEe=Math.acos,ki=Math.atan2,az=Math.abs,Hb=Math.sqrt,yb=Math.max,Ys=Math.min,ps=1e-4;function $Ee(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=c*l-f*u;if(!(h*h<ps))return h=(f*(t-a)-c*(e-i))/h,[e+h*l,t+h*u]}function ax(e,t,r,n,i,a,o){var s=e-r,l=t-n,u=(o?a:-a)/Hb(s*s+l*l),f=u*l,c=-u*s,h=e+f,d=t+c,v=r+f,g=n+c,y=(h+v)/2,b=(d+g)/2,w=v-h,_=g-d,x=w*w+_*_,E=i-a,R=h*g-v*d,A=(_<0?-1:1)*Hb(yb(0,E*E*x-R*R)),N=(R*_-w*A)/x,I=(-R*w-_*A)/x,F=(R*_+w*A)/x,H=(-R*w+_*A)/x,W=N-y,z=I-b,te=F-y,ie=H-b;return W*W+z*z>te*te+ie*ie&&(N=F,I=H),{cx:N,cy:I,x0:-f,y0:-c,x1:N*(i/E-1),y1:I*(i/E-1)}}function NEe(e){var t;if(mt(e)){var r=e.length;if(!r)return e;r===1?t=[e[0],e[0],0,0]:r===2?t=[e[0],e[0],e[1],e[1]]:r===3?t=e.concat(e[2]):t=e}else t=[e,e,e,e];return t}function LEe(e,t){var r,n=yb(t.r,0),i=yb(t.r0||0,0),a=n>0,o=i>0;if(!(!a&&!o)){if(a||(n=i,i=0),i>n){var s=n;n=i,i=s}var l=t.startAngle,u=t.endAngle;if(!(isNaN(l)||isNaN(u))){var f=t.cx,c=t.cy,h=!!t.clockwise,d=az(u-l),v=d>YI&&d%YI;if(v>ps&&(d=v),!(n>ps))e.moveTo(f,c);else if(d>YI-ps)e.moveTo(f+n*Fv(l),c+n*sh(l)),e.arc(f,c,n,l,u,!h),i>ps&&(e.moveTo(f+i*Fv(u),c+i*sh(u)),e.arc(f,c,i,u,l,h));else{var g=void 0,y=void 0,b=void 0,w=void 0,_=void 0,x=void 0,E=void 0,R=void 0,A=void 0,N=void 0,I=void 0,F=void 0,H=void 0,W=void 0,z=void 0,te=void 0,ie=n*Fv(l),fe=n*sh(l),Te=i*Fv(u),M=i*sh(u),S=d>ps;if(S){var T=t.cornerRadius;T&&(r=NEe(T),g=r[0],y=r[1],b=r[2],w=r[3]);var k=az(n-i)/2;if(_=Ys(k,b),x=Ys(k,w),E=Ys(k,g),R=Ys(k,y),I=A=yb(_,x),F=N=yb(E,R),(A>ps||N>ps)&&(H=n*Fv(u),W=n*sh(u),z=i*Fv(l),te=i*sh(l),d<qie)){var O=$Ee(ie,fe,z,te,H,W,Te,M);if(O){var D=ie-O[0],L=fe-O[1],B=H-O[0],Y=W-O[1],Q=1/sh(DEe((D*B+L*Y)/(Hb(D*D+L*L)*Hb(B*B+Y*Y)))/2),he=Hb(O[0]*O[0]+O[1]*O[1]);I=Ys(A,(n-he)/(Q+1)),F=Ys(N,(i-he)/(Q-1))}}}if(!S)e.moveTo(f+ie,c+fe);else if(I>ps){var ce=Ys(b,I),le=Ys(w,I),xe=ax(z,te,ie,fe,n,ce,h),U=ax(H,W,Te,M,n,le,h);e.moveTo(f+xe.cx+xe.x0,c+xe.cy+xe.y0),I<A&&ce===le?e.arc(f+xe.cx,c+xe.cy,I,ki(xe.y0,xe.x0),ki(U.y0,U.x0),!h):(ce>0&&e.arc(f+xe.cx,c+xe.cy,ce,ki(xe.y0,xe.x0),ki(xe.y1,xe.x1),!h),e.arc(f,c,n,ki(xe.cy+xe.y1,xe.cx+xe.x1),ki(U.cy+U.y1,U.cx+U.x1),!h),le>0&&e.arc(f+U.cx,c+U.cy,le,ki(U.y1,U.x1),ki(U.y0,U.x0),!h))}else e.moveTo(f+ie,c+fe),e.arc(f,c,n,l,u,!h);if(!(i>ps)||!S)e.lineTo(f+Te,c+M);else if(F>ps){var ce=Ys(g,F),le=Ys(y,F),xe=ax(Te,M,H,W,i,-le,h),U=ax(ie,fe,z,te,i,-ce,h);e.lineTo(f+xe.cx+xe.x0,c+xe.cy+xe.y0),F<N&&ce===le?e.arc(f+xe.cx,c+xe.cy,F,ki(xe.y0,xe.x0),ki(U.y0,U.x0),!h):(le>0&&e.arc(f+xe.cx,c+xe.cy,le,ki(xe.y0,xe.x0),ki(xe.y1,xe.x1),!h),e.arc(f,c,i,ki(xe.cy+xe.y1,xe.cx+xe.x1),ki(U.cy+U.y1,U.cx+U.x1),h),ce>0&&e.arc(f+U.cx,c+U.cy,ce,ki(U.y1,U.x1),ki(U.y0,U.x0),!h))}else e.lineTo(f+Te,c+M),e.arc(f,c,i,u,l,h)}e.closePath()}}}var FEe=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return e}(),Zie=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new FEe},t.prototype.buildPath=function(r,n){LEe(r,n)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(zr);Zie.prototype.type="sector";const Xd=Zie;var HEe=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return e}(),Jie=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new HEe},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.PI*2;r.moveTo(i+n.r,a),r.arc(i,a,n.r,0,o,!1),r.moveTo(i+n.r0,a),r.arc(i,a,n.r0,0,o,!0)},t}(zr);Jie.prototype.type="ring";const Qie=Jie;function BEe(e,t,r,n){var i=[],a=[],o=[],s=[],l,u,f,c;if(n){f=[1/0,1/0],c=[-1/0,-1/0];for(var h=0,d=e.length;h<d;h++)Ap(f,f,e[h]),Pp(c,c,e[h]);Ap(f,f,n[0]),Pp(c,c,n[1])}for(var h=0,d=e.length;h<d;h++){var v=e[h];if(r)l=e[h?h-1:d-1],u=e[(h+1)%d];else if(h===0||h===d-1){i.push(lxe(e[h]));continue}else l=e[h-1],u=e[h+1];uxe(a,u,l),fI(a,a,t);var g=w$(v,l),y=w$(v,u),b=g+y;b!==0&&(g/=b,y/=b),fI(o,a,-g),fI(s,a,y);var w=Z5([],v,o),_=Z5([],v,s);n&&(Pp(w,w,f),Ap(w,w,c),Pp(_,_,f),Ap(_,_,c)),i.push(w),i.push(_)}return r&&i.push(i.shift()),i}function eae(e,t,r){var n=t.smooth,i=t.points;if(i&&i.length>=2){if(n){var a=BEe(i,n,r,t.smoothConstraint);e.moveTo(i[0][0],i[0][1]);for(var o=i.length,s=0;s<(r?o:o-1);s++){var l=a[s*2],u=a[s*2+1],f=i[(s+1)%o];e.bezierCurveTo(l[0],l[1],u[0],u[1],f[0],f[1])}}else{e.moveTo(i[0][0],i[0][1]);for(var s=1,c=i.length;s<c;s++)e.lineTo(i[s][0],i[s][1])}r&&e.closePath()}}var WEe=function(){function e(){this.points=null,this.smooth=0,this.smoothConstraint=null}return e}(),tae=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new WEe},t.prototype.buildPath=function(r,n){eae(r,n,!0)},t}(zr);tae.prototype.type="polygon";const rae=tae;var VEe=function(){function e(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return e}(),nae=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new VEe},t.prototype.buildPath=function(r,n){eae(r,n,!1)},t}(zr);nae.prototype.type="polyline";const gk=nae;var UEe={},jEe=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return e}(),iae=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new jEe},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=Aie(UEe,n,this.style);i=l.x1,a=l.y1,o=l.x2,s=l.y2}else i=n.x1,a=n.y1,o=n.x2,s=n.y2;var u=n.percent;u!==0&&(r.moveTo(i,a),u<1&&(o=i*(1-u)+o*u,s=a*(1-u)+s*u),r.lineTo(o,s))},t.prototype.pointAt=function(r){var n=this.shape;return[n.x1*(1-r)+n.x2*r,n.y1*(1-r)+n.y2*r]},t}(zr);iae.prototype.type="line";const Rd=iae;var Oa=[],zEe=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return e}();function oz(e,t,r){var n=e.cpx2,i=e.cpy2;return n!=null||i!=null?[(r?l6:si)(e.x1,e.cpx1,e.cpx2,e.x2,t),(r?l6:si)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(r?u6:Ii)(e.x1,e.cpx1,e.x2,t),(r?u6:Ii)(e.y1,e.cpy1,e.y2,t)]}var aae=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new zEe},t.prototype.buildPath=function(r,n){var i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.cpx1,u=n.cpy1,f=n.cpx2,c=n.cpy2,h=n.percent;h!==0&&(r.moveTo(i,a),f==null||c==null?(h<1&&(sE(i,l,o,h,Oa),l=Oa[1],o=Oa[2],sE(a,u,s,h,Oa),u=Oa[1],s=Oa[2]),r.quadraticCurveTo(l,u,o,s)):(h<1&&(oE(i,l,f,o,h,Oa),l=Oa[1],f=Oa[2],o=Oa[3],oE(a,u,c,s,h,Oa),u=Oa[1],c=Oa[2],s=Oa[3]),r.bezierCurveTo(l,u,f,c,o,s)))},t.prototype.pointAt=function(r){return oz(this.shape,r,!1)},t.prototype.tangentAt=function(r){var n=oz(this.shape,r,!0);return hxe(n,n)},t}(zr);aae.prototype.type="bezier-curve";const oae=aae;var GEe=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),sae=function(e){ct(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new GEe},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r,0),s=n.startAngle,l=n.endAngle,u=n.clockwise,f=Math.cos(s),c=Math.sin(s);r.moveTo(f*o+i,c*o+a),r.arc(i,a,o,s,l,!u)},t}(zr);sae.prototype.type="arc";const h3=sae;var YEe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="compound",r}return t.prototype._updatePathDirty=function(){for(var r=this.shape.paths,n=this.shapeChanged(),i=0;i<r.length;i++)n=n||r[i].shapeChanged();n&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var r=this.shape.paths||[],n=this.getGlobalScale(),i=0;i<r.length;i++)r[i].path||r[i].createPathProxy(),r[i].path.setScale(n[0],n[1],r[i].segmentIgnoreThreshold)},t.prototype.buildPath=function(r,n){for(var i=n.paths||[],a=0;a<i.length;a++)i[a].buildPath(r,i[a].shape,!0)},t.prototype.afterBrush=function(){for(var r=this.shape.paths||[],n=0;n<r.length;n++)r[n].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),zr.prototype.getBoundingRect.call(this)},t}(zr);const KEe=YEe;var XEe=function(){function e(t){this.colorStops=t||[]}return e.prototype.addColorStop=function(t,r){this.colorStops.push({offset:t,color:r})},e}();const lae=XEe;var qEe=function(e){ct(t,e);function t(r,n,i,a,o,s){var l=e.call(this,o)||this;return l.x=r??0,l.y=n??0,l.x2=i??1,l.y2=a??0,l.type="linear",l.global=s||!1,l}return t}(lae);const uae=qEe;var ZEe=function(e){ct(t,e);function t(r,n,i,a,o){var s=e.call(this,a)||this;return s.x=r??.5,s.y=n??.5,s.r=i??.5,s.type="radial",s.global=o||!1,s}return t}(lae);const JEe=ZEe;var lh=[0,0],uh=[0,0],ox=new Yt,sx=new Yt,QEe=function(){function e(t,r){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new Yt;for(var n=0;n<2;n++)this._axes[n]=new Yt;t&&this.fromBoundingRect(t,r)}return e.prototype.fromBoundingRect=function(t,r){var n=this._corners,i=this._axes,a=t.x,o=t.y,s=a+t.width,l=o+t.height;if(n[0].set(a,o),n[1].set(s,o),n[2].set(s,l),n[3].set(a,l),r)for(var u=0;u<4;u++)n[u].transform(r);Yt.sub(i[0],n[1],n[0]),Yt.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(var u=0;u<2;u++)this._origin[u]=i[u].dot(n[0])},e.prototype.intersect=function(t,r){var n=!0,i=!r;return ox.set(1/0,1/0),sx.set(0,0),!this._intersectCheckOneSide(this,t,ox,sx,i,1)&&(n=!1,i)||!this._intersectCheckOneSide(t,this,ox,sx,i,-1)&&(n=!1,i)||i||Yt.copy(r,n?ox:sx),n},e.prototype._intersectCheckOneSide=function(t,r,n,i,a,o){for(var s=!0,l=0;l<2;l++){var u=this._axes[l];if(this._getProjMinMaxOnAxis(l,t._corners,lh),this._getProjMinMaxOnAxis(l,r._corners,uh),lh[1]<uh[0]||lh[0]>uh[1]){if(s=!1,a)return s;var f=Math.abs(uh[0]-lh[1]),c=Math.abs(lh[0]-uh[1]);Math.min(f,c)>i.len()&&(f<c?Yt.scale(i,u,-f*o):Yt.scale(i,u,c*o))}else if(n){var f=Math.abs(uh[0]-lh[1]),c=Math.abs(lh[0]-uh[1]);Math.min(f,c)<n.len()&&(f<c?Yt.scale(n,u,f*o):Yt.scale(n,u,-c*o))}}return s},e.prototype._getProjMinMaxOnAxis=function(t,r,n){for(var i=this._axes[t],a=this._origin,o=r[0].dot(i)+a[t],s=o,l=o,u=1;u<r.length;u++){var f=r[u].dot(i)+a[t];s=Math.min(f,s),l=Math.max(f,l)}n[0]=s,n[1]=l},e}();const yE=QEe;var eRe=[],tRe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.notClear=!0,r.incremental=!0,r._displayables=[],r._temporaryDisplayables=[],r._cursor=0,r}return t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(r,n){n?this._temporaryDisplayables.push(r):this._displayables.push(r),this.markRedraw()},t.prototype.addDisplayables=function(r,n){n=n||!1;for(var i=0;i<r.length;i++)this.addDisplayable(r[i],n)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(r){for(var n=this._cursor;n<this._displayables.length;n++)r&&r(this._displayables[n]);for(var n=0;n<this._temporaryDisplayables.length;n++)r&&r(this._temporaryDisplayables[n])},t.prototype.update=function(){this.updateTransform();for(var r=this._cursor;r<this._displayables.length;r++){var n=this._displayables[r];n.parent=this,n.update(),n.parent=null}for(var r=0;r<this._temporaryDisplayables.length;r++){var n=this._temporaryDisplayables[r];n.parent=this,n.update(),n.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var r=new Br(1/0,1/0,-1/0,-1/0),n=0;n<this._displayables.length;n++){var i=this._displayables[n],a=i.getBoundingRect().clone();i.needLocalTransform()&&a.applyTransform(i.getLocalTransform(eRe)),r.union(a)}this._rect=r}return this._rect},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(a.contain(i[0],i[1]))for(var o=0;o<this._displayables.length;o++){var s=this._displayables[o];if(s.contain(r,n))return!0}return!1},t}(QS);const rRe=tRe;var nRe=ti();function iRe(e,t,r,n,i){var a;if(t&&t.ecModel){var o=t.ecModel.getUpdatePayload();a=o&&o.animation}var s=t&&t.isAnimationEnabled(),l=e==="update";if(s){var u=void 0,f=void 0,c=void 0;n?(u=Tr(n.duration,200),f=Tr(n.easing,"cubicOut"),c=0):(u=t.getShallow(l?"animationDurationUpdate":"animationDuration"),f=t.getShallow(l?"animationEasingUpdate":"animationEasing"),c=t.getShallow(l?"animationDelayUpdate":"animationDelay")),a&&(a.duration!=null&&(u=a.duration),a.easing!=null&&(f=a.easing),a.delay!=null&&(c=a.delay)),lr(c)&&(c=c(r,i)),lr(u)&&(u=u(r));var h={duration:u||0,delay:c,easing:f};return h}else return null}function d3(e,t,r,n,i,a,o){var s=!1,l;lr(i)?(o=a,a=i,i=null):$t(i)&&(a=i.cb,o=i.during,s=i.isFrom,l=i.removeOpt,i=i.dataIndex);var u=e==="leave";u||t.stopAnimation("leave");var f=iRe(e,n,i,u?l||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(t,i):null);if(f&&f.duration>0){var c=f.duration,h=f.delay,d=f.easing,v={duration:c,delay:h||0,easing:d,done:a,force:!!a||!!o,setToFinal:!u,scope:e,during:o};s?t.animateFrom(r,v):t.animateTo(r,v)}else t.stopAnimation(),!s&&t.attr(r),o&&o(1),a&&a()}function ga(e,t,r,n,i,a){d3("update",e,t,r,n,i,a)}function zo(e,t,r,n,i,a){d3("enter",e,t,r,n,i,a)}function Bb(e){if(!e.__zr)return!0;for(var t=0;t<e.animators.length;t++){var r=e.animators[t];if(r.scope==="leave")return!0}return!1}function mE(e,t,r,n,i,a){Bb(e)||d3("leave",e,t,r,n,i,a)}function sz(e,t,r,n){e.removeTextContent(),e.removeTextGuideLine(),mE(e,{style:{opacity:0}},t,r,n)}function bE(e,t,r){function n(){e.parent&&e.parent.remove(e)}e.isGroup?e.traverse(function(i){i.isGroup||sz(i,t,r,n)}):sz(e,t,r,n)}function v3(e){nRe(e).oldStyle=e.style}var wE=Math.max,_E=Math.min,X$={};function aRe(e){return zr.extend(e)}var oRe=AEe;function sRe(e,t){return oRe(e,t)}function Ls(e,t){X$[e]=t}function lRe(e){if(X$.hasOwnProperty(e))return X$[e]}function p3(e,t,r,n){var i=kEe(e,t);return r&&(n==="center"&&(r=cae(r,i.getBoundingRect())),hae(i,r)),i}function fae(e,t,r){var n=new Kd({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(i){if(r==="center"){var a={width:i.width,height:i.height};n.setStyle(cae(t,a))}}});return n}function cae(e,t){var r=t.width/t.height,n=e.height*r,i;n<=e.width?i=e.height:(n=e.width,i=n/r);var a=e.x+e.width/2,o=e.y+e.height/2;return{x:a-n/2,y:o-i/2,width:n,height:i}}var uRe=PEe;function hae(e,t){if(e.applyTransform){var r=e.getBoundingRect(),n=r.calculateTransform(t);e.applyTransform(n)}}function Tw(e,t){return Aie(e,e,{lineWidth:t}),e}function fRe(e){return Pie(e.shape,e.shape,e.style),e}var cRe=Hh;function hRe(e,t){for(var r=XB([]);e&&e!==t;)jp(r,e.getLocalTransform(),r),e=e.parent;return r}function g3(e,t,r){return t&&!Fa(t)&&(t=QB.getLocalTransform(t)),r&&(t=ZB([],t)),jo([],e,t)}function dRe(e,t,r){var n=t[4]===0||t[5]===0||t[0]===0?1:Math.abs(2*t[4]/t[0]),i=t[4]===0||t[5]===0||t[2]===0?1:Math.abs(2*t[4]/t[2]),a=[e==="left"?-n:e==="right"?n:0,e==="top"?-i:e==="bottom"?i:0];return a=g3(a,t,r),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function lz(e){return!e.isGroup}function vRe(e){return e.shape!=null}function dae(e,t,r){if(!e||!t)return;function n(o){var s={};return o.traverse(function(l){lz(l)&&l.anid&&(s[l.anid]=l)}),s}function i(o){var s={x:o.x,y:o.y,rotation:o.rotation};return vRe(o)&&(s.shape=et({},o.shape)),s}var a=n(e);t.traverse(function(o){if(lz(o)&&o.anid){var s=a[o.anid];if(s){var l=i(o);o.attr(i(s)),ga(o,l,r,Ur(o).dataIndex)}}})}function pRe(e,t){return Lt(e,function(r){var n=r[0];n=wE(n,t.x),n=_E(n,t.x+t.width);var i=r[1];return i=wE(i,t.y),i=_E(i,t.y+t.height),[n,i]})}function gRe(e,t){var r=wE(e.x,t.x),n=_E(e.x+e.width,t.x+t.width),i=wE(e.y,t.y),a=_E(e.y+e.height,t.y+t.height);if(n>=r&&a>=i)return{x:r,y:i,width:n-r,height:a-i}}function y3(e,t,r){var n=et({rectHover:!0},t),i=n.style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},e)return e.indexOf("image://")===0?(i.image=e.slice(8),Vr(i,r),new Kd(n)):p3(e.replace("path://",""),n,r,"center")}function yRe(e,t,r,n,i){for(var a=0,o=i[i.length-1];a<i.length;a++){var s=i[a];if(vae(e,t,r,n,s[0],s[1],o[0],o[1]))return!0;o=s}}function vae(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=KI(f,c,l,u);if(mRe(h))return!1;var d=e-i,v=t-a,g=KI(d,v,l,u)/h;if(g<0||g>1)return!1;var y=KI(d,v,f,c)/h;return!(y<0||y>1)}function KI(e,t,r,n){return e*n-r*t}function mRe(e){return e<=1e-6&&e>=-1e-6}function m3(e){var t=e.itemTooltipOption,r=e.componentModel,n=e.itemName,i=Rt(t)?{formatter:t}:t,a=r.mainType,o=r.componentIndex,s={componentType:a,name:n,$vars:["name"]};s[a+"Index"]=o;var l=e.formatterParamsExtra;l&&ye(yn(l),function(f){dg(s,f)||(s[f]=l[f],s.$vars.push(f))});var u=Ur(e.el);u.componentMainType=a,u.componentIndex=o,u.tooltipConfig={name:n,option:Vr({content:n,formatterParams:s},i)}}function uz(e,t){var r;e.isGroup&&(r=t(e)),r||e.traverse(t)}function yk(e,t){if(e)if(mt(e))for(var r=0;r<e.length;r++)uz(e[r],t);else uz(e,t)}Ls("circle",c3);Ls("ellipse",Xie);Ls("sector",Xd);Ls("ring",Qie);Ls("polygon",rae);Ls("polyline",gk);Ls("rect",ci);Ls("line",Rd);Ls("bezierCurve",oae);Ls("arc",h3);const bRe=Object.freeze(Object.defineProperty({__proto__:null,Arc:h3,BezierCurve:oae,BoundingRect:Br,Circle:c3,CompoundPath:KEe,Ellipse:Xie,Group:Wi,Image:Kd,IncrementalDisplayable:rRe,Line:Rd,LinearGradient:uae,OrientedBoundingRect:yE,Path:zr,Point:Yt,Polygon:rae,Polyline:gk,RadialGradient:JEe,Rect:ci,Ring:Qie,Sector:Xd,Text:Vi,applyTransform:g3,clipPointsByRect:pRe,clipRectByRect:gRe,createIcon:y3,extendPath:sRe,extendShape:aRe,getShapeClass:lRe,getTransform:hRe,groupTransition:dae,initProps:zo,isElementRemoved:Bb,lineLineIntersect:vae,linePolygonIntersect:yRe,makeImage:fae,makePath:p3,mergePath:uRe,registerShape:Ls,removeElement:mE,removeElementWithFadeOut:bE,resizePath:hae,setTooltipConfig:m3,subPixelOptimize:cRe,subPixelOptimizeLine:Tw,subPixelOptimizeRect:fRe,transformDirection:dRe,traverseElements:yk,updateProps:ga},Symbol.toStringTag,{value:"Module"}));var mk={};function wRe(e,t){for(var r=0;r<Go.length;r++){var n=Go[r],i=t[n],a=e.ensureState(n);a.style=a.style||{},a.style.text=i}var o=e.currentStates.slice();e.clearStates(!0),e.setStyle({text:t.normal}),e.useStates(o,!0)}function fz(e,t,r){var n=e.labelFetcher,i=e.labelDataIndex,a=e.labelDimIndex,o=t.normal,s;n&&(s=n.getFormattedLabel(i,"normal",null,a,o&&o.get("formatter"),r!=null?{interpolatedValue:r}:null)),s==null&&(s=lr(e.defaultText)?e.defaultText(i,e,r):e.defaultText);for(var l={normal:s},u=0;u<Go.length;u++){var f=Go[u],c=t[f];l[f]=Tr(n?n.getFormattedLabel(i,f,null,a,c&&c.get("formatter")):null,s)}return l}function e1(e,t,r,n){r=r||mk;for(var i=e instanceof Vi,a=!1,o=0;o<dE.length;o++){var s=t[dE[o]];if(s&&s.getShallow("show")){a=!0;break}}var l=i?e:e.getTextContent();if(a){i||(l||(l=new Vi,e.setTextContent(l)),e.stateProxy&&(l.stateProxy=e.stateProxy));var u=fz(r,t),f=t.normal,c=!!f.getShallow("show"),h=Sc(f,n&&n.normal,r,!1,!i);h.text=u.normal,i||e.setTextConfig(cz(f,r,!1));for(var o=0;o<Go.length;o++){var d=Go[o],s=t[d];if(s){var v=l.ensureState(d),g=!!Tr(s.getShallow("show"),c);if(g!==c&&(v.ignore=!g),v.style=Sc(s,n&&n[d],r,!0,!i),v.style.text=u[d],!i){var y=e.ensureState(d);y.textConfig=cz(s,r,!0)}}}l.silent=!!f.getShallow("silent"),l.style.x!=null&&(h.x=l.style.x),l.style.y!=null&&(h.y=l.style.y),l.ignore=!c,l.useStyle(h),l.dirty(),r.enableTextSetter&&(bk(l).setLabelText=function(b){var w=fz(r,t,b);wRe(l,w)})}else l&&(l.ignore=!0);e.dirty()}function t1(e,t){t=t||"label";for(var r={normal:e.getModel(t)},n=0;n<Go.length;n++){var i=Go[n];r[i]=e.getModel([i,t])}return r}function Sc(e,t,r,n,i){var a={};return _Re(a,e,r,n,i),t&&et(a,t),a}function cz(e,t,r){t=t||{};var n={},i,a=e.getShallow("rotate"),o=Tr(e.getShallow("distance"),r?null:5),s=e.getShallow("offset");return i=e.getShallow("position")||(r?null:"inside"),i==="outside"&&(i=t.defaultOutsidePosition||"top"),i!=null&&(n.position=i),s!=null&&(n.offset=s),a!=null&&(a*=Math.PI/180,n.rotation=a),o!=null&&(n.distance=o),n.outsideFill=e.get("color")==="inherit"?t.inheritColor||null:"auto",n}function _Re(e,t,r,n,i){r=r||mk;var a=t.ecModel,o=a&&a.option.textStyle,s=SRe(t),l;if(s){l={};for(var u in s)if(s.hasOwnProperty(u)){var f=t.getModel(["rich",u]);pz(l[u]={},f,o,r,n,i,!1,!0)}}l&&(e.rich=l);var c=t.get("overflow");c&&(e.overflow=c);var h=t.get("minMargin");h!=null&&(e.margin=h),pz(e,t,o,r,n,i,!0,!1)}function SRe(e){for(var t;e&&e!==e.ecModel;){var r=(e.option||mk).rich;if(r){t=t||{};for(var n=yn(r),i=0;i<n.length;i++){var a=n[i];t[a]=1}}e=e.parentModel}return t}var hz=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],dz=["align","lineHeight","width","height","tag","verticalAlign"],vz=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function pz(e,t,r,n,i,a,o,s){r=!i&&r||mk;var l=n&&n.inheritColor,u=t.getShallow("color"),f=t.getShallow("textBorderColor"),c=Tr(t.getShallow("opacity"),r.opacity);(u==="inherit"||u==="auto")&&(l?u=l:u=null),(f==="inherit"||f==="auto")&&(l?f=l:f=null),a||(u=u||r.color,f=f||r.textBorderColor),u!=null&&(e.fill=u),f!=null&&(e.stroke=f);var h=Tr(t.getShallow("textBorderWidth"),r.textBorderWidth);h!=null&&(e.lineWidth=h);var d=Tr(t.getShallow("textBorderType"),r.textBorderType);d!=null&&(e.lineDash=d);var v=Tr(t.getShallow("textBorderDashOffset"),r.textBorderDashOffset);v!=null&&(e.lineDashOffset=v),!i&&c==null&&!s&&(c=n&&n.defaultOpacity),c!=null&&(e.opacity=c),!i&&!a&&e.fill==null&&n.inheritColor&&(e.fill=n.inheritColor);for(var g=0;g<hz.length;g++){var y=hz[g],b=Tr(t.getShallow(y),r[y]);b!=null&&(e[y]=b)}for(var g=0;g<dz.length;g++){var y=dz[g],b=t.getShallow(y);b!=null&&(e[y]=b)}if(e.verticalAlign==null){var w=t.getShallow("baseline");w!=null&&(e.verticalAlign=w)}if(!o||!n.disableBox){for(var g=0;g<vz.length;g++){var y=vz[g],b=t.getShallow(y);b!=null&&(e[y]=b)}var _=t.getShallow("borderType");_!=null&&(e.borderDash=_),(e.backgroundColor==="auto"||e.backgroundColor==="inherit")&&l&&(e.backgroundColor=l),(e.borderColor==="auto"||e.borderColor==="inherit")&&l&&(e.borderColor=l)}}function CRe(e,t){var r=t&&t.getModel("textStyle");return dl([e.fontStyle||r&&r.getShallow("fontStyle")||"",e.fontWeight||r&&r.getShallow("fontWeight")||"",(e.fontSize||r&&r.getShallow("fontSize")||12)+"px",e.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}var bk=ti();function xRe(e,t,r,n){if(e){var i=bk(e);i.prevValue=i.value,i.value=r;var a=t.normal;i.valueAnimation=a.get("valueAnimation"),i.valueAnimation&&(i.precision=a.get("precision"),i.defaultInterpolatedText=n,i.statesModels=t)}}var TRe=["textStyle","color"],XI=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],qI=new Vi,ORe=function(){function e(){}return e.prototype.getTextColor=function(t){var r=this.ecModel;return this.getShallow("color")||(!t&&r?r.get(TRe):null)},e.prototype.getFont=function(){return CRe({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},e.prototype.getTextRect=function(t){for(var r={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<XI.length;n++)r[XI[n]]=this.getShallow(XI[n]);return qI.useStyle(r),qI.update(),qI.getBoundingRect()},e}();const ERe=ORe;var pae=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],RRe=Cw(pae),kRe=function(){function e(){}return e.prototype.getLineStyle=function(t){return RRe(this,t)},e}(),gae=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],ARe=Cw(gae),PRe=function(){function e(){}return e.prototype.getItemStyle=function(t,r){return ARe(this,t,r)},e}(),qd=function(){function e(t,r,n){this.parentModel=r,this.ecModel=n,this.option=t}return e.prototype.init=function(t,r,n){},e.prototype.mergeOption=function(t,r){Hr(this.option,t,!0)},e.prototype.get=function(t,r){return t==null?this.option:this._doGet(this.parsePath(t),!r&&this.parentModel)},e.prototype.getShallow=function(t,r){var n=this.option,i=n==null?n:n[t];if(i==null&&!r){var a=this.parentModel;a&&(i=a.getShallow(t))}return i},e.prototype.getModel=function(t,r){var n=t!=null,i=n?this.parsePath(t):null,a=n?this._doGet(i):this.option;return r=r||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new e(a,r,this.ecModel)},e.prototype.isEmpty=function(){return this.option==null},e.prototype.restoreData=function(){},e.prototype.clone=function(){var t=this.constructor;return new t(Rr(this.option))},e.prototype.parsePath=function(t){return typeof t=="string"?t.split("."):t},e.prototype.resolveParentPath=function(t){return t},e.prototype.isAnimationEnabled=function(){if(!vr.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},e.prototype._doGet=function(t,r){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&!(t[i]&&(n=n&&typeof n=="object"?n[t[i]]:null,n==null));i++);return n==null&&r&&(n=r._doGet(this.resolveParentPath(t),r.parentModel)),n},e}();o3(qd);oOe(qd);Sl(qd,kRe);Sl(qd,PRe);Sl(qd,cOe);Sl(qd,ERe);const Li=qd;var IRe=Math.round(Math.random()*10);function wk(e){return[e||"",IRe++].join("_")}function MRe(e){var t={};e.registerSubTypeDefaulter=function(r,n){var i=vl(r);t[i.main]=n},e.determineSubType=function(r,n){var i=n.type;if(!i){var a=vl(r).main;e.hasSubTypes(r)&&t[a]&&(i=t[a](n))}return i}}function DRe(e,t){e.topologicalTravel=function(a,o,s,l){if(!a.length)return;var u=r(o),f=u.graph,c=u.noEntryList,h={};for(ye(a,function(w){h[w]=!0});c.length;){var d=c.pop(),v=f[d],g=!!h[d];g&&(s.call(l,d,v.originalDeps.slice()),delete h[d]),ye(v.successor,g?b:y)}ye(h,function(){var w="";throw new Error(w)});function y(w){f[w].entryCount--,f[w].entryCount===0&&c.push(w)}function b(w){h[w]=!0,y(w)}};function r(a){var o={},s=[];return ye(a,function(l){var u=n(o,l),f=u.originalDeps=t(l),c=i(f,a);u.entryCount=c.length,u.entryCount===0&&s.push(l),ye(c,function(h){Xr(u.predecessor,h)<0&&u.predecessor.push(h);var d=n(o,h);Xr(d.successor,h)<0&&d.successor.push(l)})}),{graph:o,noEntryList:s}}function n(a,o){return a[o]||(a[o]={predecessor:[],successor:[]}),a[o]}function i(a,o){var s=[];return ye(a,function(l){Xr(o,l)>=0&&s.push(l)}),s}}function yae(e,t){return Hr(Hr({},e,!0),t,!0)}const $Re={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},NRe={time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}};var SE="ZH",b3="EN",Ow=b3,nO={},w3={},mae=vr.domSupported?function(){var e=(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase();return e.indexOf(SE)>-1?SE:Ow}():Ow;function bae(e,t){e=e.toUpperCase(),w3[e]=new Li(t),nO[e]=t}function LRe(e){if(Rt(e)){var t=nO[e.toUpperCase()]||{};return e===SE||e===b3?Rr(t):Hr(Rr(t),Rr(nO[Ow]),!1)}else return Hr(Rr(e),Rr(nO[Ow]),!1)}function FRe(e){return w3[e]}function HRe(){return w3[Ow]}bae(b3,$Re);bae(SE,NRe);var _3=1e3,S3=_3*60,Wb=S3*60,Vo=Wb*24,gz=Vo*365,mb={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},lx="{yyyy}-{MM}-{dd}",yz={year:"{yyyy}",month:"{yyyy}-{MM}",day:lx,hour:lx+" "+mb.hour,minute:lx+" "+mb.minute,second:lx+" "+mb.second,millisecond:mb.none},ZI=["year","month","day","hour","minute","second","millisecond"],wae=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function fh(e,t){return e+="","0000".substr(0,t-e.length)+e}function Gp(e){switch(e){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return e}}function BRe(e){return e===Gp(e)}function WRe(e){switch(e){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function _k(e,t,r,n){var i=Wu(e),a=i[C3(r)](),o=i[Yp(r)]()+1,s=Math.floor((o-1)/3)+1,l=i[Sk(r)](),u=i["get"+(r?"UTC":"")+"Day"](),f=i[Ew(r)](),c=(f-1)%12+1,h=i[Ck(r)](),d=i[xk(r)](),v=i[Tk(r)](),g=n instanceof Li?n:FRe(n||mae)||HRe(),y=g.getModel("time"),b=y.get("month"),w=y.get("monthAbbr"),_=y.get("dayOfWeek"),x=y.get("dayOfWeekAbbr");return(t||"").replace(/{yyyy}/g,a+"").replace(/{yy}/g,a%100+"").replace(/{Q}/g,s+"").replace(/{MMMM}/g,b[o-1]).replace(/{MMM}/g,w[o-1]).replace(/{MM}/g,fh(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,fh(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,_[u]).replace(/{ee}/g,x[u]).replace(/{e}/g,u+"").replace(/{HH}/g,fh(f,2)).replace(/{H}/g,f+"").replace(/{hh}/g,fh(c+"",2)).replace(/{h}/g,c+"").replace(/{mm}/g,fh(h,2)).replace(/{m}/g,h+"").replace(/{ss}/g,fh(d,2)).replace(/{s}/g,d+"").replace(/{SSS}/g,fh(v,3)).replace(/{S}/g,v+"")}function VRe(e,t,r,n,i){var a=null;if(Rt(r))a=r;else if(lr(r))a=r(e.value,t,{level:e.level});else{var o=et({},mb);if(e.level>0)for(var s=0;s<ZI.length;++s)o[ZI[s]]="{primary|"+o[ZI[s]]+"}";var l=r?r.inherit===!1?r:Vr(r,o):o,u=_ae(e.value,i);if(l[u])a=l[u];else if(l.inherit){for(var f=wae.indexOf(u),s=f-1;s>=0;--s)if(l[u]){a=l[u];break}a=a||o.none}if(mt(a)){var c=e.level==null?0:e.level>=0?e.level:a.length+e.level;c=Math.min(c,a.length-1),a=a[c]}}return _k(new Date(e.value),a,i,n)}function _ae(e,t){var r=Wu(e),n=r[Yp(t)]()+1,i=r[Sk(t)](),a=r[Ew(t)](),o=r[Ck(t)](),s=r[xk(t)](),l=r[Tk(t)](),u=l===0,f=u&&s===0,c=f&&o===0,h=c&&a===0,d=h&&i===1,v=d&&n===1;return v?"year":d?"month":h?"day":c?"hour":f?"minute":u?"second":"millisecond"}function mz(e,t,r){var n=en(e)?Wu(e):e;switch(t=t||_ae(e,r),t){case"year":return n[C3(r)]();case"half-year":return n[Yp(r)]()>=6?1:0;case"quarter":return Math.floor((n[Yp(r)]()+1)/4);case"month":return n[Yp(r)]();case"day":return n[Sk(r)]();case"half-day":return n[Ew(r)]()/24;case"hour":return n[Ew(r)]();case"minute":return n[Ck(r)]();case"second":return n[xk(r)]();case"millisecond":return n[Tk(r)]()}}function C3(e){return e?"getUTCFullYear":"getFullYear"}function Yp(e){return e?"getUTCMonth":"getMonth"}function Sk(e){return e?"getUTCDate":"getDate"}function Ew(e){return e?"getUTCHours":"getHours"}function Ck(e){return e?"getUTCMinutes":"getMinutes"}function xk(e){return e?"getUTCSeconds":"getSeconds"}function Tk(e){return e?"getUTCMilliseconds":"getMilliseconds"}function URe(e){return e?"setUTCFullYear":"setFullYear"}function Sae(e){return e?"setUTCMonth":"setMonth"}function Cae(e){return e?"setUTCDate":"setDate"}function xae(e){return e?"setUTCHours":"setHours"}function Tae(e){return e?"setUTCMinutes":"setMinutes"}function Oae(e){return e?"setUTCSeconds":"setSeconds"}function Eae(e){return e?"setUTCMilliseconds":"setMilliseconds"}function Rae(e){if(!HTe(e))return Rt(e)?e:"-";var t=(e+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function kae(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(r,n){return n.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var Ok=Bne;function q$(e,t,r){var n="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(f){return f&&dl(f)?f:"-"}function a(f){return!!(f!=null&&!isNaN(f)&&isFinite(f))}var o=t==="time",s=e instanceof Date;if(o||s){var l=o?Wu(e):e;if(isNaN(+l)){if(s)return"-"}else return _k(l,n,r)}if(t==="ordinal")return m$(e)?i(e):en(e)&&a(e)?e+"":"-";var u=hE(e);return a(u)?Rae(u):m$(e)?i(e):typeof e=="boolean"?e+"":"-"}var bz=["a","b","c","d","e","f","g"],JI=function(e,t){return"{"+e+(t??"")+"}"};function Aae(e,t,r){mt(t)||(t=[t]);var n=t.length;if(!n)return"";for(var i=t[0].$vars||[],a=0;a<i.length;a++){var o=bz[a];e=e.replace(JI(o),JI(o,0))}for(var s=0;s<n;s++)for(var l=0;l<i.length;l++){var u=t[s][i[l]];e=e.replace(JI(bz[l],s),r?No(u):u)}return e}function jRe(e,t){var r=Rt(e)?{color:e,extraCssText:t}:e||{},n=r.color,i=r.type;t=r.extraCssText;var a=r.renderMode||"html";if(!n)return"";if(a==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+No(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+No(n)+";"+(t||"")+'"></span>';var o=r.markerId||"markerX";return{renderMode:a,content:"{"+o+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}}function kd(e,t){return t=t||"transparent",Rt(e)?e:$t(e)&&e.colorStops&&(e.colorStops[0]||{}).color||t}function wz(e,t){if(t==="_blank"||t==="blank"){var r=window.open();r.opener=null,r.location.href=e}else window.open(e,t)}var iO=ye,zRe=["left","right","top","bottom","width","height"],ux=[["width","left","right"],["height","top","bottom"]];function x3(e,t,r,n,i){var a=0,o=0;n==null&&(n=1/0),i==null&&(i=1/0);var s=0;t.eachChild(function(l,u){var f=l.getBoundingRect(),c=t.childAt(u+1),h=c&&c.getBoundingRect(),d,v;if(e==="horizontal"){var g=f.width+(h?-h.x+f.x:0);d=a+g,d>n||l.newline?(a=0,d=g,o+=s+r,s=f.height):s=Math.max(s,f.height)}else{var y=f.height+(h?-h.y+f.y:0);v=o+y,v>i||l.newline?(a+=s+r,o=0,v=y,s=f.width):s=Math.max(s,f.width)}l.newline||(l.x=a,l.y=o,l.markRedraw(),e==="horizontal"?a=d+r:o=v+r)})}var Vb=x3;Un(x3,"vertical");Un(x3,"horizontal");function vg(e,t,r){r=Ok(r||0);var n=t.width,i=t.height,a=gn(e.left,n),o=gn(e.top,i),s=gn(e.right,n),l=gn(e.bottom,i),u=gn(e.width,n),f=gn(e.height,i),c=r[2]+r[0],h=r[1]+r[3],d=e.aspect;switch(isNaN(u)&&(u=n-s-h-a),isNaN(f)&&(f=i-l-c-o),d!=null&&(isNaN(u)&&isNaN(f)&&(d>n/i?u=n*.8:f=i*.8),isNaN(u)&&(u=d*f),isNaN(f)&&(f=u/d)),isNaN(a)&&(a=n-s-u-h),isNaN(o)&&(o=i-l-f-c),e.left||e.right){case"center":a=n/2-u/2-r[3];break;case"right":a=n-u-h;break}switch(e.top||e.bottom){case"middle":case"center":o=i/2-f/2-r[0];break;case"bottom":o=i-f-c;break}a=a||0,o=o||0,isNaN(u)&&(u=n-h-a-(s||0)),isNaN(f)&&(f=i-c-o-(l||0));var v=new Br(a+r[3],o+r[0],u,f);return v.margin=r,v}function Rw(e){var t=e.layoutMode||e.constructor.layoutMode;return $t(t)?t:t?{type:t}:null}function pg(e,t,r){var n=r&&r.ignoreSize;!mt(n)&&(n=[n,n]);var i=o(ux[0],0),a=o(ux[1],1);u(ux[0],e,i),u(ux[1],e,a);function o(f,c){var h={},d=0,v={},g=0,y=2;if(iO(f,function(_){v[_]=e[_]}),iO(f,function(_){s(t,_)&&(h[_]=v[_]=t[_]),l(h,_)&&d++,l(v,_)&&g++}),n[c])return l(t,f[1])?v[f[2]]=null:l(t,f[2])&&(v[f[1]]=null),v;if(g===y||!d)return v;if(d>=y)return h;for(var b=0;b<f.length;b++){var w=f[b];if(!s(h,w)&&s(e,w)){h[w]=e[w];break}}return h}function s(f,c){return f.hasOwnProperty(c)}function l(f,c){return f[c]!=null&&f[c]!=="auto"}function u(f,c,h){iO(f,function(d){c[d]=h[d]})}}function Ek(e){return GRe({},e)}function GRe(e,t){return t&&e&&iO(zRe,function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e}var YRe=ti(),Im=function(e){ct(t,e);function t(r,n,i){var a=e.call(this,r,n,i)||this;return a.uid=wk("ec_cpt_model"),a}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=Rw(this),a=i?Ek(r):{},o=n.getTheme();Hr(r,o.get(this.mainType)),Hr(r,this.getDefaultOption()),i&&pg(r,a,i)},t.prototype.mergeOption=function(r,n){Hr(this.option,r,!0);var i=Rw(this);i&&pg(this.option,r,i)},t.prototype.optionUpdated=function(r,n){},t.prototype.getDefaultOption=function(){var r=this.constructor;if(!nOe(r))return r.defaultOption;var n=YRe(this);if(!n.defaultOption){for(var i=[],a=r;a;){var o=a.prototype.defaultOption;o&&i.push(o),a=a.superClass}for(var s={},l=i.length-1;l>=0;l--)s=Hr(s,i[l],!0);n.defaultOption=s}return n.defaultOption},t.prototype.getReferringComponents=function(r,n){var i=r+"Index",a=r+"Id";return JS(this.ecModel,r,{index:this.get(i,!0),id:this.get(a,!0)},n)},t.prototype.getBoxLayoutParams=function(){var r=this;return{left:r.get("left"),top:r.get("top"),right:r.get("right"),bottom:r.get("bottom"),width:r.get("width"),height:r.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(r){this.option.zlevel=r},t.protoInitialize=function(){var r=t.prototype;r.type="component",r.id="",r.name="",r.mainType="",r.subType="",r.componentIndex=0}(),t}(Li);_ie(Im,Li);fk(Im);MRe(Im);DRe(Im,KRe);function KRe(e){var t=[];return ye(Im.getClassesByMainType(e),function(r){t=t.concat(r.dependencies||r.prototype.dependencies||[])}),t=Lt(t,function(r){return vl(r).main}),e!=="dataset"&&Xr(t,"dataset")<=0&&t.unshift("dataset"),t}const vn=Im;var Pae="";typeof navigator<"u"&&(Pae=navigator.platform||"");var Hv="rgba(0, 0, 0, 0.2)";const XRe={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:Hv,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:Hv,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:Hv,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:Hv,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:Hv,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:Hv,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:Pae.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var Iae=pr(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),qo="original",Ha="arrayRows",Fs="objectRows",xl="keyedColumns",ec="typedArray",Mae="unknown",Nu="column",Mm="row",Si={Must:1,Might:2,Not:3},Dae=ti();function qRe(e){Dae(e).datasetMap=pr()}function ZRe(e,t,r){var n={},i=T3(t);if(!i||!e)return n;var a=[],o=[],s=t.ecModel,l=Dae(s).datasetMap,u=i.uid+"_"+r.seriesLayoutBy,f,c;e=e.slice(),ye(e,function(g,y){var b=$t(g)?g:e[y]={name:g};b.type==="ordinal"&&f==null&&(f=y,c=v(b)),n[b.name]=[]});var h=l.get(u)||l.set(u,{categoryWayDim:c,valueWayDim:0});ye(e,function(g,y){var b=g.name,w=v(g);if(f==null){var _=h.valueWayDim;d(n[b],_,w),d(o,_,w),h.valueWayDim+=w}else if(f===y)d(n[b],0,w),d(a,0,w);else{var _=h.categoryWayDim;d(n[b],_,w),d(o,_,w),h.categoryWayDim+=w}});function d(g,y,b){for(var w=0;w<b;w++)g.push(y+w)}function v(g){var y=g.dimsDef;return y?y.length:1}return a.length&&(n.itemName=a),o.length&&(n.seriesName=o),n}function JRe(e,t,r){var n={},i=T3(e);if(!i)return n;var a=t.sourceFormat,o=t.dimensionsDefine,s;(a===Fs||a===xl)&&ye(o,function(f,c){($t(f)?f.name:f)==="name"&&(s=c)});var l=function(){for(var f={},c={},h=[],d=0,v=Math.min(5,r);d<v;d++){var g=Nae(t.data,a,t.seriesLayoutBy,o,t.startIndex,d);h.push(g);var y=g===Si.Not;if(y&&f.v==null&&d!==s&&(f.v=d),(f.n==null||f.n===f.v||!y&&h[f.n]===Si.Not)&&(f.n=d),b(f)&&h[f.n]!==Si.Not)return f;y||(g===Si.Might&&c.v==null&&d!==s&&(c.v=d),(c.n==null||c.n===c.v)&&(c.n=d))}function b(w){return w.v!=null&&w.n!=null}return b(f)?f:b(c)?c:null}();if(l){n.value=[l.v];var u=s??l.n;n.itemName=[u],n.seriesName=[u]}return n}function T3(e){var t=e.get("data",!0);if(!t)return JS(e.ecModel,"dataset",{index:e.get("datasetIndex",!0),id:e.get("datasetId",!0)},Os).models[0]}function QRe(e){return!e.get("transform",!0)&&!e.get("fromTransformResult",!0)?[]:JS(e.ecModel,"dataset",{index:e.get("fromDatasetIndex",!0),id:e.get("fromDatasetId",!0)},Os).models}function $ae(e,t){return Nae(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function Nae(e,t,r,n,i,a){var o,s=5;if(so(e))return Si.Not;var l,u;if(n){var f=n[a];$t(f)?(l=f.name,u=f.type):Rt(f)&&(l=f)}if(u!=null)return u==="ordinal"?Si.Must:Si.Not;if(t===Ha){var c=e;if(r===Mm){for(var h=c[a],d=0;d<(h||[]).length&&d<s;d++)if((o=x(h[i+d]))!=null)return o}else for(var d=0;d<c.length&&d<s;d++){var v=c[i+d];if(v&&(o=x(v[a]))!=null)return o}}else if(t===Fs){var g=e;if(!l)return Si.Not;for(var d=0;d<g.length&&d<s;d++){var y=g[d];if(y&&(o=x(y[l]))!=null)return o}}else if(t===xl){var b=e;if(!l)return Si.Not;var h=b[l];if(!h||so(h))return Si.Not;for(var d=0;d<h.length&&d<s;d++)if((o=x(h[d]))!=null)return o}else if(t===qo)for(var w=e,d=0;d<w.length&&d<s;d++){var y=w[d],_=ZS(y);if(!mt(_))return Si.Not;if((o=x(_[a]))!=null)return o}function x(E){var R=Rt(E);if(E!=null&&isFinite(E)&&E!=="")return R?Si.Might:Si.Not;if(R&&E!=="-")return Si.Must}return Si.Not}var eke=pr();function tke(e,t,r){var n=eke.get(t);if(!n)return r;var i=n(e);return i?r.concat(i):r}var _z=ti();ti();var O3=function(){function e(){}return e.prototype.getColorFromPalette=function(t,r,n){var i=va(this.get("color",!0)),a=this.get("colorLayer",!0);return nke(this,_z,i,a,t,r,n)},e.prototype.clearColorPalette=function(){ike(this,_z)},e}();function rke(e,t){for(var r=e.length,n=0;n<r;n++)if(e[n].length>t)return e[n];return e[r-1]}function nke(e,t,r,n,i,a,o){a=a||e;var s=t(a),l=s.paletteIdx||0,u=s.paletteNameMap=s.paletteNameMap||{};if(u.hasOwnProperty(i))return u[i];var f=o==null||!n?r:rke(n,o);if(f=f||r,!(!f||!f.length)){var c=f[l];return i&&(u[i]=c),s.paletteIdx=(l+1)%f.length,c}}function ike(e,t){t(e).paletteIdx=0,t(e).paletteNameMap={}}var fx,C0,Sz,Cz="\0_ec_inner",ake=1,Lae=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r,n,i,a,o,s){a=a||{},this.option=null,this._theme=new Li(a),this._locale=new Li(o),this._optionManager=s},t.prototype.setOption=function(r,n,i){var a=Oz(n);this._optionManager.setOption(r,i,a),this._resetOption(null,a)},t.prototype.resetOption=function(r,n){return this._resetOption(r,Oz(n))},t.prototype._resetOption=function(r,n){var i=!1,a=this._optionManager;if(!r||r==="recreate"){var o=a.mountOption(r==="recreate");!this.option||r==="recreate"?Sz(this,o):(this.restoreData(),this._mergeOption(o,n)),i=!0}if((r==="timeline"||r==="media")&&this.restoreData(),!r||r==="recreate"||r==="timeline"){var s=a.getTimelineOption(this);s&&(i=!0,this._mergeOption(s,n))}if(!r||r==="recreate"||r==="media"){var l=a.getMediaOption(this);l.length&&ye(l,function(u){i=!0,this._mergeOption(u,n)},this)}return i},t.prototype.mergeOption=function(r){this._mergeOption(r,null)},t.prototype._mergeOption=function(r,n){var i=this.option,a=this._componentsMap,o=this._componentsCount,s=[],l=pr(),u=n&&n.replaceMergeMainTypeMap;qRe(this),ye(r,function(c,h){c!=null&&(vn.hasClass(h)?h&&(s.push(h),l.set(h,!0)):i[h]=i[h]==null?Rr(c):Hr(i[h],c,!0))}),u&&u.each(function(c,h){vn.hasClass(h)&&!l.get(h)&&(s.push(h),l.set(h,!0))}),vn.topologicalTravel(s,vn.getAllClassMainTypes(),f,this);function f(c){var h=tke(this,c,va(r[c])),d=a.get(c),v=d?u&&u.get(c)?"replaceMerge":"normalMerge":"replaceAll",g=VTe(d,h,v);XTe(g,c,vn),i[c]=null,a.set(c,null),o.set(c,0);var y=[],b=[],w=0,_;ye(g,function(x,E){var R=x.existing,A=x.newOption;if(!A)R&&(R.mergeOption({},this),R.optionUpdated({},!1));else{var N=c==="series",I=vn.getClass(c,x.keyInfo.subType,!N);if(!I)return;if(c==="tooltip"){if(_)return;_=!0}if(R&&R.constructor===I)R.name=x.keyInfo.name,R.mergeOption(A,this),R.optionUpdated(A,!1);else{var F=et({componentIndex:E},x.keyInfo);R=new I(A,this,this,F),et(R,F),x.brandNew&&(R.__requireNewView=!0),R.init(A,this,this),R.optionUpdated(null,!0)}}R?(y.push(R.option),b.push(R),w++):(y.push(void 0),b.push(void 0))},this),i[c]=y,a.set(c,b),o.set(c,w),c==="series"&&fx(this)}this._seriesIndices||fx(this)},t.prototype.getOption=function(){var r=Rr(this.option);return ye(r,function(n,i){if(vn.hasClass(i)){for(var a=va(n),o=a.length,s=!1,l=o-1;l>=0;l--)a[l]&&!Sw(a[l])?s=!0:(a[l]=null,!s&&o--);a.length=o,r[i]=a}}),delete r[Cz],r},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(r){this._payload=r},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(r,n){var i=this._componentsMap.get(r);if(i){var a=i[n||0];if(a)return a;if(n==null){for(var o=0;o<i.length;o++)if(i[o])return i[o]}}},t.prototype.queryComponents=function(r){var n=r.mainType;if(!n)return[];var i=r.index,a=r.id,o=r.name,s=this._componentsMap.get(n);if(!s||!s.length)return[];var l;return i!=null?(l=[],ye(va(i),function(u){s[u]&&l.push(s[u])})):a!=null?l=xz("id",a,s):o!=null?l=xz("name",o,s):l=ua(s,function(u){return!!u}),Tz(l,r)},t.prototype.findComponents=function(r){var n=r.query,i=r.mainType,a=s(n),o=a?this.queryComponents(a):ua(this._componentsMap.get(i),function(u){return!!u});return l(Tz(o,r));function s(u){var f=i+"Index",c=i+"Id",h=i+"Name";return u&&(u[f]!=null||u[c]!=null||u[h]!=null)?{mainType:i,index:u[f],id:u[c],name:u[h]}:null}function l(u){return r.filter?ua(u,r.filter):u}},t.prototype.eachComponent=function(r,n,i){var a=this._componentsMap;if(lr(r)){var o=n,s=r;a.each(function(c,h){for(var d=0;c&&d<c.length;d++){var v=c[d];v&&s.call(o,h,v,v.componentIndex)}})}else for(var l=Rt(r)?a.get(r):$t(r)?this.findComponents(r):null,u=0;l&&u<l.length;u++){var f=l[u];f&&n.call(i,f,f.componentIndex)}},t.prototype.getSeriesByName=function(r){var n=gl(r,null);return ua(this._componentsMap.get("series"),function(i){return!!i&&n!=null&&i.name===n})},t.prototype.getSeriesByIndex=function(r){return this._componentsMap.get("series")[r]},t.prototype.getSeriesByType=function(r){return ua(this._componentsMap.get("series"),function(n){return!!n&&n.subType===r})},t.prototype.getSeries=function(){return ua(this._componentsMap.get("series"),function(r){return!!r})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(r,n){C0(this),ye(this._seriesIndices,function(i){var a=this._componentsMap.get("series")[i];r.call(n,a,i)},this)},t.prototype.eachRawSeries=function(r,n){ye(this._componentsMap.get("series"),function(i){i&&r.call(n,i,i.componentIndex)})},t.prototype.eachSeriesByType=function(r,n,i){C0(this),ye(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];o.subType===r&&n.call(i,o,a)},this)},t.prototype.eachRawSeriesByType=function(r,n,i){return ye(this.getSeriesByType(r),n,i)},t.prototype.isSeriesFiltered=function(r){return C0(this),this._seriesIndicesMap.get(r.componentIndex)==null},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(r,n){C0(this);var i=[];ye(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];r.call(n,o,a)&&i.push(a)},this),this._seriesIndices=i,this._seriesIndicesMap=pr(i)},t.prototype.restoreData=function(r){fx(this);var n=this._componentsMap,i=[];n.each(function(a,o){vn.hasClass(o)&&i.push(o)}),vn.topologicalTravel(i,vn.getAllClassMainTypes(),function(a){ye(n.get(a),function(o){o&&(a!=="series"||!oke(o,r))&&o.restoreData()})})},t.internalField=function(){fx=function(r){var n=r._seriesIndices=[];ye(r._componentsMap.get("series"),function(i){i&&n.push(i.componentIndex)}),r._seriesIndicesMap=pr(n)},C0=function(r){},Sz=function(r,n){r.option={},r.option[Cz]=ake,r._componentsMap=pr({series:[]}),r._componentsCount=pr();var i=n.aria;$t(i)&&i.enabled==null&&(i.enabled=!0),ske(n,r._theme.option),Hr(n,XRe,!1),r._mergeOption(n,null)}}(),t}(Li);function oke(e,t){if(t){var r=t.seriesIndex,n=t.seriesId,i=t.seriesName;return r!=null&&e.componentIndex!==r||n!=null&&e.id!==n||i!=null&&e.name!==i}}function ske(e,t){var r=e.color&&!e.colorLayer;ye(t,function(n,i){i==="colorLayer"&&r||vn.hasClass(i)||(typeof n=="object"?e[i]=e[i]?Hr(e[i],n,!1):Rr(n):e[i]==null&&(e[i]=n))})}function xz(e,t,r){if(mt(t)){var n=pr();return ye(t,function(a){if(a!=null){var o=gl(a,null);o!=null&&n.set(a,!0)}}),ua(r,function(a){return a&&n.get(a[e])})}else{var i=gl(t,null);return ua(r,function(a){return a&&i!=null&&a[e]===i})}}function Tz(e,t){return t.hasOwnProperty("subType")?ua(e,function(r){return r&&r.subType===t.subType}):e}function Oz(e){var t=pr();return e&&ye(va(e.replaceMerge),function(r){t.set(r,!0)}),{replaceMergeMainTypeMap:t}}Sl(Lae,O3);const Fae=Lae;var lke=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],uke=function(){function e(t){ye(lke,function(r){this[r]=un(t[r],t)},this)}return e}();const Hae=uke;var QI={},fke=function(){function e(){this._coordinateSystems=[]}return e.prototype.create=function(t,r){var n=[];ye(QI,function(i,a){var o=i.create(t,r);n=n.concat(o||[])}),this._coordinateSystems=n},e.prototype.update=function(t,r){ye(this._coordinateSystems,function(n){n.update&&n.update(t,r)})},e.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},e.register=function(t,r){QI[t]=r},e.get=function(t){return QI[t]},e}();const E3=fke;var cke=/^(min|max)?(.+)$/,hke=function(){function e(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return e.prototype.setOption=function(t,r,n){t&&(ye(va(t.series),function(o){o&&o.data&&so(o.data)&&b$(o.data)}),ye(va(t.dataset),function(o){o&&o.source&&so(o.source)&&b$(o.source)})),t=Rr(t);var i=this._optionBackup,a=dke(t,r,!i);this._newBaseOption=a.baseOption,i?(a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},e.prototype.mountOption=function(t){var r=this._optionBackup;return this._timelineOptions=r.timelineOptions,this._mediaList=r.mediaList,this._mediaDefault=r.mediaDefault,this._currentMediaIndices=[],Rr(t?r.baseOption:this._newBaseOption)},e.prototype.getTimelineOption=function(t){var r,n=this._timelineOptions;if(n.length){var i=t.getComponent("timeline");i&&(r=Rr(n[i.getCurrentIndex()]))}return r},e.prototype.getMediaOption=function(t){var r=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,a=this._mediaDefault,o=[],s=[];if(!i.length&&!a)return s;for(var l=0,u=i.length;l<u;l++)vke(i[l].query,r,n)&&o.push(l);return!o.length&&a&&(o=[-1]),o.length&&!gke(o,this._currentMediaIndices)&&(s=Lt(o,function(f){return Rr(f===-1?a.option:i[f].option)})),this._currentMediaIndices=o,s},e}();function dke(e,t,r){var n=[],i,a,o=e.baseOption,s=e.timeline,l=e.options,u=e.media,f=!!e.media,c=!!(l||s||o&&o.timeline);o?(a=o,a.timeline||(a.timeline=s)):((c||f)&&(e.options=e.media=null),a=e),f&&mt(u)&&ye(u,function(d){d&&d.option&&(d.query?n.push(d):i||(i=d))}),h(a),ye(l,function(d){return h(d)}),ye(n,function(d){return h(d.option)});function h(d){ye(t,function(v){v(d,r)})}return{baseOption:a,timelineOptions:l||[],mediaDefault:i,mediaList:n}}function vke(e,t,r){var n={width:t,height:r,aspectratio:t/r},i=!0;return ye(e,function(a,o){var s=o.match(cke);if(!(!s||!s[1]||!s[2])){var l=s[1],u=s[2].toLowerCase();pke(n[u],a,l)||(i=!1)}}),i}function pke(e,t,r){return r==="min"?e>=t:r==="max"?e<=t:e===t}function gke(e,t){return e.join(",")===t.join(",")}const yke=hke;var ls=ye,kw=$t,Ez=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function eM(e){var t=e&&e.itemStyle;if(t)for(var r=0,n=Ez.length;r<n;r++){var i=Ez[r],a=t.normal,o=t.emphasis;a&&a[i]&&(e[i]=e[i]||{},e[i].normal?Hr(e[i].normal,a[i]):e[i].normal=a[i],a[i]=null),o&&o[i]&&(e[i]=e[i]||{},e[i].emphasis?Hr(e[i].emphasis,o[i]):e[i].emphasis=o[i],o[i]=null)}}function Mi(e,t,r){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,i=e[t].emphasis;n&&(r?(e[t].normal=e[t].emphasis=null,Vr(e[t],n)):e[t]=n),i&&(e.emphasis=e.emphasis||{},e.emphasis[t]=i,i.focus&&(e.emphasis.focus=i.focus),i.blurScope&&(e.emphasis.blurScope=i.blurScope))}}function bb(e){Mi(e,"itemStyle"),Mi(e,"lineStyle"),Mi(e,"areaStyle"),Mi(e,"label"),Mi(e,"labelLine"),Mi(e,"upperLabel"),Mi(e,"edgeLabel")}function Vn(e,t){var r=kw(e)&&e[t],n=kw(r)&&r.textStyle;if(n)for(var i=0,a=E6.length;i<a;i++){var o=E6[i];n.hasOwnProperty(o)&&(r[o]=n[o])}}function Io(e){e&&(bb(e),Vn(e,"label"),e.emphasis&&Vn(e.emphasis,"label"))}function mke(e){if(kw(e)){eM(e),bb(e),Vn(e,"label"),Vn(e,"upperLabel"),Vn(e,"edgeLabel"),e.emphasis&&(Vn(e.emphasis,"label"),Vn(e.emphasis,"upperLabel"),Vn(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(eM(t),Io(t));var r=e.markLine;r&&(eM(r),Io(r));var n=e.markArea;n&&Io(n);var i=e.data;if(e.type==="graph"){i=i||e.nodes;var a=e.links||e.edges;if(a&&!so(a))for(var o=0;o<a.length;o++)Io(a[o]);ye(e.categories,function(u){bb(u)})}if(i&&!so(i))for(var o=0;o<i.length;o++)Io(i[o]);if(t=e.markPoint,t&&t.data)for(var s=t.data,o=0;o<s.length;o++)Io(s[o]);if(r=e.markLine,r&&r.data)for(var l=r.data,o=0;o<l.length;o++)mt(l[o])?(Io(l[o][0]),Io(l[o][1])):Io(l[o]);e.type==="gauge"?(Vn(e,"axisLabel"),Vn(e,"title"),Vn(e,"detail")):e.type==="treemap"?(Mi(e.breadcrumb,"itemStyle"),ye(e.levels,function(u){bb(u)})):e.type==="tree"&&bb(e.leaves)}}function Ul(e){return mt(e)?e:e?[e]:[]}function Rz(e){return(mt(e)?e[0]:e)||{}}function bke(e,t){ls(Ul(e.series),function(n){kw(n)&&mke(n)});var r=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&r.push("valueAxis","categoryAxis","logAxis","timeAxis"),ls(r,function(n){ls(Ul(e[n]),function(i){i&&(Vn(i,"axisLabel"),Vn(i.axisPointer,"label"))})}),ls(Ul(e.parallel),function(n){var i=n&&n.parallelAxisDefault;Vn(i,"axisLabel"),Vn(i&&i.axisPointer,"label")}),ls(Ul(e.calendar),function(n){Mi(n,"itemStyle"),Vn(n,"dayLabel"),Vn(n,"monthLabel"),Vn(n,"yearLabel")}),ls(Ul(e.radar),function(n){Vn(n,"name"),n.name&&n.axisName==null&&(n.axisName=n.name,delete n.name),n.nameGap!=null&&n.axisNameGap==null&&(n.axisNameGap=n.nameGap,delete n.nameGap)}),ls(Ul(e.geo),function(n){kw(n)&&(Io(n),ls(Ul(n.regions),function(i){Io(i)}))}),ls(Ul(e.timeline),function(n){Io(n),Mi(n,"label"),Mi(n,"itemStyle"),Mi(n,"controlStyle",!0);var i=n.data;mt(i)&&ye(i,function(a){$t(a)&&(Mi(a,"label"),Mi(a,"itemStyle"))})}),ls(Ul(e.toolbox),function(n){Mi(n,"iconStyle"),ls(n.feature,function(i){Mi(i,"iconStyle")})}),Vn(Rz(e.axisPointer),"label"),Vn(Rz(e.tooltip).axisPointer,"label")}function wke(e,t){for(var r=t.split(","),n=e,i=0;i<r.length&&(n=n&&n[r[i]],n!=null);i++);return n}function _ke(e,t,r,n){for(var i=t.split(","),a=e,o,s=0;s<i.length-1;s++)o=i[s],a[o]==null&&(a[o]={}),a=a[o];(n||a[i[s]]==null)&&(a[i[s]]=r)}function kz(e){e&&ye(Ske,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var Ske=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],Cke=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],tM=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function x0(e){var t=e&&e.itemStyle;if(t)for(var r=0;r<tM.length;r++){var n=tM[r][1],i=tM[r][0];t[n]!=null&&(t[i]=t[n])}}function Az(e){e&&e.alignTo==="edge"&&e.margin!=null&&e.edgeDistance==null&&(e.edgeDistance=e.margin)}function Pz(e){e&&e.downplay&&!e.blur&&(e.blur=e.downplay)}function xke(e){e&&e.focusNodeAdjacency!=null&&(e.emphasis=e.emphasis||{},e.emphasis.focus==null&&(e.emphasis.focus="adjacency"))}function Bae(e,t){if(e)for(var r=0;r<e.length;r++)t(e[r]),e[r]&&Bae(e[r].children,t)}function Wae(e,t){bke(e,t),e.series=va(e.series),ye(e.series,function(r){if($t(r)){var n=r.type;if(n==="line")r.clipOverflow!=null&&(r.clip=r.clipOverflow);else if(n==="pie"||n==="gauge"){r.clockWise!=null&&(r.clockwise=r.clockWise),Az(r.label);var i=r.data;if(i&&!so(i))for(var a=0;a<i.length;a++)Az(i[a]);r.hoverOffset!=null&&(r.emphasis=r.emphasis||{},(r.emphasis.scaleSize=null)&&(r.emphasis.scaleSize=r.hoverOffset))}else if(n==="gauge"){var o=wke(r,"pointer.color");o!=null&&_ke(r,"itemStyle.color",o)}else if(n==="bar"){x0(r),x0(r.backgroundStyle),x0(r.emphasis);var i=r.data;if(i&&!so(i))for(var a=0;a<i.length;a++)typeof i[a]=="object"&&(x0(i[a]),x0(i[a]&&i[a].emphasis))}else if(n==="sunburst"){var s=r.highlightPolicy;s&&(r.emphasis=r.emphasis||{},r.emphasis.focus||(r.emphasis.focus=s)),Pz(r),Bae(r.data,Pz)}else n==="graph"||n==="sankey"?xke(r):n==="map"&&(r.mapType&&!r.map&&(r.map=r.mapType),r.mapLocation&&Vr(r,r.mapLocation));r.hoverAnimation!=null&&(r.emphasis=r.emphasis||{},r.emphasis&&r.emphasis.scale==null&&(r.emphasis.scale=r.hoverAnimation)),kz(r)}}),e.dataRange&&(e.visualMap=e.dataRange),ye(Cke,function(r){var n=e[r];n&&(mt(n)||(n=[n]),ye(n,function(i){kz(i)}))})}function Tke(e){var t=pr();e.eachSeries(function(r){var n=r.get("stack");if(n){var i=t.get(n)||t.set(n,[]),a=r.getData(),o={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:r};if(!o.stackedDimension||!(o.isStackedByIndex||o.stackedByDimension))return;i.length&&a.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(o)}}),t.each(Oke)}function Oke(e){ye(e,function(t,r){var n=[],i=[NaN,NaN],a=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";o.modify(a,function(u,f,c){var h=o.get(t.stackedDimension,c);if(isNaN(h))return i;var d,v;s?v=o.getRawIndex(c):d=o.get(t.stackedByDimension,c);for(var g=NaN,y=r-1;y>=0;y--){var b=e[y];if(s||(v=b.data.rawIndexOf(b.stackedByDimension,d)),v>=0){var w=b.data.getByRawIndex(b.stackResultDimension,v);if(l==="all"||l==="positive"&&w>0||l==="negative"&&w<0||l==="samesign"&&h>=0&&w>0||l==="samesign"&&h<=0&&w<0){h=NTe(h,w),g=w;break}}}return n[0]=h,n[1]=g,n})})}var Rk=function(){function e(t){this.data=t.data||(t.sourceFormat===xl?{}:[]),this.sourceFormat=t.sourceFormat||Mae,this.seriesLayoutBy=t.seriesLayoutBy||Nu,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var r=this.dimensionsDefine=t.dimensionsDefine;if(r)for(var n=0;n<r.length;n++){var i=r[n];i.type==null&&$ae(this,n)===Si.Must&&(i.type="ordinal")}}return e}();function R3(e){return e instanceof Rk}function Z$(e,t,r){r=r||Vae(e);var n=t.seriesLayoutBy,i=Rke(e,r,n,t.sourceHeader,t.dimensions),a=new Rk({data:e,sourceFormat:r,seriesLayoutBy:n,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:Rr(t)});return a}function k3(e){return new Rk({data:e,sourceFormat:so(e)?ec:qo})}function Eke(e){return new Rk({data:e.data,sourceFormat:e.sourceFormat,seriesLayoutBy:e.seriesLayoutBy,dimensionsDefine:Rr(e.dimensionsDefine),startIndex:e.startIndex,dimensionsDetectedCount:e.dimensionsDetectedCount})}function Vae(e){var t=Mae;if(so(e))t=ec;else if(mt(e)){e.length===0&&(t=Ha);for(var r=0,n=e.length;r<n;r++){var i=e[r];if(i!=null){if(mt(i)){t=Ha;break}else if($t(i)){t=Fs;break}}}}else if($t(e)){for(var a in e)if(dg(e,a)&&Fa(e[a])){t=xl;break}}return t}function Rke(e,t,r,n,i){var a,o;if(!e)return{dimensionsDefine:Iz(i),startIndex:o,dimensionsDetectedCount:a};if(t===Ha){var s=e;n==="auto"||n==null?Mz(function(u){u!=null&&u!=="-"&&(Rt(u)?o==null&&(o=1):o=0)},r,s,10):o=en(n)?n:n?1:0,!i&&o===1&&(i=[],Mz(function(u,f){i[f]=u!=null?u+"":""},r,s,1/0)),a=i?i.length:r===Mm?s.length:s[0]?s[0].length:null}else if(t===Fs)i||(i=kke(e));else if(t===xl)i||(i=[],ye(e,function(u,f){i.push(f)}));else if(t===qo){var l=ZS(e[0]);a=mt(l)&&l.length||1}return{startIndex:o,dimensionsDefine:Iz(i),dimensionsDetectedCount:a}}function kke(e){for(var t=0,r;t<e.length&&!(r=e[t++]););if(r)return yn(r)}function Iz(e){if(e){var t=pr();return Lt(e,function(r,n){r=$t(r)?r:{name:r};var i={name:r.name,displayName:r.displayName,type:r.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var a=t.get(i.name);return a?i.name+="-"+a.count++:t.set(i.name,{count:1}),i})}}function Mz(e,t,r,n){if(t===Mm)for(var i=0;i<r.length&&i<n;i++)e(r[i]?r[i][0]:null,i);else for(var a=r[0]||[],i=0;i<a.length&&i<n;i++)e(a[i],i)}function Uae(e){var t=e.sourceFormat;return t===Fs||t===xl}var ch,hh,dh,Dz,$z,jae=function(){function e(t,r){var n=R3(t)?t:k3(t);this._source=n;var i=this._data=n.data;n.sourceFormat===ec&&(this._offset=0,this._dimSize=r,this._data=i),$z(this,i,n)}return e.prototype.getSource=function(){return this._source},e.prototype.count=function(){return 0},e.prototype.getItem=function(t,r){},e.prototype.appendData=function(t){},e.prototype.clean=function(){},e.protoInitialize=function(){var t=e.prototype;t.pure=!1,t.persistent=!0}(),e.internalField=function(){var t;$z=function(o,s,l){var u=l.sourceFormat,f=l.seriesLayoutBy,c=l.startIndex,h=l.dimensionsDefine,d=Dz[A3(u,f)];if(et(o,d),u===ec)o.getItem=r,o.count=i,o.fillStorage=n;else{var v=zae(u,f);o.getItem=un(v,null,s,c,h);var g=Gae(u,f);o.count=un(g,null,s,c,h)}};var r=function(o,s){o=o-this._offset,s=s||[];for(var l=this._data,u=this._dimSize,f=u*o,c=0;c<u;c++)s[c]=l[f+c];return s},n=function(o,s,l,u){for(var f=this._data,c=this._dimSize,h=0;h<c;h++){for(var d=u[h],v=d[0]==null?1/0:d[0],g=d[1]==null?-1/0:d[1],y=s-o,b=l[h],w=0;w<y;w++){var _=f[w*c+h];b[o+w]=_,_<v&&(v=_),_>g&&(g=_)}d[0]=v,d[1]=g}},i=function(){return this._data?this._data.length/this._dimSize:0};Dz=(t={},t[Ha+"_"+Nu]={pure:!0,appendData:a},t[Ha+"_"+Mm]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[Fs]={pure:!0,appendData:a},t[xl]={pure:!0,appendData:function(o){var s=this._data;ye(o,function(l,u){for(var f=s[u]||(s[u]=[]),c=0;c<(l||[]).length;c++)f.push(l[c])})}},t[qo]={appendData:a},t[ec]={persistent:!1,pure:!0,appendData:function(o){this._data=o},clean:function(){this._offset+=this.count(),this._data=null}},t);function a(o){for(var s=0;s<o.length;s++)this._data.push(o[s])}}(),e}(),Nz=function(e,t,r,n){return e[n]},Ake=(ch={},ch[Ha+"_"+Nu]=function(e,t,r,n){return e[n+t]},ch[Ha+"_"+Mm]=function(e,t,r,n,i){n+=t;for(var a=i||[],o=e,s=0;s<o.length;s++){var l=o[s];a[s]=l?l[n]:null}return a},ch[Fs]=Nz,ch[xl]=function(e,t,r,n,i){for(var a=i||[],o=0;o<r.length;o++){var s=r[o].name,l=e[s];a[o]=l?l[n]:null}return a},ch[qo]=Nz,ch);function zae(e,t){var r=Ake[A3(e,t)];return r}var Lz=function(e,t,r){return e.length},Pke=(hh={},hh[Ha+"_"+Nu]=function(e,t,r){return Math.max(0,e.length-t)},hh[Ha+"_"+Mm]=function(e,t,r){var n=e[0];return n?Math.max(0,n.length-t):0},hh[Fs]=Lz,hh[xl]=function(e,t,r){var n=r[0].name,i=e[n];return i?i.length:0},hh[qo]=Lz,hh);function Gae(e,t){var r=Pke[A3(e,t)];return r}var rM=function(e,t,r){return e[t]},Ike=(dh={},dh[Ha]=rM,dh[Fs]=function(e,t,r){return e[r]},dh[xl]=rM,dh[qo]=function(e,t,r){var n=ZS(e);return n instanceof Array?n[t]:n},dh[ec]=rM,dh);function Yae(e){var t=Ike[e];return t}function A3(e,t){return e===Ha?e+"_"+t:e}function gg(e,t,r){if(e){var n=e.getRawDataItem(t);if(n!=null){var i=e.getStore(),a=i.getSource().sourceFormat;if(r!=null){var o=e.getDimensionIndex(r),s=i.getDimensionProperty(o);return Yae(a)(n,o,s)}else{var l=n;return a===qo&&(l=ZS(n)),l}}}}var Mke=/\{@(.+?)\}/g,Dke=function(){function e(){}return e.prototype.getDataParams=function(t,r){var n=this.getData(r),i=this.getRawValue(t,r),a=n.getRawIndex(t),o=n.getName(t),s=n.getRawDataItem(t),l=n.getItemVisual(t,"style"),u=l&&l[n.getItemVisual(t,"drawType")||"fill"],f=l&&l.stroke,c=this.mainType,h=c==="series",d=n.userOutput&&n.userOutput.get();return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:h?this.subType:null,seriesIndex:this.seriesIndex,seriesId:h?this.id:null,seriesName:h?this.name:null,name:o,dataIndex:a,data:s,dataType:r,value:i,color:u,borderColor:f,dimensionNames:d?d.fullDimensions:null,encode:d?d.encode:null,$vars:["seriesName","name","value"]}},e.prototype.getFormattedLabel=function(t,r,n,i,a,o){r=r||"normal";var s=this.getData(n),l=this.getDataParams(t,n);if(o&&(l.value=o.interpolatedValue),i!=null&&mt(l.value)&&(l.value=l.value[i]),!a){var u=s.getItemModel(t);a=u.get(r==="normal"?["label","formatter"]:[r,"label","formatter"])}if(lr(a))return l.status=r,l.dimensionIndex=i,a(l);if(Rt(a)){var f=Aae(a,l);return f.replace(Mke,function(c,h){var d=h.length,v=h;v.charAt(0)==="["&&v.charAt(d-1)==="]"&&(v=+v.slice(1,d-1));var g=gg(s,t,v);if(o&&mt(o.interpolatedValue)){var y=s.getDimensionIndex(v);y>=0&&(g=o.interpolatedValue[y])}return g!=null?g+"":""})}},e.prototype.getRawValue=function(t,r){return gg(this.getData(r),t)},e.prototype.formatTooltip=function(t,r,n){},e}();function Fz(e){var t,r;return $t(e)?e.type&&(r=e):t=e,{text:t,frag:r}}function Ub(e){return new $ke(e)}var $ke=function(){function e(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return e.prototype.perform=function(t){var r=this._upstream,n=t&&t.skip;if(this._dirty&&r){var i=this.context;i.data=i.outputData=r.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var a;this._plan&&!n&&(a=this._plan(this.context));var o=f(this._modBy),s=this._modDataCount||0,l=f(t&&t.modBy),u=t&&t.modDataCount||0;(o!==l||s!==u)&&(a="reset");function f(w){return!(w>=1)&&(w=1),w}var c;(this._dirty||a==="reset")&&(this._dirty=!1,c=this._doReset(n)),this._modBy=l,this._modDataCount=u;var h=t&&t.step;if(r?this._dueEnd=r._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var d=this._dueIndex,v=Math.min(h!=null?this._dueIndex+h:1/0,this._dueEnd);if(!n&&(c||d<v)){var g=this._progress;if(mt(g))for(var y=0;y<g.length;y++)this._doProgress(g[y],d,v,l,u);else this._doProgress(g,d,v,l,u)}this._dueIndex=v;var b=this._settedOutputEnd!=null?this._settedOutputEnd:v;this._outputDueEnd=b}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},e.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},e.prototype._doProgress=function(t,r,n,i,a){Hz.reset(r,n,i,a),this._callingProgress=t,this._callingProgress({start:r,end:n,count:n-r,next:Hz.next},this.context)},e.prototype._doReset=function(t){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var r,n;!t&&this._reset&&(r=this._reset(this.context),r&&r.progress&&(n=r.forceFirstProgress,r=r.progress),mt(r)&&!r.length&&(r=null)),this._progress=r,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),n},e.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},e.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},e.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},e.prototype.getUpstream=function(){return this._upstream},e.prototype.getDownstream=function(){return this._downstream},e.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},e}(),Hz=function(){var e,t,r,n,i,a={reset:function(l,u,f,c){t=l,e=u,r=f,n=c,i=Math.ceil(n/r),a.next=r>1&&n>0?s:o}};return a;function o(){return t<e?t++:null}function s(){var l=t%i*r+Math.ceil(t/i),u=t>=e?null:l<n?l:t;return t++,u}}();function aO(e,t){var r=t&&t.type;return r==="ordinal"?e:(r==="time"&&!en(e)&&e!=null&&e!=="-"&&(e=+Wu(e)),e==null||e===""?NaN:+e)}pr({number:function(e){return parseFloat(e)},time:function(e){return+Wu(e)},trim:function(e){return Rt(e)?dl(e):e}});var Nke=function(){function e(t,r){var n=t==="desc";this._resultLT=n?1:-1,r==null&&(r=n?"min":"max"),this._incomparable=r==="min"?-1/0:1/0}return e.prototype.evaluate=function(t,r){var n=en(t)?t:hE(t),i=en(r)?r:hE(r),a=isNaN(n),o=isNaN(i);if(a&&(n=this._incomparable),o&&(i=this._incomparable),a&&o){var s=Rt(t),l=Rt(r);s&&(n=l?t:0),l&&(i=s?r:0)}return n<i?this._resultLT:n>i?-this._resultLT:0},e}(),Lke=function(){function e(){}return e.prototype.getRawData=function(){throw new Error("not supported")},e.prototype.getRawDataItem=function(t){throw new Error("not supported")},e.prototype.cloneRawData=function(){},e.prototype.getDimensionInfo=function(t){},e.prototype.cloneAllDimensionInfo=function(){},e.prototype.count=function(){},e.prototype.retrieveValue=function(t,r){},e.prototype.retrieveValueFromItem=function(t,r){},e.prototype.convertValue=function(t,r){return aO(t,r)},e}();function Fke(e,t){var r=new Lke,n=e.data,i=r.sourceFormat=e.sourceFormat,a=e.startIndex,o="";e.seriesLayoutBy!==Nu&&Ma(o);var s=[],l={},u=e.dimensionsDefine;if(u)ye(u,function(g,y){var b=g.name,w={index:y,name:b,displayName:g.displayName};if(s.push(w),b!=null){var _="";dg(l,b)&&Ma(_),l[b]=w}});else for(var f=0;f<e.dimensionsDetectedCount;f++)s.push({index:f});var c=zae(i,Nu);t.__isBuiltIn&&(r.getRawDataItem=function(g){return c(n,a,s,g)},r.getRawData=un(Hke,null,e)),r.cloneRawData=un(Bke,null,e);var h=Gae(i,Nu);r.count=un(h,null,n,a,s);var d=Yae(i);r.retrieveValue=function(g,y){var b=c(n,a,s,g);return v(b,y)};var v=r.retrieveValueFromItem=function(g,y){if(g!=null){var b=s[y];if(b)return d(g,y,b.name)}};return r.getDimensionInfo=un(Wke,null,s,l),r.cloneAllDimensionInfo=un(Vke,null,s),r}function Hke(e){var t=e.sourceFormat;if(!P3(t)){var r="";Ma(r)}return e.data}function Bke(e){var t=e.sourceFormat,r=e.data;if(!P3(t)){var n="";Ma(n)}if(t===Ha){for(var i=[],a=0,o=r.length;a<o;a++)i.push(r[a].slice());return i}else if(t===Fs){for(var i=[],a=0,o=r.length;a<o;a++)i.push(et({},r[a]));return i}}function Wke(e,t,r){if(r!=null){if(en(r)||!isNaN(r)&&!dg(t,r))return e[r];if(dg(t,r))return t[r]}}function Vke(e){return Rr(e)}var Kae=pr();function Uke(e){e=Rr(e);var t=e.type,r="";t||Ma(r);var n=t.split(":");n.length!==2&&Ma(r);var i=!1;n[0]==="echarts"&&(t=n[1],i=!0),e.__isBuiltIn=i,Kae.set(t,e)}function jke(e,t,r){var n=va(e),i=n.length,a="";i||Ma(a);for(var o=0,s=i;o<s;o++){var l=n[o];t=zke(l,t),o!==s-1&&(t.length=Math.max(t.length,1))}return t}function zke(e,t,r,n){var i="";t.length||Ma(i),$t(e)||Ma(i);var a=e.type,o=Kae.get(a);o||Ma(i);var s=Lt(t,function(u){return Fke(u,o)}),l=va(o.transform({upstream:s[0],upstreamList:s,config:Rr(e.config)}));return Lt(l,function(u,f){var c="";$t(u)||Ma(c),u.data||Ma(c);var h=Vae(u.data);P3(h)||Ma(c);var d,v=t[0];if(v&&f===0&&!u.dimensions){var g=v.startIndex;g&&(u.data=v.data.slice(0,g).concat(u.data)),d={seriesLayoutBy:Nu,sourceHeader:g,dimensions:v.metaRawOption.dimensions}}else d={seriesLayoutBy:Nu,sourceHeader:0,dimensions:u.dimensions};return Z$(u.data,d,null)})}function P3(e){return e===Ha||e===Fs}var kk="undefined",Gke=typeof Uint32Array===kk?Array:Uint32Array,Yke=typeof Uint16Array===kk?Array:Uint16Array,Xae=typeof Int32Array===kk?Array:Int32Array,Bz=typeof Float64Array===kk?Array:Float64Array,qae={float:Bz,int:Xae,ordinal:Array,number:Array,time:Bz},nM;function T0(e){return e>65535?Gke:Yke}function Bv(){return[1/0,-1/0]}function Kke(e){var t=e.constructor;return t===Array?e.slice():new t(e)}function Wz(e,t,r,n,i){var a=qae[r||"float"];if(i){var o=e[t],s=o&&o.length;if(s!==n){for(var l=new a(n),u=0;u<s;u++)l[u]=o[u];e[t]=l}}else e[t]=new a(n)}var J$=function(){function e(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=pr()}return e.prototype.initData=function(t,r,n){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=t.getSource(),a=this.defaultDimValueGetter=nM[i.sourceFormat];this._dimValueGetter=n||a,this._rawExtent=[],Uae(i),this._dimensions=Lt(r,function(o){return{type:o.type,property:o.property}}),this._initDataFromProvider(0,t.count())},e.prototype.getProvider=function(){return this._provider},e.prototype.getSource=function(){return this._provider.getSource()},e.prototype.ensureCalculationDimension=function(t,r){var n=this._calcDimNameToIdx,i=this._dimensions,a=n.get(t);if(a!=null){if(i[a].type===r)return a}else a=i.length;return i[a]={type:r},n.set(t,a),this._chunks[a]=new qae[r||"float"](this._rawCount),this._rawExtent[a]=Bv(),a},e.prototype.collectOrdinalMeta=function(t,r){var n=this._chunks[t],i=this._dimensions[t],a=this._rawExtent,o=i.ordinalOffset||0,s=n.length;o===0&&(a[t]=Bv());for(var l=a[t],u=o;u<s;u++){var f=n[u]=r.parseAndCollect(n[u]);isNaN(f)||(l[0]=Math.min(f,l[0]),l[1]=Math.max(f,l[1]))}i.ordinalMeta=r,i.ordinalOffset=s,i.type="ordinal"},e.prototype.getOrdinalMeta=function(t){var r=this._dimensions[t],n=r.ordinalMeta;return n},e.prototype.getDimensionProperty=function(t){var r=this._dimensions[t];return r&&r.property},e.prototype.appendData=function(t){var r=this._provider,n=this.count();r.appendData(t);var i=r.count();return r.persistent||(i+=n),n<i&&this._initDataFromProvider(n,i,!0),[n,i]},e.prototype.appendValues=function(t,r){for(var n=this._chunks,i=this._dimensions,a=i.length,o=this._rawExtent,s=this.count(),l=s+Math.max(t.length,r||0),u=0;u<a;u++){var f=i[u];Wz(n,u,f.type,l,!0)}for(var c=[],h=s;h<l;h++)for(var d=h-s,v=0;v<a;v++){var f=i[v],g=nM.arrayRows.call(this,t[d]||c,f.property,d,v);n[v][h]=g;var y=o[v];g<y[0]&&(y[0]=g),g>y[1]&&(y[1]=g)}return this._rawCount=this._count=l,{start:s,end:l}},e.prototype._initDataFromProvider=function(t,r,n){for(var i=this._provider,a=this._chunks,o=this._dimensions,s=o.length,l=this._rawExtent,u=Lt(o,function(w){return w.property}),f=0;f<s;f++){var c=o[f];l[f]||(l[f]=Bv()),Wz(a,f,c.type,r,n)}if(i.fillStorage)i.fillStorage(t,r,a,l);else for(var h=[],d=t;d<r;d++){h=i.getItem(d,h);for(var v=0;v<s;v++){var g=a[v],y=this._dimValueGetter(h,u[v],d,v);g[d]=y;var b=l[v];y<b[0]&&(b[0]=y),y>b[1]&&(b[1]=y)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=r,this._extent=[]},e.prototype.count=function(){return this._count},e.prototype.get=function(t,r){if(!(r>=0&&r<this._count))return NaN;var n=this._chunks[t];return n?n[this.getRawIndex(r)]:NaN},e.prototype.getValues=function(t,r){var n=[],i=[];if(r==null){r=t,t=[];for(var a=0;a<this._dimensions.length;a++)i.push(a)}else i=t;for(var a=0,o=i.length;a<o;a++)n.push(this.get(i[a],r));return n},e.prototype.getByRawIndex=function(t,r){if(!(r>=0&&r<this._rawCount))return NaN;var n=this._chunks[t];return n?n[r]:NaN},e.prototype.getSum=function(t){var r=this._chunks[t],n=0;if(r)for(var i=0,a=this.count();i<a;i++){var o=this.get(t,i);isNaN(o)||(n+=o)}return n},e.prototype.getMedian=function(t){var r=[];this.each([t],function(a){isNaN(a)||r.push(a)});var n=r.sort(function(a,o){return a-o}),i=this.count();return i===0?0:i%2===1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},e.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var r=this._indices,n=r[t];if(n!=null&&n<this._count&&n===t)return t;for(var i=0,a=this._count-1;i<=a;){var o=(i+a)/2|0;if(r[o]<t)i=o+1;else if(r[o]>t)a=o-1;else return o}return-1},e.prototype.indicesOfNearest=function(t,r,n){var i=this._chunks,a=i[t],o=[];if(!a)return o;n==null&&(n=1/0);for(var s=1/0,l=-1,u=0,f=0,c=this.count();f<c;f++){var h=this.getRawIndex(f),d=r-a[h],v=Math.abs(d);v<=n&&((v<s||v===s&&d>=0&&l<0)&&(s=v,l=d,u=0),d===l&&(o[u++]=f))}return o.length=u,o},e.prototype.getIndices=function(){var t,r=this._indices;if(r){var n=r.constructor,i=this._count;if(n===Array){t=new n(i);for(var a=0;a<i;a++)t[a]=r[a]}else t=new n(r.buffer,0,i)}else{var n=T0(this._rawCount);t=new n(this.count());for(var a=0;a<t.length;a++)t[a]=a}return t},e.prototype.filter=function(t,r){if(!this._count)return this;for(var n=this.clone(),i=n.count(),a=T0(n._rawCount),o=new a(i),s=[],l=t.length,u=0,f=t[0],c=n._chunks,h=0;h<i;h++){var d=void 0,v=n.getRawIndex(h);if(l===0)d=r(h);else if(l===1){var g=c[f][v];d=r(g,h)}else{for(var y=0;y<l;y++)s[y]=c[t[y]][v];s[y]=h,d=r.apply(null,s)}d&&(o[u++]=v)}return u<i&&(n._indices=o),n._count=u,n._extent=[],n._updateGetRawIdx(),n},e.prototype.selectRange=function(t){var r=this.clone(),n=r._count;if(!n)return this;var i=yn(t),a=i.length;if(!a)return this;var o=r.count(),s=T0(r._rawCount),l=new s(o),u=0,f=i[0],c=t[f][0],h=t[f][1],d=r._chunks,v=!1;if(!r._indices){var g=0;if(a===1){for(var y=d[i[0]],b=0;b<n;b++){var w=y[b];(w>=c&&w<=h||isNaN(w))&&(l[u++]=g),g++}v=!0}else if(a===2){for(var y=d[i[0]],_=d[i[1]],x=t[i[1]][0],E=t[i[1]][1],b=0;b<n;b++){var w=y[b],R=_[b];(w>=c&&w<=h||isNaN(w))&&(R>=x&&R<=E||isNaN(R))&&(l[u++]=g),g++}v=!0}}if(!v)if(a===1)for(var b=0;b<o;b++){var A=r.getRawIndex(b),w=d[i[0]][A];(w>=c&&w<=h||isNaN(w))&&(l[u++]=A)}else for(var b=0;b<o;b++){for(var N=!0,A=r.getRawIndex(b),I=0;I<a;I++){var F=i[I],w=d[F][A];(w<t[F][0]||w>t[F][1])&&(N=!1)}N&&(l[u++]=r.getRawIndex(b))}return u<o&&(r._indices=l),r._count=u,r._extent=[],r._updateGetRawIdx(),r},e.prototype.map=function(t,r){var n=this.clone(t);return this._updateDims(n,t,r),n},e.prototype.modify=function(t,r){this._updateDims(this,t,r)},e.prototype._updateDims=function(t,r,n){for(var i=t._chunks,a=[],o=r.length,s=t.count(),l=[],u=t._rawExtent,f=0;f<r.length;f++)u[r[f]]=Bv();for(var c=0;c<s;c++){for(var h=t.getRawIndex(c),d=0;d<o;d++)l[d]=i[r[d]][h];l[o]=c;var v=n&&n.apply(null,l);if(v!=null){typeof v!="object"&&(a[0]=v,v=a);for(var f=0;f<v.length;f++){var g=r[f],y=v[f],b=u[g],w=i[g];w&&(w[h]=y),y<b[0]&&(b[0]=y),y>b[1]&&(b[1]=y)}}}},e.prototype.lttbDownSample=function(t,r){var n=this.clone([t],!0),i=n._chunks,a=i[t],o=this.count(),s=0,l=Math.floor(1/r),u=this.getRawIndex(0),f,c,h,d=new(T0(this._rawCount))(Math.min((Math.ceil(o/l)+2)*2,o));d[s++]=u;for(var v=1;v<o-1;v+=l){for(var g=Math.min(v+l,o-1),y=Math.min(v+l*2,o),b=(y+g)/2,w=0,_=g;_<y;_++){var x=this.getRawIndex(_),E=a[x];isNaN(E)||(w+=E)}w/=y-g;var R=v,A=Math.min(v+l,o),N=v-1,I=a[u];f=-1,h=R;for(var F=-1,H=0,_=R;_<A;_++){var x=this.getRawIndex(_),E=a[x];if(isNaN(E)){H++,F<0&&(F=x);continue}c=Math.abs((N-b)*(E-I)-(N-_)*(w-I)),c>f&&(f=c,h=x)}H>0&&H<A-R&&(d[s++]=Math.min(F,h),h=Math.max(F,h)),d[s++]=h,u=h}return d[s++]=this.getRawIndex(o-1),n._count=s,n._indices=d,n.getRawIndex=this._getRawIdx,n},e.prototype.downSample=function(t,r,n,i){for(var a=this.clone([t],!0),o=a._chunks,s=[],l=Math.floor(1/r),u=o[t],f=this.count(),c=a._rawExtent[t]=Bv(),h=new(T0(this._rawCount))(Math.ceil(f/l)),d=0,v=0;v<f;v+=l){l>f-v&&(l=f-v,s.length=l);for(var g=0;g<l;g++){var y=this.getRawIndex(v+g);s[g]=u[y]}var b=n(s),w=this.getRawIndex(Math.min(v+i(s,b)||0,f-1));u[w]=b,b<c[0]&&(c[0]=b),b>c[1]&&(c[1]=b),h[d++]=w}return a._count=d,a._indices=h,a._updateGetRawIdx(),a},e.prototype.each=function(t,r){if(this._count)for(var n=t.length,i=this._chunks,a=0,o=this.count();a<o;a++){var s=this.getRawIndex(a);switch(n){case 0:r(a);break;case 1:r(i[t[0]][s],a);break;case 2:r(i[t[0]][s],i[t[1]][s],a);break;default:for(var l=0,u=[];l<n;l++)u[l]=i[t[l]][s];u[l]=a,r.apply(null,u)}}},e.prototype.getDataExtent=function(t){var r=this._chunks[t],n=Bv();if(!r)return n;var i=this.count(),a=!this._indices,o;if(a)return this._rawExtent[t].slice();if(o=this._extent[t],o)return o.slice();o=n;for(var s=o[0],l=o[1],u=0;u<i;u++){var f=this.getRawIndex(u),c=r[f];c<s&&(s=c),c>l&&(l=c)}return o=[s,l],this._extent[t]=o,o},e.prototype.getRawDataItem=function(t){var r=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(r);for(var n=[],i=this._chunks,a=0;a<i.length;a++)n.push(i[a][r]);return n},e.prototype.clone=function(t,r){var n=new e,i=this._chunks,a=t&&bc(t,function(s,l){return s[l]=!0,s},{});if(a)for(var o=0;o<i.length;o++)n._chunks[o]=a[o]?Kke(i[o]):i[o];else n._chunks=i;return this._copyCommonProps(n),r||(n._indices=this._cloneIndices()),n._updateGetRawIdx(),n},e.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=Rr(this._extent),t._rawExtent=Rr(this._rawExtent)},e.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,r=void 0;if(t===Array){var n=this._indices.length;r=new t(n);for(var i=0;i<n;i++)r[i]=this._indices[i]}else r=new t(this._indices);return r}return null},e.prototype._getRawIdxIdentity=function(t){return t},e.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},e.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},e.internalField=function(){function t(r,n,i,a){return aO(r[a],this._dimensions[a])}nM={arrayRows:t,objectRows:function(r,n,i,a){return aO(r[n],this._dimensions[a])},keyedColumns:t,original:function(r,n,i,a){var o=r&&(r.value==null?r:r.value);return aO(o instanceof Array?o[a]:o,this._dimensions[a])},typedArray:function(r,n,i,a){return r[a]}}}(),e}(),Xke=function(){function e(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return e.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},e.prototype._setLocalSource=function(t,r){this._sourceList=t,this._upstreamSignList=r,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},e.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},e.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},e.prototype._createSource=function(){this._setLocalSource([],[]);var t=this._sourceHost,r=this._getUpstreamSourceManagers(),n=!!r.length,i,a;if(cx(t)){var o=t,s=void 0,l=void 0,u=void 0;if(n){var f=r[0];f.prepareSource(),u=f.getSource(),s=u.data,l=u.sourceFormat,a=[f._getVersionSign()]}else s=o.get("data",!0),l=so(s)?ec:qo,a=[];var c=this._getSourceMetaRawOption()||{},h=u&&u.metaRawOption||{},d=Tr(c.seriesLayoutBy,h.seriesLayoutBy)||null,v=Tr(c.sourceHeader,h.sourceHeader),g=Tr(c.dimensions,h.dimensions),y=d!==h.seriesLayoutBy||!!v!=!!h.sourceHeader||g;i=y?[Z$(s,{seriesLayoutBy:d,sourceHeader:v,dimensions:g},l)]:[]}else{var b=t;if(n){var w=this._applyTransform(r);i=w.sourceList,a=w.upstreamSignList}else{var _=b.get("source",!0);i=[Z$(_,this._getSourceMetaRawOption(),null)],a=[]}}this._setLocalSource(i,a)},e.prototype._applyTransform=function(t){var r=this._sourceHost,n=r.get("transform",!0),i=r.get("fromTransformResult",!0);if(i!=null){var a="";t.length!==1&&Vz(a)}var o,s=[],l=[];return ye(t,function(u){u.prepareSource();var f=u.getSource(i||0),c="";i!=null&&!f&&Vz(c),s.push(f),l.push(u._getVersionSign())}),n?o=jke(n,s,{datasetIndex:r.componentIndex}):i!=null&&(o=[Eke(s[0])]),{sourceList:o,upstreamSignList:l}},e.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),r=0;r<t.length;r++){var n=t[r];if(n._isDirty()||this._upstreamSignList[r]!==n._getVersionSign())return!0}},e.prototype.getSource=function(t){t=t||0;var r=this._sourceList[t];if(!r){var n=this._getUpstreamSourceManagers();return n[0]&&n[0].getSource(t)}return r},e.prototype.getSharedDataStore=function(t){var r=t.makeStoreSchema();return this._innerGetDataStore(r.dimensions,t.source,r.hash)},e.prototype._innerGetDataStore=function(t,r,n){var i=0,a=this._storeList,o=a[i];o||(o=a[i]={});var s=o[n];if(!s){var l=this._getUpstreamSourceManagers()[0];cx(this._sourceHost)&&l?s=l._innerGetDataStore(t,r,n):(s=new J$,s.initData(new jae(r,t.length),t)),o[n]=s}return s},e.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(cx(t)){var r=T3(t);return r?[r.getSourceManager()]:[]}else return Lt(QRe(t),function(n){return n.getSourceManager()})},e.prototype._getSourceMetaRawOption=function(){var t=this._sourceHost,r,n,i;if(cx(t))r=t.get("seriesLayoutBy",!0),n=t.get("sourceHeader",!0),i=t.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=t;r=a.get("seriesLayoutBy",!0),n=a.get("sourceHeader",!0),i=a.get("dimensions",!0)}return{seriesLayoutBy:r,sourceHeader:n,dimensions:i}},e}();function cx(e){return e.mainType==="series"}function Vz(e){throw new Error(e)}var Zae="line-height:1";function Jae(e,t){var r=e.color||"#6e7079",n=e.fontSize||12,i=e.fontWeight||"400",a=e.color||"#464646",o=e.fontSize||14,s=e.fontWeight||"900";return t==="html"?{nameStyle:"font-size:"+No(n+"")+"px;color:"+No(r)+";font-weight:"+No(i+""),valueStyle:"font-size:"+No(o+"")+"px;color:"+No(a)+";font-weight:"+No(s+"")}:{nameStyle:{fontSize:n,fill:r,fontWeight:i},valueStyle:{fontSize:o,fill:a,fontWeight:s}}}var qke=[0,10,20,30],Zke=["",`
`,`

`,`


`];function Aw(e,t){return t.type=e,t}function Q$(e){return e.type==="section"}function Qae(e){return Q$(e)?Jke:Qke}function eoe(e){if(Q$(e)){var t=0,r=e.blocks.length,n=r>1||r>0&&!e.noHeader;return ye(e.blocks,function(i){var a=eoe(i);a>=t&&(t=a+ +(n&&(!a||Q$(i)&&!i.noHeader)))}),t}return 0}function Jke(e,t,r,n){var i=t.noHeader,a=eAe(eoe(t)),o=[],s=t.blocks||[];Bu(!s||mt(s)),s=s||[];var l=e.orderMode;if(t.sortBlocks&&l){s=s.slice();var u={valueAsc:"asc",valueDesc:"desc"};if(dg(u,l)){var f=new Nke(u[l],null);s.sort(function(v,g){return f.evaluate(v.sortParam,g.sortParam)})}else l==="seriesDesc"&&s.reverse()}ye(s,function(v,g){var y=t.valueFormatter,b=Qae(v)(y?et(et({},e),{valueFormatter:y}):e,v,g>0?a.html:0,n);b!=null&&o.push(b)});var c=e.renderMode==="richText"?o.join(a.richText):eN(o.join(""),i?r:a.html);if(i)return c;var h=q$(t.header,"ordinal",e.useUTC),d=Jae(n,e.renderMode).nameStyle;return e.renderMode==="richText"?toe(e,h,d)+a.richText+c:eN('<div style="'+d+";"+Zae+';">'+No(h)+"</div>"+c,r)}function Qke(e,t,r,n){var i=e.renderMode,a=t.noName,o=t.noValue,s=!t.markerType,l=t.name,u=e.useUTC,f=t.valueFormatter||e.valueFormatter||function(x){return x=mt(x)?x:[x],Lt(x,function(E,R){return q$(E,mt(d)?d[R]:d,u)})};if(!(a&&o)){var c=s?"":e.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",i),h=a?"":q$(l,"ordinal",u),d=t.valueType,v=o?[]:f(t.value),g=!s||!a,y=!s&&a,b=Jae(n,i),w=b.nameStyle,_=b.valueStyle;return i==="richText"?(s?"":c)+(a?"":toe(e,h,w))+(o?"":nAe(e,v,g,y,_)):eN((s?"":c)+(a?"":tAe(h,!s,w))+(o?"":rAe(v,g,y,_)),r)}}function Uz(e,t,r,n,i,a){if(e){var o=Qae(e),s={useUTC:i,renderMode:r,orderMode:n,markupStyleCreator:t,valueFormatter:e.valueFormatter};return o(s,e,0,a)}}function eAe(e){return{html:qke[e],richText:Zke[e]}}function eN(e,t){var r='<div style="clear:both"></div>',n="margin: "+t+"px 0 0";return'<div style="'+n+";"+Zae+';">'+e+r+"</div>"}function tAe(e,t,r){var n=t?"margin-left:2px":"";return'<span style="'+r+";"+n+'">'+No(e)+"</span>"}function rAe(e,t,r,n){var i=r?"10px":"20px",a=t?"float:right;margin-left:"+i:"";return e=mt(e)?e:[e],'<span style="'+a+";"+n+'">'+Lt(e,function(o){return No(o)}).join("&nbsp;&nbsp;")+"</span>"}function toe(e,t,r){return e.markupStyleCreator.wrapRichTextStyle(t,r)}function nAe(e,t,r,n,i){var a=[i],o=n?10:20;return r&&a.push({padding:[0,0,0,o],align:"right"}),e.markupStyleCreator.wrapRichTextStyle(mt(t)?t.join("  "):t,a)}function iAe(e,t){var r=e.getData().getItemVisual(t,"style"),n=r[e.visualDrawType];return kd(n)}function roe(e,t){var r=e.get("padding");return r??(t==="richText"?[8,10]:10)}var iM=function(){function e(){this.richTextStyles={},this._nextStyleNameId=pie()}return e.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},e.prototype.makeTooltipMarker=function(t,r,n){var i=n==="richText"?this._generateStyleName():null,a=jRe({color:r,type:t,renderMode:n,markerId:i});return Rt(a)?a:(this.richTextStyles[i]=a.style,a.content)},e.prototype.wrapRichTextStyle=function(t,r){var n={};mt(r)?ye(r,function(a){return et(n,a)}):et(n,r);var i=this._generateStyleName();return this.richTextStyles[i]=n,"{"+i+"|"+t+"}"},e}();function aAe(e){var t=e.series,r=e.dataIndex,n=e.multipleSeries,i=t.getData(),a=i.mapDimensionsAll("defaultedTooltip"),o=a.length,s=t.getRawValue(r),l=mt(s),u=iAe(t,r),f,c,h,d;if(o>1||l&&!o){var v=oAe(s,t,r,a,u);f=v.inlineValues,c=v.inlineValueTypes,h=v.blocks,d=v.inlineValues[0]}else if(o){var g=i.getDimensionInfo(a[0]);d=f=gg(i,r,a[0]),c=g.type}else d=f=l?s[0]:s;var y=i3(t),b=y&&t.name||"",w=i.getName(r),_=n?b:w;return Aw("section",{header:b,noHeader:n||!y,sortParam:d,blocks:[Aw("nameValue",{markerType:"item",markerColor:u,name:_,noName:!dl(_),value:f,valueType:c})].concat(h||[])})}function oAe(e,t,r,n,i){var a=t.getData(),o=bc(e,function(c,h,d){var v=a.getDimensionInfo(d);return c=c||v&&v.tooltip!==!1&&v.displayName!=null},!1),s=[],l=[],u=[];n.length?ye(n,function(c){f(gg(a,r,c),c)}):ye(e,f);function f(c,h){var d=a.getDimensionInfo(h);!d||d.otherDims.tooltip===!1||(o?u.push(Aw("nameValue",{markerType:"subItem",markerColor:i,name:d.displayName,value:c,valueType:d.type})):(s.push(c),l.push(d.type)))}return{inlineValues:s,inlineValueTypes:l,blocks:u}}var mf=ti();function hx(e,t){return e.getName(t)||e.getId(t)}var sAe="__universalTransitionEnabled",Ak=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._selectedDataIndicesMap={},r}return t.prototype.init=function(r,n,i){this.seriesIndex=this.componentIndex,this.dataTask=Ub({count:uAe,reset:fAe}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(r,i);var a=mf(this).sourceManager=new Xke(this);a.prepareSource();var o=this.getInitialData(r,i);zz(o,this),this.dataTask.context.data=o,mf(this).dataBeforeProcessed=o,jz(this),this._initSelectedMapFromData(o)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=Rw(this),a=i?Ek(r):{},o=this.subType;vn.hasClass(o)&&(o+="Series"),Hr(r,n.getTheme().get(this.subType)),Hr(r,this.getDefaultOption()),F$(r,"label",["show"]),this.fillDataTextStyle(r.data),i&&pg(r,a,i)},t.prototype.mergeOption=function(r,n){r=Hr(this.option,r,!0),this.fillDataTextStyle(r.data);var i=Rw(this);i&&pg(this.option,r,i);var a=mf(this).sourceManager;a.dirty(),a.prepareSource();var o=this.getInitialData(r,n);zz(o,this),this.dataTask.dirty(),this.dataTask.context.data=o,mf(this).dataBeforeProcessed=o,jz(this),this._initSelectedMapFromData(o)},t.prototype.fillDataTextStyle=function(r){if(r&&!so(r))for(var n=["show"],i=0;i<r.length;i++)r[i]&&r[i].label&&F$(r[i],"label",n)},t.prototype.getInitialData=function(r,n){},t.prototype.appendData=function(r){var n=this.getRawData();n.appendData(r.data)},t.prototype.getData=function(r){var n=tN(this);if(n){var i=n.context.data;return r==null?i:i.getLinkedData(r)}else return mf(this).data},t.prototype.getAllData=function(){var r=this.getData();return r&&r.getLinkedDataAll?r.getLinkedDataAll():[{data:r}]},t.prototype.setData=function(r){var n=tN(this);if(n){var i=n.context;i.outputData=r,n!==this.dataTask&&(i.data=r)}mf(this).data=r},t.prototype.getEncode=function(){var r=this.get("encode",!0);if(r)return pr(r)},t.prototype.getSourceManager=function(){return mf(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return mf(this).dataBeforeProcessed},t.prototype.getColorBy=function(){var r=this.get("colorBy");return r||"series"},t.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},t.prototype.getBaseAxis=function(){var r=this.coordinateSystem;return r&&r.getBaseAxis&&r.getBaseAxis()},t.prototype.formatTooltip=function(r,n,i){return aAe({series:this,dataIndex:r,multipleSeries:n})},t.prototype.isAnimationEnabled=function(){var r=this.ecModel;if(vr.node&&!(r&&r.ssr))return!1;var n=this.getShallow("animation");return n&&this.getData().count()>this.getShallow("animationThreshold")&&(n=!1),!!n},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(r,n,i){var a=this.ecModel,o=O3.prototype.getColorFromPalette.call(this,r,n,i);return o||(o=a.getColorFromPalette(r,n,i)),o},t.prototype.coordDimToDataDim=function(r){return this.getRawData().mapDimensionsAll(r)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(r,n){this._innerSelect(this.getData(n),r)},t.prototype.unselect=function(r,n){var i=this.option.selectedMap;if(i){var a=this.option.selectedMode,o=this.getData(n);if(a==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var s=0;s<r.length;s++){var l=r[s],u=hx(o,l);i[u]=!1,this._selectedDataIndicesMap[u]=-1}}},t.prototype.toggleSelect=function(r,n){for(var i=[],a=0;a<r.length;a++)i[0]=r[a],this.isSelected(r[a],n)?this.unselect(i,n):this.select(i,n)},t.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var r=this._selectedDataIndicesMap,n=yn(r),i=[],a=0;a<n.length;a++){var o=r[n[a]];o>=0&&i.push(o)}return i},t.prototype.isSelected=function(r,n){var i=this.option.selectedMap;if(!i)return!1;var a=this.getData(n);return(i==="all"||i[hx(a,r)])&&!a.getItemModel(r).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[sAe])return!0;var r=this.option.universalTransition;return r?r===!0?!0:r&&r.enabled:!1},t.prototype._innerSelect=function(r,n){var i,a,o=this.option,s=o.selectedMode,l=n.length;if(!(!s||!l)){if(s==="series")o.selectedMap="all";else if(s==="multiple"){$t(o.selectedMap)||(o.selectedMap={});for(var u=o.selectedMap,f=0;f<l;f++){var c=n[f],h=hx(r,c);u[h]=!0,this._selectedDataIndicesMap[h]=r.getRawIndex(c)}}else if(s==="single"||s===!0){var d=n[l-1],h=hx(r,d);o.selectedMap=(i={},i[h]=!0,i),this._selectedDataIndicesMap=(a={},a[h]=r.getRawIndex(d),a)}}},t.prototype._initSelectedMapFromData=function(r){if(!this.option.selectedMap){var n=[];r.hasItemOption&&r.each(function(i){var a=r.getRawDataItem(i);a&&a.selected&&n.push(i)}),n.length>0&&this._innerSelect(r,n)}},t.registerClass=function(r){return vn.registerClass(r)},t.protoInitialize=function(){var r=t.prototype;r.type="series.__base__",r.seriesIndex=0,r.ignoreStyleOnData=!1,r.hasSymbolVisual=!1,r.defaultSymbol="circle",r.visualStyleAccessPath="itemStyle",r.visualDrawType="fill"}(),t}(vn);Sl(Ak,Dke);Sl(Ak,O3);_ie(Ak,vn);function jz(e){var t=e.name;i3(e)||(e.name=lAe(e)||t)}function lAe(e){var t=e.getRawData(),r=t.mapDimensionsAll("seriesName"),n=[];return ye(r,function(i){var a=t.getDimensionInfo(i);a.displayName&&n.push(a.displayName)}),n.join(" ")}function uAe(e){return e.model.getRawData().count()}function fAe(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),cAe}function cAe(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function zz(e,t){ye(oxe(e.CHANGABLE_METHODS,e.DOWNSAMPLE_METHODS),function(r){e.wrapMethod(r,Un(hAe,t))})}function hAe(e,t){var r=tN(e);return r&&r.setOutputEnd((t||this).count()),t}function tN(e){var t=(e.ecModel||{}).scheduler,r=t&&t.getPipeline(e.uid);if(r){var n=r.currentTask;if(n){var i=n.agentStubMap;i&&(n=i.get(e.uid))}return n}}const Cc=Ak;var I3=function(){function e(){this.group=new Wi,this.uid=wk("viewComponent")}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){},e.prototype.updateLayout=function(t,r,n,i){},e.prototype.updateVisual=function(t,r,n,i){},e.prototype.toggleBlurSeries=function(t,r,n){},e.prototype.eachRendered=function(t){var r=this.group;r&&r.traverse(t)},e}();o3(I3);fk(I3);const Vu=I3;function M3(){var e=ti();return function(t){var r=e(t),n=t.pipelineContext,i=!!r.large,a=!!r.progressiveRender,o=r.large=!!(n&&n.large),s=r.progressiveRender=!!(n&&n.progressiveRender);return(i!==o||a!==s)&&"reset"}}var noe=ti(),dAe=M3(),D3=function(){function e(){this.group=new Wi,this.uid=wk("viewChart"),this.renderTask=Ub({plan:vAe,reset:pAe}),this.renderTask.context={view:this}}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.highlight=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&Yz(a,i,"emphasis")},e.prototype.downplay=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&Yz(a,i,"normal")},e.prototype.remove=function(t,r){this.group.removeAll()},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateLayout=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateVisual=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.eachRendered=function(t){yk(this.group,t)},e.markUpdateMethod=function(t,r){noe(t).updateMethod=r},e.protoInitialize=function(){var t=e.prototype;t.type="chart"}(),e}();function Gz(e,t,r){e&&G$(e)&&(t==="emphasis"?vE:pE)(e,r)}function Yz(e,t,r){var n=Ed(e,t),i=t&&t.highlightKey!=null?_Ee(t.highlightKey):null;n!=null?ye(va(n),function(a){Gz(e.getItemGraphicEl(a),r,i)}):e.eachItemGraphicEl(function(a){Gz(a,r,i)})}o3(D3);fk(D3);function vAe(e){return dAe(e.model)}function pAe(e){var t=e.model,r=e.ecModel,n=e.api,i=e.payload,a=t.pipelineContext.progressiveRender,o=e.view,s=i&&noe(i).updateMethod,l=a?"incrementalPrepareRender":s&&o[s]?s:"render";return l!=="render"&&o[l](t,r,n,i),gAe[l]}var gAe={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}};const yl=D3;var CE="\0__throttleOriginMethod",Kz="\0__throttleRate",Xz="\0__throttleType";function Pk(e,t,r){var n,i=0,a=0,o=null,s,l,u,f;t=t||0;function c(){a=new Date().getTime(),o=null,e.apply(l,u||[])}var h=function(){for(var d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];n=new Date().getTime(),l=this,u=d;var g=f||t,y=f||r;f=null,s=n-(y?i:a)-g,clearTimeout(o),y?o=setTimeout(c,g):s>=0?c():o=setTimeout(c,-s),i=n};return h.clear=function(){o&&(clearTimeout(o),o=null)},h.debounceNextCall=function(d){f=d},h}function ioe(e,t,r,n){var i=e[t];if(i){var a=i[CE]||i,o=i[Xz],s=i[Kz];if(s!==r||o!==n){if(r==null||!n)return e[t]=a;i=e[t]=Pk(a,r,n==="debounce"),i[CE]=a,i[Xz]=n,i[Kz]=r}return i}}function rN(e,t){var r=e[t];r&&r[CE]&&(r.clear&&r.clear(),e[t]=r[CE])}var qz=ti(),Zz={itemStyle:Cw(gae,!0),lineStyle:Cw(pae,!0)},yAe={lineStyle:"stroke",itemStyle:"fill"};function aoe(e,t){var r=e.visualStyleMapper||Zz[t];return r||(console.warn("Unknown style type '"+t+"'."),Zz.itemStyle)}function ooe(e,t){var r=e.visualDrawType||yAe[t];return r||(console.warn("Unknown style type '"+t+"'."),"fill")}var mAe={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=e.getModel(n),a=aoe(e,n),o=a(i),s=i.getShallow("decal");s&&(r.setVisual("decal",s),s.dirty=!0);var l=ooe(e,n),u=o[l],f=lr(u)?u:null,c=o.fill==="auto"||o.stroke==="auto";if(!o[l]||f||c){var h=e.getColorFromPalette(e.name,null,t.getSeriesCount());o[l]||(o[l]=h,r.setVisual("colorFromPalette",!0)),o.fill=o.fill==="auto"||lr(o.fill)?h:o.fill,o.stroke=o.stroke==="auto"||lr(o.stroke)?h:o.stroke}if(r.setVisual("style",o),r.setVisual("drawType",l),!t.isSeriesFiltered(e)&&f)return r.setVisual("colorFromPalette",!1),{dataEach:function(d,v){var g=e.getDataParams(v),y=et({},o);y[l]=f(g),d.setItemVisual(v,"style",y)}}}},O0=new Li,bAe={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!(e.ignoreStyleOnData||t.isSeriesFiltered(e))){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=aoe(e,n),a=r.getVisual("drawType");return{dataEach:r.hasItemOption?function(o,s){var l=o.getRawDataItem(s);if(l&&l[n]){O0.option=l[n];var u=i(O0),f=o.ensureUniqueItemVisual(s,"style");et(f,u),O0.option.decal&&(o.setItemVisual(s,"decal",O0.option.decal),O0.option.decal.dirty=!0),a in u&&o.setItemVisual(s,"colorFromPalette",!1)}}:null}}}},wAe={performRawSeries:!0,overallReset:function(e){var t=pr();e.eachSeries(function(r){var n=r.getColorBy();if(!r.isColorBySeries()){var i=r.type+"-"+n,a=t.get(i);a||(a={},t.set(i,a)),qz(r).scope=a}}),e.eachSeries(function(r){if(!(r.isColorBySeries()||e.isSeriesFiltered(r))){var n=r.getRawData(),i={},a=r.getData(),o=qz(r).scope,s=r.visualStyleAccessPath||"itemStyle",l=ooe(r,s);a.each(function(u){var f=a.getRawIndex(u);i[f]=u}),n.each(function(u){var f=i[u],c=a.getItemVisual(f,"colorFromPalette");if(c){var h=a.ensureUniqueItemVisual(f,"style"),d=n.getName(u)||u+"",v=n.count();h[l]=r.getColorFromPalette(d,o,v)}})}})}},dx=Math.PI;function _Ae(e,t){t=t||{},Vr(t,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var r=new Wi,n=new ci({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});r.add(n);var i=new Vi({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),a=new ci({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});r.add(a);var o;return t.showSpinner&&(o=new h3({shape:{startAngle:-dx/2,endAngle:-dx/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001}),o.animateShape(!0).when(1e3,{endAngle:dx*3/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:dx*3/2}).delay(300).start("circularInOut"),r.add(o)),r.resize=function(){var s=i.getBoundingRect().width,l=t.showSpinner?t.spinnerRadius:0,u=(e.getWidth()-l*2-(t.showSpinner&&s?10:0)-s)/2-(t.showSpinner&&s?0:5+s/2)+(t.showSpinner?0:s/2)+(s?0:l),f=e.getHeight()/2;t.showSpinner&&o.setShape({cx:u,cy:f}),a.setShape({x:u-l,y:f-l,width:l*2,height:l*2}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},r.resize(),r}var SAe=function(){function e(t,r,n,i){this._stageTaskMap=pr(),this.ecInstance=t,this.api=r,n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=n.concat(i)}return e.prototype.restoreData=function(t,r){t.restoreData(r),this._stageTaskMap.each(function(n){var i=n.overallTask;i&&i.dirty()})},e.prototype.getPerformArgs=function(t,r){if(t.__pipeline){var n=this._pipelineMap.get(t.__pipeline.id),i=n.context,a=!r&&n.progressiveEnabled&&(!i||i.progressiveRender)&&t.__idxInPipeline>n.blockIndex,o=a?n.step:null,s=i&&i.modDataCount,l=s!=null?Math.ceil(s/o):null;return{step:o,modBy:l,modDataCount:s}}},e.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},e.prototype.updateStreamModes=function(t,r){var n=this._pipelineMap.get(t.uid),i=t.getData(),a=i.count(),o=n.progressiveEnabled&&r.incrementalPrepareRender&&a>=n.threshold,s=t.get("large")&&a>=t.get("largeThreshold"),l=t.get("progressiveChunkMode")==="mod"?a:null;t.pipelineContext=n.context={progressiveRender:o,modDataCount:l,large:s}},e.prototype.restorePipelines=function(t){var r=this,n=r._pipelineMap=pr();t.eachSeries(function(i){var a=i.getProgressive(),o=i.uid;n.set(o,{id:o,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:a&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(a||700),count:0}),r._pipe(i,i.dataTask)})},e.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,r=this.api.getModel(),n=this.api;ye(this._allHandlers,function(i){var a=t.get(i.uid)||t.set(i.uid,{}),o="";Bu(!(i.reset&&i.overallReset),o),i.reset&&this._createSeriesStageTask(i,a,r,n),i.overallReset&&this._createOverallStageTask(i,a,r,n)},this)},e.prototype.prepareView=function(t,r,n,i){var a=t.renderTask,o=a.context;o.model=r,o.ecModel=n,o.api=i,a.__block=!t.incrementalPrepareRender,this._pipe(r,a)},e.prototype.performDataProcessorTasks=function(t,r){this._performStageTasks(this._dataProcessorHandlers,t,r,{block:!0})},e.prototype.performVisualTasks=function(t,r,n){this._performStageTasks(this._visualHandlers,t,r,n)},e.prototype._performStageTasks=function(t,r,n,i){i=i||{};var a=!1,o=this;ye(t,function(l,u){if(!(i.visualType&&i.visualType!==l.visualType)){var f=o._stageTaskMap.get(l.uid),c=f.seriesTaskMap,h=f.overallTask;if(h){var d,v=h.agentStubMap;v.each(function(y){s(i,y)&&(y.dirty(),d=!0)}),d&&h.dirty(),o.updatePayload(h,n);var g=o.getPerformArgs(h,i.block);v.each(function(y){y.perform(g)}),h.perform(g)&&(a=!0)}else c&&c.each(function(y,b){s(i,y)&&y.dirty();var w=o.getPerformArgs(y,i.block);w.skip=!l.performRawSeries&&r.isSeriesFiltered(y.context.model),o.updatePayload(y,n),y.perform(w)&&(a=!0)})}});function s(l,u){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(u.__pipeline.id))}this.unfinished=a||this.unfinished},e.prototype.performSeriesTasks=function(t){var r;t.eachSeries(function(n){r=n.dataTask.perform()||r}),this.unfinished=r||this.unfinished},e.prototype.plan=function(){this._pipelineMap.each(function(t){var r=t.tail;do{if(r.__block){t.blockIndex=r.__idxInPipeline;break}r=r.getUpstream()}while(r)})},e.prototype.updatePayload=function(t,r){r!=="remain"&&(t.context.payload=r)},e.prototype._createSeriesStageTask=function(t,r,n,i){var a=this,o=r.seriesTaskMap,s=r.seriesTaskMap=pr(),l=t.seriesType,u=t.getTargetSeries;t.createOnAllSeries?n.eachRawSeries(f):l?n.eachRawSeriesByType(l,f):u&&u(n,i).each(f);function f(c){var h=c.uid,d=s.set(h,o&&o.get(h)||Ub({plan:EAe,reset:RAe,count:AAe}));d.context={model:c,ecModel:n,api:i,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:a},a._pipe(c,d)}},e.prototype._createOverallStageTask=function(t,r,n,i){var a=this,o=r.overallTask=r.overallTask||Ub({reset:CAe});o.context={ecModel:n,api:i,overallReset:t.overallReset,scheduler:a};var s=o.agentStubMap,l=o.agentStubMap=pr(),u=t.seriesType,f=t.getTargetSeries,c=!0,h=!1,d="";Bu(!t.createOnAllSeries,d),u?n.eachRawSeriesByType(u,v):f?f(n,i).each(v):(c=!1,ye(n.getSeries(),v));function v(g){var y=g.uid,b=l.set(y,s&&s.get(y)||(h=!0,Ub({reset:xAe,onDirty:OAe})));b.context={model:g,overallProgress:c},b.agent=o,b.__block=c,a._pipe(g,b)}h&&o.dirty()},e.prototype._pipe=function(t,r){var n=t.uid,i=this._pipelineMap.get(n);!i.head&&(i.head=r),i.tail&&i.tail.pipe(r),i.tail=r,r.__idxInPipeline=i.count++,r.__pipeline=i},e.wrapStageHandler=function(t,r){return lr(t)&&(t={overallReset:t,seriesType:PAe(t)}),t.uid=wk("stageHandler"),r&&(t.visualType=r),t},e}();function CAe(e){e.overallReset(e.ecModel,e.api,e.payload)}function xAe(e){return e.overallProgress&&TAe}function TAe(){this.agent.dirty(),this.getDownstream().dirty()}function OAe(){this.agent&&this.agent.dirty()}function EAe(e){return e.plan?e.plan(e.model,e.ecModel,e.api,e.payload):null}function RAe(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=va(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?Lt(t,function(r,n){return soe(n)}):kAe}var kAe=soe(0);function soe(e){return function(t,r){var n=r.data,i=r.resetDefines[e];if(i&&i.dataEach)for(var a=t.start;a<t.end;a++)i.dataEach(n,a);else i&&i.progress&&i.progress(t,n)}}function AAe(e){return e.data.count()}function PAe(e){xE=null;try{e(Pw,loe)}catch{}return xE}var Pw={},loe={},xE;uoe(Pw,Fae);uoe(loe,Hae);Pw.eachSeriesByType=Pw.eachRawSeriesByType=function(e){xE=e};Pw.eachComponent=function(e){e.mainType==="series"&&e.subType&&(xE=e.subType)};function uoe(e,t){for(var r in t.prototype)e[r]=Na}const foe=SAe;var Jz=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const IAe={color:Jz,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],Jz]};var ta="#B9B8CE",Qz="#100C2A",vx=function(){return{axisLine:{lineStyle:{color:ta}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},eG=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],coe={darkMode:!0,color:eG,backgroundColor:Qz,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:ta}},textStyle:{color:ta},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:ta}},dataZoom:{borderColor:"#71708A",textStyle:{color:ta},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:ta}},timeline:{lineStyle:{color:ta},label:{color:ta},controlStyle:{color:ta,borderColor:ta}},calendar:{itemStyle:{color:Qz},dayLabel:{color:ta},monthLabel:{color:ta},yearLabel:{color:ta}},timeAxis:vx(),logAxis:vx(),valueAxis:vx(),categoryAxis:vx(),line:{symbol:"circle"},graph:{color:eG},gauge:{title:{color:ta},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:ta},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};coe.categoryAxis.splitLine.show=!1;const MAe=coe;var DAe=function(){function e(){}return e.prototype.normalizeQuery=function(t){var r={},n={},i={};if(Rt(t)){var a=vl(t);r.mainType=a.main||null,r.subType=a.sub||null}else{var o=["Index","Name","Id"],s={name:1,dataIndex:1,dataType:1};ye(t,function(l,u){for(var f=!1,c=0;c<o.length;c++){var h=o[c],d=u.lastIndexOf(h);if(d>0&&d===u.length-h.length){var v=u.slice(0,d);v!=="data"&&(r.mainType=v,r[h.toLowerCase()]=l,f=!0)}}s.hasOwnProperty(u)&&(n[u]=l,f=!0),f||(i[u]=l)})}return{cptQuery:r,dataQuery:n,otherQuery:i}},e.prototype.filter=function(t,r){var n=this.eventInfo;if(!n)return!0;var i=n.targetEl,a=n.packedEvent,o=n.model,s=n.view;if(!o||!s)return!0;var l=r.cptQuery,u=r.dataQuery;return f(l,o,"mainType")&&f(l,o,"subType")&&f(l,o,"index","componentIndex")&&f(l,o,"name")&&f(l,o,"id")&&f(u,a,"name")&&f(u,a,"dataIndex")&&f(u,a,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,r.otherQuery,i,a));function f(c,h,d,v){return c[d]==null||h[v||d]===c[d]}},e.prototype.afterTrigger=function(){this.eventInfo=null},e}(),nN=["symbol","symbolSize","symbolRotate","symbolOffset"],tG=nN.concat(["symbolKeepAspect"]),$Ae={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData();if(e.legendIcon&&r.setVisual("legendIcon",e.legendIcon),!e.hasSymbolVisual)return;for(var n={},i={},a=!1,o=0;o<nN.length;o++){var s=nN[o],l=e.get(s);lr(l)?(a=!0,i[s]=l):n[s]=l}if(n.symbol=n.symbol||e.defaultSymbol,r.setVisual(et({legendIcon:e.legendIcon||n.symbol,symbolKeepAspect:e.get("symbolKeepAspect")},n)),t.isSeriesFiltered(e))return;var u=yn(i);function f(c,h){for(var d=e.getRawValue(h),v=e.getDataParams(h),g=0;g<u.length;g++){var y=u[g];c.setItemVisual(h,y,i[y](d,v))}}return{dataEach:a?f:null}}},NAe={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!e.hasSymbolVisual||t.isSeriesFiltered(e))return;var r=e.getData();function n(i,a){for(var o=i.getItemModel(a),s=0;s<tG.length;s++){var l=tG[s],u=o.getShallow(l,!0);u!=null&&i.setItemVisual(a,l,u)}}return{dataEach:r.hasItemOption?n:null}}};function LAe(e,t,r){switch(r){case"color":var n=e.getItemVisual(t,"style");return n[e.getVisual("drawType")];case"opacity":return e.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getItemVisual(t,r)}}function FAe(e,t){switch(t){case"color":var r=e.getVisual("style");return r[e.getVisual("drawType")];case"opacity":return e.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getVisual(t)}}function HAe(e,t){function r(n,i){var a=[];return n.eachComponent({mainType:"series",subType:e,query:i},function(o){a.push(o.seriesIndex)}),a}ye([[e+"ToggleSelect","toggleSelect"],[e+"Select","select"],[e+"UnSelect","unselect"]],function(n){t(n[0],function(i,a,o){i=et({},i),o.dispatchAction(et(i,{type:n[1],seriesIndex:r(a,i)}))})})}function Wv(e,t,r,n,i){var a=e+t;r.isSilent(a)||n.eachComponent({mainType:"series",subType:"pie"},function(o){for(var s=o.seriesIndex,l=o.option.selectedMap,u=i.selected,f=0;f<u.length;f++)if(u[f].seriesIndex===s){var c=o.getData(),h=Ed(c,i.fromActionPayload);r.trigger(a,{type:a,seriesId:o.id,name:mt(h)?c.getName(h[0]):c.getName(h),selected:Rt(l)?l:et({},l)})}})}function BAe(e,t,r){e.on("selectchanged",function(n){var i=r.getModel();n.isFromClick?(Wv("map","selectchanged",t,i,n),Wv("pie","selectchanged",t,i,n)):n.fromAction==="select"?(Wv("map","selected",t,i,n),Wv("pie","selected",t,i,n)):n.fromAction==="unselect"&&(Wv("map","unselected",t,i,n),Wv("pie","unselected",t,i,n))})}function wb(e,t,r){for(var n;e&&!(t(e)&&(n=e,r));)e=e.__hostTarget||e.parent;return n}var WAe=Math.round(Math.random()*9),VAe=typeof Object.defineProperty=="function",UAe=function(){function e(){this._id="__ec_inner_"+WAe++}return e.prototype.get=function(t){return this._guard(t)[this._id]},e.prototype.set=function(t,r){var n=this._guard(t);return VAe?Object.defineProperty(n,this._id,{value:r,enumerable:!1,configurable:!0}):n[this._id]=r,this},e.prototype.delete=function(t){return this.has(t)?(delete this._guard(t)[this._id],!0):!1},e.prototype.has=function(t){return!!this._guard(t)[this._id]},e.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},e}();const jAe=UAe;var zAe=zr.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n+a),e.lineTo(r-i,n+a),e.closePath()}}),GAe=zr.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n),e.lineTo(r,n+a),e.lineTo(r-i,n),e.closePath()}}),YAe=zr.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.x,n=t.y,i=t.width/5*3,a=Math.max(i,t.height),o=i/2,s=o*o/(a-o),l=n-a+o+s,u=Math.asin(s/o),f=Math.cos(u)*o,c=Math.sin(u),h=Math.cos(u),d=o*.6,v=o*.7;e.moveTo(r-f,l+s),e.arc(r,l,o,Math.PI-u,Math.PI*2+u),e.bezierCurveTo(r+f-c*d,l+s+h*d,r,n-v,r,n),e.bezierCurveTo(r,n-v,r-f+c*d,l+s+h*d,r-f,l+s),e.closePath()}}),KAe=zr.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.height,n=t.width,i=t.x,a=t.y,o=n/3*2;e.moveTo(i,a),e.lineTo(i+o,a+r),e.lineTo(i,a+r/4*3),e.lineTo(i-o,a+r),e.lineTo(i,a),e.closePath()}}),XAe={line:Rd,rect:ci,roundRect:ci,square:ci,circle:c3,diamond:GAe,pin:YAe,arrow:KAe,triangle:zAe},qAe={line:function(e,t,r,n,i){i.x1=e,i.y1=t+n/2,i.x2=e+r,i.y2=t+n/2},rect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n},roundRect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n,i.r=Math.min(r,n)/4},square:function(e,t,r,n,i){var a=Math.min(r,n);i.x=e,i.y=t,i.width=a,i.height=a},circle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.r=Math.min(r,n)/2},diamond:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n},pin:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},arrow:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},triangle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n}},iN={};ye(XAe,function(e,t){iN[t]=new e});var ZAe=zr.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,r){var n=fE(e,t,r),i=this.shape;return i&&i.symbolType==="pin"&&t.position==="inside"&&(n.y=r.y+r.height*.4),n},buildPath:function(e,t,r){var n=t.symbolType;if(n!=="none"){var i=iN[n];i||(n="rect",i=iN[n]),qAe[n](t.x,t.y,t.width,t.height,i.shape),i.buildPath(e,i.shape,r)}}});function JAe(e,t){if(this.type!=="image"){var r=this.style;this.__isEmptyBrush?(r.stroke=e,r.fill=t||"#fff",r.lineWidth=2):this.shape.symbolType==="line"?r.stroke=e:r.fill=e,this.markRedraw()}}function yg(e,t,r,n,i,a,o){var s=e.indexOf("empty")===0;s&&(e=e.substr(5,1).toLowerCase()+e.substr(6));var l;return e.indexOf("image://")===0?l=fae(e.slice(8),new Br(t,r,n,i),o?"center":"cover"):e.indexOf("path://")===0?l=p3(e.slice(7),{},new Br(t,r,n,i),o?"center":"cover"):l=new ZAe({shape:{symbolType:e,x:t,y:r,width:n,height:i}}),l.__isEmptyBrush=s,l.setColor=JAe,a&&l.setColor(a),l}function QAe(e){return mt(e)||(e=[+e,+e]),[e[0]||0,e[1]||0]}function hoe(e,t){if(e!=null)return mt(e)||(e=[e,e]),[gn(e[0],t[0])||0,gn(Tr(e[1],e[0]),t[1])||0]}function Bh(e){return isFinite(e)}function ePe(e,t,r){var n=t.x==null?0:t.x,i=t.x2==null?1:t.x2,a=t.y==null?0:t.y,o=t.y2==null?0:t.y2;t.global||(n=n*r.width+r.x,i=i*r.width+r.x,a=a*r.height+r.y,o=o*r.height+r.y),n=Bh(n)?n:0,i=Bh(i)?i:1,a=Bh(a)?a:0,o=Bh(o)?o:0;var s=e.createLinearGradient(n,a,i,o);return s}function tPe(e,t,r){var n=r.width,i=r.height,a=Math.min(n,i),o=t.x==null?.5:t.x,s=t.y==null?.5:t.y,l=t.r==null?.5:t.r;t.global||(o=o*n+r.x,s=s*i+r.y,l=l*a),o=Bh(o)?o:.5,s=Bh(s)?s:.5,l=l>=0&&Bh(l)?l:.5;var u=e.createRadialGradient(o,s,0,o,s,l);return u}function aN(e,t,r){for(var n=t.type==="radial"?tPe(e,t,r):ePe(e,t,r),i=t.colorStops,a=0;a<i.length;a++)n.addColorStop(i[a].offset,i[a].color);return n}function rPe(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!0;return!1}function px(e){return parseInt(e,10)}function gx(e,t,r){var n=["width","height"][t],i=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(r[n]!=null&&r[n]!=="auto")return parseFloat(r[n]);var s=document.defaultView.getComputedStyle(e);return(e[i]||px(s[n])||px(e.style[n]))-(px(s[a])||0)-(px(s[o])||0)|0}function nPe(e,t){return!e||e==="solid"||!(t>0)?null:e==="dashed"?[4*t,2*t]:e==="dotted"?[t]:en(e)?[e]:mt(e)?e:null}function doe(e){var t=e.style,r=t.lineDash&&t.lineWidth>0&&nPe(t.lineDash,t.lineWidth),n=t.lineDashOffset;if(r){var i=t.strokeNoScale&&e.getLineScale?e.getLineScale():1;i&&i!==1&&(r=Lt(r,function(a){return a/i}),n/=i)}return[r,n]}var iPe=new _c(!0);function TE(e){var t=e.stroke;return!(t==null||t==="none"||!(e.lineWidth>0))}function rG(e){return typeof e=="string"&&e!=="none"}function OE(e){var t=e.fill;return t!=null&&t!=="none"}function nG(e,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=r}else e.fill()}function iG(e,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=r}else e.stroke()}function oN(e,t,r){var n=Sie(t.image,t.__image,r);if(ck(n)){var i=e.createPattern(n,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var a=new DOMMatrix;a.translateSelf(t.x||0,t.y||0),a.rotateSelf(0,0,(t.rotation||0)*sxe),a.scaleSelf(t.scaleX||1,t.scaleY||1),i.setTransform(a)}return i}}function aPe(e,t,r,n){var i,a=TE(r),o=OE(r),s=r.strokePercent,l=s<1,u=!t.path;(!t.silent||l)&&u&&t.createPathProxy();var f=t.path||iPe,c=t.__dirty;if(!n){var h=r.fill,d=r.stroke,v=o&&!!h.colorStops,g=a&&!!d.colorStops,y=o&&!!h.image,b=a&&!!d.image,w=void 0,_=void 0,x=void 0,E=void 0,R=void 0;(v||g)&&(R=t.getBoundingRect()),v&&(w=c?aN(e,h,R):t.__canvasFillGradient,t.__canvasFillGradient=w),g&&(_=c?aN(e,d,R):t.__canvasStrokeGradient,t.__canvasStrokeGradient=_),y&&(x=c||!t.__canvasFillPattern?oN(e,h,t):t.__canvasFillPattern,t.__canvasFillPattern=x),b&&(E=c||!t.__canvasStrokePattern?oN(e,d,t):t.__canvasStrokePattern,t.__canvasStrokePattern=x),v?e.fillStyle=w:y&&(x?e.fillStyle=x:o=!1),g?e.strokeStyle=_:b&&(E?e.strokeStyle=E:a=!1)}var A=t.getGlobalScale();f.setScale(A[0],A[1],t.segmentIgnoreThreshold);var N,I;e.setLineDash&&r.lineDash&&(i=doe(t),N=i[0],I=i[1]);var F=!0;(u||c&Sp)&&(f.setDPR(e.dpr),l?f.setContext(null):(f.setContext(e),F=!1),f.reset(),t.buildPath(f,t.shape,n),f.toStatic(),t.pathUpdated()),F&&f.rebuildPath(e,l?s:1),N&&(e.setLineDash(N),e.lineDashOffset=I),n||(r.strokeFirst?(a&&iG(e,r),o&&nG(e,r)):(o&&nG(e,r),a&&iG(e,r))),N&&e.setLineDash([])}function oPe(e,t,r){var n=t.__image=Sie(r.image,t.__image,t,t.onload);if(!(!n||!ck(n))){var i=r.x||0,a=r.y||0,o=t.getWidth(),s=t.getHeight(),l=n.width/n.height;if(o==null&&s!=null?o=s*l:s==null&&o!=null?s=o/l:o==null&&s==null&&(o=n.width,s=n.height),r.sWidth&&r.sHeight){var u=r.sx||0,f=r.sy||0;e.drawImage(n,u,f,r.sWidth,r.sHeight,i,a,o,s)}else if(r.sx&&r.sy){var u=r.sx,f=r.sy,c=o-u,h=s-f;e.drawImage(n,u,f,c,h,i,a,o,s)}else e.drawImage(n,i,a,o,s)}}function sPe(e,t,r){var n,i=r.text;if(i!=null&&(i+=""),i){e.font=r.font||Od,e.textAlign=r.textAlign,e.textBaseline=r.textBaseline;var a=void 0,o=void 0;e.setLineDash&&r.lineDash&&(n=doe(t),a=n[0],o=n[1]),a&&(e.setLineDash(a),e.lineDashOffset=o),r.strokeFirst?(TE(r)&&e.strokeText(i,r.x,r.y),OE(r)&&e.fillText(i,r.x,r.y)):(OE(r)&&e.fillText(i,r.x,r.y),TE(r)&&e.strokeText(i,r.x,r.y)),a&&e.setLineDash([])}}var aG=["shadowBlur","shadowOffsetX","shadowOffsetY"],oG=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function voe(e,t,r,n,i){var a=!1;if(!n&&(r=r||{},t===r))return!1;if(n||t.opacity!==r.opacity){$a(e,i),a=!0;var o=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(o)?gd.opacity:o}(n||t.blend!==r.blend)&&(a||($a(e,i),a=!0),e.globalCompositeOperation=t.blend||gd.blend);for(var s=0;s<aG.length;s++){var l=aG[s];(n||t[l]!==r[l])&&(a||($a(e,i),a=!0),e[l]=e.dpr*(t[l]||0))}return(n||t.shadowColor!==r.shadowColor)&&(a||($a(e,i),a=!0),e.shadowColor=t.shadowColor||gd.shadowColor),a}function sG(e,t,r,n,i){var a=Iw(t,i.inHover),o=n?null:r&&Iw(r,i.inHover)||{};if(a===o)return!1;var s=voe(e,a,o,n,i);if((n||a.fill!==o.fill)&&(s||($a(e,i),s=!0),rG(a.fill)&&(e.fillStyle=a.fill)),(n||a.stroke!==o.stroke)&&(s||($a(e,i),s=!0),rG(a.stroke)&&(e.strokeStyle=a.stroke)),(n||a.opacity!==o.opacity)&&(s||($a(e,i),s=!0),e.globalAlpha=a.opacity==null?1:a.opacity),t.hasStroke()){var l=a.lineWidth,u=l/(a.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==u&&(s||($a(e,i),s=!0),e.lineWidth=u)}for(var f=0;f<oG.length;f++){var c=oG[f],h=c[0];(n||a[h]!==o[h])&&(s||($a(e,i),s=!0),e[h]=a[h]||c[1])}return s}function lPe(e,t,r,n,i){return voe(e,Iw(t,i.inHover),r&&Iw(r,i.inHover),n,i)}function poe(e,t){var r=t.transform,n=e.dpr||1;r?e.setTransform(n*r[0],n*r[1],n*r[2],n*r[3],n*r[4],n*r[5]):e.setTransform(n,0,0,n,0,0)}function uPe(e,t,r){for(var n=!1,i=0;i<e.length;i++){var a=e[i];n=n||a.isZeroArea(),poe(t,a),t.beginPath(),a.buildPath(t,a.shape),t.clip()}r.allClipped=n}function fPe(e,t){return e&&t?e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]:!(!e&&!t)}var lG=1,uG=2,fG=3,cG=4;function cPe(e){var t=OE(e),r=TE(e);return!(e.lineDash||!(+t^+r)||t&&typeof e.fill!="string"||r&&typeof e.stroke!="string"||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}function $a(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function Iw(e,t){return t&&e.__hoverStyle||e.style}function goe(e,t){Wh(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Wh(e,t,r,n){var i=t.transform;if(!t.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1)){t.__dirty&=~ro,t.__isRendered=!1;return}var a=t.__clipPaths,o=r.prevElClipPaths,s=!1,l=!1;if((!o||rPe(a,o))&&(o&&o.length&&($a(e,r),e.restore(),l=s=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),a&&a.length&&($a(e,r),e.save(),uPe(a,e,r),s=!0),r.prevElClipPaths=a),r.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var u=r.prevEl;u||(l=s=!0);var f=t instanceof zr&&t.autoBatch&&cPe(t.style);s||fPe(i,u.transform)?($a(e,r),poe(e,t)):f||$a(e,r);var c=Iw(t,r.inHover);t instanceof zr?(r.lastDrawType!==lG&&(l=!0,r.lastDrawType=lG),sG(e,t,u,l,r),(!f||!r.batchFill&&!r.batchStroke)&&e.beginPath(),aPe(e,t,c,f),f&&(r.batchFill=c.fill||"",r.batchStroke=c.stroke||"")):t instanceof V$?(r.lastDrawType!==fG&&(l=!0,r.lastDrawType=fG),sG(e,t,u,l,r),sPe(e,t,c)):t instanceof Kd?(r.lastDrawType!==uG&&(l=!0,r.lastDrawType=uG),lPe(e,t,u,l,r),oPe(e,t,c)):t.getTemporalDisplayables&&(r.lastDrawType!==cG&&(l=!0,r.lastDrawType=cG),hPe(e,t,r)),f&&n&&$a(e,r),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),r.prevEl=t,t.__dirty=0,t.__isRendered=!0}function hPe(e,t,r){var n=t.getDisplayables(),i=t.getTemporalDisplayables();e.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover},o,s;for(o=t.getCursor(),s=n.length;o<s;o++){var l=n[o];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Wh(e,l,a,o===s-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}for(var u=0,f=i.length;u<f;u++){var l=i[u];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Wh(e,l,a,u===f-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}var aM=new jAe,hG=new qS(100),dG=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function sN(e,t){if(e==="none")return null;var r=t.getDevicePixelRatio(),n=t.getZr(),i=n.painter.type==="svg";e.dirty&&aM.delete(e);var a=aM.get(e);if(a)return a;var o=Vr(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});o.backgroundColor==="none"&&(o.backgroundColor=null);var s={repeat:"repeat"};return l(s),s.rotation=o.rotation,s.scaleX=s.scaleY=i?1:1/r,aM.set(e,s),e.dirty=!1,s;function l(u){for(var f=[r],c=!0,h=0;h<dG.length;++h){var d=o[dG[h]];if(d!=null&&!mt(d)&&!Rt(d)&&!en(d)&&typeof d!="boolean"){c=!1;break}f.push(d)}var v;if(c){v=f.join(",")+(i?"-svg":"");var g=hG.get(v);g&&(i?u.svgElement=g:u.image=g)}var y=moe(o.dashArrayX),b=dPe(o.dashArrayY),w=yoe(o.symbol),_=vPe(y),x=boe(b),E=!i&&Am.createCanvas(),R=i&&{tag:"g",attrs:{},key:"dcl",children:[]},A=I(),N;E&&(E.width=A.width*r,E.height=A.height*r,N=E.getContext("2d")),F(),c&&hG.put(v,E||R),u.image=E,u.svgElement=R,u.svgWidth=A.width,u.svgHeight=A.height;function I(){for(var H=1,W=0,z=_.length;W<z;++W)H=T6(H,_[W]);for(var te=1,W=0,z=w.length;W<z;++W)te=T6(te,w[W].length);H*=te;var ie=x*_.length*w.length;return{width:Math.max(1,Math.min(H,o.maxTileWidth)),height:Math.max(1,Math.min(ie,o.maxTileHeight))}}function F(){N&&(N.clearRect(0,0,E.width,E.height),o.backgroundColor&&(N.fillStyle=o.backgroundColor,N.fillRect(0,0,E.width,E.height)));for(var H=0,W=0;W<b.length;++W)H+=b[W];if(H<=0)return;for(var z=-x,te=0,ie=0,fe=0;z<A.height;){if(te%2===0){for(var Te=ie/2%w.length,M=0,S=0,T=0;M<A.width*2;){for(var k=0,W=0;W<y[fe].length;++W)k+=y[fe][W];if(k<=0)break;if(S%2===0){var O=(1-o.symbolSize)*.5,D=M+y[fe][S]*O,L=z+b[te]*O,B=y[fe][S]*o.symbolSize,Y=b[te]*o.symbolSize,Q=T/2%w[Te].length;he(D,L,B,Y,w[Te][Q])}M+=y[fe][S],++T,++S,S===y[fe].length&&(S=0)}++fe,fe===y.length&&(fe=0)}z+=b[te],++ie,++te,te===b.length&&(te=0)}function he(ce,le,xe,U,De){var de=i?1:r,He=yg(De,ce*de,le*de,xe*de,U*de,o.color,o.symbolKeepAspect);if(i){var Be=n.painter.renderOneToVNode(He);Be&&R.children.push(Be)}else goe(N,He)}}}}function yoe(e){if(!e||e.length===0)return[["rect"]];if(Rt(e))return[[e]];for(var t=!0,r=0;r<e.length;++r)if(!Rt(e[r])){t=!1;break}if(t)return yoe([e]);for(var n=[],r=0;r<e.length;++r)Rt(e[r])?n.push([e[r]]):n.push(e[r]);return n}function moe(e){if(!e||e.length===0)return[[0,0]];if(en(e)){var t=Math.ceil(e);return[[t,t]]}for(var r=!0,n=0;n<e.length;++n)if(!en(e[n])){r=!1;break}if(r)return moe([e]);for(var i=[],n=0;n<e.length;++n)if(en(e[n])){var t=Math.ceil(e[n]);i.push([t,t])}else{var t=Lt(e[n],function(s){return Math.ceil(s)});t.length%2===1?i.push(t.concat(t)):i.push(t)}return i}function dPe(e){if(!e||typeof e=="object"&&e.length===0)return[0,0];if(en(e)){var t=Math.ceil(e);return[t,t]}var r=Lt(e,function(n){return Math.ceil(n)});return e.length%2?r.concat(r):r}function vPe(e){return Lt(e,function(t){return boe(t)})}function boe(e){for(var t=0,r=0;r<e.length;++r)t+=e[r];return e.length%2===1?t*2:t}function pPe(e,t){e.eachRawSeries(function(r){if(!e.isSeriesFiltered(r)){var n=r.getData();n.hasItemVisual()&&n.each(function(o){var s=n.getItemVisual(o,"decal");if(s){var l=n.ensureUniqueItemVisual(o,"style");l.decal=sN(s,t)}});var i=n.getVisual("decal");if(i){var a=n.getVisual("style");a.decal=sN(i,t)}}})}var gPe=new Cl;const ms=gPe;var woe={};function yPe(e,t){woe[e]=t}function mPe(e){return woe[e]}var bPe=1,wPe=800,_Pe=900,SPe=1e3,CPe=2e3,xPe=5e3,_oe=1e3,TPe=1100,$3=2e3,Soe=3e3,OPe=4e3,Ik=4500,EPe=4600,RPe=5e3,kPe=6e3,Coe=7e3,APe={PROCESSOR:{FILTER:SPe,SERIES_FILTER:wPe,STATISTIC:xPe},VISUAL:{LAYOUT:_oe,PROGRESSIVE_LAYOUT:TPe,GLOBAL:$3,CHART:Soe,POST_CHART_LAYOUT:EPe,COMPONENT:OPe,BRUSH:RPe,CHART_ITEM:Ik,ARIA:kPe,DECAL:Coe}},Ai="__flagInMainProcess",Ea="__pendingUpdate",oM="__needsUpdateStatus",vG=/^[a-zA-Z0-9_]+$/,sM="__connectUpdateStatus",pG=0,PPe=1,IPe=2;function xoe(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.isDisposed()){this.id;return}return Ooe(this,e,t)}}function Toe(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Ooe(this,e,t)}}function Ooe(e,t,r){return r[0]=r[0]&&r[0].toLowerCase(),Cl.prototype[t].apply(e,r)}var Eoe=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Cl),Roe=Eoe.prototype;Roe.on=Toe("on");Roe.off=Toe("off");var Vv,lM,yx,bf,uM,fM,cM,E0,R0,gG,yG,hM,mG,mx,bG,koe,Co,wG,Aoe=function(e){ct(t,e);function t(r,n,i){var a=e.call(this,new DAe)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],i=i||{},Rt(n)&&(n=Poe[n]),a._dom=r;var o="canvas",s="auto",l=!1,u=a._zr=C6(r,{renderer:i.renderer||o,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:Tr(i.useDirtyRect,l),useCoarsePointer:Tr(i.useCoarsePointer,s),pointerSize:i.pointerSize});a._ssr=i.ssr,a._throttledZrFlush=Pk(un(u.flush,u),17),n=Rr(n),n&&Wae(n,!0),a._theme=n,a._locale=LRe(i.locale||mae),a._coordSysMgr=new E3;var f=a._api=bG(a);function c(h,d){return h.__prio-d.__prio}return KT(RE,c),KT(lN,c),a._scheduler=new foe(a,f,lN,RE),a._messageCenter=new Eoe,a._initEvents(),a.resize=un(a.resize,a),u.animation.on("frame",a._onframe,a),gG(u,a),yG(u,a),b$(a),a}return t.prototype._onframe=function(){if(!this._disposed){wG(this);var r=this._scheduler;if(this[Ea]){var n=this[Ea].silent;this[Ai]=!0;try{Vv(this),bf.update.call(this,null,this[Ea].updateParams)}catch(l){throw this[Ai]=!1,this[Ea]=null,l}this._zr.flush(),this[Ai]=!1,this[Ea]=null,E0.call(this,n),R0.call(this,n)}else if(r.unfinished){var i=bPe,a=this._model,o=this._api;r.unfinished=!1;do{var s=+new Date;r.performSeriesTasks(a),r.performDataProcessorTasks(a),fM(this,a),r.performVisualTasks(a),mx(this,this._model,o,"remain",{}),i-=+new Date-s}while(i>0&&r.unfinished);r.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(r,n,i){if(!this[Ai]){if(this._disposed){this.id;return}var a,o,s;if($t(n)&&(i=n.lazyUpdate,a=n.silent,o=n.replaceMerge,s=n.transition,n=n.notMerge),this[Ai]=!0,!this._model||n){var l=new yke(this._api),u=this._theme,f=this._model=new Fae;f.scheduler=this._scheduler,f.ssr=this._ssr,f.init(null,null,null,u,this._locale,l)}this._model.setOption(r,{replaceMerge:o},uN);var c={seriesTransition:s,optionChanged:!0};if(i)this[Ea]={silent:a,updateParams:c},this[Ai]=!1,this.getZr().wakeUp();else{try{Vv(this),bf.update.call(this,null,c)}catch(h){throw this[Ea]=null,this[Ai]=!1,h}this._ssr||this._zr.flush(),this[Ea]=null,this[Ai]=!1,E0.call(this,a),R0.call(this,a)}}},t.prototype.setTheme=function(){},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||vr.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(r){return this.renderToCanvas(r)},t.prototype.renderToCanvas=function(r){r=r||{};var n=this._zr.painter;return n.getRenderedCanvas({backgroundColor:r.backgroundColor||this._model.get("backgroundColor"),pixelRatio:r.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(r){r=r||{};var n=this._zr.painter;return n.renderToString({useViewBox:r.useViewBox})},t.prototype.getSvgDataURL=function(){if(vr.svgSupported){var r=this._zr,n=r.storage.getDisplayList();return ye(n,function(i){i.stopAnimation(null,!0)}),r.painter.toDataURL()}},t.prototype.getDataURL=function(r){if(this._disposed){this.id;return}r=r||{};var n=r.excludeComponents,i=this._model,a=[],o=this;ye(n,function(l){i.eachComponent({mainType:l},function(u){var f=o._componentsMap[u.__viewId];f.group.ignore||(a.push(f),f.group.ignore=!0)})});var s=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(r).toDataURL("image/"+(r&&r.type||"png"));return ye(a,function(l){l.group.ignore=!1}),s},t.prototype.getConnectedDataURL=function(r){if(this._disposed){this.id;return}var n=r.type==="svg",i=this.group,a=Math.min,o=Math.max,s=1/0;if(_G[i]){var l=s,u=s,f=-s,c=-s,h=[],d=r&&r.pixelRatio||this.getDevicePixelRatio();ye(zb,function(_,x){if(_.group===i){var E=n?_.getZr().painter.getSvgDom().innerHTML:_.renderToCanvas(Rr(r)),R=_.getDom().getBoundingClientRect();l=a(R.left,l),u=a(R.top,u),f=o(R.right,f),c=o(R.bottom,c),h.push({dom:E,left:R.left,top:R.top})}}),l*=d,u*=d,f*=d,c*=d;var v=f-l,g=c-u,y=Am.createCanvas(),b=C6(y,{renderer:n?"svg":"canvas"});if(b.resize({width:v,height:g}),n){var w="";return ye(h,function(_){var x=_.left-l,E=_.top-u;w+='<g transform="translate('+x+","+E+')">'+_.dom+"</g>"}),b.painter.getSvgRoot().innerHTML=w,r.connectedBackgroundColor&&b.painter.setBackgroundColor(r.connectedBackgroundColor),b.refreshImmediately(),b.painter.toDataURL()}else return r.connectedBackgroundColor&&b.add(new ci({shape:{x:0,y:0,width:v,height:g},style:{fill:r.connectedBackgroundColor}})),ye(h,function(_){var x=new Kd({style:{x:_.left*d-l,y:_.top*d-u,image:_.dom}});b.add(x)}),b.refreshImmediately(),y.toDataURL("image/"+(r&&r.type||"png"))}else return this.getDataURL(r)},t.prototype.convertToPixel=function(r,n){return uM(this,"convertToPixel",r,n)},t.prototype.convertFromPixel=function(r,n){return uM(this,"convertFromPixel",r,n)},t.prototype.containPixel=function(r,n){if(this._disposed){this.id;return}var i=this._model,a,o=II(i,r);return ye(o,function(s,l){l.indexOf("Models")>=0&&ye(s,function(u){var f=u.coordinateSystem;if(f&&f.containPoint)a=a||!!f.containPoint(n);else if(l==="seriesModels"){var c=this._chartsMap[u.__viewId];c&&c.containPoint&&(a=a||c.containPoint(n,u))}},this)},this),!!a},t.prototype.getVisual=function(r,n){var i=this._model,a=II(i,r,{defaultMainType:"series"}),o=a.seriesModel,s=o.getData(),l=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?s.indexOfRawIndex(a.dataIndex):null;return l!=null?LAe(s,l,n):FAe(s,n)},t.prototype.getViewOfComponentModel=function(r){return this._componentsMap[r.__viewId]},t.prototype.getViewOfSeriesModel=function(r){return this._chartsMap[r.__viewId]},t.prototype._initEvents=function(){var r=this;ye(MPe,function(n){var i=function(a){var o=r.getModel(),s=a.target,l,u=n==="globalout";if(u?l={}:s&&wb(s,function(v){var g=Ur(v);if(g&&g.dataIndex!=null){var y=g.dataModel||o.getSeriesByIndex(g.seriesIndex);return l=y&&y.getDataParams(g.dataIndex,g.dataType)||{},!0}else if(g.eventData)return l=et({},g.eventData),!0},!0),l){var f=l.componentType,c=l.componentIndex;(f==="markLine"||f==="markPoint"||f==="markArea")&&(f="series",c=l.seriesIndex);var h=f&&c!=null&&o.getComponent(f,c),d=h&&r[h.mainType==="series"?"_chartsMap":"_componentsMap"][h.__viewId];l.event=a,l.type=n,r._$eventProcessor.eventInfo={targetEl:s,packedEvent:l,model:h,view:d},r.trigger(n,l)}};i.zrEventfulCallAtLast=!0,r._zr.on(n,i,r)}),ye(jb,function(n,i){r._messageCenter.on(i,function(a){this.trigger(i,a)},r)}),ye(["selectchanged"],function(n){r._messageCenter.on(n,function(i){this.trigger(n,i)},r)}),BAe(this._messageCenter,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var r=this.getDom();r&&bie(this.getDom(),L3,"");var n=this,i=n._api,a=n._model;ye(n._componentsViews,function(o){o.dispose(a,i)}),ye(n._chartsViews,function(o){o.dispose(a,i)}),n._zr.dispose(),n._dom=n._model=n._chartsMap=n._componentsMap=n._chartsViews=n._componentsViews=n._scheduler=n._api=n._zr=n._throttledZrFlush=n._theme=n._coordSysMgr=n._messageCenter=null,delete zb[n.id]},t.prototype.resize=function(r){if(!this[Ai]){if(this._disposed){this.id;return}this._zr.resize(r);var n=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!n){var i=n.resetOption("media"),a=r&&r.silent;this[Ea]&&(a==null&&(a=this[Ea].silent),i=!0,this[Ea]=null),this[Ai]=!0;try{i&&Vv(this),bf.update.call(this,{type:"resize",animation:et({duration:0},r&&r.animation)})}catch(o){throw this[Ai]=!1,o}this[Ai]=!1,E0.call(this,a),R0.call(this,a)}}},t.prototype.showLoading=function(r,n){if(this._disposed){this.id;return}if($t(r)&&(n=r,r=""),r=r||"default",this.hideLoading(),!!fN[r]){var i=fN[r](this._api,n),a=this._zr;this._loadingFX=i,a.add(i)}},t.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},t.prototype.makeActionFromEvent=function(r){var n=et({},r);return n.type=jb[r.type],n},t.prototype.dispatchAction=function(r,n){if(this._disposed){this.id;return}if($t(n)||(n={silent:!!n}),!!EE[r.type]&&this._model){if(this[Ai]){this._pendingActions.push(r);return}var i=n.silent;cM.call(this,r,i);var a=n.flush;a?this._zr.flush():a!==!1&&vr.browser.weChat&&this._throttledZrFlush(),E0.call(this,i),R0.call(this,i)}},t.prototype.updateLabelLayout=function(){ms.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(r){if(this._disposed){this.id;return}var n=r.seriesIndex,i=this.getModel(),a=i.getSeriesByIndex(n);a.appendData(r),this._scheduler.unfinished=!0,this.getZr().wakeUp()},t.internalField=function(){Vv=function(c){var h=c._scheduler;h.restorePipelines(c._model),h.prepareStageTasks(),lM(c,!0),lM(c,!1),h.plan()},lM=function(c,h){for(var d=c._model,v=c._scheduler,g=h?c._componentsViews:c._chartsViews,y=h?c._componentsMap:c._chartsMap,b=c._zr,w=c._api,_=0;_<g.length;_++)g[_].__alive=!1;h?d.eachComponent(function(R,A){R!=="series"&&x(A)}):d.eachSeries(x);function x(R){var A=R.__requireNewView;R.__requireNewView=!1;var N="_ec_"+R.id+"_"+R.type,I=!A&&y[N];if(!I){var F=vl(R.type),H=h?Vu.getClass(F.main,F.sub):yl.getClass(F.sub);I=new H,I.init(d,w),y[N]=I,g.push(I),b.add(I.group)}R.__viewId=I.__id=N,I.__alive=!0,I.__model=R,I.group.__ecComponentInfo={mainType:R.mainType,index:R.componentIndex},!h&&v.prepareView(I,R,d,w)}for(var _=0;_<g.length;){var E=g[_];E.__alive?_++:(!h&&E.renderTask.dispose(),b.remove(E.group),E.dispose(d,w),g.splice(_,1),y[E.__id]===E&&delete y[E.__id],E.__id=E.group.__ecComponentInfo=null)}},yx=function(c,h,d,v,g){var y=c._model;if(y.setUpdatePayload(d),!v){ye([].concat(c._componentsViews).concat(c._chartsViews),E);return}var b={};b[v+"Id"]=d[v+"Id"],b[v+"Index"]=d[v+"Index"],b[v+"Name"]=d[v+"Name"];var w={mainType:v,query:b};g&&(w.subType=g);var _=d.excludeSeriesId,x;_!=null&&(x=pr(),ye(va(_),function(R){var A=gl(R,null);A!=null&&x.set(A,!0)})),y&&y.eachComponent(w,function(R){var A=x&&x.get(R.id)!=null;if(!A)if(ez(d))if(R instanceof Cc)d.type===yd&&!d.notBlur&&!R.get(["emphasis","disabled"])&&dEe(R,d,c._api);else{var N=f3(R.mainType,R.componentIndex,d.name,c._api),I=N.focusSelf,F=N.dispatchers;d.type===yd&&I&&!d.notBlur&&j$(R.mainType,R.componentIndex,c._api),F&&ye(F,function(H){d.type===yd?vE(H):pE(H)})}else Y$(d)&&R instanceof Cc&&(gEe(R,d,c._api),J6(R),Co(c))},c),y&&y.eachComponent(w,function(R){var A=x&&x.get(R.id)!=null;A||E(c[v==="series"?"_chartsMap":"_componentsMap"][R.__viewId])},c);function E(R){R&&R.__alive&&R[h]&&R[h](R.__model,y,c._api,d)}},bf={prepareAndUpdate:function(c){Vv(this),bf.update.call(this,c,{optionChanged:c.newOption!=null})},update:function(c,h){var d=this._model,v=this._api,g=this._zr,y=this._coordSysMgr,b=this._scheduler;if(d){d.setUpdatePayload(c),b.restoreData(d,c),b.performSeriesTasks(d),y.create(d,v),b.performDataProcessorTasks(d,c),fM(this,d),y.update(d,v),r(d),b.performVisualTasks(d,c),hM(this,d,v,c,h);var w=d.get("backgroundColor")||"transparent",_=d.get("darkMode");g.setBackgroundColor(w),_!=null&&_!=="auto"&&g.setDarkMode(_),ms.trigger("afterupdate",d,v)}},updateTransform:function(c){var h=this,d=this._model,v=this._api;if(d){d.setUpdatePayload(c);var g=[];d.eachComponent(function(b,w){if(b!=="series"){var _=h.getViewOfComponentModel(w);if(_&&_.__alive)if(_.updateTransform){var x=_.updateTransform(w,d,v,c);x&&x.update&&g.push(_)}else g.push(_)}});var y=pr();d.eachSeries(function(b){var w=h._chartsMap[b.__viewId];if(w.updateTransform){var _=w.updateTransform(b,d,v,c);_&&_.update&&y.set(b.uid,1)}else y.set(b.uid,1)}),r(d),this._scheduler.performVisualTasks(d,c,{setDirty:!0,dirtyMap:y}),mx(this,d,v,c,{},y),ms.trigger("afterupdate",d,v)}},updateView:function(c){var h=this._model;h&&(h.setUpdatePayload(c),yl.markUpdateMethod(c,"updateView"),r(h),this._scheduler.performVisualTasks(h,c,{setDirty:!0}),hM(this,h,this._api,c,{}),ms.trigger("afterupdate",h,this._api))},updateVisual:function(c){var h=this,d=this._model;d&&(d.setUpdatePayload(c),d.eachSeries(function(v){v.getData().clearAllVisual()}),yl.markUpdateMethod(c,"updateVisual"),r(d),this._scheduler.performVisualTasks(d,c,{visualType:"visual",setDirty:!0}),d.eachComponent(function(v,g){if(v!=="series"){var y=h.getViewOfComponentModel(g);y&&y.__alive&&y.updateVisual(g,d,h._api,c)}}),d.eachSeries(function(v){var g=h._chartsMap[v.__viewId];g.updateVisual(v,d,h._api,c)}),ms.trigger("afterupdate",d,this._api))},updateLayout:function(c){bf.update.call(this,c)}},uM=function(c,h,d,v){if(c._disposed){c.id;return}for(var g=c._model,y=c._coordSysMgr.getCoordinateSystems(),b,w=II(g,d),_=0;_<y.length;_++){var x=y[_];if(x[h]&&(b=x[h](g,w,v))!=null)return b}},fM=function(c,h){var d=c._chartsMap,v=c._scheduler;h.eachSeries(function(g){v.updateStreamModes(g,d[g.__viewId])})},cM=function(c,h){var d=this,v=this.getModel(),g=c.type,y=c.escapeConnect,b=EE[g],w=b.actionInfo,_=(w.update||"update").split(":"),x=_.pop(),E=_[0]!=null&&vl(_[0]);this[Ai]=!0;var R=[c],A=!1;c.batch&&(A=!0,R=Lt(c.batch,function(te){return te=Vr(et({},te),c),te.batch=null,te}));var N=[],I,F=Y$(c),H=ez(c);if(H&&Vie(this._api),ye(R,function(te){if(I=b.action(te,d._model,d._api),I=I||et({},te),I.type=w.event||I.type,N.push(I),H){var ie=a3(c),fe=ie.queryOptionMap,Te=ie.mainTypeSpecified,M=Te?fe.keys()[0]:"series";yx(d,x,te,M),Co(d)}else F?(yx(d,x,te,"series"),Co(d)):E&&yx(d,x,te,E.main,E.sub)}),x!=="none"&&!H&&!F&&!E)try{this[Ea]?(Vv(this),bf.update.call(this,c),this[Ea]=null):bf[x].call(this,c)}catch(te){throw this[Ai]=!1,te}if(A?I={type:w.event||g,escapeConnect:y,batch:N}:I=N[0],this[Ai]=!1,!h){var W=this._messageCenter;if(W.trigger(I.type,I),F){var z={type:"selectchanged",escapeConnect:y,selected:yEe(v),isFromClick:c.isFromClick||!1,fromAction:c.type,fromActionPayload:c};W.trigger(z.type,z)}}},E0=function(c){for(var h=this._pendingActions;h.length;){var d=h.shift();cM.call(this,d,c)}},R0=function(c){!c&&this.trigger("updated")},gG=function(c,h){c.on("rendered",function(d){h.trigger("rendered",d),c.animation.isFinished()&&!h[Ea]&&!h._scheduler.unfinished&&!h._pendingActions.length&&h.trigger("finished")})},yG=function(c,h){c.on("mouseover",function(d){var v=d.target,g=wb(v,G$);g&&(vEe(g,d,h._api),Co(h))}).on("mouseout",function(d){var v=d.target,g=wb(v,G$);g&&(pEe(g,d,h._api),Co(h))}).on("click",function(d){var v=d.target,g=wb(v,function(w){return Ur(w).dataIndex!=null},!0);if(g){var y=g.selected?"unselect":"select",b=Ur(g);h._api.dispatchAction({type:y,dataType:b.dataType,dataIndexInside:b.dataIndex,seriesIndex:b.seriesIndex,isFromClick:!0})}})};function r(c){c.clearColorPalette(),c.eachSeries(function(h){h.clearColorPalette()})}function n(c){var h=[],d=[],v=!1;if(c.eachComponent(function(w,_){var x=_.get("zlevel")||0,E=_.get("z")||0,R=_.getZLevelKey();v=v||!!R,(w==="series"?d:h).push({zlevel:x,z:E,idx:_.componentIndex,type:w,key:R})}),v){var g=h.concat(d),y,b;KT(g,function(w,_){return w.zlevel===_.zlevel?w.z-_.z:w.zlevel-_.zlevel}),ye(g,function(w){var _=c.getComponent(w.type,w.idx),x=w.zlevel,E=w.key;y!=null&&(x=Math.max(y,x)),E?(x===y&&E!==b&&x++,b=E):b&&(x===y&&x++,b=""),y=x,_.setZLevel(x)})}}hM=function(c,h,d,v,g){n(h),mG(c,h,d,v,g),ye(c._chartsViews,function(y){y.__alive=!1}),mx(c,h,d,v,g),ye(c._chartsViews,function(y){y.__alive||y.remove(h,d)})},mG=function(c,h,d,v,g,y){ye(y||c._componentsViews,function(b){var w=b.__model;u(w,b),b.render(w,h,d,v),s(w,b),f(w,b)})},mx=function(c,h,d,v,g,y){var b=c._scheduler;g=et(g||{},{updatedSeries:h.getSeries()}),ms.trigger("series:beforeupdate",h,d,g);var w=!1;h.eachSeries(function(_){var x=c._chartsMap[_.__viewId];x.__alive=!0;var E=x.renderTask;b.updatePayload(E,v),u(_,x),y&&y.get(_.uid)&&E.dirty(),E.perform(b.getPerformArgs(E))&&(w=!0),x.group.silent=!!_.get("silent"),o(_,x),J6(_)}),b.unfinished=w||b.unfinished,ms.trigger("series:layoutlabels",h,d,g),ms.trigger("series:transition",h,d,g),h.eachSeries(function(_){var x=c._chartsMap[_.__viewId];s(_,x),f(_,x)}),a(c,h),ms.trigger("series:afterupdate",h,d,g)},Co=function(c){c[oM]=!0,c.getZr().wakeUp()},wG=function(c){c[oM]&&(c.getZr().storage.traverse(function(h){Bb(h)||i(h)}),c[oM]=!1)};function i(c){for(var h=[],d=c.currentStates,v=0;v<d.length;v++){var g=d[v];g==="emphasis"||g==="blur"||g==="select"||h.push(g)}c.selected&&c.states.select&&h.push("select"),c.hoverState===vk&&c.states.emphasis?h.push("emphasis"):c.hoverState===dk&&c.states.blur&&h.push("blur"),c.useStates(h)}function a(c,h){var d=c._zr,v=d.storage,g=0;v.traverse(function(y){y.isGroup||g++}),g>h.get("hoverLayerThreshold")&&!vr.node&&!vr.worker&&h.eachSeries(function(y){if(!y.preventUsingHoverLayer){var b=c._chartsMap[y.__viewId];b.__alive&&b.eachRendered(function(w){w.states.emphasis&&(w.states.emphasis.hoverLayer=!0)})}})}function o(c,h){var d=c.get("blendMode")||null;h.eachRendered(function(v){v.isGroup||(v.style.blend=d)})}function s(c,h){if(!c.preventAutoZ){var d=c.get("z")||0,v=c.get("zlevel")||0;h.eachRendered(function(g){return l(g,d,v,-1/0),!0})}}function l(c,h,d,v){var g=c.getTextContent(),y=c.getTextGuideLine(),b=c.isGroup;if(b)for(var w=c.childrenRef(),_=0;_<w.length;_++)v=Math.max(l(w[_],h,d,v),v);else c.z=h,c.zlevel=d,v=Math.max(c.z2,v);if(g&&(g.z=h,g.zlevel=d,isFinite(v)&&(g.z2=v+2)),y){var x=c.textGuideLineConfig;y.z=h,y.zlevel=d,isFinite(v)&&(y.z2=v+(x&&x.showAbove?1:-1))}return v}function u(c,h){h.eachRendered(function(d){if(!Bb(d)){var v=d.getTextContent(),g=d.getTextGuideLine();d.stateTransition&&(d.stateTransition=null),v&&v.stateTransition&&(v.stateTransition=null),g&&g.stateTransition&&(g.stateTransition=null),d.hasState()?(d.prevStates=d.currentStates,d.clearStates()):d.prevStates&&(d.prevStates=null)}})}function f(c,h){var d=c.getModel("stateAnimation"),v=c.isAnimationEnabled(),g=d.get("duration"),y=g>0?{duration:g,delay:d.get("delay"),easing:d.get("easing")}:null;h.eachRendered(function(b){if(b.states&&b.states.emphasis){if(Bb(b))return;if(b instanceof zr&&SEe(b),b.__dirty){var w=b.prevStates;w&&b.useStates(w)}if(v){b.stateTransition=y;var _=b.getTextContent(),x=b.getTextGuideLine();_&&(_.stateTransition=y),x&&(x.stateTransition=y)}b.__dirty&&i(b)}})}bG=function(c){return new(function(h){ct(d,h);function d(){return h!==null&&h.apply(this,arguments)||this}return d.prototype.getCoordinateSystems=function(){return c._coordSysMgr.getCoordinateSystems()},d.prototype.getComponentByElement=function(v){for(;v;){var g=v.__ecComponentInfo;if(g!=null)return c._model.getComponent(g.mainType,g.index);v=v.parent}},d.prototype.enterEmphasis=function(v,g){vE(v,g),Co(c)},d.prototype.leaveEmphasis=function(v,g){pE(v,g),Co(c)},d.prototype.enterBlur=function(v){hEe(v),Co(c)},d.prototype.leaveBlur=function(v){Fie(v),Co(c)},d.prototype.enterSelect=function(v){Hie(v),Co(c)},d.prototype.leaveSelect=function(v){Bie(v),Co(c)},d.prototype.getModel=function(){return c.getModel()},d.prototype.getViewOfComponentModel=function(v){return c.getViewOfComponentModel(v)},d.prototype.getViewOfSeriesModel=function(v){return c.getViewOfSeriesModel(v)},d}(Hae))(c)},koe=function(c){function h(d,v){for(var g=0;g<d.length;g++){var y=d[g];y[sM]=v}}ye(jb,function(d,v){c._messageCenter.on(v,function(g){if(_G[c.group]&&c[sM]!==pG){if(g&&g.escapeConnect)return;var y=c.makeActionFromEvent(g),b=[];ye(zb,function(w){w!==c&&w.group===c.group&&b.push(w)}),h(b,pG),ye(b,function(w){w[sM]!==PPe&&w.dispatchAction(y)}),h(b,IPe)}})})}}(),t}(Cl),N3=Aoe.prototype;N3.on=xoe("on");N3.off=xoe("off");N3.one=function(e,t,r){var n=this;function i(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];t&&t.apply&&t.apply(this,a),n.off(e,i)}this.on.call(this,e,i,r)};var MPe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var EE={},jb={},lN=[],uN=[],RE=[],Poe={},fN={},zb={},_G={},DPe=+new Date-0,L3="_echarts_instance_";function $Pe(e,t,r){var n=!(r&&r.ssr);if(n){var i=NPe(e);if(i)return i}var a=new Aoe(e,t,r);return a.id="ec_"+DPe++,zb[a.id]=a,n&&bie(e,L3,a.id),koe(a),ms.trigger("afterinit",a),a}function NPe(e){return zb[JTe(e,L3)]}function F3(e,t){Poe[e]=t}function Ioe(e){Xr(uN,e)<0&&uN.push(e)}function Moe(e,t){B3(lN,e,t,CPe)}function LPe(e){H3("afterinit",e)}function FPe(e){H3("afterupdate",e)}function H3(e,t){ms.on(e,t)}function Dm(e,t,r){lr(t)&&(r=t,t="");var n=$t(e)?e.type:[e,e={event:t}][0];e.event=(e.event||n).toLowerCase(),t=e.event,!jb[t]&&(Bu(vG.test(n)&&vG.test(t)),EE[n]||(EE[n]={action:r,actionInfo:e}),jb[t]=n)}function HPe(e,t){E3.register(e,t)}function BPe(e,t){B3(RE,e,t,_oe,"layout")}function Zd(e,t){B3(RE,e,t,Soe,"visual")}var SG=[];function B3(e,t,r,n,i){if((lr(t)||$t(t))&&(r=t,t=n),!(Xr(SG,r)>=0)){SG.push(r);var a=foe.wrapStageHandler(r,i);a.__prio=t,a.__raw=r,e.push(a)}}function Doe(e,t){fN[e]=t}function WPe(e,t,r){var n=mPe("registerMap");n&&n(e,t,r)}var VPe=Uke;Zd($3,mAe);Zd(Ik,bAe);Zd(Ik,wAe);Zd($3,$Ae);Zd(Ik,NAe);Zd(Coe,pPe);Ioe(Wae);Moe(_Pe,Tke);Doe("default",_Ae);Dm({type:yd,event:yd,update:yd},Na);Dm({type:tO,event:tO,update:tO},Na);Dm({type:Lb,event:Lb,update:Lb},Na);Dm({type:rO,event:rO,update:rO},Na);Dm({type:Fb,event:Fb,update:Fb},Na);F3("light",IAe);F3("dark",MAe);function k0(e){return e==null?0:e.length||1}function CG(e){return e}var UPe=function(){function e(t,r,n,i,a,o){this._old=t,this._new=r,this._oldKeyGetter=n||CG,this._newKeyGetter=i||CG,this.context=a,this._diffModeMultiple=o==="multiple"}return e.prototype.add=function(t){return this._add=t,this},e.prototype.update=function(t){return this._update=t,this},e.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},e.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},e.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},e.prototype.remove=function(t){return this._remove=t,this},e.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},e.prototype._executeOneToOne=function(){var t=this._old,r=this._new,n={},i=new Array(t.length),a=new Array(r.length);this._initIndexMap(t,null,i,"_oldKeyGetter"),this._initIndexMap(r,n,a,"_newKeyGetter");for(var o=0;o<t.length;o++){var s=i[o],l=n[s],u=k0(l);if(u>1){var f=l.shift();l.length===1&&(n[s]=l[0]),this._update&&this._update(f,o)}else u===1?(n[s]=null,this._update&&this._update(l,o)):this._remove&&this._remove(o)}this._performRestAdd(a,n)},e.prototype._executeMultiple=function(){var t=this._old,r=this._new,n={},i={},a=[],o=[];this._initIndexMap(t,n,a,"_oldKeyGetter"),this._initIndexMap(r,i,o,"_newKeyGetter");for(var s=0;s<a.length;s++){var l=a[s],u=n[l],f=i[l],c=k0(u),h=k0(f);if(c>1&&h===1)this._updateManyToOne&&this._updateManyToOne(f,u),i[l]=null;else if(c===1&&h>1)this._updateOneToMany&&this._updateOneToMany(f,u),i[l]=null;else if(c===1&&h===1)this._update&&this._update(f,u),i[l]=null;else if(c>1&&h>1)this._updateManyToMany&&this._updateManyToMany(f,u),i[l]=null;else if(c>1)for(var d=0;d<c;d++)this._remove&&this._remove(u[d]);else this._remove&&this._remove(u)}this._performRestAdd(o,i)},e.prototype._performRestAdd=function(t,r){for(var n=0;n<t.length;n++){var i=t[n],a=r[i],o=k0(a);if(o>1)for(var s=0;s<o;s++)this._add&&this._add(a[s]);else o===1&&this._add&&this._add(a);r[i]=null}},e.prototype._initIndexMap=function(t,r,n,i){for(var a=this._diffModeMultiple,o=0;o<t.length;o++){var s="_ec_"+this[i](t[o],o);if(a||(n[o]=s),!!r){var l=r[s],u=k0(l);u===0?(r[s]=o,a&&n.push(s)):u===1?r[s]=[l,o]:l.push(o)}}},e}();const jPe=UPe;var zPe=function(){function e(t,r){this._encode=t,this._schema=r}return e.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},e.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},e}();function GPe(e,t){var r={},n=r.encode={},i=pr(),a=[],o=[],s={};ye(e.dimensions,function(h){var d=e.getDimensionInfo(h),v=d.coordDim;if(v){var g=d.coordDimIndex;dM(n,v)[g]=h,d.isExtraCoord||(i.set(v,1),KPe(d.type)&&(a[0]=h),dM(s,v)[g]=e.getDimensionIndex(d.name)),d.defaultTooltip&&o.push(h)}Iae.each(function(y,b){var w=dM(n,b),_=d.otherDims[b];_!=null&&_!==!1&&(w[_]=d.name)})});var l=[],u={};i.each(function(h,d){var v=n[d];u[d]=v[0],l=l.concat(v)}),r.dataDimsOnCoord=l,r.dataDimIndicesOnCoord=Lt(l,function(h){return e.getDimensionInfo(h).storeDimIndex}),r.encodeFirstDimNotExtra=u;var f=n.label;f&&f.length&&(a=f.slice());var c=n.tooltip;return c&&c.length?o=c.slice():o.length||(o=a.slice()),n.defaultedLabel=a,n.defaultedTooltip=o,r.userOutput=new zPe(s,t),r}function dM(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}function YPe(e){return e==="category"?"ordinal":e==="time"?"time":"float"}function KPe(e){return!(e==="ordinal"||e==="time")}var XPe=function(){function e(t){this.otherDims={},t!=null&&et(this,t)}return e}();const oO=XPe;var qPe=ti(),ZPe={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},$oe=function(){function e(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return e.prototype.isDimensionOmitted=function(){return this._dimOmitted},e.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=Foe(this.source)))},e.prototype.getSourceDimensionIndex=function(t){return Tr(this._dimNameMap.get(t),-1)},e.prototype.getSourceDimension=function(t){var r=this.source.dimensionsDefine;if(r)return r[t]},e.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,r=Uae(this.source),n=!Hoe(t),i="",a=[],o=0,s=0;o<t;o++){var l=void 0,u=void 0,f=void 0,c=this.dimensions[s];if(c&&c.storeDimIndex===o)l=r?c.name:null,u=c.type,f=c.ordinalMeta,s++;else{var h=this.getSourceDimension(o);h&&(l=r?h.name:null,u=h.type)}a.push({property:l,type:u,ordinalMeta:f}),r&&l!=null&&(!c||!c.isCalculationCoord)&&(i+=n?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),i+="$",i+=ZPe[u]||"f",f&&(i+=f.uid),i+="$"}var d=this.source,v=[d.seriesLayoutBy,d.startIndex,i].join("$$");return{dimensions:a,hash:v}},e.prototype.makeOutputDimensionNames=function(){for(var t=[],r=0,n=0;r<this._fullDimCount;r++){var i=void 0,a=this.dimensions[n];if(a&&a.storeDimIndex===r)a.isCalculationCoord||(i=a.name),n++;else{var o=this.getSourceDimension(r);o&&(i=o.name)}t.push(i)}return t},e.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},e}();function Noe(e){return e instanceof $oe}function Loe(e){for(var t=pr(),r=0;r<(e||[]).length;r++){var n=e[r],i=$t(n)?n.name:n;i!=null&&t.get(i)==null&&t.set(i,r)}return t}function Foe(e){var t=qPe(e);return t.dimNameMap||(t.dimNameMap=Loe(e.dimensionsDefine))}function Hoe(e){return e>30}var A0=$t,wf=Lt,JPe=typeof Int32Array>"u"?Array:Int32Array,QPe="e\0\0",xG=-1,eIe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],tIe=["_approximateExtent"],TG,bx,P0,I0,vM,_x,pM,rIe=function(){function e(t,r){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var n,i=!1;Noe(t)?(n=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(i=!0,n=t),n=n||["x","y"];for(var a={},o=[],s={},l=!1,u={},f=0;f<n.length;f++){var c=n[f],h=Rt(c)?new oO({name:c}):c instanceof oO?c:new oO(c),d=h.name;h.type=h.type||"float",h.coordDim||(h.coordDim=d,h.coordDimIndex=0);var v=h.otherDims=h.otherDims||{};o.push(d),a[d]=h,u[d]!=null&&(l=!0),h.createInvertedIndices&&(s[d]=[]),v.itemName===0&&(this._nameDimIdx=f),v.itemId===0&&(this._idDimIdx=f),i&&(h.storeDimIndex=f)}if(this.dimensions=o,this._dimInfos=a,this._initGetDimensionInfo(l),this.hostModel=r,this._invertedIndicesMap=s,this._dimOmitted){var g=this._dimIdxToName=pr();ye(o,function(y){g.set(a[y].storeDimIndex,y)})}}return e.prototype.getDimension=function(t){var r=this._recognizeDimIndex(t);if(r==null)return t;if(r=t,!this._dimOmitted)return this.dimensions[r];var n=this._dimIdxToName.get(r);if(n!=null)return n;var i=this._schema.getSourceDimension(r);if(i)return i.name},e.prototype.getDimensionIndex=function(t){var r=this._recognizeDimIndex(t);if(r!=null)return r;if(t==null)return-1;var n=this._getDimInfo(t);return n?n.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},e.prototype._recognizeDimIndex=function(t){if(en(t)||t!=null&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},e.prototype._getStoreDimIndex=function(t){var r=this.getDimensionIndex(t);return r},e.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},e.prototype._initGetDimensionInfo=function(t){var r=this._dimInfos;this._getDimInfo=t?function(n){return r.hasOwnProperty(n)?r[n]:void 0}:function(n){return r[n]}},e.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},e.prototype.mapDimension=function(t,r){var n=this._dimSummary;if(r==null)return n.encodeFirstDimNotExtra[t];var i=n.encode[t];return i?i[r]:null},e.prototype.mapDimensionsAll=function(t){var r=this._dimSummary,n=r.encode[t];return(n||[]).slice()},e.prototype.getStore=function(){return this._store},e.prototype.initData=function(t,r,n){var i=this,a;if(t instanceof J$&&(a=t),!a){var o=this.dimensions,s=R3(t)||Fa(t)?new jae(t,o.length):t;a=new J$;var l=wf(o,function(u){return{type:i._dimInfos[u].type,property:u}});a.initData(s,l,n)}this._store=a,this._nameList=(r||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,a.count()),this._dimSummary=GPe(this,this._schema),this.userOutput=this._dimSummary.userOutput},e.prototype.appendData=function(t){var r=this._store.appendData(t);this._doInit(r[0],r[1])},e.prototype.appendValues=function(t,r){var n=this._store.appendValues(t,r.length),i=n.start,a=n.end,o=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),r)for(var s=i;s<a;s++){var l=s-i;this._nameList[s]=r[l],o&&pM(this,s)}},e.prototype._updateOrdinalMeta=function(){for(var t=this._store,r=this.dimensions,n=0;n<r.length;n++){var i=this._dimInfos[r[n]];i.ordinalMeta&&t.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},e.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return this._idDimIdx==null&&t.getSource().sourceFormat!==ec&&!t.fillStorage},e.prototype._doInit=function(t,r){if(!(t>=r)){var n=this._store,i=n.getProvider();this._updateOrdinalMeta();var a=this._nameList,o=this._idList,s=i.getSource().sourceFormat,l=s===qo;if(l&&!i.pure)for(var u=[],f=t;f<r;f++){var c=i.getItem(f,u);if(!this.hasItemOption&&WTe(c)&&(this.hasItemOption=!0),c){var h=c.name;a[f]==null&&h!=null&&(a[f]=gl(h,null));var d=c.id;o[f]==null&&d!=null&&(o[f]=gl(d,null))}}if(this._shouldMakeIdFromName())for(var f=t;f<r;f++)pM(this,f);TG(this)}},e.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.setApproximateExtent=function(t,r){r=this.getDimension(r),this._approximateExtent[r]=t.slice()},e.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},e.prototype.setCalculationInfo=function(t,r){A0(t)?et(this._calculationInfo,t):this._calculationInfo[t]=r},e.prototype.getName=function(t){var r=this.getRawIndex(t),n=this._nameList[r];return n==null&&this._nameDimIdx!=null&&(n=P0(this,this._nameDimIdx,r)),n==null&&(n=""),n},e.prototype._getCategory=function(t,r){var n=this._store.get(t,r),i=this._store.getOrdinalMeta(t);return i?i.categories[n]:n},e.prototype.getId=function(t){return bx(this,this.getRawIndex(t))},e.prototype.count=function(){return this._store.count()},e.prototype.get=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.get(i.storeDimIndex,r)},e.prototype.getByRawIndex=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.getByRawIndex(i.storeDimIndex,r)},e.prototype.getIndices=function(){return this._store.getIndices()},e.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},e.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},e.prototype.getValues=function(t,r){var n=this,i=this._store;return mt(t)?i.getValues(wf(t,function(a){return n._getStoreDimIndex(a)}),r):i.getValues(t)},e.prototype.hasValue=function(t){for(var r=this._dimSummary.dataDimIndicesOnCoord,n=0,i=r.length;n<i;n++)if(isNaN(this._store.get(r[n],t)))return!1;return!0},e.prototype.indexOfName=function(t){for(var r=0,n=this._store.count();r<n;r++)if(this.getName(r)===t)return r;return-1},e.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},e.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},e.prototype.rawIndexOf=function(t,r){var n=t&&this._invertedIndicesMap[t],i=n[r];return i==null||isNaN(i)?xG:i},e.prototype.indicesOfNearest=function(t,r,n){return this._store.indicesOfNearest(this._getStoreDimIndex(t),r,n)},e.prototype.each=function(t,r,n){lr(t)&&(n=r,r=t,t=[]);var i=n||this,a=wf(I0(t),this._getStoreDimIndex,this);this._store.each(a,i?un(r,i):r)},e.prototype.filterSelf=function(t,r,n){lr(t)&&(n=r,r=t,t=[]);var i=n||this,a=wf(I0(t),this._getStoreDimIndex,this);return this._store=this._store.filter(a,i?un(r,i):r),this},e.prototype.selectRange=function(t){var r=this,n={},i=yn(t);return ye(i,function(a){var o=r._getStoreDimIndex(a);n[o]=t[a]}),this._store=this._store.selectRange(n),this},e.prototype.mapArray=function(t,r,n){lr(t)&&(n=r,r=t,t=[]),n=n||this;var i=[];return this.each(t,function(){i.push(r&&r.apply(this,arguments))},n),i},e.prototype.map=function(t,r,n,i){var a=n||i||this,o=wf(I0(t),this._getStoreDimIndex,this),s=_x(this);return s._store=this._store.map(o,a?un(r,a):r),s},e.prototype.modify=function(t,r,n,i){var a=n||i||this,o=wf(I0(t),this._getStoreDimIndex,this);this._store.modify(o,a?un(r,a):r)},e.prototype.downSample=function(t,r,n,i){var a=_x(this);return a._store=this._store.downSample(this._getStoreDimIndex(t),r,n,i),a},e.prototype.lttbDownSample=function(t,r){var n=_x(this);return n._store=this._store.lttbDownSample(this._getStoreDimIndex(t),r),n},e.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},e.prototype.getItemModel=function(t){var r=this.hostModel,n=this.getRawDataItem(t);return new Li(n,r,r&&r.ecModel)},e.prototype.diff=function(t){var r=this;return new jPe(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(n){return bx(t,n)},function(n){return bx(r,n)})},e.prototype.getVisual=function(t){var r=this._visual;return r&&r[t]},e.prototype.setVisual=function(t,r){this._visual=this._visual||{},A0(t)?et(this._visual,t):this._visual[t]=r},e.prototype.getItemVisual=function(t,r){var n=this._itemVisuals[t],i=n&&n[r];return i??this.getVisual(r)},e.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},e.prototype.ensureUniqueItemVisual=function(t,r){var n=this._itemVisuals,i=n[t];i||(i=n[t]={});var a=i[r];return a==null&&(a=this.getVisual(r),mt(a)?a=a.slice():A0(a)&&(a=et({},a)),i[r]=a),a},e.prototype.setItemVisual=function(t,r,n){var i=this._itemVisuals[t]||{};this._itemVisuals[t]=i,A0(r)?et(i,r):i[r]=n},e.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},e.prototype.setLayout=function(t,r){A0(t)?et(this._layout,t):this._layout[t]=r},e.prototype.getLayout=function(t){return this._layout[t]},e.prototype.getItemLayout=function(t){return this._itemLayouts[t]},e.prototype.setItemLayout=function(t,r,n){this._itemLayouts[t]=n?et(this._itemLayouts[t]||{},r):r},e.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},e.prototype.setItemGraphicEl=function(t,r){var n=this.hostModel&&this.hostModel.seriesIndex;rEe(n,this.dataType,t,r),this._graphicEls[t]=r},e.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},e.prototype.eachItemGraphicEl=function(t,r){ye(this._graphicEls,function(n,i){n&&t&&t.call(r,n,i)})},e.prototype.cloneShallow=function(t){return t||(t=new e(this._schema?this._schema:wf(this.dimensions,this._getDimInfo,this),this.hostModel)),vM(t,this),t._store=this._store,t},e.prototype.wrapMethod=function(t,r){var n=this[t];lr(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var i=n.apply(this,arguments);return r.apply(this,[i].concat(YB(arguments)))})},e.internalField=function(){TG=function(t){var r=t._invertedIndicesMap;ye(r,function(n,i){var a=t._dimInfos[i],o=a.ordinalMeta,s=t._store;if(o){n=r[i]=new JPe(o.categories.length);for(var l=0;l<n.length;l++)n[l]=xG;for(var l=0;l<s.count();l++)n[s.get(a.storeDimIndex,l)]=l}})},P0=function(t,r,n){return gl(t._getCategory(r,n),null)},bx=function(t,r){var n=t._idList[r];return n==null&&t._idDimIdx!=null&&(n=P0(t,t._idDimIdx,r)),n==null&&(n=QPe+r),n},I0=function(t){return mt(t)||(t=t!=null?[t]:[]),t},_x=function(t){var r=new e(t._schema?t._schema:wf(t.dimensions,t._getDimInfo,t),t.hostModel);return vM(r,t),r},vM=function(t,r){ye(eIe.concat(r.__wrappedMethods||[]),function(n){r.hasOwnProperty(n)&&(t[n]=r[n])}),t.__wrappedMethods=r.__wrappedMethods,ye(tIe,function(n){t[n]=Rr(r[n])}),t._calculationInfo=et({},r._calculationInfo)},pM=function(t,r){var n=t._nameList,i=t._idList,a=t._nameDimIdx,o=t._idDimIdx,s=n[r],l=i[r];if(s==null&&a!=null&&(n[r]=s=P0(t,a,r)),l==null&&o!=null&&(i[r]=l=P0(t,o,r)),l==null&&s!=null){var u=t._nameRepeatCount,f=u[s]=(u[s]||0)+1;l=s,f>1&&(l+="__ec__"+f),i[r]=l}}}(),e}();const Boe=rIe;function Woe(e,t){R3(e)||(e=k3(e)),t=t||{};var r=t.coordDimensions||[],n=t.dimensionsDefine||e.dimensionsDefine||[],i=pr(),a=[],o=iIe(e,r,n,t.dimensionsCount),s=t.canOmitUnusedDimensions&&Hoe(o),l=n===e.dimensionsDefine,u=l?Foe(e):Loe(n),f=t.encodeDefine;!f&&t.encodeDefaulter&&(f=t.encodeDefaulter(e,o));for(var c=pr(f),h=new Xae(o),d=0;d<h.length;d++)h[d]=-1;function v(I){var F=h[I];if(F<0){var H=n[I],W=$t(H)?H:{name:H},z=new oO,te=W.name;te!=null&&u.get(te)!=null&&(z.name=z.displayName=te),W.type!=null&&(z.type=W.type),W.displayName!=null&&(z.displayName=W.displayName);var ie=a.length;return h[I]=ie,z.storeDimIndex=I,a.push(z),z}return a[F]}if(!s)for(var d=0;d<o;d++)v(d);c.each(function(I,F){var H=va(I).slice();if(H.length===1&&!Rt(H[0])&&H[0]<0){c.set(F,!1);return}var W=c.set(F,[]);ye(H,function(z,te){var ie=Rt(z)?u.get(z):z;ie!=null&&ie<o&&(W[te]=ie,y(v(ie),F,te))})});var g=0;ye(r,function(I){var F,H,W,z;if(Rt(I))F=I,z={};else{z=I,F=z.name;var te=z.ordinalMeta;z.ordinalMeta=null,z=et({},z),z.ordinalMeta=te,H=z.dimsDef,W=z.otherDims,z.name=z.coordDim=z.coordDimIndex=z.dimsDef=z.otherDims=null}var ie=c.get(F);if(ie!==!1){if(ie=va(ie),!ie.length)for(var fe=0;fe<(H&&H.length||1);fe++){for(;g<o&&v(g).coordDim!=null;)g++;g<o&&ie.push(g++)}ye(ie,function(Te,M){var S=v(Te);if(l&&z.type!=null&&(S.type=z.type),y(Vr(S,z),F,M),S.name==null&&H){var T=H[M];!$t(T)&&(T={name:T}),S.name=S.displayName=T.name,S.defaultTooltip=T.defaultTooltip}W&&Vr(S.otherDims,W)})}});function y(I,F,H){Iae.get(F)!=null?I.otherDims[F]=H:(I.coordDim=F,I.coordDimIndex=H,i.set(F,!0))}var b=t.generateCoord,w=t.generateCoordCount,_=w!=null;w=b?w||1:0;var x=b||"value";function E(I){I.name==null&&(I.name=I.coordDim)}if(s)ye(a,function(I){E(I)}),a.sort(function(I,F){return I.storeDimIndex-F.storeDimIndex});else for(var R=0;R<o;R++){var A=v(R),N=A.coordDim;N==null&&(A.coordDim=aIe(x,i,_),A.coordDimIndex=0,(!b||w<=0)&&(A.isExtraCoord=!0),w--),E(A),A.type==null&&($ae(e,R)===Si.Must||A.isExtraCoord&&(A.otherDims.itemName!=null||A.otherDims.seriesName!=null))&&(A.type="ordinal")}return nIe(a),new $oe({source:e,dimensions:a,fullDimensionCount:o,dimensionOmitted:s})}function nIe(e){for(var t=pr(),r=0;r<e.length;r++){var n=e[r],i=n.name,a=t.get(i)||0;a>0&&(n.name=i+(a-1)),a++,t.set(i,a)}}function iIe(e,t,r,n){var i=Math.max(e.dimensionsDetectedCount||1,t.length,r.length,n||0);return ye(t,function(a){var o;$t(a)&&(o=a.dimsDef)&&(i=Math.max(i,o.length))}),i}function aIe(e,t,r){if(r||t.hasKey(e)){for(var n=0;t.hasKey(e+n);)n++;e+=n}return t.set(e,!0),e}var oIe=function(){function e(t){this.coordSysDims=[],this.axisMap=pr(),this.categoryAxisMap=pr(),this.coordSysName=t}return e}();function sIe(e){var t=e.get("coordinateSystem"),r=new oIe(t),n=lIe[t];if(n)return n(e,r,r.axisMap,r.categoryAxisMap),r}var lIe={cartesian2d:function(e,t,r,n){var i=e.getReferringComponents("xAxis",Os).models[0],a=e.getReferringComponents("yAxis",Os).models[0];t.coordSysDims=["x","y"],r.set("x",i),r.set("y",a),Uv(i)&&(n.set("x",i),t.firstCategoryDimIndex=0),Uv(a)&&(n.set("y",a),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},singleAxis:function(e,t,r,n){var i=e.getReferringComponents("singleAxis",Os).models[0];t.coordSysDims=["single"],r.set("single",i),Uv(i)&&(n.set("single",i),t.firstCategoryDimIndex=0)},polar:function(e,t,r,n){var i=e.getReferringComponents("polar",Os).models[0],a=i.findAxisModel("radiusAxis"),o=i.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],r.set("radius",a),r.set("angle",o),Uv(a)&&(n.set("radius",a),t.firstCategoryDimIndex=0),Uv(o)&&(n.set("angle",o),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},geo:function(e,t,r,n){t.coordSysDims=["lng","lat"]},parallel:function(e,t,r,n){var i=e.ecModel,a=i.getComponent("parallel",e.get("parallelIndex")),o=t.coordSysDims=a.dimensions.slice();ye(a.parallelAxisIndex,function(s,l){var u=i.getComponent("parallelAxis",s),f=o[l];r.set(f,u),Uv(u)&&(n.set(f,u),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=l))})}};function Uv(e){return e.get("type")==="category"}function uIe(e,t,r){r=r||{};var n=r.byIndex,i=r.stackedCoordDimension,a,o,s;fIe(t)?a=t:(o=t.schema,a=o.dimensions,s=t.store);var l=!!(e&&e.get("stack")),u,f,c,h;if(ye(a,function(w,_){Rt(w)&&(a[_]=w={name:w}),l&&!w.isExtraCoord&&(!n&&!u&&w.ordinalMeta&&(u=w),!f&&w.type!=="ordinal"&&w.type!=="time"&&(!i||i===w.coordDim)&&(f=w))}),f&&!n&&!u&&(n=!0),f){c="__\0ecstackresult_"+e.id,h="__\0ecstackedover_"+e.id,u&&(u.createInvertedIndices=!0);var d=f.coordDim,v=f.type,g=0;ye(a,function(w){w.coordDim===d&&g++});var y={name:c,coordDim:d,coordDimIndex:g,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length},b={name:h,coordDim:h,coordDimIndex:g+1,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length+1};o?(s&&(y.storeDimIndex=s.ensureCalculationDimension(h,v),b.storeDimIndex=s.ensureCalculationDimension(c,v)),o.appendCalculationDimension(y),o.appendCalculationDimension(b)):(a.push(y),a.push(b))}return{stackedDimension:f&&f.name,stackedByDimension:u&&u.name,isStackedByIndex:n,stackedOverDimension:h,stackResultDimension:c}}function fIe(e){return!Noe(e.schema)}function mg(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function cIe(e,t){return mg(e,t)?e.getCalculationInfo("stackResultDimension"):t}function hIe(e,t){var r=e.get("coordinateSystem"),n=E3.get(r),i;return t&&t.coordSysDims&&(i=Lt(t.coordSysDims,function(a){var o={name:a},s=t.axisMap.get(a);if(s){var l=s.get("type");o.type=YPe(l)}return o})),i||(i=n&&(n.getDimensionsInfo?n.getDimensionsInfo():n.dimensions.slice())||["x","y"]),i}function dIe(e,t,r){var n,i;return r&&ye(e,function(a,o){var s=a.coordDim,l=r.categoryAxisMap.get(s);l&&(n==null&&(n=o),a.ordinalMeta=l.getOrdinalMeta(),t&&(a.createInvertedIndices=!0)),a.otherDims.itemName!=null&&(i=!0)}),!i&&n!=null&&(e[n].otherDims.itemName=0),n}function W3(e,t,r){r=r||{};var n=t.getSourceManager(),i,a=!1;e?(a=!0,i=k3(e)):(i=n.getSource(),a=i.sourceFormat===qo);var o=sIe(t),s=hIe(t,o),l=r.useEncodeDefaulter,u=lr(l)?l:l?Un(ZRe,s,t):null,f={coordDimensions:s,generateCoord:r.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!a},c=Woe(i,f),h=dIe(c.dimensions,r.createInvertedIndices,o),d=a?null:n.getSharedDataStore(c),v=uIe(t,{schema:c,store:d}),g=new Boe(c,t);g.setCalculationInfo(v);var y=h!=null&&vIe(i)?function(b,w,_,x){return x===h?_:this.defaultDimValueGetter(b,w,_,x)}:null;return g.hasItemOption=!1,g.initData(a?i:d,null,y),g}function vIe(e){if(e.sourceFormat===qo){var t=pIe(e.data||[]);return!mt(ZS(t))}}function pIe(e){for(var t=0;t<e.length&&e[t]==null;)t++;return e[t]}var Voe=function(){function e(t){this._setting=t||{},this._extent=[1/0,-1/0]}return e.prototype.getSetting=function(t){return this._setting[t]},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1])},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.setExtent=function(t,r){var n=this._extent;isNaN(t)||(n[0]=t),isNaN(r)||(n[1]=r)},e.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},e.prototype.isBlank=function(){return this._isBlank},e.prototype.setBlank=function(t){this._isBlank=t},e}();fk(Voe);const Zu=Voe;var gIe=0,yIe=function(){function e(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++gIe}return e.createByAxisModel=function(t){var r=t.option,n=r.data,i=n&&Lt(n,mIe);return new e({categories:i,needCollect:!i,deduplication:r.dedplication!==!1})},e.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},e.prototype.parseAndCollect=function(t){var r,n=this._needCollect;if(!Rt(t)&&!n)return t;if(n&&!this._deduplication)return r=this.categories.length,this.categories[r]=t,r;var i=this._getOrCreateMap();return r=i.get(t),r==null&&(n?(r=this.categories.length,this.categories[r]=t,i.set(t,r)):r=NaN),r},e.prototype._getOrCreateMap=function(){return this._map||(this._map=pr(this.categories))},e}();function mIe(e){return $t(e)&&e.value!=null?e.value:e+""}const cN=yIe;function hN(e){return e.type==="interval"||e.type==="log"}function bIe(e,t,r,n){var i={},a=e[1]-e[0],o=i.interval=vie(a/t,!0);r!=null&&o<r&&(o=i.interval=r),n!=null&&o>n&&(o=i.interval=n);var s=i.intervalPrecision=Uoe(o),l=i.niceTickExtent=[Qn(Math.ceil(e[0]/o)*o,s),Qn(Math.floor(e[1]/o)*o,s)];return wIe(l,e),i}function gM(e){var t=Math.pow(10,n3(e)),r=e/t;return r?r===2?r=3:r===3?r=5:r*=2:r=1,Qn(r*t)}function Uoe(e){return nu(e)+2}function OG(e,t,r){e[t]=Math.max(Math.min(e[t],r[1]),r[0])}function wIe(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),OG(e,0,t),OG(e,1,t),e[0]>e[1]&&(e[0]=e[1])}function Mk(e,t){return e>=t[0]&&e<=t[1]}function Dk(e,t){return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])}function $k(e,t){return e*(t[1]-t[0])+t[0]}var joe=function(e){ct(t,e);function t(r){var n=e.call(this,r)||this;n.type="ordinal";var i=n.getSetting("ordinalMeta");return i||(i=new cN({})),mt(i)&&(i=new cN({categories:Lt(i,function(a){return $t(a)?a.value:a})})),n._ordinalMeta=i,n._extent=n.getSetting("extent")||[0,i.categories.length-1],n}return t.prototype.parse=function(r){return r==null?NaN:Rt(r)?this._ordinalMeta.getOrdinal(r):Math.round(r)},t.prototype.contain=function(r){return r=this.parse(r),Mk(r,this._extent)&&this._ordinalMeta.categories[r]!=null},t.prototype.normalize=function(r){return r=this._getTickNumber(this.parse(r)),Dk(r,this._extent)},t.prototype.scale=function(r){return r=Math.round($k(r,this._extent)),this.getRawOrdinalNumber(r)},t.prototype.getTicks=function(){for(var r=[],n=this._extent,i=n[0];i<=n[1];)r.push({value:i}),i++;return r},t.prototype.getMinorTicks=function(r){},t.prototype.setSortInfo=function(r){if(r==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var n=r.ordinalNumbers,i=this._ordinalNumbersByTick=[],a=this._ticksByOrdinalNumber=[],o=0,s=this._ordinalMeta.categories.length,l=Math.min(s,n.length);o<l;++o){var u=n[o];i[o]=u,a[u]=o}for(var f=0;o<s;++o){for(;a[f]!=null;)f++;i.push(f),a[f]=o}},t.prototype._getTickNumber=function(r){var n=this._ticksByOrdinalNumber;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getRawOrdinalNumber=function(r){var n=this._ordinalNumbersByTick;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getLabel=function(r){if(!this.isBlank()){var n=this.getRawOrdinalNumber(r.value),i=this._ordinalMeta.categories[n];return i==null?"":i+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.isInExtentRange=function(r){return r=this._getTickNumber(r),this._extent[0]<=r&&this._extent[1]>=r},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(Zu);Zu.registerClass(joe);const zoe=joe;var vh=Qn,Goe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="interval",r._interval=0,r._intervalPrecision=2,r}return t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return Mk(r,this._extent)},t.prototype.normalize=function(r){return Dk(r,this._extent)},t.prototype.scale=function(r){return $k(r,this._extent)},t.prototype.setExtent=function(r,n){var i=this._extent;isNaN(r)||(i[0]=parseFloat(r)),isNaN(n)||(i[1]=parseFloat(n))},t.prototype.unionExtent=function(r){var n=this._extent;r[0]<n[0]&&(n[0]=r[0]),r[1]>n[1]&&(n[1]=r[1]),this.setExtent(n[0],n[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(r){this._interval=r,this._niceExtent=this._extent.slice(),this._intervalPrecision=Uoe(r)},t.prototype.getTicks=function(r){var n=this._interval,i=this._extent,a=this._niceExtent,o=this._intervalPrecision,s=[];if(!n)return s;var l=1e4;i[0]<a[0]&&(r?s.push({value:vh(a[0]-n,o)}):s.push({value:i[0]}));for(var u=a[0];u<=a[1]&&(s.push({value:u}),u=vh(u+n,o),u!==s[s.length-1].value);)if(s.length>l)return[];var f=s.length?s[s.length-1].value:a[1];return i[1]>f&&(r?s.push({value:vh(f+n,o)}):s.push({value:i[1]})),s},t.prototype.getMinorTicks=function(r){for(var n=this.getTicks(!0),i=[],a=this.getExtent(),o=1;o<n.length;o++){for(var s=n[o],l=n[o-1],u=0,f=[],c=s.value-l.value,h=c/r;u<r-1;){var d=vh(l.value+(u+1)*h);d>a[0]&&d<a[1]&&f.push(d),u++}i.push(f)}return i},t.prototype.getLabel=function(r,n){if(r==null)return"";var i=n&&n.precision;i==null?i=nu(r.value)||0:i==="auto"&&(i=this._intervalPrecision);var a=vh(r.value,i,!0);return Rae(a)},t.prototype.calcNiceTicks=function(r,n,i){r=r||5;var a=this._extent,o=a[1]-a[0];if(isFinite(o)){o<0&&(o=-o,a.reverse());var s=bIe(a,r,n,i);this._intervalPrecision=s.intervalPrecision,this._interval=s.interval,this._niceExtent=s.niceTickExtent}},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1])if(n[0]!==0){var i=Math.abs(n[0]);r.fixMax||(n[1]+=i/2),n[0]-=i/2}else n[1]=1;var a=n[1]-n[0];isFinite(a)||(n[0]=0,n[1]=1),this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval);var o=this._interval;r.fixMin||(n[0]=vh(Math.floor(n[0]/o)*o)),r.fixMax||(n[1]=vh(Math.ceil(n[1]/o)*o))},t.prototype.setNiceExtent=function(r,n){this._niceExtent=[r,n]},t.type="interval",t}(Zu);Zu.registerClass(Goe);const r1=Goe;var Yoe=typeof Float32Array<"u",_Ie=Yoe?Float32Array:Array;function iu(e){return mt(e)?Yoe?new Float32Array(e):e:new _Ie(e)}var SIe="__ec_stack_";function V3(e){return e.get("stack")||SIe+e.seriesIndex}function U3(e){return e.dim+e.index}function Koe(e,t){var r=[];return t.eachSeriesByType(e,function(n){qoe(n)&&r.push(n)}),r}function CIe(e){var t={};ye(e,function(l){var u=l.coordinateSystem,f=u.getBaseAxis();if(!(f.type!=="time"&&f.type!=="value"))for(var c=l.getData(),h=f.dim+"_"+f.index,d=c.getDimensionIndex(c.mapDimension(f.dim)),v=c.getStore(),g=0,y=v.count();g<y;++g){var b=v.get(d,g);t[h]?t[h].push(b):t[h]=[b]}});var r={};for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(i){i.sort(function(l,u){return l-u});for(var a=null,o=1;o<i.length;++o){var s=i[o]-i[o-1];s>0&&(a=a===null?s:Math.min(a,s))}r[n]=a}}return r}function Xoe(e){var t=CIe(e),r=[];return ye(e,function(n){var i=n.coordinateSystem,a=i.getBaseAxis(),o=a.getExtent(),s;if(a.type==="category")s=a.getBandWidth();else if(a.type==="value"||a.type==="time"){var l=a.dim+"_"+a.index,u=t[l],f=Math.abs(o[1]-o[0]),c=a.scale.getExtent(),h=Math.abs(c[1]-c[0]);s=u?f/h*u:f}else{var d=n.getData();s=Math.abs(o[1]-o[0])/d.count()}var v=gn(n.get("barWidth"),s),g=gn(n.get("barMaxWidth"),s),y=gn(n.get("barMinWidth")||(Zoe(n)?.5:1),s),b=n.get("barGap"),w=n.get("barCategoryGap");r.push({bandWidth:s,barWidth:v,barMaxWidth:g,barMinWidth:y,barGap:b,barCategoryGap:w,axisKey:U3(a),stackId:V3(n)})}),xIe(r)}function xIe(e){var t={};ye(e,function(n,i){var a=n.axisKey,o=n.bandWidth,s=t[a]||{bandWidth:o,remainedWidth:o,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=s.stacks;t[a]=s;var u=n.stackId;l[u]||s.autoWidthCount++,l[u]=l[u]||{width:0,maxWidth:0};var f=n.barWidth;f&&!l[u].width&&(l[u].width=f,f=Math.min(s.remainedWidth,f),s.remainedWidth-=f);var c=n.barMaxWidth;c&&(l[u].maxWidth=c);var h=n.barMinWidth;h&&(l[u].minWidth=h);var d=n.barGap;d!=null&&(s.gap=d);var v=n.barCategoryGap;v!=null&&(s.categoryGap=v)});var r={};return ye(t,function(n,i){r[i]={};var a=n.stacks,o=n.bandWidth,s=n.categoryGap;if(s==null){var l=yn(a).length;s=Math.max(35-l*4,15)+"%"}var u=gn(s,o),f=gn(n.gap,1),c=n.remainedWidth,h=n.autoWidthCount,d=(c-u)/(h+(h-1)*f);d=Math.max(d,0),ye(a,function(b){var w=b.maxWidth,_=b.minWidth;if(b.width){var x=b.width;w&&(x=Math.min(x,w)),_&&(x=Math.max(x,_)),b.width=x,c-=x+f*x,h--}else{var x=d;w&&w<x&&(x=Math.min(w,c)),_&&_>x&&(x=_),x!==d&&(b.width=x,c-=x+f*x,h--)}}),d=(c-u)/(h+(h-1)*f),d=Math.max(d,0);var v=0,g;ye(a,function(b,w){b.width||(b.width=d),g=b,v+=b.width*(1+f)}),g&&(v-=g.width*f);var y=-v/2;ye(a,function(b,w){r[i][w]=r[i][w]||{bandWidth:o,offset:y,width:b.width},y+=b.width*(1+f)})}),r}function TIe(e,t,r){if(e&&t){var n=e[U3(t)];return n!=null&&r!=null?n[V3(r)]:n}}function OIe(e,t){var r=Koe(e,t),n=Xoe(r);ye(r,function(i){var a=i.getData(),o=i.coordinateSystem,s=o.getBaseAxis(),l=V3(i),u=n[U3(s)][l],f=u.offset,c=u.width;a.setLayout({bandWidth:u.bandWidth,offset:f,size:c})})}function EIe(e){return{seriesType:e,plan:M3(),reset:function(t){if(qoe(t)){var r=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),a=n.getOtherAxis(i),o=r.getDimensionIndex(r.mapDimension(a.dim)),s=r.getDimensionIndex(r.mapDimension(i.dim)),l=t.get("showBackground",!0),u=r.mapDimension(a.dim),f=r.getCalculationInfo("stackResultDimension"),c=mg(r,u)&&!!r.getCalculationInfo("stackedOnSeries"),h=a.isHorizontal(),d=RIe(i,a),v=Zoe(t),g=t.get("barMinHeight")||0,y=f&&r.getDimensionIndex(f),b=r.getLayout("size"),w=r.getLayout("offset");return{progress:function(_,x){for(var E=_.count,R=v&&iu(E*3),A=v&&l&&iu(E*3),N=v&&iu(E),I=n.master.getRect(),F=h?I.width:I.height,H,W=x.getStore(),z=0;(H=_.next())!=null;){var te=W.get(c?y:o,H),ie=W.get(s,H),fe=d,Te=void 0;c&&(Te=+te-W.get(o,H));var M=void 0,S=void 0,T=void 0,k=void 0;if(h){var O=n.dataToPoint([te,ie]);if(c){var D=n.dataToPoint([Te,ie]);fe=D[0]}M=fe,S=O[1]+w,T=O[0]-fe,k=b,Math.abs(T)<g&&(T=(T<0?-1:1)*g)}else{var O=n.dataToPoint([ie,te]);if(c){var D=n.dataToPoint([ie,Te]);fe=D[1]}M=O[0]+w,S=fe,T=b,k=O[1]-fe,Math.abs(k)<g&&(k=(k<=0?-1:1)*g)}v?(R[z]=M,R[z+1]=S,R[z+2]=h?T:k,A&&(A[z]=h?I.x:M,A[z+1]=h?S:I.y,A[z+2]=F),N[H]=H):x.setItemLayout(H,{x:M,y:S,width:T,height:k}),z+=3}v&&x.setLayout({largePoints:R,largeDataIndices:N,largeBackgroundPoints:A,valueAxisHorizontal:h})}}}}}}function qoe(e){return e.coordinateSystem&&e.coordinateSystem.type==="cartesian2d"}function Zoe(e){return e.pipelineContext&&e.pipelineContext.large}function RIe(e,t){return t.toGlobalCoord(t.dataToCoord(t.type==="log"?1:0))}var kIe=function(e,t,r,n){for(;r<n;){var i=r+n>>>1;e[i][1]<t?r=i+1:n=i}return r},Joe=function(e){ct(t,e);function t(r){var n=e.call(this,r)||this;return n.type="time",n}return t.prototype.getLabel=function(r){var n=this.getSetting("useUTC");return _k(r.value,yz[WRe(Gp(this._minLevelUnit))]||yz.second,n,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(r,n,i){var a=this.getSetting("useUTC"),o=this.getSetting("locale");return VRe(r,n,i,o,a)},t.prototype.getTicks=function(){var r=this._interval,n=this._extent,i=[];if(!r)return i;i.push({value:n[0],level:0});var a=this.getSetting("useUTC"),o=NIe(this._minLevelUnit,this._approxInterval,a,n);return i=i.concat(o),i.push({value:n[1],level:0}),i},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1]&&(n[0]-=Vo,n[1]+=Vo),n[1]===-1/0&&n[0]===1/0){var i=new Date;n[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),n[0]=n[1]-Vo}this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval)},t.prototype.calcNiceTicks=function(r,n,i){r=r||10;var a=this._extent,o=a[1]-a[0];this._approxInterval=o/r,n!=null&&this._approxInterval<n&&(this._approxInterval=n),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var s=Sx.length,l=Math.min(kIe(Sx,this._approxInterval,0,s),s-1);this._interval=Sx[l][1],this._minLevelUnit=Sx[Math.max(l-1,0)][0]},t.prototype.parse=function(r){return en(r)?r:+Wu(r)},t.prototype.contain=function(r){return Mk(this.parse(r),this._extent)},t.prototype.normalize=function(r){return Dk(this.parse(r),this._extent)},t.prototype.scale=function(r){return $k(r,this._extent)},t.type="time",t}(r1),Sx=[["second",_3],["minute",S3],["hour",Wb],["quarter-day",Wb*6],["half-day",Wb*12],["day",Vo*1.2],["half-week",Vo*3.5],["week",Vo*7],["month",Vo*31],["quarter",Vo*95],["half-year",gz/2],["year",gz]];function AIe(e,t,r,n){var i=Wu(t),a=Wu(r),o=function(v){return mz(i,v,n)===mz(a,v,n)},s=function(){return o("year")},l=function(){return s()&&o("month")},u=function(){return l()&&o("day")},f=function(){return u()&&o("hour")},c=function(){return f()&&o("minute")},h=function(){return c()&&o("second")},d=function(){return h()&&o("millisecond")};switch(e){case"year":return s();case"month":return l();case"day":return u();case"hour":return f();case"minute":return c();case"second":return h();case"millisecond":return d()}}function PIe(e,t){return e/=Vo,e>16?16:e>7.5?7:e>3.5?4:e>1.5?2:1}function IIe(e){var t=30*Vo;return e/=t,e>6?6:e>3?3:e>2?2:1}function MIe(e){return e/=Wb,e>12?12:e>6?6:e>3.5?4:e>2?2:1}function EG(e,t){return e/=t?S3:_3,e>30?30:e>20?20:e>15?15:e>10?10:e>5?5:e>2?2:1}function DIe(e){return vie(e,!0)}function $Ie(e,t,r){var n=new Date(e);switch(Gp(t)){case"year":case"month":n[Sae(r)](0);case"day":n[Cae(r)](1);case"hour":n[xae(r)](0);case"minute":n[Tae(r)](0);case"second":n[Oae(r)](0),n[Eae(r)](0)}return n.getTime()}function NIe(e,t,r,n){var i=1e4,a=wae,o=0;function s(F,H,W,z,te,ie,fe){for(var Te=new Date(H),M=H,S=Te[z]();M<W&&M<=n[1];)fe.push({value:M}),S+=F,Te[te](S),M=Te.getTime();fe.push({value:M,notAdd:!0})}function l(F,H,W){var z=[],te=!H.length;if(!AIe(Gp(F),n[0],n[1],r)){te&&(H=[{value:$Ie(new Date(n[0]),F,r)},{value:n[1]}]);for(var ie=0;ie<H.length-1;ie++){var fe=H[ie].value,Te=H[ie+1].value;if(fe!==Te){var M=void 0,S=void 0,T=void 0,k=!1;switch(F){case"year":M=Math.max(1,Math.round(t/Vo/365)),S=C3(r),T=URe(r);break;case"half-year":case"quarter":case"month":M=IIe(t),S=Yp(r),T=Sae(r);break;case"week":case"half-week":case"day":M=PIe(t),S=Sk(r),T=Cae(r),k=!0;break;case"half-day":case"quarter-day":case"hour":M=MIe(t),S=Ew(r),T=xae(r);break;case"minute":M=EG(t,!0),S=Ck(r),T=Tae(r);break;case"second":M=EG(t,!1),S=xk(r),T=Oae(r);break;case"millisecond":M=DIe(t),S=Tk(r),T=Eae(r);break}s(M,fe,Te,S,T,k,z),F==="year"&&W.length>1&&ie===0&&W.unshift({value:W[0].value-M})}}for(var ie=0;ie<z.length;ie++)W.push(z[ie]);return z}}for(var u=[],f=[],c=0,h=0,d=0;d<a.length&&o++<i;++d){var v=Gp(a[d]);if(BRe(a[d])){l(a[d],u[u.length-1]||[],f);var g=a[d+1]?Gp(a[d+1]):null;if(v!==g){if(f.length){h=c,f.sort(function(F,H){return F.value-H.value});for(var y=[],b=0;b<f.length;++b){var w=f[b].value;(b===0||f[b-1].value!==w)&&(y.push(f[b]),w>=n[0]&&w<=n[1]&&c++)}var _=(n[1]-n[0])/t;if(c>_*1.5&&h>_/1.5||(u.push(y),c>_||e===a[d]))break}f=[]}}}for(var x=ua(Lt(u,function(F){return ua(F,function(H){return H.value>=n[0]&&H.value<=n[1]&&!H.notAdd})}),function(F){return F.length>0}),E=[],R=x.length-1,d=0;d<x.length;++d)for(var A=x[d],N=0;N<A.length;++N)E.push({value:A[N].value,level:R-d});E.sort(function(F,H){return F.value-H.value});for(var I=[],d=0;d<E.length;++d)(d===0||E[d].value!==E[d-1].value)&&I.push(E[d]);return I}Zu.registerClass(Joe);const LIe=Joe;var RG=Zu.prototype,Gb=r1.prototype,FIe=Qn,HIe=Math.floor,BIe=Math.ceil,Cx=Math.pow,us=Math.log,j3=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="log",r.base=10,r._originalScale=new r1,r._interval=0,r}return t.prototype.getTicks=function(r){var n=this._originalScale,i=this._extent,a=n.getExtent(),o=Gb.getTicks.call(this,r);return Lt(o,function(s){var l=s.value,u=Qn(Cx(this.base,l));return u=l===i[0]&&this._fixMin?xx(u,a[0]):u,u=l===i[1]&&this._fixMax?xx(u,a[1]):u,{value:u}},this)},t.prototype.setExtent=function(r,n){var i=us(this.base);r=us(Math.max(0,r))/i,n=us(Math.max(0,n))/i,Gb.setExtent.call(this,r,n)},t.prototype.getExtent=function(){var r=this.base,n=RG.getExtent.call(this);n[0]=Cx(r,n[0]),n[1]=Cx(r,n[1]);var i=this._originalScale,a=i.getExtent();return this._fixMin&&(n[0]=xx(n[0],a[0])),this._fixMax&&(n[1]=xx(n[1],a[1])),n},t.prototype.unionExtent=function(r){this._originalScale.unionExtent(r);var n=this.base;r[0]=us(r[0])/us(n),r[1]=us(r[1])/us(n),RG.unionExtent.call(this,r)},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.calcNiceTicks=function(r){r=r||10;var n=this._extent,i=n[1]-n[0];if(!(i===1/0||i<=0)){var a=FTe(i),o=r/i*a;for(o<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var s=[Qn(BIe(n[0]/a)*a),Qn(HIe(n[1]/a)*a)];this._interval=a,this._niceExtent=s}},t.prototype.calcNiceExtent=function(r){Gb.calcNiceExtent.call(this,r),this._fixMin=r.fixMin,this._fixMax=r.fixMax},t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return r=us(r)/us(this.base),Mk(r,this._extent)},t.prototype.normalize=function(r){return r=us(r)/us(this.base),Dk(r,this._extent)},t.prototype.scale=function(r){return r=$k(r,this._extent),Cx(this.base,r)},t.type="log",t}(Zu),Qoe=j3.prototype;Qoe.getMinorTicks=Gb.getMinorTicks;Qoe.getLabel=Gb.getLabel;function xx(e,t){return FIe(e,nu(t))}Zu.registerClass(j3);const WIe=j3;var VIe=function(){function e(t,r,n){this._prepareParams(t,r,n)}return e.prototype._prepareParams=function(t,r,n){n[1]<n[0]&&(n=[NaN,NaN]),this._dataMin=n[0],this._dataMax=n[1];var i=this._isOrdinal=t.type==="ordinal";this._needCrossZero=t.type==="interval"&&r.getNeedCrossZero&&r.getNeedCrossZero();var a=this._modelMinRaw=r.get("min",!0);lr(a)?this._modelMinNum=Tx(t,a({min:n[0],max:n[1]})):a!=="dataMin"&&(this._modelMinNum=Tx(t,a));var o=this._modelMaxRaw=r.get("max",!0);if(lr(o)?this._modelMaxNum=Tx(t,o({min:n[0],max:n[1]})):o!=="dataMax"&&(this._modelMaxNum=Tx(t,o)),i)this._axisDataLen=r.getCategories().length;else{var s=r.get("boundaryGap"),l=mt(s)?s:[s||0,s||0];typeof l[0]=="boolean"||typeof l[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[wc(l[0],1),wc(l[1],1)]}},e.prototype.calculate=function(){var t=this._isOrdinal,r=this._dataMin,n=this._dataMax,i=this._axisDataLen,a=this._boundaryGapInner,o=t?null:n-r||Math.abs(r),s=this._modelMinRaw==="dataMin"?r:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?n:this._modelMaxNum,u=s!=null,f=l!=null;s==null&&(s=t?i?0:NaN:r-a[0]*o),l==null&&(l=t?i?i-1:NaN:n+a[1]*o),(s==null||!isFinite(s))&&(s=NaN),(l==null||!isFinite(l))&&(l=NaN);var c=nE(s)||nE(l)||t&&!i;this._needCrossZero&&(s>0&&l>0&&!u&&(s=0),s<0&&l<0&&!f&&(l=0));var h=this._determinedMin,d=this._determinedMax;return h!=null&&(s=h,u=!0),d!=null&&(l=d,f=!0),{min:s,max:l,minFixed:u,maxFixed:f,isBlank:c}},e.prototype.modifyDataMinMax=function(t,r){this[jIe[t]]=r},e.prototype.setDeterminedMinMax=function(t,r){var n=UIe[t];this[n]=r},e.prototype.freeze=function(){this.frozen=!0},e}(),UIe={min:"_determinedMin",max:"_determinedMax"},jIe={min:"_dataMin",max:"_dataMax"};function zIe(e,t,r){var n=e.rawExtentInfo;return n||(n=new VIe(e,t,r),e.rawExtentInfo=n,n)}function Tx(e,t){return t==null?null:nE(t)?NaN:e.parse(t)}function ese(e,t){var r=e.type,n=zIe(e,t,e.getExtent()).calculate();e.setBlank(n.isBlank);var i=n.min,a=n.max,o=t.ecModel;if(o&&r==="time"){var s=Koe("bar",o),l=!1;if(ye(s,function(c){l=l||c.getBaseAxis()===t.axis}),l){var u=Xoe(s),f=GIe(i,a,t,u);i=f.min,a=f.max}}return{extent:[i,a],fixMin:n.minFixed,fixMax:n.maxFixed}}function GIe(e,t,r,n){var i=r.axis.getExtent(),a=i[1]-i[0],o=TIe(n,r.axis);if(o===void 0)return{min:e,max:t};var s=1/0;ye(o,function(d){s=Math.min(d.offset,s)});var l=-1/0;ye(o,function(d){l=Math.max(d.offset+d.width,l)}),s=Math.abs(s),l=Math.abs(l);var u=s+l,f=t-e,c=1-(s+l)/a,h=f/c-f;return t+=h*(l/u),e-=h*(s/u),{min:e,max:t}}function kG(e,t){var r=t,n=ese(e,r),i=n.extent,a=r.get("splitNumber");e instanceof WIe&&(e.base=r.get("logBase"));var o=e.type,s=r.get("interval"),l=o==="interval"||o==="time";e.setExtent(i[0],i[1]),e.calcNiceExtent({splitNumber:a,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:l?r.get("minInterval"):null,maxInterval:l?r.get("maxInterval"):null}),s!=null&&e.setInterval&&e.setInterval(s)}function YIe(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new zoe({ordinalMeta:e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),extent:[1/0,-1/0]});case"time":return new LIe({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new(Zu.getClass(t)||r1)}}function KIe(e){var t=e.scale.getExtent(),r=t[0],n=t[1];return!(r>0&&n>0||r<0&&n<0)}function n1(e){var t=e.getLabelModel().get("formatter"),r=e.type==="category"?e.scale.getExtent()[0]:null;return e.scale.type==="time"?function(n){return function(i,a){return e.scale.getFormattedLabel(i,a,n)}}(t):Rt(t)?function(n){return function(i){var a=e.scale.getLabel(i),o=n.replace("{value}",a??"");return o}}(t):lr(t)?function(n){return function(i,a){return r!=null&&(a=i.value-r),n(z3(e,i),a,i.level!=null?{level:i.level}:null)}}(t):function(n){return e.scale.getLabel(n)}}function z3(e,t){return e.type==="category"?e.scale.getLabel(t):t.value}function XIe(e){var t=e.model,r=e.scale;if(!(!t.get(["axisLabel","show"])||r.isBlank())){var n,i,a=r.getExtent();r instanceof zoe?i=r.count():(n=r.getTicks(),i=n.length);var o=e.getLabelModel(),s=n1(e),l,u=1;i>40&&(u=Math.ceil(i/40));for(var f=0;f<i;f+=u){var c=n?n[f]:{value:a[0]+f},h=s(c,f),d=o.getTextRect(h),v=qIe(d,o.get("rotate")||0);l?l.union(v):l=v}return l}}function qIe(e,t){var r=t*Math.PI/180,n=e.width,i=e.height,a=n*Math.abs(Math.cos(r))+Math.abs(i*Math.sin(r)),o=n*Math.abs(Math.sin(r))+Math.abs(i*Math.cos(r)),s=new Br(e.x,e.y,a,o);return s}function G3(e){var t=e.get("interval");return t??"auto"}function tse(e){return e.type==="category"&&G3(e.getLabelModel())===0}function ZIe(e,t){var r={};return ye(e.mapDimensionsAll(t),function(n){r[cIe(e,n)]=!0}),yn(r)}var JIe=function(){function e(){}return e.prototype.getNeedCrossZero=function(){var t=this.option;return!t.scale},e.prototype.getCoordSysModel=function(){},e}(),AG=[],QIe={registerPreprocessor:Ioe,registerProcessor:Moe,registerPostInit:LPe,registerPostUpdate:FPe,registerUpdateLifecycle:H3,registerAction:Dm,registerCoordinateSystem:HPe,registerLayout:BPe,registerVisual:Zd,registerTransform:VPe,registerLoading:Doe,registerMap:WPe,registerImpl:yPe,PRIORITY:APe,ComponentModel:vn,ComponentView:Vu,SeriesModel:Cc,ChartView:yl,registerComponentModel:function(e){vn.registerClass(e)},registerComponentView:function(e){Vu.registerClass(e)},registerSeriesModel:function(e){Cc.registerClass(e)},registerChartView:function(e){yl.registerClass(e)},registerSubTypeDefaulter:function(e,t){vn.registerSubTypeDefaulter(e,t)},registerPainter:function(e,t){PTe(e,t)}};function xc(e){if(mt(e)){ye(e,function(t){xc(t)});return}Xr(AG,e)>=0||(AG.push(e),lr(e)&&(e={install:e}),e.install(QIe))}var Mw=ti();function eMe(e){return e.type==="category"?rMe(e):iMe(e)}function tMe(e,t){return e.type==="category"?nMe(e,t):{ticks:Lt(e.scale.getTicks(),function(r){return r.value})}}function rMe(e){var t=e.getLabelModel(),r=rse(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r}function rse(e,t){var r=nse(e,"labels"),n=G3(t),i=ise(r,n);if(i)return i;var a,o;return lr(n)?a=sse(e,n):(o=n==="auto"?aMe(e):n,a=ose(e,o)),ase(r,n,{labels:a,labelCategoryInterval:o})}function nMe(e,t){var r=nse(e,"ticks"),n=G3(t),i=ise(r,n);if(i)return i;var a,o;if((!t.get("show")||e.scale.isBlank())&&(a=[]),lr(n))a=sse(e,n,!0);else if(n==="auto"){var s=rse(e,e.getLabelModel());o=s.labelCategoryInterval,a=Lt(s.labels,function(l){return l.tickValue})}else o=n,a=ose(e,o,!0);return ase(r,n,{ticks:a,tickCategoryInterval:o})}function iMe(e){var t=e.scale.getTicks(),r=n1(e);return{labels:Lt(t,function(n,i){return{level:n.level,formattedLabel:r(n,i),rawLabel:e.scale.getLabel(n),tickValue:n.value}})}}function nse(e,t){return Mw(e)[t]||(Mw(e)[t]=[])}function ise(e,t){for(var r=0;r<e.length;r++)if(e[r].key===t)return e[r].value}function ase(e,t,r){return e.push({key:t,value:r}),r}function aMe(e){var t=Mw(e).autoInterval;return t??(Mw(e).autoInterval=e.calculateCategoryInterval())}function oMe(e){var t=sMe(e),r=n1(e),n=(t.axisRotate-t.labelRotate)/180*Math.PI,i=e.scale,a=i.getExtent(),o=i.count();if(a[1]-a[0]<1)return 0;var s=1;o>40&&(s=Math.max(1,Math.floor(o/40)));for(var l=a[0],u=e.dataToCoord(l+1)-e.dataToCoord(l),f=Math.abs(u*Math.cos(n)),c=Math.abs(u*Math.sin(n)),h=0,d=0;l<=a[1];l+=s){var v=0,g=0,y=e3(r({value:l}),t.font,"center","top");v=y.width*1.3,g=y.height*1.3,h=Math.max(h,v,7),d=Math.max(d,g,7)}var b=h/f,w=d/c;isNaN(b)&&(b=1/0),isNaN(w)&&(w=1/0);var _=Math.max(0,Math.floor(Math.min(b,w))),x=Mw(e.model),E=e.getExtent(),R=x.lastAutoInterval,A=x.lastTickCount;return R!=null&&A!=null&&Math.abs(R-_)<=1&&Math.abs(A-o)<=1&&R>_&&x.axisExtent0===E[0]&&x.axisExtent1===E[1]?_=R:(x.lastTickCount=o,x.lastAutoInterval=_,x.axisExtent0=E[0],x.axisExtent1=E[1]),_}function sMe(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function ose(e,t,r){var n=n1(e),i=e.scale,a=i.getExtent(),o=e.getLabelModel(),s=[],l=Math.max((t||0)+1,1),u=a[0],f=i.count();u!==0&&l>1&&f/l>2&&(u=Math.round(Math.ceil(u/l)*l));var c=tse(e),h=o.get("showMinLabel")||c,d=o.get("showMaxLabel")||c;h&&u!==a[0]&&g(a[0]);for(var v=u;v<=a[1];v+=l)g(v);d&&v-l!==a[1]&&g(a[1]);function g(y){var b={value:y};s.push(r?y:{formattedLabel:n(b),rawLabel:i.getLabel(b),tickValue:y})}return s}function sse(e,t,r){var n=e.scale,i=n1(e),a=[];return ye(n.getTicks(),function(o){var s=n.getLabel(o),l=o.value;t(o.value,s)&&a.push(r?l:{formattedLabel:i(o),rawLabel:s,tickValue:l})}),a}var PG=[0,1],lMe=function(){function e(t,r,n){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=r,this._extent=n||[0,0]}return e.prototype.contain=function(t){var r=this._extent,n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return t>=n&&t<=i},e.prototype.containData=function(t){return this.scale.contain(t)},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.getPixelPrecision=function(t){return DTe(t||this.scale.getExtent(),this._extent)},e.prototype.setExtent=function(t,r){var n=this._extent;n[0]=t,n[1]=r},e.prototype.dataToCoord=function(t,r){var n=this._extent,i=this.scale;return t=i.normalize(t),this.onBand&&i.type==="ordinal"&&(n=n.slice(),IG(n,i.count())),L$(t,PG,n,r)},e.prototype.coordToData=function(t,r){var n=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(n=n.slice(),IG(n,i.count()));var a=L$(t,n,PG,r);return this.scale.scale(a)},e.prototype.pointToData=function(t,r){},e.prototype.getTicksCoords=function(t){t=t||{};var r=t.tickModel||this.getTickModel(),n=tMe(this,r),i=n.ticks,a=Lt(i,function(s){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(s):s),tickValue:s}},this),o=r.get("alignWithLabel");return uMe(this,a,o,t.clamp),a},e.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var t=this.model.getModel("minorTick"),r=t.get("splitNumber");r>0&&r<100||(r=5);var n=this.scale.getMinorTicks(r),i=Lt(n,function(a){return Lt(a,function(o){return{coord:this.dataToCoord(o),tickValue:o}},this)},this);return i},e.prototype.getViewLabels=function(){return eMe(this).labels},e.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},e.prototype.getTickModel=function(){return this.model.getModel("axisTick")},e.prototype.getBandWidth=function(){var t=this._extent,r=this.scale.getExtent(),n=r[1]-r[0]+(this.onBand?1:0);n===0&&(n=1);var i=Math.abs(t[1]-t[0]);return Math.abs(i)/n},e.prototype.calculateCategoryInterval=function(){return oMe(this)},e}();function IG(e,t){var r=e[1]-e[0],n=t,i=r/n/2;e[0]+=i,e[1]-=i}function uMe(e,t,r,n){var i=t.length;if(!e.onBand||r||!i)return;var a=e.getExtent(),o,s;if(i===1)t[0].coord=a[0],o=t[1]={coord:a[0]};else{var l=t[i-1].tickValue-t[0].tickValue,u=(t[i-1].coord-t[0].coord)/l;ye(t,function(d){d.coord-=u/2});var f=e.scale.getExtent();s=1+f[1]-t[i-1].tickValue,o={coord:t[i-1].coord+u*s},t.push(o)}var c=a[0]>a[1];h(t[0].coord,a[0])&&(n?t[0].coord=a[0]:t.shift()),n&&h(a[0],t[0].coord)&&t.unshift({coord:a[0]}),h(a[1],o.coord)&&(n?o.coord=a[1]:t.pop()),n&&h(o.coord,a[1])&&t.push({coord:a[1]});function h(d,v){return d=Qn(d),v=Qn(v),c?d>v:d<v}}const fMe=lMe;_c.CMD;function lse(e,t,r,n,i,a,o,s){var l=i-e,u=a-t,f=r-e,c=n-t,h=Math.sqrt(f*f+c*c);f/=h,c/=h;var d=l*f+u*c,v=d/h;s&&(v=Math.min(Math.max(v,0),1)),v*=h;var g=o[0]=e+v*f,y=o[1]=t+v*c;return Math.sqrt((g-i)*(g-i)+(y-a)*(y-a))}var jf=new Yt,In=new Yt,Ci=new Yt,zf=new Yt,fl=new Yt,kE=[],oa=new Yt;function cMe(e,t){if(t<=180&&t>0){t=t/180*Math.PI,jf.fromArray(e[0]),In.fromArray(e[1]),Ci.fromArray(e[2]),Yt.sub(zf,jf,In),Yt.sub(fl,Ci,In);var r=zf.len(),n=fl.len();if(!(r<.001||n<.001)){zf.scale(1/r),fl.scale(1/n);var i=zf.dot(fl),a=Math.cos(t);if(a<i){var o=lse(In.x,In.y,Ci.x,Ci.y,jf.x,jf.y,kE,!1);oa.fromArray(kE),oa.scaleAndAdd(fl,o/Math.tan(Math.PI-t));var s=Ci.x!==In.x?(oa.x-In.x)/(Ci.x-In.x):(oa.y-In.y)/(Ci.y-In.y);if(isNaN(s))return;s<0?Yt.copy(oa,In):s>1&&Yt.copy(oa,Ci),oa.toArray(e[1])}}}}function hMe(e,t,r){if(r<=180&&r>0){r=r/180*Math.PI,jf.fromArray(e[0]),In.fromArray(e[1]),Ci.fromArray(e[2]),Yt.sub(zf,In,jf),Yt.sub(fl,Ci,In);var n=zf.len(),i=fl.len();if(!(n<.001||i<.001)){zf.scale(1/n),fl.scale(1/i);var a=zf.dot(t),o=Math.cos(r);if(a<o){var s=lse(In.x,In.y,Ci.x,Ci.y,jf.x,jf.y,kE,!1);oa.fromArray(kE);var l=Math.PI/2,u=Math.acos(fl.dot(t)),f=l+u-r;if(f>=l)Yt.copy(oa,Ci);else{oa.scaleAndAdd(fl,s/Math.tan(Math.PI/2-f));var c=Ci.x!==In.x?(oa.x-In.x)/(Ci.x-In.x):(oa.y-In.y)/(Ci.y-In.y);if(isNaN(c))return;c<0?Yt.copy(oa,In):c>1&&Yt.copy(oa,Ci)}oa.toArray(e[1])}}}}function MG(e,t,r,n){var i=r==="normal",a=i?e:e.ensureState(r);a.ignore=t;var o=n.get("smooth");o&&o===!0&&(o=.3),a.shape=a.shape||{},o>0&&(a.shape.smooth=o);var s=n.getModel("lineStyle").getLineStyle();i?e.useStyle(s):a.style=s}function dMe(e,t){var r=t.smooth,n=t.points;if(n)if(e.moveTo(n[0][0],n[0][1]),r>0&&n.length>=3){var i=_$(n[0],n[1]),a=_$(n[1],n[2]);if(!i||!a){e.lineTo(n[1][0],n[1][1]),e.lineTo(n[2][0],n[2][1]);return}var o=Math.min(i,a)*r,s=cI([],n[1],n[0],o/i),l=cI([],n[1],n[2],o/a),u=cI([],s,l,.5);e.bezierCurveTo(s[0],s[1],s[0],s[1],u[0],u[1]),e.bezierCurveTo(l[0],l[1],l[0],l[1],n[2][0],n[2][1])}else for(var f=1;f<n.length;f++)e.lineTo(n[f][0],n[f][1])}function vMe(e,t,r){var n=e.getTextGuideLine(),i=e.getTextContent();if(!i){n&&e.removeTextGuideLine();return}for(var a=t.normal,o=a.get("show"),s=i.ignore,l=0;l<dE.length;l++){var u=dE[l],f=t[u],c=u==="normal";if(f){var h=f.get("show"),d=c?s:Tr(i.states[u]&&i.states[u].ignore,s);if(d||!Tr(h,o)){var v=c?n:n&&n.states[u];v&&(v.ignore=!0);continue}n||(n=new gk,e.setTextGuideLine(n),!c&&(s||!o)&&MG(n,!0,"normal",t.normal),e.stateProxy&&(n.stateProxy=e.stateProxy)),MG(n,!1,u,f)}}if(n){Vr(n.style,r),n.style.fill=null;var g=a.get("showAbove"),y=e.textGuideLineConfig=e.textGuideLineConfig||{};y.showAbove=g||!1,n.buildPath=dMe}}function pMe(e,t){t=t||"labelLine";for(var r={normal:e.getModel(t)},n=0;n<Go.length;n++){var i=Go[n];r[i]=e.getModel([i,t])}return r}function gMe(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(!n.defaultAttr.ignore){var i=n.label,a=i.getComputedTransform(),o=i.getBoundingRect(),s=!a||a[1]<1e-5&&a[2]<1e-5,l=i.style.margin||0,u=o.clone();u.applyTransform(a),u.x-=l/2,u.y-=l/2,u.width+=l,u.height+=l;var f=s?new yE(o,a):null;t.push({label:i,labelLine:n.labelLine,rect:u,localRect:o,obb:f,priority:n.priority,defaultAttr:n.defaultAttr,layoutOption:n.computedLayoutOption,axisAligned:s,transform:a})}}return t}function yMe(e,t,r,n,i,a){var o=e.length;if(o<2)return;e.sort(function(N,I){return N.rect[t]-I.rect[t]});for(var s=0,l,u=!1,f=0,c=0;c<o;c++){var h=e[c],d=h.rect;l=d[t]-s,l<0&&(d[t]-=l,h.label[t]-=l,u=!0);var v=Math.max(-l,0);f+=v,s=d[t]+d[r]}f>0&&a&&E(-f/o,0,o);var g=e[0],y=e[o-1],b,w;_(),b<0&&R(-b,.8),w<0&&R(w,.8),_(),x(b,w,1),x(w,b,-1),_(),b<0&&A(-b),w<0&&A(w);function _(){b=g.rect[t]-n,w=i-y.rect[t]-y.rect[r]}function x(N,I,F){if(N<0){var H=Math.min(I,-N);if(H>0){E(H*F,0,o);var W=H+N;W<0&&R(-W*F,1)}else R(-N*F,1)}}function E(N,I,F){N!==0&&(u=!0);for(var H=I;H<F;H++){var W=e[H],z=W.rect;z[t]+=N,W.label[t]+=N}}function R(N,I){for(var F=[],H=0,W=1;W<o;W++){var z=e[W-1].rect,te=Math.max(e[W].rect[t]-z[t]-z[r],0);F.push(te),H+=te}if(H){var ie=Math.min(Math.abs(N)/H,I);if(N>0)for(var W=0;W<o-1;W++){var fe=F[W]*ie;E(fe,0,W+1)}else for(var W=o-1;W>0;W--){var fe=F[W-1]*ie;E(-fe,W,o)}}}function A(N){var I=N<0?-1:1;N=Math.abs(N);for(var F=Math.ceil(N/(o-1)),H=0;H<o-1;H++)if(I>0?E(F,0,H+1):E(-F,o-H-1,o),N-=F,N<=0)return}return u}function mMe(e,t,r,n){return yMe(e,"y","height",t,r,n)}function bMe(e){var t=[];e.sort(function(g,y){return y.priority-g.priority});var r=new Br(0,0,0,0);function n(g){if(!g.ignore){var y=g.ensureState("emphasis");y.ignore==null&&(y.ignore=!1)}g.ignore=!0}for(var i=0;i<e.length;i++){var a=e[i],o=a.axisAligned,s=a.localRect,l=a.transform,u=a.label,f=a.labelLine;r.copy(a.rect),r.width-=.1,r.height-=.1,r.x+=.05,r.y+=.05;for(var c=a.obb,h=!1,d=0;d<t.length;d++){var v=t[d];if(r.intersect(v.rect)){if(o&&v.axisAligned){h=!0;break}if(v.obb||(v.obb=new yE(v.localRect,v.transform)),c||(c=new yE(s,l)),c.intersect(v.obb)){h=!0;break}}}h?(n(u),f&&n(f)):(u.attr("ignore",a.defaultAttr.ignore),f&&f.attr("ignore",a.defaultAttr.labelGuideIgnore),t.push(a))}}function DG(e,t,r){var n=Am.createCanvas(),i=t.getWidth(),a=t.getHeight(),o=n.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=i+"px",o.height=a+"px",n.setAttribute("data-zr-dom-id",e)),n.width=i*r,n.height=a*r,n}var wMe=function(e){ct(t,e);function t(r,n,i){var a=e.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var o;i=i||uE,typeof r=="string"?o=DG(r,n,i):$t(r)&&(o=r,r=o.id),a.id=r,a.dom=o;var s=o.style;return s&&(Une(o),o.onselectstart=function(){return!1},s.padding="0",s.margin="0",s.borderWidth="0"),a.painter=n,a.dpr=i,a}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var r=this.dpr;this.domBack=DG("back-"+this.id,this.painter,r),this.ctxBack=this.domBack.getContext("2d"),r!==1&&this.ctxBack.scale(r,r)},t.prototype.createRepaintRects=function(r,n,i,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var o=[],s=this.maxRepaintRectCount,l=!1,u=new Br(0,0,0,0);function f(w){if(!(!w.isFinite()||w.isZero()))if(o.length===0){var _=new Br(0,0,0,0);_.copy(w),o.push(_)}else{for(var x=!1,E=1/0,R=0,A=0;A<o.length;++A){var N=o[A];if(N.intersect(w)){var I=new Br(0,0,0,0);I.copy(N),I.union(w),o[A]=I,x=!0;break}else if(l){u.copy(w),u.union(N);var F=w.width*w.height,H=N.width*N.height,W=u.width*u.height,z=W-F-H;z<E&&(E=z,R=A)}}if(l&&(o[R].union(w),x=!0),!x){var _=new Br(0,0,0,0);_.copy(w),o.push(_)}l||(l=o.length>=s)}}for(var c=this.__startIndex;c<this.__endIndex;++c){var h=r[c];if(h){var d=h.shouldBePainted(i,a,!0,!0),v=h.__isRendered&&(h.__dirty&ro||!d)?h.getPrevPaintRect():null;v&&f(v);var g=d&&(h.__dirty&ro||!h.__isRendered)?h.getPaintRect():null;g&&f(g)}}for(var c=this.__prevStartIndex;c<this.__prevEndIndex;++c){var h=n[c],d=h.shouldBePainted(i,a,!0,!0);if(h&&(!d||!h.__zr)&&h.__isRendered){var v=h.getPrevPaintRect();v&&f(v)}}var y;do{y=!1;for(var c=0;c<o.length;){if(o[c].isZero()){o.splice(c,1);continue}for(var b=c+1;b<o.length;)o[c].intersect(o[b])?(y=!0,o[c].union(o[b]),o.splice(b,1)):b++;c++}}while(y);return this._paintRects=o,o},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(r,n){var i=this.dpr,a=this.dom,o=a.style,s=this.domBack;o&&(o.width=r+"px",o.height=n+"px"),a.width=r*i,a.height=n*i,s&&(s.width=r*i,s.height=n*i,i!==1&&this.ctxBack.scale(i,i))},t.prototype.clear=function(r,n,i){var a=this.dom,o=this.ctx,s=a.width,l=a.height;n=n||this.clearColor;var u=this.motionBlur&&!r,f=this.lastFrameAlpha,c=this.dpr,h=this;u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,s/c,l/c));var d=this.domBack;function v(g,y,b,w){if(o.clearRect(g,y,b,w),n&&n!=="transparent"){var _=void 0;if(sk(n)){var x=n.global||n.__width===b&&n.__height===w;_=x&&n.__canvasGradient||aN(o,n,{x:0,y:0,width:b,height:w}),n.__canvasGradient=_,n.__width=b,n.__height=w}else rxe(n)&&(n.scaleX=n.scaleX||c,n.scaleY=n.scaleY||c,_=oN(o,n,{dirty:function(){h.setUnpainted(),h.__painter.refresh()}}));o.save(),o.fillStyle=_||n,o.fillRect(g,y,b,w),o.restore()}u&&(o.save(),o.globalAlpha=f,o.drawImage(d,g,y,b,w),o.restore())}!i||u?v(0,0,s,l):i.length&&ye(i,function(g){v(g.x*c,g.y*c,g.width*c,g.height*c)})},t}(Cl);const yM=wMe;var $G=1e5,ph=314159,Ox=.01,_Me=.001;function SMe(e){return e?e.__builtin__?!0:!(typeof e.resize!="function"||typeof e.refresh!="function"):!1}function CMe(e,t){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var xMe=function(){function e(t,r,n,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=n=et({},n||{}),this.dpr=n.devicePixelRatio||uE,this._singleCanvas=a,this.root=t;var o=t.style;o&&(Une(t),t.innerHTML=""),this.storage=r;var s=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(a){var f=t,c=f.width,h=f.height;n.width!=null&&(c=n.width),n.height!=null&&(h=n.height),this.dpr=n.devicePixelRatio||1,f.width=c*this.dpr,f.height=h*this.dpr,this._width=c,this._height=h;var d=new yM(f,this,this.dpr);d.__builtin__=!0,d.initContext(),l[ph]=d,d.zlevel=ph,s.push(ph),this._domRoot=t}else{this._width=gx(t,0,n),this._height=gx(t,1,n);var u=this._domRoot=CMe(this._width,this._height);t.appendChild(u)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.refresh=function(t){var r=this.storage.getDisplayList(!0),n=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(r,n,t,this._redrawId);for(var a=0;a<i.length;a++){var o=i[a],s=this._layers[o];if(!s.__builtin__&&s.refresh){var l=a===0?this._backgroundColor:null;s.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=r.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(t){var r=t.length,n=this._hoverlayer;if(n&&n.clear(),!!r){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,o=0;o<r;o++){var s=t[o];s.__inHover&&(n||(n=this._hoverlayer=this.getLayer($G)),a||(a=n.ctx,a.save()),Wh(a,s,i,o===r-1))}a&&a.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer($G)},e.prototype.paintOne=function(t,r){goe(t,r)},e.prototype._paintList=function(t,r,n,i){if(this._redrawId===i){n=n||!1,this._updateLayerStatus(t);var a=this._doPaintList(t,r,n),o=a.finished,s=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),s&&this._paintHoverList(t),o)this.eachLayer(function(u){u.afterBrush&&u.afterBrush()});else{var l=this;O$(function(){l._paintList(t,r,n,i)})}}},e.prototype._compositeManually=function(){var t=this.getLayer(ph).ctx,r=this._domRoot.width,n=this._domRoot.height;t.clearRect(0,0,r,n),this.eachBuiltinLayer(function(i){i.virtual&&t.drawImage(i.dom,0,0,r,n)})},e.prototype._doPaintList=function(t,r,n){for(var i=this,a=[],o=this._opts.useDirtyRect,s=0;s<this._zlevelList.length;s++){var l=this._zlevelList[s],u=this._layers[l];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||n)&&a.push(u)}for(var f=!0,c=!1,h=function(g){var y=a[g],b=y.ctx,w=o&&y.createRepaintRects(t,r,d._width,d._height),_=n?y.__startIndex:y.__drawIndex,x=!n&&y.incremental&&Date.now,E=x&&Date.now(),R=y.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(y.__startIndex===y.__endIndex)y.clear(!1,R,w);else if(_===y.__startIndex){var A=t[_];(!A.incremental||!A.notClear||n)&&y.clear(!1,R,w)}_===-1&&(console.error("For some unknown reason. drawIndex is -1"),_=y.__startIndex);var N,I=function(z){var te={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(N=_;N<y.__endIndex;N++){var ie=t[N];if(ie.__inHover&&(c=!0),i._doPaintEl(ie,y,o,z,te,N===y.__endIndex-1),x){var fe=Date.now()-E;if(fe>15)break}}te.prevElClipPaths&&b.restore()};if(w)if(w.length===0)N=y.__endIndex;else for(var F=d.dpr,H=0;H<w.length;++H){var W=w[H];b.save(),b.beginPath(),b.rect(W.x*F,W.y*F,W.width*F,W.height*F),b.clip(),I(W),b.restore()}else b.save(),I(),b.restore();y.__drawIndex=N,y.__drawIndex<y.__endIndex&&(f=!1)},d=this,v=0;v<a.length;v++)h(v);return vr.wxa&&ye(this._layers,function(g){g&&g.ctx&&g.ctx.draw&&g.ctx.draw()}),{finished:f,needsRefreshHover:c}},e.prototype._doPaintEl=function(t,r,n,i,a,o){var s=r.ctx;if(n){var l=t.getPaintRect();(!i||l&&l.intersect(i))&&(Wh(s,t,a,o),t.setPrevPaintRect(l))}else Wh(s,t,a,o)},e.prototype.getLayer=function(t,r){this._singleCanvas&&!this._needsManuallyCompositing&&(t=ph);var n=this._layers[t];return n||(n=new yM("zr_"+t,this,this.dpr),n.zlevel=t,n.__builtin__=!0,this._layerConfig[t]?Hr(n,this._layerConfig[t],!0):this._layerConfig[t-Ox]&&Hr(n,this._layerConfig[t-Ox],!0),r&&(n.virtual=r),this.insertLayer(t,n),n.initContext()),n},e.prototype.insertLayer=function(t,r){var n=this._layers,i=this._zlevelList,a=i.length,o=this._domRoot,s=null,l=-1;if(!n[t]&&SMe(r)){if(a>0&&t>i[0]){for(l=0;l<a-1&&!(i[l]<t&&i[l+1]>t);l++);s=n[i[l]]}if(i.splice(l+1,0,t),n[t]=r,!r.virtual)if(s){var u=s.dom;u.nextSibling?o.insertBefore(r.dom,u.nextSibling):o.appendChild(r.dom)}else o.firstChild?o.insertBefore(r.dom,o.firstChild):o.appendChild(r.dom);r.__painter=this}},e.prototype.eachLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i];t.call(r,this._layers[a],a)}},e.prototype.eachBuiltinLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__&&t.call(r,o,a)}},e.prototype.eachOtherLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__||t.call(r,o,a)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(c,h){c.__dirty=c.__used=!1});function r(c){a&&(a.__endIndex!==c&&(a.__dirty=!0),a.__endIndex=c)}if(this._singleCanvas)for(var n=1;n<t.length;n++){var i=t[n];if(i.zlevel!==t[n-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var a=null,o=0,s,l;for(l=0;l<t.length;l++){var i=t[l],u=i.zlevel,f=void 0;s!==u&&(s=u,o=0),i.incremental?(f=this.getLayer(u+_Me,this._needsManuallyCompositing),f.incremental=!0,o=1):f=this.getLayer(u+(o>0?Ox:0),this._needsManuallyCompositing),f.__builtin__||GB("ZLevel "+u+" has been used by unkown layer "+f.id),f!==a&&(f.__used=!0,f.__startIndex!==l&&(f.__dirty=!0),f.__startIndex=l,f.incremental?f.__drawIndex=-1:f.__drawIndex=l,r(l),a=f),i.__dirty&ro&&!i.__inHover&&(f.__dirty=!0,f.incremental&&f.__drawIndex<0&&(f.__drawIndex=l))}r(l),this.eachBuiltinLayer(function(c,h){!c.__used&&c.getElementCount()>0&&(c.__dirty=!0,c.__startIndex=c.__endIndex=c.__drawIndex=0),c.__dirty&&c.__drawIndex<0&&(c.__drawIndex=c.__startIndex)})},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(t){t.clear()},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t,ye(this._layers,function(r){r.setUnpainted()})},e.prototype.configLayer=function(t,r){if(r){var n=this._layerConfig;n[t]?Hr(n[t],r,!0):n[t]=r;for(var i=0;i<this._zlevelList.length;i++){var a=this._zlevelList[i];if(a===t||a===t+Ox){var o=this._layers[a];Hr(o,n[t],!0)}}}},e.prototype.delLayer=function(t){var r=this._layers,n=this._zlevelList,i=r[t];i&&(i.dom.parentNode.removeChild(i.dom),delete r[t],n.splice(Xr(n,t),1))},e.prototype.resize=function(t,r){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var i=this._opts,a=this.root;if(t!=null&&(i.width=t),r!=null&&(i.height=r),t=gx(a,0,i),r=gx(a,1,i),n.style.display="",this._width!==t||r!==this._height){n.style.width=t+"px",n.style.height=r+"px";for(var o in this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(t,r);this.refresh(!0)}this._width=t,this._height=r}else{if(t==null||r==null)return;this._width=t,this._height=r,this.getLayer(ph).resize(t,r)}return this},e.prototype.clearLayer=function(t){var r=this._layers[t];r&&r.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[ph].dom;var r=new yM("image",this,t.pixelRatio||this.dpr);r.initContext(),r.clear(!1,t.backgroundColor||this._backgroundColor);var n=r.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var i=r.dom.width,a=r.dom.height;this.eachLayer(function(c){c.__builtin__?n.drawImage(c.dom,0,0,i,a):c.renderToCanvas&&(n.save(),c.renderToCanvas(n),n.restore())})}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},s=this.storage.getDisplayList(!0),l=0,u=s.length;l<u;l++){var f=s[l];Wh(n,f,o,l===u-1)}return r.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();const TMe=xMe;function OMe(e){e.registerPainter("canvas",TMe)}var EMe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r){return W3(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(r){var n=new Wi,i=yg("line",0,r.itemHeight/2,r.itemWidth,0,r.lineStyle.stroke,!1);n.add(i),i.setStyle(r.lineStyle);var a=this.getData().getVisual("symbol"),o=this.getData().getVisual("symbolRotate"),s=a==="none"?"circle":a,l=r.itemHeight*.8,u=yg(s,(r.itemWidth-l)/2,(r.itemHeight-l)/2,l,l,r.itemStyle.fill);n.add(u),u.setStyle(r.itemStyle);var f=r.iconRotate==="inherit"?o:r.iconRotate||0;return u.rotation=f*Math.PI/180,u.setOrigin([r.itemWidth/2,r.itemHeight/2]),s.indexOf("empty")>-1&&(u.style.stroke=u.style.fill,u.style.fill="#fff",u.style.lineWidth=2),n},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(Cc);const RMe=EMe;function Y3(e,t){var r=e.mapDimensionsAll("defaultedLabel"),n=r.length;if(n===1){var i=gg(e,t,r[0]);return i!=null?i+"":null}else if(n){for(var a=[],o=0;o<r.length;o++)a.push(gg(e,t,r[o]));return a.join(" ")}}function use(e,t){var r=e.mapDimensionsAll("defaultedLabel");if(!mt(t))return t+"";for(var n=[],i=0;i<r.length;i++){var a=e.getDimensionIndex(r[i]);a>=0&&n.push(t[a])}return n.join(" ")}var kMe=function(e){ct(t,e);function t(r,n,i,a){var o=e.call(this)||this;return o.updateData(r,n,i,a),o}return t.prototype._createSymbol=function(r,n,i,a,o){this.removeAll();var s=yg(r,-1,-1,2,2,null,o);s.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),s.drift=AMe,this._symbolType=r,this.add(s)},t.prototype.stopSymbolAnimation=function(r){this.childAt(0).stopAnimation(null,r)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){vE(this.childAt(0))},t.prototype.downplay=function(){pE(this.childAt(0))},t.prototype.setZ=function(r,n){var i=this.childAt(0);i.zlevel=r,i.z=n},t.prototype.setDraggable=function(r,n){var i=this.childAt(0);i.draggable=r,i.cursor=!n&&r?"move":i.cursor},t.prototype.updateData=function(r,n,i,a){this.silent=!1;var o=r.getItemVisual(n,"symbol")||"circle",s=r.hostModel,l=t.getSymbolSize(r,n),u=o!==this._symbolType,f=a&&a.disableAnimation;if(u){var c=r.getItemVisual(n,"symbolKeepAspect");this._createSymbol(o,r,n,l,c)}else{var h=this.childAt(0);h.silent=!1;var d={scaleX:l[0]/2,scaleY:l[1]/2};f?h.attr(d):ga(h,d,s,n),v3(h)}if(this._updateCommon(r,n,l,i,a),u){var h=this.childAt(0);if(!f){var d={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:h.style.opacity}};h.scaleX=h.scaleY=0,h.style.opacity=0,zo(h,d,s,n)}}f&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(r,n,i,a,o){var s=this.childAt(0),l=r.hostModel,u,f,c,h,d,v,g,y,b;if(a&&(u=a.emphasisItemStyle,f=a.blurItemStyle,c=a.selectItemStyle,h=a.focus,d=a.blurScope,g=a.labelStatesModels,y=a.hoverScale,b=a.cursorStyle,v=a.emphasisDisabled),!a||r.hasItemOption){var w=a&&a.itemModel?a.itemModel:r.getItemModel(n),_=w.getModel("emphasis");u=_.getModel("itemStyle").getItemStyle(),c=w.getModel(["select","itemStyle"]).getItemStyle(),f=w.getModel(["blur","itemStyle"]).getItemStyle(),h=_.get("focus"),d=_.get("blurScope"),v=_.get("disabled"),g=t1(w),y=_.getShallow("scale"),b=w.getShallow("cursor")}var x=r.getItemVisual(n,"symbolRotate");s.attr("rotation",(x||0)*Math.PI/180||0);var E=hoe(r.getItemVisual(n,"symbolOffset"),i);E&&(s.x=E[0],s.y=E[1]),b&&s.attr("cursor",b);var R=r.getItemVisual(n,"style"),A=R.fill;if(s instanceof Kd){var N=s.style;s.useStyle(et({image:N.image,x:N.x,y:N.y,width:N.width,height:N.height},R))}else s.__isEmptyBrush?s.useStyle(et({},R)):s.useStyle(R),s.style.decal=null,s.setColor(A,o&&o.symbolInnerColor),s.style.strokeNoScale=!0;var I=r.getItemVisual(n,"liftZ"),F=this._z2;I!=null?F==null&&(this._z2=s.z2,s.z2+=I):F!=null&&(s.z2=F,this._z2=null);var H=o&&o.useNameLabel;e1(s,g,{labelFetcher:l,labelDataIndex:n,defaultText:W,inheritColor:A,defaultOpacity:R.opacity});function W(ie){return H?r.getName(ie):Y3(r,ie)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var z=s.ensureState("emphasis");z.style=u,s.ensureState("select").style=c,s.ensureState("blur").style=f;var te=y==null||y===!0?Math.max(1.1,3/this._sizeY):isFinite(y)&&y>0?+y:1;z.scaleX=this._sizeX*te,z.scaleY=this._sizeY*te,this.setSymbolScale(1),xw(this,h,d,v)},t.prototype.setSymbolScale=function(r){this.scaleX=this.scaleY=r},t.prototype.fadeOut=function(r,n,i){var a=this.childAt(0),o=Ur(this).dataIndex,s=i&&i.animation;if(this.silent=a.silent=!0,i&&i.fadeLabel){var l=a.getTextContent();l&&mE(l,{style:{opacity:0}},n,{dataIndex:o,removeOpt:s,cb:function(){a.removeTextContent()}})}else a.removeTextContent();mE(a,{style:{opacity:0},scaleX:0,scaleY:0},n,{dataIndex:o,cb:r,removeOpt:s})},t.getSymbolSize=function(r,n){return QAe(r.getItemVisual(n,"symbolSize"))},t}(Wi);function AMe(e,t){this.parent.drift(e,t)}const K3=kMe;function mM(e,t,r,n){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(n.isIgnore&&n.isIgnore(r))&&!(n.clipShape&&!n.clipShape.contain(t[0],t[1]))&&e.getItemVisual(r,"symbol")!=="none"}function NG(e){return e!=null&&!$t(e)&&(e={isIgnore:e}),e||{}}function LG(e){var t=e.hostModel,r=t.getModel("emphasis");return{emphasisItemStyle:r.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:r.get("focus"),blurScope:r.get("blurScope"),emphasisDisabled:r.get("disabled"),hoverScale:r.get("scale"),labelStatesModels:t1(t),cursorStyle:t.get("cursor")}}var PMe=function(){function e(t){this.group=new Wi,this._SymbolCtor=t||K3}return e.prototype.updateData=function(t,r){this._progressiveEls=null,r=NG(r);var n=this.group,i=t.hostModel,a=this._data,o=this._SymbolCtor,s=r.disableAnimation,l=LG(t),u={disableAnimation:s},f=r.getSymbolPoint||function(c){return t.getItemLayout(c)};a||n.removeAll(),t.diff(a).add(function(c){var h=f(c);if(mM(t,h,c,r)){var d=new o(t,c,l,u);d.setPosition(h),t.setItemGraphicEl(c,d),n.add(d)}}).update(function(c,h){var d=a.getItemGraphicEl(h),v=f(c);if(!mM(t,v,c,r)){n.remove(d);return}var g=t.getItemVisual(c,"symbol")||"circle",y=d&&d.getSymbolType&&d.getSymbolType();if(!d||y&&y!==g)n.remove(d),d=new o(t,c,l,u),d.setPosition(v);else{d.updateData(t,c,l,u);var b={x:v[0],y:v[1]};s?d.attr(b):ga(d,b,i)}n.add(d),t.setItemGraphicEl(c,d)}).remove(function(c){var h=a.getItemGraphicEl(c);h&&h.fadeOut(function(){n.remove(h)},i)}).execute(),this._getSymbolPoint=f,this._data=t},e.prototype.updateLayout=function(){var t=this,r=this._data;r&&r.eachItemGraphicEl(function(n,i){var a=t._getSymbolPoint(i);n.setPosition(a),n.markRedraw()})},e.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=LG(t),this._data=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(t,r,n){this._progressiveEls=[],n=NG(n);function i(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var a=t.start;a<t.end;a++){var o=r.getItemLayout(a);if(mM(r,o,a,n)){var s=new this._SymbolCtor(r,a,this._seriesScope);s.traverse(i),s.setPosition(o),this.group.add(s),r.setItemGraphicEl(a,s),this._progressiveEls.push(s)}}},e.prototype.eachRendered=function(t){yk(this._progressiveEls||this.group,t)},e.prototype.remove=function(t){var r=this.group,n=this._data;n&&t?n.eachItemGraphicEl(function(i){i.fadeOut(function(){r.remove(i)},n.hostModel)}):r.removeAll()},e}();const IMe=PMe;function fse(e,t,r){var n=e.getBaseAxis(),i=e.getOtherAxis(n),a=MMe(i,r),o=n.dim,s=i.dim,l=t.mapDimension(s),u=t.mapDimension(o),f=s==="x"||s==="radius"?1:0,c=Lt(e.dimensions,function(v){return t.mapDimension(v)}),h=!1,d=t.getCalculationInfo("stackResultDimension");return mg(t,c[0])&&(h=!0,c[0]=d),mg(t,c[1])&&(h=!0,c[1]=d),{dataDimsForPoint:c,valueStart:a,valueAxisDim:s,baseAxisDim:o,stacked:!!h,valueDim:l,baseDim:u,baseDataOffset:f,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function MMe(e,t){var r=0,n=e.scale.getExtent();return t==="start"?r=n[0]:t==="end"?r=n[1]:en(t)&&!isNaN(t)?r=t:n[0]>0?r=n[0]:n[1]<0&&(r=n[1]),r}function cse(e,t,r,n){var i=NaN;e.stacked&&(i=r.get(r.getCalculationInfo("stackedOverDimension"),n)),isNaN(i)&&(i=e.valueStart);var a=e.baseDataOffset,o=[];return o[a]=r.get(e.baseDim,n),o[1-a]=i,t.dataToPoint(o)}function DMe(e,t){var r=[];return t.diff(e).add(function(n){r.push({cmd:"+",idx:n})}).update(function(n,i){r.push({cmd:"=",idx:i,idx1:n})}).remove(function(n){r.push({cmd:"-",idx:n})}).execute(),r}function $Me(e,t,r,n,i,a,o,s){for(var l=DMe(e,t),u=[],f=[],c=[],h=[],d=[],v=[],g=[],y=fse(i,t,o),b=e.getLayout("points")||[],w=t.getLayout("points")||[],_=0;_<l.length;_++){var x=l[_],E=!0,R=void 0,A=void 0;switch(x.cmd){case"=":R=x.idx*2,A=x.idx1*2;var N=b[R],I=b[R+1],F=w[A],H=w[A+1];(isNaN(N)||isNaN(I))&&(N=F,I=H),u.push(N,I),f.push(F,H),c.push(r[R],r[R+1]),h.push(n[A],n[A+1]),g.push(t.getRawIndex(x.idx1));break;case"+":var W=x.idx,z=y.dataDimsForPoint,te=i.dataToPoint([t.get(z[0],W),t.get(z[1],W)]);A=W*2,u.push(te[0],te[1]),f.push(w[A],w[A+1]);var ie=cse(y,i,t,W);c.push(ie[0],ie[1]),h.push(n[A],n[A+1]),g.push(t.getRawIndex(W));break;case"-":E=!1}E&&(d.push(x),v.push(v.length))}v.sort(function(B,Y){return g[B]-g[Y]});for(var fe=u.length,Te=iu(fe),M=iu(fe),S=iu(fe),T=iu(fe),k=[],_=0;_<v.length;_++){var O=v[_],D=_*2,L=O*2;Te[D]=u[L],Te[D+1]=u[L+1],M[D]=f[L],M[D+1]=f[L+1],S[D]=c[L],S[D+1]=c[L+1],T[D]=h[L],T[D+1]=h[L+1],k[_]=d[O]}return{current:Te,next:M,stackedOnCurrent:S,stackedOnNext:T,status:k}}var _f=Math.min,Sf=Math.max;function md(e,t){return isNaN(e)||isNaN(t)}function dN(e,t,r,n,i,a,o,s,l){for(var u,f,c,h,d,v,g=r,y=0;y<n;y++){var b=t[g*2],w=t[g*2+1];if(g>=i||g<0)break;if(md(b,w)){if(l){g+=a;continue}break}if(g===r)e[a>0?"moveTo":"lineTo"](b,w),c=b,h=w;else{var _=b-u,x=w-f;if(_*_+x*x<.5){g+=a;continue}if(o>0){for(var E=g+a,R=t[E*2],A=t[E*2+1];R===b&&A===w&&y<n;)y++,E+=a,g+=a,R=t[E*2],A=t[E*2+1],b=t[g*2],w=t[g*2+1],_=b-u,x=w-f;var N=y+1;if(l)for(;md(R,A)&&N<n;)N++,E+=a,R=t[E*2],A=t[E*2+1];var I=.5,F=0,H=0,W=void 0,z=void 0;if(N>=n||md(R,A))d=b,v=w;else{F=R-u,H=A-f;var te=b-u,ie=R-b,fe=w-f,Te=A-w,M=void 0,S=void 0;if(s==="x"){M=Math.abs(te),S=Math.abs(ie);var T=F>0?1:-1;d=b-T*M*o,v=w,W=b+T*S*o,z=w}else if(s==="y"){M=Math.abs(fe),S=Math.abs(Te);var k=H>0?1:-1;d=b,v=w-k*M*o,W=b,z=w+k*S*o}else M=Math.sqrt(te*te+fe*fe),S=Math.sqrt(ie*ie+Te*Te),I=S/(S+M),d=b-F*o*(1-I),v=w-H*o*(1-I),W=b+F*o*I,z=w+H*o*I,W=_f(W,Sf(R,b)),z=_f(z,Sf(A,w)),W=Sf(W,_f(R,b)),z=Sf(z,_f(A,w)),F=W-b,H=z-w,d=b-F*M/S,v=w-H*M/S,d=_f(d,Sf(u,b)),v=_f(v,Sf(f,w)),d=Sf(d,_f(u,b)),v=Sf(v,_f(f,w)),F=b-d,H=w-v,W=b+F*S/M,z=w+H*S/M}e.bezierCurveTo(c,h,d,v,b,w),c=W,h=z}else e.lineTo(b,w)}u=b,f=w,g+=a}return y}var hse=function(){function e(){this.smooth=0,this.smoothConstraint=!0}return e}(),NMe=function(e){ct(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polyline",n}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new hse},t.prototype.buildPath=function(r,n){var i=n.points,a=0,o=i.length/2;if(n.connectNulls){for(;o>0&&md(i[o*2-2],i[o*2-1]);o--);for(;a<o&&md(i[a*2],i[a*2+1]);a++);}for(;a<o;)a+=dN(r,i,a,o,o,1,n.smooth,n.smoothMonotone,n.connectNulls)+1},t.prototype.getPointOn=function(r,n){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,a=i.data,o=_c.CMD,s,l,u=n==="x",f=[],c=0;c<a.length;){var h=a[c++],d=void 0,v=void 0,g=void 0,y=void 0,b=void 0,w=void 0,_=void 0;switch(h){case o.M:s=a[c++],l=a[c++];break;case o.L:if(d=a[c++],v=a[c++],_=u?(r-s)/(d-s):(r-l)/(v-l),_<=1&&_>=0){var x=u?(v-l)*_+l:(d-s)*_+s;return u?[r,x]:[x,r]}s=d,l=v;break;case o.C:d=a[c++],v=a[c++],g=a[c++],y=a[c++],b=a[c++],w=a[c++];var E=u?aE(s,d,g,b,r,f):aE(l,v,y,w,r,f);if(E>0)for(var R=0;R<E;R++){var A=f[R];if(A<=1&&A>=0){var x=u?si(l,v,y,w,A):si(s,d,g,b,A);return u?[r,x]:[x,r]}}s=b,l=w;break}}},t}(zr),LMe=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(hse),FMe=function(e){ct(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polygon",n}return t.prototype.getDefaultShape=function(){return new LMe},t.prototype.buildPath=function(r,n){var i=n.points,a=n.stackedOnPoints,o=0,s=i.length/2,l=n.smoothMonotone;if(n.connectNulls){for(;s>0&&md(i[s*2-2],i[s*2-1]);s--);for(;o<s&&md(i[o*2],i[o*2+1]);o++);}for(;o<s;){var u=dN(r,i,o,s,s,1,n.smooth,l,n.connectNulls);dN(r,a,o+u-1,u,s,-1,n.stackedOnSmooth,l,n.connectNulls),o+=u+1,r.closePath()}},t}(zr);function dse(e,t,r,n,i){var a=e.getArea(),o=a.x,s=a.y,l=a.width,u=a.height,f=r.get(["lineStyle","width"])||2;o-=f/2,s-=f/2,l+=f,u+=f,o=Math.floor(o),l=Math.round(l);var c=new ci({shape:{x:o,y:s,width:l,height:u}});if(t){var h=e.getBaseAxis(),d=h.isHorizontal(),v=h.inverse;d?(v&&(c.shape.x+=l),c.shape.width=0):(v||(c.shape.y+=u),c.shape.height=0);var g=lr(i)?function(y){i(y,c)}:null;zo(c,{shape:{width:l,height:u,x:o,y:s}},r,null,n,g)}return c}function vse(e,t,r){var n=e.getArea(),i=Qn(n.r0,1),a=Qn(n.r,1),o=new Xd({shape:{cx:Qn(e.cx,1),cy:Qn(e.cy,1),r0:i,r:a,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});if(t){var s=e.getBaseAxis().dim==="angle";s?o.shape.endAngle=n.startAngle:o.shape.r=i,zo(o,{shape:{endAngle:n.endAngle,r:a}},r)}return o}function HMe(e,t,r,n,i){if(e){if(e.type==="polar")return vse(e,t,r);if(e.type==="cartesian2d")return dse(e,t,r,n,i)}else return null;return null}function X3(e,t){return e.type===t}function FG(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return;return!0}}function HG(e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,a=0;a<e.length;){var o=e[a++],s=e[a++];isNaN(o)||(t=Math.min(o,t),n=Math.max(o,n)),isNaN(s)||(r=Math.min(s,r),i=Math.max(s,i))}return[[t,r],[n,i]]}function BG(e,t){var r=HG(e),n=r[0],i=r[1],a=HG(t),o=a[0],s=a[1];return Math.max(Math.abs(n[0]-o[0]),Math.abs(n[1]-o[1]),Math.abs(i[0]-s[0]),Math.abs(i[1]-s[1]))}function WG(e){return en(e)?e:e?.5:0}function BMe(e,t,r){if(!r.valueDim)return[];for(var n=t.count(),i=iu(n*2),a=0;a<n;a++){var o=cse(r,e,t,a);i[a*2]=o[0],i[a*2+1]=o[1]}return i}function Cf(e,t,r,n){var i=t.getBaseAxis(),a=i.dim==="x"||i.dim==="radius"?0:1,o=[],s=0,l=[],u=[],f=[],c=[];if(n){for(s=0;s<e.length;s+=2)!isNaN(e[s])&&!isNaN(e[s+1])&&c.push(e[s],e[s+1]);e=c}for(s=0;s<e.length-2;s+=2)switch(f[0]=e[s+2],f[1]=e[s+3],u[0]=e[s],u[1]=e[s+1],o.push(u[0],u[1]),r){case"end":l[a]=f[a],l[1-a]=u[1-a],o.push(l[0],l[1]);break;case"middle":var h=(u[a]+f[a])/2,d=[];l[a]=d[a]=h,l[1-a]=u[1-a],d[1-a]=f[1-a],o.push(l[0],l[1]),o.push(d[0],d[1]);break;default:l[a]=u[a],l[1-a]=f[1-a],o.push(l[0],l[1])}return o.push(e[s++],e[s++]),o}function WMe(e,t){var r=[],n=e.length,i,a;function o(f,c,h){var d=f.coord,v=(h-d)/(c.coord-d),g=tTe(v,[f.color,c.color]);return{coord:h,color:g}}for(var s=0;s<n;s++){var l=e[s],u=l.coord;if(u<0)i=l;else if(u>t){a?r.push(o(a,l,t)):i&&r.push(o(i,l,0),o(i,l,t));break}else i&&(r.push(o(i,l,0)),i=null),r.push(l),a=l}return r}function VMe(e,t,r){var n=e.getVisual("visualMeta");if(!(!n||!n.length||!e.count())&&t.type==="cartesian2d"){for(var i,a,o=n.length-1;o>=0;o--){var s=e.getDimensionInfo(n[o].dimension);if(i=s&&s.coordDim,i==="x"||i==="y"){a=n[o];break}}if(a){var l=t.getAxis(i),u=Lt(a.stops,function(_){return{coord:l.toGlobalCoord(l.dataToCoord(_.value)),color:_.color}}),f=u.length,c=a.outerColors.slice();f&&u[0].coord>u[f-1].coord&&(u.reverse(),c.reverse());var h=WMe(u,i==="x"?r.getWidth():r.getHeight()),d=h.length;if(!d&&f)return u[0].coord<0?c[1]?c[1]:u[f-1].color:c[0]?c[0]:u[0].color;var v=10,g=h[0].coord-v,y=h[d-1].coord+v,b=y-g;if(b<.001)return"transparent";ye(h,function(_){_.offset=(_.coord-g)/b}),h.push({offset:d?h[d-1].offset:.5,color:c[1]||"transparent"}),h.unshift({offset:d?h[0].offset:.5,color:c[0]||"transparent"});var w=new uae(0,0,0,0,h,!0);return w[i]=g,w[i+"2"]=y,w}}}function UMe(e,t,r){var n=e.get("showAllSymbol"),i=n==="auto";if(!(n&&!i)){var a=r.getAxesByScale("ordinal")[0];if(a&&!(i&&jMe(a,t))){var o=t.mapDimension(a.dim),s={};return ye(a.getViewLabels(),function(l){var u=a.scale.getRawOrdinalNumber(l.tickValue);s[u]=1}),function(l){return!s.hasOwnProperty(t.get(o,l))}}}}function jMe(e,t){var r=e.getExtent(),n=Math.abs(r[1]-r[0])/e.scale.count();isNaN(n)&&(n=0);for(var i=t.count(),a=Math.max(1,Math.round(i/5)),o=0;o<i;o+=a)if(K3.getSymbolSize(t,o)[e.isHorizontal()?1:0]*1.5>n)return!1;return!0}function zMe(e,t){return isNaN(e)||isNaN(t)}function GMe(e){for(var t=e.length/2;t>0&&zMe(e[t*2-2],e[t*2-1]);t--);return t-1}function VG(e,t){return[e[t*2],e[t*2+1]]}function YMe(e,t,r){for(var n=e.length/2,i=r==="x"?0:1,a,o,s=0,l=-1,u=0;u<n;u++)if(o=e[u*2+i],!(isNaN(o)||isNaN(e[u*2+1-i]))){if(u===0){a=o;continue}if(a<=t&&o>=t||a>=t&&o<=t){l=u;break}s=u,a=o}return{range:[s,l],t:(t-a)/(o-a)}}function pse(e){if(e.get(["endLabel","show"]))return!0;for(var t=0;t<Go.length;t++)if(e.get([Go[t],"endLabel","show"]))return!0;return!1}function bM(e,t,r,n){if(X3(t,"cartesian2d")){var i=n.getModel("endLabel"),a=i.get("valueAnimation"),o=n.getData(),s={lastFrameIndex:0},l=pse(n)?function(d,v){e._endLabelOnDuring(d,v,o,s,a,i,t)}:null,u=t.getBaseAxis().isHorizontal(),f=dse(t,r,n,function(){var d=e._endLabel;d&&r&&s.originalX!=null&&d.attr({x:s.originalX,y:s.originalY})},l);if(!n.get("clip",!0)){var c=f.shape,h=Math.max(c.width,c.height);u?(c.y-=h,c.height+=h*2):(c.x-=h,c.width+=h*2)}return l&&l(1,f),f}else return vse(t,r,n)}function KMe(e,t){var r=t.getBaseAxis(),n=r.isHorizontal(),i=r.inverse,a=n?i?"right":"left":"center",o=n?"middle":i?"top":"bottom";return{normal:{align:e.get("align")||a,verticalAlign:e.get("verticalAlign")||o}}}var XMe=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(){var r=new Wi,n=new IMe;this.group.add(n.group),this._symbolDraw=n,this._lineGroup=r},t.prototype.render=function(r,n,i){var a=this,o=r.coordinateSystem,s=this.group,l=r.getData(),u=r.getModel("lineStyle"),f=r.getModel("areaStyle"),c=l.getLayout("points")||[],h=o.type==="polar",d=this._coordSys,v=this._symbolDraw,g=this._polyline,y=this._polygon,b=this._lineGroup,w=!n.ssr&&r.isAnimationEnabled(),_=!f.isEmpty(),x=f.get("origin"),E=fse(o,l,x),R=_&&BMe(o,l,E),A=r.get("showSymbol"),N=r.get("connectNulls"),I=A&&!h&&UMe(r,l,o),F=this._data;F&&F.eachItemGraphicEl(function(Y,Q){Y.__temp&&(s.remove(Y),F.setItemGraphicEl(Q,null))}),A||v.remove(),s.add(b);var H=h?!1:r.get("step"),W;o&&o.getArea&&r.get("clip",!0)&&(W=o.getArea(),W.width!=null?(W.x-=.1,W.y-=.1,W.width+=.2,W.height+=.2):W.r0&&(W.r0-=.5,W.r+=.5)),this._clipShapeForSymbol=W;var z=VMe(l,o,i)||l.getVisual("style")[l.getVisual("drawType")];if(!(g&&d.type===o.type&&H===this._step))A&&v.updateData(l,{isIgnore:I,clipShape:W,disableAnimation:!0,getSymbolPoint:function(Y){return[c[Y*2],c[Y*2+1]]}}),w&&this._initSymbolLabelAnimation(l,o,W),H&&(c=Cf(c,o,H,N),R&&(R=Cf(R,o,H,N))),g=this._newPolyline(c),_?y=this._newPolygon(c,R):y&&(b.remove(y),y=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,kd(z)),b.setClipPath(bM(this,o,!0,r));else{_&&!y?y=this._newPolygon(c,R):y&&!_&&(b.remove(y),y=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,kd(z));var te=b.getClipPath();if(te){var ie=bM(this,o,!1,r);zo(te,{shape:ie.shape},r)}else b.setClipPath(bM(this,o,!0,r));A&&v.updateData(l,{isIgnore:I,clipShape:W,disableAnimation:!0,getSymbolPoint:function(Y){return[c[Y*2],c[Y*2+1]]}}),(!FG(this._stackedOnPoints,R)||!FG(this._points,c))&&(w?this._doUpdateAnimation(l,R,o,i,H,x,N):(H&&(c=Cf(c,o,H,N),R&&(R=Cf(R,o,H,N))),g.setShape({points:c}),y&&y.setShape({points:c,stackedOnPoints:R})))}var fe=r.getModel("emphasis"),Te=fe.get("focus"),M=fe.get("blurScope"),S=fe.get("disabled");if(g.useStyle(Vr(u.getLineStyle(),{fill:"none",stroke:z,lineJoin:"bevel"})),gE(g,r,"lineStyle"),g.style.lineWidth>0&&r.get(["emphasis","lineStyle","width"])==="bolder"){var T=g.getState("emphasis").style;T.lineWidth=+g.style.lineWidth+1}Ur(g).seriesIndex=r.seriesIndex,xw(g,Te,M,S);var k=WG(r.get("smooth")),O=r.get("smoothMonotone");if(g.setShape({smooth:k,smoothMonotone:O,connectNulls:N}),y){var D=l.getCalculationInfo("stackedOnSeries"),L=0;y.useStyle(Vr(f.getAreaStyle(),{fill:z,opacity:.7,lineJoin:"bevel",decal:l.getVisual("style").decal})),D&&(L=WG(D.get("smooth"))),y.setShape({smooth:k,stackedOnSmooth:L,smoothMonotone:O,connectNulls:N}),gE(y,r,"areaStyle"),Ur(y).seriesIndex=r.seriesIndex,xw(y,Te,M,S)}var B=function(Y){a._changePolyState(Y)};l.eachItemGraphicEl(function(Y){Y&&(Y.onHoverStateChange=B)}),this._polyline.onHoverStateChange=B,this._data=l,this._coordSys=o,this._stackedOnPoints=R,this._points=c,this._step=H,this._valueOrigin=x,r.get("triggerLineEvent")&&(this.packEventData(r,g),y&&this.packEventData(r,y))},t.prototype.packEventData=function(r,n){Ur(n).eventData={componentType:"series",componentSubType:"line",componentIndex:r.componentIndex,seriesIndex:r.seriesIndex,seriesName:r.name,seriesType:"line"}},t.prototype.highlight=function(r,n,i,a){var o=r.getData(),s=Ed(o,a);if(this._changePolyState("emphasis"),!(s instanceof Array)&&s!=null&&s>=0){var l=o.getLayout("points"),u=o.getItemGraphicEl(s);if(!u){var f=l[s*2],c=l[s*2+1];if(isNaN(f)||isNaN(c)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(f,c))return;var h=r.get("zlevel")||0,d=r.get("z")||0;u=new K3(o,s),u.x=f,u.y=c,u.setZ(h,d);var v=u.getSymbolPath().getTextContent();v&&(v.zlevel=h,v.z=d,v.z2=this._polyline.z2+1),u.__temp=!0,o.setItemGraphicEl(s,u),u.stopSymbolAnimation(!0),this.group.add(u)}u.highlight()}else yl.prototype.highlight.call(this,r,n,i,a)},t.prototype.downplay=function(r,n,i,a){var o=r.getData(),s=Ed(o,a);if(this._changePolyState("normal"),s!=null&&s>=0){var l=o.getItemGraphicEl(s);l&&(l.__temp?(o.setItemGraphicEl(s,null),this.group.remove(l)):l.downplay())}else yl.prototype.downplay.call(this,r,n,i,a)},t.prototype._changePolyState=function(r){var n=this._polygon;X6(this._polyline,r),n&&X6(n,r)},t.prototype._newPolyline=function(r){var n=this._polyline;return n&&this._lineGroup.remove(n),n=new NMe({shape:{points:r},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(n),this._polyline=n,n},t.prototype._newPolygon=function(r,n){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new FMe({shape:{points:r,stackedOnPoints:n},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},t.prototype._initSymbolLabelAnimation=function(r,n,i){var a,o,s=n.getBaseAxis(),l=s.inverse;n.type==="cartesian2d"?(a=s.isHorizontal(),o=!1):n.type==="polar"&&(a=s.dim==="angle",o=!0);var u=r.hostModel,f=u.get("animationDuration");lr(f)&&(f=f(null));var c=u.get("animationDelay")||0,h=lr(c)?c(null):c;r.eachItemGraphicEl(function(d,v){var g=d;if(g){var y=[d.x,d.y],b=void 0,w=void 0,_=void 0;if(i)if(o){var x=i,E=n.pointToCoord(y);a?(b=x.startAngle,w=x.endAngle,_=-E[1]/180*Math.PI):(b=x.r0,w=x.r,_=E[0])}else{var R=i;a?(b=R.x,w=R.x+R.width,_=d.x):(b=R.y+R.height,w=R.y,_=d.y)}var A=w===b?0:(_-b)/(w-b);l&&(A=1-A);var N=lr(c)?c(v):f*A+h,I=g.getSymbolPath(),F=I.getTextContent();g.attr({scaleX:0,scaleY:0}),g.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:N}),F&&F.animateFrom({style:{opacity:0}},{duration:300,delay:N}),I.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(r,n,i){var a=r.getModel("endLabel");if(pse(r)){var o=r.getData(),s=this._polyline,l=o.getLayout("points");if(!l){s.removeTextContent(),this._endLabel=null;return}var u=this._endLabel;u||(u=this._endLabel=new Vi({z2:200}),u.ignoreClip=!0,s.setTextContent(this._endLabel),s.disableLabelAnimation=!0);var f=GMe(l);f>=0&&(e1(s,t1(r,"endLabel"),{inheritColor:i,labelFetcher:r,labelDataIndex:f,defaultText:function(c,h,d){return d!=null?use(o,d):Y3(o,c)},enableTextSetter:!0},KMe(a,n)),s.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(r,n,i,a,o,s,l){var u=this._endLabel,f=this._polyline;if(u){r<1&&a.originalX==null&&(a.originalX=u.x,a.originalY=u.y);var c=i.getLayout("points"),h=i.hostModel,d=h.get("connectNulls"),v=s.get("precision"),g=s.get("distance")||0,y=l.getBaseAxis(),b=y.isHorizontal(),w=y.inverse,_=n.shape,x=w?b?_.x:_.y+_.height:b?_.x+_.width:_.y,E=(b?g:0)*(w?-1:1),R=(b?0:-g)*(w?-1:1),A=b?"x":"y",N=YMe(c,x,A),I=N.range,F=I[1]-I[0],H=void 0;if(F>=1){if(F>1&&!d){var W=VG(c,I[0]);u.attr({x:W[0]+E,y:W[1]+R}),o&&(H=h.getRawValue(I[0]))}else{var W=f.getPointOn(x,A);W&&u.attr({x:W[0]+E,y:W[1]+R});var z=h.getRawValue(I[0]),te=h.getRawValue(I[1]);o&&(H=eOe(i,v,z,te,N.t))}a.lastFrameIndex=I[0]}else{var ie=r===1||a.lastFrameIndex>0?I[0]:0,W=VG(c,ie);o&&(H=h.getRawValue(ie)),u.attr({x:W[0]+E,y:W[1]+R})}o&&bk(u).setLabelText(H)}},t.prototype._doUpdateAnimation=function(r,n,i,a,o,s,l){var u=this._polyline,f=this._polygon,c=r.hostModel,h=$Me(this._data,r,this._stackedOnPoints,n,this._coordSys,i,this._valueOrigin),d=h.current,v=h.stackedOnCurrent,g=h.next,y=h.stackedOnNext;if(o&&(d=Cf(h.current,i,o,l),v=Cf(h.stackedOnCurrent,i,o,l),g=Cf(h.next,i,o,l),y=Cf(h.stackedOnNext,i,o,l)),BG(d,g)>3e3||f&&BG(v,y)>3e3){u.stopAnimation(),u.setShape({points:g}),f&&(f.stopAnimation(),f.setShape({points:g,stackedOnPoints:y}));return}u.shape.__points=h.current,u.shape.points=d;var b={shape:{points:g}};h.current!==d&&(b.shape.__points=h.next),u.stopAnimation(),ga(u,b,c),f&&(f.setShape({points:d,stackedOnPoints:v}),f.stopAnimation(),ga(f,{shape:{stackedOnPoints:y}},c),u.shape.points!==f.shape.points&&(f.shape.points=u.shape.points));for(var w=[],_=h.status,x=0;x<_.length;x++){var E=_[x].cmd;if(E==="="){var R=r.getItemGraphicEl(_[x].idx1);R&&w.push({el:R,ptIdx:x})}}u.animators&&u.animators.length&&u.animators[0].during(function(){f&&f.dirtyShape();for(var A=u.shape.__points,N=0;N<w.length;N++){var I=w[N].el,F=w[N].ptIdx*2;I.x=A[F],I.y=A[F+1],I.markRedraw()}})},t.prototype.remove=function(r){var n=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(a,o){a.__temp&&(n.remove(a),i.setItemGraphicEl(o,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(yl);const qMe=XMe;function ZMe(e,t){return{seriesType:e,plan:M3(),reset:function(r){var n=r.getData(),i=r.coordinateSystem,a=r.pipelineContext,o=t||a.large;if(i){var s=Lt(i.dimensions,function(d){return n.mapDimension(d)}).slice(0,2),l=s.length,u=n.getCalculationInfo("stackResultDimension");mg(n,s[0])&&(s[0]=u),mg(n,s[1])&&(s[1]=u);var f=n.getStore(),c=n.getDimensionIndex(s[0]),h=n.getDimensionIndex(s[1]);return l&&{progress:function(d,v){for(var g=d.end-d.start,y=o&&iu(g*l),b=[],w=[],_=d.start,x=0;_<d.end;_++){var E=void 0;if(l===1){var R=f.get(c,_);E=i.dataToPoint(R,null,w)}else b[0]=f.get(c,_),b[1]=f.get(h,_),E=i.dataToPoint(b,null,w);o?(y[x++]=E[0],y[x++]=E[1]):v.setItemLayout(_,E.slice())}o&&v.setLayout("points",y)}}}}}}var JMe={average:function(e){for(var t=0,r=0,n=0;n<e.length;n++)isNaN(e[n])||(t+=e[n],r++);return r===0?NaN:t/r},sum:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r]||0;return t},max:function(e){for(var t=-1/0,r=0;r<e.length;r++)e[r]>t&&(t=e[r]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,r=0;r<e.length;r++)e[r]<t&&(t=e[r]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},QMe=function(e){return Math.round(e.length/2)};function gse(e){return{seriesType:e,reset:function(t,r,n){var i=t.getData(),a=t.get("sampling"),o=t.coordinateSystem,s=i.count();if(s>10&&o.type==="cartesian2d"&&a){var l=o.getBaseAxis(),u=o.getOtherAxis(l),f=l.getExtent(),c=n.getDevicePixelRatio(),h=Math.abs(f[1]-f[0])*(c||1),d=Math.round(s/h);if(isFinite(d)&&d>1){a==="lttb"&&t.setData(i.lttbDownSample(i.mapDimension(u.dim),1/d));var v=void 0;Rt(a)?v=JMe[a]:lr(a)&&(v=a),v&&t.setData(i.downSample(i.mapDimension(u.dim),1/d,v,QMe))}}}}}function e2e(e){e.registerChartView(qMe),e.registerSeriesModel(RMe),e.registerLayout(ZMe("line",!0)),e.registerVisual({seriesType:"line",reset:function(t){var r=t.getData(),n=t.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=r.getVisual("style").fill),r.setVisual("legendLineStyle",n)}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,gse("line"))}var yse=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){return W3(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(r,n,i){var a=this.coordinateSystem;if(a&&a.clampData){var o=a.clampData(r),s=a.dataToPoint(o);if(i)ye(a.getAxes(),function(h,d){if(h.type==="category"&&n!=null){var v=h.getTicksCoords(),g=o[d],y=n[d]==="x1"||n[d]==="y1";if(y&&(g+=1),v.length<2)return;if(v.length===2){s[d]=h.toGlobalCoord(h.getExtent()[y?1:0]);return}for(var b=void 0,w=void 0,_=1,x=0;x<v.length;x++){var E=v[x].coord,R=x===v.length-1?v[x-1].tickValue+_:v[x].tickValue;if(R===g){w=E;break}else if(R<g)b=E;else if(b!=null&&R>g){w=(E+b)/2;break}x===1&&(_=R-v[0].tickValue)}w==null&&(b?b&&(w=v[v.length-1].coord):w=v[0].coord),s[d]=h.toGlobalCoord(w)}});else{var l=this.getData(),u=l.getLayout("offset"),f=l.getLayout("size"),c=a.getBaseAxis().isHorizontal()?0:1;s[c]+=u+f/2}return s}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(Cc);Cc.registerClass(yse);const UG=yse;var t2e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(){return W3(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},t.prototype.getProgressiveThreshold=function(){var r=this.get("progressiveThreshold"),n=this.get("largeThreshold");return n>r&&(r=n),r},t.prototype.brushSelector=function(r,n,i){return i.rect(n.getItemLayout(r))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=yae(UG.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(UG);const r2e=t2e;var n2e=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),i2e=function(e){ct(t,e);function t(r){var n=e.call(this,r)||this;return n.type="sausage",n}return t.prototype.getDefaultShape=function(){return new n2e},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r0||0,0),s=Math.max(n.r,0),l=(s-o)*.5,u=o+l,f=n.startAngle,c=n.endAngle,h=n.clockwise,d=Math.PI*2,v=h?c-f<d:f-c<d;v||(f=c-(h?d:-d));var g=Math.cos(f),y=Math.sin(f),b=Math.cos(c),w=Math.sin(c);v?(r.moveTo(g*o+i,y*o+a),r.arc(g*u+i,y*u+a,l,-Math.PI+f,f,!h)):r.moveTo(g*s+i,y*s+a),r.arc(i,a,s,f,c,!h),r.arc(b*u+i,w*u+a,l,c-Math.PI*2,c-Math.PI,!h),o!==0&&r.arc(i,a,o,c,f,h)},t}(zr);const jG=i2e;function a2e(e,t){t=t||{};var r=t.isRoundCap;return function(n,i,a){var o=i.position;if(!o||o instanceof Array)return fE(n,i,a);var s=e(o),l=i.distance!=null?i.distance:5,u=this.shape,f=u.cx,c=u.cy,h=u.r,d=u.r0,v=(h+d)/2,g=u.startAngle,y=u.endAngle,b=(g+y)/2,w=r?Math.abs(h-d)/2:0,_=Math.cos,x=Math.sin,E=f+h*_(g),R=c+h*x(g),A="left",N="top";switch(s){case"startArc":E=f+(d-l)*_(b),R=c+(d-l)*x(b),A="center",N="top";break;case"insideStartArc":E=f+(d+l)*_(b),R=c+(d+l)*x(b),A="center",N="bottom";break;case"startAngle":E=f+v*_(g)+Ex(g,l+w,!1),R=c+v*x(g)+Rx(g,l+w,!1),A="right",N="middle";break;case"insideStartAngle":E=f+v*_(g)+Ex(g,-l+w,!1),R=c+v*x(g)+Rx(g,-l+w,!1),A="left",N="middle";break;case"middle":E=f+v*_(b),R=c+v*x(b),A="center",N="middle";break;case"endArc":E=f+(h+l)*_(b),R=c+(h+l)*x(b),A="center",N="bottom";break;case"insideEndArc":E=f+(h-l)*_(b),R=c+(h-l)*x(b),A="center",N="top";break;case"endAngle":E=f+v*_(y)+Ex(y,l+w,!0),R=c+v*x(y)+Rx(y,l+w,!0),A="left",N="middle";break;case"insideEndAngle":E=f+v*_(y)+Ex(y,-l+w,!0),R=c+v*x(y)+Rx(y,-l+w,!0),A="right",N="middle";break;default:return fE(n,i,a)}return n=n||{},n.x=E,n.y=R,n.align=A,n.verticalAlign=N,n}}function o2e(e,t,r,n){if(en(n)){e.setTextConfig({rotation:n});return}else if(mt(t)){e.setTextConfig({rotation:0});return}var i=e.shape,a=i.clockwise?i.startAngle:i.endAngle,o=i.clockwise?i.endAngle:i.startAngle,s=(a+o)/2,l,u=r(t);switch(u){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=s;break;case"startAngle":case"insideStartAngle":l=a;break;case"endAngle":case"insideEndAngle":l=o;break;default:e.setTextConfig({rotation:0});return}var f=Math.PI*1.5-l;u==="middle"&&f>Math.PI/2&&f<Math.PI*1.5&&(f-=Math.PI),e.setTextConfig({rotation:f})}function Ex(e,t,r){return t*Math.sin(e)*(r?-1:1)}function Rx(e,t,r){return t*Math.cos(e)*(r?1:-1)}function _b(e,t,r){var n=e.get("borderRadius");if(n==null)return r?{cornerRadius:0}:null;mt(n)||(n=[n,n,n,n]);var i=Math.abs(t.r||0-t.r0||0);return{cornerRadius:Lt(n,function(a){return wc(a,i)})}}var wM=Math.max,_M=Math.min;function s2e(e,t){var r=e.getArea&&e.getArea();if(X3(e,"cartesian2d")){var n=e.getBaseAxis();if(n.type!=="category"||!n.onBand){var i=t.getLayout("bandWidth");n.isHorizontal()?(r.x-=i,r.width+=i*2):(r.y-=i,r.height+=i*2)}}return r}var l2e=function(e){ct(t,e);function t(){var r=e.call(this)||this;return r.type=t.type,r._isFirstFrame=!0,r}return t.prototype.render=function(r,n,i,a){this._model=r,this._removeOnRenderedListener(i),this._updateDrawMode(r);var o=r.get("coordinateSystem");(o==="cartesian2d"||o==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(r,n,i):this._renderNormal(r,n,i,a))},t.prototype.incrementalPrepareRender=function(r){this._clear(),this._updateDrawMode(r),this._updateLargeClip(r)},t.prototype.incrementalRender=function(r,n){this._progressiveEls=[],this._incrementalRenderLarge(r,n)},t.prototype.eachRendered=function(r){yk(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},t.prototype._renderNormal=function(r,n,i,a){var o=this.group,s=r.getData(),l=this._data,u=r.coordinateSystem,f=u.getBaseAxis(),c;u.type==="cartesian2d"?c=f.isHorizontal():u.type==="polar"&&(c=f.dim==="angle");var h=r.isAnimationEnabled()?r:null,d=u2e(r,u);d&&this._enableRealtimeSort(d,s,i);var v=r.get("clip",!0)||d,g=s2e(u,s);o.removeClipPath();var y=r.get("roundCap",!0),b=r.get("showBackground",!0),w=r.getModel("backgroundStyle"),_=w.get("borderRadius")||0,x=[],E=this._backgroundEls,R=a&&a.isInitSort,A=a&&a.type==="changeAxisOrder";function N(H){var W=kx[u.type](s,H),z=g2e(u,c,W);return z.useStyle(w.getItemStyle()),u.type==="cartesian2d"?z.setShape("r",_):z.setShape("cornerRadius",_),x[H]=z,z}s.diff(l).add(function(H){var W=s.getItemModel(H),z=kx[u.type](s,H,W);if(b&&N(H),!(!s.hasValue(H)||!XG[u.type](z))){var te=!1;v&&(te=zG[u.type](g,z));var ie=GG[u.type](r,s,H,z,c,h,f.model,!1,y);d&&(ie.forceLabelAnimation=!0),qG(ie,s,H,W,z,r,c,u.type==="polar"),R?ie.attr({shape:z}):d?YG(d,h,ie,z,H,c,!1,!1):zo(ie,{shape:z},r,H),s.setItemGraphicEl(H,ie),o.add(ie),ie.ignore=te}}).update(function(H,W){var z=s.getItemModel(H),te=kx[u.type](s,H,z);if(b){var ie=void 0;E.length===0?ie=N(W):(ie=E[W],ie.useStyle(w.getItemStyle()),u.type==="cartesian2d"?ie.setShape("r",_):ie.setShape("cornerRadius",_),x[H]=ie);var fe=kx[u.type](s,H),Te=bse(c,fe,u);ga(ie,{shape:Te},h,H)}var M=l.getItemGraphicEl(W);if(!s.hasValue(H)||!XG[u.type](te)){o.remove(M);return}var S=!1;if(v&&(S=zG[u.type](g,te),S&&o.remove(M)),M?v3(M):M=GG[u.type](r,s,H,te,c,h,f.model,!!M,y),d&&(M.forceLabelAnimation=!0),A){var T=M.getTextContent();if(T){var k=bk(T);k.prevValue!=null&&(k.prevValue=k.value)}}else qG(M,s,H,z,te,r,c,u.type==="polar");R?M.attr({shape:te}):d?YG(d,h,M,te,H,c,!0,A):ga(M,{shape:te},r,H,null),s.setItemGraphicEl(H,M),M.ignore=S,o.add(M)}).remove(function(H){var W=l.getItemGraphicEl(H);W&&bE(W,r,H)}).execute();var I=this._backgroundGroup||(this._backgroundGroup=new Wi);I.removeAll();for(var F=0;F<x.length;++F)I.add(x[F]);o.add(I),this._backgroundEls=x,this._data=s},t.prototype._renderLarge=function(r,n,i){this._clear(),JG(r,this.group),this._updateLargeClip(r)},t.prototype._incrementalRenderLarge=function(r,n){this._removeBackground(),JG(n,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(r){var n=r.get("clip",!0)&&HMe(r.coordinateSystem,!1,r),i=this.group;n?i.setClipPath(n):i.removeClipPath()},t.prototype._enableRealtimeSort=function(r,n,i){var a=this;if(n.count()){var o=r.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(n,r,i),this._isFirstFrame=!1;else{var s=function(l){var u=n.getItemGraphicEl(l),f=u&&u.shape;return f&&Math.abs(o.isHorizontal()?f.height:f.width)||0};this._onRendered=function(){a._updateSortWithinSameData(n,s,o,i)},i.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(r,n,i){var a=[];return r.each(r.mapDimension(n.dim),function(o,s){var l=i(s);l=l??NaN,a.push({dataIndex:s,mappedValue:l,ordinalNumber:o})}),a.sort(function(o,s){return s.mappedValue-o.mappedValue}),{ordinalNumbers:Lt(a,function(o){return o.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(r,n,i){for(var a=i.scale,o=r.mapDimension(i.dim),s=Number.MAX_VALUE,l=0,u=a.getOrdinalMeta().categories.length;l<u;++l){var f=r.rawIndexOf(o,a.getRawOrdinalNumber(l)),c=f<0?Number.MIN_VALUE:n(r.indexOfRawIndex(f));if(c>s)return!0;s=c}return!1},t.prototype._isOrderDifferentInView=function(r,n){for(var i=n.scale,a=i.getExtent(),o=Math.max(0,a[0]),s=Math.min(a[1],i.getOrdinalMeta().categories.length-1);o<=s;++o)if(r.ordinalNumbers[o]!==i.getRawOrdinalNumber(o))return!0},t.prototype._updateSortWithinSameData=function(r,n,i,a){if(this._isOrderChangedWithinSameData(r,n,i)){var o=this._dataSort(r,i,n);this._isOrderDifferentInView(o,i)&&(this._removeOnRenderedListener(a),a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:o}))}},t.prototype._dispatchInitSort=function(r,n,i){var a=n.baseAxis,o=this._dataSort(r,a,function(s){return r.get(r.mapDimension(n.otherAxis.dim),s)});i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",isInitSort:!0,axisId:a.index,sortInfo:o})},t.prototype.remove=function(r,n){this._clear(this._model),this._removeOnRenderedListener(n)},t.prototype.dispose=function(r,n){this._removeOnRenderedListener(n)},t.prototype._removeOnRenderedListener=function(r){this._onRendered&&(r.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(r){var n=this.group,i=this._data;r&&r.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(a){bE(a,r,Ur(a).dataIndex)})):n.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(yl),zG={cartesian2d:function(e,t){var r=t.width<0?-1:1,n=t.height<0?-1:1;r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height);var i=e.x+e.width,a=e.y+e.height,o=wM(t.x,e.x),s=_M(t.x+t.width,i),l=wM(t.y,e.y),u=_M(t.y+t.height,a),f=s<o,c=u<l;return t.x=f&&o>i?s:o,t.y=c&&l>a?u:l,t.width=f?0:s-o,t.height=c?0:u-l,r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height),f||c},polar:function(e,t){var r=t.r0<=t.r?1:-1;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}var i=_M(t.r,e.r),a=wM(t.r0,e.r0);t.r=i,t.r0=a;var o=i-a<0;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}return o}},GG={cartesian2d:function(e,t,r,n,i,a,o,s,l){var u=new ci({shape:et({},n),z2:1});if(u.__dataIndex=r,u.name="item",a){var f=u.shape,c=i?"height":"width";f[c]=0}return u},polar:function(e,t,r,n,i,a,o,s,l){var u=!i&&l?jG:Xd,f=new u({shape:n,z2:1});f.name="item";var c=mse(i);if(f.calculateTextPosition=a2e(c,{isRoundCap:u===jG}),a){var h=f.shape,d=i?"r":"endAngle",v={};h[d]=i?n.r0:n.startAngle,v[d]=n[d],(s?ga:zo)(f,{shape:v},a)}return f}};function u2e(e,t){var r=e.get("realtimeSort",!0),n=t.getBaseAxis();if(r&&n.type==="category"&&t.type==="cartesian2d")return{baseAxis:n,otherAxis:t.getOtherAxis(n)}}function YG(e,t,r,n,i,a,o,s){var l,u;a?(u={x:n.x,width:n.width},l={y:n.y,height:n.height}):(u={y:n.y,height:n.height},l={x:n.x,width:n.width}),s||(o?ga:zo)(r,{shape:l},t,i,null);var f=t?e.baseAxis.model:null;(o?ga:zo)(r,{shape:u},f,i)}function KG(e,t){for(var r=0;r<t.length;r++)if(!isFinite(e[t[r]]))return!0;return!1}var f2e=["x","y","width","height"],c2e=["cx","cy","r","startAngle","endAngle"],XG={cartesian2d:function(e){return!KG(e,f2e)},polar:function(e){return!KG(e,c2e)}},kx={cartesian2d:function(e,t,r){var n=e.getItemLayout(t),i=r?d2e(r,n):0,a=n.width>0?1:-1,o=n.height>0?1:-1;return{x:n.x+a*i/2,y:n.y+o*i/2,width:n.width-a*i,height:n.height-o*i}},polar:function(e,t,r){var n=e.getItemLayout(t);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function h2e(e){return e.startAngle!=null&&e.endAngle!=null&&e.startAngle===e.endAngle}function mse(e){return function(t){var r=t?"Arc":"Angle";return function(n){switch(n){case"start":case"insideStart":case"end":case"insideEnd":return n+r;default:return n}}}(e)}function qG(e,t,r,n,i,a,o,s){var l=t.getItemVisual(r,"style");if(s){if(!a.get("roundCap")){var f=e.shape,c=_b(n.getModel("itemStyle"),f,!0);et(f,c),e.setShape(f)}}else{var u=n.get(["itemStyle","borderRadius"])||0;e.setShape("r",u)}e.useStyle(l);var h=n.getShallow("cursor");h&&e.attr("cursor",h);var d=s?o?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":o?i.height>=0?"bottom":"top":i.width>=0?"right":"left",v=t1(n);e1(e,v,{labelFetcher:a,labelDataIndex:r,defaultText:Y3(a.getData(),r),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var g=e.getTextContent();if(s&&g){var y=n.get(["label","position"]);e.textConfig.inside=y==="middle"?!0:null,o2e(e,y==="outside"?d:y,mse(o),n.get(["label","rotate"]))}xRe(g,v,a.getRawValue(r),function(w){return use(t,w)});var b=n.getModel(["emphasis"]);xw(e,b.get("focus"),b.get("blurScope"),b.get("disabled")),gE(e,n),h2e(i)&&(e.style.fill="none",e.style.stroke="none",ye(e.states,function(w){w.style&&(w.style.fill=w.style.stroke="none")}))}function d2e(e,t){var r=e.get(["itemStyle","borderColor"]);if(!r||r==="none")return 0;var n=e.get(["itemStyle","borderWidth"])||0,i=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),a=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(n,i,a)}var v2e=function(){function e(){}return e}(),ZG=function(e){ct(t,e);function t(r){var n=e.call(this,r)||this;return n.type="largeBar",n}return t.prototype.getDefaultShape=function(){return new v2e},t.prototype.buildPath=function(r,n){for(var i=n.points,a=this.baseDimIdx,o=1-this.baseDimIdx,s=[],l=[],u=this.barWidth,f=0;f<i.length;f+=3)l[a]=u,l[o]=i[f+2],s[a]=i[f+a],s[o]=i[f+o],r.rect(s[0],s[1],l[0],l[1])},t}(zr);function JG(e,t,r,n){var i=e.getData(),a=i.getLayout("valueAxisHorizontal")?1:0,o=i.getLayout("largeDataIndices"),s=i.getLayout("size"),l=e.getModel("backgroundStyle"),u=i.getLayout("largeBackgroundPoints");if(u){var f=new ZG({shape:{points:u},incremental:!!n,silent:!0,z2:0});f.baseDimIdx=a,f.largeDataIndices=o,f.barWidth=s,f.useStyle(l.getItemStyle()),t.add(f),r&&r.push(f)}var c=new ZG({shape:{points:i.getLayout("largePoints")},incremental:!!n,ignoreCoarsePointer:!0,z2:1});c.baseDimIdx=a,c.largeDataIndices=o,c.barWidth=s,t.add(c),c.useStyle(i.getVisual("style")),Ur(c).seriesIndex=e.seriesIndex,e.get("silent")||(c.on("mousedown",QG),c.on("mousemove",QG)),r&&r.push(c)}var QG=Pk(function(e){var t=this,r=p2e(t,e.offsetX,e.offsetY);Ur(t).dataIndex=r>=0?r:null},30,!1);function p2e(e,t,r){for(var n=e.baseDimIdx,i=1-n,a=e.shape.points,o=e.largeDataIndices,s=[],l=[],u=e.barWidth,f=0,c=a.length/3;f<c;f++){var h=f*3;if(l[n]=u,l[i]=a[h+2],s[n]=a[h+n],s[i]=a[h+i],l[i]<0&&(s[i]+=l[i],l[i]=-l[i]),t>=s[0]&&t<=s[0]+l[0]&&r>=s[1]&&r<=s[1]+l[1])return o[f]}return-1}function bse(e,t,r){if(X3(r,"cartesian2d")){var n=t,i=r.getArea();return{x:e?n.x:i.x,y:e?i.y:n.y,width:e?n.width:i.width,height:e?i.height:n.height}}else{var i=r.getArea(),a=t;return{cx:i.cx,cy:i.cy,r0:e?i.r0:a.r0,r:e?i.r:a.r,startAngle:e?a.startAngle:0,endAngle:e?a.endAngle:Math.PI*2}}}function g2e(e,t,r){var n=e.type==="polar"?Xd:ci;return new n({shape:bse(t,r,e),silent:!0,z2:0})}const y2e=l2e;function m2e(e){e.registerChartView(y2e),e.registerSeriesModel(r2e),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,Un(OIe,"bar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,EIe("bar")),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,gse("bar")),e.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,r){var n=t.componentType||"series";r.eachComponent({mainType:n,query:t},function(i){t.sortInfo&&i.axis.setCategorySortInfo(t.sortInfo)})})}var Ax=Math.PI*2,e9=Math.PI/180;function wse(e,t){return vg(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function _se(e,t){var r=wse(e,t),n=e.get("center"),i=e.get("radius");mt(i)||(i=[0,i]);var a=gn(r.width,t.getWidth()),o=gn(r.height,t.getHeight()),s=Math.min(a,o),l=gn(i[0],s/2),u=gn(i[1],s/2),f,c,h=e.coordinateSystem;if(h){var d=h.dataToPoint(n);f=d[0]||0,c=d[1]||0}else mt(n)||(n=[n,n]),f=gn(n[0],a)+r.x,c=gn(n[1],o)+r.y;return{cx:f,cy:c,r0:l,r:u}}function b2e(e,t,r){t.eachSeriesByType(e,function(n){var i=n.getData(),a=i.mapDimension("value"),o=wse(n,r),s=_se(n,r),l=s.cx,u=s.cy,f=s.r,c=s.r0,h=-n.get("startAngle")*e9,d=n.get("minAngle")*e9,v=0;i.each(a,function(F){!isNaN(F)&&v++});var g=i.getSum(a),y=Math.PI/(g||v)*2,b=n.get("clockwise"),w=n.get("roseType"),_=n.get("stillShowZeroSum"),x=i.getDataExtent(a);x[0]=0;var E=Ax,R=0,A=h,N=b?1:-1;if(i.setLayout({viewRect:o,r:f}),i.each(a,function(F,H){var W;if(isNaN(F)){i.setItemLayout(H,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:b,cx:l,cy:u,r0:c,r:w?NaN:f});return}w!=="area"?W=g===0&&_?y:F*y:W=Ax/v,W<d?(W=d,E-=d):R+=F;var z=A+N*W;i.setItemLayout(H,{angle:W,startAngle:A,endAngle:z,clockwise:b,cx:l,cy:u,r0:c,r:w?L$(F,x,[c,f]):f}),A=z}),E<Ax&&v)if(E<=.001){var I=Ax/v;i.each(a,function(F,H){if(!isNaN(F)){var W=i.getItemLayout(H);W.angle=I,W.startAngle=h+N*H*I,W.endAngle=h+N*(H+1)*I}})}else y=E/R,A=h,i.each(a,function(F,H){if(!isNaN(F)){var W=i.getItemLayout(H),z=W.angle===d?d:F*y;W.startAngle=A,W.endAngle=A+N*z,A+=N*z}})})}function w2e(e){return{seriesType:e,reset:function(t,r){var n=r.findComponents({mainType:"legend"});if(!(!n||!n.length)){var i=t.getData();i.filterSelf(function(a){for(var o=i.getName(a),s=0;s<n.length;s++)if(!n[s].isSelected(o))return!1;return!0})}}}}var _2e=Math.PI/180;function t9(e,t,r,n,i,a,o,s,l,u){if(e.length<2)return;function f(g){for(var y=g.rB,b=y*y,w=0;w<g.list.length;w++){var _=g.list[w],x=Math.abs(_.label.y-r),E=n+_.len,R=E*E,A=Math.sqrt((1-Math.abs(x*x/b))*R),N=t+(A+_.len2)*i,I=N-_.label.x,F=_.targetTextWidth-I*i;Sse(_,F,!0),_.label.x=N}}function c(g){for(var y={list:[],maxY:0},b={list:[],maxY:0},w=0;w<g.length;w++)if(g[w].labelAlignTo==="none"){var _=g[w],x=_.label.y>r?b:y,E=Math.abs(_.label.y-r);if(E>=x.maxY){var R=_.label.x-t-_.len2*i,A=n+_.len,N=Math.abs(R)<A?Math.sqrt(E*E/(1-R*R/A/A)):A;x.rB=N,x.maxY=E}x.list.push(_)}f(y),f(b)}for(var h=e.length,d=0;d<h;d++)if(e[d].position==="outer"&&e[d].labelAlignTo==="labelLine"){var v=e[d].label.x-u;e[d].linePoints[1][0]+=v,e[d].label.x=u}mMe(e,l,l+o)&&c(e)}function S2e(e,t,r,n,i,a,o,s){for(var l=[],u=[],f=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<e.length;h++){var d=e[h].label;SM(e[h])||(d.x<t?(f=Math.min(f,d.x),l.push(e[h])):(c=Math.max(c,d.x),u.push(e[h])))}for(var h=0;h<e.length;h++){var v=e[h];if(!SM(v)&&v.linePoints){if(v.labelStyleWidth!=null)continue;var d=v.label,g=v.linePoints,y=void 0;v.labelAlignTo==="edge"?d.x<t?y=g[2][0]-v.labelDistance-o-v.edgeDistance:y=o+i-v.edgeDistance-g[2][0]-v.labelDistance:v.labelAlignTo==="labelLine"?d.x<t?y=f-o-v.bleedMargin:y=o+i-c-v.bleedMargin:d.x<t?y=d.x-o-v.bleedMargin:y=o+i-d.x-v.bleedMargin,v.targetTextWidth=y,Sse(v,y)}}t9(u,t,r,n,1,i,a,o,s,c),t9(l,t,r,n,-1,i,a,o,s,f);for(var h=0;h<e.length;h++){var v=e[h];if(!SM(v)&&v.linePoints){var d=v.label,g=v.linePoints,b=v.labelAlignTo==="edge",w=d.style.padding,_=w?w[1]+w[3]:0,x=d.style.backgroundColor?0:_,E=v.rect.width+x,R=g[1][0]-g[2][0];b?d.x<t?g[2][0]=o+v.edgeDistance+E+v.labelDistance:g[2][0]=o+i-v.edgeDistance-E-v.labelDistance:(d.x<t?g[2][0]=d.x+v.labelDistance:g[2][0]=d.x-v.labelDistance,g[1][0]=g[2][0]+R),g[1][1]=g[2][1]=d.y}}}function Sse(e,t,r){if(r===void 0&&(r=!1),e.labelStyleWidth==null){var n=e.label,i=n.style,a=e.rect,o=i.backgroundColor,s=i.padding,l=s?s[1]+s[3]:0,u=i.overflow,f=a.width+(o?0:l);if(t<f||r){var c=a.height;if(u&&u.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",t-l);var h=n.getBoundingRect();n.setStyle("width",Math.ceil(h.width)),n.setStyle("backgroundColor",o)}else{var d=t-l,v=t<f?d:r?d>e.unconstrainedWidth?null:d:null;n.setStyle("width",v)}var g=n.getBoundingRect();a.width=g.width;var y=(n.style.margin||0)+2.1;a.height=g.height+y,a.y-=(a.height-c)/2}}}function SM(e){return e.position==="center"}function C2e(e){var t=e.getData(),r=[],n,i,a=!1,o=(e.get("minShowLabelAngle")||0)*_2e,s=t.getLayout("viewRect"),l=t.getLayout("r"),u=s.width,f=s.x,c=s.y,h=s.height;function d(R){R.ignore=!0}function v(R){if(!R.ignore)return!0;for(var A in R.states)if(R.states[A].ignore===!1)return!0;return!1}t.each(function(R){var A=t.getItemGraphicEl(R),N=A.shape,I=A.getTextContent(),F=A.getTextGuideLine(),H=t.getItemModel(R),W=H.getModel("label"),z=W.get("position")||H.get(["emphasis","label","position"]),te=W.get("distanceToLabelLine"),ie=W.get("alignTo"),fe=gn(W.get("edgeDistance"),u),Te=W.get("bleedMargin"),M=H.getModel("labelLine"),S=M.get("length");S=gn(S,u);var T=M.get("length2");if(T=gn(T,u),Math.abs(N.endAngle-N.startAngle)<o){ye(I.states,d),I.ignore=!0,F&&(ye(F.states,d),F.ignore=!0);return}if(v(I)){var k=(N.startAngle+N.endAngle)/2,O=Math.cos(k),D=Math.sin(k),L,B,Y,Q;n=N.cx,i=N.cy;var he=z==="inside"||z==="inner";if(z==="center")L=N.cx,B=N.cy,Q="center";else{var ce=(he?(N.r+N.r0)/2*O:N.r*O)+n,le=(he?(N.r+N.r0)/2*D:N.r*D)+i;if(L=ce+O*3,B=le+D*3,!he){var xe=ce+O*(S+l-N.r),U=le+D*(S+l-N.r),De=xe+(O<0?-1:1)*T,de=U;ie==="edge"?L=O<0?f+fe:f+u-fe:L=De+(O<0?-te:te),B=de,Y=[[ce,le],[xe,U],[De,de]]}Q=he?"center":ie==="edge"?O>0?"right":"left":O>0?"left":"right"}var He=Math.PI,Be=0,Ae=W.get("rotate");if(en(Ae))Be=Ae*(He/180);else if(z==="center")Be=0;else if(Ae==="radial"||Ae===!0){var Ke=O<0?-k+He:-k;Be=Ke}else if(Ae==="tangential"&&z!=="outside"&&z!=="outer"){var Xe=Math.atan2(O,D);Xe<0&&(Xe=He*2+Xe);var G=D>0;G&&(Xe=He+Xe),Be=Xe-He}if(a=!!Be,I.x=L,I.y=B,I.rotation=Be,I.setStyle({verticalAlign:"middle"}),he){I.setStyle({align:Q});var be=I.states.select;be&&(be.x+=I.x,be.y+=I.y)}else{var q=I.getBoundingRect().clone();q.applyTransform(I.getComputedTransform());var ae=(I.style.margin||0)+2.1;q.y-=ae/2,q.height+=ae,r.push({label:I,labelLine:F,position:z,len:S,len2:T,minTurnAngle:M.get("minTurnAngle"),maxSurfaceAngle:M.get("maxSurfaceAngle"),surfaceNormal:new Yt(O,D),linePoints:Y,textAlign:Q,labelDistance:te,labelAlignTo:ie,edgeDistance:fe,bleedMargin:Te,rect:q,unconstrainedWidth:q.width,labelStyleWidth:I.style.width})}A.setTextConfig({inside:he})}}),!a&&e.get("avoidLabelOverlap")&&S2e(r,n,i,l,u,h,f,c);for(var g=0;g<r.length;g++){var y=r[g],b=y.label,w=y.labelLine,_=isNaN(b.x)||isNaN(b.y);if(b){b.setStyle({align:y.textAlign}),_&&(ye(b.states,d),b.ignore=!0);var x=b.states.select;x&&(x.x+=b.x,x.y+=b.y)}if(w){var E=y.linePoints;_||!E?(ye(w.states,d),w.ignore=!0):(cMe(E,y.minTurnAngle),hMe(E,y.surfaceNormal,y.maxSurfaceAngle),w.setShape({points:E}),b.__hostTarget.textGuideLineConfig={anchor:new Yt(E[0][0],E[0][1])})}}}var x2e=function(e){ct(t,e);function t(r,n,i){var a=e.call(this)||this;a.z2=2;var o=new Vi;return a.setTextContent(o),a.updateData(r,n,i,!0),a}return t.prototype.updateData=function(r,n,i,a){var o=this,s=r.hostModel,l=r.getItemModel(n),u=l.getModel("emphasis"),f=r.getItemLayout(n),c=et(_b(l.getModel("itemStyle"),f,!0),f);if(isNaN(c.startAngle)){o.setShape(c);return}if(a){o.setShape(c);var h=s.getShallow("animationType");s.ecModel.ssr?(zo(o,{scaleX:0,scaleY:0},s,{dataIndex:n,isFrom:!0}),o.originX=c.cx,o.originY=c.cy):h==="scale"?(o.shape.r=f.r0,zo(o,{shape:{r:f.r}},s,n)):i!=null?(o.setShape({startAngle:i,endAngle:i}),zo(o,{shape:{startAngle:f.startAngle,endAngle:f.endAngle}},s,n)):(o.shape.endAngle=f.startAngle,ga(o,{shape:{endAngle:f.endAngle}},s,n))}else v3(o),ga(o,{shape:c},s,n);o.useStyle(r.getItemVisual(n,"style")),gE(o,l);var d=(f.startAngle+f.endAngle)/2,v=s.get("selectedOffset"),g=Math.cos(d)*v,y=Math.sin(d)*v,b=l.getShallow("cursor");b&&o.attr("cursor",b),this._updateLabel(s,r,n),o.ensureState("emphasis").shape=et({r:f.r+(u.get("scale")&&u.get("scaleSize")||0)},_b(u.getModel("itemStyle"),f)),et(o.ensureState("select"),{x:g,y,shape:_b(l.getModel(["select","itemStyle"]),f)}),et(o.ensureState("blur"),{shape:_b(l.getModel(["blur","itemStyle"]),f)});var w=o.getTextGuideLine(),_=o.getTextContent();w&&et(w.ensureState("select"),{x:g,y}),et(_.ensureState("select"),{x:g,y}),xw(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r,n,i){var a=this,o=n.getItemModel(i),s=o.getModel("labelLine"),l=n.getItemVisual(i,"style"),u=l&&l.fill,f=l&&l.opacity;e1(a,t1(o),{labelFetcher:n.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:f,defaultText:r.getFormattedLabel(i,"normal")||n.getName(i)});var c=a.getTextContent();a.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var h=r.get(["label","position"]);if(h!=="outside"&&h!=="outer")a.removeTextGuideLine();else{var d=this.getTextGuideLine();d||(d=new gk,this.setTextGuideLine(d)),vMe(this,pMe(o),{stroke:u,opacity:Mb(s.get(["lineStyle","opacity"]),f,1)})}},t}(Xd),T2e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,n,i,a){var o=r.getData(),s=this._data,l=this.group,u;if(!s&&o.count()>0){for(var f=o.getItemLayout(0),c=1;isNaN(f&&f.startAngle)&&c<o.count();++c)f=o.getItemLayout(c);f&&(u=f.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),o.count()===0&&r.get("showEmptyCircle")){var h=new Xd({shape:_se(r,i)});h.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=h,l.add(h)}o.diff(s).add(function(d){var v=new x2e(o,d,u);o.setItemGraphicEl(d,v),l.add(v)}).update(function(d,v){var g=s.getItemGraphicEl(v);g.updateData(o,d,u),g.off("click"),l.add(g),o.setItemGraphicEl(d,g)}).remove(function(d){var v=s.getItemGraphicEl(d);bE(v,r,d)}).execute(),C2e(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=o)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var o=r[0]-a.cx,s=r[1]-a.cy,l=Math.sqrt(o*o+s*s);return l<=a.r&&l>=a.r0}},t.type="pie",t}(yl);const O2e=T2e;function E2e(e,t,r){t=mt(t)&&{coordDimensions:t}||et({encodeDefine:e.getEncode()},t);var n=e.getSource(),i=Woe(n,t).dimensions,a=new Boe(i,e);return a.initData(n,r),a}var R2e=function(){function e(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return e.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},e.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},e.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},e.prototype.getItemVisual=function(t,r){var n=this._getDataWithEncodedVisual();return n.getItemVisual(t,r)},e}();const k2e=R2e;var A2e=ti(),P2e=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new k2e(un(this.getData,this),un(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return E2e(this,{coordDimensions:["value"],encodeDefaulter:Un(JRe,this)})},t.prototype.getDataParams=function(r){var n=this.getData(),i=A2e(n),a=i.seats;if(!a){var o=[];n.each(n.mapDimension("value"),function(l){o.push(l)}),a=i.seats=$Te(o,n.hostModel.get("percentPrecision"))}var s=e.prototype.getDataParams.call(this,r);return s.percent=a[r]||0,s.$vars.push("percent"),s},t.prototype._defaultLabelLine=function(r){F$(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(Cc);const I2e=P2e;function M2e(e){return{seriesType:e,reset:function(t,r){var n=t.getData();n.filterSelf(function(i){var a=n.mapDimension("value"),o=n.get(a,i);return!(en(o)&&!isNaN(o)&&o<0)})}}}function D2e(e){e.registerChartView(O2e),e.registerSeriesModel(I2e),HAe("pie",e.registerAction),e.registerLayout(Un(b2e,"pie")),e.registerProcessor(w2e("pie")),e.registerProcessor(M2e("pie"))}var $2e=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}(vn);const N2e=$2e;var vN=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",Os).models[0]},t.type="cartesian2dAxis",t}(vn);Sl(vN,JIe);var Cse={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},L2e=Hr({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},Cse),q3=Hr({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},Cse),F2e=Hr({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},q3),H2e=Vr({logBase:10},q3);const B2e={category:L2e,value:q3,time:F2e,log:H2e};var W2e={value:1,category:1,time:1,log:1};function r9(e,t,r,n){ye(W2e,function(i,a){var o=Hr(Hr({},B2e[a],!0),n,!0),s=function(l){ct(u,l);function u(){var f=l!==null&&l.apply(this,arguments)||this;return f.type=t+"Axis."+a,f}return u.prototype.mergeDefaultAndTheme=function(f,c){var h=Rw(this),d=h?Ek(f):{},v=c.getTheme();Hr(f,v.get(a+"Axis")),Hr(f,this.getDefaultOption()),f.type=n9(f),h&&pg(f,d,h)},u.prototype.optionUpdated=function(){var f=this.option;f.type==="category"&&(this.__ordinalMeta=cN.createByAxisModel(this))},u.prototype.getCategories=function(f){var c=this.option;if(c.type==="category")return f?c.data:this.__ordinalMeta.categories},u.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},u.type=t+"Axis."+a,u.defaultOption=o,u}(r);e.registerComponentModel(s)}),e.registerSubTypeDefaulter(t+"Axis",n9)}function n9(e){return e.type||(e.data?"category":"value")}var V2e=function(){function e(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return e.prototype.getAxis=function(t){return this._axes[t]},e.prototype.getAxes=function(){return Lt(this._dimList,function(t){return this._axes[t]},this)},e.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),ua(this.getAxes(),function(r){return r.scale.type===t})},e.prototype.addAxis=function(t){var r=t.dim;this._axes[r]=t,this._dimList.push(r)},e}();const U2e=V2e;var pN=["x","y"];function i9(e){return e.type==="interval"||e.type==="time"}var j2e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cartesian2d",r.dimensions=pN,r}return t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var r=this.getAxis("x").scale,n=this.getAxis("y").scale;if(!(!i9(r)||!i9(n))){var i=r.getExtent(),a=n.getExtent(),o=this.dataToPoint([i[0],a[0]]),s=this.dataToPoint([i[1],a[1]]),l=i[1]-i[0],u=a[1]-a[0];if(!(!l||!u)){var f=(s[0]-o[0])/l,c=(s[1]-o[1])/u,h=o[0]-i[0]*f,d=o[1]-a[0]*c,v=this._transform=[f,0,0,c,h,d];this._invTransform=ZB([],v)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(r){var n=this.getAxis("x"),i=this.getAxis("y");return n.contain(n.toLocalCoord(r[0]))&&i.contain(i.toLocalCoord(r[1]))},t.prototype.containData=function(r){return this.getAxis("x").containData(r[0])&&this.getAxis("y").containData(r[1])},t.prototype.containZone=function(r,n){var i=this.dataToPoint(r),a=this.dataToPoint(n),o=this.getArea(),s=new Br(i[0],i[1],a[0]-i[0],a[1]-i[1]);return o.intersect(s)},t.prototype.dataToPoint=function(r,n,i){i=i||[];var a=r[0],o=r[1];if(this._transform&&a!=null&&isFinite(a)&&o!=null&&isFinite(o))return jo(i,r,this._transform);var s=this.getAxis("x"),l=this.getAxis("y");return i[0]=s.toGlobalCoord(s.dataToCoord(a,n)),i[1]=l.toGlobalCoord(l.dataToCoord(o,n)),i},t.prototype.clampData=function(r,n){var i=this.getAxis("x").scale,a=this.getAxis("y").scale,o=i.getExtent(),s=a.getExtent(),l=i.parse(r[0]),u=a.parse(r[1]);return n=n||[],n[0]=Math.min(Math.max(Math.min(o[0],o[1]),l),Math.max(o[0],o[1])),n[1]=Math.min(Math.max(Math.min(s[0],s[1]),u),Math.max(s[0],s[1])),n},t.prototype.pointToData=function(r,n){var i=[];if(this._invTransform)return jo(i,r,this._invTransform);var a=this.getAxis("x"),o=this.getAxis("y");return i[0]=a.coordToData(a.toLocalCoord(r[0]),n),i[1]=o.coordToData(o.toLocalCoord(r[1]),n),i},t.prototype.getOtherAxis=function(r){return this.getAxis(r.dim==="x"?"y":"x")},t.prototype.getArea=function(){var r=this.getAxis("x").getGlobalExtent(),n=this.getAxis("y").getGlobalExtent(),i=Math.min(r[0],r[1]),a=Math.min(n[0],n[1]),o=Math.max(r[0],r[1])-i,s=Math.max(n[0],n[1])-a;return new Br(i,a,o,s)},t}(U2e),z2e=function(e){ct(t,e);function t(r,n,i,a,o){var s=e.call(this,r,n,i)||this;return s.index=0,s.type=a||"value",s.position=o||"bottom",s}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.getGlobalExtent=function(r){var n=this.getExtent();return n[0]=this.toGlobalCoord(n[0]),n[1]=this.toGlobalCoord(n[1]),r&&n[0]>n[1]&&n.reverse(),n},t.prototype.pointToData=function(r,n){return this.coordToData(this.toLocalCoord(r[this.dim==="x"?0:1]),n)},t.prototype.setCategorySortInfo=function(r){if(this.type!=="category")return!1;this.model.option.categorySortInfo=r,this.scale.setSortInfo(r)},t}(fMe);const G2e=z2e;function gN(e,t,r){r=r||{};var n=e.coordinateSystem,i=t.axis,a={},o=i.getAxesOnZeroOf()[0],s=i.position,l=o?"onZero":s,u=i.dim,f=n.getRect(),c=[f.x,f.x+f.width,f.y,f.y+f.height],h={left:0,right:1,top:0,bottom:1,onZero:2},d=t.get("offset")||0,v=u==="x"?[c[2]-d,c[3]+d]:[c[0]-d,c[1]+d];if(o){var g=o.toGlobalCoord(o.dataToCoord(0));v[h.onZero]=Math.max(Math.min(g,v[1]),v[0])}a.position=[u==="y"?v[h[l]]:c[0],u==="x"?v[h[l]]:c[3]],a.rotation=Math.PI/2*(u==="x"?0:1);var y={top:-1,bottom:1,left:-1,right:1};a.labelDirection=a.tickDirection=a.nameDirection=y[s],a.labelOffset=o?v[h[s]]-v[h.onZero]:0,t.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),bw(r.labelInside,t.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var b=t.get(["axisLabel","rotate"]);return a.labelRotate=l==="top"?-b:b,a.z2=1,a}function a9(e){return e.get("coordinateSystem")==="cartesian2d"}function o9(e){var t={xAxisModel:null,yAxisModel:null};return ye(t,function(r,n){var i=n.replace(/Model$/,""),a=e.getReferringComponents(i,Os).models[0];t[n]=a}),t}var CM=Math.log;function Y2e(e,t,r){var n=r1.prototype,i=n.getTicks.call(r),a=n.getTicks.call(r,!0),o=i.length-1,s=n.getInterval.call(r),l=ese(e,t),u=l.extent,f=l.fixMin,c=l.fixMax;if(e.type==="log"){var h=CM(e.base);u=[CM(u[0])/h,CM(u[1])/h]}e.setExtent(u[0],u[1]),e.calcNiceExtent({splitNumber:o,fixMin:f,fixMax:c});var d=n.getExtent.call(e);f&&(u[0]=d[0]),c&&(u[1]=d[1]);var v=n.getInterval.call(e),g=u[0],y=u[1];if(f&&c)v=(y-g)/o;else if(f)for(y=u[0]+v*o;y<u[1]&&isFinite(y)&&isFinite(u[1]);)v=gM(v),y=u[0]+v*o;else if(c)for(g=u[1]-v*o;g>u[0]&&isFinite(g)&&isFinite(u[0]);)v=gM(v),g=u[1]-v*o;else{var b=e.getTicks().length-1;b>o&&(v=gM(v));var w=v*o;y=Math.ceil(u[1]/v)*v,g=Qn(y-w),g<0&&u[0]>=0?(g=0,y=Qn(w)):y>0&&u[1]<=0&&(y=0,g=-Qn(w))}var _=(i[0].value-a[0].value)/s,x=(i[o].value-a[o].value)/s;n.setExtent.call(e,g+v*_,y+v*x),n.setInterval.call(e,v),(_||x)&&n.setNiceExtent.call(e,g+v,y-v)}var K2e=function(){function e(t,r,n){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=pN,this._initCartesian(t,r,n),this.model=t}return e.prototype.getRect=function(){return this._rect},e.prototype.update=function(t,r){var n=this._axesMap;this._updateScale(t,this.model);function i(o){var s,l=yn(o),u=l.length;if(u){for(var f=[],c=u-1;c>=0;c--){var h=+l[c],d=o[h],v=d.model,g=d.scale;hN(g)&&v.get("alignTicks")&&v.get("interval")==null?f.push(d):(kG(g,v),hN(g)&&(s=d))}f.length&&(s||(s=f.pop(),kG(s.scale,s.model)),ye(f,function(y){Y2e(y.scale,y.model,s.scale)}))}}i(n.x),i(n.y);var a={};ye(n.x,function(o){s9(n,"y",o,a)}),ye(n.y,function(o){s9(n,"x",o,a)}),this.resize(this.model,r)},e.prototype.resize=function(t,r,n){var i=t.getBoxLayoutParams(),a=!n&&t.get("containLabel"),o=vg(i,{width:r.getWidth(),height:r.getHeight()});this._rect=o;var s=this._axesList;l(),a&&(ye(s,function(u){if(!u.model.get(["axisLabel","inside"])){var f=XIe(u);if(f){var c=u.isHorizontal()?"height":"width",h=u.model.get(["axisLabel","margin"]);o[c]-=f[c]+h,u.position==="top"?o.y+=f.height+h:u.position==="left"&&(o.x+=f.width+h)}}}),l()),ye(this._coordsList,function(u){u.calcAffineTransform()});function l(){ye(s,function(u){var f=u.isHorizontal(),c=f?[0,o.width]:[0,o.height],h=u.inverse?1:0;u.setExtent(c[h],c[1-h]),X2e(u,f?o.x:o.y)})}},e.prototype.getAxis=function(t,r){var n=this._axesMap[t];if(n!=null)return n[r||0]},e.prototype.getAxes=function(){return this._axesList.slice()},e.prototype.getCartesian=function(t,r){if(t!=null&&r!=null){var n="x"+t+"y"+r;return this._coordsMap[n]}$t(t)&&(r=t.yAxisIndex,t=t.xAxisIndex);for(var i=0,a=this._coordsList;i<a.length;i++)if(a[i].getAxis("x").index===t||a[i].getAxis("y").index===r)return a[i]},e.prototype.getCartesians=function(){return this._coordsList.slice()},e.prototype.convertToPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},e.prototype.convertFromPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},e.prototype._findConvertTarget=function(t){var r=t.seriesModel,n=t.xAxisModel||r&&r.getReferringComponents("xAxis",Os).models[0],i=t.yAxisModel||r&&r.getReferringComponents("yAxis",Os).models[0],a=t.gridModel,o=this._coordsList,s,l;if(r)s=r.coordinateSystem,Xr(o,s)<0&&(s=null);else if(n&&i)s=this.getCartesian(n.componentIndex,i.componentIndex);else if(n)l=this.getAxis("x",n.componentIndex);else if(i)l=this.getAxis("y",i.componentIndex);else if(a){var u=a.coordinateSystem;u===this&&(s=this._coordsList[0])}return{cartesian:s,axis:l}},e.prototype.containPoint=function(t){var r=this._coordsList[0];if(r)return r.containPoint(t)},e.prototype._initCartesian=function(t,r,n){var i=this,a=this,o={left:!1,right:!1,top:!1,bottom:!1},s={x:{},y:{}},l={x:0,y:0};if(r.eachComponent("xAxis",u("x"),this),r.eachComponent("yAxis",u("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=s,ye(s.x,function(f,c){ye(s.y,function(h,d){var v="x"+c+"y"+d,g=new j2e(v);g.master=i,g.model=t,i._coordsMap[v]=g,i._coordsList.push(g),g.addAxis(f),g.addAxis(h)})});function u(f){return function(c,h){if(xM(c,t)){var d=c.get("position");f==="x"?d!=="top"&&d!=="bottom"&&(d=o.bottom?"top":"bottom"):d!=="left"&&d!=="right"&&(d=o.left?"right":"left"),o[d]=!0;var v=new G2e(f,YIe(c),[0,0],c.get("type"),d),g=v.type==="category";v.onBand=g&&c.get("boundaryGap"),v.inverse=c.get("inverse"),c.axis=v,v.model=c,v.grid=a,v.index=h,a._axesList.push(v),s[f][h]=v,l[f]++}}}},e.prototype._updateScale=function(t,r){ye(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var a=i.model.get("categorySortInfo");i.scale.setSortInfo(a)}}),t.eachSeries(function(i){if(a9(i)){var a=o9(i),o=a.xAxisModel,s=a.yAxisModel;if(!xM(o,r)||!xM(s,r))return;var l=this.getCartesian(o.componentIndex,s.componentIndex),u=i.getData(),f=l.getAxis("x"),c=l.getAxis("y");n(u,f),n(u,c)}},this);function n(i,a){ye(ZIe(i,a.dim),function(o){a.scale.unionExtentFromData(i,o)})}},e.prototype.getTooltipAxes=function(t){var r=[],n=[];return ye(this.getCartesians(),function(i){var a=t!=null&&t!=="auto"?i.getAxis(t):i.getBaseAxis(),o=i.getOtherAxis(a);Xr(r,a)<0&&r.push(a),Xr(n,o)<0&&n.push(o)}),{baseAxes:r,otherAxes:n}},e.create=function(t,r){var n=[];return t.eachComponent("grid",function(i,a){var o=new e(i,t,r);o.name="grid_"+a,o.resize(i,r,!0),i.coordinateSystem=o,n.push(o)}),t.eachSeries(function(i){if(a9(i)){var a=o9(i),o=a.xAxisModel,s=a.yAxisModel,l=o.getCoordSysModel(),u=l.coordinateSystem;i.coordinateSystem=u.getCartesian(o.componentIndex,s.componentIndex)}}),n},e.dimensions=pN,e}();function xM(e,t){return e.getCoordSysModel()===t}function s9(e,t,r,n){r.getAxesOnZeroOf=function(){return a?[a]:[]};var i=e[t],a,o=r.model,s=o.get(["axisLine","onZero"]),l=o.get(["axisLine","onZeroAxisIndex"]);if(!s)return;if(l!=null)l9(i[l])&&(a=i[l]);else for(var u in i)if(i.hasOwnProperty(u)&&l9(i[u])&&!n[f(i[u])]){a=i[u];break}a&&(n[f(a)]=!0);function f(c){return c.dim+"_"+c.index}}function l9(e){return e&&e.type!=="category"&&e.type!=="time"&&KIe(e)}function X2e(e,t){var r=e.getExtent(),n=r[0]+r[1];e.toGlobalCoord=e.dim==="x"?function(i){return i+t}:function(i){return n-i+t},e.toLocalCoord=e.dim==="x"?function(i){return i-t}:function(i){return n-i+t}}const q2e=K2e;var Gf=Math.PI,bd=function(){function e(t,r){this.group=new Wi,this.opt=r,this.axisModel=t,Vr(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var n=new Wi({x:r.position[0],y:r.position[1],rotation:r.rotation});n.updateTransform(),this._transformGroup=n}return e.prototype.hasBuilder=function(t){return!!u9[t]},e.prototype.add=function(t){u9[t](this.opt,this.axisModel,this.group,this._transformGroup)},e.prototype.getGroup=function(){return this.group},e.innerTextLayout=function(t,r,n){var i=die(r-t),a,o;return cE(i)?(o=n>0?"top":"bottom",a="center"):cE(i-Gf)?(o=n>0?"bottom":"top",a="center"):(o="middle",i>0&&i<Gf?a=n>0?"right":"left":a=n>0?"left":"right"),{rotation:i,textAlign:a,textVerticalAlign:o}},e.makeAxisEventDataBase=function(t){var r={componentType:t.mainType,componentIndex:t.componentIndex};return r[t.mainType+"Index"]=t.componentIndex,r},e.isLabelSilent=function(t){var r=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||r&&r.show)},e}(),u9={axisLine:function(e,t,r,n){var i=t.get(["axisLine","show"]);if(i==="auto"&&e.handleAutoShown&&(i=e.handleAutoShown("axisLine")),!!i){var a=t.axis.getExtent(),o=n.transform,s=[a[0],0],l=[a[1],0],u=s[0]>l[0];o&&(jo(s,s,o),jo(l,l,o));var f=et({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),c=new Rd({shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:f,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1});Tw(c.shape,c.style.lineWidth),c.anid="line",r.add(c);var h=t.get(["axisLine","symbol"]);if(h!=null){var d=t.get(["axisLine","symbolSize"]);Rt(h)&&(h=[h,h]),(Rt(d)||en(d))&&(d=[d,d]);var v=hoe(t.get(["axisLine","symbolOffset"])||0,d),g=d[0],y=d[1];ye([{rotate:e.rotation+Math.PI/2,offset:v[0],r:0},{rotate:e.rotation-Math.PI/2,offset:v[1],r:Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1]))}],function(b,w){if(h[w]!=="none"&&h[w]!=null){var _=yg(h[w],-g/2,-y/2,g,y,f.stroke,!0),x=b.r+b.offset,E=u?l:s;_.attr({rotation:b.rotate,x:E[0]+x*Math.cos(e.rotation),y:E[1]-x*Math.sin(e.rotation),silent:!0,z2:11}),r.add(_)}})}}},axisTickLabel:function(e,t,r,n){var i=Q2e(r,n,t,e),a=tDe(r,n,t,e);if(J2e(t,a,i),eDe(r,n,t,e.tickDirection),t.get(["axisLabel","hideOverlap"])){var o=gMe(Lt(a,function(s){return{label:s,priority:s.z2,defaultAttr:{ignore:s.ignore}}}));bMe(o)}},axisName:function(e,t,r,n){var i=bw(e.axisName,t.get("name"));if(i){var a=t.get("nameLocation"),o=e.nameDirection,s=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,u=t.axis.getExtent(),f=u[0]>u[1]?-1:1,c=[a==="start"?u[0]-f*l:a==="end"?u[1]+f*l:(u[0]+u[1])/2,c9(a)?e.labelOffset+o*l:0],h,d=t.get("nameRotate");d!=null&&(d=d*Gf/180);var v;c9(a)?h=bd.innerTextLayout(e.rotation,d??e.rotation,o):(h=Z2e(e.rotation,a,d||0,u),v=e.axisNameAvailableWidth,v!=null&&(v=Math.abs(v/Math.sin(h.rotation)),!isFinite(v)&&(v=null)));var g=s.getFont(),y=t.get("nameTruncate",!0)||{},b=y.ellipsis,w=bw(e.nameTruncateMaxWidth,y.maxWidth,v),_=new Vi({x:c[0],y:c[1],rotation:h.rotation,silent:bd.isLabelSilent(t),style:Sc(s,{text:i,font:g,overflow:"truncate",width:w,ellipsis:b,fill:s.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:s.get("align")||h.textAlign,verticalAlign:s.get("verticalAlign")||h.textVerticalAlign}),z2:1});if(m3({el:_,componentModel:t,itemName:i}),_.__fullText=i,_.anid="name",t.get("triggerEvent")){var x=bd.makeAxisEventDataBase(t);x.targetType="axisName",x.name=i,Ur(_).eventData=x}n.add(_),_.updateTransform(),r.add(_),_.decomposeTransform()}}};function Z2e(e,t,r,n){var i=die(r-e),a,o,s=n[0]>n[1],l=t==="start"&&!s||t!=="start"&&s;return cE(i-Gf/2)?(o=l?"bottom":"top",a="center"):cE(i-Gf*1.5)?(o=l?"top":"bottom",a="center"):(o="middle",i<Gf*1.5&&i>Gf/2?a=l?"left":"right":a=l?"right":"left"),{rotation:i,textAlign:a,textVerticalAlign:o}}function J2e(e,t,r){if(!tse(e.axis)){var n=e.get(["axisLabel","showMinLabel"]),i=e.get(["axisLabel","showMaxLabel"]);t=t||[],r=r||[];var a=t[0],o=t[1],s=t[t.length-1],l=t[t.length-2],u=r[0],f=r[1],c=r[r.length-1],h=r[r.length-2];n===!1?(xo(a),xo(u)):f9(a,o)&&(n?(xo(o),xo(f)):(xo(a),xo(u))),i===!1?(xo(s),xo(c)):f9(l,s)&&(i?(xo(l),xo(h)):(xo(s),xo(c)))}}function xo(e){e&&(e.ignore=!0)}function f9(e,t){var r=e&&e.getBoundingRect().clone(),n=t&&t.getBoundingRect().clone();if(!(!r||!n)){var i=XB([]);return qB(i,i,-e.rotation),r.applyTransform(jp([],i,e.getLocalTransform())),n.applyTransform(jp([],i,t.getLocalTransform())),r.intersect(n)}}function c9(e){return e==="middle"||e==="center"}function xse(e,t,r,n,i){for(var a=[],o=[],s=[],l=0;l<e.length;l++){var u=e[l].coord;o[0]=u,o[1]=0,s[0]=u,s[1]=r,t&&(jo(o,o,t),jo(s,s,t));var f=new Rd({shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:n,z2:2,autoBatch:!0,silent:!0});Tw(f.shape,f.style.lineWidth),f.anid=i+"_"+e[l].tickValue,a.push(f)}return a}function Q2e(e,t,r,n){var i=r.axis,a=r.getModel("axisTick"),o=a.get("show");if(o==="auto"&&n.handleAutoShown&&(o=n.handleAutoShown("axisTick")),!(!o||i.scale.isBlank())){for(var s=a.getModel("lineStyle"),l=n.tickDirection*a.get("length"),u=i.getTicksCoords(),f=xse(u,t.transform,l,Vr(s.getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])}),"ticks"),c=0;c<f.length;c++)e.add(f[c]);return f}}function eDe(e,t,r,n){var i=r.axis,a=r.getModel("minorTick");if(!(!a.get("show")||i.scale.isBlank())){var o=i.getMinorTicksCoords();if(o.length)for(var s=a.getModel("lineStyle"),l=n*a.get("length"),u=Vr(s.getLineStyle(),Vr(r.getModel("axisTick").getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])})),f=0;f<o.length;f++)for(var c=xse(o[f],t.transform,l,u,"minorticks_"+f),h=0;h<c.length;h++)e.add(c[h])}}function tDe(e,t,r,n){var i=r.axis,a=bw(n.axisLabelShow,r.get(["axisLabel","show"]));if(!(!a||i.scale.isBlank())){var o=r.getModel("axisLabel"),s=o.get("margin"),l=i.getViewLabels(),u=(bw(n.labelRotate,o.get("rotate"))||0)*Gf/180,f=bd.innerTextLayout(n.rotation,u,n.labelDirection),c=r.getCategories&&r.getCategories(!0),h=[],d=bd.isLabelSilent(r),v=r.get("triggerEvent");return ye(l,function(g,y){var b=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(g.tickValue):g.tickValue,w=g.formattedLabel,_=g.rawLabel,x=o;if(c&&c[b]){var E=c[b];$t(E)&&E.textStyle&&(x=new Li(E.textStyle,o,r.ecModel))}var R=x.getTextColor()||r.get(["axisLine","lineStyle","color"]),A=i.dataToCoord(b),N=new Vi({x:A,y:n.labelOffset+n.labelDirection*s,rotation:f.rotation,silent:d,z2:10+(g.level||0),style:Sc(x,{text:w,align:x.getShallow("align",!0)||f.textAlign,verticalAlign:x.getShallow("verticalAlign",!0)||x.getShallow("baseline",!0)||f.textVerticalAlign,fill:lr(R)?R(i.type==="category"?_:i.type==="value"?b+"":b,y):R})});if(N.anid="label_"+b,v){var I=bd.makeAxisEventDataBase(r);I.targetType="axisLabel",I.value=_,I.tickIndex=y,i.type==="category"&&(I.dataIndex=b),Ur(N).eventData=I}t.add(N),N.updateTransform(),h.push(N),e.add(N),N.decomposeTransform()}),h}}const Tse=bd;function rDe(e,t){var r={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return nDe(r,e,t),r.seriesInvolved&&aDe(r,e),r}function nDe(e,t,r){var n=t.getComponent("tooltip"),i=t.getComponent("axisPointer"),a=i.get("link",!0)||[],o=[];ye(r.getCoordinateSystems(),function(s){if(!s.axisPointerEnabled)return;var l=Dw(s.model),u=e.coordSysAxesInfo[l]={};e.coordSysMap[l]=s;var f=s.model,c=f.getModel("tooltip",n);if(ye(s.getAxes(),Un(g,!1,null)),s.getTooltipAxes&&n&&c.get("show")){var h=c.get("trigger")==="axis",d=c.get(["axisPointer","type"])==="cross",v=s.getTooltipAxes(c.get(["axisPointer","axis"]));(h||d)&&ye(v.baseAxes,Un(g,d?"cross":!0,h)),d&&ye(v.otherAxes,Un(g,"cross",!1))}function g(y,b,w){var _=w.model.getModel("axisPointer",i),x=_.get("show");if(!(!x||x==="auto"&&!y&&!yN(_))){b==null&&(b=_.get("triggerTooltip")),_=y?iDe(w,c,i,t,y,b):_;var E=_.get("snap"),R=Dw(w.model),A=b||E||w.type==="category",N=e.axesInfo[R]={key:R,axis:w,coordSys:s,axisPointerModel:_,triggerTooltip:b,involveSeries:A,snap:E,useHandle:yN(_),seriesModels:[],linkGroup:null};u[R]=N,e.seriesInvolved=e.seriesInvolved||A;var I=oDe(a,w);if(I!=null){var F=o[I]||(o[I]={axesInfo:{}});F.axesInfo[R]=N,F.mapper=a[I].mapper,N.linkGroup=F}}}})}function iDe(e,t,r,n,i,a){var o=t.getModel("axisPointer"),s=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};ye(s,function(h){l[h]=Rr(o.get(h))}),l.snap=e.type!=="category"&&!!a,o.get("type")==="cross"&&(l.type="line");var u=l.label||(l.label={});if(u.show==null&&(u.show=!1),i==="cross"){var f=o.get(["label","show"]);if(u.show=f??!0,!a){var c=l.lineStyle=o.get("crossStyle");c&&Vr(u,c.textStyle)}}return e.model.getModel("axisPointer",new Li(l,r,n))}function aDe(e,t){t.eachSeries(function(r){var n=r.coordinateSystem,i=r.get(["tooltip","trigger"],!0),a=r.get(["tooltip","show"],!0);!n||i==="none"||i===!1||i==="item"||a===!1||r.get(["axisPointer","show"],!0)===!1||ye(e.coordSysAxesInfo[Dw(n.model)],function(o){var s=o.axis;n.getAxis(s.dim)===s&&(o.seriesModels.push(r),o.seriesDataCount==null&&(o.seriesDataCount=0),o.seriesDataCount+=r.getData().count())})})}function oDe(e,t){for(var r=t.model,n=t.dim,i=0;i<e.length;i++){var a=e[i]||{};if(TM(a[n+"AxisId"],r.id)||TM(a[n+"AxisIndex"],r.componentIndex)||TM(a[n+"AxisName"],r.name))return i}}function TM(e,t){return e==="all"||mt(e)&&Xr(e,t)>=0||e===t}function sDe(e){var t=Z3(e);if(t){var r=t.axisPointerModel,n=t.axis.scale,i=r.option,a=r.get("status"),o=r.get("value");o!=null&&(o=n.parse(o));var s=yN(r);a==null&&(i.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(o==null||o>l[1])&&(o=l[1]),o<l[0]&&(o=l[0]),i.value=o,s&&(i.status=t.axis.scale.isBlank()?"hide":"show")}}function Z3(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[Dw(e)]}function lDe(e){var t=Z3(e);return t&&t.axisPointerModel}function yN(e){return!!e.get(["handle","show"])}function Dw(e){return e.type+"||"+e.id}var h9={},uDe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){this.axisPointerClass&&sDe(r),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(r,i,!0)},t.prototype.updateAxisPointer=function(r,n,i,a){this._doUpdateAxisPointerClass(r,i,!1)},t.prototype.remove=function(r,n){var i=this._axisPointer;i&&i.remove(n)},t.prototype.dispose=function(r,n){this._disposeAxisPointer(n),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(r,n,i){var a=t.getAxisPointerClass(this.axisPointerClass);if(a){var o=lDe(r);o?(this._axisPointer||(this._axisPointer=new a)).render(r,o,n,i):this._disposeAxisPointer(n)}},t.prototype._disposeAxisPointer=function(r){this._axisPointer&&this._axisPointer.dispose(r),this._axisPointer=null},t.registerAxisPointerClass=function(r,n){h9[r]=n},t.getAxisPointerClass=function(r){return r&&h9[r]},t.type="axis",t}(Vu);const Ose=uDe;var mN=ti();function fDe(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitArea"),o=a.getModel("areaStyle"),s=o.get("color"),l=n.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:a,clamp:!0});if(u.length){var f=s.length,c=mN(e).splitAreaColors,h=pr(),d=0;if(c)for(var v=0;v<u.length;v++){var g=c.get(u[v].tickValue);if(g!=null){d=(g+(f-1)*v)%f;break}}var y=i.toGlobalCoord(u[0].coord),b=o.getAreaStyle();s=mt(s)?s:[s];for(var v=1;v<u.length;v++){var w=i.toGlobalCoord(u[v].coord),_=void 0,x=void 0,E=void 0,R=void 0;i.isHorizontal()?(_=y,x=l.y,E=w-_,R=l.height,y=_+E):(_=l.x,x=y,E=l.width,R=w-x,y=x+R);var A=u[v-1].tickValue;A!=null&&h.set(A,d),t.add(new ci({anid:A!=null?"area_"+A:null,shape:{x:_,y:x,width:E,height:R},style:Vr({fill:s[d]},b),autoBatch:!0,silent:!0})),d=(d+1)%f}mN(e).splitAreaColors=h}}}function cDe(e){mN(e).splitAreaColors=null}var hDe=["axisLine","axisTickLabel","axisName"],dDe=["splitArea","splitLine","minorSplitLine"],Ese=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="CartesianAxisPointer",r}return t.prototype.render=function(r,n,i,a){this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new Wi,this.group.add(this._axisGroup),!!r.get("show")){var s=r.getCoordSysModel(),l=gN(s,r),u=new Tse(r,et({handleAutoShown:function(c){for(var h=s.coordinateSystem.getCartesians(),d=0;d<h.length;d++)if(hN(h[d].getOtherAxis(r.axis).scale))return!0;return!1}},l));ye(hDe,u.add,u),this._axisGroup.add(u.getGroup()),ye(dDe,function(c){r.get([c,"show"])&&vDe[c](this,this._axisGroup,r,s)},this);var f=a&&a.type==="changeAxisOrder"&&a.isInitSort;f||dae(o,this._axisGroup,r),e.prototype.render.call(this,r,n,i,a)}},t.prototype.remove=function(){cDe(this)},t.type="cartesianAxis",t}(Ose),vDe={splitLine:function(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitLine"),o=a.getModel("lineStyle"),s=o.get("color");s=mt(s)?s:[s];for(var l=n.coordinateSystem.getRect(),u=i.isHorizontal(),f=0,c=i.getTicksCoords({tickModel:a}),h=[],d=[],v=o.getLineStyle(),g=0;g<c.length;g++){var y=i.toGlobalCoord(c[g].coord);u?(h[0]=y,h[1]=l.y,d[0]=y,d[1]=l.y+l.height):(h[0]=l.x,h[1]=y,d[0]=l.x+l.width,d[1]=y);var b=f++%s.length,w=c[g].tickValue,_=new Rd({anid:w!=null?"line_"+c[g].tickValue:null,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:d[0],y2:d[1]},style:Vr({stroke:s[b]},v),silent:!0});Tw(_.shape,v.lineWidth),t.add(_)}}},minorSplitLine:function(e,t,r,n){var i=r.axis,a=r.getModel("minorSplitLine"),o=a.getModel("lineStyle"),s=n.coordinateSystem.getRect(),l=i.isHorizontal(),u=i.getMinorTicksCoords();if(u.length)for(var f=[],c=[],h=o.getLineStyle(),d=0;d<u.length;d++)for(var v=0;v<u[d].length;v++){var g=i.toGlobalCoord(u[d][v].coord);l?(f[0]=g,f[1]=s.y,c[0]=g,c[1]=s.y+s.height):(f[0]=s.x,f[1]=g,c[0]=s.x+s.width,c[1]=g);var y=new Rd({anid:"minor_line_"+u[d][v].tickValue,autoBatch:!0,shape:{x1:f[0],y1:f[1],x2:c[0],y2:c[1]},style:h,silent:!0});Tw(y.shape,h.lineWidth),t.add(y)}},splitArea:function(e,t,r,n){fDe(e,t,r,n)}},Rse=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="xAxis",t}(Ese),pDe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=Rse.type,r}return t.type="yAxis",t}(Ese),gDe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="grid",r}return t.prototype.render=function(r,n){this.group.removeAll(),r.get("show")&&this.group.add(new ci({shape:r.coordinateSystem.getRect(),style:Vr({fill:r.get("backgroundColor")},r.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(Vu),d9={offset:0};function yDe(e){e.registerComponentView(gDe),e.registerComponentModel(N2e),e.registerCoordinateSystem("cartesian2d",q2e),r9(e,"x",vN,d9),r9(e,"y",vN,d9),e.registerComponentView(Rse),e.registerComponentView(pDe),e.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}var Dh=ti(),v9=Rr,OM=un,mDe=function(){function e(){this._dragging=!1,this.animationThreshold=15}return e.prototype.render=function(t,r,n,i){var a=r.get("value"),o=r.get("status");if(this._axisModel=t,this._axisPointerModel=r,this._api=n,!(!i&&this._lastValue===a&&this._lastStatus===o)){this._lastValue=a,this._lastStatus=o;var s=this._group,l=this._handle;if(!o||o==="hide"){s&&s.hide(),l&&l.hide();return}s&&s.show(),l&&l.show();var u={};this.makeElOption(u,a,t,r,n);var f=u.graphicKey;f!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=f;var c=this._moveAnimation=this.determineAnimation(t,r);if(!s)s=this._group=new Wi,this.createPointerEl(s,u,t,r),this.createLabelEl(s,u,t,r),n.getZr().add(s);else{var h=Un(p9,r,c);this.updatePointerEl(s,u,h),this.updateLabelEl(s,u,h,r)}y9(s,r,!0),this._renderHandle(a)}},e.prototype.remove=function(t){this.clear(t)},e.prototype.dispose=function(t){this.clear(t)},e.prototype.determineAnimation=function(t,r){var n=r.get("animation"),i=t.axis,a=i.type==="category",o=r.get("snap");if(!o&&!a)return!1;if(n==="auto"||n==null){var s=this.animationThreshold;if(a&&i.getBandWidth()>s)return!0;if(o){var l=Z3(t).seriesDataCount,u=i.getExtent();return Math.abs(u[0]-u[1])/l>s}return!1}return n===!0},e.prototype.makeElOption=function(t,r,n,i,a){},e.prototype.createPointerEl=function(t,r,n,i){var a=r.pointer;if(a){var o=Dh(t).pointerEl=new bRe[a.type](v9(r.pointer));t.add(o)}},e.prototype.createLabelEl=function(t,r,n,i){if(r.label){var a=Dh(t).labelEl=new Vi(v9(r.label));t.add(a),g9(a,i)}},e.prototype.updatePointerEl=function(t,r,n){var i=Dh(t).pointerEl;i&&r.pointer&&(i.setStyle(r.pointer.style),n(i,{shape:r.pointer.shape}))},e.prototype.updateLabelEl=function(t,r,n,i){var a=Dh(t).labelEl;a&&(a.setStyle(r.label.style),n(a,{x:r.label.x,y:r.label.y}),g9(a,i))},e.prototype._renderHandle=function(t){if(!(this._dragging||!this.updateHandleTransform)){var r=this._axisPointerModel,n=this._api.getZr(),i=this._handle,a=r.getModel("handle"),o=r.get("status");if(!a.get("show")||!o||o==="hide"){i&&n.remove(i),this._handle=null;return}var s;this._handle||(s=!0,i=this._handle=y3(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(u){zne(u.event)},onmousedown:OM(this._onHandleDragMove,this,0,0),drift:OM(this._onHandleDragMove,this),ondragend:OM(this._onHandleDragEnd,this)}),n.add(i)),y9(i,r,!1),i.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=a.get("size");mt(l)||(l=[l,l]),i.scaleX=l[0]/2,i.scaleY=l[1]/2,ioe(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,s)}},e.prototype._moveHandleToValue=function(t,r){p9(this._axisPointerModel,!r&&this._moveAnimation,this._handle,EM(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},e.prototype._onHandleDragMove=function(t,r){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(EM(n),[t,r],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(EM(i)),Dh(n).lastProp=null,this._doDispatchAxisPointer()}},e.prototype._doDispatchAxisPointer=function(){var t=this._handle;if(t){var r=this._payloadInfo,n=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:r.cursorPoint[0],y:r.cursorPoint[1],tooltipOption:r.tooltipOption,axesInfo:[{axisDim:n.axis.dim,axisIndex:n.componentIndex}]})}},e.prototype._onHandleDragEnd=function(){this._dragging=!1;var t=this._handle;if(t){var r=this._axisPointerModel.get("value");this._moveHandleToValue(r),this._api.dispatchAction({type:"hideTip"})}},e.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var r=t.getZr(),n=this._group,i=this._handle;r&&n&&(this._lastGraphicKey=null,n&&r.remove(n),i&&r.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),rN(this,"_doDispatchAxisPointer")},e.prototype.doClear=function(){},e.prototype.buildLabel=function(t,r,n){return n=n||0,{x:t[n],y:t[1-n],width:r[n],height:r[1-n]}},e}();function p9(e,t,r,n){kse(Dh(r).lastProp,n)||(Dh(r).lastProp=n,t?ga(r,n,e):(r.stopAnimation(),r.attr(n)))}function kse(e,t){if($t(e)&&$t(t)){var r=!0;return ye(t,function(n,i){r=r&&kse(e[i],n)}),!!r}else return e===t}function g9(e,t){e[t.get(["label","show"])?"show":"hide"]()}function EM(e){return{x:e.x||0,y:e.y||0,rotation:e.rotation||0}}function y9(e,t,r){var n=t.get("z"),i=t.get("zlevel");e&&e.traverse(function(a){a.type!=="group"&&(n!=null&&(a.z=n),i!=null&&(a.zlevel=i),a.silent=r)})}const bDe=mDe;function wDe(e){var t=e.get("type"),r=e.getModel(t+"Style"),n;return t==="line"?(n=r.getLineStyle(),n.fill=null):t==="shadow"&&(n=r.getAreaStyle(),n.stroke=null),n}function _De(e,t,r,n,i){var a=r.get("value"),o=Ase(a,t.axis,t.ecModel,r.get("seriesDataIndices"),{precision:r.get(["label","precision"]),formatter:r.get(["label","formatter"])}),s=r.getModel("label"),l=Ok(s.get("padding")||0),u=s.getFont(),f=e3(o,u),c=i.position,h=f.width+l[1]+l[3],d=f.height+l[0]+l[2],v=i.align;v==="right"&&(c[0]-=h),v==="center"&&(c[0]-=h/2);var g=i.verticalAlign;g==="bottom"&&(c[1]-=d),g==="middle"&&(c[1]-=d/2),SDe(c,h,d,n);var y=s.get("backgroundColor");(!y||y==="auto")&&(y=t.get(["axisLine","lineStyle","color"])),e.label={x:c[0],y:c[1],style:Sc(s,{text:o,font:u,fill:s.getTextColor(),padding:l,backgroundColor:y}),z2:10}}function SDe(e,t,r,n){var i=n.getWidth(),a=n.getHeight();e[0]=Math.min(e[0]+t,i)-t,e[1]=Math.min(e[1]+r,a)-r,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}function Ase(e,t,r,n,i){e=t.scale.parse(e);var a=t.scale.getLabel({value:e},{precision:i.precision}),o=i.formatter;if(o){var s={value:z3(t,{value:e}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};ye(n,function(l){var u=r.getSeriesByIndex(l.seriesIndex),f=l.dataIndexInside,c=u&&u.getDataParams(f);c&&s.seriesData.push(c)}),Rt(o)?a=o.replace("{value}",a):lr(o)&&(a=o(s))}return a}function Pse(e,t,r){var n=ww();return qB(n,n,r.rotation),T$(n,n,r.position),g3([e.dataToCoord(t),(r.labelOffset||0)+(r.labelDirection||1)*(r.labelMargin||0)],n)}function CDe(e,t,r,n,i,a){var o=Tse.innerTextLayout(r.rotation,0,r.labelDirection);r.labelMargin=i.get(["label","margin"]),_De(t,n,i,a,{position:Pse(n.axis,e,r),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function xDe(e,t,r){return r=r||0,{x1:e[r],y1:e[1-r],x2:t[r],y2:t[1-r]}}function TDe(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}}var ODe=function(e){ct(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,i,a,o){var s=i.axis,l=s.grid,u=a.get("type"),f=m9(l,s).getOtherAxis(s).getGlobalExtent(),c=s.toGlobalCoord(s.dataToCoord(n,!0));if(u&&u!=="none"){var h=wDe(a),d=EDe[u](s,c,f);d.style=h,r.graphicKey=d.type,r.pointer=d}var v=gN(l.model,i);CDe(n,r,v,i,a,o)},t.prototype.getHandleTransform=function(r,n,i){var a=gN(n.axis.grid.model,n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var o=Pse(n.axis,r,a);return{x:o[0],y:o[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,n,i,a){var o=i.axis,s=o.grid,l=o.getGlobalExtent(!0),u=m9(s,o).getOtherAxis(o).getGlobalExtent(),f=o.dim==="x"?0:1,c=[r.x,r.y];c[f]+=n[f],c[f]=Math.min(l[1],c[f]),c[f]=Math.max(l[0],c[f]);var h=(u[1]+u[0])/2,d=[h,h];d[f]=c[f];var v=[{verticalAlign:"middle"},{align:"center"}];return{x:c[0],y:c[1],rotation:r.rotation,cursorPoint:d,tooltipOption:v[f]}},t}(bDe);function m9(e,t){var r={};return r[t.dim+"AxisIndex"]=t.index,e.getCartesian(r)}var EDe={line:function(e,t,r){var n=xDe([t,r[0]],[t,r[1]],b9(e));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(e,t,r){var n=Math.max(1,e.getBandWidth()),i=r[1]-r[0];return{type:"Rect",shape:TDe([t-n/2,r[0]],[n,i],b9(e))}}};function b9(e){return e.dim==="x"?0:1}const RDe=ODe;var kDe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}(vn);const ADe=kDe;var au=ti(),PDe=ye;function Ise(e,t,r){if(!vr.node){var n=t.getZr();au(n).records||(au(n).records={}),IDe(n,t);var i=au(n).records[e]||(au(n).records[e]={});i.handler=r}}function IDe(e,t){if(au(e).initialized)return;au(e).initialized=!0,r("click",Un(w9,"click")),r("mousemove",Un(w9,"mousemove")),r("globalout",DDe);function r(n,i){e.on(n,function(a){var o=$De(t);PDe(au(e).records,function(s){s&&i(s,a,o.dispatchAction)}),MDe(o.pendings,t)})}}function MDe(e,t){var r=e.showTip.length,n=e.hideTip.length,i;r?i=e.showTip[r-1]:n&&(i=e.hideTip[n-1]),i&&(i.dispatchAction=null,t.dispatchAction(i))}function DDe(e,t,r){e.handler("leave",null,r)}function w9(e,t,r,n){t.handler(e,r,n)}function $De(e){var t={showTip:[],hideTip:[]},r=function(n){var i=t[n.type];i?i.push(n):(n.dispatchAction=r,e.dispatchAction(n))};return{dispatchAction:r,pendings:t}}function bN(e,t){if(!vr.node){var r=t.getZr(),n=(au(r).records||{})[e];n&&(au(r).records[e]=null)}}var NDe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=n.getComponent("tooltip"),o=r.get("triggerOn")||a&&a.get("triggerOn")||"mousemove|click";Ise("axisPointer",i,function(s,l,u){o!=="none"&&(s==="leave"||o.indexOf(s)>=0)&&u({type:"updateAxisPointer",currTrigger:s,x:l&&l.offsetX,y:l&&l.offsetY})})},t.prototype.remove=function(r,n){bN("axisPointer",n)},t.prototype.dispose=function(r,n){bN("axisPointer",n)},t.type="axisPointer",t}(Vu);const LDe=NDe;function Mse(e,t){var r=[],n=e.seriesIndex,i;if(n==null||!(i=t.getSeriesByIndex(n)))return{point:[]};var a=i.getData(),o=Ed(a,e);if(o==null||o<0||mt(o))return{point:[]};var s=a.getItemGraphicEl(o),l=i.coordinateSystem;if(i.getTooltipPosition)r=i.getTooltipPosition(o)||[];else if(l&&l.dataToPoint)if(e.isStacked){var u=l.getBaseAxis(),f=l.getOtherAxis(u),c=f.dim,h=u.dim,d=c==="x"||c==="radius"?1:0,v=a.mapDimension(h),g=[];g[d]=a.get(v,o),g[1-d]=a.get(a.getCalculationInfo("stackResultDimension"),o),r=l.dataToPoint(g)||[]}else r=l.dataToPoint(a.getValues(Lt(l.dimensions,function(b){return a.mapDimension(b)}),o))||[];else if(s){var y=s.getBoundingRect().clone();y.applyTransform(s.transform),r=[y.x+y.width/2,y.y+y.height/2]}return{point:r,el:s}}var _9=ti();function FDe(e,t,r){var n=e.currTrigger,i=[e.x,e.y],a=e,o=e.dispatchAction||un(r.dispatchAction,r),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){sO(i)&&(i=Mse({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},t).point);var l=sO(i),u=a.axesInfo,f=s.axesInfo,c=n==="leave"||sO(i),h={},d={},v={list:[],map:{}},g={showPointer:Un(BDe,d),showTooltip:Un(WDe,v)};ye(s.coordSysMap,function(b,w){var _=l||b.containPoint(i);ye(s.coordSysAxesInfo[w],function(x,E){var R=x.axis,A=zDe(u,x);if(!c&&_&&(!u||A)){var N=A&&A.value;N==null&&!l&&(N=R.pointToData(i)),N!=null&&S9(x,N,g,!1,h)}})});var y={};return ye(f,function(b,w){var _=b.linkGroup;_&&!d[w]&&ye(_.axesInfo,function(x,E){var R=d[E];if(x!==b&&R){var A=R.value;_.mapper&&(A=b.axis.scale.parse(_.mapper(A,C9(x),C9(b)))),y[b.key]=A}})}),ye(y,function(b,w){S9(f[w],b,g,!0,h)}),VDe(d,f,h),UDe(v,i,e,o),jDe(f,o,r),h}}function S9(e,t,r,n,i){var a=e.axis;if(!(a.scale.isBlank()||!a.containData(t))){if(!e.involveSeries){r.showPointer(e,t);return}var o=HDe(t,e),s=o.payloadBatch,l=o.snapToValue;s[0]&&i.seriesIndex==null&&et(i,s[0]),!n&&e.snap&&a.containData(l)&&l!=null&&(t=l),r.showPointer(e,t,s),r.showTooltip(e,o,l)}}function HDe(e,t){var r=t.axis,n=r.dim,i=e,a=[],o=Number.MAX_VALUE,s=-1;return ye(t.seriesModels,function(l,u){var f=l.getData().mapDimensionsAll(n),c,h;if(l.getAxisTooltipData){var d=l.getAxisTooltipData(f,e,r);h=d.dataIndices,c=d.nestestValue}else{if(h=l.getData().indicesOfNearest(f[0],e,r.type==="category"?.5:null),!h.length)return;c=l.getData().get(f[0],h[0])}if(!(c==null||!isFinite(c))){var v=e-c,g=Math.abs(v);g<=o&&((g<o||v>=0&&s<0)&&(o=g,s=v,i=c,a.length=0),ye(h,function(y){a.push({seriesIndex:l.seriesIndex,dataIndexInside:y,dataIndex:l.getData().getRawIndex(y)})}))}}),{payloadBatch:a,snapToValue:i}}function BDe(e,t,r,n){e[t.key]={value:r,payloadBatch:n}}function WDe(e,t,r,n){var i=r.payloadBatch,a=t.axis,o=a.model,s=t.axisPointerModel;if(!(!t.triggerTooltip||!i.length)){var l=t.coordSys.model,u=Dw(l),f=e.map[u];f||(f=e.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(f)),f.dataByAxis.push({axisDim:a.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:n,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function VDe(e,t,r){var n=r.axesInfo=[];ye(t,function(i,a){var o=i.axisPointerModel.option,s=e[a];s?(!i.useHandle&&(o.status="show"),o.value=s.value,o.seriesDataIndices=(s.payloadBatch||[]).slice()):!i.useHandle&&(o.status="hide"),o.status==="show"&&n.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:o.value})})}function UDe(e,t,r,n){if(sO(t)||!e.list.length){n({type:"hideTip"});return}var i=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:r.tooltipOption,position:r.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:e.list})}function jDe(e,t,r){var n=r.getZr(),i="axisPointerLastHighlights",a=_9(n)[i]||{},o=_9(n)[i]={};ye(e,function(u,f){var c=u.axisPointerModel.option;c.status==="show"&&ye(c.seriesDataIndices,function(h){var d=h.seriesIndex+" | "+h.dataIndex;o[d]=h})});var s=[],l=[];ye(a,function(u,f){!o[f]&&l.push(u)}),ye(o,function(u,f){!a[f]&&s.push(u)}),l.length&&r.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&r.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}function zDe(e,t){for(var r=0;r<(e||[]).length;r++){var n=e[r];if(t.axis.dim===n.axisDim&&t.axis.model.componentIndex===n.axisIndex)return n}}function C9(e){var t=e.axis.model,r={},n=r.axisDim=e.axis.dim;return r.axisIndex=r[n+"AxisIndex"]=t.componentIndex,r.axisName=r[n+"AxisName"]=t.name,r.axisId=r[n+"AxisId"]=t.id,r}function sO(e){return!e||e[0]==null||isNaN(e[0])||e[1]==null||isNaN(e[1])}function Dse(e){Ose.registerAxisPointerClass("CartesianAxisPointer",RDe),e.registerComponentModel(ADe),e.registerComponentView(LDe),e.registerPreprocessor(function(t){if(t){(!t.axisPointer||t.axisPointer.length===0)&&(t.axisPointer={});var r=t.axisPointer.link;r&&!mt(r)&&(t.axisPointer.link=[r])}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,function(t,r){t.getComponent("axisPointer").coordSysAxesInfo=rDe(t,r)}),e.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},FDe)}function GDe(e){xc(yDe),xc(Dse)}function YDe(e,t){var r=Ok(t.get("padding")),n=t.getItemStyle(["color","opacity"]);return n.fill=t.get("backgroundColor"),e=new ci({shape:{x:e.x-r[3],y:e.y-r[0],width:e.width+r[1]+r[3],height:e.height+r[0]+r[2],r:t.get("borderRadius")},style:n,silent:!0,z2:-1}),e}var KDe=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}(vn);const XDe=KDe;function $se(e){var t=e.get("confine");return t!=null?!!t:e.get("renderMode")==="richText"}function Nse(e){if(vr.domSupported){for(var t=document.documentElement.style,r=0,n=e.length;r<n;r++)if(e[r]in t)return e[r]}}var Lse=Nse(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),qDe=Nse(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function Fse(e,t){if(!e)return t;t=kae(t,!0);var r=e.indexOf(t);return e=r===-1?t:"-"+e.slice(0,r)+"-"+t,e.toLowerCase()}function ZDe(e,t){var r=e.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(e);return r?t?r[t]:r:null}var JDe=Fse(qDe,"transition"),J3=Fse(Lse,"transform"),QDe="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(vr.transform3dSupported?"will-change:transform;":"");function e$e(e){return e=e==="left"?"right":e==="right"?"left":e==="top"?"bottom":"top",e}function t$e(e,t,r){if(!Rt(r)||r==="inside")return"";var n=e.get("backgroundColor"),i=e.get("borderWidth");t=kd(t);var a=e$e(r),o=Math.max(Math.round(i)*1.5,6),s="",l=J3+":",u;Xr(["left","right"],a)>-1?(s+="top:50%",l+="translateY(-50%) rotate("+(u=a==="left"?-225:-45)+"deg)"):(s+="left:50%",l+="translateX(-50%) rotate("+(u=a==="top"?225:45)+"deg)");var f=u*Math.PI/180,c=o+i,h=c*Math.abs(Math.cos(f))+c*Math.abs(Math.sin(f)),d=Math.round(((h-Math.SQRT2*i)/2+Math.SQRT2*i-(h-c)/2)*100)/100;s+=";"+a+":-"+d+"px";var v=t+" solid "+i+"px;",g=["position:absolute;width:"+o+"px;height:"+o+"px;z-index:-1;",s+";"+l+";","border-bottom:"+v,"border-right:"+v,"background-color:"+n+";"];return'<div style="'+g.join("")+'"></div>'}function r$e(e,t){var r="cubic-bezier(0.23,1,0.32,1)",n=" "+e/2+"s "+r,i="opacity"+n+",visibility"+n;return t||(n=" "+e+"s "+r,i+=vr.transformSupported?","+J3+n:",left"+n+",top"+n),JDe+":"+i}function x9(e,t,r){var n=e.toFixed(0)+"px",i=t.toFixed(0)+"px";if(!vr.transformSupported)return r?"top:"+i+";left:"+n+";":[["top",i],["left",n]];var a=vr.transform3dSupported,o="translate"+(a?"3d":"")+"("+n+","+i+(a?",0":"")+")";return r?"top:0;left:0;"+J3+":"+o+";":[["top",0],["left",0],[Lse,o]]}function n$e(e){var t=[],r=e.get("fontSize"),n=e.getTextColor();n&&t.push("color:"+n),t.push("font:"+e.getFont()),r&&t.push("line-height:"+Math.round(r*3/2)+"px");var i=e.get("textShadowColor"),a=e.get("textShadowBlur")||0,o=e.get("textShadowOffsetX")||0,s=e.get("textShadowOffsetY")||0;return i&&a&&t.push("text-shadow:"+o+"px "+s+"px "+a+"px "+i),ye(["decoration","align"],function(l){var u=e.get(l);u&&t.push("text-"+l+":"+u)}),t.join(";")}function i$e(e,t,r){var n=[],i=e.get("transitionDuration"),a=e.get("backgroundColor"),o=e.get("shadowBlur"),s=e.get("shadowColor"),l=e.get("shadowOffsetX"),u=e.get("shadowOffsetY"),f=e.getModel("textStyle"),c=roe(e,"html"),h=l+"px "+u+"px "+o+"px "+s;return n.push("box-shadow:"+h),t&&i&&n.push(r$e(i,r)),a&&n.push("background-color:"+a),ye(["width","color","radius"],function(d){var v="border-"+d,g=kae(v),y=e.get(g);y!=null&&n.push(v+":"+y+(d==="color"?"":"px"))}),n.push(n$e(f)),c!=null&&n.push("padding:"+Ok(c).join("px ")+"px"),n.join(";")+";"}function T9(e,t,r,n,i){var a=t&&t.painter;if(r){var o=a&&a.getViewportRoot();o&&mxe(e,o,document.body,n,i)}else{e[0]=n,e[1]=i;var s=a&&a.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var a$e=function(){function e(t,r,n){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,vr.wxa)return null;var i=document.createElement("div");i.domBelongToZr=!0,this.el=i;var a=this._zr=r.getZr(),o=this._appendToBody=n&&n.appendToBody;T9(this._styleCoord,a,o,r.getWidth()/2,r.getHeight()/2),o?document.body.appendChild(i):t.appendChild(i),this._container=t;var s=this;i.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},i.onmousemove=function(l){if(l=l||window.event,!s._enterable){var u=a.handler,f=a.painter.getViewportRoot();Po(f,l,!0),u.dispatch("mousemove",l)}},i.onmouseleave=function(){s._inContent=!1,s._enterable&&s._show&&s.hideLater(s._hideDelay)}}return e.prototype.update=function(t){var r=this._container,n=ZDe(r,"position"),i=r.style;i.position!=="absolute"&&n!=="absolute"&&(i.position="relative");var a=t.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=t.get("className")||""},e.prototype.show=function(t,r){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var n=this.el,i=n.style,a=this._styleCoord;n.innerHTML?i.cssText=QDe+i$e(t,!this._firstShow,this._longHide)+x9(a[0],a[1],!0)+("border-color:"+kd(r)+";")+(t.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},e.prototype.setContent=function(t,r,n,i,a){var o=this.el;if(t==null){o.innerHTML="";return}var s="";if(Rt(a)&&n.get("trigger")==="item"&&!$se(n)&&(s=t$e(n,i,a)),Rt(t))o.innerHTML=t+s;else if(t){o.innerHTML="",mt(t)||(t=[t]);for(var l=0;l<t.length;l++)rE(t[l])&&t[l].parentNode!==o&&o.appendChild(t[l]);if(s&&o.childNodes.length){var u=document.createElement("div");u.innerHTML=s,o.appendChild(u)}}},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el;return[t.offsetWidth,t.offsetHeight]},e.prototype.moveTo=function(t,r){var n=this._styleCoord;if(T9(n,this._zr,this._appendToBody,t,r),n[0]!=null&&n[1]!=null){var i=this.el.style,a=x9(n[0],n[1]);ye(a,function(o){i[o[0]]=o[1]})}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){var t=this,r=this.el.style;r.visibility="hidden",r.opacity="0",vr.transform3dSupported&&(r.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(un(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},e}();const o$e=a$e;var s$e=function(){function e(t){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=t.getZr(),E9(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return e.prototype.update=function(t){var r=t.get("alwaysShowContent");r&&this._moveIfResized(),this._alwaysShowContent=r},e.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},e.prototype.setContent=function(t,r,n,i,a){var o=this;$t(t)&&Ma(""),this.el&&this._zr.remove(this.el);var s=n.getModel("textStyle");this.el=new Vi({style:{rich:r.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:s.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:roe(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),ye(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(u){o.el.style[u]=n.get(u)}),ye(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(u){o.el.style[u]=s.get(u)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el,r=this.el.getBoundingRect(),n=O9(t.style);return[r.width+n.left+n.right,r.height+n.top+n.bottom]},e.prototype.moveTo=function(t,r){var n=this.el;if(n){var i=this._styleCoord;E9(i,this._zr,t,r),t=i[0],r=i[1];var a=n.style,o=Df(a.borderWidth||0),s=O9(a);n.x=t+o+s.left,n.y=r+o+s.top,n.markRedraw()}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(un(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this._zr.remove(this.el)},e}();function Df(e){return Math.max(0,e)}function O9(e){var t=Df(e.shadowBlur||0),r=Df(e.shadowOffsetX||0),n=Df(e.shadowOffsetY||0);return{left:Df(t-r),right:Df(t+r),top:Df(t-n),bottom:Df(t+n)}}function E9(e,t,r,n){e[0]=r,e[1]=n,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}const l$e=s$e;var u$e=new ci({shape:{x:-1,y:-1,width:2,height:2}}),f$e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){if(!(vr.node||!n.getDom())){var i=r.getComponent("tooltip"),a=this._renderMode=QTe(i.get("renderMode"));this._tooltipContent=a==="richText"?new l$e(n):new o$e(n.getDom(),n,{appendToBody:i.get("appendToBody",!0)})}},t.prototype.render=function(r,n,i){if(!(vr.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=r,this._ecModel=n,this._api=i;var a=this._tooltipContent;a.update(r),a.setEnterable(r.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&r.get("transitionDuration")?ioe(this,"_updatePosition",50,"fixRate"):rN(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var r=this._tooltipModel,n=r.get("triggerOn");Ise("itemTooltip",this._api,un(function(i,a,o){n!=="none"&&(n.indexOf(i)>=0?this._tryShow(a,o):i==="leave"&&this._hide(o))},this))},t.prototype._keepShow=function(){var r=this._tooltipModel,n=this._ecModel,i=this._api,a=r.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&o.manuallyShowTip(r,n,i,{x:o._lastX,y:o._lastY,dataByCoordSys:o._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(r,n,i,a){if(!(a.from===this.uid||vr.node||!i.getDom())){var o=R9(a,i);this._ticket="";var s=a.dataByCoordSys,l=v$e(a,n,i);if(l){var u=l.el.getBoundingRect().clone();u.applyTransform(l.el.transform),this._tryShow({offsetX:u.x+u.width/2,offsetY:u.y+u.height/2,target:l.el,position:a.position,positionDefault:"bottom"},o)}else if(a.tooltip&&a.x!=null&&a.y!=null){var f=u$e;f.x=a.x,f.y=a.y,f.update(),Ur(f).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:f},o)}else if(s)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:s,tooltipOption:a.tooltipOption},o);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(r,n,i,a))return;var c=Mse(a,n),h=c.point[0],d=c.point[1];h!=null&&d!=null&&this._tryShow({offsetX:h,offsetY:d,target:c.el,position:a.position,positionDefault:"bottom"},o)}else a.x!=null&&a.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:i.getZr().findHover(a.x,a.y).target},o))}},t.prototype.manuallyHideTip=function(r,n,i,a){var o=this._tooltipContent;this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(R9(a,i))},t.prototype._manuallyAxisShowTip=function(r,n,i,a){var o=a.seriesIndex,s=a.dataIndex,l=n.getComponent("axisPointer").coordSysAxesInfo;if(!(o==null||s==null||l==null)){var u=n.getSeriesByIndex(o);if(u){var f=u.getData(),c=M0([f.getItemModel(s),u,(u.coordinateSystem||{}).model],this._tooltipModel);if(c.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:s,position:a.position}),!0}}},t.prototype._tryShow=function(r,n){var i=r.target,a=this._tooltipModel;if(a){this._lastX=r.offsetX,this._lastY=r.offsetY;var o=r.dataByCoordSys;if(o&&o.length)this._showAxisTooltip(o,r);else if(i){this._lastDataByCoordSys=null;var s,l;wb(i,function(u){if(Ur(u).dataIndex!=null)return s=u,!0;if(Ur(u).tooltipConfig!=null)return l=u,!0},!0),s?this._showSeriesItemTooltip(r,s,n):l?this._showComponentItemTooltip(r,l,n):this._hide(n)}else this._lastDataByCoordSys=null,this._hide(n)}},t.prototype._showOrMove=function(r,n){var i=r.get("showDelay");n=un(n,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(n,i):n()},t.prototype._showAxisTooltip=function(r,n){var i=this._ecModel,a=this._tooltipModel,o=[n.offsetX,n.offsetY],s=M0([n.tooltipOption],a),l=this._renderMode,u=[],f=Aw("section",{blocks:[],noHeader:!0}),c=[],h=new iM;ye(r,function(w){ye(w.dataByAxis,function(_){var x=i.getComponent(_.axisDim+"Axis",_.axisIndex),E=_.value;if(!(!x||E==null)){var R=Ase(E,x.axis,i,_.seriesDataIndices,_.valueLabelOpt),A=Aw("section",{header:R,noHeader:!dl(R),sortBlocks:!0,blocks:[]});f.blocks.push(A),ye(_.seriesDataIndices,function(N){var I=i.getSeriesByIndex(N.seriesIndex),F=N.dataIndexInside,H=I.getDataParams(F);if(!(H.dataIndex<0)){H.axisDim=_.axisDim,H.axisIndex=_.axisIndex,H.axisType=_.axisType,H.axisId=_.axisId,H.axisValue=z3(x.axis,{value:E}),H.axisValueLabel=R,H.marker=h.makeTooltipMarker("item",kd(H.color),l);var W=Fz(I.formatTooltip(F,!0,null)),z=W.frag;if(z){var te=M0([I],a).get("valueFormatter");A.blocks.push(te?et({valueFormatter:te},z):z)}W.text&&c.push(W.text),u.push(H)}})}})}),f.blocks.reverse(),c.reverse();var d=n.position,v=s.get("order"),g=Uz(f,h,l,v,i.get("useUTC"),s.get("textStyle"));g&&c.unshift(g);var y=l==="richText"?`

`:"<br/>",b=c.join(y);this._showOrMove(s,function(){this._updateContentNotChangedOnAxis(r,u)?this._updatePosition(s,d,o[0],o[1],this._tooltipContent,u):this._showTooltipContent(s,b,u,Math.random()+"",o[0],o[1],d,null,h)})},t.prototype._showSeriesItemTooltip=function(r,n,i){var a=this._ecModel,o=Ur(n),s=o.seriesIndex,l=a.getSeriesByIndex(s),u=o.dataModel||l,f=o.dataIndex,c=o.dataType,h=u.getData(c),d=this._renderMode,v=r.positionDefault,g=M0([h.getItemModel(f),u,l&&(l.coordinateSystem||{}).model],this._tooltipModel,v?{position:v}:null),y=g.get("trigger");if(!(y!=null&&y!=="item")){var b=u.getDataParams(f,c),w=new iM;b.marker=w.makeTooltipMarker("item",kd(b.color),d);var _=Fz(u.formatTooltip(f,!1,c)),x=g.get("order"),E=g.get("valueFormatter"),R=_.frag,A=R?Uz(E?et({valueFormatter:E},R):R,w,d,x,a.get("useUTC"),g.get("textStyle")):_.text,N="item_"+u.name+"_"+f;this._showOrMove(g,function(){this._showTooltipContent(g,A,b,N,r.offsetX,r.offsetY,r.position,r.target,w)}),i({type:"showTip",dataIndexInside:f,dataIndex:h.getRawIndex(f),seriesIndex:s,from:this.uid})}},t.prototype._showComponentItemTooltip=function(r,n,i){var a=Ur(n),o=a.tooltipConfig,s=o.option||{};if(Rt(s)){var l=s;s={content:l,formatter:l}}var u=[s],f=this._ecModel.getComponent(a.componentMainType,a.componentIndex);f&&u.push(f),u.push({formatter:s.content});var c=r.positionDefault,h=M0(u,this._tooltipModel,c?{position:c}:null),d=h.get("content"),v=Math.random()+"",g=new iM;this._showOrMove(h,function(){var y=Rr(h.get("formatterParams")||{});this._showTooltipContent(h,d,y,v,r.offsetX,r.offsetY,r.position,n,g)}),i({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(r,n,i,a,o,s,l,u,f){if(this._ticket="",!(!r.get("showContent")||!r.get("show"))){var c=this._tooltipContent;c.setEnterable(r.get("enterable"));var h=r.get("formatter");l=l||r.get("position");var d=n,v=this._getNearestPoint([o,s],i,r.get("trigger"),r.get("borderColor")),g=v.color;if(h)if(Rt(h)){var y=r.ecModel.get("useUTC"),b=mt(i)?i[0]:i,w=b&&b.axisType&&b.axisType.indexOf("time")>=0;d=h,w&&(d=_k(b.axisValue,d,y)),d=Aae(d,i,!0)}else if(lr(h)){var _=un(function(x,E){x===this._ticket&&(c.setContent(E,f,r,g,l),this._updatePosition(r,l,o,s,c,i,u))},this);this._ticket=a,d=h(i,a,_)}else d=h;c.setContent(d,f,r,g,l),c.show(r,g),this._updatePosition(r,l,o,s,c,i,u)}},t.prototype._getNearestPoint=function(r,n,i,a){if(i==="axis"||mt(n))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!mt(n))return{color:a||n.color||n.borderColor}},t.prototype._updatePosition=function(r,n,i,a,o,s,l){var u=this._api.getWidth(),f=this._api.getHeight();n=n||r.get("position");var c=o.getSize(),h=r.get("align"),d=r.get("verticalAlign"),v=l&&l.getBoundingRect().clone();if(l&&v.applyTransform(l.transform),lr(n)&&(n=n([i,a],s,o.el,v,{viewSize:[u,f],contentSize:c.slice()})),mt(n))i=gn(n[0],u),a=gn(n[1],f);else if($t(n)){var g=n;g.width=c[0],g.height=c[1];var y=vg(g,{width:u,height:f});i=y.x,a=y.y,h=null,d=null}else if(Rt(n)&&l){var b=d$e(n,v,c,r.get("borderWidth"));i=b[0],a=b[1]}else{var b=c$e(i,a,o,u,f,h?null:20,d?null:20);i=b[0],a=b[1]}if(h&&(i-=k9(h)?c[0]/2:h==="right"?c[0]:0),d&&(a-=k9(d)?c[1]/2:d==="bottom"?c[1]:0),$se(r)){var b=h$e(i,a,o,u,f);i=b[0],a=b[1]}o.moveTo(i,a)},t.prototype._updateContentNotChangedOnAxis=function(r,n){var i=this._lastDataByCoordSys,a=this._cbParamsList,o=!!i&&i.length===r.length;return o&&ye(i,function(s,l){var u=s.dataByAxis||[],f=r[l]||{},c=f.dataByAxis||[];o=o&&u.length===c.length,o&&ye(u,function(h,d){var v=c[d]||{},g=h.seriesDataIndices||[],y=v.seriesDataIndices||[];o=o&&h.value===v.value&&h.axisType===v.axisType&&h.axisId===v.axisId&&g.length===y.length,o&&ye(g,function(b,w){var _=y[w];o=o&&b.seriesIndex===_.seriesIndex&&b.dataIndex===_.dataIndex}),a&&ye(h.seriesDataIndices,function(b){var w=b.seriesIndex,_=n[w],x=a[w];_&&x&&x.data!==_.data&&(o=!1)})})}),this._lastDataByCoordSys=r,this._cbParamsList=n,!!o},t.prototype._hide=function(r){this._lastDataByCoordSys=null,r({type:"hideTip",from:this.uid})},t.prototype.dispose=function(r,n){vr.node||!n.getDom()||(rN(this,"_updatePosition"),this._tooltipContent.dispose(),bN("itemTooltip",n))},t.type="tooltip",t}(Vu);function M0(e,t,r){var n=t.ecModel,i;r?(i=new Li(r,n,n),i=new Li(t.option,i,n)):i=t;for(var a=e.length-1;a>=0;a--){var o=e[a];o&&(o instanceof Li&&(o=o.get("tooltip",!0)),Rt(o)&&(o={formatter:o}),o&&(i=new Li(o,i,n)))}return i}function R9(e,t){return e.dispatchAction||un(t.dispatchAction,t)}function c$e(e,t,r,n,i,a,o){var s=r.getSize(),l=s[0],u=s[1];return a!=null&&(e+l+a+2>n?e-=l+a:e+=a),o!=null&&(t+u+o>i?t-=u+o:t+=o),[e,t]}function h$e(e,t,r,n,i){var a=r.getSize(),o=a[0],s=a[1];return e=Math.min(e+o,n)-o,t=Math.min(t+s,i)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}function d$e(e,t,r,n){var i=r[0],a=r[1],o=Math.ceil(Math.SQRT2*n)+8,s=0,l=0,u=t.width,f=t.height;switch(e){case"inside":s=t.x+u/2-i/2,l=t.y+f/2-a/2;break;case"top":s=t.x+u/2-i/2,l=t.y-a-o;break;case"bottom":s=t.x+u/2-i/2,l=t.y+f+o;break;case"left":s=t.x-i-o,l=t.y+f/2-a/2;break;case"right":s=t.x+u+o,l=t.y+f/2-a/2}return[s,l]}function k9(e){return e==="center"||e==="middle"}function v$e(e,t,r){var n=a3(e).queryOptionMap,i=n.keys()[0];if(!(!i||i==="series")){var a=JS(t,i,n.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),o=a.models[0];if(o){var s=r.getViewOfComponentModel(o),l;if(s.group.traverse(function(u){var f=Ur(u).tooltipConfig;if(f&&f.name===e.name)return l=u,!0}),l)return{componentMainType:i,componentIndex:o.componentIndex,el:l}}}}const p$e=f$e;function g$e(e){xc(Dse),e.registerComponentModel(XDe),e.registerComponentView(p$e),e.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Na),e.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Na)}var y$e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}(vn),m$e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){if(this.group.removeAll(),!!r.get("show")){var a=this.group,o=r.getModel("textStyle"),s=r.getModel("subtextStyle"),l=r.get("textAlign"),u=Tr(r.get("textBaseline"),r.get("textVerticalAlign")),f=new Vi({style:Sc(o,{text:r.get("text"),fill:o.getTextColor()},{disableBox:!0}),z2:10}),c=f.getBoundingRect(),h=r.get("subtext"),d=new Vi({style:Sc(s,{text:h,fill:s.getTextColor(),y:c.height+r.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),v=r.get("link"),g=r.get("sublink"),y=r.get("triggerEvent",!0);f.silent=!v&&!y,d.silent=!g&&!y,v&&f.on("click",function(){wz(v,"_"+r.get("target"))}),g&&d.on("click",function(){wz(g,"_"+r.get("subtarget"))}),Ur(f).eventData=Ur(d).eventData=y?{componentType:"title",componentIndex:r.componentIndex}:null,a.add(f),h&&a.add(d);var b=a.getBoundingRect(),w=r.getBoxLayoutParams();w.width=b.width,w.height=b.height;var _=vg(w,{width:i.getWidth(),height:i.getHeight()},r.get("padding"));l||(l=r.get("left")||r.get("right"),l==="middle"&&(l="center"),l==="right"?_.x+=_.width:l==="center"&&(_.x+=_.width/2)),u||(u=r.get("top")||r.get("bottom"),u==="center"&&(u="middle"),u==="bottom"?_.y+=_.height:u==="middle"&&(_.y+=_.height/2),u=u||"top"),a.x=_.x,a.y=_.y,a.markRedraw();var x={align:l,verticalAlign:u};f.setStyle(x),d.setStyle(x),b=a.getBoundingRect();var E=_.margin,R=r.getItemStyle(["color","opacity"]);R.fill=r.get("backgroundColor");var A=new ci({shape:{x:b.x-E[3],y:b.y-E[0],width:b.width+E[1]+E[3],height:b.height+E[0]+E[2],r:r.get("borderRadius")},style:R,subPixelOptimize:!0,silent:!0});a.add(A)}},t.type="title",t}(Vu);function b$e(e){e.registerComponentModel(y$e),e.registerComponentView(m$e)}var w$e=function(e,t){if(t==="all")return{type:"all",title:e.getLocaleModel().get(["legend","selector","all"])};if(t==="inverse")return{type:"inverse",title:e.getLocaleModel().get(["legend","selector","inverse"])}},_$e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),r.selected=r.selected||{},this._updateSelector(r)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),this._updateSelector(r)},t.prototype._updateSelector=function(r){var n=r.selector,i=this.ecModel;n===!0&&(n=r.selector=["all","inverse"]),mt(n)&&ye(n,function(a,o){Rt(a)&&(a={type:a}),n[o]=Hr(a,w$e(i,a.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var r=this._data;if(r[0]&&this.get("selectedMode")==="single"){for(var n=!1,i=0;i<r.length;i++){var a=r[i].get("name");if(this.isSelected(a)){this.select(a),n=!0;break}}!n&&this.select(r[0].get("name"))}},t.prototype._updateData=function(r){var n=[],i=[];r.eachRawSeries(function(l){var u=l.name;i.push(u);var f;if(l.legendVisualProvider){var c=l.legendVisualProvider,h=c.getAllNames();r.isSeriesFiltered(l)||(i=i.concat(h)),h.length?n=n.concat(h):f=!0}else f=!0;f&&i3(l)&&n.push(l.name)}),this._availableNames=i;var a=this.get("data")||n,o=pr(),s=Lt(a,function(l){return(Rt(l)||en(l))&&(l={name:l}),o.get(l.name)?null:(o.set(l.name,!0),new Li(l,this,this.ecModel))},this);this._data=ua(s,function(l){return!!l})},t.prototype.getData=function(){return this._data},t.prototype.select=function(r){var n=this.option.selected,i=this.get("selectedMode");if(i==="single"){var a=this._data;ye(a,function(o){n[o.get("name")]=!1})}n[r]=!0},t.prototype.unSelect=function(r){this.get("selectedMode")!=="single"&&(this.option.selected[r]=!1)},t.prototype.toggleSelected=function(r){var n=this.option.selected;n.hasOwnProperty(r)||(n[r]=!0),this[n[r]?"unSelect":"select"](r)},t.prototype.allSelect=function(){var r=this._data,n=this.option.selected;ye(r,function(i){n[i.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var r=this._data,n=this.option.selected;ye(r,function(i){var a=i.get("name",!0);n.hasOwnProperty(a)||(n[a]=!0),n[a]=!n[a]})},t.prototype.isSelected=function(r){var n=this.option.selected;return!(n.hasOwnProperty(r)&&!n[r])&&Xr(this._availableNames,r)>=0},t.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}(vn);const wN=_$e;var jv=Un,_N=ye,Px=Wi,S$e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!1,r}return t.prototype.init=function(){this.group.add(this._contentGroup=new Px),this.group.add(this._selectorGroup=new Px),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(r,n,i){var a=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!r.get("show",!0)){var o=r.get("align"),s=r.get("orient");(!o||o==="auto")&&(o=r.get("left")==="right"&&s==="vertical"?"right":"left");var l=r.get("selector",!0),u=r.get("selectorPosition",!0);l&&(!u||u==="auto")&&(u=s==="horizontal"?"end":"start"),this.renderInner(o,r,n,i,l,s,u);var f=r.getBoxLayoutParams(),c={width:i.getWidth(),height:i.getHeight()},h=r.get("padding"),d=vg(f,c,h),v=this.layoutInner(r,o,d,a,l,u),g=vg(Vr({width:v.width,height:v.height},f),c,h);this.group.x=g.x-v.x,this.group.y=g.y-v.y,this.group.markRedraw(),this.group.add(this._backgroundEl=YDe(v,r))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this.getContentGroup(),f=pr(),c=n.get("selectedMode"),h=[];i.eachRawSeries(function(d){!d.get("legendHoverLink")&&h.push(d.id)}),_N(n.getData(),function(d,v){var g=d.get("name");if(!this.newlineDisabled&&(g===""||g===`
`)){var y=new Px;y.newline=!0,u.add(y);return}var b=i.getSeriesByName(g)[0];if(!f.get(g))if(b){var w=b.getData(),_=w.getVisual("legendLineStyle")||{},x=w.getVisual("legendIcon"),E=w.getVisual("style"),R=this._createItem(b,g,v,d,n,r,_,E,x,c,a);R.on("click",jv(A9,g,null,a,h)).on("mouseover",jv(SN,b.name,null,a,h)).on("mouseout",jv(CN,b.name,null,a,h)),f.set(g,!0)}else i.eachRawSeries(function(A){if(!f.get(g)&&A.legendVisualProvider){var N=A.legendVisualProvider;if(!N.containName(g))return;var I=N.indexOfName(g),F=N.getItemVisual(I,"style"),H=N.getItemVisual(I,"legendIcon"),W=$u(F.fill);W&&W[3]===0&&(W[3]=.2,F=et(et({},F),{fill:uk(W,"rgba")}));var z=this._createItem(A,g,v,d,n,r,{},F,H,c,a);z.on("click",jv(A9,null,g,a,h)).on("mouseover",jv(SN,null,g,a,h)).on("mouseout",jv(CN,null,g,a,h)),f.set(g,!0)}},this)},this),o&&this._createSelector(o,n,a,s,l)},t.prototype._createSelector=function(r,n,i,a,o){var s=this.getSelectorGroup();_N(r,function(u){var f=u.type,c=new Vi({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:f==="all"?"legendAllSelect":"legendInverseSelect"})}});s.add(c);var h=n.getModel("selectorLabel"),d=n.getModel(["emphasis","selectorLabel"]);e1(c,{normal:h,emphasis:d},{defaultText:u.title}),z$(c)})},t.prototype._createItem=function(r,n,i,a,o,s,l,u,f,c,h){var d=r.visualDrawType,v=o.get("itemWidth"),g=o.get("itemHeight"),y=o.isSelected(n),b=a.get("symbolRotate"),w=a.get("symbolKeepAspect"),_=a.get("icon");f=_||f||"roundRect";var x=C$e(f,a,l,u,d,y,h),E=new Px,R=a.getModel("textStyle");if(lr(r.getLegendIcon)&&(!_||_==="inherit"))E.add(r.getLegendIcon({itemWidth:v,itemHeight:g,icon:f,iconRotate:b,itemStyle:x.itemStyle,lineStyle:x.lineStyle,symbolKeepAspect:w}));else{var A=_==="inherit"&&r.getData().getVisual("symbol")?b==="inherit"?r.getData().getVisual("symbolRotate"):b:0;E.add(x$e({itemWidth:v,itemHeight:g,icon:f,iconRotate:A,itemStyle:x.itemStyle,lineStyle:x.lineStyle,symbolKeepAspect:w}))}var N=s==="left"?v+5:-5,I=s,F=o.get("formatter"),H=n;Rt(F)&&F?H=F.replace("{name}",n??""):lr(F)&&(H=F(n));var W=a.get("inactiveColor");E.add(new Vi({style:Sc(R,{text:H,x:N,y:g/2,fill:y?R.getTextColor():W,align:I,verticalAlign:"middle"})}));var z=new ci({shape:E.getBoundingRect(),invisible:!0}),te=a.getModel("tooltip");return te.get("show")&&m3({el:z,componentModel:o,itemName:n,itemTooltipOption:te.option}),E.add(z),E.eachChild(function(ie){ie.silent=!0}),z.silent=!c,this.getContentGroup().add(E),z$(E),E.__legendDataIndex=i,E},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getContentGroup(),u=this.getSelectorGroup();Vb(r.get("orient"),l,r.get("itemGap"),i.width,i.height);var f=l.getBoundingRect(),c=[-f.x,-f.y];if(u.markRedraw(),l.markRedraw(),o){Vb("horizontal",u,r.get("selectorItemGap",!0));var h=u.getBoundingRect(),d=[-h.x,-h.y],v=r.get("selectorButtonGap",!0),g=r.getOrient().index,y=g===0?"width":"height",b=g===0?"height":"width",w=g===0?"y":"x";s==="end"?d[g]+=f[y]+v:c[g]+=h[y]+v,d[1-g]+=f[b]/2-h[b]/2,u.x=d[0],u.y=d[1],l.x=c[0],l.y=c[1];var _={x:0,y:0};return _[y]=f[y]+v+h[y],_[b]=Math.max(f[b],h[b]),_[w]=Math.min(0,h[w]+d[1-g]),_}else return l.x=c[0],l.y=c[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(Vu);function C$e(e,t,r,n,i,a,o){function s(y,b){y.lineWidth==="auto"&&(y.lineWidth=b.lineWidth>0?2:0),_N(y,function(w,_){y[_]==="inherit"&&(y[_]=b[_])})}var l=t.getModel("itemStyle"),u=l.getItemStyle(),f=e.lastIndexOf("empty",0)===0?"fill":"stroke",c=l.getShallow("decal");u.decal=!c||c==="inherit"?n.decal:sN(c,o),u.fill==="inherit"&&(u.fill=n[i]),u.stroke==="inherit"&&(u.stroke=n[f]),u.opacity==="inherit"&&(u.opacity=(i==="fill"?n:r).opacity),s(u,n);var h=t.getModel("lineStyle"),d=h.getLineStyle();if(s(d,r),u.fill==="auto"&&(u.fill=n.fill),u.stroke==="auto"&&(u.stroke=n.fill),d.stroke==="auto"&&(d.stroke=n.fill),!a){var v=t.get("inactiveBorderWidth"),g=u[f];u.lineWidth=v==="auto"?n.lineWidth>0&&g?2:0:u.lineWidth,u.fill=t.get("inactiveColor"),u.stroke=t.get("inactiveBorderColor"),d.stroke=h.get("inactiveColor"),d.lineWidth=h.get("inactiveWidth")}return{itemStyle:u,lineStyle:d}}function x$e(e){var t=e.icon||"roundRect",r=yg(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill,e.symbolKeepAspect);return r.setStyle(e.itemStyle),r.rotation=(e.iconRotate||0)*Math.PI/180,r.setOrigin([e.itemWidth/2,e.itemHeight/2]),t.indexOf("empty")>-1&&(r.style.stroke=r.style.fill,r.style.fill="#fff",r.style.lineWidth=2),r}function A9(e,t,r,n){CN(e,t,r,n),r.dispatchAction({type:"legendToggleSelect",name:e??t}),SN(e,t,r,n)}function Hse(e){for(var t=e.getZr().storage.getDisplayList(),r,n=0,i=t.length;n<i&&!(r=t[n].states.emphasis);)n++;return r&&r.hoverLayer}function SN(e,t,r,n){Hse(r)||r.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:n})}function CN(e,t,r,n){Hse(r)||r.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:n})}const Bse=S$e;function T$e(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(r){for(var n=0;n<t.length;n++)if(!t[n].isSelected(r.name))return!1;return!0})}function D0(e,t,r){var n={},i=e==="toggleSelected",a;return r.eachComponent("legend",function(o){i&&a!=null?o[a?"select":"unSelect"](t.name):e==="allSelect"||e==="inverseSelect"?o[e]():(o[e](t.name),a=o.isSelected(t.name));var s=o.getData();ye(s,function(l){var u=l.get("name");if(!(u===`
`||u==="")){var f=o.isSelected(u);n.hasOwnProperty(u)?n[u]=n[u]&&f:n[u]=f}})}),e==="allSelect"||e==="inverseSelect"?{selected:n}:{name:t.name,selected:n}}function O$e(e){e.registerAction("legendToggleSelect","legendselectchanged",Un(D0,"toggleSelected")),e.registerAction("legendAllSelect","legendselectall",Un(D0,"allSelect")),e.registerAction("legendInverseSelect","legendinverseselect",Un(D0,"inverseSelect")),e.registerAction("legendSelect","legendselected",Un(D0,"select")),e.registerAction("legendUnSelect","legendunselected",Un(D0,"unSelect"))}function Wse(e){e.registerComponentModel(wN),e.registerComponentView(Bse),e.registerProcessor(e.PRIORITY.PROCESSOR.SERIES_FILTER,T$e),e.registerSubTypeDefaulter("legend",function(){return"plain"}),O$e(e)}var E$e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.setScrollDataIndex=function(r){this.option.scrollDataIndex=r},t.prototype.init=function(r,n,i){var a=Ek(r);e.prototype.init.call(this,r,n,i),P9(this,r,a)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),P9(this,this.option,r)},t.type="legend.scroll",t.defaultOption=yae(wN.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(wN);function P9(e,t,r){var n=e.getOrient(),i=[1,1];i[n.index]=0,pg(t,r,{type:"box",ignoreSize:!!i})}const R$e=E$e;var I9=Wi,RM=["width","height"],kM=["x","y"],k$e=function(e){ct(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!0,r._currentIndex=0,r}return t.prototype.init=function(){e.prototype.init.call(this),this.group.add(this._containerGroup=new I9),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new I9)},t.prototype.resetInner=function(){e.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this;e.prototype.renderInner.call(this,r,n,i,a,o,s,l);var f=this._controllerGroup,c=n.get("pageIconSize",!0),h=mt(c)?c:[c,c];v("pagePrev",0);var d=n.getModel("pageTextStyle");f.add(new Vi({name:"pageText",style:{text:"xx/xx",fill:d.getTextColor(),font:d.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),v("pageNext",1);function v(g,y){var b=g+"DataIndex",w=y3(n.get("pageIcons",!0)[n.getOrient().name][y],{onclick:un(u._pageGo,u,b,n,a)},{x:-h[0]/2,y:-h[1]/2,width:h[0],height:h[1]});w.name=g,f.add(w)}},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getSelectorGroup(),u=r.getOrient().index,f=RM[u],c=kM[u],h=RM[1-u],d=kM[1-u];o&&Vb("horizontal",l,r.get("selectorItemGap",!0));var v=r.get("selectorButtonGap",!0),g=l.getBoundingRect(),y=[-g.x,-g.y],b=Rr(i);o&&(b[f]=i[f]-g[f]-v);var w=this._layoutContentAndController(r,a,b,u,f,h,d,c);if(o){if(s==="end")y[u]+=w[f]+v;else{var _=g[f]+v;y[u]-=_,w[c]-=_}w[f]+=g[f]+v,y[1-u]+=w[d]+w[h]/2-g[h]/2,w[h]=Math.max(w[h],g[h]),w[d]=Math.min(w[d],g[d]+y[1-u]),l.x=y[0],l.y=y[1],l.markRedraw()}return w},t.prototype._layoutContentAndController=function(r,n,i,a,o,s,l,u){var f=this.getContentGroup(),c=this._containerGroup,h=this._controllerGroup;Vb(r.get("orient"),f,r.get("itemGap"),a?i.width:null,a?null:i.height),Vb("horizontal",h,r.get("pageButtonItemGap",!0));var d=f.getBoundingRect(),v=h.getBoundingRect(),g=this._showController=d[o]>i[o],y=[-d.x,-d.y];n||(y[a]=f[u]);var b=[0,0],w=[-v.x,-v.y],_=Tr(r.get("pageButtonGap",!0),r.get("itemGap",!0));if(g){var x=r.get("pageButtonPosition",!0);x==="end"?w[a]+=i[o]-v[o]:b[a]+=v[o]+_}w[1-a]+=d[s]/2-v[s]/2,f.setPosition(y),c.setPosition(b),h.setPosition(w);var E={x:0,y:0};if(E[o]=g?i[o]:d[o],E[s]=Math.max(d[s],v[s]),E[l]=Math.min(0,v[l]+w[1-a]),c.__rectSize=i[o],g){var R={x:0,y:0};R[o]=Math.max(i[o]-v[o]-_,0),R[s]=E[s],c.setClipPath(new ci({shape:R})),c.__rectSize=R[o]}else h.eachChild(function(N){N.attr({invisible:!0,silent:!0})});var A=this._getPageInfo(r);return A.pageIndex!=null&&ga(f,{x:A.contentPosition[0],y:A.contentPosition[1]},g?r:null),this._updatePageInfoView(r,A),E},t.prototype._pageGo=function(r,n,i){var a=this._getPageInfo(n)[r];a!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:a,legendId:n.id})},t.prototype._updatePageInfoView=function(r,n){var i=this._controllerGroup;ye(["pagePrev","pageNext"],function(f){var c=f+"DataIndex",h=n[c]!=null,d=i.childOfName(f);d&&(d.setStyle("fill",h?r.get("pageIconColor",!0):r.get("pageIconInactiveColor",!0)),d.cursor=h?"pointer":"default")});var a=i.childOfName("pageText"),o=r.get("pageFormatter"),s=n.pageIndex,l=s!=null?s+1:0,u=n.pageCount;a&&o&&a.setStyle("text",Rt(o)?o.replace("{current}",l==null?"":l+"").replace("{total}",u==null?"":u+""):o({current:l,total:u}))},t.prototype._getPageInfo=function(r){var n=r.get("scrollDataIndex",!0),i=this.getContentGroup(),a=this._containerGroup.__rectSize,o=r.getOrient().index,s=RM[o],l=kM[o],u=this._findTargetItemIndex(n),f=i.children(),c=f[u],h=f.length,d=h?1:0,v={contentPosition:[i.x,i.y],pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return v;var g=x(c);v.contentPosition[o]=-g.s;for(var y=u+1,b=g,w=g,_=null;y<=h;++y)_=x(f[y]),(!_&&w.e>b.s+a||_&&!E(_,b.s))&&(w.i>b.i?b=w:b=_,b&&(v.pageNextDataIndex==null&&(v.pageNextDataIndex=b.i),++v.pageCount)),w=_;for(var y=u-1,b=g,w=g,_=null;y>=-1;--y)_=x(f[y]),(!_||!E(w,_.s))&&b.i<w.i&&(w=b,v.pagePrevDataIndex==null&&(v.pagePrevDataIndex=b.i),++v.pageCount,++v.pageIndex),b=_;return v;function x(R){if(R){var A=R.getBoundingRect(),N=A[l]+R[l];return{s:N,e:N+A[s],i:R.__legendDataIndex}}}function E(R,A){return R.e>=A&&R.s<=A+a}},t.prototype._findTargetItemIndex=function(r){if(!this._showController)return 0;var n,i=this.getContentGroup(),a;return i.eachChild(function(o,s){var l=o.__legendDataIndex;a==null&&l!=null&&(a=s),l===r&&(n=s)}),n??a},t.type="legend.scroll",t}(Bse);const A$e=k$e;function P$e(e){e.registerAction("legendScroll","legendscroll",function(t,r){var n=t.scrollDataIndex;n!=null&&r.eachComponent({mainType:"legend",subType:"scroll",query:t},function(i){i.setScrollDataIndex(n)})})}function I$e(e){xc(Wse),e.registerComponentModel(R$e),e.registerComponentView(A$e),P$e(e)}function M$e(e){xc(Wse),xc(I$e)}var AM=null;function D$e(e){return AM||(AM=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),AM(e)}var PM=null;function $$e(e){PM||(PM=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),PM(e)}function N$e(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function Ix(e,t){t===void 0&&(t={});var r=document.createElement(e);return Object.keys(t).forEach(function(n){r[n]=t[n]}),r}function Vse(e,t,r){var n=window.getComputedStyle(e,r||null)||{display:"none"};return n[t]}function xN(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Vse(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var L$e='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',TN=0,lO=null;function F$e(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=W$e.bind(e));var r=e.__resize_listeners__;if(!r){if(e.__resize_listeners__=[],window.ResizeObserver){var n=e.offsetWidth,i=e.offsetHeight,a=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===n&&e.offsetHeight===i)||AE(e)}),o=xN(e),s=o.detached,l=o.rendered;e.__resize_observer_triggered__=s===!1&&l===!1,e.__resize_observer__=a,a.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){AE(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(TN||(lO=N$e(L$e)),V$e(e),e.__resize_rendered__=xN(e).rendered,window.MutationObserver){var u=new MutationObserver(e.__resize_mutation_handler__);u.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=u}}e.__resize_listeners__.push(t),TN++}function H$e(e,t){var r=e.__resize_listeners__;if(r){if(t&&r.splice(r.indexOf(t),1),!r.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",Q3),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--TN&&lO&&lO.parentNode.removeChild(lO)}}function B$e(e){var t=e.__resize_last__,r=t.width,n=t.height,i=e.offsetWidth,a=e.offsetHeight;return i!==r||a!==n?{width:i,height:a}:null}function W$e(){var e=xN(this),t=e.rendered,r=e.detached;t!==this.__resize_rendered__&&(!r&&this.__resize_triggers__&&(e4(this),this.addEventListener("scroll",Q3,!0)),this.__resize_rendered__=t,AE(this))}function Q3(){var e=this;e4(this),this.__resize_raf__&&$$e(this.__resize_raf__),this.__resize_raf__=D$e(function(){var t=B$e(e);t&&(e.__resize_last__=t,AE(e))})}function AE(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function V$e(e){var t=Vse(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var r=Ix("div",{className:"resize-triggers"}),n=Ix("div",{className:"resize-expand-trigger"}),i=Ix("div"),a=Ix("div",{className:"resize-contract-trigger"});n.appendChild(i),r.appendChild(n),r.appendChild(a),e.appendChild(r),e.__resize_triggers__={triggers:r,expand:n,expandChild:i,contract:a},e4(e),e.addEventListener("scroll",Q3,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function e4(e){var t=e.__resize_triggers__,r=t.expand,n=t.expandChild,i=t.contract,a=i.scrollWidth,o=i.scrollHeight,s=r.offsetWidth,l=r.offsetHeight,u=r.scrollWidth,f=r.scrollHeight;i.scrollLeft=a,i.scrollTop=o,n.style.width=s+1+"px",n.style.height=l+1+"px",r.scrollLeft=u,r.scrollTop=f}var Zl=function(){return Zl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Zl.apply(this,arguments)},U$e=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function j$e(e){return t=Object.create(null),U$e.forEach(function(r){t[r]=function(n){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[n].apply(e.value,i)}}(r)}),t;var t}var z$e={autoresize:Boolean},G$e=/^on[^a-z]/,Y$e=function(e){return G$e.test(e)};function Mx(e,t){var r=ln(e);return r&&typeof r=="object"&&"value"in r?r.value||t:r||t}var K$e={loading:Boolean,loadingOptions:Object},$0=null,M9=[],N0=[];(function(e,t){if(e&&typeof document<"u"){var r,n=t.prepend===!0?"prepend":"append",i=t.singleTag===!0,a=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var o=M9.indexOf(a);o===-1&&(o=M9.push(a)-1,N0[o]={}),r=N0[o]&&N0[o][n]?N0[o][n]:N0[o][n]=s()}else r=s();e.charCodeAt(0)===65279&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function s(){var l=document.createElement("style");if(l.setAttribute("type","text/css"),t.attributes)for(var u=Object.keys(t.attributes),f=0;f<u.length;f++)l.setAttribute(u[f],t.attributes[u[f]]);var c=n==="prepend"?"afterbegin":"beforeend";return a.insertAdjacentElement(c,l),l}})(`x-vue-echarts{display:block;width:100%;height:100%;min-width:0}
`,{});var X$e=function(){if($0!=null)return $0;if(typeof HTMLElement>"u"||typeof customElements>"u")return $0=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)("x-vue-echarts")}catch{return $0=!1}return $0=!0}(),q$e="ecTheme",Z$e=ba({name:"echarts",props:Zl(Zl({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},z$e),K$e),emits:{},inheritAttrs:!1,setup:function(e,t){var r=t.attrs,n=uI(),i=uI(),a=uI(),o=db("ecTheme",null),s=db("ecInitOptions",null),l=db("ecUpdateOptions",null),u=Q1e(e),f=u.autoresize,c=u.manualUpdate,h=u.loading,d=u.loadingOptions,v=_s(function(){return a.value||e.option||null}),g=_s(function(){return e.theme||Mx(o,{})}),y=_s(function(){return e.initOptions||Mx(s,{})}),b=_s(function(){return e.updateOptions||Mx(l,{})}),w=_s(function(){return function(N){var I={};for(var F in N)Y$e(F)||(I[F]=N[F]);return I}(r)}),_=eCe().proxy.$listeners;function x(N){if(n.value){var I=i.value=$Pe(n.value,g.value,y.value);e.group&&(I.group=e.group);var F=_;F||(F={},Object.keys(r).filter(function(W){return W.indexOf("on")===0&&W.length>2}).forEach(function(W){var z=W.charAt(2).toLowerCase()+W.slice(3);z.substring(z.length-4)==="Once"&&(z="~".concat(z.substring(0,z.length-4))),F[z]=r[W]})),Object.keys(F).forEach(function(W){var z=F[W];if(z){var te=W.toLowerCase();te.charAt(0)==="~"&&(te=te.substring(1),z.__once__=!0);var ie=I;if(te.indexOf("zr:")===0&&(ie=I.getZr(),te=te.substring(3)),z.__once__){delete z.__once__;var fe=z;z=function(){for(var Te=[],M=0;M<arguments.length;M++)Te[M]=arguments[M];fe.apply(void 0,Te),ie.off(te,z)}}ie.on(te,z)}}),f.value?eE(function(){I&&!I.isDisposed()&&I.resize(),H()}):H()}function H(){var W=N||v.value;W&&I.setOption(W,b.value)}}function E(){i.value&&(i.value.dispose(),i.value=void 0)}var R=null;kp(c,function(N){typeof R=="function"&&(R(),R=null),N||(R=kp(function(){return e.option},function(I,F){I&&(i.value?i.value.setOption(I,Zl({notMerge:I!==F},b.value)):x())},{deep:!0}))},{immediate:!0}),kp([g,y],function(){E(),x()},{deep:!0}),K5(function(){e.group&&i.value&&(i.value.group=e.group)});var A=j$e(i);return function(N,I,F){var H=db("ecLoadingOptions",{}),W=_s(function(){return Zl(Zl({},Mx(H,{})),F==null?void 0:F.value)});K5(function(){var z=N.value;z&&(I.value?z.showLoading(W.value):z.hideLoading())})}(i,h,d),function(N,I,F){var H=null;kp([F,N,I],function(W,z,te){var ie=W[0],fe=W[1],Te=W[2];ie&&fe&&Te&&(H=Pk(function(){fe.resize()},100),F$e(ie,H)),te(function(){H&&ie&&H$e(ie,H)})})}(i,f,n),Yd(function(){x()}),tCe(function(){X$e&&n.value?n.value.__dispose=E:E()}),Zl({chart:i,root:n,setOption:function(N,I){e.manualUpdate&&(a.value=N),i.value?i.value.setOption(N,I||{}):x(N)},nonEventAttrs:w},A)},render:function(){var e=Zl({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",rCe("x-vue-echarts",e)}});const J$e={type:"bar"},Q$e={type:"DYNAMIC_RANKING_BAR"},eNe={type:"DYNAMIC_RING"},tNe={type:"line"},rNe={type:"pie"},nNe={type:"bar"},iNe={type:"ring"},Nk={DYNAMIC_LINE_BAR_MIX:J$e,DYNAMIC_RANKING_BAR:Q$e,DYNAMIC_RING:eNe,LINE_BASICS:tNe,PIE_BASICS:rNe,BAR_BASICS:nNe,RING_BASICS:iNe},ON={westeros:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],wonderland:["#4ea397","#22c3aa","#7bd9a5","#d0648a","#f58db2","#f2b3c9"],walden:["#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],chalk:["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb","#d2f5a6","#76f2f2"],macarons:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"]},aNe=Object.keys(ON).map(e=>({value:e,color:ON[e]})),Use=e=>{var r;const t=(r=e==null?void 0:e.config)==null?void 0:r.title;return{title:{show:t.show,text:t.value,left:10,top:10}}},jse=e=>{var r;const t=((r=e==null?void 0:e.config)==null?void 0:r.theme)||"westeros";return{color:ON[t]}},pl=(e,t)=>{const{type:r}=e;return Nk[r].type===t},zse=e=>{const{config:t}=e;return{legend:{show:t==null?void 0:t.legend,bottom:"10"}}},Gse=e=>{var n;const{type:t}=e,r=(n=Nk[t])==null?void 0:n.type;return!!["bar","line"].includes(r)},oNe=e=>{const{config:t}=e,{data:r=[]}=t,n={};if(Gse(e)){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{xAxis:n}}return{}},sNe=e=>{const{config:t,type:r}=e,{data:n=[]}=t,a=Nk[r].type,o=[],s=io.cloneDeep(n);if((pl(e,"line")||pl(e,"bar"))&&(s[0].shift(),s[0].forEach((u,f)=>{const c={name:u,type:a,data:[],markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]}};for(let h=1;h<s.length;h++){const d=s[h];c.data.push(+d[f+1])}o.push(c)}),console.log("series: ",o)),pl(e,"pie")){const l={name:s.shift()[0],radius:"50%",data:[],type:a};s.forEach(u=>{const[f,c]=u;l.data.push({value:c,name:f})}),o.push(l)}if(pl(e,"ring")){const l={name:s.shift()[0],data:[],radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},type:"pie"};s.forEach(u=>{const[f,c]=u;l.data.push({value:c,name:f})}),o.push(l)}return{series:o}},lNe=e=>{const t={};return Gse(e)?(t.type="value",{yAxis:t}):{}};function uNe(e){const t=io.cloneDeep(e),r=oNe(t),n=lNe(t),i=sNe(t),a=zse(t),o=Use(t),l={...jse(t),...r,...n,...i,...a,...o,backgroundColor:"#fff",grid:{},tooltip:{trigger:"item"}};return console.log("option: ",l),l}const fNe=e=>{const t={axisTick:{show:!1}};return pl(e,"DYNAMIC_RANKING_BAR")?(t.type="value",{xAxis:t}):{}},cNe=e=>{const{config:t}=e,{data:r=[]}=t,n={axisTick:{show:!1}};if(pl(e,"DYNAMIC_RANKING_BAR")){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{yAxis:n}}return{}},hNe=e=>{const{config:t,type:r}=e,{data:n=[]}=t;Nk[r].type;const a=[],o=io.cloneDeep(n);if(pl(e,"DYNAMIC_RANKING_BAR")&&(o[0].shift(),o[0].forEach((l,u)=>{const f={name:l,type:"bar",barMaxWidth:40,data:[]};for(let c=1;c<o.length;c++){const h=o[c];f.data.push(+h[u+1])}a.push(f)})),pl(e,"DYNAMIC_RING")){const s={name:o.shift()[0],data:[],radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},type:"pie"};o.forEach(l=>{const[u,f]=l;s.data.push({value:f,name:u})}),a.push(s)}return{series:a}},dNe=(e,t)=>{const r=io.cloneDeep(e.config.data),n=r.shift();if(pl(e,"DYNAMIC_RANKING_BAR")){const i=r.reverse().filter((a,o)=>o<=t);return i.unshift(n),i}return pl(e,"DYNAMIC_RING")?n.map((a,o)=>[a,r[t][o]]):r};function D9(e,t){const r=io.cloneDeep(e),{config:n}=r;n.data=dNe(r,t);const{animation:i}=n,a=fNe(r),o=cNe(r),s=hNe(r),l=zse(r),u=Use(r);return{...jse(r),...a,...o,...s,...l,...u,backgroundColor:"#fff",animationDuration:i.moveTime*1e3,animationEasing:"linear",animationEasingUpdate:"linear",grid:{},tooltip:{trigger:"item"}}}const vNe=1e3;let Lk=null,Dp=0;const i1=da("clear"),pNe=e=>{var r;return(((r=e==null?void 0:e.config)==null?void 0:r.data)||[]).length-1},$9=(e,t)=>{Lk=setInterval(()=>{i1.value="start",Dp=Dp+1,Dp>=pNe(e)&&yNe(),t&&t(Dp-1)},vNe)},gNe=()=>{i1.value="stop",clearInterval(Lk)},yNe=()=>{clearInterval(Lk),setTimeout(()=>{i1.value="end",Dp=0},1e3)},Yse=()=>{i1.value="clear",clearInterval(Lk),Dp=0};Ine(()=>{Yse()});const N9=(e,t,r="png")=>{const n=document.createElement("a");n.download=e.name+"."+r,n.href=t,document.body.appendChild(n),n.click(),n.remove()};var EN={},mNe={get exports(){return EN},set exports(e){EN=e}};(function(e,t){(function(r,n,i,a){var o={URL:r.URL||r.webkitURL||r.mozURL||r.msURL,getUserMedia:function(){var M=i.getUserMedia||i.webkitGetUserMedia||i.mozGetUserMedia||i.msGetUserMedia;return M&&M.bind(i)}(),requestAnimFrame:r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame,requestTimeout:function(S,T){if(S=S||o.noop,T=T||0,!o.requestAnimFrame)return setTimeout(S,T);var k=new Date().getTime(),O=new Object,D=o.requestAnimFrame,L=function B(){var Y=new Date().getTime(),Q=Y-k;Q>=T?S.call():O.value=D(B)};return O.value=D(L),O},Blob:r.Blob||r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder,btoa:function(){var M=r.btoa||function(S){for(var T="",k=0,O=S.length,D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",L=void 0,B=void 0,Y=void 0,Q=void 0,he=void 0,ce=void 0,le=void 0;k<O;)L=S.charCodeAt(k++),B=S.charCodeAt(k++),Y=S.charCodeAt(k++),Q=L>>2,he=(L&3)<<4|B>>4,ce=(B&15)<<2|Y>>6,le=Y&63,isNaN(B)?ce=le=64:isNaN(Y)&&(le=64),T=T+D.charAt(Q)+D.charAt(he)+D.charAt(ce)+D.charAt(le);return T};return M?M.bind(r):o.noop}(),isObject:function(S){return S&&Object.prototype.toString.call(S)==="[object Object]"},isEmptyObject:function(S){return o.isObject(S)&&!Object.keys(S).length},isArray:function(S){return S&&Array.isArray(S)},isFunction:function(S){return S&&typeof S=="function"},isElement:function(S){return S&&S.nodeType===1},isString:function(S){return typeof S=="string"||Object.prototype.toString.call(S)==="[object String]"},isSupported:{canvas:function(){var S=n.createElement("canvas");return S&&S.getContext&&S.getContext("2d")},webworkers:function(){return r.Worker},blob:function(){return o.Blob},Uint8Array:function(){return r.Uint8Array},Uint32Array:function(){return r.Uint32Array},videoCodecs:function(){var M=n.createElement("video"),S={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{M&&M.canPlayType&&(S.mp4=M.canPlayType('video/mp4; codecs="mp4v.20.8"')!=="",S.h264=(M.canPlayType('video/mp4; codecs="avc1.42E01E"')||M.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))!=="",S.ogv=M.canPlayType('video/ogg; codecs="theora"')!=="",S.ogg=M.canPlayType('video/ogg; codecs="theora"')!=="",S.webm=M.canPlayType('video/webm; codecs="vp8, vorbis"')!==-1)}catch{}return S}()},noop:function(){},each:function(S,T){var k=void 0,O=void 0;if(o.isArray(S))for(k=-1,O=S.length;++k<O&&T(k,S[k])!==!1;);else if(o.isObject(S)){for(k in S)if(S.hasOwnProperty(k)&&T(k,S[k])===!1)break}},mergeOptions:function(S,T){if(!(!o.isObject(S)||!o.isObject(T)||!Object.keys)){var k={};return o.each(S,function(O,D){k[O]=S[O]}),o.each(T,function(O,D){var L=T[O];o.isObject(L)&&S[O]?k[O]=o.mergeOptions(S[O],L):k[O]=L}),k}},setCSSAttr:function(S,T,k){o.isElement(S)&&(o.isString(T)&&o.isString(k)?S.style[T]=k:o.isObject(T)&&o.each(T,function(O,D){S.style[O]=D}))},removeElement:function(S){o.isElement(S)&&S.parentNode&&S.parentNode.removeChild(S)},createWebWorker:function(S){if(!o.isString(S))return{};try{var T=new o.Blob([S],{type:"text/javascript"}),k=o.URL.createObjectURL(T),O=new Worker(k);return{objectUrl:k,worker:O}}catch(D){return""+D}},getExtension:function(S){return S.substr(S.lastIndexOf(".")+1,S.length)},getFontSize:function(){var S=arguments.length>0&&arguments[0]!==a?arguments[0]:{};if(!n.body||S.resizeFont===!1)return S.fontSize;var T=S.text,k=S.gifWidth,O=parseInt(S.fontSize,10),D=parseInt(S.minFontSize,10),L=n.createElement("div"),B=n.createElement("span");for(L.setAttribute("width",k),L.appendChild(B),B.innerHTML=T,B.style.fontSize=O+"px",B.style.textIndent="-9999px",B.style.visibility="hidden",n.body.appendChild(B);B.offsetWidth>k&&O>=D;)B.style.fontSize=--O+"px";return n.body.removeChild(B),O+"px"},webWorkerError:!1},s=Object.freeze({default:o}),l={validate:function(S){S=o.isObject(S)?S:{};var T={};return o.each(l.validators,function(k,O){var D=O.errorCode;if(!S[D]&&!O.condition)return T=O,T.error=!0,!1}),delete T.condition,T},isValid:function(S){var T=l.validate(S),k=T.error!==!0;return k},validators:[{condition:o.isFunction(o.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:o.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:o.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:o.isFunction(o.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:o.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:o.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:o.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},u=Object.freeze({default:l}),f=function(){},c={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:f,completeCallback:f,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},h=Object.freeze({default:c});function d(){return l.isValid()}function v(){return l.isValid()}function g(){var M={getUserMedia:!0};return l.isValid(M)}function y(M){var S=!1;if(o.isArray(M)&&M.length){if(o.each(M,function(T,k){o.isSupported.videoCodecs[k]&&(S=!0)}),!S)return!1}else if(o.isString(M)&&M.length&&!o.isSupported.videoCodecs[M])return!1;return l.isValid({getUserMedia:!0})}function b(){var M=256,S=499,T=491,k=487,O=503,D=3*O,L=M-1,B=4,Y=100,Q=16,he=1<<Q,ce=10,le=10,xe=he>>le,U=he<<ce-le,De=M>>3,de=6,He=1<<de,Be=De*He,Ae=30,Ke=10,Xe=1<<Ke,G,q=8,ae=1<<q,be=Ke+q,se=1<<be,Oe,pe,ge,me,Ce=[],Se=[],Le=[],qe=[];function Qe(st,rt,_t){var tt,Tt;for(Oe=st,pe=rt,ge=_t,me=new Array(M),tt=0;tt<M;tt++)me[tt]=new Array(4),Tt=me[tt],Tt[0]=Tt[1]=Tt[2]=(tt<<B+8)/M|0,Le[tt]=he/M|0,Se[tt]=0}function wt(){for(var st=[],rt=new Array(M),_t=0;_t<M;_t++)rt[me[_t][3]]=_t;for(var tt=0,Tt=0;Tt<M;Tt++){var nt=rt[Tt];st[tt++]=me[nt][0],st[tt++]=me[nt][1],st[tt++]=me[nt][2]}return st}function Pt(){var st,rt,_t,tt,Tt,nt,ht,cr;for(ht=0,cr=0,st=0;st<M;st++){for(Tt=me[st],_t=st,tt=Tt[1],rt=st+1;rt<M;rt++)nt=me[rt],nt[1]<tt&&(_t=rt,tt=nt[1]);if(nt=me[_t],st!=_t&&(rt=nt[0],nt[0]=Tt[0],Tt[0]=rt,rt=nt[1],nt[1]=Tt[1],Tt[1]=rt,rt=nt[2],nt[2]=Tt[2],Tt[2]=rt,rt=nt[3],nt[3]=Tt[3],Tt[3]=rt),tt!=ht){for(Ce[ht]=cr+st>>1,rt=ht+1;rt<tt;rt++)Ce[rt]=st;ht=tt,cr=st}}for(Ce[ht]=cr+L>>1,rt=ht+1;rt<256;rt++)Ce[rt]=L}function Jt(){var st,rt,_t,tt,Tt,nt,ht,cr,dr,br,ni,Dr,j,re;for(pe<D&&(ge=1),G=30+(ge-1)/3,Dr=Oe,j=0,re=pe,ni=pe/(3*ge),br=ni/Y|0,cr=Xe,nt=Be,ht=nt>>de,ht<=1&&(ht=0),st=0;st<ht;st++)qe[st]=cr*((ht*ht-st*st)*ae/(ht*ht));for(pe<D?dr=3:pe%S!==0?dr=3*S:pe%T!==0?dr=3*T:pe%k!==0?dr=3*k:dr=3*O,st=0;st<ni;)if(_t=(Dr[j+0]&255)<<B,tt=(Dr[j+1]&255)<<B,Tt=(Dr[j+2]&255)<<B,rt=Ht(_t,tt,Tt),zt(cr,rt,_t,tt,Tt),ht!==0&&qt(ht,rt,_t,tt,Tt),j+=dr,j>=re&&(j-=pe),st++,br===0&&(br=1),st%br===0)for(cr-=cr/G,nt-=nt/Ae,ht=nt>>de,ht<=1&&(ht=0),rt=0;rt<ht;rt++)qe[rt]=cr*((ht*ht-rt*rt)*ae/(ht*ht))}function Ot(st,rt,_t){var tt,Tt,nt,ht,cr,dr,br;for(cr=1e3,br=-1,tt=Ce[rt],Tt=tt-1;tt<M||Tt>=0;)tt<M&&(dr=me[tt],nt=dr[1]-rt,nt>=cr?tt=M:(tt++,nt<0&&(nt=-nt),ht=dr[0]-st,ht<0&&(ht=-ht),nt+=ht,nt<cr&&(ht=dr[2]-_t,ht<0&&(ht=-ht),nt+=ht,nt<cr&&(cr=nt,br=dr[3])))),Tt>=0&&(dr=me[Tt],nt=rt-dr[1],nt>=cr?Tt=-1:(Tt--,nt<0&&(nt=-nt),ht=dr[0]-st,ht<0&&(ht=-ht),nt+=ht,nt<cr&&(ht=dr[2]-_t,ht<0&&(ht=-ht),nt+=ht,nt<cr&&(cr=nt,br=dr[3]))));return br}function Et(){return Jt(),jt(),Pt(),wt()}function jt(){var st;for(st=0;st<M;st++)me[st][0]>>=B,me[st][1]>>=B,me[st][2]>>=B,me[st][3]=st}function qt(st,rt,_t,tt,Tt){var nt,ht,cr,dr,br,ni,Dr;for(cr=rt-st,cr<-1&&(cr=-1),dr=rt+st,dr>M&&(dr=M),nt=rt+1,ht=rt-1,ni=1;nt<dr||ht>cr;){if(br=qe[ni++],nt<dr){Dr=me[nt++];try{Dr[0]-=br*(Dr[0]-_t)/se|0,Dr[1]-=br*(Dr[1]-tt)/se|0,Dr[2]-=br*(Dr[2]-Tt)/se|0}catch{}}if(ht>cr){Dr=me[ht--];try{Dr[0]-=br*(Dr[0]-_t)/se|0,Dr[1]-=br*(Dr[1]-tt)/se|0,Dr[2]-=br*(Dr[2]-Tt)/se|0}catch{}}}}function zt(st,rt,_t,tt,Tt){var nt=me[rt],ht=st/Xe;nt[0]-=ht*(nt[0]-_t)|0,nt[1]-=ht*(nt[1]-tt)|0,nt[2]-=ht*(nt[2]-Tt)|0}function Ht(st,rt,_t){var tt,Tt,nt,ht,cr,dr,br,ni,Dr,j;for(ni=~(1<<31),Dr=ni,dr=-1,br=dr,tt=0;tt<M;tt++)j=me[tt],Tt=j[0]-st,Tt<0&&(Tt=-Tt),nt=j[1]-rt,nt<0&&(nt=-nt),Tt+=nt,nt=j[2]-_t,nt<0&&(nt=-nt),Tt+=nt,Tt<ni&&(ni=Tt,dr=tt),ht=Tt-(Se[tt]>>Q-B),ht<Dr&&(Dr=ht,br=tt),cr=Le[tt]>>le,Le[tt]-=cr,Se[tt]+=cr<<ce;return Le[dr]+=xe,Se[dr]-=U,br}Qe.apply(this,arguments);var At={};return At.map=Ot,At.process=Et,At}function w(){var M=this;try{M.onmessage=function(T){var k=T.data||{},O;k.gifshot&&(O=S.run(k),postMessage(O))}}catch{}var S={dataToRGB:function(k,O,D){for(var L=O*D*4,B=0,Y=[];B<L;)Y.push(k[B++]),Y.push(k[B++]),Y.push(k[B++]),B++;return Y},componentizedPaletteToArray:function(k){k=k||[];for(var O=[],D=0;D<k.length;D+=3){var L=k[D],B=k[D+1],Y=k[D+2];O.push(L<<16|B<<8|Y)}return O},processFrameWithQuantizer:function(k,O,D,L){for(var B=this.dataToRGB(k,O,D),Y=new b(B,B.length,L),Q=Y.process(),he=new Uint32Array(this.componentizedPaletteToArray(Q)),ce=O*D,le=new Uint8Array(ce),xe=0,U=0;U<ce;U++){var De=B[xe++],de=B[xe++],He=B[xe++];le[U]=Y.map(De,de,He)}return{pixels:le,palette:he}},run:function(k){k=k||{};var O=k,D=O.height;O.palette;var L=O.sampleInterval,B=O.width,Y=k.data;return this.processFrameWithQuantizer(Y,B,D,L)}};return S}function _(M,S,T,k){var O=0;k=k===a?{}:k;var D=k.loop===a?null:k.loop,L=k.palette===a?null:k.palette;if(S<=0||T<=0||S>65535||T>65535)throw"Width/Height invalid.";function B(le){var xe=le.length;if(xe<2||xe>256||xe&xe-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return xe}M[O++]=71,M[O++]=73,M[O++]=70,M[O++]=56,M[O++]=57,M[O++]=97;var Y=0,Q=0;if(M[O++]=S&255,M[O++]=S>>8&255,M[O++]=T&255,M[O++]=T>>8&255,M[O++]=(L!==null?128:0)|Y,M[O++]=Q,M[O++]=0,D!==null){if(D<0||D>65535)throw"Loop count invalid.";M[O++]=33,M[O++]=255,M[O++]=11,M[O++]=78,M[O++]=69,M[O++]=84,M[O++]=83,M[O++]=67,M[O++]=65,M[O++]=80,M[O++]=69,M[O++]=50,M[O++]=46,M[O++]=48,M[O++]=3,M[O++]=1,M[O++]=D&255,M[O++]=D>>8&255,M[O++]=0}var he=!1;this.addFrame=function(le,xe,U,De,de,He){if(he===!0&&(--O,he=!1),He=He===a?{}:He,le<0||xe<0||le>65535||xe>65535)throw"x/y invalid.";if(U<=0||De<=0||U>65535||De>65535)throw"Width/Height invalid.";if(de.length<U*De)throw"Not enough pixels for the frame size.";var Be=!0,Ae=He.palette;if((Ae===a||Ae===null)&&(Be=!1,Ae=L),Ae===a||Ae===null)throw"Must supply either a local or global palette.";for(var Ke=B(Ae),Xe=0;Ke>>=1;)++Xe;Ke=1<<Xe;var G=He.delay===a?0:He.delay,q=He.disposal===a?0:He.disposal;if(q<0||q>3)throw"Disposal out of range.";var ae=!1,be=0;if(He.transparent!==a&&He.transparent!==null&&(ae=!0,be=He.transparent,be<0||be>=Ke))throw"Transparent color index.";if((q!==0||ae||G!==0)&&(M[O++]=33,M[O++]=249,M[O++]=4,M[O++]=q<<2|(ae===!0?1:0),M[O++]=G&255,M[O++]=G>>8&255,M[O++]=be,M[O++]=0),M[O++]=44,M[O++]=le&255,M[O++]=le>>8&255,M[O++]=xe&255,M[O++]=xe>>8&255,M[O++]=U&255,M[O++]=U>>8&255,M[O++]=De&255,M[O++]=De>>8&255,M[O++]=Be===!0?128|Xe-1:0,Be===!0)for(var se=0,Oe=Ae.length;se<Oe;++se){var pe=Ae[se];M[O++]=pe>>16&255,M[O++]=pe>>8&255,M[O++]=pe&255}O=ce(M,O,Xe<2?2:Xe,de)},this.end=function(){return he===!1&&(M[O++]=59,he=!0),O};function ce(le,xe,U,De){le[xe++]=U;var de=xe++,He=1<<U,Be=He-1,Ae=He+1,Ke=Ae+1,Xe=U+1,G=0,q=0;function ae(Le){for(;G>=Le;)le[xe++]=q&255,q>>=8,G-=8,xe===de+256&&(le[de]=255,de=xe++)}function be(Le){q|=Le<<G,G+=Xe,ae(8)}var se=De[0]&Be,Oe={};be(He);for(var pe=1,ge=De.length;pe<ge;++pe){var me=De[pe]&Be,Ce=se<<8|me,Se=Oe[Ce];if(Se===a){for(q|=se<<G,G+=Xe;G>=8;)le[xe++]=q&255,q>>=8,G-=8,xe===de+256&&(le[de]=255,de=xe++);Ke===4096?(be(He),Ke=Ae+1,Xe=U+1,Oe={}):(Ke>=1<<Xe&&++Xe,Oe[Ce]=Ke++),se=me}else se=Se}return be(se),be(Ae),ae(1),de+1===xe?le[de]=0:(le[de]=xe-de-1,le[xe++]=0),xe}}var x=function(){},E=function(S){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=x,this.onRenderProgressCallback=x,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=S,this.initializeWebWorkers(S)};E.prototype={workerMethods:w(),initializeWebWorkers:function(S){var T=this,k=b.toString()+"("+w.toString()+"());",O=void 0,D=void 0,L=void 0,B=void 0,Y=-1,Q="";for(B=S.numWorkers;++Y<B;)O=o.createWebWorker(k),o.isObject(O)?(D=O.objectUrl,L=O.worker,T.workers.push({worker:L,objectUrl:D}),T.availableWorkers.push(L)):(Q=O,o.webWorkerError=!!O);this.workerError=Q,this.canvas=n.createElement("canvas"),this.canvas.width=S.gifWidth,this.canvas.height=S.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(S){this.availableWorkers.push(S)},byteMap:function(){for(var M=[],S=0;S<256;S++)M[S]=String.fromCharCode(S);return M}(),bufferToString:function(S){for(var T=S.length,k="",O=-1;++O<T;)k+=this.byteMap[S[O]];return k},onFrameFinished:function(S){var T=this,k=T.frames,O=T.options,D=!!(O.images||[]).length,L=k.every(function(B){return!B.beingProcessed&&B.done});T.numRenderedFrames++,D&&S(T.numRenderedFrames/k.length),T.onRenderProgressCallback(T.numRenderedFrames*.75/k.length),L?T.generatingGIF||T.generateGIF(k,T.onRenderCompleteCallback):o.requestTimeout(function(){T.processNextFrame()},1)},processFrame:function(S){var T=this;this.options;var k=this.options,O=k.progressCallback,D=k.sampleInterval,L=this.frames,B=void 0,Y=void 0,Q=function(){var ce=arguments.length>0&&arguments[0]!==a?arguments[0]:{},le=ce.data;delete B.data,B.pixels=Array.prototype.slice.call(le.pixels),B.palette=Array.prototype.slice.call(le.palette),B.done=!0,B.beingProcessed=!1,T.freeWorker(Y),T.onFrameFinished(O)};if(B=L[S],B.beingProcessed||B.done){this.onFrameFinished();return}B.sampleInterval=D,B.beingProcessed=!0,B.gifshot=!0,Y=this.getWorker(),Y?(Y.onmessage=Q,Y.postMessage(B)):Q({data:T.workerMethods.run(B)})},startRendering:function(S){this.onRenderCompleteCallback=S;for(var T=0;T<this.options.numWorkers&&T<this.frames.length;T++)this.processFrame(T)},processNextFrame:function(){for(var S=-1,T=0;T<this.frames.length;T++){var k=this.frames[T];if(!k.done&&!k.beingProcessed){S=T;break}}S>=0&&this.processFrame(S)},generateGIF:function(S,T){var k=[],O={loop:this.repeat},D=this.options,L=D.interval,B=D.frameDuration,Y=D.images,Q=!!Y.length,he=D.gifHeight,ce=D.gifWidth,le=new _(k,ce,he,O),xe=this.onRenderProgressCallback,U=Q?L*100:0,De=void 0,de=void 0;this.generatingGIF=!0,o.each(S,function(He,Be){var Ae=Be.palette;xe(.75+.25*Be.position*1/S.length);for(var Ke=0;Ke<B;Ke++)le.addFrame(0,0,ce,he,Be.pixels,{palette:Ae,delay:U})}),le.end(),xe(1),this.frames=[],this.generatingGIF=!1,o.isFunction(T)&&(De=this.bufferToString(k),de="data:image/gif;base64,"+o.btoa(De),T(de))},setRepeat:function(S){this.repeat=S},addFrame:function(S,T){T=o.isObject(T)?T:{};var k=this,O=k.ctx,D=k.options,L=D.gifWidth,B=D.gifHeight,Y=o.getFontSize(T),Q=T,he=Q.filter,ce=Q.fontColor,le=Q.fontFamily,xe=Q.fontWeight;Q.gifHeight,Q.gifWidth;var U=Q.text,De=Q.textAlign,de=Q.textBaseline,He=T.textXCoordinate?T.textXCoordinate:De==="left"?1:De==="right"?L:L/2,Be=T.textYCoordinate?T.textYCoordinate:de==="top"?1:de==="center"?B/2:B,Ae=xe+" "+Y+" "+le,Ke=void 0;try{O.filter=he,O.drawImage(S,0,0,L,B),U&&(O.font=Ae,O.fillStyle=ce,O.textAlign=De,O.textBaseline=de,O.fillText(U,He,Be)),Ke=O.getImageData(0,0,L,B),k.addFrameImageData(Ke)}catch(Xe){return""+Xe}},addFrameImageData:function(){var S=arguments.length>0&&arguments[0]!==a?arguments[0]:{},T=this.frames,k=S.data;this.frames.push({data:k,width:S.width,height:S.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:T.length})},onRenderProgress:function(S){this.onRenderProgressCallback=S},isRendering:function(){return this.generatingGIF},getBase64GIF:function(S){var T=this,k=function(D){T.destroyWorkers(),o.requestTimeout(function(){S(D)},0)};T.startRendering(k)},destroyWorkers:function(){if(!this.workerError){var S=this.workers;o.each(S,function(T,k){var O=k.worker,D=k.objectUrl;O.terminate(),o.URL.revokeObjectURL(D)})}}};function R(M,S){M.getBase64GIF(function(T){S({error:!1,errorCode:"",errorMsg:"",image:T})})}function A(){var M=arguments.length>0&&arguments[0]!==a?arguments[0]:{},S=M.callback,T=M.images,k=M.options,O=M.imagesLength,D={getUserMedia:!0,"window.URL":!0},L=l.validate(D),B=[],Y=0,Q=void 0,he=void 0;if(L.error)return S(L);he=new E(k),o.each(T,function(le,xe){var U=xe;xe.src&&(U=U.src),o.isElement(U)?(k.crossOrigin&&(U.crossOrigin=k.crossOrigin),B[le]=U,Y+=1,Y===O&&ce()):o.isString(U)&&(Q=new Image,k.crossOrigin&&(Q.crossOrigin=k.crossOrigin),function(De){xe.text&&(De.text=xe.text),De.onerror=function(de){var He=void 0;if(--O,O===0)return He={},He.error="None of the requested images was capable of being retrieved",S(He)},De.onload=function(de){xe.text?B[le]={img:De,text:De.text}:B[le]=De,Y+=1,Y===O&&ce(),o.removeElement(De)},De.src=U}(Q),o.setCSSAttr(Q,{position:"fixed",opacity:"0"}),n.body.appendChild(Q))});function ce(){o.each(B,function(le,xe){xe&&(xe.text?he.addFrame(xe.img,k,xe.text):he.addFrame(xe,k))}),R(he,S)}}var N=function(){},I={getGIF:function(){var S=arguments.length>0&&arguments[0]!==a?arguments[0]:{},T=arguments[1];T=o.isFunction(T)?T:N;var k=n.createElement("canvas"),O=void 0,D=S.images,L=!!D.length,B=S.cameraStream,Y=S.crop,Q=S.filter,he=S.fontColor,ce=S.fontFamily,le=S.fontWeight,xe=S.keepCameraOn;S.numWorkers;var U=S.progressCallback,De=S.saveRenderingContexts,de=S.savedRenderingContexts,He=S.text,Be=S.textAlign,Ae=S.textBaseline,Ke=S.videoElement,Xe=S.videoHeight,G=S.videoWidth,q=S.webcamVideoElement,ae=Number(S.gifWidth),be=Number(S.gifHeight),se=Number(S.interval);Number(S.sampleInterval);var Oe=L?0:se*1e3,pe=[],ge=de.length?de.length:S.numFrames,me=ge,Ce=new E(S),Se=o.getFontSize(S),Le=S.textXCoordinate?S.textXCoordinate:Be==="left"?1:Be==="right"?ae:ae/2,qe=S.textYCoordinate?S.textYCoordinate:Ae==="top"?1:Ae==="center"?be/2:be,Qe=le+" "+Se+" "+ce,wt=Y?Math.floor(Y.scaledWidth/2):0,Pt=Y?G-Y.scaledWidth:0,Jt=Y?Math.floor(Y.scaledHeight/2):0,Ot=Y?Xe-Y.scaledHeight:0,Et=function jt(){var qt=me-1;de.length?(O.putImageData(de[ge-me],0,0),Ht()):zt();function zt(){try{Pt>G&&(Pt=G),Ot>Xe&&(Ot=Xe),wt<0&&(wt=0),Jt<0&&(Jt=0),O.filter=Q,O.drawImage(Ke,wt,Jt,Pt,Ot,0,0,ae,be),Ht()}catch(At){if(At.name==="NS_ERROR_NOT_AVAILABLE")o.requestTimeout(zt,100);else throw At}}function Ht(){var At=void 0;De&&pe.push(O.getImageData(0,0,ae,be)),He&&(O.font=Qe,O.fillStyle=he,O.textAlign=Be,O.textBaseline=Ae,O.fillText(He,Le,qe)),At=O.getImageData(0,0,ae,be),Ce.addFrameImageData(At),me=qt,U((ge-me)/ge),qt>0&&o.requestTimeout(jt,Oe),me||Ce.getBase64GIF(function(st){T({error:!1,errorCode:"",errorMsg:"",image:st,cameraStream:B,videoElement:Ke,webcamVideoElement:q,savedRenderingContexts:pe,keepCameraOn:xe})})}};ge=ge!==a?ge:10,se=se!==a?se:.1,k.width=ae,k.height=be,O=k.getContext("2d"),function jt(){if(!de.length&&Ke.currentTime===0){o.requestTimeout(jt,100);return}Et()}()},getCropDimensions:function(){var S=arguments.length>0&&arguments[0]!==a?arguments[0]:{},T=S.videoWidth,k=S.videoHeight,O=S.gifWidth,D=S.gifHeight,L={width:0,height:0,scaledWidth:0,scaledHeight:0};return T>k?(L.width=Math.round(T*(D/k))-O,L.scaledWidth=Math.round(L.width*(k/D))):(L.height=Math.round(k*(O/T))-D,L.scaledHeight=Math.round(L.height*(T/O))),L}},F={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function M(S){M.attempts=M.attempts||0;var T=S.cameraStream,k=S.completedCallback,O=S.videoElement;O&&(O.videoWidth>0&&O.videoHeight>0?(O.removeEventListener("loadeddata",F.findVideoSize),k({videoElement:O,cameraStream:T,videoWidth:O.videoWidth,videoHeight:O.videoHeight})):M.attempts<10?(M.attempts+=1,o.requestTimeout(function(){F.findVideoSize(S)},400)):k({videoElement:O,cameraStream:T,videoWidth:F.defaultVideoDimensions.width,videoHeight:F.defaultVideoDimensions.height}))},onStreamingTimeout:function(S){o.isFunction(S)&&S({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(S){var T=o.isArray(S.existingVideo)?S.existingVideo[0]:S.existingVideo,k=S.cameraStream,O=S.completedCallback,D=S.streamedCallback,L=S.videoElement;if(o.isFunction(D)&&D(),T){if(o.isString(T))L.src=T,L.innerHTML='<source src="'+T+'" type="video/'+o.getExtension(T)+'" />';else if(T instanceof Blob){try{L.src=o.URL.createObjectURL(T)}catch{}L.innerHTML='<source src="'+T+'" type="'+T.type+'" />'}}else if(L.mozSrcObject)L.mozSrcObject=k;else if(o.URL)try{L.srcObject=k,L.src=o.URL.createObjectURL(k)}catch{L.srcObject=k}L.play(),o.requestTimeout(function B(){B.count=B.count||0,F.loadedData===!0?(F.findVideoSize({videoElement:L,cameraStream:k,completedCallback:O}),F.loadedData=!1):(B.count+=1,B.count>10?F.findVideoSize({videoElement:L,cameraStream:k,completedCallback:O}):B())},0)},startStreaming:function(S){var T=o.isFunction(S.error)?S.error:o.noop,k=o.isFunction(S.streamed)?S.streamed:o.noop,O=o.isFunction(S.completed)?S.completed:o.noop,D=S.crossOrigin,L=S.existingVideo,B=S.lastCameraStream,Y=S.options,Q=S.webcamVideoElement,he=o.isElement(L)?L:Q||n.createElement("video");D&&(he.crossOrigin=Y.crossOrigin),he.autoplay=!0,he.loop=!0,he.muted=!0,he.addEventListener("loadeddata",function(ce){F.loadedData=!0,Y.offset&&(he.currentTime=Y.offset)}),L?F.stream({videoElement:he,existingVideo:L,completedCallback:O}):B?F.stream({videoElement:he,cameraStream:B,streamedCallback:k,completedCallback:O}):o.getUserMedia({video:!0},function(ce){F.stream({videoElement:he,cameraStream:ce,streamedCallback:k,completedCallback:O})},T)},startVideoStreaming:function(S){var T=arguments.length>1&&arguments[1]!==a?arguments[1]:{},k=T.timeout!==a?T.timeout:0,O=T.callback,D=T.webcamVideoElement,L=void 0;k>0&&(L=o.requestTimeout(function(){F.onStreamingTimeout(O)},1e4)),F.startStreaming({error:function(){O({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(L)},completed:function(){var Y=arguments.length>0&&arguments[0]!==a?arguments[0]:{},Q=Y.cameraStream,he=Y.videoElement,ce=Y.videoHeight,le=Y.videoWidth;S({cameraStream:Q,videoElement:he,videoHeight:ce,videoWidth:le})},lastCameraStream:T.lastCameraStream,webcamVideoElement:D,crossOrigin:T.crossOrigin,options:T})},stopVideoStreaming:function(S){S=o.isObject(S)?S:{};var T=S,k=T.keepCameraOn,O=T.videoElement,D=T.webcamVideoElement,L=S.cameraStream||{},B=L.getTracks?L.getTracks()||[]:[],Y=!!B.length,Q=B[0];!k&&Y&&o.isFunction(Q.stop)&&Q.stop(),o.isElement(O)&&!D&&(O.pause(),o.isFunction(o.URL.revokeObjectURL)&&!o.webWorkerError&&O.src&&o.URL.revokeObjectURL(O.src),o.removeElement(O))}};function H(M){M=o.isObject(M)?M:{},F.stopVideoStreaming(M)}function W(M,S){var T=M.options||{},k=T.images,O=T.video,D=Number(T.gifWidth),L=Number(T.gifHeight);Number(T.numFrames);var B=M.cameraStream,Y=M.videoElement,Q=M.videoWidth,he=M.videoHeight,ce=I.getCropDimensions({videoWidth:Q,videoHeight:he,gifHeight:L,gifWidth:D}),le=S;T.crop=ce,T.videoElement=Y,T.videoWidth=Q,T.videoHeight=he,T.cameraStream=B,o.isElement(Y)&&(Y.width=D+ce.width,Y.height=L+ce.height,T.webcamVideoElement||(o.setCSSAttr(Y,{position:"fixed",opacity:"0"}),n.body.appendChild(Y)),Y.play(),I.getGIF(T,function(xe){(!k||!k.length)&&(!O||!O.length)&&H(xe),le(xe)}))}function z(){var M=arguments.length>0&&arguments[0]!==a?arguments[0]:{},S=M.callback,T=M.existingVideo,k=M.options,O={getUserMedia:!0,"window.URL":!0},D=l.validate(O),L=void 0,B=void 0;if(D.error)return S(D);if(o.isElement(T)&&T.src){if(B=T.src,L=o.getExtension(B),!o.isSupported.videoCodecs[L])return S(l.messages.videoCodecs)}else o.isArray(T)&&o.each(T,function(Y,Q){if(Q instanceof Blob?L=Q.type.substr(Q.type.lastIndexOf("/")+1,Q.length):L=Q.substr(Q.lastIndexOf(".")+1,Q.length),o.isSupported.videoCodecs[L])return T=Q,!1});F.startStreaming({completed:function(Q){Q.options=k||{},W(Q,S)},existingVideo:T,crossOrigin:k.crossOrigin,options:k})}function te(){var M=arguments.length>0&&arguments[0]!==a?arguments[0]:{},S=M.callback,T=M.lastCameraStream,k=M.options,O=M.webcamVideoElement;if(!v())return S(l.validate());if(k.savedRenderingContexts.length){I.getGIF(k,function(D){S(D)});return}F.startVideoStreaming(function(){var D=arguments.length>0&&arguments[0]!==a?arguments[0]:{};D.options=k||{},W(D,S)},{lastCameraStream:T,callback:S,webcamVideoElement:O,crossOrigin:k.crossOrigin})}function ie(M,S){if(S=o.isFunction(M)?M:S,M=o.isObject(M)?M:{},!!o.isFunction(S)){var T=o.mergeOptions(c,M)||{},k=M.cameraStream,O=T.images,D=O?O.length:0,L=T.video,B=T.webcamVideoElement;T=o.mergeOptions(T,{gifWidth:Math.floor(T.gifWidth),gifHeight:Math.floor(T.gifHeight)}),D?A({images:O,imagesLength:D,callback:S,options:T}):L?z({existingVideo:L,callback:S,options:T}):te({lastCameraStream:k,callback:S,webcamVideoElement:B,options:T})}}function fe(M,S){if(S=o.isFunction(M)?M:S,M=o.isObject(M)?M:{},!!o.isFunction(S)){var T=o.mergeOptions(c,M),k=o.mergeOptions(T,{interval:.1,numFrames:1,gifWidth:Math.floor(T.gifWidth),gifHeight:Math.floor(T.gifHeight)});ie(k,S)}}var Te={utils:s,error:u,defaultOptions:h,createGIF:ie,takeSnapShot:fe,stopVideoStreaming:H,isSupported:d,isWebCamGIFSupported:v,isExistingVideoGIFSupported:y,isExistingImagesGIFSupported:g,VERSION:"0.4.5"};typeof a=="function"&&a.amd?a([],function(){return Te}):e.exports=Te})(typeof window<"u"?window:{},typeof document<"u"?document:{createElement:function(){}},typeof window<"u"?window.navigator:{})})(mNe);const bNe=EN,wNe={class:"preview-block"},_Ne={class:"v-chart-box"},SNe={key:0,class:"iconfont icon-weibiaoti519"},CNe={key:1,class:"iconfont icon-bofang"},xNe=ba({__name:"previewBlock",setup(e){xc([GDe,OMe,D2e,e2e,m2e,b$e,g$e,M$e]),F3("westeros",BCe),Mne(q$e,"westeros");const t=Xu(_l),r=_s(()=>~t.value.type.indexOf(X1e)),n=da(null),i=da(!1),a=da(!1);let o=[],s=null;kp(()=>i1.value,d=>{i.value=d==="start",a.value&&d==="end"&&h()},{deep:!0});const l=_s(()=>t!=null&&t.value.id?r.value?D9(t.value,0):uNe(t.value):{}),u=()=>{i.value=!i.value,i.value?$9(t.value,f):gNe()},f=d=>{eE(()=>{var g;const v=(g=n.value)==null?void 0:g.setOption;v&&v(D9(t.value,d))})},c=()=>{o=[],s=setInterval(()=>{var v;const d=(v=n.value)==null?void 0:v.getDataURL({type:"png",pixelRatio:3,backgroundColor:"#fff"});o.push(d)},100)},h=()=>{clearInterval(s),!(!o.length||!a.value)&&(bNe.createGIF({gifWidth:1e3,gifHeight:630,interval:.1,images:o},d=>{if(!d.error){const v=d.image;console.log("src: ",v),N9(t.value,v,"gif"),o=[],Wo.emit("chartLoading",!1)}}),a.value=!1)};return Wo.on("handleChart",d=>{r.value?(Wo.emit("chartLoading",!0),Yse(),$9(t.value,f),a.value=!0,c()):eE(()=>{var g;Wo.emit("chartLoading",!0);const v=(g=n.value)==null?void 0:g.getDataURL({type:"png",pixelRatio:10,backgroundColor:"#fff"});N9(t.value,v,"png"),setTimeout(()=>{Wo.emit("chartLoading",!1)},1e3)})}),Ine(()=>{o=[],clearInterval(s)}),(d,v)=>(Cr(),Gr("div",wNe,[fr("div",_Ne,[li(ln(Z$e),{ref_key:"chartRef",ref:n,class:"chart",autoresize:"",option:ln(l)},null,8,["option"]),ln(r)?(Cr(),Gr("div",{key:0,class:"play-btn",onClick:u},[i.value?(Cr(),Gr("i",SNe)):(Cr(),Gr("i",CNe))])):Td("",!0)])]))}});const TNe=Xo(xNe,[["__scopeId","data-v-1cacd233"]]);var Dx=function(e){return e&&e.Math==Math&&e},tn=Dx(typeof globalThis=="object"&&globalThis)||Dx(typeof window=="object"&&window)||Dx(typeof self=="object"&&self)||Dx(typeof Lf=="object"&&Lf)||function(){return this}()||Function("return this")(),Tl={},Kt=function(e){try{return!!e()}catch{return!0}},ONe=Kt,Gn=!ONe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ENe=Kt,a1=!ENe(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),RNe=a1,$x=Function.prototype.call,ri=RNe?$x.bind($x):function(){return $x.apply($x,arguments)},o1={},Kse={}.propertyIsEnumerable,Xse=Object.getOwnPropertyDescriptor,kNe=Xse&&!Kse.call({1:2},1);o1.f=kNe?function(t){var r=Xse(this,t);return!!r&&r.enumerable}:Kse;var s1=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},qse=a1,Zse=Function.prototype,RN=Zse.call,ANe=qse&&Zse.bind.bind(RN,RN),ir=qse?ANe:function(e){return function(){return RN.apply(e,arguments)}},Jse=ir,PNe=Jse({}.toString),INe=Jse("".slice),Ol=function(e){return INe(PNe(e),8,-1)},MNe=ir,DNe=Kt,$Ne=Ol,IM=Object,NNe=MNe("".split),l1=DNe(function(){return!IM("z").propertyIsEnumerable(0)})?function(e){return $Ne(e)=="String"?NNe(e,""):IM(e)}:IM,Hs=function(e){return e==null},LNe=Hs,FNe=TypeError,Ba=function(e){if(LNe(e))throw FNe("Can't call method on "+e);return e},HNe=l1,BNe=Ba,co=function(e){return HNe(BNe(e))},kN=typeof document=="object"&&document.all,WNe=typeof kN>"u"&&kN!==void 0,Qse={all:kN,IS_HTMLDDA:WNe},ele=Qse,VNe=ele.all,cn=ele.IS_HTMLDDA?function(e){return typeof e=="function"||e===VNe}:function(e){return typeof e=="function"},L9=cn,tle=Qse,UNe=tle.all,Yn=tle.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:L9(e)||e===UNe}:function(e){return typeof e=="object"?e!==null:L9(e)},MM=tn,jNe=cn,zNe=function(e){return jNe(e)?e:void 0},Ju=function(e,t){return arguments.length<2?zNe(MM[e]):MM[e]&&MM[e][t]},GNe=ir,Mc=GNe({}.isPrototypeOf),Jd=typeof navigator<"u"&&String(navigator.userAgent)||"",rle=tn,DM=Jd,F9=rle.process,H9=rle.Deno,B9=F9&&F9.versions||H9&&H9.version,W9=B9&&B9.v8,Ss,PE;W9&&(Ss=W9.split("."),PE=Ss[0]>0&&Ss[0]<4?1:+(Ss[0]+Ss[1]));!PE&&DM&&(Ss=DM.match(/Edge\/(\d+)/),(!Ss||Ss[1]>=74)&&(Ss=DM.match(/Chrome\/(\d+)/),Ss&&(PE=+Ss[1])));var u1=PE,V9=u1,YNe=Kt,$m=!!Object.getOwnPropertySymbols&&!YNe(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&V9&&V9<41}),KNe=$m,nle=KNe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",XNe=Ju,qNe=cn,ZNe=Mc,JNe=nle,QNe=Object,f1=JNe?function(e){return typeof e=="symbol"}:function(e){var t=XNe("Symbol");return qNe(t)&&ZNe(t.prototype,QNe(e))},eLe=String,Nm=function(e){try{return eLe(e)}catch{return"Object"}},tLe=cn,rLe=Nm,nLe=TypeError,Qd=function(e){if(tLe(e))return e;throw nLe(rLe(e)+" is not a function")},iLe=Qd,aLe=Hs,ev=function(e,t){var r=e[t];return aLe(r)?void 0:iLe(r)},$M=ri,NM=cn,LM=Yn,oLe=TypeError,ile=function(e,t){var r,n;if(t==="string"&&NM(r=e.toString)&&!LM(n=$M(r,e))||NM(r=e.valueOf)&&!LM(n=$M(r,e))||t!=="string"&&NM(r=e.toString)&&!LM(n=$M(r,e)))return n;throw oLe("Can't convert object to primitive value")},Tc={},sLe={get exports(){return Tc},set exports(e){Tc=e}},lLe=!1,U9=tn,uLe=Object.defineProperty,t4=function(e,t){try{uLe(U9,e,{value:t,configurable:!0,writable:!0})}catch{U9[e]=t}return t},fLe=tn,cLe=t4,j9="__core-js_shared__",hLe=fLe[j9]||cLe(j9,{}),r4=hLe,z9=r4;(sLe.exports=function(e,t){return z9[e]||(z9[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var dLe=Ba,vLe=Object,Wa=function(e){return vLe(dLe(e))},pLe=ir,gLe=Wa,yLe=pLe({}.hasOwnProperty),Rn=Object.hasOwn||function(t,r){return yLe(gLe(t),r)},mLe=ir,bLe=0,wLe=Math.random(),_Le=mLe(1 .toString),Fk=function(e){return"Symbol("+(e===void 0?"":e)+")_"+_Le(++bLe+wLe,36)},SLe=tn,CLe=Tc,G9=Rn,xLe=Fk,TLe=$m,OLe=nle,$p=SLe.Symbol,FM=CLe("wks"),ELe=OLe?$p.for||$p:$p&&$p.withoutSetter||xLe,on=function(e){return G9(FM,e)||(FM[e]=TLe&&G9($p,e)?$p[e]:ELe("Symbol."+e)),FM[e]},RLe=ri,Y9=Yn,K9=f1,kLe=ev,ALe=ile,PLe=on,ILe=TypeError,MLe=PLe("toPrimitive"),ale=function(e,t){if(!Y9(e)||K9(e))return e;var r=kLe(e,MLe),n;if(r){if(t===void 0&&(t="default"),n=RLe(r,e,t),!Y9(n)||K9(n))return n;throw ILe("Can't convert object to primitive value")}return t===void 0&&(t="number"),ALe(e,t)},DLe=ale,$Le=f1,Hk=function(e){var t=DLe(e,"string");return $Le(t)?t:t+""},NLe=tn,X9=Yn,AN=NLe.document,LLe=X9(AN)&&X9(AN.createElement),Bk=function(e){return LLe?AN.createElement(e):{}},FLe=Gn,HLe=Kt,BLe=Bk,ole=!FLe&&!HLe(function(){return Object.defineProperty(BLe("div"),"a",{get:function(){return 7}}).a!=7}),WLe=Gn,VLe=ri,ULe=o1,jLe=s1,zLe=co,GLe=Hk,YLe=Rn,KLe=ole,q9=Object.getOwnPropertyDescriptor;Tl.f=WLe?q9:function(t,r){if(t=zLe(t),r=GLe(r),KLe)try{return q9(t,r)}catch{}if(YLe(t,r))return jLe(!VLe(ULe.f,t,r),t[r])};var wa={},XLe=Gn,qLe=Kt,sle=XLe&&qLe(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),ZLe=Yn,JLe=String,QLe=TypeError,$n=function(e){if(ZLe(e))return e;throw QLe(JLe(e)+" is not an object")},eFe=Gn,tFe=ole,rFe=sle,Nx=$n,Z9=Hk,nFe=TypeError,HM=Object.defineProperty,iFe=Object.getOwnPropertyDescriptor,BM="enumerable",WM="configurable",VM="writable";wa.f=eFe?rFe?function(t,r,n){if(Nx(t),r=Z9(r),Nx(n),typeof t=="function"&&r==="prototype"&&"value"in n&&VM in n&&!n[VM]){var i=iFe(t,r);i&&i[VM]&&(t[r]=n.value,n={configurable:WM in n?n[WM]:i[WM],enumerable:BM in n?n[BM]:i[BM],writable:!1})}return HM(t,r,n)}:HM:function(t,r,n){if(Nx(t),r=Z9(r),Nx(n),tFe)try{return HM(t,r,n)}catch{}if("get"in n||"set"in n)throw nFe("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var aFe=Gn,oFe=wa,sFe=s1,tv=aFe?function(e,t,r){return oFe.f(e,t,sFe(1,r))}:function(e,t,r){return e[t]=r,e},IE={},lFe={get exports(){return IE},set exports(e){IE=e}},PN=Gn,uFe=Rn,lle=Function.prototype,fFe=PN&&Object.getOwnPropertyDescriptor,n4=uFe(lle,"name"),cFe=n4&&function(){}.name==="something",hFe=n4&&(!PN||PN&&fFe(lle,"name").configurable),c1={EXISTS:n4,PROPER:cFe,CONFIGURABLE:hFe},dFe=ir,vFe=cn,IN=r4,pFe=dFe(Function.toString);vFe(IN.inspectSource)||(IN.inspectSource=function(e){return pFe(e)});var ule=IN.inspectSource,gFe=tn,yFe=cn,J9=gFe.WeakMap,fle=yFe(J9)&&/native code/.test(String(J9)),mFe=Tc,bFe=Fk,Q9=mFe("keys"),Wk=function(e){return Q9[e]||(Q9[e]=bFe(e))},h1={},wFe=fle,cle=tn,_Fe=Yn,SFe=tv,UM=Rn,jM=r4,CFe=Wk,xFe=h1,e7="Object already initialized",MN=cle.TypeError,TFe=cle.WeakMap,ME,$w,DE,OFe=function(e){return DE(e)?$w(e):ME(e,{})},EFe=function(e){return function(t){var r;if(!_Fe(t)||(r=$w(t)).type!==e)throw MN("Incompatible receiver, "+e+" required");return r}};if(wFe||jM.state){var Ks=jM.state||(jM.state=new TFe);Ks.get=Ks.get,Ks.has=Ks.has,Ks.set=Ks.set,ME=function(e,t){if(Ks.has(e))throw MN(e7);return t.facade=e,Ks.set(e,t),t},$w=function(e){return Ks.get(e)||{}},DE=function(e){return Ks.has(e)}}else{var zv=CFe("state");xFe[zv]=!0,ME=function(e,t){if(UM(e,zv))throw MN(e7);return t.facade=e,SFe(e,zv,t),t},$w=function(e){return UM(e,zv)?e[zv]:{}},DE=function(e){return UM(e,zv)}}var Qu={set:ME,get:$w,has:DE,enforce:OFe,getterFor:EFe},i4=ir,RFe=Kt,kFe=cn,Lx=Rn,DN=Gn,AFe=c1.CONFIGURABLE,PFe=ule,hle=Qu,IFe=hle.enforce,MFe=hle.get,t7=String,uO=Object.defineProperty,DFe=i4("".slice),$Fe=i4("".replace),NFe=i4([].join),LFe=DN&&!RFe(function(){return uO(function(){},"length",{value:8}).length!==8}),FFe=String(String).split("String"),HFe=lFe.exports=function(e,t,r){DFe(t7(t),0,7)==="Symbol("&&(t="["+$Fe(t7(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Lx(e,"name")||AFe&&e.name!==t)&&(DN?uO(e,"name",{value:t,configurable:!0}):e.name=t),LFe&&r&&Lx(r,"arity")&&e.length!==r.arity&&uO(e,"length",{value:r.arity});try{r&&Lx(r,"constructor")&&r.constructor?DN&&uO(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=IFe(e);return Lx(n,"source")||(n.source=NFe(FFe,typeof t=="string"?t:"")),e};Function.prototype.toString=HFe(function(){return kFe(this)&&MFe(this).source||PFe(this)},"toString");var BFe=cn,WFe=wa,VFe=IE,UFe=t4,Zo=function(e,t,r,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:t;if(BFe(r)&&VFe(r,a,n),n.global)i?e[t]=r:UFe(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:WFe.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},rv={},jFe=Math.ceil,zFe=Math.floor,GFe=Math.trunc||function(t){var r=+t;return(r>0?zFe:jFe)(r)},YFe=GFe,Dc=function(e){var t=+e;return t!==t||t===0?0:YFe(t)},KFe=Dc,XFe=Math.max,qFe=Math.min,d1=function(e,t){var r=KFe(e);return r<0?XFe(r+t,0):qFe(r,t)},ZFe=Dc,JFe=Math.min,nv=function(e){return e>0?JFe(ZFe(e),9007199254740991):0},QFe=nv,Jo=function(e){return QFe(e.length)},eHe=co,tHe=d1,rHe=Jo,r7=function(e){return function(t,r,n){var i=eHe(t),a=rHe(i),o=tHe(n,a),s;if(e&&r!=r){for(;a>o;)if(s=i[o++],s!=s)return!0}else for(;a>o;o++)if((e||o in i)&&i[o]===r)return e||o||0;return!e&&-1}},a4={includes:r7(!0),indexOf:r7(!1)},nHe=ir,zM=Rn,iHe=co,aHe=a4.indexOf,oHe=h1,n7=nHe([].push),dle=function(e,t){var r=iHe(e),n=0,i=[],a;for(a in r)!zM(oHe,a)&&zM(r,a)&&n7(i,a);for(;t.length>n;)zM(r,a=t[n++])&&(~aHe(i,a)||n7(i,a));return i},o4=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],sHe=dle,lHe=o4,uHe=lHe.concat("length","prototype");rv.f=Object.getOwnPropertyNames||function(t){return sHe(t,uHe)};var v1={};v1.f=Object.getOwnPropertySymbols;var fHe=Ju,cHe=ir,hHe=rv,dHe=v1,vHe=$n,pHe=cHe([].concat),vle=fHe("Reflect","ownKeys")||function(t){var r=hHe.f(vHe(t)),n=dHe.f;return n?pHe(r,n(t)):r},i7=Rn,gHe=vle,yHe=Tl,mHe=wa,ple=function(e,t,r){for(var n=gHe(t),i=mHe.f,a=yHe.f,o=0;o<n.length;o++){var s=n[o];!i7(e,s)&&!(r&&i7(r,s))&&i(e,s,a(t,s))}},bHe=Kt,wHe=cn,_He=/#|\.prototype\./,p1=function(e,t){var r=CHe[SHe(e)];return r==THe?!0:r==xHe?!1:wHe(t)?bHe(t):!!t},SHe=p1.normalize=function(e){return String(e).replace(_He,".").toLowerCase()},CHe=p1.data={},xHe=p1.NATIVE="N",THe=p1.POLYFILL="P",Vk=p1,GM=tn,OHe=Tl.f,EHe=tv,RHe=Zo,kHe=t4,AHe=ple,PHe=Vk,Nt=function(e,t){var r=e.target,n=e.global,i=e.stat,a,o,s,l,u,f;if(n?o=GM:i?o=GM[r]||kHe(r,{}):o=(GM[r]||{}).prototype,o)for(s in t){if(u=t[s],e.dontCallGetSet?(f=OHe(o,s),l=f&&f.value):l=o[s],a=PHe(n?s:r+(i?".":"#")+s,e.forced),!a&&l!==void 0){if(typeof u==typeof l)continue;AHe(u,l)}(e.sham||l&&l.sham)&&EHe(u,"sham",!0),RHe(o,s,u,e)}},IHe=on,MHe=IHe("toStringTag"),gle={};gle[MHe]="z";var s4=String(gle)==="[object z]",DHe=s4,$He=cn,fO=Ol,NHe=on,LHe=NHe("toStringTag"),FHe=Object,HHe=fO(function(){return arguments}())=="Arguments",BHe=function(e,t){try{return e[t]}catch{}},Uk=DHe?fO:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=BHe(t=FHe(e),LHe))=="string"?r:HHe?fO(t):(n=fO(t))=="Object"&&$He(t.callee)?"Arguments":n},WHe=Uk,VHe=String,Kn=function(e){if(WHe(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return VHe(e)},l4={},UHe=dle,jHe=o4,g1=Object.keys||function(t){return UHe(t,jHe)},zHe=Gn,GHe=sle,YHe=wa,KHe=$n,XHe=co,qHe=g1;l4.f=zHe&&!GHe?Object.defineProperties:function(t,r){KHe(t);for(var n=XHe(r),i=qHe(r),a=i.length,o=0,s;a>o;)YHe.f(t,s=i[o++],n[s]);return t};var ZHe=Ju,yle=ZHe("document","documentElement"),JHe=$n,QHe=l4,a7=o4,eBe=h1,tBe=yle,rBe=Bk,nBe=Wk,o7=">",s7="<",$N="prototype",NN="script",mle=nBe("IE_PROTO"),YM=function(){},ble=function(e){return s7+NN+o7+e+s7+"/"+NN+o7},l7=function(e){e.write(ble("")),e.close();var t=e.parentWindow.Object;return e=null,t},iBe=function(){var e=rBe("iframe"),t="java"+NN+":",r;return e.style.display="none",tBe.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(ble("document.F=Object")),r.close(),r.F},Fx,cO=function(){try{Fx=new ActiveXObject("htmlfile")}catch{}cO=typeof document<"u"?document.domain&&Fx?l7(Fx):iBe():l7(Fx);for(var e=a7.length;e--;)delete cO[$N][a7[e]];return cO()};eBe[mle]=!0;var Lm=Object.create||function(t,r){var n;return t!==null?(YM[$N]=JHe(t),n=new YM,YM[$N]=null,n[mle]=t):n=cO(),r===void 0?n:QHe.f(n,r)},jk={},aBe=Hk,oBe=wa,sBe=s1,Fm=function(e,t,r){var n=aBe(t);n in e?oBe.f(e,n,sBe(0,r)):e[n]=r},u7=d1,lBe=Jo,uBe=Fm,fBe=Array,cBe=Math.max,u4=function(e,t,r){for(var n=lBe(e),i=u7(t,n),a=u7(r===void 0?n:r,n),o=fBe(cBe(a-i,0)),s=0;i<a;i++,s++)uBe(o,s,e[i]);return o.length=s,o},hBe=Ol,dBe=co,wle=rv.f,vBe=u4,_le=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],pBe=function(e){try{return wle(e)}catch{return vBe(_le)}};jk.f=function(t){return _le&&hBe(t)=="Window"?pBe(t):wle(dBe(t))};var f7=IE,gBe=wa,y1=function(e,t,r){return r.get&&f7(r.get,t,{getter:!0}),r.set&&f7(r.set,t,{setter:!0}),gBe.f(e,t,r)},f4={},yBe=on;f4.f=yBe;var mBe=tn,Sle=mBe,c7=Sle,bBe=Rn,wBe=f4,_Be=wa.f,c4=function(e){var t=c7.Symbol||(c7.Symbol={});bBe(t,e)||_Be(t,e,{value:wBe.f(e)})},SBe=ri,CBe=Ju,xBe=on,TBe=Zo,Cle=function(){var e=CBe("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=xBe("toPrimitive");t&&!t[n]&&TBe(t,n,function(i){return SBe(r,this)},{arity:1})},OBe=wa.f,EBe=Rn,RBe=on,h7=RBe("toStringTag"),zk=function(e,t,r){e&&!r&&(e=e.prototype),e&&!EBe(e,h7)&&OBe(e,h7,{configurable:!0,value:t})},kBe=Ol,ABe=ir,m1=function(e){if(kBe(e)==="Function")return ABe(e)},d7=m1,PBe=Qd,IBe=a1,MBe=d7(d7.bind),b1=function(e,t){return PBe(e),t===void 0?e:IBe?MBe(e,t):function(){return e.apply(t,arguments)}},DBe=Ol,Hm=Array.isArray||function(t){return DBe(t)=="Array"},$Be=ir,NBe=Kt,xle=cn,LBe=Uk,FBe=Ju,HBe=ule,Tle=function(){},BBe=[],Ole=FBe("Reflect","construct"),h4=/^\s*(?:class|function)\b/,WBe=$Be(h4.exec),VBe=!h4.exec(Tle),L0=function(t){if(!xle(t))return!1;try{return Ole(Tle,BBe,t),!0}catch{return!1}},Ele=function(t){if(!xle(t))return!1;switch(LBe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return VBe||!!WBe(h4,HBe(t))}catch{return!0}};Ele.sham=!0;var Gk=!Ole||NBe(function(){var e;return L0(L0.call)||!L0(Object)||!L0(function(){e=!0})||e})?Ele:L0,v7=Hm,UBe=Gk,jBe=Yn,zBe=on,GBe=zBe("species"),p7=Array,YBe=function(e){var t;return v7(e)&&(t=e.constructor,UBe(t)&&(t===p7||v7(t.prototype))?t=void 0:jBe(t)&&(t=t[GBe],t===null&&(t=void 0))),t===void 0?p7:t},KBe=YBe,d4=function(e,t){return new(KBe(e))(t===0?0:t)},XBe=b1,qBe=ir,ZBe=l1,JBe=Wa,QBe=Jo,e3e=d4,g7=qBe([].push),xf=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,a=e==6,o=e==7,s=e==5||a;return function(l,u,f,c){for(var h=JBe(l),d=ZBe(h),v=XBe(u,f),g=QBe(d),y=0,b=c||e3e,w=t?b(l,g):r||o?b(l,0):void 0,_,x;g>y;y++)if((s||y in d)&&(_=d[y],x=v(_,y,h),e))if(t)w[y]=x;else if(x)switch(e){case 3:return!0;case 5:return _;case 6:return y;case 2:g7(w,_)}else switch(e){case 4:return!1;case 7:g7(w,_)}return a?-1:n||i?i:w}},iv={forEach:xf(0),map:xf(1),filter:xf(2),some:xf(3),every:xf(4),find:xf(5),findIndex:xf(6),filterReject:xf(7)},Yk=Nt,v4=tn,p4=ri,t3e=ir,bg=Gn,wg=$m,r3e=Kt,mi=Rn,n3e=Mc,LN=$n,Kk=co,g4=Hk,i3e=Kn,FN=s1,Nw=Lm,Rle=g1,a3e=rv,kle=jk,o3e=v1,Ale=Tl,Ple=wa,s3e=l4,Ile=o1,KM=Zo,l3e=y1,y4=Tc,u3e=Wk,Mle=h1,y7=Fk,f3e=on,c3e=f4,h3e=c4,d3e=Cle,v3e=zk,Dle=Qu,Xk=iv.forEach,Da=u3e("hidden"),qk="Symbol",Lw="prototype",p3e=Dle.set,m7=Dle.getterFor(qk),Uo=Object[Lw],wd=v4.Symbol,Sb=wd&&wd[Lw],g3e=v4.TypeError,XM=v4.QObject,$le=Ale.f,$h=Ple.f,Nle=kle.f,y3e=Ile.f,Lle=t3e([].push),Uu=y4("symbols"),w1=y4("op-symbols"),m3e=y4("wks"),HN=!XM||!XM[Lw]||!XM[Lw].findChild,BN=bg&&r3e(function(){return Nw($h({},"a",{get:function(){return $h(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=$le(Uo,t);n&&delete Uo[t],$h(e,t,r),n&&e!==Uo&&$h(Uo,t,n)}:$h,qM=function(e,t){var r=Uu[e]=Nw(Sb);return p3e(r,{type:qk,tag:e,description:t}),bg||(r.description=t),r},Zk=function(t,r,n){t===Uo&&Zk(w1,r,n),LN(t);var i=g4(r);return LN(n),mi(Uu,i)?(n.enumerable?(mi(t,Da)&&t[Da][i]&&(t[Da][i]=!1),n=Nw(n,{enumerable:FN(0,!1)})):(mi(t,Da)||$h(t,Da,FN(1,{})),t[Da][i]=!0),BN(t,i,n)):$h(t,i,n)},m4=function(t,r){LN(t);var n=Kk(r),i=Rle(n).concat(Ble(n));return Xk(i,function(a){(!bg||p4(WN,n,a))&&Zk(t,a,n[a])}),t},b3e=function(t,r){return r===void 0?Nw(t):m4(Nw(t),r)},WN=function(t){var r=g4(t),n=p4(y3e,this,r);return this===Uo&&mi(Uu,r)&&!mi(w1,r)?!1:n||!mi(this,r)||!mi(Uu,r)||mi(this,Da)&&this[Da][r]?n:!0},Fle=function(t,r){var n=Kk(t),i=g4(r);if(!(n===Uo&&mi(Uu,i)&&!mi(w1,i))){var a=$le(n,i);return a&&mi(Uu,i)&&!(mi(n,Da)&&n[Da][i])&&(a.enumerable=!0),a}},Hle=function(t){var r=Nle(Kk(t)),n=[];return Xk(r,function(i){!mi(Uu,i)&&!mi(Mle,i)&&Lle(n,i)}),n},Ble=function(e){var t=e===Uo,r=Nle(t?w1:Kk(e)),n=[];return Xk(r,function(i){mi(Uu,i)&&(!t||mi(Uo,i))&&Lle(n,Uu[i])}),n};wg||(wd=function(){if(n3e(Sb,this))throw g3e("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:i3e(arguments[0]),r=y7(t),n=function(i){this===Uo&&p4(n,w1,i),mi(this,Da)&&mi(this[Da],r)&&(this[Da][r]=!1),BN(this,r,FN(1,i))};return bg&&HN&&BN(Uo,r,{configurable:!0,set:n}),qM(r,t)},Sb=wd[Lw],KM(Sb,"toString",function(){return m7(this).tag}),KM(wd,"withoutSetter",function(e){return qM(y7(e),e)}),Ile.f=WN,Ple.f=Zk,s3e.f=m4,Ale.f=Fle,a3e.f=kle.f=Hle,o3e.f=Ble,c3e.f=function(e){return qM(f3e(e),e)},bg&&(l3e(Sb,"description",{configurable:!0,get:function(){return m7(this).description}}),KM(Uo,"propertyIsEnumerable",WN,{unsafe:!0})));Yk({global:!0,constructor:!0,wrap:!0,forced:!wg,sham:!wg},{Symbol:wd});Xk(Rle(m3e),function(e){h3e(e)});Yk({target:qk,stat:!0,forced:!wg},{useSetter:function(){HN=!0},useSimple:function(){HN=!1}});Yk({target:"Object",stat:!0,forced:!wg,sham:!bg},{create:b3e,defineProperty:Zk,defineProperties:m4,getOwnPropertyDescriptor:Fle});Yk({target:"Object",stat:!0,forced:!wg},{getOwnPropertyNames:Hle});d3e();v3e(wd,qk);Mle[Da]=!0;var w3e=$m,Wle=w3e&&!!Symbol.for&&!!Symbol.keyFor,_3e=Nt,S3e=Ju,C3e=Rn,x3e=Kn,Vle=Tc,T3e=Wle,ZM=Vle("string-to-symbol-registry"),O3e=Vle("symbol-to-string-registry");_3e({target:"Symbol",stat:!0,forced:!T3e},{for:function(e){var t=x3e(e);if(C3e(ZM,t))return ZM[t];var r=S3e("Symbol")(t);return ZM[t]=r,O3e[r]=t,r}});var E3e=Nt,R3e=Rn,k3e=f1,A3e=Nm,P3e=Tc,I3e=Wle,b7=P3e("symbol-to-string-registry");E3e({target:"Symbol",stat:!0,forced:!I3e},{keyFor:function(t){if(!k3e(t))throw TypeError(A3e(t)+" is not a symbol");if(R3e(b7,t))return b7[t]}});var M3e=a1,Ule=Function.prototype,w7=Ule.apply,_7=Ule.call,av=typeof Reflect=="object"&&Reflect.apply||(M3e?_7.bind(w7):function(){return _7.apply(w7,arguments)}),D3e=ir,_1=D3e([].slice),$3e=ir,S7=Hm,N3e=cn,C7=Ol,L3e=Kn,x7=$3e([].push),F3e=function(e){if(N3e(e))return e;if(S7(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?x7(r,i):(typeof i=="number"||C7(i)=="Number"||C7(i)=="String")&&x7(r,L3e(i))}var a=r.length,o=!0;return function(s,l){if(o)return o=!1,l;if(S7(this))return l;for(var u=0;u<a;u++)if(r[u]===s)return l}}},H3e=Nt,jle=Ju,zle=av,B3e=ri,S1=ir,Gle=Kt,T7=cn,O7=f1,Yle=_1,W3e=F3e,V3e=$m,U3e=String,tc=jle("JSON","stringify"),Hx=S1(/./.exec),E7=S1("".charAt),j3e=S1("".charCodeAt),z3e=S1("".replace),G3e=S1(1 .toString),Y3e=/[\uD800-\uDFFF]/g,R7=/^[\uD800-\uDBFF]$/,k7=/^[\uDC00-\uDFFF]$/,A7=!V3e||Gle(function(){var e=jle("Symbol")();return tc([e])!="[null]"||tc({a:e})!="{}"||tc(Object(e))!="{}"}),P7=Gle(function(){return tc("\uDF06\uD834")!=='"\\udf06\\ud834"'||tc("\uDEAD")!=='"\\udead"'}),K3e=function(e,t){var r=Yle(arguments),n=W3e(t);if(!(!T7(n)&&(e===void 0||O7(e))))return r[1]=function(i,a){if(T7(n)&&(a=B3e(n,this,U3e(i),a)),!O7(a))return a},zle(tc,null,r)},X3e=function(e,t,r){var n=E7(r,t-1),i=E7(r,t+1);return Hx(R7,e)&&!Hx(k7,i)||Hx(k7,e)&&!Hx(R7,n)?"\\u"+G3e(j3e(e,0),16):e};tc&&H3e({target:"JSON",stat:!0,arity:3,forced:A7||P7},{stringify:function(t,r,n){var i=Yle(arguments),a=zle(A7?K3e:tc,null,i);return P7&&typeof a=="string"?z3e(a,Y3e,X3e):a}});var q3e=Nt,Z3e=$m,J3e=Kt,Kle=v1,Q3e=Wa,e4e=!Z3e||J3e(function(){Kle.f(1)});q3e({target:"Object",stat:!0,forced:e4e},{getOwnPropertySymbols:function(t){var r=Kle.f;return r?r(Q3e(t)):[]}});var t4e=Nt,r4e=Gn,n4e=tn,Bx=ir,i4e=Rn,a4e=cn,o4e=Mc,s4e=Kn,l4e=y1,u4e=ple,Jl=n4e.Symbol,gh=Jl&&Jl.prototype;if(r4e&&a4e(Jl)&&(!("description"in gh)||Jl().description!==void 0)){var I7={},Wx=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:s4e(arguments[0]),r=o4e(gh,this)?new Jl(t):t===void 0?Jl():Jl(t);return t===""&&(I7[r]=!0),r};u4e(Wx,Jl),Wx.prototype=gh,gh.constructor=Wx;var f4e=String(Jl("test"))=="Symbol(test)",c4e=Bx(gh.valueOf),h4e=Bx(gh.toString),d4e=/^Symbol\((.*)\)[^)]+$/,v4e=Bx("".replace),p4e=Bx("".slice);l4e(gh,"description",{configurable:!0,get:function(){var t=c4e(this);if(i4e(I7,t))return"";var r=h4e(t),n=f4e?p4e(r,7,-1):v4e(r,d4e,"$1");return n===""?void 0:n}}),t4e({global:!0,constructor:!0,forced:!0},{Symbol:Wx})}var g4e=c4;g4e("iterator");var y4e=Gn,m4e=c1.EXISTS,Xle=ir,b4e=y1,qle=Function.prototype,w4e=Xle(qle.toString),Zle=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,_4e=Xle(Zle.exec),S4e="name";y4e&&!m4e&&b4e(qle,S4e,{configurable:!0,get:function(){try{return _4e(Zle,w4e(this))[1]}catch{return""}}});var C4e=Kt,b4=!C4e(function(){return Object.isExtensible(Object.preventExtensions({}))}),Ad={},x4e={get exports(){return Ad},set exports(e){Ad=e}},T4e=Kt,O4e=T4e(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),E4e=Kt,R4e=Yn,k4e=Ol,M7=O4e,hO=Object.isExtensible,A4e=E4e(function(){hO(1)}),P4e=A4e||M7?function(t){return!R4e(t)||M7&&k4e(t)=="ArrayBuffer"?!1:hO?hO(t):!0}:hO,I4e=Nt,M4e=ir,D4e=h1,$4e=Yn,w4=Rn,N4e=wa.f,D7=rv,L4e=jk,_4=P4e,F4e=Fk,H4e=b4,Jle=!1,ju=F4e("meta"),B4e=0,S4=function(e){N4e(e,ju,{value:{objectID:"O"+B4e++,weakData:{}}})},W4e=function(e,t){if(!$4e(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!w4(e,ju)){if(!_4(e))return"F";if(!t)return"E";S4(e)}return e[ju].objectID},V4e=function(e,t){if(!w4(e,ju)){if(!_4(e))return!0;if(!t)return!1;S4(e)}return e[ju].weakData},U4e=function(e){return H4e&&Jle&&_4(e)&&!w4(e,ju)&&S4(e),e},j4e=function(){z4e.enable=function(){},Jle=!0;var e=D7.f,t=M4e([].splice),r={};r[ju]=1,e(r).length&&(D7.f=function(n){for(var i=e(n),a=0,o=i.length;a<o;a++)if(i[a]===ju){t(i,a,1);break}return i},I4e({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:L4e.f}))},z4e=x4e.exports={enable:j4e,fastKey:W4e,getWeakData:V4e,onFreeze:U4e};D4e[ju]=!0;var G4e=Nt,Y4e=b4,K4e=Kt,X4e=Yn,q4e=Ad.onFreeze,VN=Object.freeze,Z4e=K4e(function(){VN(1)});G4e({target:"Object",stat:!0,forced:Z4e,sham:!Y4e},{freeze:function(t){return VN&&X4e(t)?VN(q4e(t)):t}});var J4e=on,Q4e=Lm,eWe=wa.f,UN=J4e("unscopables"),jN=Array.prototype;jN[UN]==null&&eWe(jN,UN,{configurable:!0,value:Q4e(null)});var C1=function(e){jN[UN][e]=!0},x1={},tWe=Kt,Qle=!tWe(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),rWe=Rn,nWe=cn,iWe=Wa,aWe=Wk,oWe=Qle,$7=aWe("IE_PROTO"),zN=Object,sWe=zN.prototype,Jk=oWe?zN.getPrototypeOf:function(e){var t=iWe(e);if(rWe(t,$7))return t[$7];var r=t.constructor;return nWe(r)&&t instanceof r?r.prototype:t instanceof zN?sWe:null},lWe=Kt,uWe=cn,fWe=Yn,N7=Jk,cWe=Zo,hWe=on,GN=hWe("iterator"),eue=!1,Pd,JM,QM;[].keys&&(QM=[].keys(),"next"in QM?(JM=N7(N7(QM)),JM!==Object.prototype&&(Pd=JM)):eue=!0);var dWe=!fWe(Pd)||lWe(function(){var e={};return Pd[GN].call(e)!==e});dWe&&(Pd={});uWe(Pd[GN])||cWe(Pd,GN,function(){return this});var tue={IteratorPrototype:Pd,BUGGY_SAFARI_ITERATORS:eue},vWe=tue.IteratorPrototype,pWe=Lm,gWe=s1,yWe=zk,mWe=x1,bWe=function(){return this},wWe=function(e,t,r,n){var i=t+" Iterator";return e.prototype=pWe(vWe,{next:gWe(+!n,r)}),yWe(e,i,!1),mWe[i]=bWe,e},_We=ir,SWe=Qd,CWe=function(e,t,r){try{return _We(SWe(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},xWe=cn,TWe=String,OWe=TypeError,EWe=function(e){if(typeof e=="object"||xWe(e))return e;throw OWe("Can't set "+TWe(e)+" as a prototype")},RWe=CWe,kWe=$n,AWe=EWe,C4=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=RWe(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,a){return kWe(i),AWe(a),e?r(i,a):i.__proto__=a,i}}():void 0),PWe=Nt,IWe=ri,rue=c1,MWe=cn,DWe=wWe,L7=Jk,F7=C4,$We=zk,NWe=tv,e2=Zo,LWe=on,FWe=x1,nue=tue,HWe=rue.PROPER,BWe=rue.CONFIGURABLE,H7=nue.IteratorPrototype,Vx=nue.BUGGY_SAFARI_ITERATORS,F0=LWe("iterator"),B7="keys",H0="values",W7="entries",WWe=function(){return this},x4=function(e,t,r,n,i,a,o){DWe(r,t,n);var s=function(b){if(b===i&&h)return h;if(!Vx&&b in f)return f[b];switch(b){case B7:return function(){return new r(this,b)};case H0:return function(){return new r(this,b)};case W7:return function(){return new r(this,b)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,f=e.prototype,c=f[F0]||f["@@iterator"]||i&&f[i],h=!Vx&&c||s(i),d=t=="Array"&&f.entries||c,v,g,y;if(d&&(v=L7(d.call(new e)),v!==Object.prototype&&v.next&&(L7(v)!==H7&&(F7?F7(v,H7):MWe(v[F0])||e2(v,F0,WWe)),$We(v,l,!0))),HWe&&i==H0&&c&&c.name!==H0&&(BWe?NWe(f,"name",H0):(u=!0,h=function(){return IWe(c,this)})),i)if(g={values:s(H0),keys:a?h:s(B7),entries:s(W7)},o)for(y in g)(Vx||u||!(y in f))&&e2(f,y,g[y]);else PWe({target:t,proto:!0,forced:Vx||u},g);return f[F0]!==h&&e2(f,F0,h,{name:i}),FWe[t]=h,g},T4=function(e,t){return{value:e,done:t}},VWe=co,O4=C1,V7=x1,iue=Qu,UWe=wa.f,jWe=x4,Ux=T4,zWe=Gn,aue="Array Iterator",GWe=iue.set,YWe=iue.getterFor(aue),KWe=jWe(Array,"Array",function(e,t){GWe(this,{type:aue,target:VWe(e),index:0,kind:t})},function(){var e=YWe(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Ux(void 0,!0)):r=="keys"?Ux(n,!1):r=="values"?Ux(t[n],!1):Ux([n,t[n]],!1)},"values"),U7=V7.Arguments=V7.Array;O4("keys");O4("values");O4("entries");if(zWe&&U7.name!=="values")try{UWe(U7,"name",{value:"values"})}catch{}var XWe=s4,qWe=Uk,ZWe=XWe?{}.toString:function(){return"[object "+qWe(this)+"]"},JWe=s4,QWe=Zo,eVe=ZWe;JWe||QWe(Object.prototype,"toString",eVe,{unsafe:!0});var tVe=on,rVe=x1,nVe=tVe("iterator"),iVe=Array.prototype,oue=function(e){return e!==void 0&&(rVe.Array===e||iVe[nVe]===e)},aVe=Uk,j7=ev,oVe=Hs,sVe=x1,lVe=on,uVe=lVe("iterator"),E4=function(e){if(!oVe(e))return j7(e,uVe)||j7(e,"@@iterator")||sVe[aVe(e)]},fVe=ri,cVe=Qd,hVe=$n,dVe=Nm,vVe=E4,pVe=TypeError,sue=function(e,t){var r=arguments.length<2?vVe(e):t;if(cVe(r))return hVe(fVe(r,e));throw pVe(dVe(e)+" is not iterable")},gVe=ri,z7=$n,yVe=ev,lue=function(e,t,r){var n,i;z7(e);try{if(n=yVe(e,"return"),!n){if(t==="throw")throw r;return r}n=gVe(n,e)}catch(a){i=!0,n=a}if(t==="throw")throw r;if(i)throw n;return z7(n),r},mVe=b1,bVe=ri,wVe=$n,_Ve=Nm,SVe=oue,CVe=Jo,G7=Mc,xVe=sue,TVe=E4,Y7=lue,OVe=TypeError,dO=function(e,t){this.stopped=e,this.result=t},K7=dO.prototype,R4=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),a=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=mVe(t,n),u,f,c,h,d,v,g,y=function(w){return u&&Y7(u,"normal",w),new dO(!0,w)},b=function(w){return i?(wVe(w),s?l(w[0],w[1],y):l(w[0],w[1])):s?l(w,y):l(w)};if(a)u=e.iterator;else if(o)u=e;else{if(f=TVe(e),!f)throw OVe(_Ve(e)+" is not iterable");if(SVe(f)){for(c=0,h=CVe(e);h>c;c++)if(d=b(e[c]),d&&G7(K7,d))return d;return new dO(!1)}u=xVe(e,f)}for(v=a?e.next:u.next;!(g=bVe(v,u)).done;){try{d=b(g.value)}catch(w){Y7(u,"throw",w)}if(typeof d=="object"&&d&&G7(K7,d))return d}return new dO(!1)},EVe=Mc,RVe=TypeError,k4=function(e,t){if(EVe(t,e))return e;throw RVe("Incorrect invocation")},kVe=on,uue=kVe("iterator"),fue=!1;try{var AVe=0,X7={next:function(){return{done:!!AVe++}},return:function(){fue=!0}};X7[uue]=function(){return this},Array.from(X7,function(){throw 2})}catch{}var cue=function(e,t){if(!t&&!fue)return!1;var r=!1;try{var n={};n[uue]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},PVe=cn,IVe=Yn,q7=C4,A4=function(e,t,r){var n,i;return q7&&PVe(n=t.constructor)&&n!==r&&IVe(i=n.prototype)&&i!==r.prototype&&q7(e,i),e},MVe=Nt,DVe=tn,$Ve=ir,Z7=Vk,NVe=Zo,LVe=Ad,FVe=R4,HVe=k4,BVe=cn,WVe=Hs,t2=Yn,r2=Kt,VVe=cue,UVe=zk,jVe=A4,Qk=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,a=n?"set":"add",o=DVe[e],s=o&&o.prototype,l=o,u={},f=function(b){var w=$Ve(s[b]);NVe(s,b,b=="add"?function(x){return w(this,x===0?0:x),this}:b=="delete"?function(_){return i&&!t2(_)?!1:w(this,_===0?0:_)}:b=="get"?function(x){return i&&!t2(x)?void 0:w(this,x===0?0:x)}:b=="has"?function(x){return i&&!t2(x)?!1:w(this,x===0?0:x)}:function(x,E){return w(this,x===0?0:x,E),this})},c=Z7(e,!BVe(o)||!(i||s.forEach&&!r2(function(){new o().entries().next()})));if(c)l=r.getConstructor(t,e,n,a),LVe.enable();else if(Z7(e,!0)){var h=new l,d=h[a](i?{}:-0,1)!=h,v=r2(function(){h.has(1)}),g=VVe(function(b){new o(b)}),y=!i&&r2(function(){for(var b=new o,w=5;w--;)b[a](w,w);return!b.has(-0)});g||(l=t(function(b,w){HVe(b,s);var _=jVe(new o,b,l);return WVe(w)||FVe(w,_[a],{that:_,AS_ENTRIES:n}),_}),l.prototype=s,s.constructor=l),(v||y)&&(f("delete"),f("has"),n&&f("get")),(y||d)&&f(a),i&&s.clear&&delete s.clear}return u[e]=l,MVe({global:!0,constructor:!0,forced:l!=o},u),UVe(l,e),i||r.setStrong(l,e,n),l},zVe=Zo,P4=function(e,t,r){for(var n in t)zVe(e,n,t[n],r);return e},GVe=Ju,YVe=y1,KVe=on,XVe=Gn,J7=KVe("species"),hue=function(e){var t=GVe(e);XVe&&t&&!t[J7]&&YVe(t,J7,{configurable:!0,get:function(){return this}})},qVe=Lm,ZVe=y1,Q7=P4,JVe=b1,QVe=k4,eUe=Hs,tUe=R4,rUe=x4,jx=T4,nUe=hue,B0=Gn,eY=Ad.fastKey,due=Qu,tY=due.set,n2=due.getterFor,vue={getConstructor:function(e,t,r,n){var i=e(function(u,f){QVe(u,a),tY(u,{type:t,index:qVe(null),first:void 0,last:void 0,size:0}),B0||(u.size=0),eUe(f)||tUe(f,u[n],{that:u,AS_ENTRIES:r})}),a=i.prototype,o=n2(t),s=function(u,f,c){var h=o(u),d=l(u,f),v,g;return d?d.value=c:(h.last=d={index:g=eY(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),B0?h.size++:u.size++,g!=="F"&&(h.index[g]=d)),u},l=function(u,f){var c=o(u),h=eY(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return Q7(a,{clear:function(){for(var f=this,c=o(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,B0?c.size=0:f.size=0},delete:function(u){var f=this,c=o(f),h=l(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),B0?c.size--:f.size--}return!!h},forEach:function(f){for(var c=o(this),h=JVe(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!l(this,f)}}),Q7(a,r?{get:function(f){var c=l(this,f);return c&&c.value},set:function(f,c){return s(this,f===0?0:f,c)}}:{add:function(f){return s(this,f=f===0?0:f,f)}}),B0&&ZVe(a,"size",{configurable:!0,get:function(){return o(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=n2(t),a=n2(n);rUe(e,t,function(o,s){tY(this,{type:n,target:o,state:i(o),kind:s,last:void 0})},function(){for(var o=a(this),s=o.kind,l=o.last;l&&l.removed;)l=l.previous;return!o.target||!(o.last=l=l?l.next:o.state.first)?(o.target=void 0,jx(void 0,!0)):s=="keys"?jx(l.key,!1):s=="values"?jx(l.value,!1):jx([l.key,l.value],!1)},r?"entries":"values",!r,!0),nUe(t)}},iUe=Qk,aUe=vue;iUe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},aUe);var I4=ir,oUe=Dc,sUe=Kn,lUe=Ba,uUe=I4("".charAt),rY=I4("".charCodeAt),fUe=I4("".slice),nY=function(e){return function(t,r){var n=sUe(lUe(t)),i=oUe(r),a=n.length,o,s;return i<0||i>=a?e?"":void 0:(o=rY(n,i),o<55296||o>56319||i+1===a||(s=rY(n,i+1))<56320||s>57343?e?uUe(n,i):o:e?fUe(n,i,i+2):(o-55296<<10)+(s-56320)+65536)}},M4={codeAt:nY(!1),charAt:nY(!0)},cUe=M4.charAt,hUe=Kn,pue=Qu,dUe=x4,iY=T4,gue="String Iterator",vUe=pue.set,pUe=pue.getterFor(gue);dUe(String,"String",function(e){vUe(this,{type:gue,string:hUe(e),index:0})},function(){var t=pUe(this),r=t.string,n=t.index,i;return n>=r.length?iY(void 0,!0):(i=cUe(r,n),t.index+=i.length,iY(i,!1))});var yue={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},gUe=Bk,i2=gUe("span").classList,aY=i2&&i2.constructor&&i2.constructor.prototype,mue=aY===Object.prototype?void 0:aY,oY=tn,bue=yue,yUe=mue,Cb=KWe,a2=tv,wue=on,o2=wue("iterator"),sY=wue("toStringTag"),s2=Cb.values,_ue=function(e,t){if(e){if(e[o2]!==s2)try{a2(e,o2,s2)}catch{e[o2]=s2}if(e[sY]||a2(e,sY,t),bue[t]){for(var r in Cb)if(e[r]!==Cb[r])try{a2(e,r,Cb[r])}catch{e[r]=Cb[r]}}}};for(var l2 in bue)_ue(oY[l2]&&oY[l2].prototype,l2);_ue(yUe,"DOMTokenList");var mUe=Nt,bUe=a4.includes,wUe=Kt,_Ue=C1,SUe=wUe(function(){return!Array(1).includes()});mUe({target:"Array",proto:!0,forced:SUe},{includes:function(t){return bUe(this,t,arguments.length>1?arguments[1]:void 0)}});_Ue("includes");var lY=Nm,CUe=TypeError,Sue=function(e,t){if(!delete e[t])throw CUe("Cannot delete property "+lY(t)+" of "+lY(e))},uY=u4,xUe=Math.floor,YN=function(e,t){var r=e.length,n=xUe(r/2);return r<8?TUe(e,t):OUe(e,YN(uY(e,0,n),t),YN(uY(e,n),t),t)},TUe=function(e,t){for(var r=e.length,n=1,i,a;n<r;){for(a=n,i=e[n];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==n++&&(e[a]=i)}return e},OUe=function(e,t,r,n){for(var i=t.length,a=r.length,o=0,s=0;o<i||s<a;)e[o+s]=o<i&&s<a?n(t[o],r[s])<=0?t[o++]:r[s++]:o<i?t[o++]:r[s++];return e},EUe=YN,RUe=Kt,Bm=function(e,t){var r=[][e];return!!r&&RUe(function(){r.call(null,t||function(){return 1},1)})},kUe=Jd,fY=kUe.match(/firefox\/(\d+)/i),AUe=!!fY&&+fY[1],PUe=Jd,IUe=/MSIE|Trident/.test(PUe),MUe=Jd,cY=MUe.match(/AppleWebKit\/(\d+)\./),DUe=!!cY&&+cY[1],$Ue=Nt,Cue=ir,NUe=Qd,LUe=Wa,hY=Jo,FUe=Sue,dY=Kn,D4=Kt,HUe=EUe,BUe=Bm,vY=AUe,WUe=IUe,pY=u1,gY=DUe,Yf=[],yY=Cue(Yf.sort),VUe=Cue(Yf.push),UUe=D4(function(){Yf.sort(void 0)}),jUe=D4(function(){Yf.sort(null)}),zUe=BUe("sort"),xue=!D4(function(){if(pY)return pY<70;if(!(vY&&vY>3)){if(WUe)return!0;if(gY)return gY<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)Yf.push({k:r+i,v:n})}for(Yf.sort(function(a,o){return o.v-a.v}),i=0;i<Yf.length;i++)r=Yf[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),GUe=UUe||!jUe||!zUe||!xue,YUe=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:dY(t)>dY(r)?1:-1}};$Ue({target:"Array",proto:!0,forced:GUe},{sort:function(t){t!==void 0&&NUe(t);var r=LUe(this);if(xue)return t===void 0?yY(r):yY(r,t);var n=[],i=hY(r),a,o;for(o=0;o<i;o++)o in r&&VUe(n,r[o]);for(HUe(n,YUe(t)),a=hY(n),o=0;o<a;)r[o]=n[o++];for(;o<i;)FUe(r,o++);return r}});var KUe=Gn,XUe=Hm,qUe=TypeError,ZUe=Object.getOwnPropertyDescriptor,JUe=KUe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),QUe=JUe?function(e,t){if(XUe(e)&&!ZUe(e,"length").writable)throw qUe("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},eje=TypeError,tje=9007199254740991,Tue=function(e){if(e>tje)throw eje("Maximum allowed index exceeded");return e},rje=Kt,nje=on,ije=u1,aje=nje("species"),T1=function(e){return ije>=51||!rje(function(){var t=[],r=t.constructor={};return r[aje]=function(){return{foo:1}},t[e](Boolean).foo!==1})},oje=Nt,sje=Wa,lje=d1,uje=Dc,fje=Jo,cje=QUe,hje=Tue,dje=d4,vje=Fm,u2=Sue,pje=T1,gje=pje("splice"),yje=Math.max,mje=Math.min;oje({target:"Array",proto:!0,forced:!gje},{splice:function(t,r){var n=sje(this),i=fje(n),a=lje(t,i),o=arguments.length,s,l,u,f,c,h;for(o===0?s=l=0:o===1?(s=0,l=i-a):(s=o-2,l=mje(yje(uje(r),0),i-a)),hje(i+s-l),u=dje(n,l),f=0;f<l;f++)c=a+f,c in n&&vje(u,f,n[c]);if(u.length=l,s<l){for(f=a;f<i-l;f++)c=f+l,h=f+s,c in n?n[h]=n[c]:u2(n,h);for(f=i;f>i-l+s;f--)u2(n,f-1)}else if(s>l)for(f=i-l;f>a;f--)c=f+l-1,h=f+s-1,c in n?n[h]=n[c]:u2(n,h);for(f=0;f<s;f++)n[f+a]=arguments[f+2];return cje(n,i-l+s),u}});var bje=Yn,wje=Math.floor,_je=Number.isInteger||function(t){return!bje(t)&&isFinite(t)&&wje(t)===t},Sje=Nt,Cje=_je;Sje({target:"Number",stat:!0},{isInteger:Cje});var xje=ir,Oue=xje(1 .valueOf),Eue=`	
\v\f\r                　\u2028\u2029\uFEFF`,Tje=ir,Oje=Ba,Eje=Kn,KN=Eue,mY=Tje("".replace),Rje=RegExp("^["+KN+"]+"),kje=RegExp("(^|[^"+KN+"])["+KN+"]+$"),f2=function(e){return function(t){var r=Eje(Oje(t));return e&1&&(r=mY(r,Rje,"")),e&2&&(r=mY(r,kje,"$1")),r}},Rue={start:f2(1),end:f2(2),trim:f2(3)},Aje=Nt,kue=lLe,Pje=Gn,Aue=tn,Pue=Sle,Iue=ir,Ije=Vk,bY=Rn,Mje=A4,Dje=Mc,$je=f1,Mue=ale,Nje=Kt,Lje=rv.f,Fje=Tl.f,Hje=wa.f,Bje=Oue,Wje=Rue.trim,eA="Number",Kp=Aue[eA];Pue[eA];var $4=Kp.prototype,Vje=Aue.TypeError,Uje=Iue("".slice),zx=Iue("".charCodeAt),jje=function(e){var t=Mue(e,"number");return typeof t=="bigint"?t:zje(t)},zje=function(e){var t=Mue(e,"number"),r,n,i,a,o,s,l,u;if($je(t))throw Vje("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=Wje(t),r=zx(t,0),r===43||r===45){if(n=zx(t,2),n===88||n===120)return NaN}else if(r===48){switch(zx(t,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(o=Uje(t,2),s=o.length,l=0;l<s;l++)if(u=zx(o,l),u<48||u>a)return NaN;return parseInt(o,i)}}return+t},N4=Ije(eA,!Kp(" 0o1")||!Kp("0b1")||Kp("+0x1")),Gje=function(e){return Dje($4,e)&&Nje(function(){Bje(e)})},tA=function(t){var r=arguments.length<1?0:Kp(jje(t));return Gje(this)?Mje(Object(r),this,tA):r};tA.prototype=$4;N4&&!kue&&($4.constructor=tA);Aje({global:!0,constructor:!0,wrap:!0,forced:N4},{Number:tA});var Yje=function(e,t){for(var r=Pje?Lje(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)bY(t,i=r[n])&&!bY(e,i)&&Hje(e,i,Fje(t,i))};(N4||kue)&&Yje(Pue[eA],Kp);var Kje=Nt,wY=Hm,Xje=Gk,qje=Yn,_Y=d1,Zje=Jo,Jje=co,Qje=Fm,e8e=on,t8e=T1,r8e=_1,n8e=t8e("slice"),i8e=e8e("species"),c2=Array,a8e=Math.max;Kje({target:"Array",proto:!0,forced:!n8e},{slice:function(t,r){var n=Jje(this),i=Zje(n),a=_Y(t,i),o=_Y(r===void 0?i:r,i),s,l,u;if(wY(n)&&(s=n.constructor,Xje(s)&&(s===c2||wY(s.prototype))?s=void 0:qje(s)&&(s=s[i8e],s===null&&(s=void 0)),s===c2||s===void 0))return r8e(n,a,o);for(l=new(s===void 0?c2:s)(a8e(o-a,0)),u=0;a<o;a++,u++)a in n&&Qje(l,u,n[a]);return l.length=u,l}});var o8e=Nt,s8e=Kt,l8e=Hm,u8e=Yn,f8e=Wa,c8e=Jo,SY=Tue,CY=Fm,h8e=d4,d8e=T1,v8e=on,p8e=u1,Due=v8e("isConcatSpreadable"),g8e=p8e>=51||!s8e(function(){var e=[];return e[Due]=!1,e.concat()[0]!==e}),y8e=function(e){if(!u8e(e))return!1;var t=e[Due];return t!==void 0?!!t:l8e(e)},m8e=!g8e||!d8e("concat");o8e({target:"Array",proto:!0,arity:1,forced:m8e},{concat:function(t){var r=f8e(this),n=h8e(r,0),i=0,a,o,s,l,u;for(a=-1,s=arguments.length;a<s;a++)if(u=a===-1?r:arguments[a],y8e(u))for(l=c8e(u),SY(i+l),o=0;o<l;o++,i++)o in u&&CY(n,i,u[o]);else SY(i+1),CY(n,i++,u);return n.length=i,n}});var b8e=Wa,xY=d1,w8e=Jo,_8e=function(t){for(var r=b8e(this),n=w8e(r),i=arguments.length,a=xY(i>1?arguments[1]:void 0,n),o=i>2?arguments[2]:void 0,s=o===void 0?n:xY(o,n);s>a;)r[a++]=t;return r},S8e=Nt,C8e=_8e,x8e=C1;S8e({target:"Array",proto:!0},{fill:C8e});x8e("fill");var T8e=Nt,O8e=iv.map,E8e=T1,R8e=E8e("map");T8e({target:"Array",proto:!0,forced:!R8e},{map:function(t){return O8e(this,t,arguments.length>1?arguments[1]:void 0)}});var k8e=$n,$ue=function(){var e=k8e(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},L4=Kt,A8e=tn,F4=A8e.RegExp,H4=L4(function(){var e=F4("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),P8e=H4||L4(function(){return!F4("a","y").sticky}),I8e=H4||L4(function(){var e=F4("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),B4={BROKEN_CARET:I8e,MISSED_STICKY:P8e,UNSUPPORTED_Y:H4},M8e=Kt,D8e=tn,$8e=D8e.RegExp,Nue=M8e(function(){var e=$8e(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),N8e=Kt,L8e=tn,F8e=L8e.RegExp,Lue=N8e(function(){var e=F8e("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Np=ri,rA=ir,H8e=Kn,B8e=$ue,W8e=B4,V8e=Tc,U8e=Lm,j8e=Qu.get,z8e=Nue,G8e=Lue,Y8e=V8e("native-string-replace",String.prototype.replace),$E=RegExp.prototype.exec,XN=$E,K8e=rA("".charAt),X8e=rA("".indexOf),q8e=rA("".replace),h2=rA("".slice),qN=function(){var e=/a/,t=/b*/g;return Np($E,e,"a"),Np($E,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),Fue=W8e.BROKEN_CARET,ZN=/()??/.exec("")[1]!==void 0,Z8e=qN||ZN||Fue||z8e||G8e;Z8e&&(XN=function(t){var r=this,n=j8e(r),i=H8e(t),a=n.raw,o,s,l,u,f,c,h;if(a)return a.lastIndex=r.lastIndex,o=Np(XN,a,i),r.lastIndex=a.lastIndex,o;var d=n.groups,v=Fue&&r.sticky,g=Np(B8e,r),y=r.source,b=0,w=i;if(v&&(g=q8e(g,"y",""),X8e(g,"g")===-1&&(g+="g"),w=h2(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&K8e(i,r.lastIndex-1)!==`
`)&&(y="(?: "+y+")",w=" "+w,b++),s=new RegExp("^(?:"+y+")",g)),ZN&&(s=new RegExp("^"+y+"$(?!\\s)",g)),qN&&(l=r.lastIndex),u=Np($E,v?s:r,w),v?u?(u.input=h2(u.input,b),u[0]=h2(u[0],b),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:qN&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),ZN&&u&&u.length>1&&Np(Y8e,u[0],s,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=U8e(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var nA=XN,J8e=Nt,TY=nA;J8e({target:"RegExp",proto:!0,forced:/./.exec!==TY},{exec:TY});var OY=m1,EY=Zo,Q8e=nA,RY=Kt,Hue=on,e5e=tv,t5e=Hue("species"),d2=RegExp.prototype,iA=function(e,t,r,n){var i=Hue(e),a=!RY(function(){var u={};return u[i]=function(){return 7},""[e](u)!=7}),o=a&&!RY(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[t5e]=function(){return f},f.flags="",f[i]=/./[i]),f.exec=function(){return u=!0,null},f[i](""),!u});if(!a||!o||r){var s=OY(/./[i]),l=t(i,""[e],function(u,f,c,h,d){var v=OY(u),g=f.exec;return g===Q8e||g===d2.exec?a&&!d?{done:!0,value:s(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});EY(String.prototype,e,l[0]),EY(d2,i,l[1])}n&&e5e(d2[i],"sham",!0)},r5e=M4.charAt,W4=function(e,t,r){return t+(r?r5e(e,t).length:1)},V4=ir,n5e=Wa,i5e=Math.floor,v2=V4("".charAt),a5e=V4("".replace),p2=V4("".slice),o5e=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s5e=/\$([$&'`]|\d{1,2})/g,l5e=function(e,t,r,n,i,a){var o=r+e.length,s=n.length,l=s5e;return i!==void 0&&(i=n5e(i),l=o5e),a5e(a,l,function(u,f){var c;switch(v2(f,0)){case"$":return"$";case"&":return e;case"`":return p2(t,0,r);case"'":return p2(t,o);case"<":c=i[p2(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>s){var d=i5e(h/10);return d===0?u:d<=s?n[d-1]===void 0?v2(f,1):n[d-1]+v2(f,1):u}c=n[h-1]}return c===void 0?"":c})},kY=ri,u5e=$n,f5e=cn,c5e=Ol,h5e=nA,d5e=TypeError,aA=function(e,t){var r=e.exec;if(f5e(r)){var n=kY(r,e,t);return n!==null&&u5e(n),n}if(c5e(e)==="RegExp")return kY(h5e,e,t);throw d5e("RegExp#exec called on incompatible receiver")},v5e=av,AY=ri,oA=ir,p5e=iA,g5e=Kt,y5e=$n,m5e=cn,b5e=Hs,w5e=Dc,_5e=nv,Gv=Kn,S5e=Ba,C5e=W4,x5e=ev,T5e=l5e,O5e=aA,E5e=on,JN=E5e("replace"),R5e=Math.max,k5e=Math.min,A5e=oA([].concat),g2=oA([].push),PY=oA("".indexOf),IY=oA("".slice),P5e=function(e){return e===void 0?e:String(e)},I5e=function(){return"a".replace(/./,"$0")==="$0"}(),MY=function(){return/./[JN]?/./[JN]("a","$0")==="":!1}(),M5e=!g5e(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});p5e("replace",function(e,t,r){var n=MY?"$":"$0";return[function(a,o){var s=S5e(this),l=b5e(a)?void 0:x5e(a,JN);return l?AY(l,a,s,o):AY(t,Gv(s),a,o)},function(i,a){var o=y5e(this),s=Gv(i);if(typeof a=="string"&&PY(a,n)===-1&&PY(a,"$<")===-1){var l=r(t,o,s,a);if(l.done)return l.value}var u=m5e(a);u||(a=Gv(a));var f=o.global;if(f){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var d=O5e(o,s);if(d===null||(g2(h,d),!f))break;var v=Gv(d[0]);v===""&&(o.lastIndex=C5e(s,_5e(o.lastIndex),c))}for(var g="",y=0,b=0;b<h.length;b++){d=h[b];for(var w=Gv(d[0]),_=R5e(k5e(w5e(d.index),s.length),0),x=[],E=1;E<d.length;E++)g2(x,P5e(d[E]));var R=d.groups;if(u){var A=A5e([w],x,_,s);R!==void 0&&g2(A,R);var N=Gv(v5e(a,void 0,A))}else N=T5e(w,s,_,x,R,a);_>=y&&(g+=IY(s,y,_)+N,y=_+w.length)}return g+IY(s,y)}]},!M5e||!I5e||MY);var D5e=$n,$5e=lue,N5e=function(e,t,r,n){try{return n?t(D5e(r)[0],r[1]):t(r)}catch(i){$5e(e,"throw",i)}},L5e=b1,F5e=ri,H5e=Wa,B5e=N5e,W5e=oue,V5e=Gk,U5e=Jo,DY=Fm,j5e=sue,z5e=E4,$Y=Array,G5e=function(t){var r=H5e(t),n=V5e(this),i=arguments.length,a=i>1?arguments[1]:void 0,o=a!==void 0;o&&(a=L5e(a,i>2?arguments[2]:void 0));var s=z5e(r),l=0,u,f,c,h,d,v;if(s&&!(this===$Y&&W5e(s)))for(h=j5e(r,s),d=h.next,f=n?new this:[];!(c=F5e(d,h)).done;l++)v=o?B5e(h,a,[c.value,l],!0):c.value,DY(f,l,v);else for(u=U5e(r),f=n?new this(u):$Y(u);u>l;l++)v=o?a(r[l],l):r[l],DY(f,l,v);return f.length=l,f},Y5e=Nt,K5e=G5e,X5e=cue,q5e=!X5e(function(e){Array.from(e)});Y5e({target:"Array",stat:!0,forced:q5e},{from:K5e});var Z5e=Nt,J5e=m1,Q5e=a4.indexOf,e6e=Bm,QN=J5e([].indexOf),Bue=!!QN&&1/QN([1],1,-0)<0,t6e=Bue||!e6e("indexOf");Z5e({target:"Array",proto:!0,forced:t6e},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return Bue?QN(this,t,r)||0:Q5e(this,t,r)}});var r6e=Nt,n6e=ir,i6e=Hm,a6e=n6e([].reverse),NY=[1,2];r6e({target:"Array",proto:!0,forced:String(NY)===String(NY.reverse())},{reverse:function(){return i6e(this)&&(this.length=this.length),a6e(this)}});var o6e=iv.forEach,s6e=Bm,l6e=s6e("forEach"),u6e=l6e?[].forEach:function(t){return o6e(this,t,arguments.length>1?arguments[1]:void 0)},LY=tn,FY=yue,f6e=mue,y2=u6e,c6e=tv,Wue=function(e){if(e&&e.forEach!==y2)try{c6e(e,"forEach",y2)}catch{e.forEach=y2}};for(var m2 in FY)FY[m2]&&Wue(LY[m2]&&LY[m2].prototype);Wue(f6e);var h6e=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",d6e=TypeError,Vue=function(e,t){if(e<t)throw d6e("Not enough arguments");return e},Uue=tn,v6e=av,p6e=cn,g6e=h6e,y6e=Jd,m6e=_1,b6e=Vue,w6e=Uue.Function,_6e=/MSIE .\./.test(y6e)||g6e&&function(){var e=Uue.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),U4=function(e,t){var r=t?2:1;return _6e?function(n,i){var a=b6e(arguments.length,1)>r,o=p6e(n)?n:w6e(n),s=a?m6e(arguments,r):[],l=a?function(){v6e(o,this,s)}:o;return t?e(l,i):e(l)}:e},S6e=Nt,jue=tn,C6e=U4,HY=C6e(jue.setInterval,!0);S6e({global:!0,bind:!0,forced:jue.setInterval!==HY},{setInterval:HY});var x6e=Nt,zue=tn,T6e=U4,BY=T6e(zue.setTimeout,!0);x6e({global:!0,bind:!0,forced:zue.setTimeout!==BY},{setTimeout:BY});var O6e=Jd,E6e=/(?:ipad|iphone|ipod).*applewebkit/i.test(O6e),R6e=Ol,Gue=typeof process<"u"&&R6e(process)=="process",ao=tn,k6e=av,A6e=b1,WY=cn,P6e=Rn,Yue=Kt,VY=yle,I6e=_1,UY=Bk,M6e=Vue,D6e=E6e,$6e=Gue,eL=ao.setImmediate,tL=ao.clearImmediate,N6e=ao.process,b2=ao.Dispatch,L6e=ao.Function,jY=ao.MessageChannel,F6e=ao.String,w2=0,Yb={},zY="onreadystatechange",Fw,yh,_2,S2;Yue(function(){Fw=ao.location});var j4=function(e){if(P6e(Yb,e)){var t=Yb[e];delete Yb[e],t()}},C2=function(e){return function(){j4(e)}},GY=function(e){j4(e.data)},YY=function(e){ao.postMessage(F6e(e),Fw.protocol+"//"+Fw.host)};(!eL||!tL)&&(eL=function(t){M6e(arguments.length,1);var r=WY(t)?t:L6e(t),n=I6e(arguments,1);return Yb[++w2]=function(){k6e(r,void 0,n)},yh(w2),w2},tL=function(t){delete Yb[t]},$6e?yh=function(e){N6e.nextTick(C2(e))}:b2&&b2.now?yh=function(e){b2.now(C2(e))}:jY&&!D6e?(_2=new jY,S2=_2.port2,_2.port1.onmessage=GY,yh=A6e(S2.postMessage,S2)):ao.addEventListener&&WY(ao.postMessage)&&!ao.importScripts&&Fw&&Fw.protocol!=="file:"&&!Yue(YY)?(yh=YY,ao.addEventListener("message",GY,!1)):zY in UY("script")?yh=function(e){VY.appendChild(UY("script"))[zY]=function(){VY.removeChild(this),j4(e)}}:yh=function(e){setTimeout(C2(e),0)});var Kue={set:eL,clear:tL},H6e=Nt,B6e=tn,KY=Kue.clear;H6e({global:!0,bind:!0,enumerable:!0,forced:B6e.clearImmediate!==KY},{clearImmediate:KY});var W6e=Nt,Xue=tn,XY=Kue.set,V6e=U4,qY=Xue.setImmediate?V6e(XY,!1):XY;W6e({global:!0,bind:!0,enumerable:!0,forced:Xue.setImmediate!==qY},{setImmediate:qY});var U6e=Qk,j6e=vue;U6e("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},j6e);var z6e=Nt,G6e=Kt,Y6e=Wa,que=Jk,K6e=Qle,X6e=G6e(function(){que(1)});z6e({target:"Object",stat:!0,forced:X6e,sham:!K6e},{getPrototypeOf:function(t){return que(Y6e(t))}});var q6e=Yn,Z6e=Ol,J6e=on,Q6e=J6e("match"),z4=function(e){var t;return q6e(e)&&((t=e[Q6e])!==void 0?!!t:Z6e(e)=="RegExp")},eze=z4,tze=TypeError,G4=function(e){if(eze(e))throw tze("The method doesn't accept regular expressions");return e},rze=on,nze=rze("match"),Y4=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[nze]=!1,"/./"[e](t)}catch{}}return!1},ize=Nt,aze=ir,oze=G4,sze=Ba,ZY=Kn,lze=Y4,uze=aze("".indexOf);ize({target:"String",proto:!0,forced:!lze("includes")},{includes:function(t){return!!~uze(ZY(sze(this)),ZY(oze(t)),arguments.length>1?arguments[1]:void 0)}});var fze=Nt,cze=iv.filter,hze=T1,dze=hze("filter");fze({target:"Array",proto:!0,forced:!dze},{filter:function(t){return cze(this,t,arguments.length>1?arguments[1]:void 0)}});var vze=ri,pze=Rn,gze=Mc,yze=$ue,JY=RegExp.prototype,Zue=function(e){var t=e.flags;return t===void 0&&!("flags"in JY)&&!pze(e,"flags")&&gze(JY,e)?vze(yze,e):t},mze=wa.f,bze=function(e,t,r){r in e||mze(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},wze=Gn,K4=tn,O1=ir,_ze=Vk,Sze=A4,Cze=tv,xze=rv.f,QY=Mc,Tze=z4,eK=Kn,Oze=Zue,Jue=B4,Eze=bze,Rze=Zo,kze=Kt,Aze=Rn,Pze=Qu.enforce,Ize=hue,Mze=on,Que=Nue,efe=Lue,Dze=Mze("match"),rc=K4.RegExp,xp=rc.prototype,$ze=K4.SyntaxError,Nze=O1(xp.exec),NE=O1("".charAt),tK=O1("".replace),rK=O1("".indexOf),Lze=O1("".slice),Fze=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,_d=/a/g,x2=/a/g,Hze=new rc(_d)!==_d,tfe=Jue.MISSED_STICKY,Bze=Jue.UNSUPPORTED_Y,Wze=wze&&(!Hze||tfe||Que||efe||kze(function(){return x2[Dze]=!1,rc(_d)!=_d||rc(x2)==x2||rc(_d,"i")!="/a/i"})),Vze=function(e){for(var t=e.length,r=0,n="",i=!1,a;r<=t;r++){if(a=NE(e,r),a==="\\"){n+=a+NE(e,++r);continue}!i&&a==="."?n+="[\\s\\S]":(a==="["?i=!0:a==="]"&&(i=!1),n+=a)}return n},Uze=function(e){for(var t=e.length,r=0,n="",i=[],a={},o=!1,s=!1,l=0,u="",f;r<=t;r++){if(f=NE(e,r),f==="\\")f=f+NE(e,++r);else if(f==="]")o=!1;else if(!o)switch(!0){case f==="[":o=!0;break;case f==="(":Nze(Fze,Lze(e,r+1))&&(r+=2,s=!0),n+=f,l++;continue;case(f===">"&&s):if(u===""||Aze(a,u))throw new $ze("Invalid capture group name");a[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=f:n+=f}return[n,i]};if(_ze("RegExp",Wze)){for(var mh=function(t,r){var n=QY(xp,this),i=Tze(t),a=r===void 0,o=[],s=t,l,u,f,c,h,d;if(!n&&i&&a&&t.constructor===mh)return t;if((i||QY(xp,t))&&(t=t.source,a&&(r=Oze(s))),t=t===void 0?"":eK(t),r=r===void 0?"":eK(r),s=t,Que&&"dotAll"in _d&&(u=!!r&&rK(r,"s")>-1,u&&(r=tK(r,/s/g,""))),l=r,tfe&&"sticky"in _d&&(f=!!r&&rK(r,"y")>-1,f&&Bze&&(r=tK(r,/y/g,""))),efe&&(c=Uze(t),t=c[0],o=c[1]),h=Sze(rc(t,r),n?this:xp,mh),(u||f||o.length)&&(d=Pze(h),u&&(d.dotAll=!0,d.raw=mh(Vze(t),l)),f&&(d.sticky=!0),o.length&&(d.groups=o)),t!==s)try{Cze(h,"source",s===""?"(?:)":s)}catch{}return h},nK=xze(rc),iK=0;nK.length>iK;)Eze(mh,rc,nK[iK++]);xp.constructor=mh,mh.prototype=xp,Rze(K4,"RegExp",mh,{constructor:!0})}Ize("RegExp");var jze=c1.PROPER,zze=Zo,Gze=$n,aK=Kn,Yze=Kt,Kze=Zue,X4="toString",Xze=RegExp.prototype,rfe=Xze[X4],qze=Yze(function(){return rfe.call({source:"a",flags:"b"})!="/a/b"}),Zze=jze&&rfe.name!=X4;(qze||Zze)&&zze(RegExp.prototype,X4,function(){var t=Gze(this),r=aK(t.source),n=aK(Kze(t));return"/"+r+"/"+n},{unsafe:!0});var Jze=Nt,Qze=ir,eGe=l1,tGe=co,rGe=Bm,nGe=Qze([].join),iGe=eGe!=Object,aGe=iGe||!rGe("join",",");Jze({target:"Array",proto:!0,forced:aGe},{join:function(t){return nGe(tGe(this),t===void 0?",":t)}});var oGe=c1.PROPER,sGe=Kt,oK=Eue,sK="​᠎",lGe=function(e){return sGe(function(){return!!oK[e]()||sK[e]()!==sK||oGe&&oK[e].name!==e})},uGe=Nt,fGe=Rue.trim,cGe=lGe;uGe({target:"String",proto:!0,forced:cGe("trim")},{trim:function(){return fGe(this)}});function rL(e){return rL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rL(e)}function sA(e){return window.requestAnimationFrame(e)}function nfe(){return!!document.documentElement.classList}function ife(){return!!document.createTextNode("test").textContent}function afe(){return!!window.getComputedStyle}function Hw(e){window.cancelAnimationFrame(e)}function q4(){return"ontouchstart"in window}var nL;function hGe(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),nL=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function Z4(){return nL===void 0&&hGe(),nL}var Yv;function ofe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yv||((typeof Intl>"u"?"undefined":rL(Intl))==="object"?Yv=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?Yv=function(n,i){return"".concat(n).localeCompare(i)}:Yv=function(n,i){return n===i?0:n>i?-1:1},Yv)}var W0;function sfe(){if(W0!==void 0)return W0;try{var e={get passive(){W0=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{W0=!1}return W0}const dGe=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Hw,getComparisonFunction:ofe,hasCaptionProblem:Z4,isClassListSupported:nfe,isGetComputedStyleSupported:afe,isPassiveEventSupported:sfe,isTextContentSupported:ife,isTouchSupported:q4,requestAnimationFrame:sA},Symbol.toStringTag,{value:"Module"}));var vGe=c4,pGe=Cle;vGe("toPrimitive");pGe();var gGe=$n,yGe=ile,mGe=TypeError,bGe=function(e){if(gGe(this),e==="string"||e==="default")e="string";else if(e!=="number")throw mGe("Incorrect hint");return yGe(this,e)},wGe=Rn,_Ge=Zo,SGe=bGe,CGe=on,lK=CGe("toPrimitive"),uK=Date.prototype;wGe(uK,lK)||_Ge(uK,lK,SGe);var xGe=Gk,TGe=Nm,OGe=TypeError,lfe=function(e){if(xGe(e))return e;throw OGe(TGe(e)+" is not a constructor")},fK=$n,EGe=lfe,RGe=Hs,kGe=on,AGe=kGe("species"),PGe=function(e,t){var r=fK(e).constructor,n;return r===void 0||RGe(n=fK(r)[AGe])?t:EGe(n)},IGe=av,V0=ri,J4=ir,MGe=iA,DGe=$n,$Ge=Hs,NGe=z4,cK=Ba,LGe=PGe,FGe=W4,HGe=nv,T2=Kn,BGe=ev,hK=u4,dK=aA,WGe=nA,VGe=B4,UGe=Kt,Kv=VGe.UNSUPPORTED_Y,vK=4294967295,jGe=Math.min,ufe=[].push,zGe=J4(/./.exec),Xv=J4(ufe),U0=J4("".slice),GGe=!UGe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});MGe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var o=T2(cK(this)),s=a===void 0?vK:a>>>0;if(s===0)return[];if(i===void 0)return[o];if(!NGe(i))return V0(t,o,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),f=0,c=new RegExp(i.source,u+"g"),h,d,v;(h=V0(WGe,c,o))&&(d=c.lastIndex,!(d>f&&(Xv(l,U0(o,f,h.index)),h.length>1&&h.index<o.length&&IGe(ufe,l,hK(h,1)),v=h[0].length,f=d,l.length>=s)));)c.lastIndex===h.index&&c.lastIndex++;return f===o.length?(v||!zGe(c,""))&&Xv(l,""):Xv(l,U0(o,f)),l.length>s?hK(l,0,s):l}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:V0(t,this,i,a)}:n=t,[function(a,o){var s=cK(this),l=$Ge(a)?void 0:BGe(a,e);return l?V0(l,a,s,o):V0(n,T2(s),a,o)},function(i,a){var o=DGe(this),s=T2(i),l=r(n,o,s,a,n!==t);if(l.done)return l.value;var u=LGe(o,RegExp),f=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(Kv?"g":"y"),h=new u(Kv?"^(?:"+o.source+")":o,c),d=a===void 0?vK:a>>>0;if(d===0)return[];if(s.length===0)return dK(h,s)===null?[s]:[];for(var v=0,g=0,y=[];g<s.length;){h.lastIndex=Kv?0:g;var b=dK(h,Kv?U0(s,g):s),w;if(b===null||(w=jGe(HGe(h.lastIndex+(Kv?g:0)),s.length))===v)g=FGe(s,g,f);else{if(Xv(y,U0(s,v,g)),y.length===d)return y;for(var _=1;_<=b.length-1;_++)if(Xv(y,b[_]),y.length===d)return y;g=v=w}}return Xv(y,U0(s,v)),y}]},!GGe,Kv);function ffe(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function iL(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Kb(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var a=0;a<n;a++)t[a]||(t[a]=[]),t[a][i]=e[i][a];return t}function Nn(e,t,r,n){var i=-1,a=e,o=r;Array.isArray(e)||(a=Array.from(e));var s=a.length;for(n&&s&&(i+=1,o=a[i]),i+=1;i<s;)o=t(o,a[i],i,a),i+=1;return o}function lo(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];t(s,r,n)&&(o+=1,a[o]=s),r+=1}return a}function tr(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];o+=1,a[o]=t(s,r,n),r+=1}return a}function ve(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function cfe(e){return Nn(e,function(t,r){return t+r},0)}function YGe(e){return Nn(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function KGe(e){return Nn(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function XGe(e){return e.length?cfe(e)/e.length:0}function hfe(e){return Nn(e,function(t,r){return t.concat(Array.isArray(r)?hfe(r):r)},[])}function Q4(e){var t=[];return ve(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function aL(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ve(a,function(s){o=o.filter(function(l){return!s.includes(l)})}),o}function qGe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ve(a,function(s){o=o.filter(function(l){return s.includes(l)})}),o}function ZGe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=new Set(i);return ve(a,function(s){ve(s,function(l){o.has(l)||o.add(l)})}),Array.from(o)}function oL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const JGe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:XGe,arrayEach:ve,arrayFilter:lo,arrayFlatten:hfe,arrayMap:tr,arrayMax:YGe,arrayMin:KGe,arrayReduce:Nn,arraySum:cfe,arrayUnique:Q4,extendArray:iL,getDifferenceOfArrays:aL,getIntersectionOfArrays:qGe,getUnionOfArrays:ZGe,pivot:Kb,stringToArray:oL,to2dArray:ffe},Symbol.toStringTag,{value:"Module"}));function pK(e,t,r){return t=QGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QGe(e){var t=e9e(e,"string");return zu(t)==="symbol"?t:String(t)}function e9e(e,t){if(zu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zu(e){return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(e)}function _g(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},nr(e,function(r,n){n!=="__children"&&(r&&zu(r)==="object"&&!Array.isArray(r)?t[n]=_g(r):Array.isArray(r)?r.length&&zu(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[_g(r[0])]:t[n]=[]:t[n]=null)})),t}function ef(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function zn(e,t,r){var n=Array.isArray(r);return nr(t,function(i,a){(n===!1||r.includes(a))&&(e[a]=i)}),e}function E1(e,t){nr(t,function(r,n){t[n]&&zu(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),E1(e[n],t[n])):e[n]=t[n]})}function Ui(e){return zu(e)==="object"?JSON.parse(JSON.stringify(e)):e}function ca(e){var t={};return nr(e,function(r,n){t[n]=r}),t}function qr(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ve(r,function(i){e.MIXINS.push(i.MIXIN_NAME),nr(i,function(a,o){if(e.prototype[o]!==void 0)throw new Error("Mixin conflict. Property '".concat(o,"' already exist and cannot be overwritten."));if(typeof a=="function")e.prototype[o]=a;else{var s=function(f,c){var h="_".concat(f),d=function(g){var y=g;return(Array.isArray(y)||rr(y))&&(y=Ui(y)),y};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},l=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,o,{get:s(o,a),set:l(o),configurable:!0})}})}),e}function eW(e,t){return JSON.stringify(e)===JSON.stringify(t)}function rr(e){return Object.prototype.toString.call(e)==="[object Object]"}function El(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function nr(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function dfe(e,t){var r=t.split("."),n=e;return nr(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function vO(e,t,r){var n=t.split("."),i=e;n.forEach(function(a,o){o!==n.length-1?(On(i,a)||(i[a]={}),i=i[a]):i[a]=r})}function lA(e){if(!rr(e))return 0;var t=function r(n){var i=0;return rr(n)?nr(n,function(a,o){o!=="__children"&&(i+=r(a))}):i+=1,i};return t(e)}function Id(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},pK(t,n,e),pK(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(o){this._touched=!0,this[n]=o},enumerable:!0,configurable:!0}),i}function On(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const t9e=Object.freeze(Object.defineProperty({__proto__:null,clone:ca,createObjectPropListener:Id,deepClone:Ui,deepExtend:E1,deepObjectSize:lA,defineGetter:El,duckSchema:_g,extend:zn,getProperty:dfe,hasOwnProperty:On,inherit:ef,isObject:rr,isObjectEqual:eW,mixin:qr,objectEach:nr,setProperty:vO},Symbol.toStringTag,{value:"Module"}));var Pa=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},uo={chrome:Pa(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Pa(function(e){return/CriOS/.test(e)}),edge:Pa(function(e){return/Edge/.test(e)}),edgeWebKit:Pa(function(e){return/EdgiOS/.test(e)}),firefox:Pa(function(e){return/Firefox/.test(e)}),firefoxWebKit:Pa(function(e){return/FxiOS/.test(e)}),ie:Pa(function(e){return/Trident/.test(e)}),ie9:Pa(function(){return!!document.documentMode}),mobile:Pa(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Pa(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Wm={mac:Pa(function(e){return/^Mac/.test(e)}),win:Pa(function(e){return/^Win/.test(e)}),linux:Pa(function(e){return/^Linux/.test(e)}),ios:Pa(function(e){return/iPhone|iPad|iPod/i.test(e)})};function vfe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;nr(uo,function(a){var o=a.test;return void o(r,i)})}function pfe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;nr(Wm,function(n){var i=n.test;return void i(r)})}vfe();pfe();function tW(){return uo.chrome.value}function gfe(){return uo.chromeWebKit.value}function pO(){return uo.firefox.value}function yfe(){return uo.firefoxWebKit.value}function mfe(){return uo.safari.value}function bfe(){return uo.edge.value}function r9e(){return uo.edgeWebKit.value}function wfe(){return uo.ie.value}function _fe(){return uo.ie9.value}function n9e(){return uo.ie.value||uo.edge.value}function Es(){return uo.mobile.value}function rW(){return Wm.ios.value}function nW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Wm.mac.value}function sL(){return Wm.win.value}function LE(){return Wm.mac.value}function i9e(){return Wm.linux.value}const a9e=Object.freeze(Object.defineProperty({__proto__:null,isChrome:tW,isChromeWebKit:gfe,isEdge:bfe,isEdgeWebKit:r9e,isFirefox:pO,isFirefoxWebKit:yfe,isIE:wfe,isIE9:_fe,isIOS:rW,isIpadOS:nW,isLinuxOS:i9e,isMSBrowser:n9e,isMacOS:LE,isMobileBrowser:Es,isSafari:mfe,isWindowsOS:sL,setBrowserMeta:vfe,setPlatformMeta:pfe},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function Hf(e){return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hf(e)}function lL(e,t){return lL=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},lL(e,t)}function o9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gO(e,t,r){return o9e()?gO=Reflect.construct:gO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&lL(u,o.prototype),u},gO.apply(null,arguments)}function gs(e){return s9e(e)||l9e(e)||u9e(e)||f9e()}function s9e(e){if(Array.isArray(e))return uL(e)}function l9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function u9e(e,t){if(e){if(typeof e=="string")return uL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uL(e,t)}}function uL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c9e=Object.hasOwnProperty,gK=Object.setPrototypeOf,h9e=Object.isFrozen,d9e=Object.getPrototypeOf,v9e=Object.getOwnPropertyDescriptor,ya=Object.freeze,Is=Object.seal,p9e=Object.create,Sfe=typeof Reflect<"u"&&Reflect,FE=Sfe.apply,fL=Sfe.construct;FE||(FE=function(t,r,n){return t.apply(r,n)});ya||(ya=function(t){return t});Is||(Is=function(t){return t});fL||(fL=function(t,r){return gO(t,gs(r))});var g9e=Yo(Array.prototype.forEach),yK=Yo(Array.prototype.pop),j0=Yo(Array.prototype.push),yO=Yo(String.prototype.toLowerCase),O2=Yo(String.prototype.toString),y9e=Yo(String.prototype.match),fs=Yo(String.prototype.replace),m9e=Yo(String.prototype.indexOf),b9e=Yo(String.prototype.trim),Ji=Yo(RegExp.prototype.test),E2=w9e(TypeError);function Yo(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return FE(e,t,n)}}function w9e(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return fL(e,r)}}function ur(e,t,r){r=r||yO,gK&&gK(e,null);for(var n=t.length;n--;){var i=t[n];if(typeof i=="string"){var a=r(i);a!==i&&(h9e(t)||(t[n]=a),i=a)}e[i]=!0}return e}function bh(e){var t=p9e(null),r;for(r in e)FE(c9e,e,[r])===!0&&(t[r]=e[r]);return t}function Gx(e,t){for(;e!==null;){var r=v9e(e,t);if(r){if(r.get)return Yo(r.get);if(typeof r.value=="function")return Yo(r.value)}e=d9e(e)}function n(i){return console.warn("fallback value for",i),null}return n}var mK=ya(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),R2=ya(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),k2=ya(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_9e=ya(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),A2=ya(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),S9e=ya(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),bK=ya(["#text"]),wK=ya(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),P2=ya(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_K=ya(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Yx=ya(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),C9e=Is(/\{\{[\w\W]*|[\w\W]*\}\}/gm),x9e=Is(/<%[\w\W]*|[\w\W]*%>/gm),T9e=Is(/\${[\w\W]*}/gm),O9e=Is(/^data-[\-\w.\u00B7-\uFFFF]/),E9e=Is(/^aria-[\-\w]+$/),R9e=Is(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),k9e=Is(/^(?:\w+script|data):/i),A9e=Is(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),P9e=Is(/^html$/i),I9e=function(){return typeof window>"u"?null:window},M9e=function(t,r){if(Hf(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var a="dompurify"+(n?"#"+n:"");try{return t.createPolicy(a,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}};function Cfe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I9e(),t=function(X){return Cfe(X)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,a=e.HTMLTemplateElement,o=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=s.prototype,g=Gx(v,"cloneNode"),y=Gx(v,"nextSibling"),b=Gx(v,"childNodes"),w=Gx(v,"parentNode");if(typeof a=="function"){var _=n.createElement("template");_.content&&_.content.ownerDocument&&(n=_.content.ownerDocument)}var x=M9e(d,r),E=x?x.createHTML(""):"",R=n,A=R.implementation,N=R.createNodeIterator,I=R.createDocumentFragment,F=R.getElementsByTagName,H=r.importNode,W={};try{W=bh(n).documentMode?n.documentMode:{}}catch{}var z={};t.isSupported=typeof w=="function"&&A&&typeof A.createHTMLDocument<"u"&&W!==9;var te=C9e,ie=x9e,fe=T9e,Te=O9e,M=E9e,S=k9e,T=A9e,k=R9e,O=null,D=ur({},[].concat(gs(mK),gs(R2),gs(k2),gs(A2),gs(bK))),L=null,B=ur({},[].concat(gs(wK),gs(P2),gs(_K),gs(Yx))),Y=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,he=null,ce=!0,le=!0,xe=!1,U=!0,De=!1,de=!1,He=!1,Be=!1,Ae=!1,Ke=!1,Xe=!1,G=!0,q=!1,ae="user-content-",be=!0,se=!1,Oe={},pe=null,ge=ur({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),me=null,Ce=ur({},["audio","video","img","source","image","track"]),Se=null,Le=ur({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),qe="http://www.w3.org/1998/Math/MathML",Qe="http://www.w3.org/2000/svg",wt="http://www.w3.org/1999/xhtml",Pt=wt,Jt=!1,Ot=null,Et=ur({},[qe,Qe,wt],O2),jt,qt=["application/xhtml+xml","text/html"],zt="text/html",Ht,At=null,st=n.createElement("form"),rt=function(X){return X instanceof RegExp||X instanceof Function},_t=function(X){At&&At===X||((!X||Hf(X)!=="object")&&(X={}),X=bh(X),jt=qt.indexOf(X.PARSER_MEDIA_TYPE)===-1?jt=zt:jt=X.PARSER_MEDIA_TYPE,Ht=jt==="application/xhtml+xml"?O2:yO,O="ALLOWED_TAGS"in X?ur({},X.ALLOWED_TAGS,Ht):D,L="ALLOWED_ATTR"in X?ur({},X.ALLOWED_ATTR,Ht):B,Ot="ALLOWED_NAMESPACES"in X?ur({},X.ALLOWED_NAMESPACES,O2):Et,Se="ADD_URI_SAFE_ATTR"in X?ur(bh(Le),X.ADD_URI_SAFE_ATTR,Ht):Le,me="ADD_DATA_URI_TAGS"in X?ur(bh(Ce),X.ADD_DATA_URI_TAGS,Ht):Ce,pe="FORBID_CONTENTS"in X?ur({},X.FORBID_CONTENTS,Ht):ge,Q="FORBID_TAGS"in X?ur({},X.FORBID_TAGS,Ht):{},he="FORBID_ATTR"in X?ur({},X.FORBID_ATTR,Ht):{},Oe="USE_PROFILES"in X?X.USE_PROFILES:!1,ce=X.ALLOW_ARIA_ATTR!==!1,le=X.ALLOW_DATA_ATTR!==!1,xe=X.ALLOW_UNKNOWN_PROTOCOLS||!1,U=X.ALLOW_SELF_CLOSE_IN_ATTR!==!1,De=X.SAFE_FOR_TEMPLATES||!1,de=X.WHOLE_DOCUMENT||!1,Ae=X.RETURN_DOM||!1,Ke=X.RETURN_DOM_FRAGMENT||!1,Xe=X.RETURN_TRUSTED_TYPE||!1,Be=X.FORCE_BODY||!1,G=X.SANITIZE_DOM!==!1,q=X.SANITIZE_NAMED_PROPS||!1,be=X.KEEP_CONTENT!==!1,se=X.IN_PLACE||!1,k=X.ALLOWED_URI_REGEXP||k,Pt=X.NAMESPACE||wt,Y=X.CUSTOM_ELEMENT_HANDLING||{},X.CUSTOM_ELEMENT_HANDLING&&rt(X.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Y.tagNameCheck=X.CUSTOM_ELEMENT_HANDLING.tagNameCheck),X.CUSTOM_ELEMENT_HANDLING&&rt(X.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Y.attributeNameCheck=X.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),X.CUSTOM_ELEMENT_HANDLING&&typeof X.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Y.allowCustomizedBuiltInElements=X.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(le=!1),Ke&&(Ae=!0),Oe&&(O=ur({},gs(bK)),L=[],Oe.html===!0&&(ur(O,mK),ur(L,wK)),Oe.svg===!0&&(ur(O,R2),ur(L,P2),ur(L,Yx)),Oe.svgFilters===!0&&(ur(O,k2),ur(L,P2),ur(L,Yx)),Oe.mathMl===!0&&(ur(O,A2),ur(L,_K),ur(L,Yx))),X.ADD_TAGS&&(O===D&&(O=bh(O)),ur(O,X.ADD_TAGS,Ht)),X.ADD_ATTR&&(L===B&&(L=bh(L)),ur(L,X.ADD_ATTR,Ht)),X.ADD_URI_SAFE_ATTR&&ur(Se,X.ADD_URI_SAFE_ATTR,Ht),X.FORBID_CONTENTS&&(pe===ge&&(pe=bh(pe)),ur(pe,X.FORBID_CONTENTS,Ht)),be&&(O["#text"]=!0),de&&ur(O,["html","head","body"]),O.table&&(ur(O,["tbody"]),delete Q.tbody),ya&&ya(X),At=X)},tt=ur({},["mi","mo","mn","ms","mtext"]),Tt=ur({},["foreignobject","desc","title","annotation-xml"]),nt=ur({},["title","style","font","a","script"]),ht=ur({},R2);ur(ht,k2),ur(ht,_9e);var cr=ur({},A2);ur(cr,S9e);var dr=function(X){var Ee=w(X);(!Ee||!Ee.tagName)&&(Ee={namespaceURI:Pt,tagName:"template"});var Me=yO(X.tagName),ze=yO(Ee.tagName);return Ot[X.namespaceURI]?X.namespaceURI===Qe?Ee.namespaceURI===wt?Me==="svg":Ee.namespaceURI===qe?Me==="svg"&&(ze==="annotation-xml"||tt[ze]):!!ht[Me]:X.namespaceURI===qe?Ee.namespaceURI===wt?Me==="math":Ee.namespaceURI===Qe?Me==="math"&&Tt[ze]:!!cr[Me]:X.namespaceURI===wt?Ee.namespaceURI===Qe&&!Tt[ze]||Ee.namespaceURI===qe&&!tt[ze]?!1:!cr[Me]&&(nt[Me]||!ht[Me]):!!(jt==="application/xhtml+xml"&&Ot[X.namespaceURI]):!1},br=function(X){j0(t.removed,{element:X});try{X.parentNode.removeChild(X)}catch{try{X.outerHTML=E}catch{X.remove()}}},ni=function(X,Ee){try{j0(t.removed,{attribute:Ee.getAttributeNode(X),from:Ee})}catch{j0(t.removed,{attribute:null,from:Ee})}if(Ee.removeAttribute(X),X==="is"&&!L[X])if(Ae||Ke)try{br(Ee)}catch{}else try{Ee.setAttribute(X,"")}catch{}},Dr=function(X){var Ee,Me;if(Be)X="<remove></remove>"+X;else{var ze=y9e(X,/^[\r\n\t ]+/);Me=ze&&ze[0]}jt==="application/xhtml+xml"&&Pt===wt&&(X='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+X+"</body></html>");var Ue=x?x.createHTML(X):X;if(Pt===wt)try{Ee=new h().parseFromString(Ue,jt)}catch{}if(!Ee||!Ee.documentElement){Ee=A.createDocument(Pt,"template",null);try{Ee.documentElement.innerHTML=Jt?E:Ue}catch{}}var Je=Ee.body||Ee.documentElement;return X&&Me&&Je.insertBefore(n.createTextNode(Me),Je.childNodes[0]||null),Pt===wt?F.call(Ee,de?"html":"body")[0]:de?Ee.documentElement:Je},j=function(X){return N.call(X.ownerDocument||X,X,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},re=function(X){return X instanceof c&&(typeof X.nodeName!="string"||typeof X.textContent!="string"||typeof X.removeChild!="function"||!(X.attributes instanceof f)||typeof X.removeAttribute!="function"||typeof X.setAttribute!="function"||typeof X.namespaceURI!="string"||typeof X.insertBefore!="function"||typeof X.hasChildNodes!="function")},J=function(X){return Hf(o)==="object"?X instanceof o:X&&Hf(X)==="object"&&typeof X.nodeType=="number"&&typeof X.nodeName=="string"},ee=function(X,Ee,Me){z[X]&&g9e(z[X],function(ze){ze.call(t,Ee,Me,At)})},ne=function(X){var Ee;if(ee("beforeSanitizeElements",X,null),re(X)||Ji(/[\u0080-\uFFFF]/,X.nodeName))return br(X),!0;var Me=Ht(X.nodeName);if(ee("uponSanitizeElement",X,{tagName:Me,allowedTags:O}),X.hasChildNodes()&&!J(X.firstElementChild)&&(!J(X.content)||!J(X.content.firstElementChild))&&Ji(/<[/\w]/g,X.innerHTML)&&Ji(/<[/\w]/g,X.textContent)||Me==="select"&&Ji(/<template/i,X.innerHTML))return br(X),!0;if(!O[Me]||Q[Me]){if(!Q[Me]&&Ie(Me)&&(Y.tagNameCheck instanceof RegExp&&Ji(Y.tagNameCheck,Me)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(Me)))return!1;if(be&&!pe[Me]){var ze=w(X)||X.parentNode,Ue=b(X)||X.childNodes;if(Ue&&ze)for(var Je=Ue.length,St=Je-1;St>=0;--St)ze.insertBefore(g(Ue[St],!0),y(X))}return br(X),!0}return X instanceof s&&!dr(X)||(Me==="noscript"||Me==="noembed")&&Ji(/<\/no(script|embed)/i,X.innerHTML)?(br(X),!0):(De&&X.nodeType===3&&(Ee=X.textContent,Ee=fs(Ee,te," "),Ee=fs(Ee,ie," "),Ee=fs(Ee,fe," "),X.textContent!==Ee&&(j0(t.removed,{element:X.cloneNode()}),X.textContent=Ee)),ee("afterSanitizeElements",X,null),!1)},oe=function(X,Ee,Me){if(G&&(Ee==="id"||Ee==="name")&&(Me in n||Me in st))return!1;if(!(le&&!he[Ee]&&Ji(Te,Ee))){if(!(ce&&Ji(M,Ee))){if(!L[Ee]||he[Ee]){if(!(Ie(X)&&(Y.tagNameCheck instanceof RegExp&&Ji(Y.tagNameCheck,X)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(X))&&(Y.attributeNameCheck instanceof RegExp&&Ji(Y.attributeNameCheck,Ee)||Y.attributeNameCheck instanceof Function&&Y.attributeNameCheck(Ee))||Ee==="is"&&Y.allowCustomizedBuiltInElements&&(Y.tagNameCheck instanceof RegExp&&Ji(Y.tagNameCheck,Me)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(Me))))return!1}else if(!Se[Ee]){if(!Ji(k,fs(Me,T,""))){if(!((Ee==="src"||Ee==="xlink:href"||Ee==="href")&&X!=="script"&&m9e(Me,"data:")===0&&me[X])){if(!(xe&&!Ji(S,fs(Me,T,"")))){if(Me)return!1}}}}}}return!0},Ie=function(X){return X.indexOf("-")>0},Ne=function(X){var Ee,Me,ze,Ue;ee("beforeSanitizeAttributes",X,null);var Je=X.attributes;if(Je){var St={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:L};for(Ue=Je.length;Ue--;){Ee=Je[Ue];var $r=Ee,Ut=$r.name,wn=$r.namespaceURI;if(Me=Ut==="value"?Ee.value:b9e(Ee.value),ze=Ht(Ut),St.attrName=ze,St.attrValue=Me,St.keepAttr=!0,St.forceKeepAttr=void 0,ee("uponSanitizeAttribute",X,St),Me=St.attrValue,!St.forceKeepAttr&&(ni(Ut,X),!!St.keepAttr)){if(!U&&Ji(/\/>/i,Me)){ni(Ut,X);continue}De&&(Me=fs(Me,te," "),Me=fs(Me,ie," "),Me=fs(Me,fe," "));var ns=Ht(X.nodeName);if(oe(ns,ze,Me)){if(q&&(ze==="id"||ze==="name")&&(ni(Ut,X),Me=ae+Me),x&&Hf(d)==="object"&&typeof d.getAttributeType=="function"&&!wn)switch(d.getAttributeType(ns,ze)){case"TrustedHTML":Me=x.createHTML(Me);break;case"TrustedScriptURL":Me=x.createScriptURL(Me);break}try{wn?X.setAttributeNS(wn,Ut,Me):X.setAttribute(Ut,Me),yK(t.removed)}catch{}}}}ee("afterSanitizeAttributes",X,null)}},Pe=function we(X){var Ee,Me=j(X);for(ee("beforeSanitizeShadowDOM",X,null);Ee=Me.nextNode();)ee("uponSanitizeShadowNode",Ee,null),!ne(Ee)&&(Ee.content instanceof i&&we(Ee.content),Ne(Ee));ee("afterSanitizeShadowDOM",X,null)};return t.sanitize=function(we){var X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ee,Me,ze,Ue,Je;if(Jt=!we,Jt&&(we="<!-->"),typeof we!="string"&&!J(we)){if(typeof we.toString!="function")throw E2("toString is not a function");if(we=we.toString(),typeof we!="string")throw E2("dirty is not a string, aborting")}if(!t.isSupported){if(Hf(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof we=="string")return e.toStaticHTML(we);if(J(we))return e.toStaticHTML(we.outerHTML)}return we}if(He||_t(X),t.removed=[],typeof we=="string"&&(se=!1),se){if(we.nodeName){var St=Ht(we.nodeName);if(!O[St]||Q[St])throw E2("root node is forbidden and cannot be sanitized in-place")}}else if(we instanceof o)Ee=Dr("<!---->"),Me=Ee.ownerDocument.importNode(we,!0),Me.nodeType===1&&Me.nodeName==="BODY"||Me.nodeName==="HTML"?Ee=Me:Ee.appendChild(Me);else{if(!Ae&&!De&&!de&&we.indexOf("<")===-1)return x&&Xe?x.createHTML(we):we;if(Ee=Dr(we),!Ee)return Ae?null:Xe?E:""}Ee&&Be&&br(Ee.firstChild);for(var $r=j(se?we:Ee);ze=$r.nextNode();)ze.nodeType===3&&ze===Ue||ne(ze)||(ze.content instanceof i&&Pe(ze.content),Ne(ze),Ue=ze);if(Ue=null,se)return we;if(Ae){if(Ke)for(Je=I.call(Ee.ownerDocument);Ee.firstChild;)Je.appendChild(Ee.firstChild);else Je=Ee;return(L.shadowroot||L.shadowrootmod)&&(Je=H.call(r,Je,!0)),Je}var Ut=de?Ee.outerHTML:Ee.innerHTML;return de&&O["!doctype"]&&Ee.ownerDocument&&Ee.ownerDocument.doctype&&Ee.ownerDocument.doctype.name&&Ji(P9e,Ee.ownerDocument.doctype.name)&&(Ut="<!DOCTYPE "+Ee.ownerDocument.doctype.name+`>
`+Ut),De&&(Ut=fs(Ut,te," "),Ut=fs(Ut,ie," "),Ut=fs(Ut,fe," ")),x&&Xe?x.createHTML(Ut):Ut},t.setConfig=function(we){_t(we),He=!0},t.clearConfig=function(){At=null,He=!1},t.isValidAttribute=function(we,X,Ee){At||_t({});var Me=Ht(we),ze=Ht(X);return oe(Me,ze,Ee)},t.addHook=function(we,X){typeof X=="function"&&(z[we]=z[we]||[],j0(z[we],X))},t.removeHook=function(we){if(z[we])return yK(z[we])},t.removeHooks=function(we){z[we]&&(z[we]=[])},t.removeAllHooks=function(){z={}},t}var D9e=Cfe(),$9e=Nt,N9e=M4.codeAt;$9e({target:"String",proto:!0},{codePointAt:function(t){return N9e(this,t)}});var L9e=Dc,F9e=Kn,H9e=Ba,B9e=RangeError,xfe=function(t){var r=F9e(H9e(this)),n="",i=L9e(t);if(i<0||i==1/0)throw B9e("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},Tfe=ir,W9e=nv,SK=Kn,V9e=xfe,U9e=Ba,j9e=Tfe(V9e),z9e=Tfe("".slice),G9e=Math.ceil,CK=function(e){return function(t,r,n){var i=SK(U9e(t)),a=W9e(r),o=i.length,s=n===void 0?" ":SK(n),l,u;return a<=o||s==""?i:(l=a-o,u=j9e(s,G9e(l/s.length)),u.length>l&&(u=z9e(u,0,l)),e?i+u:u+i)}},Y9e={start:CK(!1),end:CK(!0)},K9e=Jd,X9e=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(K9e),q9e=Nt,Z9e=Y9e.start,J9e=X9e;q9e({target:"String",proto:!0,forced:J9e},{padStart:function(t){return Z9e(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Ofe;function Ye(){return Ofe.apply(null,arguments)}function Q9e(e){Ofe=e}function Ms(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Sd(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Pr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function iW(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Pr(e,t))return!1;return!0}function ka(e){return e===void 0}function Gu(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function R1(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Efe(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function Kf(e,t){for(var r in t)Pr(t,r)&&(e[r]=t[r]);return Pr(t,"toString")&&(e.toString=t.toString),Pr(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Rl(e,t,r,n){return Zfe(e,t,r,n,!0).utc()}function e7e(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function or(e){return e._pf==null&&(e._pf=e7e()),e._pf}var cL;Array.prototype.some?cL=Array.prototype.some:cL=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function aW(e){if(e._isValid==null){var t=or(e),r=cL.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function uA(e){var t=Rl(NaN);return e!=null?Kf(or(t),e):or(t).userInvalidated=!0,t}var xK=Ye.momentProperties=[],I2=!1;function oW(e,t){var r,n,i,a=xK.length;if(ka(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),ka(t._i)||(e._i=t._i),ka(t._f)||(e._f=t._f),ka(t._l)||(e._l=t._l),ka(t._strict)||(e._strict=t._strict),ka(t._tzm)||(e._tzm=t._tzm),ka(t._isUTC)||(e._isUTC=t._isUTC),ka(t._offset)||(e._offset=t._offset),ka(t._pf)||(e._pf=or(t)),ka(t._locale)||(e._locale=t._locale),a>0)for(r=0;r<a;r++)n=xK[r],i=t[n],ka(i)||(e[n]=i);return e}function k1(e){oW(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),I2===!1&&(I2=!0,Ye.updateOffset(this),I2=!1)}function Ds(e){return e instanceof k1||e!=null&&e._isAMomentObject!=null}function Rfe(e){Ye.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Qo(e,t){var r=!0;return Kf(function(){if(Ye.deprecationHandler!=null&&Ye.deprecationHandler(null,e),r){var n=[],i,a,o,s=arguments.length;for(a=0;a<s;a++){if(i="",typeof arguments[a]=="object"){i+=`
[`+a+"] ";for(o in arguments[0])Pr(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[a];n.push(i)}Rfe(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var TK={};function kfe(e,t){Ye.deprecationHandler!=null&&Ye.deprecationHandler(e,t),TK[e]||(Rfe(t),TK[e]=!0)}Ye.suppressDeprecationWarnings=!1;Ye.deprecationHandler=null;function kl(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function t7e(e){var t,r;for(r in e)Pr(e,r)&&(t=e[r],kl(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function hL(e,t){var r=Kf({},e),n;for(n in t)Pr(t,n)&&(Sd(e[n])&&Sd(t[n])?(r[n]={},Kf(r[n],e[n]),Kf(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Pr(e,n)&&!Pr(t,n)&&Sd(e[n])&&(r[n]=Kf({},r[n]));return r}function sW(e){e!=null&&this.set(e)}var dL;Object.keys?dL=Object.keys:dL=function(e){var t,r=[];for(t in e)Pr(e,t)&&r.push(t);return r};var r7e={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function n7e(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return kl(n)?n.call(t,r):n}function bl(e,t,r){var n=""+Math.abs(e),i=t-n.length,a=e>=0;return(a?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var lW=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Kx=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,M2={},Xp={};function kt(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(Xp[e]=i),t&&(Xp[t[0]]=function(){return bl(i.apply(this,arguments),t[1],t[2])}),r&&(Xp[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function i7e(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function a7e(e){var t=e.match(lW),r,n;for(r=0,n=t.length;r<n;r++)Xp[t[r]]?t[r]=Xp[t[r]]:t[r]=i7e(t[r]);return function(i){var a="",o;for(o=0;o<n;o++)a+=kl(t[o])?t[o].call(i,e):t[o];return a}}function mO(e,t){return e.isValid()?(t=Afe(t,e.localeData()),M2[t]=M2[t]||a7e(t),M2[t](e)):e.localeData().invalidDate()}function Afe(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(Kx.lastIndex=0;r>=0&&Kx.test(e);)e=e.replace(Kx,n),Kx.lastIndex=0,r-=1;return e}var o7e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function s7e(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(lW).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var l7e="Invalid date";function u7e(){return this._invalidDate}var f7e="%d",c7e=/\d{1,2}/;function h7e(e){return this._ordinal.replace("%d",e)}var d7e={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function v7e(e,t,r,n){var i=this._relativeTime[r];return kl(i)?i(e,t,r,n):i.replace(/%d/i,e)}function p7e(e,t){var r=this._relativeTime[e>0?"future":"past"];return kl(r)?r(t):r.replace(/%s/i,t)}var Xb={};function zi(e,t){var r=e.toLowerCase();Xb[r]=Xb[r+"s"]=Xb[t]=e}function es(e){return typeof e=="string"?Xb[e]||Xb[e.toLowerCase()]:void 0}function uW(e){var t={},r,n;for(n in e)Pr(e,n)&&(r=es(n),r&&(t[r]=e[n]));return t}var Pfe={};function Gi(e,t){Pfe[e]=t}function g7e(e){var t=[],r;for(r in e)Pr(e,r)&&t.push({unit:r,priority:Pfe[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function fA(e){return e%4===0&&e%100!==0||e%400===0}function Bo(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function gr(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Bo(t)),r}function Vm(e,t){return function(r){return r!=null?(Ife(this,e,r),Ye.updateOffset(this,t),this):HE(this,e)}}function HE(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Ife(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&fA(e.year())&&e.month()===1&&e.date()===29?(r=gr(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),gA(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function y7e(e){return e=es(e),kl(this[e])?this[e]():this}function m7e(e,t){if(typeof e=="object"){e=uW(e);var r=g7e(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=es(e),kl(this[e]))return this[e](t);return this}var Mfe=/\d/,ho=/\d\d/,Dfe=/\d{3}/,fW=/\d{4}/,cA=/[+-]?\d{6}/,hn=/\d\d?/,$fe=/\d\d\d\d?/,Nfe=/\d\d\d\d\d\d?/,hA=/\d{1,3}/,cW=/\d{1,4}/,dA=/[+-]?\d{1,6}/,Um=/\d+/,vA=/[+-]?\d+/,b7e=/Z|[+-]\d\d:?\d\d/gi,pA=/Z|[+-]\d\d(?::?\d\d)?/gi,w7e=/[+-]?\d+(\.\d{1,3})?/,A1=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,BE;BE={};function bt(e,t,r){BE[e]=kl(t)?t:function(n,i){return n&&r?r:t}}function _7e(e,t){return Pr(BE,e)?BE[e](t._strict,t._locale):new RegExp(S7e(e))}function S7e(e){return Qa(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,a){return r||n||i||a}))}function Qa(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var vL={};function Zr(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),Gu(t)&&(n=function(a,o){o[t]=gr(a)}),i=e.length,r=0;r<i;r++)vL[e[r]]=n}function P1(e,t){Zr(e,function(r,n,i,a){i._w=i._w||{},t(r,i._w,i,a)})}function C7e(e,t,r){t!=null&&Pr(vL,e)&&vL[e](t,r._a,r,e)}var Hi=0,ou=1,cl=2,ui=3,Rs=4,su=5,Vh=6,x7e=7,T7e=8;function O7e(e,t){return(e%t+t)%t}var Wn;Array.prototype.indexOf?Wn=Array.prototype.indexOf:Wn=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function gA(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=O7e(t,12);return e+=(t-r)/12,r===1?fA(e)?29:28:31-r%7%2}kt("M",["MM",2],"Mo",function(){return this.month()+1});kt("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});kt("MMMM",0,0,function(e){return this.localeData().months(this,e)});zi("month","M");Gi("month",8);bt("M",hn);bt("MM",hn,ho);bt("MMM",function(e,t){return t.monthsShortRegex(e)});bt("MMMM",function(e,t){return t.monthsRegex(e)});Zr(["M","MM"],function(e,t){t[ou]=gr(e)-1});Zr(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[ou]=i:or(r).invalidMonth=e});var E7e="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Lfe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ffe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,R7e=A1,k7e=A1;function A7e(e,t){return e?Ms(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Ffe).test(t)?"format":"standalone"][e.month()]:Ms(this._months)?this._months:this._months.standalone}function P7e(e,t){return e?Ms(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Ffe.test(t)?"format":"standalone"][e.month()]:Ms(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function I7e(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=Rl([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return r?t==="MMM"?(i=Wn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=Wn.call(this._longMonthsParse,o),i!==-1?i:null):t==="MMM"?(i=Wn.call(this._shortMonthsParse,o),i!==-1?i:(i=Wn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=Wn.call(this._longMonthsParse,o),i!==-1?i:(i=Wn.call(this._shortMonthsParse,o),i!==-1?i:null))}function M7e(e,t,r){var n,i,a;if(this._monthsParseExact)return I7e.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Rl([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function Hfe(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=gr(t);else if(t=e.localeData().monthsParse(t),!Gu(t))return e}return r=Math.min(e.date(),gA(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function Bfe(e){return e!=null?(Hfe(this,e),Ye.updateOffset(this,!0),this):HE(this,"Month")}function D7e(){return gA(this.year(),this.month())}function $7e(e){return this._monthsParseExact?(Pr(this,"_monthsRegex")||Wfe.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Pr(this,"_monthsShortRegex")||(this._monthsShortRegex=R7e),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function N7e(e){return this._monthsParseExact?(Pr(this,"_monthsRegex")||Wfe.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Pr(this,"_monthsRegex")||(this._monthsRegex=k7e),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Wfe(){function e(o,s){return s.length-o.length}var t=[],r=[],n=[],i,a;for(i=0;i<12;i++)a=Rl([2e3,i]),t.push(this.monthsShort(a,"")),r.push(this.months(a,"")),n.push(this.months(a,"")),n.push(this.monthsShort(a,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=Qa(t[i]),r[i]=Qa(r[i]);for(i=0;i<24;i++)n[i]=Qa(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}kt("Y",0,0,function(){var e=this.year();return e<=9999?bl(e,4):"+"+e});kt(0,["YY",2],0,function(){return this.year()%100});kt(0,["YYYY",4],0,"year");kt(0,["YYYYY",5],0,"year");kt(0,["YYYYYY",6,!0],0,"year");zi("year","y");Gi("year",1);bt("Y",vA);bt("YY",hn,ho);bt("YYYY",cW,fW);bt("YYYYY",dA,cA);bt("YYYYYY",dA,cA);Zr(["YYYYY","YYYYYY"],Hi);Zr("YYYY",function(e,t){t[Hi]=e.length===2?Ye.parseTwoDigitYear(e):gr(e)});Zr("YY",function(e,t){t[Hi]=Ye.parseTwoDigitYear(e)});Zr("Y",function(e,t){t[Hi]=parseInt(e,10)});function qb(e){return fA(e)?366:365}Ye.parseTwoDigitYear=function(e){return gr(e)+(gr(e)>68?1900:2e3)};var Vfe=Vm("FullYear",!0);function L7e(){return fA(this.year())}function F7e(e,t,r,n,i,a,o){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,i,a,o),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,i,a,o),s}function Bw(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function WE(e,t,r){var n=7+t-r,i=(7+Bw(e,0,n).getUTCDay()-t)%7;return-i+n-1}function Ufe(e,t,r,n,i){var a=(7+r-n)%7,o=WE(e,n,i),s=1+7*(t-1)+a+o,l,u;return s<=0?(l=e-1,u=qb(l)+s):s>qb(e)?(l=e+1,u=s-qb(e)):(l=e,u=s),{year:l,dayOfYear:u}}function Ww(e,t,r){var n=WE(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;return i<1?(o=e.year()-1,a=i+Lu(o,t,r)):i>Lu(e.year(),t,r)?(a=i-Lu(e.year(),t,r),o=e.year()+1):(o=e.year(),a=i),{week:a,year:o}}function Lu(e,t,r){var n=WE(e,t,r),i=WE(e+1,t,r);return(qb(e)-n+i)/7}kt("w",["ww",2],"wo","week");kt("W",["WW",2],"Wo","isoWeek");zi("week","w");zi("isoWeek","W");Gi("week",5);Gi("isoWeek",5);bt("w",hn);bt("ww",hn,ho);bt("W",hn);bt("WW",hn,ho);P1(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=gr(e)});function H7e(e){return Ww(e,this._week.dow,this._week.doy).week}var B7e={dow:0,doy:6};function W7e(){return this._week.dow}function V7e(){return this._week.doy}function U7e(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function j7e(e){var t=Ww(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}kt("d",0,"do","day");kt("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});kt("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});kt("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});kt("e",0,0,"weekday");kt("E",0,0,"isoWeekday");zi("day","d");zi("weekday","e");zi("isoWeekday","E");Gi("day",11);Gi("weekday",11);Gi("isoWeekday",11);bt("d",hn);bt("e",hn);bt("E",hn);bt("dd",function(e,t){return t.weekdaysMinRegex(e)});bt("ddd",function(e,t){return t.weekdaysShortRegex(e)});bt("dddd",function(e,t){return t.weekdaysRegex(e)});P1(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:or(r).invalidWeekday=e});P1(["d","e","E"],function(e,t,r,n){t[n]=gr(e)});function z7e(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function G7e(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function hW(e,t){return e.slice(t,7).concat(e.slice(0,t))}var Y7e="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),jfe="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),K7e="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),X7e=A1,q7e=A1,Z7e=A1;function J7e(e,t){var r=Ms(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?hW(r,this._week.dow):e?r[e.day()]:r}function Q7e(e){return e===!0?hW(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function eYe(e){return e===!0?hW(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function tYe(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=Rl([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return r?t==="dddd"?(i=Wn.call(this._weekdaysParse,o),i!==-1?i:null):t==="ddd"?(i=Wn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=Wn.call(this._minWeekdaysParse,o),i!==-1?i:null):t==="dddd"?(i=Wn.call(this._weekdaysParse,o),i!==-1||(i=Wn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=Wn.call(this._minWeekdaysParse,o),i!==-1?i:null)):t==="ddd"?(i=Wn.call(this._shortWeekdaysParse,o),i!==-1||(i=Wn.call(this._weekdaysParse,o),i!==-1)?i:(i=Wn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=Wn.call(this._minWeekdaysParse,o),i!==-1||(i=Wn.call(this._weekdaysParse,o),i!==-1)?i:(i=Wn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function rYe(e,t,r){var n,i,a;if(this._weekdaysParseExact)return tYe.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Rl([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function nYe(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=z7e(e,this.localeData()),this.add(e-t,"d")):t}function iYe(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function aYe(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=G7e(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function oYe(e){return this._weekdaysParseExact?(Pr(this,"_weekdaysRegex")||dW.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Pr(this,"_weekdaysRegex")||(this._weekdaysRegex=X7e),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function sYe(e){return this._weekdaysParseExact?(Pr(this,"_weekdaysRegex")||dW.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Pr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=q7e),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function lYe(e){return this._weekdaysParseExact?(Pr(this,"_weekdaysRegex")||dW.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Pr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Z7e),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function dW(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],i=[],a,o,s,l,u;for(a=0;a<7;a++)o=Rl([2e3,1]).day(a),s=Qa(this.weekdaysMin(o,"")),l=Qa(this.weekdaysShort(o,"")),u=Qa(this.weekdays(o,"")),t.push(s),r.push(l),n.push(u),i.push(s),i.push(l),i.push(u);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function vW(){return this.hours()%12||12}function uYe(){return this.hours()||24}kt("H",["HH",2],0,"hour");kt("h",["hh",2],0,vW);kt("k",["kk",2],0,uYe);kt("hmm",0,0,function(){return""+vW.apply(this)+bl(this.minutes(),2)});kt("hmmss",0,0,function(){return""+vW.apply(this)+bl(this.minutes(),2)+bl(this.seconds(),2)});kt("Hmm",0,0,function(){return""+this.hours()+bl(this.minutes(),2)});kt("Hmmss",0,0,function(){return""+this.hours()+bl(this.minutes(),2)+bl(this.seconds(),2)});function zfe(e,t){kt(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}zfe("a",!0);zfe("A",!1);zi("hour","h");Gi("hour",13);function Gfe(e,t){return t._meridiemParse}bt("a",Gfe);bt("A",Gfe);bt("H",hn);bt("h",hn);bt("k",hn);bt("HH",hn,ho);bt("hh",hn,ho);bt("kk",hn,ho);bt("hmm",$fe);bt("hmmss",Nfe);bt("Hmm",$fe);bt("Hmmss",Nfe);Zr(["H","HH"],ui);Zr(["k","kk"],function(e,t,r){var n=gr(e);t[ui]=n===24?0:n});Zr(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});Zr(["h","hh"],function(e,t,r){t[ui]=gr(e),or(r).bigHour=!0});Zr("hmm",function(e,t,r){var n=e.length-2;t[ui]=gr(e.substr(0,n)),t[Rs]=gr(e.substr(n)),or(r).bigHour=!0});Zr("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[ui]=gr(e.substr(0,n)),t[Rs]=gr(e.substr(n,2)),t[su]=gr(e.substr(i)),or(r).bigHour=!0});Zr("Hmm",function(e,t,r){var n=e.length-2;t[ui]=gr(e.substr(0,n)),t[Rs]=gr(e.substr(n))});Zr("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[ui]=gr(e.substr(0,n)),t[Rs]=gr(e.substr(n,2)),t[su]=gr(e.substr(i))});function fYe(e){return(e+"").toLowerCase().charAt(0)==="p"}var cYe=/[ap]\.?m?\.?/i,hYe=Vm("Hours",!0);function dYe(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var Yfe={calendar:r7e,longDateFormat:o7e,invalidDate:l7e,ordinal:f7e,dayOfMonthOrdinalParse:c7e,relativeTime:d7e,months:E7e,monthsShort:Lfe,week:B7e,weekdays:Y7e,weekdaysMin:K7e,weekdaysShort:jfe,meridiemParse:cYe},dn={},z0={},Vw;function vYe(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function OK(e){return e&&e.toLowerCase().replace("_","-")}function pYe(e){for(var t=0,r,n,i,a;t<e.length;){for(a=OK(e[t]).split("-"),r=a.length,n=OK(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=yA(a.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&vYe(a,n)>=r-1)break;r--}t++}return Vw}function gYe(e){return e.match("^[^/\\\\]*$")!=null}function yA(e){var t=null,r;if(dn[e]===void 0&&typeof module<"u"&&module&&module.exports&&gYe(e))try{t=Vw._abbr,r=require,r("./locale/"+e),nc(t)}catch{dn[e]=null}return dn[e]}function nc(e,t){var r;return e&&(ka(t)?r=tf(e):r=pW(e,t),r?Vw=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Vw._abbr}function pW(e,t){if(t!==null){var r,n=Yfe;if(t.abbr=e,dn[e]!=null)kfe("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=dn[e]._config;else if(t.parentLocale!=null)if(dn[t.parentLocale]!=null)n=dn[t.parentLocale]._config;else if(r=yA(t.parentLocale),r!=null)n=r._config;else return z0[t.parentLocale]||(z0[t.parentLocale]=[]),z0[t.parentLocale].push({name:e,config:t}),null;return dn[e]=new sW(hL(n,t)),z0[e]&&z0[e].forEach(function(i){pW(i.name,i.config)}),nc(e),dn[e]}else return delete dn[e],null}function yYe(e,t){if(t!=null){var r,n,i=Yfe;dn[e]!=null&&dn[e].parentLocale!=null?dn[e].set(hL(dn[e]._config,t)):(n=yA(e),n!=null&&(i=n._config),t=hL(i,t),n==null&&(t.abbr=e),r=new sW(t),r.parentLocale=dn[e],dn[e]=r),nc(e)}else dn[e]!=null&&(dn[e].parentLocale!=null?(dn[e]=dn[e].parentLocale,e===nc()&&nc(e)):dn[e]!=null&&delete dn[e]);return dn[e]}function tf(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Vw;if(!Ms(e)){if(t=yA(e),t)return t;e=[e]}return pYe(e)}function mYe(){return dL(dn)}function gW(e){var t,r=e._a;return r&&or(e).overflow===-2&&(t=r[ou]<0||r[ou]>11?ou:r[cl]<1||r[cl]>gA(r[Hi],r[ou])?cl:r[ui]<0||r[ui]>24||r[ui]===24&&(r[Rs]!==0||r[su]!==0||r[Vh]!==0)?ui:r[Rs]<0||r[Rs]>59?Rs:r[su]<0||r[su]>59?su:r[Vh]<0||r[Vh]>999?Vh:-1,or(e)._overflowDayOfYear&&(t<Hi||t>cl)&&(t=cl),or(e)._overflowWeeks&&t===-1&&(t=x7e),or(e)._overflowWeekday&&t===-1&&(t=T7e),or(e).overflow=t),e}var bYe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wYe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_Ye=/Z|[+-]\d\d(?::?\d\d)?/,Xx=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],D2=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],SYe=/^\/?Date\((-?\d+)/i,CYe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,xYe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Kfe(e){var t,r,n=e._i,i=bYe.exec(n)||wYe.exec(n),a,o,s,l,u=Xx.length,f=D2.length;if(i){for(or(e).iso=!0,t=0,r=u;t<r;t++)if(Xx[t][1].exec(i[1])){o=Xx[t][0],a=Xx[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(i[3]){for(t=0,r=f;t<r;t++)if(D2[t][1].exec(i[3])){s=(i[2]||" ")+D2[t][0];break}if(s==null){e._isValid=!1;return}}if(!a&&s!=null){e._isValid=!1;return}if(i[4])if(_Ye.exec(i[4]))l="Z";else{e._isValid=!1;return}e._f=o+(s||"")+(l||""),mW(e)}else e._isValid=!1}function TYe(e,t,r,n,i,a){var o=[OYe(e),Lfe.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return a&&o.push(parseInt(a,10)),o}function OYe(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function EYe(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function RYe(e,t,r){if(e){var n=jfe.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return or(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function kYe(e,t,r){if(e)return xYe[e];if(t)return 0;var n=parseInt(r,10),i=n%100,a=(n-i)/100;return a*60+i}function Xfe(e){var t=CYe.exec(EYe(e._i)),r;if(t){if(r=TYe(t[4],t[3],t[2],t[5],t[6],t[7]),!RYe(t[1],r,e))return;e._a=r,e._tzm=kYe(t[8],t[9],t[10]),e._d=Bw.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),or(e).rfc2822=!0}else e._isValid=!1}function AYe(e){var t=SYe.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(Kfe(e),e._isValid===!1)delete e._isValid;else return;if(Xfe(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Ye.createFromInputFallback(e)}Ye.createFromInputFallback=Qo("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Tp(e,t,r){return e??t??r}function PYe(e){var t=new Date(Ye.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function yW(e){var t,r,n=[],i,a,o;if(!e._d){for(i=PYe(e),e._w&&e._a[cl]==null&&e._a[ou]==null&&IYe(e),e._dayOfYear!=null&&(o=Tp(e._a[Hi],i[Hi]),(e._dayOfYear>qb(o)||e._dayOfYear===0)&&(or(e)._overflowDayOfYear=!0),r=Bw(o,0,e._dayOfYear),e._a[ou]=r.getUTCMonth(),e._a[cl]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[ui]===24&&e._a[Rs]===0&&e._a[su]===0&&e._a[Vh]===0&&(e._nextDay=!0,e._a[ui]=0),e._d=(e._useUTC?Bw:F7e).apply(null,n),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ui]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==a&&(or(e).weekdayMismatch=!0)}}function IYe(e){var t,r,n,i,a,o,s,l,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(a=1,o=4,r=Tp(t.GG,e._a[Hi],Ww(fn(),1,4).year),n=Tp(t.W,1),i=Tp(t.E,1),(i<1||i>7)&&(l=!0)):(a=e._locale._week.dow,o=e._locale._week.doy,u=Ww(fn(),a,o),r=Tp(t.gg,e._a[Hi],u.year),n=Tp(t.w,u.week),t.d!=null?(i=t.d,(i<0||i>6)&&(l=!0)):t.e!=null?(i=t.e+a,(t.e<0||t.e>6)&&(l=!0)):i=a),n<1||n>Lu(r,a,o)?or(e)._overflowWeeks=!0:l!=null?or(e)._overflowWeekday=!0:(s=Ufe(r,n,i,a,o),e._a[Hi]=s.year,e._dayOfYear=s.dayOfYear)}Ye.ISO_8601=function(){};Ye.RFC_2822=function(){};function mW(e){if(e._f===Ye.ISO_8601){Kfe(e);return}if(e._f===Ye.RFC_2822){Xfe(e);return}e._a=[],or(e).empty=!0;var t=""+e._i,r,n,i,a,o,s=t.length,l=0,u,f;for(i=Afe(e._f,e._locale).match(lW)||[],f=i.length,r=0;r<f;r++)a=i[r],n=(t.match(_7e(a,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&or(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),l+=n.length),Xp[a]?(n?or(e).empty=!1:or(e).unusedTokens.push(a),C7e(a,n,e)):e._strict&&!n&&or(e).unusedTokens.push(a);or(e).charsLeftOver=s-l,t.length>0&&or(e).unusedInput.push(t),e._a[ui]<=12&&or(e).bigHour===!0&&e._a[ui]>0&&(or(e).bigHour=void 0),or(e).parsedDateParts=e._a.slice(0),or(e).meridiem=e._meridiem,e._a[ui]=MYe(e._locale,e._a[ui],e._meridiem),u=or(e).era,u!==null&&(e._a[Hi]=e._locale.erasConvertYear(u,e._a[Hi])),yW(e),gW(e)}function MYe(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function DYe(e){var t,r,n,i,a,o,s=!1,l=e._f.length;if(l===0){or(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<l;i++)a=0,o=!1,t=oW({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],mW(t),aW(t)&&(o=!0),a+=or(t).charsLeftOver,a+=or(t).unusedTokens.length*10,or(t).score=a,s?a<n&&(n=a,r=t):(n==null||a<n||o)&&(n=a,r=t,o&&(s=!0));Kf(e,r||t)}function $Ye(e){if(!e._d){var t=uW(e._i),r=t.day===void 0?t.date:t.day;e._a=Efe([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),yW(e)}}function NYe(e){var t=new k1(gW(qfe(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function qfe(e){var t=e._i,r=e._f;return e._locale=e._locale||tf(e._l),t===null||r===void 0&&t===""?uA({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),Ds(t)?new k1(gW(t)):(R1(t)?e._d=t:Ms(r)?DYe(e):r?mW(e):LYe(e),aW(e)||(e._d=null),e))}function LYe(e){var t=e._i;ka(t)?e._d=new Date(Ye.now()):R1(t)?e._d=new Date(t.valueOf()):typeof t=="string"?AYe(e):Ms(t)?(e._a=Efe(t.slice(0),function(r){return parseInt(r,10)}),yW(e)):Sd(t)?$Ye(e):Gu(t)?e._d=new Date(t):Ye.createFromInputFallback(e)}function Zfe(e,t,r,n,i){var a={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Sd(e)&&iW(e)||Ms(e)&&e.length===0)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=r,a._i=e,a._f=t,a._strict=n,NYe(a)}function fn(e,t,r,n){return Zfe(e,t,r,n,!1)}var FYe=Qo("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=fn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:uA()}),HYe=Qo("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=fn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:uA()});function Jfe(e,t){var r,n;if(t.length===1&&Ms(t[0])&&(t=t[0]),!t.length)return fn();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function BYe(){var e=[].slice.call(arguments,0);return Jfe("isBefore",e)}function WYe(){var e=[].slice.call(arguments,0);return Jfe("isAfter",e)}var VYe=function(){return Date.now?Date.now():+new Date},G0=["year","quarter","month","week","day","hour","minute","second","millisecond"];function UYe(e){var t,r=!1,n,i=G0.length;for(t in e)if(Pr(e,t)&&!(Wn.call(G0,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[G0[n]]){if(r)return!1;parseFloat(e[G0[n]])!==gr(e[G0[n]])&&(r=!0)}return!0}function jYe(){return this._isValid}function zYe(){return Bs(NaN)}function mA(e){var t=uW(e),r=t.year||0,n=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=UYe(t),this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60,this._days=+o+a*7,this._months=+i+n*3+r*12,this._data={},this._locale=tf(),this._bubble()}function bO(e){return e instanceof mA}function pL(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function GYe(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0,o;for(o=0;o<n;o++)(r&&e[o]!==t[o]||!r&&gr(e[o])!==gr(t[o]))&&a++;return a+i}function Qfe(e,t){kt(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+bl(~~(r/60),2)+t+bl(~~r%60,2)})}Qfe("Z",":");Qfe("ZZ","");bt("Z",pA);bt("ZZ",pA);Zr(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=bW(pA,e)});var YYe=/([\+\-]|\d\d)/gi;function bW(e,t){var r=(t||"").match(e),n,i,a;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(YYe)||["-",0,0],a=+(i[1]*60)+gr(i[2]),a===0?0:i[0]==="+"?a:-a)}function wW(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(Ds(e)||R1(e)?e.valueOf():fn(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ye.updateOffset(r,!1),r):fn(e).local()}function gL(e){return-Math.round(e._d.getTimezoneOffset())}Ye.updateOffset=function(){};function KYe(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=bW(pA,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=gL(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?rce(this,Bs(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ye.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:gL(this)}function XYe(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function qYe(e){return this.utcOffset(0,e)}function ZYe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(gL(this),"m")),this}function JYe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=bW(b7e,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function QYe(e){return this.isValid()?(e=e?fn(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function eKe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function tKe(){if(!ka(this._isDSTShifted))return this._isDSTShifted;var e={},t;return oW(e,this),e=qfe(e),e._a?(t=e._isUTC?Rl(e._a):fn(e._a),this._isDSTShifted=this.isValid()&&GYe(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function rKe(){return this.isValid()?!this._isUTC:!1}function nKe(){return this.isValid()?this._isUTC:!1}function ece(){return this.isValid()?this._isUTC&&this._offset===0:!1}var iKe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,aKe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Bs(e,t){var r=e,n=null,i,a,o;return bO(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Gu(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=iKe.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:gr(n[cl])*i,h:gr(n[ui])*i,m:gr(n[Rs])*i,s:gr(n[su])*i,ms:gr(pL(n[Vh]*1e3))*i}):(n=aKe.exec(e))?(i=n[1]==="-"?-1:1,r={y:wh(n[2],i),M:wh(n[3],i),w:wh(n[4],i),d:wh(n[5],i),h:wh(n[6],i),m:wh(n[7],i),s:wh(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=oKe(fn(r.from),fn(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),a=new mA(r),bO(e)&&Pr(e,"_locale")&&(a._locale=e._locale),bO(e)&&Pr(e,"_isValid")&&(a._isValid=e._isValid),a}Bs.fn=mA.prototype;Bs.invalid=zYe;function wh(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function EK(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function oKe(e,t){var r;return e.isValid()&&t.isValid()?(t=wW(t,e),e.isBefore(t)?r=EK(e,t):(r=EK(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function tce(e,t){return function(r,n){var i,a;return n!==null&&!isNaN(+n)&&(kfe(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=r,r=n,n=a),i=Bs(r,n),rce(this,i,e),this}}function rce(e,t,r,n){var i=t._milliseconds,a=pL(t._days),o=pL(t._months);e.isValid()&&(n=n??!0,o&&Hfe(e,HE(e,"Month")+o*r),a&&Ife(e,"Date",HE(e,"Date")+a*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&Ye.updateOffset(e,a||o))}var sKe=tce(1,"add"),lKe=tce(-1,"subtract");function nce(e){return typeof e=="string"||e instanceof String}function uKe(e){return Ds(e)||R1(e)||nce(e)||Gu(e)||cKe(e)||fKe(e)||e===null||e===void 0}function fKe(e){var t=Sd(e)&&!iW(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,a,o=n.length;for(i=0;i<o;i+=1)a=n[i],r=r||Pr(e,a);return t&&r}function cKe(e){var t=Ms(e),r=!1;return t&&(r=e.filter(function(n){return!Gu(n)&&nce(e)}).length===0),t&&r}function hKe(e){var t=Sd(e)&&!iW(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,a;for(i=0;i<n.length;i+=1)a=n[i],r=r||Pr(e,a);return t&&r}function dKe(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function vKe(e,t){arguments.length===1&&(arguments[0]?uKe(arguments[0])?(e=arguments[0],t=void 0):hKe(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||fn(),n=wW(r,this).startOf("day"),i=Ye.calendarFormat(this,n)||"sameElse",a=t&&(kl(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,fn(r)))}function pKe(){return new k1(this)}function gKe(e,t){var r=Ds(e)?e:fn(e);return this.isValid()&&r.isValid()?(t=es(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function yKe(e,t){var r=Ds(e)?e:fn(e);return this.isValid()&&r.isValid()?(t=es(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function mKe(e,t,r,n){var i=Ds(e)?e:fn(e),a=Ds(t)?t:fn(t);return this.isValid()&&i.isValid()&&a.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(a,r):!this.isAfter(a,r))):!1}function bKe(e,t){var r=Ds(e)?e:fn(e),n;return this.isValid()&&r.isValid()?(t=es(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function wKe(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function _Ke(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function SKe(e,t,r){var n,i,a;if(!this.isValid())return NaN;if(n=wW(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=es(t),t){case"year":a=wO(this,n)/12;break;case"month":a=wO(this,n);break;case"quarter":a=wO(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return r?a:Bo(a)}function wO(e,t){if(e.date()<t.date())return-wO(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,a;return t-n<0?(i=e.clone().add(r-1,"months"),a=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),a=(t-n)/(i-n)),-(r+a)||0}Ye.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ye.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function CKe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function xKe(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?mO(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):kl(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",mO(r,"Z")):mO(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function TKe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,a;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",a=t+'[")]',this.format(r+n+i+a)}function OKe(e){e||(e=this.isUtc()?Ye.defaultFormatUtc:Ye.defaultFormat);var t=mO(this,e);return this.localeData().postformat(t)}function EKe(e,t){return this.isValid()&&(Ds(e)&&e.isValid()||fn(e).isValid())?Bs({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function RKe(e){return this.from(fn(),e)}function kKe(e,t){return this.isValid()&&(Ds(e)&&e.isValid()||fn(e).isValid())?Bs({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function AKe(e){return this.to(fn(),e)}function ice(e){var t;return e===void 0?this._locale._abbr:(t=tf(e),t!=null&&(this._locale=t),this)}var ace=Qo("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function oce(){return this._locale}var VE=1e3,qp=60*VE,UE=60*qp,sce=(365*400+97)*24*UE;function Zp(e,t){return(e%t+t)%t}function lce(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-sce:new Date(e,t,r).valueOf()}function uce(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-sce:Date.UTC(e,t,r)}function PKe(e){var t,r;if(e=es(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?uce:lce,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Zp(t+(this._isUTC?0:this.utcOffset()*qp),UE);break;case"minute":t=this._d.valueOf(),t-=Zp(t,qp);break;case"second":t=this._d.valueOf(),t-=Zp(t,VE);break}return this._d.setTime(t),Ye.updateOffset(this,!0),this}function IKe(e){var t,r;if(e=es(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?uce:lce,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=UE-Zp(t+(this._isUTC?0:this.utcOffset()*qp),UE)-1;break;case"minute":t=this._d.valueOf(),t+=qp-Zp(t,qp)-1;break;case"second":t=this._d.valueOf(),t+=VE-Zp(t,VE)-1;break}return this._d.setTime(t),Ye.updateOffset(this,!0),this}function MKe(){return this._d.valueOf()-(this._offset||0)*6e4}function DKe(){return Math.floor(this.valueOf()/1e3)}function $Ke(){return new Date(this.valueOf())}function NKe(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function LKe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function FKe(){return this.isValid()?this.toISOString():null}function HKe(){return aW(this)}function BKe(){return Kf({},or(this))}function WKe(){return or(this).overflow}function VKe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}kt("N",0,0,"eraAbbr");kt("NN",0,0,"eraAbbr");kt("NNN",0,0,"eraAbbr");kt("NNNN",0,0,"eraName");kt("NNNNN",0,0,"eraNarrow");kt("y",["y",1],"yo","eraYear");kt("y",["yy",2],0,"eraYear");kt("y",["yyy",3],0,"eraYear");kt("y",["yyyy",4],0,"eraYear");bt("N",_W);bt("NN",_W);bt("NNN",_W);bt("NNNN",QKe);bt("NNNNN",eXe);Zr(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?or(r).era=i:or(r).invalidEra=e});bt("y",Um);bt("yy",Um);bt("yyy",Um);bt("yyyy",Um);bt("yo",tXe);Zr(["y","yy","yyy","yyyy"],Hi);Zr(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Hi]=r._locale.eraYearOrdinalParse(e,i):t[Hi]=parseInt(e,10)});function UKe(e,t){var r,n,i,a=this._eras||tf("en")._eras;for(r=0,n=a.length;r<n;++r){switch(typeof a[r].since){case"string":i=Ye(a[r].since).startOf("day"),a[r].since=i.valueOf();break}switch(typeof a[r].until){case"undefined":a[r].until=1/0;break;case"string":i=Ye(a[r].until).startOf("day").valueOf(),a[r].until=i.valueOf();break}}return a}function jKe(e,t,r){var n,i,a=this.eras(),o,s,l;for(e=e.toUpperCase(),n=0,i=a.length;n<i;++n)if(o=a[n].name.toUpperCase(),s=a[n].abbr.toUpperCase(),l=a[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return a[n];break;case"NNNN":if(o===e)return a[n];break;case"NNNNN":if(l===e)return a[n];break}else if([o,s,l].indexOf(e)>=0)return a[n]}function zKe(e,t){var r=e.since<=e.until?1:-1;return t===void 0?Ye(e.since).year():Ye(e.since).year()+(t-e.offset)*r}function GKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function YKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function KKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function XKe(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-Ye(i[e].since).year())*r+i[e].offset;return this.year()}function qKe(e){return Pr(this,"_erasNameRegex")||SW.call(this),e?this._erasNameRegex:this._erasRegex}function ZKe(e){return Pr(this,"_erasAbbrRegex")||SW.call(this),e?this._erasAbbrRegex:this._erasRegex}function JKe(e){return Pr(this,"_erasNarrowRegex")||SW.call(this),e?this._erasNarrowRegex:this._erasRegex}function _W(e,t){return t.erasAbbrRegex(e)}function QKe(e,t){return t.erasNameRegex(e)}function eXe(e,t){return t.erasNarrowRegex(e)}function tXe(e,t){return t._eraYearOrdinalRegex||Um}function SW(){var e=[],t=[],r=[],n=[],i,a,o=this.eras();for(i=0,a=o.length;i<a;++i)t.push(Qa(o[i].name)),e.push(Qa(o[i].abbr)),r.push(Qa(o[i].narrow)),n.push(Qa(o[i].name)),n.push(Qa(o[i].abbr)),n.push(Qa(o[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}kt(0,["gg",2],0,function(){return this.weekYear()%100});kt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function bA(e,t){kt(0,[e,e.length],0,t)}bA("gggg","weekYear");bA("ggggg","weekYear");bA("GGGG","isoWeekYear");bA("GGGGG","isoWeekYear");zi("weekYear","gg");zi("isoWeekYear","GG");Gi("weekYear",1);Gi("isoWeekYear",1);bt("G",vA);bt("g",vA);bt("GG",hn,ho);bt("gg",hn,ho);bt("GGGG",cW,fW);bt("gggg",cW,fW);bt("GGGGG",dA,cA);bt("ggggg",dA,cA);P1(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=gr(e)});P1(["gg","GG"],function(e,t,r,n){t[n]=Ye.parseTwoDigitYear(e)});function rXe(e){return fce.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function nXe(e){return fce.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function iXe(){return Lu(this.year(),1,4)}function aXe(){return Lu(this.isoWeekYear(),1,4)}function oXe(){var e=this.localeData()._week;return Lu(this.year(),e.dow,e.doy)}function sXe(){var e=this.localeData()._week;return Lu(this.weekYear(),e.dow,e.doy)}function fce(e,t,r,n,i){var a;return e==null?Ww(this,n,i).year:(a=Lu(e,n,i),t>a&&(t=a),lXe.call(this,e,t,r,n,i))}function lXe(e,t,r,n,i){var a=Ufe(e,t,r,n,i),o=Bw(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}kt("Q",0,"Qo","quarter");zi("quarter","Q");Gi("quarter",7);bt("Q",Mfe);Zr("Q",function(e,t){t[ou]=(gr(e)-1)*3});function uXe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}kt("D",["DD",2],"Do","date");zi("date","D");Gi("date",9);bt("D",hn);bt("DD",hn,ho);bt("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});Zr(["D","DD"],cl);Zr("Do",function(e,t){t[cl]=gr(e.match(hn)[0])});var cce=Vm("Date",!0);kt("DDD",["DDDD",3],"DDDo","dayOfYear");zi("dayOfYear","DDD");Gi("dayOfYear",4);bt("DDD",hA);bt("DDDD",Dfe);Zr(["DDD","DDDD"],function(e,t,r){r._dayOfYear=gr(e)});function fXe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}kt("m",["mm",2],0,"minute");zi("minute","m");Gi("minute",14);bt("m",hn);bt("mm",hn,ho);Zr(["m","mm"],Rs);var cXe=Vm("Minutes",!1);kt("s",["ss",2],0,"second");zi("second","s");Gi("second",15);bt("s",hn);bt("ss",hn,ho);Zr(["s","ss"],su);var hXe=Vm("Seconds",!1);kt("S",0,0,function(){return~~(this.millisecond()/100)});kt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});kt(0,["SSS",3],0,"millisecond");kt(0,["SSSS",4],0,function(){return this.millisecond()*10});kt(0,["SSSSS",5],0,function(){return this.millisecond()*100});kt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});kt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});kt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});kt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});zi("millisecond","ms");Gi("millisecond",16);bt("S",hA,Mfe);bt("SS",hA,ho);bt("SSS",hA,Dfe);var Xf,hce;for(Xf="SSSS";Xf.length<=9;Xf+="S")bt(Xf,Um);function dXe(e,t){t[Vh]=gr(("0."+e)*1e3)}for(Xf="S";Xf.length<=9;Xf+="S")Zr(Xf,dXe);hce=Vm("Milliseconds",!1);kt("z",0,0,"zoneAbbr");kt("zz",0,0,"zoneName");function vXe(){return this._isUTC?"UTC":""}function pXe(){return this._isUTC?"Coordinated Universal Time":""}var Ze=k1.prototype;Ze.add=sKe;Ze.calendar=vKe;Ze.clone=pKe;Ze.diff=SKe;Ze.endOf=IKe;Ze.format=OKe;Ze.from=EKe;Ze.fromNow=RKe;Ze.to=kKe;Ze.toNow=AKe;Ze.get=y7e;Ze.invalidAt=WKe;Ze.isAfter=gKe;Ze.isBefore=yKe;Ze.isBetween=mKe;Ze.isSame=bKe;Ze.isSameOrAfter=wKe;Ze.isSameOrBefore=_Ke;Ze.isValid=HKe;Ze.lang=ace;Ze.locale=ice;Ze.localeData=oce;Ze.max=HYe;Ze.min=FYe;Ze.parsingFlags=BKe;Ze.set=m7e;Ze.startOf=PKe;Ze.subtract=lKe;Ze.toArray=NKe;Ze.toObject=LKe;Ze.toDate=$Ke;Ze.toISOString=xKe;Ze.inspect=TKe;typeof Symbol<"u"&&Symbol.for!=null&&(Ze[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Ze.toJSON=FKe;Ze.toString=CKe;Ze.unix=DKe;Ze.valueOf=MKe;Ze.creationData=VKe;Ze.eraName=GKe;Ze.eraNarrow=YKe;Ze.eraAbbr=KKe;Ze.eraYear=XKe;Ze.year=Vfe;Ze.isLeapYear=L7e;Ze.weekYear=rXe;Ze.isoWeekYear=nXe;Ze.quarter=Ze.quarters=uXe;Ze.month=Bfe;Ze.daysInMonth=D7e;Ze.week=Ze.weeks=U7e;Ze.isoWeek=Ze.isoWeeks=j7e;Ze.weeksInYear=oXe;Ze.weeksInWeekYear=sXe;Ze.isoWeeksInYear=iXe;Ze.isoWeeksInISOWeekYear=aXe;Ze.date=cce;Ze.day=Ze.days=nYe;Ze.weekday=iYe;Ze.isoWeekday=aYe;Ze.dayOfYear=fXe;Ze.hour=Ze.hours=hYe;Ze.minute=Ze.minutes=cXe;Ze.second=Ze.seconds=hXe;Ze.millisecond=Ze.milliseconds=hce;Ze.utcOffset=KYe;Ze.utc=qYe;Ze.local=ZYe;Ze.parseZone=JYe;Ze.hasAlignedHourOffset=QYe;Ze.isDST=eKe;Ze.isLocal=rKe;Ze.isUtcOffset=nKe;Ze.isUtc=ece;Ze.isUTC=ece;Ze.zoneAbbr=vXe;Ze.zoneName=pXe;Ze.dates=Qo("dates accessor is deprecated. Use date instead.",cce);Ze.months=Qo("months accessor is deprecated. Use month instead",Bfe);Ze.years=Qo("years accessor is deprecated. Use year instead",Vfe);Ze.zone=Qo("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",XYe);Ze.isDSTShifted=Qo("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",tKe);function gXe(e){return fn(e*1e3)}function yXe(){return fn.apply(null,arguments).parseZone()}function dce(e){return e}var Ir=sW.prototype;Ir.calendar=n7e;Ir.longDateFormat=s7e;Ir.invalidDate=u7e;Ir.ordinal=h7e;Ir.preparse=dce;Ir.postformat=dce;Ir.relativeTime=v7e;Ir.pastFuture=p7e;Ir.set=t7e;Ir.eras=UKe;Ir.erasParse=jKe;Ir.erasConvertYear=zKe;Ir.erasAbbrRegex=ZKe;Ir.erasNameRegex=qKe;Ir.erasNarrowRegex=JKe;Ir.months=A7e;Ir.monthsShort=P7e;Ir.monthsParse=M7e;Ir.monthsRegex=N7e;Ir.monthsShortRegex=$7e;Ir.week=H7e;Ir.firstDayOfYear=V7e;Ir.firstDayOfWeek=W7e;Ir.weekdays=J7e;Ir.weekdaysMin=eYe;Ir.weekdaysShort=Q7e;Ir.weekdaysParse=rYe;Ir.weekdaysRegex=oYe;Ir.weekdaysShortRegex=sYe;Ir.weekdaysMinRegex=lYe;Ir.isPM=fYe;Ir.meridiem=dYe;function jE(e,t,r,n){var i=tf(),a=Rl().set(n,t);return i[r](a,e)}function vce(e,t,r){if(Gu(e)&&(t=e,e=void 0),e=e||"",t!=null)return jE(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=jE(e,n,r,"month");return i}function CW(e,t,r,n){typeof e=="boolean"?(Gu(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Gu(t)&&(r=t,t=void 0),t=t||"");var i=tf(),a=e?i._week.dow:0,o,s=[];if(r!=null)return jE(t,(r+a)%7,n,"day");for(o=0;o<7;o++)s[o]=jE(t,(o+a)%7,n,"day");return s}function mXe(e,t){return vce(e,t,"months")}function bXe(e,t){return vce(e,t,"monthsShort")}function wXe(e,t,r){return CW(e,t,r,"weekdays")}function _Xe(e,t,r){return CW(e,t,r,"weekdaysShort")}function SXe(e,t,r){return CW(e,t,r,"weekdaysMin")}nc("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=gr(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});Ye.lang=Qo("moment.lang is deprecated. Use moment.locale instead.",nc);Ye.langData=Qo("moment.langData is deprecated. Use moment.localeData instead.",tf);var jl=Math.abs;function CXe(){var e=this._data;return this._milliseconds=jl(this._milliseconds),this._days=jl(this._days),this._months=jl(this._months),e.milliseconds=jl(e.milliseconds),e.seconds=jl(e.seconds),e.minutes=jl(e.minutes),e.hours=jl(e.hours),e.months=jl(e.months),e.years=jl(e.years),this}function pce(e,t,r,n){var i=Bs(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function xXe(e,t){return pce(this,e,t,1)}function TXe(e,t){return pce(this,e,t,-1)}function RK(e){return e<0?Math.floor(e):Math.ceil(e)}function OXe(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,a,o,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=RK(yL(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=Bo(e/1e3),n.seconds=i%60,a=Bo(i/60),n.minutes=a%60,o=Bo(a/60),n.hours=o%24,t+=Bo(o/24),l=Bo(gce(t)),r+=l,t-=RK(yL(l)),s=Bo(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function gce(e){return e*4800/146097}function yL(e){return e*146097/4800}function EXe(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=es(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+gce(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(yL(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function RXe(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+gr(this._months/12)*31536e6:NaN}function rf(e){return function(){return this.as(e)}}var kXe=rf("ms"),AXe=rf("s"),PXe=rf("m"),IXe=rf("h"),MXe=rf("d"),DXe=rf("w"),$Xe=rf("M"),NXe=rf("Q"),LXe=rf("y");function FXe(){return Bs(this)}function HXe(e){return e=es(e),this.isValid()?this[e+"s"]():NaN}function ov(e){return function(){return this.isValid()?this._data[e]:NaN}}var BXe=ov("milliseconds"),WXe=ov("seconds"),VXe=ov("minutes"),UXe=ov("hours"),jXe=ov("days"),zXe=ov("months"),GXe=ov("years");function YXe(){return Bo(this.days()/7)}var Ql=Math.round,Lp={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function KXe(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function XXe(e,t,r,n){var i=Bs(e).abs(),a=Ql(i.as("s")),o=Ql(i.as("m")),s=Ql(i.as("h")),l=Ql(i.as("d")),u=Ql(i.as("M")),f=Ql(i.as("w")),c=Ql(i.as("y")),h=a<=r.ss&&["s",a]||a<r.s&&["ss",a]||o<=1&&["m"]||o<r.m&&["mm",o]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,KXe.apply(null,h)}function qXe(e){return e===void 0?Ql:typeof e=="function"?(Ql=e,!0):!1}function ZXe(e,t){return Lp[e]===void 0?!1:t===void 0?Lp[e]:(Lp[e]=t,e==="s"&&(Lp.ss=t-1),!0)}function JXe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Lp,i,a;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Lp,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),a=XXe(this,!r,n,i),r&&(a=i.pastFuture(+this,a)),i.postformat(a)}var $2=Math.abs;function qv(e){return(e>0)-(e<0)||+e}function wA(){if(!this.isValid())return this.localeData().invalidDate();var e=$2(this._milliseconds)/1e3,t=$2(this._days),r=$2(this._months),n,i,a,o,s=this.asSeconds(),l,u,f,c;return s?(n=Bo(e/60),i=Bo(n/60),e%=60,n%=60,a=Bo(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=qv(this._months)!==qv(s)?"-":"",f=qv(this._days)!==qv(s)?"-":"",c=qv(this._milliseconds)!==qv(s)?"-":"",l+"P"+(a?u+a+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(i||n||e?"T":"")+(i?c+i+"H":"")+(n?c+n+"M":"")+(e?c+o+"S":"")):"P0D"}var Er=mA.prototype;Er.isValid=jYe;Er.abs=CXe;Er.add=xXe;Er.subtract=TXe;Er.as=EXe;Er.asMilliseconds=kXe;Er.asSeconds=AXe;Er.asMinutes=PXe;Er.asHours=IXe;Er.asDays=MXe;Er.asWeeks=DXe;Er.asMonths=$Xe;Er.asQuarters=NXe;Er.asYears=LXe;Er.valueOf=RXe;Er._bubble=OXe;Er.clone=FXe;Er.get=HXe;Er.milliseconds=BXe;Er.seconds=WXe;Er.minutes=VXe;Er.hours=UXe;Er.days=jXe;Er.weeks=YXe;Er.months=zXe;Er.years=GXe;Er.humanize=JXe;Er.toISOString=wA;Er.toString=wA;Er.toJSON=wA;Er.locale=ice;Er.localeData=oce;Er.toIsoString=Qo("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",wA);Er.lang=ace;kt("X",0,0,"unix");kt("x",0,0,"valueOf");bt("x",vA);bt("X",w7e);Zr("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});Zr("x",function(e,t,r){r._d=new Date(gr(e))});//! moment.js
Ye.version="2.29.4";Q9e(fn);Ye.fn=Ze;Ye.min=BYe;Ye.max=WYe;Ye.now=VYe;Ye.utc=Rl;Ye.unix=gXe;Ye.months=mXe;Ye.isDate=R1;Ye.locale=nc;Ye.invalid=uA;Ye.duration=Bs;Ye.isMoment=Ds;Ye.weekdays=wXe;Ye.parseZone=yXe;Ye.localeData=tf;Ye.isDuration=bO;Ye.monthsShort=bXe;Ye.weekdaysMin=SXe;Ye.defineLocale=pW;Ye.updateLocale=yYe;Ye.locales=mYe;Ye.weekdaysShort=_Xe;Ye.normalizeUnits=es;Ye.relativeTimeRounding=qXe;Ye.relativeTimeThreshold=ZXe;Ye.calendarFormat=dKe;Ye.prototype=Ze;Ye.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const QXe=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));function Wr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=Nn(e,function(a,o,s){var l=o.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return a+l+u},"");return i.trim()}var kK,AK,PK,IK,MK,DK;function Jp(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function mL(e){return mL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mL(e)}function En(e){var t;switch(mL(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function dt(e){return typeof e<"u"}function Yr(e){return typeof e>"u"}function ei(e){return e===null||e===""||Yr(e)}function yce(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var xb="length",Zb=function(t){return parseInt(t,16)},$K=function(t){return parseInt(t,10)},zE=function(t,r,n){return t.substr(r,n)},Jb=function(t){return t.codePointAt(0)-65},bL=function(t){return"".concat(t).replace(/\-/g,"")},eqe=function(t){return Zb(zE(bL(t),Zb("12"),Jb("F")))/(Zb(zE(bL(t),Jb("B"),~~![][xb]))||9)},tqe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},NK=!1,LK={invalid:function(){return Wr(kK||(kK=Jp([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Wr(AK||(AK=Jp([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Wr(PK||(PK=Jp([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},FK={invalid:function(){return Wr(IK||(IK=Jp([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return Wr(MK||(MK=Jp([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Wr(DK||(DK=Jp([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function mce(e,t){var r=!ei(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",a,o="invalid",s="invalid";e=bL(e||"");var l=rqe(e);if(r||n||l)if(l){var u=Ye("28/03/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=eqe(e);a=Ye((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(o="expired",s="expired"):(o="valid",s="valid")}else n?(o="non_commercial",s="valid"):(o="invalid",s="invalid");else o="missing",s="missing";if(tqe()&&(o="valid",s="valid"),!NK&&o!=="valid"){var h=LK[o]({keyValidityDate:a,hotVersion:i});h&&console[o==="non_commercial"?"info":"warn"](LK[o]({keyValidityDate:a,hotVersion:i})),NK=!0}if(s!=="valid"&&t.parentNode){var d=FK[s]({keyValidityDate:a,hotVersion:i});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=FK[s]({keyValidityDate:a,hotVersion:i}),t.parentNode.insertBefore(v,t.nextSibling)}}}function rqe(e){var t=[][xb],r=t;if(e[xb]!==Jb("Z"))return!1;for(var n="",i="B<H4P+".split(""),a=Jb(i.shift());a;a=Jb(i.shift()||"A"))--a<""[xb]?r=r|($K("".concat($K(Zb(n)+(Zb(zE(e,Math.abs(a),2))+[]).padStart(2,"0"))))%97||2)>>1:n=zE(e,a,a?i[xb]===1?9:8:6);return r===t}const nqe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:mce,isDefined:dt,isEmpty:ei,isRegExp:yce,isUndefined:Yr,stringify:En},Symbol.toStringTag,{value:"Module"}));function La(e){return e[0].toUpperCase()+e.substr(1)}function iqe(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=r.length;i;){i-=1;var a=En(r[i]).toLowerCase();e.indexOf(a)===-1&&e.push(a)}return e.length===1}function xW(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function TW(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function OW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function wL(e){return _A("".concat(e),{ALLOWED_TAGS:[]})}function _A(e,t){return D9e.sanitize(e,t)}const aqe=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:iqe,isPercentValue:TW,randomString:xW,sanitize:_A,stripTags:wL,substitute:OW,toUpperCaseFirst:La},Symbol.toStringTag,{value:"Module"}));function HK(e){return uqe(e)||lqe(e)||sqe(e)||oqe()}function oqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sqe(e,t){if(e){if(typeof e=="string")return _L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _L(e,t)}}function lqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uqe(e){if(Array.isArray(e))return _L(e)}function _L(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bce(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function wce(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Uw(e){return wce(e)&&e.parent}function fqe(e){return!!Object.getPrototypeOf(e.parent)}function ic(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,a=n.DOCUMENT_FRAGMENT_NODE,o=e;o!=null&&o!==r;){var s=o,l=s.nodeType,u=s.nodeName;if(l===i&&(t.includes(u)||t.includes(o)))return o;var f=o,c=f.host;c&&l===a?o=c:o=o.parentNode}return null}function Tb(e,t,r){for(var n=[],i=e;i&&(i=ic(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var a=n.length;return a?n[a-1]:null}function ac(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function _ce(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function $f(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var SL,CL,xL;function qx(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(nfe()){var BK=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};SL=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},CL=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=qx(i),i.length>0)if(BK(n)){var a;(a=t.classList).add.apply(a,HK(i))}else for(var o=0;i[o];)t.classList.add(i[o]),o+=1},xL=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=qx(i),i.length>0)if(BK(n)){var a;(a=t.classList).remove.apply(a,HK(i))}else for(var o=0;i[o];)t.classList.remove(i[o]),o+=1}}else{var N2=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};SL=function(t,r){return t.className!==void 0&&N2(r).test(t.className)},CL=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=qx(i),n==="")n=i.join(" ");else for(var a=0;a<i.length;a++)i[a]&&!N2(i[a]).test(n)&&(n+=" ".concat(i[a]));t.className=n},xL=function(t,r){var n=0,i=t.className,a=r;for(typeof a=="string"&&(a=a.split(" ")),a=qx(a);a[n];)i=i.replace(N2(a[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function Wt(e,t){return SL(e,t)}function Ge(e,t){CL(e,t)}function Vt(e,t){xL(e,t)}function EW(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)EW(t[r])}function $s(e){for(var t;t=e.lastChild;)e.removeChild(t)}var Sce=/(<(.*)>|&(.*);)/;function sv(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Sce.test(t)?e.innerHTML=r?_A(t):t:Oc(e,t)}function Oc(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?ife?r.textContent=t:r.data=t:($s(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function Sg(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Sg(r.host.impl);if(r.host)return Sg(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function jn(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,a,o,s,l;if(Z4()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(a=i.offsetLeft,o=i.offsetTop,s=i;(i=i.offsetParent)&&i!==t.body;)a+=i.offsetLeft,o+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(a+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:a,top:o}}function Cg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Md(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function jw(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Cg(t):e.scrollTop}function GE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Md(t):e.scrollLeft}function zw(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=afe(),a=e.parentNode;a&&a.style&&t.body!==a;){var o=a.style,s=o.overflow,l=o.overflowX,u=o.overflowY;if([s,l,u].includes("scroll"))return a;if(i){var f=r.getComputedStyle(a);if(s=f.overflow,l=f.overflowX,u=f.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return a}if(a.clientHeight<=a.scrollHeight+1&&(n.includes(u)||n.includes(s))||a.clientWidth<=a.scrollWidth+1&&(n.includes(l)||n.includes(s)))return a;a=a.parentNode}return r}function xg(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Ec(n,r),a=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(a.includes(o)||a.includes(s)||a.includes(l))return n;n=n.parentNode}return r}function Tg(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=Ec(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function cqe(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Ec(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function jr(e){return e.offsetWidth}function mn(e){return Z4()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function lu(e){return e.clientHeight||e.innerHeight}function Qb(e){return e.clientWidth||e.innerWidth}function hqe(e,t,r){e.addEventListener(t,r,!1)}function dqe(e,t,r){e.removeEventListener(t,r,!1)}function RW(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function Cce(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function xce(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function TL(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function I1(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var L2;function vqe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function hi(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return L2===void 0&&(L2=vqe(e)),L2}function Tce(e){return e.offsetWidth!==e.clientWidth}function Oce(e){return e.offsetHeight!==e.clientHeight}function SA(e,t,r){_fe()?(e.style.top=r,e.style.left=t):mfe()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function pqe(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function M1(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function Gw(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function CA(e){return Gw(e)&&e.hasAttribute("data-hot-input")===!1}function Ece(e){var t=e.ownerDocument.activeElement;CA(t)||e.select()}function kW(e){return!e.parentNode}function Rce(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(a){a.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const gqe=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Sce,addClass:Ge,addEvent:hqe,clearTextSelection:TL,closest:ic,closestDown:Tb,empty:$s,fastInnerHTML:sv,fastInnerText:Oc,getCaretPosition:RW,getComputedStyle:Ec,getCssTransform:pqe,getFrameElement:wce,getParent:bce,getParentWindow:Uw,getScrollLeft:GE,getScrollTop:jw,getScrollableElement:zw,getScrollbarWidth:hi,getSelectionEndPosition:Cce,getSelectionText:xce,getStyle:Tg,getTrimmingContainer:xg,getWindowScrollLeft:Md,getWindowScrollTop:Cg,hasAccessToParentWindow:fqe,hasClass:Wt,hasHorizontalScrollbar:Oce,hasVerticalScrollbar:Tce,index:_ce,innerHeight:lu,innerWidth:Qb,isChildOf:ac,isDetached:kW,isInput:Gw,isOutsideInput:CA,isVisible:Sg,matchesCSSRules:cqe,observeVisibilityChangeOnce:Rce,offset:jn,outerHeight:mn,outerWidth:jr,overlayContainsElement:$f,removeClass:Vt,removeEvent:dqe,removeTextNodes:EW,resetCssTransform:M1,selectElementIfAllowed:Ece,setCaretPosition:I1,setOverlayPosition:SA},Symbol.toStringTag,{value:"Module"}));function Qr(e){return typeof e=="function"}function kce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},i=null;function a(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,l)):(i&&clearTimeout(i),i=setTimeout(function(){n.lastCallThrottled=!1,e.apply(o,l),r=0,i=void 0},h)),n}return a}function yqe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=kce(e,t),i=r;function a(){i=r}function o(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return i?(i-=1,e.apply(this,l)):n.apply(this,l)}return o.clearHits=a,o}function AW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var a=this,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(a,s)},t),n}return i}function mqe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t.slice(1);return function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return Nn(i,function(u,f){return f(u)},n.apply(this,s))}}function PW(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return e.apply(this,r.concat(o))}}function Ace(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function bqe(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o.reverse()),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function YE(e,t,r,n,i,a,o,s){return dt(s)?e.call(t,r,n,i,a,o,s):dt(o)?e.call(t,r,n,i,a,o):dt(a)?e.call(t,r,n,i,a):dt(i)?e.call(t,r,n,i):dt(n)?e.call(t,r,n):dt(r)?e.call(t,r):e.call(t)}const wqe=Object.freeze(Object.defineProperty({__proto__:null,curry:Ace,curryRight:bqe,debounce:AW,fastCall:YE,isFunction:Qr,partial:PW,pipe:mqe,throttle:kce,throttleAfterHits:yqe},Symbol.toStringTag,{value:"Module"}));function Kr(){if(dt(console)){var e;(e=console).warn.apply(e,arguments)}}function IW(){if(dt(console)){var e;(e=console).error.apply(e,arguments)}}var _qe=ir,WK=P4,Zx=Ad.getWeakData,Sqe=k4,Cqe=$n,xqe=Hs,F2=Yn,Tqe=R4,Pce=iv,VK=Rn,Ice=Qu,Oqe=Ice.set,Eqe=Ice.getterFor,Rqe=Pce.find,kqe=Pce.findIndex,Aqe=_qe([].splice),Pqe=0,Jx=function(e){return e.frozen||(e.frozen=new Mce)},Mce=function(){this.entries=[]},H2=function(e,t){return Rqe(e.entries,function(r){return r[0]===t})};Mce.prototype={get:function(e){var t=H2(this,e);if(t)return t[1]},has:function(e){return!!H2(this,e)},set:function(e,t){var r=H2(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=kqe(this.entries,function(r){return r[0]===e});return~t&&Aqe(this.entries,t,1),!!~t}};var Dce={getConstructor:function(e,t,r,n){var i=e(function(l,u){Sqe(l,a),Oqe(l,{type:t,id:Pqe++,frozen:void 0}),xqe(u)||Tqe(u,l[n],{that:l,AS_ENTRIES:r})}),a=i.prototype,o=Eqe(t),s=function(l,u,f){var c=o(l),h=Zx(Cqe(u),!0);return h===!0?Jx(c).set(u,f):h[c.id]=f,l};return WK(a,{delete:function(l){var u=o(this);if(!F2(l))return!1;var f=Zx(l);return f===!0?Jx(u).delete(l):f&&VK(f,u.id)&&delete f[u.id]},has:function(u){var f=o(this);if(!F2(u))return!1;var c=Zx(u);return c===!0?Jx(f).has(u):c&&VK(c,f.id)}}),WK(a,r?{get:function(u){var f=o(this);if(F2(u)){var c=Zx(u);return c===!0?Jx(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return s(this,u,f)}}:{add:function(u){return s(this,u,!0)}}),i}},Iqe=b4,UK=tn,_O=ir,jK=P4,Mqe=Ad,Dqe=Qk,$ce=Dce,Qx=Yn,eT=Qu.enforce,$qe=Kt,Nqe=fle,D1=Object,Lqe=Array.isArray,tT=D1.isExtensible,Nce=D1.isFrozen,Fqe=D1.isSealed,Lce=D1.freeze,Hqe=D1.seal,zK={},GK={},Bqe=!UK.ActiveXObject&&"ActiveXObject"in UK,Y0,Fce=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Hce=Dqe("WeakMap",Fce,$ce),Op=Hce.prototype,SO=_O(Op.set),Wqe=function(){return Iqe&&$qe(function(){var e=Lce([]);return SO(new Hce,e,1),!Nce(e)})};if(Nqe)if(Bqe){Y0=$ce.getConstructor(Fce,"WeakMap",!0),Mqe.enable();var YK=_O(Op.delete),rT=_O(Op.has),KK=_O(Op.get);jK(Op,{delete:function(e){if(Qx(e)&&!tT(e)){var t=eT(this);return t.frozen||(t.frozen=new Y0),YK(this,e)||t.frozen.delete(e)}return YK(this,e)},has:function(t){if(Qx(t)&&!tT(t)){var r=eT(this);return r.frozen||(r.frozen=new Y0),rT(this,t)||r.frozen.has(t)}return rT(this,t)},get:function(t){if(Qx(t)&&!tT(t)){var r=eT(this);return r.frozen||(r.frozen=new Y0),rT(this,t)?KK(this,t):r.frozen.get(t)}return KK(this,t)},set:function(t,r){if(Qx(t)&&!tT(t)){var n=eT(this);n.frozen||(n.frozen=new Y0),rT(this,t)?SO(this,t,r):n.frozen.set(t,r)}else SO(this,t,r);return this}})}else Wqe()&&jK(Op,{set:function(t,r){var n;return Lqe(t)&&(Nce(t)?n=zK:Fqe(t)&&(n=GK)),SO(this,t,r),n==zK&&Lce(t),n==GK&&Hqe(t),this}});var yt={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:pO()?182:174,AUDIO_MUTE:pO()?181:173,AUDIO_UP:pO()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Vqe=[yt.ALT,yt.ARROW_DOWN,yt.ARROW_LEFT,yt.ARROW_RIGHT,yt.ARROW_UP,yt.AUDIO_DOWN,yt.AUDIO_MUTE,yt.AUDIO_UP,yt.BACKSPACE,yt.CAPS_LOCK,yt.DELETE,yt.END,yt.ENTER,yt.ESCAPE,yt.F1,yt.F2,yt.F3,yt.F4,yt.F5,yt.F6,yt.F7,yt.F8,yt.F9,yt.F10,yt.F11,yt.F12,yt.F13,yt.F14,yt.F15,yt.F16,yt.F17,yt.F18,yt.F19,yt.HOME,yt.INSERT,yt.MEDIA_NEXT,yt.MEDIA_PLAY_PAUSE,yt.MEDIA_PREV,yt.MEDIA_STOP,yt.NULL,yt.NUM_LOCK,yt.PAGE_DOWN,yt.PAGE_UP,yt.PAUSE,yt.SCROLL_LOCK,yt.SHIFT,yt.TAB];function Bce(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function MW(e){return Vqe.includes(e)}function Uqe(e){var t=[];return LE()?t.push(yt.COMMAND_LEFT,yt.COMMAND_RIGHT,yt.COMMAND_FIREFOX):t.push(yt.CONTROL),t.includes(e)}function Wce(e){return[yt.CONTROL,yt.COMMAND_LEFT,yt.COMMAND_RIGHT,yt.COMMAND_FIREFOX].includes(e)}function Og(e,t){var r=t.split("|"),n=!1;return ve(r,function(i){if(e===yt[i])return n=!0,!1}),n}const jqe=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:yt,isCtrlKey:Uqe,isCtrlMetaKey:Wce,isFunctionKey:MW,isKey:Og,isPrintableChar:Bce},Symbol.toStringTag,{value:"Module"}));function Ns(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Nh(e){return e.isImmediatePropagationEnabled===!1}function Rc(e){return e.button===2}function xA(e){return e.button===0}const zqe=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Nh,isLeftClick:xA,isRightClick:Rc,stopImmediatePropagation:Ns},Symbol.toStringTag,{value:"Module"}));function Yw(e){return Yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yw(e)}var XK;function Gqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kqe(n.key),n)}}function Yqe(e,t,r){return t&&qK(e.prototype,t),r&&qK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kqe(e){var t=Xqe(e,"string");return Yw(t)==="symbol"?t:String(t)}function Xqe(e,t){if(Yw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qqe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Zv=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Zqe=Wr(XK||(XK=qqe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),B2=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),W2=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),Vce=function(){function e(){Gqe(this,e),this.globalBucket=this.createEmptyBucket()}return Yqe(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return ve(Zv,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))ve(n,function(l){return i.add(r,l,a)});else{B2.has(r)&&Kr(OW(Zqe,{hookName:r,removedInVersion:B2.get(r)})),W2.has(r)&&Kr(W2.get(r));var o=this.getBucket(a);if(typeof o[r]>"u"&&(this.register(r),o[r]=[]),n.skip=!1,o[r].indexOf(n)===-1){var s=!1;n.initialHook&&ve(o[r],function(l,u){if(l.initialHook)return o[r][u]=n,s=!0,!1}),s||o[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?ve(n,function(o){return i.once(r,o,a)}):(n.runOnce=!0,this.add(r,n,a))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=this.getBucket(i);return typeof a[r]<"u"&&a[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,a,o,s,l,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=YE(f[h],r,i,a,o,s,l,u);d!==void 0&&(i=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],g=v?v.length:0,y=0;if(g)for(;y<g;){if(!v[y]||v[y].skip){y+=1;continue}var b=YE(v[y],r,i,a,o,s,l,u);b!==void 0&&(i=b),v[y]&&v[y].runOnce&&this.remove(n,v[y],r),y+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;nr(this.getBucket(r),function(n,i,a){return a[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||Zv.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&Zv.splice(Zv.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return W2.has(r)||B2.has(r)}},{key:"isRegistered",value:function(r){return Zv.indexOf(r)>=0}},{key:"getRegistered",value:function(){return Zv}}],[{key:"getSingleton",value:function(){return Qqe()}}]),e}(),Jqe=new Vce;function Qqe(){return Jqe}const pt=Vce;function ZK(e){return nZe(e)||rZe(e)||tZe(e)||eZe()}function eZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tZe(e,t){if(e){if(typeof e=="string")return OL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OL(e,t)}}function rZe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nZe(e){if(Array.isArray(e))return OL(e)}function OL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var V2=new Map;function ts(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";V2.has(e)||V2.set(e,new Map);var t=V2.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function i(s){return t.has(s)}function a(){return ZK(t.keys())}function o(){return ZK(t.values())}return{register:r,getItem:n,hasItem:i,getNames:a,getValues:o}}var EL=new WeakMap,$1=ts("editors"),iZe=$1.register,Uce=$1.getItem,jce=$1.hasItem,aZe=$1.getNames;$1.getValues;function oZe(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},pt.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function zce(e,t){var r;if(typeof e=="function")EL.get(e)||Aa(null,e),r=EL.get(e);else if(typeof e=="string")r=Uce(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function KE(e){if(typeof e=="function")return e;if(!jce(e))throw Error('No registered editor found under "'.concat(e,'" name'));return Uce(e).getConstructor()}function Aa(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new oZe(t);typeof e=="string"&&iZe(e,r),EL.set(t,r)}function Kw(e){return Kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kw(e)}function sZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uZe(n.key),n)}}function lZe(e,t,r){return t&&JK(e.prototype,t),r&&JK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uZe(e){var t=fZe(e,"string");return Kw(t)==="symbol"?t:String(t)}function fZe(e,t){if(Kw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CO=0,cZe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;sZe(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return lZe(e,[{key:"addEventListener",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,hZe(l))}return typeof o!="boolean"&&!sfe()&&(o=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:o,eventManager:this}),r.addEventListener(n,s,o),CO+=1,function(){a.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===r){if(i&&i!==s.callback||a&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),CO-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),CO-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,a=r;i||(i=r.ownerDocument?r.ownerDocument:r,a=i.defaultView);var o={bubbles:!0,cancelable:n!=="mousemove",view:a,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),e}();function hZe(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Ns(this)},e}const bn=cZe;function dZe(){return CO}function Xw(e){return Xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xw(e)}function vZe(e,t){return mZe(e)||yZe(e,t)||gZe(e,t)||pZe()}function pZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gZe(e,t){if(e){if(typeof e=="string")return QK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QK(e,t)}}function QK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function mZe(e){if(Array.isArray(e))return e}function bZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ze(n.key),n)}}function wZe(e,t,r){return t&&eX(e.prototype,t),r&&eX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ze(e){var t=SZe(e,"string");return Xw(t)==="symbol"?t:String(t)}function SZe(e,t){if(Xw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TA="editorManager.navigation",ew="editorManager.handlingEditor",RL=function(){function e(t,r,n){var i=this;bZe(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new bn(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var a=this.instance.getShortcutManager();a.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(o){!i.destroyed&&i.instance.isListening()&&i.openEditor("",o)}),this.instance.view._wt.update("onCellDblClick",function(o,s,l){return i.onCellDblClick(o,s,l)})}return wZe(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),a=n.getContext("editor"),o={group:ew};a.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],o),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),Ns(l)}}],o)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(g){g&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance.runHooks("modifyGetCellCoords",i,a),s=i,l=a;if(Array.isArray(o)){var u=vZe(o,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var f=this.instance.rootDocument.activeElement;if(f&&CA(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(i,a,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=zce(h,this.instance),this.activeEditor.prepare(i,a,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var a=this.instance.getSelectedRangeLast().highlight,o=a.row,s=a.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance,s=o.rowIndexMapper,l=o.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(a));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var a=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!MW(i)&&!Wce(i)&&!a&&!this.isEditorOpened()){var o=this.instance.getShortcutManager(),s=o.getContext("editor"),l={runOnlyIf:function(){return dt(n.instance.getSelected())},group:TA};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),tX=new WeakMap;RL.getInstance=function(e,t,r){var n=tX.get(e);return n||(n=new RL(e,t,r),tX.set(e,n)),n};const CZe=RL;var xZe=Nt,TZe=Wa,Gce=g1,OZe=Kt,EZe=OZe(function(){Gce(1)});xZe({target:"Object",stat:!0,forced:EZe},{keys:function(t){return Gce(TZe(t))}});var RZe=ri,kZe=iA,AZe=$n,PZe=Hs,IZe=nv,U2=Kn,MZe=Ba,DZe=ev,$Ze=W4,rX=aA;kZe("match",function(e,t,r){return[function(i){var a=MZe(this),o=PZe(i)?void 0:DZe(i,e);return o?RZe(o,i,a):new RegExp(i)[e](U2(a))},function(n){var i=AZe(this),a=U2(n),o=r(t,i,a);if(o.done)return o.value;if(!i.global)return rX(i,a);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,f;(f=rX(i,a))!==null;){var c=U2(f[0]);l[u]=c,c===""&&(i.lastIndex=$Ze(a,IZe(i.lastIndex),s)),u++}return u===0?null:l}]});var NZe=av,LZe=co,FZe=Dc,HZe=Jo,BZe=Bm,WZe=Math.min,kL=[].lastIndexOf,Yce=!!kL&&1/[1].lastIndexOf(1,-0)<0,VZe=BZe("lastIndexOf"),UZe=Yce||!VZe,jZe=UZe?function(t){if(Yce)return NZe(kL,this,arguments)||0;var r=LZe(this),n=HZe(r),i=n-1;for(arguments.length>1&&(i=WZe(i,FZe(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:kL,zZe=Nt,nX=jZe;zZe({target:"Array",proto:!0,forced:nX!==[].lastIndexOf},{lastIndexOf:nX});var GZe=Qd,YZe=Wa,KZe=l1,XZe=Jo,qZe=TypeError,iX=function(e){return function(t,r,n,i){GZe(r);var a=YZe(t),o=KZe(a),s=XZe(a),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in o){i=o[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw qZe("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in o&&(i=r(i,o[l],l,a));return i}},ZZe={left:iX(!1),right:iX(!0)},JZe=Nt,QZe=ZZe.left,eJe=Bm,aX=u1,tJe=Gue,rJe=!tJe&&aX>79&&aX<83,nJe=rJe||!eJe("reduce");JZe({target:"Array",proto:!0,forced:nJe},{reduce:function(t){var r=arguments.length;return QZe(this,t,r,r>1?arguments[1]:void 0)}});var iJe=Nt,aJe=iv.findIndex,oJe=C1,AL="findIndex",Kce=!0;AL in[]&&Array(1)[AL](function(){Kce=!1});iJe({target:"Array",proto:!0,forced:Kce},{findIndex:function(t){return aJe(this,t,arguments.length>1?arguments[1]:void 0)}});oJe(AL);function j2(e){return fJe(e)||uJe(e)||lJe(e)||sJe()}function sJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lJe(e,t){if(e){if(typeof e=="string")return PL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PL(e,t)}}function uJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fJe(e){if(Array.isArray(e))return PL(e)}function PL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Xce={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},cJe=new RegExp(Object.keys(Xce).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function hJe(e){return(e&&e.nodeName||"")==="TABLE"}function IL(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),a=i.length,o=a>0?i[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<a;h+=1){for(var d=t&&h===0,v=[],g=0;g<o;g+=1){var y=!d&&r&&g===0,b="";if(d)b="<th>".concat(e.getColHeader(g-f),"</th>");else if(y)b="<th>".concat(e.getRowHeader(h-c),"</th>");else{var w=i[h][g],_=e.getCellMeta(h-c,g-f),x=_.hidden,E=_.rowspan,R=_.colspan;if(!x){var A=[];if(E&&A.push('rowspan="'.concat(E,'"')),R&&A.push('colspan="'.concat(R,'"')),ei(w))b="<td ".concat(A.join(" "),"></td>");else{var N=w.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b="<td ".concat(A.join(" "),">").concat(N,"</td>")}}}v.push(b)}var I=["<tr>"].concat(v,["</tr>"]).join("");d?l.splice(1,0,I):u.splice(-1,0,I)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function ML(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var i=e[n],a=i.length,o=[];n===0&&r.push("<tbody>");for(var s=0;s<a;s+=1){var l=i[s],u=ei(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");o.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(o,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function qce(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);var a=e;if(typeof a=="string"){var o=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(O){var D=O.match(/<td\b[^>]*?>/g)[0],L=O.substring(D.length,O.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),B="</td>";return"".concat(D).concat(L).concat(B)});i.insertAdjacentHTML("afterbegin","".concat(o)),a=i.querySelector("table")}if(!(!a||!hJe(a))){var s=i.querySelector('meta[name$="enerator"]'),l=a.querySelector("tbody th")!==null,u=a.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(O,D){return O+D.colSpan},0)-(l?1:0):0,c=a.tFoot&&Array.from(a.tFoot.rows)||[],h=[],d=!1,v=0,g=0;if(a.tHead){var y=Array.from(a.tHead.rows).filter(function(O){var D=O.querySelector("td")!==null;return D&&h.push(O),!D});v=y.length,d=v>0,v>1?r.nestedHeaders=Array.from(y).reduce(function(O,D){var L=Array.from(D.cells).reduce(function(B,Y,Q){if(l&&Q===0)return B;var he=Y.colSpan,ce=Y.innerHTML,le=he>1?{label:ce,colspan:he}:ce;return B.push(le),B},[]);return O.push(L),O},[]):d&&(r.colHeaders=Array.from(y[0].children).reduce(function(O,D,L){return l&&L===0||O.push(D.innerHTML),O},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var b=[].concat(h,j2(Array.from(a.tBodies).reduce(function(O,D){return O.push.apply(O,j2(Array.from(D.rows))),O},[])),j2(c));g=b.length;for(var w=new Array(g),_=0;_<g;_++)w[_]=new Array(f);for(var x=[],E=[],R=0;R<g;R++)for(var A=b[R],N=Array.from(A.cells),I=N.length,F=0;F<I;F++){var H=N[F],W=H.nodeName,z=H.innerHTML,te=H.rowSpan,ie=H.colSpan,fe=w[R].findIndex(function(O){return O===void 0});if(W==="TD"){if(te>1||ie>1){for(var Te=R;Te<R+te;Te++)if(Te<g)for(var M=fe;M<fe+ie;M++)w[Te][M]=null;var S=H.getAttribute("style"),T=S&&S.includes("mso-ignore:colspan");T||x.push({col:fe,row:R,rowspan:te,colspan:ie})}var k="";s&&/excel/gi.test(s.content)?k=z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):k=z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),w[R][fe]=k.replace(cJe,function(O){return Xce[O]})}else E.push(z)}return x.length&&(r.mergeCells=x),E.length&&(r.rowHeaders=E),w.length&&(r.data=w),r}}const dJe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:ML,htmlToGridSettings:qce,instanceToHTML:IL},Symbol.toStringTag,{value:"Module"}));function vJe(e){return mJe(e)||yJe(e)||gJe(e)||pJe()}function pJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gJe(e,t){if(e){if(typeof e=="string")return DL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DL(e,t)}}function yJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mJe(e){if(Array.isArray(e))return DL(e)}function DL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $L(e){return $L=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$L(e)}function eo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=$L(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(vJe(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function Zce(e){return eo(e,[","])}function xt(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function XE(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function DW(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const bJe=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:eo,isNumericLike:Zce,rangeEach:xt,rangeEachReverse:XE,valueAccordingPercent:DW},Symbol.toStringTag,{value:"Module"}));function wJe(e){return CJe(e)||SJe(e)||Jce(e)||_Je()}function _Je(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CJe(e){if(Array.isArray(e))return NL(e)}function xJe(e,t){return EJe(e)||OJe(e,t)||Jce(e,t)||TJe()}function TJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jce(e,t){if(e){if(typeof e=="string")return NL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NL(e,t)}}function NL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function EJe(e){if(Array.isArray(e))return e}var LL="asc",RJe="desc",oX=new Map([[LL,[-1,1]],[RJe,[1,-1]]]),kJe=function(t){return"The priority '".concat(t,"' is already declared in a map.")},AJe=function(t){return"The priority '".concat(t,"' is not a number.")};function PJe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=Qr(t)?t:kJe,r=Qr(r)?r:AJe;function i(o,s){if(!eo(o))throw new Error(r(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function a(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:LL,s=oX.get(o)||oX.get(LL),l=xJe(s,2),u=l[0],f=l[1];return wJe(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:i,getItems:a}}var IJe=Nt,MJe=iv.find,DJe=C1,FL="find",Qce=!0;FL in[]&&Array(1)[FL](function(){Qce=!1});IJe({target:"Array",proto:!0,forced:Qce},{find:function(t){return MJe(this,t,arguments.length>1?arguments[1]:void 0)}});DJe(FL);function $Je(e){return FJe(e)||LJe(e)||ehe(e)||NJe()}function NJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FJe(e){if(Array.isArray(e))return HL(e)}function sX(e,t){return WJe(e)||BJe(e,t)||ehe(e,t)||HJe()}function HJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ehe(e,t){if(e){if(typeof e=="string")return HL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HL(e,t)}}function HL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function WJe(e){if(Array.isArray(e))return e}var VJe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function OA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=Qr(t)?t:VJe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function i(f){return r.delete(f)}function a(){r.clear()}function o(f){var c=l().find(function(v){var g=sX(v,2),y=g[0],b=g[1];return f===b?y:!1})||[null],h=sX(c,1),d=h[0];return d}function s(f){return r.get(f)}function l(){return $Je(r)}function u(f){return r.has(f)}return{addItem:n,clear:a,getId:o,getItem:s,getItems:l,hasItem:u,removeItem:i}}function UJe(e){return YJe(e)||GJe(e)||zJe(e)||jJe()}function jJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zJe(e,t){if(e){if(typeof e=="string")return BL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BL(e,t)}}function GJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function YJe(e){if(Array.isArray(e))return BL(e)}function BL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var KJe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function XJe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=Qr(t)?t:KJe;function n(o){if(r.has(o))throw new Error(t(o));r.add(o)}function i(){return UJe(r)}function a(){r.clear()}return{addItem:n,clear:a,getItems:i}}function qJe(e,t){return QJe(e)||JJe(e,t)||the(e,t)||ZJe()}function ZJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function QJe(e){if(Array.isArray(e))return e}function lX(e){return rQe(e)||tQe(e)||the(e)||eQe()}function eQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function the(e,t){if(e){if(typeof e=="string")return WL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WL(e,t)}}function tQe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rQe(e){if(Array.isArray(e))return WL(e)}function WL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $W=function(t){return'There is already registered "'.concat(t,'" plugin.')},nQe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},iQe=function(t){return'The priority "'.concat(t,'" is not a number.')},rhe=PJe({errorPriorityExists:nQe,errorPriorityNaN:iQe}),nhe=XJe({errorItemExists:$W}),VL=OA({errorIdExists:$W});function NW(){return[].concat(lX(rhe.getItems()),lX(nhe.getItems()))}function N1(e){var t=La(e);return VL.getItem(t)}function aQe(e){return!!N1(e)}function Sr(e,t,r){var n=sQe(e,t,r),i=qJe(n,3);e=i[0],t=i[1],r=i[2],N1(e)===void 0&&oQe(e,t,r)}function oQe(e,t,r){var n=La(e);if(VL.hasItem(n))throw new Error($W(n));r===void 0?nhe.addItem(n):rhe.addItem(r,n),VL.addItem(n,t)}function sQe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var L1=ts("renderers"),lQe=L1.register,uQe=L1.getItem,ihe=L1.hasItem,fQe=L1.getNames;L1.getValues;function qE(e){if(typeof e=="function")return e;if(!ihe(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return uQe(e)}function ol(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),lQe(e,t)}var F1=ts("validators"),cQe=F1.register,hQe=F1.getItem,ahe=F1.hasItem,dQe=F1.getNames;F1.getValues;function LW(e){if(typeof e=="function")return e;if(!ahe(e))throw Error('No registered validator found under "'.concat(e,'" name'));return hQe(e)}function Fp(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),cQe(e,t)}var Lh=1,$i=2;function qw(e){return qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qw(e)}function vQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gQe(n.key),n)}}function pQe(e,t,r){return t&&uX(e.prototype,t),r&&uX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gQe(e){var t=yQe(e,"string");return qw(t)==="symbol"?t:String(t)}function yQe(e,t){if(qw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jv=new WeakMap,mQe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;vQe(this,e),Jv.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:a,overrideFn:o,calculationType:s,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return pQe(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],a,o=0,s=0,l=Jv.get(this),u=l.calculationType,f=l.overrideFn,c=l.scrollOffset,h=Math.max(l.scrollOffset,0),d=l.totalColumns,v=l.viewportWidth,g=h>0?v+1:v,y=0;y<d;y++)if(a=this._getColumnWidth(y),r<=h&&u!==$i&&(this.startColumn=y,o=a),r>=h&&r+(u===$i?a:0)<=h+g&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,o=a),this.endColumn=y),i.push(r),r+=a,s=a,u!==$i&&(this.endColumn=y),r>=h+v){n=!1;break}var b=c+v-g,w=u===$i?0:s,_=u===$i?o:0;if(b<-1*l.inlineStartOffset||c>i.at(-1)+w||-1*l.scrollOffset-l.viewportWidth>-1*_?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var x=i[this.endColumn]+a-i[this.startColumn-1];if((x<=v||u!==$i)&&(this.startColumn-=1),x>v)break}u===Lh&&this.startColumn!==null&&f&&f(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=Jv.get(this),a=i.totalColumns,o=0,s=0;s<a;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:o+=l}var f=n-o;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(a-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,a=Jv.get(this),o=a.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=a.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Jv.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Jv.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const FW=mQe;function Zw(e){return Zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zw(e)}function bQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Qe(n.key),n)}}function wQe(e,t,r){return t&&fX(e.prototype,t),r&&fX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Qe(e){var t=SQe(e,"string");return Zw(t)==="symbol"?t:String(t)}function SQe(e,t){if(Zw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cX=new WeakMap,CQe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;bQe(this,e),cX.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:a,overrideFn:o,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return wQe(e,[{key:"calculate",value:function(){for(var r=cX.get(this),n=r.calculationType,i=r.overrideFn,a=r.rowHeightFn,o=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,g=0,y=0,b=0;b<l;b++)if(v=a(b),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=s&&n!==$i&&(this.startRow=b,g=v),c>=s&&c+(n===$i?v:0)<=s+u-f&&(this.startRow===null&&(this.startRow=b,g=v),this.endRow=b),d.push(c),c+=v,y=v,n!==$i&&(this.endRow=b),c>=s+u-f){h=!1;break}var w=o+u-f,_=n===$i?g:0,x=n===$i?0:y;if(w<_||o>d.at(-1)+x?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var E=d[this.endRow]+v-d[this.startRow-1];if((E<=u-f||n!==$i)&&(this.startRow-=1),E>=u-f)break}n===Lh&&this.startRow!==null&&i&&i(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const ohe=CQe;function Jw(e){return Jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jw(e)}function xQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,she(n.key),n)}}function TQe(e,t,r){return t&&hX(e.prototype,t),r&&hX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OQe(e,t,r){EQe(e,t),t.set(e,r)}function EQe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dX(e,t,r){return t=she(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function she(e){var t=RQe(e,"string");return Jw(t)==="symbol"?t:String(t)}function RQe(e,t){if(Jw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K0(e,t){var r=lhe(e,t,"get");return kQe(e,r)}function kQe(e,t){return t.get?t.get.call(e):t.value}function AQe(e,t,r){var n=lhe(e,t,"set");return PQe(e,n,r),r}function lhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function PQe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var _h=new WeakMap,IQe=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;xQe(this,e),dX(this,"row",null),dX(this,"col",null),OQe(this,_h,{writable:!0,value:!1}),AQe(this,_h,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return TQe(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(K0(this,_h)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(K0(this,_h)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(K0(this,_h)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(K0(this,_h)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,K0(this,_h))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const ZE=IQe;function Qw(e){return Qw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qw(e)}function MQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uhe(n.key),n)}}function DQe(e,t,r){return t&&vX(e.prototype,t),r&&vX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Qe(e,t,r){NQe(e,t),t.set(e,r)}function NQe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z2(e,t,r){return t=uhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uhe(e){var t=LQe(e,"string");return Qw(t)==="symbol"?t:String(t)}function LQe(e,t){if(Qw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xs(e,t){var r=fhe(e,t,"get");return FQe(e,r)}function FQe(e,t){return t.get?t.get.call(e):t.value}function HQe(e,t,r){var n=fhe(e,t,"set");return BQe(e,n,r),r}function fhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function BQe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var To=new WeakMap,WQe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;MQe(this,e),z2(this,"highlight",null),z2(this,"from",null),z2(this,"to",null),$Qe(this,To,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),HQe(this,To,i)}return DQe(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,a=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return a.row<=n&&o.row>=n&&a.col<=i&&o.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=this.getDirection(),o=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),f=Math.max(i.row,s.row),c=Math.max(i.col,s.col),h=this._createCellCoords(l,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(a),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var a=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=a[0],this.to=a[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Xs(this,To)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Xs(this,To)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Xs(this,To)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Xs(this,To)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Xs(this,To)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Xs(this,To)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Xs(this,To)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Xs(this,To)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof ZE))return!1;if(n){var i=n.from,a=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,a.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(a.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(a.row,a.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},a=[];return n.top===i.top&&a.push("top"),n.right===i.right&&a.push("right"),n.bottom===i.bottom&&a.push("bottom"),n.left===i.left&&a.push("left"),a}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)!(this.from.row===a&&this.from.col===o)&&!(this.to.row===a&&this.to.col===o)&&i.push(this._createCellCoords(a,o));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)r.row===a&&r.col===o?i.push(r):n.row===a&&n.col===o?i.push(n):i.push(this._createCellCoords(a,o));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=n.row;a<=i.row;a++)for(var o=n.col;o<=i.col;o++){var s=r(a,o);if(s===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Xs(this,To))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new ZE(r,n,Xs(this,To))}}]),e}();const HW=WQe;var VQe=Nt,UQe=C4;VQe({target:"Object",stat:!0},{setPrototypeOf:UQe});var che=ir,jQe=Qd,zQe=Yn,GQe=Rn,pX=_1,YQe=a1,hhe=Function,KQe=che([].concat),XQe=che([].join),G2={},qQe=function(e,t,r){if(!GQe(G2,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";G2[t]=hhe("C,a","return new C("+XQe(n,",")+")")}return G2[t](e,r)},ZQe=YQe?hhe.bind:function(t){var r=jQe(this),n=r.prototype,i=pX(arguments,1),a=function(){var s=KQe(i,pX(arguments));return this instanceof a?qQe(r,s.length,s):r.apply(t,s)};return zQe(n)&&(a.prototype=n),a},JQe=Nt,QQe=Ju,Y2=av,eet=ZQe,gX=lfe,tet=$n,yX=Yn,ret=Lm,dhe=Kt,BW=QQe("Reflect","construct"),net=Object.prototype,iet=[].push,vhe=dhe(function(){function e(){}return!(BW(function(){},[],e)instanceof e)}),phe=!dhe(function(){BW(function(){})}),mX=vhe||phe;JQe({target:"Reflect",stat:!0,forced:mX,sham:mX},{construct:function(t,r){gX(t),tet(r);var n=arguments.length<3?t:gX(arguments[2]);if(phe&&!vhe)return BW(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return Y2(iet,i,r),new(Y2(eet,t,i))}var a=n.prototype,o=ret(yX(a)?a:net),s=Y2(t,o,r);return yX(s)?s:o}});function e_(e){return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e_(e)}function aet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,set(n.key),n)}}function oet(e,t,r){return t&&bX(e.prototype,t),r&&bX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function set(e){var t=uet(e,"string");return e_(t)==="symbol"?t:String(t)}function uet(e,t){if(e_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(e_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qv=new WeakMap,fet=function(){function e(t,r,n,i,a,o){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;aet(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=a,this.selections=o,this.parent=s,this.eventManager=i,this.facadeGetter=t,Qv.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return oet(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(a){return r.onContextMenu(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(a){return r.onMouseOver(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(a){return r.onMouseOut(a)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(o){return r.onTouchStart(o)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(o){return r.onTouchEnd(o)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(o){return r.onMouseUp(o)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(o){return r.onMouseDown(o)})};Es()?n():(q4()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=Qv.get(this),i=this.parentCell(r),a=i.coords;if(n.selectedCellBeforeTouchEnd&&a){var o=[a.row,n.selectedCellBeforeTouchEnd.from.row],s=o[0],l=o[1],u=[a.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return s===l&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,a=Tb(r,["TD","TH"],i);return a?(n.coords=this.wtTable.getCoords(a),n.TD=a):Wt(r,"wtBorder")&&Wt(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):Wt(r,"wtBorder")&&Wt(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Qv.get(this),i=this.domBindings.rootDocument.activeElement,a=PW(bce,r.target),o=r.target;if(!(o===i||a(0)===i||a(1)===i)){var s=this.parentCell(o);Wt(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,o):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=Tb(r.target,["TD","TH"],n),a=this.parent||this;i&&i!==a.lastMouseOver&&ac(i,n)&&(a.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=Tb(r.target,["TD","TH"],n),a=Tb(r.relatedTarget,["TD","TH"],n);i&&i!==a&&ac(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=Qv.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(Wt(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Qv.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,a=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=dt(a)&&a.row>=0&&a.col>=0,s=r.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];rW()&&(gfe()||yfe())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,a){var o=this.wtSettings.getSettingPure(r);o&&o(n,i,a,this.facadeGetter())}},{key:"destroy",value:function(){var r=Qv.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const ghe=fet;function t_(e){return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function cet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,det(n.key),n)}}function het(e,t,r){return t&&wX(e.prototype,t),r&&wX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function det(e){var t=vet(e,"string");return t_(t)==="symbol"?t:String(t)}function vet(e,t){if(t_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pet=function(){function e(t,r,n){cet(this,e),this.offset=t,this.total=r,this.countTH=n}return het(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const get=pet;function r_(e){return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r_(e)}function yet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bet(n.key),n)}}function met(e,t,r){return t&&_X(e.prototype,t),r&&_X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bet(e){var t=wet(e,"string");return r_(t)==="symbol"?t:String(t)}function wet(e,t){if(r_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _et=function(){function e(t,r,n){yet(this,e),this.offset=t,this.total=r,this.countTH=n}return met(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const Cet=_et;var xet=0,JE=1,QE=2;function n_(e){return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}function Tet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eet(n.key),n)}}function Oet(e,t,r){return t&&SX(e.prototype,t),r&&SX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eet(e){var t=Ret(e,"string");return n_(t)==="symbol"?t:String(t)}function Ret(e,t){if(n_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CX=function(){function e(){Tet(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Oet(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function i_(e){return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function ket(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pet(n.key),n)}}function Aet(e,t,r){return t&&xX(e.prototype,t),r&&xX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pet(e){var t=Iet(e,"string");return i_(t)==="symbol"?t:String(t)}function Iet(e,t){if(i_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Met=function(){function e(){ket(this,e),this.size=new CX,this.workingSpace=xet,this.sharedSize=null}return Aet(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof CX}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=JE,r.workingSpace=QE,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=QE,r.workingSpace=JE,this.sharedSize=r.getViewSize()}}]),e}();function a_(e){return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function Det(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Net(n.key),n)}}function $et(e,t,r){return t&&TX(e.prototype,t),r&&TX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Net(e){var t=Let(e,"string");return a_(t)==="symbol"?t:String(t)}function Let(e,t){if(a_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yhe=function(){function e(t,r,n){Det(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new Met,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return $et(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var a=r.firstElementChild;a;){if(a.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(JE))break;a=a.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),a=n.getViewSize(),o=a.nextSize,s=this.getRenderedChildCount();s<o;){var l=this.nodesPool();!i||i&&n.isPlaceOn(QE)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(JE);s>o;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(QE)&&(i+=n.sharedSize.nextSize);var a=r.childNodes[i];if(a.tagName!==this.childNodeType){var o=this.nodesPool();r.replaceChild(o,a),a=o}this.collectedNodes.push(a),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function Eg(e){return Eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eg(e)}function Fet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bet(n.key),n)}}function Het(e,t,r){return t&&OX(e.prototype,t),r&&OX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bet(e){var t=Wet(e,"string");return Eg(t)==="symbol"?t:String(t)}function Wet(e,t){if(Eg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UL(e,t)}function UL(e,t){return UL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UL(e,t)}function Uet(e){var t=Get();return function(){var n=eR(e),i;if(t){var a=eR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return jet(this,i)}}function jet(e,t){if(t&&(Eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zet(e)}function zet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Get(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eR(e){return eR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eR(e)}var mhe=function(e){Vet(r,e);var t=Uet(r);function r(){return Fet(this,r),t.apply(this,arguments)}return Het(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(yhe);function o_(e){return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o_(e)}function Yet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xet(n.key),n)}}function Ket(e,t,r){return t&&EX(e.prototype,t),r&&EX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xet(e){var t=qet(e,"string");return o_(t)==="symbol"?t:String(t)}function qet(e,t){if(o_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(o_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zet=function(){function e(t){Yet(this,e),this.nodeType=t.toUpperCase()}return Ket(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function s_(e){return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function Jet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ett(n.key),n)}}function Qet(e,t,r){return t&&RX(e.prototype,t),r&&RX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ett(e){var t=ttt(e,"string");return s_(t)==="symbol"?t:String(t)}function ttt(e,t){if(s_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H1=function(){function e(t,r){Jet(this,e),this.nodesPool=typeof t=="string"?new Zet(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return Qet(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function Rg(e){return Rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rg(e)}function rtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,itt(n.key),n)}}function ntt(e,t,r){return t&&kX(e.prototype,t),r&&kX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function itt(e){var t=att(e,"string");return Rg(t)==="symbol"?t:String(t)}function att(e,t){if(Rg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ott(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jL(e,t)}function jL(e,t){return jL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jL(e,t)}function stt(e){var t=ftt();return function(){var n=tR(e),i;if(t){var a=tR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ltt(this,i)}}function ltt(e,t){if(t&&(Rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return utt(e)}function utt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ftt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tR(e){return tR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tR(e)}var ctt=function(e){ott(r,e);var t=stt(r);function r(){var n;return rtt(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return ntt(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new mhe(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,f=0;f<a;f++){var c=this.table.renderedRowToSource(f),h=l.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var g=0;g<s;g++){d.render();var y=d.getCurrentNode();y.className="",y.removeAttribute("style"),o[g](c,y,g)}d.end()}}}]),r}(H1);function kg(e){return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kg(e)}function htt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vtt(n.key),n)}}function dtt(e,t,r){return t&&AX(e.prototype,t),r&&AX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vtt(e){var t=ptt(e,"string");return kg(t)==="symbol"?t:String(t)}function ptt(e,t){if(kg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gtt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zL(e,t)}function zL(e,t){return zL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zL(e,t)}function ytt(e){var t=wtt();return function(){var n=rR(e),i;if(t){var a=rR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mtt(this,i)}}function mtt(e,t){if(t&&(kg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return btt(e)}function btt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rR(e){return rR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rR(e)}var _tt=function(e){gtt(r,e);var t=ytt(r);function r(n){return htt(this,r),t.call(this,null,n)}return dtt(r,[{key:"adjust",value:function(){var i=this.table,a=i.columnHeadersCount,o=i.rowHeadersCount,s=this.rootNode.firstChild;if(a){for(var l=this.table.columnsToRender,u=l+o,f=0,c=a;f<c;f++){for(s=this.rootNode.childNodes[f],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>a)for(var d=a;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&$s(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,a=0;a<i;a+=1)for(var o=this.table,s=o.columnHeaderFunctions,l=o.columnsToRender,u=o.rowHeadersCount,f=this.rootNode.childNodes[a],c=-1*u;c<l;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),s[a](h,d,a)}}}]),r}(H1);function Ag(e){return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ag(e)}function Stt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xtt(n.key),n)}}function Ctt(e,t,r){return t&&PX(e.prototype,t),r&&PX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xtt(e){var t=Ttt(e,"string");return Ag(t)==="symbol"?t:String(t)}function Ttt(e,t){if(Ag(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ag(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ott(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GL(e,t)}function GL(e,t){return GL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GL(e,t)}function Ett(e){var t=Att();return function(){var n=nR(e),i;if(t){var a=nR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Rtt(this,i)}}function Rtt(e,t){if(t&&(Ag(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ktt(e)}function ktt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Att(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nR(e){return nR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nR(e)}var Ptt=function(e){Ott(r,e);var t=Ett(r);function r(n){return Stt(this,r),t.call(this,null,n)}return Ctt(r,[{key:"adjust",value:function(){for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=a+o;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=0;s<o;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var f=0;f<a;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+o].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&Ge(d,"rowHeader")}}]),r}(H1);function Pg(e){return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pg(e)}var IX;function Itt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Mtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$tt(n.key),n)}}function Dtt(e,t,r){return t&&MX(e.prototype,t),r&&MX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $tt(e){var t=Ntt(e,"string");return Pg(t)==="symbol"?t:String(t)}function Ntt(e,t){if(Pg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ltt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YL(e,t)}function YL(e,t){return YL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YL(e,t)}function Ftt(e){var t=Wtt();return function(){var n=iR(e),i;if(t){var a=iR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Htt(this,i)}}function Htt(e,t){if(t&&(Pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Btt(e)}function Btt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iR(e){return iR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iR(e)}var DX=!1,Vtt=function(e){Ltt(r,e);var t=Ftt(r);function r(n){var i;return Mtt(this,r),i=t.call(this,"TR",n),i.orderView=new yhe(n,function(a){return i.nodesPool.obtain(a)},i.nodeType),i}return Dtt(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!DX&&i>1e3&&(DX=!0,Kr(Wr(IX||(IX=Itt([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var a=0;a<i;a++)this.orderView.render();this.orderView.end()}}]),r}(H1);function Ig(e){return Ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ig(e)}function Utt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ztt(n.key),n)}}function jtt(e,t,r){return t&&$X(e.prototype,t),r&&$X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ztt(e){var t=Gtt(e,"string");return Ig(t)==="symbol"?t:String(t)}function Gtt(e,t){if(Ig(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ig(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ytt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KL(e,t)}function KL(e,t){return KL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KL(e,t)}function Ktt(e){var t=Ztt();return function(){var n=aR(e),i;if(t){var a=aR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Xtt(this,i)}}function Xtt(e,t){if(t&&(Ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qtt(e)}function qtt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ztt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function aR(e){return aR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aR(e)}var Jtt=function(e){Ytt(r,e);var t=Ktt(r);function r(){var n;return Utt(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return jtt(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new mhe(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<a;u++){var f=this.table.renderedRowToSource(u),c=s.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=l.obtainOrderView(c);h.prependView(d).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<o;v++){h.render();var g=h.getCurrentNode(),y=this.table.renderedColumnToSource(v);Wt(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),this.table.cellRenderer(f,y,g)}h.end()}}}]),r}(H1);function l_(e){return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function Qtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,trt(n.key),n)}}function ert(e,t,r){return t&&NX(e.prototype,t),r&&NX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function trt(e){var t=rrt(e,"string");return l_(t)==="symbol"?t:String(t)}function rrt(e,t){if(l_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nrt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Qtt(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return ert(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,a=r.colGroup,o=r.rows,s=r.cells;n.setTable(this),i.setTable(this),a.setTable(this),o.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=a,this.rows=o,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var a=n.getRenderedNode(i);if(a.firstChild){var o=this.renderedRowToSource(i),s=this.rowUtils.getHeight(o);s?a.firstChild.style.height="".concat(s-1,"px"):a.firstChild.style.height=""}}}}]),e}();function u_(e){return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u_(e)}function irt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ort(n.key),n)}}function art(e,t,r){return t&&LX(e.prototype,t),r&&LX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ort(e){var t=srt(e,"string");return u_(t)==="symbol"?t:String(t)}function srt(e,t){if(u_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(u_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lrt=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,a=t.TBODY,o=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;irt(this,e),this.renderer=new nrt(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new ctt,columnHeaders:new _tt(n),colGroup:new Ptt(i),rows:new Vtt(a),cells:new Jtt}),this.renderer.setAxisUtils(o,s)}return art(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function f_(e){return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f_(e)}function urt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,crt(n.key),n)}}function frt(e,t,r){return t&&FX(e.prototype,t),r&&FX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function crt(e){var t=hrt(e,"string");return f_(t)==="symbol"?t:String(t)}function hrt(e,t){if(f_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var drt=function(){function e(t,r){urt(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return frt(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var a=n.getStretchedColumnWidth(r,i);a&&(i=a)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,a=n.wtViewport,o=n.cloneSource,s=o?o.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?hi():0,u=r.getSetting("rowHeaderWidth");if(a.columnsRenderCalculator.refreshStretching(a.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function c_(e){return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c_(e)}function vrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,grt(n.key),n)}}function prt(e,t,r){return t&&HX(e.prototype,t),r&&HX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function grt(e){var t=yrt(e,"string");return c_(t)==="symbol"?t:String(t)}function yrt(e,t){if(c_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mrt=function(){function e(t,r){vrt(this,e),this.dataAccessObject=t,this.wtSettings=r}return prt(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function h_(e){return h_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h_(e)}function brt(e){return Srt(e)||_rt(e)||bhe(e)||wrt()}function wrt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _rt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Srt(e){if(Array.isArray(e))return XL(e)}function Crt(e,t){return Ort(e)||Trt(e,t)||bhe(e,t)||xrt()}function xrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bhe(e,t){if(e){if(typeof e=="string")return XL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XL(e,t)}}function XL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Trt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Ort(e){if(Array.isArray(e))return e}function Ert(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,whe(n.key),n)}}function Rrt(e,t,r){return t&&BX(e.prototype,t),r&&BX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qs(e,t,r){return t=whe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function whe(e){var t=krt(e,"string");return h_(t)==="symbol"?t:String(t)}function krt(e,t){if(h_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(h_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Art=function(){function e(t,r,n,i,a){var o=this;Ert(this,e),qs(this,"wtSettings",null),qs(this,"domBindings",void 0),qs(this,"TBODY",null),qs(this,"THEAD",null),qs(this,"COLGROUP",null),qs(this,"hasTableHeight",!0),qs(this,"hasTableWidth",!0),qs(this,"isTableVisible",!1),qs(this,"tableOffset",0),qs(this,"holderOffset",0),this.domBindings=n,this.isMaster=a==="master",this.name=a,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,EW(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return o._modifyRowHeaderWidth(s)}),this.rowUtils=new mrt(this.dataAccessObject,this.wtSettings),this.columnUtils=new drt(this.dataAccessObject,this.wtSettings),this.tableRenderer=new lrt({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Rrt(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Wt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Wt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Wt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,a=i.wtOverlays,o=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=jn(this.holder),v=o.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var g=a.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,y!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=a.updateStateOfRendering()),v)this.isMaster&&o.createVisibleCalculators(),a&&a.refresh(!0);else{this.isMaster?this.tableOffset=jn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var b=s>0?this.getFirstRenderedRow():0,w=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new Cet(b,s,h),this.columnFilter=new get(w,l,f);var _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var x={};this.wtSettings.getSetting("beforeDraw",!0,x),_=x.skipRender!==!0}if(_){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(hl)||this.is(oc))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var E;if(this.isMaster&&(E=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(hl))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var R=jr(this.hider),A=jr(this.TABLE);R!==0&&A!==R&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),E!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(hl)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var N=!1;return this.isMaster&&(N=a.topOverlay.resetFixedPosition(),a.bottomOverlay.clone&&(N=a.bottomOverlay.resetFixedPosition()||N),N=a.inlineStartOverlay.resetFixedPosition()||N,a.topInlineStartCornerOverlay&&a.topInlineStartCornerOverlay.resetFixedPosition(),a.bottomInlineStartCornerOverlay&&a.bottomInlineStartCornerOverlay.clone&&a.bottomInlineStartCornerOverlay.resetFixedPosition()),N?(a.refreshAll(),a.adjustElementsSize()):this.refreshSelections(v),d&&a.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,a=this.wtSettings.getSetting("defaultRowHeight"),o,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=lu(s),(!o&&a<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,a=r.getSetting("columnHeaders"),o=0,s=a.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height="".concat(i[o],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(hl))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),a=0;a<i;a++){var o=this.rowFilter.renderedToSource(a);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,a=n.length;i<a;i++)Vt(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var a=Array.from(i),o=a.length;if(r){for(var s=[],l=0;l<o;l++){for(var u=a[l].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=a[l].classNames,v=d.length,g=0;g<v;g++)s.includes(d[g])||s.push(d[g]);f&&!s.includes(f)&&s.push(f),c&&!s.includes(c)&&s.push(c),h&&!s.includes(h)&&s.push(h)}var y=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(y))for(var b=0;b<y.length;b++)s.push(y[b]);for(var w=s.length,_=0;_<w;_++)this.removeClassFromCells(s[_])}for(var x=0;x<o;x++)a[x].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,a=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(a&&Array.isArray(a)){var o=Crt(a,2);n=o[0],i=o[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(a){var o=a.childNodes[i];o&&n.push(o)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return a==null?void 0:a.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,a=0;a<i;a++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=o==null?void 0:o.childNodes[a];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ic(n,["TD","TH"])),n===null)return null;var i=n.parentNode,a=i.parentNode,o=_ce(i),s=n.cellIndex;if($f(Nd,n,this.wtRootElement)||$f(Dd,n,this.wtRootElement))a.nodeName==="THEAD"&&(o-=a.childNodes.length);else if($f(oc,n,this.wtRootElement)||$f(hl,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");o=l-a.childNodes.length+o}else a===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o);return $f(Nd,n,this.wtRootElement)||$f($d,n,this.wtRootElement)||$f(oc,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=lu(this.TBODY)-1,a,o,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),a=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?o=lu(u):o=lu(l)-1,(!a&&this.wtSettings.getSetting("defaultRowHeight")<o||a<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return jr(this.TABLE)}},{key:"getHeight",value:function(){return mn(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=jr(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=mn(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return Sg(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=Qr(r)?r():null;return Array.isArray(n)?(n=brt(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const jm=Art;var Prt="stickyRowsBottom",_he={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};El(_he,"MIXIN_NAME",Prt,{writable:!1,enumerable:!1});const She=_he;var Irt="stickyColumnsStart",Che={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};El(Che,"MIXIN_NAME",Irt,{writable:!1,enumerable:!1});const WW=Che;function Mg(e){return Mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mg(e)}function WX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Drt(n.key),n)}}function Mrt(e,t,r){return t&&WX(e.prototype,t),r&&WX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Drt(e){var t=$rt(e,"string");return Mg(t)==="symbol"?t:String(t)}function $rt(e,t){if(Mg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qL(e,t)}function qL(e,t){return qL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qL(e,t)}function Frt(e){var t=Wrt();return function(){var n=oR(e),i;if(t){var a=oR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Hrt(this,i)}}function Hrt(e,t){if(t&&(Mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Brt(e)}function Brt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oR(e){return oR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oR(e)}var VW=function(e){Lrt(r,e);var t=Frt(r);function r(n,i,a,o){return Nrt(this,r),t.call(this,n,i,a,o,oc)}return Mrt(r)}(jm);qr(VW,She);qr(VW,WW);const Vrt=VW;var Dd="top",hl="bottom",$d="inline_start",Nd="top_inline_start_corner",oc="bottom_inline_start_corner",Urt=[Dd,hl,$d,Nd,oc],jrt=new Map([[Dd,"ht_clone_".concat(Dd)],[hl,"ht_clone_".concat(hl)],[$d,"ht_clone_".concat($d," ht_clone_left")],[Nd,"ht_clone_".concat(Nd," ht_clone_top_left_corner")],[oc,"ht_clone_".concat(oc," ht_clone_bottom_left_corner")]]);function d_(e){return d_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d_(e)}function zrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xhe(n.key),n)}}function Grt(e,t,r){return t&&VX(e.prototype,t),r&&VX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K2(e,t,r){return t=xhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xhe(e){var t=Yrt(e,"string");return d_(t)==="symbol"?t:String(t)}function Yrt(e,t){if(d_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(d_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Krt=function(){function e(t){zrt(this,e),K2(this,"dataAccessObject",void 0),K2(this,"lastScrolledColumnPos",-1),K2(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return Grt(e,[{key:"scrollViewport",value:function(r,n,i,a,o){var s=this.scrollViewportHorizontally(r.col,i,o),l=this.scrollViewportVertically(r.row,n,a);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalColumns;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return l===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<l||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalRows;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>s-h-1))return!1;var g=!1;return l===-1?g=v.scrollTo(r,f?r>this.lastScrolledRowPos:i):(f&&(r<l||r>u)||!f)&&(g=v.scrollTo(r,f?r>u:i)),g&&(this.lastScrolledRowPos=r),g}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var f=jn(i.wtRootElement),c=lu(i.hider),h=lu(l),d=jw(l,l);if(f.top+c-h<=d){var v=a.getColumnHeaderHeight();v+=n.sumCellSizes(0,s);for(var g=o;g>0;g--)if(v+=n.sumCellSizes(g-1,g),f.top+c-v<=d){u=g;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=jn(i.wtRootElement),f=jw(s,s);if(u.top>f){for(var c=lu(s),h=a.getColumnHeaderHeight(),d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=jn(i.wtRootElement),f=Qb(i.hider),c=Qb(s),h=Math.abs(GE(s,s));if(u.left+f-c<=h){for(var d=a.getRowHeaderWidth(),v=o;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){l=v;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,a=r.wtTable,o=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=a.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var f=n.getSetting("rtlMode"),c=null;if(f){var h=a.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var g=jn(a.wtRootElement);c=g.left}var y=Math.abs(GE(l,l));if(c>y){for(var b=Qb(l),w=o.getRowHeaderWidth(),_=1;_<=s;_++)if(w+=i.sumCellSizes(_-1,_),c+w-y>=b){u=_-2;break}}}return u}}]),e}();const Xrt=Krt;function v_(e){return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v_(e)}function qrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,The(n.key),n)}}function Zrt(e,t,r){return t&&UX(e.prototype,t),r&&UX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cs(e,t,r){return t=The(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function The(e){var t=Jrt(e,"string");return v_(t)==="symbol"?t:String(t)}function Jrt(e,t){if(v_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(v_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UW=function(){function e(t,r){qrt(this,e),cs(this,"wtTable",void 0),cs(this,"wtScroll",void 0),cs(this,"wtViewport",void 0),cs(this,"wtOverlays",void 0),cs(this,"selections",void 0),cs(this,"wtEvent",void 0),cs(this,"guid","wt_".concat(xW())),cs(this,"drawInterrupted",!1),cs(this,"drawn",!1),cs(this,"domBindings",void 0),cs(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Xrt(this.createScrollDao())}return Zrt(e,[{key:"eventManager",get:function(){return new bn(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(a,o){Oc(o,r[a])}])}}},{key:"createCellCoords",value:function(r,n){return new ZE(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new HW(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),a=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<a&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<a)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,a,o){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Dg(e){return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dg(e)}function jX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ohe(n.key),n)}}function Qrt(e,t,r){return t&&jX(e.prototype,t),r&&jX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ent(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZL(e,t)}function ZL(e,t){return ZL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ZL(e,t)}function rnt(e){var t=int();return function(){var n=sR(e),i;if(t){var a=sR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nnt(this,i)}}function nnt(e,t){if(t&&(Dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xO(e)}function xO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function int(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sR(e){return sR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sR(e)}function zX(e,t,r){return t=Ohe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ohe(e){var t=ant(e,"string");return Dg(t)==="symbol"?t:String(t)}function ant(e,t){if(Dg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ont=function(e){tnt(r,e);var t=rnt(r);function r(n,i,a){var o;ent(this,r),o=t.call(this,n,i),zX(xO(o),"cloneSource",void 0),zX(xO(o),"cloneOverlay",void 0);var s=o.wtSettings.getSetting("facade",xO(o));return o.cloneSource=a.source,o.cloneOverlay=a.overlay,o.wtTable=o.cloneOverlay.createTable(o.getTableDao(),s,o.domBindings,o.wtSettings),o.wtViewport=a.viewport,o.selections=a.selections,o.wtEvent=new ghe(s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections,a.event),o.findOriginalHeaders(),o}return Qrt(r)}(UW);function p_(e){return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p_(e)}function snt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ehe(n.key),n)}}function lnt(e,t,r){return t&&GX(e.prototype,t),r&&GX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function unt(e,t,r){return t=Ehe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ehe(e){var t=fnt(e,"string");return p_(t)==="symbol"?t:String(t)}function fnt(e,t){if(p_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B1=function(){function e(t,r,n,i,a){snt(this,e),unt(this,"wtSettings",null),El(this,"wot",t,{writable:!1}),this.domBindings=a,this.facadeGetter=r,this.wtSettings=i;var o=this.wot.wtTable,s=o.TABLE,l=o.hider,u=o.spreader,f=o.holder,c=o.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=xg(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return lnt(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=xg(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=zw(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){Kr("The provided element is not a child of the ".concat(this.type," overlay"));return}var a=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return a?h=this.getRelativeCellPositionWithinWindow(s,o,c,f):h=this.getRelativeCellPositionWithinHolder(s,l,o,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,a){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=a.start;else{var u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+hi())),s=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();l=f.top-o.top}else l=a.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,a,o){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-o.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=s.vertical-o.top);return{start:a.start-l,top:a.top-u}}},{key:"makeClone",value:function(){if(Urt.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;o.className="".concat(jrt.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,s.className=r.TABLE.className,o.appendChild(s),l.appendChild(o);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Dd||u==="vertical"&&this.type===$d?this.mainTableScrollableElement=a:a.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=zw(r.TABLE),new ont(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,a=n.style,o=r.parentNode.style;ve([i,a,o],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function $g(e){return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$g(e)}function TO(e,t,r){return Rhe()?TO=Reflect.construct.bind():TO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&lR(u,o.prototype),u},TO.apply(null,arguments)}function cnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dnt(n.key),n)}}function hnt(e,t,r){return t&&YX(e.prototype,t),r&&YX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dnt(e){var t=vnt(e,"string");return $g(t)==="symbol"?t:String(t)}function vnt(e,t){if($g(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lR(e,t)}function gnt(e){var t=Rhe();return function(){var n=uR(e),i;if(t){var a=uR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ynt(this,i)}}function ynt(e,t){if(t&&($g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mnt(e)}function mnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uR(e){return uR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uR(e)}var bnt=function(e){pnt(r,e);var t=gnt(r);function r(n,i,a,o,s,l){var u;return cnt(this,r),u=t.call(this,n,i,oc,a,o),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return hnt(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return TO(Vrt,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var a=this.clone.wtTable.holder.parentNode;if(a.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();a.style[this.isRtl()?"right":"left"]="".concat(o,"px"),a.style.bottom="".concat(s,"px")}else M1(a),this.repositionOverlay();var l=mn(this.clone.wtTable.TABLE),u=jr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),a.style.height="".concat(l,"px"),a.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=hi(s)),l.style.bottom="".concat(u,"px")}}]),r}(B1),wnt="calculatedColumns",khe={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};El(khe,"MIXIN_NAME",wnt,{writable:!1,enumerable:!1});const jW=khe;function Ng(e){return Ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ng(e)}function KX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Snt(n.key),n)}}function _nt(e,t,r){return t&&KX(e.prototype,t),r&&KX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Snt(e){var t=Cnt(e,"string");return Ng(t)==="symbol"?t:String(t)}function Cnt(e,t){if(Ng(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ng(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JL(e,t)}function JL(e,t){return JL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JL(e,t)}function Ont(e){var t=knt();return function(){var n=fR(e),i;if(t){var a=fR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ent(this,i)}}function Ent(e,t){if(t&&(Ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rnt(e)}function Rnt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function knt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fR(e){return fR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fR(e)}var zW=function(e){Tnt(r,e);var t=Ont(r);function r(n,i,a,o){return xnt(this,r),t.call(this,n,i,a,o,hl)}return _nt(r)}(jm);qr(zW,She);qr(zW,jW);const Ant=zW;function Lg(e){return Lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lg(e)}function OO(e,t,r){return Phe()?OO=Reflect.construct.bind():OO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&cR(u,o.prototype),u},OO.apply(null,arguments)}function Pnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ihe(n.key),n)}}function Int(e,t,r){return t&&XX(e.prototype,t),r&&XX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}function cR(e,t){return cR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cR(e,t)}function Dnt(e){var t=Phe();return function(){var n=hR(e),i;if(t){var a=hR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return $nt(this,i)}}function $nt(e,t){if(t&&(Lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ahe(e)}function Ahe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Phe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hR(e){return hR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hR(e)}function Nnt(e,t,r){return t=Ihe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ihe(e){var t=Lnt(e,"string");return Lg(t)==="symbol"?t:String(t)}function Lnt(e,t){if(Lg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fnt=function(e){Mnt(r,e);var t=Dnt(r);function r(n,i,a,o){var s;return Pnt(this,r),s=t.call(this,n,i,hl,a,o),Nnt(Ahe(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return Int(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return OO(Ant,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode;a.style.top="";var o=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(o=this.getOverlayOffset(),a.style.bottom="".concat(o,"px")):(o=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=hi(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a?(a.scrollTo(Md(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wot,s=o.wtTable,l=o.wtSettings,u=l.getSetting("defaultRowHeight"),f=i,c=0;f<a;){var h=s.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,f=hi(l),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=o.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,a.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var g=mn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(g=0),h.height="".concat(g,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;a&&l.offsetHeight!==l.clientHeight&&(u=hi(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return jw(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,f=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+s,0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==a,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((o||a===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,f=Wt(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(Ge(u,"innerBorderBottom"),l=!f):(Vt(u,"innerBorderBottom"),l=f)}return l}}]),r}(B1),Hnt="calculatedRows",Mhe={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};El(Mhe,"MIXIN_NAME",Hnt,{writable:!1,enumerable:!1});const Dhe=Mhe;function Fg(e){return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fg(e)}function qX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wnt(n.key),n)}}function Bnt(e,t,r){return t&&qX(e.prototype,t),r&&qX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wnt(e){var t=Vnt(e,"string");return Fg(t)==="symbol"?t:String(t)}function Vnt(e,t){if(Fg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Unt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QL(e,t)}function QL(e,t){return QL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QL(e,t)}function znt(e){var t=Knt();return function(){var n=dR(e),i;if(t){var a=dR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Gnt(this,i)}}function Gnt(e,t){if(t&&(Fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ynt(e)}function Ynt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Knt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dR(e){return dR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dR(e)}var GW=function(e){jnt(r,e);var t=znt(r);function r(n,i,a,o){return Unt(this,r),t.call(this,n,i,a,o,$d)}return Bnt(r)}(jm);qr(GW,Dhe);qr(GW,WW);const Xnt=GW;function Hg(e){return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hg(e)}function EO(e,t,r){return $he()?EO=Reflect.construct.bind():EO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&vR(u,o.prototype),u},EO.apply(null,arguments)}function qnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jnt(n.key),n)}}function Znt(e,t,r){return t&&ZX(e.prototype,t),r&&ZX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jnt(e){var t=Qnt(e,"string");return Hg(t)==="symbol"?t:String(t)}function Qnt(e,t){if(Hg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vR(e,t)}function vR(e,t){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vR(e,t)}function tit(e){var t=$he();return function(){var n=pR(e),i;if(t){var a=pR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rit(this,i)}}function rit(e,t){if(t&&(Hg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nit(e)}function nit(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $he(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pR(e){return pR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pR(e)}var iit=function(e){eit(r,e);var t=tit(r);function r(n,i,a,o){return qnt(this,r),t.call(this,n,i,$d,a,o)}return Znt(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return EO(Xnt,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var a=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===a&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),SA(o,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),M1(o));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===a&&a.scrollX!==i?(a.scrollTo(i,Cg(a)),o=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<a;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||o,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=hi(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=jr(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,a.style.height=a.parentNode.style.height,a.style.width="".concat(parseInt(a.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),a=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[a]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[a]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(a){var f=this.wot.wtTable.getColumnWidth(i),c=this.wot.wtViewport.getViewportWidth();f>c&&(a=!1)}return a&&l.offsetWidth!==l.clientWidth&&(u=hi(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),a=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(a=this.wot.wtTable.holderOffset.left),a}},{key:"getScrollPosition",value:function(){return Math.abs(GE(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="horizontal")){this.isRtl()?o=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?Vt(a,"emptyRows"):Ge(a,"emptyRows");var u=!1;if(s&&!o.length)Ge(a,"innerBorderLeft innerBorderInlineStart");else if(!s&&o.length){var f=Wt(a,"innerBorderInlineStart");i?(Ge(a,"innerBorderLeft innerBorderInlineStart"),u=!f):(Vt(a,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(B1),ait="stickyRowsTop",Nhe={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};El(Nhe,"MIXIN_NAME",ait,{writable:!1,enumerable:!1});const Lhe=Nhe;function Bg(e){return Bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bg(e)}function JX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sit(n.key),n)}}function oit(e,t,r){return t&&JX(e.prototype,t),r&&JX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sit(e){var t=lit(e,"string");return Bg(t)==="symbol"?t:String(t)}function lit(e,t){if(Bg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eF(e,t)}function eF(e,t){return eF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eF(e,t)}function cit(e){var t=vit();return function(){var n=gR(e),i;if(t){var a=gR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return hit(this,i)}}function hit(e,t){if(t&&(Bg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dit(e)}function dit(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gR(e){return gR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gR(e)}var YW=function(e){fit(r,e);var t=cit(r);function r(n,i,a,o){return uit(this,r),t.call(this,n,i,a,o,Nd)}return oit(r)}(jm);qr(YW,Lhe);qr(YW,WW);const pit=YW;function Wg(e){return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wg(e)}function RO(e,t,r){return Fhe()?RO=Reflect.construct.bind():RO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&yR(u,o.prototype),u},RO.apply(null,arguments)}function git(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hhe(n.key),n)}}function yit(e,t,r){return t&&QX(e.prototype,t),r&&QX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yR(e,t)}function yR(e,t){return yR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yR(e,t)}function bit(e){var t=Fhe();return function(){var n=mR(e),i;if(t){var a=mR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return wit(this,i)}}function wit(e,t){if(t&&(Wg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tF(e)}function tF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mR(e){return mR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mR(e)}function eq(e,t,r){return t=Hhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hhe(e){var t=_it(e,"string");return Wg(t)==="symbol"?t:String(t)}function _it(e,t){if(Wg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sit=function(e){mit(r,e);var t=bit(r);function r(n,i,a,o,s,l){var u;return git(this,r),u=t.call(this,n,i,Nd,a,o),eq(tF(u),"topOverlay",void 0),eq(tF(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return yit(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return RO(pit,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();SA(i,"".concat(a,"px"),"".concat(o,"px"))}else M1(i);var s=mn(this.clone.wtTable.TABLE),l=jr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}(B1);function Vg(e){return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vg(e)}function tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xit(n.key),n)}}function Cit(e,t,r){return t&&tq(e.prototype,t),r&&tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xit(e){var t=Tit(e,"string");return Vg(t)==="symbol"?t:String(t)}function Tit(e,t){if(Vg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rF(e,t)}function rF(e,t){return rF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rF(e,t)}function Rit(e){var t=Pit();return function(){var n=bR(e),i;if(t){var a=bR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return kit(this,i)}}function kit(e,t){if(t&&(Vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ait(e)}function Ait(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bR(e){return bR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bR(e)}var KW=function(e){Eit(r,e);var t=Rit(r);function r(n,i,a,o){return Oit(this,r),t.call(this,n,i,a,o,Dd)}return Cit(r)}(jm);qr(KW,Lhe);qr(KW,jW);const Iit=KW;function Ug(e){return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ug(e)}function kO(e,t,r){return Whe()?kO=Reflect.construct.bind():kO=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&wR(u,o.prototype),u},kO.apply(null,arguments)}function Mit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vhe(n.key),n)}}function Dit(e,t,r){return t&&rq(e.prototype,t),r&&rq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $it(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wR(e,t)}function wR(e,t){return wR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wR(e,t)}function Nit(e){var t=Whe();return function(){var n=_R(e),i;if(t){var a=_R(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Lit(this,i)}}function Lit(e,t){if(t&&(Ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bhe(e)}function Bhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Whe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _R(e){return _R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_R(e)}function Fit(e,t,r){return t=Vhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vhe(e){var t=Hit(e,"string");return Ug(t)==="symbol"?t:String(t)}function Hit(e,t){if(Ug(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bit=function(e){$it(r,e);var t=Nit(r);function r(n,i,a,o){var s;return Mit(this,r),s=t.call(this,n,i,Dd,a,o),Fit(Bhe(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return Dit(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return kO(Iit,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,a=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===a&&(!o||o!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=i.offsetHeight;l=c===h,s=this.getOverlayOffset(),SA(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),M1(i);var d=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a&&a.scrollY!==i?(a.scrollTo(Md(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<a;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?o:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=hi(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=mn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,a.style.width=a.parentNode.style.width,a.style.height="".concat(parseInt(a.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.wot,s=this.wtSettings,l=o.cloneSource?o.cloneSource:o,u=l.wtTable.holder,f=this.getTableParentOffset(),c=0;if(a){var h=this.wot.wtTable.getRowHeight(i),d=this.wot.wtViewport.getViewportHeight();h>d&&(a=!1)}if(a&&u.offsetHeight!==u.clientHeight&&(c=hi(this.domBindings.rootDocument)),a){var v=s.getSetting("fixedRowsBottom"),g=s.getSetting("totalRows");f+=this.sumCellSizes(0,i+1),f-=o.wtViewport.getViewportHeight()-this.sumCellSizes(g-v,g),f+=1}else f+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return jw(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?Vt(o,"emptyColumns"):Ge(o,"emptyColumns");var l=!1;if(!a){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=Wt(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(Ge(o,"innerBorderTop"),l=!h):(Vt(o,"innerBorderTop"),l=h)}}return l}}]),r}(B1);function g_(e){return g_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g_(e)}function Bf(e,t,r){return Wit()?Bf=Reflect.construct.bind():Bf=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&nF(u,o.prototype),u},Bf.apply(null,arguments)}function Wit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nF(e,t){return nF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nF(e,t)}function Vit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uhe(n.key),n)}}function Uit(e,t,r){return t&&nq(e.prototype,t),r&&nq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zl(e,t,r){return t=Uhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uhe(e){var t=jit(e,"string");return g_(t)==="symbol"?t:String(t)}function jit(e,t){if(g_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(g_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zit=function(){function e(t,r,n,i,a,o){var s=this;Vit(this,e),zl(this,"wot",null),zl(this,"topOverlay",null),zl(this,"bottomOverlay",null),zl(this,"inlineStartOverlay",null),zl(this,"topInlineStartCornerOverlay",null),zl(this,"bottomInlineStartCornerOverlay",null),zl(this,"browserLineHeight",void 0),zl(this,"wtSettings",null),zl(this,"resizeObserver",new ResizeObserver(function(h){sA(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;var l=this.domBindings,u=l.rootDocument,f=l.rootWindow;this.instance=this.wot,this.eventManager=a,this.scrollbarSize=hi(u);var c=f.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:zw(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return Uit(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,a=n.getComputedStyle(i.body),o=parseInt(a.lineHeight,10),s=parseInt(a.fontSize,10)*1.2;this.browserLineHeight=o||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Bf(Bit,r),this.bottomOverlay=Bf(Fnt,r),this.inlineStartOverlay=Bf(iit,r),this.topInlineStartCornerOverlay=Bf(Sit,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Bf(bnt,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),o!==s&&this.eventManager.addEventListener(s,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var l=a.devicePixelRatio&&a.devicePixelRatio>1,u=this.scrollableElement===a,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||l||!tW())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var g=v.clone.wtTable.holder;r.eventManager.addEventListener(g,"wheel",function(y){return r.onCloneWheel(y,f)},c)}});var d;this.eventManager.addEventListener(a,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,o=r.target;this.keyPressed&&(a!==n&&o!==n&&!r.target.contains(a)||i!==n&&o!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,a=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=r.target,l=o!==i&&s!==i&&!s.contains(o),u=a!==i&&s!==i&&!s.contains(a);if(!(this.keyPressed&&(l||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Og(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var a=this.scrollVertically(n),o=this.scrollHorizontally(i);return a||o}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,a=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=a[0],s=a[1];if(this.horizontalScrolling=n.scrollLeft!==o||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=o;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=o)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=zw(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,a=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return a&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),a}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,a=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,a),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var f=i.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=i.holder,v=d.scrollHeight,g=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<g,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return ve(n,function(a){a&&a.clone&&a.clone.wtTable.TABLE.contains(r)&&(i=a.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];ve(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const Git=zit;function y_(e){return y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y_(e)}function Yit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jhe(n.key),n)}}function Kit(e,t,r){return t&&iq(e.prototype,t),r&&iq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aq(e,t,r){return t=jhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jhe(e){var t=Xit(e,"string");return y_(t)==="symbol"?t:String(t)}function Xit(e,t){if(y_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(y_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qit=function(){function e(t){var r=this;Yit(this,e),aq(this,"settings",{}),aq(this,"defaults",Object.freeze(this.getDefaults())),nr(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return Kit(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,a,o){var s=r.getSetting("data",i,a);Oc(o,s??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?nr(r,function(a,o){i.settings[o]=a}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,a,o){return typeof this.settings[r]=="function"?this.settings[r](n,i,a,o):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function jg(e){return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jg(e)}function Zit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qit(n.key),n)}}function Jit(e,t,r){return t&&oq(e.prototype,t),r&&oq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qit(e){var t=eat(e,"string");return jg(t)==="symbol"?t:String(t)}function eat(e,t){if(jg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iF(e,t)}function iF(e,t){return iF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iF(e,t)}function rat(e){var t=aat();return function(){var n=SR(e),i;if(t){var a=SR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nat(this,i)}}function nat(e,t){if(t&&(jg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iat(e)}function iat(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function SR(e){return SR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SR(e)}var XW=function(e){tat(r,e);var t=rat(r);function r(n,i,a,o){return Zit(this,r),t.call(this,n,i,a,o,"master")}return Jit(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=xg(this.wtRootElement),a=this.domBindings.rootWindow;if(i===a){var o=this.wtSettings.getSetting("preventOverflow");o||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=Tg(i,"height",a),u=Tg(i,"overflow",a),f=this.holder.style,c=i.scrollWidth,h=i.scrollHeight,d=i.getBoundingClientRect(),v=d.width,g=d.height,y=["auto","hidden","scroll"];if(s&&y.includes(u)){var b=i.cloneNode(!1);b.style.overflow="auto",b.style.position="absolute",i.nextElementSibling?s.insertBefore(b,i.nextElementSibling):s.appendChild(b);var w=parseInt(Ec(b,a).height,10);s.removeChild(b),w===0&&(g=0)}g=Math.min(g,h),f.height=l==="auto"?"auto":"".concat(g,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:g>0,this.hasTableWidth=v>0}this.isTableVisible=Sg(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,a=this.dataAccessObject.wtViewport,o="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!a.hasOversizedColumnHeadersMarked[o]){for(var u=i.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<l;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);a.hasOversizedColumnHeadersMarked[o]=!0}}}]),r}(jm);qr(XW,Dhe);qr(XW,jW);const oat=XW;function m_(e){return m_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m_(e)}function sat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uat(n.key),n)}}function lat(e,t,r){return t&&sq(e.prototype,t),r&&sq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uat(e){var t=fat(e,"string");return m_(t)==="symbol"?t:String(t)}function fat(e,t){if(m_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(m_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cat=function(){function e(t,r,n,i,a){var o=this;sat(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=a,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){o.clientHeight=o.getWorkspaceHeight()})}return lat(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var a=mn(n);i=a>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-s:c.left,d=s-h,v,g;if(u)return jr(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,s):v=Math.min(this.getContainerFillWidth(),d,s),o===a&&l>0&&this.sumColumnWidths(0,l-1)>v)return i.documentElement.clientWidth;if(o!==a&&(g=Tg(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",a),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(v,o.clientWidth);var y=r.getSetting("stretchH");return y==="none"||!y?Math.max(v,jr(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,a=r;a<n;)i+=this.wtTable.getColumnWidth(a),a+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return jn(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=mn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,a=n.length;i<a;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)o?(this.rowHeaderWidth+=jr(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lh,n=this.wtSettings,i=this.wtTable,a,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Lh?a=1/0:a=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,a-=s),f&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),a-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=hi(this.domBindings.rootDocument),new ohe({viewportSize:a,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return i.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:o})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lh,n=this.wtSettings,i=this.wtTable,a=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&o>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=l,a-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(a-=hi(this.domBindings.rootDocument)),new FW({viewportSize:a,scrollOffset:o,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return i.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator($i),a=this.createColumnsCalculator($i);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(a)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Lh),this.columnsRenderCalculator=this.createColumnsCalculator(Lh)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator($i),this.columnsVisibleCalculator=this.createColumnsCalculator($i)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.rowsRenderCalculator,s=o.startRow,l=o.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.columnsRenderCalculator,s=o.startColumn,l=o.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){nr(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const hat=cat;function zg(e){return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zg(e)}function dat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pat(n.key),n)}}function vat(e,t,r){return t&&lq(e.prototype,t),r&&lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pat(e){var t=gat(e,"string");return zg(t)==="symbol"?t:String(t)}function gat(e,t){if(zg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aF(e,t)}function aF(e,t){return aF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aF(e,t)}function mat(e){var t=wat();return function(){var n=CR(e),i;if(t){var a=CR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return bat(this,i)}}function bat(e,t){if(t&&(zg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oF(e)}function oF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function CR(e){return CR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},CR(e)}var _at=function(e){yat(r,e);var t=mat(r);function r(n,i){var a;dat(this,r),a=t.call(this,n,new qit(i));var o=a.wtSettings.getSetting("facade",oF(a));return a.wtTable=new oat(a.getTableDao(),o,a.domBindings,a.wtSettings),a.wtViewport=new hat(a.getViewportDao(),a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.selections=a.wtSettings.getSetting("selections"),a.wtEvent=new ghe(o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections),a.wtOverlays=new Git(oF(a),o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.exportSettingsAsClassNames(),a.findOriginalHeaders(),a}return vat(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,a={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},o=[],s=[];nr(a,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),o.push(l)}),Vt(this.wtTable.wtRootElement.parentNode,o),Ge(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(UW);function b_(e){return b_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b_(e)}function Sat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xat(n.key),n)}}function Cat(e,t,r){return t&&uq(e.prototype,t),r&&uq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xat(e){var t=Tat(e,"string");return b_(t)==="symbol"?t:String(t)}function Tat(e,t){if(b_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(b_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oat=function(){function e(t){Sat(this,e),t instanceof UW?this._wot=t:this._initFromSettings(t)}return Cat(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new _at(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wot.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,a,o){return this._wot.wtSettings.getSetting(r,n,i,a,o)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),Eat=Gn,zhe=ir,Rat=g1,kat=co,Aat=o1.f,Pat=zhe(Aat),Iat=zhe([].push),fq=function(e){return function(t){for(var r=kat(t),n=Rat(r),i=n.length,a=0,o=[],s;i>a;)s=n[a++],(!Eat||Pat(r,s))&&Iat(o,e?[s,r[s]]:r[s]);return o}},Mat={entries:fq(!0),values:fq(!1)},Dat=Nt,$at=Mat.values;Dat({target:"Object",stat:!0},{values:function(t){return $at(t)}});function w_(e){return w_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w_(e)}function X2(e,t){return Hat(e)||Fat(e,t)||Lat(e,t)||Nat()}function Nat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lat(e,t){if(e){if(typeof e=="string")return cq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cq(e,t)}}function cq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fat(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Hat(e){if(Array.isArray(e))return e}function Bat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vat(n.key),n)}}function Wat(e,t,r){return t&&hq(e.prototype,t),r&&hq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vat(e){var t=Uat(e,"string");return w_(t)==="symbol"?t:String(t)}function Uat(e,t){if(w_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(w_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jat=function(){function e(t,r){Bat(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Wat(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[l])})},a=0,o=this.main.childNodes.length;a<o;a++)i(a)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),Ns(r);var i=this,a=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(a,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(a,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],a=this.main.style;a.position="absolute",a.top=0,a.left=0;for(var o=0;o<5;o++){var s=i[o],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),a=l.style,a.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,a.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),a.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Es()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,a=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(a,"px"),width:"".concat(a,"px"),"border-radius":"".concat(parseInt(a/1.5,10),"px")};nr(o,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};nr(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,a,o,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,g=parseInt(c.borderWidth,10),y=parseInt(c.width,10),b=parseInt(h.width,10),w=this.wot.wtTable.getWidth(),_=this.wot.wtTable.getHeight();c.top="".concat(parseInt(i-y-1,10),"px"),c[u]="".concat(parseInt(a-y-1,10),"px"),h.top="".concat(parseInt(i-b/4*3,10),"px"),h[u]="".concat(parseInt(a-b/4*3,10),"px");var x=Math.min(parseInt(a+o,10),w-y-g*2),E=Math.min(parseInt(a+o-b/4,10),w-b-g*2);d[u]="".concat(x,"px"),v[u]="".concat(E,"px");var R=Math.min(parseInt(i+s,10),_-y-g*2),A=Math.min(parseInt(i+s-b/4,10),_-b-g*2);d.top="".concat(R,"px"),v.top="".concat(A,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,a=n.rootDocument,o=n.rootWindow,s,l,u,f,c,h,d=i.getRenderedRowsCount(),v=0;v<d;v+=1){var g=i.rowFilter.renderedToSource(v);if(g>=r[0]&&g<=r[2]){s=g,c=r[0];break}}for(var y=d-1;y>=0;y-=1){var b=i.rowFilter.renderedToSource(y);if(b>=r[0]&&b<=r[2]){l=b;break}}for(var w=i.getRenderedColumnsCount(),_=0;_<w;_+=1){var x=i.columnFilter.renderedToSource(_);if(x>=r[1]&&x<=r[3]){u=x,h=r[1];break}}for(var E=w-1;E>=0;E-=1){var R=i.columnFilter.renderedToSource(E);if(R>=r[1]&&R<=r[3]){f=R;break}}if(s===void 0||u===void 0){this.disappear();return}var A=i.getCell(this.wot.createCellCoords(s,u)),N=s!==l||u!==f,I=N?i.getCell(this.wot.createCellCoords(l,f)):A,F=jn(A),H=N?jn(I):F,W=jn(i.TABLE),z=jr(i.TABLE),te=F.top,ie=F.left,fe=this.wot.wtSettings.getSetting("rtlMode"),Te=0,M=0;if(fe){var S=jr(A),T=o.innerWidth-W.left-z;M=ie+S-H.left,Te=o.innerWidth-ie-S-T-1}else M=H.left+jr(I)-ie,Te=ie-W.left-1;if(this.isEntireColumnSelected(s,l)){var k=this.getDimensionsFromHeader("columns",u,f,c,W),O=null;if(k){var D=X2(k,3);O=D[0],Te=D[1],M=D[2]}O&&(A=O)}var L=te-W.top-1,B=H.top+mn(I)-te;if(this.isEntireRowSelected(u,f)){var Y=this.getDimensionsFromHeader("rows",s,l,h,W),Q=null;if(Y){var he=X2(Y,3);Q=he[0],L=he[1],B=he[2]}Q&&(A=Q)}var ce=Ec(A,o);parseInt(ce.borderTopWidth,10)>0&&(L+=1,B=B>0?B-1:0),parseInt(ce[fe?"borderRightWidth":"borderLeftWidth"],10)>0&&(Te+=1,M=M>0?M-1:0);var le=fe?"right":"left";this.topStyle.top="".concat(L,"px"),this.topStyle[le]="".concat(Te,"px"),this.topStyle.width="".concat(M,"px"),this.topStyle.display="block",this.startStyle.top="".concat(L,"px"),this.startStyle[le]="".concat(Te,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var xe=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(L+B-xe,"px"),this.bottomStyle[le]="".concat(Te,"px"),this.bottomStyle.width="".concat(M,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(L,"px"),this.endStyle[le]="".concat(Te+M-xe,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var U=this.settings.border.cornerVisible;U=typeof U=="function"?U(this.settings.layerLevel):U;var De=this.wot.getSetting("onModifyGetCellCoords",l,f),de=l,He=f;if(De&&Array.isArray(De)){var Be=X2(De,4);de=Be[2],He=Be[3]}if(Es()||!U||this.isPartRange(de,He))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(L+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[le]="".concat(Te+M+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Ae=xg(i.TABLE),Ke=Ae===o;Ke&&(Ae=a.documentElement);var Xe=parseInt(this.cornerDefaultStyle.width,10)/2,G=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var q=Ke?I.getBoundingClientRect().left:I.offsetLeft,ae=!1,be=0;fe?(be=q-parseInt(this.cornerDefaultStyle.width,10)/2,ae=be<0):(be=q+jr(I)+parseInt(this.cornerDefaultStyle.width,10)/2,ae=be>=Qb(Ae)),ae&&(this.cornerStyle[le]="".concat(Math.floor(Te+M+this.cornerCenterPointOffset-Xe),"px"),this.cornerStyle[fe?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var se=Ke?I.getBoundingClientRect().top:I.offsetTop,Oe=se+mn(I)+parseInt(this.cornerDefaultStyle.height,10)/2,pe=Oe>=lu(Ae);pe&&(this.cornerStyle.top="".concat(Math.floor(L+B+this.cornerCenterPointOffset-G),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Es()&&this.updateMultipleSelectionHandlesPosition(l,f,L,Te,M,B)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,a,o){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,g=null,y=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},f=function(){return mn.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},f=function(){return jr.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(l.classList.contains(c)){var b=this.wot.getSetting("columnHeaders").length;if(g=u(n,b-a),y=u(i,b-a),!g||!y)return!1;var w=jn(g),_=jn(y);return g&&y&&(h=w[v]-o[v]-1,d=_[v]+f(y)-w[v]),[g,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,a=n[r];!a||a.hide?Ge(this[r],"hidden"):(Wt(this[r],"hidden")&&Vt(this[r],"hidden"),i.backgroundColor=a.color,(r==="top"||r==="bottom")&&(i.height="".concat(a.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(a.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?Ge(this[r],"hidden"):Vt(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Es()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const zat=jat;function Gat(e,t){return qat(e)||Xat(e,t)||Kat(e,t)||Yat()}function Yat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kat(e,t){if(e){if(typeof e=="string")return dq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dq(e,t)}}function dq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xat(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function qat(e){if(Array.isArray(e))return e}function Gg(e){return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gg(e)}function Zat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qat(n.key),n)}}function Jat(e,t,r){return t&&vq(e.prototype,t),r&&vq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qat(e){var t=eot(e,"string");return Gg(t)==="symbol"?t:String(t)}function eot(e,t){if(Gg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tot=function(){function e(t,r){Zat(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Jat(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new zat(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(Gg(s)==="object"){var l=a;o&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),Ge(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||o===0)return r;var s=o>=0?o:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(Wt(a,u)){var f=s+1;l="".concat(r,"-").concat(f)}else l=i(a,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),a=this.getCorners(),o=Gat(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,g=c.highlightOnlyClosestHeader,y=c.selectionType,b=y===void 0||["active-header","header"].includes(y);if(b&&l!==null&&f!==null)for(var w=0,_=0;_<i;_+=1){var x=r.wtTable.columnFilter.renderedToSource(_);if(x>=l&&x<=f){var E=r.wtTable.getColumnHeaders(x),R=E.length-1;g&&E.length>1&&(E=[E[R]]);for(var A=0;A<E.length;A+=1){var N=[],I=E[A];h&&N.push(h),d&&N.push(d),A=g?R:A;var F=r.getSetting("onBeforeHighlightingColumnHeader",x,A,{selectionType:y,columnCursor:w,selectionWidth:f-l+1,classNames:N});F!==x&&(I=r.wtTable.getColumnHeader(F,A)),Ge(I,N)}w+=1}}if(s!==null&&u!==null)for(var H=0,W=0;W<n;W+=1){var z=r.wtTable.rowFilter.renderedToSource(W);if(b&&z>=s&&z<=u){var te=r.wtTable.getRowHeaders(z),ie=te.length-1;g&&te.length>1&&(te=[te[ie]]);for(var fe=0;fe<te.length;fe+=1){var Te=[],M=te[fe];h&&Te.push(h),v&&Te.push(v),fe=g?ie:fe;var S=r.getSetting("onBeforeHighlightingRowHeader",z,fe,{selectionType:y,rowCursor:H,selectionHeight:u-s+1,classNames:Te});S!==z&&(M=r.wtTable.getRowHeader(S,fe)),Ge(M,Te)}H+=1}if(l!==null&&f!==null)for(var T=0;T<i;T+=1){var k=r.wtTable.columnFilter.renderedToSource(T);z>=s&&z<=u&&k>=l&&k<=f?this.settings.className&&this.addClassAtCoords(r,z,k,this.settings.className,this.settings.markIntersections):z>=s&&z<=u?v&&this.addClassAtCoords(r,z,k,v):k>=l&&k<=f&&d&&this.addClassAtCoords(r,z,k,d);var O=r.getSetting("onAfterDrawSelection",z,k,this.settings.layerLevel);typeof O=="string"&&this.addClassAtCoords(r,z,k,O)}}r.getSetting("onBeforeDrawBorders",a,this.settings.className),this.settings.border&&this.getBorder(r).appear(a)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const rot=tot;function pq(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,a=e.selection,o=e.controller,s=e.cellCoordsFactory,l=a.isSelected()?a.getSelectedRange().current():null,u=a.isSelectedByCorner(),f=a.isSelectedByRowHeader();if(t&&l)i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(i):(u||f)&&i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!o.column?a.setRangeEnd(s(l.to.row,i.col)):f&&i.col<0&&!o.row?a.setRangeEnd(s(i.row,l.to.col)):(!u&&!f&&i.col<0||u&&i.col<0)&&!o.row?a.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!f&&i.row<0||f&&i.row<0)&&!o.column&&a.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var c=!a.inInSelection(i),h=r||n&&c;i.row<0&&i.col>=0&&!o.column?h&&a.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?h&&a.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?h&&a.setRangeStart(i):i.col<0&&i.row<0&&a.selectAll(!0,!0)}}function not(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,a=e.cellCoordsFactory;if(t){var o=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(a(u-1,r.col)):o&&!i.row?n.setRangeEnd(a(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var iot=new Map([["mousedown",pq],["mouseover",not],["touchstart",pq]]);function gq(e,t){var r=t.coords,n=t.selection,i=t.controller,a=t.cellCoordsFactory;iot.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:a,isShiftKey:e.shiftKey,isLeftClick:xA(e)||e.type==="touchstart",isRightClick:Rc(e)})}var Ghe=new WeakMap,qW=Symbol("rootInstance");function aot(e){Ghe.set(e,!0)}function oot(e){return e===qW}function sF(e){return Ghe.has(e)}function __(e){return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__(e)}function X0(e,t){return uot(e)||lot(e,t)||Yhe(e,t)||sot()}function sot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lot(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function uot(e){if(Array.isArray(e))return e}function yq(e){return hot(e)||cot(e)||Yhe(e)||fot()}function fot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yhe(e,t){if(e){if(typeof e=="string")return lF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lF(e,t)}}function cot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hot(e){if(Array.isArray(e))return lF(e)}function lF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Khe(n.key),n)}}function vot(e,t,r){return t&&mq(e.prototype,t),r&&mq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bq(e,t,r){pot(e,t),t.set(e,r)}function pot(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tf(e,t,r){return t=Khe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Khe(e){var t=got(e,"string");return __(t)==="symbol"?t:String(t)}function got(e,t){if(__(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(__(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wq(e,t){var r=Xhe(e,t,"get");return yot(e,r)}function yot(e,t){return t.get?t.get.call(e):t.value}function _q(e,t,r){var n=Xhe(e,t,"set");return mot(e,n,r),r}function Xhe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function mot(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Sh=new WeakMap,q2=new WeakMap,Z2=new WeakMap,bot=function(){function e(t){dot(this,e),Tf(this,"instance",void 0),Tf(this,"eventManager",void 0),Tf(this,"settings",void 0),Tf(this,"THEAD",void 0),Tf(this,"TBODY",void 0),Tf(this,"_wt",void 0),Tf(this,"activeWt",void 0),bq(this,q2,{writable:!0,value:0}),bq(this,Z2,{writable:!0,value:0}),Tf(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new bn(this.instance),this.settings=this.instance.getSettings(),Sh.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return vot(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wt.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=Sh.get(this),n=this.instance,i=n.rootElement,a=n.rootDocument,o=i.getAttribute("style");o&&i.setAttribute("data-originalstyle",o),Ge(i,"handsontable"),r.table=a.createElement("TABLE"),Ge(r.table,"htCore"),this.instance.getSettings().tableClassName&&Ge(r.table,this.instance.getSettings().tableClassName),this.THEAD=a.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=a.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Sh.get(this),i=this.instance,a=i.rootElement,o=i.rootDocument,s=i.selection,l=o.documentElement;this.eventManager.addEventListener(a,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;TL(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(a,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(a,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&TL(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&xA(u)&&s.finish(),n.mouseDown=!1,(CA(o.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!a.contains(u.target)&&!Rc(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&Rc(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!a||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var g=hi(o);if(o.elementFromPoint(c+g,h)!==v||o.elementFromPoint(c,h+g)!==v)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===a)return;d=d.parentNode}var y=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;y?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Gw(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,a=r.col;return(n=this.instance)._createCellCoords.apply(n,yq(this.translateFromRenderableToVisualIndex(i,a)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,a=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),a===null&&(a=n),[i,a]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),a=r.getNearestNotHiddenIndex(i-1,-1);return a===null?0:r.getRenderableFromVisualIndex(a)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,a){if(isNaN(r)||r<0)return 0;var o=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=a-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Sh.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return sF(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,yq(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),_q(r,Z2,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),_q(r,q2,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=X0(d,2),g=v[0],y=v[1],b=r.instance.runHooks("modifyGetCellCoords",g,y),w=g,_=y;if(Array.isArray(b)){var x=X0(b,2);w=x[0],_=x[1]}var E=r.instance.getCellMeta(w,_),R=r.instance.colToProp(_),A=r.instance.getDataAtRowProp(w,R);r.instance.hasHook("beforeValueRender")&&(A=r.instance.runHooks("beforeValueRender",A,E)),r.instance.runHooks("beforeRenderer",h,g,y,R,A,E),r.instance.getCellRenderer(E)(r.instance,h,g,y,R,A,E),r.instance.runHooks("afterRenderer",h,g,y,R,A,E)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,g),!Nh(f)&&(gq(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(b,w){return r.instance._createCellCoords(b,w)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!Nh(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!Nh(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),g={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,g),!Nh(f)&&(n.mouseDown&&gq(f,{coords:v,selection:r.instance.selection,controller:g,cellCoordsFactory:function(b,w){return r.instance._createCellCoords(b,w)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(Nh(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),g=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),g=X0(v,2),y=g[0],b=g[1],w=r.instance.selection.getSelectedRange(),_=w.size();if(_>0){var x=(h??0)+1-_,E=w.peekByIndex(x);d=[E.from.row,E.from.col,E.to.row,E.to.col]}return r.instance.runHooks("afterDrawSelection",y,b,d,h)},onBeforeDrawBorders:function(f,c){var h=X0(f,4),d=h[0],v=h[1],g=h[2],y=h[3],b=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(g),r.instance.columnIndexMapper.getVisualFromRenderableIndex(y)];return r.instance.runHooks("beforeDrawBorders",b,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,g=c>=0?v.getVisualFromRenderableIndex(c):c,y=f>=0?d.getVisualFromRenderableIndex(f):f,b=r.instance.runHooks("modifyGetCellCoords",y,g,h);if(Array.isArray(b)){var w=X0(b,4),_=w[0],x=w[1],E=w[2],R=w[3];return[_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,1)):_,x>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(x,1)):x,E>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(E,-1)):E,R>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(R,-1)):R]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var g=Math.ceil(v/h*12);f.startRow=Math.max(d-g,0),f.endRow=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var g=Math.ceil(v/h*6);f.startColumn=Math.max(d-g,0),f.endColumn=Math.min(v+g,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new Oat(i),this.activeWt=this._wt;var a=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),s=o.width,l=o.height;this.setLastSize(s,l),this.eventManager.addEventListener(a,"mousedown",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(a,"contextmenu",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Gw(r))return!0;var n=ac(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Sh.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!Wt(i,"relative")){$s(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var a=this.instance,o=a.rootDocument,s=a.getRowHeader,l=o.createElement("div"),u=o.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var o=n.firstChild;Wt(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),r,i,a):($s(n),this.appendColHeader(r,n,i,a))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,a),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,a)}},{key:"updateCellHeader",value:function(r,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(Wt(r,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Wt(r,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?sv(r,i(n,a)):(Oc(r,String.fromCharCode(160)),Ge(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=Sh.get(this),a=[r,n];i.lastWidth=a[0],i.lastHeight=a[1]}},{key:"getLastSize",value:function(){var r=Sh.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return wq(this,q2)}},{key:"getRowHeadersCount",value:function(){return wq(this,Z2)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const wot=bot;function uF(e){return uF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uF(e)}var qhe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",fF=qhe.length;function EA(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%fF,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/fF,10);return r}function _ot(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(fF,n)*(qhe.indexOf(e[r])+1);return t-=1,t}function Sot(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a=[];for(i=0;i<t;i++)a.push(EA(i)+(n+1));r.push(a)}return r}function Cot(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a={};for(i=0;i<t;i++)a["prop".concat(i)]=EA(i)+(n+1);r.push(a)}return r}function xot(e,t){for(var r=[],n,i=0;i<e;i++){n=[];for(var a=0;a<t;a++)n.push("");r.push(n)}return r}function cF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(i,a){Array.isArray(i)?i.forEach(function(o,s){n.push([a+t,s,o])}):Object.keys(i).forEach(function(o){n.push([a+t,o,i[o]])})}),n}function ZW(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&rr(e[0])&&(t=lA(e[0]))),t}function Zhe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function Jhe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return uF(t)==="object"&&!Array.isArray(t)&&t!==null}))}const Tot=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:ZW,createEmptySpreadsheetData:xot,createSpreadsheetData:Sot,createSpreadsheetObjectData:Cot,dataRowToChangesArray:cF,isArrayOfArrays:Zhe,isArrayOfObjects:Jhe,spreadsheetColumnIndex:_ot,spreadsheetColumnLabel:EA},Symbol.toStringTag,{value:"Module"}));function S_(e){return S_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S_(e)}function Oot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rot(n.key),n)}}function Eot(e,t,r){return t&&Sq(e.prototype,t),r&&Sq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rot(e){var t=kot(e,"string");return S_(t)==="symbol"?t:String(t)}function kot(e,t){if(S_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aot=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Oot(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Eot(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return ve(this.data,function(a,o){var s=n.getAtCell(o,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=a.getAtPhysicalCell(r,d,l)}):xt(n,i,function(h){u[h-n]=a.getAtPhysicalCell(r,h,l)});else if(rr(l)||Qr(l))if(o?u=[]:u={},!s||o){var f=0,c=this.countFirstRowKeys()-1;xt(f,c,function(h){var d=a.colToProp(h);if(h>=(n||f)&&h<=(i||c)&&!Number.isInteger(d)){var v=a.getAtPhysicalCell(r,d,l);o?u.push(v):vO(u,d,v)}})}else nr(l,function(h,d){vO(u,d,a.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var a=Id(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),a,"set"),a.isTouched()&&(i=a.value)}Number.isInteger(n)?this.data[r][n]=i:vO(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var a=null;if(i&&(typeof n=="string"?a=dfe(i,n):typeof n=="function"?a=n(i):a=i[n]),this.hot.hasHook("modifySourceData")){var o=Id(a);this.hot.runHooks("modifySourceData",r,this.colToProp(n),o,"get"),o.isTouched()&&(a=o.value)}return a}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=null,l=null,u=null,f=null;n===null||i===null?(o=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),f=Math.max(n.col,i.col));var c=[];return xt(s,u,function(h){c.push(o?r.getAtRow(h,void 0,void 0,a):r.getAtRow(h,l,f,a))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return ZW(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const Pot=Aot;var Cq=Rn,Iot=function(e){return e!==void 0&&(Cq(e,"value")||Cq(e,"writable"))},Mot=Nt,Dot=ri,$ot=Yn,Not=$n,Lot=Iot,Fot=Tl,Hot=Jk;function Qhe(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(Not(e)===r)return e[t];if(n=Fot.f(e,t),n)return Lot(n)?n.value:n.get===void 0?void 0:Dot(n.get,r);if($ot(i=Hot(e)))return Qhe(i,t,r)}Mot({target:"Reflect",stat:!0},{get:Qhe});var Bot=Nt,Wot=Kt,Vot=co,ede=Tl.f,tde=Gn,Uot=!tde||Wot(function(){ede(1)});Bot({target:"Object",stat:!0,forced:Uot,sham:!tde},{getOwnPropertyDescriptor:function(t,r){return ede(Vot(t),r)}});var jot="localHooks",rde={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,a,o,s){if(this._localHooks[t])for(var l=this._localHooks[t].length,u=0;u<l;u++)YE(this._localHooks[t][u],this,r,n,i,a,o,s)},clearLocalHooks:function(){return this._localHooks={},this}};El(rde,"MIXIN_NAME",jot,{writable:!1,enumerable:!1});const Va=rde;function C_(e){return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(e)}function zot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yot(n.key),n)}}function Got(e,t,r){return t&&xq(e.prototype,t),r&&xq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yot(e){var t=Kot(e,"string");return C_(t)==="symbol"?t:String(t)}function Kot(e,t){if(C_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(C_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lv=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;zot(this,e),this.indexedValues=[],this.initValueOrFn=t}return Got(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Qr(this.initValueOrFn)?xt(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):xt(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();qr(lv,Va);function J2(e){return Jot(e)||Zot(e)||qot(e)||Xot()}function Xot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qot(e,t){if(e){if(typeof e=="string")return hF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hF(e,t)}}function Zot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jot(e){if(Array.isArray(e))return hF(e)}function hF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JW(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(J2(e.slice(0,i)),J2(r.map(function(a,o){return Qr(n)?n(a,o):n})),J2(i===void 0?[]:e.slice(i)))}function QW(e,t){return lo(e,function(r,n){return t.includes(n)===!1})}function Yg(e){return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yg(e)}function Qot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tst(n.key),n)}}function est(e,t,r){return t&&Tq(e.prototype,t),r&&Tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tst(e){var t=rst(e,"string");return Yg(t)==="symbol"?t:String(t)}function rst(e,t){if(Yg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tw(){return typeof Reflect<"u"&&Reflect.get?tw=Reflect.get.bind():tw=function(t,r,n){var i=nst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},tw.apply(this,arguments)}function nst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ld(e),e!==null););return e}function ist(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dF(e,t)}function dF(e,t){return dF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dF(e,t)}function ast(e){var t=lst();return function(){var n=Ld(e),i;if(t){var a=Ld(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ost(this,i)}}function ost(e,t){if(t&&(Yg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sst(e)}function sst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ld(e){return Ld=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ld(e)}var $c=function(e){ist(r,e);var t=ast(r);function r(){return Qot(this,r),t.apply(this,arguments)}return est(r,[{key:"insert",value:function(i,a){this.indexedValues=JW(this.indexedValues,i,a,this.initValueOrFn),tw(Ld(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=QW(this.indexedValues,i),tw(Ld(r.prototype),"remove",this).call(this,i)}}]),r}(lv);function Kg(e){return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kg(e)}function ust(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cst(n.key),n)}}function fst(e,t,r){return t&&Oq(e.prototype,t),r&&Oq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cst(e){var t=hst(e,"string");return Kg(t)==="symbol"?t:String(t)}function hst(e,t){if(Kg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vF(e,t)}function vF(e,t){return vF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vF(e,t)}function vst(e){var t=yst();return function(){var n=xR(e),i;if(t){var a=xR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pst(this,i)}}function pst(e,t){if(t&&(Kg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gst(e)}function gst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xR(e){return xR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xR(e)}var RA=function(e){dst(r,e);var t=vst(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return ust(this,r),t.call(this,n)}return fst(r,[{key:"getHiddenIndexes",value:function(){return Nn(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}($c);function Q2(e){return _st(e)||wst(e)||bst(e)||mst()}function mst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bst(e,t){if(e){if(typeof e=="string")return pF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pF(e,t)}}function wst(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _st(e){if(Array.isArray(e))return pF(e)}function pF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eV(e,t,r){return[].concat(Q2(e.slice(0,t)),Q2(r),Q2(e.slice(t)))}function x_(e,t){return lo(e,function(r){return t.includes(r)===!1})}function tV(e,t){return tr(e,function(r){return r-t.filter(function(n){return n<r}).length})}function rV(e,t){var r=t[0],n=t.length;return tr(e,function(i){return i>=r?i+n:i})}function Xg(e){return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xg(e)}function Sst(e){return Ost(e)||Tst(e)||xst(e)||Cst()}function Cst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xst(e,t){if(e){if(typeof e=="string")return gF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gF(e,t)}}function Tst(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ost(e){if(Array.isArray(e))return gF(e)}function gF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Est(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ide(n.key),n)}}function Rst(e,t,r){return t&&Eq(e.prototype,t),r&&Eq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tu(){return typeof Reflect<"u"&&Reflect.get?tu=Reflect.get.bind():tu=function(t,r,n){var i=kst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},tu.apply(this,arguments)}function kst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cs(e),e!==null););return e}function Ast(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yF(e,t)}function yF(e,t){return yF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yF(e,t)}function Pst(e){var t=Mst();return function(){var n=Cs(e),i;if(t){var a=Cs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ist(this,i)}}function Ist(e,t){if(t&&(Xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nde(e)}function nde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cs(e){return Cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cs(e)}function Dst(e,t,r){return t=ide(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ide(e){var t=$st(e,"string");return Xg(t)==="symbol"?t:String(t)}function $st(e,t){if(Xg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kA=function(e){Ast(r,e);var t=Pst(r);function r(){var n;Est(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Dst(nde(n),"orderOfIndexes",[]),n}return Rst(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return i.indexedValues[a]})}},{key:"setValues",value:function(i){this.orderOfIndexes=Sst(Array(i.length).keys()),tu(Cs(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=a,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(o,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=x_(this.orderOfIndexes,[i]),Qr(this.initValueOrFn)?tu(Cs(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):tu(Cs(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,tu(Cs(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,a){this.indexedValues=JW(this.indexedValues,i,a,this.initValueOrFn),this.orderOfIndexes=rV(this.orderOfIndexes,a),tu(Cs(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=QW(this.indexedValues,i),this.orderOfIndexes=x_(this.orderOfIndexes,i),this.orderOfIndexes=tV(this.orderOfIndexes,i),tu(Cs(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return[a,i.getValueAtIndex(a)]})}}]),r}(lv);function qg(e){return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qg(e)}function Nst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fst(n.key),n)}}function Lst(e,t,r){return t&&Rq(e.prototype,t),r&&Rq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fst(e){var t=Hst(e,"string");return qg(t)==="symbol"?t:String(t)}function Hst(e,t){if(qg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mF(e,t)}function mF(e,t){return mF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mF(e,t)}function Wst(e){var t=jst();return function(){var n=TR(e),i;if(t){var a=TR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Vst(this,i)}}function Vst(e,t){if(t&&(qg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ust(e)}function Ust(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function TR(e){return TR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TR(e)}var W1=function(e){Bst(r,e);var t=Wst(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Nst(this,r),t.call(this,n)}return Lst(r,[{key:"getTrimmedIndexes",value:function(){return Nn(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}($c),kq=new Map([["indexesSequence",{getListWithInsertedItems:eV,getListWithRemovedItems:x_}],["physicallyIndexed",{getListWithInsertedItems:JW,getListWithRemovedItems:QW}]]),ade=function(t){if(kq.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return kq.get(t)};function Zg(e){return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zg(e)}function zst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yst(n.key),n)}}function Gst(e,t,r){return t&&Aq(e.prototype,t),r&&Aq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yst(e){var t=Kst(e,"string");return Zg(t)==="symbol"?t:String(t)}function Kst(e,t){if(Zg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rw(){return typeof Reflect<"u"&&Reflect.get?rw=Reflect.get.bind():rw=function(t,r,n){var i=Xst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},rw.apply(this,arguments)}function Xst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fd(e),e!==null););return e}function qst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bF(e,t)}function bF(e,t){return bF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bF(e,t)}function Zst(e){var t=elt();return function(){var n=Fd(e),i;if(t){var a=Fd(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Jst(this,i)}}function Jst(e,t){if(t&&(Zg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qst(e)}function Qst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function elt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fd(e){return Fd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fd(e)}var ode=function(e){qst(r,e);var t=Zst(r);function r(){return zst(this,r),t.call(this,function(n){return n})}return Gst(r,[{key:"insert",value:function(i,a){var o=rV(this.indexedValues,a);this.indexedValues=eV(o,i,a),rw(Fd(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=x_(this.indexedValues,i);this.indexedValues=tV(a,i),rw(Fd(r.prototype),"remove",this).call(this,i)}}]),r}(lv),Pq=new Map([["hiding",RA],["index",lv],["linkedPhysicalIndexToValue",kA],["physicalIndexToValue",$c],["trimming",W1]]);function tlt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Pq.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(Pq.get(e))(t)}function T_(e){return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T_(e)}function rlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Iq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ilt(n.key),n)}}function nlt(e,t,r){return t&&Iq(e.prototype,t),r&&Iq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ilt(e){var t=alt(e,"string");return T_(t)==="symbol"?t:String(t)}function alt(e,t){if(T_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wF=0,nV=function(){function e(){rlt(this,e),this.collection=new Map}return nlt(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}),wF+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);dt(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),wF-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return Yr(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();qr(nV,Va);function olt(){return wF}function Jg(e){return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jg(e)}function slt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ult(n.key),n)}}function llt(e,t,r){return t&&Mq(e.prototype,t),r&&Mq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ult(e){var t=flt(e,"string");return Jg(t)==="symbol"?t:String(t)}function flt(e,t){if(Jg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function clt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_F(e,t)}function _F(e,t){return _F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_F(e,t)}function hlt(e){var t=plt();return function(){var n=OR(e),i;if(t){var a=OR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dlt(this,i)}}function dlt(e,t){if(t&&(Jg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vlt(e)}function vlt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function plt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function OR(e){return OR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},OR(e)}var Dq=function(e){clt(r,e);var t=hlt(r);function r(n,i){var a;return slt(this,r),a=t.call(this),a.mergedValuesCache=[],a.aggregationFunction=n,a.fallbackValue=i,a}return llt(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var a=tr(this.get(),function(c){return c.getValues()}),o=[],s=dt(a[0])&&a[0].length||0,l=0;l<s;l+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(a[f][l]);o.push(u)}return tr(o,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,a){var o=this.getMergedValues(a)[i];return dt(o)?o:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(nV);function O_(e){return O_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O_(e)}function glt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mlt(n.key),n)}}function ylt(e,t,r){return t&&$q(e.prototype,t),r&&$q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mlt(e){var t=blt(e,"string");return O_(t)==="symbol"?t:String(t)}function blt(e,t){if(O_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wlt(e,t,r){_lt(e,t),t.set(e,r)}function _lt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Slt(e,t,r){var n=sde(e,t,"set");return Clt(e,n,r),r}function Clt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function xlt(e,t){var r=sde(e,t,"get");return Tlt(e,r)}function sde(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Tlt(e,t){return t.get?t.get.call(e):t.value}var eD=new WeakMap,lde=function(){function e(){glt(this,e),wlt(this,eD,{writable:!0,value:[]})}return ylt(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(xlt(this,eD)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){Slt(this,eD,r)}}]),e}();qr(lde,Va);function Nq(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function E_(e){return E_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E_(e)}function Olt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rlt(n.key),n)}}function Elt(e,t,r){return t&&Lq(e.prototype,t),r&&Lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rlt(e){var t=klt(e,"string");return E_(t)==="symbol"?t:String(t)}function klt(e,t){if(E_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q0(e,t,r){Alt(e,t),t.set(e,r)}function Alt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oo(e,t){var r=ude(e,t,"get");return Plt(e,r)}function Plt(e,t){return t.get?t.get.call(e):t.value}function nT(e,t,r){var n=ude(e,t,"set");return Ilt(e,n,r),r}function ude(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ilt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var iT=new WeakMap,Z0=new WeakMap,aT=new WeakMap,oT=new WeakMap,sT=new WeakMap,Mlt=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;Olt(this,e),q0(this,iT,{writable:!0,value:new Set}),q0(this,Z0,{writable:!0,value:[]}),q0(this,aT,{writable:!0,value:[]}),q0(this,oT,{writable:!0,value:!1}),q0(this,sT,{writable:!0,value:!1}),nT(this,sT,r??!1)}return Elt(e,[{key:"createObserver",value:function(){var r=this,n=new lde;return Oo(this,iT).add(n),n.addLocalHook("unsubscribe",function(){Oo(r,iT).delete(n)}),n._writeInitialChanges(Nq(Oo(this,Z0),Oo(this,aT))),n}},{key:"emit",value:function(r){var n=Oo(this,aT);(!Oo(this,oT)||Oo(this,Z0).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Oo(this,sT)):nT(this,Z0,new Array(r.length).fill(Oo(this,sT))),Oo(this,oT)||(nT(this,oT,!0),n=Oo(this,Z0)));var i=Nq(n,r);Oo(this,iT).forEach(function(a){return a._write(i)}),nT(this,aT,r)}}]),e}();function R_(e){return R_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R_(e)}var Fq;function tD(e){return Llt(e)||Nlt(e)||$lt(e)||Dlt()}function Dlt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $lt(e,t){if(e){if(typeof e=="string")return SF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SF(e,t)}}function Nlt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Llt(e){if(Array.isArray(e))return SF(e)}function SF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Flt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Hlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wlt(n.key),n)}}function Blt(e,t,r){return t&&Hq(e.prototype,t),r&&Hq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wlt(e){var t=Vlt(e,"string");return R_(t)==="symbol"?t:String(t)}function Vlt(e,t){if(R_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(R_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bq=new Set(["getFirstNotHiddenIndex"]),CF=function(){function e(){var t=this;Hlt(this,e),this.indexesSequence=new ode,this.trimmingMapsCollection=new Dq(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new Dq(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new nV,this.hidingChangesObservable=new Mlt({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return Blt(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,tlt(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof W1?this.trimmingMapsCollection.register(r,n):n instanceof RA?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return dt(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return dt(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return dt(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return dt(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;Bq.has("getFirstNotHiddenIndex")&&(Bq.delete("getFirstNotHiddenIndex"),Kr(Wr(Fq||(Fq=Flt([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var o=this.getPhysicalFromVisualIndex(r);return o===null?i===!0&&a!==r-n?this.getFirstNotHiddenIndex(a,-n,!1,a):null:this.isHidden(o)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,a)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.getPhysicalFromVisualIndex(r);if(a===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=o.findIndex(function(l){return l>r}):s=o.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:o[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=tD(new Array(r).keys()),this.notHiddenIndexesCache=tD(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=tD(Array(this.getNumberOfIndexes()-r).keys()).map(function(a){return a+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isTrimmed(a)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var a=tr(r,function(c){return i.getPhysicalFromVisualIndex(c)}),o=this.getNotTrimmedIndexesLength(),s=r.length,l=x_(this.getIndexesSequence(),a),u=o-s;if(n+s<o){var f=l.filter(function(c){return i.isTrimmed(c)===!1})[n];u=l.indexOf(f)}this.setIndexesSequence(eV(l,u,a))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],a=dt(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=tr(new Array(n).fill(a),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(o,s),this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),a=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(a,n)}}}]),e}();qr(CF,Va);var Wq;function Ult(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function jlt(e,t){return nr(t,function(r,n){Yr(e[n])&&(e[n]=r)}),e}function fde(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function cde(e){dt(e)&&IW(Wr(Wq||(Wq=Ult(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function zlt(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var hde=ts("phraseFormatters"),Glt=hde.register,Ylt=hde.getValues;function Klt(e,t){Glt(e,t)}function Xlt(){return Ylt()}Klt("pluralize",zlt);var dde="ContextMenu:items",Xt=dde,iV="".concat(Xt,".noItems"),aV="".concat(Xt,".insertRowAbove"),oV="".concat(Xt,".insertRowBelow"),sV="".concat(Xt,".insertColumnOnTheLeft"),lV="".concat(Xt,".insertColumnOnTheRight"),uV="".concat(Xt,".removeRow"),fV="".concat(Xt,".removeColumn"),cV="".concat(Xt,".undo"),hV="".concat(Xt,".redo"),dV="".concat(Xt,".readOnly"),vV="".concat(Xt,".clearColumn"),pV="".concat(Xt,".copy"),gV="".concat(Xt,".copyWithHeaders"),yV="".concat(Xt,".copyWithGroupHeaders"),mV="".concat(Xt,".copyHeadersOnly"),bV="".concat(Xt,".cut"),wV="".concat(Xt,".freezeColumn"),_V="".concat(Xt,".unfreezeColumn"),SV="".concat(Xt,".mergeCells"),CV="".concat(Xt,".unmergeCells"),xV="".concat(Xt,".addComment"),TV="".concat(Xt,".editComment"),OV="".concat(Xt,".removeComment"),EV="".concat(Xt,".readOnlyComment"),RV="".concat(Xt,".align"),kV="".concat(Xt,".align.left"),AV="".concat(Xt,".align.center"),PV="".concat(Xt,".align.right"),IV="".concat(Xt,".align.justify"),MV="".concat(Xt,".align.top"),DV="".concat(Xt,".align.middle"),$V="".concat(Xt,".align.bottom"),NV="".concat(Xt,".borders"),LV="".concat(Xt,".borders.top"),FV="".concat(Xt,".borders.right"),HV="".concat(Xt,".borders.bottom"),BV="".concat(Xt,".borders.left"),WV="".concat(Xt,".borders.remove"),VV="".concat(Xt,".nestedHeaders.insertChildRow"),UV="".concat(Xt,".nestedHeaders.detachFromParent"),jV="".concat(Xt,".hideColumn"),zV="".concat(Xt,".showColumn"),GV="".concat(Xt,".hideRow"),YV="".concat(Xt,".showRow"),_a="Filters:",kn="".concat(_a,"conditions"),AA="".concat(kn,".none"),KV="".concat(kn,".isEmpty"),XV="".concat(kn,".isNotEmpty"),qV="".concat(kn,".isEqualTo"),ZV="".concat(kn,".isNotEqualTo"),JV="".concat(kn,".beginsWith"),QV="".concat(kn,".endsWith"),eU="".concat(kn,".contains"),tU="".concat(kn,".doesNotContain"),qlt="".concat(kn,".byValue"),rU="".concat(kn,".greaterThan"),nU="".concat(kn,".greaterThanOrEqualTo"),iU="".concat(kn,".lessThan"),aU="".concat(kn,".lessThanOrEqualTo"),oU="".concat(kn,".isBetween"),sU="".concat(kn,".isNotBetween"),lU="".concat(kn,".after"),uU="".concat(kn,".before"),fU="".concat(kn,".today"),cU="".concat(kn,".tomorrow"),hU="".concat(kn,".yesterday"),dU="".concat(_a,"labels.filterByCondition"),vU="".concat(_a,"labels.filterByValue"),pU="".concat(_a,"labels.conjunction"),PA="".concat(_a,"labels.disjunction"),ER="".concat(_a,"values.blankCells"),gU="".concat(_a,"buttons.selectAll"),yU="".concat(_a,"buttons.clear"),mU="".concat(_a,"buttons.ok"),bU="".concat(_a,"buttons.cancel"),wU="".concat(_a,"buttons.placeholder.search"),_U="".concat(_a,"buttons.placeholder.value"),SU="".concat(_a,"buttons.placeholder.secondValue");const Zlt=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:xV,CONTEXTMENU_ITEMS_ALIGNMENT:RV,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:$V,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:AV,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:IV,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:kV,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:DV,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:PV,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:MV,CONTEXTMENU_ITEMS_BORDERS:NV,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:HV,CONTEXTMENU_ITEMS_BORDERS_LEFT:BV,CONTEXTMENU_ITEMS_BORDERS_RIGHT:FV,CONTEXTMENU_ITEMS_BORDERS_TOP:LV,CONTEXTMENU_ITEMS_CLEAR_COLUMN:vV,CONTEXTMENU_ITEMS_COPY:pV,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:mV,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:yV,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:gV,CONTEXTMENU_ITEMS_CUT:bV,CONTEXTMENU_ITEMS_EDIT_COMMENT:TV,CONTEXTMENU_ITEMS_FREEZE_COLUMN:wV,CONTEXTMENU_ITEMS_HIDE_COLUMN:jV,CONTEXTMENU_ITEMS_HIDE_ROW:GV,CONTEXTMENU_ITEMS_INSERT_LEFT:sV,CONTEXTMENU_ITEMS_INSERT_RIGHT:lV,CONTEXTMENU_ITEMS_MERGE_CELLS:SV,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:UV,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:VV,CONTEXTMENU_ITEMS_NO_ITEMS:iV,CONTEXTMENU_ITEMS_READ_ONLY:dV,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:EV,CONTEXTMENU_ITEMS_REDO:hV,CONTEXTMENU_ITEMS_REMOVE_BORDERS:WV,CONTEXTMENU_ITEMS_REMOVE_COLUMN:fV,CONTEXTMENU_ITEMS_REMOVE_COMMENT:OV,CONTEXTMENU_ITEMS_REMOVE_ROW:uV,CONTEXTMENU_ITEMS_ROW_ABOVE:aV,CONTEXTMENU_ITEMS_ROW_BELOW:oV,CONTEXTMENU_ITEMS_SHOW_COLUMN:zV,CONTEXTMENU_ITEMS_SHOW_ROW:YV,CONTEXTMENU_ITEMS_UNDO:cV,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:_V,CONTEXTMENU_ITEMS_UNMERGE_CELLS:CV,CONTEXT_MENU_ITEMS_NAMESPACE:dde,FILTERS_BUTTONS_CANCEL:bU,FILTERS_BUTTONS_CLEAR:yU,FILTERS_BUTTONS_OK:mU,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:wU,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:SU,FILTERS_BUTTONS_PLACEHOLDER_VALUE:_U,FILTERS_BUTTONS_SELECT_ALL:gU,FILTERS_CONDITIONS_AFTER:lU,FILTERS_CONDITIONS_BEFORE:uU,FILTERS_CONDITIONS_BEGINS_WITH:JV,FILTERS_CONDITIONS_BETWEEN:oU,FILTERS_CONDITIONS_BY_VALUE:qlt,FILTERS_CONDITIONS_CONTAINS:eU,FILTERS_CONDITIONS_EMPTY:KV,FILTERS_CONDITIONS_ENDS_WITH:QV,FILTERS_CONDITIONS_EQUAL:qV,FILTERS_CONDITIONS_GREATER_THAN:rU,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:nU,FILTERS_CONDITIONS_LESS_THAN:iU,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:aU,FILTERS_CONDITIONS_NAMESPACE:kn,FILTERS_CONDITIONS_NONE:AA,FILTERS_CONDITIONS_NOT_BETWEEN:sU,FILTERS_CONDITIONS_NOT_CONTAIN:tU,FILTERS_CONDITIONS_NOT_EMPTY:XV,FILTERS_CONDITIONS_NOT_EQUAL:ZV,FILTERS_CONDITIONS_TODAY:fU,FILTERS_CONDITIONS_TOMORROW:cU,FILTERS_CONDITIONS_YESTERDAY:hU,FILTERS_DIVS_FILTER_BY_CONDITION:dU,FILTERS_DIVS_FILTER_BY_VALUE:vU,FILTERS_LABELS_CONJUNCTION:pU,FILTERS_LABELS_DISJUNCTION:PA,FILTERS_NAMESPACE:_a,FILTERS_VALUES_BLANK_CELLS:ER},Symbol.toStringTag,{value:"Module"}));function k_(e){return k_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k_(e)}var it;function ot(e,t,r){return t=Jlt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jlt(e){var t=Qlt(e,"string");return k_(t)==="symbol"?t:String(t)}function Qlt(e,t){if(k_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(k_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eut=(it={languageCode:"en-US"},ot(it,iV,"No available options"),ot(it,aV,"Insert row above"),ot(it,oV,"Insert row below"),ot(it,sV,"Insert column left"),ot(it,lV,"Insert column right"),ot(it,uV,["Remove row","Remove rows"]),ot(it,fV,["Remove column","Remove columns"]),ot(it,cV,"Undo"),ot(it,hV,"Redo"),ot(it,dV,"Read only"),ot(it,vV,"Clear column"),ot(it,RV,"Alignment"),ot(it,kV,"Left"),ot(it,AV,"Center"),ot(it,PV,"Right"),ot(it,IV,"Justify"),ot(it,MV,"Top"),ot(it,DV,"Middle"),ot(it,$V,"Bottom"),ot(it,wV,"Freeze column"),ot(it,_V,"Unfreeze column"),ot(it,NV,"Borders"),ot(it,LV,"Top"),ot(it,FV,"Right"),ot(it,HV,"Bottom"),ot(it,BV,"Left"),ot(it,WV,"Remove border(s)"),ot(it,xV,"Add comment"),ot(it,TV,"Edit comment"),ot(it,OV,"Delete comment"),ot(it,EV,"Read-only comment"),ot(it,SV,"Merge cells"),ot(it,CV,"Unmerge cells"),ot(it,pV,"Copy"),ot(it,gV,["Copy with header","Copy with headers"]),ot(it,yV,["Copy with group header","Copy with group headers"]),ot(it,mV,["Copy header only","Copy headers only"]),ot(it,bV,"Cut"),ot(it,VV,"Insert child row"),ot(it,UV,"Detach from parent"),ot(it,jV,["Hide column","Hide columns"]),ot(it,zV,["Show column","Show columns"]),ot(it,GV,["Hide row","Hide rows"]),ot(it,YV,["Show row","Show rows"]),ot(it,AA,"None"),ot(it,KV,"Is empty"),ot(it,XV,"Is not empty"),ot(it,qV,"Is equal to"),ot(it,ZV,"Is not equal to"),ot(it,JV,"Begins with"),ot(it,QV,"Ends with"),ot(it,eU,"Contains"),ot(it,tU,"Does not contain"),ot(it,rU,"Greater than"),ot(it,nU,"Greater than or equal to"),ot(it,iU,"Less than"),ot(it,aU,"Less than or equal to"),ot(it,oU,"Is between"),ot(it,sU,"Is not between"),ot(it,lU,"After"),ot(it,uU,"Before"),ot(it,fU,"Today"),ot(it,cU,"Tomorrow"),ot(it,hU,"Yesterday"),ot(it,ER,"Blank cells"),ot(it,dU,"Filter by condition"),ot(it,vU,"Filter by value"),ot(it,pU,"And"),ot(it,PA,"Or"),ot(it,gU,"Select all"),ot(it,yU,"Clear"),ot(it,mU,"OK"),ot(it,bU,"Cancel"),ot(it,wU,"Search"),ot(it,_U,"Value"),ot(it,SU,"Second value"),it);const vde=eut;var xF=vde.languageCode,IA=ts("languagesDictionaries"),tut=IA.register,pde=IA.getItem,rut=IA.hasItem,nut=IA.getValues;gde(vde);function gde(e,t){var r=e,n=t;return rr(e)&&(n=e,r=n.languageCode),iut(r,n),tut(r,Ui(n)),Ui(n)}function iut(e,t){e!==xF&&jlt(t,pde(xF))}function yde(e){return CU(e)?Ui(pde(e)):null}function CU(e){return rut(e)}function aut(){return nut()}function mde(e,t,r){var n=yde(e);if(n===null)return null;var i=n[t];if(Yr(i))return null;var a=out(i,r);return Array.isArray(a)?a[0]:a}function out(e,t){var r=e;return ve(Xlt(),function(n){r=n(e,t)}),r}function sut(e){var t=fde(e);return CU(t)||(t=xF,cde(e)),t}var lut=Nt,uut=Gn,fut=vle,cut=co,hut=Tl,dut=Fm;lut({target:"Object",stat:!0,sham:!uut},{getOwnPropertyDescriptors:function(t){for(var r=cut(t),n=hut.f,i=fut(r),a={},o=0,s,l;i.length>o;)l=n(r,s=i[o++]),l!==void 0&&dut(a,s,l);return a}});var MA="active-header",DA="area",A_="cell",xU="fill",V1="header",TU="custom-selection";function Qg(e){return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qg(e)}function vut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wde(n.key),n)}}function put(e,t,r){return t&&Vq(e.prototype,t),r&&Vq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AO(){return typeof Reflect<"u"&&Reflect.get?AO=Reflect.get.bind():AO=function(t,r,n){var i=gut(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},AO.apply(this,arguments)}function gut(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ey(e),e!==null););return e}function yut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TF(e,t)}function TF(e,t){return TF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TF(e,t)}function mut(e){var t=wut();return function(){var n=ey(e),i;if(t){var a=ey(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return but(this,i)}}function but(e,t){if(t&&(Qg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bde(e)}function bde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ey(e){return ey=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ey(e)}function _ut(e,t,r){return t=wde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wde(e){var t=Sut(e,"string");return Qg(t)==="symbol"?t:String(t)}function Sut(e,t){if(Qg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cut=function(e){yut(r,e);var t=mut(r);function r(n,i){var a;return vut(this,r),a=t.call(this,n,null),_ut(bde(a),"visualCellRange",null),a.visualCellRange=i||null,a.commit(),a}return put(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,AO(ey(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var a=i.from,o=i.to,s=this.getNearestNotHiddenCoords(a,1),l=this.getNearestNotHiddenCoords(o,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=a,l=o}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,a);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,o);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,a,o){if(a<0)return a;var s=i.getNearestNotHiddenIndex(a,o),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var a=i.getVerticalDirection()==="N-S"?1:-1,o=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),a,o);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,a=i.from,o=i.to,s=a.row===null||o.row===null,l=a.col===null||o.col===null,u=this.settings.createCellCoords(s?null:Math.min(a.row,o.row),l?null:Math.min(a.col,o.col)),f=this.settings.createCellCoords(s?null:Math.max(a.row,o.row),l?null:Math.max(a.col,o.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),a=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,a.row,a.col]}},{key:"createRenderableCellRange",value:function(i,a){var o=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(a);return this.settings.createCellRange(o,o,s)}}]),r}(rot);const zm=Cut;function P_(e){return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P_(e)}var xut=["activeHeaderClassName"];function Uq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uq(Object(r),!0).forEach(function(n){Tut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tut(e,t,r){return t=Out(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Out(e){var t=Eut(e,"string");return P_(t)==="symbol"?t:String(t)}function Eut(e,t){if(P_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rut(e,t){if(e==null)return{};var r=kut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Aut(e){var t=e.activeHeaderClassName,r=Rut(e,xut),n=new zm(jq(jq({highlightHeaderClassName:t},r),{},{selectionType:MA}));return n}function I_(e){return I_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I_(e)}var Put=["layerLevel","areaCornerVisible"];function zq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zq(Object(r),!0).forEach(function(n){Iut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Iut(e,t,r){return t=Mut(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mut(e){var t=Dut(e,"string");return I_(t)==="symbol"?t:String(t)}function Dut(e,t){if(I_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(I_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $ut(e,t){if(e==null)return{};var r=Nut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Nut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Lut(e){var t=e.layerLevel,r=e.areaCornerVisible,n=$ut(e,Put),i=new zm(Gq(Gq({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:DA}));return i}function M_(e){return M_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M_(e)}var Fut=["cellCornerVisible"];function Yq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Kq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yq(Object(r),!0).forEach(function(n){Hut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hut(e,t,r){return t=But(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function But(e){var t=Wut(e,"string");return M_(t)==="symbol"?t:String(t)}function Wut(e,t){if(M_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vut(e,t){if(e==null)return{};var r=Uut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Uut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function jut(e){var t=e.cellCornerVisible,r=Vut(e,Fut),n=new zm(Kq(Kq({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:A_}));return n}function D_(e){return D_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D_(e)}var zut=["border","visualCellRange"];function Xq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xq(Object(r),!0).forEach(function(n){Gut(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gut(e,t,r){return t=Yut(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yut(e){var t=Kut(e,"string");return D_(t)==="symbol"?t:String(t)}function Kut(e,t){if(D_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(D_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xut(e,t){if(e==null)return{};var r=qut(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qut(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Zut(e){var t=e.border,r=e.visualCellRange,n=Xut(e,zut),i=new zm(rD(rD(rD({},t),n),{},{selectionType:TU}),r);return i}var qq=Gn,Jut=ir,Qut=ri,eft=Kt,nD=g1,tft=v1,rft=o1,nft=Wa,ift=l1,ep=Object.assign,Zq=Object.defineProperty,aft=Jut([].concat),oft=!ep||eft(function(){if(qq&&ep({b:1},ep(Zq({},"a",{enumerable:!0,get:function(){Zq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),ep({},e)[r]!=7||nD(ep({},t)).join("")!=n})?function(t,r){for(var n=nft(t),i=arguments.length,a=1,o=tft.f,s=rft.f;i>a;)for(var l=ift(arguments[a++]),u=o?aft(nD(l),o(l)):nD(l),f=u.length,c=0,h;f>c;)h=u[c++],(!qq||Qut(s,l,h))&&(n[h]=l[h]);return n}:ep,sft=Nt,Jq=oft;sft({target:"Object",stat:!0,arity:2,forced:Object.assign!==Jq},{assign:Jq});function $_(e){return $_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$_(e)}function Qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function eZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(r),!0).forEach(function(n){lft(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lft(e,t,r){return t=uft(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uft(e){var t=fft(e,"string");return $_(t)==="symbol"?t:String(t)}function fft(e,t){if($_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cft(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function hft(e){var t=Object.assign({},(cft(e),e)),r=new zm(eZ(eZ({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:xU}));return r}function N_(e){return N_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N_(e)}var dft=["headerClassName","rowClassName","columnClassName"];function tZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tZ(Object(r),!0).forEach(function(n){vft(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vft(e,t,r){return t=pft(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pft(e){var t=gft(e,"string");return N_(t)==="symbol"?t:String(t)}function gft(e,t){if(N_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yft(e,t){if(e==null)return{};var r=mft(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mft(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function bft(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=yft(e,dft),a=new zm(rZ(rZ({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:V1}));return a}function L_(e){return L_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L_(e)}function nZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wft(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nZ(Object(r),!0).forEach(function(n){_ft(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ft(e,t,r){return t=Sft(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sft(e){var t=Cft(e,"string");return L_(t)==="symbol"?t:String(t)}function Cft(e,t){if(L_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(L_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _de=ts("highlight/types"),Gm=_de.register,xft=_de.getItem;Gm(MA,Aut);Gm(DA,Lut);Gm(A_,jut);Gm(TU,Zut);Gm(xU,hft);Gm(V1,bft);function tp(e,t){return xft(e)(wft({type:e},t))}function F_(e){return F_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F_(e)}function Of(e){return Rft(e)||Eft(e)||Oft(e)||Tft()}function Tft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oft(e,t){if(e){if(typeof e=="string")return OF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OF(e,t)}}function Eft(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rft(e){if(Array.isArray(e))return OF(e)}function OF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function J0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iZ(Object(r),!0).forEach(function(n){kft(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kft(e,t,r){return t=Sde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sde(n.key),n)}}function Pft(e,t,r){return t&&aZ(e.prototype,t),r&&aZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sde(e){var t=Ift(e,"string");return F_(t)==="symbol"?t:String(t)}function Ift(e,t){if(F_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mft=function(e){function t(r){Aft(this,t),this.options=r,this.layerLevel=0,this.cell=tp(A_,r),this.fill=tp(xU,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Pft(t,[{key:"isEnabledFor",value:function(n,i){var a=n;n===A_&&(a="current");var o=this.options.disabledCellSelection(i.row,i.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(a)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=tp(DA,J0({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return Of(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=tp(V1,J0({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return Of(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=tp(MA,J0({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return Of(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Of(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(tp(TU,J0(J0({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),ve(this.areas.values(),function(n){return void n.clear()}),ve(this.headers.values(),function(n){return void n.clear()}),ve(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Of(this.areas.values()),Of(this.headers.values()),Of(this.activeHeaders.values()),Of(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Dft=Mft;function H_(e){return H_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H_(e)}function $ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lft(n.key),n)}}function Nft(e,t,r){return t&&oZ(e.prototype,t),r&&oZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lft(e){var t=Fft(e,"string");return H_(t)==="symbol"?t:String(t)}function Fft(e,t){if(H_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(H_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hft=function(e){function t(r){$ft(this,t),this.ranges=[],this.createCellRange=r}return Nft(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,a;return i>=0&&(a=this.ranges[i]),a}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Bft=Hft;function B_(e){return B_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B_(e)}function Wft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uft(n.key),n)}}function Vft(e,t,r){return t&&sZ(e.prototype,t),r&&sZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uft(e){var t=jft(e,"string");return B_(t)==="symbol"?t:String(t)}function jft(e,t){if(B_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(B_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cde=function(){function e(t,r){Wft(this,e),this.range=t,this.options=r}return Vft(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.options.createCellCoords(r,n),o=this.range.current().highlight,s=this.options.visualToRenderableCoords(o),l=s.row,u=s.col,f=o,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",a),l!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),g=this.options.fixedRowsBottom(),y=this.options.minSpareRows(),b=this.options.minSpareCols(),w=this.options.autoWrapRow(),_=this.options.autoWrapCol();l+r>d-1?i&&y>0&&!(g&&l>=d-g-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):_&&(a.row=1-d,a.col=u+a.col===v-1?1-v:1):_&&l+a.row<0&&u+a.col>=0&&(a.row=d-1,a.col=u+a.col===0?v-1:-1),u+a.col>v-1?i&&b>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):w&&(a.row=l+a.row===d-1?1-d:1,a.col=1-v):w&&u+a.col<0&&l+a.row>=0&&(a.row=l+a.row===0?d-1:-1,a.col=v-1);var x=this.options.createCellCoords(l+a.row,u+a.col);c=0,h=0,x.row<0?(c=-1,x.row=0):x.row>0&&x.row>=d&&(c=1,x.row=d-1),x.col<0?(h=-1,x.col=0):x.col>0&&x.col>=v&&(h=1,x.col=v-1),f=this.options.renderableToVisualCoords(x)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),a=this.range.current(),o=a.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(a.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(a.to),g=v.row,y=v.col,b=this.options.createCellCoords(g+i.row,y+i.col);s=0,l=0,b.row<0?(s=-1,b.row=0):b.row>0&&b.row>=h&&(s=1,b.row=h-1),b.col<0?(l=-1,b.col=0):b.col>0&&b.col>=d&&(l=1,b.col=d-1),o=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformEnd",o,s,l),o}}]),e}();qr(Cde,Va);const zft=Cde;function xde(e,t){return Xft(e)||Kft(e,t)||Yft(e,t)||Gft()}function Gft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yft(e,t){if(e){if(typeof e=="string")return lZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lZ(e,t)}}function lZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kft(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Xft(e){if(Array.isArray(e))return e}function EF(e){return EF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},EF(e)}var $A=0,NA=1,Tde=2,OU=3,qft=[OU,Tde],Zft=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],iD=Symbol("root"),uZ=Symbol("child");function ty(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iD;if(t!==iD&&t!==uZ)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===iD,i=$A;if(r){var a=e[0];if(e.length===0)i=NA;else if(n&&a instanceof HW)i=OU;else if(n&&Array.isArray(a))i=ty(a,uZ);else if(e.length>=2&&e.length<=4){var o=!e.some(function(s,l){return!Zft[l].includes(EF(s))});o&&(i=Tde)}}return i}function W_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!qft.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(a){var o=e===OU,s=o?a.from.row:a[0],l=o?a.from.col:a[1],u=o?a.to.row:a[2],f=o?a.to.col:a[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof f=="string"&&(f=i(f))),Yr(u)&&(u=s),Yr(f)&&(f=l),!n){var c=s,h=l,d=u,v=f;s=Math.min(c,d),l=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[s,l,u,f]}}function Jft(e){var t=ty(e);if(t===$A||t===NA)return[];var r=W_(t),n=new Set;ve(e,function(o){var s=r(o),l=xde(s,4),u=l[1],f=l[3],c=Math.max(u,0),h=f-c+1;ve(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=Nn(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function Qft(e){var t=ty(e);if(t===$A||t===NA)return[];var r=W_(t),n=new Set;ve(e,function(o){var s=r(o),l=xde(s,3),u=l[0],f=l[2],c=Math.max(u,0),h=f-c+1;ve(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=Nn(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function Ef(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function V_(e){return V_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V_(e)}var fZ;function cZ(e,t){return nct(e)||rct(e,t)||tct(e,t)||ect()}function ect(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tct(e,t){if(e){if(typeof e=="string")return hZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hZ(e,t)}}function hZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rct(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function nct(e){if(Array.isArray(e))return e}function ict(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function act(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sct(n.key),n)}}function oct(e,t,r){return t&&dZ(e.prototype,t),r&&dZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sct(e){var t=lct(e,"string");return V_(t)==="symbol"?t:String(t)}function lct(e,t){if(V_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(V_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ode=function(){function e(t,r){var n=this;act(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Bft(function(i,a,o){return n.tableProps.createCellRange(i,a,o)}),this.highlight=new Dft({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(a,o){return n.tableProps.isDisabledCellSelection(a,o)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},createCellRange:function(a,o,s){return n.tableProps.createCellRange(a,o,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new zft(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(a))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertColRequire"].concat(a))})}return oct(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.settings.selectionMode==="multiple",o=Yr(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),f),(!a||a&&!o&&Yr(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(A_,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var a=this.getLayerLevel();a<this.highlight.layerLevel&&(ve(this.highlight.getAreas(),function(g){return void g.clear()}),ve(this.highlight.getHeaders(),function(g){return void g.clear()}),ve(this.highlight.getActiveHeaders(),function(g){return void g.clear()})),this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(DA,i.highlight)&&(this.isMultiple()||a>=1)&&(o.add(i.from).add(i.to).commit(),a===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(a-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(V1,i.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=i;if((f||c)&&(h=i.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===i.getWidth();d&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===i.getHeight();v&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Id(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),a=this.tableProps.countCols();if(!(!r&&!n&&(i===0||a===0))){var o=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,a-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=ty(r);if(i===NA)return!1;if(i===$A)throw new Error(Wr(fZ||(fZ=ict([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var a=W_(i,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var f=a(u),c=cZ(f,4),h=c[0],d=c[1],v=c[2],g=c[3],y=Ef(h,o)&&Ef(d,s)&&Ef(v,o)&&Ef(g,s);return!y});return l&&(this.clear(),ve(r,function(u){var f=a(u),c=cZ(f,4),h=c[0],d=c[1],v=c[2],g=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,g)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=typeof r=="string"?this.tableProps.propToCol(r):r,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=Ef(a,s)&&Ef(o,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,a)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,o)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=this.tableProps.countRows(),o=this.tableProps.countCols(),s=Ef(r,a)&&Ef(n,a);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,o-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var a=0;a<this.selectedRange.size();a+=1){this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();o.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),e}();qr(Ode,Va);const uct=Ode;var fct=Nt,Ede=m1,cct=Tl.f,hct=nv,vZ=Kn,dct=G4,vct=Ba,pct=Y4,pZ=Ede("".startsWith),gct=Ede("".slice),yct=Math.min,Rde=pct("startsWith"),mct=!Rde&&!!function(){var e=cct(String.prototype,"startsWith");return e&&!e.writable}();fct({target:"String",proto:!0,forced:!mct&&!Rde},{startsWith:function(t){var r=vZ(vct(this));dct(t);var n=hct(yct(arguments.length>1?arguments[1]:void 0,r.length)),i=vZ(t);return pZ?pZ(r,i,n):gct(r,n,n+i.length)===i}});var gZ=/^(\r\n|\n\r|\r|\n)/,bct=/^[^\t\r\n]+/,yZ=/^\t/;function wct(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,i;e.length>0&&i!==e.length;)if(i=e.length,e.match(yZ))e=e.replace(yZ,""),r+=1,t[n][r]="";else if(e.match(gZ))e=e.replace(gZ,""),r=0,n+=1,t[n]=[""];else{var a="";if(e.startsWith('"')){for(var o=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(o+=1),a+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&o%2===0)&&(s=!1)}a=a.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(bct);a=u?u[0]:"",e=e.slice(a.length)}t[n][r]=a}return t}function nw(e){var t,r,n,i,a="",o;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(a+="	"),o=e[t][n],typeof o=="string"?o.indexOf(`
`)>-1?a+='"'.concat(o.replace(/"/g,'""'),'"'):a+=o:o==null?a+="":a+=o;t!==r-1&&(a+=`
`)}return a}function aD(e){return xct(e)||Cct(e)||Sct(e)||_ct()}function _ct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sct(e,t){if(e){if(typeof e=="string")return RF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RF(e,t)}}function Cct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xct(e){if(Array.isArray(e))return RF(e)}function RF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ry(e){return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ry(e)}function Tct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ect(n.key),n)}}function Oct(e,t,r){return t&&mZ(e.prototype,t),r&&mZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ect(e){var t=Rct(e,"string");return ry(t)==="symbol"?t:String(t)}function Rct(e,t){if(ry(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ry(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kct=function(){function e(t,r,n){Tct(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return Oct(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var a=0,o=0,s=!1;if(typeof n=="function"){var l=lA(r);a=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;a=Math.min(u,n.length)}for(i=0;i<a;i++){var f=s?n(i):n[i];if(rr(f)){if(typeof f.data<"u"){var c=s?o:i;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}o+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return ZW(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var a=this,o=n,s=i,l;return typeof o>"u"&&(o=0,s=""),ry(r)==="object"&&!Array.isArray(r)&&nr(r,function(u,f){u===null?(l=s+f,a.colToPropCache.push(l),a.propToColCache.set(l,o),o+=1):o=a.recursiveDuckColumns(u,o,"".concat(f,"."))}),o}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&dt(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(dt(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?_g(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.source,s=a.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,i,o);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,g=this.getSchema().length,y=[],b=function(){var x=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?x=Ui(n.getSchema()):(x=[],xt(g-1,function(){return x.push(null)})):n.instance.dataType==="function"?x=n.tableMeta.dataSchema(h+c):(x={},E1(x,n.getSchema())),y.push(x),c+=1};c<i&&u+c<v;)b();this.instance.rowIndexMapper.insertIndexes(h,c),l==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,y);var w=this.instance.toVisualRow(f);return this.instance.countSourceRows()===y.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):o!=="auto"&&this.metaManager.createRow(f,i)),this.instance.runHooks("afterCreateRow",w,c,o),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,o=i.mode,s=o===void 0?"start":o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,a);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),g=this.instance.countCols(),y=0,b=d;s==="end"&&(b=Math.min(b+1,f));for(var w=b;y<n&&g<u;){if(typeof c!="number"||c>=g)if(v>0)for(var _=0;_<v;_+=1)typeof l[_]>"u"&&(l[_]=[]),l[_].push(null);else l.push([null]);else for(var x=0;x<v;x++)l[x].splice(b,0,null);y+=1,b+=1,g+=1}this.instance.columnIndexMapper.insertIndexes(c,y),y>0&&(r==null?this.metaManager.createColumn(null,y):a!=="auto"&&this.metaManager.createColumn(w,n));var E=this.instance.toVisualColumn(w);return this.instance.runHooks("afterCreateCol",E,y,a),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:y,startPhysicalIndex:w}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(o,i),l=this.instance.countSourceRows();o=(l+o)%l;var u=this.instance.runHooks("beforeRemoveRow",o,s.length,s,a);if(u===!1)return!1;var f=s.length;if(this.filterData(o,f,s),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var c=dt(this.tableMeta.columns)||dt(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=s.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",o,f,s,a),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var a=typeof r!="number"?-n:r;a=(this.instance.countCols()+a)%this.instance.countCols();var o=this.visualColumnsToPhysical(a,n),s=o.slice(0).sort(function(w,_){return _-w}),l=this.instance.runHooks("beforeRemoveCol",a,n,o,i);if(l===!1)return!1;for(var u=!0,f=s.length,c=this.dataSource,h=0;h<f;h++)u&&o[0]!==o[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(var g=0,y=this.instance.countSourceRows();g<y;g++)for(var b=0;b<f;b++)c[g].splice(s[b],1),g===0&&this.metaManager.removeColumn(s[b],1);return a<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",a,n,o,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var a=this.instance.getDataAtCol(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];iL(u,s);for(var c=0;c<i;)u.push(null),c+=1;return ffe(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(r,n,i){for(var a=this.instance.getSourceDataAtRow(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];iL(u,s);for(var c=0;c<i;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),o}},{key:"spliceData",value:function(r,n,i){var a=this,o=this.instance.runHooks("beforeDataSplice",r,n,i);if(o!==!1){var s=[].concat(aD(this.dataSource.slice(0,r)),aD(i),aD(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return a.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var a=this.instance.runHooks("filterData",r,n,i);Array.isArray(a)===!1&&(a=this.dataSource.filter(function(o,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,a)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),a=this.dataSource[i],o=this.instance.runHooks("modifyRowData",i);a=isNaN(o)?o:a;var s=null;if(a&&a.hasOwnProperty&&On(a,n))s=a[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=a;if(!u)return null;for(var f=0,c=l.length;f<c;f++)if(u=u[l[f]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=Id(s);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var a=this.instance.toPhysicalRow(r),o=i,s=this.dataSource[a],l=this.instance.runHooks("modifyRowData",a);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=Id(o);this.instance.runHooks("modifyData",a,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}if(s&&s.hasOwnProperty&&On(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=s,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=o}else typeof n=="function"?n(this.dataSource.slice(a,a+1)[0],o):s[n]=o}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),a=[],o=(i+r)%i,s=n,l;o<i&&s;)l=this.instance.toPhysicalRow(o),a.push(l),s-=1,o+=1;return a}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),a=[],o=(i+r)%i,s=n;o<i&&s;){var l=this.instance.toPhysicalColumn(o);a.push(l),s-=1,o+=1}return a}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var a=[],o,s,l,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(o=Math.min(r.row,n.row);o<=h;o++){l=[];var v=o>=0?this.instance.toPhysicalRow(o):o;for(s=Math.min(r.col,n.col);s<=d&&v!==null;s++)l.push(c.call(this,o,this.colToProp(s)));v!==null&&a.push(l)}return a}},{key:"getText",value:function(r,n){return nw(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return nw(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const Act=kct;var U1=ts("cellTypes"),Pct=U1.register,Ict=U1.getItem,kde=U1.hasItem,Mct=U1.getNames;U1.getValues;function EU(e){if(!kde(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Ict(e)}function bs(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,a=r.validator;n&&Aa(e,n),i&&ol(e,i),a&&Fp(e,a),Pct(e,t)}function Dct(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!On(t,e)}function LA(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?EU(t.type):t.type;if(e._automaticallyAssignedMetaProps&&nr(t,function(a,o){return void e._automaticallyAssignedMetaProps.delete(o)}),!!rr(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};nr(n,function(a,o){if(Dct(o,r)){var s;i[o]=a,(s=e._automaticallyAssignedMetaProps)===null||s===void 0||s.add(o)}}),zn(e,i)}}function $ct(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}ef(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function PO(e){return Number.isInteger(e)&&e>=0}function IO(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function lT(e){return e==null}function kF(e){return kF=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kF(e)}const Ade=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),ei(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,a;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),ei(i)===!1)return kF(i)==="object"?(a=this.getCellMeta(t,r),eW(this.getSchema()[a.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function U_(e){return U_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U_(e)}function bZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bZ(Object(r),!0).forEach(function(n){Nct(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nct(e,t,r){return t=Ide(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ide(n.key),n)}}function Pde(e,t,r){return t&&_Z(e.prototype,t),r&&_Z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ide(e){var t=Lct(e,"string");return U_(t)==="symbol"?t:String(t)}function Lct(e,t){if(U_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(U_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fct(){return Pde(function e(){Mde(this,e)})}var Hct=function(){function e(t){Mde(this,e),this.metaCtor=Fct(),this.meta=this.metaCtor.prototype,zn(this.meta,Ade()),this.meta.instance=t}return Pde(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;zn(this.meta,r),LA(this.meta,wZ(wZ({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function j_(e){return j_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j_(e)}function Bct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vct(n.key),n)}}function Wct(e,t,r){return t&&SZ(e.prototype,t),r&&SZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vct(e){var t=Uct(e,"string");return j_(t)==="symbol"?t:String(t)}function Uct(e,t){if(j_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jct=function(){function e(t){Bct(this,e);var r=t.getMetaConstructor();this.meta=new r}return Wct(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){zn(this.meta,r),LA(this.meta,r,r)}}]),e}();function z_(e){return z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z_(e)}function CZ(e){return Kct(e)||Yct(e)||Gct(e)||zct()}function zct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gct(e,t){if(e){if(typeof e=="string")return AF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AF(e,t)}}function Yct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kct(e){if(Array.isArray(e))return AF(e)}function AF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zct(n.key),n)}}function qct(e,t,r){return t&&xZ(e.prototype,t),r&&xZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zct(e){var t=Jct(e,"string");return z_(t)==="symbol"?t:String(t)}function Jct(e,t){if(z_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PF=function(e){function t(r){Xct(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return qct(t,[{key:"obtain",value:function(n){IO(function(){return PO(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),a;if(i>=0)a=this.data[i],a===void 0&&(a=this.valueFactory(n),this.data[i]=a);else if(a=this.valueFactory(n),this.holes.size>0){var o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=a,this.index[n]=o}else this.data.push(a),this.index[n]=this.data.length-1;return a}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;IO(function(){return PO(n)||lT(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=[],o=this.data.length,s=0;s<i;s++)a.push(o+s),this.data.push(void 0);var l=lT(n)?this.index.length:n;this.index=[].concat(CZ(this.index.slice(0,l)),a,CZ(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;IO(function(){return PO(n)||lT(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=this.index.splice(lT(n)?this.index.length-i:n,i),o=0;o<a.length;o++){var s=a[o];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return lo(this.data,function(i,a){return!n.holes.has(a)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var a=this._getKeyByStorageIndex(i);a!==-1&&n.push([a,this.data[i]])}var o=0;return{next:function(){if(o<n.length){var l=n[o];return o+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function G_(e){return G_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G_(e)}function Qct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tht(n.key),n)}}function eht(e,t,r){return t&&TZ(e.prototype,t),r&&TZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tht(e){var t=rht(e,"string");return G_(t)==="symbol"?t:String(t)}function rht(e,t){if(G_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nht=["data","width"],iht=function(){function e(t){var r=this;Qct(this,e),this.globalMeta=t,this.metas=new PF(function(){return r._createMeta()})}return eht(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);zn(i,n),LA(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return $ct(this.globalMeta.getMetaConstructor(),nht).prototype}}]),e}();function Y_(e){return Y_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y_(e)}function aht(e){return uht(e)||lht(e)||sht(e)||oht()}function oht(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sht(e,t){if(e){if(typeof e=="string")return IF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IF(e,t)}}function lht(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uht(e){if(Array.isArray(e))return IF(e)}function IF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hht(n.key),n)}}function cht(e,t,r){return t&&OZ(e.prototype,t),r&&OZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hht(e){var t=dht(e,"string");return Y_(t)==="symbol"?t:String(t)}function dht(e,t){if(Y_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Y_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vht=function(){function e(t){var r=this;fht(this,e),this.columnMeta=t,this.metas=new PF(function(){return r._createRow()})}return cht(e,[{key:"updateMeta",value:function(r,n,i){var a=this.getMeta(r,n);zn(a,i),LA(a,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);return i===void 0?a:a[i]}},{key:"setMeta",value:function(r,n,i,a){var o,s=this.metas.obtain(r).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=a}},{key:"removeMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);delete a[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,aht(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){IO(function(){return PO(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new PF(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function K_(e){return K_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K_(e)}function pht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yht(n.key),n)}}function ght(e,t,r){return t&&EZ(e.prototype,t),r&&EZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yht(e){var t=mht(e,"string");return K_(t)==="symbol"?t:String(t)}function mht(e,t){if(K_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dde=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];pht(this,e),this.hot=t,this.globalMeta=new Hct(t),this.tableMeta=new jct(this.globalMeta),this.columnMeta=new iht(this.globalMeta),this.cellMeta=new vht(this.columnMeta),i.forEach(function(a){return new a(r)}),this.globalMeta.updateMeta(n)}return ght(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var a=i.visualRow,o=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=a,s.visualCol=o,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,a){this.cellMeta.setMeta(r,n,i,a)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();qr(Dde,Va);function RR(e){return RR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RR(e)}function RZ(e,t,r,n){var i=n.hotInstance,a=n.dataMap,o=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,f=n.firstRun,c=La(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":Qr(h.dataSchema)?i.dataType="function":i.dataType="object",a&&a.destroy(),e=i.runHooks("before".concat(c),e,f,l);var d=new Act(i,e,u);if(t(d),RR(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var g,y=0,b=0;for(y=0,b=h.startRows;y<b;y++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)g=Ui(v),e.push(g);else if(i.dataType==="array")g=Ui(v[0]),e.push(g);else{g=[];for(var w=0,_=h.startCols;w<_;w++)g.push(null);e.push(g)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(RR(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),h.data=e,d.dataSource=e,o.data=e,o.dataType=i.dataType,o.colToProp=d.colToProp.bind(d),o.propToCol=d.propToCol.bind(d),o.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks("after".concat(c),e,f,l),f||(i.runHooks("afterChange",null,s),i.render())}function X_(e){return X_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X_(e)}function bht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ht(n.key),n)}}function wht(e,t,r){return t&&kZ(e.prototype,t),r&&kZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ht(e){var t=Sht(e,"string");return X_(t)==="symbol"?t:String(t)}function Sht(e,t){if(X_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cht=function(){function e(t){var r=this;bht(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),pt.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return wht(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,a=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(a))){var o=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",o,s,r);var f=On(r,"type")?r.type:null,c=Qr(r.cells)?r.cells(i,a,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(i,a,c),l.runHooks("afterGetCellMeta",o,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(a)}}}]),e}();function q_(e){return q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q_(e)}function xht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oht(n.key),n)}}function Tht(e,t,r){return t&&AZ(e.prototype,t),r&&AZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oht(e){var t=Eht(e,"string");return q_(t)==="symbol"?t:String(t)}function Eht(e,t){if(q_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rht=function(){function e(t){xht(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,a){if(!a)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return Tht(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var a=n.target,o=n.onChange,s=o===void 0?function(){}:o,l=typeof a=="string",u=l?a:i,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,f,s),l&&r.installPropWatcher(a,f,s)})}},{key:"installPropWatcher",value:function(r,n,i){var a=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!a.usageTracker.has(r);a.usageTracker.add(r),i.call(a,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),e}(),PZ=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),uT=function(t){return t.map(function(r){var n=r.toLowerCase();return PZ.has(n)?PZ.get(n):n}).sort().join("+")},kht=function(t){return t.split("+")},IZ=function(t){return t.toLowerCase()},MZ;function Aht(e){return Mht(e)||Iht(e)||$de(e)||Pht()}function Pht(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iht(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mht(e){if(Array.isArray(e))return MF(e)}function Dht(e,t){return Lht(e)||Nht(e,t)||$de(e,t)||$ht()}function $ht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $de(e,t){if(e){if(typeof e=="string")return MF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MF(e,t)}}function MF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Lht(e){if(Array.isArray(e))return e}function Fht(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Hht=function(t){var r=OA({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,g=v===void 0?function(){return!0}:v,y=f.captureCtrl,b=y===void 0?!1:y,w=f.preventDefault,_=w===void 0?!0:w,x=f.stopPropagation,E=x===void 0?!1:x,R=f.relativeToGroup,A=f.position;if(Yr(d))throw new Error("You need to define the shortcut's group.");if(Qr(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(Wr(MZ||(MZ=Fht([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var N={callback:h,group:d,runOnlyIf:g,captureCtrl:b,preventDefault:_,stopPropagation:E};if(dt(R)){var I=[R,A];N.relativeToGroup=I[0],N.position=I[1]}c.forEach(function(F){var H=uT(F),W=r.hasItem(H);if(W){var z=r.getItem(H),te=z.findIndex(function(ie){return ie.group===R});te!==-1?A==="before"?te-=1:te+=1:te=z.length,z.splice(te,0,N)}else r.addItem(H,[N])})},i=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){nr(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},a=function(f){var c=uT(f);r.removeItem(c)},o=function(f){var c=r.getItems();c.forEach(function(h){var d=Dht(h,2),v=d[0],g=d[1],y=g.filter(function(b){return b.group!==f});y.length===0?a(kht(v)):(g.length=0,g.push.apply(g,Aht(y)))})},s=function(f){var c=uT(f),h=r.getItem(c);return dt(h)?h.slice():[]},l=function(f){var c=uT(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:a,removeShortcutsByGroup:o}};function Bht(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var Wht=["meta","alt","shift","control"],Q0=Bht();function Vht(e,t,r,n,i){var a=function(d){return Wht.includes(d)},o=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return d.altKey&&g.push("alt"),v&&(d.ctrlKey||d.metaKey)?g.push("control/meta"):(d.ctrlKey&&g.push("control"),d.metaKey&&g.push("meta")),d.shiftKey&&g.push("shift"),g},s=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Nh(d))){var g=IZ(d.key),y=[];a(g)?Q0.press(g):y=o(d);var b=[g].concat(y),w=i(d,b);!w&&(LE()&&y.includes("meta")||!LE()&&y.includes("control"))&&i(d,[g].concat(o(d,!0))),n(d)}}},l=function(d){if(t(d)!==!1){var v=IZ(d.key);a(v)!==!1&&Q0.release(v)}},u=function(){Q0.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",s),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=Uw(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",s),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=Uw(d)};return{mount:f,unmount:c,isPressed:function(d){return Q0.isPressed(d)},releasePressedKeys:function(){return Q0.releaseAll()}}}var Uht=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,a=t.afterKeyDown,o=OA({errorIdExists:function(g){return'The "'.concat(g,'" context name is already registered.')}}),s="grid",l=function(g){var y=Hht(g);return o.addItem(g,y),y},u=function(){return s},f=function(g){return o.getItem(g)},c=function(g){s=g},h=!1,d=Vht(r,n,i,a,function(v,g){var y=f(u()),b=!1;if(!y.hasShortcut(g))return b;for(var w=y.getShortcuts(g),_=0;_<w.length;_++){var x=w[_],E=x.callback,R=x.runOnlyIf,A=x.preventDefault,N=x.stopPropagation,I=x.captureCtrl;if(R(v)!==!1&&(h=I,b=E(v,g)===!1,h=!1,A&&v.preventDefault(),N&&v.stopPropagation(),b))break}return b});return d.mount(),{addContext:l,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},DZ,$Z;function Ra(e){return Ra=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ra(e)}function NZ(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Zs(e,t){return Ght(e)||zht(e,t)||Nde(e,t)||jht()}function jht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Ght(e){if(Array.isArray(e))return e}function rp(e){return Xht(e)||Kht(e)||Nde(e)||Yht()}function Yht(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nde(e,t){if(e){if(typeof e=="string")return DF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DF(e,t)}}function Kht(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xht(e){if(Array.isArray(e))return DF(e)}function DF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qht="gridDefault",oD=null,fT=new Set;function RU(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,o=this,s=new bn(o),l,u,f,c,h=!0;oot(i)&&aot(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=sut(t.language);var g=new Dde(o,t,[Cht,Rht]),y=g.getTableMeta(),b=g.getGlobalMeta(),w=OA();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),sF(this)&&mce(t.licenseKey,e),this.guid="ht_".concat(xW()),this.columnIndexMapper=new CF,this.rowIndexMapper=new CF,u=new Pot(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var _=function(T){var k=T.row,O=T.col;return o._createCellCoords(k>=0?o.rowIndexMapper.getRenderableFromVisualIndex(k):k,O>=0?o.columnIndexMapper.getRenderableFromVisualIndex(O):O)},x=function(T){var k=T.row,O=T.col;return o._createCellCoords(k>=0?o.rowIndexMapper.getVisualFromRenderableIndex(k):k,O>=0?o.columnIndexMapper.getVisualFromRenderableIndex(O):O)},E=new uct(y,{rowIndexMapper:function(){return o.rowIndexMapper},columnIndexMapper:function(){return o.columnIndexMapper},countCols:function(){return o.countCols()},countRows:function(){return o.countRows()},propToCol:function(T){return l.propToCol(T)},isEditorOpened:function(){return o.getActiveEditor()?o.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return o.getShortcutManager()},createCellCoords:function(T,k){return o._createCellCoords(T,k)},createCellRange:function(T,k,O){return o._createCellRange(T,k,O)},visualToRenderableCoords:_,renderableToVisualCoords:x,isDisabledCellSelection:function(T,k){return o.getCellMeta(T,k).disableVisualSelection}});this.selection=E;var R=function(T){var k=T.hiddenIndexesChanged;k&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("beforeSetRangeStart",function(S){n.runHooks("beforeSetRangeStart",S)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(S){n.runHooks("beforeSetRangeStartOnly",S)}),this.selection.addLocalHook("beforeSetRangeEnd",function(S){n.runHooks("beforeSetRangeEnd",S),S.row<0&&(S.row=n.view._wt.wtTable.getFirstVisibleRow()),S.col<0&&(S.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(S){var T=Id(!1),k=n.selection.getSelectedRange(),O=k.current(),D=O.from,L=O.to,B=k.size()-1;n.runHooks("afterSelection",D.row,D.col,L.row,L.col,T,B),n.runHooks("afterSelectionByProp",D.row,o.colToProp(D.col),L.row,o.colToProp(L.col),T,B);var Y=n.selection.isSelectedByAnyHeader(),Q=n.selection.selectedRange.current(),he=!0;a&&(he=!1),T.isTouched()&&(he=!T.value);var ce=n.selection.isSelectedByRowHeader(),le=n.selection.isSelectedByColumnHeader();he!==!1&&(Y?ce?n.view.scrollViewportVertically(o.rowIndexMapper.getRenderableFromVisualIndex(S.row)):le&&n.view.scrollViewportHorizontally(o.columnIndexMapper.getRenderableFromVisualIndex(S.col)):Q&&!n.selection.isMultiple()?n.view.scrollViewport(_(Q.from)):n.view.scrollViewport(_(S))),ce&&le?Ge(n.rootElement,["ht__selection--rows","ht__selection--columns"]):ce?(Vt(n.rootElement,"ht__selection--columns"),Ge(n.rootElement,"ht__selection--rows")):le?(Vt(n.rootElement,"ht__selection--rows"),Ge(n.rootElement,"ht__selection--columns")):Vt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(S){var T=S.length-1,k=S[T],O=k.from,D=k.to;n.runHooks("afterSelectionEnd",O.row,O.col,D.row,D.col,T),n.runHooks("afterSelectionEndByProp",O.row,o.colToProp(O.col),D.row,o.colToProp(D.col),T)}),this.selection.addLocalHook("afterIsMultipleSelection",function(S){var T=n.runHooks("afterIsMultipleSelection",S.value);S.value&&(S.value=T)}),this.selection.addLocalHook("beforeModifyTransformStart",function(S){n.runHooks("modifyTransformStart",S)}),this.selection.addLocalHook("afterModifyTransformStart",function(S,T,k){n.runHooks("afterModifyTransformStart",S,T,k)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(S){n.runHooks("modifyTransformEnd",S)}),this.selection.addLocalHook("afterModifyTransformEnd",function(S,T,k){n.runHooks("afterModifyTransformEnd",S,T,k)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),Vt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(S){n.alter("insert_row_above",S,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(S){n.alter("insert_col_start",S,1,"auto")}),f={alter:function(T,k){var O,D,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,B=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0,Q=function(Ot){if(Ot.length===0)return[];var Et=rp(Ot);Et.sort(function(qt,zt){var Ht=Zs(qt,1),At=Ht[0],st=Zs(zt,1),rt=st[0];return At===rt?0:At>rt?1:-1});var jt=Nn(Et,function(qt,zt){var Ht=Zs(zt,2),At=Ht[0],st=Ht[1],rt=qt[qt.length-1],_t=Zs(rt,2),tt=_t[0],Tt=_t[1],nt=tt+Tt;if(At<=nt){var ht=Math.max(st-(nt-At),0);rt[1]+=ht}else qt.push([At,st]);return qt},[Et[0]]);return jt};switch(T){case"insert_row":fT.has(T)||(fT.add(T),Kr(Wr(DZ||(DZ=NZ(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),T)));case"insert_row_below":case"insert_row_above":var he=o.countSourceRows();if(y.maxRows===he)return;var ce=T==="insert_row_below"?"below":"above";k=(O=k)!==null&&O!==void 0?O:T==="insert_row"||ce==="below"?he:0;var le=l.createRow(k,L,{source:B,mode:ce}),xe=le.delta,U=le.startPhysicalIndex;if(xe){var De=E.selectedRange.current(),de=De==null?void 0:De.from,He=de==null?void 0:de.row,Be=o.toVisualRow(U);if(E.isSelectedByCorner())o.selectAll();else if(dt(He)&&He>=Be){var Ae=De.to,Ke=Ae.row,Xe=Ae.col,G=de.col;E.isSelectedByRowHeader()&&(G=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(o._createCellCoords(He+xe,G),!0),E.setRangeEnd(o._createCellCoords(Ke+xe,Xe))}else o._refreshBorders()}break;case"insert_col":fT.has(T)||(fT.add(T),Kr(Wr($Z||($Z=NZ(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),T)));case"insert_col_start":case"insert_col_end":var q=T==="insert_col_end"?"end":"start";k=(D=k)!==null&&D!==void 0?D:T==="insert_col"||q==="end"?o.countSourceCols():0;var ae=l.createCol(k,L,{source:B,mode:q}),be=ae.delta,se=ae.startPhysicalIndex;if(be){if(Array.isArray(y.colHeaders)){var Oe=[o.toVisualColumn(se),0];Oe.length+=be,Array.prototype.splice.apply(y.colHeaders,Oe)}var pe=E.selectedRange.current(),ge=pe==null?void 0:pe.from,me=ge==null?void 0:ge.col,Ce=o.toVisualColumn(se);if(E.isSelectedByCorner())o.selectAll();else if(dt(me)&&me>=Ce){var Se=pe.to,Le=Se.row,qe=Se.col,Qe=ge.row;E.isSelectedByColumnHeader()&&(Qe=-1),E.getSelectedRange().pop(),E.setRangeStartOnly(o._createCellCoords(Qe,me+be),!0),E.setRangeEnd(o._createCellCoords(Le,qe+be))}else o._refreshBorders()}break;case"remove_row":var wt=function(Ot){var Et=0;ve(Ot,function(jt){var qt=Zs(jt,2),zt=qt[0],Ht=qt[1],At=ei(zt)?o.countRows()-1:Math.max(zt-Et,0);Number.isInteger(zt)&&(zt=Math.max(zt-Et,0));var st=l.removeRow(zt,Ht,B);if(st){var rt=o.countRows(),_t=y.fixedRowsTop;_t>=At+1&&(y.fixedRowsTop-=Math.min(Ht,_t-At));var tt=y.fixedRowsBottom;tt&&At>=rt-tt&&(y.fixedRowsBottom-=Math.min(Ht,tt)),Et+=Ht}})};Array.isArray(k)?wt(Q(k)):wt([[k,L]]),f.adjustRowsAndCols(),o._refreshBorders();break;case"remove_col":var Pt=function(Ot){var Et=0;ve(Ot,function(jt){var qt=Zs(jt,2),zt=qt[0],Ht=qt[1],At=ei(zt)?o.countCols()-1:Math.max(zt-Et,0),st=o.toPhysicalColumn(At);Number.isInteger(zt)&&(zt=Math.max(zt-Et,0));var rt=l.removeCol(zt,Ht,B);if(rt){var _t=y.fixedColumnsStart;_t>=At+1&&(y.fixedColumnsStart-=Math.min(Ht,_t-At)),Array.isArray(y.colHeaders)&&(typeof st>"u"&&(st=-1),y.colHeaders.splice(st,Ht)),Et+=Ht}})};Array.isArray(k)?Pt(Q(k)):Pt([[k,L]]),f.adjustRowsAndCols(),o._refreshBorders();break;default:throw new Error('There is no such action "'.concat(T,'"'))}Y||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var T=y.minRows,k=y.minSpareRows,O=y.minCols,D=y.minSpareCols;if(o.countRows()===0&&o.countCols()===0&&E.deselect(),T){var L=o.countRows();L<T&&l.createRow(L,T-L,{source:"auto"})}if(k){var B=o.countEmptyRows(!0);if(B<k){var Y=k-B,Q=Math.min(Y,y.maxRows-o.countSourceRows());l.createRow(o.countRows(),Q,{source:"auto"})}}{var he;(O||D)&&(he=o.countEmptyCols(!0));var ce=o.countCols();if(O&&!y.columns&&ce<O){var le=O-ce;he+=le,l.createCol(ce,le,{source:"auto"})}if(D&&!y.columns&&o.dataType==="array"&&he<D){ce=o.countCols();var xe=D-he,U=Math.min(xe,y.maxCols-ce);l.createCol(ce,U,{source:"auto"})}}if(E.isSelected()){var De=o.countRows(),de=o.countCols();ve(E.selectedRange,function(He){var Be=!1,Ae=He.from.row,Ke=He.from.col,Xe=He.to.row,G=He.to.col;Ae>De-1?(Ae=De-1,Be=!0,Xe>Ae&&(Xe=Ae)):Xe>De-1&&(Xe=De-1,Be=!0,Ae>Xe&&(Ae=Xe)),Ke>de-1?(Ke=de-1,Be=!0,G>Ke&&(G=Ke)):G>de-1&&(G=de-1,Be=!0,Ke>G&&(Ke=G)),Be&&o.selectCell(Ae,Ke,Xe,G)})}o.view&&o.view.adjustElementsSize()},populateFromArray:function(T,k,O,D,L,B,Y){var Q,he,ce,le,xe=[],U={},De=[],de=T.row,He=T.col;if(he=k.length,he===0)return!1;var Be=0,Ae=0;switch(rr(O)&&(Be=O.col-He+1,Ae=O.row-de+1),L){case"shift_down":var Ke=Kb(k),Xe=Ke.length,G=Math.max(Xe,Be),q=o.getData().slice(de),ae=Kb(q).slice(He,He+G);for(ce=0;ce<G;ce+=1)if(ce<Xe){for(Q=0,he=Ke[ce].length;Q<Ae-he;Q+=1)Ke[ce].push(Ke[ce][Q%he]);ce<ae.length?De.push(Ke[ce].concat(ae[ce])):De.push(Ke[ce].concat(new Array(q.length).fill(null)))}else De.push(Ke[ce%Xe].concat(ae[ce]));o.populateFromArray(de,He,Kb(De));break;case"shift_right":var be=k.length,se=Math.max(be,Ae),Oe=o.getData().slice(de).map(function(_t){return _t.slice(He)});for(Q=0;Q<se;Q+=1)if(Q<be){for(ce=0,le=k[Q].length;ce<Be-le;ce+=1)k[Q].push(k[Q][ce%le]);if(Q<Oe.length)for(var pe=0;pe<Oe[Q].length;pe+=1)k[Q].push(Oe[Q][pe]);else{var ge;(ge=k[Q]).push.apply(ge,rp(new Array(Oe[0].length).fill(null)))}}else k.push(k[Q%he].slice(0,se).concat(Oe[Q]));o.populateFromArray(de,He,k);break;case"overwrite":default:U.row=T.row,U.col=T.col;var me={row:O&&T?O.row-T.row+1:1,col:O&&T?O.col-T.col+1:1},Ce=0,Se=0,Le=!0,qe,Qe=function(tt){var Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,nt=k[tt%k.length];return Tt!==null?nt[Tt%nt.length]:nt},wt=k.length,Pt=O?O.row-T.row+1:0;for(O?he=Pt:he=Math.max(wt,Pt),Q=0;Q<he&&!(O&&U.row>O.row&&Pt>wt||!y.allowInsertRow&&U.row>o.countRows()-1||U.row>=y.maxRows);Q++){var Jt=Q-Ce,Ot=Qe(Jt).length,Et=O?O.col-T.col+1:0;if(O?le=Et:le=Math.max(Ot,Et),U.col=T.col,qe=o.getCellMeta(U.row,U.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&qe.skipRowOnPaste){Ce+=1,U.row+=1,he+=1;continue}for(Se=0,ce=0;ce<le&&!(O&&U.col>O.col&&Et>Ot||!y.allowInsertColumn&&U.col>o.countCols()-1||U.col>=y.maxCols);ce++){if(qe=o.getCellMeta(U.row,U.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&qe.skipColumnOnPaste){Se+=1,U.col+=1,le+=1;continue}if(qe.readOnly&&D!=="UndoRedo.undo"){U.col+=1;continue}var jt=ce-Se,qt=Qe(Jt,jt),zt=o.getDataAtCell(U.row,U.col),Ht={row:Jt,col:jt};if(D==="Autofill.fill"){var At=o.runHooks("beforeAutofillInsidePopulate",Ht,B,k,Y,{},me);At&&(qt=Yr(At.value)?qt:At.value)}if(qt!==null&&Ra(qt)==="object")if(Array.isArray(qt)&&zt===null&&(zt=[]),zt===null||Ra(zt)!=="object")Le=!1;else{var st=_g(Array.isArray(zt)?zt:zt[0]||zt),rt=_g(Array.isArray(qt)?qt:qt[0]||qt);eW(st,rt)||Array.isArray(st)&&Array.isArray(rt)?qt=Ui(qt):Le=!1}else zt!==null&&Ra(zt)==="object"&&(Le=!1);Le&&xe.push([U.row,U.col,qt]),Le=!0,U.col+=1}U.row+=1}o.setDataAtCell(xe,null,null,D||"populateFromArray");break}}};function A(S){var T=fde(S);CU(T)?(o.runHooks("beforeLanguageChange",T),b.language=T,o.runHooks("afterLanguageChange",T)):cde(S)}function N(S,T){var k=S==="className"?o.rootElement:o.table;if(h)Ge(k,T);else{var O=[],D=[];b[S]&&(O=Array.isArray(b[S])?b[S]:oL(b[S])),T&&(D=Array.isArray(T)?T:oL(T));var L=aL(O,D),B=aL(D,O);L.length&&Vt(k,L),B.length&&Ge(k,B)}b[S]=T}this.init=function(){u.setData(y.data),o.runHooks("beforeInit"),(Es()||nW())&&Ge(o.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new wot(this),c=CZe.getInstance(o,y,E),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&o.rootElement.offsetParent===null&&Rce(o.rootElement,function(){o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),Ra(h)==="object"&&(o.runHooks("afterChange",h[0],h[1]),h=!1),o.runHooks("afterInit")};function I(){var S=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,S=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&S===!1&&(S=!0,this.onQueueEmpty(this.valid))}}}function F(S){var T=S.replace(",",".");return isNaN(parseFloat(T))===!1?parseFloat(T):S}function H(S,T,k){if(S.length){var O=o.getActiveEditor(),D=o.runHooks("beforeChange",S,T||"edit"),L=!0;if(D===!1){O&&O.cancelChanges();return}var B=new I;B.onQueueEmpty=function(De){O&&L&&O.cancelChanges(),k(De)};for(var Y=S.length-1;Y>=0;Y--)if(S[Y]===null)S.splice(Y,1);else{var Q=Zs(S[Y],4),he=Q[0],ce=Q[1],le=Q[3],xe=l.propToCol(ce),U=o.getCellMeta(he,xe);U.type==="numeric"&&typeof le=="string"&&Zce(le)&&(S[Y][3]=F(le)),o.getCellValidator(U)&&(B.addValidatorToQueue(),o.validateCell(S[Y][3],U,function(De,de){return function(He){if(typeof He!="boolean")throw new Error("Validation error: result is not boolean");if(He===!1&&de.allowInvalid===!1){L=!1,S.splice(De,1),de.valid=!0;var Be=o.getCell(de.visualRow,de.visualCol);Be!==null&&Vt(Be,y.invalidCellClassName)}B.removeValidatorFormQueue()}}(Y,U),T))}B.checkIfQueueIsEmpty()}}function W(S,T){var k=S.length-1;if(!(k<0)){for(;k>=0;k--){var O=!1;if(S[k]===null){S.splice(k,1);continue}if(!((S[k][2]===null||S[k][2]===void 0)&&(S[k][3]===null||S[k][3]===void 0))){if(y.allowInsertRow)for(;S[k][0]>o.countRows()-1;){var D=l.createRow(void 0,void 0,{source:T}),L=D.delta;if(L===0){O=!0;break}}if(o.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(S[k][1])>o.countCols()-1;){var B=l.createCol(void 0,void 0,{source:T}),Y=B.delta;if(Y===0){O=!0;break}}O||l.set(S[k][0],S[k][1],S[k][3])}}o.forceFullRender=!0,f.adjustRowsAndCols(),o.runHooks("beforeChangeRender",S,T),c.lockEditor(),o._refreshBorders(null),c.unlockEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",S,T||"edit");var Q=o.getActiveEditor();Q&&dt(Q.refreshValue)&&Q.refreshValue()}}this._createCellCoords=function(S,T){return o.view._wt.createCellCoords(S,T)},this._createCellRange=function(S,T,k){return o.view._wt.createCellRange(S,T,k)},this.validateCell=function(S,T,k,O){var D=o.getCellValidator(T);function L(B){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!Y||T.hidden===!0){k(B);return}var Q=T.visualCol,he=T.visualRow,ce=o.getCell(he,Q,!0);if(ce&&ce.nodeName!=="TH"){var le=o.rowIndexMapper.getRenderableFromVisualIndex(he),xe=o.columnIndexMapper.getRenderableFromVisualIndex(Q);o.view._wt.getSetting("cellRenderer",le,xe,ce)}k(B)}yce(D)&&(D=function(B){return function(Y,Q){Q(B.test(Y))}}(D)),Qr(D)?(S=o.runHooks("beforeValidate",S,T.visualRow,T.prop,O),o._registerImmediate(function(){D.call(T,S,function(B){o&&(B=o.runHooks("afterValidate",B,S,T.visualRow,T.prop,O),T.valid=B,L(B),o.runHooks("postAfterValidate",B,S,T.visualRow,T.prop,O))})})):o._registerImmediate(function(){T.valid=!0,L(T.valid,!1)})};function z(S,T,k){return Array.isArray(S)?S:[[S,T,k]]}this.setDataAtCell=function(S,T,k,O){var D=z(S,T,k),L=[],B=O,Y,Q,he;for(Y=0,Q=D.length;Y<Q;Y++){if(Ra(D[Y])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof D[Y][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");D[Y][1]>=this.countCols()?he=D[Y][1]:he=l.colToProp(D[Y][1]),L.push([D[Y][0],he,u.getAtCell(this.toPhysicalRow(D[Y][0]),D[Y][1]),D[Y][2]])}!B&&Ra(S)==="object"&&(B=T),o.runHooks("afterSetDataAtCell",L,B),H(L,B,function(){W(L,B)})},this.setDataAtRowProp=function(S,T,k,O){var D=z(S,T,k),L=[],B=O,Y,Q;for(Y=0,Q=D.length;Y<Q;Y++)L.push([D[Y][0],D[Y][1],u.getAtCell(this.toPhysicalRow(D[Y][0]),D[Y][1]),D[Y][2]]);!B&&Ra(S)==="object"&&(B=T),o.runHooks("afterSetDataAtRowProp",L,B),H(L,B,function(){W(L,B)})},this.listen=function(){o&&!o.isListening()&&(oD=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(oD=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return oD===o.guid},this.destroyEditor=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o._refreshBorders(S,T)},this.populateFromArray=function(S,T,k,O,D,L,B,Y,Q){if(!(Ra(k)==="object"&&Ra(k[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var he=typeof O=="number"?o._createCellCoords(O,D):null;return f.populateFromArray(o._createCellCoords(S,T),k,he,L,B,Y,Q)},this.spliceCol=function(S,T,k){for(var O,D=arguments.length,L=new Array(D>3?D-3:0),B=3;B<D;B++)L[B-3]=arguments[B];return(O=l).spliceCol.apply(O,[S,T,k].concat(L))},this.spliceRow=function(S,T,k){for(var O,D=arguments.length,L=new Array(D>3?D-3:0),B=3;B<D;B++)L[B-3]=arguments[B];return(O=l).spliceRow.apply(O,[S,T,k].concat(L))},this.getSelected=function(){if(E.isSelected())return tr(E.getSelectedRange(),function(S){var T=S.from,k=S.to;return[T.row,T.col,k.row,k.col]})},this.getSelectedLast=function(){var S=this.getSelected(),T;return S&&S.length>0&&(T=S[S.length-1]),T},this.getSelectedRange=function(){if(E.isSelected())return Array.from(E.getSelectedRange())},this.getSelectedRangeLast=function(){var S=this.getSelectedRange(),T;return S&&S.length>0&&(T=S[S.length-1]),T},this.emptySelectedCells=function(S){var T=this;if(!(!E.isSelected()||this.countRows()===0||this.countCols()===0)){var k=[];ve(E.getSelectedRange(),function(O){var D=O.getTopStartCorner(),L=O.getBottomEndCorner();xt(D.row,L.row,function(B){xt(D.col,L.col,function(Y){T.getCellMeta(B,Y).readOnly||k.push([B,Y,null])})})}),k.length>0&&this.setDataAtCell(k,S)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var S=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(S,0),!this.isRenderSuspended()&&S===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(S){this.suspendRender();var T=S();return this.resumeRender(),T},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,T=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(T,0),(!this.isExecutionSuspended()&&T===this.executionSuspendedCounter||S)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var k=S();return this.resumeExecution(T),k},this.batch=function(S){this.suspendRender(),this.suspendExecution();var T=S();return this.resumeExecution(),this.resumeRender(),T},this.refreshDimensions=function(){if(o.view){var S=o.view.getLastSize(),T=S.width,k=S.height,O=o.rootElement.getBoundingClientRect(),D=O.width,L=O.height,B=D!==T||L!==k,Y=o.runHooks("beforeRefreshDimensions",{width:T,height:k},{width:D,height:L},B)===!1;Y||((B||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(D,L),o.render()),o.runHooks("afterRefreshDimensions",{width:T,height:k},{width:D,height:L},B))}},this.updateData=function(S,T){var k=this;RZ(S,function(O){l=O},function(O){l=O,o.columnIndexMapper.fitToLength(k.getInitialColumnCount()),o.rowIndexMapper.fitToLength(k.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:T,metaManager:g,firstRun:h})},this.loadData=function(S,T){RZ(S,function(k){l=k},function(){g.clearCellsCache(),o.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:T,metaManager:g,firstRun:h})},this.getInitialColumnCount=function(){var S=y.columns,T=0;if(Array.isArray(S))T=S.length;else if(Qr(S))if(o.dataType==="array")for(var k=this.countSourceCols(),O=0;O<k;O+=1)S(O)&&(T+=1);else(o.dataType==="object"||o.dataType==="function")&&(T=l.colToPropCache.length);else if(dt(y.dataSchema)){var D=l.getSchema();T=Array.isArray(D)?D.length:lA(D)}else T=this.countSourceCols();return T},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(S,T,k,O){return Yr(S)?l.getAll():l.getRange(o._createCellCoords(S,T),o._createCellCoords(k,O),l.DESTINATION_RENDERER)},this.getCopyableText=function(S,T,k,O){return l.getCopyableText(o._createCellCoords(S,T),o._createCellCoords(k,O))},this.getCopyableData=function(S,T){return l.getCopyable(S,l.colToProp(T))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,k=(h?o.loadData:o.updateData).bind(this),O=!1,D,L;if(dt(S.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(dt(S.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(dt(S.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(D in S)D==="data"||(D==="language"?A(S.language):D==="className"?N("className",S.className):D==="tableClassName"&&o.table?(N("tableClassName",S.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):pt.getSingleton().isRegistered(D)||pt.getSingleton().isDeprecated(D)?(Qr(S[D])||Array.isArray(S[D]))&&(S[D].initialHook=!0,o.addHook(D,S[D])):!T&&On(S,D)&&(b[D]=S[D]));S.data===void 0&&y.data===void 0?k(null,"updateSettings"):S.data!==void 0?k(S.data,"updateSettings"):S.columns!==void 0&&(l.createMap(),o.initIndexMappers());var B=o.countCols(),Y=y.columns;if(Y&&Qr(Y)&&(O=!0),(S.cell!==void 0||S.cells!==void 0||S.columns!==void 0)&&g.clearCache(),B>0)for(D=0,L=0;D<B;D++){if(Y){var Q=O?Y(D):Y[L];Q&&g.updateColumnMeta(L,Q)}L+=1}dt(S.cell)&&nr(S.cell,function(De){o.setCellMetaObject(De.row,De.col,De)}),o.runHooks("afterCellMetaReset");var he=o.rootElement.style.height;he!==""&&(he=parseInt(o.rootElement.style.height,10));var ce=S.height;if(Qr(ce)&&(ce=ce()),T){var le=o.rootElement.getAttribute("style");le&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(ce===null){var xe=o.rootElement.getAttribute("data-initialstyle");xe&&(xe.indexOf("height")>-1||xe.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",xe):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else ce!==void 0&&(o.rootElement.style.height=isNaN(ce)?"".concat(ce):"".concat(ce,"px"),o.rootElement.style.overflow="hidden");if(typeof S.width<"u"){var U=S.width;Qr(U)&&(U=U()),o.rootElement.style.width=isNaN(U)?"".concat(U):"".concat(U,"px")}T||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",S)),f.adjustRowsAndCols(),o.view&&!h&&(o.forceFullRender=!0,c.lockEditor(),o._refreshBorders(null),o.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!T&&o.view&&(he===""||ce===""||ce===void 0)&&he!==ce&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var S=o.getSelectedLast();if(y.getValue){if(Qr(y.getValue))return y.getValue.call(o);if(S)return o.getData()[S[0][0]][y.getValue]}else if(S)return o.getDataAtCell(S[0],S[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(S,T,k,O,D){f.alter(S,T,k,O,D)},this.getCell=function(S,T){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=T,D=S;if(T>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(T)))return null;O=this.columnIndexMapper.getRenderableFromVisualIndex(T)}if(S>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(S)))return null;D=this.rowIndexMapper.getRenderableFromVisualIndex(S)}return D===null||O===null?null:o.view.getCellAtCoords(o._createCellCoords(D,O),k)},this.getCoords=function(S){var T=this.view._wt.wtTable.getCoords(S);if(T===null)return null;var k=T.row,O=T.col,D=k,L=O;return k>=0&&(D=this.rowIndexMapper.getVisualFromRenderableIndex(k)),O>=0&&(L=this.columnIndexMapper.getVisualFromRenderableIndex(O)),o._createCellCoords(D,L)},this.colToProp=function(S){return l.colToProp(S)},this.propToCol=function(S){return l.propToCol(S)},this.toVisualRow=function(S){return n.rowIndexMapper.getVisualFromPhysicalIndex(S)},this.toVisualColumn=function(S){return n.columnIndexMapper.getVisualFromPhysicalIndex(S)},this.toPhysicalRow=function(S){return n.rowIndexMapper.getPhysicalFromVisualIndex(S)},this.toPhysicalColumn=function(S){return n.columnIndexMapper.getPhysicalFromVisualIndex(S)},this.getDataAtCell=function(S,T){return l.get(S,l.colToProp(T))},this.getDataAtRowProp=function(S,T){return l.get(S,T)},this.getDataAtCol=function(S){for(var T=[],k=l.getRange(o._createCellCoords(0,S),o._createCellCoords(y.data.length-1,S),l.DESTINATION_RENDERER),O=0;O<k.length;O+=1)for(var D=0;D<k[O].length;D+=1)T.push(k[O][D]);return T},this.getDataAtProp=function(S){for(var T=[],k=l.getRange(o._createCellCoords(0,l.propToCol(S)),o._createCellCoords(y.data.length-1,l.propToCol(S)),l.DESTINATION_RENDERER),O=0;O<k.length;O+=1)for(var D=0;D<k[O].length;D+=1)T.push(k[O][D]);return T},this.getSourceData=function(S,T,k,O){var D;return S===void 0?D=u.getData():D=u.getByRange(o._createCellCoords(S,T),o._createCellCoords(k,O)),D},this.getSourceDataArray=function(S,T,k,O){var D;return S===void 0?D=u.getData(!0):D=u.getByRange(o._createCellCoords(S,T),o._createCellCoords(k,O),!0),D},this.getSourceDataAtCol=function(S){return u.getAtColumn(S)},this.setSourceDataAtCell=function(S,T,k,O){var D=z(S,T,k),L=this.hasHook("afterSetSourceDataAtCell"),B=[];L&&ve(D,function(Q){var he=Zs(Q,3),ce=he[0],le=he[1],xe=he[2];B.push([ce,le,u.getAtCell(ce,le),xe])}),ve(D,function(Q){var he=Zs(Q,3),ce=he[0],le=he[1],xe=he[2];u.setAtCell(ce,le,xe)}),L&&this.runHooks("afterSetSourceDataAtCell",B,O),this.render();var Y=o.getActiveEditor();Y&&dt(Y.refreshValue)&&Y.refreshValue()},this.getSourceDataAtRow=function(S){return u.getAtRow(S)},this.getSourceDataAtCell=function(S,T){return u.getAtCell(S,T)},this.getDataAtRow=function(S){var T=l.getRange(o._createCellCoords(S,0),o._createCellCoords(S,this.countCols()-1),l.DESTINATION_RENDERER);return T[0]||[]},this.getDataType=function(S,T,k,O){var D=this,L=S===void 0?[0,0,this.countRows(),this.countCols()]:[S,T,k,O],B=L[0],Y=L[1],Q=L[2],he=L[3],ce=null,le=null;Q===void 0&&(Q=B),he===void 0&&(he=Y);var xe="mixed";return xt(Math.max(Math.min(B,Q),0),Math.max(B,Q),function(U){var De=!0;return xt(Math.max(Math.min(Y,he),0),Math.max(Y,he),function(de){var He=D.getCellMeta(U,de);return le=He.type,ce?De=ce===le:ce=le,De}),xe=De?le:"mixed",De}),xe},this.removeCellMeta=function(S,T,k){var O=[this.toPhysicalRow(S),this.toPhysicalColumn(T)],D=O[0],L=O[1],B=g.getCellMetaKeyValue(D,L,k),Y=o.runHooks("beforeRemoveCellMeta",S,T,k,B);Y!==!1&&(g.removeCellMeta(D,L,k),o.runHooks("afterRemoveCellMeta",S,T,k,B)),B=null},this.spliceCellsMeta=function(S){for(var T=this,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=arguments.length,D=new Array(O>2?O-2:0),L=2;L<O;L++)D[L-2]=arguments[L];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");k>0&&g.removeRow(this.toPhysicalRow(S),k),D.length>0&&ve(D.reverse(),function(B){g.createRow(T.toPhysicalRow(S)),ve(B,function(Y,Q){return T.setCellMetaObject(S,Q,Y)})}),o.render()},this.setCellMetaObject=function(S,T,k){var O=this;Ra(k)==="object"&&nr(k,function(D,L){O.setCellMeta(S,T,L,D)})},this.setCellMeta=function(S,T,k,O){var D=o.runHooks("beforeSetCellMeta",S,T,k,O);if(D!==!1){var L=S,B=T;S<this.countRows()&&(L=this.toPhysicalRow(S)),T<this.countCols()&&(B=this.toPhysicalColumn(T)),g.setCellMeta(L,B,k,O),o.runHooks("afterSetCellMeta",S,T,k,O)}},this.getCellsMeta=function(){return g.getCellsMeta()},this.getCellMeta=function(S,T){var k=this.toPhysicalRow(S),O=this.toPhysicalColumn(T);return k===null&&(k=S),O===null&&(O=T),g.getCellMeta(k,O,{visualRow:S,visualColumn:T})},this.getCellMetaAtRow=function(S){return g.getCellsMetaAtRow(S)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||y.columns)},this.getCellRenderer=function(S,T){var k=typeof S=="number"?o.getCellMeta(S,T).renderer:S.renderer;return typeof k=="string"?qE(k):Yr(k)?qE("text"):k},this.getCellEditor=function(S,T){var k=typeof S=="number"?o.getCellMeta(S,T).editor:S.editor;return typeof k=="string"?KE(k):Yr(k)?KE("text"):k},this.getCellValidator=function(S,T){var k=typeof S=="number"?o.getCellMeta(S,T).validator:S.validator;return typeof k=="string"?LW(k):k},this.validateCells=function(S){this._validateCells(S)},this.validateRows=function(S,T){if(!Array.isArray(S))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(T,S)},this.validateColumns=function(S,T){if(!Array.isArray(S))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(T,void 0,S)},this._validateCells=function(S,T,k){var O=new I;S&&(O.onQueueEmpty=S);for(var D=o.countRows()-1;D>=0;){if(T!==void 0&&T.indexOf(D)===-1){D-=1;continue}for(var L=o.countCols()-1;L>=0;){if(k!==void 0&&k.indexOf(L)===-1){L-=1;continue}O.addValidatorToQueue(),o.validateCell(o.getDataAtCell(D,L),o.getCellMeta(D,L),function(B){if(typeof B!="boolean")throw new Error("Validation error: result is not boolean");B===!1&&(O.valid=!1),O.removeValidatorFormQueue()},"validateCells"),L-=1}D-=1}O.checkIfQueueIsEmpty()},this.getRowHeader=function(S){var T=y.rowHeaders,k=S;return k!==void 0&&(k=o.runHooks("modifyRowHeader",k)),k===void 0?(T=[],xt(o.countRows()-1,function(O){T.push(o.getRowHeader(O))})):Array.isArray(T)&&T[k]!==void 0?T=T[k]:Qr(T)?T=T(k):T&&typeof T!="string"&&typeof T!="number"&&(T=k+1),T},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(var S=0,T=o.countCols();S<T;S++)if(o.getColHeader(S))return!0;return!1},this.getColHeader=function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,k=o.runHooks("modifyColHeader",S);if(k===void 0){for(var O=[],D=o.countCols(),L=0;L<D;L++)O.push(o.getColHeader(L));return O}var B=y.colHeaders,Y=function(le){for(var xe=[],U=o.countCols(),De=0;De<U;De++)Qr(y.columns)&&y.columns(De)&&xe.push(De);return xe[le]},Q=o.toPhysicalColumn(k),he=Y(Q);return y.colHeaders===!1?B=null:y.columns&&Qr(y.columns)&&y.columns(he)&&y.columns(he).title?B=y.columns(he).title:y.columns&&y.columns[Q]&&y.columns[Q].title?B=y.columns[Q].title:Array.isArray(y.colHeaders)&&y.colHeaders[Q]!==void 0?B=y.colHeaders[Q]:Qr(y.colHeaders)?B=y.colHeaders(Q):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(B=EA(k)),B=o.runHooks("modifyColumnHeaderValue",B,S,T),B},this._getColWidthFromSettings=function(S){var T;if(S>=0){var k=o.getCellMeta(0,S);T=k.width}if((T===void 0||T===y.width)&&(T=y.colWidths),T!=null){switch(Ra(T)){case"object":T=T[S];break;case"function":T=T(S);break}typeof T=="string"&&(T=parseInt(T,10))}return T},this.getColWidth=function(S){var T=o._getColWidthFromSettings(S);return T=o.runHooks("modifyColWidth",T,S),T===void 0&&(T=FW.DEFAULT_WIDTH),T},this._getRowHeightFromSettings=function(S){var T=y.rowHeights;if(T!=null){switch(Ra(T)){case"object":T=T[S];break;case"function":T=T(S);break}typeof T=="string"&&(T=parseInt(T,10))}return T},this.getRowHeight=function(S){var T=o._getRowHeightFromSettings(S);return T=o.runHooks("modifyRowHeight",T,S),T},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var S=y.maxCols,T=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(S,T)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,T=0;return XE(o.countRows()-1,function(k){if(o.isEmptyRow(k))T+=1;else if(S===!0)return!1}),T},this.countEmptyCols=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,T=0;return XE(o.countCols()-1,function(k){if(o.isEmptyCol(k))T+=1;else if(S===!0)return!1}),T},this.isEmptyRow=function(S){return y.isEmptyRow.call(o,S)},this.isEmptyCol=function(S){return y.isEmptyCol.call(o,S)},this.selectCell=function(S,T,k,O){var D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,L=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Yr(S)||Yr(T)?!1:this.selectCells([[S,T,k,O]],D,L)},this.selectCells=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;T===!1&&(a=!0);var O=E.selectCells(S);return O&&k&&o.listen(),a=!1,O},this.selectColumns=function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S;return E.selectColumns(S,T)},this.selectRows=function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S;return E.selectRows(S,T)},this.deselectCell=function(){E.deselect()},this.selectAll=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,T=S&&this.hasRowHeaders(),k=S&&this.hasColHeaders();a=!0,E.selectAll(T,k),a=!1};var te=function(T,k){return T.getNearestNotHiddenIndex(k,1,!0)};this.scrollViewportTo=function(S,T){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,L=!k,B=!O,Y=S,Q=T;if(D){var he=Number.isInteger(S),ce=Number.isInteger(T),le=he?te(this.rowIndexMapper,S):void 0,xe=ce?te(this.columnIndexMapper,T):void 0;if(le===null||xe===null)return!1;Y=he?o.rowIndexMapper.getRenderableFromVisualIndex(le):void 0,Q=ce?o.columnIndexMapper.getRenderableFromVisualIndex(xe):void 0}var U=Number.isInteger(Y),De=Number.isInteger(Q);return U&&De?o.view.scrollViewport(o._createCellCoords(Y,Q),L,O,k,B):U&&De===!1?o.view.scrollViewportVertically(Y,L,k):De&&U===!1?o.view.scrollViewportHorizontally(Q,O,B):!1},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),g.clearCache(),sF(o)){var S=this.rootDocument.querySelector(".hot-display-license-info");S&&S.parentNode.removeChild(S)}$s(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(function(){o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),w.getItems().forEach(function(T){var k=Zs(T,2),O=k[1];O.destroy()}),w.clear(),o.runHooks("afterDestroy")},!0),pt.getSingleton().destroy(o),nr(o,function(T,k,O){Qr(T)?O[k]=ie(k):k!=="guid"&&(O[k]=null)}),o.isDestroyed=!0,l&&l.destroy(),o.rowIndexMapper=null,o.columnIndexMapper=null,l=null,f=null,E=null,c=null,o=null};function ie(S){return function(){throw new Error('The "'.concat(S,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(S){var T=La(S);return T==="UndoRedo"?this.undoRedo:w.getItem(T)},this.getPluginName=function(S){return S===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:w.getId(S)},this.getInstance=function(){return o},this.addHook=function(S,T){pt.getSingleton().add(S,T,o)},this.hasHook=function(S){return pt.getSingleton().has(S,o)||pt.getSingleton().has(S)},this.addHookOnce=function(S,T){pt.getSingleton().once(S,T,o)},this.removeHook=function(S,T){pt.getSingleton().remove(S,T,o)},this.runHooks=function(S,T,k,O,D,L,B){return pt.getSingleton().run(o,S,T,k,O,D,L,B)},this.getTranslatedPhrase=function(S,T){return mde(y.language,S,T)},this.toHTML=function(){return IL(n)},this.toTableElement=function(){var S=n.rootDocument.createElement("div");return S.insertAdjacentHTML("afterbegin",IL(n)),S.firstElementChild},this.timeouts=[],this._registerTimeout=function(S){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=S;typeof k=="function"&&(k=setTimeout(k,T)),this.timeouts.push(k)},this._clearTimeouts=function(){ve(this.timeouts,function(S){clearTimeout(S)})},this.immediates=[],this._registerImmediate=function(S){this.immediates.push(setImmediate(S))},this._clearImmediates=function(){ve(this.immediates,function(S){clearImmediate(S)})},this._refreshBorders=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(S),o.view.render(),T&&E.isSelected()&&c.prepareEditor()},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};var fe=Uht({handleEvent:function(T){var k=o.isListening(),O=(T==null?void 0:T.key)!==void 0;return k&&O},beforeKeyDown:function(T){return n.runHooks("beforeKeyDown",T)},afterKeyDown:function(T){n.isDestroyed||o.runHooks("afterDocumentKeyDown",T)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(S){S.ctrlKey===!1&&S.metaKey===!1&&fe.releasePressedKeys()}),this.getShortcutManager=function(){return fe};var Te=fe.addContext("grid"),M={runOnlyIf:function(){return dt(o.getSelected())&&o.countRenderedRows()>0&&o.countRenderedCols()>0},group:qht};fe.setActiveContextName("grid"),Te.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){o.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var T=o.getSelectedRange(),k=T[T.length-1].highlight,O=k.row,D=k.col,L=o.getDataAtCell(O,D),B=new Map,Y=0;Y<T.length;Y++)T[Y].forAll(function(Q,he){if(Q>=0&&he>=0&&(Q!==O||he!==D)){var ce=o.getCellMeta(Q,he),le=ce.readOnly;le||B.set("".concat(Q,"x").concat(he),[Q,he,L])}});o.setDataAtCell(Array.from(B.values()))},runOnlyIf:function(){return o.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){E.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(0,1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){E.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var T=o.getSelectedRangeLast(),k=T.from,O=T.to,D=o.rowIndexMapper.getNearestNotHiddenIndex(0,1);E.setRangeStart(k.clone()),E.setRangeEnd(o._createCellCoords(D,O.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){E.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){E.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){E.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var T=o.getSelectedRangeLast(),k=T.from,O=T.to,D=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1);E.setRangeStart(k.clone()),E.setRangeEnd(o._createCellCoords(D,O.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){E.transformStart(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var T,k=o.getSelectedRangeLast().highlight.row,O=(T=o.columnIndexMapper).getNearestNotHiddenIndex.apply(T,rp(o.isRtl()?[o.countCols()-1,-1]:[0,1]));E.setRangeStart(o._createCellCoords(k,O))}},{keys:[["ArrowLeft","Shift"]],callback:function(){E.transformEnd(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var T,k=o.getSelectedRangeLast(),O=k.from,D=k.to,L=(T=o.columnIndexMapper).getNearestNotHiddenIndex.apply(T,rp(o.isRtl()?[o.countCols()-1,-1]:[0,1]));E.setRangeStart(O.clone()),E.setRangeEnd(o._createCellCoords(D.row,L))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){E.transformStart(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var T,k=o.getSelectedRangeLast().highlight.row,O=(T=o.columnIndexMapper).getNearestNotHiddenIndex.apply(T,rp(o.isRtl()?[0,1]:[o.countCols()-1,-1]));E.setRangeStart(o._createCellCoords(k,O))}},{keys:[["ArrowRight","Shift"]],callback:function(){E.transformEnd(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var T,k=o.getSelectedRangeLast(),O=k.from,D=k.to,L=(T=o.columnIndexMapper).getNearestNotHiddenIndex.apply(T,rp(o.isRtl()?[0,1]:[o.countCols()-1,-1]));E.setRangeStart(O.clone()),E.setRangeEnd(o._createCellCoords(D.row,L))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var T=parseInt(o.getSettings().fixedColumnsStart,10),k=o.getSelectedRangeLast().highlight.row,O=o.columnIndexMapper.getNearestNotHiddenIndex(T,1);E.setRangeStart(o._createCellCoords(k,O))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){E.setRangeEnd(o._createCellCoords(E.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var T=parseInt(o.getSettings().fixedRowsTop,10),k=parseInt(o.getSettings().fixedColumnsStart,10),O=o.rowIndexMapper.getNearestNotHiddenIndex(T,1),D=o.columnIndexMapper.getNearestNotHiddenIndex(k,1);E.setRangeStart(o._createCellCoords(O,D))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){E.setRangeStart(o._createCellCoords(o.getSelectedRangeLast().highlight.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){E.setRangeEnd(o._createCellCoords(E.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var T=parseInt(o.getSettings().fixedRowsBottom,10),k=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-T-1,-1),O=o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1);E.setRangeStart(o._createCellCoords(k,O))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){E.transformStart(-o.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var T=o.getSelectedRangeLast(),k=T.to,O=Math.max(k.row-o.countVisibleRows(),0),D=o.rowIndexMapper.getNearestNotHiddenIndex(O,1);if(D!==null){var L=o._createCellCoords(D,k.col),B=k.row-o.view.getFirstFullyVisibleRow(),Y=Math.max(L.row-B,0);E.setRangeEnd(L),o.scrollViewportTo(Y)}}},{keys:[["PageDown"]],callback:function(){E.transformStart(o.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var T=o.getSelectedRangeLast(),k=T.to,O=Math.min(k.row+o.countVisibleRows(),o.countRows()-1),D=o.rowIndexMapper.getNearestNotHiddenIndex(O,-1);if(D!==null){var L=o._createCellCoords(D,k.col),B=k.row-o.view.getFirstFullyVisibleRow(),Y=Math.min(L.row-B,o.countRows()-1);E.setRangeEnd(L),o.scrollViewportTo(Y)}}},{keys:[["Tab"]],callback:function(T){var k=typeof y.tabMoves=="function"?y.tabMoves(T):y.tabMoves;E.transformStart(k.row,k.col,!0)}},{keys:[["Shift","Tab"]],callback:function(T){var k=typeof y.tabMoves=="function"?y.tabMoves(T):y.tabMoves;E.transformStart(-k.row,-k.col)}}],M),NW().forEach(function(S){var T=N1(S);w.addItem(S,new T(n))}),pt.getSingleton().run(o,"construct")}var Zht="hooksRefRegisterer",Lde={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;ve(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;nr(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};El(Lde,"MIXIN_NAME",Zht,{writable:!1,enumerable:!1});const Jht=Lde;function ny(e){return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(e)}function Qht(e,t){return ndt(e)||rdt(e,t)||tdt(e,t)||edt()}function edt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tdt(e,t){if(e){if(typeof e=="string")return LZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LZ(e,t)}}function LZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rdt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ndt(e){if(Array.isArray(e))return e}function idt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$F(e,t)}function $F(e,t){return $F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$F(e,t)}function adt(e){var t=ldt();return function(){var n=kR(e),i;if(t){var a=kR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return odt(this,i)}}function odt(e,t){if(t&&(ny(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sdt(e)}function sdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ldt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kR(e){return kR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kR(e)}function FZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,udt(n.key),n)}}function BZ(e,t,r){return t&&HZ(e.prototype,t),r&&HZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function udt(e){var t=fdt(e,"string");return ny(t)==="symbol"?t:String(t)}function fdt(e,t){if(ny(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ny(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cdt="base",pi=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),NF="baseEditor",Ym=function(){function e(t){FZ(this,e),this.hot=t,this.instance=t,this.state=pi.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return BZ(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,a,o,s){this.TD=a,this.row=r,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=pi.VIRGIN}},{key:"extend",value:function(){return function(r){idt(i,r);var n=adt(i);function i(){return FZ(this,i),n.apply(this,arguments)}return BZ(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,a,o,s,l;if(n){var u=this.hot.getSelectedLast();a=Math.max(Math.min(u[0],u[2]),0),o=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];a=f[0],o=f[1],s=f[2],l=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",a,o);if(Array.isArray(c)){var h=Qht(c,2);a=h[0],o=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),g={runOnlyIf:function(){return dt(i.hot.getSelected())},group:NF};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],g),this.hot.populateFromArray(a,o,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===pi.VIRGIN){var i=this.hot,a=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(a,o)),this.state=pi.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:En(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var a=this,o;if(i){var s=this._closeCallback;this._closeCallback=function(c){s&&s(c),i(c),a.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(NF),u.removeShortcutsByGroup(TA),this.state===pi.VIRGIN){this.hot._registerTimeout(function(){a._fireCallbacks(!0)});return}if(this.state===pi.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:o=[[f]],this.state=pi.WAITING,this.saveValue(o,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){a.state=pi.FINISHED,a.discardEditor(c)}):(this.state=pi.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=pi.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===pi.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=pi.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=pi.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===pi.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,a=i.wtOverlays,o=i.wtViewport,s=this.hot.rootWindow,l=jn(n),u=jr(n),f=jn(this.hot.rootElement),c=jr(this.hot.rootElement),h=a.topOverlay.holder,d=a.inlineStartOverlay.holder,v=h!==s?h.scrollTop:0,g=d!==s?d.scrollLeft:0,y=s.innerWidth-f.left-c,b=(r=a.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,w=b.wtTable,_=w.name,x=["master","inline_start"].includes(_)?v:0,E=["master","top","bottom"].includes(_)?g:0,R=l.top===f.top?0:1,A=l.top-f.top-R-x,N=0;this.hot.isRtl()?N=s.innerWidth-l.left-u-y-1+E:N=l.left-f.left-1-E,["top","top_inline_start_corner"].includes(_)&&(A+=a.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(_)&&(N+=Math.abs(a.inlineStartOverlay.getOverlayOffset()));var I=this.hot.hasColHeaders(),F=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),H=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength(),z=W-this.hot.view._wt.getSetting("fixedRowsBottom");(I&&F<=0||F===z)&&(A+=1),H<=0&&(N+=1);var te=o.rowsRenderCalculator.startPosition,ie=o.columnsRenderCalculator.startPosition,fe=Math.abs(a.inlineStartOverlay.getScrollPosition()),Te=a.topOverlay.getScrollPosition(),M=hi(this.hot.rootDocument),S=n.offsetTop+te-Te,T=0;if(this.hot.isRtl()){var k=n.offsetLeft;k>=0?T=w.getWidth()-n.offsetLeft:T=Math.abs(k),T+=ie-fe-u}else T=n.offsetLeft+ie-fe;var O=Ec(this.TD,this.hot.rootWindow),D=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(O[D],10)>0?0:1,B=parseInt(O.borderTopWidth,10)>0?0:1,Y=jr(n)+L,Q=mn(n)+B,he=Tce(h)?M:0,ce=Oce(d)?M:0,le=this.hot.view.maximumVisibleElementWidth(T)-he+L,xe=Math.max(this.hot.view.maximumVisibleElementHeight(S)-ce+B,23);return{top:A,start:N,height:Q,maxHeight:xe,width:Y,maxWidth:le}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return cdt}}]),e}();qr(Ym,Jht);function hdt(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),a=function(d,v,g){d.addEventListener(v,g,!1)},o=function(d,v,g){d.removeEventListener(v,g,!1)},s=function(d){var v,g;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,i.style.position="absolute",i.style.fontSize=c(t).fontSize,i.style.fontFamily=c(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),v=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",g=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>g?t.style.height=e.minHeight+"px":e.maxHeight<g?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=g+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var g=parseInt(d.maxHeight);isNaN(g)||(e.maxHeight=g)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var y=parseInt(d.minWidth);isNaN(y)||(e.minWidth=y)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var b=parseInt(d.maxWidth);isNaN(b)||(e.maxWidth=b)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},f=function(d,v,g){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),g&&(a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)),s()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,g){f(d,v,g)},unObserve:function(){o(t,"change",s),o(t,"cut",l),o(t,"paste",l),o(t,"drop",l),o(t,"keydown",l),o(t,"focus",s),o(t,"compositionstart",l),o(t,"compositionupdate",l),o(t,"compositionend",l)},resize:s}}function WZ(e,t){for(var r=RW(t),n=t.value.split(`
`),i=r,a=0,o=0;o<n.length;o++){var s=n[o];o!==0&&(a+=n[o-1].length+1);var l=a+s.length;if(e==="home"?i=a:e==="end"&&(i=l),r<=l)break}I1(t,i)}function iy(e){return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iy(e)}function VZ(e,t){return gdt(e)||pdt(e,t)||vdt(e,t)||ddt()}function ddt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vdt(e,t){if(e){if(typeof e=="string")return UZ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UZ(e,t)}}function UZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pdt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function gdt(e){if(Array.isArray(e))return e}function ydt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bdt(n.key),n)}}function mdt(e,t,r){return t&&jZ(e.prototype,t),r&&jZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bdt(e){var t=wdt(e,"string");return iy(t)==="symbol"?t:String(t)}function wdt(e,t){if(iy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iw(){return typeof Reflect<"u"&&Reflect.get?iw=Reflect.get.bind():iw=function(t,r,n){var i=_dt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},iw.apply(this,arguments)}function _dt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hd(e),e!==null););return e}function Sdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LF(e,t)}function LF(e,t){return LF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LF(e,t)}function Cdt(e){var t=Tdt();return function(){var n=Hd(e),i;if(t){var a=Hd(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return xdt(this,i)}}function xdt(e,t){if(t&&(iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fde(e)}function Fde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hd(e){return Hd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hd(e)}var Odt="ht_editor_visible",cT="ht_editor_hidden",zZ="textEditor",Edt="text",uv=function(e){Sdt(r,e);var t=Cdt(r);function r(n){var i;return ydt(this,r),i=t.call(this,n),i.eventManager=new bn(Fde(i)),i.autoResize=hdt(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return mdt(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var a=this.hot.getShortcutManager();a.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this.state;if(iw(Hd(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==pi.FINISHED&&this.hideEditableElement();var d=!h;d&&!Es()&&this.focus()}}},{key:"beginEditing",value:function(i,a){this.state===pi.VIRGIN&&(this.TEXTAREA.value="",iw(Hd(r.prototype),"beginEditing",this).call(this,i,a))}},{key:"focus",value:function(){this.TEXTAREA.select(),I1(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ge(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),Ge(this.TEXTAREA_PARENT,"handsontableInputHolder"),Wt(this.TEXTAREA_PARENT,this.layerClass)&&Vt(this.TEXTAREA_PARENT,this.layerClass),Ge(this.TEXTAREA_PARENT,cT),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(wfe()||bfe())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Vt(this.TEXTAREA_PARENT,this.layerClass),Ge(this.TEXTAREA_PARENT,cT)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,a=!1;xt(i.length-1,function(o){var s=i[o];if(Wt(s,"handsontableEditor"))return a=!0,!1}),Wt(this.TEXTAREA_PARENT,cT)&&Vt(this.TEXTAREA_PARENT,cT),a?(this.layerClass=Odt,Ge(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ge(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),a=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=a,this.setValue(a),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==pi.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var a=this.getEditedCellRect(),o=a.top,s=a.start,l=a.width,u=a.maxWidth,f=a.height,c=a.maxHeight;this.textareaParentStyle.top="".concat(o,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var h=Ec(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ec(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),g=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),y=l-v,b=f-g,w=u-v,_=c-g;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(y,w),minHeight:Math.min(b,_),maxWidth:w,maxHeight:_},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(a){return a.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(a){return a.stopPropagation()}),rW()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={runOnlyIf:function(){return dt(i.hot.getSelected())},group:zZ},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};o.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(f){return!i.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:ew,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:ew,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:ew,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=VZ(c,1),d=h[0];WZ(d,i.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=VZ(c,1),d=h[0];WZ(d,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(TA),a.removeShortcutsByGroup(zZ),a.removeShortcutsByGroup(NF)}},{key:"onAfterDocumentKeyDown",value:function(i){var a=[yt.ARROW_UP,yt.ARROW_RIGHT,yt.ARROW_DOWN,yt.ARROW_LEFT];a.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return Edt}}]),r}(Ym),Rdt="base";function j1(e,t,r,n,i,a,o){var s=[],l=[];o.className&&Ge(t,o.className),o.readOnly&&s.push(o.readOnlyCellClassName),o.valid===!1&&o.invalidCellClassName?s.push(o.invalidCellClassName):l.push(o.invalidCellClassName),o.wordWrap===!1&&o.noWordWrapClassName&&s.push(o.noWordWrapClassName),!a&&o.placeholder&&s.push(o.placeholderCellClassName),Vt(t,l),Ge(t,s)}j1.RENDERER_TYPE=Rdt;var kdt="text";function Nc(e,t,r,n,i,a,o){j1.apply(this,[e,t,r,n,i,a,o]);var s=a;if(!s&&o.placeholder&&(s=o.placeholder),s=En(s),o.trimWhitespace&&(s=s.trim()),o.rendererTemplate){$s(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else Oc(t,s)}Nc.RENDERER_TYPE=kdt;var Adt="text",Hde={CELL_TYPE:Adt,editor:uv,renderer:Nc};bs(Hde);It.editors={BaseEditor:Ym};function It(e,t){var r=new RU(e,t||{},qW);return r.init(),r}It.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new RU(e,t,qW)};It.DefaultSettings=Ade();It.hooks=pt.getSingleton();It.CellCoords=ZE;It.CellRange=HW;It.packageName="handsontable";It.buildDate="28/03/2023 12:24:11";It.version="12.3.3";It.languages={dictionaryKeys:Zlt,getLanguageDictionary:yde,getLanguagesDictionaries:aut,registerLanguageDictionary:gde,getTranslatedPhrase:mde};var Qp=Symbol("unassigned"),Pdt="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function AR(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Bde(e){var t=It.hooks.getRegistered(),r={};Object.assign(r,It.DefaultSettings);for(var n in r)r[n]={default:Qp};for(var i=0;i<t.length;i++)r[t[i]]={default:Qp};return r.settings={default:Qp},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function Wde(e){var t={},r=e.settings;if(r!==Qp)for(var n in r)AR(r,n)&&r[n]!==Qp&&(t[n]=r[n]);for(var i in e)AR(e,i)&&i!=="settings"&&e[i]!==Qp&&(t[i]=e[i]);return t}function GZ(e,t){var r=Wde(e),n=e.settings?e.settings:r,i=e.settings?r:null,a={};for(var o in n)AR(n,o)&&n[o]!==void 0&&(!(t&&o!=="data")||!YZ(t[o],n[o]))&&(a[o]=n[o]);for(var s in i)AR(i,s)&&s!=="id"&&s!=="settings"&&i[s]!==void 0&&(!(t&&s!=="data")||!YZ(t[s],i[s]))&&(a[s]=i[s]);return a}function YZ(e,t){return JSON.stringify(e)===JSON.stringify(t)}var Idt="12.3.3",kU=ba({name:"HotTable",props:Bde("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=GZ(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Pdt),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=GZ(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=nCe(new It.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],i=[],a=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),o=this.hotInstance.isColumnModificationAllowed(),s=0;if(r&&r.length!==a&&r.length<a)for(var l=r.length;l<a;l++)n.push(l);if(o){var u;if(s=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==s&&r[0].length<s)for(var f=r[0].length;f<s;f++)i.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(a-1,r.length-a),o&&r.length!==0&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(s-1,r[0].length-s))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:Idt}),Mdt=["id"];function Ddt(e,t,r,n,i,a){return Cr(),Gr("div",{id:e.id},[Dne(e.$slots,"default")],8,Mdt)}kU.render=Ddt;kU.__file="src/HotTable.vue";function KZ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $dt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KZ(Object(r),!0).forEach(function(n){Ndt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KZ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ndt(e,t,r){return t=Fdt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ldt(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fdt(e){var t=Ldt(e,"string");return typeof t=="symbol"?t:String(t)}var Hdt=ba({name:"HotColumn",props:Bde("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=Wde(this.$props),r=$dt({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});Hdt.__file="src/HotColumn.vue";function ay(e){return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ay(e)}function Bdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vdt(n.key),n)}}function Wdt(e,t,r){return t&&XZ(e.prototype,t),r&&XZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vdt(e){var t=Udt(e,"string");return ay(t)==="symbol"?t:String(t)}function Udt(e,t){if(ay(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ws(){return typeof Reflect<"u"&&Reflect.get?ws=Reflect.get.bind():ws=function(t,r,n){var i=jdt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ws.apply(this,arguments)}function jdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ja(e),e!==null););return e}function zdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FF(e,t)}function FF(e,t){return FF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FF(e,t)}function Gdt(e){var t=Xdt();return function(){var n=Ja(e),i;if(t){var a=Ja(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ydt(this,i)}}function Ydt(e,t){if(t&&(ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kdt(e)}function Kdt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ja(e){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ja(e)}var qZ="handsontableEditor",qdt="handsontable",AU=function(e){zdt(r,e);var t=Gdt(r);function r(){return Bdt(this,r),t.apply(this,arguments)}return Wdt(r,[{key:"open",value:function(){ws(Ja(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),I1(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),ws(Ja(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,a,o,s,l,u){ws(Ja(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var g=this.getSourceData(v.row,v.col);g!==void 0&&f.setValue(g),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&zn(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(i,a){var o=this.hot.getSettings().onBeginEditing;o&&o()===!1||ws(Ja(r.prototype),"beginEditing",this).call(this,i,a)}},{key:"createElements",value:function(){ws(Ja(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,a,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}ws(Ja(r.prototype),"finishEditing",this).call(this,i,a,o)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor");ws(Ja(r.prototype),"registerShortcuts",this).call(this);var s={group:qZ,relativeToGroup:TA,position:"before"},l=function(f,c){var h=i.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),Ns(c),i.hot.listen(),i.TEXTAREA.focus(),!1};o.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),l(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return l(h,f)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){ws(Ja(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(qZ)}}],[{key:"EDITOR_TYPE",get:function(){return qdt}}]),r}(uv);function oy(e){return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oy(e)}function Zdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vde(n.key),n)}}function Jdt(e,t,r){return t&&ZZ(e.prototype,t),r&&ZZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uh(){return typeof Reflect<"u"&&Reflect.get?Uh=Reflect.get.bind():Uh=function(t,r,n){var i=Qdt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Uh.apply(this,arguments)}function Qdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=uu(e),e!==null););return e}function evt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HF(e,t)}function HF(e,t){return HF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HF(e,t)}function tvt(e){var t=nvt();return function(){var n=uu(e),i;if(t){var a=uu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rvt(this,i)}}function rvt(e,t){if(t&&(oy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BF(e)}function BF(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uu(e){return uu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uu(e)}function ivt(e,t,r){return t=Vde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vde(e){var t=avt(e,"string");return oy(t)==="symbol"?t:String(t)}function avt(e,t){if(oy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sD=new WeakMap,ovt="autocomplete",PU=function(e){evt(r,e);var t=tvt(r);function r(n){var i;return Zdt(this,r),i=t.call(this,n),ivt(BF(i),"sortByRelevance",function(a,o,s){var l=[],u=[],f=a.length,c=o.length,h,d,v,g;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=wL(En(o[v])),s)g=d.indexOf(a);else{var y=this.cellProperties.locale;g=d.toLocaleLowerCase(y).indexOf(a.toLocaleLowerCase(y))}g!==-1&&(h=d.length-g-f,l.push({baseIndex:v,index:g,charsLeft:h,value:d}))}for(l.sort(function(b,w){if(w.index===-1)return-1;if(b.index===-1)return 1;if(b.index<w.index)return-1;if(w.index<b.index)return 1;if(b.index===w.index){if(b.charsLeft<w.charsLeft)return-1;if(b.charsLeft>w.charsLeft)return 1}return 0}),v=0,c=l.length;v<c;v++)u.push(l[v].baseIndex);return u}),i.query=null,i.strippedChoices=[],i.rawChoices=[],sD.set(BF(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return Jdt(r,[{key:"getValue",value:function(){var i=this,a=this.rawChoices.find(function(o){var s=i.stripValueIfNeeded(o);return s===i.TEXTAREA.value});return dt(a)?a:this.TEXTAREA.value}},{key:"createElements",value:function(){Uh(uu(r.prototype),"createElements",this).call(this),Ge(this.htContainer,"autocompleteEditor"),Ge(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,a=sD.get(this);Uh(uu(r.prototype),"open",this).call(this);var o=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=hi();l===0&&a.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return i.onBeforeKeyDown(u)}),o.updateSettings({colWidths:s?[jr(this.TEXTAREA)-2]:void 0,width:s?jr(this.TEXTAREA)+l:void 0,renderer:function(f,c,h,d,v,g,y){Nc(f,c,h,d,v,g,y);var b=i.cellProperties,w=b.filteringCaseSensitive,_=b.allowHtml,x=b.locale,E=i.query,R=En(g),A,N;R&&!_&&(A=w===!0?R.indexOf(E):R.toLocaleLowerCase(x).indexOf(E.toLocaleLowerCase(x)),A!==-1&&(N=R.substr(A,E.length),R=R.replace(N,"<strong>".concat(N,"</strong>")))),c.innerHTML=R},autoColumnSize:!0}),a.skipOne&&(a.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Uh(uu(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Uh(uu(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var a=this,o=this.cellProperties.source;this.query=i,typeof o=="function"?o.call(this.cellProperties,i,function(s){a.rawChoices=s,a.updateChoicesList(a.stripValuesIfNeeded(s))}):Array.isArray(o)?(this.rawChoices=o,this.updateChoicesList(this.stripValuesIfNeeded(o))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var a=RW(this.TEXTAREA),o=Cce(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,f=null,c=i;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(f=u[0]);else{for(var d=[],v=0,g=c.length;v<g&&!(s&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Kb([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),I1(this.TEXTAREA,a,a===o?void 0:o)}},{key:"flipDropdownIfNeeded",value:function(){var i=xg(this.hot.view._wt.wtTable.TABLE),a=i===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(a||!a&&(o||o==="horizontal"))return!1;var s=jn(this.TEXTAREA),l=mn(this.TEXTAREA),u=this.getDropdownHeight(),f=i.scrollTop,c=mn(this.hot.view._wt.wtTable.THEAD),h=jn(i),d=s.top-h.top-c+f,v=i.scrollHeight-d-c-l,g=u>v&&d>v;return g?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(g?d:v,u),g}},{key:"limitDropdownIfNeeded",value:function(i,a){if(a>i){var o=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=l,s+=1;while(o<i);u=o-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+a-u,"px")),this.setDropdownHeight(o-l)}}},{key:"flipDropdown",value:function(i){var a=this.htEditor.rootElement.style;a.position="absolute",a.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+hi(this.hot.rootDocument)+2,a=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:a?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,a=this.cellProperties.visibleRows;return this.strippedChoices.length>=a?a*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var a=this.cellProperties.allowHtml,o=tr(i,function(l){return En(l)}),s=tr(o,function(l){return a?l:wL(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var a=this.htEditor.getSelectedRangeLast(),o={row:a?a.from.row:-1},s=!1;return i===yt.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(s=!0),i===yt.ARROW_UP&&o.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var a=this,o=sD.get(this);if(o.skipOne=!1,Bce(i.keyCode)||i.keyCode===yt.BACKSPACE||i.keyCode===yt.DELETE||i.keyCode===yt.INSERT){var s=10;if(i.keyCode===yt.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){a.queryChoices(a.TEXTAREA.value),o.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return ovt}}]),r}(AU);function sy(e){return sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sy(e)}function svt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uvt(n.key),n)}}function lvt(e,t,r){return t&&JZ(e.prototype,t),r&&JZ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uvt(e){var t=fvt(e,"string");return sy(t)==="symbol"?t:String(t)}function fvt(e,t){if(sy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WF(e,t)}function WF(e,t){return WF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WF(e,t)}function hvt(e){var t=pvt();return function(){var n=PR(e),i;if(t){var a=PR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dvt(this,i)}}function dvt(e,t){if(t&&(sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vvt(e)}function vvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function PR(e){return PR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},PR(e)}var gvt="checkbox",Ude=function(e){cvt(r,e);var t=hvt(r);function r(){return svt(this,r),t.apply(this,arguments)}return lvt(r,[{key:"beginEditing",value:function(i,a){if(a&&a.type==="mouseup"){var o=this.TD.querySelector('input[type="checkbox"]');Wt(o,"htBadValue")||o.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return gvt}}]),r}(Ym),VF={},yvt={get exports(){return VF},set exports(e){VF=e}};const mvt=iCe(QXe);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var i;{try{i=mvt}catch{}e.exports=n(i)}})(Lf,function(r){var n=typeof r=="function",i=!!window.addEventListener,a=window.document,o=window.setTimeout,s=function(M,S,T,k){i?M.addEventListener(S,T,!!k):M.attachEvent("on"+S,T)},l=function(M,S,T,k){i?M.removeEventListener(S,T,!!k):M.detachEvent("on"+S,T)},u=function(M){return M.trim?M.trim():M.replace(/^\s+|\s+$/g,"")},f=function(M,S){return(" "+M.className+" ").indexOf(" "+S+" ")!==-1},c=function(M,S){f(M,S)||(M.className=M.className===""?S:M.className+" "+S)},h=function(M,S){M.className=u((" "+M.className+" ").replace(" "+S+" "," "))},d=function(M){return/Array/.test(Object.prototype.toString.call(M))},v=function(M){return/Date/.test(Object.prototype.toString.call(M))&&!isNaN(M.getTime())},g=function(M){var S=M.getDay();return S===0||S===6},y=function(M){return M%4===0&&M%100!==0||M%400===0},b=function(M,S){return[31,y(M)?29:28,31,30,31,30,31,31,30,31,30,31][S]},w=function(M){v(M)&&M.setHours(0,0,0,0)},_=function(M,S){return M.getTime()===S.getTime()},x=function(M,S,T){var k,O;for(k in S)O=M[k]!==void 0,O&&typeof S[k]=="object"&&S[k]!==null&&S[k].nodeName===void 0?v(S[k])?T&&(M[k]=new Date(S[k].getTime())):d(S[k])?T&&(M[k]=S[k].slice(0)):M[k]=x({},S[k],T):(T||!O)&&(M[k]=S[k]);return M},E=function(M,S,T){var k;a.createEvent?(k=a.createEvent("HTMLEvents"),k.initEvent(S,!0,!1),k=x(k,T),M.dispatchEvent(k)):a.createEventObject&&(k=a.createEventObject(),k=x(k,T),M.fireEvent("on"+S,k))},R=function(M){return M.month<0&&(M.year-=Math.ceil(Math.abs(M.month)/12),M.month+=12),M.month>11&&(M.year+=Math.floor(Math.abs(M.month)/12),M.month-=12),M},A={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},N=function(M,S,T){for(S+=M.firstDay;S>=7;)S-=7;return T?M.i18n.weekdaysShort[S]:M.i18n.weekdays[S]},I=function(M){var S=[],T="false";if(M.isEmpty)if(M.showDaysInNextAndPreviousMonths)S.push("is-outside-current-month"),M.enableSelectionDaysInNextAndPreviousMonths||S.push("is-selection-disabled");else return'<td class="is-empty"></td>';return M.isDisabled&&S.push("is-disabled"),M.isToday&&S.push("is-today"),M.isSelected&&(S.push("is-selected"),T="true"),M.hasEvent&&S.push("has-event"),M.isInRange&&S.push("is-inrange"),M.isStartRange&&S.push("is-startrange"),M.isEndRange&&S.push("is-endrange"),'<td data-day="'+M.day+'" class="'+S.join(" ")+'" aria-selected="'+T+'"><button class="pika-button pika-day" type="button" data-pika-year="'+M.year+'" data-pika-month="'+M.month+'" data-pika-day="'+M.day+'">'+M.day+"</button></td>"},F=function(M,S){M.setHours(0,0,0,0);var T=M.getDate(),k=M.getDay(),O=S,D=O-1,L=7,B=function(le){return(le+L-1)%L};M.setDate(T+D-B(k));var Y=new Date(M.getFullYear(),0,O),Q=24*60*60*1e3,he=(M.getTime()-Y.getTime())/Q,ce=1+Math.round((he-D+B(Y.getDay()))/L);return ce},H=function(M,S,T,k){var O=new Date(T,S,M),D=n?r(O).isoWeek():F(O,k);return'<td class="pika-week">'+D+"</td>"},W=function(M,S,T,k){return'<tr class="pika-row'+(T?" pick-whole-week":"")+(k?" is-selected":"")+'">'+(S?M.reverse():M).join("")+"</tr>"},z=function(M){return"<tbody>"+M.join("")+"</tbody>"},te=function(M){var S,T=[];for(M.showWeekNumber&&T.push("<th></th>"),S=0;S<7;S++)T.push('<th scope="col"><abbr title="'+N(M,S)+'">'+N(M,S,!0)+"</abbr></th>");return"<thead><tr>"+(M.isRTL?T.reverse():T).join("")+"</tr></thead>"},ie=function(M,S,T,k,O,D){var L,B,Y,Q=M._o,he=T===Q.minYear,ce=T===Q.maxYear,le='<div id="'+D+'" class="pika-title" role="heading" aria-live="assertive">',xe,U,De=!0,de=!0;for(Y=[],L=0;L<12;L++)Y.push('<option value="'+(T===O?L-S:12+L-S)+'"'+(L===k?' selected="selected"':"")+(he&&L<Q.minMonth||ce&&L>Q.maxMonth?' disabled="disabled"':"")+">"+Q.i18n.months[L]+"</option>");for(xe='<div class="pika-label">'+Q.i18n.months[k]+'<select class="pika-select pika-select-month" tabindex="-1">'+Y.join("")+"</select></div>",d(Q.yearRange)?(L=Q.yearRange[0],B=Q.yearRange[1]+1):(L=T-Q.yearRange,B=1+T+Q.yearRange),Y=[];L<B&&L<=Q.maxYear;L++)L>=Q.minYear&&Y.push('<option value="'+L+'"'+(L===T?' selected="selected"':"")+">"+L+"</option>");return U='<div class="pika-label">'+T+Q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+Y.join("")+"</select></div>",Q.showMonthAfterYear?le+=U+xe:le+=xe+U,he&&(k===0||Q.minMonth>=k)&&(De=!1),ce&&(k===11||Q.maxMonth<=k)&&(de=!1),S===0&&(le+='<button class="pika-prev'+(De?"":" is-disabled")+'" type="button">'+Q.i18n.previousMonth+"</button>"),S===M._o.numberOfMonths-1&&(le+='<button class="pika-next'+(de?"":" is-disabled")+'" type="button">'+Q.i18n.nextMonth+"</button>"),le+="</div>"},fe=function(M,S,T){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+T+'">'+te(M)+z(S)+"</table>"},Te=function(M){var S=this,T=S.config(M);S._onMouseDown=function(O){if(S._v){O=O||window.event;var D=O.target||O.srcElement;if(D)if(f(D,"is-disabled")||(f(D,"pika-button")&&!f(D,"is-empty")&&!f(D.parentNode,"is-disabled")?(S.setDate(new Date(D.getAttribute("data-pika-year"),D.getAttribute("data-pika-month"),D.getAttribute("data-pika-day"))),T.bound&&o(function(){S.hide(),T.blurFieldOnSelect&&T.field&&T.field.blur()},100)):f(D,"pika-prev")?S.prevMonth():f(D,"pika-next")&&S.nextMonth()),f(D,"pika-select"))S._c=!0;else if(O.preventDefault)O.preventDefault();else return O.returnValue=!1,!1}},S._onChange=function(O){O=O||window.event;var D=O.target||O.srcElement;D&&(f(D,"pika-select-month")?S.gotoMonth(D.value):f(D,"pika-select-year")&&S.gotoYear(D.value))},S._onKeyChange=function(O){if(O=O||window.event,S.isVisible())switch(O.keyCode){case 13:case 27:T.field&&T.field.blur();break;case 37:S.adjustDate("subtract",1);break;case 38:S.adjustDate("subtract",7);break;case 39:S.adjustDate("add",1);break;case 40:S.adjustDate("add",7);break;case 8:case 46:S.setDate(null);break}},S._parseFieldValue=function(){if(T.parse)return T.parse(T.field.value,T.format);if(n){var O=r(T.field.value,T.format,T.formatStrict);return O&&O.isValid()?O.toDate():null}else return new Date(Date.parse(T.field.value))},S._onInputChange=function(O){var D;O.firedBy!==S&&(D=S._parseFieldValue(),v(D)&&S.setDate(D),S._v||S.show())},S._onInputFocus=function(){S.show()},S._onInputClick=function(){S.show()},S._onInputBlur=function(){var O=a.activeElement;do if(f(O,"pika-single"))return;while(O=O.parentNode);S._c||(S._b=o(function(){S.hide()},50)),S._c=!1},S._onClick=function(O){O=O||window.event;var D=O.target||O.srcElement,L=D;if(D){!i&&f(D,"pika-select")&&(D.onchange||(D.setAttribute("onchange","return;"),s(D,"change",S._onChange)));do if(f(L,"pika-single")||L===T.trigger)return;while(L=L.parentNode);S._v&&D!==T.trigger&&L!==T.trigger&&S.hide()}},S.el=a.createElement("div"),S.el.className="pika-single"+(T.isRTL?" is-rtl":"")+(T.theme?" "+T.theme:""),s(S.el,"mousedown",S._onMouseDown,!0),s(S.el,"touchend",S._onMouseDown,!0),s(S.el,"change",S._onChange),T.keyboardInput&&s(a,"keydown",S._onKeyChange),T.field&&(T.container?T.container.appendChild(S.el):T.bound?a.body.appendChild(S.el):T.field.parentNode.insertBefore(S.el,T.field.nextSibling),s(T.field,"change",S._onInputChange),T.defaultDate||(T.defaultDate=S._parseFieldValue(),T.setDefaultDate=!0));var k=T.defaultDate;v(k)?T.setDefaultDate?S.setDate(k,!0):S.gotoDate(k):S.gotoDate(new Date),T.bound?(this.hide(),S.el.className+=" is-bound",s(T.trigger,"click",S._onInputClick),s(T.trigger,"focus",S._onInputFocus),s(T.trigger,"blur",S._onInputBlur)):this.show()};return Te.prototype={config:function(M){this._o||(this._o=x({},A,!0));var S=x(this._o,M,!0);S.isRTL=!!S.isRTL,S.field=S.field&&S.field.nodeName?S.field:null,S.theme=typeof S.theme=="string"&&S.theme?S.theme:null,S.bound=!!(S.bound!==void 0?S.field&&S.bound:S.field),S.trigger=S.trigger&&S.trigger.nodeName?S.trigger:S.field,S.disableWeekends=!!S.disableWeekends,S.disableDayFn=typeof S.disableDayFn=="function"?S.disableDayFn:null;var T=parseInt(S.numberOfMonths,10)||1;if(S.numberOfMonths=T>4?4:T,v(S.minDate)||(S.minDate=!1),v(S.maxDate)||(S.maxDate=!1),S.minDate&&S.maxDate&&S.maxDate<S.minDate&&(S.maxDate=S.minDate=!1),S.minDate&&this.setMinDate(S.minDate),S.maxDate&&this.setMaxDate(S.maxDate),d(S.yearRange)){var k=new Date().getFullYear()-10;S.yearRange[0]=parseInt(S.yearRange[0],10)||k,S.yearRange[1]=parseInt(S.yearRange[1],10)||k}else S.yearRange=Math.abs(parseInt(S.yearRange,10))||A.yearRange,S.yearRange>100&&(S.yearRange=100);return S},toString:function(M){return M=M||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,M):n?r(this._d).format(M):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(M,S){n&&r.isMoment(M)&&this.setDate(M.toDate(),S)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(M,S){if(!M)return this._d=null,this._o.field&&(this._o.field.value="",E(this._o.field,"change",{firedBy:this})),this.draw();if(typeof M=="string"&&(M=new Date(Date.parse(M))),!!v(M)){var T=this._o.minDate,k=this._o.maxDate;v(T)&&M<T?M=T:v(k)&&M>k&&(M=k),this._d=new Date(M.getTime()),w(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),E(this._o.field,"change",{firedBy:this})),!S&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(M){var S=!0;if(v(M)){if(this.calendars){var T=new Date(this.calendars[0].year,this.calendars[0].month,1),k=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),O=M.getTime();k.setMonth(k.getMonth()+1),k.setDate(k.getDate()-1),S=O<T.getTime()||k.getTime()<O}S&&(this.calendars=[{month:M.getMonth(),year:M.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(M,S){var T=this.getDate()||new Date,k=parseInt(S)*24*60*60*1e3,O;M==="add"?O=new Date(T.valueOf()+k):M==="subtract"&&(O=new Date(T.valueOf()-k)),this.setDate(O)},adjustCalendars:function(){this.calendars[0]=R(this.calendars[0]);for(var M=1;M<this._o.numberOfMonths;M++)this.calendars[M]=R({month:this.calendars[0].month+M,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(M){isNaN(M)||(this.calendars[0].month=parseInt(M,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(M){isNaN(M)||(this.calendars[0].year=parseInt(M,10),this.adjustCalendars())},setMinDate:function(M){M instanceof Date?(w(M),this._o.minDate=M,this._o.minYear=M.getFullYear(),this._o.minMonth=M.getMonth()):(this._o.minDate=A.minDate,this._o.minYear=A.minYear,this._o.minMonth=A.minMonth,this._o.startRange=A.startRange),this.draw()},setMaxDate:function(M){M instanceof Date?(w(M),this._o.maxDate=M,this._o.maxYear=M.getFullYear(),this._o.maxMonth=M.getMonth()):(this._o.maxDate=A.maxDate,this._o.maxYear=A.maxYear,this._o.maxMonth=A.maxMonth,this._o.endRange=A.endRange),this.draw()},setStartRange:function(M){this._o.startRange=M},setEndRange:function(M){this._o.endRange=M},draw:function(M){if(!(!this._v&&!M)){var S=this._o,T=S.minYear,k=S.maxYear,O=S.minMonth,D=S.maxMonth,L="",B;this._y<=T&&(this._y=T,!isNaN(O)&&this._m<O&&(this._m=O)),this._y>=k&&(this._y=k,!isNaN(D)&&this._m>D&&(this._m=D));for(var Y=0;Y<S.numberOfMonths;Y++)B="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),L+='<div class="pika-lendar">'+ie(this,Y,this.calendars[Y].year,this.calendars[Y].month,this.calendars[0].year,B)+this.render(this.calendars[Y].year,this.calendars[Y].month,B)+"</div>";this.el.innerHTML=L,S.bound&&S.field.type!=="hidden"&&o(function(){S.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),S.bound&&S.field.setAttribute("aria-label",S.ariaLabel)}},adjustPosition:function(){var M,S,T,k,O,D,L,B,Y,Q,he,ce;if(!this._o.container){if(this.el.style.position="absolute",M=this._o.trigger,S=M,T=this.el.offsetWidth,k=this.el.offsetHeight,O=window.innerWidth||a.documentElement.clientWidth,D=window.innerHeight||a.documentElement.clientHeight,L=window.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop,he=!0,ce=!0,typeof M.getBoundingClientRect=="function")Q=M.getBoundingClientRect(),B=Q.left+window.pageXOffset,Y=Q.bottom+window.pageYOffset;else for(B=S.offsetLeft,Y=S.offsetTop+S.offsetHeight;S=S.offsetParent;)B+=S.offsetLeft,Y+=S.offsetTop;(this._o.reposition&&B+T>O||this._o.position.indexOf("right")>-1&&B-T+M.offsetWidth>0)&&(B=B-T+M.offsetWidth,he=!1),(this._o.reposition&&Y+k>D+L||this._o.position.indexOf("top")>-1&&Y-k-M.offsetHeight>0)&&(Y=Y-k-M.offsetHeight,ce=!1),this.el.style.left=B+"px",this.el.style.top=Y+"px",c(this.el,he?"left-aligned":"right-aligned"),c(this.el,ce?"bottom-aligned":"top-aligned"),h(this.el,he?"right-aligned":"left-aligned"),h(this.el,ce?"top-aligned":"bottom-aligned")}},render:function(M,S,T){var k=this._o,O=new Date,D=b(M,S),L=new Date(M,S,1).getDay(),B=[],Y=[];w(O),k.firstDay>0&&(L-=k.firstDay,L<0&&(L+=7));for(var Q=S===0?11:S-1,he=S===11?0:S+1,ce=S===0?M-1:M,le=S===11?M+1:M,xe=b(ce,Q),U=D+L,De=U;De>7;)De-=7;U+=7-De;for(var de=!1,He=0,Be=0;He<U;He++){var Ae=new Date(M,S,1+(He-L)),Ke=v(this._d)?_(Ae,this._d):!1,Xe=_(Ae,O),G=k.events.indexOf(Ae.toDateString())!==-1,q=He<L||He>=D+L,ae=1+(He-L),be=S,se=M,Oe=k.startRange&&_(k.startRange,Ae),pe=k.endRange&&_(k.endRange,Ae),ge=k.startRange&&k.endRange&&k.startRange<Ae&&Ae<k.endRange,me=k.minDate&&Ae<k.minDate||k.maxDate&&Ae>k.maxDate||k.disableWeekends&&g(Ae)||k.disableDayFn&&k.disableDayFn(Ae);q&&(He<L?(ae=xe+ae,be=Q,se=ce):(ae=ae-D,be=he,se=le));var Ce={day:ae,month:be,year:se,hasEvent:G,isSelected:Ke,isToday:Xe,isDisabled:me,isEmpty:q,isStartRange:Oe,isEndRange:pe,isInRange:ge,showDaysInNextAndPreviousMonths:k.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:k.enableSelectionDaysInNextAndPreviousMonths};k.pickWholeWeek&&Ke&&(de=!0),Y.push(I(Ce)),++Be===7&&(k.showWeekNumber&&Y.unshift(H(He-L,S,M,k.firstWeekOfYearMinDays)),B.push(W(Y,k.isRTL,k.pickWholeWeek,de)),Y=[],Be=0,de=!1)}return fe(k,B,T)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(a,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var M=this._v;M!==!1&&(this._o.bound&&l(a,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,M!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var M=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),M.keyboardInput&&l(a,"keydown",this._onKeyChange),M.field&&(l(M.field,"change",this._onInputChange),M.bound&&(l(M.trigger,"click",this._onInputClick),l(M.trigger,"focus",this._onInputFocus),l(M.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Te})})(yvt);const QZ=VF;function ly(e){return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ly(e)}function bvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_vt(n.key),n)}}function wvt(e,t,r){return t&&eJ(e.prototype,t),r&&eJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _vt(e){var t=Svt(e,"string");return ly(t)==="symbol"?t:String(t)}function Svt(e,t){if(ly(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ru(){return typeof Reflect<"u"&&Reflect.get?ru=Reflect.get.bind():ru=function(t,r,n){var i=Cvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ru.apply(this,arguments)}function Cvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xs(e),e!==null););return e}function xvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UF(e,t)}function UF(e,t){return UF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UF(e,t)}function Tvt(e){var t=Rvt();return function(){var n=xs(e),i;if(t){var a=xs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ovt(this,i)}}function Ovt(e,t){if(t&&(ly(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Evt(e)}function Evt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xs(e){return xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xs(e)}var jde="date",tJ="dateEditor",zde=function(e){xvt(r,e);var t=Tvt(r);function r(n){var i;return bvt(this,r),i=t.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return wvt(r,[{key:"init",value:function(){var i=this;if(typeof Ye!="function")throw new Error("You need to include moment.js to your project.");if(typeof QZ!="function")throw new Error("You need to include Pikaday to your project.");ru(xs(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){ru(xs(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ge(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new bn(this);i.addEventListener(this.datePicker,"mousedown",function(a){return a.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,a,o,s,l,u){ru(xs(r.prototype),"prepare",this).call(this,i,a,o,s,l,u)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=this.hot.getShortcutManager(),o=a.getContext("editor");ru(xs(r.prototype),"open",this).call(this),this.showDatepicker(i),o.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:tJ})}},{key:"close",value:function(){var i,a=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){a.instance._refreshBorders()});var o=this.hot.getShortcutManager(),s=o.getContext("editor");s.removeShortcutsByGroup(tJ),ru(xs(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var o=this.originalValue;o!==void 0&&this.setValue(o)}ru(xs(r.prototype),"finishEditing",this).call(this,i,a)}},{key:"showDatepicker",value:function(i){var a=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?MW(i.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new QZ(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+a.top+mn(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=a.right-jr(this.datePicker):f=a.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,Ye(u,o,!0).isValid()&&this.$datePicker.setMoment(Ye(u,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,Ye(u,o,!0).isValid()&&this.$datePicker.setMoment(Ye(u,o),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,a=this.TEXTAREA,o={};this.cellProperties&&this.cellProperties.datePickerConfig&&E1(o,this.cellProperties.datePickerConfig);var s=o.onSelect,l=o.onClose;return o.field=a,o.trigger=a,o.container=this.datePicker,o.bound=!1,o.format=o.format||this.defaultDateFormat,o.reposition=o.reposition||!1,o.isRTL=!1,o.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=Ye(f).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(f),i.hideDatepicker(),s&&s()},o.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},o}}],[{key:"EDITOR_TYPE",get:function(){return jde}}]),r}(uv);function uy(e){return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(e)}function kvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pvt(n.key),n)}}function Avt(e,t,r){return t&&rJ(e.prototype,t),r&&rJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pvt(e){var t=Ivt(e,"string");return uy(t)==="symbol"?t:String(t)}function Ivt(e,t){if(uy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MO(){return typeof Reflect<"u"&&Reflect.get?MO=Reflect.get.bind():MO=function(t,r,n){var i=Mvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},MO.apply(this,arguments)}function Mvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fy(e),e!==null););return e}function Dvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jF(e,t)}function jF(e,t){return jF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jF(e,t)}function $vt(e){var t=Fvt();return function(){var n=fy(e),i;if(t){var a=fy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Nvt(this,i)}}function Nvt(e,t){if(t&&(uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lvt(e)}function Lvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fy(e){return fy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fy(e)}var Hvt="dropdown",IU=function(e){Dvt(r,e);var t=$vt(r);function r(){return kvt(this,r),t.apply(this,arguments)}return Avt(r,[{key:"prepare",value:function(i,a,o,s,l,u){MO(fy(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Hvt}}]),r}(PU);pt.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===IU&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function cy(e){return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cy(e)}function Bvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vvt(n.key),n)}}function Wvt(e,t,r){return t&&nJ(e.prototype,t),r&&nJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vvt(e){var t=Uvt(e,"string");return cy(t)==="symbol"?t:String(t)}function Uvt(e,t){if(cy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zF(e,t)}function zF(e,t){return zF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zF(e,t)}function zvt(e){var t=Kvt();return function(){var n=IR(e),i;if(t){var a=IR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Gvt(this,i)}}function Gvt(e,t){if(t&&(cy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yvt(e)}function Yvt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function IR(e){return IR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},IR(e)}var Xvt="numeric",Gde=function(e){jvt(r,e);var t=zvt(r);function r(){return Bvt(this,r),t.apply(this,arguments)}return Wvt(r,null,[{key:"EDITOR_TYPE",get:function(){return Xvt}}]),r}(uv);function hy(e){return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(e)}function qvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jvt(n.key),n)}}function Zvt(e,t,r){return t&&iJ(e.prototype,t),r&&iJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jvt(e){var t=Qvt(e,"string");return hy(t)==="symbol"?t:String(t)}function Qvt(e,t){if(hy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DO(){return typeof Reflect<"u"&&Reflect.get?DO=Reflect.get.bind():DO=function(t,r,n){var i=ept(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},DO.apply(this,arguments)}function ept(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dy(e),e!==null););return e}function tpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GF(e,t)}function GF(e,t){return GF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GF(e,t)}function rpt(e){var t=apt();return function(){var n=dy(e),i;if(t){var a=dy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return npt(this,i)}}function npt(e,t){if(t&&(hy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ipt(e)}function ipt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function apt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dy(e){return dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dy(e)}var opt="password",Yde=function(e){tpt(r,e);var t=rpt(r);function r(){return qvt(this,r),t.apply(this,arguments)}return Zvt(r,[{key:"createElements",value:function(){DO(dy(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,$s(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return opt}}]),r}(uv);function Bd(e){return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function spt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,upt(n.key),n)}}function lpt(e,t,r){return t&&aJ(e.prototype,t),r&&aJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function upt(e){var t=fpt(e,"string");return Bd(t)==="symbol"?t:String(t)}function fpt(e,t){if(Bd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $O(){return typeof Reflect<"u"&&Reflect.get?$O=Reflect.get.bind():$O=function(t,r,n){var i=cpt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},$O.apply(this,arguments)}function cpt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vy(e),e!==null););return e}function hpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YF(e,t)}function YF(e,t){return YF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YF(e,t)}function dpt(e){var t=gpt();return function(){var n=vy(e),i;if(t){var a=vy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return vpt(this,i)}}function vpt(e,t){if(t&&(Bd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ppt(e)}function ppt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vy(e){return vy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vy(e)}var lD="ht_editor_visible",oJ="selectEditor",ypt="select",mpt=function(e){hpt(r,e);var t=dpt(r);function r(){return spt(this,r),t.apply(this,arguments)}return lpt(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Ge(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Wt(this.select,lD)&&Vt(this.select,lD),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this;$O(vy(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),$s(this.select),nr(h,function(d,v){var g=f.hot.rootDocument.createElement("OPTION");g.value=v,sv(g,d),f.select.appendChild(g)})}},{key:"prepareOptions",value:function(i){var a={};if(Array.isArray(i))for(var o=0,s=i.length;o<s;o++)a[i[o]]=i[o];else Bd(i)==="object"&&(a=i);return a}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===pi.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),a=i.top,o=i.start,s=i.width,l=i.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(a,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),u.margin="0px",Ge(this.select,lD)}}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={group:oJ};this.isInFullEditMode()!==!1&&o.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=i.select.selectedIndex-1;u>=0&&(i.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=i.select.selectedIndex+1;u<=i.select.length-1&&(i.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(oJ)}}],[{key:"EDITOR_TYPE",get:function(){return ypt}}]),r}(Ym);function py(e){return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function bpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_pt(n.key),n)}}function wpt(e,t,r){return t&&sJ(e.prototype,t),r&&sJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _pt(e){var t=Spt(e,"string");return py(t)==="symbol"?t:String(t)}function Spt(e,t){if(py(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NO(){return typeof Reflect<"u"&&Reflect.get?NO=Reflect.get.bind():NO=function(t,r,n){var i=Cpt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},NO.apply(this,arguments)}function Cpt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gy(e),e!==null););return e}function xpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KF(e,t)}function KF(e,t){return KF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KF(e,t)}function Tpt(e){var t=Rpt();return function(){var n=gy(e),i;if(t){var a=gy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Opt(this,i)}}function Opt(e,t){if(t&&(py(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ept(e)}function Ept(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gy(e){return gy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gy(e)}var kpt="time",Kde=function(e){xpt(r,e);var t=Tpt(r);function r(){return bpt(this,r),t.apply(this,arguments)}return wpt(r,[{key:"prepare",value:function(i,a,o,s,l,u){NO(gy(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return kpt}}]),r}(uv);function Apt(){Aa(Ym),Aa(PU),Aa(Ude),Aa(zde),Aa(IU),Aa(AU),Aa(Gde),Aa(Yde),Aa(mpt),Aa(uv),Aa(Kde)}var Ppt="html";function MU(e,t,r,n,i,a,o){j1.apply(this,[e,t,r,n,i,a,o]),sv(t,a??"",!1)}MU.RENDERER_TYPE=Ppt;var Ipt="autocomplete";function Km(e,t,r,n,i,a,o){var s=e.rootDocument,l=o.allowHtml?MU:Nc,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,r,n,i,a,o]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),Ge(t,"htAutocomplete"),!e.acArrowListener){var f=new bn(e);e.acArrowListener=function(c){Wt(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Km.RENDERER_TYPE=Ipt;var lJ=new WeakMap,uJ=new WeakMap,Mpt="htBadValue",yy="data-row",my="data-col",Dpt="checkboxRenderer",Xde="checkbox";pt.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,i=t.type,a=t.row,o=t.column,s=t.prop;if(i===Xde){if(n){var l=n.value,u=n.property,f=r;if(l)f=typeof l=="function"?l(a,o,s,r):l;else if(u){var c=this.getDataAtRowProp(a,u);f=c!==null?c:r}e=f}return e}});function DU(e,t,r,n,i,a,o){var s=e.rootDocument;j1.apply(this,[e,t,r,n,i,a,o]),$pt(e);var l=Npt(s),u=o.label,f=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),$s(t),a===o.checkedTemplate||En(a).toLocaleLowerCase(o.locale)===En(o.checkedTemplate).toLocaleLowerCase(o.locale)?l.checked=!0:a===o.uncheckedTemplate||En(a).toLocaleLowerCase(o.locale)===En(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?l.checked=!1:ei(a)?Ge(l,"noValue"):(l.style.display="none",Ge(l,Mpt),f=!0),l.setAttribute(yy,r),l.setAttribute(my,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,i,a):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=Lpt(s,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(l),t.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&t.appendChild(l),f&&t.appendChild(s.createTextNode("#bad-value#")),lJ.has(e)||(lJ.set(e,!0),v());function v(){var b=e.getShortcutManager(),w=b.getContext("grid"),_={group:Dpt};w.addShortcuts([{keys:[["space"]],callback:function(){return g(),!y()}},{keys:[["enter"]],callback:function(){return g(),!y()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return g(!0),!y()},relativeToGroup:ew,position:"before"}],_)}function g(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=e.getSelectedRange();if(w)for(var _=0;_<w.length;_++){for(var x=w[_].getTopStartCorner(),E=x.row,R=x.col,A=w[_].getBottomEndCorner(),N=A.row,I=A.col,F=[],H=E;H<=N;H+=1)for(var W=R;W<=I;W+=1){var z=e.getCellMeta(H,W);if(z.type!=="checkbox")return;if(z.readOnly!==!0){typeof z.checkedTemplate>"u"&&(z.checkedTemplate=!0),typeof z.uncheckedTemplate>"u"&&(z.uncheckedTemplate=!1);var te=e.getDataAtCell(H,W);b===!1?[z.checkedTemplate,z.checkedTemplate.toString()].includes(te)?F.push([H,W,z.uncheckedTemplate]):[z.uncheckedTemplate,z.uncheckedTemplate.toString(),null,void 0].includes(te)&&F.push([H,W,z.checkedTemplate]):F.push([H,W,z.uncheckedTemplate])}}F.length>0&&e.setDataAtCell(F)}}function y(){var b=e.getSelectedRange();if(b){for(var w=0;w<b.length;w++)for(var _=b[w].getTopStartCorner(),x=b[w].getBottomEndCorner(),E=_.row;E<=x.row;E++)for(var R=_.col;R<=x.col;R++){var A=e.getCellMeta(E,R);if(A.type!=="checkbox")return!1;var N=e.getCell(E,R);if(N==null)return!0;var I=N.querySelectorAll("input[type=checkbox]");if(I.length>0&&!A.readOnly)return!0}return!1}}}DU.RENDERER_TYPE=Xde;function $pt(e){var t=uJ.get(e);if(!t){var r=e.rootElement;t=new bn(e),t.addEventListener(r,"click",function(n){return Hpt(n,e)}),t.addEventListener(r,"mouseup",function(n){return Fpt(n,e)}),t.addEventListener(r,"change",function(n){return Bpt(n,e)}),uJ.set(e,t)}return t}function Npt(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function Lpt(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function Fpt(e,t){var r=e.target;$U(r)&&(!r.hasAttribute(yy)||!r.hasAttribute(my)||setTimeout(t.listen,10))}function Hpt(e,t){var r=e.target;if($U(r)&&!(!r.hasAttribute(yy)||!r.hasAttribute(my))){var n=parseInt(r.getAttribute(yy),10),i=parseInt(r.getAttribute(my),10),a=t.getCellMeta(n,i);a.readOnly&&e.preventDefault()}}function Bpt(e,t){var r=e.target;if($U(r)&&!(!r.hasAttribute(yy)||!r.hasAttribute(my))){var n=parseInt(r.getAttribute(yy),10),i=parseInt(r.getAttribute(my),10),a=t.getCellMeta(n,i);if(!a.readOnly){var o=null;e.target.checked?o=a.uncheckedTemplate===void 0?!0:a.checkedTemplate:o=a.uncheckedTemplate===void 0?!1:a.uncheckedTemplate,t.setDataAtCell(n,i,o)}}}function $U(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function hT(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var XF={},Wpt={get exports(){return XF},set exports(e){XF=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,a){function o(u,f){if(!i[u]){if(!n[u]){var c=typeof hT=="function"&&hT;if(!f&&c)return c(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(v){return o(n[u][1][v]||v)},d,d.exports,r,n,i,a)}return i[u].exports}for(var s=typeof hT=="function"&&hT,l=0;l<a.length;l++)o(a[l]);return o}({1:[function(r,n,i){(function(a){var o,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,b=1e9;function w(I){var F=0|I;return 0<I||I===F?F:F-1}function _(I){for(var F,H,W=1,z=I.length,te=I[0]+"";W<z;){for(F=I[W++]+"",H=d-F.length;H--;F="0"+F);te+=F}for(z=te.length;te.charCodeAt(--z)===48;);return te.slice(0,z+1||1)}function x(I,F){var H,W,z=I.c,te=F.c,ie=I.s,fe=F.s,Te=I.e,M=F.e;if(!ie||!fe)return null;if(H=z&&!z[0],W=te&&!te[0],H||W)return H?W?0:-fe:ie;if(ie!=fe)return ie;if(H=ie<0,W=Te==M,!z||!te)return W?0:!z^H?1:-1;if(!W)return M<Te^H?1:-1;for(fe=(Te=z.length)<(M=te.length)?Te:M,ie=0;ie<fe;ie++)if(z[ie]!=te[ie])return z[ie]>te[ie]^H?1:-1;return Te==M?0:M<Te^H?1:-1}function E(I,F,H,W){if(I<F||H<I||I!==(I<0?l(I):u(I)))throw Error(f+(W||"Argument")+(typeof I=="number"?I<F||H<I?" out of range: ":" not an integer: ":" not a primitive number: ")+String(I))}function R(I){var F=I.c.length-1;return w(I.e/d)==F&&I.c[F]%2!=0}function A(I,F){return(1<I.length?I.charAt(0)+"."+I.slice(1):I)+(F<0?"e":"e+")+F}function N(I,F,H){var W,z;if(F<0){for(z=H+".";++F;z+=H);I=z+I}else if(++F>(W=I.length)){for(z=H,F-=W;--F;z+=H);I+=z}else F<W&&(I=I.slice(0,F)+"."+I.slice(F));return I}(o=function I(F){var H,W,z,te,ie,fe,Te,M,S,T,k=de.prototype={constructor:de,toString:null,valueOf:null},O=new de(1),D=20,L=4,B=-7,Y=21,Q=-1e7,he=1e7,ce=!1,le=1,xe=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},De="0123456789abcdefghijklmnopqrstuvwxyz";function de(G,q){var ae,be,se,Oe,pe,ge,me,Ce,Se=this;if(!(Se instanceof de))return new de(G,q);if(q==null){if(G instanceof de)return Se.s=G.s,Se.e=G.e,void(Se.c=(G=G.c)?G.slice():G);if((ge=typeof G=="number")&&0*G==0){if(Se.s=1/G<0?(G=-G,-1):1,G===~~G){for(Oe=0,pe=G;10<=pe;pe/=10,Oe++);return Se.e=Oe,void(Se.c=[G])}Ce=String(G)}else{if(Ce=String(G),!s.test(Ce))return z(Se,Ce,ge);Se.s=Ce.charCodeAt(0)==45?(Ce=Ce.slice(1),-1):1}-1<(Oe=Ce.indexOf("."))&&(Ce=Ce.replace(".","")),0<(pe=Ce.search(/e/i))?(Oe<0&&(Oe=pe),Oe+=+Ce.slice(pe+1),Ce=Ce.substring(0,pe)):Oe<0&&(Oe=Ce.length)}else{if(E(q,2,De.length,"Base"),Ce=String(G),q==10)return Ke(Se=new de(G instanceof de?G:Ce),D+Se.e+1,L);if(ge=typeof G=="number"){if(0*G!=0)return z(Se,Ce,ge,q);if(Se.s=1/G<0?(Ce=Ce.slice(1),-1):1,de.DEBUG&&15<Ce.replace(/^0\.0*|\./,"").length)throw Error(c+G);ge=!1}else Se.s=Ce.charCodeAt(0)===45?(Ce=Ce.slice(1),-1):1;for(ae=De.slice(0,q),Oe=pe=0,me=Ce.length;pe<me;pe++)if(ae.indexOf(be=Ce.charAt(pe))<0){if(be=="."){if(Oe<pe){Oe=me;continue}}else if(!se&&(Ce==Ce.toUpperCase()&&(Ce=Ce.toLowerCase())||Ce==Ce.toLowerCase()&&(Ce=Ce.toUpperCase()))){se=!0,pe=-1,Oe=0;continue}return z(Se,String(G),ge,q)}-1<(Oe=(Ce=W(Ce,q,10,Se.s)).indexOf("."))?Ce=Ce.replace(".",""):Oe=Ce.length}for(pe=0;Ce.charCodeAt(pe)===48;pe++);for(me=Ce.length;Ce.charCodeAt(--me)===48;);if(Ce=Ce.slice(pe,++me)){if(me-=pe,ge&&de.DEBUG&&15<me&&(v<G||G!==u(G)))throw Error(c+Se.s*G);if(he<(Oe=Oe-pe-1))Se.c=Se.e=null;else if(Oe<Q)Se.c=[Se.e=0];else{if(Se.e=Oe,Se.c=[],pe=(Oe+1)%d,Oe<0&&(pe+=d),pe<me){for(pe&&Se.c.push(+Ce.slice(0,pe)),me-=d;pe<me;)Se.c.push(+Ce.slice(pe,pe+=d));Ce=Ce.slice(pe),pe=d-Ce.length}else pe-=me;for(;pe--;Ce+="0");Se.c.push(+Ce)}}else Se.c=[Se.e=0]}function He(G,q,ae,be){var se,Oe,pe,ge,me;if(ae==null?ae=L:E(ae,0,8),!G.c)return G.toString();if(se=G.c[0],pe=G.e,q==null)me=_(G.c),me=be==1||be==2&&(pe<=B||Y<=pe)?A(me,pe):N(me,pe,"0");else if(Oe=(G=Ke(new de(G),q,ae)).e,ge=(me=_(G.c)).length,be==1||be==2&&(q<=Oe||Oe<=B)){for(;ge<q;me+="0",ge++);me=A(me,Oe)}else if(q-=pe,me=N(me,Oe,"0"),ge<Oe+1){if(0<--q)for(me+=".";q--;me+="0");}else if(0<(q+=Oe-ge))for(Oe+1==ge&&(me+=".");q--;me+="0");return G.s<0&&se?"-"+me:me}function Be(G,q){for(var ae,be=1,se=new de(G[0]);be<G.length;be++){if(!(ae=new de(G[be])).s){se=ae;break}q.call(se,ae)&&(se=ae)}return se}function Ae(G,q,ae){for(var be=1,se=q.length;!q[--se];q.pop());for(se=q[0];10<=se;se/=10,be++);return(ae=be+ae*d-1)>he?G.c=G.e=null:G.c=ae<Q?[G.e=0]:(G.e=ae,q),G}function Ke(G,q,ae,be){var se,Oe,pe,ge,me,Ce,Se,Le=G.c,qe=g;if(Le){e:{for(se=1,ge=Le[0];10<=ge;ge/=10,se++);if((Oe=q-se)<0)Oe+=d,pe=q,Se=(me=Le[Ce=0])/qe[se-pe-1]%10|0;else if((Ce=l((Oe+1)/d))>=Le.length){if(!be)break e;for(;Le.length<=Ce;Le.push(0));me=Se=0,pe=(Oe%=d)-d+(se=1)}else{for(me=ge=Le[Ce],se=1;10<=ge;ge/=10,se++);Se=(pe=(Oe%=d)-d+se)<0?0:me/qe[se-pe-1]%10|0}if(be=be||q<0||Le[Ce+1]!=null||(pe<0?me:me%qe[se-pe-1]),be=ae<4?(Se||be)&&(ae==0||ae==(G.s<0?3:2)):5<Se||Se==5&&(ae==4||be||ae==6&&(0<Oe?0<pe?me/qe[se-pe]:0:Le[Ce-1])%10&1||ae==(G.s<0?8:7)),q<1||!Le[0])return Le.length=0,be?(q-=G.e+1,Le[0]=qe[(d-q%d)%d],G.e=-q||0):Le[0]=G.e=0,G;if(Oe==0?(Le.length=Ce,ge=1,Ce--):(Le.length=Ce+1,ge=qe[d-Oe],Le[Ce]=0<pe?u(me/qe[se-pe]%qe[pe])*ge:0),be)for(;;){if(Ce==0){for(Oe=1,pe=Le[0];10<=pe;pe/=10,Oe++);for(pe=Le[0]+=ge,ge=1;10<=pe;pe/=10,ge++);Oe!=ge&&(G.e++,Le[0]==h&&(Le[0]=1));break}if(Le[Ce]+=ge,Le[Ce]!=h)break;Le[Ce--]=0,ge=1}for(Oe=Le.length;Le[--Oe]===0;Le.pop());}G.e>he?G.c=G.e=null:G.e<Q&&(G.c=[G.e=0])}return G}function Xe(G){var q,ae=G.e;return ae===null?G.toString():(q=_(G.c),q=ae<=B||Y<=ae?A(q,ae):N(q,ae,"0"),G.s<0?"-"+q:q)}return de.clone=I,de.ROUND_UP=0,de.ROUND_DOWN=1,de.ROUND_CEIL=2,de.ROUND_FLOOR=3,de.ROUND_HALF_UP=4,de.ROUND_HALF_DOWN=5,de.ROUND_HALF_EVEN=6,de.ROUND_HALF_CEIL=7,de.ROUND_HALF_FLOOR=8,de.EUCLID=9,de.config=de.set=function(G){var q,ae;if(G!=null){if(typeof G!="object")throw Error(f+"Object expected: "+G);if(G.hasOwnProperty(q="DECIMAL_PLACES")&&(E(ae=G[q],0,b,q),D=ae),G.hasOwnProperty(q="ROUNDING_MODE")&&(E(ae=G[q],0,8,q),L=ae),G.hasOwnProperty(q="EXPONENTIAL_AT")&&((ae=G[q])&&ae.pop?(E(ae[0],-b,0,q),E(ae[1],0,b,q),B=ae[0],Y=ae[1]):(E(ae,-b,b,q),B=-(Y=ae<0?-ae:ae))),G.hasOwnProperty(q="RANGE"))if((ae=G[q])&&ae.pop)E(ae[0],-b,-1,q),E(ae[1],1,b,q),Q=ae[0],he=ae[1];else{if(E(ae,-b,b,q),!ae)throw Error(f+q+" cannot be zero: "+ae);Q=-(he=ae<0?-ae:ae)}if(G.hasOwnProperty(q="CRYPTO")){if((ae=G[q])!==!!ae)throw Error(f+q+" not true or false: "+ae);if(ae){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ce=!ae,Error(f+"crypto unavailable");ce=ae}else ce=ae}if(G.hasOwnProperty(q="MODULO_MODE")&&(E(ae=G[q],0,9,q),le=ae),G.hasOwnProperty(q="POW_PRECISION")&&(E(ae=G[q],0,b,q),xe=ae),G.hasOwnProperty(q="FORMAT")){if(typeof(ae=G[q])!="object")throw Error(f+q+" not an object: "+ae);U=ae}if(G.hasOwnProperty(q="ALPHABET")){if(typeof(ae=G[q])!="string"||/^.$|[+-.\s]|(.).*\1/.test(ae))throw Error(f+q+" invalid: "+ae);De=ae}}return{DECIMAL_PLACES:D,ROUNDING_MODE:L,EXPONENTIAL_AT:[B,Y],RANGE:[Q,he],CRYPTO:ce,MODULO_MODE:le,POW_PRECISION:xe,FORMAT:U,ALPHABET:De}},de.isBigNumber=function(G){return G instanceof de||G&&G._isBigNumber===!0||!1},de.maximum=de.max=function(){return Be(arguments,k.lt)},de.minimum=de.min=function(){return Be(arguments,k.gt)},de.random=(te=9007199254740992,ie=Math.random()*te&2097151?function(){return u(Math.random()*te)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(G){var q,ae,be,se,Oe,pe=0,ge=[],me=new de(O);if(G==null?G=D:E(G,0,b),se=l(G/d),ce)if(crypto.getRandomValues){for(q=crypto.getRandomValues(new Uint32Array(se*=2));pe<se;)9e15<=(Oe=131072*q[pe]+(q[pe+1]>>>11))?(ae=crypto.getRandomValues(new Uint32Array(2)),q[pe]=ae[0],q[pe+1]=ae[1]):(ge.push(Oe%1e14),pe+=2);pe=se/2}else{if(!crypto.randomBytes)throw ce=!1,Error(f+"crypto unavailable");for(q=crypto.randomBytes(se*=7);pe<se;)9e15<=(Oe=281474976710656*(31&q[pe])+1099511627776*q[pe+1]+4294967296*q[pe+2]+16777216*q[pe+3]+(q[pe+4]<<16)+(q[pe+5]<<8)+q[pe+6])?crypto.randomBytes(7).copy(q,pe):(ge.push(Oe%1e14),pe+=7);pe=se/7}if(!ce)for(;pe<se;)(Oe=ie())<9e15&&(ge[pe++]=Oe%1e14);for(se=ge[--pe],G%=d,se&&G&&(Oe=g[d-G],ge[pe]=u(se/Oe)*Oe);ge[pe]===0;ge.pop(),pe--);if(pe<0)ge=[be=0];else{for(be=-1;ge[0]===0;ge.splice(0,1),be-=d);for(pe=1,Oe=ge[0];10<=Oe;Oe/=10,pe++);pe<d&&(be-=d-pe)}return me.e=be,me.c=ge,me}),de.sum=function(){for(var G=1,q=arguments,ae=new de(q[0]);G<q.length;)ae=ae.plus(q[G++]);return ae},W=function(){var G="0123456789";function q(ae,be,se,Oe){for(var pe,ge,me=[0],Ce=0,Se=ae.length;Ce<Se;){for(ge=me.length;ge--;me[ge]*=be);for(me[0]+=Oe.indexOf(ae.charAt(Ce++)),pe=0;pe<me.length;pe++)me[pe]>se-1&&(me[pe+1]==null&&(me[pe+1]=0),me[pe+1]+=me[pe]/se|0,me[pe]%=se)}return me.reverse()}return function(ae,be,se,Oe,pe){var ge,me,Ce,Se,Le,qe,Qe,wt,Pt=ae.indexOf("."),Jt=D,Ot=L;for(0<=Pt&&(Se=xe,xe=0,ae=ae.replace(".",""),qe=(wt=new de(be)).pow(ae.length-Pt),xe=Se,wt.c=q(N(_(qe.c),qe.e,"0"),10,se,G),wt.e=wt.c.length),Ce=Se=(Qe=q(ae,be,se,pe?(ge=De,G):(ge=G,De))).length;Qe[--Se]==0;Qe.pop());if(!Qe[0])return ge.charAt(0);if(Pt<0?--Ce:(qe.c=Qe,qe.e=Ce,qe.s=Oe,Qe=(qe=H(qe,wt,Jt,Ot,se)).c,Le=qe.r,Ce=qe.e),Pt=Qe[me=Ce+Jt+1],Se=se/2,Le=Le||me<0||Qe[me+1]!=null,Le=Ot<4?(Pt!=null||Le)&&(Ot==0||Ot==(qe.s<0?3:2)):Se<Pt||Pt==Se&&(Ot==4||Le||Ot==6&&1&Qe[me-1]||Ot==(qe.s<0?8:7)),me<1||!Qe[0])ae=Le?N(ge.charAt(1),-Jt,ge.charAt(0)):ge.charAt(0);else{if(Qe.length=me,Le)for(--se;++Qe[--me]>se;)Qe[me]=0,me||(++Ce,Qe=[1].concat(Qe));for(Se=Qe.length;!Qe[--Se];);for(Pt=0,ae="";Pt<=Se;ae+=ge.charAt(Qe[Pt++]));ae=N(ae,Ce,ge.charAt(0))}return ae}}(),H=function(){function G(be,se,Oe){var pe,ge,me,Ce,Se=0,Le=be.length,qe=se%y,Qe=se/y|0;for(be=be.slice();Le--;)Se=((ge=qe*(me=be[Le]%y)+(pe=Qe*me+(Ce=be[Le]/y|0)*qe)%y*y+Se)/Oe|0)+(pe/y|0)+Qe*Ce,be[Le]=ge%Oe;return Se&&(be=[Se].concat(be)),be}function q(be,se,Oe,pe){var ge,me;if(Oe!=pe)me=pe<Oe?1:-1;else for(ge=me=0;ge<Oe;ge++)if(be[ge]!=se[ge]){me=be[ge]>se[ge]?1:-1;break}return me}function ae(be,se,Oe,pe){for(var ge=0;Oe--;)be[Oe]-=ge,ge=be[Oe]<se[Oe]?1:0,be[Oe]=ge*pe+be[Oe]-se[Oe];for(;!be[0]&&1<be.length;be.splice(0,1));}return function(be,se,Oe,pe,ge){var me,Ce,Se,Le,qe,Qe,wt,Pt,Jt,Ot,Et,jt,qt,zt,Ht,At,st,rt=be.s==se.s?1:-1,_t=be.c,tt=se.c;if(!(_t&&_t[0]&&tt&&tt[0]))return new de(be.s&&se.s&&(_t?!tt||_t[0]!=tt[0]:tt)?_t&&_t[0]==0||!tt?0*rt:rt/0:NaN);for(Jt=(Pt=new de(rt)).c=[],rt=Oe+(Ce=be.e-se.e)+1,ge||(ge=h,Ce=w(be.e/d)-w(se.e/d),rt=rt/d|0),Se=0;tt[Se]==(_t[Se]||0);Se++);if(tt[Se]>(_t[Se]||0)&&Ce--,rt<0)Jt.push(1),Le=!0;else{for(zt=_t.length,At=tt.length,rt+=2,1<(qe=u(ge/(tt[Se=0]+1)))&&(tt=G(tt,qe,ge),_t=G(_t,qe,ge),At=tt.length,zt=_t.length),qt=At,Et=(Ot=_t.slice(0,At)).length;Et<At;Ot[Et++]=0);st=tt.slice(),st=[0].concat(st),Ht=tt[0],tt[1]>=ge/2&&Ht++;do{if(qe=0,(me=q(tt,Ot,At,Et))<0){if(jt=Ot[0],At!=Et&&(jt=jt*ge+(Ot[1]||0)),1<(qe=u(jt/Ht)))for(ge<=qe&&(qe=ge-1),wt=(Qe=G(tt,qe,ge)).length,Et=Ot.length;q(Qe,Ot,wt,Et)==1;)qe--,ae(Qe,At<wt?st:tt,wt,ge),wt=Qe.length,me=1;else qe==0&&(me=qe=1),wt=(Qe=tt.slice()).length;if(wt<Et&&(Qe=[0].concat(Qe)),ae(Ot,Qe,Et,ge),Et=Ot.length,me==-1)for(;q(tt,Ot,At,Et)<1;)qe++,ae(Ot,At<Et?st:tt,Et,ge),Et=Ot.length}else me===0&&(qe++,Ot=[0]);Jt[Se++]=qe,Ot[0]?Ot[Et++]=_t[qt]||0:(Ot=[_t[qt]],Et=1)}while((qt++<zt||Ot[0]!=null)&&rt--);Le=Ot[0]!=null,Jt[0]||Jt.splice(0,1)}if(ge==h){for(Se=1,rt=Jt[0];10<=rt;rt/=10,Se++);Ke(Pt,Oe+(Pt.e=Se+Ce*d-1)+1,pe,Le)}else Pt.e=Ce,Pt.r=+Le;return Pt}}(),fe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Te=/^([^.]+)\.$/,M=/^\.([^.]+)$/,S=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g,z=function(G,q,ae,be){var se,Oe=ae?q:q.replace(T,"");if(S.test(Oe))G.s=isNaN(Oe)?null:Oe<0?-1:1,G.c=G.e=null;else{if(!ae&&(Oe=Oe.replace(fe,function(pe,ge,me){return se=(me=me.toLowerCase())=="x"?16:me=="b"?2:8,be&&be!=se?pe:ge}),be&&(se=be,Oe=Oe.replace(Te,"$1").replace(M,"0.$1")),q!=Oe))return new de(Oe,se);if(de.DEBUG)throw Error(f+"Not a"+(be?" base "+be:"")+" number: "+q);G.c=G.e=G.s=null}},k.absoluteValue=k.abs=function(){var G=new de(this);return G.s<0&&(G.s=1),G},k.comparedTo=function(G,q){return x(this,new de(G,q))},k.decimalPlaces=k.dp=function(G,q){var ae,be,se;if(G!=null)return E(G,0,b),q==null?q=L:E(q,0,8),Ke(new de(this),G+this.e+1,q);if(!(ae=this.c))return null;if(be=((se=ae.length-1)-w(this.e/d))*d,se=ae[se])for(;se%10==0;se/=10,be--);return be<0&&(be=0),be},k.dividedBy=k.div=function(G,q){return H(this,new de(G,q),D,L)},k.dividedToIntegerBy=k.idiv=function(G,q){return H(this,new de(G,q),0,1)},k.exponentiatedBy=k.pow=function(G,q){var ae,be,se,Oe,pe,ge,me,Ce,Se=this;if((G=new de(G)).c&&!G.isInteger())throw Error(f+"Exponent not an integer: "+Xe(G));if(q!=null&&(q=new de(q)),pe=14<G.e,!Se.c||!Se.c[0]||Se.c[0]==1&&!Se.e&&Se.c.length==1||!G.c||!G.c[0])return Ce=new de(Math.pow(+Xe(Se),pe?2-R(G):+Xe(G))),q?Ce.mod(q):Ce;if(ge=G.s<0,q){if(q.c?!q.c[0]:!q.s)return new de(NaN);(be=!ge&&Se.isInteger()&&q.isInteger())&&(Se=Se.mod(q))}else{if(9<G.e&&(0<Se.e||Se.e<-1||(Se.e==0?1<Se.c[0]||pe&&24e7<=Se.c[1]:Se.c[0]<8e13||pe&&Se.c[0]<=9999975e7)))return Oe=Se.s<0&&R(G)?-0:0,-1<Se.e&&(Oe=1/Oe),new de(ge?1/Oe:Oe);xe&&(Oe=l(xe/d+2))}for(me=pe?(ae=new de(.5),ge&&(G.s=1),R(G)):(se=Math.abs(+Xe(G)))%2,Ce=new de(O);;){if(me){if(!(Ce=Ce.times(Se)).c)break;Oe?Ce.c.length>Oe&&(Ce.c.length=Oe):be&&(Ce=Ce.mod(q))}if(se){if((se=u(se/2))===0)break;me=se%2}else if(Ke(G=G.times(ae),G.e+1,1),14<G.e)me=R(G);else{if((se=+Xe(G))==0)break;me=se%2}Se=Se.times(Se),Oe?Se.c&&Se.c.length>Oe&&(Se.c.length=Oe):be&&(Se=Se.mod(q))}return be?Ce:(ge&&(Ce=O.div(Ce)),q?Ce.mod(q):Oe?Ke(Ce,xe,L,void 0):Ce)},k.integerValue=function(G){var q=new de(this);return G==null?G=L:E(G,0,8),Ke(q,q.e+1,G)},k.isEqualTo=k.eq=function(G,q){return x(this,new de(G,q))===0},k.isFinite=function(){return!!this.c},k.isGreaterThan=k.gt=function(G,q){return 0<x(this,new de(G,q))},k.isGreaterThanOrEqualTo=k.gte=function(G,q){return(q=x(this,new de(G,q)))===1||q===0},k.isInteger=function(){return!!this.c&&w(this.e/d)>this.c.length-2},k.isLessThan=k.lt=function(G,q){return x(this,new de(G,q))<0},k.isLessThanOrEqualTo=k.lte=function(G,q){return(q=x(this,new de(G,q)))===-1||q===0},k.isNaN=function(){return!this.s},k.isNegative=function(){return this.s<0},k.isPositive=function(){return 0<this.s},k.isZero=function(){return!!this.c&&this.c[0]==0},k.minus=function(G,q){var ae,be,se,Oe,pe=this,ge=pe.s;if(q=(G=new de(G,q)).s,!ge||!q)return new de(NaN);if(ge!=q)return G.s=-q,pe.plus(G);var me=pe.e/d,Ce=G.e/d,Se=pe.c,Le=G.c;if(!me||!Ce){if(!Se||!Le)return Se?(G.s=-q,G):new de(Le?pe:NaN);if(!Se[0]||!Le[0])return Le[0]?(G.s=-q,G):new de(Se[0]?pe:L==3?-0:0)}if(me=w(me),Ce=w(Ce),Se=Se.slice(),ge=me-Ce){for((se=(Oe=ge<0)?(ge=-ge,Se):(Ce=me,Le)).reverse(),q=ge;q--;se.push(0));se.reverse()}else for(be=(Oe=(ge=Se.length)<(q=Le.length))?ge:q,ge=q=0;q<be;q++)if(Se[q]!=Le[q]){Oe=Se[q]<Le[q];break}if(Oe&&(se=Se,Se=Le,Le=se,G.s=-G.s),0<(q=(be=Le.length)-(ae=Se.length)))for(;q--;Se[ae++]=0);for(q=h-1;ge<be;){if(Se[--be]<Le[be]){for(ae=be;ae&&!Se[--ae];Se[ae]=q);--Se[ae],Se[be]+=h}Se[be]-=Le[be]}for(;Se[0]==0;Se.splice(0,1),--Ce);return Se[0]?Ae(G,Se,Ce):(G.s=L==3?-1:1,G.c=[G.e=0],G)},k.modulo=k.mod=function(G,q){var ae,be,se=this;return G=new de(G,q),!se.c||!G.s||G.c&&!G.c[0]?new de(NaN):!G.c||se.c&&!se.c[0]?new de(se):(le==9?(be=G.s,G.s=1,ae=H(se,G,0,3),G.s=be,ae.s*=be):ae=H(se,G,0,le),(G=se.minus(ae.times(G))).c[0]||le!=1||(G.s=se.s),G)},k.multipliedBy=k.times=function(G,q){var ae,be,se,Oe,pe,ge,me,Ce,Se,Le,qe,Qe,wt,Pt,Jt,Ot=this,Et=Ot.c,jt=(G=new de(G,q)).c;if(!(Et&&jt&&Et[0]&&jt[0]))return!Ot.s||!G.s||Et&&!Et[0]&&!jt||jt&&!jt[0]&&!Et?G.c=G.e=G.s=null:(G.s*=Ot.s,Et&&jt?(G.c=[0],G.e=0):G.c=G.e=null),G;for(be=w(Ot.e/d)+w(G.e/d),G.s*=Ot.s,(me=Et.length)<(Le=jt.length)&&(wt=Et,Et=jt,jt=wt,se=me,me=Le,Le=se),se=me+Le,wt=[];se--;wt.push(0));for(Pt=h,Jt=y,se=Le;0<=--se;){for(ae=0,qe=jt[se]%Jt,Qe=jt[se]/Jt|0,Oe=se+(pe=me);se<Oe;)ae=((Ce=qe*(Ce=Et[--pe]%Jt)+(ge=Qe*Ce+(Se=Et[pe]/Jt|0)*qe)%Jt*Jt+wt[Oe]+ae)/Pt|0)+(ge/Jt|0)+Qe*Se,wt[Oe--]=Ce%Pt;wt[Oe]=ae}return ae?++be:wt.splice(0,1),Ae(G,wt,be)},k.negated=function(){var G=new de(this);return G.s=-G.s||null,G},k.plus=function(G,q){var ae,be=this,se=be.s;if(q=(G=new de(G,q)).s,!se||!q)return new de(NaN);if(se!=q)return G.s=-q,be.minus(G);var Oe=be.e/d,pe=G.e/d,ge=be.c,me=G.c;if(!Oe||!pe){if(!ge||!me)return new de(se/0);if(!ge[0]||!me[0])return me[0]?G:new de(ge[0]?be:0*se)}if(Oe=w(Oe),pe=w(pe),ge=ge.slice(),se=Oe-pe){for((ae=0<se?(pe=Oe,me):(se=-se,ge)).reverse();se--;ae.push(0));ae.reverse()}for((se=ge.length)-(q=me.length)<0&&(ae=me,me=ge,ge=ae,q=se),se=0;q;)se=(ge[--q]=ge[q]+me[q]+se)/h|0,ge[q]=h===ge[q]?0:ge[q]%h;return se&&(ge=[se].concat(ge),++pe),Ae(G,ge,pe)},k.precision=k.sd=function(G,q){var ae,be,se;if(G!=null&&G!==!!G)return E(G,1,b),q==null?q=L:E(q,0,8),Ke(new de(this),G,q);if(!(ae=this.c))return null;if(be=(se=ae.length-1)*d+1,se=ae[se]){for(;se%10==0;se/=10,be--);for(se=ae[0];10<=se;se/=10,be++);}return G&&this.e+1>be&&(be=this.e+1),be},k.shiftedBy=function(G){return E(G,-v,v),this.times("1e"+G)},k.squareRoot=k.sqrt=function(){var G,q,ae,be,se,Oe=this,pe=Oe.c,ge=Oe.s,me=Oe.e,Ce=D+4,Se=new de("0.5");if(ge!==1||!pe||!pe[0])return new de(!ge||ge<0&&(!pe||pe[0])?NaN:pe?Oe:1/0);if((ae=(ge=Math.sqrt(+Xe(Oe)))==0||ge==1/0?(((q=_(pe)).length+me)%2==0&&(q+="0"),ge=Math.sqrt(+q),me=w((me+1)/2)-(me<0||me%2),new de(q=ge==1/0?"1e"+me:(q=ge.toExponential()).slice(0,q.indexOf("e")+1)+me)):new de(ge+"")).c[0]){for((ge=(me=ae.e)+Ce)<3&&(ge=0);;)if(se=ae,ae=Se.times(se.plus(H(Oe,se,Ce,1))),_(se.c).slice(0,ge)===(q=_(ae.c)).slice(0,ge)){if(ae.e<me&&--ge,(q=q.slice(ge-3,ge+1))!="9999"&&(be||q!="4999")){+q&&(+q.slice(1)||q.charAt(0)!="5")||(Ke(ae,ae.e+D+2,1),G=!ae.times(ae).eq(Oe));break}if(!be&&(Ke(se,se.e+D+2,0),se.times(se).eq(Oe))){ae=se;break}Ce+=4,ge+=4,be=1}}return Ke(ae,ae.e+D+1,L,G)},k.toExponential=function(G,q){return G!=null&&(E(G,0,b),G++),He(this,G,q,1)},k.toFixed=function(G,q){return G!=null&&(E(G,0,b),G=G+this.e+1),He(this,G,q)},k.toFormat=function(G,q,ae){var be;if(ae==null)G!=null&&q&&typeof q=="object"?(ae=q,q=null):G&&typeof G=="object"?(ae=G,G=q=null):ae=U;else if(typeof ae!="object")throw Error(f+"Argument not an object: "+ae);if(be=this.toFixed(G,q),this.c){var se,Oe=be.split("."),pe=+ae.groupSize,ge=+ae.secondaryGroupSize,me=ae.groupSeparator||"",Ce=Oe[0],Se=Oe[1],Le=this.s<0,qe=Le?Ce.slice(1):Ce,Qe=qe.length;if(ge&&(se=pe,pe=ge,Qe-=ge=se),0<pe&&0<Qe){for(se=Qe%pe||pe,Ce=qe.substr(0,se);se<Qe;se+=pe)Ce+=me+qe.substr(se,pe);0<ge&&(Ce+=me+qe.slice(se)),Le&&(Ce="-"+Ce)}be=Se?Ce+(ae.decimalSeparator||"")+((ge=+ae.fractionGroupSize)?Se.replace(new RegExp("\\d{"+ge+"}\\B","g"),"$&"+(ae.fractionGroupSeparator||"")):Se):Ce}return(ae.prefix||"")+be+(ae.suffix||"")},k.toFraction=function(G){var q,ae,be,se,Oe,pe,ge,me,Ce,Se,Le,qe,Qe=this,wt=Qe.c;if(G!=null&&(!(ge=new de(G)).isInteger()&&(ge.c||ge.s!==1)||ge.lt(O)))throw Error(f+"Argument "+(ge.isInteger()?"out of range: ":"not an integer: ")+Xe(ge));if(!wt)return new de(Qe);for(q=new de(O),Ce=ae=new de(O),be=me=new de(O),qe=_(wt),Oe=q.e=qe.length-Qe.e-1,q.c[0]=g[(pe=Oe%d)<0?d+pe:pe],G=!G||0<ge.comparedTo(q)?0<Oe?q:Ce:ge,pe=he,he=1/0,ge=new de(qe),me.c[0]=0;Se=H(ge,q,0,1),(se=ae.plus(Se.times(be))).comparedTo(G)!=1;)ae=be,be=se,Ce=me.plus(Se.times(se=Ce)),me=se,q=ge.minus(Se.times(se=q)),ge=se;return se=H(G.minus(ae),be,0,1),me=me.plus(se.times(Ce)),ae=ae.plus(se.times(be)),me.s=Ce.s=Qe.s,Le=H(Ce,be,Oe*=2,L).minus(Qe).abs().comparedTo(H(me,ae,Oe,L).minus(Qe).abs())<1?[Ce,be]:[me,ae],he=pe,Le},k.toNumber=function(){return+Xe(this)},k.toPrecision=function(G,q){return G!=null&&E(G,1,b),He(this,G,q,2)},k.toString=function(G){var q,ae=this,be=ae.s,se=ae.e;return se===null?be?(q="Infinity",be<0&&(q="-"+q)):q="NaN":(q=G==null?se<=B||Y<=se?A(_(ae.c),se):N(_(ae.c),se,"0"):G===10?N(_((ae=Ke(new de(ae),D+se+1,L)).c),ae.e,"0"):(E(G,2,De.length,"Base"),W(N(_(ae.c),se,"0"),10,G,be,!0)),be<0&&ae.c[0]&&(q="-"+q)),q},k.valueOf=k.toJSON=function(){return Xe(this)},k._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(k[Symbol.toStringTag]="BigNumber",k[Symbol.for("nodejs.util.inspect.custom")]=k.valueOf),F!=null&&de.set(F),de}()).default=o.BigNumber=o,n!==void 0&&n.exports?n.exports=o:(a||(a=typeof self<"u"&&self?self:window),a.BigNumber=o)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(a){var o=a%10;return~~(a%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function a(w,_){return function(x){if(Array.isArray(x))return x}(w)||function(x,E){var R=[],A=!0,N=!1,I=void 0;try{for(var F,H=x[Symbol.iterator]();!(A=(F=H.next()).done)&&(R.push(F.value),!E||R.length!==E);A=!0);}catch(W){N=!0,I=W}finally{try{A||H.return==null||H.return()}finally{if(N)throw I}}return R}(w,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(w){var _=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},x=2<arguments.length?arguments[2]:void 0;if(typeof _=="string"&&(_=l.parseFormat(_)),!s.validateFormat(_))return"ERROR: invalid format";var E=_.prefix||"",R=_.postfix||"",A=function(N,I,F){switch(I.output){case"currency":return I=b(I,o.currentCurrencyDefaultFormat()),function(De,de,He){var Be=He.currentCurrency(),Ae=Object.assign({},c,de),Ke=void 0,Xe="",G=!!Ae.totalLength||!!Ae.forceAverage||Ae.average,q=de.currencyPosition||Be.position,ae=de.currencySymbol||Be.symbol;Ae.spaceSeparated&&(Xe=" "),q==="infix"&&(Ke=Xe+ae+Xe);var be=y({instance:De,providedFormat:de,state:He,decimalSeparator:Ke});return q==="prefix"&&(be=De._value<0&&Ae.negative==="sign"?"-".concat(Xe).concat(ae).concat(be.slice(1)):ae+Xe+be),q&&q!=="postfix"||(be=be+(Xe=G?"":Xe)+ae),be}(N,I,o);case"percent":return I=b(I,o.currentPercentageDefaultFormat()),function(De,de,He,Be){var Ae=de.prefixSymbol,Ke=y({instance:Be(100*De._value),providedFormat:de,state:He}),Xe=Object.assign({},c,de);return Ae?"%".concat(Xe.spaceSeparated?" ":"").concat(Ke):"".concat(Ke).concat(Xe.spaceSeparated?" ":"","%")}(N,I,o,F);case"byte":return I=b(I,o.currentByteDefaultFormat()),O=N,L=o,B=F,Y=(D=I).base||"binary",Q=f[Y],he=d(O._value,Q.suffixes,Q.scale),ce=he.value,le=he.suffix,xe=y({instance:B(ce),providedFormat:D,state:L,defaults:L.currentByteDefaultFormat()}),U=L.currentAbbreviations(),"".concat(xe).concat(U.spaced?" ":"").concat(le);case"time":return I=b(I,o.currentTimeDefaultFormat()),M=N,S=Math.floor(M._value/60/60),T=Math.floor((M._value-60*S*60)/60),k=Math.round(M._value-60*S*60-60*T),"".concat(S,":").concat(T<10?"0":"").concat(T,":").concat(k<10?"0":"").concat(k);case"ordinal":return I=b(I,o.currentOrdinalDefaultFormat()),H=N,W=I,te=(z=o).currentOrdinal(),ie=Object.assign({},c,W),fe=y({instance:H,providedFormat:W,state:z}),Te=te(H._value),"".concat(fe).concat(ie.spaceSeparated?" ":"").concat(Te);case"number":default:return y({instance:N,providedFormat:I,numbro:F})}var H,W,z,te,ie,fe,Te,M,S,T,k,O,D,L,B,Y,Q,he,ce,le,xe,U}(w,_,x);return A=(A=E+A)+R}function d(w,_,x){var E=_[0],R=Math.abs(w);if(x<=R){for(var A=1;A<_.length;++A){var N=Math.pow(x,A),I=Math.pow(x,A+1);if(N<=R&&R<I){E=_[A],w/=N;break}}E===_[0]&&(w/=Math.pow(x,_.length-1),E=_[_.length-1])}return{value:w,suffix:E}}function v(w){for(var _="",x=0;x<w;x++)_+="0";return _}function g(w,_){return w.toString().indexOf("e")!==-1?function(x,E){var R=x.toString(),A=a(R.split("e"),2),N=A[0],I=A[1],F=a(N.split("."),2),H=F[0],W=F[1],z=W===void 0?"":W;if(0<+I)R=H+z+v(I-z.length);else{var te=".";te=+H<0?"-0".concat(te):"0".concat(te);var ie=(v(-I-1)+Math.abs(H)+z).substr(0,E);ie.length<E&&(ie+=v(E-ie.length)),R=te+ie}return 0<+I&&0<E&&(R+=".".concat(v(E))),R}(w,_):(Math.round(+"".concat(w,"e+").concat(_))/Math.pow(10,_)).toFixed(_)}function y(w){var _=w.instance,x=w.providedFormat,E=w.state,R=E===void 0?o:E,A=w.decimalSeparator,N=w.defaults,I=N===void 0?R.currentDefaults():N,F=_._value;if(F===0&&R.hasZeroFormat())return R.getZeroFormat();if(!isFinite(F))return F.toString();var H,W,z,te,ie,fe,Te,M,S=Object.assign({},c,I,x),T=S.totalLength,k=T?0:S.characteristic,O=S.optionalCharacteristic,D=S.forceAverage,L=!!T||!!D||S.average,B=T?-1:L&&x.mantissa===void 0?0:S.mantissa,Y=!T&&(x.optionalMantissa===void 0?B===-1:S.optionalMantissa),Q=S.trimMantissa,he=S.thousandSeparated,ce=S.spaceSeparated,le=S.negative,xe=S.forceSign,U=S.exponential,De="";if(L){var de=function(G){var q=G.value,ae=G.forceAverage,be=G.abbreviations,se=G.spaceSeparated,Oe=se!==void 0&&se,pe=G.totalLength,ge=pe===void 0?0:pe,me="",Ce=Math.abs(q),Se=-1;if(Ce>=Math.pow(10,12)&&!ae||ae==="trillion"?(me=be.trillion,q/=Math.pow(10,12)):Ce<Math.pow(10,12)&&Ce>=Math.pow(10,9)&&!ae||ae==="billion"?(me=be.billion,q/=Math.pow(10,9)):Ce<Math.pow(10,9)&&Ce>=Math.pow(10,6)&&!ae||ae==="million"?(me=be.million,q/=Math.pow(10,6)):(Ce<Math.pow(10,6)&&Ce>=Math.pow(10,3)&&!ae||ae==="thousand")&&(me=be.thousand,q/=Math.pow(10,3)),me&&(me=(Oe?" ":"")+me),ge){var Le=q.toString().split(".")[0];Se=Math.max(ge-Le.length,0)}return{value:q,abbreviation:me,mantissaPrecision:Se}}({value:F,forceAverage:D,abbreviations:R.currentAbbreviations(),spaceSeparated:ce,totalLength:T});F=de.value,De+=de.abbreviation,T&&(B=de.mantissaPrecision)}if(U){var He=(W=(H={value:F,characteristicPrecision:k}).value,z=H.characteristicPrecision,te=z===void 0?0:z,ie=a(W.toExponential().split("e"),2),fe=ie[0],Te=ie[1],M=+fe,te&&1<te&&(M*=Math.pow(10,te-1),Te=0<=(Te=+Te-(te-1))?"+".concat(Te):Te),{value:M,abbreviation:"e".concat(Te)});F=He.value,De=He.abbreviation+De}var Be,Ae,Ke,Xe=function(G,q,ae,be,se){if(be===-1)return G;var Oe=g(q,be),pe=a(Oe.toString().split("."),2),ge=pe[0],me=pe[1],Ce=me===void 0?"":me;if(Ce.match(/^0+$/)&&(ae||se))return ge;var Se=Ce.match(/0+$/);return se&&Se?"".concat(ge,".").concat(Ce.toString().slice(0,Se.index)):Oe.toString()}(F.toString(),F,Y,B,Q);return Xe=function(G,q,ae,be,se){var Oe=be.currentDelimiters(),pe=Oe.thousands;se=se||Oe.decimal;var ge=Oe.thousandsSize||3,me=G.toString(),Ce=me.split(".")[0],Se=me.split(".")[1];return ae&&(q<0&&(Ce=Ce.slice(1)),function(Le,qe){for(var Qe=[],wt=0,Pt=Le;0<Pt;Pt--)wt===qe&&(Qe.unshift(Pt),wt=0),wt++;return Qe}(Ce.length,ge).forEach(function(Le,qe){Ce=Ce.slice(0,Le+qe)+pe+Ce.slice(Le+qe)}),q<0&&(Ce="-".concat(Ce))),me=Se?Ce+se+Se:Ce}(Xe=function(G,q,ae,be){var se=G,Oe=a(se.toString().split("."),2),pe=Oe[0],ge=Oe[1];if(pe.match(/^-?0$/)&&ae)return ge?"".concat(pe.replace("0",""),".").concat(ge):pe.replace("0","");if(pe.length<be)for(var me=be-pe.length,Ce=0;Ce<me;Ce++)se="0".concat(se);return se.toString()}(Xe,0,O,k),F,he,R,A),(L||U)&&(Xe=Xe+De),(xe||F<0)&&(Be=Xe,Ke=le,Xe=(Ae=F)===0?Be:+Be==0?Be.replace("-",""):0<Ae?"+".concat(Be):Ke==="sign"?Be:"(".concat(Be.replace("-",""),")")),Xe}function b(w,_){if(!w)return _;var x=Object.keys(w);return x.length===1&&x[0]==="output"?_:w}n.exports=function(w){return{format:function(){for(var _=arguments.length,x=new Array(_),E=0;E<_;E++)x[E]=arguments[E];return h.apply(void 0,x.concat([w]))},getByteUnit:function(){for(var _=arguments.length,x=new Array(_),E=0;E<_;E++)x[E]=arguments[E];return function(R){var A=f.general;return d(R._value,A.suffixes,A.scale).suffix}.apply(void 0,x.concat([w]))},getBinaryByteUnit:function(){for(var _=arguments.length,x=new Array(_),E=0;E<_;E++)x[E]=arguments[E];return function(R){var A=f.binary;return d(R._value,A.suffixes,A.scale).suffix}.apply(void 0,x.concat([w]))},getDecimalByteUnit:function(){for(var _=arguments.length,x=new Array(_),E=0;E<_;E++)x[E]=arguments[E];return function(R){var A=f.decimal;return d(R._value,A.suffixes,A.scale).suffix}.apply(void 0,x.concat([w]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var a=r("./en-US"),o=r("./validating"),s=r("./parsing"),l={},u=void 0,f={},c=null,h={};function d(g){u=g}function v(){return f[u]}l.languages=function(){return Object.assign({},f)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return v().currency},l.currentAbbreviations=function(){return v().abbreviations},l.currentDelimiters=function(){return v().delimiters},l.currentOrdinal=function(){return v().ordinal},l.currentDefaults=function(){return Object.assign({},v().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().timeFormat)},l.setDefaults=function(g){g=s.parseFormat(g),o.validateFormat(g)&&(h=g)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(g){return c=typeof g=="string"?g:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(g){if(g){if(f[g])return f[g];throw new Error('Unknown tag "'.concat(g,'"'))}return v()},l.registerLanguage=function(g){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(g))throw new Error("Invalid language data");f[g.languageTag]=g,y&&d(g.languageTag)},l.setLanguage=function(g){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.languageTag;if(!f[g]){var b=g.split("-")[0],w=Object.keys(f).find(function(_){return _.split("-")[0]===b});return f[w]?void d(w):void d(y)}d(g)},l.registerLanguage(a),u=a.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(a){return{loadLanguagesInNode:function(o){return s=a,void o.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,i){var a=r("bignumber.js");function o(s,l,u){var f=new a(s._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new a(c),s._value=f.minus(c).toNumber(),s}n.exports=function(s){return{add:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(l,u){return o(l,u,s)},multiply:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(l,u){return f=l,h=c=u,s.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(l,u){return f=u,o(h=(c=s)(l._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,i){function a(y,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(y,_.key,_)}}var o=r("./globalState"),s=r("./validating"),l=r("./loading")(g),u=r("./unformatting"),f=r("./formatting")(g),c=r("./manipulating")(g),h=r("./parsing"),d=function(){function y(_){(function(x,E){if(!(x instanceof E))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=_}var b,w;return b=y,(w=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,_)}},{key:"formatCurrency",value:function(_){return typeof _=="string"&&(_=h.parseFormat(_)),(_=f.formatOrDefault(_,o.currentCurrencyDefaultFormat())).output="currency",f.format(this,_)}},{key:"formatTime",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return _.output="time",f.format(this,_)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(_){return c.difference(this,_)}},{key:"add",value:function(_){return c.add(this,_)}},{key:"subtract",value:function(_){return c.subtract(this,_)}},{key:"multiply",value:function(_){return c.multiply(this,_)}},{key:"divide",value:function(_){return c.divide(this,_)}},{key:"set",value:function(_){return c.set(this,v(_))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&a(b.prototype,w),y}();function v(y){var b=y;return g.isNumbro(y)?b=y._value:typeof y=="string"?b=g.unformat(y):isNaN(y)&&(b=NaN),b}function g(y){return new d(v(y))}g.version="2.1.2",g.isNumbro=function(y){return y instanceof d},g.language=o.currentLanguage,g.registerLanguage=o.registerLanguage,g.setLanguage=o.setLanguage,g.languages=o.languages,g.languageData=o.languageData,g.zeroFormat=o.setZeroFormat,g.defaultFormat=o.currentDefaults,g.setDefaults=o.setDefaults,g.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,g.validate=s.validate,g.loadLanguagesInNode=l.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(a){var o,s,l,u,f,c,h,d,v,g,y,b,w,_,x,E,R,A,N,I,F=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof a!="string"?a:(s=F,a=(l=(o=a).match(/^{([^}]*)}/))?(s.prefix=l[1],o.slice(l[0].length)):o,f=F,function(H,W){if(H.indexOf("$")===-1){if(H.indexOf("%")===-1)return H.indexOf("bd")!==-1?(W.output="byte",W.base="general"):H.indexOf("b")!==-1?(W.output="byte",W.base="binary"):H.indexOf("d")!==-1?(W.output="byte",W.base="decimal"):H.indexOf(":")===-1?H.indexOf("o")!==-1&&(W.output="ordinal"):W.output="time";W.output="percent"}else W.output="currency"}(a=(c=(u=a).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,F),h=F,(d=a.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=F,(g=a.split(".")[0].match(/0+/))&&(v.characteristic=g[0].length),function(H,W){if(H.indexOf(".")!==-1){var z=H.split(".")[0];W.optionalCharacteristic=z.indexOf("0")===-1}}(a,F),y=F,a.indexOf("a")!==-1&&(y.average=!0),w=F,(b=a).indexOf("K")!==-1?w.forceAverage="thousand":b.indexOf("M")!==-1?w.forceAverage="million":b.indexOf("B")!==-1?w.forceAverage="billion":b.indexOf("T")!==-1&&(w.forceAverage="trillion"),function(H,W){var z=H.split(".")[1];if(z){var te=z.match(/0+/);te&&(W.mantissa=te[0].length)}}(a,F),x=F,(_=a).match(/\[\.]/)?x.optionalMantissa=!0:_.match(/\./)&&(x.optionalMantissa=!1),E=F,a.indexOf(",")!==-1&&(E.thousandSeparated=!0),R=F,a.indexOf(" ")!==-1&&(R.spaceSeparated=!0),N=F,(A=a).match(/^\+?\([^)]*\)$/)&&(N.negative="parenthesis"),A.match(/^\+?-/)&&(N.negative="sign"),I=F,a.match(/^\+/)&&(I.forceSign=!0),F)}}},{}],9:[function(r,n,i){var a=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function g(y,b){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=3<arguments.length?arguments[3]:void 0,x=4<arguments.length?arguments[4]:void 0,E=5<arguments.length?arguments[5]:void 0,R=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var A="",N=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(N!==y)return-1*g(N,b,w,_,x,E,R);for(var I=0;I<a.length;I++){var F=a[I];if((A=y.replace(F.key,""))!==y)return g(A,b,w,_,x,E,R)*F.factor}if((A=y.replace("%",""))!==y)return g(A,b,w,_,x,E,R)/100;var H=parseFloat(y);if(!isNaN(H)){var W=_(H);if(W&&W!=="."&&(A=y.replace(new RegExp("".concat(o(W),"$")),""))!==y)return g(A,b,w,_,x,E,R);var z={};Object.keys(E).forEach(function(T){z[E[T]]=T});for(var te=Object.keys(z).sort().reverse(),ie=te.length,fe=0;fe<ie;fe++){var Te=te[fe],M=z[Te];if((A=y.replace(Te,""))!==y){var S=void 0;switch(M){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return g(A,b,w,_,x,E,R)*S}}}}(function(g,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=g.replace(b,"");return w=(w=w.replace(new RegExp("([0-9])".concat(o(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,f),u,f,c,h,d,v)}n.exports={unformat:function(l,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),g=d.currentCurrency().symbol,y=d.currentOrdinal(),b=d.getZeroFormat(),w=d.currentAbbreviations(),_=void 0;if(typeof l=="string")_=function(x,E){if(!x.indexOf(":")||E.thousands===":")return!1;var R=x.split(":");if(R.length!==3)return!1;var A=+R[0],N=+R[1],I=+R[2];return!isNaN(A)&&!isNaN(N)&&!isNaN(I)}(l,v)?(f=l.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):s(l,v,g,y,b,w,u);else{if(typeof l!="number")return;_=l}if(_!==void 0)return _}}},{"./globalState":4}],10:[function(r,n,i){function a(v){return function(g){if(Array.isArray(g)){for(var y=0,b=new Array(g.length);y<g.length;y++)b[y]=g[y];return b}}(v)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(v)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!s.unformat(v)}function h(v,g,y){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],w=Object.keys(v).map(function(_){if(!g[_])return console.error("".concat(y," Invalid key: ").concat(_)),!1;var x=v[_],E=g[_];if(typeof E=="string"&&(E={type:E}),E.type==="format"){if(!h(x,u,"[Validate ".concat(_,"]"),!0))return!1}else if(o(x)!==E.type)return console.error("".concat(y," ").concat(_,' type mismatched: "').concat(E.type,'" expected, "').concat(o(x),'" provided')),!1;if(E.restrictions&&E.restrictions.length)for(var R=E.restrictions.length,A=0;A<R;A++){var N=E.restrictions[A],I=N.restriction,F=N.message;if(!I(x,v))return console.error("".concat(y," ").concat(_," invalid value: ").concat(F)),!1}return E.restriction&&!E.restriction(x,v)?(console.error("".concat(y," ").concat(_," invalid value: ").concat(E.message)),!1):E.validValues&&E.validValues.indexOf(x)===-1?(console.error("".concat(y," ").concat(_," invalid value: must be among ").concat(JSON.stringify(E.validValues),', "').concat(x,'" provided')),!1):!(E.children&&!h(x,E.children,"[Validate ".concat(_,"]")))});return b||w.push.apply(w,a(Object.keys(g).map(function(_){var x=g[_];if(typeof x=="string"&&(x={type:x}),x.mandatory){var E=x.mandatory;if(typeof E=="function"&&(E=E(v)),E&&v[_]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(_,'"')),!1}return!0}))),w.reduce(function(_,x){return _&&x},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,g){var y=c(v),b=d(g);return y&&b},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(Wpt);const Ch=XF;var Vpt="numeric";function NU(e,t,r,n,i,a,o){var s=a;if(eo(s)){var l=o.numericFormat,u=l&&l.culture||"-",f=l&&l.pattern,c=o.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Ch.languages()[u]){var d=u.replace("-",""),v=Ch.allLanguages?Ch.allLanguages[u]:Ch[d];v&&Ch.registerLanguage(v)}Ch.setLanguage(u),s=Ch(s).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),o.className=h.join(" "),t.dir="ltr"}Nc(e,t,r,n,i,s,o)}NU.RENDERER_TYPE=Vpt;var Upt="password";function LU(e,t,r,n,i,a,o){Nc.apply(this,[e,t,r,n,i,a,o]);var s=o.hashLength||t.innerHTML.length,l=o.hashSymbol||"*",u="";xt(s-1,function(){u+=l}),sv(t,u)}LU.RENDERER_TYPE=Upt;var jpt="time";function FU(e,t,r,n,i,a,o){Nc.apply(this,[e,t,r,n,i,a,o]),t.dir="ltr"}FU.RENDERER_TYPE=jpt;function zpt(){ol(Km),ol(j1),ol(DU),ol(MU),ol(NU),ol(LU),ol(Nc),ol(FU)}var Gpt="autocomplete";function FA(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,fJ(r,t)):fJ(r,t)(this.source):t(!0)}FA.VALIDATOR_TYPE=Gpt;function fJ(e,t){var r=e;return function(n){for(var i=!1,a=0,o=n.length;a<o;a++)if(r===n[a]){i=!0;break}t(i)}}var Ypt=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},Kpt=ri,Xpt=iA,qpt=$n,Zpt=Hs,Jpt=Ba,cJ=Ypt,hJ=Kn,Qpt=ev,egt=aA;Xpt("search",function(e,t,r){return[function(i){var a=Jpt(this),o=Zpt(i)?void 0:Qpt(i,e);return o?Kpt(o,i,a):new RegExp(i)[e](hJ(a))},function(n){var i=qpt(this),a=hJ(n),o=r(t,i,a);if(o.done)return o.value;var s=i.lastIndex;cJ(s,0)||(i.lastIndex=0);var l=egt(i,a);return cJ(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function qde(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const tgt=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:qde},Symbol.toStringTag,{value:"Module"}));var rgt="date";function HU(e,t){var r=zce(jde,this.instance),n=e,i=!0;n==null&&(n="");var a=Ye(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=Ye(new Date(n)).isValid()||a;if(this.allowEmpty&&n===""&&(o=!0,a=!0),o||(i=!1),!o&&a&&(i=!0),o&&!a)if(this.correctFormat===!0){var s=ngt(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;t(i)}HU.VALIDATOR_TYPE=rgt;function ngt(e,t){var r=Ye(qde(e)),n=Ye(e,t),i=e.search(/[A-z]/g)>-1,a;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?a=r:a=n,a.format(t)}var igt="numeric";function BU(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:eo(e))}BU.VALIDATOR_TYPE=igt;var agt=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],ogt="time";function WU(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,i=e;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var a=/^\d{1,2}$/.test(i);a&&(i+=":00");var o=Ye(i,agt,!0).isValid()?Ye(i):Ye(i,r),s=o.isValid(),l=Ye(i,r,!0).isValid()&&!a;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=o.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}WU.VALIDATOR_TYPE=ogt;function sgt(){Fp(FA),Fp(HU),Fp(BU),Fp(WU)}var lgt="autocomplete",ugt={CELL_TYPE:lgt,editor:PU,renderer:Km,validator:FA},fgt="checkbox",cgt={CELL_TYPE:fgt,editor:Ude,renderer:DU},hgt="date",dgt={CELL_TYPE:hgt,editor:zde,renderer:Km,validator:HU},vgt="dropdown",pgt={CELL_TYPE:vgt,editor:IU,renderer:Km,validator:FA},ggt="handsontable",ygt={CELL_TYPE:ggt,editor:AU,renderer:Km},mgt="numeric",bgt={CELL_TYPE:mgt,editor:Gde,renderer:NU,validator:BU,dataType:"number"},wgt="password",_gt={CELL_TYPE:wgt,editor:Yde,renderer:LU,copyable:!1},Sgt="time",Cgt={CELL_TYPE:Sgt,editor:Kde,renderer:FU,validator:WU};function xgt(){bs(ugt),bs(cgt),bs(dgt),bs(pgt),bs(ygt),bs(bgt),bs(_gt),bs(Hde),bs(Cgt)}var Tgt=Qk,Ogt=Dce;Tgt("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Ogt);function Z_(e){return Z_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z_(e)}function Egt(e,t){return Pgt(e)||Agt(e,t)||kgt(e,t)||Rgt()}function Rgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kgt(e,t){if(e){if(typeof e=="string")return dJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dJ(e,t)}}function dJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Agt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Pgt(e){if(Array.isArray(e))return e}function Igt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dgt(n.key),n)}}function Mgt(e,t,r){return t&&vJ(e.prototype,t),r&&vJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dgt(e){var t=$gt(e,"string");return Z_(t)==="symbol"?t:String(t)}function $gt(e,t){if(Z_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ngt(e,t){Lgt(e,t),t.add(e)}function Lgt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fgt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var pJ=new Map([["plugin",aQe],["cell-type",kde],["editor",jce],["renderer",ihe],["validator",ahe]]),Hgt="base",xh=new WeakMap,uD=[],Js=null,gJ=new WeakSet,Ar=function(){function e(t){var r=this;Igt(this,e),Ngt(this,gJ),El(this,"hot",t,{writable:!1}),xh.set(this,{hooks:{}}),Js=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Mgt(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var a=[];if(i.forEach(function(u){var f=u.split(":"),c=Egt(f,2),h=c[0],d=c[1];if(!pJ.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));pJ.get(h)(d)||a.push(" - ".concat(d," (").concat(h,")"))}),a.length>0){var o=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(a.join(`
`),`
`)].join("");uD.push(o)}}Js||(Js=NW()),Js.indexOf("UndoRedo")>=0&&Js.splice(Js.indexOf("UndoRedo"),1),Js.indexOf(this.pluginName)>=0&&Js.splice(Js.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=Js.length===0;if(s){if(uD.length>0){var l=["".concat(uD.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){xh.get(this).hooks[r]=xh.get(this).hooks[r]||[];var i=xh.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),xh.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;ve(xh.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=xh.get(this).hooks;nr(n,function(i,a){return r.removeHooks(a)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){ve(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=Fgt(this,gJ,Bgt).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),nr(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Hgt}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function Bgt(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function J_(e){return J_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J_(e)}function Wgt(e,t){return zgt(e)||jgt(e,t)||Ugt(e,t)||Vgt()}function Vgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ugt(e,t){if(e){if(typeof e=="string")return yJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yJ(e,t)}}function yJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jgt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function zgt(e){if(Array.isArray(e))return e}function Ggt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kgt(n.key),n)}}function Ygt(e,t,r){return t&&mJ(e.prototype,t),r&&mJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kgt(e){var t=Xgt(e,"string");return J_(t)==="symbol"?t:String(t)}function Xgt(e,t){if(J_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(J_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qgt=function(){function e(t){Ggt(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Ygt(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),ve(this.rows,function(n){r(n.row,mn(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),ve(this.columns,function(n){var i=n.table.getBoundingClientRect(),a=i.width;r(n.col,Math.ceil(a))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){ve(i.strings,function(a){n.appendChild(r.createColElement(a.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment(),o=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,o),a.appendChild(o)),this.samples.forEach(function(s){ve(s.strings,function(l){var u=l.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=i.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),l.value,f),a.appendChild(h)})}),a}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),a=[];if(this.hot.hasRowHeaders()){var o=n.createElement("th");a.push([-1,o]),i.appendChild(o)}this.samples.forEach(function(s){ve(s.strings,function(l){var u=l.col,f=n.createElement("th");a.push([u,f]),i.appendChild(f)})}),this.table.tHead.appendChild(i),ve(a,function(s){var l=Wgt(s,2),u=l[0],f=l[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment();return this.samples.forEach(function(o){ve(o.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var f=n.hot.getCellRenderer(u),c=i.createElement("td"),h=i.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(c),a.appendChild(h)})}),a}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&a.appendChild(l),this.isHorizontal()&&(u.appendChild(f),o.appendChild(u),a.style.tableLayout="auto",a.style.width="auto"),a.appendChild(o),this.isVertical()&&s.appendChild(u),a.appendChild(s),Ge(a,r),i.appendChild(a),{fragment:i,table:a,tHead:o,tBody:s,colGroup:l,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("div"),o="htGhostTable htAutoSize ".concat(r.trim());return Ge(a,o),i.appendChild(a),{fragment:i,container:a}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const VU=qgt;function Q_(e){return Q_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q_(e)}function Zgt(e,t,r){return t=Zde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zde(n.key),n)}}function Qgt(e,t,r){return t&&bJ(e.prototype,t),r&&bJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zde(e){var t=eyt(e,"string");return Q_(t)==="symbol"?t:String(t)}function eyt(e,t){if(Q_(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tyt=function(){function e(t){Jgt(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return Qgt(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var a=this,o=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return xt(l,u,function(f){var c=a.generateSample(r,n,f);o.set(f,c)}),o}},{key:"generateSample",value:function(r,n,i){var a=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var o=new Map,s=r==="row"?"col":"row",l=[];return xt(n.from,n.to,function(u){var f=r==="row"?a.dataFactory(i,u):a.dataFactory(u,i),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:rr(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(En(c).length),o.has(v)||o.set(v,{needed:a.getSampleCount(),strings:[]});var g=o.get(v);if(g.needed){var y=l.indexOf(c)>-1;(!y||a.allowDuplicates||d)&&(g.strings.push(Zgt({value:c},s,u)),l.push(c),g.needed-=1)}}),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const Jde=tyt;function by(e){return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},by(e)}function wJ(e,t){return ayt(e)||iyt(e,t)||nyt(e,t)||ryt()}function ryt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nyt(e,t){if(e){if(typeof e=="string")return _J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _J(e,t)}}function _J(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ayt(e){if(Array.isArray(e))return e}function oyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lyt(n.key),n)}}function syt(e,t,r){return t&&SJ(e.prototype,t),r&&SJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lyt(e){var t=uyt(e,"string");return by(t)==="symbol"?t:String(t)}function uyt(e,t){if(by(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(by(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jh(){return typeof Reflect<"u"&&Reflect.get?jh=Reflect.get.bind():jh=function(t,r,n){var i=fyt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},jh.apply(this,arguments)}function fyt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=fu(e),e!==null););return e}function cyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qF(e,t)}function qF(e,t){return qF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qF(e,t)}function hyt(e){var t=vyt();return function(){var n=fu(e),i;if(t){var a=fu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dyt(this,i)}}function dyt(e,t){if(t&&(by(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qde(e)}function Qde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fu(e){return fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fu(e)}pt.getSingleton().register("modifyAutoColumnSizeSeed");var eb="autoColumnSize",pyt=10,fD=new WeakMap,gyt="autoColumnSize",yyt=function(e){cyt(r,e);var t=hyt(r);function r(n){var i;return oyt(this,r),i=t.call(this,n),fD.set(Qde(i),{cachedColumnHeaders:[]}),i.ghostTable=new VU(i.hot),i.samplesGenerator=new Jde(function(a,o){var s=i.hot.getCellMeta(a,o),l="";s.spanned||(l=i.hot.getDataAtCell(a,o));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new $c,i.hot.columnIndexMapper.registerMap(gyt,i.columnWidthsMap),i.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),i}return syt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[eb]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[eb];a&&a.useHeaders!==null&&a.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",a.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("afterFormulasValuesUpdate",function(o){return i.onAfterFormulasValuesUpdate(o)}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyColWidth",function(o,s){return i.getColumnWidth(s,o)}),this.addHook("afterInit",function(){return i.onAfterInit()}),jh(fu(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),jh(fu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;jh(fu(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var a=this.hot.renderCall,o=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();o===-1||s===-1||this.calculateColumnsWidth({from:o,to:s},void 0,a)}}},{key:"calculateColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;xt(l.from,l.to,function(f){var c=i.hot.toPhysicalColumn(f);if(c===null&&(c=f),s||i.columnWidthsMap.getValueAtIndex(c)===null&&!i.hot._getColWidthFromSettings(c)){var h=i.samplesGenerator.generateColumnSamples(f,u);ve(h,function(d){var v=wJ(d,2),g=v[0],y=v[1];return i.ghostTable.addColumn(g,y)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(f,c){var h=i.hot.toPhysicalColumn(f);i.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){Hw(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=sA(c):(Hw(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[eb],a=i&&On(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&On(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[eb],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countCols()-1;return rr(i)&&(a=i.syncLimit,TW(a)?a=DW(o,a):a>>=0),Math.min(a,o)}},{key:"getColumnWidth",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=a;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),o&&typeof s=="number"&&(s=Math.max(s,FW.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getFirstVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getFirstRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getLastVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getLastRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),a=fD.get(this),o=a.cachedColumnHeaders,s=Nn(i,function(l,u,f){var c=o.length;return(c-1<f||o[f]!==u)&&l.push(f),c-1<f?o.push(u):o[f]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];a.length?this.hot.batchExecution(function(){ve(a,function(o){i.columnWidthsMap.setValueAtIndex(o,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!lo(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var a=this,o=tr(i,function(s){var l=wJ(s,2),u=l[1];return a.hot.toPhysicalColumn(a.hot.propToCol(u))});this.clearCache(Array.from(new Set(o)))}},{key:"onBeforeColumnResize",value:function(i,a,o){var s=i;return o&&(this.calculateColumnsWidth(a,void 0,!0),s=this.getColumnWidth(a,void 0,!1)),s}},{key:"onAfterInit",value:function(){fD.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var a=lo(i,function(s){var l;return dt((l=s.address)===null||l===void 0?void 0:l.col)}),o=tr(a,function(s){return s.address.col});this.clearCache(Array.from(new Set(o)))}},{key:"destroy",value:function(){this.ghostTable.clean(),jh(fu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return eb}},{key:"PLUGIN_PRIORITY",get:function(){return pyt}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(Ar),zh={horizontal:"horizontal",vertical:"vertical"};function myt(e,t,r,n){var i=r.length,a=r?r[0].length:0,o=[],s=t.row-e.row,l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<l;f++){var c=parseInt(r[0][f],10),h=parseInt(r[i-1][f],10),d=(n==="down"?h-c:c-h)/(i-1)||0;u.push(d)}o.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<s;v++){var g=parseInt(r[v][0],10),y=parseInt(r[v][a-1],10),b=(n==="right"?y-g:g-y)/(a-1)||0;o.push([b])}return o}function byt(e,t,r){var n,i,a;return t[0]===e[0]&&t[1]<e[1]?(a="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(a="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(a="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(a="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:a,startOfDragCoords:n,endOfDragCoords:i}}function wyt(e){var t={};return e===!0?(t.directions=Object.keys(zh),t.autoInsertRow=!0):rr(e)?(dt(e.autoInsertRow)?e.direction===zh.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,dt(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(zh)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function wy(e){return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function _yt(e){return xyt(e)||Cyt(e)||eve(e)||Syt()}function Syt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cyt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xyt(e){if(Array.isArray(e))return ZF(e)}function Tyt(e,t){return Ryt(e)||Eyt(e,t)||eve(e,t)||Oyt()}function Oyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eve(e,t){if(e){if(typeof e=="string")return ZF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZF(e,t)}}function ZF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Eyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Ryt(e){if(Array.isArray(e))return e}function kyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pyt(n.key),n)}}function Ayt(e,t,r){return t&&CJ(e.prototype,t),r&&CJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pyt(e){var t=Iyt(e,"string");return wy(t)==="symbol"?t:String(t)}function Iyt(e,t){if(wy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gh(){return typeof Reflect<"u"&&Reflect.get?Gh=Reflect.get.bind():Gh=function(t,r,n){var i=Myt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Gh.apply(this,arguments)}function Myt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cu(e),e!==null););return e}function Dyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JF(e,t)}function JF(e,t){return JF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JF(e,t)}function $yt(e){var t=Lyt();return function(){var n=cu(e),i;if(t){var a=cu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Nyt(this,i)}}function Nyt(e,t){if(t&&(wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tve(e)}function tve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cu(e){return cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cu(e)}pt.getSingleton().register("modifyAutofillRange");pt.getSingleton().register("beforeAutofill");pt.getSingleton().register("afterAutofill");var xJ="autofill",Fyt=20,Hyt=["fillHandle"],Byt="insert_row_below",Wyt=200,Vyt=function(e){Dyt(r,e);var t=$yt(r);function r(n){var i;return kyt(this,r),i=t.call(this,n),i.eventManager=new bn(tve(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return Ayt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(a){return i.onAfterCellCornerMouseDown(a)}),this.addHook("afterOnCellCornerDblClick",function(a){return i.onCellCornerDblClick(a)}),this.addHook("beforeOnCellMouseOver",function(a,o){return i.onBeforeCellMouseOver(o)}),Gh(cu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Gh(cu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Gh(cu(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,a=this.hot.getSelectedRangeLast(),o=a.getTopStartCorner(),s=o.row,l=o.col,u=a.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:f,endCol:c}]),d=[],v=[],g=[];return ve(h,function(y){for(var b=y.startRow;b<=y.endRow;b+=1)d.indexOf(b)===-1&&d.push(b);for(var w=y.startCol;w<=y.endCol;w+=1)v.indexOf(w)===-1&&v.push(w)}),ve(d,function(y){var b=[];ve(v,function(w){b.push(i.hot.getCopyableData(y,w))}),g.push(b)}),g}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var a=this.hot.selection.highlight.getFill().getVisualCorners(),o=Tyt(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],g=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,s),Math.min(h.col,l),Math.max(d.row,u),Math.max(d.col,f)],v),y=byt(v,g,function(M,S){return i.hot._createCellCoords(M,S)}),b=y.directionOfDrag,w=y.startOfDragCoords,_=y.endOfDragCoords;if(w&&w.row>-1&&w.col>-1){var x=this.getSelectionData(),E=c.clone(),R=this.hot._createCellRange(w,w,_),A=this.hot.runHooks("beforeAutofill",x,E,R,b);if(A===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var N=myt(w,_,x,b),I=A,F=A;if(["up","left"].indexOf(b)>-1&&!(F.length===1&&F[0].length===0))if(I=[],b==="up")for(var H=_.row-w.row+1,W=H%F.length,z=0;z<H;z++)I.push(F[(z+(F.length-W))%F.length]);else for(var te=_.col-w.col+1,ie=te%F[0].length,fe=0;fe<F.length;fe++){I.push([]);for(var Te=0;Te<te;Te++)I[fe].push(F[fe][(Te+(F[fe].length-ie))%F[fe].length])}this.hot.populateFromArray(w.row,w.col,I,_.row,_.col,"".concat(this.pluginName,".fill"),null,b,N),this.setSelection(g),this.hot.runHooks("afterAutofill",I,E,R,b),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var a=this.hot.getSelectedRangeLast(),o=a.getBottomEndCorner(),s=i;if(this.directions.includes(zh.vertical)&&this.directions.includes(zh.horizontal)){var l=a.getTopStartCorner();(o.col<=i.col||l.col>=i.col)&&(s=this.hot._createCellCoords(o.row,i.col)),(o.row<i.row||l.row>i.row)&&(s=this.hot._createCellCoords(i.row,o.col))}else if(this.directions.includes(zh.vertical))s=this.hot._createCellCoords(i.row,o.col);else if(this.directions.includes(zh.horizontal))s=this.hot._createCellCoords(o.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var a=this.getCoordsOfDragAndDropBorders(i);a&&this.redrawBorders(a)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(Byt,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},Wyt)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),a=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();i[2]<o-1&&a[2]===o-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var a=this.hot.getData(),o=this.hot.countRows(),s,l=i[2]+1;l<o;l++){for(var u=i[1];u<=i[3];u++){var f=a[l][u];if(f)return-1}var c=a[l][i[1]-1],h=a[l][i[3]+1];(c||h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,a){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(a,i[3])).commit()}},{key:"setSelection",value:function(i){var a;(a=this.hot).selectCell.apply(a,_yt(tr(i,function(o){return Math.max(o,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),a=this.getIndexOfLastAdjacentFilledInRow(i);return a===-1||a===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,a),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var a=this.hot.rootDocument.documentElement,o=jn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||a.scrollTop)+mn(this.hot.table),s=jn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||a.scrollLeft)+jr(this.hot.table);return i.clientY>o&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var a=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&a?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=wyt(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){Gh(cu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xJ}},{key:"PLUGIN_PRIORITY",get:function(){return Fyt}},{key:"SETTING_KEYS",get:function(){return[xJ].concat(Hyt)}}]),r}(Ar);function _y(e){return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_y(e)}function Uyt(e,t){return Yyt(e)||Gyt(e,t)||zyt(e,t)||jyt()}function jyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zyt(e,t){if(e){if(typeof e=="string")return TJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TJ(e,t)}}function TJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Yyt(e){if(Array.isArray(e))return e}function Kyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qyt(n.key),n)}}function Xyt(e,t,r){return t&&OJ(e.prototype,t),r&&OJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qyt(e){var t=Zyt(e,"string");return _y(t)==="symbol"?t:String(t)}function Zyt(e,t){if(_y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eg(){return typeof Reflect<"u"&&Reflect.get?eg=Reflect.get.bind():eg=function(t,r,n){var i=Jyt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},eg.apply(this,arguments)}function Jyt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sc(e),e!==null););return e}function Qyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QF(e,t)}function QF(e,t){return QF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QF(e,t)}function emt(e){var t=nmt();return function(){var n=sc(e),i;if(t){var a=sc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return tmt(this,i)}}function tmt(e,t){if(t&&(_y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rmt(e)}function rmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sc(e){return sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sc(e)}var dT="autoRowSize",imt=40,amt="autoRowSize",omt=function(e){Qyt(r,e);var t=emt(r);function r(n){var i;return Kyt(this,r),i=t.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new VU(i.hot),i.samplesGenerator=new Jde(function(a,o){var s;return a>=0?s=i.hot.getDataAtCell(a,o):a===-1&&(s=i.hot.getColHeader(o)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new $c,i.hot.rowIndexMapper.registerMap(amt,i.rowHeightsMap),i.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)}),i}return Xyt(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[dT];return i===!0||rr(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyRowHeight",function(a,o){return i.getRowHeight(o,a)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),eg(sc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,eg(sc(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}xt(l.from,l.to,function(c){if(s||i.rowHeightsMap.getValueAtIndex(c)===null){var h=i.samplesGenerator.generateRowSamples(c,u);ve(h,function(d){var v=Uyt(d,2),g=v[0],y=v[1];return i.ghostTable.addRow(g,y)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(c,h){c<0?i.headerHeight=h:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){Hw(l),i.inProgress=!1;return}i.calculateRowsHeight({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=sA(c):(Hw(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[dT],a=i&&On(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&On(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllRowsHeight",value:function(){Sg(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[dT],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countRows()-1;return rr(i)&&(a=i.syncLimit,TW(a)?a=DW(o,a):a>>=0),Math.min(a,o)}},{key:"getRowHeight",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=a;return o!==null&&o>(a||0)&&(s=o),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var a=this,o=typeof i=="number"?{from:i,to:i}:i,s=o.from,l=o.to;this.hot.batchExecution(function(){xt(Math.min(s,l),Math.max(s,l),function(u){a.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!lo(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,a=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(o===-1||s===-1)){if(this.calculateRowsHeight({from:o,to:s},void 0,i),a){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-a,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,a){this.clearCacheByRange({from:i,to:a}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,a,o){var s=i;return o&&(this.calculateRowsHeight(a,void 0,!0),s=this.getRowHeight(a)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var a=null;i.length===1?a=i[0][0]:i.length>1&&(a={from:i[0][0],to:i[i.length-1][0]}),a!==null&&this.clearCacheByRange(a)}},{key:"destroy",value:function(){this.ghostTable.clean(),eg(sc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return dT}},{key:"PLUGIN_PRIORITY",get:function(){return imt}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(Ar);function Sy(e){return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function smt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,umt(n.key),n)}}function lmt(e,t,r){return t&&EJ(e.prototype,t),r&&EJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function umt(e){var t=fmt(e,"string");return Sy(t)==="symbol"?t:String(t)}function fmt(e,t){if(Sy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aw(){return typeof Reflect<"u"&&Reflect.get?aw=Reflect.get.bind():aw=function(t,r,n){var i=cmt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},aw.apply(this,arguments)}function cmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Wd(e),e!==null););return e}function hmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eH(e,t)}function eH(e,t){return eH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eH(e,t)}function dmt(e){var t=gmt();return function(){var n=Wd(e),i;if(t){var a=Wd(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return vmt(this,i)}}function vmt(e,t){if(t&&(Sy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pmt(e)}function pmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wd(e){return Wd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wd(e)}var rve=ade("physicallyIndexed"),ymt=rve.getListWithInsertedItems,mmt=rve.getListWithRemovedItems,bmt=function(e){hmt(r,e);var t=dmt(r);function r(){return smt(this,r),t.call(this,function(n){return n})}return lmt(r,[{key:"insert",value:function(i,a){var o=rV(this.indexedValues,a);this.indexedValues=ymt(o,i,a,this.initValueOrFn),aw(Wd(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=mmt(this.indexedValues,i);this.indexedValues=tV(a,i),aw(Wd(r.prototype),"remove",this).call(this,i)}}]),r}(lv);const wmt=bmt;function Cy(e){return Cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cy(e)}function _mt(e){return Tmt(e)||xmt(e)||Cmt(e)||Smt()}function Smt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cmt(e,t){if(e){if(typeof e=="string")return tH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tH(e,t)}}function xmt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tmt(e){if(Array.isArray(e))return tH(e)}function tH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Omt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rmt(n.key),n)}}function Emt(e,t,r){return t&&RJ(e.prototype,t),r&&RJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rmt(e){var t=kmt(e,"string");return Cy(t)==="symbol"?t:String(t)}function kmt(e,t){if(Cy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ow(){return typeof Reflect<"u"&&Reflect.get?ow=Reflect.get.bind():ow=function(t,r,n){var i=Amt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ow.apply(this,arguments)}function Amt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vd(e),e!==null););return e}function Pmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rH(e,t)}function rH(e,t){return rH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rH(e,t)}function Imt(e){var t=$mt();return function(){var n=Vd(e),i;if(t){var a=Vd(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Mmt(this,i)}}function Mmt(e,t){if(t&&(Cy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dmt(e)}function Dmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $mt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vd(e){return Vd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vd(e)}var nve=ade("physicallyIndexed"),Nmt=nve.getListWithInsertedItems,Lmt=nve.getListWithRemovedItems,Fmt=function(e){Pmt(r,e);var t=Imt(r);function r(){return Omt(this,r),t.call(this,function(n){return n})}return Emt(r,[{key:"insert",value:function(i,a){var o=this;this.indexedValues=Nmt(this.indexedValues,i,a,function(s,l){return o.getNextValue(l)}),ow(Vd(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=Lmt(this.indexedValues,i),ow(Vd(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,_mt(this.getValues()))+1+i}}]),r}(lv);const Hmt=Fmt;function xy(e){return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function Bmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vmt(n.key),n)}}function Wmt(e,t,r){return t&&kJ(e.prototype,t),r&&kJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vmt(e){var t=Umt(e,"string");return xy(t)==="symbol"?t:String(t)}function Umt(e,t){if(xy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tg(){return typeof Reflect<"u"&&Reflect.get?tg=Reflect.get.bind():tg=function(t,r,n){var i=jmt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},tg.apply(this,arguments)}function jmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=lc(e),e!==null););return e}function zmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nH(e,t)}function nH(e,t){return nH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nH(e,t)}function Gmt(e){var t=Xmt();return function(){var n=lc(e),i;if(t){var a=lc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ymt(this,i)}}function Ymt(e,t){if(t&&(xy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kmt(e)}function Kmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lc(e){return lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lc(e)}var cD="bindRowsWithHeaders",qmt=210,Zmt="loose",Jmt=new Map([["loose",wmt],["strict",Hmt]]),Qmt=function(e){zmt(r,e);var t=Gmt(r);function r(n){var i;return Bmt(this,r),i=t.call(this,n),i.headerIndexes=null,i}return Wmt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[cD];typeof a!="string"&&(a=Zmt);var o=Jmt.get(a);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new o),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),tg(lc(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),tg(lc(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){tg(lc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cD}},{key:"PLUGIN_PRIORITY",get:function(){return qmt}}]),r}(Ar);function Ty(e){return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function AJ(e){return n0t(e)||r0t(e)||t0t(e)||e0t()}function e0t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t0t(e,t){if(e){if(typeof e=="string")return iH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iH(e,t)}}function r0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function n0t(e){if(Array.isArray(e))return iH(e)}function iH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ive(n.key),n)}}function a0t(e,t,r){return t&&PJ(e.prototype,t),r&&PJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yh(){return typeof Reflect<"u"&&Reflect.get?Yh=Reflect.get.bind():Yh=function(t,r,n){var i=o0t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Yh.apply(this,arguments)}function o0t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hu(e),e!==null););return e}function s0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aH(e,t)}function aH(e,t){return aH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aH(e,t)}function l0t(e){var t=f0t();return function(){var n=hu(e),i;if(t){var a=hu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return u0t(this,i)}}function u0t(e,t){if(t&&(Ty(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ep(e)}function Ep(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hu(e){return hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hu(e)}function c0t(e,t,r){h0t(e,t),t.set(e,r)}function h0t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hD(e,t,r){return t=ive(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ive(e){var t=d0t(e,"string");return Ty(t)==="symbol"?t:String(t)}function d0t(e,t){if(Ty(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IJ(e,t){var r=ave(e,t,"get");return v0t(e,r)}function v0t(e,t){return t.get?t.get.call(e):t.value}function dD(e,t,r){var n=ave(e,t,"set");return p0t(e,n,r),r}function ave(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function p0t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var vD="collapsibleColumns",g0t=290,y0t=["nestedHeaders"],np="collapsibleIndicator",MJ=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ip=new WeakMap,m0t=function(e){s0t(r,e);var t=l0t(r);function r(){var n;i0t(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),hD(Ep(n),"nestedHeadersPlugin",null),hD(Ep(n),"eventManager",new bn(Ep(n))),hD(Ep(n),"headerStateManager",null),c0t(Ep(n),ip,{writable:!0,value:null}),n}return a0t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;o||Kr("You need to configure the Nested Headers plugin in order to use collapsible headers."),dD(this,ip,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return i.onBeforeOnCellMouseDown(s,l,u)}),Yh(hu(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),a=i.collapsibleColumns;typeof a=="boolean"?this.headerStateManager.mapState(function(o){return{collapsible:o.origColspan>1}}):Array.isArray(a)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(a))}Yh(hu(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),dD(this,ip,null),this.nestedHeadersPlugin=null,this.clearButtons(),Yh(hu(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,a=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(f){f&&f.parentNode.removeChild(f)};xt(0,i-1,function(u){var f=a.childNodes[u],c=o.childNodes[u],h=s?s.childNodes[u]:null;xt(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(np));l(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(np)),l(v)),s&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(np)),l(v))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var a=this,o=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,f=s.headerLevel,c=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&i==="expand"||!h&&i==="collapse"))return{row:a.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(o,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,a){var o=this;if(!MJ.has(a))throw new Error("Unsupported action is passed (".concat(a,")."));if(Array.isArray(i)){var s=lo(i,function(y){var b=y.row;return b<0}),l=s.length>0;ve(s,function(y){var b,w=y.row,_=y.col,x=(b=o.headerStateManager.getHeaderSettings(w,_))!==null&&b!==void 0?b:{},E=x.collapsible,R=x.isCollapsed;if(!E||R&&a==="collapse"||!R&&a==="expand")return l=!1,!1});var u=[],f=[];l&&ve(s,function(y){var b=y.row,w=y.col,_=o.headerStateManager.triggerNodeModification(a,b,w),x=_.colspanCompensation,E=_.affectedColumns,R=_.rollbackModification;x>0&&(f.push.apply(f,AJ(E)),u.push(R))});var c=this.getCollapsedColumns(),h=[];a==="collapse"?h=Q4([].concat(AJ(c),f)):a==="expand"&&(h=lo(c,function(y){return!f.includes(y)}));var d=MJ.get(a),v=this.hot.runHooks(d.beforeHook,c,h,l);if(v===!1){ve(u,function(y){y()});return}this.hot.batchExecution(function(){ve(f,function(y){IJ(o,ip).setValueAtIndex(o.hot.toPhysicalColumn(y),d.hideColumn)})},!0);var g=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,l,g),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return IJ(this,ip).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,a,o){var s,l=(s=this.headerStateManager.getHeaderSettings(o,i))!==null&&s!==void 0?s:{},u=l.collapsible,f=l.origColspan,c=l.isCollapsed,h=u&&f>1&&i>=this.hot.getSettings().fixedColumnsStart,d=a.querySelector(".".concat(np));if(h)d||(d=this.hot.rootDocument.createElement("div"),Ge(d,np),a.querySelector("div:first-child").appendChild(d)),Vt(d,["collapsed","expanded"]),c?(Ge(d,"collapsed"),Oc(d,"+")):(Ge(d,"expanded"),Oc(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,a){Wt(i.target,np)&&(Wt(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"collapse")):Wt(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"expand")),Ns(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){dD(this,ip,null),Yh(hu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return vD}},{key:"PLUGIN_PRIORITY",get:function(){return g0t}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[vD].concat(y0t)}}]),r}(Ar);function eS(e){return eS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eS(e)}function DJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function b0t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DJ(Object(r),!0).forEach(function(n){w0t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function w0t(e,t,r){return t=ove(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $J(e,t){return x0t(e)||C0t(e,t)||S0t(e,t)||_0t()}function _0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S0t(e,t){if(e){if(typeof e=="string")return NJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NJ(e,t)}}function NJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C0t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function x0t(e){if(Array.isArray(e))return e}function T0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ove(n.key),n)}}function O0t(e,t,r){return t&&LJ(e.prototype,t),r&&LJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ove(e){var t=E0t(e,"string");return eS(t)==="symbol"?t:String(t)}function E0t(e,t){if(eS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R0t=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],k0t=!1,A0t=!0,P0t=!0,I0t=function(){function e(t,r){T0t(this,e),this.hot=t,this.sortingStates=new kA,this.sortEmptyCells=k0t,this.indicator=A0t,this.headerAction=P0t,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return O0t(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;rr(r)&&nr(r,function(i,a){R0t.includes(a)&&(n[a]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=$J(n,1),a=i[0];return a===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return rr(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var a=$J(i,2),o=a[0],s=a[1];return b0t({column:r.hot.toVisualColumn(o)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(dt(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),MR="asc",DR="desc",M0t="colHeader";function D0t(e){if(rr(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[MR,DR].includes(r)}function $0t(e){if(e.some(function(r){return D0t(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function FJ(e){if(e!==DR)return e===MR?DR:MR}function HJ(e){var t=e.querySelector(".".concat(M0t));return t}function BJ(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function oH(e,t,r){return e===-1&&t>=0&&Rc(r)===!1}var N0t="ascending",L0t="descending",sve="indicatorDisabled",lve="columnSorting",uve="sortAction",fve=new Map([[MR,N0t],[DR,L0t]]);function F0t(e,t,r,n){var i=[lve];if(n&&i.push(uve),r===!1)return i.push(sve),i;var a=e.getSortOrderOfColumn(t);return dt(a)&&i.push(fve.get(a)),i}function H0t(){return Array.from(fve.values()).concat(uve,sve,lve)}function cve(e,t,r){var n=t.locale;return function(i,a){var o=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof a=="string"&&(a=a.toLocaleLowerCase(n)),i===a?ml:ei(i)?ei(a)?ml:o&&e==="asc"?xn:Tn:ei(a)?o&&e==="asc"?Tn:xn:isNaN(i)&&!isNaN(a)?e==="asc"?Tn:xn:!isNaN(i)&&isNaN(a)||(isNaN(i)||isNaN(a)||(i=parseFloat(i),a=parseFloat(a)),i<a)?e==="asc"?xn:Tn:i>a?e==="asc"?Tn:xn:ml}}var hve="default";function B0t(e,t,r){return function(n,i){var a=parseFloat(n),o=parseFloat(i),s=r.sortEmptyCells;if(a===o||isNaN(a)&&isNaN(o))return ml;if(s){if(ei(n))return e==="asc"?xn:Tn;if(ei(i))return e==="asc"?Tn:xn}return isNaN(a)?Tn:isNaN(o)?xn:a<o?e==="asc"?xn:Tn:a>o?e==="asc"?Tn:xn:ml}}var W0t="numeric";function V0t(e,t,r){var n=t.checkedTemplate,i=t.uncheckedTemplate,a=r.sortEmptyCells;return function(o,s){var l=ei(o),u=ei(s),f=l?i:o,c=u?i:s,h=f===i||f===n,d=c===i||c===n;if(a===!1){if(l&&u===!1)return Tn;if(l===!1&&u)return xn}return h===!1&&d?e==="asc"?xn:Tn:h&&d===!1?e==="asc"?Tn:xn:h===!1&&d===!1?cve(e,t,r)(o,s):f===i&&c===n?e==="asc"?xn:Tn:f===n&&c===i?e==="asc"?Tn:xn:ml}}var U0t="checkbox";function j0t(e,t,r){return function(n,i){var a=r.sortEmptyCells;if(n===i)return ml;if(ei(n))return ei(i)?ml:a&&e==="asc"?xn:Tn;if(ei(i))return a&&e==="asc"?Tn:xn;var o=t.dateFormat,s=Ye(n,o),l=Ye(i,o);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?xn:Tn:l.isBefore(s)?e==="asc"?Tn:xn:ml:xn:Tn}}var z0t="date",UU=ts("sorting.compareFunctionFactory"),HA=UU.register,WJ=UU.getItem,G0t=UU.hasItem,dve=ts("sorting.mainSortComparator"),vve=dve.register,Y0t=dve.getItem;function pve(e){return G0t(e)?WJ(e):WJ(hve)}HA(W0t,B0t);HA(U0t,V0t);HA(z0t,j0t);HA(hve,cve);var ml=0,xn=-1,Tn=1;function K0t(e,t){for(var r=Y0t(t),n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];e.sort(r.apply(void 0,i))}function VJ(e){return J0t(e)||Z0t(e)||q0t(e)||X0t()}function X0t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q0t(e,t){if(e){if(typeof e=="string")return UJ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UJ(e,t)}}function UJ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z0t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function J0t(e){if(Array.isArray(e))return e}function Q0t(e,t){return function(r,n){var i=VJ(r),a=i.slice(1),o=VJ(n),s=o.slice(1);return function(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.columnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:pve(c.type),y=g(f,c,v)(h,d);return y}(0)}}function Oy(e){return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(e)}var ebt=["column"],tbt=["column"];function ap(e){return abt(e)||ibt(e)||nbt(e)||rbt()}function rbt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nbt(e,t){if(e){if(typeof e=="string")return sH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sH(e,t)}}function ibt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function abt(e){if(Array.isArray(e))return sH(e)}function sH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jJ(Object(r),!0).forEach(function(n){obt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jJ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function obt(e,t,r){return t=gve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GJ(e,t){if(e==null)return{};var r=sbt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sbt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function lbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gve(n.key),n)}}function ubt(e,t,r){return t&&YJ(e.prototype,t),r&&YJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gve(e){var t=fbt(e,"string");return Oy(t)==="symbol"?t:String(t)}function fbt(e,t){if(Oy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Oy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kh(){return typeof Reflect<"u"&&Reflect.get?Kh=Reflect.get.bind():Kh=function(t,r,n){var i=cbt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Kh.apply(this,arguments)}function cbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=du(e),e!==null););return e}function hbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lH(e,t)}function lH(e,t){return lH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lH(e,t)}function dbt(e){var t=gbt();return function(){var n=du(e),i;if(t){var a=du(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return vbt(this,i)}}function vbt(e,t){if(t&&(Oy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pbt(e)}function pbt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function du(e){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},du(e)}var uH="columnSorting",ybt=50,KJ="append",mbt="replace";vve(uH,Q0t);pt.getSingleton().register("beforeColumnSort");pt.getSingleton().register("afterColumnSort");var yve=function(e){hbt(r,e);var t=dbt(r);function r(n){var i;return lbt(this,r),i=t.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=uH,i.indexesSequenceCache=null,i}return ubt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new I0t(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new $c(function(a){var o=i.hot.toVisualColumn(a);return o===null&&(o=a),i.getMergedPluginSettings(o)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(a,o){return i.onAfterOnCellMouseDown(a,o)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Kh(du(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,a=function(s,l){var u=HJ(l);BJ(s,l)===!1||u===null||i.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",a)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Kh(du(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var a=this.getSortConfig(),o=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(o),l=this.hot.runHooks("beforeColumnSort",a,o,s);l!==!1&&(a.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new ode),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",a,s?o:a,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return dt(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var a=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(a)&&this.columnStatesManager.setSortStates(a)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var a=this.hot.countCols();return $0t(i)&&i.every(function(o){var s=o.column;return s<=a&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var a=this,o=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var f=u.column,c=GJ(u,ebt);return zJ({column:a.hot.toPhysicalColumn(f)},c)};o.initialConfig=tr(i,s),this.hot.runHooks("persistentStateSave","columnSorting",o)}},{key:"getAllSavedSortSettings",value:function(){var i=this,a={};this.hot.runHooks("persistentStateLoad","columnSorting",a);var o=a.value,s=function(u){var f=u.column,c=GJ(u,tbt);return zJ({column:i.hot.toVisualColumn(f)},c)};return dt(o)&&Array.isArray(o.initialConfig)&&(o.initialConfig=tr(o.initialConfig,s)),o}},{key:"getColumnNextConfig",value:function(i){var a=this.columnStatesManager.getSortOrderOfColumn(i);if(dt(a)){var o=FJ(a);return dt(o)?{column:i,sortOrder:o}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:FJ()}}},{key:"getNextSortConfig",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KJ,o=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=o!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(i);if(s){if(Yr(u))return[].concat(ap(l.slice(0,o)),ap(l.slice(o+1)));if(a===KJ)return[].concat(ap(l.slice(0,o)),ap(l.slice(o+1)),[u]);if(a===mbt)return[].concat(ap(l.slice(0,o)),[u],ap(l.slice(o+1)))}return dt(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(i){if(rr(i)){var a=i[this.pluginKey];if(rr(a))return a}return{}}},{key:"getMergedPluginSettings",value:function(i){var a=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns[i])):Qr(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns(i))):Object.assign(o,a)}},{key:"getFirstCellSettings",value:function(i){var a=this.hot.getCellMeta(0,i),o=Object.create(a);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),o}},{key:"getNumberOfRowsToSort",value:function(i){var a=this.hot.getSettings();return a.maxRows<=i?a.maxRows:i-a.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var a=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var o=[],s=this.hot.countRows(),l=function(y){return tr(i,function(b){return a.hot.getDataAtCell(y,b.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)o.push([this.hot.toPhysicalRow(u)].concat(l(u)));var f=tr(o,function(g){return g[0]});K0t(o,this.pluginKey,tr(i,function(g){return g.sortOrder}),tr(i,function(g){return a.getFirstCellSettings(g.column)}));for(var c=o.length;c<s;c+=1)o.push([c].concat(l(c)));var h=tr(o,function(g){return g[0]}),d=new Map(tr(f,function(g,y){return[g,h[y]]})),v=tr(this.hot.rowIndexMapper.getIndexesSequence(),function(g){return d.has(g)?d.get(g):g});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(rr(i))this.sortBySettings(i);else{var a=this.hot.getSettings()[this.pluginKey];this.sortBySettings(a)}}},{key:"sortBySettings",value:function(i){if(rr(i)){this.columnStatesManager.updateAllColumnsProperties(i);var a=i.initialConfig;(Array.isArray(a)||rr(a))&&this.sort(a)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,a){var o=HJ(a);if(!(BJ(i,a)===!1||o===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(o,this.columnStatesManager,i,l,u)}}},{key:"updateHeaderClasses",value:function(i){if(Vt(i,H0t()),this.enabled!==!1){for(var a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];Ge(i,F0t.apply(void 0,o))}}},{key:"onUpdateSettings",value:function(i){Kh(du(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),dt(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,a){var o=this.getFirstCellSettings(a)[this.pluginKey],s=o.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){oH(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){oH(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(a.col)),this.sort(this.getColumnNextConfig(a.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Kh(du(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return uH}},{key:"PLUGIN_PRIORITY",get:function(){return ybt}}]),r}(Ar),bbt=Nt,jU=ir,wbt=Dc,_bt=Oue,Sbt=xfe,XJ=Kt,Cbt=RangeError,mve=String,bve=Math.floor,fH=jU(Sbt),qJ=jU("".slice),tb=jU(1 .toFixed),Hp=function(e,t,r){return t===0?r:t%2===1?Hp(e,t-1,r*e):Hp(e*e,t/2,r)},xbt=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},op=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=bve(i/1e7)},pD=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=bve(n/t),n=n%t*1e7},ZJ=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=mve(e[t]);r=r===""?n:r+fH("0",7-n.length)+n}return r},Tbt=XJ(function(){return tb(8e-5,3)!=="0.000"||tb(.9,0)!=="1"||tb(1.255,2)!=="1.25"||tb(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!XJ(function(){tb({})});bbt({target:"Number",proto:!0,forced:Tbt},{toFixed:function(t){var r=_bt(this),n=wbt(t),i=[0,0,0,0,0,0],a="",o="0",s,l,u,f;if(n<0||n>20)throw Cbt("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return mve(r);if(r<0&&(a="-",r=-r),r>1e-21)if(s=xbt(r*Hp(2,69,1))-69,l=s<0?r*Hp(2,-s,1):r/Hp(2,s,1),l*=4503599627370496,s=52-s,s>0){for(op(i,0,l),u=n;u>=7;)op(i,1e7,0),u-=7;for(op(i,Hp(10,u,1),0),u=s-1;u>=23;)pD(i,1<<23),u-=23;pD(i,1<<u),op(i,1,1),pD(i,2),o=ZJ(i)}else op(i,0,l),op(i,1<<-s,0),o=ZJ(i)+fH("0",n);return n>0?(f=o.length,o=a+(f<=n?"0."+fH("0",n-f)+o:qJ(o,0,f-n)+"."+qJ(o,f-n))):o=a+o,o}});function tS(e){return tS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tS(e)}function Obt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JJ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rbt(n.key),n)}}function Ebt(e,t,r){return t&&JJ(e.prototype,t),r&&JJ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rbt(e){var t=kbt(e,"string");return tS(t)==="symbol"?t:String(t)}function kbt(e,t){if(tS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Abt=function(){function e(t,r){Obt(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return Ebt(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],a=r;if(!a&&typeof this.settings=="function"){this.settingsType="function";return}return a||(a=this.settings),ve(a,function(o){var s={};n.assignSetting(o,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(o,s,"reversedRowCoords",!1),n.assignSetting(o,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"sourceColumn",o.destinationColumn),n.assignSetting(o,s,"type","sum"),n.assignSetting(o,s,"forceNumeric",!1),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"customFunction",null),n.assignSetting(o,s,"readOnly",!0),n.assignSetting(o,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(r,n,i,a){if(i==="ranges"&&r[i]===void 0){n[i]=a;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(a instanceof Error)throw a;n[i]=a}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var a=r.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();ve(o,function(s){a==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=i:r==="remove_row"&&(s.alterRowOffset=-1*i)),a==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=i:r==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,a,o){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function g(){return s.hot.removeHook("beforeViewRender",g),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;ve(h,function(g){f==="row"&&g.destinationRow>=v&&(g.alterRowOffset=c*i),f==="col"&&g.destinationColumn>=v&&(g.alterColumnOffset=c*i)}),this.resetAllEndpoints(h,!d),d?ve(h,function(g){s.extendEndpointRanges(g,v,a[0],a.length),s.recreatePhysicalRanges(g),s.clearOffsetInformation(g)}):ve(h,function(g){s.shiftEndpointCoordinates(g,v)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,a){ve(r.ranges,function(o){o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=a:i<o[0]&&(o[0]-=a):i>=o[0]&&i<=o[1]&&(o[1]-=a,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,a=[],o=[];ve(i,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));o.push(l)}),ve(o,function(s){var l=[];ve(s,function(u,f){f===0?l.push(u):s[f]!==s[f-1]+1&&(l.push(s[f-1]),a.push(l),l=[],l.push(u)),f===s.length-1&&(l.push(u),a.push(l))})}),r.ranges=a}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,ve(r.ranges,function(i){ve(i,function(a,o){a>=n&&(i[o]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=n.some(function(o){var s=o.alterRowOffset||0,l=o.alterColumnOffset||0;return o.destinationRow+s>=r.hot.countRows()||o.destinationColumn+l>=r.hot.countCols()});a||(this.cellsToSetCache=[],ve(n,function(o){r.resetEndpointValue(o,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],ve(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],ve(r,function(a,o,s){"".concat(a[2]||"")!=="".concat(a[3])&&ve(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[o][1])===l.sourceColumn&&i.indexOf(u)===-1&&i.push(u)})}),ve(i,function(a){n.refreshEndpoint(n.getEndpoint(a))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,a=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?a:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var o=this.hot.toVisualRow(r.destinationRow);if(o!==null){var s=this.hot.getCellMeta(o,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(a,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([a,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){Kr("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const Pbt=Abt;function gD(e){return e==null||isNaN(e)}function Ey(e){return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ey(e)}var QJ;function Ibt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Mbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$bt(n.key),n)}}function Dbt(e,t,r){return t&&eQ(e.prototype,t),r&&eQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $bt(e){var t=Nbt(e,"string");return Ey(t)==="symbol"?t:String(t)}function Nbt(e,t){if(Ey(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ey(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LO(){return typeof Reflect<"u"&&Reflect.get?LO=Reflect.get.bind():LO=function(t,r,n){var i=Lbt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},LO.apply(this,arguments)}function Lbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ry(e),e!==null););return e}function Fbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cH(e,t)}function cH(e,t){return cH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cH(e,t)}function Hbt(e){var t=Vbt();return function(){var n=Ry(e),i;if(t){var a=Ry(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Bbt(this,i)}}function Bbt(e,t){if(t&&(Ey(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wbt(e)}function Wbt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ry(e){return Ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ry(e)}var yD="columnSummary",Ubt=220,jbt=function(e){Fbt(r,e);var t=Hbt(r);function r(n){var i;return Mbt(this,r),i=t.call(this,n),i.endpoints=null,i}return Dbt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[yD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[yD],this.endpoints=new Pbt(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",a,o,null,s)}),this.addHook("beforeCreateCol",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",a,o,null,s)}),this.addHook("beforeRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",a,o,null,s)}),this.addHook("afterCreateCol",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",a,o,null,s)}),this.addHook("afterRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),LO(Ry(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var a=this,o=0;return nr(i.ranges,function(s){o+=a.getPartialSum(s,i.sourceColumn)}),o}},{key:"getPartialSum",value:function(i,a){var o=0,s=i[1]||i[0],l=null,u=0;do{if(l=this.getCellValue(s,a),l=gD(l)?null:l,l!==null){var f=("".concat(l).split(".")[1]||[]).length||1;f>u&&(u=f)}o+=l||0,s-=1}while(s>=i[0]);return Math.round(o*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(i,a){var o=this,s=null;return nr(i.ranges,function(l){var u=o.getPartialMinMax(l,i.sourceColumn,a);if(s===null&&u!==null&&(s=u),u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,a,o){var s=null,l=i[1]||i[0],u;do{if(u=this.getCellValue(l,a),u=gD(u)?null:u,s===null)s=u;else if(u!==null)switch(o){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,a){var o,s=0,l=i[1]||i[0];do o=this.getCellValue(l,a),o=gD(o)?null:o,o===null&&(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var a=this,o=0,s=i.ranges;return nr(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,f=a.countEmpty(l,i.sourceColumn);o+=u,o-=f}),o}},{key:"calculateAverage",value:function(i){var a=this.calculateSum(i),o=this.countEntries(i);return a/o}},{key:"getCellValue",value:function(i,a){var o=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(a),l=this.hot.getSourceDataAtCell(i,a),u="";if(o!==null&&s!==null&&(u=this.hot.getCellMeta(o,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Wr(QJ||(QJ=Ibt(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,a));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,a){i&&a!=="ColumnSummary.reset"&&a!=="ColumnSummary.set"&&a!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,a){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",a,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return yD}},{key:"PLUGIN_PRIORITY",get:function(){return Ubt}}]),r}(Ar);function rS(e){return rS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rS(e)}function zbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ybt(n.key),n)}}function Gbt(e,t,r){return t&&tQ(e.prototype,t),r&&tQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ybt(e){var t=Kbt(e,"string");return rS(t)==="symbol"?t:String(t)}function Kbt(e,t){if(rS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xbt=function(){function e(t,r){zbt(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Gbt(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:jr(this.getInputElement()),height:mn(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ge(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ge(r,e.CLASS_EDITOR),Ge(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const qbt=Xbt;var sr="---------";function Zbt(){return{name:sr}}function Jbt(e){return tr(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function vT(e){return Wt(e,"htSeparator")}function Qbt(e){return Wt(e,"htSubmenu")}function pT(e){return Wt(e,"htDisabled")}function gT(e){return Wt(e,"htSelectionDisabled")}function fv(e){var t=e.getSelected();return!t||t[0]<0?null:t}function ewt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function twt(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Th(e,t){var r={};return ve(e,function(n){n.forAll(function(i,a){i>=0&&a>=0&&(r[i]||(r[i]=[]),r[i][a]=t(i,a))})}),r}function Nf(e,t,r,n,i){ve(e,function(a){a.forAll(function(o,s){o>=0&&s>=0&&rwt(o,s,t,r,n,i)})})}function rwt(e,t,r,n,i,a){var o=i(e,t),s=n;o.className&&(r==="vertical"?s=ewt(o.className,n):s=twt(o.className,n)),a(e,t,"className",s)}function ll(e,t){var r=!1;return Array.isArray(e)&&ve(e,function(n){return n.forAll(function(i,a){if(i>=0&&a>=0&&t(i,a))return r=!0,!1}),r}),r}function eu(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function nwt(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function wve(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function iwt(e,t){var r=e.slice(0);return r.reverse(),r=wve(r,t),r.reverse(),r}function awt(e){var t=[];return ve(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function owt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sr,r=e.slice(0);return r=wve(r,t),r=iwt(r,t),r=awt(r),r}function nS(e){return nS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nS(e)}function swt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uwt(n.key),n)}}function lwt(e,t,r){return t&&rQ(e.prototype,t),r&&rQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uwt(e){var t=fwt(e,"string");return nS(t)==="symbol"?t:String(t)}function fwt(e,t){if(nS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cwt=250,hwt=250,_ve=function(){function e(t){swt(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return lwt(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},hwt)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cwt;this.showDebounced=AW(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();qr(_ve,Va);const dwt=_ve;function ky(e){return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function mD(e,t,r){return t=Sve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sve(n.key),n)}}function pwt(e,t,r){return t&&nQ(e.prototype,t),r&&nQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sve(e){var t=gwt(e,"string");return ky(t)==="symbol"?t:String(t)}function gwt(e,t){if(ky(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xh(){return typeof Reflect<"u"&&Reflect.get?Xh=Reflect.get.bind():Xh=function(t,r,n){var i=ywt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Xh.apply(this,arguments)}function ywt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vu(e),e!==null););return e}function mwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hH(e,t)}function hH(e,t){return hH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hH(e,t)}function bwt(e){var t=_wt();return function(){var n=vu(e),i;if(t){var a=vu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return wwt(this,i)}}function wwt(e,t){if(t&&(ky(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cve(e)}function Cve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vu(e)}var bD="comments",Swt=60,yT=new WeakMap,Qs="comment",sp="value",iQ="style",mT="readOnly",Cwt=function(e){mwt(r,e);var t=bwt(r);function r(n){var i;return vwt(this,r),i=t.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,yT.set(Cve(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return pwt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new qbt(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new bn(this)),this.displaySwitch||(this.displaySwitch=new dwt(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(a){return i.addToContextMenu(a)}),this.addHook("afterRenderer",function(a,o,s,l,u,f){return i.onAfterRenderer(a,f)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(a,o){return i.showAtCell(a,o)}),this.registerListeners(),Xh(vu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Xh(vu(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Xh(vu(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,a=this.hot.rootDocument;this.eventManager.addEventListener(a,"mouseover",function(o){return i.onMouseOver(o)}),this.eventManager.addEventListener(a,"mousedown",function(o){return i.onMouseDown(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(o){return i.onEditorMouseDown(o)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(o){return i.onEditorMouseUp(o)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var a=ic(i.target,"TD","TBODY");return!!(a&&Wt(a,"htCommentCell")&&ic(a,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.editor.getValue(),o="";i!=null?o=i:a!=null&&(o=a);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,mD({},sp,o)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,a,o){this.setRange({from:this.hot._createCellCoords(i,a)}),this.setComment(o)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Qs),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,a)}),this.removeComment(o)}},{key:"getComment",value:function(){var i=this.range.from.row,a=this.range.from.col;return this.getCommentMeta(i,a,sp)}},{key:"getCommentAtCell",value:function(i,a){return this.getCommentMeta(i,a,sp)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,a=i.row,o=i.col;if(a<0||a>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[Qs]?s[Qs][sp]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,a){return this.setRange({from:this.hot._createCellCoords(i,a)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,a,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!o&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=l.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),g=d===null;this.editor.setPosition(0,0),d===null&&(d=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var y=d===null,b=v===null;d=(i=d)!==null&&i!==void 0?i:0,v=(a=v)!==null&&a!==void 0?a:0;var w=this.hot,_=w.rootWindow,x=w.view._wt,E=x.wtTable,R=x.getCell({row:d,col:v},!0),A=this.getCommentMeta(c,h,iQ);A?this.editor.setSize(A.width,A.height):this.editor.resetSize();var N=b?0:E.getStretchedColumnWidth(v),I=g&&!y?mn(R):0,F=R.getBoundingClientRect(),H=F.left,W=F.top,z=F.width,te=F.height,ie=this.editor.getSize(),fe=ie.width,Te=ie.height,M=this.hot.rootWindow,S=M.innerWidth,T=M.innerHeight,k=this.hot.rootDocument.documentElement,O=H+_.scrollX+N,D=W+_.scrollY+I;this.hot.isRtl()&&(O-=fe+N),this.hot.isLtr()&&H+z+fe>S?O=H+_.scrollX-fe-1:this.hot.isRtl()&&O<-(k.scrollWidth-k.clientWidth)&&(O=H+_.scrollX+N+1),W+Te>T&&(D-=Te-te+1),this.editor.setPosition(O,D),this.editor.setReadOnlyState(this.getCommentMeta(c,h,mT))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var a=!1,o=i.getTopStartCorner();return this.getCommentMeta(o.row,o.col,sp)&&(a=!0),a}},{key:"updateCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a)[Qs],l;s?(l=Ui(s),E1(l,o)):l=o,this.hot.setCellMeta(i,a,Qs,l)}},{key:"getCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a);if(s[Qs])return s[Qs][o]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var a=ic(i.target,"TD","TBODY"),o=null;a&&(o=this.hot.getCoords(a)),(!a||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var a=yT.get(this),o=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Wt(i.target,"wtBorder")||a.cellBelowCursor===i.target||!this.editor))if(a.cellBelowCursor=o.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var s=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(s)}else ac(i.target,o)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,a){a[Qs]&&a[Qs][sp]&&Ge(i,a.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var a=yT.get(this);a.tempEditorDimensions={width:jr(i.target),height:mn(i.target)}}},{key:"onEditorMouseUp",value:function(i){var a=yT.get(this),o=jr(i.target),s=mn(i.target);(o!==a.tempEditorDimensions.width+1||s!==a.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,mD({},iQ,{width:o,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){o>=0&&s>=0&&i.removeCommentAtCell(o,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){if(o>=0&&s>=0){var l=!!i.getCommentMeta(o,s,mT);i.updateCommentMeta(o,s,mD({},mT,!l))}})}},{key:"addToContextMenu",value:function(i){var a=this,o=function(){return a.hot.rowIndexMapper.getRenderableIndexesLength()>0&&a.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return a.checkSelectionCommentsConsistency()?a.hot.getTranslatedPhrase(TV):a.hot.getTranslatedPhrase(xV)},callback:function(){return a.onContextMenuAddComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(OV)},callback:function(){return a.onContextMenuRemoveComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(EV),f=ll(this.getSelectedRangeLast(),function(c,h){var d=l.getCellMeta(c,h)[Qs];if(d&&(d=d[mT]),d)return!0});return f&&(u=eu(u)),u},callback:function(){return a.onContextMenuMakeReadOnly()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner())||!a.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[bD];if(rr(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Xh(vu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bD}},{key:"PLUGIN_PRIORITY",get:function(){return Swt}}]),r}(Ar);function iS(e){return iS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iS(e)}function xwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Owt(n.key),n)}}function Twt(e,t,r){return t&&aQ(e.prototype,t),r&&aQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Owt(e){var t=Ewt(e,"string");return iS(t)==="symbol"?t:String(t)}function Ewt(e,t){if(iS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rwt=function(){function e(t){xwt(this,e),this.hot=t,this.commands={},this.commonCallback=null}return Twt(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,f=this.commands[l];if(!f)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&f.submenu&&(f=kwt(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!On(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),a.unshift(s.join(":")),ve(c,function(h){return h.apply(n.hot,a)})}}}]),e}();function kwt(e,t){var r;return ve(t,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===e)return r=n,!1}),r}const xve=Rwt;var $o="alignment";function Awt(){return{key:$o,name:function(){return this.getTranslatedPhrase(RV)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat($o,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(kV),n=ll(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htLeft")!==-1)return!0});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Th(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htLeft";this.runHooks("beforeCellAlignment",n,r,i,a),Nf(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat($o,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(AV),n=ll(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htCenter")!==-1)return!0});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Th(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htCenter";this.runHooks("beforeCellAlignment",n,r,i,a),Nf(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat($o,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(PV),n=ll(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htRight")!==-1)return!0});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Th(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htRight";this.runHooks("beforeCellAlignment",n,r,i,a),Nf(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat($o,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(IV),n=ll(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htJustify")!==-1)return!0});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Th(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htJustify";this.runHooks("beforeCellAlignment",n,r,i,a),Nf(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{name:sr},{key:"".concat($o,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(MV),n=ll(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htTop")!==-1)return!0});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Th(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htTop";this.runHooks("beforeCellAlignment",n,r,i,a),Nf(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat($o,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(DV),n=ll(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htMiddle")!==-1)return!0});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Th(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,a),Nf(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat($o,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase($V),n=ll(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htBottom")!==-1)return!0});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Th(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htBottom";this.runHooks("beforeCellAlignment",n,r,i,a),Nf(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1}]}}}var BA="clear_column";function Pwt(){return{key:BA,name:function(){return this.getTranslatedPhrase(vV)},callback:function(t,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=fv(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var z1="col_left";function Iwt(){return{key:z1,name:function(){return this.getTranslatedPhrase(sV)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=fv(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var G1="col_right";function Mwt(){return{key:G1,name:function(){return this.getTranslatedPhrase(lV)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=fv(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Y1="make_read_only";function Dwt(){return{key:Y1,name:function(){var t=this,r=this.getTranslatedPhrase(dV),n=ll(this.getSelectedRange(),function(i,a){return t.getCellMeta(i,a).readOnly});return n&&(r=eu(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=ll(r,function(i,a){return t.getCellMeta(i,a).readOnly});ve(r,function(i){i.forAll(function(a,o){a>=0&&o>=0&&t.setCellMeta(a,o,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var WA="redo";function $wt(){return{key:WA,name:function(){return this.getTranslatedPhrase(hV)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function Nwt(e,t){return Bwt(e)||Hwt(e,t)||Fwt(e,t)||Lwt()}function Lwt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fwt(e,t){if(e){if(typeof e=="string")return oQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oQ(e,t)}}function oQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hwt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Bwt(e){if(Array.isArray(e))return e}var K1="remove_col";function Wwt(){return{key:K1,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=Nwt(t[0],4),i=n[1],a=n[3];i-a!==0&&(r=1)}return this.getTranslatedPhrase(fV,r)},callback:function(){this.alter("remove_col",Jft(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=fv(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function Vwt(e,t){return Gwt(e)||zwt(e,t)||jwt(e,t)||Uwt()}function Uwt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jwt(e,t){if(e){if(typeof e=="string")return sQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sQ(e,t)}}function sQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zwt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Gwt(e){if(Array.isArray(e))return e}var VA="remove_row";function Ywt(){return{key:VA,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=Vwt(t[0],3),i=n[0],a=n[2];i-a!==0&&(r=1)}return this.getTranslatedPhrase(uV,r)},callback:function(){this.alter("remove_row",Qft(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=fv(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var UA="row_above";function Kwt(){return{key:UA,name:function(){return this.getTranslatedPhrase(aV)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=fv(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var jA="row_below";function Xwt(){return{key:jA,name:function(){return this.getTranslatedPhrase(oV)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=fv(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var aS="no_items";function qwt(){return{key:aS,name:function(){return this.getTranslatedPhrase(iV)},disabled:!0,isCommand:!1}}var zA="undo";function Zwt(){return{key:zA,name:function(){return this.getTranslatedPhrase(cV)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function oS(e){return oS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oS(e)}var Qi;function Ya(e,t,r){return t=Jwt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jwt(e){var t=Qwt(e,"string");return oS(t)==="symbol"?t:String(t)}function Qwt(e,t){if(oS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(oS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var e_t=[UA,jA,z1,G1,BA,VA,K1,zA,WA,Y1,$o,sr,aS],t_t=(Qi={},Ya(Qi,sr,Zbt),Ya(Qi,aS,qwt),Ya(Qi,UA,Kwt),Ya(Qi,jA,Xwt),Ya(Qi,z1,Iwt),Ya(Qi,G1,Mwt),Ya(Qi,BA,Pwt),Ya(Qi,VA,Ywt),Ya(Qi,K1,Wwt),Ya(Qi,zA,Zwt),Ya(Qi,WA,$wt),Ya(Qi,Y1,Dwt),Ya(Qi,$o,Awt),Qi);function Tve(){var e={};return nr(t_t,function(t,r){e[r]=t()}),e}function sS(e){return sS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sS(e)}function r_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i_t(n.key),n)}}function n_t(e,t,r){return t&&lQ(e.prototype,t),r&&lQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i_t(e){var t=a_t(e,"string");return sS(t)==="symbol"?t:String(t)}function a_t(e,t){if(sS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o_t=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;r_t(this,e),this.hot=t,this.predefinedItems=Tve(),this.defaultOrderPattern=r}return n_t(e,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,nr(r,function(a,o){var s="";a.name===sr?(i[sr]=a,s=sr):isNaN(parseInt(o,10))?(a.key=a.key===void 0?o:a.key,i[o]=a,s=a.key):(i[a.key]=a,s=a.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return s_t(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function s_t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=e;return i&&i.items?i=i.items:Array.isArray(i)||(i=t),rr(i)?nr(i,function(a,o){var s=r[typeof a=="string"?a:o];s||(s=a),rr(a)?zn(s,a):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=o),n.push(s)}):ve(i,function(a,o){var s=r[a];!s&&e_t.indexOf(a)>=0||(s||(s={name:a,key:"".concat(o)}),rr(a)&&zn(s,a),s.key===void 0&&(s.key=o),n.push(s))}),n}const Ove=o_t;function lS(e){return lS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lS(e)}function l_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f_t(n.key),n)}}function u_t(e,t,r){return t&&uQ(e.prototype,t),r&&uQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f_t(e){var t=c_t(e,"string");return lS(t)==="symbol"?t:String(t)}function c_t(e,t){if(lS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h_t=function(){function e(t,r){l_t(this,e);var n=Cg(r),i=Md(r),a,o,s,l,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(a=parseInt(t.top,10),s=parseInt(t.left,10),u=t.height||0,f=t.width||0,o=a,l=s,a+=n,s+=i):this.type==="event"&&(a=parseInt(t.pageY,10),s=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,o=a-n,l=s-i),this.top=a,this.topRelative=o,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=f}return u_t(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const d_t=h_t;function uS(e){return uS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uS(e)}function fQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fQ(Object(r),!0).forEach(function(n){v_t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v_t(e,t,r){return t=Eve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eve(n.key),n)}}function g_t(e,t,r){return t&&hQ(e.prototype,t),r&&hQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eve(e){var t=y_t(e,"string");return uS(t)==="symbol"?t:String(t)}function y_t(e,t){if(uS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dQ=215,Rve="menu",m_t=Rve,kve=function(){function e(t,r){p_t(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:dQ,container:this.hot.rootDocument.documentElement},this.eventManager=new bn(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return g_t(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=Uw(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=AW(function(d){return r.openSubMenu(d)},300),i=this.options.minWidth||dQ,a=!1,o=lo(this.menuItems,function(d){return d.key===aS&&(a=!0),nwt(d,r.hot)});if(o.length<1&&!a)o.push(Tve()[aS]);else if(o.length===0)return;o=owt(o,sr);var s=!1,l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return dt(v)&&v<i?i:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,g,y,b,w,_){return r.menuItemRenderer(v,g,y,b,w,_)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,g){r.isAllSubMenusClosed()?n(g.row):r.openSubMenu(g.row)},rowHeights:function(v){return o[v].name===sr?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),sL()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!sL()||!Rc(v))&&s&&r.hasSelectedItem()&&(Es()||nW()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new RU(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(m_t),c={group:Rve},h=cQ(cQ({},c),{},{runOnlyIf:function(v){return Gw(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var g=r.openSubMenu(v[0]);g&&g.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var g=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(g[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!Qbt(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),a=new e(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return a.setMenuItems(i.submenu.items),a.open(),a.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=a,a}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;ve(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),a=i?Jbt(i):[];this.runLocalHooks("executeCommand",n.key,a,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,a,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,a=r.disabled,o=r.submenu,s=a===!0||typeof a=="function"&&a.call(this.hot)===!0;return n===!1||i===sr||s===!0||o}},{key:"setPosition",value:function(r){var n=new d_t(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.right;n+=r.cellWidth+a-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.left;n-=r.left-a}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);vT(r)||pT(r)||gT(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);vT(n)||pT(n)||gT(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,a=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;a&&(vT(a)||pT(a)||gT(a)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,a=i>=0?this.hotMenu.getCell(i,n):null;a&&(vT(a)||pT(a)||gT(a)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,a,o,s){var l=this,u=r.getSourceDataAtRow(i),f=this.hot.rootDocument.createElement("div"),c=function(b){return On(b,"submenu")},h=function(b){return new RegExp(sr,"i").test(b.name)},d=function(b){return b.disabled===!0||typeof b.disabled=="function"&&b.disabled.call(l.hot)===!0},v=function(b){return b.disableSelection},g=s;typeof g=="function"&&(g=g.call(this.hot)),$s(n),Ge(f,"htItemWrapper"),n.appendChild(f),h(u)?Ge(n,"htSeparator"):typeof u.renderer=="function"?(Ge(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,i,a,o,g))):sv(f,g),d(u)?(Ge(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(Ge(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(Ge(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)})):(Vt(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,a;return i&&(Qr(i)&&(i=i.call(this.hot),i===null||Yr(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),a=n.querySelector(".".concat(this.options.className,".").concat(i))),a||(a=n.createElement("div"),Ge(a,"htMenu ".concat(this.options.className)),i&&Ge(a,i),this.options.container.appendChild(a)),a}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,a=r.holder.style,o=parseInt(i.width,10),s=Nn(n,function(l,u){return l+(u.name===sr?1:26)},0);a.width="".concat(o+3,"px"),a.height="".concat(s+3,"px"),i.height=a.height}},{key:"onAfterSelection",value:function(r,n,i,a,o){this.keyEvent===!1&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ac(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ac(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&Wt(r.target,"htCore")&&ac(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();qr(kve,Va);const zU=kve;function Ay(e){return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function b_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,__t(n.key),n)}}function w_t(e,t,r){return t&&vQ(e.prototype,t),r&&vQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function __t(e){var t=S_t(e,"string");return Ay(t)==="symbol"?t:String(t)}function S_t(e,t){if(Ay(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qh(){return typeof Reflect<"u"&&Reflect.get?qh=Reflect.get.bind():qh=function(t,r,n){var i=C_t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},qh.apply(this,arguments)}function C_t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pu(e),e!==null););return e}function x_t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dH(e,t)}function dH(e,t){return dH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dH(e,t)}function T_t(e){var t=E_t();return function(){var n=pu(e),i;if(t){var a=pu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return O_t(this,i)}}function O_t(e,t){if(t&&(Ay(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ave(e)}function Ave(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E_t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pu(e){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pu(e)}var bT="contextMenu",R_t=70;pt.getSingleton().register("afterContextMenuDefaultOptions");pt.getSingleton().register("beforeContextMenuShow");pt.getSingleton().register("afterContextMenuShow");pt.getSingleton().register("afterContextMenuHide");pt.getSingleton().register("afterContextMenuExecute");var Pve=function(e){x_t(r,e);var t=T_t(r);function r(n){var i;return b_t(this,r),i=t.call(this,n),i.eventManager=new bn(Ave(i)),i.commandExecutor=new xve(i.hot),i.itemsFactory=null,i.menu=null,i}return w_t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bT]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[bT];typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),this.menu=new zU(this.hot,{className:"htContextMenu",keepInViewport:!0,container:a.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var o,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(o=i.executeCommand).call.apply(o,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(o){return i.onAfterOnCellContextMenu(o)}),qh(pu(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),qh(pu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),qh(pu(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u-Cg(i.view),o=f-Md(i.view)}else a=-1*Cg(this.menu.hotMenu.rootWindow),o=-1*Md(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+a,left:parseInt(i.pageX,10)+o})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var a;this.itemsFactory===null&&this.prepareMenuItems();for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new Ove(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[bT],o={items:this.itemsFactory.getItems(a)};this.hot.runHooks("afterContextMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);var s=this.itemsFactory.getItems(a);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),ve(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var a=this.hot.getSettings(),o=a.rowHeaders,s=a.colHeaders;function l(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=i.target;this.close(),!Wt(u,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(o||s)&&!l(u)&&!(Wt(u,"current")&&Wt(u,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),qh(pu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bT}},{key:"PLUGIN_PRIORITY",get:function(){return R_t}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[UA,jA,sr,z1,G1,sr,VA,K1,sr,zA,WA,sr,Y1,sr,$o]}}]),r}(Ar);Pve.SEPARATOR={name:sr};function k_t(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(pV)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function A_t(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(mV,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function P_t(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(yV,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function I_t(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(gV,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function M_t(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(bV)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function fS(e){return fS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fS(e)}function D_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N_t(n.key),n)}}function $_t(e,t,r){return t&&pQ(e.prototype,t),r&&pQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N_t(e){var t=L_t(e,"string");return fS(t)==="symbol"?t:String(t)}function L_t(e,t){if(fS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var F_t=function(){function e(){D_t(this,e),this.data={}}return $_t(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function cS(e){return cS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cS(e)}function gQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B_t(n.key),n)}}function H_t(e,t,r){return t&&gQ(e.prototype,t),r&&gQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B_t(e){var t=W_t(e,"string");return cS(t)==="symbol"?t:String(t)}function W_t(e,t){if(cS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var U_t=H_t(function e(){V_t(this,e),this.clipboardData=new F_t});function hS(e){return hS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hS(e)}function j_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G_t(n.key),n)}}function z_t(e,t,r){return t&&yQ(e.prototype,t),r&&yQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function G_t(e){var t=Y_t(e,"string");return hS(t)==="symbol"?t:String(t)}function Y_t(e,t){if(hS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GU=function(){function e(t){j_t(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new bn(this),this.listenersCount=new WeakSet,this.container=t}return z_t(e,[{key:"useSecondaryElement",value:function(){var r=q_t(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),mQ(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),mQ(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Es()||Ece(this.mainElement)}}]),e}();qr(GU,Va);var $R=new WeakMap;function K_t(e){var t=new GU(e),r=$R.get(e);return r=isNaN(r)?0:r,$R.set(e,r+1),t}function X_t(e){e.eventManager.clear()}var wD=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function mQ(e,t,r){e.addEventListener(t,"copy",wD("copy",r)),e.addEventListener(t,"cut",wD("cut",r)),e.addEventListener(t,"paste",wD("paste",r))}var NR=new WeakMap;function q_t(e){var t=NR.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return NR.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function bQ(e){if(e instanceof GU){var t=$R.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),X_t(e),t<=0){t=0;var r=NR.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),NR.delete(e.container)),e.mainElement=null}$R.set(e.container,t)}}function dS(e){return dS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dS(e)}function Z_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q_t(n.key),n)}}function J_t(e,t,r){return t&&wQ(e.prototype,t),r&&wQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q_t(e){var t=eSt(e,"string");return dS(t)==="symbol"?t:String(t)}function eSt(e,t){if(dS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Q(e,t){Ive(e,t),t.add(e)}function lp(e,t,r){Ive(e,t),t.set(e,r)}function Ive(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wT(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function na(e,t){var r=Mve(e,t,"get");return tSt(e,r)}function tSt(e,t){return t.get?t.get.call(e):t.value}function up(e,t,r){var n=Mve(e,t,"set");return rSt(e,n,r),r}function Mve(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function rSt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Rf=new WeakMap,_D=new WeakMap,rb=new WeakMap,vH=new WeakMap,pH=new WeakMap,nb=new WeakMap,_T=new WeakSet,SQ=new WeakSet,nSt=function(){function e(t){var r=t.countRows,n=t.countColumns,i=t.rowsLimit,a=t.columnsLimit,o=t.countColumnHeaders;Z_t(this,e),_Q(this,SQ),_Q(this,_T),lp(this,Rf,{writable:!0,value:void 0}),lp(this,_D,{writable:!0,value:void 0}),lp(this,rb,{writable:!0,value:void 0}),lp(this,vH,{writable:!0,value:void 0}),lp(this,pH,{writable:!0,value:void 0}),lp(this,nb,{writable:!0,value:void 0}),up(this,_D,r),up(this,rb,n),up(this,vH,i),up(this,pH,a),up(this,nb,o)}return J_t(e,[{key:"setSelectedRange",value:function(r){up(this,Rf,r)}},{key:"getCellsRange",value:function(){if(na(this,_D).call(this)===0||na(this,rb).call(this)===0)return null;var r=na(this,Rf).getTopStartCorner(),n=r.row,i=r.col,a=na(this,Rf).getBottomEndCorner(),o=a.row,s=a.col,l=wT(this,SQ,iSt).call(this,n,o),u=wT(this,_T,SD).call(this,i,s),f=o!==l||s!==u;return{isRangeTrimmed:f,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(na(this,rb).call(this)===0||na(this,nb).call(this)===0)return null;var r=na(this,Rf).getTopStartCorner(),n=r.col,i=na(this,Rf).getBottomEndCorner(),a=i.col,o=wT(this,_T,SD).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:o}}},{key:"getAllColumnHeadersRange",value:function(){if(na(this,rb).call(this)===0||na(this,nb).call(this)===0)return null;var r=na(this,Rf).getTopStartCorner(),n=r.col,i=na(this,Rf).getBottomEndCorner(),a=i.col,o=wT(this,_T,SD).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-na(this,nb).call(this),startCol:n,endRow:-1,endCol:o}}}]),e}();function SD(e,t){return Math.min(t,Math.max(e+na(this,pH).call(this)-1,e))}function iSt(e,t){return Math.min(t,Math.max(e+na(this,vH).call(this)-1,e))}function Dve(e){var t=[],r=[];return ve(e,function(n){var i=Math.min(n.startRow,n.endRow),a=Math.max(n.startRow,n.endRow);xt(i,a,function(l){t.indexOf(l)===-1&&t.push(l)});var o=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);xt(o,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:t,columns:r}}function aSt(e,t){return uSt(e)||lSt(e,t)||sSt(e,t)||oSt()}function oSt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sSt(e,t){if(e){if(typeof e=="string")return CQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CQ(e,t)}}function CQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lSt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function uSt(e){if(Array.isArray(e))return e}function Ud(e){return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}function fSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nve(n.key),n)}}function cSt(e,t,r){return t&&xQ(e.prototype,t),r&&xQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zh(){return typeof Reflect<"u"&&Reflect.get?Zh=Reflect.get.bind():Zh=function(t,r,n){var i=hSt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Zh.apply(this,arguments)}function hSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gu(e),e!==null););return e}function dSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gH(e,t)}function gH(e,t){return gH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gH(e,t)}function vSt(e){var t=gSt();return function(){var n=gu(e),i;if(t){var a=gu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pSt(this,i)}}function pSt(e,t){if(t&&(Ud(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ra(e)}function ra(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gu(e){return gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gu(e)}function ySt(e,t){$ve(e,t),t.add(e)}function Oh(e,t,r){$ve(e,t),t.set(e,r)}function $ve(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fp(e,t,r){return t=Nve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nve(e){var t=mSt(e,"string");return Ud(t)==="symbol"?t:String(t)}function mSt(e,t){if(Ud(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bSt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Ka(e,t){var r=Lve(e,t,"get");return wSt(e,r)}function wSt(e,t){return t.get?t.get.call(e):t.value}function Gl(e,t,r){var n=Lve(e,t,"set");return _St(e,n,r),r}function Lve(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _St(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pt.getSingleton().register("afterCopyLimit");pt.getSingleton().register("modifyCopyableRange");pt.getSingleton().register("beforeCut");pt.getSingleton().register("afterCut");pt.getSingleton().register("beforePaste");pt.getSingleton().register("afterPaste");pt.getSingleton().register("beforeCopy");pt.getSingleton().register("afterCopy");var ST="copyPaste",SSt=80,CSt=["fragmentSelection"],TQ=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),CD=new WeakMap,xD=new WeakMap,TD=new WeakMap,cp=new WeakMap,CT=new WeakMap,xT=new WeakMap,hp=new WeakMap,OQ=new WeakSet,xSt=function(e){dSt(r,e);var t=vSt(r);function r(){var n;fSt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),ySt(ra(n),OQ),fp(ra(n),"columnsLimit",1/0),fp(ra(n),"rowsLimit",1/0),fp(ra(n),"pasteMode","overwrite"),fp(ra(n),"uiContainer",n.hot.rootDocument.body),Oh(ra(n),CD,{writable:!0,value:!1}),Oh(ra(n),xD,{writable:!0,value:!1}),Oh(ra(n),TD,{writable:!0,value:!1}),Oh(ra(n),cp,{writable:!0,value:"cells-only"}),Oh(ra(n),CT,{writable:!0,value:!1}),Oh(ra(n),xT,{writable:!0,value:!1}),Oh(ra(n),hp,{writable:!0,value:new nSt({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),fp(ra(n),"copyableRanges",[]),fp(ra(n),"focusableElement",void 0),n}return cSt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ST]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a[ST];if(Ud(o)==="object"){var s,l;this.pasteMode=(s=o.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(o.rowsLimit)?this.rowsLimit:o.rowsLimit,this.columnsLimit=isNaN(o.columnsLimit)?this.columnsLimit:o.columnsLimit,Gl(this,CD,!!o.copyColumnHeaders),Gl(this,xD,!!o.copyColumnGroupHeaders),Gl(this,TD,!!o.copyColumnHeadersOnly),this.uiContainer=(l=o.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=K_t(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),Zh(gu(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Zh(gu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&bQ(this.focusableElement),Zh(gu(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Gl(this,cp,i),Gl(this,CT,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Gl(this,xT,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return nw(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var a=this,o=[],s=Dve(i),l=s.rows,u=s.columns;return ve(l,function(f){var c=[];ve(u,function(h){f<0?c.push(a.hot.getColHeader(h,f)):c.push(a.hot.getCopyableData(f,h))}),o.push(c)}),o}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!a)){var o=new U_t;i&&o.clipboardData.setData("text/plain",i),a&&o.clipboardData.setData("text/html",a),this.getOrCreateFocusableElement(),this.onPaste(o)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){Ka(this,hp).setSelectedRange(i);var a=new Map([["headers",null],["cells",null]]);Ka(this,cp)==="column-headers-only"?a.set("headers",Ka(this,hp).getMostBottomColumnHeadersRange()):(Ka(this,cp)==="with-column-headers"?a.set("headers",Ka(this,hp).getMostBottomColumnHeadersRange()):Ka(this,cp)==="with-column-group-headers"&&a.set("headers",Ka(this,hp).getAllColumnHeadersRange()),a.set("cells",Ka(this,hp).getCellsRange())),this.copyableRanges=Array.from(a.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,g=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:g}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var o=a.get("cells");if(o!==null&&o.isRangeTrimmed){var s=o.startRow,l=o.startCol,u=o.endRow,f=o.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,f-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,a=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;a?this.focusableElement.setFocusableElement(a):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var o=i.length,s=i[0].length,l=[],u=a.getTopStartCorner(),f=u.row,c=u.col,h=a.getBottomEndCorner(),d=h.row,v=h.col,g=f,y=c,b=f,w=c;l.length<o||g<=d;){var _=this.hot.getCellMeta(g,c),x=_.skipRowOnPaste,E=_.visualRow;if(g=E+1,x!==!0){b=E,y=c;for(var R=[],A=l.length%o;R.length<s||y<=v;){var N=this.hot.getCellMeta(f,y),I=N.skipColumnOnPaste,F=N.visualCol;if(y=F+1,I!==!0){w=F;var H=R.length%s;R.push(i[A][H])}}l.push(R)}}return this.hot.populateFromArray(f,c,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,b,w]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!Ka(this,CT)||this.isEditorOpened())){this.setCopyableText(),Gl(this,CT,!1);var a=this.getRangedData(this.copyableRanges),o=bSt(this,OQ,TSt).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges,o);if(s){var l=nw(a);if(i&&i.clipboardData){var u=ML(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[TQ,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",a,this.copyableRanges,o)}Gl(this,cp,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!Ka(this,xT)||this.isEditorOpened())){this.setCopyableText(),Gl(this,xT,!1);var a=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(o){var s=nw(a);if(i&&i.clipboardData){var l=ML(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[TQ,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var a;if(i&&typeof i.clipboardData<"u"){var o=_A(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){var s=qce(o,this.hot.rootDocument);a=s.data}else a=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(a=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof a=="string"&&(a=wct(a)),!(a&&a.length===0)&&this.hot.runHooks("beforePaste",a,this.copyableRanges)!==!1){var l=this.populateValues(a),u=aSt(l,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",a,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},k_t(this)),Ka(this,CD)&&i.items.push(I_t(this)),Ka(this,xD)&&i.items.push(P_t(this)),Ka(this,TD)&&i.items.push(A_t(this)),i.items.push(M_t(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&xce())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,a=this.hot.getActiveEditor();!a||i!==this.focusableElement.getFocusableElement()&&i!==a.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(bQ(this.focusableElement),this.focusableElement=null),Zh(gu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ST}},{key:"SETTING_KEYS",get:function(){return[ST].concat(CSt)}},{key:"PLUGIN_PRIORITY",get:function(){return SSt}}]),r}(Ar);function TSt(e){for(var t=Dve(e),r=t.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Fve(e,t){return"border_row".concat(e,"col").concat(t)}function Ob(){return{width:1,color:"#000"}}function yu(){return{hide:!0}}function OSt(){return{width:1,color:"#000",cornerVisible:!1}}function OD(e){if(dt(e.start)||dt(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(dt(e.end)||dt(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function ib(e){return dt(e.start)&&(e.left=e.start),dt(e.end)&&(e.right=e.end),e}function ED(e,t){return{id:Fve(e,t),border:OSt(),row:e,col:t,top:yu(),bottom:yu(),start:yu(),end:yu()}}function ESt(e,t){return On(t,"border")&&t.border&&(e.border=t.border),On(t,"top")&&dt(t.top)&&(t.top?(rr(t.top)||(t.top=Ob()),e.top=t.top):(t.top=yu(),e.top=t.top)),On(t,"bottom")&&dt(t.bottom)&&(t.bottom?(rr(t.bottom)||(t.bottom=Ob()),e.bottom=t.bottom):(t.bottom=yu(),e.bottom=t.bottom)),On(t,"start")&&dt(t.start)&&(t.start?(rr(t.start)||(t.start=Ob()),e.start=t.start):(t.start=yu(),e.start=t.start)),On(t,"end")&&dt(t.end)&&(t.end?(rr(t.end)||(t.end=Ob()),e.end=t.end):(t.end=yu(),e.end=t.end)),e}function Yu(e,t){var r=!1;return ve(e.getSelectedRange(),function(n){n.forAll(function(i,a){if(!(i<0||a<0)){var o=e.getCellMeta(i,a).borders;if(o)if(t){if(!On(o[t],"hide")||o[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function GA(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function RSt(e){return e.some(function(t){return dt(t.left)||dt(t.right)})}function kSt(e){return e.some(function(t){return dt(t.start)||dt(t.end)})}var ASt=new Map([["left","start"],["right","end"]]);function PSt(e){var t;return(t=ASt.get(e))!==null&&t!==void 0?t:e}function ISt(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(HV),n=Yu(this,"bottom");return n&&(r=GA(r)),r},callback:function(r,n){var i=Yu(this,"bottom");e.prepareBorder(n,"bottom",i)}}}function MSt(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(BV),i=Yu(this,t);return i&&(n=GA(n)),n},callback:function(n,i){var a=Yu(this,t);e.prepareBorder(i,t,a)}}}function DSt(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(WV)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!Yu(this)}}}function $St(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(FV),i=Yu(this,t);return i&&(n=GA(n)),n},callback:function(n,i){var a=Yu(this,t);e.prepareBorder(i,t,a)}}}function NSt(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(LV),n=Yu(this,"top");return n&&(r=GA(r)),r},callback:function(r,n){var i=Yu(this,"top");e.prepareBorder(n,"top",i)}}}function Py(e){return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Py(e)}function EQ(e,t){return BSt(e)||HSt(e,t)||FSt(e,t)||LSt()}function LSt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FSt(e,t){if(e){if(typeof e=="string")return RQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RQ(e,t)}}function RQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HSt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function BSt(e){if(Array.isArray(e))return e}function WSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bve(n.key),n)}}function VSt(e,t,r){return t&&kQ(e.prototype,t),r&&kQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jh(){return typeof Reflect<"u"&&Reflect.get?Jh=Reflect.get.bind():Jh=function(t,r,n){var i=USt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Jh.apply(this,arguments)}function USt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mu(e),e!==null););return e}function jSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yH(e,t)}function yH(e,t){return yH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yH(e,t)}function zSt(e){var t=YSt();return function(){var n=mu(e),i;if(t){var a=mu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return GSt(this,i)}}function GSt(e,t){if(t&&(Py(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hve(e)}function Hve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mu(e)}function KSt(e,t,r){return t=Bve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bve(e){var t=XSt(e,"string");return Py(t)==="symbol"?t:String(t)}function XSt(e,t){if(Py(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TT="customBorders",qSt=90,ZSt=function(e){jSt(r,e);var t=zSt(r);function r(){var n;WSt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),KSt(Hve(n),"savedBorders",[]),n}return VSt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[TT]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.onAfterContextMenuDefaultOptions(a)}),this.addHook("init",function(){return i.onAfterInit()}),Jh(mu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Jh(mu(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Jh(mu(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,a){var o=this,s=["top","bottom","start","end"],l=null;a&&(this.checkSettingsCohesion([a]),s=Object.keys(a),l=OD(a));var u=ty(i),f=W_(u);ve(i,function(c){for(var h=f(c),d=EQ(h,4),v=d[0],g=d[1],y=d[2],b=d[3],w=function(E){for(var R=function(I){ve(s,function(F){o.prepareBorderFromCustomAdded(E,I,l,PSt(F))})},A=g;A<=b;A+=1)R(A)},_=v;_<=y;_+=1)w(_)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var a=this;if(!Array.isArray(i))return this.savedBorders;var o=ty(i),s=W_(o),l=[];return ve(i,function(u){for(var f=s(u),c=EQ(f,4),h=c[0],d=c[1],v=c[2],g=c[3],y=function(_){for(var x=function(A){ve(a.savedBorders,function(N){N.row===_&&N.col===A&&l.push(ib(N))})},E=d;E<=g;E+=1)x(E)},b=h;b<=v;b+=1)y(b)}),l}},{key:"clearBorders",value:function(i){var a=this;i?this.setBorders(i):(ve(this.savedBorders,function(o){a.clearBordersFromSelectionSettings(o.id),a.clearNullCellRange(),a.hot.removeCellMeta(o.row,o.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,a){var o=this.checkSavedBorders(i);o||this.savedBorders.push(i);var s=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),l=this.checkCustomSelections(i,s,a);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,a,o,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(i>=l||a>=u)){var f=ED(i,a);o&&(f=ESt(f,o),ve(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,o),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(i,a,"borders",ib(f)),this.insertBorderIntoSettings(f,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,a){var o=this,s=Math.min(i.to.row,this.hot.countRows()-1),l=Math.min(i.to.col,this.hot.countCols()-1);xt(i.from.row,s,function(u){xt(i.from.col,l,function(f){var c=ED(u,f),h=0;u===i.from.row&&On(a,"top")&&(h+=1,c.top=a.top),u===i.to.row&&On(a,"bottom")&&(h+=1,c.bottom=a.bottom),f===i.from.col&&On(a,"start")&&(h+=1,c.start=a.start),f===i.to.col&&On(a,"end")&&(h+=1,c.end=a.end),h>0&&(o.hot.setCellMeta(u,f,"borders",ib(c)),o.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(i,a){var o=Fve(i,a);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(i,a,"borders")}},{key:"setBorder",value:function(i,a,o,s){var l=this.hot.getCellMeta(i,a).borders;if(!l||l.border===void 0?l=ED(i,a):l=OD(l),s){l[o]=yu();var u=this.countHide(l);if(u===4)this.removeAllBorders(i,a);else{var f=this.checkCustomSelectionsFromContextMenu(l,o,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",ib(l))}}else{l[o]=Ob();var c=this.checkCustomSelectionsFromContextMenu(l,o,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",ib(l))}}},{key:"prepareBorder",value:function(i,a,o){var s=this;ve(i,function(l){var u=l.start,f=l.end;if(u.row===f.row&&u.col===f.col)a==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,a,o);else switch(a){case"noBorders":xt(u.col,f.col,function(c){xt(u.row,f.row,function(h){s.removeAllBorders(h,c)})});break;case"top":xt(u.col,f.col,function(c){s.setBorder(u.row,c,a,o)});break;case"bottom":xt(u.col,f.col,function(c){s.setBorder(f.row,c,a,o)});break;case"start":xt(u.row,f.row,function(c){s.setBorder(c,u.col,a,o)});break;case"end":xt(u.row,f.row,function(c){s.setBorder(c,f.col,a,o)});break}})}},{key:"createCustomBorders",value:function(i){var a=this;ve(i,function(o){var s=OD(o);o.range?a.prepareBorderFromCustomAddedRange(o.range,s):a.prepareBorderFromCustomAdded(o.row,o.col,s)})}},{key:"countHide",value:function(i){var a=i.top,o=i.bottom,s=i.start,l=i.end,u=[a,o,s,l];return Nn(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var a=tr(this.hot.selection.highlight.customSelections,function(o){return o.settings.id}).indexOf(i);a>-1&&this.hot.selection.highlight.customSelections[a].clear()}},{key:"clearNullCellRange",value:function(){var i=this;ve(this.hot.selection.highlight.customSelections,function(a,o){if(a.cellRange===null)return i.hot.selection.highlight.customSelections[o].destroy(),i.hot.selection.highlight.customSelections.splice(o,1),!1})}},{key:"hideBorders",value:function(){var i=this;ve(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var a=tr(this.savedBorders,function(o){return o.id}).indexOf(i);a>-1&&this.savedBorders.splice(a,1)}},{key:"checkSavedBorders",value:function(i){var a=this,o=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),o=!0):ve(this.savedBorders,function(l,u){if(i.id===l.id)return a.savedBorders[u]=i,o=!0,!1}),o}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,a,o){var s=!1;return ve(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return nr(l.instanceBorders,function(u){u.toggleHiddenClass(a,o)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,a,o){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):ve(this.hot.selection.highlight.customSelections,function(u){if(i.id===u.settings.id)return u.visualCellRange=a,u.commit(),o&&nr(u.instanceBorders,function(f){f.changeBorderStyle(o,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[TT];if(Array.isArray(i)){var a=Ui(i);this.checkSettingsCohesion(a),a.length||(this.savedBorders=a),this.createCustomBorders(a)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var a=RSt(i),o=kSt(i);if(a&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&a)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){this.hot.getSettings()[TT]&&i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(NV)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[NSt(this),$St(this),ISt(this),MSt(this),DSt(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Jh(mu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TT}},{key:"PLUGIN_PRIORITY",get:function(){return qSt}}]),r}(Ar);function Iy(e){return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}function JSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e1t(n.key),n)}}function QSt(e,t,r){return t&&AQ(e.prototype,t),r&&AQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e1t(e){var t=t1t(e,"string");return Iy(t)==="symbol"?t:String(t)}function t1t(e,t){if(Iy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qh(){return typeof Reflect<"u"&&Reflect.get?Qh=Reflect.get.bind():Qh=function(t,r,n){var i=r1t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Qh.apply(this,arguments)}function r1t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function n1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mH(e,t)}function mH(e,t){return mH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mH(e,t)}function i1t(e){var t=o1t();return function(){var n=bu(e),i;if(t){var a=bu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return a1t(this,i)}}function a1t(e,t){if(t&&(Iy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wve(e)}function Wve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var PQ="dragToScroll",s1t=100,l1t=function(e){n1t(r,e);var t=i1t(r);function r(n){var i;return JSt(this,r),i=t.call(this,n),i.eventManager=new bn(Wve(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return QSt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PQ]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(a){return i.setupListening(a)}),this.addHook("afterOnCellCornerMouseDown",function(a){return i.setupListening(a)}),this.registerEvents(),Qh(bu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qh(bu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Qh(bu(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,a){var o=0,s=0;a<this.boundaries.top?s=a-this.boundaries.top:a>this.boundaries.bottom&&(s=a-this.boundaries.bottom),i<this.boundaries.left?o=i-this.boundaries.left:i>this.boundaries.right&&(o=i-this.boundaries.right),this.callback(o,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,a=this.hot.rootWindow,o=a;o;)this.eventManager.addEventListener(o.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mousemove",function(s){return i.onMouseMove(s)}),o=Uw(o)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!Rc(i)){var a=this.hot.view._wt.wtTable.holder;a!==this.hot.rootWindow&&(this.setBoundaries(a.getBoundingClientRect()),this.setCallback(function(o,s){o<0?a.scrollLeft-=50:o>0&&(a.scrollLeft+=50),s<0?a.scrollTop-=20:s>0&&(a.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){Qh(bu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PQ}},{key:"PLUGIN_PRIORITY",get:function(){return s1t}}]),r}(Ar);function My(e){return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},My(e)}function u1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c1t(n.key),n)}}function f1t(e,t,r){return t&&IQ(e.prototype,t),r&&IQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c1t(e){var t=h1t(e,"string");return My(t)==="symbol"?t:String(t)}function h1t(e,t){if(My(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(My(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ed(){return typeof Reflect<"u"&&Reflect.get?ed=Reflect.get.bind():ed=function(t,r,n){var i=d1t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ed.apply(this,arguments)}function d1t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wu(e),e!==null););return e}function v1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bH(e,t)}function bH(e,t){return bH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bH(e,t)}function p1t(e){var t=y1t();return function(){var n=wu(e),i;if(t){var a=wu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return g1t(this,i)}}function g1t(e,t){if(t&&(My(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vve(e)}function Vve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wu(e){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wu(e)}pt.getSingleton().register("afterDropdownMenuDefaultOptions");pt.getSingleton().register("beforeDropdownMenuShow");pt.getSingleton().register("afterDropdownMenuShow");pt.getSingleton().register("afterDropdownMenuHide");pt.getSingleton().register("afterDropdownMenuExecute");var RD="dropdownMenu",m1t=230,kD="changeType",Uve=function(e){v1t(r,e);var t=p1t(r);function r(n){var i;return u1t(this,r),i=t.call(this,n),i.eventManager=new bn(Vve(i)),i.commandExecutor=new xve(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return f1t(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[RD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new Ove(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[RD],o={items:this.itemsFactory.getItems(a)};this.registerEvents(),typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),ed(wu(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",o),i.itemsFactory.setPredefinedItems(o.items);var s=i.itemsFactory.getItems(a);i.menu&&i.menu.destroy(),i.menu=new zU(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:a.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(l=i.executeCommand).call.apply(l,[i].concat(f))}),ve(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ed(wu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),ed(wu(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(a){return i.onTableClick(a)})}},{key:"open",value:function(i){this.menu&&(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),Wt(i.target,kD)&&!this.menu.isOpened()){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u,o=f}var c=i.target.getBoundingClientRect();this.open({left:c.left+o,top:c.top+i.target.offsetHeight+3+a,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(i,a){var o=a.parentNode;if(o){var s=o.parentNode.childNodes,l=Array.prototype.indexOf.call(s,o);if(!(i<0||l!==s.length-1)){var u=a.querySelector(".".concat(kD));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=kD,f.type="button",f.onclick=function(){return!1},a.firstChild.insertBefore(f,a.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ed(wu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return RD}},{key:"PLUGIN_PRIORITY",get:function(){return m1t}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[z1,G1,sr,K1,sr,BA,sr,Y1,sr,$o]}}]),r}(Ar);Uve.SEPARATOR={name:sr};function vS(e){return vS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vS(e)}function b1t(e,t){return C1t(e)||S1t(e,t)||_1t(e,t)||w1t()}function w1t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _1t(e,t){if(e){if(typeof e=="string")return MQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MQ(e,t)}}function MQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S1t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function C1t(e){if(Array.isArray(e))return e}function x1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O1t(n.key),n)}}function T1t(e,t,r){return t&&DQ(e.prototype,t),r&&DQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O1t(e){var t=E1t(e,"string");return vS(t)==="symbol"?t:String(t)}function E1t(e,t){if(vS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R1t=function(){function e(t){x1t(this,e),this.hot=t,this.options={}}return T1t(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,a=n.startCol,o=n.endRow,s=n.endCol,l=this.options,u=[];return xt(i,o,function(f){var c=[];!l.exportHiddenRows&&r._isHiddenRow(f)||(xt(a,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),a=i.startRow,o=i.endRow,s=this.hot.getRowHeader();xt(a,o,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),a=i.startCol,o=i.endCol,s=this.hot.getColHeader();xt(a,o,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=b1t(this.options.range,4),a=i[0],o=a===void 0?0:a,s=i[1],l=s===void 0?0:s,u=i[2],f=u===void 0?n:u,c=i[3],h=c===void 0?r:c;return o=Math.max(o,0),l=Math.max(l,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:o,startCol:l,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const k1t=R1t;function pS(e){return pS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pS(e)}function A1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I1t(n.key),n)}}function P1t(e,t,r){return t&&$Q(e.prototype,t),r&&$Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I1t(e){var t=M1t(e,"string");return pS(t)==="symbol"?t:String(t)}function M1t(e,t){if(pS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D1t=function(){function e(t,r){A1t(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return P1t(e,[{key:"_mergeOptions",value:function(r){var n=ca(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=zn(ca(e.DEFAULT_OPTIONS),n),n=zn(n,r),n.filename=OW(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const $1t=D1t;function Dy(e){return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dy(e)}function N1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F1t(n.key),n)}}function L1t(e,t,r){return t&&NQ(e.prototype,t),r&&NQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F1t(e){var t=H1t(e,"string");return Dy(t)==="symbol"?t:String(t)}function H1t(e,t){if(Dy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wH(e,t)}function wH(e,t){return wH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wH(e,t)}function W1t(e){var t=j1t();return function(){var n=LR(e),i;if(t){var a=LR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return V1t(this,i)}}function V1t(e,t){if(t&&(Dy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U1t(e)}function U1t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function LR(e){return LR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LR(e)}var z1t=String.fromCharCode(13),G1t=String.fromCharCode(34),Y1t=String.fromCharCode(10),K1t=function(e){B1t(r,e);var t=W1t(r);function r(){return N1t(this,r),t.apply(this,arguments)}return L1t(r,[{key:"export",value:function(){var i=this,a=this.options,o=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=a.bom?String.fromCharCode(65279):"";return l&&(s=tr(s,function(h){return i._escapeCell(h,!0)}),f&&(c+=a.columnDelimiter),c+=s.join(a.columnDelimiter),c+=a.rowDelimiter),ve(o,function(h,d){d>0&&(c+=a.rowDelimiter),f&&(c+=i._escapeCell(u[d])+a.columnDelimiter),c+=h.map(function(v){return i._escapeCell(v)}).join(a.columnDelimiter)}),c}},{key:"_escapeCell",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=En(i);return o!==""&&(a||o.indexOf(z1t)>=0||o.indexOf(G1t)>=0||o.indexOf(Y1t)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o='"'.concat(o,'"')),o}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}($1t);const X1t=K1t;function gS(e){return gS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gS(e)}function q1t(e,t,r){return t=Z1t(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z1t(e){var t=J1t(e,"string");return gS(t)==="symbol"?t:String(t)}function J1t(e,t){if(gS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q1t="csv",_H=q1t({},Q1t,X1t);function eCt(e,t,r){return typeof _H[e]=="function"?new _H[e](t,r):null}function $y(e){return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(e)}function tCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nCt(n.key),n)}}function rCt(e,t,r){return t&&LQ(e.prototype,t),r&&LQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nCt(e){var t=iCt(e,"string");return $y(t)==="symbol"?t:String(t)}function iCt(e,t){if($y(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SH(e,t)}function SH(e,t){return SH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SH(e,t)}function oCt(e){var t=uCt();return function(){var n=FR(e),i;if(t){var a=FR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return sCt(this,i)}}function sCt(e,t){if(t&&($y(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lCt(e)}function lCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function FR(e){return FR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FR(e)}var fCt="exportFile",cCt=240,hCt=function(e){aCt(r,e);var t=oCt(r);function r(){return tCt(this,r),t.apply(this,arguments)}return rCt(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,a).export()}},{key:"exportAsBlob",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,a))}},{key:"downloadFile",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.hot,s=o.rootDocument,l=o.rootWindow,u=this._createTypeFormatter(i,a),f=this._createBlob(u),c=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!_H[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return eCt(i,new k1t(this.hot),a)}},{key:"_createBlob",value:function(i){var a=null;return typeof Blob<"u"&&(a=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),a}}],[{key:"PLUGIN_KEY",get:function(){return fCt}},{key:"PLUGIN_PRIORITY",get:function(){return cCt}}]),r}(Ar);function yS(e){return yS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yS(e)}function dCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pCt(n.key),n)}}function vCt(e,t,r){return t&&FQ(e.prototype,t),r&&FQ(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pCt(e){var t=gCt(e,"string");return yS(t)==="symbol"?t:String(t)}function gCt(e,t){if(yS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jve=function(){function e(t,r){var n=r.id,i=r.stateless,a=i===void 0?!0:i;dCt(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=a?null:this.hot.columnIndexMapper.registerMap(this.stateId,new kA)}return vCt(e,[{key:"reset",value:function(){ve(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),ve(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();qr(jve,Va);const YA=jve;var mS={};function kc(e,t){if(!mS[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=mS[e],n=r.condition,i=r.descriptor,a=t;return i.inputValuesDecorator&&(a=i.inputValuesDecorator(a)),function(o){return n.apply(o.meta.instance,[].concat([o],[a]))}}function td(e){if(!mS[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return mS[e].descriptor}function Xn(e,t,r){r.key=e,mS[e]={condition:t,descriptor:r}}var gi="none";function yCt(){return!0}Xn(gi,yCt,{name:AA,inputsCount:0,showOperators:!1});var sw="empty";function mCt(e){return ei(e.value)}Xn(sw,mCt,{name:KV,inputsCount:0,showOperators:!0});var FO="not_empty";function bCt(e,t){return!kc(sw,t)(e)}Xn(FO,bCt,{name:XV,inputsCount:0,showOperators:!0});function wCt(e,t){return xCt(e)||CCt(e,t)||SCt(e,t)||_Ct()}function _Ct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SCt(e,t){if(e){if(typeof e=="string")return HQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HQ(e,t)}}function HQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function xCt(e){if(Array.isArray(e))return e}var lw="eq";function TCt(e,t){var r=wCt(t,1),n=r[0];return En(e.value).toLocaleLowerCase(e.meta.locale)===En(n)}Xn(lw,TCt,{name:qV,inputsCount:1,showOperators:!0});var HO="neq";function OCt(e,t){return!kc(lw,t)(e)}Xn(HO,OCt,{name:ZV,inputsCount:1,showOperators:!0});function ECt(e,t){return PCt(e)||ACt(e,t)||kCt(e,t)||RCt()}function RCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kCt(e,t){if(e){if(typeof e=="string")return BQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BQ(e,t)}}function BQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ACt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function PCt(e){if(Array.isArray(e))return e}var zve="gt";function ICt(e,t){var r=ECt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>i}Xn(zve,ICt,{name:rU,inputsCount:1,showOperators:!0});function MCt(e,t){return LCt(e)||NCt(e,t)||$Ct(e,t)||DCt()}function DCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Ct(e,t){if(e){if(typeof e=="string")return WQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WQ(e,t)}}function WQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function LCt(e){if(Array.isArray(e))return e}var Gve="gte";function FCt(e,t){var r=MCt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>=i}Xn(Gve,FCt,{name:nU,inputsCount:1,showOperators:!0});function HCt(e,t){return UCt(e)||VCt(e,t)||WCt(e,t)||BCt()}function BCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WCt(e,t){if(e){if(typeof e=="string")return VQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VQ(e,t)}}function VQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function UCt(e){if(Array.isArray(e))return e}var Yve="lt";function jCt(e,t){var r=HCt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<i}Xn(Yve,jCt,{name:iU,inputsCount:1,showOperators:!0});function zCt(e,t){return XCt(e)||KCt(e,t)||YCt(e,t)||GCt()}function GCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YCt(e,t){if(e){if(typeof e=="string")return UQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UQ(e,t)}}function UQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KCt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function XCt(e){if(Array.isArray(e))return e}var Kve="lte";function qCt(e,t){var r=zCt(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<=i}Xn(Kve,qCt,{name:aU,inputsCount:1,showOperators:!0});function ZCt(e,t){return txt(e)||ext(e,t)||QCt(e,t)||JCt()}function JCt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QCt(e,t){if(e){if(typeof e=="string")return jQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jQ(e,t)}}function jQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ext(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function txt(e){if(Array.isArray(e))return e}var YU="date_after";function rxt(e,t){var r=ZCt(t,1),n=r[0],i=Ye(e.value,e.meta.dateFormat),a=Ye(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)>=0}Xn(YU,rxt,{name:lU,inputsCount:1,showOperators:!0});function nxt(e,t){return sxt(e)||oxt(e,t)||axt(e,t)||ixt()}function ixt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function axt(e,t){if(e){if(typeof e=="string")return zQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zQ(e,t)}}function zQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sxt(e){if(Array.isArray(e))return e}var KU="date_before";function lxt(e,t){var r=nxt(t,1),n=r[0],i=Ye(e.value,e.meta.dateFormat),a=Ye(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)<=0}Xn(KU,lxt,{name:uU,inputsCount:1,showOperators:!0});function uxt(e,t){return dxt(e)||hxt(e,t)||cxt(e,t)||fxt()}function fxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cxt(e,t){if(e){if(typeof e=="string")return GQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GQ(e,t)}}function GQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function dxt(e){if(Array.isArray(e))return e}var HR="between";function vxt(e,t){var r=uxt(t,2),n=r[0],i=r[1],a=n,o=i;if(e.meta.type==="numeric"){var s=parseFloat(a,10),l=parseFloat(o,10);a=Math.min(s,l),o=Math.max(s,l)}else if(e.meta.type==="date"){var u=kc(KU,[o]),f=kc(YU,[a]);return u(e)&&f(e)}return e.value>=a&&e.value<=o}Xn(HR,vxt,{name:oU,inputsCount:2,showOperators:!0});var Xve="not_between";function pxt(e,t){return!kc(HR,t)(e)}Xn(Xve,pxt,{name:sU,inputsCount:2,showOperators:!0});function gxt(e,t){return wxt(e)||bxt(e,t)||mxt(e,t)||yxt()}function yxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mxt(e,t){if(e){if(typeof e=="string")return YQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YQ(e,t)}}function YQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function wxt(e){if(Array.isArray(e))return e}var qve="begins_with";function _xt(e,t){var r=gxt(t,1),n=r[0];return En(e.value).toLocaleLowerCase(e.meta.locale).startsWith(En(n))}Xn(qve,_xt,{name:JV,inputsCount:1,showOperators:!0});var Sxt=Nt,Zve=m1,Cxt=Tl.f,xxt=nv,KQ=Kn,Txt=G4,Oxt=Ba,Ext=Y4,XQ=Zve("".endsWith),Rxt=Zve("".slice),kxt=Math.min,Jve=Ext("endsWith"),Axt=!Jve&&!!function(){var e=Cxt(String.prototype,"endsWith");return e&&!e.writable}();Sxt({target:"String",proto:!0,forced:!Axt&&!Jve},{endsWith:function(t){var r=KQ(Oxt(this));Txt(t);var n=arguments.length>1?arguments[1]:void 0,i=r.length,a=n===void 0?i:kxt(xxt(n),i),o=KQ(t);return XQ?XQ(r,o,a):Rxt(r,a-o.length,a)===o}});function Pxt(e,t){return $xt(e)||Dxt(e,t)||Mxt(e,t)||Ixt()}function Ixt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mxt(e,t){if(e){if(typeof e=="string")return qQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qQ(e,t)}}function qQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function $xt(e){if(Array.isArray(e))return e}var Qve="ends_with";function Nxt(e,t){var r=Pxt(t,1),n=r[0];return En(e.value).toLocaleLowerCase(e.meta.locale).endsWith(En(n))}Xn(Qve,Nxt,{name:QV,inputsCount:1,showOperators:!0});function Lxt(e,t){return Wxt(e)||Bxt(e,t)||Hxt(e,t)||Fxt()}function Fxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hxt(e,t){if(e){if(typeof e=="string")return ZQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZQ(e,t)}}function ZQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Wxt(e){if(Array.isArray(e))return e}var XU="contains";function Vxt(e,t){var r=Lxt(t,1),n=r[0];return En(e.value).toLocaleLowerCase(e.meta.locale).indexOf(En(n))>=0}Xn(XU,Vxt,{name:eU,inputsCount:1,showOperators:!0});var epe="not_contains";function Uxt(e,t){return!kc(XU,t)(e)}Xn(epe,Uxt,{name:tU,inputsCount:1,showOperators:!0});var tpe="date_tomorrow";function jxt(e){var t=Ye(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ye().subtract(-1,"days").startOf("day"),"d"):!1}Xn(tpe,jxt,{name:cU,inputsCount:0});var rpe="date_today";function zxt(e){var t=Ye(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ye().startOf("day"),"d"):!1}Xn(rpe,zxt,{name:fU,inputsCount:0});var npe="date_yesterday";function Gxt(e){var t=Ye(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ye().subtract(1,"days").startOf("day"),"d"):!1}Xn(npe,Gxt,{name:hU,inputsCount:0});ofe();function Yxt(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var CH=new Set([1]).has(1),Kxt=CH&&typeof Array.from=="function";function X1(e){var t=e;return CH&&(t=new Set(t)),function(r){var n;return CH?n=t.has(r):n=!!~t.indexOf(r),n}}function ipe(e){return e??""}function xH(e){var t=e;return Kxt?t=Array.from(new Set(t)):t=Q4(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function JQ(e,t,r,n){var i=[],a=e===t,o;return a||(o=X1(t)),ve(e,function(s){var l=!1;(a||o(s))&&(l=!0);var u={checked:l,value:s,visualValue:Yxt(s,r)};n&&n(u),i.push(u)}),i}function ape(e,t){return Jxt(e)||Zxt(e,t)||qxt(e,t)||Xxt()}function Xxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qxt(e,t){if(e){if(typeof e=="string")return QQ(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QQ(e,t)}}function QQ(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Jxt(e){if(Array.isArray(e))return e}var rd="by_value";function Qxt(e,t){var r=ape(t,1),n=r[0];return n(e.value)}Xn(rd,Qxt,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=ape(t,1),n=r[0];return[X1(n)]},showOperators:!1});var bS={};function eTt(e){if(!bS[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=bS[e].func;return function(r,n){return t(r,n)}}function tTt(e){return bS[e].name}function qU(e,t,r){bS[e]={name:t,func:r}}var uc="conjunction",rTt=pU;function nTt(e,t){return e.every(function(r){return r.func(t)})}qU(uc,rTt,nTt);var BR="disjunction",iTt=PA;function aTt(e,t){return e.some(function(r){return r.func(t)})}qU(BR,iTt,aTt);var ZU="disjunctionWithExtraCondition",oTt=PA;function sTt(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}qU(ZU,oTt,sTt);function wS(e){return wS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wS(e)}var ab;function AD(e,t,r){return t=lTt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lTt(e){var t=uTt(e,"string");return wS(t)==="symbol"?t:String(t)}function uTt(e,t){if(wS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fTt="numeric",ope="text",cTt="date",eee=(ab={},AD(ab,fTt,[gi,sr,sw,FO,sr,lw,HO,sr,zve,Gve,Yve,Kve,HR,Xve]),AD(ab,ope,[gi,sr,sw,FO,sr,lw,HO,sr,qve,Qve,sr,XU,epe]),AD(ab,cTt,[gi,sr,sw,FO,sr,lw,HO,sr,KU,YU,HR,sr,tpe,rpe,npe]),ab);function hTt(e){var t=[],r=e;return eee[r]||(r=ope),ve(eee[r],function(n){var i;n===sr?i={name:sr}:i=ca(td(n)),t.push(i)}),t}function _S(e){return _S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_S(e)}function dTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pTt(n.key),n)}}function vTt(e,t,r){return t&&tee(e.prototype,t),r&&tee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pTt(e){var t=gTt(e,"string");return _S(t)==="symbol"?t:String(t)}function gTt(e,t){if(_S(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_S(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PD="built",ID="building",ree=["click","input","keydown","keypress","keyup","focus","blur","change"],spe=function(){function e(t,r){dTt(this,e),this.hot=t,this.eventManager=new bn(this),this.options=zn(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return vTt(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===ID?this._element:this.buildState===PD?(this.update(),this._element):(this.buildState=ID,this.build(),this.buildState=PD,this._element)}},{key:"isBuilt",value:function(){return this.buildState===PD}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(_a)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(o,s){r.eventManager.addEventListener(o,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=ID),this.options.className&&Ge(this._element,this.options.className),this.options.children.length)ve(this.options.children,function(a){return r._element.appendChild(a.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);nr(this.options,function(a,o){i[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(i[o]=r.translateIfPossible(a))}),this._element.appendChild(i),ve(ree,function(a){return n(i,a)})}else ve(ree,function(a){return n(r._element,a)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return ca({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();qr(spe,Va);const fc=spe;function Ny(e){return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ny(e)}function yTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bTt(n.key),n)}}function mTt(e,t,r){return t&&nee(e.prototype,t),r&&nee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bTt(e){var t=wTt(e,"string");return Ny(t)==="symbol"?t:String(t)}function wTt(e,t){if(Ny(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ny(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BO(){return typeof Reflect<"u"&&Reflect.get?BO=Reflect.get.bind():BO=function(t,r,n){var i=_Tt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},BO.apply(this,arguments)}function _Tt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ly(e),e!==null););return e}function STt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TH(e,t)}function TH(e,t){return TH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TH(e,t)}function CTt(e){var t=TTt();return function(){var n=Ly(e),i;if(t){var a=Ly(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return xTt(this,i)}}function xTt(e,t){if(t&&(Ny(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lpe(e)}function lpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ly(e){return Ly=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ly(e)}var OT=new WeakMap,OTt=function(e){STt(r,e);var t=CTt(r);function r(n,i){var a;return yTt(this,r),a=t.call(this,n,zn(r.DEFAULTS,i)),OT.set(lpe(a),{}),a.registerHooks(),a}return mTt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(a){return i.onKeyup(a)})}},{key:"build",value:function(){BO(Ly(r.prototype),"build",this).call(this);var i=OT.get(this),a=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,Ge(this._element,"htUIInput"),Ge(a,"htUIInputIcon"),this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=OT.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&OT.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return ca({placeholder:"",type:"text",tagName:"input"})}}]),r}(fc);const rg=OTt;function Fy(e){return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fy(e)}function ETt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kTt(n.key),n)}}function RTt(e,t,r){return t&&iee(e.prototype,t),r&&iee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kTt(e){var t=ATt(e,"string");return Fy(t)==="symbol"?t:String(t)}function ATt(e,t){if(Fy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ng(){return typeof Reflect<"u"&&Reflect.get?ng=Reflect.get.bind():ng=function(t,r,n){var i=PTt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ng.apply(this,arguments)}function PTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=cc(e),e!==null););return e}function ITt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OH(e,t)}function OH(e,t){return OH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OH(e,t)}function MTt(e){var t=$Tt();return function(){var n=cc(e),i;if(t){var a=cc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return DTt(this,i)}}function DTt(e,t){if(t&&(Fy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return upe(e)}function upe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Tt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cc(e){return cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cc(e)}var ET=new WeakMap,NTt=function(e){ITt(r,e);var t=MTt(r);function r(n,i){var a;return ETt(this,r),a=t.call(this,n,zn(r.DEFAULTS,i)),ET.set(upe(a),{}),a.menu=null,a.items=[],a.registerHooks(),a}return RTt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var a=this;return ve(i,function(o){o.name=a.translateIfPossible(o.name)}),i}},{key:"build",value:function(){var i=this;ng(cc(r.prototype),"build",this).call(this),this.menu=new zU(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var a=new fc(this.hot,{className:"htUISelectCaption"}),o=new fc(this.hot,{className:"htUISelectDropdown"}),s=ET.get(this);s.caption=a,s.captionElement=a.element,s.dropdown=o,ve([a,o],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(AA),ET.get(this).captionElement.textContent=i,ng(cc(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==sr&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=ET.get(this),a=i.caption,o=i.dropdown;a&&a.destroy(),o&&o.destroy(),ng(cc(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return ca({className:"htUISelect",wrapIt:!1})}}]),r}(fc);const aee=NTt;function Hy(e){return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hy(e)}function LTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HTt(n.key),n)}}function FTt(e,t,r){return t&&oee(e.prototype,t),r&&oee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HTt(e){var t=BTt(e,"string");return Hy(t)==="symbol"?t:String(t)}function BTt(e,t){if(Hy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WO(){return typeof Reflect<"u"&&Reflect.get?WO=Reflect.get.bind():WO=function(t,r,n){var i=WTt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},WO.apply(this,arguments)}function WTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=By(e),e!==null););return e}function VTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EH(e,t)}function EH(e,t){return EH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EH(e,t)}function UTt(e){var t=GTt();return function(){var n=By(e),i;if(t){var a=By(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return jTt(this,i)}}function jTt(e,t){if(t&&(Hy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zTt(e)}function zTt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GTt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function By(e){return By=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},By(e)}var YTt=function(e){VTt(r,e);var t=UTt(r);function r(n,i){var a;return LTt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.addSeparator=i.addSeparator,a.elements.push(new aee(a.hot,{menuContainer:i.menuContainer})),a.elements.push(new rg(a.hot,{placeholder:_U})),a.elements.push(new rg(a.hot,{placeholder:SU})),a.registerHooks(),a}return FTt(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(a){return i.onConditionSelect(a)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),ve(this.getInputElements(),function(a){a.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})})}},{key:"setState",value:function(i){var a=this;if(this.reset(),!!i){var o=ca(i.command);o.name.startsWith(kn)&&(o.name=this.hot.getTranslatedPhrase(o.name)),this.getSelectElement().setValue(o),ve(i.args,function(s,l){if(l>o.inputsCount-1)return!1;var u=a.getInputElement(l);u.setValue(s),u[o.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||td(gi),a=[];return ve(this.getInputElements(),function(o,s){i.inputsCount>s&&a.push(o.getValue())}),{command:i,args:a}}},{key:"updateState",value:function(i,a){var o=td(i?i.name:gi);this.state.setValueAtIndex(a,{command:o,args:i?i.args:[]}),i||ve(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof aee})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof rg})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){Ge(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&Ge(s.parentNode,"border");var h=i.hot.rootDocument.createElement("div");return Ge(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ve(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),a=[td(gi)];if(i!==null){var o=i.visualIndex;a=hTt(this.hot.getDataType(0,o,this.hot.countRows(),o))}ve(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(a),WO(By(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(a[0])}},{key:"onConditionSelect",value:function(i){ve(this.getInputElements(),function(a,o){a[i.inputsCount>o?"show":"hide"](),o===0&&setTimeout(function(){return a.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){Og(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),Ns(i)):Og(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ns(i))}}]),r}(YA);const MD=YTt;function Wy(e){return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wy(e)}function KTt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function see(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qTt(n.key),n)}}function XTt(e,t,r){return t&&see(e.prototype,t),r&&see(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qTt(e){var t=ZTt(e,"string");return Wy(t)==="symbol"?t:String(t)}function ZTt(e,t){if(Wy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VO(){return typeof Reflect<"u"&&Reflect.get?VO=Reflect.get.bind():VO=function(t,r,n){var i=JTt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},VO.apply(this,arguments)}function JTt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vy(e),e!==null););return e}function QTt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RH(e,t)}function RH(e,t){return RH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RH(e,t)}function eOt(e){var t=rOt();return function(){var n=Vy(e),i;if(t){var a=Vy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return tOt(this,i)}}function tOt(e,t){if(t&&(Wy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fpe(e)}function fpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vy(e){return Vy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vy(e)}var RT=new WeakMap,nOt=function(e){QTt(r,e);var t=eOt(r);function r(n,i){var a;return KTt(this,r),a=t.call(this,n,zn(r.DEFAULTS,i)),RT.set(fpe(a),{}),a}return XTt(r,[{key:"build",value:function(){VO(Vy(r.prototype),"build",this).call(this);var i=RT.get(this);i.input=this._element.firstChild;var a=this.hot.rootDocument.createElement("label");a.textContent=this.translateIfPossible(this.options.label.textContent),a.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=a,this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=RT.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&RT.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return ca({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(fc);const lee=nOt;function Uy(e){return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uy(e)}var uee;function iOt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sOt(n.key),n)}}function oOt(e,t,r){return t&&fee(e.prototype,t),r&&fee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sOt(e){var t=lOt(e,"string");return Uy(t)==="symbol"?t:String(t)}function lOt(e,t){if(Uy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uOt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kH(e,t)}function kH(e,t){return kH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kH(e,t)}function fOt(e){var t=dOt();return function(){var n=WR(e),i;if(t){var a=WR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return cOt(this,i)}}function cOt(e,t){if(t&&(Uy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hOt(e)}function hOt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function WR(e){return WR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WR(e)}var cee=0,vOt=function(e){uOt(r,e);var t=fOt(r);function r(n,i){var a;return aOt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.buildOperatorsElement(),a}return oOt(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return Ge(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||ve(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,a=[uc,BR];ve(a,function(o){var s=new lee(i.hot,{name:"operator",label:{htmlFor:o,textContent:tTt(o)},value:o,checked:o===a[cee],id:o});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(Wr(uee||(uee=iOt(["Radio button with index "," doesn't exist."])),i));ve(this.elements,function(a,o){a.setChecked(o===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(a){return a instanceof lee&&a.isChecked()});return i?i.getValue():uc}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&ve(this.elements,function(a){a.setChecked(a.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:uc,a=arguments.length>1?arguments[1]:void 0,o=i;o===ZU&&(o=BR),this.state.setValueAtIndex(a,o)}},{key:"reset",value:function(){this.setChecked(cee)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(YA);const pOt=vOt;var gOt=ir,yOt=Ba,hee=Kn,mOt=/"/g,bOt=gOt("".replace),wOt=function(e,t,r,n){var i=hee(yOt(e)),a="<"+t;return r!==""&&(a+=" "+r+'="'+bOt(hee(n),mOt,"&quot;")+'"'),a+">"+i+"</"+t+">"},_Ot=Kt,SOt=function(e){return _Ot(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},COt=Nt,xOt=wOt,TOt=SOt;COt({target:"String",proto:!0,forced:TOt("link")},{link:function(t){return xOt(this,"a","href",t)}});function jy(e){return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}function OOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ROt(n.key),n)}}function EOt(e,t,r){return t&&dee(e.prototype,t),r&&dee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ROt(e){var t=kOt(e,"string");return jy(t)==="symbol"?t:String(t)}function kOt(e,t){if(jy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UO(){return typeof Reflect<"u"&&Reflect.get?UO=Reflect.get.bind():UO=function(t,r,n){var i=AOt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},UO.apply(this,arguments)}function AOt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zy(e),e!==null););return e}function POt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AH(e,t)}function AH(e,t){return AH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AH(e,t)}function IOt(e){var t=DOt();return function(){var n=zy(e),i;if(t){var a=zy(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return MOt(this,i)}}function MOt(e,t){if(t&&(jy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cpe(e)}function cpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zy(e){return zy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zy(e)}var DD=new WeakMap,$Ot=function(e){POt(r,e);var t=IOt(r);function r(n,i){var a;return OOt(this,r),a=t.call(this,n,zn(r.DEFAULTS,i)),DD.set(cpe(a),{}),a}return EOt(r,[{key:"build",value:function(){UO(zy(r.prototype),"build",this).call(this);var i=DD.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(DD.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return ca({href:"#",tagName:"a"})}}]),r}(fc);const vee=$Ot;function Gy(e){return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gy(e)}function pee(e){return HOt(e)||FOt(e)||LOt(e)||NOt()}function NOt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LOt(e,t){if(e){if(typeof e=="string")return PH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PH(e,t)}}function FOt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HOt(e){if(Array.isArray(e))return PH(e)}function PH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BOt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VOt(n.key),n)}}function WOt(e,t,r){return t&&gee(e.prototype,t),r&&gee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VOt(e){var t=UOt(e,"string");return Gy(t)==="symbol"?t:String(t)}function UOt(e,t){if(Gy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ig(){return typeof Reflect<"u"&&Reflect.get?ig=Reflect.get.bind():ig=function(t,r,n){var i=jOt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ig.apply(this,arguments)}function jOt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hc(e),e!==null););return e}function zOt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IH(e,t)}function IH(e,t){return IH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IH(e,t)}function GOt(e){var t=KOt();return function(){var n=hc(e),i;if(t){var a=hc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return YOt(this,i)}}function YOt(e,t){if(t&&(Gy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hpe(e)}function hpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KOt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hc(e){return hc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hc(e)}var XOt=new WeakMap,qOt="multipleSelect.itemBox",ZOt=function(e){zOt(r,e);var t=GOt(r);function r(n,i){var a;return BOt(this,r),a=t.call(this,n,zn(r.DEFAULTS,i)),XOt.set(hpe(a),{}),a.searchInput=new rg(a.hot,{placeholder:wU,className:"htUIMultipleSelectSearch"}),a.selectAllUI=new vee(a.hot,{textContent:gU,className:"htUISelectAll"}),a.clearAllUI=new vee(a.hot,{textContent:yU,className:"htUIClearAll"}),a.items=[],a.itemsBox=null,a.registerHooks(),a}return WOt(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)}),this.searchInput.addLocalHook("input",function(a){return i.onInput(a)}),this.selectAllUI.addLocalHook("click",function(a){return i.onSelectAllClick(a)}),this.clearAllUI.addLocalHook("click",function(a){return i.onClearAllClick(a)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return pee(this.items)}},{key:"getValue",value:function(){return QOt(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;ig(hc(r.prototype),"build",this).call(this);var a=this.hot.rootDocument,o=a.createElement("div"),s=new fc(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(o);var l=function(f){if(i._element){i.itemsBox&&i.itemsBox.destroy(),Ge(f,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(f,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,g,y,b,w,_){v.title=_.instance.getDataAtRowProp(g,_.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-hi(a)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var c=i.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){i.runLocalHooks("keydown",v,i)},group:qOt})}};l(o),setTimeout(function(){return l(o)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(JOt(this.items,this.options.value)),ig(hc(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,ig(hc(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var a=this,o=i.target.value.toLocaleLowerCase(this.getLocale()),s;o===""?s=pee(this.items):s=lo(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(a.getLocale()).indexOf(o)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var a=PW(Og,i.keyCode);a("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Ns(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var a=[];i.preventDefault(),ve(this.itemsBox.getSourceData(),function(o,s){o.checked=!0,a.push(cF(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}},{key:"onClearAllClick",value:function(i){var a=[];i.preventDefault(),ve(this.itemsBox.getSourceData(),function(o,s){o.checked=!1,a.push(cF(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}}],[{key:"DEFAULTS",get:function(){return ca({className:"htUIMultipleSelect",value:[]})}}]),r}(fc);const yee=ZOt;function JOt(e,t){var r=X1(t);return tr(e,function(n){return n.checked=r(n.value),n})}function QOt(e){var t=[];return ve(e,function(r){r.checked&&t.push(r.value)}),t}function Yy(e){return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yy(e)}function eEt(e,t){return iEt(e)||nEt(e,t)||rEt(e,t)||tEt()}function tEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rEt(e,t){if(e){if(typeof e=="string")return mee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mee(e,t)}}function mee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nEt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function iEt(e){if(Array.isArray(e))return e}function aEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sEt(n.key),n)}}function oEt(e,t,r){return t&&bee(e.prototype,t),r&&bee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sEt(e){var t=lEt(e,"string");return Yy(t)==="symbol"?t:String(t)}function lEt(e,t){if(Yy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jO(){return typeof Reflect<"u"&&Reflect.get?jO=Reflect.get.bind():jO=function(t,r,n){var i=uEt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},jO.apply(this,arguments)}function uEt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ky(e),e!==null););return e}function fEt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MH(e,t)}function MH(e,t){return MH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MH(e,t)}function cEt(e){var t=vEt();return function(){var n=Ky(e),i;if(t){var a=Ky(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return hEt(this,i)}}function hEt(e,t){if(t&&(Yy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dEt(e)}function dEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ky(e){return Ky=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ky(e)}var pEt=function(e){fEt(r,e);var t=cEt(r);function r(n,i){var a;return aEt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.elements.push(new yee(a.hot)),a.registerHooks(),a}return oEt(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===rd){var a=this.getMultipleSelectElement();a.setItems(i.itemsSnapshot),a.setValue(i.args[0]),a.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),a=i.getItems();return{command:{key:i.isSelectedAllValues()||!a.length?gi:rd},args:[i.getValue()],itemsSnapshot:a}}},{key:"updateState",value:function(i){var a=this,o=function(l,u,f,c,h){var d=lo(u,function(R){return R.name===rd}),v=eEt(d,1),g=v[0],y={},b=a.hot.getTranslatedPhrase(ER);if(g){var w=xH(tr(c(l,h),function(R){return R.value}));f&&(g.args[0]=f);var _=[],x=JQ(w,g.args[0],b,function(R){R.checked&&_.push(R.value)}),E=i.editedConditionStack.column;y.locale=a.hot.getCellMeta(0,E).locale,y.args=[_],y.command=td(rd),y.itemsSnapshot=x}else y.args=[],y.command=td(gi);a.state.setValueAtIndex(l,y)};o(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&o(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof yee})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){Ge(s.parentNode,"htFiltersMenuValue");var h=i.hot.rootDocument.createElement("div");return Ge(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ve(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(ER),a=xH(this._getColumnVisibleValues()),o=JQ(a,a,i);this.getMultipleSelectElement().setItems(o),jO(Ky(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(a);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){Og(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ns(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:tr(this.hot.getDataAtCol(i.visualIndex),function(a){return ipe(a)})}}]),r}(YA);const gEt=pEt;function Xy(e){return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xy(e)}function yEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bEt(n.key),n)}}function mEt(e,t,r){return t&&wee(e.prototype,t),r&&wee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bEt(e){var t=wEt(e,"string");return Xy(t)==="symbol"?t:String(t)}function wEt(e,t){if(Xy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Et(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DH(e,t)}function DH(e,t){return DH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DH(e,t)}function SEt(e){var t=TEt();return function(){var n=VR(e),i;if(t){var a=VR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return CEt(this,i)}}function CEt(e,t){if(t&&(Xy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xEt(e)}function xEt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TEt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function VR(e){return VR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},VR(e)}var OEt=function(e){_Et(r,e);var t=SEt(r);function r(n,i){var a;return yEt(this,r),a=t.call(this,n,{id:i.id,stateless:!0}),a.name=i.name,a.elements.push(new rg(a.hot,{type:"button",value:mU,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),a.elements.push(new rg(a.hot,{type:"button",value:bU,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),a.registerHooks(),a}return mEt(r,[{key:"registerHooks",value:function(){var i=this;ve(this.elements,function(a){a.addLocalHook("click",function(o,s){return i.onButtonClick(o,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return Ge(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||ve(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,a){a.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(YA);const EEt=OEt;function SS(e){return SS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SS(e)}var _ee,See;function Cee(e,t){return PEt(e)||AEt(e,t)||kEt(e,t)||REt()}function REt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kEt(e,t){if(e){if(typeof e=="string")return xee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xee(e,t)}}function xee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AEt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function PEt(e){if(Array.isArray(e))return e}function Tee(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function IEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DEt(n.key),n)}}function MEt(e,t,r){return t&&Oee(e.prototype,t),r&&Oee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DEt(e){var t=$Et(e,"string");return SS(t)==="symbol"?t:String(t)}function $Et(e,t){if(SS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(SS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eee="ConditionCollection.filteringStates",dpe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;IEt(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new kA,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(Eee,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return MEt(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,a=this.filteringStates.getValueAtIndex(n),o=(i=a==null?void 0:a.conditions)!==null&&i!==void 0?i:[],s=a==null?void 0:a.operation;return this.isMatchInConditions(o,r,s)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uc;return r.length?eTt(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uc,a=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,r).locale,s=tr(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(o):c}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==i)throw Error(Wr(_ee||(_ee=Tee(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(Yr(bS[i]))throw new Error(Wr(See||(See=Tee(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:l,args:s,func:kc(l,s)}]},a):f.push({name:l,args:s,func:kc(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=Cee(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Nn(this.filteringStates.getEntries(),function(r,n){var i=Cee(n,2),a=i[0],o=i[1],s=o.operation,l=o.conditions;return r.push({column:a,operation:s,conditions:tr(l,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),ve(r,function(i){ve(i.conditions,function(a){return n.addCondition(i.column,a)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(a){return a.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Eee),this.filteringStates=null,this.clearLocalHooks()}}]),e}();qr(dpe,Va);const vpe=dpe;function CS(e){return CS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CS(e)}function NEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ree(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FEt(n.key),n)}}function LEt(e,t,r){return t&&Ree(e.prototype,t),r&&Ree(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FEt(e){var t=HEt(e,"string");return CS(t)==="symbol"?t:String(t)}function HEt(e,t){if(CS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(CS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BEt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};NEt(this,e),this.conditionCollection=t,this.columnDataFactory=r}return LEt(e,[{key:"filter",value:function(){var r=this,n=[];return ve(this.conditionCollection.getFilteredColumns(),function(i,a){var o=r.columnDataFactory(i);a&&(o=r._getIntersectData(o,n)),n=r.filterByColumn(i,o)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[];return ve(i,function(o){o!==void 0&&n.conditionCollection.isMatch(o,r)&&a.push(o)}),a}},{key:"_getIntersectData",value:function(r,n){var i=[];return ve(n,function(a){var o=a.meta.visualRow;r[o]!==void 0&&(i[o]=r[o])}),i}}]),e}();const ppe=BEt;function xS(e){return xS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xS(e)}function WEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UEt(n.key),n)}}function VEt(e,t,r){return t&&kee(e.prototype,t),r&&kee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UEt(e){var t=jEt(e,"string");return xS(t)==="symbol"?t:String(t)}function jEt(e,t){if(xS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gpe=function(){function e(t,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};WEt(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(a){return n._onConditionBeforeModify(a)}),this.conditionCollection.addLocalHook("afterRemove",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("afterAdd",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return VEt(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,ve(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var a=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(r);o===-1&&(o=this.latestEditedColumnPosition);var s=a.slice(0,o),l=a.slice(o);l.length&&l[0].column===r&&l.shift();var u=Ace(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new vpe(i.hot,!1),g=[].concat(c,d);v.importAllConditions(g);var y=i.columnDataFactory(h),b;v.isEmpty()?b=y:b=new ppe(v,function(_){return i.columnDataFactory(_)}).filter(),b=tr(b,function(_){return _.meta.visualRow});var w=X1(b);return v.destroy(),lo(y,function(_){return w(_.meta.visualRow)})})(s),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;ve(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),nr(this,function(n,i){r[i]=null})}}]),e}();qr(gpe,Va);const zEt=gpe;function qy(e){return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qy(e)}var Aee;function GEt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YEt(e,t){return ZEt(e)||qEt(e,t)||XEt(e,t)||KEt()}function KEt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XEt(e,t){if(e){if(typeof e=="string")return Pee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pee(e,t)}}function Pee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qEt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ZEt(e){if(Array.isArray(e))return e}function JEt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Iee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eRt(n.key),n)}}function QEt(e,t,r){return t&&Iee(e.prototype,t),r&&Iee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eRt(e){var t=tRt(e,"string");return qy(t)==="symbol"?t:String(t)}function tRt(e,t){if(qy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ag(){return typeof Reflect<"u"&&Reflect.get?ag=Reflect.get.bind():ag=function(t,r,n){var i=rRt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ag.apply(this,arguments)}function rRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=dc(e),e!==null););return e}function nRt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$H(e,t)}function $H(e,t){return $H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$H(e,t)}function iRt(e){var t=oRt();return function(){var n=dc(e),i;if(t){var a=dc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return aRt(this,i)}}function aRt(e,t){if(t&&(qy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ype(e)}function ype(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oRt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dc(e){return dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dc(e)}var Mee="filters",sRt=250,lRt=function(e){nRt(r,e);var t=iRt(r);function r(n){var i;return JEt(this,r),i=t.call(this,n),i.eventManager=new bn(ype(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return QEt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Mee]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new W1),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var a=this.hot.getSettings().dropdownMenu,o=a&&a.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return i.onComponentChange(d,v)}),d},l=function(){return"".concat(i.hot.getTranslatedPhrase(dU),":")},u=function(){return"".concat(i.hot.getTranslatedPhrase(vU),":")};if(!this.components.get("filter_by_condition")){var f=new MD(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:o});f.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new pOt(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new MD(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:o});c.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new gEt(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new EEt(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new vpe(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new zEt(this.hot,this.conditionCollection,function(h){return i.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return i.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return i.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return i.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return i.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),ag(dc(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var a;(a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(o,s){o.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}ag(dc(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:uc,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:a},args:o},s)}},{key:"removeConditions",value:function(i){var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}}},{key:"filter",value:function(){var i=this,a=this._createDataFilter(),o=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(o){var f=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=tr(a.filter(),function(h){return h.meta.visualRow});var c=X1(s);xt(i.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),ve(f,function(h){i.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return a?{visualIndex:a.col,physicalIndex:this.hot.toPhysicalColumn(a.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var a=this,o=this.hot.toVisualColumn(i),s=[];return ve(this.hot.getSourceDataAtCol(o),function(l,u){var f,c=a.hot.getCellMeta(u,o),h=c.row,d=c.col,v=c.visualCol,g=c.visualRow,y=c.type,b=c.instance,w=c.dateFormat,_=c.locale,x=(f=a.hot.getDataAtCell(a.hot.toVisualRow(u),o))!==null&&f!==void 0?f:l;s.push({meta:{row:h,col:d,visualCol:v,visualRow:g,type:y,instance:b,dateFormat:w,locale:_},value:ipe(x)})}),s}},{key:"onAfterChange",value:function(i){var a=this;i&&ve(i,function(o){var s=YEt(o,2),l=s[1],u=a.hot.propToCol(l);a.conditionCollection.hasConditions(u)&&a.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(i){var a=this.hot.getDataAtCol(i),o=xH(a);this.conditionUpdateObserver.updateStatesAtColumn(i,o)}},{key:"restoreComponents",value:function(i){var a,o=(a=this.getSelectedColumn())===null||a===void 0?void 0:a.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(o)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:sr}),this.components.forEach(function(a){i.items.push(a.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,a,o,s){var l=i;return l===BR&&a.command.key!==gi&&o.command.key!==gi&&s.command.key!==gi?l=ZU:s.command.key!==gi&&(a.command.key===gi||o.command.key===gi)&&(l=uc),l}},{key:"onActionBarSubmit",value:function(i){var a;if(i==="accept"){var o=this.getSelectedColumn();if(o===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=o.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(l);d===-1&&(d=void 0),this.conditionCollection.removeConditions(l),u.command.key!==gi&&(this.conditionCollection.addCondition(l,u,h,d),f.command.key!==gi&&this.conditionCollection.addCondition(l,f,h,d)),c.command.key!==gi&&this.conditionCollection.addCondition(l,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(a=this.dropdownMenuPlugin)===null||a===void 0||a.close()}},{key:"onComponentChange",value:function(i,a){this.updateDependentComponentsVisibility(),i.constructor===MD&&!a.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),a=i.getState(),o=a.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];o.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,a){var o=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(o)?Ge(a,"htFiltersActive"):Vt(a,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new ppe(a,function(o){return i.getDataMapAtColumn(o)})}},{key:"updateComponents",value:function(i){var a;if((a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled){var o=i.editedConditionStack,s=o.conditions,l=o.column,u=s.filter(function(h){return h.name===rd}),f=s.filter(function(h){return h.name!==rd});if(u.length>=2||f.length>=3)Kr(Wr(Aee||(Aee=GEt([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(f[0],l),this.components.get("filter_by_condition2").updateState(f[1],l),this.components.get("filter_operators").updateState(c,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var a=this.dropdownMenuPlugin.menu,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return ve(s,function(u){ve(a.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&i.push(c)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var a=this.dropdownMenuPlugin.menu,o=a.hotMenu,s=o.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);i?s.showRows(c):s.hideRows(c),o.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!1].concat(a))}},{key:"showComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!0].concat(a))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(a,o){a!==null&&(a.destroy(),i.components.set(o,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),ag(dc(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Mee}},{key:"PLUGIN_PRIORITY",get:function(){return sRt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(Ar);function TS(e){return TS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TS(e)}function Dee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dee(Object(r),!0).forEach(function(n){uRt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dee(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uRt(e,t,r){return t=fRt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fRt(e){var t=cRt(e,"string");return TS(t)==="symbol"?t:String(t)}function cRt(e,t){if(TS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(TS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mpe="internal-use-in-handsontable",hRt={licenseKey:mpe,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function bpe(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[sa])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function wpe(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function dRt(e){var t,r=e[sa],n=wpe(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=bpe(e);return uw(uw(uw({},hRt),n),i)}function vRt(e){var t,r=e[sa],n=wpe(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=bpe(e);return uw(uw({},n),i)}function NH(e){return NH=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NH(e)}function KA(){var e="engine_relationship",t=ts(sa);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function JU(){var e="shared_engine_usage",t=ts(sa);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function pRt(e){var t=e.getSettings(),r=t[sa],n=r==null?void 0:r.engine;if(r===!0||Yr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return gRt((i=n.hyperformula)!==null&&i!==void 0?i:n,t,e)}else if(NH(n)==="object"&&Yr(n.hyperformula)){var a=KA(),o=JU().get(n);return a.has(n)||a.set(n,[]),a.get(n).push(e),o&&o.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:mpe}),n}return null}function gRt(e,t,r){var n=t[sa],i=dRt(t),a=KA(),o=JU();yRt(e,n.functions),mRt(e,n.language);var s=e.buildEmpty(i);return a.set(s,[r]),o.set(s,[r.guid]),bRt(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function $ee(e){var t,r=KA(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function Nee(e,t){if(e){var r=KA(),n=r.get(e),i=JU(),a=i.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),a&&a.includes(t.guid)&&(a.splice(a.indexOf(t.guid),1),a.length===0&&(i.delete(e),e.destroy()))}}function yRt(e,t){t&&t.forEach(function(r){var n=r.name,i=r.plugin,a=r.translations;try{e.registerFunction(n,i,a)}catch(o){Kr(o.message)}})}function mRt(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){Kr(n.message)}}}function bRt(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,i=r.expression,a=r.scope,o=r.options;try{e.addNamedExpression(n,i,a,o)}catch(s){Kr(s.message)}}),e.resumeEvaluation())}function wRt(e,t){return(Yr(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function _pe(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function _Rt(e){return _pe(e)?e.substr(1):e}function SRt(e){return TRt(e)||xRt(e)||Spe(e)||CRt()}function CRt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xRt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TRt(e){if(Array.isArray(e))return LH(e)}function Lee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lee(Object(r),!0).forEach(function(n){zO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lee(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ac(e){return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ac(e)}function dp(e,t){return RRt(e)||ERt(e,t)||Spe(e,t)||ORt()}function ORt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Spe(e,t){if(e){if(typeof e=="string")return LH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LH(e,t)}}function LH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ERt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function RRt(e){if(Array.isArray(e))return e}function kRt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cpe(n.key),n)}}function ARt(e,t,r){return t&&Hee(e.prototype,t),r&&Hee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nd(){return typeof Reflect<"u"&&Reflect.get?nd=Reflect.get.bind():nd=function(t,r,n){var i=PRt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},nd.apply(this,arguments)}function PRt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_u(e),e!==null););return e}function IRt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FH(e,t)}function FH(e,t){return FH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FH(e,t)}function MRt(e){var t=$Rt();return function(){var n=_u(e),i;if(t){var a=_u(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return DRt(this,i)}}function DRt(e,t){if(t&&(Ac(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mh(e)}function Mh(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Rt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _u(e){return _u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_u(e)}function zO(e,t,r){return t=Cpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cpe(e){var t=NRt(e,"string");return Ac(t)==="symbol"?t:String(t)}function NRt(e,t){if(Ac(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ac(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $D(e,t,r){LRt(e,t),t.set(e,r)}function LRt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vp(e,t,r){var n=xpe(e,t,"set");return FRt(e,n,r),r}function FRt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function pp(e,t){var r=xpe(e,t,"get");return HRt(e,r)}function xpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function HRt(e,t){return t.get?t.get.call(e):t.value}var sa="formulas",BRt=260,Bee="row_move";pt.getSingleton().register("afterNamedExpressionAdded");pt.getSingleton().register("afterNamedExpressionRemoved");pt.getSingleton().register("afterSheetAdded");pt.getSingleton().register("afterSheetRemoved");pt.getSingleton().register("afterSheetRenamed");pt.getSingleton().register("afterFormulasValuesUpdate");var gp=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Eh=new WeakMap,ND=new WeakMap,ob=new WeakMap,WRt=function(e){IRt(r,e);var t=MRt(r);function r(){var n;kRt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),$D(Mh(n),Eh,{writable:!0,value:!1}),$D(Mh(n),ND,{writable:!0,value:!1}),$D(Mh(n),ob,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),zO(Mh(n),"staticRegister",ts("formulas")),zO(Mh(n),"engine",null),zO(Mh(n),"sheetName",null),n}return ARt(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sa]}},{key:"enablePlugin",value:function(){var i,a=this;if(!this.enabled){if(this.engine=(i=pRt(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){Kr("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var o=this.addSheet(this.sheetName,this.hot.getSourceDataArray());o!==!1&&(this.sheetName=o)}this.addHook("beforeLoadData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterLoadData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("beforeUpdateData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterUpdateData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("modifyData",function(){return a.onModifyData.apply(a,arguments)}),this.addHook("modifySourceData",function(){return a.onModifySourceData.apply(a,arguments)}),this.addHook("beforeValidate",function(){return a.onBeforeValidate.apply(a,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return a.onAfterSetSourceDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtCell",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("beforeCreateRow",function(){return a.onBeforeCreateRow.apply(a,arguments)}),this.addHook("beforeCreateCol",function(){return a.onBeforeCreateCol.apply(a,arguments)}),this.addHook("afterCreateRow",function(){return a.onAfterCreateRow.apply(a,arguments)}),this.addHook("afterCreateCol",function(){return a.onAfterCreateCol.apply(a,arguments)}),this.addHook("beforeRemoveRow",function(){return a.onBeforeRemoveRow.apply(a,arguments)}),this.addHook("beforeRemoveCol",function(){return a.onBeforeRemoveCol.apply(a,arguments)}),this.addHook("afterRemoveRow",function(){return a.onAfterRemoveRow.apply(a,arguments)}),this.addHook("afterRemoveCol",function(){return a.onAfterRemoveCol.apply(a,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==Bee&&a.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==Bee&&a.engine.redo()}),this.addHook("afterDetachChild",function(){return a.onAfterDetachChild.apply(a,arguments)}),this.addHook("beforeAutofill",function(){return a.onBeforeAutofill.apply(a,arguments)}),pp(this,ob).forEach(function(s){var l=dp(s,2),u=l[0],f=l[1];return a.engine.on(u,f)}),nd(_u(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;pp(this,ob).forEach(function(a){var o=dp(a,2),s=o[0],l=o[1];return i.engine.off(s,l)}),Nee(this.engine,this.hot),this.engine=null,nd(_u(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(vRt(this.hot.getSettings()));var a=this.hot.getSettings()[sa];if(dt(a)&&dt(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!i.data&&this.sheetName===null){var o=this.hot.getSettings()[sa].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}nd(_u(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;pp(this,ob).forEach(function(a){var o,s=dp(a,2),l=s[0],u=s[1];return(o=i.engine)===null||o===void 0?void 0:o.off(l,u)}),vp(this,ob,null),Nee(this.engine,this.hot),this.engine=null,nd(_u(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,a,o,s,l){return!l&&i>=o?s+(i-o):a}},{key:"toPhysicalRowPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),a)}},{key:"toPhysicalColumnPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),a)}},{key:"addSheet",value:function(i,a){if(dt(a)&&!Zhe(a))return Kr("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return Kr("Sheet with the provided name already exists."),!1;try{var o=this.engine.addSheet(i??void 0);return a&&this.engine.setSheetContent(this.engine.getSheetId(o),a),o}catch(s){return Kr(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){IW("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var a=this.engine.getSheetSerialized(this.sheetId);a.length>0&&this.hot.loadData(a,"".concat(La(sa),".switchSheet"))}},{key:"getCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s!==null&&l!==null?this.engine.getCellType({sheet:o,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:o,row:s,col:l})}},{key:"renderDependentSheets",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var u,f=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(s.has(f)||s.add(f))}),$ee(this.engine).forEach(function(l,u){if((o||u!==a.sheetId)&&s.has(u)){var f;l.render(),(f=l.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,g=h.sheet;return dt(g)?"".concat(g,":").concat(d,"x").concat(v):""},l=new Set(o.map(function(u){return s(u)}));i.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col,g=dt(d)?a.hot.toVisualRow(d):null,y=dt(v)?a.hot.toVisualColumn(v):null;if(!(g===null||y===null)){var b=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,w=s(u);if(b!==void 0&&!l.has(w)){var _=$ee(a.engine).get(b);if(!_)return;_.validateCell(_.getDataAtCell(g,y),_.getCellMeta(g,y),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,a,o){var s={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(a),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){Kr("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,o)}},{key:"onBeforeValidate",value:function(i,a,o){var s=this.hot.propToCol(o);if(this.isFormulaCellType(a,s)){var l={row:this.hot.toPhysicalRow(a),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return Ac(u)==="object"&&u!==null?u.value:u}return i}},{key:"onBeforeAutofill",value:function(i,a,o){var s=this,l=function(h){return Fee(Fee({},h),{},{sheet:s.sheetId})},u={start:l(a.getTopStartCorner()),end:l(a.getBottomEndCorner())},f={start:l(o.getTopStartCorner()),end:l(o.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(f)===!1?!1:this.engine.getFillRangeData(u,f)}},{key:"onBeforeLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";o.includes(La(sa))||vp(this,ND,Yr(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!o.includes(La(sa)))if(this.sheetName=wRt(this.engine,this.hot.getSettings()[sa].sheetName),pp(this,ND))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){vp(this,Eh,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),vp(this,Eh,!1)}}}},{key:"onModifyData",value:function(i,a,o,s){if(!(s!=="get"||pp(this,Eh)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.isFormulaCellType(l,a);if(!u){var f=this.getCellType(l,a);if(f!=="ARRAY"){_pe(o.value)&&(o.value=_Rt(o.value));return}}var c={row:i,col:this.toPhysicalColumnPosition(a),sheet:this.sheetId},h=this.engine.getCellValue(c),d=Ac(h)==="object"&&h!==null?h.value:h;o.value=d}}},{key:"onModifySourceData",value:function(i,a,o,s){if(!(s!=="get"||pp(this,Eh)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.hot.propToCol(a),f=this.isFormulaCellType(l,u);if(!f){var c=this.getCellType(l,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:i,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};o.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(i,a){var o=this;if(!gp(a)){var s=[],l=[],u=this.engine.batch(function(){i.forEach(function(f){var c=dp(f,4),h=c[0],d=c[1],v=c[3],g=o.hot.propToCol(d),y=o.hot.toPhysicalRow(h),b=o.hot.toPhysicalColumn(g),w={row:y,col:b,sheet:o.sheetId};y!==null&&b!==null?o.syncChangeWithEngine(h,g,v):s.push([h,g,v]),l.push({address:w})})});s.length&&this.hot.addHookOnce("afterChange",function(){var f=o.engine.batch(function(){s.forEach(function(c){var h=dp(c,3),d=h[0],v=h[1],g=h[2];o.syncChangeWithEngine(d,v,g)})});o.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,a){var o=this;if(!gp(a)){var s=[],l=[];i.forEach(function(u){var f=dp(u,4),c=f[0],h=f[1],d=f[3],v=o.hot.propToCol(h);if(eo(v)){var g={row:c,col:o.toPhysicalColumnPosition(v),sheet:o.sheetId};if(!o.engine.isItPossibleToSetCellContents(g)){Kr("Not possible to set source cell data at ".concat(JSON.stringify(g)));return}l.push({address:g}),s.push.apply(s,SRt(o.engine.setCellContents(g,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),a]))return!1}},{key:"onBeforeCreateCol",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]))return!1}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,a,o){if(!gp(o)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,a,o){if(!gp(o)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(!gp(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeRows(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(i,a,o,s){var l=this;if(!gp(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeColumns(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(i,a,o){var s,l=this;vp(this,Eh,!0);var u=this.hot.getSourceDataArray(o,0,o+(((s=a.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());vp(this,Eh,!1),u.forEach(function(f,c){f.forEach(function(h,d){l.engine.setCellContents({col:d,row:o+c,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,a){this.hot.runHooks("afterNamedExpressionAdded",i,a)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,a){this.hot.runHooks("afterNamedExpressionRemoved",i,a)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,a){this.hot.runHooks("afterSheetRenamed",i,a)}},{key:"onEngineSheetRemoved",value:function(i,a){this.hot.runHooks("afterSheetRemoved",i,a)}}],[{key:"PLUGIN_KEY",get:function(){return sa}},{key:"PLUGIN_PRIORITY",get:function(){return BRt}}]),r}(Ar);function VRt(e,t){return GRt(e)||zRt(e,t)||jRt(e,t)||URt()}function URt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jRt(e,t){if(e){if(typeof e=="string")return Wee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wee(e,t)}}function Wee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zRt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function GRt(e){if(Array.isArray(e))return e}function YRt(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=VRt(r,4),a=i[1],o=i[3];a-o!==0&&(n=1)}return this.getTranslatedPhrase(jV,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.col,i.col),0),o=Math.max(n.col,i.col),s=[],l=a;l<=o;l+=1)s.push(l);e.hideColumns(s);var u=s[s.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function kT(e){return ZRt(e)||qRt(e)||XRt(e)||KRt()}function KRt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XRt(e,t){if(e){if(typeof e=="string")return HH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HH(e,t)}}function qRt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZRt(e){if(Array.isArray(e))return HH(e)}function HH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JRt(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(zV,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countCols();s||this.selectColumns(a,o)}},disabled:!1,hidden:function(){var n=this,i=tr(e.getHiddenColumns(),function(w){return n.toPhysicalColumn(w)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().col,s=a.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var g=c.slice(o,s+1);h.push.apply(h,kT(g.filter(function(w){return i.includes(w)})))}}else if(u===0&&u<o)h.push.apply(h,kT(c.slice(0,o)));else if(u===null)h.push.apply(h,kT(c.slice(0,this.countCols())));else{var y=this.countCols()-1,b=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));f===b&&y>s&&h.push.apply(h,kT(c.slice(s+1)))}return ve(h,function(w){t.push(n.toVisualColumn(w))}),t.length===0}}}function Zy(e){return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zy(e)}function QRt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tkt(n.key),n)}}function ekt(e,t,r){return t&&Vee(e.prototype,t),r&&Vee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tkt(e){var t=rkt(e,"string");return Zy(t)==="symbol"?t:String(t)}function rkt(e,t){if(Zy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function id(){return typeof Reflect<"u"&&Reflect.get?id=Reflect.get.bind():id=function(t,r,n){var i=nkt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},id.apply(this,arguments)}function nkt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Su(e),e!==null););return e}function ikt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BH(e,t)}function BH(e,t){return BH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},BH(e,t)}function akt(e){var t=skt();return function(){var n=Su(e),i;if(t){var a=Su(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return okt(this,i)}}function okt(e,t){if(t&&(Zy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WH(e)}function WH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function skt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Su(e)}function Uee(e,t,r){lkt(e,t),t.set(e,r)}function lkt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(e,t){var r=Tpe(e,t,"get");return ukt(e,r)}function ukt(e,t){return t.get?t.get.call(e):t.value}function sb(e,t,r){var n=Tpe(e,t,"set");return fkt(e,n,r),r}function Tpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function fkt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pt.getSingleton().register("beforeHideColumns");pt.getSingleton().register("afterHideColumns");pt.getSingleton().register("beforeUnhideColumns");pt.getSingleton().register("afterUnhideColumns");var LD="hiddenColumns",ckt=310,el=new WeakMap,tl=new WeakMap,hkt=function(e){ikt(r,e);var t=akt(r);function r(){var n;QRt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Uee(WH(n),el,{writable:!0,value:{}}),Uee(WH(n),tl,{writable:!0,value:null}),n}return ekt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[LD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[LD];rr(a)&&(sb(this,el,a),Yr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),sb(this,tl,new RA),Xa(this,tl).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Xa(this,tl)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyColWidth",function(o,s){return i.onModifyColWidth(o,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),id(Su(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),id(Su(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),sb(this,el,{}),id(Su(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o,u=Xa(this,tl).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalColumn(d)});ve(c,function(d){u[d]=!1}),l=Nn(u,function(d,v,g){return v&&d.push(a.hot.toVisualColumn(g)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",o,l,s&&f);h!==!1&&(s&&f&&Xa(this,tl).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",o,l,s&&f,s&&l.length<o.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showColumns(a)}},{key:"hideColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideColumns",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ve(i,function(f){Xa(a,tl).setValueAtIndex(a.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",o,l,s,s&&l.length>o.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideColumns(a)}},{key:"getHiddenColumns",value:function(){var i=this;return tr(Xa(this,tl).getHiddenIndexes(),function(a){return i.hot.toVisualColumn(a)})}},{key:"isHidden",value:function(i){return Xa(this,tl).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ve(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,a){if(this.isHidden(a))return 0;if(Xa(this,el).indicators&&(this.isHidden(a+1)||this.isHidden(a-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(Xa(this,el).copyPasteEnabled===!1&&this.isHidden(a)&&(o.skipColumnOnPaste=!0),this.isHidden(a-1))o.className=o.className||"",o.className.indexOf("afterHiddenColumn")===-1&&(o.className+=" afterHiddenColumn");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(Xa(this,el).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ve(i,function(l){var u=!0,f=0;xt(l.startCol,l.endCol,function(c){a.isHidden(c)?(u||s(l.startRow,l.endRow,f,c-1),u=!0):(u&&(f=c),c===l.endCol&&s(l.startRow,l.endRow,f,c),u=!1)})}),o}},{key:"onAfterGetColHeader",value:function(i,a){if(!(!Xa(this,el).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&o.push("beforeHiddenColumn"),Ge(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:sr},YRt(this),JRt(this))}},{key:"onMapInit",value:function(){Array.isArray(Xa(this,el).columns)&&this.hideColumns(Xa(this,el).columns)}},{key:"destroy",value:function(){sb(this,el,null),sb(this,tl,null),id(Su(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LD}},{key:"PLUGIN_PRIORITY",get:function(){return ckt}}]),r}(Ar);function dkt(e,t){return ykt(e)||gkt(e,t)||pkt(e,t)||vkt()}function vkt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pkt(e,t){if(e){if(typeof e=="string")return jee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jee(e,t)}}function jee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gkt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ykt(e){if(Array.isArray(e))return e}function mkt(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=dkt(r,3),a=i[0],o=i[2];a-o!==0&&(n=1)}return this.getTranslatedPhrase(GV,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.row,i.row),0),o=Math.max(n.row,i.row),s=[],l=a;l<=o;l+=1)s.push(l);e.hideRows(s);var u=s[s.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function AT(e){return Skt(e)||_kt(e)||wkt(e)||bkt()}function bkt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wkt(e,t){if(e){if(typeof e=="string")return VH(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VH(e,t)}}function _kt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Skt(e){if(Array.isArray(e))return VH(e)}function VH(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ckt(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(YV,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countRows();s||this.selectRows(a,o)}},disabled:!1,hidden:function(){var n=this,i=tr(e.getHiddenRows(),function(w){return n.toPhysicalRow(w)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().row,s=a.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var g=c.slice(o,s+1);h.push.apply(h,AT(g.filter(function(w){return i.includes(w)})))}}else if(u===0&&u<o)h.push.apply(h,AT(c.slice(0,o)));else if(u===null)h.push.apply(h,AT(c.slice(0,this.countRows())));else{var y=this.countRows()-1,b=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));f===b&&y>s&&h.push.apply(h,AT(c.slice(s+1)))}return ve(h,function(w){t.push(n.toVisualRow(w))}),t.length===0}}}function Jy(e){return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jy(e)}function xkt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Okt(n.key),n)}}function Tkt(e,t,r){return t&&zee(e.prototype,t),r&&zee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Okt(e){var t=Ekt(e,"string");return Jy(t)==="symbol"?t:String(t)}function Ekt(e,t){if(Jy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ad(){return typeof Reflect<"u"&&Reflect.get?ad=Reflect.get.bind():ad=function(t,r,n){var i=Rkt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ad.apply(this,arguments)}function Rkt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cu(e),e!==null););return e}function kkt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UH(e,t)}function UH(e,t){return UH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UH(e,t)}function Akt(e){var t=Ikt();return function(){var n=Cu(e),i;if(t){var a=Cu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Pkt(this,i)}}function Pkt(e,t){if(t&&(Jy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jH(e)}function jH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ikt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cu(e)}function Gee(e,t,r){Mkt(e,t),t.set(e,r)}function Mkt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eo(e,t){var r=Ope(e,t,"get");return Dkt(e,r)}function Dkt(e,t){return t.get?t.get.call(e):t.value}function lb(e,t,r){var n=Ope(e,t,"set");return $kt(e,n,r),r}function Ope(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $kt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}pt.getSingleton().register("beforeHideRows");pt.getSingleton().register("afterHideRows");pt.getSingleton().register("beforeUnhideRows");pt.getSingleton().register("afterUnhideRows");var FD="hiddenRows",Nkt=320,Yl=new WeakMap,rl=new WeakMap,Lkt=function(e){kkt(r,e);var t=Akt(r);function r(){var n;xkt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Gee(jH(n),Yl,{writable:!0,value:{}}),Gee(jH(n),rl,{writable:!0,value:null}),n}return Tkt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[FD];rr(a)&&(lb(this,Yl,a),Yr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),lb(this,rl,new RA),Eo(this,rl).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Eo(this,rl)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyRowHeight",function(o,s){return i.onModifyRowHeight(o,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),ad(Cu(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ad(Cu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),lb(this,Yl,{}),ad(Cu(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o,u=Eo(this,rl).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalRow(d)});ve(c,function(d){u[d]=!1}),l=Nn(u,function(d,v,g){return v&&d.push(a.hot.toVisualRow(g)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",o,l,s&&f);h!==!1&&(s&&f&&Eo(this,rl).setValues(u),this.hot.runHooks("afterUnhideRows",o,l,s&&f,s&&l.length<o.length))}},{key:"showRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showRows(a)}},{key:"hideRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideRows",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ve(i,function(f){Eo(a,rl).setValueAtIndex(a.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",o,l,s,s&&l.length>o.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideRows(a)}},{key:"getHiddenRows",value:function(){var i=this;return tr(Eo(this,rl).getHiddenIndexes(),function(a){return i.hot.toVisualRow(a)})}},{key:"isHidden",value:function(i){return Eo(this,rl).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ve(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,a){return this.isHidden(a)?0:i}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(Eo(this,Yl).copyPasteEnabled===!1&&this.isHidden(i)&&(o.skipRowOnPaste=!0),this.isHidden(i-1))o.className=o.className||"",o.className.indexOf("afterHiddenRow")===-1&&(o.className+=" afterHiddenRow");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(Eo(this,Yl).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ve(i,function(l){var u=!0,f=0;xt(l.startRow,l.endRow,function(c){a.isHidden(c)?(u||s(f,c-1,l.startCol,l.endCol),u=!0):(u&&(f=c),c===l.endRow&&s(f,c,l.startCol,l.endCol),u=!1)})}),o}},{key:"onAfterGetRowHeader",value:function(i,a){if(!(!Eo(this,Yl).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&o.push("beforeHiddenRow"),Ge(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:sr},mkt(this),Ckt(this))}},{key:"onMapInit",value:function(){Array.isArray(Eo(this,Yl).rows)&&this.hideRows(Eo(this,Yl).rows)}},{key:"destroy",value:function(){lb(this,Yl,null),lb(this,rl,null),ad(Cu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FD}},{key:"PLUGIN_PRIORITY",get:function(){return Nkt}}]),r}(Ar);function Fkt(e,t){return Vkt(e)||Wkt(e,t)||Bkt(e,t)||Hkt()}function Hkt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bkt(e,t){if(e){if(typeof e=="string")return Yee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yee(e,t)}}function Yee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wkt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Vkt(e){if(Array.isArray(e))return e}function Ukt(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(wV)},callback:function(r,n){var i=Fkt(n,1),a=i[0].start.col;e.freezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function jkt(e,t){return Kkt(e)||Ykt(e,t)||Gkt(e,t)||zkt()}function zkt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gkt(e,t){if(e){if(typeof e=="string")return Kee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kee(e,t)}}function Kee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ykt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Kkt(e){if(Array.isArray(e))return e}function Xkt(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(_V)},callback:function(r,n){var i=jkt(n,1),a=i[0].start.col;e.unfreezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Qy(e){return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qy(e)}function qkt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jkt(n.key),n)}}function Zkt(e,t,r){return t&&Xee(e.prototype,t),r&&Xee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jkt(e){var t=Qkt(e,"string");return Qy(t)==="symbol"?t:String(t)}function Qkt(e,t){if(Qy(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function og(){return typeof Reflect<"u"&&Reflect.get?og=Reflect.get.bind():og=function(t,r,n){var i=eAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},og.apply(this,arguments)}function eAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vc(e),e!==null););return e}function tAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zH(e,t)}function zH(e,t){return zH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zH(e,t)}function rAt(e){var t=iAt();return function(){var n=vc(e),i;if(t){var a=vc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nAt(this,i)}}function nAt(e,t){if(t&&(Qy(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Epe(e)}function Epe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vc(e){return vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vc(e)}pt.getSingleton().register("beforeColumnFreeze");pt.getSingleton().register("afterColumnFreeze");pt.getSingleton().register("beforeColumnUnfreeze");pt.getSingleton().register("afterColumnUnfreeze");var qee="manualColumnFreeze",aAt=110,ub=new WeakMap,oAt=function(e){tAt(r,e);var t=rAt(r);function r(n){var i;return qkt(this,r),i=t.call(this,n),ub.set(Epe(i),{afterFirstUse:!1}),i}return Zkt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qee]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.addContextMenuEntry(a)}),this.addHook("beforeColumnMove",function(a,o){return i.onBeforeColumnMove(a,o)}),og(vc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=ub.get(this);i.afterFirstUse=!1,og(vc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),og(vc(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var a=ub.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart<this.hot.countCols()&&i>o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",i,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart),o._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,s))}},{key:"unfreezeColumn",value:function(i){var a=ub.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart>0&&i<=o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",i,s);l!==!1&&(s&&(o._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,s))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},Ukt(this),Xkt(this))}},{key:"onBeforeColumnMove",value:function(i,a){var o=ub.get(this);if(o.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(a<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return qee}},{key:"PLUGIN_PRIORITY",get:function(){return aAt}}]),r}(Ar);function OS(e){return OS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OS(e)}function sAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uAt(n.key),n)}}function lAt(e,t,r){return t&&Zee(e.prototype,t),r&&Zee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uAt(e){var t=fAt(e,"string");return OS(t)==="symbol"?t:String(t)}function fAt(e,t){if(OS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(OS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HD=0,Jee=1,Qee=2,yp="px",cAt=function(){function e(t){sAt(this,e),this.hot=t,this._element=null,this.state=HD,this.inlineProperty=t.isRtl()?"right":"left"}return lAt(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=Qee}},{key:"build",value:function(){this.state===HD&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Jee)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=HD}},{key:"isAppended",value:function(){return this.state===Qee}},{key:"isBuilt",value:function(){return this.state>=Jee}},{key:"setPosition",value:function(r,n){eo(r)&&(this._element.style.top=r+yp),eo(n)&&(this._element.style[this.inlineProperty]=n+yp)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){eo(r)&&(this._element.style.width=r+yp),eo(n)&&(this._element.style.height=n+yp)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){eo(r)&&(this._element.style.marginTop=r+yp),eo(n)&&(this._element.style["margin".concat(La(this.inlineProperty))]=n+yp)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(La(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const Rpe=cAt;function em(e){return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},em(e)}function hAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ete(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vAt(n.key),n)}}function dAt(e,t,r){return t&&ete(e.prototype,t),r&&ete(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vAt(e){var t=pAt(e,"string");return em(t)==="symbol"?t:String(t)}function pAt(e,t){if(em(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(em(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GO(){return typeof Reflect<"u"&&Reflect.get?GO=Reflect.get.bind():GO=function(t,r,n){var i=gAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},GO.apply(this,arguments)}function gAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tm(e),e!==null););return e}function yAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GH(e,t)}function GH(e,t){return GH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GH(e,t)}function mAt(e){var t=_At();return function(){var n=tm(e),i;if(t){var a=tm(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return bAt(this,i)}}function bAt(e,t){if(t&&(em(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wAt(e)}function wAt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _At(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tm(e){return tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tm(e)}var SAt="ht__manualColumnMove--backlight",CAt=function(e){yAt(r,e);var t=mAt(r);function r(){return hAt(this,r),t.apply(this,arguments)}return dAt(r,[{key:"build",value:function(){GO(tm(r.prototype),"build",this).call(this),Ge(this._element,SAt)}}]),r}(Rpe);const xAt=CAt;function rm(e){return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rm(e)}function TAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EAt(n.key),n)}}function OAt(e,t,r){return t&&tte(e.prototype,t),r&&tte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EAt(e){var t=RAt(e,"string");return rm(t)==="symbol"?t:String(t)}function RAt(e,t){if(rm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YO(){return typeof Reflect<"u"&&Reflect.get?YO=Reflect.get.bind():YO=function(t,r,n){var i=kAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},YO.apply(this,arguments)}function kAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=nm(e),e!==null););return e}function AAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YH(e,t)}function YH(e,t){return YH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YH(e,t)}function PAt(e){var t=DAt();return function(){var n=nm(e),i;if(t){var a=nm(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return IAt(this,i)}}function IAt(e,t){if(t&&(rm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MAt(e)}function MAt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nm(e){return nm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nm(e)}var $At="ht__manualColumnMove--guideline",NAt=function(e){AAt(r,e);var t=PAt(r);function r(){return TAt(this,r),t.apply(this,arguments)}return OAt(r,[{key:"build",value:function(){YO(nm(r.prototype),"build",this).call(this),Ge(this._element,$At)}}]),r}(Rpe);const LAt=NAt;function im(e){return im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},im(e)}function FAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BAt(n.key),n)}}function HAt(e,t,r){return t&&rte(e.prototype,t),r&&rte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BAt(e){var t=WAt(e,"string");return im(t)==="symbol"?t:String(t)}function WAt(e,t){if(im(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(im(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function od(){return typeof Reflect<"u"&&Reflect.get?od=Reflect.get.bind():od=function(t,r,n){var i=VAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},od.apply(this,arguments)}function VAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function UAt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KH(e,t)}function KH(e,t){return KH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KH(e,t)}function jAt(e){var t=GAt();return function(){var n=xu(e),i;if(t){var a=xu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zAt(this,i)}}function zAt(e,t){if(t&&(im(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XH(e)}function XH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GAt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}pt.getSingleton().register("beforeColumnMove");pt.getSingleton().register("afterColumnMove");var BD="manualColumnMove",YAt=120,kf=new WeakMap,nte="ht__manualColumnMove",PT="show-ui",WD="on-moving--columns",VD="after-selection--columns",KAt=function(e){UAt(r,e);var t=jAt(r);function r(n){var i;return FAt(this,r),i=t.call(this,n),kf.set(XH(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new bn(XH(i)),i.backlight=new xAt(n),i.guideline=new LAt(n),i}return HAt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[BD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Ge(this.hot.rootElement,nte),od(xu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),od(xu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Vt(this.hot.rootElement,nte),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),od(xu(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,a){return this.moveColumns([i],a)}},{key:"moveColumns",value:function(i,a){var o=kf.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeColumnMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,a);var f=l&&this.isColumnOrderChanged(i,a);return this.hot.runHooks("afterColumnMove",i,a,s,l,f),f}}},{key:"dragColumn",value:function(i,a){return this.dragColumns([i],a)}},{key:"dragColumns",value:function(i,a){var o=this.countFinalIndex(i,a),s=kf.get(this);return s.cachedDropIndex=a,this.moveColumns(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isColumnOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=Nn(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getColumnsWidth",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=0,l=i;l<=a;l+=1){var u=o.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[BD];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveColumns(a,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,a){var o=[];return xt(i,a,function(s){o.push(s)}),o}},{key:"refreshPositions",value:function(){var i=kf.get(this),a=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&a>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1));var o=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),f=o.hider.offsetWidth,c=o.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,g=0;if(this.hot.isRtl()){var y=this.hot.rootWindow,b=jr(this.hot.rootElement),w=y.innerWidth-i.rootElementOffset-b;g=y.innerWidth-i.target.eventPageX-w-(s.scrollX===void 0?l:0)}else g=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=v,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=a>0?a-1:a;else if(i.target.TD.offsetWidth/2+u<=g){var _=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=_+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var x=g,E=u;g+d+h>=f?x=f-d-h:g+h<c+v&&(x=c+v+Math.abs(h)),u>=f-1?E=f-1:E===0?E=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(E-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,x),this.guideline.setPosition(null,E)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=kf.get(this),h=Wt(i.target,"sortAction");if(!f||!u||c.pressed||i.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,Vt(this.hot.rootElement,[WD,PT]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var g=f.from,y=f.to,b=Math.min(g.col,y.col),w=Math.max(g.col,y.col);if(a.row<0&&a.col>=b&&a.col<=w){s.column=!0,c.pressed=!0,c.target.eventPageX=i.pageX,c.target.eventOffsetX=i.offsetX,c.hoveredColumn=a.col,c.target.TD=o,c.target.col=a.col,c.columnsToMove=this.prepareColumnsToMoving(b,w),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=jn(this.hot.rootElement).left;var _=c.hasRowHeaders?-1:0,x=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,E=a.col<c.fixedColumnsStart,R=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),A=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),N=this.getColumnsWidth(b,a.col-1)+A,I=this.getColumnsWidth(_,b-1)+(E?R:0)+N;this.backlight.setPosition(x,I),this.backlight.setSize(this.getColumnsWidth(b,w),l.hider.offsetHeight-x),this.backlight.setOffset(null,-N),Ge(this.hot.rootElement,WD)}else Vt(this.hot.rootElement,VD),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=kf.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(o)})}a.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=kf.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(a.col)>-1?Vt(this.hot.rootElement,PT):Ge(this.hot.rootElement,PT),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=a.col,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=kf.get(this),a=i.target.col,o=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,Vt(this.hot.rootElement,[WD,PT,VD]),this.hot.selection.isSelectedByColumnHeader()&&Ge(this.hot.rootElement,VD),!(o<1||a===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,a);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(l),c=f+o-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,a=i.getColumnHeaderHeight(0)+1,o=i.holder.scrollTop,s=a+o;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),od(xu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return BD}},{key:"PLUGIN_PRIORITY",get:function(){return YAt}}]),r}(Ar);function am(e){return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},am(e)}function XAt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ite(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZAt(n.key),n)}}function qAt(e,t,r){return t&&ite(e.prototype,t),r&&ite(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZAt(e){var t=JAt(e,"string");return am(t)==="symbol"?t:String(t)}function JAt(e,t){if(am(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(am(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sd(){return typeof Reflect<"u"&&Reflect.get?sd=Reflect.get.bind():sd=function(t,r,n){var i=QAt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},sd.apply(this,arguments)}function QAt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Tu(e),e!==null););return e}function ePt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qH(e,t)}function qH(e,t){return qH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qH(e,t)}function tPt(e){var t=nPt();return function(){var n=Tu(e),i;if(t){var a=Tu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rPt(this,i)}}function rPt(e,t){if(t&&(am(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZH(e)}function ZH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nPt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tu(e){return Tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tu(e)}var IT="manualColumnResize",iPt=130,ate="manualColumnWidths",UD=new WeakMap,aPt=function(e){ePt(r,e);var t=tPt(r);function r(n){var i;XAt(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new bn(ZH(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,UD.set(ZH(i),{config:void 0}),Ge(i.handle,"manualColumnResizer"),Ge(i.guide,"manualColumnResizerGuide"),i}return qAt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[IT]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new $c,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(a,o){return i.onModifyColWidth(a,o)}),this.addHook("beforeStretchingColumnWidth",function(a,o){return i.onBeforeStretchingColumnWidth(a,o)}),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),this.bindEvents(),sd(Tu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sd(Tu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=UD.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),sd(Tu(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",ate,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",ate,i),i.value}},{key:"setManualSize",value:function(i,a){var o=Math.max(a,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,o),o}},{key:"clearManualSize",value:function(i){var a=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(a,null)}},{key:"onMapInit",value:function(){var i=this,a=UD.get(this),o=this.hot.getSettings()[IT],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(o)?(this.hot.batchExecution(function(){o.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0),a.config=o):o===!0&&Array.isArray(a.config)&&this.hot.batchExecution(function(){a.config.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var a=this;if(i.parentNode){this.currentTH=i;var o=this.hot.view._wt,s=o.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=mn(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=l<o.getSetting("fixedColumnsStart"),h;c&&(h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=o.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();ve(v,function(g){var y=g.getTopStartCorner().col,b=g.getBottomEndCorner().col;xt(y,b,function(w){a.selectedCols.includes(w)||a.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(mn(this.handle),10),a=parseInt(this.handle.style.top,10)+i,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ge(this.handle,"active"),Ge(this.guide,"active"),this.guide.style.top="".concat(a,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Vt(this.handle,"active"),Vt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!ic(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!kW(i.target)&&this.checkIfColumnHeader(i.target)){var a=this.getClosestTHParent(i.target);if(!a)return;var o=a.getAttribute("colspan");a&&(o===null||o==="1")&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeColumnResize",i.newSize,u,!0);c!==void 0&&(i.newSize=c),i.hot.getSettings().stretchH==="all"?i.clearManualSize(u):i.setManualSize(u,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(ve(this.selectedCols,function(l){o(l)}),a()):ve(this.selectedCols,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;Wt(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var a=this;if(this.pressed){var o=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+o,ve(this.selectedCols,function(s){a.newSize=a.setManualSize(s,a.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeColumnResize",i.newSize,u,!1),f&&a(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(ve(this.selectedCols,function(l){o(l)}),a()):ve(this.selectedCols,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootWindow,s=a.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(o,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalColumn(a),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[IT]&&l&&(o=l)}return o}},{key:"onBeforeStretchingColumnWidth",value:function(i,a){var o=this.columnWidthsMap.getValueAtIndex(a);return o===null&&(o=i),o}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){sd(Tu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return IT}},{key:"PLUGIN_PRIORITY",get:function(){return iPt}}]),r}(Ar);function ES(e){return ES=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ES(e)}function oPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ote(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lPt(n.key),n)}}function sPt(e,t,r){return t&&ote(e.prototype,t),r&&ote(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lPt(e){var t=uPt(e,"string");return ES(t)==="symbol"?t:String(t)}function uPt(e,t){if(ES(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ES(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jD=0,ste=1,lte=2,mp="px",fPt=function(){function e(t){oPt(this,e),this.hot=t,this._element=null,this.state=jD}return sPt(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=lte}},{key:"build",value:function(){this.state===jD&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ste)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=jD}},{key:"isAppended",value:function(){return this.state===lte}},{key:"isBuilt",value:function(){return this.state>=ste}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+mp),n!==void 0&&(this._element.style.left=n+mp)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+mp),n&&(this._element.style.height=n+mp)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+mp),n&&(this._element.style.marginLeft=n+mp)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const kpe=fPt;function om(e){return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},om(e)}function cPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ute(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dPt(n.key),n)}}function hPt(e,t,r){return t&&ute(e.prototype,t),r&&ute(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dPt(e){var t=vPt(e,"string");return om(t)==="symbol"?t:String(t)}function vPt(e,t){if(om(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(om(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KO(){return typeof Reflect<"u"&&Reflect.get?KO=Reflect.get.bind():KO=function(t,r,n){var i=pPt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},KO.apply(this,arguments)}function pPt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=sm(e),e!==null););return e}function gPt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JH(e,t)}function JH(e,t){return JH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JH(e,t)}function yPt(e){var t=wPt();return function(){var n=sm(e),i;if(t){var a=sm(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mPt(this,i)}}function mPt(e,t){if(t&&(om(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bPt(e)}function bPt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wPt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sm(e){return sm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sm(e)}var _Pt="ht__manualRowMove--backlight",SPt=function(e){gPt(r,e);var t=yPt(r);function r(){return cPt(this,r),t.apply(this,arguments)}return hPt(r,[{key:"build",value:function(){KO(sm(r.prototype),"build",this).call(this),Ge(this._element,_Pt)}}]),r}(kpe);const CPt=SPt;function lm(e){return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lm(e)}function xPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OPt(n.key),n)}}function TPt(e,t,r){return t&&fte(e.prototype,t),r&&fte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OPt(e){var t=EPt(e,"string");return lm(t)==="symbol"?t:String(t)}function EPt(e,t){if(lm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XO(){return typeof Reflect<"u"&&Reflect.get?XO=Reflect.get.bind():XO=function(t,r,n){var i=RPt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},XO.apply(this,arguments)}function RPt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=um(e),e!==null););return e}function kPt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QH(e,t)}function QH(e,t){return QH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QH(e,t)}function APt(e){var t=MPt();return function(){var n=um(e),i;if(t){var a=um(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return PPt(this,i)}}function PPt(e,t){if(t&&(lm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IPt(e)}function IPt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MPt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function um(e){return um=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},um(e)}var DPt="ht__manualRowMove--guideline",$Pt=function(e){kPt(r,e);var t=APt(r);function r(){return xPt(this,r),t.apply(this,arguments)}return TPt(r,[{key:"build",value:function(){XO(um(r.prototype),"build",this).call(this),Ge(this._element,DPt)}}]),r}(kpe);const NPt=$Pt;function fm(e){return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fm(e)}function LPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HPt(n.key),n)}}function FPt(e,t,r){return t&&cte(e.prototype,t),r&&cte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HPt(e){var t=BPt(e,"string");return fm(t)==="symbol"?t:String(t)}function BPt(e,t){if(fm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ld(){return typeof Reflect<"u"&&Reflect.get?ld=Reflect.get.bind():ld=function(t,r,n){var i=WPt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ld.apply(this,arguments)}function WPt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ou(e),e!==null););return e}function VPt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eB(e,t)}function eB(e,t){return eB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eB(e,t)}function UPt(e){var t=zPt();return function(){var n=Ou(e),i;if(t){var a=Ou(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return jPt(this,i)}}function jPt(e,t){if(t&&(fm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tB(e)}function tB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zPt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ou(e){return Ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ou(e)}pt.getSingleton().register("beforeRowMove");pt.getSingleton().register("afterRowMove");var zD="manualRowMove",GPt=140,Af=new WeakMap,hte="ht__manualRowMove",MT="show-ui",GD="on-moving--rows",YD="after-selection--rows",YPt=function(e){VPt(r,e);var t=UPt(r);function r(n){var i;return LPt(this,r),i=t.call(this,n),Af.set(tB(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new bn(tB(i)),i.backlight=new CPt(n),i.guideline=new NPt(n),i}return FPt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Ge(this.hot.rootElement,hte),ld(Ou(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ld(Ou(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Vt(this.hot.rootElement,hte),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ld(Ou(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,a){return this.moveRows([i],a)}},{key:"moveRows",value:function(i,a){var o=Af.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeRowMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,a);var f=l&&this.isRowOrderChanged(i,a);return this.hot.runHooks("afterRowMove",i,a,s,l,f),f}}},{key:"dragRow",value:function(i,a){return this.dragRows([i],a)}},{key:"dragRows",value:function(i,a){var o=this.countFinalIndex(i,a),s=Af.get(this);return s.cachedDropIndex=a,this.moveRows(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isRowOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=Nn(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getRowsHeight",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=0,l=i;l<=a;l++){var u=o.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[zD];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveRows(a,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),a=[];if(!i)return a;var o=i.from,s=i.to,l=Math.min(o.row,s.row),u=Math.max(o.row,s.row);return xt(l,u,function(f){a.push(f)}),a}},{key:"refreshPositions",value:function(){var i=Af.get(this),a=i.target.coords,o=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(a.row)&&o>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1)),this.isFixedRowBottom(a.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=i.target.TD,c=jn(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,a.row-1),d=i.target.eventPageY-c.top+u.holder.scrollTop,v=u.hider.offsetHeight,g=u.TBODY.offsetTop,y=this.backlight.getOffset().top,b=this.backlight.getSize().height;this.isFixedRowTop(a.row)&&(h+=u.holder.scrollTop),a.row<0?i.target.row=o>0?o-1:o:f.offsetHeight/2+h<=d?(i.target.row=a.row+1,h+=a.row===0?f.offsetHeight-1:f.offsetHeight):i.target.row=a.row;var w=d,_=h;d+b+y>=v?w=v-b-y:d+y<g&&(w=g+Math.abs(y)),h>=v-1&&(_=v-1),this.backlight.setPosition(w),this.guideline.setPosition(_)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt,u=l.wtTable,f=l.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Af.get(this);if(!h||!c||d.pressed||i.button!==0){d.pressed=!1,d.rowsToMove.length=0,Vt(this.hot.rootElement,[GD,MT]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),g=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&g&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var y=h.from,b=h.to,w=Math.min(y.row,b.row),_=Math.max(y.row,b.row);if(a.col<0&&a.row>=w&&a.row<=_){s.row=!0,d.pressed=!0,d.target.eventPageY=i.pageY,d.target.coords=a,d.target.TD=o,d.rowsToMove=this.prepareRowsToMoving();var x=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,x),this.backlight.setSize(u.hider.offsetWidth-x,this.getRowsHeight(w,_)),this.backlight.setOffset((this.getRowsHeight(w,a.row-1)+i.offsetY)*-1,null),Ge(this.hot.rootElement,GD),this.refreshPositions()}else Vt(this.hot.rootElement,YD),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=Af.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,o)})}a.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=Af.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(a.row)>-1?Vt(this.hot.rootElement,MT):Ge(this.hot.rootElement,MT),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=a,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=Af.get(this),a=i.target.row,o=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,Vt(this.hot.rootElement,[GD,MT,YD]),this.hot.selection.isSelectedByRowHeader()&&Ge(this.hot.rootElement,YD),!(o<1||a===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(i.rowsToMove,a);if(i.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(l),c=f+o-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=i.holder.scrollLeft,s=a+o;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ld(Ou(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zD}},{key:"PLUGIN_PRIORITY",get:function(){return GPt}}]),r}(Ar);function cm(e){return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cm(e)}function KPt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qPt(n.key),n)}}function XPt(e,t,r){return t&&dte(e.prototype,t),r&&dte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qPt(e){var t=ZPt(e,"string");return cm(t)==="symbol"?t:String(t)}function ZPt(e,t){if(cm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ud(){return typeof Reflect<"u"&&Reflect.get?ud=Reflect.get.bind():ud=function(t,r,n){var i=JPt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ud.apply(this,arguments)}function JPt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eu(e),e!==null););return e}function QPt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rB(e,t)}function rB(e,t){return rB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rB(e,t)}function eIt(e){var t=rIt();return function(){var n=Eu(e),i;if(t){var a=Eu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return tIt(this,i)}}function tIt(e,t){if(t&&(cm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nB(e)}function nB(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rIt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eu(e){return Eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eu(e)}var DT="manualRowResize",nIt=30,vte="manualRowHeights",KD=new WeakMap,iIt=function(e){QPt(r,e);var t=eIt(r);function r(n){var i;KPt(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new bn(nB(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,KD.set(nB(i),{config:void 0}),Ge(i.handle,"manualRowResizer"),Ge(i.guide,"manualRowResizerGuide"),i}return XPt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[DT]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new $c,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(a,o){return i.onModifyRowHeight(a,o)}),this.bindEvents(),ud(Eu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ud(Eu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=KD.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ud(Eu(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",vte,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",vte,i),i.value}},{key:"setManualSize",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=Math.max(a,ohe.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(o,s),s}},{key:"setupHandlePosition",value:function(i){var a=this;this.currentTH=i;var o=this.hot.view,s=o._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var f=jr(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=o.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),v;h?v=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(v=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),v||(v=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){var y=this.hot.getSelectedRange();ve(y,function(b){var w=b.getTopStartCorner().row,_=b.getBottomStartCorner().row;xt(w,_,function(x){a.selectedRows.includes(x)||a.selectedRows.push(x)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(jr(this.handle),10),a=parseInt(this.handle.style[this.inlineDir],10)+i,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ge(this.handle,"active"),Ge(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(a,"px"),this.guide.style.width="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Vt(this.handle,"active"),Vt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var a,o,s=ic(i,["TH"],this.hot.rootElement);return s&&((a=i.parentNode)===null||a===void 0||(o=a.parentNode)===null||o===void 0?void 0:o.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var a=this.hot.view._wt.wtTable.getRowHeight(i);return a!==void 0&&this.newSize<a?a:this.newSize}},{key:"onMouseOver",value:function(i){if(!kW(i.target)&&this.checkIfRowHeader(i.target)){var a=this.getClosestTHParent(i.target);a&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!0);c!==void 0&&(i.newSize=c),i.setManualSize(u,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(ve(this.selectedRows,function(l){o(l)}),a()):ve(this.selectedRows,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;Wt(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var a=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),ve(this.selectedRows,function(o){a.newSize=a.setManualSize(o,a.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!1),f&&a(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(ve(this.selectedRows,function(l){o(l)}),a()):ve(this.selectedRows,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootElement,s=a.rootWindow;this.eventManager.addEventListener(o,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(o,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalRow(a),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[DT]&&l&&(o=l)}return o}},{key:"onMapInit",value:function(){var i=this,a=KD.get(this),o=this.hot.getSettings()[DT],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(o)?(o.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}),a.config=o):o===!0&&Array.isArray(a.config)&&a.config.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){ud(Eu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DT}},{key:"PLUGIN_PRIORITY",get:function(){return nIt}}]),r}(Ar);function RS(e){return RS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RS(e)}var pte,gte,yte,mte;function $T(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function aIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sIt(n.key),n)}}function oIt(e,t,r){return t&&bte(e.prototype,t),r&&bte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sIt(e){var t=lIt(e,"string");return RS(t)==="symbol"?t:String(t)}function lIt(e,t){if(RS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(RS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uIt=function(){function e(t,r,n,i,a,o){aIt(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=a,this.cellRangeFactory=o}return oIt(e,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],a=n+Math.abs(r[0]||r[1])-1,o=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,a),u=Math.max(n,a),f=this[s],c=this[s]+this[o]-1;if(f>=n&&(this[s]+=i),i>0)n<=c&&n>f&&(this[o]+=i);else if(i<0){if(l<=f&&u>=c)return this.removed=!0,!1;if(f>=l&&f<=u){var h=u-f+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(f<=l&&c>=u)this[o]+=i;else if(f<=l&&c>=l&&c<u){var v=c-l+1;this[o]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Wr(pte||(pte=$T(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Wr(gte||(gte=$T(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Wr(yte||(yte=$T(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Wr(mte||(mte=$T(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),e}();const sl=uIt;function iB(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function kS(e){return kS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kS(e)}var wte;function fIt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _te(e){return vIt(e)||dIt(e)||hIt(e)||cIt()}function cIt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hIt(e,t){if(e){if(typeof e=="string")return aB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aB(e,t)}}function dIt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vIt(e){if(Array.isArray(e))return aB(e)}function aB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ste(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yIt(n.key),n)}}function gIt(e,t,r){return t&&Ste(e.prototype,t),r&&Ste(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yIt(e){var t=mIt(e,"string");return kS(t)==="symbol"?t:String(t)}function mIt(e,t){if(kS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bIt=function(){function e(t){pIt(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return gIt(e,[{key:"get",value:function(r,n){var i=this.mergedCells,a=!1;return ve(i,function(o){return o.row<=r&&o.row+o.rowspan-1>=r&&o.col<=n&&o.col+o.colspan-1>=n?(a=o,!1):!0}),a}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return ve(n,function(a){return a.row<=r.from.row&&a.row+a.rowspan-1>=r.to.row&&a.col<=r.from.col&&a.col+a.colspan-1>=r.to.col?(i=a,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCells,o=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return ve(a,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);i?s.overlaps(d)&&o.push(f):s.includesRange(d)&&o.push(f)}),o.length?o:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,a=r.col,o=r.rowspan,s=r.colspan,l=new sl(i,a,o,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(i,a),f=this.isOverlapping(l);return!u&&!f?(this.hot&&l.normalize(this.hot),n.push(l),l):(Kr(e.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,a=this.get(r,n),o=a?this.mergedCells.indexOf(a):-1;return a&&o!==-1?(i.splice(o,1),a):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],a=[];ve(n,function(o){var s=r.hot.getCell(o.row,o.col);s&&i.push([s,r.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,ve(i,function(o,s){xt(0,o.rowspan-1,function(l){xt(0,o.colspan-1,function(u){if(u!==0||l!==0){var f=r.hot.getCell(o.row+l,o.col+u);f&&a.push([f,null,null,null])}})}),i[s][1]=null}),ve(i,function(o){iB.apply(void 0,_te(o))}),ve(a,function(o){iB.apply(void 0,_te(o))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),a=!1;return ve(this.mergedCells,function(o){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(o.row,o.col),n.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1));return s.overlaps(i)?(a=!0,!1):!0}),a}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var a=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(a,o)}},{key:"shiftCollections",value:function(r,n,i){var a=this,o=[0,0];switch(r){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break}ve(this.mergedCells,function(s){s.shift(o,n)}),XE(this.mergedCells.length-1,0,function(s){var l=a.mergedCells[s];l&&l.removed&&a.mergedCells.splice(a.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Wr(wte||(wte=fIt(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const wIt=bIt;function AS(e){return AS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AS(e)}function Rh(e,t){return xIt(e)||CIt(e,t)||SIt(e,t)||_It()}function _It(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SIt(e,t){if(e){if(typeof e=="string")return Cte(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cte(e,t)}}function Cte(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CIt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function xIt(e){if(Array.isArray(e))return e}function TIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EIt(n.key),n)}}function OIt(e,t,r){return t&&xte(e.prototype,t),r&&xte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EIt(e){var t=RIt(e,"string");return AS(t)==="symbol"?t:String(t)}function RIt(e,t){if(AS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(AS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kIt=function(){function e(t){TIt(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return OIt(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,a){var o=n.slice(0),s=this.getAutofillSize(r,n,i),l=Rh(r,4),u=l[0],f=l[1],c=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,v=d?c-u+1:h-f+1,g=Math.floor(s/v)*v,y=s-g,b=this.getFarthestCollection(r,n,i,a);if(b){if(i==="down"){var w=b.row+b.rowspan-u-y,_=o[2]+w;_>=this.plugin.hot.countRows()?o[2]-=y:o[2]+=y?w:0}else if(i==="right"){var x=b.col+b.colspan-f-y,E=o[3]+x;E>=this.plugin.hot.countCols()?o[3]-=y:o[3]+=y?x:0}else if(i==="up"){var R=c-y-b.row+1,A=o[0]+R;A<0?o[0]+=y:o[0]-=y?R:0}else if(i==="left"){var N=h-y-b.col+1,I=o[1]+N;I<0?o[1]+=y:o[1]-=y?N:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:a,fillSize:s,dragArea:o,cycleLength:v}),o}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),zn(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var a=Rh(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=Rh(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return o-c;case"down":return d-l;case"left":return s-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,i){var a=Rh(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=Rh(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return[c,h,o-1,u];case"down":return[l+1,s,d,u];case"left":return[c,h,l,s-1];case"right":return[o,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,a){var o=Rh(r,4),s=o[0],l=o[1],u=o[2],f=o[3],c=["up","down"].indexOf(i)>-1,h=c?u:f,d=c?s:l,v=this.getAutofillSize(r,n,i),g=c?u-s+1:f-l+1,y=Math.floor(v/g)*g,b=v-y,w=null,_=null,x=null;switch(i){case"up":w="includesVertically",x=h-b+1;break;case"left":w="includesHorizontally",x=h-b+1;break;case"down":w="includesVertically",x=d+b-1;break;case"right":w="includesHorizontally",x=d+b-1;break}return ve(a,function(E){E[w](x)&&E.isFarther(_,i)&&(_=E)}),_}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,a=this.currentFillData.dragDirection,o=function(h,d){switch(a){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var f=0;f<i.length;f+=1){if(l=i[f],s=u*this.currentFillData.cycleLength,o(l,s))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}f===i.length-1&&(u+=1)}while(o(l,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},a={min:null,max:null};return ve(r,function(o){var s=o[0],l=n.plugin.hot.propToCol(o[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(a.min===null||l<a.min)&&(a.min=l),(a.max===null||l>a.max)&&(a.max=l)}),{from:{row:i.min,column:a.min},to:{row:i.max,column:a.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var a=this.getDragArea(r,n,i),o=Rh(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.plugin.hot._createCellCoords(s,l),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const AIt=kIt;function PS(e){return PS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PS(e)}function PIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MIt(n.key),n)}}function IIt(e,t,r){return t&&Tte(e.prototype,t),r&&Tte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MIt(e){var t=DIt(e,"string");return PS(t)==="symbol"?t:String(t)}function DIt(e,t){if(PS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(PS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $It=function(){function e(t){PIt(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return IIt(e,[{key:"snapDelta",value:function(r,n,i){var a=n.to,o=a.row+r.row,s=a.col+r.col;r.row?this.jumpOverMergedCell(r,i,o):r.col&&this.jumpOverMergedCell(r,i,s)}},{key:"jumpOverMergedCell",value:function(r,n,i){var a=r.row||r.col,o=null,s=null,l=null;r.row?(o=n.includesVertically(i),s=n.row,l=n.getLastRow()):r.col&&(o=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),a!==0&&(a>0?o&&i!==s&&(a+=l-i+1):o&&i!==l&&(a-=i-s+1),r.row?r.row=a:r.col&&(r.col=a))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,a){var o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(a!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=o<=c.row&&s<=c.col&&l>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(a);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var a=0;a<r.rowspan;a+=1)for(var o=0;o<r.colspan;o+=1)i.push(this.hot._createCellCoords(r.row+a,r.col+o));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const NIt=$It;function LIt(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(CV)}return this.getTranslatedPhrase(SV)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=sl.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function hm(e){return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hm(e)}function FIt(e,t){return WIt(e)||BIt(e,t)||Ape(e,t)||HIt()}function HIt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BIt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function WIt(e){if(Array.isArray(e))return e}function VIt(e){return zIt(e)||jIt(e)||Ape(e)||UIt()}function UIt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ape(e,t){if(e){if(typeof e=="string")return oB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oB(e,t)}}function jIt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zIt(e){if(Array.isArray(e))return oB(e)}function oB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GIt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ote(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KIt(n.key),n)}}function YIt(e,t,r){return t&&Ote(e.prototype,t),r&&Ote(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KIt(e){var t=XIt(e,"string");return hm(t)==="symbol"?t:String(t)}function XIt(e,t){if(hm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sg(){return typeof Reflect<"u"&&Reflect.get?sg=Reflect.get.bind():sg=function(t,r,n){var i=qIt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},sg.apply(this,arguments)}function qIt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pc(e),e!==null););return e}function ZIt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sB(e,t)}function sB(e,t){return sB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sB(e,t)}function JIt(e){var t=eMt();return function(){var n=pc(e),i;if(t){var a=pc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return QIt(this,i)}}function QIt(e,t){if(t&&(hm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ppe(e)}function Ppe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eMt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pc(e){return pc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pc(e)}pt.getSingleton().register("beforeMergeCells");pt.getSingleton().register("afterMergeCells");pt.getSingleton().register("beforeUnmergeCells");pt.getSingleton().register("afterUnmergeCells");var Eb="mergeCells",tMt=150,Ete=new WeakMap,Rte=Eb,rMt=function(e){ZIt(r,e);var t=JIt(r);function r(n){var i;return GIt(this,r),i=t.call(this,n),Ete.set(Ppe(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return YIt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Eb]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new wIt(this),this.autofillCalculations=new AIt(this),this.selectionCalculations=new NIt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(a,o){if(o==="MergeCells")return!1}),this.registerShortcuts(),sg(pc(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),sg(pc(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[Eb];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),sg(pc(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(tW()){var a=[],o=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,f=l+1;f<l+u;f++)o.push(f)}),o=VIt(new Set(o)),o.forEach(function(s){var l=i.hot.rowIndexMapper.getRenderableFromVisualIndex(s);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(l);f&&(f.style.background=Tg(f,"backgroundColor").replace(")",", 0.99)"),a.push(f))})}),this.hot._registerTimeout(function(){a.forEach(function(s){s.style.background=Tg(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var a=!0;return i?(sl.containsNegativeValues(i)?(Kr(sl.NEGATIVE_VALUES_WARNING(i)),a=!1):sl.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(Kr(sl.IS_OUT_OF_BOUNDS_WARNING(i)),a=!1):sl.isSingleCell(i)?(Kr(sl.IS_SINGLE_CELL(i)),a=!1):sl.containsZeroSpan(i)&&(Kr(sl.ZERO_SPAN_WARNING(i)),a=!1),a):!1}},{key:"generateFromSettings",value:function(i){var a=this;if(Array.isArray(i)){var o=[];if(ve(i,function(s){if(a.validateSetting(s)){var l=a.hot._createCellCoords(s.row,s.col),u=a.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),f=a.hot._createCellRange(l,l,u);a.mergeRange(f,!0,!0),xt(s.row,s.row+s.rowspan-1,function(c){xt(s.col,s.col+s.colspan-1,function(h){c===s.row&&h===s.col||o.push([c,h,null])})})}}),o.length===0)return;this.hot.setDataAtCell(o)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return a?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.toggleMerge(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){var a=i.from,o=i.to;this.unmergeRange(i,!0),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopStartCorner(),u=i.getBottomEndCorner(),f={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},c=[],h=null;if(!this.canMergeRange(f,o))return!1;this.hot.runHooks("beforeMergeCells",i,o),xt(0,f.rowspan-1,function(v){xt(0,f.colspan-1,function(g){var y=null;c[v]||(c[v]=[]),v===0&&g===0?y=a.hot.getSourceDataAtCell(a.hot.toPhysicalRow(f.row),a.hot.toPhysicalColumn(f.col)):a.hot.setCellMeta(f.row+v,f.col+g,"hidden",!0),c[v][g]=y})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(s?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),o||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,f,o),h):!0}},{key:"unmergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);s&&(this.hot.runHooks("beforeUnmergeCells",i,o),ve(s,function(l){a.mergedCellsCollection.remove(l.row,l.col),xt(0,l.rowspan-1,function(u){xt(0,l.colspan-1,function(f){a.hot.removeCellMeta(l.row+u,l.col+f,"hidden")})}),a.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,o),this.hot.render())}},{key:"toggleMerge",value:function(i){var a=this.mergedCellsCollection.get(i.from.row,i.from.col),o=a.row===i.from.row&&a.col===i.from.col&&a.row+a.rowspan-1===i.to.row&&a.col+a.colspan-1===i.to.col;o?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Eb]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("grid");o.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(l){return!l.altKey},group:Rte})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("grid");a.removeShortcutsByGroup(Rte)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var a=this.mergedCellsCollection.mergedCells,o=this.hot.getSelectedRangeLast(),s=0;s<a.length;s+=1)if(o.from.row===a[s].row&&o.from.col===a[s].col&&o.to.row===a[s].row+a[s].rowspan-1&&o.to.col===a[s].col+a[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var a=Ete.get(this),o=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,u=this.hot._createCellCoords(o.highlight.row,o.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(a.lastDesiredCoords||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(a.lastDesiredCoords)||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=a.lastDesiredCoords.row?a.lastDesiredCoords.row-u.row:s.row,s.col=a.lastDesiredCoords.col?a.lastDesiredCoords.col-u.col:s.col,i.row>0?s.row=f.row+f.rowspan-1-u.row+i.row:i.row<0&&(s.row=u.row-f.row+i.row),i.col>0?s.col=f.col+f.colspan-1-u.col+i.col:i.col<0&&(s.col=u.col-f.col+i.col)}l=this.hot._createCellCoords(o.highlight.row+s.row,o.highlight.col+s.col);var v=this.mergedCellsCollection.get(l.row,l.col);if(v){var g=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);a.lastDesiredCoords=l,s={row:g.row-u.row,col:g.col-u.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var a=this,o=this.hot.getSelectedRangeLast(),s=ca(i),l=this.selectionCalculations.getUpdatedSelectionRange(o,i),u=ca(s),f=this.mergedCellsCollection.getWithinRange(l,!0);do u=ca(s),this.selectionCalculations.getUpdatedSelectionRange(o,s),ve(f,function(c){a.selectionCalculations.snapDelta(s,o,c)});while(s.row!==u.row||s.col!==u.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,a){if(!(i<0||a<0)){var o=this.mergedCellsCollection.get(i,a);if(o){var s=o.row,l=o.col,u=o.colspan,f=o.rowspan;return[s,l,s+f-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},LIt(this))}},{key:"onAfterRenderer",value:function(i,a,o){var s=this.mergedCellsCollection.get(a,o),l=rr(s)?ca(s):void 0;if(rr(l)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=l.row,d=l.col,v=l.colspan,g=l.rowspan,y=this.translateMergedCellToRenderable(h,g,d,v),b=FIt(y,2),w=b[0],_=b[1],x=f.getRenderableFromVisualIndex(a),E=c.getRenderableFromVisualIndex(o),R=w-x+1,A=_-E+1;l.row=f.getNearestNotHiddenIndex(l.row,1),l.col=c.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,R),l.colspan=Math.min(l.colspan,A)}iB(i,l,a,o)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var a=this.mergedCellsCollection.get(i.row,i.col),o=[a.row,a.col];i.row=o[0],i.col=o[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var a=this.hot.getSelectedRangeLast();a.highlight=this.hot._createCellCoords(a.highlight.row,a.highlight.col),a.to=i;var o=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{o=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();a.expandByRange(u)&&(i.row=a.to.row,i.col=a.to.col,o=!0)}}while(o)}},{key:"onAfterGetCellMeta",value:function(i,a,o){var s=this.mergedCellsCollection.get(i,a);s&&(s.row!==i||s.col!==a?o.copyable=!1:(o.rowspan=s.rowspan,o.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var a=this.hot.countCols();this.modifyViewportRowStart(i,a),this.modifyViewportRowEnd(i,a)}},{key:"modifyViewportRowStart",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.startRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(rr(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.row,1));if(f<i.startRow){i.startRow=f,this.modifyViewportRowStart(i,a);return}}}}},{key:"modifyViewportRowEnd",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.endRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(rr(u)){var f=u.row+u.rowspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endRow){i.endRow=c,this.modifyViewportRowEnd(i,a);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var a=this.hot.countRows();this.modifyViewportColumnStart(i,a),this.modifyViewportColumnEnd(i,a)}},{key:"modifyViewportColumnStart",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.startColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(rr(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.col,1));if(f<i.startColumn){i.startColumn=f,this.modifyViewportColumnStart(i,a);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.endColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(rr(u)){var f=u.col+u.colspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endColumn){i.endColumn=c,this.modifyViewportColumnEnd(i,a);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,a,o,s){var l=this.hot,u=l.rowIndexMapper,f=l.columnIndexMapper,c,h;a===0?c=u.getNearestNotHiddenIndex(i,1):c=u.getNearestNotHiddenIndex(i+a-1,-1),s===0?h=f.getNearestNotHiddenIndex(o,1):h=f.getNearestNotHiddenIndex(o+s-1,-1);var d=i>=0?u.getRenderableFromVisualIndex(c):i,v=o>=0?f.getRenderableFromVisualIndex(h):o;return[d,v]}},{key:"onModifyAutofillRange",value:function(i,a){this.autofillCalculations.correctSelectionAreaSize(a);var o=this.autofillCalculations.getDirection(a,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(a,s,o))return s=a,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:a[0],col:a[1]},to:{row:a[2],col:a[3]}});return l&&(s=this.autofillCalculations.snapDragArea(a,s,o,l)),s}},{key:"onAfterCreateCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("right",i,a)}},{key:"onAfterRemoveCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("left",i,a)}},{key:"onAfterCreateRow",value:function(i,a,o){o!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,a)}},{key:"onAfterRemoveRow",value:function(i,a){this.mergedCellsCollection.shiftCollections("up",i,a)}},{key:"onAfterChange",value:function(i,a){a==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,a){if(a&&a==="area"){var o=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(o);ve(s,function(l){o.getBottomEndCorner().row===l.getLastRow()&&o.getBottomEndCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,a,o){if(this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(s){var l=a>0,u=a<0,f=o<0,c=o>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,v=s.col+s.colspan-1===this.hot.countCols()-1,g=s.col===0;(l&&h||u&&d||c&&v||f&&g)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,a,o,s){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(i,a,o,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Eb}},{key:"PLUGIN_PRIORITY",get:function(){return tMt}}]),r}(Ar);function kte(e){return oMt(e)||aMt(e)||iMt(e)||nMt()}function nMt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iMt(e,t){if(e){if(typeof e=="string")return Ate(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ate(e,t)}}function Ate(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aMt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oMt(e){if(Array.isArray(e))return e}function sMt(e,t){return function(r,n){var i=kte(r),a=i.slice(1),o=kte(n),s=o.slice(1);return function l(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.multiColumnSorting,g=v.compareFunctionFactory?v.compareFunctionFactory:pve(c.type),y=g(f,c,v)(h,d);if(y===ml){var b=u+1;if(typeof t[b]<"u")return l(b)}return y}(0)}}var Pte;function lMt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ite(){Kr(Wr(Pte||(Pte=lMt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Ipe="sort";function uMt(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(Ipe,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function fMt(e){var t=e.className.split(" "),r=new RegExp("^".concat(Ipe,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function dm(e){return dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dm(e)}function cMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dMt(n.key),n)}}function hMt(e,t,r){return t&&Mte(e.prototype,t),r&&Mte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dMt(e){var t=vMt(e,"string");return dm(t)==="symbol"?t:String(t)}function vMt(e,t){if(dm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Za(){return typeof Reflect<"u"&&Reflect.get?Za=Reflect.get.bind():Za=function(t,r,n){var i=pMt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Za.apply(this,arguments)}function pMt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ia(e),e!==null););return e}function gMt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lB(e,t)}function lB(e,t){return lB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lB(e,t)}function yMt(e){var t=wMt();return function(){var n=ia(e),i;if(t){var a=ia(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mMt(this,i)}}function mMt(e,t){if(t&&(dm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bMt(e)}function bMt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wMt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ia(e){return ia=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ia(e)}var uB="multiColumnSorting",_Mt=170,SMt="append",Dte="columnSorting";vve(uB,sMt);var CMt=function(e){gMt(r,e);var t=yMt(r);function r(n){var i;return cMt(this,r),i=t.call(this,n),i.pluginKey=uB,i}return hMt(r,[{key:"isEnabled",value:function(){return Za(ia(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Dte]&&Ite(),Za(ia(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Za(ia(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){Za(ia(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){Za(ia(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Za(ia(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return Za(ia(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){Za(ia(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=Za(ia(r.prototype),"updateHeaderClasses",this)).call.apply(a,[this,i].concat(s)),Vt(i,fMt(i)),this.enabled!==!1&&Ge(i,uMt.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Dte]&&Ite(),Za(ia(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,a){oH(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(a.col),this.sort(this.getNextSortConfig(a.col,SMt))):this.sort(this.getColumnNextConfig(a.col)))}}],[{key:"PLUGIN_KEY",get:function(){return uB}},{key:"PLUGIN_PRIORITY",get:function(){return _Mt}}]),r}(yve);function vm(e){return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vm(e)}function xMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OMt(n.key),n)}}function TMt(e,t,r){return t&&$te(e.prototype,t),r&&$te(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OMt(e){var t=EMt(e,"string");return vm(t)==="symbol"?t:String(t)}function EMt(e,t){if(vm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qO(){return typeof Reflect<"u"&&Reflect.get?qO=Reflect.get.bind():qO=function(t,r,n){var i=RMt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},qO.apply(this,arguments)}function RMt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pm(e),e!==null););return e}function kMt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fB(e,t)}function fB(e,t){return fB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fB(e,t)}function AMt(e){var t=MMt();return function(){var n=pm(e),i;if(t){var a=pm(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return PMt(this,i)}}function PMt(e,t){if(t&&(vm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IMt(e)}function IMt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MMt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pm(e){return pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pm(e)}var DMt="multipleSelectionHandles",$Mt=160,NMt=function(e){kMt(r,e);var t=AMt(r);function r(n){var i;return xMt(this,r),i=t.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return TMt(r,[{key:"isEnabled",value:function(){return Es()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new bn(this)),this.registerListeners(),qO(pm(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,a=this,o=this.hot.rootElement;function s(l){if(a.dragged.length===1)return a.dragged.splice(0,a.dragged.length),!0;var u=a.dragged.indexOf(l);if(u===-1)return!1;u===0?a.dragged=a.dragged.slice(0,1):u===1&&(a.dragged=a.dragged.slice(-1))}this.eventManager.addEventListener(o,"touchstart",function(l){var u;if(Wt(l.target,"topSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("top"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(Wt(l.target,"bottomSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("bottom"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchend",function(l){if(Wt(l.target,"topSelectionHandle-HitArea"))return s.call(a,"top"),a.touchStartRange=void 0,l.preventDefault(),!1;if(Wt(l.target,"bottomSelectionHandle-HitArea"))return s.call(a,"bottom"),a.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchmove",function(l){var u=i.hot.rootDocument,f,c,h,d,v,g;if(a.dragged.length!==0){var y=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!y||y===a.lastSetCell||((y.nodeName==="TD"||y.nodeName==="TH")&&(f=a.hot.getCoords(y),f.col===-1&&(f.col=0),c=a.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&a.hot.selection.setRangeEnd(f),g=a.getCurrentRangeCoords(c,f,a.touchStartRange.direction,v,a.dragged[0]),g.start!==null&&a.hot.selection.setRangeStart(g.start),a.hot.selection.setRangeEnd(g.end),a.lastSetCell=y),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,a,o,s,l){var u=i.getTopStartCorner(),f=i.getBottomEndCorner(),c=i.getBottomStartCorner(),h=i.getTopEndCorner(),d={start:null,end:null};switch(o){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?d={start:this.hot._createCellCoords(a.row,i.highlight.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,u.col)};break;case"SE-NW":l==="bottom"&&(d={start:this.hot._createCellCoords(f.row,a.col),end:this.hot._createCellCoords(a.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?d={start:a,end:c}:d.end=a;break;case"NW-SE":l==="top"?d={start:a,end:f}:d.end=a;break;case"SE-NW":l==="top"?d={start:a,end:u}:d.end=a;break;case"SW-NE":l==="top"?d={start:a,end:h}:d.end=a;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(u.row,a.col),end:this.hot._createCellCoords(a.row,f.col)};break;case"SW-NE":l==="top"?d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,f.col)}:d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(u.row,a.col)};break;case"SE-NW":l==="bottom"?d={start:this.hot._createCellCoords(a.row,h.col),end:this.hot._createCellCoords(u.row,a.col)}:l==="top"&&(d={start:c,end:a});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(d.end=a);break;case"SE-NW":l==="top"?d.end=a:d={start:a,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return DMt}},{key:"PLUGIN_PRIORITY",get:function(){return $Mt}}]),r}(Ar);function cB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,i=n===void 0?1:n,a=e.origColspan,o=a===void 0?1:a,s=e.collapsible,l=s===void 0?!1:s,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,g=e.isRoot,y=g===void 0?!1:g,b=e.isPlaceholder,w=b===void 0?!1:b;return{label:r,colspan:i,origColspan:o,collapsible:l,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:y,isPlaceholder:w}}function Mpe(){return{label:"",isPlaceholder:!0}}function Nte(e){return BMt(e)||HMt(e)||FMt(e)||LMt()}function LMt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FMt(e,t){if(e){if(typeof e=="string")return hB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hB(e,t)}}function HMt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BMt(e){if(Array.isArray(e))return hB(e)}function hB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WMt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;ve(e,function(i){var a=[],o=0;r.push(a),ve(i,function(s){var l=cB();if(rr(s)){var u=s.label,f=s.colspan;l.label=En(u),typeof f=="number"&&f>1&&(l.colspan=f,l.origColspan=f)}else l.label=En(s);o+=l.origColspan;var c=!1;if(o>=t&&(l.colspan=l.origColspan-(o-t),l.origColspan=l.colspan,c=!0),a.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)a.push(Mpe());return!c})});var n=Math.max.apply(Math,Nte(tr(r,function(i){return i.length})));return ve(r,function(i){if(i.length<n){var a=tr(new Array(n-i.length),function(){return cB()});i.splice.apply(i,[i.length,0].concat(Nte(a)))}}),r}function IS(e){return IS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},IS(e)}var VMt=["row","col"];function Lte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function UMt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lte(Object(r),!0).forEach(function(n){jMt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jMt(e,t,r){return t=Dpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zMt(e,t){if(e==null)return{};var r=GMt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GMt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function YMt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dpe(n.key),n)}}function KMt(e,t,r){return t&&Fte(e.prototype,t),r&&Fte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dpe(e){var t=XMt(e,"string");return IS(t)==="symbol"?t:String(t)}function XMt(e,t){if(IS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(IS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XD(e,t,r){qMt(e,t),t.set(e,r)}function qMt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(e,t){var r=$pe(e,t,"get");return ZMt(e,r)}function ZMt(e,t){return t.get?t.get.call(e):t.value}function fb(e,t,r){var n=$pe(e,t,"set");return JMt(e,n,r),r}function $pe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function JMt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Hte=["label","collapsible"],Kl=new WeakMap,kh=new WeakMap,qD=new WeakMap,QMt=function(){function e(){YMt(this,e),XD(this,Kl,{writable:!0,value:[]}),XD(this,kh,{writable:!0,value:0}),XD(this,qD,{writable:!0,value:1/0})}return KMt(e,[{key:"setColumnsLimit",value:function(r){fb(this,qD,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];fb(this,Kl,WMt(r,hs(this,qD))),fb(this,kh,hs(this,Kl).length)}},{key:"getData",value:function(){return hs(this,Kl)}},{key:"mergeWith",value:function(r){var n=this;ve(r,function(i){var a=i.row,o=i.col,s=zMt(i,VMt),l=n.getHeaderSettings(a,o);l!==null&&zn(l,s,Hte)})}},{key:"map",value:function(r){ve(hs(this,Kl),function(n){ve(n,function(i){var a=r(UMt({},i));rr(a)&&zn(i,a,Hte)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=hs(this,kh)||r<0)return null;var a=hs(this,Kl)[r];return n>=a.length?null:(i=a[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=[];if(r>=hs(this,kh)||r<0)return a;for(var o=hs(this,Kl)[r],s=0,l=n;l<o.length;l++){var u=o[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,a.push(u),u.colspan>1&&(l+=u.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return a}},{key:"getLayersCount",value:function(){return hs(this,kh)}},{key:"getColumnsCount",value:function(){return hs(this,kh)>0?hs(this,Kl)[0].length:0}},{key:"clear",value:function(){fb(this,Kl,[]),fb(this,kh,0)}}]),e}();function MS(e){return MS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MS(e)}function Bte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Wte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bte(Object(r),!0).forEach(function(n){ZO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Npe(n.key),n)}}function t2t(e,t,r){return t&&Vte(e.prototype,t),r&&Vte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZO(e,t,r){return t=Npe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Npe(e){var t=r2t(e,"string");return MS(t)==="symbol"?t:String(t)}function r2t(e,t){if(MS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(MS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function n2t(e){return s2t(e)||o2t(e)||a2t(e)||i2t()}function i2t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a2t(e,t){if(e){if(typeof e=="string")return dB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dB(e,t)}}function o2t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function s2t(e){if(Array.isArray(e))return dB(e)}function dB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l2t="DF-pre-order";function Lpe(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=Lpe.call(this.childs[n],e,t)}return r}var u2t="DF-post-order";function Fpe(e,t){for(var r=0;r<this.childs.length;r++){var n=Fpe.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var Hpe="BF";function f2t(e,t){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,n2t(i.childs)),e.call(t,i)!==!1&&n()}}n()}var c2t=Hpe,Ute=new Map([[l2t,Lpe],[u2t,Fpe],[Hpe,f2t]]),jte=function(){function e(t){e2t(this,e),ZO(this,"data",{}),ZO(this,"parent",null),ZO(this,"childs",[]),this.data=t}return t2t(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(Wte({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=Wte({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c2t;if(!Ute.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));Ute.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function a(o){var s=r.call(n,o);s!==!1&&o.parent!==null&&a(o.parent)};i(this)}}]),e}();function DS(e){return DS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DS(e)}function zte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zte(Object(r),!0).forEach(function(n){h2t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h2t(e,t,r){return t=Bpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d2t(e,t){return y2t(e)||g2t(e,t)||p2t(e,t)||v2t()}function v2t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p2t(e,t){if(e){if(typeof e=="string")return Yte(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yte(e,t)}}function Yte(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g2t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function y2t(e){if(Array.isArray(e))return e}function m2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bpe(n.key),n)}}function b2t(e,t,r){return t&&Kte(e.prototype,t),r&&Kte(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bpe(e){var t=w2t(e,"string");return DS(t)==="symbol"?t:String(t)}function w2t(e,t){if(DS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(DS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZD(e,t,r){_2t(e,t),t.set(e,r)}function _2t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ea(e,t){var r=Wpe(e,t,"get");return S2t(e,r)}function S2t(e,t){return t.get?t.get.call(e):t.value}function C2t(e,t,r){var n=Wpe(e,t,"set");return x2t(e,n,r),r}function Wpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function x2t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var bp=new WeakMap,Ah=new WeakMap,wp=new WeakMap,T2t=function(){function e(t){m2t(this,e),ZD(this,bp,{writable:!0,value:new Map}),ZD(this,Ah,{writable:!0,value:new Map}),ZD(this,wp,{writable:!0,value:null}),C2t(this,wp,t)}return b2t(e,[{key:"getRoots",value:function(){return Array.from(ea(this,bp).values())}},{key:"getRootByColumn",value:function(r){var n;return ea(this,Ah).has(r)&&(n=ea(this,bp).get(ea(this,Ah).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(i){var a=n-ea(this,Ah).get(n),o=0,s;return i.walkDown(function(l){var u=l.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(a>=o&&a<=o+f-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;o+=f}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;ea(this,Ah).clear(),ve(ea(this,bp),function(i){for(var a=d2t(i,2),o=a[1].data.colspan,s=n;s<n+o;s++)ea(r,Ah).set(s,n);n+=o})}},{key:"buildTree",value:function(){this.clear();for(var r=ea(this,wp).getColumnsCount(),n=0;n<r;){var i=ea(this,wp).getHeaderSettings(0,n),a=new jte;ea(this,bp).set(n,a),this.buildLeaves(a,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=ea(this,wp).getHeadersSettings(i,n,o);i+=1,ve(s,function(l){var u=Gte(Gte({},l),{},{headerLevel:i-1,columnIndex:n}),f;i===1?(r.data=u,f=r):(f=new jte(u),r.addChild(f)),i<ea(a,wp).getLayersCount()&&a.buildLeaves(f,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){ea(this,bp).clear(),ea(this,Ah).clear()}}]),e}();function Vpe(e,t){e.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(t(n.columnIndex),i.length===0))for(var a=1;a<n.colspan;a++)t(n.columnIndex+a)})}function UR(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function jR(e){return UR(e,"origColspan")===e.data.origColspan}function QU(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=jR(e);if(n)return QU(r[0]);t.isCollapsed=!1;var i=r.slice(1),a=new Set,o=0;if(i.length>0)ve(i,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;o+=h.colspan,Vpe(c,function(d){a.add(d)})});else{var s=t.colspan,l=t.origColspan,u=t.columnIndex;o=l-s;for(var f=1;f<l;f++)a.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=o,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):jR(c)&&(h.isCollapsed=UR(c,"isCollapsed"))}),{rollbackModification:function(){return ej(e)},affectedColumns:Array.from(a),colspanCompensation:o}}function ej(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=jR(e);if(i)return ej(n[0]);r.isCollapsed=!0;var a=n.slice(1),o=new Set;if(a.length>0)ve(a,function(h){Vpe(h,function(d){o.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var f=l+u;o.add(f)}var c=r.colspan-((t=UR(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):jR(h)&&(d.isCollapsed=UR(h,"isCollapsed"))}),{rollbackModification:function(){return QU(e)},affectedColumns:Array.from(o),colspanCompensation:c}}var Xte;function O2t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function E2t(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Wr(Xte||(Xte=O2t([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.push(t),a.colspan>1?a.colspan-=1:a.isHidden=!0})}}var qte;function R2t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function k2t(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Wr(qte||(qte=R2t([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.splice(a.crossHiddenColumns.indexOf(t),1),!a.isHidden&&a.colspan<a.origColspan&&(a.colspan+=1),a.isHidden=!1})}}var Zte=new Map([["collapse",ej],["expand",QU],["hide-column",E2t],["show-column",k2t]]);function A2t(e,t,r){if(!Zte.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return Zte.get(e)(t,r)}var P2t=["crossHiddenColumns"];function I2t(e,t){if(e==null)return{};var r=M2t(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function M2t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function NT(e){var t=[];return ve(e,function(r){r.walkDown(function(n){for(var i=n.data,a=i.origColspan,o=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,u=$2t(t,s),f=!1,c=o;c<o+a;c++){var h=l.includes(c);if(h||f)u.push(Mpe());else{var d=D2t(i);d.isRoot=!0,u.push(d),f=!0}}})}),t}function D2t(e){var t=cB(e);t.crossHiddenColumns;var r=I2t(t,P2t);return r}function $2t(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function $S(e){return $S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$S(e)}var N2t=["row"];function Jte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Qte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jte(Object(r),!0).forEach(function(n){L2t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L2t(e,t,r){return t=Upe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F2t(e,t){if(e==null)return{};var r=H2t(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function H2t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function B2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ere(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Upe(n.key),n)}}function W2t(e,t,r){return t&&ere(e.prototype,t),r&&ere(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Upe(e){var t=V2t(e,"string");return $S(t)==="symbol"?t:String(t)}function V2t(e,t){if($S(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($S(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JD(e,t,r){U2t(e,t),t.set(e,r)}function U2t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cb(e,t,r){var n=jpe(e,t,"set");return j2t(e,n,r),r}function j2t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Pn(e,t){var r=jpe(e,t,"get");return z2t(e,r)}function jpe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function z2t(e,t){return t.get?t.get.call(e):t.value}var nl=new WeakMap,qa=new WeakMap,Ph=new WeakMap,G2t=function(){function e(){B2t(this,e),JD(this,nl,{writable:!0,value:new QMt}),JD(this,qa,{writable:!0,value:new T2t(Pn(this,nl))}),JD(this,Ph,{writable:!0,value:[[]]})}return W2t(e,[{key:"setState",value:function(r){Pn(this,nl).setData(r);var n=!1;try{Pn(this,qa).buildTree()}catch{Pn(this,qa).clear(),Pn(this,nl).clear(),n=!0}return cb(this,Ph,NT(Pn(this,qa).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Pn(this,nl).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=tr(r,function(a){var o=a.row,s=F2t(a,N2t);return Qte({row:o<0?n.rowCoordsToLevel(o):o},s)});Pn(this,nl).mergeWith(i),Pn(this,qa).buildTree(),cb(this,Ph,NT(Pn(this,qa).getRoots()))}},{key:"mapState",value:function(r){Pn(this,nl).map(r),Pn(this,qa).buildTree(),cb(this,Ph,NT(Pn(this,qa).getRoots()))}},{key:"mapNodes",value:function(r){return Nn(Pn(this,qa).getRoots(),function(n,i){return i.walkDown(function(a){var o=r(a.data);o!==void 0&&n.push(o)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var a=Pn(this,qa).getNode(n,i),o;return a&&(o=A2t(r,a,i),cb(this,Ph,NT(Pn(this,qa).getRoots()))),o}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,a;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(a=Pn(this,Ph)[r])===null||a===void 0?void 0:a[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=Pn(this,qa).getNode(r,n);return i?Qte({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,a=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},o=a.isRoot;if(o)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},f=u.isRoot;if(f)break;s-=1}return s}},{key:"getLayersCount",value:function(){return Pn(this,nl).getLayersCount()}},{key:"getColumnsCount",value:function(){return Pn(this,nl).getColumnsCount()}},{key:"clear",value:function(){cb(this,Ph,[]),Pn(this,nl).clear(),Pn(this,qa).clear()}}]),e}();function NS(e){return NS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NS(e)}function Y2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zpe(n.key),n)}}function K2t(e,t,r){return t&&tre(e.prototype,t),r&&tre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hb(e,t,r){return t=zpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zpe(e){var t=X2t(e,"string");return NS(t)==="symbol"?t:String(t)}function X2t(e,t){if(NS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(NS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q2t=function(){function e(t,r){Y2t(this,e),hb(this,"hot",void 0),hb(this,"nestedHeaderSettingsGetter",void 0),hb(this,"layersCount",0),hb(this,"container",void 0),hb(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return K2t(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(a);this.widthsMap.setValueAtIndex(o,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,a=n.columnIndexMapper,o=i.createDocumentFragment(),s=i.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=a.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=i.createElement("tr"),h=0;h<u;h++){var d=a.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=i.createElement("th"),g=this.nestedHeaderSettingsGetter(f,d);if(g&&(!g.isPlaceholder||g.isHidden)){var y=g.label;l&&(y+='<button class="changeType"></button>'),sv(v,y),v.colSpan=g.colspan,c.appendChild(v)}}s.appendChild(c)}o.appendChild(s),r.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const Z2t=q2t;function gm(e){return gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gm(e)}var rre,nre;function ire(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function J2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function are(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gpe(n.key),n)}}function Q2t(e,t,r){return t&&are(e.prototype,t),r&&are(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fd(){return typeof Reflect<"u"&&Reflect.get?fd=Reflect.get.bind():fd=function(t,r,n){var i=eDt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},fd.apply(this,arguments)}function eDt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ru(e),e!==null););return e}function tDt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vB(e,t)}function vB(e,t){return vB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vB(e,t)}function rDt(e){var t=iDt();return function(){var n=Ru(e),i;if(t){var a=Ru(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return nDt(this,i)}}function nDt(e,t){if(t&&(gm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rb(e)}function Rb(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iDt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ru(e){return Ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ru(e)}function ore(e,t,r){return t=Gpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gpe(e){var t=aDt(e,"string");return gm(t)==="symbol"?t:String(t)}function aDt(e,t){if(gm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sre(e,t,r){oDt(e,t),t.set(e,r)}function oDt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LT(e,t,r){var n=Ype(e,t,"set");return sDt(e,n,r),r}function sDt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Cn(e,t){var r=Ype(e,t,"get");return lDt(e,r)}function Ype(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function lDt(e,t){return t.get?t.get.call(e):t.value}var lre="nestedHeaders",uDt=280,Hn=new WeakMap,Pf=new WeakMap,fDt=function(e){tDt(r,e);var t=rDt(r);function r(){var n;J2t(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),sre(Rb(n),Hn,{writable:!0,value:new G2t}),sre(Rb(n),Pf,{writable:!0,value:null}),ore(Rb(n),"ghostTable",new Z2t(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),ore(Rb(n),"detectedOverlappedHeaders",!1),n}return Q2t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[lre]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;(!Array.isArray(o)||!Array.isArray(o[0]))&&Kr(Wr(rre||(rre=ire([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),fd(Ru(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(this.hot.view){var a=this.hot.getSettings(),o=a.nestedHeaders;Cn(this,Hn).setColumnsLimit(this.hot.countCols()),Array.isArray(o)&&(this.detectedOverlappedHeaders=Cn(this,Hn).setState(o)),this.detectedOverlappedHeaders&&Kr(Wr(nre||(nre=ire([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";Cn(i,Hn).triggerColumnModification(u,l)}),!Cn(this,Pf)&&this.enabled&&LT(this,Pf,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,f=l.index,c=l.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";Cn(i,Hn).triggerColumnModification(h,f)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),fd(Ru(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Cn(this,Hn).clear(),Cn(this,Pf).unsubscribe(),LT(this,Pf,null),this.ghostTable.clear(),fd(Ru(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Cn(this,Hn)}},{key:"getLayersCount",value:function(){return Cn(this,Hn).getLayersCount()}},{key:"getHeaderSettings",value:function(i,a){return Cn(this,Hn).getHeaderSettings(i,a)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var i=this.hot.view._wt,a=i.getSetting("columnHeaders").length,o=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<a;u++){var f=o.childNodes[u];if(!f)break;for(var c=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),Vt(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),Vt(c.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),Vt(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var a=this,o=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,f=a.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(s);d===null&&(d=s),l.removeAttribute("colspan"),Vt(l,"hiddenHeader");var v=(u=Cn(a,Hn).getHeaderSettings(i,d))!==null&&u!==void 0?u:{label:""},g=v.colspan,y=v.isHidden,b=v.isPlaceholder;if(b||y)Ge(l,"hiddenHeader");else if(g>1){var w,_,x=h._wt.wtOverlays,E=(w=x.topInlineStartCornerOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(l),R=(_=x.inlineStartOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(l),A=E||R?Math.min(g,o-s):g;A>1&&l.setAttribute("colspan",A)}a.hot.view.appendColHeader(d,l,function(){return a.getColumnHeaderValue.apply(a,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,a){var o,s=(o=Cn(this,Hn).getHeaderSettings(a,i))!==null&&o!==void 0?o:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(i,a)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,a,o){var s=Cn(this,Hn).getHeaderTreeNodeData(a,i);if(!s)return i;var l=o.classNames,u=o.columnCursor,f=o.selectionType,c=o.selectionWidth,h=Cn(this,Hn).getHeaderSettings(a,i),d=h.isRoot,v=h.colspan;if(f===V1){if(!d)return s.columnIndex}else f===MA&&(v>c-u||!d)&&(l.length=0);return i}},{key:"onBeforeCopy",value:function(i,a,o){var s=o.columnHeadersCount;if(s!==0)for(var l=0;l<a.length;l++){var u=a[l],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,g=c-d+1;if(f>=0||g===1)break;for(var y=c;y<=d;y++)for(var b=f;b<=h;b++){var w,_=v+b,x=y-c;if(x!==0){var E=(w=Cn(this,Hn).getHeaderTreeNodeData(b,y))===null||w===void 0?void 0:w.isRoot;E===!1&&(i[_][x]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this._getHeaderTreeNodeDataByCoords(a);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){var o=this._getHeaderTreeNodeDataByCoords(a);if(o){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],f=o.columnIndex,c=o.origColspan,h=!s.inInSelection(a);i.shiftKey&&l?a.col<l.from.col?u.push(l.getTopEndCorner().col,f,a.row):a.col>l.from.col?u.push(l.getTopStartCorner().col,f+c-1,a.row):u.push(f,f+c-1,a.row):(xA(i)||Rc(i)&&h)&&u.push(f,f+c-1,a.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(a);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),g=h.from;s.column=!0,s.cell=!0;var y=[];a.col<g.col?y.push(v.col,f):a.col>g.col?y.push(d.col,f+c-1):y.push(f,f+c-1),(l=this.hot).selectColumns.apply(l,y)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var a=0;a<Cn(this,Hn).getLayersCount();a++)i.push(this.headerRendererFactory(a))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var a=Cn(this,Hn).getLayersCount(),o=i.startColumn,s=!!a,l=0;l<a;l++){var u=Cn(this,Hn).findLeftMostColumnIndex(l,i.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),eo(f)&&f<i.startColumn){o=f;break}}i.startColumn=s?Cn(this,Hn).getHeaderTreeNodeData(0,o).columnIndex:o}},{key:"onModifyColWidth",value:function(i,a){var o=this.ghostTable.getWidth(a);return i>o?i:o}},{key:"onModifyColumnHeaderValue",value:function(i,a,o){var s,l=(s=Cn(this,Hn).getHeaderTreeNodeData(o,a))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){LT(this,Hn,null),Cn(this,Pf)!==null&&(Cn(this,Pf).unsubscribe(),LT(this,Pf,null)),fd(Ru(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return Cn(this,Hn).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return lre}},{key:"PLUGIN_PRIORITY",get:function(){return uDt}}]),r}(Ar);function ure(e){return vDt(e)||dDt(e)||hDt(e)||cDt()}function cDt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hDt(e,t){if(e){if(typeof e=="string")return pB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pB(e,t)}}function dDt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vDt(e){if(Array.isArray(e))return pB(e)}function pB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ym(e){return ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ym(e)}function pDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yDt(n.key),n)}}function gDt(e,t,r){return t&&fre(e.prototype,t),r&&fre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yDt(e){var t=mDt(e,"string");return ym(t)==="symbol"?t:String(t)}function mDt(e,t){if(ym(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ym(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bDt=function(){function e(t,r){pDt(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return gDt(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},xt(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var a=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&ve(r.__children,function(o){a.cacheNode(o,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,a){var o=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:u,end:!0}:a!=null&&u===a?{result:l,end:!0}:(l+=1,u.__children&&ve(u.__children,function(f){if(o.parentReference.set(f,s?null:u),l=o.readTreeNodes(f,l,i,a),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return nr(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,a=r;return isNaN(a)||(a=this.getDataObject(a)),!a||!a.__children?0:(ve(a.__children,function(o){i+=1,o.__children&&(i+=n.countChildren(o))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||ym(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var a=null;r&&(a=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",a+this.countChildren(r)+1,1);var o=r;r||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var a=i,o;if(a||(a=this.mockNode()),this.hot.runHooks("beforeAddChild",r,a,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,a),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),o=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);a=this.getDataObject(o),this.hot.runHooks("afterAddChild",r,a,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),a=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(a,o+1,null);break;case"above":this.addChildAtIndex(a,o,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=null,o=[];Array.isArray(r)?(xt(r[0],r[2],function(b){var w=n.translateTrimmedRow(b);o.push(n.getDataObject(w))}),xt(0,o.length-2,function(b){n.detachFromParent(o[b],!1)}),a=o[o.length-1]):a=r;var s=this.getRowIndex(a),l=this.countChildren(a),u=this.getRowIndexWithinParent(a),f=this.getRowParent(a),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,a),u!=null){var v=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var g=this.getChild(c,this.countChildren(c)-1),y=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",y+1,l+1,this.plugin.pluginName),c.__children.push(a)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(a)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,a,this.getRowIndex(a)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var a=this,o=[];ve(i,function(s){o.push(a.getDataObject(s))}),ve(o,function(s){var l=a.getRowIndexWithinParent(s),u=a.getRowParent(s);u===null?a.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var a=this.getDataObject(r-1),o=null,s=r;if(a&&a.__children&&a.__children.length===0?(o=a,s=0):r<this.countAllRows()&&(o=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),o)if(i){var l;(l=o.__children).splice.apply(l,[s,n].concat(ure(i)))}else o.__children.splice(s,n);else if(i){var u;(u=this.data).splice.apply(u,[s,n].concat(ure(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,a){var o=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),f=r>n,c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=o||i||a?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,u[0]),s.__children.splice(l+(f&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const wDt=bDt;function LS(e){return LS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LS(e)}function cre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SDt(n.key),n)}}function _Dt(e,t,r){return t&&cre(e.prototype,t),r&&cre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SDt(e){var t=CDt(e,"string");return LS(t)==="symbol"?t:String(t)}function CDt(e,t){if(LS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(LS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var TDt=_Dt(function e(t,r){xDt(this,e),this.hot=r,this.plugin=t});const tj=TDt;function mm(e){return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mm(e)}function ODt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RDt(n.key),n)}}function EDt(e,t,r){return t&&hre(e.prototype,t),r&&hre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RDt(e){var t=kDt(e,"string");return mm(t)==="symbol"?t:String(t)}function kDt(e,t){if(mm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ADt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gB(e,t)}function gB(e,t){return gB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gB(e,t)}function PDt(e){var t=DDt();return function(){var n=zR(e),i;if(t){var a=zR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return IDt(this,i)}}function IDt(e,t){if(t&&(mm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MDt(e)}function MDt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DDt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zR(e){return zR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zR(e)}var $Dt=function(e){ADt(r,e);var t=PDt(r);function r(n,i){var a;return ODt(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsingUI=a.plugin.collapsingUI,a.rowHeaderWidthCache=null,a}return EDt(r,[{key:"appendLevelIndicators",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(o),l=this.dataManager.getDataObject(o),u=a.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(ve(c,function(g){g&&u.removeChild(g)}),Ge(a,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",xt(0,s-1,function(){var g=h.createElement("SPAN");Ge(g,r.CSS_CLASSES.emptyIndicator),u.appendChild(g)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var v=this.hot.rootDocument.createElement("DIV");Ge(a,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?Ge(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):Ge(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(i){var a=i;a||(a=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*a+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(tj);const Kpe=$Dt;function bm(e){return bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bm(e)}function dre(e){return HDt(e)||FDt(e)||LDt(e)||NDt()}function NDt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LDt(e,t){if(e){if(typeof e=="string")return yB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yB(e,t)}}function FDt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HDt(e){if(Array.isArray(e))return yB(e)}function yB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VDt(n.key),n)}}function WDt(e,t,r){return t&&vre(e.prototype,t),r&&vre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VDt(e){var t=UDt(e,"string");return bm(t)==="symbol"?t:String(t)}function UDt(e,t){if(bm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jDt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mB(e,t)}function mB(e,t){return mB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mB(e,t)}function zDt(e){var t=KDt();return function(){var n=GR(e),i;if(t){var a=GR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return GDt(this,i)}}function GDt(e,t){if(t&&(bm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YDt(e)}function YDt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KDt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function GR(e){return GR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GR(e)}var XDt=function(e){jDt(r,e);var t=zDt(r);function r(n,i){var a;return BDt(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsedRows=[],a.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;a.lastCollapsedRows=a.collapsedRows.slice(0),a.expandMultipleChildren(a.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),ve(a.lastCollapsedRows,function(f,c){f>=s&&f<l&&(a.lastCollapsedRows[c]=f+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;a.collapseMultipleChildren(a.lastCollapsedRows,s),a.lastCollapsedRows=void 0},trimStash:function(s,l){xt(s,s+l-1,function(u){var f=a.lastCollapsedRows.indexOf(u);f>-1&&a.lastCollapsedRows.splice(f,1)})}},a}return WDt(r,[{key:"collapseChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(i),f=i),this.dataManager.hasChildren(u)&&ve(u.__children,function(h){l.push(a.dataManager.getRowIndex(h))}),c=this.collapseRows(l,!0,!1),s&&this.trimRows(c),o&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ve(i,function(u){l.push.apply(l,dre(a.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),o&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],a)}},{key:"collapseRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ve(i,function(u){l.push(u),o&&a.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ve(l.__children,function(u){var f=a.dataManager.getRowIndex(u);o.push(f),a.collapseChildRows(f,o)})}s&&this.trimRows(o)}},{key:"expandRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],a)}},{key:"expandRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ve(i,function(u){l.push(u),o&&a.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ve(l.__children,function(u){if(!a.isAnyParentCollapsed(u)){var f=a.dataManager.getRowIndex(u);o.push(f),a.expandChildRows(f,o)}})}s&&this.untrimRows(o)}},{key:"expandChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(i)):(u=this.dataManager.getDataObject(i),f=i),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&ve(u.__children,function(h){var d=a.dataManager.getRowIndex(h);l.push(d)}),c=this.expandRows(l,!0,!1),s&&this.untrimRows(c),o&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ve(i,function(u){l.push.apply(l,dre(a.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),o&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ve(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.collapseMultipleChildren(o),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ve(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.expandMultipleChildren(o),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ve(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"untrimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ve(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var a=this,o=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return o===null&&(o={__children:this.dataManager.data}),this.dataManager.hasChildren(o)&&ve(o.__children,function(l){var u=a.dataManager.getRowIndex(l);if(!a.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var a=i;a!==null;){a=this.dataManager.getRowParent(a);var o=this.dataManager.getRowIndex(a);if(this.collapsedRows.indexOf(o)>-1)return!0}return!1}},{key:"toggleState",value:function(i,a){if(!(a.col>=0)){var o=this.translateTrimmedRow(a.row);Wt(i.target,Kpe.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),Ns(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(tj);const qDt=XDt;function wm(e){return wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wm(e)}function ZDt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QDt(n.key),n)}}function JDt(e,t,r){return t&&pre(e.prototype,t),r&&pre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QDt(e){var t=e$t(e,"string");return wm(t)==="symbol"?t:String(t)}function e$t(e,t){if(wm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function t$t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bB(e,t)}function bB(e,t){return bB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bB(e,t)}function r$t(e){var t=i$t();return function(){var n=YR(e),i;if(t){var a=YR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return n$t(this,i)}}function n$t(e,t){if(t&&(wm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xpe(e)}function Xpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i$t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function YR(e){return YR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YR(e)}var gre=new WeakMap,a$t=function(e){t$t(r,e);var t=r$t(r);function r(n,i){var a;return ZDt(this,r),a=t.call(this,n,i),gre.set(Xpe(a),{row_above:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"below")}}),a.dataManager=a.plugin.dataManager,a}return JDt(r,[{key:"appendOptions",value:function(i){var a=this,o=[{key:"add_child",name:function(){return this.getTranslatedPhrase(VV)},callback:function(){var l=a.dataManager.translateTrimmedRow(a.hot.getSelectedLast()[0]),u=a.dataManager.getDataObject(l);a.dataManager.addChild(u)},disabled:function(){var l=a.hot.getSelectedLast();return!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(UV)},callback:function(){a.dataManager.detachFromParent(a.hot.getSelectedLast())},disabled:function(){var l=a.hot.getSelectedLast(),u=a.dataManager.translateTrimmedRow(l[0]),f=a.dataManager.getRowParent(u);return!f||!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{name:"---------"}];return xt(0,i.items.length-1,function(s){if(s===0)return ve(o,function(l,u){i.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var a=gre.get(this);return xt(0,i.items.length-1,function(o){var s=a[i.items[o].key];s!=null&&(i.items[o].callback=s)}),i}}]),r}(tj);const o$t=a$t;function FS(e){return FS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FS(e)}var yre;function mre(e){return f$t(e)||u$t(e)||l$t(e)||s$t()}function s$t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l$t(e,t){if(e){if(typeof e=="string")return wB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wB(e,t)}}function u$t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function f$t(e){if(Array.isArray(e))return wB(e)}function wB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c$t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function h$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v$t(n.key),n)}}function d$t(e,t,r){return t&&bre(e.prototype,t),r&&bre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v$t(e){var t=p$t(e,"string");return FS(t)==="symbol"?t:String(t)}function p$t(e,t){if(FS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(FS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g$t=function(){function e(t){h$t(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return d$t(e,[{key:"onBeforeRowMove",value:function(r,n,i,a){var o=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:a});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),f=!0,c=r.map(function(y){if(!f)return!1;var b=o.dataManager.translateTrimmedRow(y);return f=o.shouldAllowMoving(b,u),b}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(l,u),g=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,g),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,a,a&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,a=r.dropIndex,o=r.movePossible,s=!1;return Yr(a)&&(Kr(Wr(yre||(yre=c$t([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,a,o,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,mre(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var a=this,o=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(s){a.dataManager.moveRow(s,n,a.movedToCollapsed,o)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,a,o=[],s=Math.max.apply(Math,mre(r))<n;r.forEach(function(l){o.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(a=this.hot).spliceCellsMeta.apply(a,[n-(s?o.length:0),0].concat(o))}},{key:"selectCells",value:function(r,n){var i=r.length,a=0,o=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[i-1]<n?u=this.dataManager.translateTrimmedRow(n-i):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);a=this.dataManager.untranslateTrimmedRow(c),o=a}else r[i-1]<n?(o=n-1,a=o-i+1):(a=n,o=a+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(a,0)),s.setRangeEnd(this.hot._createCellCoords(o,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,a){return i-a!==n})}}]),e}();function _m(e){return _m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_m(e)}function y$t(e){return _$t(e)||w$t(e)||b$t(e)||m$t()}function m$t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b$t(e,t){if(e){if(typeof e=="string")return _B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _B(e,t)}}function w$t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _$t(e){if(Array.isArray(e))return _B(e)}function _B(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x$t(n.key),n)}}function C$t(e,t,r){return t&&wre(e.prototype,t),r&&wre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x$t(e){var t=T$t(e,"string");return _m(t)==="symbol"?t:String(t)}function T$t(e,t){if(_m(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_m(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cd(){return typeof Reflect<"u"&&Reflect.get?cd=Reflect.get.bind():cd=function(t,r,n){var i=O$t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},cd.apply(this,arguments)}function O$t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ku(e),e!==null););return e}function E$t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SB(e,t)}function SB(e,t){return SB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SB(e,t)}function R$t(e){var t=A$t();return function(){var n=ku(e),i;if(t){var a=ku(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return k$t(this,i)}}function k$t(e,t){if(t&&(_m(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qpe(e)}function qpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A$t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ku(e){return ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ku(e)}var QD="nestedRows",P$t=300,Xl=new WeakMap,I$t="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",M$t=function(e){E$t(r,e);var t=R$t(r);function r(n){var i;return S$t(this,r),i=t.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,Xl.set(qpe(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return C$t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[QD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new W1),this.dataManager=new wDt(this,this.hot),this.collapsingUI=new qDt(this,this.hot),this.headersUI=new Kpe(this,this.hot),this.contextMenuUI=new o$t(this,this.hot),this.rowMoveController=new g$t(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(a){return i.onBeforeLoadData(a)}),this.addHook("beforeUpdateData",function(a){return i.onBeforeLoadData(a)}),cd(ku(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),cd(ku(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),cd(ku(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,a,o,s){return this.rowMoveController.onBeforeRowMove(i,a,o,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=Xl.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=Xl.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o){this.collapsingUI.toggleState(i,a,o)}},{key:"onModifyRowData",value:function(i){var a=Xl.get(this);if(!a.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=Xl.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,a,o){var s=Xl.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,a,o),!1)}},{key:"onFilterData",value:function(i,a,o){var s=Xl.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],a),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*a),this.dataManager.filterData(i,a,o),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,a){this.headersUI.appendLevelIndicators(i,a)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(s!==this.pluginName){var u=Xl.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=Array.from(o.reduce(function(u,f){if(s.dataManager.isParent(f)){var c=s.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));o.length=0,o.push.apply(o,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,a){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(a)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,a,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,y$t(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,a){var o=Xl.get(this);o.skipRender&&(a.skipRender=!0)}},{key:"destroy",value:function(){cd(ku(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!Jhe(i)){IW(I$t),this.hot.getSettings()[QD]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return QD}},{key:"PLUGIN_PRIORITY",get:function(){return P$t}}]),r}(Ar);function HS(e){return HS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HS(e)}function D$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N$t(n.key),n)}}function $$t(e,t,r){return t&&_re(e.prototype,t),r&&_re(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N$t(e){var t=L$t(e,"string");return HS(t)==="symbol"?t:String(t)}function L$t(e,t){if(HS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(HS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var F$t=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;D$t(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return $$t(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,a=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return a===null?void 0:JSON.parse(a)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;ve(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const H$t=F$t;function Sm(e){return Sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sm(e)}function B$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V$t(n.key),n)}}function W$t(e,t,r){return t&&Sre(e.prototype,t),r&&Sre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V$t(e){var t=U$t(e,"string");return Sm(t)==="symbol"?t:String(t)}function U$t(e,t){if(Sm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hd(){return typeof Reflect<"u"&&Reflect.get?hd=Reflect.get.bind():hd=function(t,r,n){var i=j$t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},hd.apply(this,arguments)}function j$t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Au(e),e!==null););return e}function z$t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CB(e,t)}function CB(e,t){return CB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CB(e,t)}function G$t(e){var t=X$t();return function(){var n=Au(e),i;if(t){var a=Au(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Y$t(this,i)}}function Y$t(e,t){if(t&&(Sm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K$t(e)}function K$t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X$t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Au(e){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Au(e)}pt.getSingleton().register("persistentStateSave");pt.getSingleton().register("persistentStateLoad");pt.getSingleton().register("persistentStateReset");var Cre="persistentState",q$t=0,Z$t=function(e){z$t(r,e);var t=G$t(r);function r(n){var i;return B$t(this,r),i=t.call(this,n),i.storage=void 0,i}return W$t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Cre]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new H$t(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(a,o){return i.saveValue(a,o)}),this.addHook("persistentStateLoad",function(a,o){return i.loadValue(a,o)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),hd(Au(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,hd(Au(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),hd(Au(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,a){a.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,a){this.storage.saveValue(i,a)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){hd(Au(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Cre}},{key:"PLUGIN_PRIORITY",get:function(){return q$t}}]),r}(Ar);function Cm(e){return Cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cm(e)}function J$t(e){return rNt(e)||tNt(e)||eNt(e)||Q$t()}function Q$t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eNt(e,t){if(e){if(typeof e=="string")return xB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xB(e,t)}}function tNt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rNt(e){if(Array.isArray(e))return xB(e)}function xB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nNt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aNt(n.key),n)}}function iNt(e,t,r){return t&&xre(e.prototype,t),r&&xre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aNt(e){var t=oNt(e,"string");return Cm(t)==="symbol"?t:String(t)}function oNt(e,t){if(Cm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dd(){return typeof Reflect<"u"&&Reflect.get?dd=Reflect.get.bind():dd=function(t,r,n){var i=sNt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},dd.apply(this,arguments)}function sNt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Pu(e),e!==null););return e}function lNt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TB(e,t)}function TB(e,t){return TB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TB(e,t)}function uNt(e){var t=hNt();return function(){var n=Pu(e),i;if(t){var a=Pu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fNt(this,i)}}function fNt(e,t){if(t&&(Cm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cNt(e)}function cNt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pu(e){return Pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pu(e)}var e$="search",dNt=190,vNt="htSearchResult",pNt=function(t,r,n,i,a){t.getCellMeta(r,n).isSearchResult=a},gNt=function(t,r,n){return Yr(t)||t===null||!t.toLocaleLowerCase||t.length===0||Yr(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},yNt=function(e){lNt(r,e);var t=uNt(r);function r(n){var i;return nNt(this,r),i=t.call(this,n),i.callback=pNt,i.queryMethod=gNt,i.searchResultClass=vNt,i}return iNt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[e$]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[e$];this.updatePluginSettings(a),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),dd(Pu(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,a=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",a)}),dd(Pu(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),dd(Pu(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return xt(0,l-1,function(h){xt(0,u-1,function(d){var v=a.hot.getDataAtCell(h,d),g=a.hot.getCellMeta(h,d),y=g.search.callback||o,b=g.search.queryMethod||s,w=b(i,v,g);if(w){var _={row:h,col:d,data:v};f.push(_)}y&&y(c,h,d,v,w)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){rr(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,a,o,s,l,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,J$t(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){dd(Pu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return e$}},{key:"PLUGIN_PRIORITY",get:function(){return dNt}}]),r}(Ar);function xm(e){return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xm(e)}function mNt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tre(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wNt(n.key),n)}}function bNt(e,t,r){return t&&Tre(e.prototype,t),r&&Tre(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wNt(e){var t=_Nt(e,"string");return xm(t)==="symbol"?t:String(t)}function _Nt(e,t){if(xm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lg(){return typeof Reflect<"u"&&Reflect.get?lg=Reflect.get.bind():lg=function(t,r,n){var i=SNt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},lg.apply(this,arguments)}function SNt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=gc(e),e!==null););return e}function CNt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OB(e,t)}function OB(e,t){return OB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OB(e,t)}function xNt(e){var t=ENt();return function(){var n=gc(e),i;if(t){var a=gc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return TNt(this,i)}}function TNt(e,t){if(t&&(xm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ONt(e)}function ONt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ENt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gc(e){return gc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gc(e)}var RNt="touchScroll",kNt=200,ANt=function(e){CNt(r,e);var t=xNt(r);function r(n){var i;return mNt(this,r),i=t.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return bNt(r,[{key:"isEnabled",value:function(){return q4()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),lg(gc(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,lg(gc(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){lg(gc(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,a=i.topOverlay,o=i.bottomOverlay,s=i.inlineStartOverlay,l=i.topInlineStartCornerOverlay,u=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(a),o.clone&&this.scrollbars.push(o),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,ve(this.clones,function(i){Ge(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,ve(this.clones,function(a){Vt(a,"hide-tween"),Ge(a,"show-tween")}),this.hot._registerTimeout(function(){ve(i.clones,function(a){Vt(a,"show-tween")})},400),ve(this.scrollbars,function(a){a.refresh(),a.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return RNt}},{key:"PLUGIN_PRIORITY",get:function(){return kNt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(Ar);function Tm(e){return Tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tm(e)}function PNt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ore(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MNt(n.key),n)}}function INt(e,t,r){return t&&Ore(e.prototype,t),r&&Ore(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MNt(e){var t=DNt(e,"string");return Tm(t)==="symbol"?t:String(t)}function DNt(e,t){if(Tm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vd(){return typeof Reflect<"u"&&Reflect.get?vd=Reflect.get.bind():vd=function(t,r,n){var i=$Nt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},vd.apply(this,arguments)}function $Nt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Iu(e),e!==null););return e}function NNt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EB(e,t)}function EB(e,t){return EB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EB(e,t)}function LNt(e){var t=BNt();return function(){var n=Iu(e),i;if(t){var a=Iu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return FNt(this,i)}}function FNt(e,t){if(t&&(Tm(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HNt(e)}function HNt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(e){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iu(e)}var FT="trimRows",WNt=330,VNt=function(e){NNt(r,e);var t=LNt(r);function r(n){var i;return PNt(this,r),i=t.call(this,n),i.trimmedRowsMap=null,i}return INt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FT]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new W1),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),vd(Iu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,a=this.hot.getSettings()[FT];Array.isArray(a)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),ve(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),vd(Iu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),vd(Iu(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var a=this,o=this.getTrimmedRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeTrimRow",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ve(i,function(f){a.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",o,l,s,s&&l.length>o.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.trimRows(a)}},{key:"untrimRows",value:function(i){var a=this.getTrimmedRows(),o=this.isValidConfig(i),s=a,l=this.trimmedRowsMap.getValues().slice(),u=i.length>0;o&&u&&(ve(i,function(c){l[c]=!1}),s=Nn(l,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",a,s,o&&u);f!==!1&&(o&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",a,s,o&&u,o&&s.length<a.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.untrimRows(a)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var a=this.hot.countSourceRows();return i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a})}},{key:"onMapInit",value:function(){var i=this,a=this.hot.getSettings()[FT];Array.isArray(a)&&this.hot.batchExecution(function(){ve(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"destroy",value:function(){vd(Iu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FT}},{key:"PLUGIN_PRIORITY",get:function(){return WNt}}]),r}(Ar);function Om(e){return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Om(e)}function Zpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ere(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UNt(n.key),n)}}function Jpe(e,t,r){return t&&Ere(e.prototype,t),r&&Ere(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function UNt(e){var t=jNt(e,"string");return Om(t)==="symbol"?t:String(t)}function jNt(e,t){if(Om(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Om(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RB(e,t)}function RB(e,t){return RB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RB(e,t)}function ege(e){var t=YNt();return function(){var n=KR(e),i;if(t){var a=KR(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zNt(this,i)}}function zNt(e,t){if(t&&(Om(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GNt(e)}function GNt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YNt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function KR(e){return KR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},KR(e)}function KNt(e){return ZNt(e)||qNt(e)||rge(e)||XNt()}function XNt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qNt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZNt(e){if(Array.isArray(e))return kB(e)}function tge(e,t){return eLt(e)||QNt(e,t)||rge(e,t)||JNt()}function JNt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rge(e,t){if(e){if(typeof e=="string")return kB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kB(e,t)}}function kB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QNt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function eLt(e){if(Array.isArray(e))return e}var nge="undoRedo",tLt="undoRedo";function vt(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var i=this,a=r&&r.length;if(a){var o=r.find(function(l){var u=tge(l,4),f=u[2],c=u[3];return f!==c});if(o){var s=function(){var u=r.reduce(function(c,h){return c.push(KNt(h)),c},[]);ve(u,function(c){c[1]=e.propToCol(c[1])});var f=a>1?i.getSelected():[[u[0][0],u[0][1]]];return new vt.ChangeAction(u,f)};t.done(s,n)}}}),e.addHook("afterCreateRow",function(r,n,i){t.done(function(){return new vt.CreateRowAction(r,n)},i)}),e.addHook("beforeRemoveRow",function(r,n,i,a){var o=function(){var l=e.toPhysicalRow(r),u=Ui(t.instance.getSourceData(l,0,l+n-1,t.instance.countSourceCols()-1));return new vt.RemoveRowAction(l,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(o,a)}),e.addHook("afterCreateCol",function(r,n,i){t.done(function(){return new vt.CreateColumnAction(r,n)},i)}),e.addHook("beforeRemoveCol",function(r,n,i,a){var o=function(){var l=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];xt(l.length-1,function(g){var y=[],b=l[g];xt(u,u+(n-1),function(w){y.push(b[e.toPhysicalColumn(w)])}),f.push(y)}),xt(n-1,function(g){h.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&xt(n-1,function(g){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new vt.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(o,a)}),e.addHook("beforeCellAlignment",function(r,n,i,a){t.done(function(){return new vt.CellAlignmentAction(r,n,i,a)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new vt.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new vt.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new vt.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new vt.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}vt.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,t);if(i!==!1){var a=e(),o=this.undoneActions.slice();this.doneActions.push(a),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())}}}};vt.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=Ui(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",a),t.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};vt.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=Ui(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",a),t.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",a,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};vt.prototype.isUndoAvailable=function(){return this.doneActions.length>0};vt.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};vt.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};vt.prototype.isEnabled=function(){return this.enabled};vt.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,iLt(e),this.registerShortcuts(),e.addHook("afterChange",ige)}};vt.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,aLt(e),this.unregisterShortcuts(),e.removeHook("afterChange",ige)}};vt.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};vt.Action=function(){};vt.Action.prototype.undo=function(){};vt.Action.prototype.redo=function(){};vt.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};ef(vt.ChangeAction,vt.Action);vt.ChangeAction.prototype.undo=function(e,t){for(var r=Ui(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0),a=0,o=r.length;a<o;a++)r[a].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=tge(r[s],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};vt.ChangeAction.prototype.redo=function(e,t){for(var r=Ui(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};vt.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};ef(vt.CreateRowAction,vt.Action);vt.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};vt.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};vt.RemoveRowAction=function(e,t,r,n,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};ef(vt.RemoveRowAction,vt.Action);vt.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(a,o){Object.keys(a).forEach(function(s){var l=parseInt(s,10);i.push([r.index+o,isNaN(l)?s:l,a[s]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};vt.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};vt.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};ef(vt.CreateColumnAction,vt.Action);vt.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};vt.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};vt.RemoveColumnAction=function(e,t,r,n,i,a,o){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=a.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o};ef(vt.RemoveColumnAction,vt.Action);vt.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),a=function(h,d,v){return v[r.indexes.indexOf(i[d])]},o=this.data.length,s=[],l=0;l<o;l++)s.push(tr(this.data[l],a));var u=tr(this.headers,a),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),ve(e.getSourceDataArray(),function(c,h){ve(i,function(d,v){c[d]=s[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&ve(u,function(c,h){e.getSettings().colHeaders[i[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};vt.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};vt.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};vt.CellAlignmentAction.prototype.undo=function(e,t){var r=this;ve(this.range,function(n){n.forAll(function(i,a){i>=0&&a>=0&&e.setCellMeta(i,a,"className",r.stateBefore[i][a]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};vt.CellAlignmentAction.prototype.redo=function(e,t){Nf(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,i,a){return e.setCellMeta(r,n,i,a)}),e.addHookOnce("afterViewRender",t),e.render()};vt.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};ef(vt.FiltersAction,vt.Action);vt.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};vt.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var rLt=function(e){Qpe(r,e);var t=ege(r);function r(n,i){var a;Zpe(this,r),a=t.call(this),a.cellRange=i;var o=a.cellRange.getTopStartCorner(),s=a.cellRange.getBottomEndCorner();return a.rangeData=n.getData(o.row,o.col,s.row,s.col),a}return Jpe(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange)}}]),r}(vt.Action);vt.MergeCellsAction=rLt;var nLt=function(e){Qpe(r,e);var t=ege(r);function r(n,i){var a;return Zpe(this,r),a=t.call(this),a.cellRange=i,a}return Jpe(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0),i.render()}}]),r}(vt.Action);vt.UnmergeCellsAction=nLt;vt.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};ef(vt.RowMoveAction,vt.Action);vt.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),i=[].concat(this.rows),a=i.filter(function(f){return f>r.finalIndex}),o=i.filter(function(f){return f<=r.finalIndex}),s=a.sort(function(f,c){return c-f}).concat(o.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};vt.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};vt.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};vt.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(o){return!o.altKey},i={runOnlyIf:n,group:nge};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],i)};vt.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(nge)};function ige(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function iLt(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function aLt(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var q1=pt.getSingleton();q1.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});q1.register("beforeUndo");q1.register("afterUndo");q1.register("beforeRedo");q1.register("afterRedo");vt.PLUGIN_KEY=tLt;vt.SETTING_KEYS=!0;function oLt(){Sr(yyt),Sr(Vyt),Sr(omt),Sr(Qmt),Sr(m0t),Sr(yve),Sr(jbt),Sr(Cwt),Sr(Pve),Sr(xSt),Sr(ZSt),Sr(l1t),Sr(Uve),Sr(hCt),Sr(lRt),Sr(WRt),Sr(hkt),Sr(Lkt),Sr(oAt),Sr(KAt),Sr(aPt),Sr(YPt),Sr(iIt),Sr(rMt),Sr(CMt),Sr(NMt),Sr(fDt),Sr(M$t),Sr(Z$t),Sr(yNt),Sr(ANt),Sr(VNt),Sr(vt)}function age(){Apt(),zpt(),sgt(),xgt(),oLt()}var sLt=Nt,lLt=Kt,uLt=jk.f,fLt=lLt(function(){return!Object.getOwnPropertyNames(1)});sLt({target:"Object",stat:!0,forced:fLt},{getOwnPropertyNames:uLt});function cLt(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),i=n.data("handsontable");if(typeof r!="string"){var a=r||{};return i?i.updateSettings(a):(i=new e.Core(n[0],a),n.data("handsontable",i),i.init()),n}var o;if(i)if(typeof i[r]<"u"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];o=(s=i[r]).call.apply(s,[i].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return o})}var t$,r$,n$,i$,a$;age();cLt(It);It.__GhostTable=VU;It._getListenersCounter=dZe;It._getRegisteredMapsCounter=olt;It.EventManager=bn;var hLt=[JGe,a9e,Tot,tgt,dGe,wqe,nqe,bJe,t9e,aqe,jqe,dJe],dLt=[gqe,zqe];It.helper={};It.dom={};ve(hLt,function(e){ve(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(It.helper[t]=e[t])})});ve(dLt,function(e){ve(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(It.dom[t]=e[t])})});It.cellTypes=(t$=It.cellTypes)!==null&&t$!==void 0?t$:{};ve(Mct(),function(e){It.cellTypes[e]=EU(e)});It.cellTypes.registerCellType=bs;It.cellTypes.getCellType=EU;It.editors=(r$=It.editors)!==null&&r$!==void 0?r$:{};ve(aZe(),function(e){It.editors["".concat(La(e),"Editor")]=KE(e)});It.editors.registerEditor=Aa;It.editors.getEditor=KE;It.renderers=(n$=It.renderers)!==null&&n$!==void 0?n$:{};ve(fQe(),function(e){var t=qE(e);e==="base"&&(It.renderers.cellDecorator=t),It.renderers["".concat(La(e),"Renderer")]=t});It.renderers.registerRenderer=ol;It.renderers.getRenderer=qE;It.validators=(i$=It.validators)!==null&&i$!==void 0?i$:{};ve(dQe(),function(e){It.validators["".concat(La(e),"Validator")]=LW(e)});It.validators.registerValidator=Fp;It.validators.getValidator=LW;It.plugins=(a$=It.plugins)!==null&&a$!==void 0?a$:{};ve(NW(),function(e){It.plugins[e]=N1(e)});It.plugins["".concat(La(Ar.PLUGIN_KEY),"Plugin")]=Ar;It.plugins.registerPlugin=Sr;It.plugins.getPlugin=N1;function BS(e){return BS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BS(e)}var at;function lt(e,t,r){return t=vLt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vLt(e){var t=pLt(e,"string");return BS(t)==="symbol"?t:String(t)}function pLt(e,t){if(BS(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(BS(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ut=It.languages.dictionaryKeys,gLt=(at={languageCode:"zh-CN"},lt(at,ut.CONTEXTMENU_ITEMS_ROW_ABOVE,"上方插入行"),lt(at,ut.CONTEXTMENU_ITEMS_ROW_BELOW,"下方插入行"),lt(at,ut.CONTEXTMENU_ITEMS_INSERT_LEFT,"左方插入列"),lt(at,ut.CONTEXTMENU_ITEMS_INSERT_RIGHT,"右方插入列"),lt(at,ut.CONTEXTMENU_ITEMS_REMOVE_ROW,["移除该行","移除多行"]),lt(at,ut.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["移除该列","移除多列"]),lt(at,ut.CONTEXTMENU_ITEMS_UNDO,"撤销"),lt(at,ut.CONTEXTMENU_ITEMS_REDO,"恢复"),lt(at,ut.CONTEXTMENU_ITEMS_READ_ONLY,"只读"),lt(at,ut.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"清空该列"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT,"对齐"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"左对齐"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"水平居中"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"右对齐"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"两端对齐"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"顶端对齐"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"垂直居中"),lt(at,ut.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"底端对齐"),lt(at,ut.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"冻结该列"),lt(at,ut.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"取消冻结"),lt(at,ut.CONTEXTMENU_ITEMS_BORDERS,"边框"),lt(at,ut.CONTEXTMENU_ITEMS_BORDERS_TOP,"上"),lt(at,ut.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"右"),lt(at,ut.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"下"),lt(at,ut.CONTEXTMENU_ITEMS_BORDERS_LEFT,"左"),lt(at,ut.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"移除边框"),lt(at,ut.CONTEXTMENU_ITEMS_ADD_COMMENT,"插入批注"),lt(at,ut.CONTEXTMENU_ITEMS_EDIT_COMMENT,"编辑批注"),lt(at,ut.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"删除批注"),lt(at,ut.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"只读批注"),lt(at,ut.CONTEXTMENU_ITEMS_MERGE_CELLS,"合并"),lt(at,ut.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"取消合并"),lt(at,ut.CONTEXTMENU_ITEMS_COPY,"复制"),lt(at,ut.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,"带标题的复制"),lt(at,ut.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,"带标题组的复制"),lt(at,ut.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,"仅复制标题"),lt(at,ut.CONTEXTMENU_ITEMS_CUT,"剪切"),lt(at,ut.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"插入子行"),lt(at,ut.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"与母行分离"),lt(at,ut.CONTEXTMENU_ITEMS_HIDE_COLUMN,["隐藏该列","隐藏多列"]),lt(at,ut.CONTEXTMENU_ITEMS_SHOW_COLUMN,["显示该列","显示多列"]),lt(at,ut.CONTEXTMENU_ITEMS_HIDE_ROW,["隐藏该行","隐藏多行"]),lt(at,ut.CONTEXTMENU_ITEMS_SHOW_ROW,["显示该行","显示多行"]),lt(at,ut.FILTERS_CONDITIONS_NONE,"无"),lt(at,ut.FILTERS_CONDITIONS_EMPTY,"为空"),lt(at,ut.FILTERS_CONDITIONS_NOT_EMPTY,"不为空"),lt(at,ut.FILTERS_CONDITIONS_EQUAL,"等于"),lt(at,ut.FILTERS_CONDITIONS_NOT_EQUAL,"不等于"),lt(at,ut.FILTERS_CONDITIONS_BEGINS_WITH,"开头是"),lt(at,ut.FILTERS_CONDITIONS_ENDS_WITH,"结尾是"),lt(at,ut.FILTERS_CONDITIONS_CONTAINS,"包含"),lt(at,ut.FILTERS_CONDITIONS_NOT_CONTAIN,"不包含"),lt(at,ut.FILTERS_CONDITIONS_GREATER_THAN,"大于"),lt(at,ut.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"大于或等于"),lt(at,ut.FILTERS_CONDITIONS_LESS_THAN,"小于"),lt(at,ut.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"小于或等于"),lt(at,ut.FILTERS_CONDITIONS_BETWEEN,"在此范围"),lt(at,ut.FILTERS_CONDITIONS_NOT_BETWEEN,"不在此范围"),lt(at,ut.FILTERS_CONDITIONS_AFTER,"之后"),lt(at,ut.FILTERS_CONDITIONS_BEFORE,"之前"),lt(at,ut.FILTERS_CONDITIONS_TODAY,"今天"),lt(at,ut.FILTERS_CONDITIONS_TOMORROW,"明天"),lt(at,ut.FILTERS_CONDITIONS_YESTERDAY,"昨天"),lt(at,ut.FILTERS_VALUES_BLANK_CELLS,"空白单元格"),lt(at,ut.FILTERS_DIVS_FILTER_BY_CONDITION,"按条件过滤"),lt(at,ut.FILTERS_DIVS_FILTER_BY_VALUE,"按值过滤"),lt(at,ut.FILTERS_LABELS_CONJUNCTION,"且"),lt(at,ut.FILTERS_LABELS_DISJUNCTION,"或"),lt(at,ut.FILTERS_BUTTONS_SELECT_ALL,"全选"),lt(at,ut.FILTERS_BUTTONS_CLEAR,"清除"),lt(at,ut.FILTERS_BUTTONS_OK,"确认"),lt(at,ut.FILTERS_BUTTONS_CANCEL,"取消"),lt(at,ut.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"搜索"),lt(at,ut.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"值"),lt(at,ut.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"第二值"),at);It.languages.registerLanguageDictionary(gLt);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var oge=1252,yLt=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],rj={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},nj=function(e){yLt.indexOf(e)!=-1&&(oge=rj[0]=e)};function mLt(){nj(1252)}var ks=function(e){nj(e)};function sge(){ks(1200),mLt()}function Rre(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function bLt(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function lge(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var kb=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?bLt(e.slice(2)):t==254&&r==255?lge(e.slice(2)):t==65279?e.slice(1):e},HT=function(t){return String.fromCharCode(t)},kre=function(t){return String.fromCharCode(t)},Wf,qf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Are(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),t+=qf.charAt(a)+qf.charAt(o)+qf.charAt(s)+qf.charAt(l);return t}function fo(e){var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=qf.indexOf(e.charAt(u++)),o=qf.indexOf(e.charAt(u++)),r=a<<2|o>>4,t+=String.fromCharCode(r),s=qf.indexOf(e.charAt(u++)),n=(o&15)<<4|s>>2,s!==64&&(t+=String.fromCharCode(n)),l=qf.indexOf(e.charAt(u++)),i=(s&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var _r=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cv=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Pc(e){return _r?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Pre(e){return _r?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ts=function(t){return _r?cv(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function hv(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function ij(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ij(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Vf=_r?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:cv(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function wLt(e){for(var t=[],r=0,n=e.length+250,i=Pc(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|s>>6&15|(o&3)<<4,i[r++]=128|s&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Pc(65535),n=65530)}return t.push(i.slice(0,r)),Vf(t)}var pa=/\u0000/g,Ab=/[\u0001-\u0006]/g;function ug(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function As(e,t){var r=""+e;return r.length>=t?r:Mn("0",t-r.length)+r}function aj(e,t){var r=""+e;return r.length>=t?r:Mn(" ",t-r.length)+r}function XR(e,t){var r=""+e;return r.length>=t?r:r+Mn(" ",t-r.length)}function _Lt(e,t){var r=""+Math.round(e);return r.length>=t?r:Mn("0",t-r.length)+r}function SLt(e,t){var r=""+e;return r.length>=t?r:Mn("0",t-r.length)+r}var Ire=Math.pow(2,32);function _p(e,t){if(e>Ire||e<-Ire)return _Lt(e,t);var r=Math.round(e);return SLt(r,t)}function qR(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Mre=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],o$=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CLt(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var er={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Dre={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},xLt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ZR(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,o=1,s=0,l=1,u=0,f=0,c=Math.floor(i);u<t&&(c=Math.floor(i),s=c*o+a,f=c*u+l,!(i-c<5e-8));)i=1/(i-c),a=o,o=s,l=u,u=f;if(f>t&&(u>t?(f=l,s=a):(f=u,s=o)),!r)return[0,n*s,f];var h=Math.floor(n*s/f);return[h,n*s-h*f,f]}function pd(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],s={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,++i==86400&&(s.T=i=0,++n,++s.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=ALt(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=a,s}var uge=new Date(1899,11,31,0,0,0),TLt=uge.getTime(),OLt=new Date(1900,2,1,0,0,0);function fge(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=OLt&&(r+=24*60*60*1e3),(r-(TLt+(e.getTimezoneOffset()-uge.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function oj(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ELt(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function RLt(e){var t=e<0?12:11,r=oj(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function kLt(e){var t=oj(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function WS(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=RLt(e):t===10?r=e.toFixed(10).substr(0,12):r=kLt(e),oj(ELt(r.toUpperCase()))}function jd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):WS(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ko(14,fge(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ALt(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function PLt(e,t,r,n){var i="",a=0,o=0,s=r.y,l,u=0;switch(e){case 98:s=r.y+543;case 121:switch(t.length){case 1:case 2:l=s%100,u=2;break;default:l=s%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return o$[r.m-1][1];case 5:return o$[r.m-1][0];default:return o$[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return Mre[r.q][0];default:return Mre[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?As(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=As(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=s,u=1;break}var f=u>0?As(l,u):"";return f}function Zf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var cge=/%/g;function ILt(e,t,r){var n=t.replace(cge,""),i=t.length-n.length;return Fu(e,n,r*Math.pow(10,2*i))+Mn("%",i)}function MLt(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Fu(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function hge(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hge(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var dge=/# (\?+)( ?)\/( ?)(\d+)/;function DLt(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),o=i-a*n,s=n;return r+(a===0?"":""+a)+" "+(o===0?Mn(" ",e[1].length+1+e[4].length):aj(o,e[1].length)+e[2]+"/"+e[3]+As(s,e[4].length))}function $Lt(e,t,r){return r+(t===0?"":""+t)+Mn(" ",e[1].length+2+e[4].length)}var vge=/^#*0*\.([0#]+)/,pge=/\).*[0#]/,gge=/\(###\) ###\\?-####/;function la(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function $re(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Nre(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function NLt(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function LLt(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ao(e,t,r){if(e.charCodeAt(0)===40&&!t.match(pge)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ao("n",n,r):"("+Ao("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return MLt(e,t,r);if(t.indexOf("%")!==-1)return ILt(e,t,r);if(t.indexOf("E")!==-1)return hge(t,r);if(t.charCodeAt(0)===36)return"$"+Ao(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+_p(l,t.length);if(t.match(/^[#?]+$/))return i=_p(r,0),i==="0"&&(i=""),i.length>t.length?i:la(t.substr(0,t.length-i.length))+i;if(a=t.match(dge))return DLt(a,l,u);if(t.match(/^#+0+$/))return u+_p(l,t.length-t.indexOf("0"));if(a=t.match(vge))return i=$re(r,a[1].length).replace(/^([^\.]+)$/,"$1."+la(a[1])).replace(/\.$/,"."+la(a[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+Mn("0",la(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+$re(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Zf(_p(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ao(e,t,-r):Zf(""+(Math.floor(r)+NLt(r,a[1].length)))+"."+As(Nre(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Ao(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ug(Ao(e,t.replace(/[\\-]/g,""),r)),o=0,ug(ug(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(gge))return i=Ao(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=ZR(l,Math.pow(10,o)-1,!1),i=""+u,f=Fu("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=XR(s[2],o),f.length<a[4].length&&(f=la(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=ZR(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?aj(s[1],o)+a[2]+"/"+a[3]+XR(s[2],o):Mn(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=_p(r,0),t.length<=i.length?i:la(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return la(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=Nre(r,a[1].length),r<0?"-"+Ao(e,t,-r):Zf(LLt(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?As(0,3-v.length):"")+v})+"."+As(o,a[1].length);switch(t){case"###,##0.00":return Ao(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Zf(_p(l,0));return d!=="0"?u+d:"";case"###,###.00":return Ao(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ao(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function FLt(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Fu(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function HLt(e,t,r){var n=t.replace(cge,""),i=t.length-n.length;return Fu(e,n,r*Math.pow(10,2*i))+Mn("%",i)}function yge(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+yge(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function al(e,t,r){if(e.charCodeAt(0)===40&&!t.match(pge)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?al("n",n,r):"("+al("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return FLt(e,t,r);if(t.indexOf("%")!==-1)return HLt(e,t,r);if(t.indexOf("E")!==-1)return yge(t,r);if(t.charCodeAt(0)===36)return"$"+al(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+As(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:la(t.substr(0,t.length-i.length))+i;if(a=t.match(dge))return $Lt(a,l,u);if(t.match(/^#+0+$/))return u+As(l,t.length-t.indexOf("0"));if(a=t.match(vge))return i=(""+r).replace(/^([^\.]+)$/,"$1."+la(a[1])).replace(/\.$/,"."+la(a[1])),i=i.replace(/\.(\d*)$/,function(v,g){return"."+g+Mn("0",la(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Zf(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+al(e,t,-r):Zf(""+r)+"."+Mn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return al(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ug(al(e,t.replace(/[\\-]/g,""),r)),o=0,ug(ug(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(gge))return i=al(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=ZR(l,Math.pow(10,o)-1,!1),i=""+u,f=Fu("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=XR(s[2],o),f.length<a[4].length&&(f=la(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=ZR(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?aj(s[1],o)+a[2]+"/"+a[3]+XR(s[2],o):Mn(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:la(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return la(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+al(e,t,-r):Zf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?As(0,3-v.length):"")+v})+"."+As(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Zf(""+l);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return al(e,t.slice(0,t.lastIndexOf(".")),r)+la(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fu(e,t,r){return(r|0)===r?al(e,t,r):Ao(e,t,r)}function BLt(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var mge=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xm(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":qR(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(mge))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function WLt(e,t,r,n){for(var i=[],a="",o=0,s="",l="t",u,f,c,h="H";o<e.length;)switch(s=e.charAt(o)){case"G":if(!qR(e,o))throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(c=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(c);i[i.length]={t:"t",v:a},++o;break;case"\\":var d=e.charAt(++o),v=d==="("||d===")"?d:"t";i[i.length]={t:v,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=pd(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=pd(t,r),u==null))return"";for(a=s;++o<e.length&&e.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&l.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=h),i[i.length]={t:s,v:a},l=s;break;case"A":case"a":case"上":var g={t:s,v:s};if(u==null&&(u=pd(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",o+=5,h="h"):(g.t="t",++o),u==null&&g.t==="T")return"";i[i.length]=g,l=s;break;case"[":for(a=s;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(mge)){if(u==null&&(u=pd(t,r),u==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xm(e)||(i[i.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=s;++o<e.length&&(s=e.charAt(o))==="0";)a+=s;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<e.length&&"0#?.,E+-%".indexOf(s=e.charAt(o))>-1;)a+=s;i[i.length]={t:"n",v:a};break;case"?":for(a=s;e.charAt(++o)===s;)a+=s;i[i.length]={t:s,v:a},l=s;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"t",v:s},++o;break}var y=0,b=0,w;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,l="h",y<1&&(y=1);break;case"s":(w=i[o].v.match(/\.0+$/))&&(b=Math.max(b,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",x;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=PLt(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(x=o+1;i[x]!=null&&((s=i[x].t)==="?"||s==="D"||(s===" "||s==="t")&&i[x+1]!=null&&(i[x+1].t==="?"||i[x+1].t==="t"&&i[x+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[x].v==="/"||i[x].v===" "&&i[x+1]!=null&&i[x+1].t=="?"));)i[o].v+=i[x].v,i[x]={v:"",t:";"},++x;_+=i[o].v,o=x-1;break;case"G":i[o].t="t",i[o].v=jd(t,r);break}var E="",R,A;if(_.length>0){_.charCodeAt(0)==40?(R=t<0&&_.charCodeAt(0)===45?-t:t,A=Fu("n",_,R)):(R=t<0&&n>1?-t:t,A=Fu("n",_,R),R<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),x=A.length-1;var N=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){N=o;break}var I=i.length;if(N===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(x>=i[o].v.length-1?(x-=i[o].v.length,i[o].v=A.substr(x+1,i[o].v.length)):x<0?i[o].v="":(i[o].v=A.substr(0,x+1),x=-1),i[o].t="t",I=o);x>=0&&I<i.length&&(i[I].v=A.substr(0,x+1)+i[I].v)}else if(N!==i.length&&A.indexOf("E")===-1){for(x=A.indexOf(".")-1,o=N;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(f=i[o].v.indexOf(".")>-1&&o===N?i[o].v.indexOf(".")-1:i[o].v.length-1,E=i[o].v.substr(f+1);f>=0;--f)x>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#")&&(E=A.charAt(x--)+E);i[o].v=E,i[o].t="t",I=o}for(x>=0&&I<i.length&&(i[I].v=A.substr(0,x+1)+i[I].v),x=A.indexOf(".")+1,o=N;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==N)){for(f=i[o].v.indexOf(".")>-1&&o===N?i[o].v.indexOf(".")+1:0,E=i[o].v.substr(0,f);f<i[o].v.length;++f)x<A.length&&(E+=A.charAt(x++));i[o].v=E,i[o].t="t",I=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(R=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Fu(i[o].t,i[o].v,R),i[o].t="t");var F="";for(o=0;o!==i.length;++o)i[o]!=null&&(F+=i[o].v);return F}var Lre=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Fre(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function VLt(e,t){var r=BLt(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Lre),s=r[1].match(Lre);return Fre(t,o)?[n,r[0]]:Fre(t,s)?[n,r[1]]:[n,r[o!=null&&s!=null?2:1]]}return[n,a]}function Ko(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:er)[e],n==null&&(n=r.table&&r.table[Dre[e]]||er[Dre[e]]),n==null&&(n=xLt[e]||"General");break}if(qR(n,0))return jd(t,r);t instanceof Date&&(t=fge(t,r.date1904));var i=VLt(n,t);if(qR(i[1]))return jd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return WLt(i[1],t,r,i[0])}function Cd(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(er[r]==null){t<0&&(t=r);continue}if(er[r]==e){t=r;break}}t<0&&(t=391)}return er[t]=e,t}function bge(){er=CLt()}var ULt={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},wge=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function jLt(e){var t=typeof e=="number"?er[e]:e;return t=t.replace(wge,"(\\d+)"),new RegExp("^"+t+"$")}function zLt(e,t,r){var n=-1,i=-1,a=-1,o=-1,s=-1,l=-1;(t.match(wge)||[]).forEach(function(c,h){var d=parseInt(r[h+1],10);switch(c.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?s=d:i=d;break}}),l>=0&&s==-1&&i>=0&&(s=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&s==-1&&l==-1?u:n==-1&&i==-1&&a==-1?f:u+"T"+f}var GLt=function(){var e={};e.version="1.2.0";function t(){for(var A=0,N=new Array(256),I=0;I!=256;++I)A=I,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,N[I]=A;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function n(A){var N=0,I=0,F=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)H[F]=A[F];for(F=0;F!=256;++F)for(I=A[F],N=256+F;N<4096;N+=256)I=H[N]=I>>>8^A[I&255];var W=[];for(F=1;F!=16;++F)W[F-1]=typeof Int32Array<"u"?H.subarray(F*256,F*256+256):H.slice(F*256,F*256+256);return W}var i=n(r),a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],f=i[5],c=i[6],h=i[7],d=i[8],v=i[9],g=i[10],y=i[11],b=i[12],w=i[13],_=i[14];function x(A,N){for(var I=N^-1,F=0,H=A.length;F<H;)I=I>>>8^r[(I^A.charCodeAt(F++))&255];return~I}function E(A,N){for(var I=N^-1,F=A.length-15,H=0;H<F;)I=_[A[H++]^I&255]^w[A[H++]^I>>8&255]^b[A[H++]^I>>16&255]^y[A[H++]^I>>>24]^g[A[H++]]^v[A[H++]]^d[A[H++]]^h[A[H++]]^c[A[H++]]^f[A[H++]]^u[A[H++]]^l[A[H++]]^s[A[H++]]^o[A[H++]]^a[A[H++]]^r[A[H++]];for(F+=15;H<F;)I=I>>>8^r[(I^A[H++])&255];return~I}function R(A,N){for(var I=N^-1,F=0,H=A.length,W=0,z=0;F<H;)W=A.charCodeAt(F++),W<128?I=I>>>8^r[(I^W)&255]:W<2048?(I=I>>>8^r[(I^(192|W>>6&31))&255],I=I>>>8^r[(I^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,z=A.charCodeAt(F++)&1023,I=I>>>8^r[(I^(240|W>>8&7))&255],I=I>>>8^r[(I^(128|W>>2&63))&255],I=I>>>8^r[(I^(128|z>>6&15|(W&3)<<4))&255],I=I>>>8^r[(I^(128|z&63))&255]):(I=I>>>8^r[(I^(224|W>>12&15))&255],I=I>>>8^r[(I^(128|W>>6&63))&255],I=I>>>8^r[(I^(128|W&63))&255]);return~I}return e.table=r,e.bstr=x,e.buf=E,e.str=R,e}(),xr=function(){var t={};t.version="1.2.1";function r(j,re){for(var J=j.split("/"),ee=re.split("/"),ne=0,oe=0,Ie=Math.min(J.length,ee.length);ne<Ie;++ne){if(oe=J[ne].length-ee[ne].length)return oe;if(J[ne]!=ee[ne])return J[ne]<ee[ne]?-1:1}return J.length-ee.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var re=j.lastIndexOf("/");return re===-1?j:j.slice(0,re+1)}function i(j){if(j.charAt(j.length-1)=="/")return i(j.slice(0,-1));var re=j.lastIndexOf("/");return re===-1?j:j.slice(re+1)}function a(j,re){typeof re=="string"&&(re=new Date(re));var J=re.getHours();J=J<<6|re.getMinutes(),J=J<<5|re.getSeconds()>>>1,j.write_shift(2,J);var ee=re.getFullYear()-1980;ee=ee<<4|re.getMonth()+1,ee=ee<<5|re.getDate(),j.write_shift(2,ee)}function o(j){var re=j.read_shift(2)&65535,J=j.read_shift(2)&65535,ee=new Date,ne=J&31;J>>>=5;var oe=J&15;J>>>=4,ee.setMilliseconds(0),ee.setFullYear(J+1980),ee.setMonth(oe-1),ee.setDate(ne);var Ie=re&31;re>>>=5;var Ne=re&63;return re>>>=6,ee.setHours(re),ee.setMinutes(Ne),ee.setSeconds(Ie<<1),ee}function s(j){xi(j,0);for(var re={},J=0;j.l<=j.length-4;){var ee=j.read_shift(2),ne=j.read_shift(2),oe=j.l+ne,Ie={};switch(ee){case 21589:J=j.read_shift(1),J&1&&(Ie.mtime=j.read_shift(4)),ne>5&&(J&2&&(Ie.atime=j.read_shift(4)),J&4&&(Ie.ctime=j.read_shift(4))),Ie.mtime&&(Ie.mt=new Date(Ie.mtime*1e3));break}j.l=oe,re[ee]=Ie}return re}var l;function u(){return l||(l={})}function f(j,re){if(j[0]==80&&j[1]==75)return qt(j,re);if((j[0]|32)==109&&(j[1]|32)==105)return nt(j,re);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var J=3,ee=512,ne=0,oe=0,Ie=0,Ne=0,Pe=0,we=[],X=j.slice(0,512);xi(X,0);var Ee=c(X);switch(J=Ee[0],J){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(Ee[1]==0)return qt(j,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}ee!==512&&(X=j.slice(0,ee),xi(X,28));var Me=j.slice(0,ee);h(X,J);var ze=X.read_shift(4,"i");if(J===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);X.l+=4,Ie=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Ne=X.read_shift(4,"i"),ne=X.read_shift(4,"i"),Pe=X.read_shift(4,"i"),oe=X.read_shift(4,"i");for(var Ue=-1,Je=0;Je<109&&(Ue=X.read_shift(4,"i"),!(Ue<0));++Je)we[Je]=Ue;var St=d(j,ee);y(Pe,oe,St,ee,we);var $r=w(St,Ie,we,ee);$r[Ie].name="!Directory",ne>0&&Ne!==z&&($r[Ne].name="!MiniFAT"),$r[we[0]].name="!FAT",$r.fat_addrs=we,$r.ssz=ee;var Ut={},wn=[],ns=[],af=[];_(Ie,$r,St,wn,ne,Ut,ns,Ne),v(ns,af,wn),wn.shift();var Fc={FileIndex:ns,FullPaths:af};return re&&re.raw&&(Fc.raw={header:Me,sectors:St}),Fc}function c(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(te,"Header Signature: "),j.l+=16;var re=j.read_shift(2,"u");return[j.read_shift(2,"u"),re]}function h(j,re){var J=9;switch(j.l+=2,J=j.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function d(j,re){for(var J=Math.ceil(j.length/re)-1,ee=[],ne=1;ne<J;++ne)ee[ne-1]=j.slice(ne*re,(ne+1)*re);return ee[J-1]=j.slice(J*re),ee}function v(j,re,J){for(var ee=0,ne=0,oe=0,Ie=0,Ne=0,Pe=J.length,we=[],X=[];ee<Pe;++ee)we[ee]=X[ee]=ee,re[ee]=J[ee];for(;Ne<X.length;++Ne)ee=X[Ne],ne=j[ee].L,oe=j[ee].R,Ie=j[ee].C,we[ee]===ee&&(ne!==-1&&we[ne]!==ne&&(we[ee]=we[ne]),oe!==-1&&we[oe]!==oe&&(we[ee]=we[oe])),Ie!==-1&&(we[Ie]=ee),ne!==-1&&ee!=we[ee]&&(we[ne]=we[ee],X.lastIndexOf(ne)<Ne&&X.push(ne)),oe!==-1&&ee!=we[ee]&&(we[oe]=we[ee],X.lastIndexOf(oe)<Ne&&X.push(oe));for(ee=1;ee<Pe;++ee)we[ee]===ee&&(oe!==-1&&we[oe]!==oe?we[ee]=we[oe]:ne!==-1&&we[ne]!==ne&&(we[ee]=we[ne]));for(ee=1;ee<Pe;++ee)if(j[ee].type!==0){if(Ne=ee,Ne!=we[Ne])do Ne=we[Ne],re[ee]=re[Ne]+"/"+re[ee];while(Ne!==0&&we[Ne]!==-1&&Ne!=we[Ne]);we[ee]=-1}for(re[0]+="/",ee=1;ee<Pe;++ee)j[ee].type!==2&&(re[ee]+="/")}function g(j,re,J){for(var ee=j.start,ne=j.size,oe=[],Ie=ee;J&&ne>0&&Ie>=0;)oe.push(re.slice(Ie*W,Ie*W+W)),ne-=W,Ie=Fh(J,Ie*4);return oe.length===0?oi(0):Vf(oe).slice(0,j.size)}function y(j,re,J,ee,ne){var oe=z;if(j===z){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var Ie=J[j],Ne=(ee>>>2)-1;if(!Ie)return;for(var Pe=0;Pe<Ne&&(oe=Fh(Ie,Pe*4))!==z;++Pe)ne.push(oe);y(Fh(Ie,ee-4),re-1,J,ee,ne)}}function b(j,re,J,ee,ne){var oe=[],Ie=[];ne||(ne=[]);var Ne=ee-1,Pe=0,we=0;for(Pe=re;Pe>=0;){ne[Pe]=!0,oe[oe.length]=Pe,Ie.push(j[Pe]);var X=J[Math.floor(Pe*4/ee)];if(we=Pe*4&Ne,ee<4+we)throw new Error("FAT boundary crossed: "+Pe+" 4 "+ee);if(!j[X])break;Pe=Fh(j[X],we)}return{nodes:oe,data:Kre([Ie])}}function w(j,re,J,ee){var ne=j.length,oe=[],Ie=[],Ne=[],Pe=[],we=ee-1,X=0,Ee=0,Me=0,ze=0;for(X=0;X<ne;++X)if(Ne=[],Me=X+re,Me>=ne&&(Me-=ne),!Ie[Me]){Pe=[];var Ue=[];for(Ee=Me;Ee>=0;){Ue[Ee]=!0,Ie[Ee]=!0,Ne[Ne.length]=Ee,Pe.push(j[Ee]);var Je=J[Math.floor(Ee*4/ee)];if(ze=Ee*4&we,ee<4+ze)throw new Error("FAT boundary crossed: "+Ee+" 4 "+ee);if(!j[Je]||(Ee=Fh(j[Je],ze),Ue[Ee]))break}oe[Me]={nodes:Ne,data:Kre([Pe])}}return oe}function _(j,re,J,ee,ne,oe,Ie,Ne){for(var Pe=0,we=ee.length?2:0,X=re[j].data,Ee=0,Me=0,ze;Ee<X.length;Ee+=128){var Ue=X.slice(Ee,Ee+128);xi(Ue,64),Me=Ue.read_shift(2),ze=cj(Ue,0,Me-we),ee.push(ze);var Je={name:ze,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},St=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);St!==0&&(Je.ct=x(Ue,Ue.l-8));var $r=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);$r!==0&&(Je.mt=x(Ue,Ue.l-8)),Je.start=Ue.read_shift(4,"i"),Je.size=Ue.read_shift(4,"i"),Je.size<0&&Je.start<0&&(Je.size=Je.type=0,Je.start=z,Je.name=""),Je.type===5?(Pe=Je.start,ne>0&&Pe!==z&&(re[Pe].name="!StreamData")):Je.size>=4096?(Je.storage="fat",re[Je.start]===void 0&&(re[Je.start]=b(J,Je.start,re.fat_addrs,re.ssz)),re[Je.start].name=Je.name,Je.content=re[Je.start].data.slice(0,Je.size)):(Je.storage="minifat",Je.size<0?Je.size=0:Pe!==z&&Je.start!==z&&re[Pe]&&(Je.content=g(Je,re[Pe].data,(re[Ne]||{}).data))),Je.content&&xi(Je.content,0),oe[ze]=Je,Ie.push(Je)}}function x(j,re){return new Date((to(j,re+4)/1e7*Math.pow(2,32)+to(j,re)/1e7-11644473600)*1e3)}function E(j,re){return u(),f(l.readFileSync(j),re)}function R(j,re){var J=re&&re.type;switch(J||_r&&Buffer.isBuffer(j)&&(J="buffer"),J||"base64"){case"file":return E(j,re);case"base64":return f(Ts(fo(j)),re);case"binary":return f(Ts(j),re)}return f(j,re)}function A(j,re){var J=re||{},ee=J.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=ee+"/",j.FileIndex[0]={name:ee,type:5}),J.CLSID&&(j.FileIndex[0].clsid=J.CLSID),N(j)}function N(j){var re="Sh33tJ5";if(!xr.find(j,"/"+re)){var J=oi(4);J[0]=55,J[1]=J[3]=50,J[2]=54,j.FileIndex.push({name:re,type:2,content:J,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+re),I(j)}}function I(j,re){A(j);for(var J=!1,ee=!1,ne=j.FullPaths.length-1;ne>=0;--ne){var oe=j.FileIndex[ne];switch(oe.type){case 0:ee?J=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(oe.R*oe.L*oe.C)&&(J=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!re)){var Ie=new Date(1987,1,19),Ne=0,Pe=Object.create?Object.create(null):{},we=[];for(ne=0;ne<j.FullPaths.length;++ne)Pe[j.FullPaths[ne]]=!0,j.FileIndex[ne].type!==0&&we.push([j.FullPaths[ne],j.FileIndex[ne]]);for(ne=0;ne<we.length;++ne){var X=n(we[ne][0]);ee=Pe[X],ee||(we.push([X,{name:i(X).replace("/",""),type:1,clsid:fe,ct:Ie,mt:Ie,content:null}]),Pe[X]=!0)}for(we.sort(function(ze,Ue){return r(ze[0],Ue[0])}),j.FullPaths=[],j.FileIndex=[],ne=0;ne<we.length;++ne)j.FullPaths[ne]=we[ne][0],j.FileIndex[ne]=we[ne][1];for(ne=0;ne<we.length;++ne){var Ee=j.FileIndex[ne],Me=j.FullPaths[ne];if(Ee.name=i(Me).replace("/",""),Ee.L=Ee.R=Ee.C=-(Ee.color=1),Ee.size=Ee.content?Ee.content.length:0,Ee.start=0,Ee.clsid=Ee.clsid||fe,ne===0)Ee.C=we.length>1?1:-1,Ee.size=0,Ee.type=5;else if(Me.slice(-1)=="/"){for(Ne=ne+1;Ne<we.length&&n(j.FullPaths[Ne])!=Me;++Ne);for(Ee.C=Ne>=we.length?-1:Ne,Ne=ne+1;Ne<we.length&&n(j.FullPaths[Ne])!=n(Me);++Ne);Ee.R=Ne>=we.length?-1:Ne,Ee.type=1}else n(j.FullPaths[ne+1]||"")==n(Me)&&(Ee.R=ne+1),Ee.type=2}}}function F(j,re){var J=re||{};if(J.fileType=="mad")return ht(j,J);switch(I(j),J.fileType){case"zip":return Ht(j,J)}var ee=function(ze){for(var Ue=0,Je=0,St=0;St<ze.FileIndex.length;++St){var $r=ze.FileIndex[St];if($r.content){var Ut=$r.content.length;Ut>0&&(Ut<4096?Ue+=Ut+63>>6:Je+=Ut+511>>9)}}for(var wn=ze.FullPaths.length+3>>2,ns=Ue+7>>3,af=Ue+127>>7,Fc=ns+Je+wn+af,Il=Fc+127>>7,Jm=Il<=109?0:Math.ceil((Il-109)/127);Fc+Il+Jm+127>>7>Il;)Jm=++Il<=109?0:Math.ceil((Il-109)/127);var vo=[1,Jm,Il,af,wn,Je,Ue,0];return ze.FileIndex[0].size=Ue<<6,vo[7]=(ze.FileIndex[0].start=vo[0]+vo[1]+vo[2]+vo[3]+vo[4]+vo[5])+(vo[6]+7>>3),vo}(j),ne=oi(ee[7]<<9),oe=0,Ie=0;{for(oe=0;oe<8;++oe)ne.write_shift(1,ie[oe]);for(oe=0;oe<8;++oe)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),oe=0;oe<3;++oe)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,ee[2]),ne.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),ne.write_shift(4,0),ne.write_shift(4,1<<12),ne.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:z),ne.write_shift(4,ee[3]),ne.write_shift(-4,ee[1]?ee[0]-1:z),ne.write_shift(4,ee[1]),oe=0;oe<109;++oe)ne.write_shift(-4,oe<ee[2]?ee[1]+oe:-1)}if(ee[1])for(Ie=0;Ie<ee[1];++Ie){for(;oe<236+Ie*127;++oe)ne.write_shift(-4,oe<ee[2]?ee[1]+oe:-1);ne.write_shift(-4,Ie===ee[1]-1?z:Ie+1)}var Ne=function(ze){for(Ie+=ze;oe<Ie-1;++oe)ne.write_shift(-4,oe+1);ze&&(++oe,ne.write_shift(-4,z))};for(Ie=oe=0,Ie+=ee[1];oe<Ie;++oe)ne.write_shift(-4,Te.DIFSECT);for(Ie+=ee[2];oe<Ie;++oe)ne.write_shift(-4,Te.FATSECT);Ne(ee[3]),Ne(ee[4]);for(var Pe=0,we=0,X=j.FileIndex[0];Pe<j.FileIndex.length;++Pe)X=j.FileIndex[Pe],X.content&&(we=X.content.length,!(we<4096)&&(X.start=Ie,Ne(we+511>>9)));for(Ne(ee[6]+7>>3);ne.l&511;)ne.write_shift(-4,Te.ENDOFCHAIN);for(Ie=oe=0,Pe=0;Pe<j.FileIndex.length;++Pe)X=j.FileIndex[Pe],X.content&&(we=X.content.length,!(!we||we>=4096)&&(X.start=Ie,Ne(we+63>>6)));for(;ne.l&511;)ne.write_shift(-4,Te.ENDOFCHAIN);for(oe=0;oe<ee[4]<<2;++oe){var Ee=j.FullPaths[oe];if(!Ee||Ee.length===0){for(Pe=0;Pe<17;++Pe)ne.write_shift(4,0);for(Pe=0;Pe<3;++Pe)ne.write_shift(4,-1);for(Pe=0;Pe<12;++Pe)ne.write_shift(4,0);continue}X=j.FileIndex[oe],oe===0&&(X.start=X.size?X.start-1:z);var Me=oe===0&&J.root||X.name;if(we=2*(Me.length+1),ne.write_shift(64,Me,"utf16le"),ne.write_shift(2,we),ne.write_shift(1,X.type),ne.write_shift(1,X.color),ne.write_shift(-4,X.L),ne.write_shift(-4,X.R),ne.write_shift(-4,X.C),X.clsid)ne.write_shift(16,X.clsid,"hex");else for(Pe=0;Pe<4;++Pe)ne.write_shift(4,0);ne.write_shift(4,X.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,X.start),ne.write_shift(4,X.size),ne.write_shift(4,0)}for(oe=1;oe<j.FileIndex.length;++oe)if(X=j.FileIndex[oe],X.size>=4096)if(ne.l=X.start+1<<9,_r&&Buffer.isBuffer(X.content))X.content.copy(ne,ne.l,0,X.size),ne.l+=X.size+511&-512;else{for(Pe=0;Pe<X.size;++Pe)ne.write_shift(1,X.content[Pe]);for(;Pe&511;++Pe)ne.write_shift(1,0)}for(oe=1;oe<j.FileIndex.length;++oe)if(X=j.FileIndex[oe],X.size>0&&X.size<4096)if(_r&&Buffer.isBuffer(X.content))X.content.copy(ne,ne.l,0,X.size),ne.l+=X.size+63&-64;else{for(Pe=0;Pe<X.size;++Pe)ne.write_shift(1,X.content[Pe]);for(;Pe&63;++Pe)ne.write_shift(1,0)}if(_r)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function H(j,re){var J=j.FullPaths.map(function(Pe){return Pe.toUpperCase()}),ee=J.map(function(Pe){var we=Pe.split("/");return we[we.length-(Pe.slice(-1)=="/"?2:1)]}),ne=!1;re.charCodeAt(0)===47?(ne=!0,re=J[0].slice(0,-1)+re):ne=re.indexOf("/")!==-1;var oe=re.toUpperCase(),Ie=ne===!0?J.indexOf(oe):ee.indexOf(oe);if(Ie!==-1)return j.FileIndex[Ie];var Ne=!oe.match(Ab);for(oe=oe.replace(pa,""),Ne&&(oe=oe.replace(Ab,"!")),Ie=0;Ie<J.length;++Ie)if((Ne?J[Ie].replace(Ab,"!"):J[Ie]).replace(pa,"")==oe||(Ne?ee[Ie].replace(Ab,"!"):ee[Ie]).replace(pa,"")==oe)return j.FileIndex[Ie];return null}var W=64,z=-2,te="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",Te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function M(j,re,J){u();var ee=F(j,J);l.writeFileSync(re,ee)}function S(j){for(var re=new Array(j.length),J=0;J<j.length;++J)re[J]=String.fromCharCode(j[J]);return re.join("")}function T(j,re){var J=F(j,re);switch(re&&re.type||"buffer"){case"file":return u(),l.writeFileSync(re.filename,J),J;case"binary":return typeof J=="string"?J:S(J);case"base64":return Are(typeof J=="string"?J:S(J));case"buffer":if(_r)return Buffer.isBuffer(J)?J:cv(J);case"array":return typeof J=="string"?Ts(J):J}return J}var k;function O(j){try{var re=j.InflateRaw,J=new re;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)k=j;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function D(j,re){if(!k)return Et(j,re);var J=k.InflateRaw,ee=new J,ne=ee._processChunk(j.slice(j.l),ee._finishFlushFlag);return j.l+=ee.bytesRead,ne}function L(j){return k?k.deflateRawSync(j):Se(j)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(j){var re=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(re>>16|re>>8|re)&255}for(var ce=typeof Uint8Array<"u",le=ce?new Uint8Array(1<<8):[],xe=0;xe<1<<8;++xe)le[xe]=he(xe);function U(j,re){var J=le[j&255];return re<=8?J>>>8-re:(J=J<<8|le[j>>8&255],re<=16?J>>>16-re:(J=J<<8|le[j>>16&255],J>>>24-re))}function De(j,re){var J=re&7,ee=re>>>3;return(j[ee]|(J<=6?0:j[ee+1]<<8))>>>J&3}function de(j,re){var J=re&7,ee=re>>>3;return(j[ee]|(J<=5?0:j[ee+1]<<8))>>>J&7}function He(j,re){var J=re&7,ee=re>>>3;return(j[ee]|(J<=4?0:j[ee+1]<<8))>>>J&15}function Be(j,re){var J=re&7,ee=re>>>3;return(j[ee]|(J<=3?0:j[ee+1]<<8))>>>J&31}function Ae(j,re){var J=re&7,ee=re>>>3;return(j[ee]|(J<=1?0:j[ee+1]<<8))>>>J&127}function Ke(j,re,J){var ee=re&7,ne=re>>>3,oe=(1<<J)-1,Ie=j[ne]>>>ee;return J<8-ee||(Ie|=j[ne+1]<<8-ee,J<16-ee)||(Ie|=j[ne+2]<<16-ee,J<24-ee)||(Ie|=j[ne+3]<<24-ee),Ie&oe}function Xe(j,re,J){var ee=re&7,ne=re>>>3;return ee<=5?j[ne]|=(J&7)<<ee:(j[ne]|=J<<ee&255,j[ne+1]=(J&7)>>8-ee),re+3}function G(j,re,J){var ee=re&7,ne=re>>>3;return J=(J&1)<<ee,j[ne]|=J,re+1}function q(j,re,J){var ee=re&7,ne=re>>>3;return J<<=ee,j[ne]|=J&255,J>>>=8,j[ne+1]=J,re+8}function ae(j,re,J){var ee=re&7,ne=re>>>3;return J<<=ee,j[ne]|=J&255,J>>>=8,j[ne+1]=J&255,j[ne+2]=J>>>8,re+16}function be(j,re){var J=j.length,ee=2*J>re?2*J:re+5,ne=0;if(J>=re)return j;if(_r){var oe=Pre(ee);if(j.copy)j.copy(oe);else for(;ne<j.length;++ne)oe[ne]=j[ne];return oe}else if(ce){var Ie=new Uint8Array(ee);if(Ie.set)Ie.set(j);else for(;ne<J;++ne)Ie[ne]=j[ne];return Ie}return j.length=ee,j}function se(j){for(var re=new Array(j),J=0;J<j;++J)re[J]=0;return re}function Oe(j,re,J){var ee=1,ne=0,oe=0,Ie=0,Ne=0,Pe=j.length,we=ce?new Uint16Array(32):se(32);for(oe=0;oe<32;++oe)we[oe]=0;for(oe=Pe;oe<J;++oe)j[oe]=0;Pe=j.length;var X=ce?new Uint16Array(Pe):se(Pe);for(oe=0;oe<Pe;++oe)we[ne=j[oe]]++,ee<ne&&(ee=ne),X[oe]=0;for(we[0]=0,oe=1;oe<=ee;++oe)we[oe+16]=Ne=Ne+we[oe-1]<<1;for(oe=0;oe<Pe;++oe)Ne=j[oe],Ne!=0&&(X[oe]=we[Ne+16]++);var Ee=0;for(oe=0;oe<Pe;++oe)if(Ee=j[oe],Ee!=0)for(Ne=U(X[oe],ee)>>ee-Ee,Ie=(1<<ee+4-Ee)-1;Ie>=0;--Ie)re[Ne|Ie<<Ee]=Ee&15|oe<<4;return ee}var pe=ce?new Uint16Array(512):se(512),ge=ce?new Uint16Array(32):se(32);if(!ce){for(var me=0;me<512;++me)pe[me]=0;for(me=0;me<32;++me)ge[me]=0}(function(){for(var j=[],re=0;re<32;re++)j.push(5);Oe(j,ge,32);var J=[];for(re=0;re<=143;re++)J.push(8);for(;re<=255;re++)J.push(9);for(;re<=279;re++)J.push(7);for(;re<=287;re++)J.push(8);Oe(J,pe,288)})();var Ce=function(){for(var re=ce?new Uint8Array(32768):[],J=0,ee=0;J<Q.length-1;++J)for(;ee<Q[J+1];++ee)re[ee]=J;for(;ee<32768;++ee)re[ee]=29;var ne=ce?new Uint8Array(259):[];for(J=0,ee=0;J<Y.length-1;++J)for(;ee<Y[J+1];++ee)ne[ee]=J;function oe(Ne,Pe){for(var we=0;we<Ne.length;){var X=Math.min(65535,Ne.length-we),Ee=we+X==Ne.length;for(Pe.write_shift(1,+Ee),Pe.write_shift(2,X),Pe.write_shift(2,~X&65535);X-- >0;)Pe[Pe.l++]=Ne[we++]}return Pe.l}function Ie(Ne,Pe){for(var we=0,X=0,Ee=ce?new Uint16Array(32768):[];X<Ne.length;){var Me=Math.min(65535,Ne.length-X);if(Me<10){for(we=Xe(Pe,we,+(X+Me==Ne.length)),we&7&&(we+=8-(we&7)),Pe.l=we/8|0,Pe.write_shift(2,Me),Pe.write_shift(2,~Me&65535);Me-- >0;)Pe[Pe.l++]=Ne[X++];we=Pe.l*8;continue}we=Xe(Pe,we,+(X+Me==Ne.length)+2);for(var ze=0;Me-- >0;){var Ue=Ne[X];ze=(ze<<5^Ue)&32767;var Je=-1,St=0;if((Je=Ee[ze])&&(Je|=X&-32768,Je>X&&(Je-=32768),Je<X))for(;Ne[Je+St]==Ne[X+St]&&St<250;)++St;if(St>2){Ue=ne[St],Ue<=22?we=q(Pe,we,le[Ue+1]>>1)-1:(q(Pe,we,3),we+=5,q(Pe,we,le[Ue-23]>>5),we+=3);var $r=Ue<8?0:Ue-4>>2;$r>0&&(ae(Pe,we,St-Y[Ue]),we+=$r),Ue=re[X-Je],we=q(Pe,we,le[Ue]>>3),we-=3;var Ut=Ue<4?0:Ue-2>>1;Ut>0&&(ae(Pe,we,X-Je-Q[Ue]),we+=Ut);for(var wn=0;wn<St;++wn)Ee[ze]=X&32767,ze=(ze<<5^Ne[X])&32767,++X;Me-=St-1}else Ue<=143?Ue=Ue+48:we=G(Pe,we,1),we=q(Pe,we,le[Ue]),Ee[ze]=X&32767,++X}we=q(Pe,we,0)-1}return Pe.l=(we+7)/8|0,Pe.l}return function(Pe,we){return Pe.length<8?oe(Pe,we):Ie(Pe,we)}}();function Se(j){var re=oi(50+Math.floor(j.length*1.1)),J=Ce(j,re);return re.slice(0,J)}var Le=ce?new Uint16Array(32768):se(32768),qe=ce?new Uint16Array(32768):se(32768),Qe=ce?new Uint16Array(128):se(128),wt=1,Pt=1;function Jt(j,re){var J=Be(j,re)+257;re+=5;var ee=Be(j,re)+1;re+=5;var ne=He(j,re)+4;re+=4;for(var oe=0,Ie=ce?new Uint8Array(19):se(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Pe=1,we=ce?new Uint8Array(8):se(8),X=ce?new Uint8Array(8):se(8),Ee=Ie.length,Me=0;Me<ne;++Me)Ie[B[Me]]=oe=de(j,re),Pe<oe&&(Pe=oe),we[oe]++,re+=3;var ze=0;for(we[0]=0,Me=1;Me<=Pe;++Me)X[Me]=ze=ze+we[Me-1]<<1;for(Me=0;Me<Ee;++Me)(ze=Ie[Me])!=0&&(Ne[Me]=X[ze]++);var Ue=0;for(Me=0;Me<Ee;++Me)if(Ue=Ie[Me],Ue!=0){ze=le[Ne[Me]]>>8-Ue;for(var Je=(1<<7-Ue)-1;Je>=0;--Je)Qe[ze|Je<<Ue]=Ue&7|Me<<3}var St=[];for(Pe=1;St.length<J+ee;)switch(ze=Qe[Ae(j,re)],re+=ze&7,ze>>>=3){case 16:for(oe=3+De(j,re),re+=2,ze=St[St.length-1];oe-- >0;)St.push(ze);break;case 17:for(oe=3+de(j,re),re+=3;oe-- >0;)St.push(0);break;case 18:for(oe=11+Ae(j,re),re+=7;oe-- >0;)St.push(0);break;default:St.push(ze),Pe<ze&&(Pe=ze);break}var $r=St.slice(0,J),Ut=St.slice(J);for(Me=J;Me<286;++Me)$r[Me]=0;for(Me=ee;Me<30;++Me)Ut[Me]=0;return wt=Oe($r,Le,286),Pt=Oe(Ut,qe,30),re}function Ot(j,re){if(j[0]==3&&!(j[1]&3))return[Pc(re),2];for(var J=0,ee=0,ne=Pre(re||1<<18),oe=0,Ie=ne.length>>>0,Ne=0,Pe=0;!(ee&1);){if(ee=de(j,J),J+=3,ee>>>1)ee>>1==1?(Ne=9,Pe=5):(J=Jt(j,J),Ne=wt,Pe=Pt);else{J&7&&(J+=8-(J&7));var we=j[J>>>3]|j[(J>>>3)+1]<<8;if(J+=32,we>0)for(!re&&Ie<oe+we&&(ne=be(ne,oe+we),Ie=ne.length);we-- >0;)ne[oe++]=j[J>>>3],J+=8;continue}for(;;){!re&&Ie<oe+32767&&(ne=be(ne,oe+32767),Ie=ne.length);var X=Ke(j,J,Ne),Ee=ee>>>1==1?pe[X]:Le[X];if(J+=Ee&15,Ee>>>=4,!(Ee>>>8&255))ne[oe++]=Ee;else{if(Ee==256)break;Ee-=257;var Me=Ee<8?0:Ee-4>>2;Me>5&&(Me=0);var ze=oe+Y[Ee];Me>0&&(ze+=Ke(j,J,Me),J+=Me),X=Ke(j,J,Pe),Ee=ee>>>1==1?ge[X]:qe[X],J+=Ee&15,Ee>>>=4;var Ue=Ee<4?0:Ee-2>>1,Je=Q[Ee];for(Ue>0&&(Je+=Ke(j,J,Ue),J+=Ue),!re&&Ie<ze&&(ne=be(ne,ze+100),Ie=ne.length);oe<ze;)ne[oe]=ne[oe-Je],++oe}}}return re?[ne,J+7>>>3]:[ne.slice(0,oe),J+7>>>3]}function Et(j,re){var J=j.slice(j.l||0),ee=Ot(J,re);return j.l+=ee[1],ee[0]}function jt(j,re){if(j)typeof console<"u"&&console.error(re);else throw new Error(re)}function qt(j,re){var J=j;xi(J,0);var ee=[],ne=[],oe={FileIndex:ee,FullPaths:ne};A(oe,{root:re.root});for(var Ie=J.length-4;(J[Ie]!=80||J[Ie+1]!=75||J[Ie+2]!=5||J[Ie+3]!=6)&&Ie>=0;)--Ie;J.l=Ie+4,J.l+=4;var Ne=J.read_shift(2);J.l+=6;var Pe=J.read_shift(4);for(J.l=Pe,Ie=0;Ie<Ne;++Ie){J.l+=20;var we=J.read_shift(4),X=J.read_shift(4),Ee=J.read_shift(2),Me=J.read_shift(2),ze=J.read_shift(2);J.l+=8;var Ue=J.read_shift(4),Je=s(J.slice(J.l+Ee,J.l+Ee+Me));J.l+=Ee+Me+ze;var St=J.l;J.l=Ue+4,zt(J,we,X,oe,Je),J.l=St}return oe}function zt(j,re,J,ee,ne){j.l+=2;var oe=j.read_shift(2),Ie=j.read_shift(2),Ne=o(j);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var Pe=j.read_shift(4),we=j.read_shift(4),X=j.read_shift(4),Ee=j.read_shift(2),Me=j.read_shift(2),ze="",Ue=0;Ue<Ee;++Ue)ze+=String.fromCharCode(j[j.l++]);if(Me){var Je=s(j.slice(j.l,j.l+Me));(Je[21589]||{}).mt&&(Ne=Je[21589].mt),((ne||{})[21589]||{}).mt&&(Ne=ne[21589].mt)}j.l+=Me;var St=j.slice(j.l,j.l+we);switch(Ie){case 8:St=D(j,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ie)}var $r=!1;oe&8&&(Pe=j.read_shift(4),Pe==134695760&&(Pe=j.read_shift(4),$r=!0),we=j.read_shift(4),X=j.read_shift(4)),we!=re&&jt($r,"Bad compressed size: "+re+" != "+we),X!=J&&jt($r,"Bad uncompressed size: "+J+" != "+X),dr(ee,ze,St,{unsafe:!0,mt:Ne})}function Ht(j,re){var J=re||{},ee=[],ne=[],oe=oi(1),Ie=J.compression?8:0,Ne=0,Pe=0,we=0,X=0,Ee=0,Me=j.FullPaths[0],ze=Me,Ue=j.FileIndex[0],Je=[],St=0;for(Pe=1;Pe<j.FullPaths.length;++Pe)if(ze=j.FullPaths[Pe].slice(Me.length),Ue=j.FileIndex[Pe],!(!Ue.size||!Ue.content||ze=="Sh33tJ5")){var $r=X,Ut=oi(ze.length);for(we=0;we<ze.length;++we)Ut.write_shift(1,ze.charCodeAt(we)&127);Ut=Ut.slice(0,Ut.l),Je[Ee]=GLt.buf(Ue.content,0);var wn=Ue.content;Ie==8&&(wn=L(wn)),oe=oi(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,Ne),oe.write_shift(2,Ie),Ue.mt?a(oe,Ue.mt):oe.write_shift(4,0),oe.write_shift(-4,Je[Ee]),oe.write_shift(4,wn.length),oe.write_shift(4,Ue.content.length),oe.write_shift(2,Ut.length),oe.write_shift(2,0),X+=oe.length,ee.push(oe),X+=Ut.length,ee.push(Ut),X+=wn.length,ee.push(wn),oe=oi(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,Ne),oe.write_shift(2,Ie),oe.write_shift(4,0),oe.write_shift(-4,Je[Ee]),oe.write_shift(4,wn.length),oe.write_shift(4,Ue.content.length),oe.write_shift(2,Ut.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,$r),St+=oe.l,ne.push(oe),St+=Ut.length,ne.push(Ut),++Ee}return oe=oi(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,Ee),oe.write_shift(2,Ee),oe.write_shift(4,St),oe.write_shift(4,X),oe.write_shift(2,0),Vf([Vf(ee),Vf(ne),oe])}var At={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function st(j,re){if(j.ctype)return j.ctype;var J=j.name||"",ee=J.match(/\.([^\.]+)$/);return ee&&At[ee[1]]||re&&(ee=(J=re).match(/[\.\\]([^\.\\])+$/),ee&&At[ee[1]])?At[ee[1]]:"application/octet-stream"}function rt(j){for(var re=Are(j),J=[],ee=0;ee<re.length;ee+=76)J.push(re.slice(ee,ee+76));return J.join(`\r
`)+`\r
`}function _t(j){var re=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var X=we.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],ee=re.split(`\r
`),ne=0;ne<ee.length;++ne){var oe=ee[ne];if(oe.length==0){J.push("");continue}for(var Ie=0;Ie<oe.length;){var Ne=76,Pe=oe.slice(Ie,Ie+Ne);Pe.charAt(Ne-1)=="="?Ne--:Pe.charAt(Ne-2)=="="?Ne-=2:Pe.charAt(Ne-3)=="="&&(Ne-=3),Pe=oe.slice(Ie,Ie+Ne),Ie+=Ne,Ie<oe.length&&(Pe+="="),J.push(Pe)}}return J.join(`\r
`)}function tt(j){for(var re=[],J=0;J<j.length;++J){for(var ee=j[J];J<=j.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+j[++J];re.push(ee)}for(var ne=0;ne<re.length;++ne)re[ne]=re[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return Ts(re.join(`\r
`))}function Tt(j,re,J){for(var ee="",ne="",oe="",Ie,Ne=0;Ne<10;++Ne){var Pe=re[Ne];if(!Pe||Pe.match(/^\s*$/))break;var we=Pe.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":ee=we[2].trim();break;case"content-type":oe=we[2].trim();break;case"content-transfer-encoding":ne=we[2].trim();break}}switch(++Ne,ne.toLowerCase()){case"base64":Ie=Ts(fo(re.slice(Ne).join("")));break;case"quoted-printable":Ie=tt(re.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var X=dr(j,ee.slice(J.length),Ie,{unsafe:!0});oe&&(X.ctype=oe)}function nt(j,re){if(S(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=re&&re.root||"",ee=(_r&&Buffer.isBuffer(j)?j.toString("binary"):S(j)).split(`\r
`),ne=0,oe="";for(ne=0;ne<ee.length;++ne)if(oe=ee[ne],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),J||(J=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),oe.slice(0,J.length)!=J););var Ie=(ee[1]||"").match(/boundary="(.*?)"/);if(!Ie)throw new Error("MAD cannot find boundary");var Ne="--"+(Ie[1]||""),Pe=[],we=[],X={FileIndex:Pe,FullPaths:we};A(X);var Ee,Me=0;for(ne=0;ne<ee.length;++ne){var ze=ee[ne];ze!==Ne&&ze!==Ne+"--"||(Me++&&Tt(X,ee.slice(Ee,ne),J),Ee=ne)}return X}function ht(j,re){var J=re||{},ee=J.boundary||"SheetJS";ee="------="+ee;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],oe=j.FullPaths[0],Ie=oe,Ne=j.FileIndex[0],Pe=1;Pe<j.FullPaths.length;++Pe)if(Ie=j.FullPaths[Pe].slice(oe.length),Ne=j.FileIndex[Pe],!(!Ne.size||!Ne.content||Ie=="Sh33tJ5")){Ie=Ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(St){return"_x"+St.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(St){return"_u"+St.charCodeAt(0).toString(16)+"_"});for(var we=Ne.content,X=_r&&Buffer.isBuffer(we)?we.toString("binary"):S(we),Ee=0,Me=Math.min(1024,X.length),ze=0,Ue=0;Ue<=Me;++Ue)(ze=X.charCodeAt(Ue))>=32&&ze<128&&++Ee;var Je=Ee>=Me*4/5;ne.push(ee),ne.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+Ie),ne.push("Content-Transfer-Encoding: "+(Je?"quoted-printable":"base64")),ne.push("Content-Type: "+st(Ne,Ie)),ne.push(""),ne.push(Je?_t(X):rt(X))}return ne.push(ee+`--\r
`),ne.join(`\r
`)}function cr(j){var re={};return A(re,j),re}function dr(j,re,J,ee){var ne=ee&&ee.unsafe;ne||A(j);var oe=!ne&&xr.find(j,re);if(!oe){var Ie=j.FullPaths[0];re.slice(0,Ie.length)==Ie?Ie=re:(Ie.slice(-1)!="/"&&(Ie+="/"),Ie=(Ie+re).replace("//","/")),oe={name:i(re),type:2},j.FileIndex.push(oe),j.FullPaths.push(Ie),ne||xr.utils.cfb_gc(j)}return oe.content=J,oe.size=J?J.length:0,ee&&(ee.CLSID&&(oe.clsid=ee.CLSID),ee.mt&&(oe.mt=ee.mt),ee.ct&&(oe.ct=ee.ct)),oe}function br(j,re){A(j);var J=xr.find(j,re);if(J){for(var ee=0;ee<j.FileIndex.length;++ee)if(j.FileIndex[ee]==J)return j.FileIndex.splice(ee,1),j.FullPaths.splice(ee,1),!0}return!1}function ni(j,re,J){A(j);var ee=xr.find(j,re);if(ee){for(var ne=0;ne<j.FileIndex.length;++ne)if(j.FileIndex[ne]==ee)return j.FileIndex[ne].name=i(J),j.FullPaths[ne]=J,!0}return!1}function Dr(j){I(j,!0)}return t.find=H,t.read=R,t.parse=f,t.write=T,t.writeFile=M,t.utils={cfb_new:cr,cfb_add:dr,cfb_del:br,cfb_mov:ni,cfb_gc:Dr,ReadShift:fw,CheckField:Uge,prep_blob:xi,bconcat:Vf,use_zlib:O,_deflateRaw:Se,_inflateRaw:Et,consts:Te},t}();function YLt(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function wl(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function sj(e){for(var t=[],r=wl(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var JR=new Date(1899,11,30,0,0,0);function ma(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=JR.getTime()+(e.getTimezoneOffset()-JR.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _ge=new Date,KLt=JR.getTime()+(_ge.getTimezoneOffset()-JR.getTimezoneOffset())*6e4,Hre=_ge.getTimezoneOffset();function XA(e){var t=new Date;return t.setTime(e*24*60*60*1e3+KLt),t.getTimezoneOffset()!==Hre&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Hre)*6e4),t}function XLt(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var Bre=new Date("2017-02-19T19:06:09.000Z"),Sge=isNaN(Bre.getFullYear())?new Date("2/19/17"):Bre,qLt=Sge.getFullYear()==2017;function bi(e,t){var r=new Date(e);if(qLt)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Sge.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function zd(e,t){if(_r&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ib(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ib(lge(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ib(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ib(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Ti(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ti(e[r]));return t}function Mn(e,t){for(var r="";r.length<t;)r+=e;return r}function Ps(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var ZLt=["january","february","march","april","may","june","july","august","september","october","november","december"];function Em(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&ZLt.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var JLt=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],s=1;s<a.length;++s)o.push(i),o.push(a[s]);return o}}();function Cge(e){return e?e.content&&e.type?zd(e.content,!0):e.data?kb(e.data):e.asNodeBuffer&&_r?kb(e.asNodeBuffer().toString("binary")):e.asBinary?kb(e.asBinary()):e._data&&e._data.getContent?kb(zd(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function xge(e){if(!e)return null;if(e.data)return Rre(e.data);if(e.asNodeBuffer&&_r)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Rre(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function QLt(e){return e&&e.name.slice(-4)===".bin"?xge(e):Cge(e)}function Mo(e,t){for(var r=e.FullPaths||wl(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function lj(e,t){var r=Mo(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Zn(e,t,r){if(!r)return QLt(lj(e,t));if(!t)return null;try{return Zn(e,t)}catch{return null}}function no(e,t,r){if(!r)return Cge(lj(e,t));if(!t)return null;try{return no(e,t)}catch{return null}}function Tge(e,t,r){if(!r)return xge(lj(e,t));if(!t)return null;try{return Tge(e,t)}catch{return null}}function Wre(e){for(var t=e.FullPaths||wl(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function eFt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return _r?n=cv(r):n=wLt(r),xr.utils.cfb_add(e,t,n)}xr.utils.cfb_add(e,t,r)}else e.file(t,r)}function Oge(e,t){switch(t.type){case"base64":return xr.read(e,{type:"base64"});case"binary":return xr.read(e,{type:"binary"});case"buffer":case"array":return xr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Pb(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Ege=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,tFt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Vre=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,rFt=/<[^>]*>/g,Yi=Ege.match(Vre)?Vre:rFt,nFt=/<\w*:/,iFt=/<(\/?)\w+:/;function Bt(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(tFt),s=0,l="",u=0,f="",c="",h=1;if(o)for(u=0;u!=o.length;++u){for(c=o[u],a=0;a!=c.length&&c.charCodeAt(a)!==61;++a);for(f=c.slice(0,a).trim();c.charCodeAt(a+1)==32;)++a;for(h=(i=c.charCodeAt(a+1))==34||i==39?1:0,l=c.slice(a+1+h,c.length-h),s=0;s!=f.length&&f.charCodeAt(s)!==58;++s);if(s===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,r||(n[f.toLowerCase()]=l);else{var d=(s===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(s+1);if(n[d]&&f.slice(s-3,s)=="ext")continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function Al(e){return e.replace(iFt,"<$1")}var Rge={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},aFt=sj(Rge),kr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(s,l){return Rge[s]||String.fromCharCode(parseInt(l,s.indexOf("x")>-1?16:10))||s}).replace(t,function(s,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),oFt=/[&<>'"]/g,sFt=/[\u0000-\u001f]/g;function uj(e){var t=e+"";return t.replace(oFt,function(r){return aFt[r]}).replace(/\n/g,"<br/>").replace(sFt,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ure=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function pn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function s$(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),s=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(s&1023))}return t}function jre(e){var t=Pc(2*e.length),r,n,i=1,a=0,o=0,s;for(n=0;n<e.length;n+=i)i=1,(s=e.charCodeAt(n))<128?r=s:s<224?(r=(s&31)*64+(e.charCodeAt(n+1)&63),i=2):s<240?(r=(s&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(s&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function zre(e){return cv(e,"binary").toString("utf8")}var BT="foo bar bazâð£",an=_r&&(zre(BT)==s$(BT)&&zre||jre(BT)==s$(BT)&&jre)||s$,Ib=_r?function(e){return cv(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},VS=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),kge=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),lFt=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),uFt=/<\/?(?:vt:)?variant>/g,fFt=/<(?:vt:)([^>]*)>([\s\S]*)</;function Gre(e,t){var r=Bt(e),n=e.match(lFt(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(uFt,"").match(fFt);o&&i.push({v:an(o[2]),t:o[1]})}),i}var cFt=/(^\s|\s$|\n)/;function hFt(e){return wl(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function dFt(e,t,r){return"<"+e+(r!=null?hFt(r):"")+(t!=null?(t.match(cFt)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function fj(e){if(_r&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return an(hv(ij(e)));throw new Error("Bad input format: expected Buffer or string")}var US=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vFt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pFt=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function gFt(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function yFt(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=n?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var s=0;s<=5;++s,a/=256)e[r+s]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var Yre=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Kre=_r?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:cv(t)})):Yre(e)}:Yre,Xre=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Mu(e,i)));return n.join("").replace(pa,"")},cj=_r?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(pa,""):Xre(e,t,r)}:Xre,qre=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Age=_r?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):qre(e,t,r)}:qre,Zre=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Rp(e,i)));return n.join("")},Z1=_r?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Zre(t,r,n)}:Zre,Pge=function(e,t){var r=to(e,t);return r>0?Z1(e,t+4,t+4+r-1):""},Ige=Pge,Mge=function(e,t){var r=to(e,t);return r>0?Z1(e,t+4,t+4+r-1):""},Dge=Mge,$ge=function(e,t){var r=2*to(e,t);return r>0?Z1(e,t+4,t+4+r-1):""},Nge=$ge,Lge=function(t,r){var n=to(t,r);return n>0?cj(t,r+4,r+4+n):""},Fge=Lge,Hge=function(e,t){var r=to(e,t);return r>0?Z1(e,t+4,t+4+r):""},Bge=Hge,Wge=function(e,t){return gFt(e,t)},QR=Wge,Vge=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_r&&(Ige=function(t,r){if(!Buffer.isBuffer(t))return Pge(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Dge=function(t,r){if(!Buffer.isBuffer(t))return Mge(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Nge=function(t,r){if(!Buffer.isBuffer(t))return $ge(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Fge=function(t,r){if(!Buffer.isBuffer(t))return Lge(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Bge=function(t,r){if(!Buffer.isBuffer(t))return Hge(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},QR=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Wge(t,r)},Vge=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Rp=function(e,t){return e[t]},Mu=function(e,t){return e[t+1]*(1<<8)+e[t]},mFt=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},to=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},bFt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function fw(e,t){var r="",n,i,a=[],o,s,l,u;switch(t){case"dbcs":if(u=this.l,_r&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Mu(this,u)),u+=2;e*=2;break;case"utf8":r=Z1(this,this.l,this.l+e);break;case"utf16le":e*=2,r=cj(this,this.l,this.l+e);break;case"wstr":return fw.call(this,e,"dbcs");case"lpstr-ansi":r=Ige(this,this.l),e=4+to(this,this.l);break;case"lpstr-cp":r=Dge(this,this.l),e=4+to(this,this.l);break;case"lpwstr":r=Nge(this,this.l),e=4+2*to(this,this.l);break;case"lpp4":e=4+to(this,this.l),r=Fge(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+to(this,this.l),r=Bge(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Rp(this,this.l+e++))!==0;)a.push(HT(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=Mu(this,this.l+e))!==0;)a.push(HT(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Rp(this,u),this.l=u+1,s=fw.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(HT(Mu(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Rp(this,u),this.l=u+1,s=fw.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(HT(Rp(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Rp(this,this.l),this.l++,n;case 2:return n=(t==="i"?mFt:Mu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Fh:bFt)(this,this.l),this.l+=4,n):(i=to(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=QR(this,this.l):i=QR([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Age(this,this.l,e);break}}return this.l+=e,r}var wFt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},_Ft=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},SFt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function CFt(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)SFt(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,wFt(this,t,this.l);break;case 8:if(n=8,r==="f"){yFt(this,t,this.l);break}case 16:break;case-4:n=4,_Ft(this,t,this.l);break}return this.l+=n,this}function Uge(e,t){var r=Age(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function xi(e,t){e.l=t,e.read_shift=fw,e.chk=Uge,e.write_shift=CFt}function ji(e,t){e.l+=t}function oi(e){var t=Pc(e);return xi(t,0),t}function nf(e,t,r){if(e){var n,i,a;xi(e,e.l||0);for(var o=e.length,s=0,l=0;e.l<o;){s=e.read_shift(1),s&128&&(s=(s&127)+((e.read_shift(1)&127)<<7));var u=ak[s]||ak[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;l=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=l,t(f,u,s))return}}}function AB(){var e=[],t=_r?256:2048,r=function(u){var f=oi(u);return xi(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Vf(e)},s=function(u){i(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:s,end:o,_bufs:e}}function cw(e,t,r){var n=Ti(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Jre(e,t,r){var n=Ti(e);return n.s=cw(n.s,t.s,r),n.e=cw(n.e,t.s,r),n}function hw(e,t){if(e.cRel&&e.c<0)for(e=Ti(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ti(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Gt(e);return!e.cRel&&e.cRel!=null&&(r=OFt(r)),!e.rRel&&e.rRel!=null&&(r=xFt(r)),r}function l$(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fi(e.s.c)+":"+(e.e.cRel?"":"$")+fi(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Oi(e.s.r)+":"+(e.e.rRel?"":"$")+Oi(e.e.r):hw(e.s,t.biff)+":"+hw(e.e,t.biff)}function hj(e){return parseInt(TFt(e),10)-1}function Oi(e){return""+(e+1)}function xFt(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function TFt(e){return e.replace(/\$(\d+)$/,"$1")}function dj(e){for(var t=EFt(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function fi(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function OFt(e){return e.replace(/^([A-Z])/,"$$$1")}function EFt(e){return e.replace(/^\$([A-Z])/,"$1")}function RFt(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ha(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Gt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function qm(e){var t=e.indexOf(":");return t==-1?{s:ha(e),e:ha(e)}:{s:ha(e.slice(0,t)),e:ha(e.slice(t+1))}}function Or(e,t){return typeof t>"u"||typeof t=="number"?Or(e.s,e.e):(typeof e!="string"&&(e=Gt(e)),typeof t!="string"&&(t=Gt(t)),e==t?e:e+":"+t)}function Dn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Qre(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ko(e.z,r?ma(t):t)}catch{}try{return e.w=Ko((e.XF||{}).numFmtId||(r?14:0),r?ma(t):t)}catch{return""+t}}function Ku(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?pv[e.v]||e.v:t==null?Qre(e,e.v):Qre(e,t))}function Lc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function jge(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),o=0,s=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?ha(n.origin):n.origin;o=l.r,s=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Dn(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(u.e.r=o=f.e.r+1)}for(var c=0;c!=t.length;++c)if(t[c]){if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[c].length;++h)if(!(typeof t[c][h]>"u")){var d={v:t[c][h]},v=o+c,g=s+h;if(u.s.r>v&&(u.s.r=v),u.s.c>g&&(u.s.c=g),u.e.r<v&&(u.e.r=v),u.e.c<g&&(u.e.c=g),t[c][h]&&typeof t[c][h]=="object"&&!Array.isArray(t[c][h])&&!(t[c][h]instanceof Date))d=t[c][h];else if(Array.isArray(d.v)&&(d.f=t[c][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||er[14],n.cellDates?(d.t="d",d.w=Ko(d.z,ma(d.v))):(d.t="n",d.v=ma(d.v),d.w=Ko(d.z,d.v))):d.t="s";if(i)a[v]||(a[v]=[]),a[v][g]&&a[v][g].z&&(d.z=a[v][g].z),a[v][g]=d;else{var y=Gt({c:g,r:v});a[y]&&a[y].z&&(d.z=a[y].z),a[y]=d}}}return u.s.c<1e7&&(a["!ref"]=Or(u)),a}function Zm(e,t){return jge(null,e,t)}function kFt(e){return e.read_shift(4,"i")}function Bi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function AFt(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vj(e,t){var r=e.l,n=e.read_shift(1),i=Bi(e),a=[],o={t:i,h:i};if(n&1){for(var s=e.read_shift(4),l=0;l!=s;++l)a.push(AFt(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var PFt=vj;function rs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function dv(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var IFt=Bi;function pj(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var MFt=Bi,PB=pj;function gj(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?QR([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fh(t,0)>>2;return r?i/100:i}function zge(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var vv=zge;function Ni(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function DFt(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=xd[i];u&&(t.rgb=zS(u));break;case 2:t.rgb=zS([o,s,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function $Ft(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Gge(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function NFt(e){return Gge(e,1)}function LFt(e){return Gge(e,2)}var yj=2,Ia=3,WT=11,ene=12,ek=19,VT=64,FFt=65,HFt=71,BFt=4108,WFt=4126,yi=80,Yge=81,VFt=[yi,Yge],UFt={1:{n:"CodePage",t:yj},2:{n:"Category",t:yi},3:{n:"PresentationFormat",t:yi},4:{n:"ByteCount",t:Ia},5:{n:"LineCount",t:Ia},6:{n:"ParagraphCount",t:Ia},7:{n:"SlideCount",t:Ia},8:{n:"NoteCount",t:Ia},9:{n:"HiddenCount",t:Ia},10:{n:"MultimediaClipCount",t:Ia},11:{n:"ScaleCrop",t:WT},12:{n:"HeadingPairs",t:BFt},13:{n:"TitlesOfParts",t:WFt},14:{n:"Manager",t:yi},15:{n:"Company",t:yi},16:{n:"LinksUpToDate",t:WT},17:{n:"CharacterCount",t:Ia},19:{n:"SharedDoc",t:WT},22:{n:"HyperlinksChanged",t:WT},23:{n:"AppVersion",t:Ia,p:"version"},24:{n:"DigSig",t:FFt},26:{n:"ContentType",t:yi},27:{n:"ContentStatus",t:yi},28:{n:"Language",t:yi},29:{n:"Version",t:yi},255:{},2147483648:{n:"Locale",t:ek},2147483651:{n:"Behavior",t:ek},1919054434:{}},jFt={1:{n:"CodePage",t:yj},2:{n:"Title",t:yi},3:{n:"Subject",t:yi},4:{n:"Author",t:yi},5:{n:"Keywords",t:yi},6:{n:"Comments",t:yi},7:{n:"Template",t:yi},8:{n:"LastAuthor",t:yi},9:{n:"RevNumber",t:yi},10:{n:"EditTime",t:VT},11:{n:"LastPrinted",t:VT},12:{n:"CreatedDate",t:VT},13:{n:"ModifiedDate",t:VT},14:{n:"PageCount",t:Ia},15:{n:"WordCount",t:Ia},16:{n:"CharCount",t:Ia},17:{n:"Thumbnail",t:HFt},18:{n:"Application",t:yi},19:{n:"DocSecurity",t:Ia},255:{},2147483648:{n:"Locale",t:ek},2147483651:{n:"Behavior",t:ek},1919054434:{}},tne={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zFt=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function GFt(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var YFt=GFt([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xd=Ti(YFt),pv={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Kge={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rne={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function KFt(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function XFt(e){var t=KFt();if(!e||!e.match)return t;var r={};if((e.match(Yi)||[]).forEach(function(n){var i=Bt(n);switch(i[0].replace(nFt,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[rne[i.ContentType]]!==void 0&&t[rne[i.ContentType]].push(i.PartName);break}}),t.xmlns!==vFt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Bp={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function IB(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function dw(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Yi)||[]).forEach(function(i){var a=Bt(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var s=a.TargetMode==="External"?a.Target:Pb(a.Target,t);r[s]=o,n[a.Id]=o}}),r["!id"]=n,r}var qFt="application/vnd.oasis.opendocument.spreadsheet";function ZFt(e,t){for(var r=fj(e),n,i;n=US.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Bt(n[0],!1),i.path=="/"&&i.type!==qFt)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var vw=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],JFt=function(){for(var e=new Array(vw.length),t=0;t<vw.length;++t){var r=vw[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Xge(e){var t={};e=an(e);for(var r=0;r<vw.length;++r){var n=vw[r],i=e.match(JFt[r]);i!=null&&i.length>0&&(t[n[1]]=kr(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=bi(t[n[1]]))}return t}var QFt=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function qge(e,t,r,n){var i=[];if(typeof e=="string")i=Gre(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(f){return{v:f}}));var o=typeof t=="string"?Gre(t,n).map(function(f){return f.v}):t,s=0,l=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=o.slice(s,s+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(s,s+l);break}s+=l}}function eHt(e,t,r){var n={};return t||(t={}),e=an(e),QFt.forEach(function(i){var a=(e.match(VS(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=kr(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&qge(n.HeadingPairs,n.TitlesOfParts,t,r),t}var tHt=/<[^>]+>[^<]*/g;function rHt(e,t){var r={},n="",i=e.match(tHt);if(i)for(var a=0;a!=i.length;++a){var o=i[a],s=Bt(o);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":n=kr(s.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=kr(f);break;case"bool":r[n]=pn(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=bi(f);break;case"cy":case"error":r[n]=kr(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var nHt={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},u$;function iHt(e,t,r){u$||(u$=sj(nHt)),t=u$[t]||t,e[t]=r}function mj(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Zge(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Jge(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Qge(e,t,r){return t===31?Jge(e):Zge(e,t,r)}function MB(e,t,r){return Qge(e,t,r===!1?0:4)}function aHt(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Qge(e,t,0)}function oHt(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(pa,""),e.l-i&2&&(e.l+=2)}return r}function sHt(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(pa,"");return r}function lHt(e){var t=e.l,r=tk(e,Yge);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=tk(e,Ia);return[r,n]}function uHt(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(lHt(e));return r}function nne(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(pa,"").replace(Ab,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function eye(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function fHt(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function tk(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==ene&&n!==t&&VFt.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===ene?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Zge(e,n,4).replace(pa,"");case 31:return Jge(e);case 64:return mj(e);case 65:return eye(e);case 71:return fHt(e);case 80:return MB(e,n,!a.raw).replace(pa,"");case 81:return aHt(e,n).replace(pa,"");case 4108:return uHt(e);case 4126:case 4127:return n==4127?oHt(e):sHt(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ine(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,s=0,l=-1,u={};for(o=0;o!=i;++o){var f=e.read_shift(4),c=e.read_shift(4);a[o]=[f,c+r]}a.sort(function(w,_){return w[1]-_[1]});var h={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var d=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(d=!1,e.l=a[o][1]),d)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[a[o][0]];if(h[v.n]=tk(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ks(s=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(a[o][0]===1){if(s=h.CodePage=tk(e,yj),ks(s),l!==-1){var g=e.l;e.l=a[l][1],u=nne(e,s),e.l=g}}else if(a[o][0]===0){if(s===0){l=o,e.l=a[o+1][1];continue}u=nne(e,s)}else{var y=u[a[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=eye(e);break;case 30:e.l+=4,b=MB(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=MB(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Bn(e,4);break;case 64:e.l+=4,b=bi(mj(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=b}}return e.l=r+n,h}function ane(e,t,r){var n=e.content;if(!n)return{};xi(n,0);var i,a,o,s,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==xr.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),s=n.read_shift(4),i===1&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var c=ine(n,t),h={SystemIdentifier:u};for(var d in c)h[d]=c[d];if(h.FMTID=a,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=ine(n,null)}catch{}for(d in v)h[d]=v[d];return h.FMTID=[a,o],h}function If(e,t){return e.read_shift(t),null}function cHt(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Bn(e,t){return e.read_shift(t)===1}function Jn(e){return e.read_shift(2,"u")}function tye(e,t){return cHt(e,t,Jn)}function hHt(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function J1(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function dHt(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,s,l={};i&&(o=e.read_shift(2)),n&&(s=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=s),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Gd(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Q1(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Gd(e,n,r)}function gv(e,t,r){if(r.biff>5)return Q1(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function vHt(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function pHt(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(pa,"");return n&&(e.l+=24),i}function gHt(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(pa,"");return r+o}function yHt(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return pHt(e);case"0303000000000000c000000000000046":return gHt(e);default:throw new Error("Unsupported Moniker "+r)}}function UT(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(pa,""):"";return r}function mHt(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,s,l,u="",f,c;i&16&&(a=UT(e,r-e.l)),i&128&&(o=UT(e,r-e.l)),(i&257)===257&&(s=UT(e,r-e.l)),(i&257)===1&&(l=yHt(e,r-e.l)),i&8&&(u=UT(e,r-e.l)),i&32&&(f=e.read_shift(16)),i&64&&(c=mj(e)),e.l=r;var h=o||s||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return f&&(d.guid=f),c&&(d.time=c),a&&(d.Tooltip=a),d}function rye(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function nye(e,t){var r=rye(e);return r[3]=0,r}function Pl(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function bHt(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function wHt(e,t,r){return t===0?"":gv(e,t,r)}function _Ht(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function iye(e){var t=e.read_shift(2),r=gj(e);return[t,r]}function SHt(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=J1(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function qA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function aye(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var CHt=aye;function oye(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function xHt(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function THt(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Pi(e){e.l+=2,e.l+=e.read_shift(2)}var OHt={0:Pi,4:Pi,5:Pi,6:Pi,7:THt,8:Pi,9:Pi,10:Pi,11:Pi,12:Pi,13:xHt,14:Pi,15:Pi,16:Pi,17:Pi,18:Pi,19:Pi,20:Pi,21:oye};function EHt(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(OHt[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function jT(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function RHt(e,t){return t===0||e.read_shift(2),1200}function kHt(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=gv(e,0,r);return e.read_shift(t+n-e.l),i}function AHt(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function PHt(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=J1(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function IHt(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<r;++o)a.push(dHt(e));return a.Count=n,a.Unique=i,a}function MHt(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function DHt(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function $Ht(e){var t=bHt(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function NHt(e){return e.read_shift(2),e.read_shift(4)}function one(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function LHt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:s,Selected:l,TabRatio:u}}function FHt(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function HHt(){}function BHt(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=J1(e,0,r),n}function WHt(e){var t=Pl(e);return t.isst=e.read_shift(4),t}function VHt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Pl(e);r.biff==2&&e.l++;var a=Q1(e,n-e.l,r);return i.val=a,i}function UHt(e,t,r){var n=e.read_shift(2),i=gv(e,0,r);return[n,i]}var jHt=gv;function sne(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),s=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:s},e:{r:o,c:l}}}function zHt(e){var t=e.read_shift(2),r=e.read_shift(2),n=iye(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function GHt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(iye(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function YHt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function KHt(e,t,r,n){var i={},a=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(2);return i.patternType=zFt[s>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=s&127,i.icvBottom=s>>7&127,i.icvDiag=s>>14&127,i.dgDiag=s>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function XHt(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=KHt(e,t,n.fStyle,r),n}function qHt(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function lne(e,t,r){var n=Pl(e);(r.biff==2||t==9)&&++e.l;var i=hHt(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function ZHt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Pl(e),i=Ni(e);return n.val=i,n}var une=wHt;function JHt(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Gd(e,a),s=[];n>e.l;)s.push(Q1(e));return[a,i,o,s]}function fne(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=SHt(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var QHt=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function cne(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Gd(e,o,r);i&32&&(u=QHt[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var c=n==e.l||s===0||!(f>0)?[]:DWt(e,f,r,s);return{chKey:a,Name:u,itab:l,rgce:c}}function sye(e,t,r){if(r.biff<8)return eBt(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(_Ht(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function eBt(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=J1(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function tBt(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Gd(e,n,r),o=Gd(e,i,r);return[a,o]}function rBt(e,t,r){var n=aye(e);e.l++;var i=e.read_shift(1);return t-=8,[$Wt(e,t,r),i,n]}function hne(e,t,r){var n=CHt(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,IWt(e,t,r)]}function nBt(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function iBt(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=gv(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},s,o,a]}}function aBt(e,t,r){return iBt(e,t,r)}function oBt(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(qA(e));return r}function sBt(e,t,r){if(r&&r.biff<8)return uBt(e,t,r);var n=oye(e),i=EHt(e,t-22,n[1]);return{cmo:n,ft:i}}var lBt={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function uBt(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((lBt[n]||ji)(e,t,r)),{cmo:[i,n,a],ft:o}}function fBt(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=vHt(e,6,r);var s=e.read_shift(2);e.read_shift(2),Jn(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],c=Gd(e,e.lens[u+1]-e.lens[u]-1);if(i+=c,i.length>=(f?s:2*s))break}if(i.length!==s&&i.length!==s*2)throw new Error("cchText: "+s+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function cBt(e,t){var r=qA(e);e.l+=16;var n=mHt(e,t-24);return[r,n]}function hBt(e,t){e.read_shift(2);var r=qA(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(pa,""),[r,n]}function dBt(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=tne[r]||r,r=e.read_shift(2),t[1]=tne[r]||r,t}function vBt(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nye(e));return r}function pBt(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nye(e));return r}function gBt(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function lye(e,t,r){if(!r.cellStyles)return ji(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:a,w:o,ixfe:s,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function yBt(e,t){var r={};return t<32||(e.l+=16,r.header=Ni(e),r.footer=Ni(e),e.l+=2),r}function mBt(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var bBt=Pl,wBt=tye,_Bt=Q1;function SBt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function CBt(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Pl(e);++e.l;var i=gv(e,t-7,r);return n.t="str",n.val=i,n}function xBt(e){var t=Pl(e);++e.l;var r=Ni(e);return t.t="n",t.val=r,t}function TBt(e){var t=Pl(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function OBt(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function EBt(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function RBt(e,t,r){var n=e.l+t,i=Pl(e),a=e.read_shift(2),o=Gd(e,a,r);return e.l=n,i.t="str",i.val=o,i}var kBt=[2,3,48,49,131,139,140,245],dne=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=sj({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(s,l){var u=[],f=Pc(1);switch(l.type){case"base64":f=Ts(fo(s));break;case"binary":f=Ts(s);break;case"buffer":case"array":f=s;break}xi(f,0);var c=f.read_shift(1),h=!!(c&136),d=!1,v=!1;switch(c){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+c.toString(16))}var g=0,y=521;c==2&&(g=f.read_shift(2)),f.l+=3,c!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),c!=2&&(y=f.read_shift(2));var b=f.read_shift(2),w=l.codepage||1252;c!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var _=[],x={},E=Math.min(f.length,c==2?521:y-10-(d?264:0)),R=v?32:11;f.l<E&&f[f.l]!=13;)switch(x={},x.name=Wf.utils.decode(w,f.slice(f.l,f.l+R)).replace(/[\u0000\r\n].*$/g,""),f.l+=R,x.type=String.fromCharCode(f.read_shift(1)),c!=2&&!v&&(x.offset=f.read_shift(4)),x.len=f.read_shift(1),c==2&&(x.offset=f.read_shift(2)),x.dec=f.read_shift(1),x.name.length&&_.push(x),c!=2&&(f.l+=v?13:14),x.type){case"B":(!d||x.len!=8)&&l.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+x.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var A=0,N=0;for(u[0]=[],N=0;N!=_.length;++N)u[0][N]=_[N].name;for(;g-- >0;){if(f[f.l]===42){f.l+=b;continue}for(++f.l,u[++A]=[],N=0,N=0;N!=_.length;++N){var I=f.slice(f.l,f.l+_[N].len);f.l+=_[N].len,xi(I,0);var F=Wf.utils.decode(w,I);switch(_[N].type){case"C":F.trim().length&&(u[A][N]=F.replace(/\s+$/,""));break;case"D":F.length===8?u[A][N]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):u[A][N]=F;break;case"F":u[A][N]=parseFloat(F.trim());break;case"+":case"I":u[A][N]=v?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":u[A][N]=!0;break;case"N":case"F":u[A][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+c.toString(16));u[A][N]="##MEMO##"+(v?parseInt(F.trim(),10):I.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(u[A][N]=+F||0);break;case"@":u[A][N]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":u[A][N]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":u[A][N]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][N]=-I.read_shift(-8,"f");break;case"B":if(d&&_[N].len==8){u[A][N]=I.read_shift(8,"f");break}case"G":case"P":I.l+=_[N].len;break;case"0":if(_[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[N].type)}}}if(c!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(s,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Zm(r(s,u),u);return f["!cols"]=u.DBF.map(function(c){return{wch:c.len,DBF:c}}),delete u.DBF,f}function i(s,l){try{return Lc(n(s,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,l){var u=l||{};if(+u.codepage>=0&&ks(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=AB(),c=BB(s,{header:1,raw:!0,cellDates:!0}),h=c[0],d=c.slice(1),v=s["!cols"]||[],g=0,y=0,b=0,w=1;for(g=0;g<h.length;++g){if(((v[g]||{}).DBF||{}).name){h[g]=v[g].DBF.name,++b;continue}if(h[g]!=null){if(++b,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var _=Dn(s["!ref"]),x=[],E=[],R=[];for(g=0;g<=_.e.c-_.s.c;++g){var A="",N="",I=0,F=[];for(y=0;y<d.length;++y)d[y][g]!=null&&F.push(d[y][g]);if(F.length==0||h[g]==null){x[g]="?";continue}for(y=0;y<F.length;++y){switch(typeof F[y]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=F[y]instanceof Date?"D":"C";break;default:N="C"}I=Math.max(I,String(F[y]).length),A=A&&A!=N?"C":N}I>250&&(I=250),N=((v[g]||{}).DBF||{}).type,N=="C"&&v[g].DBF.len>I&&(I=v[g].DBF.len),A=="B"&&N=="N"&&(A="N",R[g]=v[g].DBF.dec,I=v[g].DBF.len),E[g]=A=="C"||N=="N"?I:a[A]||0,w+=E[g],x[g]=A}var H=f.next(32);for(H.write_shift(4,318902576),H.write_shift(4,d.length),H.write_shift(2,296+32*b),H.write_shift(2,w),g=0;g<4;++g)H.write_shift(4,0);for(H.write_shift(4,0|(+t[oge]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var W=f.next(32),z=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,z,"sbcs"),W.write_shift(1,x[g]=="?"?"C":x[g],"sbcs"),W.write_shift(4,y),W.write_shift(1,E[g]||a[x[g]]||0),W.write_shift(1,R[g]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),y+=E[g]||a[x[g]]||0}var te=f.next(264);for(te.write_shift(4,13),g=0;g<65;++g)te.write_shift(4,0);for(g=0;g<d.length;++g){var ie=f.next(w);for(ie.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(x[y]){case"L":ie.write_shift(1,d[g][y]==null?63:d[g][y]?84:70);break;case"B":ie.write_shift(8,d[g][y]||0,"f");break;case"N":var fe="0";for(typeof d[g][y]=="number"&&(fe=d[g][y].toFixed(R[y]||0)),b=0;b<E[y]-fe.length;++b)ie.write_shift(1,32);ie.write_shift(1,fe,"sbcs");break;case"D":d[g][y]?(ie.write_shift(4,("0000"+d[g][y].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(d[g][y].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+d[g][y].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var Te=String(d[g][y]!=null?d[g][y]:"").slice(0,E[y]);for(ie.write_shift(1,Te,"sbcs"),b=0;b<E[y]-Te.length;++b)ie.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),ABt=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wl(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var v=e[d];return typeof v=="number"?kre(v):v},n=function(h,d,v){var g=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?h:kre(g)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return a(fo(h),d);case"binary":return a(h,d);case"buffer":return a(_r&&Buffer.isBuffer(h)?h.toString("binary"):hv(h),d);case"array":return a(zd(h),d)}throw new Error("Unrecognized type "+d.type)}function a(h,d){var v=h.split(/[\n\r]+/),g=-1,y=-1,b=0,w=0,_=[],x=[],E=null,R={},A=[],N=[],I=[],F=0,H;for(+d.codepage>=0&&ks(+d.codepage);b!==v.length;++b){F=0;var W=v[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=W.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),te=z[0],ie;if(W.length>0)switch(te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&x.push(W.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,Te=!1,M=!1,S=!1,T=-1,k=-1;for(w=1;w<z.length;++w)switch(z[w].charAt(0)){case"A":break;case"X":y=parseInt(z[w].slice(1))-1,Te=!0;break;case"Y":for(g=parseInt(z[w].slice(1))-1,Te||(y=0),H=_.length;H<=g;++H)_[H]=[];break;case"K":ie=z[w].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(Ps(ie))?isNaN(Em(ie).getDate())||(ie=bi(ie)):(ie=Ps(ie),E!==null&&Xm(E)&&(ie=XA(ie))),fe=!0;break;case"E":S=!0;var O=fg(z[w].slice(1),{r:g,c:y});_[g][y]=[_[g][y],O];break;case"S":M=!0,_[g][y]=[_[g][y],"S5S"];break;case"G":break;case"R":T=parseInt(z[w].slice(1))-1;break;case"C":k=parseInt(z[w].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+W)}if(fe&&(_[g][y]&&_[g][y].length==2?_[g][y][0]=ie:_[g][y]=ie,E=null),M){if(S)throw new Error("SYLK shared formula cannot have own formula");var D=T>-1&&_[T][k];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");_[g][y][1]=mye(D[1],{r:g-T,c:y-k})}break;case"F":var L=0;for(w=1;w<z.length;++w)switch(z[w].charAt(0)){case"X":y=parseInt(z[w].slice(1))-1,++L;break;case"Y":for(g=parseInt(z[w].slice(1))-1,H=_.length;H<=g;++H)_[H]=[];break;case"M":F=parseInt(z[w].slice(1))/20;break;case"F":break;case"G":break;case"P":E=x[parseInt(z[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=z[w].slice(1).split(" "),H=parseInt(I[0],10);H<=parseInt(I[1],10);++H)F=parseInt(I[2],10),N[H-1]=F===0?{hidden:!0}:{wch:F},Rm(N[H-1]);break;case"C":y=parseInt(z[w].slice(1))-1,N[y]||(N[y]={});break;case"R":g=parseInt(z[w].slice(1))-1,A[g]||(A[g]={}),F>0?(A[g].hpt=F,A[g].hpx=GS(F)):F===0&&(A[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+W)}L<1&&(E=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+W)}}return A.length>0&&(R["!rows"]=A),N.length>0&&(R["!cols"]=N),d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),[_,R]}function o(h,d){var v=i(h,d),g=v[0],y=v[1],b=Zm(g,d);return wl(y).forEach(function(w){b[w]=y[w]}),b}function s(h,d){return Lc(o(h,d),d)}function l(h,d,v,g){var y="C;Y"+(v+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+g4t(h.f,{r:v,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,d){d.forEach(function(v,g){var y="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=nk(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ik(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function f(h,d){d.forEach(function(v,g){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*pye(v.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function c(h,d){var v=["ID;PWXL;N;E"],g=[],y=Dn(h["!ref"]),b,w=Array.isArray(h),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&u(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var x=y.s.r;x<=y.e.r;++x)for(var E=y.s.c;E<=y.e.c;++E){var R=Gt({r:x,c:E});b=w?(h[x]||[])[E]:h[R],!(!b||b.v==null&&(!b.f||b.F))&&g.push(l(b,h,x,E))}return v.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:s,to_sheet:o,from_sheet:c}}(),PBt=function(){function e(a,o){switch(o.type){case"base64":return t(fo(a),o);case"binary":return t(a,o);case"buffer":return t(_r&&Buffer.isBuffer(a)?a.toString("binary"):hv(a),o);case"array":return t(zd(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var s=a.split(`
`),l=-1,u=-1,f=0,c=[];f!==s.length;++f){if(s[f].trim()==="BOT"){c[++l]=[],u=0;continue}if(!(l<0)){var h=s[f].trim().split(","),d=h[0],v=h[1];++f;for(var g=s[f]||"";(g.match(/["]/g)||[]).length&1&&f<s.length-1;)g+=`
`+s[++f];switch(g=g.trim(),+d){case-1:if(g==="BOT"){c[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?c[l][u]=!0:g==="FALSE"?c[l][u]=!1:isNaN(Ps(v))?isNaN(Em(v).getDate())?c[l][u]=v:c[l][u]=bi(v):c[l][u]=Ps(v),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),c[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(c=c.slice(0,o.sheetRows)),c}function r(a,o){return Zm(e(a,o),o)}function n(a,o){return Lc(r(a,o),o)}var i=function(){var a=function(l,u,f,c,h){l.push(u),l.push(f+","+c),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,u,f,c){l.push(u+","+f),l.push(u==1?'"'+c.replace(/"/g,'""')+'"':c)};return function(l){var u=[],f=Dn(l["!ref"]),c,h=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){o(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var g=Gt({r:d,c:v});if(c=h?(l[d]||[])[v]:l[g],!c){o(u,1,0,"");continue}switch(c.t){case"n":var y=c.w;!y&&c.v!=null&&(y=c.v),y==null?c.f&&!c.F?o(u,1,0,"="+c.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,c.v?1:0,c.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(c.v)?c.v:'="'+c.v+'"');break;case"d":c.w||(c.w=Ko(c.z||er[14],ma(bi(c.v)))),o(u,0,c.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,w=u.join(b);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),IBt=function(){function e(c){return c.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(c){return c.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(c,h){for(var d=c.split(`
`),v=-1,g=-1,y=0,b=[];y!==d.length;++y){var w=d[y].trim().split(":");if(w[0]==="cell"){var _=ha(w[1]);if(b.length<=_.r)for(v=b.length;v<=_.r;++v)b[v]||(b[v]=[]);switch(v=_.r,g=_.c,w[2]){case"t":b[v][g]=e(w[3]);break;case"v":b[v][g]=+w[3];break;case"vtf":var x=w[w.length-1];case"vtc":switch(w[3]){case"nl":b[v][g]=!!+w[4];break;default:b[v][g]=+w[4];break}w[2]=="vtf"&&(b[v][g]=[b[v][g],x])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(c,h){return Zm(r(c,h),h)}function i(c,h){return Lc(n(c,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(c){if(!c||!c["!ref"])return"";for(var h=[],d=[],v,g="",y=qm(c["!ref"]),b=Array.isArray(c),w=y.s.r;w<=y.e.r;++w)for(var _=y.s.c;_<=y.e.c;++_)if(g=Gt({r:w,c:_}),v=b?(c[w]||[])[_]:c[g],!(!v||v.v==null||v.t==="z")){switch(d=["cell",g,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var x=ma(bi(v.v));d[2]="vtc",d[3]="nd",d[4]=""+x,d[5]=v.w||Ko(v.z||er[14],x);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(c){return[a,o,s,o,u(c),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),jS=function(){function e(f,c,h,d,v){v.raw?c[h][d]=f:f===""||(f==="TRUE"?c[h][d]=!0:f==="FALSE"?c[h][d]=!1:isNaN(Ps(f))?isNaN(Em(f).getDate())?c[h][d]=f:c[h][d]=bi(f):c[h][d]=Ps(f))}function t(f,c){var h=c||{},d=[];if(!f||f.length===0)return d;for(var v=f.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var y=10,b=0,w=0;w<=g;++w)b=v[w].indexOf(" "),b==-1?b=v[w].length:b++,y=Math.max(y,b);for(w=0;w<=g;++w){d[w]=[];var _=0;for(e(v[w].slice(0,y).trim(),d,w,_,h),_=1;_<=(v[w].length-y)/10+1;++_)e(v[w].slice(y+(_-1)*10,y+_*10).trim(),d,w,_,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var c={},h=!1,d=0,v=0;d<f.length;++d)(v=f.charCodeAt(d))==34?h=!h:!h&&v in r&&(c[v]=(c[v]||0)+1);v=[];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d]);if(!v.length){c=n;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d])}return v.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[v.pop()[1]]||44}function a(f,c){var h=c||{},d="",v=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=i(f.slice(0,1024)):h&&h.FS?d=h.FS:d=i(f.slice(0,1024));var y=0,b=0,w=0,_=0,x=0,E=d.charCodeAt(0),R=!1,A=0,N=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var I=h.dateNF!=null?jLt(h.dateNF):null;function F(){var H=f.slice(_,x),W={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)W.t="z";else if(h.raw)W.t="s",W.v=H;else if(H.trim().length===0)W.t="s",W.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(W.t="s",W.v=H.slice(2,-1).replace(/""/g,'"')):m4t(H)?(W.t="n",W.f=H.slice(1)):(W.t="s",W.v=H);else if(H=="TRUE")W.t="b",W.v=!0;else if(H=="FALSE")W.t="b",W.v=!1;else if(!isNaN(w=Ps(H)))W.t="n",h.cellText!==!1&&(W.w=H),W.v=w;else if(!isNaN(Em(H).getDate())||I&&H.match(I)){W.z=h.dateNF||er[14];var z=0;I&&H.match(I)&&(H=zLt(H,h.dateNF,H.match(I)||[]),z=1),h.cellDates?(W.t="d",W.v=bi(H,z)):(W.t="n",W.v=ma(bi(H,z))),h.cellText!==!1&&(W.w=Ko(W.z,W.v instanceof Date?ma(W.v):W.v)),h.cellNF||delete W.z}else W.t="s",W.v=H;if(W.t=="z"||(h.dense?(v[y]||(v[y]=[]),v[y][b]=W):v[Gt({c:b,r:y})]=W),_=x+1,N=f.charCodeAt(_),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),A==E)++b;else if(b=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;x<f.length;++x)switch(A=f.charCodeAt(x)){case 34:N===34&&(R=!R);break;case E:case 10:case 13:if(!R&&F())break e;break}return x-_>0&&F(),v["!ref"]=Or(g),v}function o(f,c){return!(c&&c.PRN)||c.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,c):Zm(t(f,c),c)}function s(f,c){var h="",d=c.type=="string"?[0,0,0,0]:Oj(f,c);switch(c.type){case"base64":h=fo(f);break;case"binary":h=f;break;case"buffer":c.codepage==65001?h=f.toString("utf8"):c.codepage&&typeof Wf<"u"?h=Wf.utils.decode(c.codepage,f):h=_r&&Buffer.isBuffer(f)?f.toString("binary"):hv(f);break;case"array":h=zd(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+c.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=an(h.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?h=an(h):c.type=="binary"&&typeof Wf<"u"&&c.codepage&&(h=Wf.utils.decode(c.codepage,Wf.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?IBt.to_sheet(c.type=="string"?h:an(h),c):o(h,c)}function l(f,c){return Lc(s(f,c),c)}function u(f){for(var c=[],h=Dn(f["!ref"]),d,v=Array.isArray(f),g=h.s.r;g<=h.e.r;++g){for(var y=[],b=h.s.c;b<=h.e.c;++b){var w=Gt({r:g,c:b});if(d=v?(f[g]||[])[b]:f[w],!d||d.v==null){y.push("          ");continue}for(var _=(d.w||(Ku(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";y.push(_+(b===0?" ":""))}c.push(y.join(""))}return c.join(`
`)}return{to_workbook:l,to_sheet:s,from_sheet:u}}();function MBt(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=ABt.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return jS.to_workbook(e,t)}}var pw=function(){function e(O,D,L){if(O){xi(O,O.l||0);for(var B=L.Enum||T;O.l<O.length;){var Y=O.read_shift(2),Q=B[Y]||B[65535],he=O.read_shift(2),ce=O.l+he,le=Q.f&&Q.f(O,he,L);if(O.l=ce,D(le,Q,Y))return}}}function t(O,D){switch(D.type){case"base64":return r(Ts(fo(O)),D);case"binary":return r(Ts(O),D);case"buffer":case"array":return r(O,D)}throw"Unsupported type "+D.type}function r(O,D){if(!O)return O;var L=D||{},B=L.dense?[]:{},Y="Sheet1",Q="",he=0,ce={},le=[],xe=[],U={s:{r:0,c:0},e:{r:0,c:0}},De=L.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)L.Enum=T,e(O,function(Ae,Ke,Xe){switch(Xe){case 0:L.vers=Ae,Ae>=4096&&(L.qpro=!0);break;case 6:U=Ae;break;case 204:Ae&&(Q=Ae);break;case 222:Q=Ae;break;case 15:case 51:L.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=L.dateNF||er[14],L.cellDates&&(Ae[1].t="d",Ae[1].v=XA(Ae[1].v))),L.qpro&&Ae[3]>he&&(B["!ref"]=Or(U),ce[Y]=B,le.push(Y),B=L.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},he=Ae[3],Y=Q||"Sheet"+(he+1),Q="");var G=L.dense?(B[Ae[0].r]||[])[Ae[0].c]:B[Gt(Ae[0])];if(G){G.t=Ae[1].t,G.v=Ae[1].v,Ae[1].z!=null&&(G.z=Ae[1].z),Ae[1].f!=null&&(G.f=Ae[1].f);break}L.dense?(B[Ae[0].r]||(B[Ae[0].r]=[]),B[Ae[0].r][Ae[0].c]=Ae[1]):B[Gt(Ae[0])]=Ae[1];break}},L);else if(O[2]==26||O[2]==14)L.Enum=k,O[2]==14&&(L.qpro=!0,O.l=0),e(O,function(Ae,Ke,Xe){switch(Xe){case 204:Y=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>he&&(B["!ref"]=Or(U),ce[Y]=B,le.push(Y),B=L.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},he=Ae[3],Y="Sheet"+(he+1)),De>0&&Ae[0].r>=De)break;L.dense?(B[Ae[0].r]||(B[Ae[0].r]=[]),B[Ae[0].r][Ae[0].c]=Ae[1]):B[Gt(Ae[0])]=Ae[1],U.e.c<Ae[0].c&&(U.e.c=Ae[0].c),U.e.r<Ae[0].r&&(U.e.r=Ae[0].r);break;case 27:Ae[14e3]&&(xe[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:xe[Ae[0]]=Ae[1],Ae[0]==he&&(Y=Ae[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(B["!ref"]=Or(U),ce[Q||Y]=B,le.push(Q||Y),!xe.length)return{SheetNames:le,Sheets:ce};for(var de={},He=[],Be=0;Be<xe.length;++Be)ce[le[Be]]?(He.push(xe[Be]||le[Be]),de[xe[Be]]=ce[xe[Be]]||ce[le[Be]]):(He.push(xe[Be]),de[xe[Be]]={"!ref":"A1"});return{SheetNames:He,Sheets:de}}function n(O,D){var L=D||{};if(+L.codepage>=0&&ks(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var B=AB(),Y=Dn(O["!ref"]),Q=Array.isArray(O),he=[];vs(B,0,a(1030)),vs(B,6,l(Y));for(var ce=Math.min(Y.e.r,8191),le=Y.s.r;le<=ce;++le)for(var xe=Oi(le),U=Y.s.c;U<=Y.e.c;++U){le===Y.s.r&&(he[U]=fi(U));var De=he[U]+xe,de=Q?(O[le]||[])[U]:O[De];if(!(!de||de.t=="z"))if(de.t=="n")(de.v|0)==de.v&&de.v>=-32768&&de.v<=32767?vs(B,13,d(le,U,de.v)):vs(B,14,g(le,U,de.v));else{var He=Ku(de);vs(B,15,c(le,U,He.slice(0,239)))}}return vs(B,1),B.end()}function i(O,D){var L=D||{};if(+L.codepage>=0&&ks(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var B=AB();vs(B,0,o(O));for(var Y=0,Q=0;Y<O.SheetNames.length;++Y)(O.Sheets[O.SheetNames[Y]]||{})["!ref"]&&vs(B,27,S(O.SheetNames[Y],Q++));var he=0;for(Y=0;Y<O.SheetNames.length;++Y){var ce=O.Sheets[O.SheetNames[Y]];if(!(!ce||!ce["!ref"])){for(var le=Dn(ce["!ref"]),xe=Array.isArray(ce),U=[],De=Math.min(le.e.r,8191),de=le.s.r;de<=De;++de)for(var He=Oi(de),Be=le.s.c;Be<=le.e.c;++Be){de===le.s.r&&(U[Be]=fi(Be));var Ae=U[Be]+He,Ke=xe?(ce[de]||[])[Be]:ce[Ae];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")vs(B,23,F(de,Be,he,Ke.v));else{var Xe=Ku(Ke);vs(B,22,A(de,Be,he,Xe.slice(0,239)))}}++he}}return vs(B,1),B.end()}function a(O){var D=oi(2);return D.write_shift(2,O),D}function o(O){var D=oi(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var L=0,B=0,Y=0,Q=0;Q<O.SheetNames.length;++Q){var he=O.SheetNames[Q],ce=O.Sheets[he];if(!(!ce||!ce["!ref"])){++Y;var le=qm(ce["!ref"]);L<le.e.r&&(L=le.e.r),B<le.e.c&&(B=le.e.c)}}return L>8191&&(L=8191),D.write_shift(2,L),D.write_shift(1,Y),D.write_shift(1,B),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function s(O,D,L){var B={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&L.qpro?(B.s.c=O.read_shift(1),O.l++,B.s.r=O.read_shift(2),B.e.c=O.read_shift(1),O.l++,B.e.r=O.read_shift(2),B):(B.s.c=O.read_shift(2),B.s.r=O.read_shift(2),D==12&&L.qpro&&(O.l+=2),B.e.c=O.read_shift(2),B.e.r=O.read_shift(2),D==12&&L.qpro&&(O.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(O){var D=oi(8);return D.write_shift(2,O.s.c),D.write_shift(2,O.s.r),D.write_shift(2,O.e.c),D.write_shift(2,O.e.r),D}function u(O,D,L){var B=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(B[0].c=O.read_shift(1),B[3]=O.read_shift(1),B[0].r=O.read_shift(2),O.l+=2):(B[2]=O.read_shift(1),B[0].c=O.read_shift(2),B[0].r=O.read_shift(2)),B}function f(O,D,L){var B=O.l+D,Y=u(O,D,L);if(Y[1].t="s",L.vers==20768){O.l++;var Q=O.read_shift(1);return Y[1].v=O.read_shift(Q,"utf8"),Y}return L.qpro&&O.l++,Y[1].v=O.read_shift(B-O.l,"cstr"),Y}function c(O,D,L){var B=oi(7+L.length);B.write_shift(1,255),B.write_shift(2,D),B.write_shift(2,O),B.write_shift(1,39);for(var Y=0;Y<B.length;++Y){var Q=L.charCodeAt(Y);B.write_shift(1,Q>=128?95:Q)}return B.write_shift(1,0),B}function h(O,D,L){var B=u(O,D,L);return B[1].v=O.read_shift(2,"i"),B}function d(O,D,L){var B=oi(7);return B.write_shift(1,255),B.write_shift(2,D),B.write_shift(2,O),B.write_shift(2,L,"i"),B}function v(O,D,L){var B=u(O,D,L);return B[1].v=O.read_shift(8,"f"),B}function g(O,D,L){var B=oi(13);return B.write_shift(1,255),B.write_shift(2,D),B.write_shift(2,O),B.write_shift(8,L,"f"),B}function y(O,D,L){var B=O.l+D,Y=u(O,D,L);if(Y[1].v=O.read_shift(8,"f"),L.qpro)O.l=B;else{var Q=O.read_shift(2);x(O.slice(O.l,O.l+Q),Y),O.l+=Q}return Y}function b(O,D,L){var B=D&32768;return D&=-32769,D=(B?O:0)+(D>=8192?D-16384:D),(B?"":"$")+(L?fi(D):Oi(D))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function x(O,D){xi(O,0);for(var L=[],B=0,Y="",Q="",he="",ce="";O.l<O.length;){var le=O[O.l++];switch(le){case 0:L.push(O.read_shift(8,"f"));break;case 1:Q=b(D[0].c,O.read_shift(2),!0),Y=b(D[0].r,O.read_shift(2),!1),L.push(Q+Y);break;case 2:{var xe=b(D[0].c,O.read_shift(2),!0),U=b(D[0].r,O.read_shift(2),!1);Q=b(D[0].c,O.read_shift(2),!0),Y=b(D[0].r,O.read_shift(2),!1),L.push(xe+U+":"+Q+Y)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(O.read_shift(2));break;case 6:{for(var De="";le=O[O.l++];)De+=String.fromCharCode(le);L.push('"'+De.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:ce=L.pop(),he=L.pop(),L.push(["AND","OR"][le-20]+"("+he+","+ce+")");break;default:if(le<32&&_[le])ce=L.pop(),he=L.pop(),L.push(he+_[le]+ce);else if(w[le]){if(B=w[le][1],B==69&&(B=O[O.l++]),B>L.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+L.join("|")+"|");return}var de=L.slice(-B);L.length-=B,L.push(w[le][0]+"("+de.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}L.length==1?D[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function E(O){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=O.read_shift(2),D[3]=O[O.l++],D[0].c=O[O.l++],D}function R(O,D){var L=E(O);return L[1].t="s",L[1].v=O.read_shift(D-4,"cstr"),L}function A(O,D,L,B){var Y=oi(6+B.length);Y.write_shift(2,O),Y.write_shift(1,L),Y.write_shift(1,D),Y.write_shift(1,39);for(var Q=0;Q<B.length;++Q){var he=B.charCodeAt(Q);Y.write_shift(1,he>=128?95:he)}return Y.write_shift(1,0),Y}function N(O,D){var L=E(O);L[1].v=O.read_shift(2);var B=L[1].v>>1;if(L[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return L[1].v=B,L}function I(O,D){var L=E(O),B=O.read_shift(4),Y=O.read_shift(4),Q=O.read_shift(2);if(Q==65535)return B===0&&Y===3221225472?(L[1].t="e",L[1].v=15):B===0&&Y===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var he=Q&32768;return Q=(Q&32767)-16446,L[1].v=(1-he*2)*(Y*Math.pow(2,Q+32)+B*Math.pow(2,Q)),L}function F(O,D,L,B){var Y=oi(14);if(Y.write_shift(2,O),Y.write_shift(1,L),Y.write_shift(1,D),B==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var Q=0,he=0,ce=0,le=0;return B<0&&(Q=1,B=-B),he=Math.log2(B)|0,B/=Math.pow(2,he-31),le=B>>>0,le&2147483648||(B/=2,++he,le=B>>>0),B-=le,le|=2147483648,le>>>=0,B*=Math.pow(2,32),ce=B>>>0,Y.write_shift(4,ce),Y.write_shift(4,le),he+=16383+(Q?32768:0),Y.write_shift(2,he),Y}function H(O,D){var L=I(O);return O.l+=D-14,L}function W(O,D){var L=E(O),B=O.read_shift(4);return L[1].v=B>>6,L}function z(O,D){var L=E(O),B=O.read_shift(8,"f");return L[1].v=B,L}function te(O,D){var L=z(O);return O.l+=D-10,L}function ie(O,D){return O[O.l+D-1]==0?O.read_shift(D,"cstr"):""}function fe(O,D){var L=O[O.l++];L>D-1&&(L=D-1);for(var B="";B.length<L;)B+=String.fromCharCode(O[O.l++]);return B}function Te(O,D,L){if(!(!L.qpro||D<21)){var B=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var Y=O.read_shift(D-21,"cstr");return[B,Y]}}function M(O,D){for(var L={},B=O.l+D;O.l<B;){var Y=O.read_shift(2);if(Y==14e3){for(L[Y]=[0,""],L[Y][0]=O.read_shift(2);O[O.l];)L[Y][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return L}function S(O,D){var L=oi(5+O.length);L.write_shift(2,14e3),L.write_shift(2,D);for(var B=0;B<O.length;++B){var Y=O.charCodeAt(B);L[L.l++]=Y>127?95:Y}return L[L.l++]=0,L}var T={0:{n:"BOF",f:Jn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},k={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:M},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function DBt(e){var t={},r=e.match(Yi),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=Bt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=rj[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var $Bt=function(){var e=VS("t"),t=VS("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var s={t:"s",v:kr(o[1])},l=a.match(t);return l&&(s.s=DBt(l[1])),s}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(s){return s.v})}}(),NBt=function(){var t=/(\r\n|\n)/g;function r(i,a,o){var s=[];i.u&&s.push("text-decoration: underline;"),i.uval&&s.push("text-underline-style:"+i.uval+";"),i.sz&&s.push("font-size:"+i.sz+"pt;"),i.outline&&s.push("text-effect: outline;"),i.shadow&&s.push("text-shadow: auto;"),a.push('<span style="'+s.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),LBt=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,FBt=/<(?:\w+:)?r>/,HBt=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function bj(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=kr(an(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=an(e),r&&(n.h=uj(n.t))):e.match(FBt)&&(n.r=an(e),n.t=kr(an((e.replace(HBt,"").match(LBt)||[]).join("").replace(Yi,""))),r&&(n.h=NBt($Bt(n.r)))),n):{t:""}}var BBt=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,WBt=/<(?:\w+:)?(?:si|sstItem)>/g,VBt=/<\/(?:\w+:)?(?:si|sstItem)>/;function UBt(e,t){var r=[],n="";if(!e)return r;var i=e.match(BBt);if(i){n=i[2].replace(WBt,"").split(VBt);for(var a=0;a!=n.length;++a){var o=bj(n[a].trim(),t);o!=null&&(r[r.length]=o)}i=Bt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function jBt(e){return[e.read_shift(4),e.read_shift(4)]}function zBt(e,t){var r=[],n=!1;return nf(e,function(a,o,s){switch(s){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}function uye(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Hu(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function GBt(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Hu(e,4),t.U=Hu(e,4),t.W=Hu(e,4),t}function YBt(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function KBt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YBt(e));return t}function XBt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function qBt(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Hu(e,4),t.U=Hu(e,4),t.W=Hu(e,4),t}function ZBt(e){var t=qBt(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function fye(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cye(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function JBt(e){var t=Hu(e);switch(t.Minor){case 2:return[t.Minor,QBt(e)];case 3:return[t.Minor,e3t()];case 4:return[t.Minor,t3t(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function QBt(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=fye(e,r),i=cye(e,e.length-e.l);return{t:"Std",h:n,v:i}}function e3t(){throw new Error("File is password-protected: ECMA-376 Extensible")}function t3t(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Yi,function(a){var o=Bt(a);switch(Al(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(s){n[s]=o[s]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function r3t(e,t){var r={},n=r.EncryptionVersionInfo=Hu(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=fye(e,i),t-=i,r.EncryptionVerifier=cye(e,t),r}function n3t(e){var t={},r=t.EncryptionVersionInfo=Hu(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function i3t(e){var t=0,r,n=uye(e),i=n.length+1,a,o,s,l,u;for(r=Pc(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],s=t&16384?1:0,l=t<<1&32767,u=s|l,t=u^o;return t^52811}var hye=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,s){return n(o^s)},a=function(o){for(var s=t[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var f=o[u],c=0;c!=7;++c)f&64&&(s^=r[l]),f*=2,--l;return s};return function(o){for(var s=uye(o),l=a(s),u=s.length,f=Pc(16),c=0;c!=16;++c)f[c]=0;var h,d,v;for((u&1)===1&&(h=l>>8,f[u]=i(e[0],h),--u,h=l&255,d=s[s.length-1],f[u]=i(d,h));u>0;)--u,h=l>>8,f[u]=i(s[u],h),--u,h=l&255,f[u]=i(s[u],h);for(u=15,v=15-s.length;v>0;)h=l>>8,f[u]=i(e[v],h),--u,--v,h=l&255,f[u]=i(s[u],h),--u,--v;return f}}(),a3t=function(e,t,r,n,i){i||(i=t),n||(n=hye(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},o3t=function(e){var t=0,r=hye(e);return function(n){var i=a3t("",n,t,r);return t=i[1],i[0]}};function s3t(e,t,r,n){var i={key:Jn(e),verificationBytes:Jn(e)};return r.password&&(i.verifier=i3t(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=o3t(r.password)),i}function l3t(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=n3t(e):n.Data=r3t(e,t),n}function u3t(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?l3t(e,t-2,n):s3t(e,r.biff>=8?t:t-2,r,n),n}var f3t=function(){function e(i,a){switch(a.type){case"base64":return t(fo(i),a);case"binary":return t(i,a);case"buffer":return t(_r&&Buffer.isBuffer(i)?i.toString("binary"):hv(i),a);case"array":return t(zd(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},s=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,c){Array.isArray(s)&&(s[c]=[]);for(var h=/\\\w+\b/g,d=0,v,g=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var y=f.slice(d,h.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(s)?s[c][g]=b:s[Gt({r:c,c:g})]=b}break}d=h.lastIndex}g>u.e.c&&(u.e.c=g)}),s["!ref"]=Or(u),s}function r(i,a){return Lc(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Dn(i["!ref"]),s,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var c=Gt({r:u,c:f});s=l?(i[u]||[])[f]:i[c],!(!s||s.v==null&&(!s.f||s.F))&&(a.push(" "+(s.w||(Ku(s),s.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function c3t(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function zS(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function h3t(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var s=0,l=0,u=i+a;switch(l=o/(u>1?2-u:u),i){case t:s=((r-n)/o+6)%6;break;case r:s=(n-t)/o+2;break;case n:s=(t-r)/o+4;break}return[s/6,l,u/2]}function d3t(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],s=6*t,l;if(r!==0)switch(s|0){case 0:case 6:l=i*s,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-s),o[0]+=l,o[1]+=i;break;case 2:l=i*(s-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-s),o[1]+=l,o[2]+=i;break;case 4:l=i*(s-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-s),o[2]+=l,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function rk(e,t){if(t===0)return e;var r=h3t(c3t(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),zS(d3t(r))}var dye=6,v3t=15,p3t=1,fa=dye;function nk(e){return Math.floor((e+Math.round(128/fa)/256)*fa)}function ik(e){return Math.floor((e-5)/fa*100+.5)/100}function DB(e){return Math.round((e*fa+5)/fa*256)/256}function f$(e){return DB(ik(nk(e)))}function wj(e){var t=Math.abs(e-f$(e)),r=fa;if(t>.005)for(fa=p3t;fa<v3t;++fa)Math.abs(e-f$(e))<=t&&(t=Math.abs(e-f$(e)),r=fa);fa=r}function Rm(e){e.width?(e.wpx=nk(e.width),e.wch=ik(e.wpx),e.MDW=fa):e.wpx?(e.wch=ik(e.wpx),e.width=DB(e.wch),e.MDW=fa):typeof e.wch=="number"&&(e.width=DB(e.wch),e.wpx=nk(e.width),e.MDW=fa),e.customWidth&&delete e.customWidth}var g3t=96,vye=g3t;function pye(e){return e*96/vye}function GS(e){return e*vye/96}var y3t={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function m3t(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(Yi)||[]).forEach(function(o){var s=Bt(o);switch(Al(s[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},s.diagonalUp&&(i.diagonalUp=pn(s.diagonalUp)),s.diagonalDown&&(i.diagonalDown=pn(s.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in borders")}})}function b3t(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(Yi)||[]).forEach(function(o){var s=Bt(o);switch(Al(s[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":s.patternType&&(i.patternType=s.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),s.indexed&&(i.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(i.bgColor.theme=parseInt(s.theme,10)),s.tint&&(i.bgColor.tint=parseFloat(s.tint)),s.rgb&&(i.bgColor.rgb=s.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),s.theme&&(i.fgColor.theme=parseInt(s.theme,10)),s.tint&&(i.fgColor.tint=parseFloat(s.tint)),s.rgb!=null&&(i.fgColor.rgb=s.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fills")}})}function w3t(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(Yi)||[]).forEach(function(o){var s=Bt(o);switch(Al(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=an(s.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=s.val?pn(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?pn(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?pn(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?pn(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?pn(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?pn(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?pn(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(s.val=="1")break;s.codepage=rj[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=pn(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var l=xd[i.color.index];i.color.index==81&&(l=xd[1]),l||(l=xd[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=rk(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fonts")}})}function _3t(e,t,r){t.NumberFmt=[];for(var n=wl(er),i=0;i<n.length;++i)t.NumberFmt[n[i]]=er[n[i]];var a=e[0].match(Yi);if(a)for(i=0;i<a.length;++i){var o=Bt(a[i]);switch(Al(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var s=kr(an(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=s}Cd(s,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var zT=["numFmtId","fillId","fontId","borderId","xfId"],GT=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function S3t(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Yi)||[]).forEach(function(a){var o=Bt(a),s=0;switch(Al(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],s=0;s<zT.length;++s)n[zT[s]]&&(n[zT[s]]=parseInt(n[zT[s]],10));for(s=0;s<GT.length;++s)n[GT[s]]&&(n[GT[s]]=pn(n[GT[s]]));if(t.NumberFmt&&n.numFmtId>392){for(s=392;s>60;--s)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[s]){n.numFmtId=s;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=pn(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var C3t=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,l,u){var f={};if(!s)return f;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var c;return(c=s.match(t))&&_3t(c,f,u),(c=s.match(i))&&w3t(c,f,l,u),(c=s.match(n))&&b3t(c,f,l,u),(c=s.match(a))&&m3t(c,f,l,u),(c=s.match(r))&&S3t(c,f,u),f}}();function x3t(e,t){var r=e.read_shift(2),n=Bi(e);return[r,n]}function T3t(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=$Ft(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var s=e.read_shift(1);s>0&&(n.family=s);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=DFt(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Bi(e),n}var O3t=ji;function E3t(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var R3t=ji;function k3t(e,t,r){var n={};n.NumberFmt=[];for(var i in er)n.NumberFmt[i]=er[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return nf(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Cd(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=rk(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f),o=!0;break;case 38:a.pop(),o=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var A3t=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function P3t(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Yi)||[]).forEach(function(i){var a=Bt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[A3t.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function I3t(){}function M3t(){}var D3t=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,$3t=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,N3t=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function L3t(e,t,r){t.themeElements={};var n;[["clrScheme",D3t,P3t],["fontScheme",$3t,I3t],["fmtScheme",N3t,M3t]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var F3t=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function gye(e,t){(!e||e.length===0)&&(e=H3t());var r,n={};if(!(r=e.match(F3t)))throw new Error("themeElements not found in theme");return L3t(r[0],n,t),n.raw=e,n}function H3t(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ege];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function B3t(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=Oge(a,{type:"array"})}catch{return}var s=no(o,"theme/theme/theme1.xml",!0);if(s)return gye(s,r)}}function W3t(e){return e.read_shift(4)}function V3t(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=U3t(e,4);break;case 2:t.xclrValue=rye(e);break;case 3:t.xclrValue=W3t(e);break;case 4:e.l+=4;break}return e.l+=8,t}function U3t(e,t){return ji(e,t)}function j3t(e,t){return ji(e,t)}function z3t(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=V3t(e);break;case 6:n[1]=j3t(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function G3t(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(z3t(e,r-e.l));return{ixfe:n,ext:a}}function Y3t(e,t){t.forEach(function(r){switch(r[0]){}})}function K3t(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Bi(e)}}function X3t(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function q3t(e){return e.l+=4,e.read_shift(4)!=0}function Z3t(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,s=2;return nf(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(c){s==1?n.Cell.push({type:n.Types[c[0]-1].name,index:c[1]}):s==0&&n.Value.push({type:n.Types[c[0]-1].name,index:c[1]})});break;case 337:s=l?1:0;break;case 338:s=2;break;case 35:a.push(f),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function J3t(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(Yi,function(s){var l=Bt(s);switch(Al(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return s}),n}function Q3t(e){var t=[];if(!e)return t;var r=1;return(e.match(Yi)||[]).forEach(function(n){var i=Bt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function e4t(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Gt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function t4t(e,t,r){var n=[];return nf(e,function(a,o,s){switch(s){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+s.toString(16))}}),n}function r4t(e,t,r,n){if(!e)return e;var i=n||{},a=!1;nf(e,function(s,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function n4t(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function vne(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(o){var s=ha(o.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[o.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[o.ref]=a;var l=Dn(e["!ref"]||"BDWGO1000001:A1");l.s.r>s.r&&(l.s.r=s.r),l.e.r<s.r&&(l.e.r=s.r),l.s.c>s.c&&(l.s.c=s.c),l.e.c<s.c&&(l.e.c=s.c);var u=Or(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:o.author,t:o.t,r:o.r,T:r};o.h&&(f.h=o.h);for(var c=a.c.length-1;c>=0;--c){if(!r&&a.c[c].T)return;r&&!a.c[c].T&&a.c.splice(c,1)}if(r&&n){for(c=0;c<n.length;++c)if(f.a==n[c].id){f.a=n[c].name||f.a;break}}a.c.push(f)})}function i4t(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&r.push(s[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?comment[^>]*>/);if(s){var l=Bt(s[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=ha(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var c=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!c&&!!c[1]&&bj(c[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function a4t(e,t){var r=[],n=!1,i={},a=0;return e.replace(Yi,function(s,l){var u=Bt(s);switch(Al(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=l+s.length;break;case"</text>":i.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return s}),r}function o4t(e,t){var r=[],n=!1;return e.replace(Yi,function(a){var o=Bt(a);switch(Al(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function s4t(e){var t={};t.iauthor=e.read_shift(4);var r=vv(e);return t.rfx=r.s,t.ref=Gt(r.s),e.l+=16,t}var l4t=Bi;function u4t(e,t){var r=[],n=[],i={},a=!1;return nf(e,function(s,l,u){switch(u){case 632:n.push(s);break;case 635:i=s;break;case 637:i.t=s.t,i.h=s.h,i.r=s.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var f4t="application/vnd.ms-office.vbaProject";function c4t(e){var t=xr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");xr.utils.cfb_add(t,i,e.FileIndex[n].content)}}),xr.write(t)}function h4t(){return{"!type":"dialog"}}function d4t(){return{"!type":"dialog"}}function v4t(){return{"!type":"macro"}}function p4t(){return{"!type":"macro"}}var fg=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,o){var s=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return s?f+=t.c:--f,l?u+=t.r:--u,i+(s?"":"$")+fi(f)+(l?"":"$")+Oi(u)}return function(i,a){return t=a,i.replace(e,r)}}(),yye=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,g4t=function(){return function(t,r){return t.replace(yye,function(n,i,a,o,s,l){var u=dj(o)-(a?0:r.c),f=hj(l)-(s?0:r.r),c=f==0?"":s?f+1:"["+f+"]",h=u==0?"":a?u+1:"["+u+"]";return i+"R"+c+"C"+h})}}();function mye(e,t){return e.replace(yye,function(r,n,i,a,o,s){return n+(i=="$"?i+a:fi(dj(a)+t.c))+(o=="$"?o+s:Oi(hj(s)+t.r))})}function y4t(e,t,r){var n=qm(t),i=n.s,a=ha(r),o={r:a.r-i.r,c:a.c-i.c};return mye(e,o)}function m4t(e){return e.length!=1}function pne(e){return e.replace(/_xlfn\./g,"")}function qn(e){e.l+=1}function Ic(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function bye(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return wye(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=Ic(e,2),s=Ic(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function wye(e){var t=Ic(e,2),r=Ic(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function b4t(e,t,r){if(r.biff<8)return wye(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Ic(e,2),o=Ic(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function _ye(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return w4t(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Ic(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function w4t(e){var t=Ic(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function _4t(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function S4t(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return C4t(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function C4t(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function x4t(e,t,r){var n=(e[e.l++]&96)>>5,i=bye(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function T4t(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=bye(e,a,r);return[n,i,o]}function O4t(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function E4t(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function R4t(e,t,r){var n=(e[e.l++]&96)>>5,i=b4t(e,t-1,r);return[n,i]}function k4t(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function gne(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function A4t(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function P4t(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function I4t(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function M4t(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function D4t(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Sye(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function $4t(e){return e.read_shift(2),Sye(e)}function N4t(e){return e.read_shift(2),Sye(e)}function L4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=_ye(e,0,r);return[n,i]}function F4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=S4t(e,0,r);return[n,i]}function H4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=_ye(e,0,r);return[n,i,a]}function B4t(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[WWt[i],Tye[i],n]}function W4t(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:V4t(e);return[i,(a[0]===0?Tye:BWt)[a[1]]]}function V4t(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function U4t(e,t,r){e.l+=r&&r.biff==2?3:4}function j4t(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function z4t(e){return e.l++,pv[e.read_shift(1)]}function G4t(e){return e.l++,e.read_shift(2)}function Y4t(e){return e.l++,e.read_shift(1)!==0}function K4t(e){return e.l++,Ni(e)}function X4t(e,t,r){return e.l++,J1(e,t-1,r)}function q4t(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Bn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=pv[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ni(e);break;case 2:r[1]=gv(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Z4t(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?vv:qA)(e));return i}function J4t(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=q4t(e,r.biff);return o}function Q4t(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function eWt(e,t,r){if(r.biff==5)return tWt(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function tWt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function rWt(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function nWt(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function iWt(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function aWt(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var oWt=ji,sWt=ji,lWt=ji;function eC(e,t,r){return e.l+=2,[_4t(e)]}function _j(e){return e.l+=6,[]}var uWt=eC,fWt=_j,cWt=_j,hWt=eC;function Cye(e){return e.l+=2,[Jn(e),e.read_shift(2)&1]}var dWt=eC,vWt=Cye,pWt=_j,gWt=eC,yWt=eC,mWt=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bWt(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=mWt[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function wWt(e){return e.l+=2,[e.read_shift(4)]}function _Wt(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function SWt(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function CWt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xWt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TWt(e){return e.l+=4,[0,0]}var yne={1:{n:"PtgExp",f:j4t},2:{n:"PtgTbl",f:lWt},3:{n:"PtgAdd",f:qn},4:{n:"PtgSub",f:qn},5:{n:"PtgMul",f:qn},6:{n:"PtgDiv",f:qn},7:{n:"PtgPower",f:qn},8:{n:"PtgConcat",f:qn},9:{n:"PtgLt",f:qn},10:{n:"PtgLe",f:qn},11:{n:"PtgEq",f:qn},12:{n:"PtgGe",f:qn},13:{n:"PtgGt",f:qn},14:{n:"PtgNe",f:qn},15:{n:"PtgIsect",f:qn},16:{n:"PtgUnion",f:qn},17:{n:"PtgRange",f:qn},18:{n:"PtgUplus",f:qn},19:{n:"PtgUminus",f:qn},20:{n:"PtgPercent",f:qn},21:{n:"PtgParen",f:qn},22:{n:"PtgMissArg",f:qn},23:{n:"PtgStr",f:X4t},26:{n:"PtgSheet",f:_Wt},27:{n:"PtgEndSheet",f:SWt},28:{n:"PtgErr",f:z4t},29:{n:"PtgBool",f:Y4t},30:{n:"PtgInt",f:G4t},31:{n:"PtgNum",f:K4t},32:{n:"PtgArray",f:k4t},33:{n:"PtgFunc",f:B4t},34:{n:"PtgFuncVar",f:W4t},35:{n:"PtgName",f:Q4t},36:{n:"PtgRef",f:L4t},37:{n:"PtgArea",f:x4t},38:{n:"PtgMemArea",f:rWt},39:{n:"PtgMemErr",f:oWt},40:{n:"PtgMemNoMem",f:sWt},41:{n:"PtgMemFunc",f:nWt},42:{n:"PtgRefErr",f:iWt},43:{n:"PtgAreaErr",f:O4t},44:{n:"PtgRefN",f:F4t},45:{n:"PtgAreaN",f:R4t},46:{n:"PtgMemAreaN",f:CWt},47:{n:"PtgMemNoMemN",f:xWt},57:{n:"PtgNameX",f:eWt},58:{n:"PtgRef3d",f:H4t},59:{n:"PtgArea3d",f:T4t},60:{n:"PtgRefErr3d",f:aWt},61:{n:"PtgAreaErr3d",f:E4t},255:{}},OWt={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},EWt={1:{n:"PtgElfLel",f:Cye},2:{n:"PtgElfRw",f:gWt},3:{n:"PtgElfCol",f:uWt},6:{n:"PtgElfRwV",f:yWt},7:{n:"PtgElfColV",f:hWt},10:{n:"PtgElfRadical",f:dWt},11:{n:"PtgElfRadicalS",f:pWt},13:{n:"PtgElfColS",f:fWt},15:{n:"PtgElfColSV",f:cWt},16:{n:"PtgElfRadicalLel",f:vWt},25:{n:"PtgList",f:bWt},29:{n:"PtgSxName",f:wWt},255:{}},RWt={0:{n:"PtgAttrNoop",f:TWt},1:{n:"PtgAttrSemi",f:D4t},2:{n:"PtgAttrIf",f:I4t},4:{n:"PtgAttrChoose",f:A4t},8:{n:"PtgAttrGoto",f:P4t},16:{n:"PtgAttrSum",f:U4t},32:{n:"PtgAttrBaxcel",f:gne},33:{n:"PtgAttrBaxcel",f:gne},64:{n:"PtgAttrSpace",f:$4t},65:{n:"PtgAttrSpaceSemi",f:N4t},128:{n:"PtgAttrIfError",f:M4t},255:{}};function tC(e,t,r,n){if(n.biff<8)return ji(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=J4t(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Z4t(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(ji(e,t)),a}function rC(e,t,r){for(var n=e.l+t,i,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],i=yne[a]||yne[OWt[a]],(a===24||a===25)&&(i=(a===24?EWt:RWt)[e[e.l+1]]),!i||!i.f?ji(e,t):o.push([i.n,i.f(e,t,r)]);return o}function kWt(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var AWt={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function PWt(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function xye(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function mne(e,t,r){var n=xye(e,t,r);return n=="#REF"?n:PWt(n,r)}function Di(e,t,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],l,u,f,c=0,h=0,d,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,w=e[0].length;b<w;++b){var _=e[0][b];switch(_[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=s.pop(),u=s.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=Mn(" ",e[0][g][1][1]);break;case 1:y=Mn("\r",e[0][g][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}s.push(u+AWt[_[0]]+l);break;case"PtgIsect":l=s.pop(),u=s.pop(),s.push(u+" "+l);break;case"PtgUnion":l=s.pop(),u=s.pop(),s.push(u+","+l);break;case"PtgRange":l=s.pop(),u=s.pop(),s.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=cw(_[1][1],o,i),s.push(hw(f,a));break;case"PtgRefN":f=r?cw(_[1][1],r,i):_[1][1],s.push(hw(f,a));break;case"PtgRef3d":c=_[1][1],f=cw(_[1][2],o,i),v=mne(n,c,i),s.push(v+"!"+hw(f,a));break;case"PtgFunc":case"PtgFuncVar":var x=_[1][0],E=_[1][1];x||(x=0),x&=127;var R=x==0?[]:s.slice(-x);s.length-=x,E==="User"&&(E=R.shift()),s.push(E+"("+R.join(",")+")");break;case"PtgBool":s.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(_[1]);break;case"PtgNum":s.push(String(_[1]));break;case"PtgStr":s.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(_[1]);break;case"PtgAreaN":d=Jre(_[1][1],r?{s:r}:o,i),s.push(l$(d,i));break;case"PtgArea":d=Jre(_[1][1],o,i),s.push(l$(d,i));break;case"PtgArea3d":c=_[1][1],d=_[1][2],v=mne(n,c,i),s.push(v+"!"+l$(d,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var A=(n.names||[])[h-1]||(n[0]||[])[h],N=A?A.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),s.push(N);break;case"PtgNameX":var I=_[1][1];h=_[1][2];var F;if(i.biff<=5)I<0&&(I=-I),n[I]&&(F=n[I][h]);else{var H="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][h]&&n[I][h].itab>0&&(H=n.SheetNames[n[I][h].itab-1]+"!"):H=n.SheetNames[h-1]+"!"),n[I]&&n[I][h])H+=n[I][h].Name;else if(n[0]&&n[0][h])H+=n[0][h].Name;else{var W=(xye(n,I,i)||"").split(";;");W[h-1]?H=W[h-1]:H+="SH33TJSERRX"}s.push(H);break}F||(F={Name:"SH33TJSERRY"}),s.push(F.Name);break;case"PtgParen":var z="(",te=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:z=Mn(" ",e[0][g][1][1])+z;break;case 3:z=Mn("\r",e[0][g][1][1])+z;break;case 4:te=Mn(" ",e[0][g][1][1])+te;break;case 5:te=Mn("\r",e[0][g][1][1])+te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}s.push(z+s.pop()+te);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var ie={c:r.c,r:r.r};if(n.sharedf[Gt(f)]){var fe=n.sharedf[Gt(f)];s.push(Di(fe,o,ie,n,i))}else{var Te=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){s.push(Di(u[1],o,ie,n,i)),Te=!0;break}Te||s.push(_[1])}break;case"PtgArray":s.push("{"+kWt(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var M=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&M.indexOf(e[0][b][0])==-1){_=e[0][g];var S=!0;switch(_[1][0]){case 4:S=!1;case 0:y=Mn(" ",_[1][1]);break;case 5:S=!1;case 1:y=Mn("\r",_[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}s.push((S?y:"")+s.pop()+(S?"":y)),g=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function IWt(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],ji(e,t-2)];var s=rC(e,o,r);return t!==o+i&&(a=tC(e,t-o-i,s,r)),e.l=n,[s,a]}function MWt(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],ji(e,t-2)];var s=rC(e,o,r);return t!==o+i&&(a=tC(e,t-o-i,s,r)),e.l=n,[s,a]}function DWt(e,t,r,n){var i=e.l+t,a=rC(e,n,r),o;return i!==e.l&&(o=tC(e,i-e.l,a,r)),[a,o]}function $Wt(e,t,r){var n=e.l+t,i,a=e.read_shift(2),o=rC(e,a,r);return a==65535?[[],ji(e,t-2)]:(t!==a+2&&(i=tC(e,n-a-2,o,r)),[o,i])}function NWt(e){var t;if(Mu(e,e.l+6)!==65535)return[Ni(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function c$(e,t,r){var n=e.l+t,i=Pl(e);r.biff==2&&++e.l;var a=NWt(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var s=MWt(e,n-e.l,r);return{cell:i,val:a[0],formula:s,shared:o>>3&1,tt:a[1]}}function ZA(e,t,r){var n=e.read_shift(4),i=rC(e,n,r),a=e.read_shift(4),o=a>0?tC(e,a,i,r):null;return[i,o]}var LWt=ZA,JA=ZA,FWt=ZA,HWt=ZA,BWt={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Tye={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},WWt={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bne(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function h$(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var gw={},cg={};function yw(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Oye(e,t,r,n,i,a){try{n.cellNF&&(e.z=er[t])}catch(s){if(n.WTF)throw s}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=bi(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(er[t]==null&&Cd(ULt[t]||"General",t),e.t==="e")e.w=e.w||pv[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=WS(e.v);else if(e.t==="d"){var o=ma(e.v);(o|0)===o?e.w=o.toString(10):e.w=WS(o)}else{if(e.v===void 0)return"";e.w=jd(e.v,cg)}else e.t==="d"?e.w=Ko(t,ma(e.v),cg):e.w=Ko(t,e.v,cg)}catch(s){if(n.WTF)throw s}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rk(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rk(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(n.WTF&&a.Fills)throw s}}}function VWt(e,t){var r=Dn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Or(r))}var UWt=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jWt=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zWt=/<(?:\w:)?hyperlink [^>]*>/mg,GWt=/"(\w*:\w*)"/,YWt=/<(?:\w:)?col\b[^>]*[\/]?>/g,KWt=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,XWt=/<(?:\w:)?pageMargins[^>]*\/>/g,Eye=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,qWt=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ZWt=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function JWt(e,t,r,n,i,a,o){if(!e)return e;n||(n={"!id":{}});var s=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",c=e.match(jWt);c?(u=e.slice(0,c.index),f=e.slice(c.index+c[0].length)):u=f=e;var h=u.match(Eye);h?Sj(h[0],s,i,r):(h=u.match(qWt))&&QWt(h[0],h[1]||"",s,i,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=u.slice(d,d+50).match(GWt);v&&VWt(s,v[1])}var g=u.match(ZWt);g&&g[1]&&aVt(g[1],i);var y=[];if(t.cellStyles){var b=u.match(YWt);b&&rVt(y,b)}c&&oVt(c[1],s,t,l,a,o);var w=f.match(KWt);w&&(s["!autofilter"]=nVt(w[0]));var _=[],x=f.match(UWt);if(x)for(d=0;d!=x.length;++d)_[d]=Dn(x[d].slice(x[d].indexOf('"')+1));var E=f.match(zWt);E&&eVt(s,E,n);var R=f.match(XWt);if(R&&(s["!margins"]=tVt(Bt(R[0]))),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=Or(l)),t.sheetRows>0&&s["!ref"]){var A=Dn(s["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>l.e.r&&(A.e.r=l.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>l.e.c&&(A.e.c=l.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),s["!fullref"]=s["!ref"],s["!ref"]=Or(A))}return y.length>0&&(s["!cols"]=y),_.length>0&&(s["!merges"]=_),s}function Sj(e,t,r,n){var i=Bt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=kr(an(i.codeName)))}function QWt(e,t,r,n,i){Sj(e.slice(0,e.indexOf(">")),r,n,i)}function eVt(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=Bt(an(t[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+kr(a.location))):(a.Target="#"+kr(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var s=Dn(a.ref),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var f=Gt({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function tVt(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function rVt(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Bt(t[n],!0);i.hidden&&(i.hidden=pn(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,wj(i.width)),Rm(i);a<=o;)e[a++]=Ti(i)}}function nVt(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var iVt=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function aVt(e,t){t.Views||(t.Views=[{}]),(e.match(iVt)||[]).forEach(function(r,n){var i=Bt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),pn(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var oVt=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=VS("v"),o=VS("f");return function(l,u,f,c,h,d){for(var v=0,g="",y=[],b=[],w=0,_=0,x=0,E="",R,A,N=0,I=0,F,H,W=0,z=0,te=Array.isArray(d.CellXf),ie,fe=[],Te=[],M=Array.isArray(u),S=[],T={},k=!1,O=!!f.sheetStubs,D=l.split(t),L=0,B=D.length;L!=B;++L){g=D[L].trim();var Y=g.length;if(Y!==0){var Q=0;e:for(v=0;v<Y;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(A=Bt(g.slice(Q,v),!0),N=A.r!=null?parseInt(A.r,10):N+1,I=-1,f.sheetRows&&f.sheetRows<N)continue;T={},k=!1,A.ht&&(k=!0,T.hpt=parseFloat(A.ht),T.hpx=GS(T.hpt)),A.hidden=="1"&&(k=!0,T.hidden=!0),A.outlineLevel!=null&&(k=!0,T.level=+A.outlineLevel),k&&(S[N-1]=T)}break;case"<":Q=v;break}if(Q>=v)break;if(A=Bt(g.slice(Q,v),!0),N=A.r!=null?parseInt(A.r,10):N+1,I=-1,!(f.sheetRows&&f.sheetRows<N)){c.s.r>N-1&&(c.s.r=N-1),c.e.r<N-1&&(c.e.r=N-1),f&&f.cellStyles&&(T={},k=!1,A.ht&&(k=!0,T.hpt=parseFloat(A.ht),T.hpx=GS(T.hpt)),A.hidden=="1"&&(k=!0,T.hidden=!0),A.outlineLevel!=null&&(k=!0,T.level=+A.outlineLevel),k&&(S[N-1]=T)),y=g.slice(v).split(e);for(var he=0;he!=y.length&&y[he].trim().charAt(0)=="<";++he);for(y=y.slice(he),v=0;v!=y.length;++v)if(g=y[v].trim(),g.length!==0){if(b=g.match(r),w=v,_=0,x=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(w=0,E=b[1],_=0;_!=E.length&&!((x=E.charCodeAt(_)-64)<1||x>26);++_)w=26*w+x;--w,I=w}else++I;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,A=Bt(g.slice(0,_),!0),A.r||(A.r=Gt({r:N-1,c:I})),E=g.slice(_),R={t:""},(b=E.match(a))!=null&&b[1]!==""&&(R.v=kr(b[1])),f.cellFormula){if((b=E.match(o))!=null&&b[1]!==""){if(R.f=kr(an(b[1])).replace(/\r\n/g,`
`),f.xlfn||(R.f=pne(R.f)),b[0].indexOf('t="array"')>-1)R.F=(E.match(i)||[])[1],R.F.indexOf(":")>-1&&fe.push([Dn(R.F),R.F]);else if(b[0].indexOf('t="shared"')>-1){H=Bt(b[0]);var ce=kr(an(b[1]));f.xlfn||(ce=pne(ce)),Te[parseInt(H.si,10)]=[H,ce,A.r]}}else(b=E.match(/<f[^>]*\/>/))&&(H=Bt(b[0]),Te[H.si]&&(R.f=y4t(Te[H.si][1],Te[H.si][2],A.r)));var le=ha(A.r);for(_=0;_<fe.length;++_)le.r>=fe[_][0].s.r&&le.r<=fe[_][0].e.r&&le.c>=fe[_][0].s.c&&le.c<=fe[_][0].e.c&&(R.F=fe[_][1])}if(A.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(O)R.t="z";else continue;else R.t=A.t||"n";switch(c.s.c>I&&(c.s.c=I),c.e.c<I&&(c.e.c=I),R.t){case"n":if(R.v==""||R.v==null){if(!O)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!O)continue;R.t="z"}else F=gw[parseInt(R.v,10)],R.v=F.t,R.r=F.r,f.cellHTML&&(R.h=F.h);break;case"str":R.t="s",R.v=R.v!=null?an(R.v):"",f.cellHTML&&(R.h=uj(R.v));break;case"inlineStr":b=E.match(n),R.t="s",b!=null&&(F=bj(b[1]))?(R.v=F.t,f.cellHTML&&(R.h=F.h)):R.v="";break;case"b":R.v=pn(R.v);break;case"d":f.cellDates?R.v=bi(R.v,1):(R.v=ma(bi(R.v,1)),R.t="n");break;case"e":(!f||f.cellText!==!1)&&(R.w=R.v),R.v=Kge[R.v];break}if(W=z=0,ie=null,te&&A.s!==void 0&&(ie=d.CellXf[A.s],ie!=null&&(ie.numFmtId!=null&&(W=ie.numFmtId),f.cellStyles&&ie.fillId!=null&&(z=ie.fillId))),Oye(R,W,z,f,h,d),f.cellDates&&te&&R.t=="n"&&Xm(er[W])&&(R.t="d",R.v=XA(R.v)),A.cm&&f.xlmeta){var xe=(f.xlmeta.Cell||[])[+A.cm-1];xe&&xe.type=="XLDAPR"&&(R.D=!0)}if(M){var U=ha(A.r);u[U.r]||(u[U.r]=[]),u[U.r][U.c]=R}else u[A.r]=R}}}}S.length>0&&(u["!rows"]=S)}}();function sVt(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var lVt=vv;function uVt(){}function fVt(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=IFt(e),r}function cVt(e){var t=rs(e);return[t]}function hVt(e){var t=dv(e);return[t]}function dVt(e){var t=rs(e),r=e.read_shift(1);return[t,r,"b"]}function vVt(e){var t=dv(e),r=e.read_shift(1);return[t,r,"b"]}function pVt(e){var t=rs(e),r=e.read_shift(1);return[t,r,"e"]}function gVt(e){var t=dv(e),r=e.read_shift(1);return[t,r,"e"]}function yVt(e){var t=rs(e),r=e.read_shift(4);return[t,r,"s"]}function mVt(e){var t=dv(e),r=e.read_shift(4);return[t,r,"s"]}function bVt(e){var t=rs(e),r=Ni(e);return[t,r,"n"]}function Rye(e){var t=dv(e),r=Ni(e);return[t,r,"n"]}function wVt(e){var t=rs(e),r=gj(e);return[t,r,"n"]}function _Vt(e){var t=dv(e),r=gj(e);return[t,r,"n"]}function SVt(e){var t=rs(e),r=vj(e);return[t,r,"is"]}function CVt(e){var t=rs(e),r=Bi(e);return[t,r,"str"]}function xVt(e){var t=dv(e),r=Bi(e);return[t,r,"str"]}function TVt(e,t,r){var n=e.l+t,i=rs(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var s=JA(e,n-e.l,r);o[3]=Di(s,null,i,r.supbooks,r)}else e.l=n;return o}function OVt(e,t,r){var n=e.l+t,i=rs(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var s=JA(e,n-e.l,r);o[3]=Di(s,null,i,r.supbooks,r)}else e.l=n;return o}function EVt(e,t,r){var n=e.l+t,i=rs(e);i.r=r["!row"];var a=Ni(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var s=JA(e,n-e.l,r);o[3]=Di(s,null,i,r.supbooks,r)}else e.l=n;return o}function RVt(e,t,r){var n=e.l+t,i=rs(e);i.r=r["!row"];var a=Bi(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var s=JA(e,n-e.l,r);o[3]=Di(s,null,i,r.supbooks,r)}else e.l=n;return o}var kVt=vv;function AVt(e,t){var r=e.l+t,n=vv(e),i=pj(e),a=Bi(e),o=Bi(e),s=Bi(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:s};return o&&(l.Tooltip=o),l}function PVt(){}function IVt(e,t,r){var n=e.l+t,i=zge(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var s=LWt(e,n-e.l,r);o[1]=s}else e.l=n;return o}function MVt(e,t,r){var n=e.l+t,i=vv(e),a=[i];if(r.cellFormula){var o=HWt(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}var DVt=["left","right","top","bottom","header","footer"];function $Vt(e){var t={};return DVt.forEach(function(r){t[r]=Ni(e)}),t}function NVt(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function LVt(){}function FVt(){}function HVt(e,t,r,n,i,a,o){if(!e)return e;var s=t||{};n||(n={"!id":{}});var l=s.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},c=!1,h=!1,d,v,g,y,b,w,_,x,E,R=[];s.biff=12,s["!row"]=0;var A=0,N=!1,I=[],F={},H=s.supbooks||i.supbooks||[[]];if(H.sharedf=F,H.arrayf=I,H.SheetNames=i.SheetNames||i.Sheets.map(function(M){return M.name}),!s.supbooks&&(s.supbooks=H,i.Names))for(var W=0;W<i.Names.length;++W)H[0][W+1]=i.Names[W];var z=[],te=[],ie=!1;ak[16]={n:"BrtShortReal",f:Rye};var fe;if(nf(e,function(S,T,k){if(!h)switch(k){case 148:u=S;break;case 0:d=S,s.sheetRows&&s.sheetRows<=d.r&&(h=!0),x=Oi(y=d.r),s["!row"]=d.r,(S.hidden||S.hpt||S.level!=null)&&(S.hpt&&(S.hpx=GS(S.hpt)),te[S.r]=S);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:S[2]},S[2]){case"n":v.v=S[1];break;case"s":_=gw[S[1]],v.v=_.t,v.r=_.r;break;case"b":v.v=!!S[1];break;case"e":v.v=S[1],s.cellText!==!1&&(v.w=pv[v.v]);break;case"str":v.t="s",v.v=S[1];break;case"is":v.t="s",v.v=S[1].t;break}if((g=o.CellXf[S[0].iStyleRef])&&Oye(v,g.numFmtId,null,s,a,o),b=S[0].c==-1?b+1:S[0].c,s.dense?(l[y]||(l[y]=[]),l[y][b]=v):l[fi(b)+x]=v,s.cellFormula){for(N=!1,A=0;A<I.length;++A){var O=I[A];d.r>=O[0].s.r&&d.r<=O[0].e.r&&b>=O[0].s.c&&b<=O[0].e.c&&(v.F=Or(O[0]),N=!0)}!N&&S.length>3&&(v.f=S[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>b&&(f.s.c=b),f.e.r<d.r&&(f.e.r=d.r),f.e.c<b&&(f.e.c=b),s.cellDates&&g&&v.t=="n"&&Xm(er[g.numFmtId])){var D=pd(v.v);D&&(v.t="d",v.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 1:case 12:if(!s.sheetStubs||c)break;v={t:"z",v:void 0},b=S[0].c==-1?b+1:S[0].c,s.dense?(l[y]||(l[y]=[]),l[y][b]=v):l[fi(b)+x]=v,f.s.r>d.r&&(f.s.r=d.r),f.s.c>b&&(f.s.c=b),f.e.r<d.r&&(f.e.r=d.r),f.e.c<b&&(f.e.c=b),fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 176:R.push(S);break;case 49:fe=((s.xlmeta||{}).Cell||[])[S-1];break;case 494:var L=n["!id"][S.relId];for(L?(S.Target=L.Target,S.loc&&(S.Target+="#"+S.loc),S.Rel=L):S.relId==""&&(S.Target="#"+S.loc),y=S.rfx.s.r;y<=S.rfx.e.r;++y)for(b=S.rfx.s.c;b<=S.rfx.e.c;++b)s.dense?(l[y]||(l[y]=[]),l[y][b]||(l[y][b]={t:"z",v:void 0}),l[y][b].l=S):(w=Gt({c:b,r:y}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=S);break;case 426:if(!s.cellFormula)break;I.push(S),E=s.dense?l[y][b]:l[fi(b)+x],E.f=Di(S[1],f,{r:d.r,c:b},H,s),E.F=Or(S[0]);break;case 427:if(!s.cellFormula)break;F[Gt(S[0].s)]=S[1],E=s.dense?l[y][b]:l[fi(b)+x],E.f=Di(S[1],f,{r:d.r,c:b},H,s);break;case 60:if(!s.cellStyles)break;for(;S.e>=S.s;)z[S.e--]={width:S.w/256,hidden:!!(S.flags&1),level:S.level},ie||(ie=!0,wj(S.w/256)),Rm(z[S.e+1]);break;case 161:l["!autofilter"]={ref:Or(S)};break;case 476:l["!margins"]=S;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),S.name&&(i.Sheets[r].CodeName=S.name),(S.above||S.left)&&(l["!outline"]={above:S.above,left:S.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),S.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:c=!0;break;case 36:c=!1;break;case 37:c=!0;break;case 38:c=!1;break;default:if(!T.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+k.toString(16))}}},s),delete s.supbooks,delete s["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=Or(u||f)),s.sheetRows&&l["!ref"]){var Te=Dn(l["!ref"]);s.sheetRows<=+Te.e.r&&(Te.e.r=s.sheetRows-1,Te.e.r>f.e.r&&(Te.e.r=f.e.r),Te.e.r<Te.s.r&&(Te.s.r=Te.e.r),Te.e.c>f.e.c&&(Te.e.c=f.e.c),Te.e.c<Te.s.c&&(Te.s.c=Te.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Or(Te))}return R.length>0&&(l["!merges"]=R),z.length>0&&(l["!cols"]=z),te.length>0&&(l["!rows"]=te),l}function BVt(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=kr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function WVt(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var s=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(c){var h=BVt(c);f.s.r=f.s.c=0,f.e.c=s,u=fi(s),h[0].forEach(function(d,v){o[u+Oi(v)]={t:"n",v:d,z:h[1]},l=v}),f.e.r<l&&(f.e.r=l),++s}),s>0&&(o["!ref"]=Or(f)),o}function VVt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,s=e.match(Eye);return s&&Sj(s[0],a,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function UVt(e,t){e.l+=10;var r=Bi(e);return{name:r}}function jVt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return nf(e,function(l,u,f){switch(f){case 550:a["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var kye=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],zVt=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],GVt=[],YVt=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function wne(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=pn(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function _ne(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=pn(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Aye(e){_ne(e.WBProps,kye),_ne(e.CalcPr,YVt),wne(e.WBView,zVt),wne(e.Sheets,GVt),cg.date1904=pn(e.WBProps.date1904)}var KVt="][*?/\\".split("");function XVt(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return KVt.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var qVt=/<\w+:workbook/;function ZVt(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(Yi,function(l,u){var f=Bt(l);switch(Al(f[0])){case"<?xml":break;case"<workbook":l.match(qVt)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":kye.forEach(function(c){if(f[c[0]]!=null)switch(c[2]){case"bool":r.WBProps[c[0]]=pn(f[c[0]]);break;case"int":r.WBProps[c[0]]=parseInt(f[c[0]],10);break;default:r.WBProps[c[0]]=f[c[0]]}}),f.codeName&&(r.WBProps.CodeName=an(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=kr(an(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=an(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),pn(f.hidden||"0")&&(a.Hidden=!0),o=u+l.length;break;case"</definedName>":a.Ref=kr(an(e.slice(o,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),pFt.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Aye(r),r}function JVt(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=PB(e),r.name=Bi(e),r}function QVt(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Bi(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function eUt(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function tUt(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=MFt(e),o=FWt(e,0,r),s=pj(e);e.l=n;var l={Name:a,Ptg:o};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}function rUt(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],ak[16]={n:"BrtFRTArchID$",f:eUt},nf(e,function(l,u,f){switch(f){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Di(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,l]):o[0]=[f,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Aye(r),r.Names=a,r.supbooks=o,r}function nUt(e,t,r){return t.slice(-4)===".bin"?rUt(e,r):ZVt(e,r)}function iUt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?HVt(e,n,r,i,a,o,s):JWt(e,n,r,i,a,o,s)}function aUt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?jVt(e,n,r,i,a):VVt(e,n,r,i,a)}function oUt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?v4t():p4t()}function sUt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?h4t():d4t()}function lUt(e,t,r,n){return t.slice(-4)===".bin"?k3t(e,r,n):C3t(e,r,n)}function uUt(e,t,r){return gye(e,r)}function fUt(e,t,r){return t.slice(-4)===".bin"?zBt(e,r):UBt(e,r)}function cUt(e,t,r){return t.slice(-4)===".bin"?u4t(e,r):i4t(e,r)}function hUt(e,t,r){return t.slice(-4)===".bin"?t4t(e):Q3t(e)}function dUt(e,t,r,n){return r.slice(-4)===".bin"?r4t(e,t,r,n):void 0}function vUt(e,t,r){return t.slice(-4)===".bin"?Z3t(e,t,r):J3t(e,t,r)}var Pye=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Iye=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ds(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(Pye),a,o,s,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(Iye),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),n[s]=a[2].slice(1,a[2].length-1));return n}function pUt(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Pye),i,a,o,s;if(n)for(s=0;s!=n.length;++s)i=n[s].match(Iye),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var mw;function gUt(e,t){var r=mw[e]||kr(e);return r==="General"?jd(t):Ko(r,t)}function yUt(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=pn(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=bi(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[kr(t)]=i}function mUt(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||pv[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=WS(e.v):e.w=jd(e.v):e.w=gUt(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=mw[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Xm(n)){var i=pd(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function bUt(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=y3t[n.Pattern]||n.Pattern)}e[t.ID]=t}function wUt(e,t,r,n,i,a,o,s,l,u){var f="General",c=n.StyleID,h={};u=u||{};var d=[],v=0;for(c===void 0&&s&&(c=s.StyleID),c===void 0&&o&&(c=o.StyleID);a[c]!==void 0&&(a[c].nf&&(f=a[c].nf),a[c].Interior&&d.push(a[c].Interior),!!a[c].Parent);)c=a[c].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=pn(e);break;case"String":n.t="s",n.r=Ure(kr(e)),n.v=e.indexOf("<")>-1?kr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(bi(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=kr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Kge[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Ure(t||e));break}if(mUt(n,f,u),u.cellFormula!==!1)if(n.Formula){var g=kr(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=fg(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=fg("RC:RC",i):n.ArrayRange&&(n.F=fg(n.ArrayRange,i),l.push([Dn(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);u.cellStyles&&(d.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function _Ut(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function d$(e,t){var r=t||{};bge();var n=kb(fj(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=an(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Ti(r);return o.type="string",jS.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ke){i.indexOf("<"+Ke)>=0&&(a=!0)}),a)return AUt(n,r);mw={"General Number":"General","General Date":er[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":er[15],"Short Date":er[14],"Long Time":er[19],"Medium Time":er[18],"Short Time":er[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:er[2],Standard:er[4],Percent:er[10],Scientific:er[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,l=[],u,f={},c=[],h=r.dense?[]:{},d="",v={},g={},y=ds('<Data ss:Type="String">'),b=0,w=0,_=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},R={},A="",N=0,I=[],F={},H={},W=0,z=[],te=[],ie={},fe=[],Te,M=!1,S=[],T=[],k={},O=0,D=0,L={Sheets:[],WBProps:{date1904:!1}},B={};US.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";s=US.exec(n);)switch(s[3]=(Y=s[3]).toLowerCase()){case"data":if(Y=="data"){if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break}if(l[l.length-1][1])break;s[1]==="/"?wUt(n.slice(b,s.index),A,y,l[l.length-1][0]=="comment"?ie:v,{c:w,r:_},E,fe[w],g,S,r):(A="",y=ds(s[0]),b=s.index+s[0].length);break;case"cell":if(s[1]==="/")if(te.length>0&&(v.c=te),(!r.sheetRows||r.sheetRows>_)&&v.v!==void 0&&(r.dense?(h[_]||(h[_]=[]),h[_][w]=v):h[fi(w)+Oi(_)]=v),v.HRef&&(v.l={Target:kr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(O=w+(parseInt(v.MergeAcross,10)|0),D=_+(parseInt(v.MergeDown,10)|0),I.push({s:{c:w,r:_},e:{c:O,r:D}})),!r.sheetStubs)v.MergeAcross?w=O+1:++w;else if(v.MergeAcross||v.MergeDown){for(var Q=w;Q<=O;++Q)for(var he=_;he<=D;++he)(Q>w||he>_)&&(r.dense?(h[he]||(h[he]=[]),h[he][Q]={t:"z"}):h[fi(Q)+Oi(he)]={t:"z"});w=O+1}else++w;else v=pUt(s[0]),v.Index&&(w=+v.Index-1),w<x.s.c&&(x.s.c=w),w>x.e.c&&(x.e.c=w),s[0].slice(-2)==="/>"&&++w,te=[];break;case"row":s[1]==="/"||s[0].slice(-2)==="/>"?(_<x.s.r&&(x.s.r=_),_>x.e.r&&(x.e.r=_),s[0].slice(-2)==="/>"&&(g=ds(s[0]),g.Index&&(_=+g.Index-1)),w=0,++_):(g=ds(s[0]),g.Index&&(_=+g.Index-1),k={},(g.AutoFitHeight=="0"||g.Height)&&(k.hpx=parseInt(g.Height,10),k.hpt=pye(k.hpx),T[_]=k),g.Hidden=="1"&&(k.hidden=!0,T[_]=k));break;case"worksheet":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));c.push(d),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(h["!ref"]=Or(x),r.sheetRows&&r.sheetRows<=x.e.r&&(h["!fullref"]=h["!ref"],x.e.r=r.sheetRows-1,h["!ref"]=Or(x))),I.length&&(h["!merges"]=I),fe.length>0&&(h["!cols"]=fe),T.length>0&&(h["!rows"]=T),f[d]=h}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=w=0,l.push([s[3],!1]),u=ds(s[0]),d=kr(u.Name),h=r.dense?[]:{},I=[],S=[],T=[],B={name:d,Hidden:0},L.Sheets.push(B);break;case"table":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else{if(s[0].slice(-2)=="/>")break;l.push([s[3],!1]),fe=[],M=!1}break;case"style":s[1]==="/"?bUt(E,R,r):R=ds(s[0]);break;case"numberformat":R.nf=kr(ds(s[0]).Format||"General"),mw[R.nf]&&(R.nf=mw[R.nf]);for(var ce=0;ce!=392&&er[ce]!=R.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(er[ce]==null){Cd(R.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Te=ds(s[0]),Te.Hidden&&(Te.hidden=!0,delete Te.Hidden),Te.Width&&(Te.wpx=parseInt(Te.Width,10)),!M&&Te.wpx>10){M=!0,fa=dye;for(var le=0;le<fe.length;++le)fe[le]&&Rm(fe[le])}M&&Rm(Te),fe[Te.Index-1||fe.length]=Te;for(var xe=0;xe<+Te.Span;++xe)fe[fe.length]=Ti(Te);break;case"namedrange":if(s[1]==="/")break;L.Names||(L.Names=[]);var U=Bt(s[0]),De={Name:U.Name,Ref:fg(U.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(De.Sheet=L.Sheets.length-1),L.Names.push(De);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(s[0].slice(-2)==="/>")break;s[1]==="/"?A+=n.slice(N,s.index):N=s.index+s[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=ds(s[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(s[0].slice(-2)==="/>")break;s[1]==="/"?iHt(F,Y,n.slice(W,s.index)):W=s.index+s[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else l.push([s[3],!1]);break;case"comment":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));_Ut(ie),te.push(ie)}else l.push([s[3],!1]),u=ds(s[0]),ie={a:u.Author};break;case"autofilter":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else if(s[0].charAt(s[0].length-2)!=="/"){var de=ds(s[0]);h["!autofilter"]={ref:fg(de.Range).replace(/\$/g,"")},l.push([s[3],!0])}break;case"name":break;case"datavalidation":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"null":break;default:if(l.length==0&&s[3]=="document"||l.length==0&&s[3]=="uof")return Ene(n,r);var He=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(s[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(s[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if(s[0].slice(-2)!=="/>")if(s[1]==="/")switch(n.slice(W,s.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else W=s.index+s[0].length;break;case"header":h["!margins"]||yw(h["!margins"]={},"xlml"),isNaN(+Bt(s[0]).Margin)||(h["!margins"].header=+Bt(s[0]).Margin);break;case"footer":h["!margins"]||yw(h["!margins"]={},"xlml"),isNaN(+Bt(s[0]).Margin)||(h["!margins"].footer=+Bt(s[0]).Margin);break;case"pagemargins":var Be=Bt(s[0]);h["!margins"]||yw(h["!margins"]={},"xlml"),isNaN(+Be.Top)||(h["!margins"].top=+Be.Top),isNaN(+Be.Left)||(h["!margins"].left=+Be.Left),isNaN(+Be.Right)||(h["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(h["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(s[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||s[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(s[0].slice(-2)==="/>")break;s[1]==="/"?yUt(H,Y,z,n.slice(W,s.index)):(z=s,W=s.index+s[0].length);break}if(r.WTF)throw"Unrecognized tag: "+s[3]+"|"+l.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=f),Ae.SheetNames=c,Ae.Workbook=L,Ae.SSF=Ti(er),Ae.Props=F,Ae.Custprops=H,Ae}function $B(e,t){switch(Tj(t=t||{}),t.type||"base64"){case"base64":return d$(fo(e),t);case"binary":case"buffer":case"file":return d$(e,t);case"array":return d$(hv(e),t)}}function SUt(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=NFt(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=LFt(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var CUt=[60,1084,2066,2165,2175];function xUt(e,t,r,n,i){var a=n,o=[],s=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(s)}o.push(s),r.l+=a;for(var l=Mu(r,r.l),u=NB[l],f=0;u!=null&&CUt.indexOf(l)>-1;)a=Mu(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),s=r.slice(f,r.l+4+a),o.push(s),r.l+=4+a,u=NB[l=Mu(r,r.l)];var c=Vf(o);xi(c,0);var h=0;c.lens=[];for(var d=0;d<o.length;++d)c.lens.push(h),h+=o[d].length;if(c.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+c.length+" < "+n;return t.f(c,c.length,i)}function il(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=er[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||pv[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=WS(e.v):e.w=jd(e.v):e.w=Ko(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Xm(er[n]||String(n))){var i=pd(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function YT(e,t,r){return{v:e,ixfe:t,t:r}}function TUt(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},o={},s=null,l=[],u="",f={},c,h="",d,v,g,y,b={},w=[],_,x,E=[],R=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},I=function(Se){return Se<8?xd[Se]:Se<64&&R[Se-8]||xd[Se]},F=function(Se,Le,qe){var Qe=Le.XF.data;if(!(!Qe||!Qe.patternType||!qe||!qe.cellStyles)){Le.s={},Le.s.patternType=Qe.patternType;var wt;(wt=zS(I(Qe.icvFore)))&&(Le.s.fgColor={rgb:wt}),(wt=zS(I(Qe.icvBack)))&&(Le.s.bgColor={rgb:wt})}},H=function(Se,Le,qe){if(!(k>1)&&!(qe.sheetRows&&Se.r>=qe.sheetRows)){if(qe.cellStyles&&Le.XF&&Le.XF.data&&F(Se,Le,qe),delete Le.ixfe,delete Le.XF,c=Se,h=Gt(Se),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Se.r<o.s.r&&(o.s.r=Se.r),Se.c<o.s.c&&(o.s.c=Se.c),Se.r+1>o.e.r&&(o.e.r=Se.r+1),Se.c+1>o.e.c&&(o.e.c=Se.c+1),qe.cellFormula&&Le.f){for(var Qe=0;Qe<w.length;++Qe)if(!(w[Qe][0].s.c>Se.c||w[Qe][0].s.r>Se.r)&&!(w[Qe][0].e.c<Se.c||w[Qe][0].e.r<Se.r)){Le.F=Or(w[Qe][0]),(w[Qe][0].s.c!=Se.c||w[Qe][0].s.r!=Se.r)&&delete Le.f,Le.f&&(Le.f=""+Di(w[Qe][1],o,Se,S,W));break}}qe.dense?(i[Se.r]||(i[Se.r]=[]),i[Se.r][Se.c]=Le):i[h]=Le}},W={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(W.password=t.password);var z,te=[],ie=[],fe=[],Te=[],M=!1,S=[];S.SheetNames=W.snames,S.sharedf=W.sharedf,S.arrayf=W.arrayf,S.names=[],S.XTI=[];var T=0,k=0,O=0,D=[],L=[],B;W.codepage=1200,ks(1200);for(var Y=!1;e.l<e.length-1;){var Q=e.l,he=e.read_shift(2);if(he===0&&T===10)break;var ce=e.l===e.length?0:e.read_shift(2),le=NB[he];if(le&&le.f){if(t.bookSheets&&T===133&&he!==133)break;if(T=he,le.r===2||le.r==12){var xe=e.read_shift(2);if(ce-=2,!W.enc&&xe!==he&&((xe&255)<<8|xe>>8)!==he)throw new Error("rt mismatch: "+xe+"!="+he);le.r==12&&(e.l+=10,ce-=10)}var U={};if(he===10?U=le.f(e,ce,W):U=xUt(he,le,e,ce,W),k==0&&[9,521,1033,2057].indexOf(T)===-1)continue;switch(he){case 34:r.opts.Date1904=A.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(W.enc||(e.l=0),W.enc=U,!t.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=U;break;case 66:var De=Number(U);switch(De){case 21010:De=1200;break;case 32768:De=1e4;break;case 32769:De=1252;break}ks(W.codepage=De),Y=!0;break;case 317:W.rrtabid=U;break;case 25:W.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:W.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(i["!type"]="dialog"),U.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),U.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:E.push(U);break;case 430:S.push([U]),S[S.length-1].XTI=[];break;case 35:case 547:S[S.length-1].push(U);break;case 24:case 536:B={Name:U.Name,Ref:Di(U.rgce,o,null,S,W)},U.itab>0&&(B.Sheet=U.itab-1),S.names.push(B),S[0]||(S[0]=[],S[0].XTI=[]),S[S.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(L[U.itab-1]={ref:Or(U.rgce[0][0][1][2])});break;case 22:W.ExternCount=U;break;case 23:S.length==0&&(S[0]=[],S[0].XTI=[]),S[S.length-1].XTI=S[S.length-1].XTI.concat(U),S.XTI=S.XTI.concat(U);break;case 2196:if(W.biff<8)break;B!=null&&(B.Comment=U[1]);break;case 18:i["!protect"]=U;break;case 19:U!==0&&W.WTF&&console.error("Password verifier: "+U);break;case 133:a[U.pos]=U,W.snames.push(U.name);break;case 10:{if(--k)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=Or(o),t.sheetRows&&t.sheetRows<=o.e.r){var de=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Or(o),o.e.r=de}o.e.r++,o.e.c++}te.length>0&&(i["!merges"]=te),ie.length>0&&(i["!objects"]=ie),fe.length>0&&(i["!cols"]=fe),Te.length>0&&(i["!rows"]=Te),A.Sheets.push(N)}u===""?f=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[he]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),W.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(W.biff=5,Y=!0,ks(W.codepage=28591)),W.biff==8&&U.BIFFVer==0&&U.dt==16&&(W.biff=2),k++)break;if(i=t.dense?[]:{},W.biff<8&&!Y&&(Y=!0,ks(W.codepage=t.codepage||1252)),W.biff<5||U.BIFFVer==0&&U.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:e.l-ce,name:u};a[He.pos]=He,W.snames.push(u)}else u=(a[Q]||{name:""}).name;U.dt==32&&(i["!type"]="chart"),U.dt==64&&(i["!type"]="macro"),te=[],ie=[],W.arrayf=w=[],fe=[],Te=[],M=!1,N={Hidden:(a[Q]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[U.r]||[])[U.c]:i[Gt({c:U.c,r:U.r})])&&++U.c,_={ixfe:U.ixfe,XF:E[U.ixfe]||{},v:U.val,t:"n"},O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:U.c,r:U.r},_,t);break;case 5:case 517:_={ixfe:U.ixfe,XF:E[U.ixfe],v:U.val,t:U.t},O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:U.c,r:U.r},_,t);break;case 638:_={ixfe:U.ixfe,XF:E[U.ixfe],v:U.rknum,t:"n"},O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:U.c,r:U.r},_,t);break;case 189:for(var Be=U.c;Be<=U.C;++Be){var Ae=U.rkrec[Be-U.c][0];_={ixfe:Ae,XF:E[Ae],v:U.rkrec[Be-U.c][1],t:"n"},O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:Be,r:U.r},_,t)}break;case 6:case 518:case 1030:{if(U.val=="String"){s=U;break}if(_=YT(U.val,U.cell.ixfe,U.tt),_.XF=E[_.ixfe],t.cellFormula){var Ke=U.formula;if(Ke&&Ke[0]&&Ke[0][0]&&Ke[0][0][0]=="PtgExp"){var Xe=Ke[0][0][1][0],G=Ke[0][0][1][1],q=Gt({r:Xe,c:G});b[q]?_.f=""+Di(U.formula,o,U.cell,S,W):_.F=((t.dense?(i[Xe]||[])[G]:i[q])||{}).F}else _.f=""+Di(U.formula,o,U.cell,S,W)}O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H(U.cell,_,t),s=U}break;case 7:case 519:if(s)s.val=U,_=YT(U,s.cell.ixfe,"s"),_.XF=E[_.ixfe],t.cellFormula&&(_.f=""+Di(s.formula,o,s.cell,S,W)),O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H(s.cell,_,t),s=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(U);var ae=Gt(U[0].s);if(d=t.dense?(i[U[0].s.r]||[])[U[0].s.c]:i[ae],t.cellFormula&&d){if(!s||!ae||!d)break;d.f=""+Di(U[1],o,U[0],S,W),d.F=Or(U[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!s)break;b[Gt(s.cell)]=U[0],d=t.dense?(i[s.cell.r]||[])[s.cell.c]:i[Gt(s.cell)],(d||{}).f=""+Di(U[0],o,c,S,W)}}break;case 253:_=YT(l[U.isst].t,U.ixfe,"s"),l[U.isst].h&&(_.h=l[U.isst].h),_.XF=E[_.ixfe],O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:U.c,r:U.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:U.ixfe,XF:E[U.ixfe],t:"z"},O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:U.c,r:U.r},_,t));break;case 190:if(t.sheetStubs)for(var be=U.c;be<=U.C;++be){var se=U.ixfe[be-U.c];_={ixfe:se,XF:E[se],t:"z"},O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:be,r:U.r},_,t)}break;case 214:case 516:case 4:_=YT(U.val,U.ixfe,"s"),_.XF=E[_.ixfe],O>0&&(_.z=D[_.ixfe>>8&63]),il(_,t,r.opts.Date1904),H({c:U.c,r:U.r},_,t);break;case 0:case 512:k===1&&(o=U);break;case 252:l=U;break;case 1054:if(W.biff==4){D[O++]=U[1];for(var Oe=0;Oe<O+163&&er[Oe]!=U[1];++Oe);Oe>=163&&Cd(U[1],O+163)}else Cd(U[1],U[0]);break;case 30:{D[O++]=U;for(var pe=0;pe<O+163&&er[pe]!=U;++pe);pe>=163&&Cd(U,O+163)}break;case 229:te=te.concat(U);break;case 93:ie[U.cmo[0]]=W.lastobj=U;break;case 438:W.lastobj.TxO=U;break;case 127:W.lastobj.ImData=U;break;case 440:for(y=U[0].s.r;y<=U[0].e.r;++y)for(g=U[0].s.c;g<=U[0].e.c;++g)d=t.dense?(i[y]||[])[g]:i[Gt({c:g,r:y})],d&&(d.l=U[1]);break;case 2048:for(y=U[0].s.r;y<=U[0].e.r;++y)for(g=U[0].s.c;g<=U[0].e.c;++g)d=t.dense?(i[y]||[])[g]:i[Gt({c:g,r:y})],d&&d.l&&(d.l.Tooltip=U[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;d=t.dense?(i[U[0].r]||[])[U[0].c]:i[Gt(U[0])];var ge=ie[U[2]];d||(t.dense?(i[U[0].r]||(i[U[0].r]=[]),d=i[U[0].r][U[0].c]={t:"z"}):d=i[Gt(U[0])]={t:"z"},o.e.r=Math.max(o.e.r,U[0].r),o.s.r=Math.min(o.s.r,U[0].r),o.e.c=Math.max(o.e.c,U[0].c),o.s.c=Math.min(o.s.c,U[0].c)),d.c||(d.c=[]),v={a:U[1],t:ge.TxO.t},d.c.push(v)}break;case 2173:Y3t(E[U.ixfe],U.ext);break;case 125:{if(!W.cellStyles)break;for(;U.e>=U.s;)fe[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},M||(M=!0,wj(U.w/256)),Rm(fe[U.e+1])}break;case 520:{var me={};U.level!=null&&(Te[U.r]=me,me.level=U.level),U.hidden&&(Te[U.r]=me,me.hidden=!0),U.hpt&&(Te[U.r]=me,me.hpt=U.hpt,me.hpx=GS(U.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||yw(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[he]]=U;break;case 161:i["!margins"]||yw(i["!margins"]={}),i["!margins"].header=U.header,i["!margins"].footer=U.footer;break;case 574:U.RTL&&(A.Views[0].RTL=!0);break;case 146:R=U;break;case 2198:z=U;break;case 140:x=U;break;case 442:u?N.CodeName=U||N.name:A.WBProps.CodeName=U||"ThisWorkbook";break}}else le||console.error("Missing Info for XLS Record 0x"+he.toString(16)),e.l+=ce}return r.SheetNames=wl(a).sort(function(Ce,Se){return Number(Ce)-Number(Se)}).map(function(Ce){return a[Ce].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&L.forEach(function(Ce,Se){r.Sheets[r.SheetNames[Se]]["!autofilter"]=Ce}),r.Strings=l,r.SSF=Ti(er),W.enc&&(r.Encryption=W.enc),z&&(r.Themes=z),r.Metadata={},x!==void 0&&(r.Metadata.Country=x),S.names.length>0&&(A.Names=S.names),r.Workbook=A,r}var Sne={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function OUt(e,t,r){var n=xr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ane(n,UFt,Sne.DSI);for(var a in i)t[a]=i[a]}catch(u){if(r.WTF)throw u}var o=xr.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=ane(o,jFt,Sne.SI);for(var l in s)t[l]==null&&(t[l]=s[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(qge(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Mye(e,t){t||(t={}),Tj(t),sge(),t.codepage&&nj(t.codepage);var r,n;if(e.FullPaths){if(xr.find(e,"/encryption"))throw new Error("File is password-protected");r=xr.find(e,"!CompObj"),n=xr.find(e,"/Workbook")||xr.find(e,"/Book")}else{switch(t.type){case"base64":e=Ts(fo(e));break;case"binary":e=Ts(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}xi(e,0),n={content:e}}var i,a;if(r&&SUt(r),t.bookProps&&!t.bookSheets)i={};else{var o=_r?"buffer":"array";if(n&&n.content)i=TUt(n.content,t);else if((a=xr.find(e,"PerfectOffice_MAIN"))&&a.content)i=pw.to_workbook(a.content,(t.type=o,t));else if((a=xr.find(e,"NativeContent_MAIN"))&&a.content)i=pw.to_workbook(a.content,(t.type=o,t));else throw(a=xr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&xr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=c4t(e))}var s={};return e.FullPaths&&OUt(e,s,t),i.Props=i.Custprops=s,t.bookFiles&&(i.cfb=e),i}var ak={0:{f:sVt},1:{f:cVt},2:{f:wVt},3:{f:pVt},4:{f:dVt},5:{f:bVt},6:{f:CVt},7:{f:yVt},8:{f:RVt},9:{f:EVt},10:{f:TVt},11:{f:OVt},12:{f:hVt},13:{f:_Vt},14:{f:gVt},15:{f:vVt},16:{f:Rye},17:{f:xVt},18:{f:mVt},19:{f:vj},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tUt},40:{},42:{},43:{f:T3t},44:{f:x3t},45:{f:O3t},46:{f:R3t},47:{f:E3t},48:{},49:{f:kFt},50:{},51:{f:X3t},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lye},62:{f:SVt},63:{f:e4t},64:{f:LVt},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ji,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:NVt},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fVt},148:{f:lVt,p:16},151:{f:PVt},152:{},153:{f:QVt},154:{},155:{},156:{f:JVt},157:{},158:{},159:{T:1,f:jBt},160:{T:-1},161:{T:1,f:vv},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:kVt},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:K3t},336:{T:-1},337:{f:q3t,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:PB},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sye},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:IVt},427:{f:MVt},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$Vt},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uVt},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:AVt},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:PB},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:l4t},633:{T:1},634:{T:-1},635:{T:1,f:s4t},636:{T:-1},637:{f:PFt},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UVt},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:FVt},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},NB={6:{f:c$},10:{f:If},12:{f:Jn},13:{f:Jn},14:{f:Bn},15:{f:Bn},16:{f:Ni},17:{f:Bn},18:{f:Bn},19:{f:Jn},20:{f:une},21:{f:une},23:{f:sye},24:{f:cne},25:{f:Bn},26:{},27:{},28:{f:aBt},29:{},34:{f:Bn},35:{f:fne},38:{f:Ni},39:{f:Ni},40:{f:Ni},41:{f:Ni},42:{f:Bn},43:{f:Bn},47:{f:u3t},49:{f:BHt},51:{f:Jn},60:{},61:{f:LHt},64:{f:Bn},65:{f:HHt},66:{f:Jn},77:{},80:{},81:{},82:{},85:{f:Jn},89:{},90:{},91:{},92:{f:kHt},93:{f:sBt},94:{},95:{f:Bn},96:{},97:{},99:{f:Bn},125:{f:lye},128:{f:qHt},129:{f:AHt},130:{f:Jn},131:{f:Bn},132:{f:Bn},133:{f:PHt},134:{},140:{f:dBt},141:{f:Jn},144:{},146:{f:pBt},151:{},152:{},153:{},154:{},155:{},156:{f:Jn},157:{},158:{},160:{f:wBt},161:{f:yBt},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:GHt},190:{f:YHt},193:{f:If},197:{},198:{},199:{},200:{},201:{},202:{f:Bn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Jn},220:{},221:{f:Bn},222:{},224:{f:XHt},225:{f:RHt},226:{f:If},227:{},229:{f:oBt},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:IHt},253:{f:WHt},255:{f:MHt},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:tye},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Bn},353:{f:If},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:JHt},431:{f:Bn},432:{},433:{},434:{},437:{},438:{f:fBt},439:{f:Bn},440:{f:cBt},441:{},442:{f:Q1},443:{},444:{f:Jn},445:{},446:{},448:{f:If},449:{f:NHt,r:2},450:{f:If},512:{f:sne},513:{f:bBt},515:{f:ZHt},516:{f:VHt},517:{f:lne},519:{f:_Bt},520:{f:DHt},523:{},545:{f:hne},549:{f:one},566:{},574:{f:FHt},638:{f:zHt},659:{},1048:{},1054:{f:UHt},1084:{},1212:{f:rBt},2048:{f:hBt},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:jT},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:If},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:gBt,r:12},2173:{f:G3t,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Bn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:tBt,r:12},2197:{},2198:{f:B3t,r:12},2199:{},2200:{},2201:{},2202:{f:nBt,r:12},2203:{f:If},2204:{},2205:{},2206:{},2207:{},2211:{f:$Ht},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Jn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mBt},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:vBt},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sne},1:{},2:{f:TBt},3:{f:xBt},4:{f:CBt},5:{f:lne},7:{f:OBt},8:{},9:{f:jT},11:{},22:{f:Jn},30:{f:jHt},31:{},32:{},33:{f:hne},36:{},37:{f:one},50:{f:EBt},62:{},52:{},67:{},68:{f:Jn},69:{},86:{},126:{},127:{f:SBt},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RBt},223:{},234:{},354:{},421:{},518:{f:c$},521:{f:jT},536:{f:cne},547:{f:fne},561:{},579:{},1030:{f:c$},1033:{f:jT},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vs(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Vge(r)&&e.push(r)}}function Cne(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,s=a&&a.index||e.length,l=JLt(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,c=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<l.length;++o){var g=l[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(y!="<td"&&y!="<th")){var b=g.split(/<\/t[dh]>/i);for(s=0;s<b.length;++s){var w=b[s].trim();if(w.match(/<t[dh]/i)){for(var _=w,x=0;_.charAt(0)=="<"&&(x=_.indexOf(">"))>-1;)_=_.slice(x+1);for(var E=0;E<v.length;++E){var R=v[E];R.s.c==f&&R.s.r<u&&u<=R.e.r&&(f=R.e.c+1,E=-1)}var A=Bt(w.slice(0,w.indexOf(">")));h=A.colspan?+A.colspan:1,((c=+A.rowspan)>1||h>1)&&v.push({s:{r:u,c:f},e:{r:u+(c||1)-1,c:f+h-1}});var N=A.t||A["data-t"]||"";if(!_.length){f+=h;continue}if(_=kge(_),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!_.length){f+=h;continue}var I={t:"s",v:_};r.raw||!_.trim().length||N=="s"||(_==="TRUE"?I={t:"b",v:!0}:_==="FALSE"?I={t:"b",v:!1}:isNaN(Ps(_))?isNaN(Em(_).getDate())||(I={t:"d",v:bi(_)},r.cellDates||(I={t:"n",v:ma(I.v)}),I.z=r.dateNF||er[14]):I={t:"n",v:Ps(_)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=I):n[Gt({r:u,c:f})]=I,f+=h}}}}return n["!ref"]=Or(d),v.length&&(n["!merges"]=v),n}function EUt(e,t,r,n){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){s=-1;break}s=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(s<0)){var f=Gt({r,c:o}),c=n.dense?(e[r]||[])[o]:e[f],h=c&&c.v!=null&&(c.h||uj(c.w||(Ku(c),c.w)||""))||"",d={};s>1&&(d.rowspan=s),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":c&&(d["data-t"]=c&&c.t||"z",c.v!=null&&(d["data-v"]=c.v),c.z!=null&&(d["data-z"]=c.z),c.l&&(c.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+c.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+f,a.push(dFt("td",h,d))}}var v="<tr>";return v+a.join("")+"</tr>"}var RUt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',kUt="</body></html>";function AUt(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Lc(Cne(r[0],t),t);var n=Ej();return r.forEach(function(i,a){Rj(n,Cne(i,t),"Sheet"+(a+1))}),n}function PUt(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function IUt(e,t){var r=t||{},n=r.header!=null?r.header:RUt,i=r.footer!=null?r.footer:kUt,a=[n],o=qm(e["!ref"]);r.dense=Array.isArray(e),a.push(PUt(e,o,r));for(var s=o.s.r;s<=o.e.r;++s)a.push(EUt(e,o,s,r));return a.push("</table>"+i),a.join("")}function Dye(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?ha(n.origin):n.origin;i=o.r,a=o.c}var s=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),u={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var f=qm(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var c=[],h=0,d=e["!rows"]||(e["!rows"]=[]),v=0,g=0,y=0,b=0,w=0,_=0;for(e["!cols"]||(e["!cols"]=[]);v<s.length&&g<l;++v){var x=s[v];if(xne(x)){if(n.display)continue;d[g]={hidden:!0}}var E=x.children;for(y=b=0;y<E.length;++y){var R=E[y];if(!(n.display&&xne(R))){var A=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):kge(R.innerHTML),N=R.getAttribute("data-z")||R.getAttribute("z");for(h=0;h<c.length;++h){var I=c[h];I.s.c==b+a&&I.s.r<g+i&&g+i<=I.e.r&&(b=I.e.c+1-a,h=-1)}_=+R.getAttribute("colspan")||1,((w=+R.getAttribute("rowspan")||1)>1||_>1)&&c.push({s:{r:g+i,c:b+a},e:{r:g+i+(w||1)-1,c:b+a+(_||1)-1}});var F={t:"s",v:A},H=R.getAttribute("data-t")||R.getAttribute("t")||"";A!=null&&(A.length==0?F.t=H||"z":n.raw||A.trim().length==0||H=="s"||(A==="TRUE"?F={t:"b",v:!0}:A==="FALSE"?F={t:"b",v:!1}:isNaN(Ps(A))?isNaN(Em(A).getDate())||(F={t:"d",v:bi(A)},n.cellDates||(F={t:"n",v:ma(F.v)}),F.z=n.dateNF||er[14]):F={t:"n",v:Ps(A)})),F.z===void 0&&N!=null&&(F.z=N);var W="",z=R.getElementsByTagName("A");if(z&&z.length)for(var te=0;te<z.length&&!(z[te].hasAttribute("href")&&(W=z[te].getAttribute("href"),W.charAt(0)!="#"));++te);W&&W.charAt(0)!="#"&&(F.l={Target:W}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+a]=F):e[Gt({c:b+a,r:g+i})]=F,u.e.c<b+a&&(u.e.c=b+a),b+=_}}++g}return c.length&&(e["!merges"]=(e["!merges"]||[]).concat(c)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=Or(u),g>=l&&(e["!fullref"]=Or((u.e.r=s.length-v+g-1+i,u))),e}function $ye(e,t){var r=t||{},n=r.dense?[]:{};return Dye(n,e,t)}function MUt(e,t){return Lc($ye(e,t),t)}function xne(e){var t="",r=DUt(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function DUt(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $Ut(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=kr(t.replace(/<[^>]*>/g,""));return[r]}var Tne={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Nye(e,t){var r=t||{},n=fj(e),i=[],a,o,s={name:""},l="",u=0,f,c,h={},d=[],v=r.dense?[]:{},g,y,b={value:""},w="",_=0,x=[],E=-1,R=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,I={},F=[],H={},W=0,z=0,te=[],ie=1,fe=1,Te=[],M={Names:[]},S={},T=["",""],k=[],O={},D="",L=0,B=!1,Y=!1,Q=0;for(US.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=US.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?v["!ref"]=Or(A):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(v["!fullref"]=v["!ref"],A.e.r=r.sheetRows-1,v["!ref"]=Or(A)),F.length&&(v["!merges"]=F),te.length&&(v["!rows"]=te),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),h[f.name]=v,Y=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=Bt(g[0],!1),E=R=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,v=r.dense?[]:{},F=[],te=[],Y=!0);break;case"table-row-group":g[1]==="/"?--N:++N;break;case"table-row":case"行":if(g[1]==="/"){E+=ie,ie=1;break}if(c=Bt(g[0],!1),c.行号?E=c.行号-1:E==-1&&(E=0),ie=+c["number-rows-repeated"]||1,ie<10)for(Q=0;Q<ie;++Q)N>0&&(te[E+Q]={level:N});R=-1;break;case"covered-table-cell":g[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(v[E]||(v[E]=[]),v[E][R]={t:"z"}):v[Gt({r:E,c:R})]={t:"z"}),w="",x=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++R,b=Bt(g[0],!1),fe=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=bne(kr(b.formula))),(b.数据类型||b["value-type"])=="string"&&(y.t="s",y.v=kr(b["string-value"]||""),r.dense?(v[E]||(v[E]=[]),v[E][R]=y):v[Gt({r:E,c:R})]=y),R+=fe-1;else if(g[1]!=="/"){++R,w="",_=0,x=[],fe=1;var he=ie?E+ie-1:E;if(R>A.e.c&&(A.e.c=R),R<A.s.c&&(A.s.c=R),E<A.s.r&&(A.s.r=E),he>A.e.r&&(A.e.r=he),b=Bt(g[0],!1),k=[],O={},y={t:b.数据类型||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=kr(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(W=parseInt(b["number-matrix-rows-spanned"],10)||0,z=parseInt(b["number-matrix-columns-spanned"],10)||0,H={s:{r:E,c:R},e:{r:E+W-1,c:R+z-1}},y.F=Or(H),Te.push([H,y.F])),b.formula)y.f=bne(b.formula);else for(Q=0;Q<Te.length;++Q)E>=Te[Q][0].s.r&&E<=Te[Q][0].e.r&&R>=Te[Q][0].s.c&&R<=Te[Q][0].e.c&&(y.F=Te[Q][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(W=parseInt(b["number-rows-spanned"],10)||0,z=parseInt(b["number-columns-spanned"],10)||0,H={s:{r:E,c:R},e:{r:E+W-1,c:R+z-1}},F.push(H)),b["number-columns-repeated"]&&(fe=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=pn(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=bi(b["date-value"]),r.cellDates||(y.t="n",y.v=ma(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=XLt(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=XA(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(w=kr(b["string-value"]),x=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(B=!1,y.t==="s"&&(y.v=w||"",x.length&&(y.R=x),B=_==0),S.Target&&(y.l=S),k.length>0&&(y.c=k,k=[]),w&&r.cellText!==!1&&(y.w=w),B&&(y.t="z",delete y.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var ce=0;ce<ie;++ce){if(fe=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(v[E+ce]||(v[E+ce]=[]),v[E+ce][R]=ce==0?y:Ti(y);--fe>0;)v[E+ce][R+fe]=Ti(y);else for(v[Gt({r:E+ce,c:R})]=y;--fe>0;)v[Gt({r:E+ce,c:R+fe})]=Ti(y);A.e.c<=R&&(A.e.c=R)}fe=parseInt(b["number-columns-repeated"]||"1",10),R+=fe-1,fe=0,y={},w="",x=[]}S={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a;O.t=w,x.length&&(O.R=x),O.a=D,k.push(O)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);D="",L=0,w="",_=0,x=[];break;case"creator":g[1]==="/"?D=n.slice(L,g.index):L=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);w="",_=0,x=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(I[s.name]=l,(a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",s=Bt(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Bt(g[0],!1),l+=Tne[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Bt(g[0],!1),l+=Tne[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Bt(g[0],!1),T=h$(o["cell-range-address"]);var le={Name:o.name,Ref:T[0]+"!"+T[1]};Y&&(le.Sheet=d.length),M.Names.push(le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var xe=$Ut(n.slice(_,g.index));w=(w.length>0?w+`
`:"")+xe[0]}else Bt(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{T=h$(Bt(g[0])["target-range-address"]),h[T[0]]["!autofilter"]={ref:T[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(S=Bt(g[0],!1),!S.href)break;S.Target=kr(S.href),delete S.href,S.Target.charAt(0)=="#"&&S.Target.indexOf(".")>-1?(T=h$(S.Target.slice(1)),S.Target="#"+T[0]+"!"+T[1]):S.Target.match(/^\.\.[\\\/]/)&&(S.Target=S.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var U={Sheets:h,SheetNames:d,Workbook:M};return r.bookSheets&&delete U.Sheets,U}function One(e,t){t=t||{},Mo(e,"META-INF/manifest.xml")&&ZFt(Zn(e,"META-INF/manifest.xml"),t);var r=no(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Nye(an(r),t);return Mo(e,"meta.xml")&&(n.Props=Xge(Zn(e,"meta.xml"))),n}function Ene(e,t){return Nye(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Cj(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function LB(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):an(hv(e))}function FB(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Rne(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function NUt(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function YS(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function di(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Fi(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=YS(e,r),a=i&7;i=Math.floor(i/8);var o=0,s;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);s=e.slice(l,r[0])}break;case 5:o=4,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=YS(e,r),s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var u={data:s,type:a};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function xj(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function LUt(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=YS(e,n),a=Fi(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:di(a[1][0].data),messages:[]};a[2].forEach(function(s){var l=Fi(s.data),u=di(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(o.merge=di(a[3][0].data)>>>0>0),r.push(o)}return r}function FUt(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=YS(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var s=o-59;o=t[r[0]],s>1&&(o|=t[r[0]+1]<<8),s>2&&(o|=t[r[0]+2]<<16),s>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=s}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[FB(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=FB(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function HUt(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(FUt(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return FB(t)}function BUt(e,t,r,n){var i=Cj(e),a=i.getUint32(4,!0),o=(n>1?12:8)+Rne(a&(n>1?3470:398))*4,s=-1,l=-1,u=NaN,f=new Date(2001,0,1);a&512&&(s=i.getUint32(o,!0),o+=4),o+=Rne(a&(n>1?12288:4096))*4,a&16&&(l=i.getUint32(o,!0),o+=4),a&32&&(u=i.getFloat64(o,!0),o+=8),a&64&&(f.setTime(f.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var c;switch(e[2]){case 0:break;case 2:c={t:"n",v:u};break;case 3:c={t:"s",v:t[l]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(s>-1)c={t:"s",v:r[s]};else if(l>-1)c={t:"s",v:t[l]};else if(!isNaN(u))c={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return c}function WUt(e,t,r){var n=Cj(e),i=n.getUint32(8,!0),a=12,o=-1,s=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=NUt(e,a),a+=16),i&2&&(u=n.getFloat64(a,!0),a+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(s=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var c;switch(e[1]){case 0:break;case 2:c={t:"n",v:l};break;case 3:c={t:"s",v:t[s]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(o>-1)c={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:c={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return c}function VUt(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return BUt(e,t,r,e[0]);case 5:return WUt(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function yc(e){var t=Fi(e);return YS(t[1][0].data)}function kne(e,t){var r=Fi(t.data),n=di(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var s=Fi(o.data),l=di(s[1][0].data)>>>0;switch(n){case 1:a[l]=LB(s[3][0].data);break;case 8:{var u=e[yc(s[9][0].data)][0],f=Fi(u.data),c=e[yc(f[1][0].data)][0],h=di(c.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=Fi(c.data);a[l]=d[3].map(function(v){return LB(v.data)}).join("")}break}}),a}function UUt(e,t){var r,n,i,a,o,s,l,u,f,c,h,d,v,g,y=Fi(e),b=di(y[1][0].data)>>>0,w=di(y[2][0].data)>>>0,_=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&di(y[8][0].data)>0||!1,x,E;if((a=(i=y[7])==null?void 0:i[0])!=null&&a.data&&t!=0)x=(s=(o=y[7])==null?void 0:o[0])==null?void 0:s.data,E=(u=(l=y[6])==null?void 0:l[0])==null?void 0:u.data;else if((c=(f=y[4])==null?void 0:f[0])!=null&&c.data&&t!=1)x=(d=(h=y[4])==null?void 0:h[0])==null?void 0:d.data,E=(g=(v=y[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=_?4:1,A=Cj(x),N=[],I=0;I<x.length/2;++I){var F=A.getUint16(I*2,!0);F<65535&&N.push([I,F])}if(N.length!=w)throw"Expected ".concat(w," cells, found ").concat(N.length);var H=[];for(I=0;I<N.length-1;++I)H[N[I][0]]=E.subarray(N[I][1]*R,N[I+1][1]*R);return N.length>=1&&(H[N[N.length-1][0]]=E.subarray(N[N.length-1][1]*R)),{R:b,cells:H}}function jUt(e,t){var r,n=Fi(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?di(n[7][0].data)>>>0>0?1:0:-1,a=xj(n[5],function(o){return UUt(o,i)});return{nrows:di(n[4][0].data)>>>0,data:a.reduce(function(o,s){return o[s.R]||(o[s.R]=[]),s.cells.forEach(function(l,u){if(o[s.R][u])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(u));o[s.R][u]=l}),o},[])}}function zUt(e,t,r){var n,i=Fi(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(di(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(di(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Or(a);var o=Fi(i[4][0].data),s=kne(e,e[yc(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?kne(e,e[yc(o[17][0].data)][0]):[],u=Fi(o[3][0].data),f=0;u[1].forEach(function(c){var h=Fi(c.data),d=e[yc(h[2][0].data)][0],v=di(d.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=jUt(e,d);g.data.forEach(function(y,b){y.forEach(function(w,_){var x=Gt({r:f+b,c:_}),E=VUt(w,s,l);E&&(r[x]=E)})}),f+=g.nrows})}function GUt(e,t){var r=Fi(t.data),n={"!ref":"A1"},i=e[yc(r[2][0].data)],a=di(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return zUt(e,i[0],n),n}function YUt(e,t){var r,n=Fi(t.data),i={name:(r=n[1])!=null&&r[0]?LB(n[1][0].data):"",sheets:[]},a=xj(n[2],yc);return a.forEach(function(o){e[o].forEach(function(s){var l=di(s.meta[1][0].data);l==6e3&&i.sheets.push(GUt(e,s))})}),i}function KUt(e,t){var r=Ej(),n=Fi(t.data),i=xj(n[1],yc);if(i.forEach(function(a){e[a].forEach(function(o){var s=di(o.meta[1][0].data);if(s==2){var l=YUt(e,o);l.sheets.forEach(function(u,f){Rj(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function v$(e){var t,r,n,i,a={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=HUt(l.content)}catch(c){return console.log("?? "+l.content.length+" "+(c.message||c))}var f;try{f=LUt(u)}catch(c){return console.log("## "+(c.message||c))}f.forEach(function(c){a[c.id]=c.messages,o.push(c.id)})}}),!o.length)throw new Error("File has no messages");var s=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&di(a[1][0].meta[1][0].data)==1&&a[1][0];if(s||o.forEach(function(l){a[l].forEach(function(u){var f=di(u.meta[1][0].data)>>>0;if(f==1)if(!s)s=u;else throw new Error("Document has multiple roots")})}),!s)throw new Error("Cannot find Document root");return KUt(a,s)}function XUt(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Tj(e){XUt([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function qUt(e){return Bp.WS.indexOf(e)>-1?"sheet":e==Bp.CS?"chart":e==Bp.DS?"dialog":e==Bp.MS?"macro":e&&e.length?e:"sheet"}function ZUt(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,qUt(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function JUt(e,t,r,n,i,a,o,s,l,u,f,c){try{a[n]=dw(no(e,r,!0),t);var h=Zn(e,t),d;switch(s){case"sheet":d=iUt(h,t,i,l,a[n],u,f,c);break;case"chart":if(d=aUt(h,t,i,l,a[n],u,f,c),!d||!d["!drawel"])break;var v=Pb(d["!drawel"].Target,t),g=IB(v),y=n4t(no(e,v,!0),dw(no(e,g,!0),v)),b=Pb(y,v),w=IB(b);d=WVt(no(e,b,!0),b,l,dw(no(e,w,!0),b),u,d);break;case"macro":d=oUt(h,t,i,l,a[n],u,f,c);break;case"dialog":d=sUt(h,t,i,l,a[n],u,f,c);break;default:throw new Error("Unrecognized sheet type "+s)}o[n]=d;var _=[];a&&a[n]&&wl(a[n]).forEach(function(x){var E="";if(a[n][x].Type==Bp.CMNT){E=Pb(a[n][x].Target,t);var R=cUt(Zn(e,E,!0),E,l);if(!R||!R.length)return;vne(d,R,!1)}a[n][x].Type==Bp.TCMNT&&(E=Pb(a[n][x].Target,t),_=_.concat(a4t(Zn(e,E,!0),l)))}),_&&_.length&&vne(d,_,!0,l.people||[])}catch(x){if(l.WTF)throw x}}function Ro(e){return e.charAt(0)=="/"?e.slice(1):e}function QUt(e,t){if(bge(),t=t||{},Tj(t),Mo(e,"META-INF/manifest.xml")||Mo(e,"objectdata.xml"))return One(e,t);if(Mo(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof v$<"u"){if(e.FileIndex)return v$(e);var r=xr.utils.cfb_new();return Wre(e).forEach(function(te){eFt(r,te,Tge(e,te))}),v$(r)}throw new Error("Unsupported NUMBERS file")}if(!Mo(e,"[Content_Types].xml"))throw Mo(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Mo(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Wre(e),i=XFt(no(e,"[Content_Types].xml")),a=!1,o,s;if(i.workbooks.length===0&&(s="xl/workbook.xml",Zn(e,s,!0)&&i.workbooks.push(s)),i.workbooks.length===0){if(s="xl/workbook.bin",!Zn(e,s,!0))throw new Error("Could not find workbook");i.workbooks.push(s),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(gw=[],i.sst)try{gw=fUt(Zn(e,Ro(i.sst)),i.sst,t)}catch(te){if(t.WTF)throw te}t.cellStyles&&i.themes.length&&(l=uUt(no(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=lUt(Zn(e,Ro(i.style)),i.style,l,t))}i.links.map(function(te){try{var ie=dw(no(e,IB(Ro(te))),te);return dUt(Zn(e,Ro(te)),ie,te,t)}catch{}});var f=nUt(Zn(e,Ro(i.workbooks[0])),i.workbooks[0],t),c={},h="";i.coreprops.length&&(h=Zn(e,Ro(i.coreprops[0]),!0),h&&(c=Xge(h)),i.extprops.length!==0&&(h=Zn(e,Ro(i.extprops[0]),!0),h&&eHt(h,c,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=no(e,Ro(i.custprops[0]),!0),h&&(d=rHt(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?o=f.Sheets.map(function(ie){return ie.name}):c.Worksheets&&c.SheetNames.length>0&&(o=c.SheetNames),t.bookProps&&(v.Props=c,v.Custprops=d),t.bookSheets&&typeof o<"u"&&(v.SheetNames=o),t.bookSheets?v.SheetNames:t.bookProps))return v;o={};var g={};t.bookDeps&&i.calcchain&&(g=hUt(Zn(e,Ro(i.calcchain)),i.calcchain));var y=0,b={},w,_;{var x=f.Sheets;c.Worksheets=x.length,c.SheetNames=[];for(var E=0;E!=x.length;++E)c.SheetNames[E]=x[E].name}var R=a?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),N=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Mo(e,N)||(N="xl/_rels/workbook."+R+".rels");var I=dw(no(e,N,!0),N.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=vUt(Zn(e,Ro(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=o4t(Zn(e,Ro(i.people[0])),t)),I&&(I=ZUt(I,f.Sheets));var F=Zn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=c.Worksheets;++y){var H="sheet";if(I&&I[y]?(w="xl/"+I[y][1].replace(/[\/]?xl\//,""),Mo(e,w)||(w=I[y][1]),Mo(e,w)||(w=N.replace(/_rels\/.*$/,"")+I[y][1]),H=I[y][2]):(w="xl/worksheets/sheet"+(y+1-F)+"."+R,w=w.replace(/sheet0\./,"sheet.")),_=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(c.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var W=!1,z=0;z!=t.sheets.length;++z)typeof t.sheets[z]=="number"&&t.sheets[z]==y&&(W=1),typeof t.sheets[z]=="string"&&t.sheets[z].toLowerCase()==c.SheetNames[y].toLowerCase()&&(W=1);if(!W)continue e}}JUt(e,w,_,c.SheetNames[y],y,b,o,H,t,f,l,u)}return v={Directory:i,Workbook:f,Props:c,Custprops:d,Deps:g,Sheets:o,SheetNames:c.SheetNames,Strings:gw,Styles:u,Themes:l,SSF:Ti(er)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(te,ie){te=te.replace(/^Root Entry[\/]/,""),v.keys.push(te),v.files[te]=e.FileIndex[ie]}))),t&&t.bookVBA&&(i.vba.length>0?v.vbaraw=Zn(e,Ro(i.vba[0]),!0):i.defaults&&i.defaults.bin===f4t&&(v.vbaraw=Zn(e,"xl/vbaProject.bin",!0))),v}function ejt(e,t){var r=t||{},n="Workbook",i=xr.find(e,n);try{if(n="/!DataSpaces/Version",i=xr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(GBt(i.content),n="/!DataSpaces/DataSpaceMap",i=xr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=KBt(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=xr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=XBt(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=xr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);ZBt(i.content)}catch{}if(n="/EncryptionInfo",i=xr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=JBt(i.content);if(n="/EncryptedPackage",i=xr.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(s[1],i.content,r.password||"",r);if(s[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(s[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Oj(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=fo(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function tjt(e,t){return xr.find(e,"EncryptedPackage")?ejt(e,t):Mye(e,t)}function rjt(e,t){var r,n=e,i=t||{};return i.type||(i.type=_r&&Buffer.isBuffer(e)?"buffer":"base64"),r=Oge(n,i),QUt(r,i)}function Lye(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return $B(e.slice(r),t);default:break e}return jS.to_workbook(e,t)}function njt(e,t){var r="",n=Oj(e,t);switch(t.type){case"base64":r=fo(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=zd(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=an(r)),t.type="binary",Lye(r,t)}function ijt(e,t){var r=e;return t.type=="base64"&&(r=fo(r)),r=Wf.utils.decode(1200,r.slice(2),"str"),t.type="binary",Lye(r,t)}function ajt(e){return e.match(/[^\x00-\x7F]/)?Ib(e):e}function p$(e,t,r,n){return n?(r.type="string",jS.to_workbook(e,r)):jS.to_workbook(t,r)}function HB(e,t){sge();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return HB(new Uint8Array(e),(r=Ti(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),cg={},r.dateNF&&(cg.dateNF=r.dateNF),r.type||(r.type=_r&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_r?"buffer":"binary",n=YLt(e),typeof Uint8Array<"u"&&!_r&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=ajt(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return r=Ti(r),r.type="array",HB(ij(n),r)}switch((i=Oj(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return tjt(xr.read(n,r),r);break;case 9:if(i[1]<=8)return Mye(n,r);break;case 60:return $B(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return MBt(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return PBt.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?rjt(n,r):p$(e,n,r,a);case 239:return i[3]===60?$B(n,r):p$(e,n,r,a);case 255:if(i[1]===254)return ijt(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return pw.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return pw.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return dne.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return f3t.to_workbook(n,r);break;case 10:case 13:case 32:return njt(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return kBt.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?dne.to_workbook(n,r):p$(e,n,r,a)}function ojt(e,t,r,n,i,a,o,s){var l=Oi(r),u=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),c=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=o?e[r][d]:e[n[d]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;a[d]!=null&&(h[a[d]]=u);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[d]!=null){if(g==null)if(v.t=="e"&&g===null)h[a[d]]=null;else if(u!==void 0)h[a[d]]=u;else if(f&&g===null)h[a[d]]=null;else continue;else h[a[d]]=f&&(v.t!=="n"||v.t==="n"&&s.rawNumbers!==!1)?g:Ku(v,g,s);g!=null&&(c=!1)}}return{row:h,isempty:c}}function BB(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Dn(f);break;case"number":l=Dn(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var c=Oi(l.s.r),h=[],d=[],v=0,g=0,y=Array.isArray(e),b=l.s.r,w=0,_={};y&&!e[b]&&(e[b]=[]);var x=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(x[w]||{}).hidden)switch(h[w]=fi(w),r=y?e[b][w]:e[h[w]+c],n){case 1:a[w]=w-l.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),s=o=Ku(r,null,u),g=_[o]||0,!g)_[o]=1;else{do s=o+"_"+g++;while(_[s]);_[o]=g,_[s]=1}a[w]=s}for(b=l.s.r+i;b<=l.e.r;++b)if(!(E[b]||{}).hidden){var R=ojt(e,l,b,h,n,a,y,u);(R.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[v++]=R.row)}return d.length=v,d}var Ane=/"/g;function sjt(e,t,r,n,i,a,o,s){for(var l=!0,u=[],f="",c=Oi(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=s.dense?(e[r]||[])[h]:e[n[h]+c];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(s.rawNumbers&&d.t=="n"?d.v:Ku(d,null,s));for(var v=0,g=0;v!==f.length;++v)if((g=f.charCodeAt(v))===i||g===a||g===34||s.forceQuotes){f='"'+f.replace(Ane,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(Ane,'""')+'"')):f="";u.push(f)}return s.blankrows===!1&&l?null:u.join(o)}function Fye(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Dn(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),s=n.RS!==void 0?n.RS:`
`,l=s.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",c=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(h[v]||{}).hidden||(c[v]=fi(v));for(var g=0,y=i.s.r;y<=i.e.r;++y)(d[y]||{}).hidden||(f=sjt(e,i,y,c,o,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?s:"")+f)));return delete n.dense,r.join("")}function ljt(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Fye(e,t);return r}function ujt(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Dn(e["!ref"]),a="",o=[],s,l=[],u=Array.isArray(e);for(s=i.s.c;s<=i.e.c;++s)o[s]=fi(s);for(var f=i.s.r;f<=i.e.r;++f)for(a=Oi(f),s=i.s.c;s<=i.e.c;++s)if(t=o[s]+a,r=u?(e[f]||[])[s]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function Hye(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},o=0,s=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?ha(n.origin):n.origin;o=l.r,s=l.c}var u,f={s:{c:0,r:0},e:{c:s,r:o+t.length-1+i}};if(a["!ref"]){var c=Dn(a["!ref"]);f.e.c=Math.max(f.e.c,c.e.c),f.e.r=Math.max(f.e.r,c.e.r),o==-1&&(o=c.e.r+1,f.e.r=o+t.length-1+i)}else o==-1&&(o=0,f.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(g,y){wl(g).forEach(function(b){(d=h.indexOf(b))==-1&&(h[d=h.length]=b);var w=g[b],_="z",x="",E=Gt({c:s+d,r:o+y+i});u=KS(a,E),w&&typeof w=="object"&&!(w instanceof Date)?a[E]=w:(typeof w=="number"?_="n":typeof w=="boolean"?_="b":typeof w=="string"?_="s":w instanceof Date?(_="d",n.cellDates||(_="n",w=ma(w)),x=n.dateNF||er[14]):w===null&&n.nullError&&(_="e",w=0),u?(u.t=_,u.v=w,delete u.w,delete u.R,x&&(u.z=x)):a[E]=u={t:_,v:w},x&&(u.z=x))})}),f.e.c=Math.max(f.e.c,s+h.length-1);var v=Oi(o);if(i)for(d=0;d<h.length;++d)a[fi(d+s)+v]={t:"s",v:h[d]};return a["!ref"]=Or(f),a}function fjt(e,t){return Hye(null,e,t)}function KS(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ha(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?KS(e,Gt(t)):KS(e,Gt({r:t,c:r||0}))}function cjt(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ej(){return{SheetNames:[],Sheets:{}}}function Rj(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(XVt(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function hjt(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=cjt(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function djt(e,t){return e.z=t,e}function Bye(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function vjt(e,t,r){return Bye(e,"#"+t,r)}function pjt(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function gjt(e,t,r,n){for(var i=typeof t!="string"?t:Dn(t),a=typeof t=="string"?t:Or(t),o=i.s.r;o<=i.e.r;++o)for(var s=i.s.c;s<=i.e.c;++s){var l=KS(e,o,s);l.t="n",l.F=a,delete l.v,o==i.s.r&&s==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Pne={encode_col:fi,encode_row:Oi,encode_cell:Gt,encode_range:Or,decode_col:dj,decode_row:hj,split_cell:RFt,decode_cell:ha,decode_range:qm,format_cell:Ku,sheet_add_aoa:jge,sheet_add_json:Hye,sheet_add_dom:Dye,aoa_to_sheet:Zm,json_to_sheet:fjt,table_to_sheet:$ye,table_to_book:MUt,sheet_to_csv:Fye,sheet_to_txt:ljt,sheet_to_json:BB,sheet_to_html:IUt,sheet_to_formulae:ujt,sheet_to_row_object_array:BB,sheet_get_cell:KS,book_new:Ej,book_append_sheet:Rj,book_set_sheet_visibility:hjt,cell_set_number_format:djt,cell_set_hyperlink:Bye,cell_set_internal_link:vjt,cell_add_comment:pjt,sheet_set_array_formula:gjt,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const yjt={class:"table-wrapper"},mjt={class:"toolbar"},bjt={class:"left"},wjt={class:"table-box"},_jt=ba({__name:"dataTable",setup(e){age();const t=da(null),r=_s(()=>{var l;return((l=n==null?void 0:n.value.config)==null?void 0:l.data)||null}),n=Xu(_l);kp(()=>r.value,()=>{t.value.hotInstance.updateData(io.cloneDeep(r.value))},{deep:!0});const i=()=>{eE(()=>{const u=t.value.hotInstance.getSourceData().map(c=>c.filter(h=>h!==null)).filter(c=>c.length);console.log(JSON.stringify(u));const f=io.isEqual(u,r.value);if(r.value&&!f&&u.length){const c=io.cloneDeep(n==null?void 0:n.value);c.config.data=u,Wo.emit("updateChart",c)}})},a=l=>{try{const u=new FileReader;u.onload=f=>{const c=f.target.result,h=HB(c,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],v=Pne.decode_range(d["!ref"]);var g=[];for(let y=v.s.r;y<=v.e.r;y++){let b=g.length;g.push([]);for(let w=v.s.c;w<=v.e.c;w++){let _=d[Pne.encode_cell({r:y,c:w})];_&&g[b].push(_.v)}}t.value.hotInstance.updateData(g),aCe.success("导出成功")},u.readAsBinaryString(l)}catch(u){console.log("err: ",u)}return!1},o=()=>{t.value.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:n==null?void 0:n.value.name})};Yd(()=>{r.value&&t.value.hotInstance.updateData(io.cloneDeep(r.value))});const s=_s(()=>({language:"zh-CN",licenseKey:"non-commercial-and-evaluation",width:"auto",data:null,startRows:30,startCols:15,minSpareRows:30,minSpareCols:15,colHeaders:!0,rowHeaders:!0,colWidths:100,dropdownMenu:!1,autoWrapRow:!0,fixedRowsTop:0,fixedColumnsLeft:1,fillHandle:!0,manualRowMove:!0,afterChange(){i()},afterCreateCol(){i()},afterCreateRow(){i()},afterRemoveCol(){i()},afterRemoveRow(){i()},contextMenu:{items:{row_above:{name:"上面插入一行"},row_below:{name:"下面插入一行"},col_left:{name:"左侧插入一列"},col_right:{name:"右侧插入一列"},remove_row:{name:"移除本行"},remove_col:{name:"移除本列"},alignment:{name:"对齐方式"},make_read_only:{name:"只读"},copy:{name:"复制"},cut:{name:"剪切"},separator:It.plugins.ContextMenu.SEPARATOR}}}));return(l,u)=>{const f=mc("el-button"),c=mc("el-upload");return Cr(),Gr("div",yjt,[fr("div",mjt,[fr("div",bjt,[li(c,{"before-upload":a},{default:Du(()=>[li(f,{type:"primary",class:"import-btn"},{default:Du(()=>[JO("导入数据")]),_:1})]),_:1}),li(f,{plain:"",type:"primary",onClick:o},{default:Du(()=>[JO("下载数据")]),_:1})])]),fr("div",wjt,[li(ln(kU),{ref_key:"hotTableComponent",ref:t,settings:ln(s)},null,8,["settings"])])])}}});const Sjt=Xo(_jt,[["__scopeId","data-v-bc8ccbf2"]]),Wye=e=>(WB("data-v-adddbc27"),e=e(),VB(),e),Cjt=Wye(()=>fr("i",{class:"iconfont icon-fanhui"},null,-1)),xjt=Wye(()=>fr("i",{class:"iconfont icon-fanhui"},null,-1)),Tjt={class:"content"},Ojt=ba({__name:"widget",props:{title:{type:String,default:"标题"},tooltip:{type:String,default:""},open:{type:Boolean,default:!1}},setup(e){const t=e,r=da(!1),n=()=>{r.value=!r.value};return Yd(()=>{r.value=t.open}),(i,a)=>{const o=mc("el-tooltip");return Cr(),Gr("div",{class:Ff(["widget",{open:r.value}])},[e.tooltip?(Cr(),km(o,{key:0,effect:"dark",content:e.tooltip,placement:"left"},{default:Du(()=>[fr("div",{class:"top",onClick:n},[fr("div",null,hg(e.title),1),Cjt])]),_:1},8,["content"])):(Cr(),Gr("div",{key:1,class:"top",onClick:n},[fr("div",null,hg(e.title),1),xjt])),fr("div",Tjt,[Dne(i.$slots,"default",{},void 0,!0)])],2)}}});const kj=Xo(Ojt,[["__scopeId","data-v-adddbc27"]]),Aj=(e,t,r)=>{const n=io.cloneDeep(e),{config:i}=n;i[t]=io.isObject(r)?io.cloneDeep(r):r,console.log("config[key]: ",i[t]),Wo.emit("updateChart",n)},Ejt={class:"wrapper"},Rjt=ba({__name:"title",setup(e){const t=Xu(_l),r=da({}),n=()=>{const{config:a}=t.value;r.value={...a==null?void 0:a.title}},i=()=>{Aj(t.value,"title",r.value)};return Yd(()=>{n()}),(a,o)=>{const s=mc("el-checkbox"),l=mc("el-input");return Cr(),km(ln(kj),{title:"标题",tooltip:"设置图表标题"},{default:Du(()=>[fr("div",Ejt,[li(s,{modelValue:r.value.show,"onUpdate:modelValue":o[0]||(o[0]=u=>r.value.show=u),label:"",size:"small",onChange:i},null,8,["modelValue"]),li(l,{modelValue:r.value.value,"onUpdate:modelValue":o[1]||(o[1]=u=>r.value.value=u),size:"small",onInput:i},null,8,["modelValue"])])]),_:1})}}});const kjt=Xo(Rjt,[["__scopeId","data-v-e3142e3f"]]),Ajt={class:"wrapper"},Pjt=["onClick"],Ijt=ba({__name:"theme",setup(e){const t=Xu(_l),r=da({theme:""}),n=()=>{const{config:o}=t.value;r.value.theme=(o==null?void 0:o.theme)||"westeros"},i=o=>o.filter((s,l)=>l<6),a=o=>{r.value.theme=o,Aj(t.value,"theme",r.value.theme)};return Yd(()=>{n()}),(o,s)=>(Cr(),km(ln(kj),{title:"主题",tooltip:"设置图表主题"},{default:Du(()=>[fr("div",Ajt,[(Cr(!0),Gr(Wp,null,Vp(ln(aNe),l=>(Cr(),Gr("div",{key:l.value,class:Ff(["theme",{active:l.value===r.value.theme}]),onClick:u=>a(l.value)},[(Cr(!0),Gr(Wp,null,Vp(i(l.color),u=>(Cr(),Gr("div",{key:u,style:oCe({background:u}),class:"color"},null,4))),128))],10,Pjt))),128))])]),_:1}))}});const Mjt=Xo(Ijt,[["__scopeId","data-v-09720a37"]]),Djt={class:"wrapper"},$jt=ba({__name:"legend",setup(e){const t=Xu(_l),r=da({legend:!0}),n=()=>{const{config:a}=t.value;r.value.legend=a==null?void 0:a.legend},i=()=>{Aj(t.value,"legend",r.value.legend)};return Yd(()=>{n()}),(a,o)=>{const s=mc("el-checkbox");return Cr(),km(ln(kj),{title:"图例",tooltip:"颜色所代表内容与指标说明"},{default:Du(()=>[fr("div",Djt,[li(s,{modelValue:r.value.legend,"onUpdate:modelValue":o[0]||(o[0]=l=>r.value.legend=l),label:"图例显示",size:"small",onChange:i},null,8,["modelValue"])])]),_:1})}}});const Njt=Xo($jt,[["__scopeId","data-v-970e77c3"]]),Ljt={class:"setting"},Fjt=ba({__name:"setting",setup(e){return Xu(_l),(t,r)=>(Cr(),Gr("div",Ljt,[li(ln(kjt),{open:!0}),li(ln(Mjt),{open:!0}),li(ln(Njt),{open:!0})]))}});const Hjt=Xo(Fjt,[["__scopeId","data-v-518ab403"]]),Bjt={class:"setting-block"},Wjt={class:"tabs"},Vjt=["onClick"],Ujt={key:0,class:"data-table"},jjt={class:"chart-setting"},zjt=ba({__name:"settingBlock",setup(e){Xu(_l);const t=[{value:"setting",label:"编辑图表"},{value:"data",label:"编辑数据"}],r=da("setting"),n=i=>{r.value=i};return(i,a)=>(Cr(),Gr("div",Bjt,[fr("div",Wjt,[(Cr(),Gr(Wp,null,Vp(t,o=>fr("div",{key:o.value,class:Ff(["item",{active:r.value===o.value}]),onClick:s=>n(o.value)},hg(o.label),11,Vjt)),64))]),r.value==="data"?(Cr(),Gr("div",Ujt,[li(ln(Sjt))])):Td("",!0),QO(fr("div",jjt,[li(ln(Hjt))],512),[[g$,r.value==="setting"]])]))}});const Gjt=Xo(zjt,[["__scopeId","data-v-3bc03d2c"]]),Yjt=["loading"],Kjt={key:1,class:"container"},Xjt=ba({__name:"chart",setup(e){const t=q1e(),r=sCe(),n=_s(()=>+r.params.id),i=da({}),a=da(!0),o=async()=>{const l=await t.get(n.value);i.value=l};Mne(_l,lCe(i)),Wo.on("updateChart",async l=>{l.updatedTime=new Date().getTime(),await t.set(l),await o(),s()});const s=()=>{new BroadcastChannel("chart").postMessage("updateChart")};return Yd(async()=>{var l;await o(),a.value=!1,(l=document.querySelector("html"))==null||l.classList.add("dark")}),(l,u)=>(Cr(),Gr("div",{class:"chart-wrapper",loading:a.value},[a.value?Td("",!0):(Cr(),km(ln(_Ce),{key:0})),a.value?Td("",!0):(Cr(),Gr("div",Kjt,[li(ln($Ce)),li(ln(TNe)),li(ln(Gjt))])),li(ln(HCe))],8,Yjt))}});const Jjt=Xo(Xjt,[["__scopeId","data-v-422f22e1"]]);export{Jjt as default};
