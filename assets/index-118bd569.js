import{e as Ta,_ as ace,a as oce,P as sce,d as lce,c as Ji,D as uce,f as fce,u as cce}from"./lodash-0a69c344.js";import{B as Vy,d as _i,o as Yt,a as vr,b as $t,e as rn,w as nl,t as rv,j as Tr,f as Yo,g as Ym,q as _N,s as SN,_ as Ma,r as Mn,F as Pd,v as Id,l as BC,D as XP,G as Xl,y as Rc,m as bg,E as hce,z as dce,H as jE,I as vce,c as eo,J as pce,K as bd,L as f4,i as qc,M as gce,N as yce,p as VC,O as Kq,P as Xq,Q as qP,R as mce,S as qq,T as bce,A as wce,U as _ce,u as Sce,V as Cce}from"./index-ea3582a9.js";const Qo=Symbol("CHART");function ml(e,t){const r=Vy(e,t);if(!r)throw new Error(`Could not resolve ${e.description}`);return r}const Zq=e=>(_N("data-v-722fad7b"),e=e(),SN(),e),xce={class:"topbar"},Tce={class:"left"},Oce={class:"logo",title:"charts"},Ece=Zq(()=>$t("img",{src:ace,alt:"charts"},null,-1)),Rce={class:"center"},kce={class:"name-box"},Ace={class:"name"},Pce={class:"right"},Ice={class:"operation"},Mce=Zq(()=>$t("div",null,[$t("i",{class:"iconfont icon-xiazai"}),$t("div",{class:"text"},"下载")],-1)),Dce=[Mce],$ce=_i({__name:"topbar",setup(e){const t=ml(Qo),r=n=>{Ta.emit("handleChart",n)};return(n,i)=>{const a=Yo("router-link");return Yt(),vr("div",xce,[$t("div",Tce,[$t("h1",Oce,[rn(a,{tag:"a",to:{name:"home"}},{default:nl(()=>[Ece,Ym(" Charts ")]),_:1})])]),$t("div",Rce,[$t("div",kce,[$t("div",Ace,rv(Tr(t).name)+" ",1)])]),$t("div",Pce,[$t("div",Ice,[$t("div",{class:"item",onClick:i[0]||(i[0]=o=>r("download"))},Dce)])])])}}});const Nce=Ma($ce,[["__scopeId","data-v-722fad7b"]]),Jq=e=>(_N("data-v-c30cc333"),e=e(),SN(),e),Lce={class:"chart-list"},Fce=["onClick"],Hce=Jq(()=>$t("i",{class:"icon-sanjiaoyou iconfont"},null,-1)),Bce={key:0,class:"chart-wrapper"},Vce=["onClick"],jce={class:"preview"},Wce={class:"name-box"},Uce={class:"chart-nav"},zce=["onClick"],Gce=Jq(()=>$t("i",{class:"iconfont icon-shouqi"},null,-1)),Yce={key:0,class:"text"},Kce=_i({__name:"typeBlock",setup(e){const t=ml(Qo),r=Mn(oce().map(o=>({...o,open:!0}))),n=o=>{o.open=!o.open},i=Mn(!1),a=o=>{hce.confirm("切换图表类型将会替换原图表的数据，你确定要切换吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ta.emit("chartClear");const s=Ji.cloneDeep(t==null?void 0:t.value),l=uce[o.value];s.config.data=l,s.type=o.value,Ta.emit("updateChart",s)})};return(o,s)=>{const l=Yo("el-tooltip");return Yt(),vr("div",{class:Xl(["type-block",{expand:i.value}])},[$t("div",Lce,[(Yt(!0),vr(Pd,null,Id(r.value,u=>BC((Yt(),vr("div",{key:u.value},[$t("div",{class:Xl(["tab",{open:u.open}]),onClick:f=>n(u)},[Hce,Ym(" "+rv(u.label),1)],10,Fce),u.open?(Yt(),vr("div",Bce,[(Yt(!0),vr(Pd,null,Id(u.children,f=>(Yt(),vr("div",{key:f.value,class:Xl([{active:f.value===Tr(t).type},"chart-block"]),onClick:c=>a(f)},[$t("div",jce,[rn(Tr(sce),{chart:f},null,8,["chart"])]),$t("div",Wce,rv(f.label),1)],10,Vce))),128))])):Rc("",!0)])),[[XP,i.value]])),128)),BC($t("div",Uce,[(Yt(!0),vr(Pd,null,Id(Tr(lce),u=>(Yt(),bg(l,{key:u.value,content:u.label,placement:"right"},{default:nl(()=>[$t("div",{class:Xl({active:u.value===Tr(t).type}),onClick:f=>a(u)},[$t("i",{class:Xl(["iconfont",[u.icon]])},null,2)],10,zce)]),_:2},1032,["content"]))),128))],512),[[XP,!i.value]])]),$t("div",{class:"bottom",onClick:s[0]||(s[0]=u=>i.value=!i.value)},[$t("div",null,[Gce,i.value?(Yt(),vr("span",Yce,"收起")):Rc("",!0)])])],2)}}});const Xce=Ma(Kce,[["__scopeId","data-v-c30cc333"]]),qce={key:0,class:"download-loading"},Zce={class:"wrapper","element-loading-background":"transparent","element-loading-text":"下载中, 请稍后..."},Jce=_i({__name:"loading",setup(e){const t=Mn(!1);return Ta.on("chartLoading",r=>{t.value=r}),(r,n)=>{const i=dce("loading");return t.value?(Yt(),vr("div",qce,[BC($t("div",Zce,null,512),[[i,!0]])])):Rc("",!0)}}});const Qce=Ma(Jce,[["__scopeId","data-v-39f8190a"]]),ehe={color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],backgroundColor:"transparent",textStyle:{},title:{textStyle:{color:"#516b91"},subtextStyle:{color:"#93b7e3"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"circle",smooth:!0},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"circle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#edafda",color0:"transparent",borderColor:"#d680bc",borderColor0:"#8fd3e8",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:"6",symbol:"circle",smooth:!0,color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},geo:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#8fd3e8",width:1},itemStyle:{color:"#8fd3e8",borderWidth:1},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},checkpointStyle:{color:"#8fd3e8",borderColor:"#8a7ca8"},label:{color:"#8fd3e8"},emphasis:{itemStyle:{color:"#8fd3e8"},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},label:{color:"#8fd3e8"}}},visualMap:{color:["#516b91","#59c4e6","#a5e7f0"]},dataZoom:{backgroundColor:"rgba(0,0,0,0)",dataBackgroundColor:"rgba(255,255,255,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ZP=function(e,t){return ZP=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},ZP(e,t)};function Ye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ZP(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var the=function(){function e(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return e}(),rhe=function(){function e(){this.browser=new the,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return e}(),$f=new rhe;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?($f.wxa=!0,$f.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?$f.worker=!0:typeof navigator>"u"?($f.node=!0,$f.svgSupported=!0):nhe(navigator.userAgent,$f);function nhe(e,t){var r=t.browser,n=e.match(/Firefox\/([\d.]+)/),i=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),a=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);n&&(r.firefox=!0,r.version=n[1]),i&&(r.ie=!0,r.version=i[1]),a&&(r.edge=!0,r.version=a[1],r.newEdge=+a[1].split(".")[0]>18),o&&(r.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,t.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),t.domSupported=typeof document<"u";var s=document.documentElement.style;t.transform3dSupported=(r.ie&&"transition"in s||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||r.ie&&+r.version>=9}const Bt=$f;var CN=12,ihe="sans-serif",kc=CN+"px "+ihe,ahe=20,ohe=100,she="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function lhe(e){var t={};if(typeof JSON>"u")return t;for(var r=0;r<e.length;r++){var n=String.fromCharCode(r+32),i=(e.charCodeAt(r)-ahe)/ohe;t[n]=i}return t}var uhe=lhe(she),wg={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var e,t;return function(r,n){if(!e){var i=wg.createCanvas();e=i&&i.getContext("2d")}if(e)return t!==n&&(t=e.font=n||kc),e.measureText(r);r=r||"",n=n||kc;var a=/(\d+)px/.exec(n),o=a&&+a[1]||CN,s=0;if(n.indexOf("mono")>=0)s=o*r.length;else for(var l=0;l<r.length;l++){var u=uhe[r[l]];s+=u==null?o:u*o}return{width:s}}}(),loadImage:function(e,t,r){var n=new Image;return n.onload=t,n.onerror=r,n.src=e,n}},Qq=ku(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),eZ=ku(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),xw=Object.prototype.toString,KT=Array.prototype,fhe=KT.forEach,che=KT.filter,xN=KT.slice,hhe=KT.map,c4=function(){}.constructor,I_=c4?c4.prototype:null,TN="__proto__",dhe=2311;function tZ(){return dhe++}function ON(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];typeof console<"u"&&console.error.apply(console,e)}function Qt(e){if(e==null||typeof e!="object")return e;var t=e,r=xw.call(e);if(r==="[object Array]"){if(!lm(e)){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=Qt(e[n])}}else if(eZ[r]){if(!lm(e)){var a=e.constructor;if(a.from)t=a.from(e);else{t=new a(e.length);for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}}}else if(!Qq[r]&&!lm(e)&&!jC(e)){t={};for(var o in e)e.hasOwnProperty(o)&&o!==TN&&(t[o]=Qt(e[o]))}return t}function ar(e,t,r){if(!dt(t)||!dt(e))return r?Qt(t):e;for(var n in t)if(t.hasOwnProperty(n)&&n!==TN){var i=e[n],a=t[n];dt(a)&&dt(i)&&!et(a)&&!et(i)&&!jC(a)&&!jC(i)&&!h4(a)&&!h4(i)&&!lm(a)&&!lm(i)?ar(i,a,r):(r||!(n in e))&&(e[n]=Qt(t[n]))}return e}function Le(e,t){if(Object.assign)Object.assign(e,t);else for(var r in t)t.hasOwnProperty(r)&&r!==TN&&(e[r]=t[r]);return e}function lr(e,t,r){for(var n=Dr(t),i=0;i<n.length;i++){var a=n[i];(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}return e}function yr(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return-1}function vhe(e,t){var r=e.prototype;function n(){}n.prototype=t.prototype,e.prototype=new n;for(var i in r)r.hasOwnProperty(i)&&(e.prototype[i]=r[i]);e.prototype.constructor=e,e.superClass=t}function es(e,t,r){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var a=n[i];a!=="constructor"&&(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}else lr(e,t,r)}function Ni(e){return!e||typeof e=="string"?!1:typeof e.length=="number"}function le(e,t,r){if(e&&t)if(e.forEach&&e.forEach===fhe)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(r,e[a],a,e)}function pt(e,t,r){if(!e)return[];if(!t)return EN(e);if(e.map&&e.map===hhe)return e.map(t,r);for(var n=[],i=0,a=e.length;i<a;i++)n.push(t.call(r,e[i],i,e));return n}function ku(e,t,r,n){if(e&&t){for(var i=0,a=e.length;i<a;i++)r=t.call(n,r,e[i],i,e);return r}}function hi(e,t,r){if(!e)return[];if(!t)return EN(e);if(e.filter&&e.filter===che)return e.filter(t,r);for(var n=[],i=0,a=e.length;i<a;i++)t.call(r,e[i],i,e)&&n.push(e[i]);return n}function Dr(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}function phe(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){return e.apply(t,r.concat(xN.call(arguments)))}}var Or=I_&&Nt(I_.bind)?I_.call.bind(I_.bind):phe;function en(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){return e.apply(this,t.concat(xN.call(arguments)))}}function et(e){return Array.isArray?Array.isArray(e):xw.call(e)==="[object Array]"}function Nt(e){return typeof e=="function"}function st(e){return typeof e=="string"}function JP(e){return xw.call(e)==="[object String]"}function _r(e){return typeof e=="number"}function dt(e){var t=typeof e;return t==="function"||!!e&&t==="object"}function h4(e){return!!Qq[xw.call(e)]}function ta(e){return!!eZ[xw.call(e)]}function jC(e){return typeof e=="object"&&typeof e.nodeType=="number"&&typeof e.ownerDocument=="object"}function XT(e){return e.colorStops!=null}function ghe(e){return e.image!=null}function WC(e){return e!==e}function Km(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e.length;r<n;r++)if(e[r]!=null)return e[r]}function Xt(e,t){return e??t}function sm(e,t,r){return e??t??r}function EN(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return xN.apply(e,t)}function rZ(e){if(typeof e=="number")return[e,e,e,e];var t=e.length;return t===2?[e[0],e[1],e[0],e[1]]:t===3?[e[0],e[1],e[2],e[1]]:e}function ul(e,t){if(!e)throw new Error(t)}function Uo(e){return e==null?null:typeof e.trim=="function"?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var nZ="__ec_primitive__";function QP(e){e[nZ]=!0}function lm(e){return e[nZ]}var yhe=function(){function e(){this.data={}}return e.prototype.delete=function(t){var r=this.has(t);return r&&delete this.data[t],r},e.prototype.has=function(t){return this.data.hasOwnProperty(t)},e.prototype.get=function(t){return this.data[t]},e.prototype.set=function(t,r){return this.data[t]=r,this},e.prototype.keys=function(){return Dr(this.data)},e.prototype.forEach=function(t){var r=this.data;for(var n in r)r.hasOwnProperty(n)&&t(r[n],n)},e}(),iZ=typeof Map=="function";function mhe(){return iZ?new Map:new yhe}var bhe=function(){function e(t){var r=et(t);this.data=mhe();var n=this;t instanceof e?t.each(i):t&&le(t,i);function i(a,o){r?n.set(a,o):n.set(o,a)}}return e.prototype.hasKey=function(t){return this.data.has(t)},e.prototype.get=function(t){return this.data.get(t)},e.prototype.set=function(t,r){return this.data.set(t,r),r},e.prototype.each=function(t,r){this.data.forEach(function(n,i){t.call(r,n,i)})},e.prototype.keys=function(){var t=this.data.keys();return iZ?Array.from(t):t},e.prototype.removeKey=function(t){this.data.delete(t)},e}();function Vt(e){return new bhe(e)}function whe(e,t){for(var r=new e.constructor(e.length+t.length),n=0;n<e.length;n++)r[n]=e[n];for(var i=e.length,n=0;n<t.length;n++)r[n+i]=t[n];return r}function qT(e,t){var r;if(Object.create)r=Object.create(e);else{var n=function(){};n.prototype=e,r=new n}return t&&Le(r,t),r}function aZ(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function nv(e,t){return e.hasOwnProperty(t)}function Di(){}var _he=180/Math.PI;function _g(e,t){return e==null&&(e=0),t==null&&(t=0),[e,t]}function She(e){return[e[0],e[1]]}function d4(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Che(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function xhe(e){return Math.sqrt(The(e))}function The(e){return e[0]*e[0]+e[1]*e[1]}function WE(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Ohe(e,t){var r=xhe(t);return r===0?(e[0]=0,e[1]=0):(e[0]=t[0]/r,e[1]=t[1]/r),e}function eI(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var tI=eI;function Ehe(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var Md=Ehe;function UE(e,t,r,n){return e[0]=t[0]+n*(r[0]-t[0]),e[1]=t[1]+n*(r[1]-t[1]),e}function Ra(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function wd(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function _d(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}var _h=function(){function e(t,r){this.target=t,this.topTarget=r&&r.topTarget}return e}(),Rhe=function(){function e(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(t){for(var r=t.target;r&&!r.draggable;)r=r.parent||r.__hostTarget;r&&(this._draggingTarget=r,r.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new _h(r,t),"dragstart",t.event))},e.prototype._drag=function(t){var r=this._draggingTarget;if(r){var n=t.offsetX,i=t.offsetY,a=n-this._x,o=i-this._y;this._x=n,this._y=i,r.drift(a,o,t),this.handler.dispatchToElement(new _h(r,t),"drag",t.event);var s=this.handler.findHover(n,i,r).target,l=this._dropTarget;this._dropTarget=s,r!==s&&(l&&s!==l&&this.handler.dispatchToElement(new _h(l,t),"dragleave",t.event),s&&s!==l&&this.handler.dispatchToElement(new _h(s,t),"dragenter",t.event))}},e.prototype._dragEnd=function(t){var r=this._draggingTarget;r&&(r.dragging=!1),this.handler.dispatchToElement(new _h(r,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new _h(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},e}();const khe=Rhe;var Ahe=function(){function e(t){t&&(this._$eventProcessor=t)}return e.prototype.on=function(t,r,n,i){this._$handlers||(this._$handlers={});var a=this._$handlers;if(typeof r=="function"&&(i=n,n=r,r=null),!n||!t)return this;var o=this._$eventProcessor;r!=null&&o&&o.normalizeQuery&&(r=o.normalizeQuery(r)),a[t]||(a[t]=[]);for(var s=0;s<a[t].length;s++)if(a[t][s].h===n)return this;var l={h:n,query:r,ctx:i||this,callAtLast:n.zrEventfulCallAtLast},u=a[t].length-1,f=a[t][u];return f&&f.callAtLast?a[t].splice(u,0,l):a[t].push(l),this},e.prototype.isSilent=function(t){var r=this._$handlers;return!r||!r[t]||!r[t].length},e.prototype.off=function(t,r){var n=this._$handlers;if(!n)return this;if(!t)return this._$handlers={},this;if(r){if(n[t]){for(var i=[],a=0,o=n[t].length;a<o;a++)n[t][a].h!==r&&i.push(n[t][a]);n[t]=i}n[t]&&n[t].length===0&&delete n[t]}else delete n[t];return this},e.prototype.trigger=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=i.length,l=0;l<s;l++){var u=i[l];if(!(a&&a.filter&&u.query!=null&&!a.filter(t,u.query)))switch(o){case 0:u.h.call(u.ctx);break;case 1:u.h.call(u.ctx,r[0]);break;case 2:u.h.call(u.ctx,r[0],r[1]);break;default:u.h.apply(u.ctx,r);break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e.prototype.triggerWithContext=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=r[o-1],l=i.length,u=0;u<l;u++){var f=i[u];if(!(a&&a.filter&&f.query!=null&&!a.filter(t,f.query)))switch(o){case 0:f.h.call(s);break;case 1:f.h.call(s,r[0]);break;case 2:f.h.call(s,r[0],r[1]);break;default:f.h.apply(s,r.slice(1,o-1));break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e}();const ts=Ahe;var Phe=Math.log(2);function rI(e,t,r,n,i,a){var o=n+"-"+i,s=e.length;if(a.hasOwnProperty(o))return a[o];if(t===1){var l=Math.round(Math.log((1<<s)-1&~i)/Phe);return e[r][l]}for(var u=n|1<<r,f=r+1;n&1<<f;)f++;for(var c=0,h=0,d=0;h<s;h++){var v=1<<h;v&i||(c+=(d%2?-1:1)*e[r][h]*rI(e,t-1,f,u,i|v,a),d++)}return a[o]=c,c}function v4(e,t){var r=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],n={},i=rI(r,8,0,0,0,n);if(i!==0){for(var a=[],o=0;o<8;o++)for(var s=0;s<8;s++)a[s]==null&&(a[s]=0),a[s]+=((o+s)%2?-1:1)*rI(r,7,o===0?1:0,1<<o,1<<s,n)/i*t[o];return function(l,u,f){var c=u*a[6]+f*a[7]+1;l[0]=(u*a[0]+f*a[1]+a[2])/c,l[1]=(u*a[3]+f*a[4]+a[5])/c}}}var p4="___zrEVENTSAVED",zE=[];function Ihe(e,t,r,n,i){return nI(zE,t,n,i,!0)&&nI(e,r,zE[0],zE[1])}function nI(e,t,r,n,i){if(t.getBoundingClientRect&&Bt.domSupported&&!oZ(t)){var a=t[p4]||(t[p4]={}),o=Mhe(t,a),s=Dhe(o,a,i);if(s)return s(e,r,n),!0}return!1}function Mhe(e,t){var r=t.markers;if(r)return r;r=t.markers=[];for(var n=["left","right"],i=["top","bottom"],a=0;a<4;a++){var o=document.createElement("div"),s=o.style,l=a%2,u=(a>>1)%2;s.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[l]+":0",i[u]+":0",n[1-l]+":auto",i[1-u]+":auto",""].join("!important;"),e.appendChild(o),r.push(o)}return r}function Dhe(e,t,r){for(var n=r?"invTrans":"trans",i=t[n],a=t.srcCoords,o=[],s=[],l=!0,u=0;u<4;u++){var f=e[u].getBoundingClientRect(),c=2*u,h=f.left,d=f.top;o.push(h,d),l=l&&a&&h===a[c]&&d===a[c+1],s.push(e[u].offsetLeft,e[u].offsetTop)}return l&&i?i:(t.srcCoords=o,t[n]=r?v4(s,o):v4(o,s))}function oZ(e){return e.nodeName.toUpperCase()==="CANVAS"}var $he=/([&<>"'])/g,Nhe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function wa(e){return e==null?"":(e+"").replace($he,function(t,r){return Nhe[r]})}var Lhe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,GE=[],Fhe=Bt.browser.firefox&&+Bt.browser.version.split(".")[0]<39;function iI(e,t,r,n){return r=r||{},n?g4(e,t,r):Fhe&&t.layerX!=null&&t.layerX!==t.offsetX?(r.zrX=t.layerX,r.zrY=t.layerY):t.offsetX!=null?(r.zrX=t.offsetX,r.zrY=t.offsetY):g4(e,t,r),r}function g4(e,t,r){if(Bt.domSupported&&e.getBoundingClientRect){var n=t.clientX,i=t.clientY;if(oZ(e)){var a=e.getBoundingClientRect();r.zrX=n-a.left,r.zrY=i-a.top;return}else if(nI(GE,e,n,i)){r.zrX=GE[0],r.zrY=GE[1];return}}r.zrX=r.zrY=0}function RN(e){return e||window.event}function pa(e,t,r){if(t=RN(t),t.zrX!=null)return t;var n=t.type,i=n&&n.indexOf("touch")>=0;if(i){var o=n!=="touchend"?t.targetTouches[0]:t.changedTouches[0];o&&iI(e,o,t,r)}else{iI(e,t,t,r);var a=Hhe(t);t.zrDelta=a?a/120:-(t.detail||0)/3}var s=t.button;return t.which==null&&s!==void 0&&Lhe.test(t.type)&&(t.which=s&1?1:s&2?3:s&4?2:0),t}function Hhe(e){var t=e.wheelDelta;if(t)return t;var r=e.deltaX,n=e.deltaY;if(r==null||n==null)return t;var i=Math.abs(n!==0?n:r),a=n>0?-1:n<0?1:r>0?-1:1;return 3*i*a}function Bhe(e,t,r,n){e.addEventListener(t,r,n)}function Vhe(e,t,r,n){e.removeEventListener(t,r,n)}var sZ=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0},jhe=function(){function e(){this._track=[]}return e.prototype.recognize=function(t,r,n){return this._doTrack(t,r,n),this._recognize(t)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(t,r,n){var i=t.touches;if(i){for(var a={points:[],touches:[],target:r,event:t},o=0,s=i.length;o<s;o++){var l=i[o],u=iI(n,l,{});a.points.push([u.zrX,u.zrY]),a.touches.push(l)}this._track.push(a)}},e.prototype._recognize=function(t){for(var r in YE)if(YE.hasOwnProperty(r)){var n=YE[r](this._track,t);if(n)return n}},e}();function y4(e){var t=e[1][0]-e[0][0],r=e[1][1]-e[0][1];return Math.sqrt(t*t+r*r)}function Whe(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}var YE={pinch:function(e,t){var r=e.length;if(r){var n=(e[r-1]||{}).points,i=(e[r-2]||{}).points||n;if(i&&i.length>1&&n&&n.length>1){var a=y4(n)/y4(i);!isFinite(a)&&(a=1),t.pinchScale=a;var o=Whe(n);return t.pinchX=o[0],t.pinchY=o[1],{type:"pinch",target:e[0].target,event:t}}}}};function Xm(){return[1,0,0,1,0,0]}function kN(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Uhe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Dd(e,t,r){var n=t[0]*r[0]+t[2]*r[1],i=t[1]*r[0]+t[3]*r[1],a=t[0]*r[2]+t[2]*r[3],o=t[1]*r[2]+t[3]*r[3],s=t[0]*r[4]+t[2]*r[5]+t[4],l=t[1]*r[4]+t[3]*r[5]+t[5];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e}function aI(e,t,r){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+r[0],e[5]=t[5]+r[1],e}function AN(e,t,r){var n=t[0],i=t[2],a=t[4],o=t[1],s=t[3],l=t[5],u=Math.sin(r),f=Math.cos(r);return e[0]=n*f+o*u,e[1]=-n*u+o*f,e[2]=i*f+s*u,e[3]=-i*u+f*s,e[4]=f*a+u*l,e[5]=f*l-u*a,e}function zhe(e,t,r){var n=r[0],i=r[1];return e[0]=t[0]*n,e[1]=t[1]*i,e[2]=t[2]*n,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*i,e}function PN(e,t){var r=t[0],n=t[2],i=t[4],a=t[1],o=t[3],s=t[5],l=r*o-a*n;return l?(l=1/l,e[0]=o*l,e[1]=-a*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*s-o*i)*l,e[5]=(a*i-r*s)*l,e):null}var Ghe=function(){function e(t,r){this.x=t||0,this.y=r||0}return e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(t,r){return this.x=t,this.y=r,this},e.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.scaleAndAdd=function(t,r){this.x+=t.x*r,this.y+=t.y*r},e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},e.prototype.distance=function(t){var r=this.x-t.x,n=this.y-t.y;return Math.sqrt(r*r+n*n)},e.prototype.distanceSquare=function(t){var r=this.x-t.x,n=this.y-t.y;return r*r+n*n},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(t){if(t){var r=this.x,n=this.y;return this.x=t[0]*r+t[2]*n+t[4],this.y=t[1]*r+t[3]*n+t[5],this}},e.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},e.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},e.set=function(t,r,n){t.x=r,t.y=n},e.copy=function(t,r){t.x=r.x,t.y=r.y},e.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.lenSquare=function(t){return t.x*t.x+t.y*t.y},e.dot=function(t,r){return t.x*r.x+t.y*r.y},e.add=function(t,r,n){t.x=r.x+n.x,t.y=r.y+n.y},e.sub=function(t,r,n){t.x=r.x-n.x,t.y=r.y-n.y},e.scale=function(t,r,n){t.x=r.x*n,t.y=r.y*n},e.scaleAndAdd=function(t,r,n,i){t.x=r.x+n.x*i,t.y=r.y+n.y*i},e.lerp=function(t,r,n,i){var a=1-i;t.x=a*r.x+i*n.x,t.y=a*r.y+i*n.y},e}();const St=Ghe;var M_=Math.min,D_=Math.max,Xu=new St,qu=new St,Zu=new St,Ju=new St,Wg=new St,Ug=new St,Yhe=function(){function e(t,r,n,i){n<0&&(t=t+n,n=-n),i<0&&(r=r+i,i=-i),this.x=t,this.y=r,this.width=n,this.height=i}return e.prototype.union=function(t){var r=M_(t.x,this.x),n=M_(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=D_(t.x+t.width,this.x+this.width)-r:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=D_(t.y+t.height,this.y+this.height)-n:this.height=t.height,this.x=r,this.y=n},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(t){var r=this,n=t.width/r.width,i=t.height/r.height,a=Xm();return aI(a,a,[-r.x,-r.y]),zhe(a,a,[n,i]),aI(a,a,[t.x,t.y]),a},e.prototype.intersect=function(t,r){if(!t)return!1;t instanceof e||(t=e.create(t));var n=this,i=n.x,a=n.x+n.width,o=n.y,s=n.y+n.height,l=t.x,u=t.x+t.width,f=t.y,c=t.y+t.height,h=!(a<l||u<i||s<f||c<o);if(r){var d=1/0,v=0,p=Math.abs(a-l),g=Math.abs(u-i),y=Math.abs(s-f),m=Math.abs(c-o),b=Math.min(p,g),_=Math.min(y,m);a<l||u<i?b>v&&(v=b,p<g?St.set(Ug,-p,0):St.set(Ug,g,0)):b<d&&(d=b,p<g?St.set(Wg,p,0):St.set(Wg,-g,0)),s<f||c<o?_>v&&(v=_,y<m?St.set(Ug,0,-y):St.set(Ug,0,m)):b<d&&(d=b,y<m?St.set(Wg,0,y):St.set(Wg,0,-m))}return r&&St.copy(r,h?Wg:Ug),h},e.prototype.contain=function(t,r){var n=this;return t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return this.width===0||this.height===0},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(t,r){t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height},e.applyTransform=function(t,r,n){if(!n){t!==r&&e.copy(t,r);return}if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var i=n[0],a=n[3],o=n[4],s=n[5];t.x=r.x*i+o,t.y=r.y*a+s,t.width=r.width*i,t.height=r.height*a,t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height);return}Xu.x=Zu.x=r.x,Xu.y=Ju.y=r.y,qu.x=Ju.x=r.x+r.width,qu.y=Zu.y=r.y+r.height,Xu.transform(n),Ju.transform(n),qu.transform(n),Zu.transform(n),t.x=M_(Xu.x,qu.x,Zu.x,Ju.x),t.y=M_(Xu.y,qu.y,Zu.y,Ju.y);var l=D_(Xu.x,qu.x,Zu.x,Ju.x),u=D_(Xu.y,qu.y,Zu.y,Ju.y);t.width=l-t.x,t.height=u-t.y},e}();const or=Yhe;var lZ="silent";function Khe(e,t,r){return{type:e,event:r,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:Xhe}}function Xhe(){sZ(this.event)}var qhe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.handler=null,r}return t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(ts),zg=function(){function e(t,r){this.x=t,this.y=r}return e}(),Zhe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],KE=new or(0,0,0,0),uZ=function(e){Ye(t,e);function t(r,n,i,a,o){var s=e.call(this)||this;return s._hovered=new zg(0,0),s.storage=r,s.painter=n,s.painterRoot=a,s._pointerSize=o,i=i||new qhe,s.proxy=null,s.setHandlerProxy(i),s._draggingMgr=new khe(s),s}return t.prototype.setHandlerProxy=function(r){this.proxy&&this.proxy.dispose(),r&&(le(Zhe,function(n){r.on&&r.on(n,this[n],this)},this),r.handler=this),this.proxy=r},t.prototype.mousemove=function(r){var n=r.zrX,i=r.zrY,a=fZ(this,n,i),o=this._hovered,s=o.target;s&&!s.__zr&&(o=this.findHover(o.x,o.y),s=o.target);var l=this._hovered=a?new zg(n,i):this.findHover(n,i),u=l.target,f=this.proxy;f.setCursor&&f.setCursor(u?u.cursor:"default"),s&&u!==s&&this.dispatchToElement(o,"mouseout",r),this.dispatchToElement(l,"mousemove",r),u&&u!==s&&this.dispatchToElement(l,"mouseover",r)},t.prototype.mouseout=function(r){var n=r.zrEventControl;n!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",r),n!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:r})},t.prototype.resize=function(){this._hovered=new zg(0,0)},t.prototype.dispatch=function(r,n){var i=this[r];i&&i.call(this,n)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(r){var n=this.proxy;n.setCursor&&n.setCursor(r)},t.prototype.dispatchToElement=function(r,n,i){r=r||{};var a=r.target;if(!(a&&a.silent)){for(var o="on"+n,s=Khe(n,r,i);a&&(a[o]&&(s.cancelBubble=!!a[o].call(a,s)),a.trigger(n,s),a=a.__hostTarget?a.__hostTarget:a.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(n,s),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[o]=="function"&&l[o].call(l,s),l.trigger&&l.trigger(n,s)}))}},t.prototype.findHover=function(r,n,i){var a=this.storage.getDisplayList(),o=new zg(r,n);if(m4(a,o,r,n,i),this._pointerSize&&!o.target){for(var s=[],l=this._pointerSize,u=l/2,f=new or(r-u,n-u,l,l),c=a.length-1;c>=0;c--){var h=a[c];h!==i&&!h.ignore&&!h.ignoreCoarsePointer&&(!h.parent||!h.parent.ignoreCoarsePointer)&&(KE.copy(h.getBoundingRect()),h.transform&&KE.applyTransform(h.transform),KE.intersect(f)&&s.push(h))}if(s.length)for(var d=4,v=Math.PI/12,p=Math.PI*2,g=0;g<u;g+=d)for(var y=0;y<p;y+=v){var m=r+g*Math.cos(y),b=n+g*Math.sin(y);if(m4(s,o,m,b,i),o.target)return o}}return o},t.prototype.processGesture=function(r,n){this._gestureMgr||(this._gestureMgr=new jhe);var i=this._gestureMgr;n==="start"&&i.clear();var a=i.recognize(r,this.findHover(r.zrX,r.zrY,null).target,this.proxy.dom);if(n==="end"&&i.clear(),a){var o=a.type;r.gestureEvent=o;var s=new zg;s.target=a.target,this.dispatchToElement(s,o,a.event)}},t}(ts);le(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){uZ.prototype[e]=function(t){var r=t.zrX,n=t.zrY,i=fZ(this,r,n),a,o;if((e!=="mouseup"||!i)&&(a=this.findHover(r,n),o=a.target),e==="mousedown")this._downEl=o,this._downPoint=[t.zrX,t.zrY],this._upEl=o;else if(e==="mouseup")this._upEl=o;else if(e==="click"){if(this._downEl!==this._upEl||!this._downPoint||tI(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,e,t)}});function Jhe(e,t,r){if(e[e.rectHover?"rectContain":"contain"](t,r)){for(var n=e,i=void 0,a=!1;n;){if(n.ignoreClip&&(a=!0),!a){var o=n.getClipPath();if(o&&!o.contain(t,r))return!1;n.silent&&(i=!0)}var s=n.__hostTarget;n=s||n.parent}return i?lZ:!0}return!1}function m4(e,t,r,n,i){for(var a=e.length-1;a>=0;a--){var o=e[a],s=void 0;if(o!==i&&!o.ignore&&(s=Jhe(o,r,n))&&(!t.topTarget&&(t.topTarget=o),s!==lZ)){t.target=o;break}}}function fZ(e,t,r){var n=e.painter;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}const Qhe=uZ;var cZ=32,Gg=7;function ede(e){for(var t=0;e>=cZ;)t|=e&1,e>>=1;return e+t}function b4(e,t,r,n){var i=t+1;if(i===r)return 1;if(n(e[i++],e[t])<0){for(;i<r&&n(e[i],e[i-1])<0;)i++;tde(e,t,i)}else for(;i<r&&n(e[i],e[i-1])>=0;)i++;return i-t}function tde(e,t,r){for(r--;t<r;){var n=e[t];e[t++]=e[r],e[r--]=n}}function w4(e,t,r,n,i){for(n===t&&n++;n<r;n++){for(var a=e[n],o=t,s=n,l;o<s;)l=o+s>>>1,i(a,e[l])<0?s=l:o=l+1;var u=n-o;switch(u){case 3:e[o+3]=e[o+2];case 2:e[o+2]=e[o+1];case 1:e[o+1]=e[o];break;default:for(;u>0;)e[o+u]=e[o+u-1],u--}e[o]=a}}function XE(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])>0){for(s=n-i;l<s&&a(e,t[r+i+l])>0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}else{for(s=i+1;l<s&&a(e,t[r+i-l])<=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])>0?o=f+1:l=f}return l}function qE(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])<0){for(s=i+1;l<s&&a(e,t[r+i-l])<0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}else{for(s=n-i;l<s&&a(e,t[r+i+l])>=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])<0?l=f:o=f+1}return l}function rde(e,t){var r=Gg,n,i,a=0;e.length;var o=[];n=[],i=[];function s(d,v){n[a]=d,i[a]=v,a+=1}function l(){for(;a>1;){var d=a-2;if(d>=1&&i[d-1]<=i[d]+i[d+1]||d>=2&&i[d-2]<=i[d]+i[d-1])i[d-1]<i[d+1]&&d--;else if(i[d]>i[d+1])break;f(d)}}function u(){for(;a>1;){var d=a-2;d>0&&i[d-1]<i[d+1]&&d--,f(d)}}function f(d){var v=n[d],p=i[d],g=n[d+1],y=i[d+1];i[d]=p+y,d===a-3&&(n[d+1]=n[d+2],i[d+1]=i[d+2]),a--;var m=qE(e[g],e,v,p,0,t);v+=m,p-=m,p!==0&&(y=XE(e[v+p-1],e,g,y,y-1,t),y!==0&&(p<=y?c(v,p,g,y):h(v,p,g,y)))}function c(d,v,p,g){var y=0;for(y=0;y<v;y++)o[y]=e[d+y];var m=0,b=p,_=d;if(e[_++]=e[b++],--g===0){for(y=0;y<v;y++)e[_+y]=o[m+y];return}if(v===1){for(y=0;y<g;y++)e[_+y]=e[b+y];e[_+g]=o[m];return}for(var x=r,T,E,P;;){T=0,E=0,P=!1;do if(t(e[b],o[m])<0){if(e[_++]=e[b++],E++,T=0,--g===0){P=!0;break}}else if(e[_++]=o[m++],T++,E=0,--v===1){P=!0;break}while((T|E)<x);if(P)break;do{if(T=qE(e[b],o,m,v,0,t),T!==0){for(y=0;y<T;y++)e[_+y]=o[m+y];if(_+=T,m+=T,v-=T,v<=1){P=!0;break}}if(e[_++]=e[b++],--g===0){P=!0;break}if(E=XE(o[m],e,b,g,0,t),E!==0){for(y=0;y<E;y++)e[_+y]=e[b+y];if(_+=E,b+=E,g-=E,g===0){P=!0;break}}if(e[_++]=o[m++],--v===1){P=!0;break}x--}while(T>=Gg||E>=Gg);if(P)break;x<0&&(x=0),x+=2}if(r=x,r<1&&(r=1),v===1){for(y=0;y<g;y++)e[_+y]=e[b+y];e[_+g]=o[m]}else{if(v===0)throw new Error;for(y=0;y<v;y++)e[_+y]=o[m+y]}}function h(d,v,p,g){var y=0;for(y=0;y<g;y++)o[y]=e[p+y];var m=d+v-1,b=g-1,_=p+g-1,x=0,T=0;if(e[_--]=e[m--],--v===0){for(x=_-(g-1),y=0;y<g;y++)e[x+y]=o[y];return}if(g===1){for(_-=v,m-=v,T=_+1,x=m+1,y=v-1;y>=0;y--)e[T+y]=e[x+y];e[_]=o[b];return}for(var E=r;;){var P=0,R=0,M=!1;do if(t(o[b],e[m])<0){if(e[_--]=e[m--],P++,R=0,--v===0){M=!0;break}}else if(e[_--]=o[b--],R++,P=0,--g===1){M=!0;break}while((P|R)<E);if(M)break;do{if(P=v-qE(o[b],e,d,v,v-1,t),P!==0){for(_-=P,m-=P,v-=P,T=_+1,x=m+1,y=P-1;y>=0;y--)e[T+y]=e[x+y];if(v===0){M=!0;break}}if(e[_--]=o[b--],--g===1){M=!0;break}if(R=g-XE(e[m],o,0,g,g-1,t),R!==0){for(_-=R,b-=R,g-=R,T=_+1,x=b+1,y=0;y<R;y++)e[T+y]=o[x+y];if(g<=1){M=!0;break}}if(e[_--]=e[m--],--v===0){M=!0;break}E--}while(P>=Gg||R>=Gg);if(M)break;E<0&&(E=0),E+=2}if(r=E,r<1&&(r=1),g===1){for(_-=v,m-=v,T=_+1,x=m+1,y=v-1;y>=0;y--)e[T+y]=e[x+y];e[_]=o[b]}else{if(g===0)throw new Error;for(x=_-(g-1),y=0;y<g;y++)e[x+y]=o[y]}}return{mergeRuns:l,forceMergeRuns:u,pushRun:s}}function N1(e,t,r,n){r||(r=0),n||(n=e.length);var i=n-r;if(!(i<2)){var a=0;if(i<cZ){a=b4(e,r,n,t),w4(e,r,n,r+a,t);return}var o=rde(e,t),s=ede(i);do{if(a=b4(e,r,n,t),a<s){var l=i;l>s&&(l=s),w4(e,r,r+l,r+a,t),a=l}o.pushRun(r,a),o.mergeRuns(),i-=a,r+=a}while(i!==0);o.forceMergeRuns()}}var qi=1,jy=2,hd=4,_4=!1;function ZE(){_4||(_4=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function S4(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var nde=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=S4}return e.prototype.traverse=function(t,r){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,r)},e.prototype.getDisplayList=function(t,r){r=r||!1;var n=this._displayList;return(t||!n.length)&&this.updateDisplayList(r),n},e.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var r=this._roots,n=this._displayList,i=0,a=r.length;i<a;i++)this._updateAndAddDisplayable(r[i],null,t);n.length=this._displayListLen,N1(n,S4)},e.prototype._updateAndAddDisplayable=function(t,r,n){if(!(t.ignore&&!n)){t.beforeUpdate(),t.update(),t.afterUpdate();var i=t.getClipPath();if(t.ignoreClip)r=null;else if(i){r?r=r.slice():r=[];for(var a=i,o=t;a;)a.parent=o,a.updateTransform(),r.push(a),o=a,a=a.getClipPath()}if(t.childrenRef){for(var s=t.childrenRef(),l=0;l<s.length;l++){var u=s[l];t.__dirty&&(u.__dirty|=qi),this._updateAndAddDisplayable(u,r,n)}t.__dirty=0}else{var f=t;r&&r.length?f.__clipPaths=r:f.__clipPaths&&f.__clipPaths.length>0&&(f.__clipPaths=[]),isNaN(f.z)&&(ZE(),f.z=0),isNaN(f.z2)&&(ZE(),f.z2=0),isNaN(f.zlevel)&&(ZE(),f.zlevel=0),this._displayList[this._displayListLen++]=f}var c=t.getDecalElement&&t.getDecalElement();c&&this._updateAndAddDisplayable(c,r,n);var h=t.getTextGuideLine();h&&this._updateAndAddDisplayable(h,r,n);var d=t.getTextContent();d&&this._updateAndAddDisplayable(d,r,n)}},e.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},e.prototype.delRoot=function(t){if(t instanceof Array){for(var r=0,n=t.length;r<n;r++)this.delRoot(t[r]);return}var i=yr(this._roots,t);i>=0&&this._roots.splice(i,1)},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}();const ide=nde;var hZ;hZ=Bt.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};const oI=hZ;var L1={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return .5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},exponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)))},elasticOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},elasticInOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)):r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-L1.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?L1.bounceIn(e*2)*.5:L1.bounceOut(e*2-1)*.5+.5}};const dZ=L1;var $_=Math.pow,uu=Math.sqrt,UC=1e-8,vZ=1e-4,C4=uu(3),N_=1/3,Bo=_g(),_a=_g(),$d=_g();function eu(e){return e>-UC&&e<UC}function pZ(e){return e>UC||e<-UC}function mn(e,t,r,n,i){var a=1-i;return a*a*(a*e+3*i*t)+i*i*(i*n+3*a*r)}function x4(e,t,r,n,i){var a=1-i;return 3*(((t-e)*a+2*(r-t)*i)*a+(n-r)*i*i)}function zC(e,t,r,n,i,a){var o=n+3*(t-r)-e,s=3*(r-t*2+e),l=3*(t-e),u=e-i,f=s*s-3*o*l,c=s*l-9*o*u,h=l*l-3*s*u,d=0;if(eu(f)&&eu(c))if(eu(s))a[0]=0;else{var v=-l/s;v>=0&&v<=1&&(a[d++]=v)}else{var p=c*c-4*f*h;if(eu(p)){var g=c/f,v=-s/o+g,y=-g/2;v>=0&&v<=1&&(a[d++]=v),y>=0&&y<=1&&(a[d++]=y)}else if(p>0){var m=uu(p),b=f*s+1.5*o*(-c+m),_=f*s+1.5*o*(-c-m);b<0?b=-$_(-b,N_):b=$_(b,N_),_<0?_=-$_(-_,N_):_=$_(_,N_);var v=(-s-(b+_))/(3*o);v>=0&&v<=1&&(a[d++]=v)}else{var x=(2*f*s-3*o*c)/(2*uu(f*f*f)),T=Math.acos(x)/3,E=uu(f),P=Math.cos(T),v=(-s-2*E*P)/(3*o),y=(-s+E*(P+C4*Math.sin(T)))/(3*o),R=(-s+E*(P-C4*Math.sin(T)))/(3*o);v>=0&&v<=1&&(a[d++]=v),y>=0&&y<=1&&(a[d++]=y),R>=0&&R<=1&&(a[d++]=R)}}return d}function gZ(e,t,r,n,i){var a=6*r-12*t+6*e,o=9*t+3*n-3*e-9*r,s=3*t-3*e,l=0;if(eu(o)){if(pZ(a)){var u=-s/a;u>=0&&u<=1&&(i[l++]=u)}}else{var f=a*a-4*o*s;if(eu(f))i[0]=-a/(2*o);else if(f>0){var c=uu(f),u=(-a+c)/(2*o),h=(-a-c)/(2*o);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function GC(e,t,r,n,i,a){var o=(t-e)*i+e,s=(r-t)*i+t,l=(n-r)*i+r,u=(s-o)*i+o,f=(l-s)*i+s,c=(f-u)*i+u;a[0]=e,a[1]=o,a[2]=u,a[3]=c,a[4]=c,a[5]=f,a[6]=l,a[7]=n}function ade(e,t,r,n,i,a,o,s,l,u,f){var c,h=.005,d=1/0,v,p,g,y;Bo[0]=l,Bo[1]=u;for(var m=0;m<1;m+=.05)_a[0]=mn(e,r,i,o,m),_a[1]=mn(t,n,a,s,m),g=Md(Bo,_a),g<d&&(c=m,d=g);d=1/0;for(var b=0;b<32&&!(h<vZ);b++)v=c-h,p=c+h,_a[0]=mn(e,r,i,o,v),_a[1]=mn(t,n,a,s,v),g=Md(_a,Bo),v>=0&&g<d?(c=v,d=g):($d[0]=mn(e,r,i,o,p),$d[1]=mn(t,n,a,s,p),y=Md($d,Bo),p<=1&&y<d?(c=p,d=y):h*=.5);return f&&(f[0]=mn(e,r,i,o,c),f[1]=mn(t,n,a,s,c)),uu(d)}function ode(e,t,r,n,i,a,o,s,l){for(var u=e,f=t,c=0,h=1/l,d=1;d<=l;d++){var v=d*h,p=mn(e,r,i,o,v),g=mn(t,n,a,s,v),y=p-u,m=g-f;c+=Math.sqrt(y*y+m*m),u=p,f=g}return c}function Hn(e,t,r,n){var i=1-n;return i*(i*e+2*n*t)+n*n*r}function T4(e,t,r,n){return 2*((1-n)*(t-e)+n*(r-t))}function sde(e,t,r,n,i){var a=e-2*t+r,o=2*(t-e),s=e-n,l=0;if(eu(a)){if(pZ(o)){var u=-s/o;u>=0&&u<=1&&(i[l++]=u)}}else{var f=o*o-4*a*s;if(eu(f)){var u=-o/(2*a);u>=0&&u<=1&&(i[l++]=u)}else if(f>0){var c=uu(f),u=(-o+c)/(2*a),h=(-o-c)/(2*a);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function yZ(e,t,r){var n=e+r-2*t;return n===0?.5:(e-t)/n}function YC(e,t,r,n,i){var a=(t-e)*n+e,o=(r-t)*n+t,s=(o-a)*n+a;i[0]=e,i[1]=a,i[2]=s,i[3]=s,i[4]=o,i[5]=r}function lde(e,t,r,n,i,a,o,s,l){var u,f=.005,c=1/0;Bo[0]=o,Bo[1]=s;for(var h=0;h<1;h+=.05){_a[0]=Hn(e,r,i,h),_a[1]=Hn(t,n,a,h);var d=Md(Bo,_a);d<c&&(u=h,c=d)}c=1/0;for(var v=0;v<32&&!(f<vZ);v++){var p=u-f,g=u+f;_a[0]=Hn(e,r,i,p),_a[1]=Hn(t,n,a,p);var d=Md(_a,Bo);if(p>=0&&d<c)u=p,c=d;else{$d[0]=Hn(e,r,i,g),$d[1]=Hn(t,n,a,g);var y=Md($d,Bo);g<=1&&y<c?(u=g,c=y):f*=.5}}return l&&(l[0]=Hn(e,r,i,u),l[1]=Hn(t,n,a,u)),uu(c)}function ude(e,t,r,n,i,a,o){for(var s=e,l=t,u=0,f=1/o,c=1;c<=o;c++){var h=c*f,d=Hn(e,r,i,h),v=Hn(t,n,a,h),p=d-s,g=v-l;u+=Math.sqrt(p*p+g*g),s=d,l=v}return u}var fde=/cubic-bezier\(([0-9,\.e ]+)\)/;function mZ(e){var t=e&&fde.exec(e);if(t){var r=t[1].split(","),n=+Uo(r[0]),i=+Uo(r[1]),a=+Uo(r[2]),o=+Uo(r[3]);if(isNaN(n+i+a+o))return;var s=[];return function(l){return l<=0?0:l>=1?1:zC(0,n,a,1,l,s)&&mn(0,i,o,1,s[0])}}}var cde=function(){function e(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||Di,this.ondestroy=t.ondestroy||Di,this.onrestart=t.onrestart||Di,t.easing&&this.setEasing(t.easing)}return e.prototype.step=function(t,r){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=r;return}var n=this._life,i=t-this._startTime-this._pausedTime,a=i/n;a<0&&(a=0),a=Math.min(a,1);var o=this.easingFunc,s=o?o(a):a;if(this.onframe(s),a===1)if(this.loop){var l=i%n;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(t){this.easing=t,this.easingFunc=Nt(t)?t:dZ[t]||mZ(t)},e}();const hde=cde;var bZ=function(){function e(t){this.value=t}return e}(),dde=function(){function e(){this._len=0}return e.prototype.insert=function(t){var r=new bZ(t);return this.insertEntry(r),r},e.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},e.prototype.remove=function(t){var r=t.prev,n=t.next;r?r.next=n:this.head=n,n?n.prev=r:this.tail=r,t.next=t.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),vde=function(){function e(t){this._list=new dde,this._maxSize=10,this._map={},this._maxSize=t}return e.prototype.put=function(t,r){var n=this._list,i=this._map,a=null;if(i[t]==null){var o=n.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var l=n.head;n.remove(l),delete i[l.key],a=l.value,this._lastRemovedEntry=l}s?s.value=r:s=new bZ(r),s.key=t,n.insertEntry(s),i[t]=s}return a},e.prototype.get=function(t){var r=this._map[t],n=this._list;if(r!=null)return r!==n.tail&&(n.remove(r),n.insertEntry(r)),r.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}();const Tw=vde;var O4={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function fu(e){return e=Math.round(e),e<0?0:e>255?255:e}function sI(e){return e<0?0:e>1?1:e}function JE(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?fu(parseFloat(t)/100*255):fu(parseInt(t,10))}function um(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?sI(parseFloat(t)/100):sI(parseFloat(t))}function QE(e,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?e+(t-e)*r*6:r*2<1?t:r*3<2?e+(t-e)*(2/3-r)*6:e}function L_(e,t,r){return e+(t-e)*r}function da(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function lI(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var wZ=new Tw(20),F_=null;function Sh(e,t){F_&&lI(F_,t),F_=wZ.put(e,F_||t.slice())}function il(e,t){if(e){t=t||[];var r=wZ.get(e);if(r)return lI(t,r);e=e+"";var n=e.replace(/ /g,"").toLowerCase();if(n in O4)return lI(t,O4[n]),Sh(e,t),t;var i=n.length;if(n.charAt(0)==="#"){if(i===4||i===5){var a=parseInt(n.slice(1,4),16);if(!(a>=0&&a<=4095)){da(t,0,0,0,1);return}return da(t,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,i===5?parseInt(n.slice(4),16)/15:1),Sh(e,t),t}else if(i===7||i===9){var a=parseInt(n.slice(1,7),16);if(!(a>=0&&a<=16777215)){da(t,0,0,0,1);return}return da(t,(a&16711680)>>16,(a&65280)>>8,a&255,i===9?parseInt(n.slice(7),16)/255:1),Sh(e,t),t}return}var o=n.indexOf("("),s=n.indexOf(")");if(o!==-1&&s+1===i){var l=n.substr(0,o),u=n.substr(o+1,s-(o+1)).split(","),f=1;switch(l){case"rgba":if(u.length!==4)return u.length===3?da(t,+u[0],+u[1],+u[2],1):da(t,0,0,0,1);f=um(u.pop());case"rgb":if(u.length>=3)return da(t,JE(u[0]),JE(u[1]),JE(u[2]),u.length===3?f:um(u[3])),Sh(e,t),t;da(t,0,0,0,1);return;case"hsla":if(u.length!==4){da(t,0,0,0,1);return}return u[3]=um(u[3]),E4(u,t),Sh(e,t),t;case"hsl":if(u.length!==3){da(t,0,0,0,1);return}return E4(u,t),Sh(e,t),t;default:return}}da(t,0,0,0,1)}}function E4(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=um(e[1]),i=um(e[2]),a=i<=.5?i*(n+1):i+n-i*n,o=i*2-a;return t=t||[],da(t,fu(QE(o,a,r+1/3)*255),fu(QE(o,a,r)*255),fu(QE(o,a,r-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function R4(e,t){var r=il(e);if(r){for(var n=0;n<3;n++)t<0?r[n]=r[n]*(1-t)|0:r[n]=(255-r[n])*t+r[n]|0,r[n]>255?r[n]=255:r[n]<0&&(r[n]=0);return ZT(r,r.length===4?"rgba":"rgb")}}function pde(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=il(t[i]),s=il(t[a]),l=n-i,u=ZT([fu(L_(o[0],s[0],l)),fu(L_(o[1],s[1],l)),fu(L_(o[2],s[2],l)),sI(L_(o[3],s[3],l))],"rgba");return r?{color:u,leftIndex:i,rightIndex:a,value:n}:u}}function ZT(e,t){if(!(!e||!e.length)){var r=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+e[3]),t+"("+r+")"}}function KC(e,t){var r=il(e);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*t:0}function gde(e){return e.type==="linear"}function yde(e){return e.type==="radial"}(function(){return Bt.hasGlobalWindow&&Nt(window.btoa)?function(e){return window.btoa(unescape(encodeURIComponent(e)))}:typeof Buffer<"u"?function(e){return Buffer.from(e).toString("base64")}:function(e){return null}})();var uI=Array.prototype.slice;function bs(e,t,r){return(t-e)*r+e}function eR(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=bs(t[a],r[a],n);return e}function mde(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=bs(t[o][s],r[o][s],n)}return e}function H_(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=t[a]+r[a]*n;return e}function k4(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=t[o][s]+r[o][s]*n}return e}function bde(e,t){for(var r=e.length,n=t.length,i=r>n?t:e,a=Math.min(r,n),o=i[a-1]||{color:[0,0,0,0],offset:0},s=a;s<Math.max(r,n);s++)i.push({offset:o.offset,color:o.color.slice()})}function wde(e,t,r){var n=e,i=t;if(!(!n.push||!i.push)){var a=n.length,o=i.length;if(a!==o){var s=a>o;if(s)n.length=o;else for(var l=a;l<o;l++)n.push(r===1?i[l]:uI.call(i[l]))}for(var u=n[0]&&n[0].length,l=0;l<n.length;l++)if(r===1)isNaN(n[l])&&(n[l]=i[l]);else for(var f=0;f<u;f++)isNaN(n[l][f])&&(n[l][f]=i[l][f])}}function F1(e){if(Ni(e)){var t=e.length;if(Ni(e[0])){for(var r=[],n=0;n<t;n++)r.push(uI.call(e[n]));return r}return uI.call(e)}return e}function H1(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=e[3]==null?1:e[3],"rgba("+e.join(",")+")"}function _de(e){return Ni(e&&e[0])?2:1}var B_=0,B1=1,_Z=2,Wy=3,fI=4,cI=5,A4=6;function P4(e){return e===fI||e===cI}function V_(e){return e===B1||e===_Z}var Yg=[0,0,0,0],Sde=function(){function e(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(t,r,n){this._needsSort=!0;var i=this.keyframes,a=i.length,o=!1,s=A4,l=r;if(Ni(r)){var u=_de(r);s=u,(u===1&&!_r(r[0])||u===2&&!_r(r[0][0]))&&(o=!0)}else if(_r(r)&&!WC(r))s=B_;else if(st(r))if(!isNaN(+r))s=B_;else{var f=il(r);f&&(l=f,s=Wy)}else if(XT(r)){var c=Le({},l);c.colorStops=pt(r.colorStops,function(d){return{offset:d.offset,color:il(d.color)}}),gde(r)?s=fI:yde(r)&&(s=cI),l=c}a===0?this.valType=s:(s!==this.valType||s===A4)&&(o=!0),this.discrete=this.discrete||o;var h={time:t,value:l,rawValue:r,percent:0};return n&&(h.easing=n,h.easingFunc=Nt(n)?n:dZ[n]||mZ(n)),i.push(h),h},e.prototype.prepare=function(t,r){var n=this.keyframes;this._needsSort&&n.sort(function(p,g){return p.time-g.time});for(var i=this.valType,a=n.length,o=n[a-1],s=this.discrete,l=V_(i),u=P4(i),f=0;f<a;f++){var c=n[f],h=c.value,d=o.value;c.percent=c.time/t,s||(l&&f!==a-1?wde(h,d,i):u&&bde(h.colorStops,d.colorStops))}if(!s&&i!==cI&&r&&this.needsAnimate()&&r.needsAnimate()&&i===r.valType&&!r._finished){this._additiveTrack=r;for(var v=n[0].value,f=0;f<a;f++)i===B_?n[f].additiveValue=n[f].value-v:i===Wy?n[f].additiveValue=H_([],n[f].value,v,-1):V_(i)&&(n[f].additiveValue=i===B1?H_([],n[f].value,v,-1):k4([],n[f].value,v,-1))}},e.prototype.step=function(t,r){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var n=this._additiveTrack!=null,i=n?"additiveValue":"value",a=this.valType,o=this.keyframes,s=o.length,l=this.propName,u=a===Wy,f,c=this._lastFr,h=Math.min,d,v;if(s===1)d=v=o[0];else{if(r<0)f=0;else if(r<this._lastFrP){var p=h(c+1,s-1);for(f=p;f>=0&&!(o[f].percent<=r);f--);f=h(f,s-2)}else{for(f=c;f<s&&!(o[f].percent>r);f++);f=h(f-1,s-2)}v=o[f+1],d=o[f]}if(d&&v){this._lastFr=f,this._lastFrP=r;var g=v.percent-d.percent,y=g===0?1:h((r-d.percent)/g,1);v.easingFunc&&(y=v.easingFunc(y));var m=n?this._additiveValue:u?Yg:t[l];if((V_(a)||u)&&!m&&(m=this._additiveValue=[]),this.discrete)t[l]=y<1?d.rawValue:v.rawValue;else if(V_(a))a===B1?eR(m,d[i],v[i],y):mde(m,d[i],v[i],y);else if(P4(a)){var b=d[i],_=v[i],x=a===fI;t[l]={type:x?"linear":"radial",x:bs(b.x,_.x,y),y:bs(b.y,_.y,y),colorStops:pt(b.colorStops,function(E,P){var R=_.colorStops[P];return{offset:bs(E.offset,R.offset,y),color:H1(eR([],E.color,R.color,y))}}),global:_.global},x?(t[l].x2=bs(b.x2,_.x2,y),t[l].y2=bs(b.y2,_.y2,y)):t[l].r=bs(b.r,_.r,y)}else if(u)eR(m,d[i],v[i],y),n||(t[l]=H1(m));else{var T=bs(d[i],v[i],y);n?this._additiveValue=T:t[l]=T}n&&this._addToTarget(t)}}},e.prototype._addToTarget=function(t){var r=this.valType,n=this.propName,i=this._additiveValue;r===B_?t[n]=t[n]+i:r===Wy?(il(t[n],Yg),H_(Yg,Yg,i,1),t[n]=H1(Yg)):r===B1?H_(t[n],t[n],i,1):r===_Z&&k4(t[n],t[n],i,1)},e}(),Cde=function(){function e(t,r,n,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=r,r&&i){ON("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=n}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(t){this._target=t},e.prototype.when=function(t,r,n){return this.whenWithKeys(t,r,Dr(r),n)},e.prototype.whenWithKeys=function(t,r,n,i){for(var a=this._tracks,o=0;o<n.length;o++){var s=n[o],l=a[s];if(!l){l=a[s]=new Sde(s);var u=void 0,f=this._getAdditiveTrack(s);if(f){var c=f.keyframes,h=c[c.length-1];u=h&&h.value,f.valType===Wy&&u&&(u=H1(u))}else u=this._target[s];if(u==null)continue;t>0&&l.addKeyframe(0,F1(u),i),this._trackKeys.push(s)}l.addKeyframe(t,F1(r[s]),i)}return this._maxTime=Math.max(this._maxTime,t),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var r=t.length,n=0;n<r;n++)t[n].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,r=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,r)for(var n=0;n<r.length;n++)r[n].call(this)},e.prototype._setTracksFinished=function(){for(var t=this._tracks,r=this._trackKeys,n=0;n<r.length;n++)t[r[n]].setFinished()},e.prototype._getAdditiveTrack=function(t){var r,n=this._additiveAnimators;if(n)for(var i=0;i<n.length;i++){var a=n[i].getTrack(t);a&&(r=a)}return r},e.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var r=this,n=[],i=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var o=this._trackKeys[a],s=this._tracks[o],l=this._getAdditiveTrack(o),u=s.keyframes,f=u.length;if(s.prepare(i,l),s.needsAnimate())if(!this._allowDiscrete&&s.discrete){var c=u[f-1];c&&(r._target[s.propName]=c.rawValue),s.setFinished()}else n.push(s)}if(n.length||this._force){var h=new hde({life:i,loop:this._loop,delay:this._delay||0,onframe:function(d){r._started=2;var v=r._additiveAnimators;if(v){for(var p=!1,g=0;g<v.length;g++)if(v[g]._clip){p=!0;break}p||(r._additiveAnimators=null)}for(var g=0;g<n.length;g++)n[g].step(r._target,d);var y=r._onframeCbs;if(y)for(var g=0;g<y.length;g++)y[g](r._target,d)},ondestroy:function(){r._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),t&&h.setEasing(t)}else this._doneCallback();return this}},e.prototype.stop=function(t){if(this._clip){var r=this._clip;t&&r.onframe(1),this._abortedCallback()}},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},e.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},e.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(t){return this._tracks[t]},e.prototype.getTracks=function(){var t=this;return pt(this._trackKeys,function(r){return t._tracks[r]})},e.prototype.stopTracks=function(t,r){if(!t.length||!this._clip)return!0;for(var n=this._tracks,i=this._trackKeys,a=0;a<t.length;a++){var o=n[t[a]];o&&!o.isFinished()&&(r?o.step(this._target,1):this._started===1&&o.step(this._target,0),o.setFinished())}for(var s=!0,a=0;a<i.length;a++)if(!n[i[a]].isFinished()){s=!1;break}return s&&this._abortedCallback(),s},e.prototype.saveTo=function(t,r,n){if(t){r=r||this._trackKeys;for(var i=0;i<r.length;i++){var a=r[i],o=this._tracks[a];if(!(!o||o.isFinished())){var s=o.keyframes,l=s[n?0:s.length-1];l&&(t[a]=F1(l.rawValue))}}}},e.prototype.__changeFinalValue=function(t,r){r=r||Dr(t);for(var n=0;n<r.length;n++){var i=r[n],a=this._tracks[i];if(a){var o=a.keyframes;if(o.length>1){var s=o.pop();a.addKeyframe(s.time,t[i]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},e}();const IN=Cde;function Sd(){return new Date().getTime()}var xde=function(e){Ye(t,e);function t(r){var n=e.call(this)||this;return n._running=!1,n._time=0,n._pausedTime=0,n._pauseStart=0,n._paused=!1,r=r||{},n.stage=r.stage||{},n}return t.prototype.addClip=function(r){r.animation&&this.removeClip(r),this._head?(this._tail.next=r,r.prev=this._tail,r.next=null,this._tail=r):this._head=this._tail=r,r.animation=this},t.prototype.addAnimator=function(r){r.animation=this;var n=r.getClip();n&&this.addClip(n)},t.prototype.removeClip=function(r){if(r.animation){var n=r.prev,i=r.next;n?n.next=i:this._head=i,i?i.prev=n:this._tail=n,r.next=r.prev=r.animation=null}},t.prototype.removeAnimator=function(r){var n=r.getClip();n&&this.removeClip(n),r.animation=null},t.prototype.update=function(r){for(var n=Sd()-this._pausedTime,i=n-this._time,a=this._head;a;){var o=a.next,s=a.step(n,i);s&&(a.ondestroy(),this.removeClip(a)),a=o}this._time=n,r||(this.trigger("frame",i),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var r=this;this._running=!0;function n(){r._running&&(oI(n),!r._paused&&r.update())}oI(n)},t.prototype.start=function(){this._running||(this._time=Sd(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=Sd(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=Sd()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var r=this._head;r;){var n=r.next;r.prev=r.next=r.animation=null,r=n}this._head=this._tail=null},t.prototype.isFinished=function(){return this._head==null},t.prototype.animate=function(r,n){n=n||{},this.start();var i=new IN(r,n.loop);return this.addAnimator(i),i},t}(ts);const Tde=xde;var Ode=300,tR=Bt.domSupported,rR=function(){var e=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t=["touchstart","touchend","touchmove"],r={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},n=pt(e,function(i){var a=i.replace("mouse","pointer");return r.hasOwnProperty(a)?a:i});return{mouse:e,touch:t,pointer:n}}(),I4={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},M4=!1;function hI(e){var t=e.pointerType;return t==="pen"||t==="touch"}function Ede(e){e.touching=!0,e.touchTimer!=null&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout(function(){e.touching=!1,e.touchTimer=null},700)}function nR(e){e&&(e.zrByTouch=!0)}function Rde(e,t){return pa(e.dom,new kde(e,t),!0)}function SZ(e,t){for(var r=t,n=!1;r&&r.nodeType!==9&&!(n=r.domBelongToZr||r!==t&&r===e.painterRoot);)r=r.parentNode;return n}var kde=function(){function e(t,r){this.stopPropagation=Di,this.stopImmediatePropagation=Di,this.preventDefault=Di,this.type=r.type,this.target=this.currentTarget=t.dom,this.pointerType=r.pointerType,this.clientX=r.clientX,this.clientY=r.clientY}return e}(),qa={mousedown:function(e){e=pa(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=pa(this.dom,e);var t=this.__mayPointerCapture;t&&(e.zrX!==t[0]||e.zrY!==t[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=pa(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){e=pa(this.dom,e);var t=e.toElement||e.relatedTarget;SZ(this,t)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){M4=!0,e=pa(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){M4||(e=pa(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){e=pa(this.dom,e),nR(e),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),qa.mousemove.call(this,e),qa.mousedown.call(this,e)},touchmove:function(e){e=pa(this.dom,e),nR(e),this.handler.processGesture(e,"change"),qa.mousemove.call(this,e)},touchend:function(e){e=pa(this.dom,e),nR(e),this.handler.processGesture(e,"end"),qa.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<Ode&&qa.click.call(this,e)},pointerdown:function(e){qa.mousedown.call(this,e)},pointermove:function(e){hI(e)||qa.mousemove.call(this,e)},pointerup:function(e){qa.mouseup.call(this,e)},pointerout:function(e){hI(e)||qa.mouseout.call(this,e)}};le(["click","dblclick","contextmenu"],function(e){qa[e]=function(t){t=pa(this.dom,t),this.trigger(e,t)}});var dI={pointermove:function(e){hI(e)||dI.mousemove.call(this,e)},pointerup:function(e){dI.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function Ade(e,t){var r=t.domHandlers;Bt.pointerEventsSupported?le(rR.pointer,function(n){V1(t,n,function(i){r[n].call(e,i)})}):(Bt.touchEventsSupported&&le(rR.touch,function(n){V1(t,n,function(i){r[n].call(e,i),Ede(t)})}),le(rR.mouse,function(n){V1(t,n,function(i){i=RN(i),t.touching||r[n].call(e,i)})}))}function Pde(e,t){Bt.pointerEventsSupported?le(I4.pointer,r):Bt.touchEventsSupported||le(I4.mouse,r);function r(n){function i(a){a=RN(a),SZ(e,a.target)||(a=Rde(e,a),t.domHandlers[n].call(e,a))}V1(t,n,i,{capture:!0})}}function V1(e,t,r,n){e.mounted[t]=r,e.listenerOpts[t]=n,Bhe(e.domTarget,t,r,n)}function iR(e){var t=e.mounted;for(var r in t)t.hasOwnProperty(r)&&Vhe(e.domTarget,r,t[r],e.listenerOpts[r]);e.mounted={}}var D4=function(){function e(t,r){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=r}return e}(),Ide=function(e){Ye(t,e);function t(r,n){var i=e.call(this)||this;return i.__pointerCapturing=!1,i.dom=r,i.painterRoot=n,i._localHandlerScope=new D4(r,qa),tR&&(i._globalHandlerScope=new D4(document,dI)),Ade(i,i._localHandlerScope),i}return t.prototype.dispose=function(){iR(this._localHandlerScope),tR&&iR(this._globalHandlerScope)},t.prototype.setCursor=function(r){this.dom.style&&(this.dom.style.cursor=r||"default")},t.prototype.__togglePointerCapture=function(r){if(this.__mayPointerCapture=null,tR&&+this.__pointerCapturing^+r){this.__pointerCapturing=r;var n=this._globalHandlerScope;r?Pde(this,n):iR(n)}},t}(ts);const Mde=Ide;var CZ=1;Bt.hasGlobalWindow&&(CZ=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var XC=CZ,vI=.4,pI="#333",gI="#ccc",Dde="#eee",$4=kN,N4=5e-5;function Qu(e){return e>N4||e<-N4}var ef=[],Ch=[],aR=Xm(),oR=Math.abs,MN=function(){function e(){}return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},e.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},e.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},e.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},e.prototype.needLocalTransform=function(){return Qu(this.rotation)||Qu(this.x)||Qu(this.y)||Qu(this.scaleX-1)||Qu(this.scaleY-1)||Qu(this.skewX)||Qu(this.skewY)},e.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,r=this.needLocalTransform(),n=this.transform;if(!(r||t)){n&&$4(n);return}n=n||Xm(),r?this.getLocalTransform(n):$4(n),t&&(r?Dd(n,t,n):Uhe(n,t)),this.transform=n,this._resolveGlobalScaleRatio(n)},e.prototype._resolveGlobalScaleRatio=function(t){var r=this.globalScaleRatio;if(r!=null&&r!==1){this.getGlobalScale(ef);var n=ef[0]<0?-1:1,i=ef[1]<0?-1:1,a=((ef[0]-n)*r+n)/ef[0]||0,o=((ef[1]-i)*r+i)/ef[1]||0;t[0]*=a,t[1]*=a,t[2]*=o,t[3]*=o}this.invTransform=this.invTransform||Xm(),PN(this.invTransform,t)},e.prototype.getComputedTransform=function(){for(var t=this,r=[];t;)r.push(t),t=t.parent;for(;t=r.pop();)t.updateTransform();return this.transform},e.prototype.setLocalTransform=function(t){if(t){var r=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],i=Math.atan2(t[1],t[0]),a=Math.PI/2+i-Math.atan2(t[3],t[2]);n=Math.sqrt(n)*Math.cos(a),r=Math.sqrt(r),this.skewX=a,this.skewY=0,this.rotation=-i,this.x=+t[4],this.y=+t[5],this.scaleX=r,this.scaleY=n,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,r=this.transform;t&&t.transform&&(Dd(Ch,t.invTransform,r),r=Ch);var n=this.originX,i=this.originY;(n||i)&&(aR[4]=n,aR[5]=i,Dd(Ch,r,aR),Ch[4]-=n,Ch[5]-=i,r=Ch),this.setLocalTransform(r)}},e.prototype.getGlobalScale=function(t){var r=this.transform;return t=t||[],r?(t[0]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),t[1]=Math.sqrt(r[2]*r[2]+r[3]*r[3]),r[0]<0&&(t[0]=-t[0]),r[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},e.prototype.transformCoordToLocal=function(t,r){var n=[t,r],i=this.invTransform;return i&&Ra(n,n,i),n},e.prototype.transformCoordToGlobal=function(t,r){var n=[t,r],i=this.transform;return i&&Ra(n,n,i),n},e.prototype.getLineScale=function(){var t=this.transform;return t&&oR(t[0]-1)>1e-10&&oR(t[3]-1)>1e-10?Math.sqrt(oR(t[0]*t[3]-t[2]*t[1])):1},e.prototype.copyTransform=function(t){$de(this,t)},e.getLocalTransform=function(t,r){r=r||[];var n=t.originX||0,i=t.originY||0,a=t.scaleX,o=t.scaleY,s=t.anchorX,l=t.anchorY,u=t.rotation||0,f=t.x,c=t.y,h=t.skewX?Math.tan(t.skewX):0,d=t.skewY?Math.tan(-t.skewY):0;if(n||i||s||l){var v=n+s,p=i+l;r[4]=-v*a-h*p*o,r[5]=-p*o-d*v*a}else r[4]=r[5]=0;return r[0]=a,r[3]=o,r[1]=d*a,r[2]=h*o,u&&AN(r,r,u),r[4]+=n+f,r[5]+=i+c,r},e.initDefaultProps=function(){var t=e.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),e}(),qm=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function $de(e,t){for(var r=0;r<qm.length;r++){var n=qm[r];e[n]=t[n]}}var L4={};function ea(e,t){t=t||kc;var r=L4[t];r||(r=L4[t]=new Tw(500));var n=r.get(e);return n==null&&(n=wg.measureText(e,t).width,r.put(e,n)),n}function F4(e,t,r,n){var i=ea(e,t),a=$N(t),o=Uy(0,i,r),s=dd(0,a,n),l=new or(o,s,i,a);return l}function DN(e,t,r,n){var i=((e||"")+"").split(`
`),a=i.length;if(a===1)return F4(i[0],t,r,n);for(var o=new or(0,0,0,0),s=0;s<i.length;s++){var l=F4(i[s],t,r,n);s===0?o.copy(l):o.union(l)}return o}function Uy(e,t,r){return r==="right"?e-=t:r==="center"&&(e-=t/2),e}function dd(e,t,r){return r==="middle"?e-=t/2:r==="bottom"&&(e-=t),e}function $N(e){return ea("国",e)}function Au(e,t){return typeof e=="string"?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function qC(e,t,r){var n=t.position||"inside",i=t.distance!=null?t.distance:5,a=r.height,o=r.width,s=a/2,l=r.x,u=r.y,f="left",c="top";if(n instanceof Array)l+=Au(n[0],r.width),u+=Au(n[1],r.height),f=null,c=null;else switch(n){case"left":l-=i,u+=s,f="right",c="middle";break;case"right":l+=i+o,u+=s,c="middle";break;case"top":l+=o/2,u-=i,f="center",c="bottom";break;case"bottom":l+=o/2,u+=a+i,f="center";break;case"inside":l+=o/2,u+=s,f="center",c="middle";break;case"insideLeft":l+=i,u+=s,c="middle";break;case"insideRight":l+=o-i,u+=s,f="right",c="middle";break;case"insideTop":l+=o/2,u+=i,f="center";break;case"insideBottom":l+=o/2,u+=a-i,f="center",c="bottom";break;case"insideTopLeft":l+=i,u+=i;break;case"insideTopRight":l+=o-i,u+=i,f="right";break;case"insideBottomLeft":l+=i,u+=a-i,c="bottom";break;case"insideBottomRight":l+=o-i,u+=a-i,f="right",c="bottom";break}return e=e||{},e.x=l,e.y=u,e.align=f,e.verticalAlign=c,e}var sR="__zr_normal__",lR=qm.concat(["ignore"]),Nde=ku(qm,function(e,t){return e[t]=!0,e},{ignore:!1}),xh={},Lde=new or(0,0,0,0),NN=function(){function e(t){this.id=tZ(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return e.prototype._init=function(t){this.attr(t)},e.prototype.drift=function(t,r,n){switch(this.draggable){case"horizontal":r=0;break;case"vertical":t=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=r,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(t){var r=this._textContent;if(r&&(!r.ignore||t)){this.textConfig||(this.textConfig={});var n=this.textConfig,i=n.local,a=r.innerTransformable,o=void 0,s=void 0,l=!1;a.parent=i?this:null;var u=!1;if(a.copyTransform(r),n.position!=null){var f=Lde;n.layoutRect?f.copy(n.layoutRect):f.copy(this.getBoundingRect()),i||f.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(xh,n,f):qC(xh,n,f),a.x=xh.x,a.y=xh.y,o=xh.align,s=xh.verticalAlign;var c=n.origin;if(c&&n.rotation!=null){var h=void 0,d=void 0;c==="center"?(h=f.width*.5,d=f.height*.5):(h=Au(c[0],f.width),d=Au(c[1],f.height)),u=!0,a.originX=-a.x+h+(i?0:f.x),a.originY=-a.y+d+(i?0:f.y)}}n.rotation!=null&&(a.rotation=n.rotation);var v=n.offset;v&&(a.x+=v[0],a.y+=v[1],u||(a.originX=-v[0],a.originY=-v[1]));var p=n.inside==null?typeof n.position=="string"&&n.position.indexOf("inside")>=0:n.inside,g=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),y=void 0,m=void 0,b=void 0;p&&this.canBeInsideText()?(y=n.insideFill,m=n.insideStroke,(y==null||y==="auto")&&(y=this.getInsideTextFill()),(m==null||m==="auto")&&(m=this.getInsideTextStroke(y),b=!0)):(y=n.outsideFill,m=n.outsideStroke,(y==null||y==="auto")&&(y=this.getOutsideFill()),(m==null||m==="auto")&&(m=this.getOutsideStroke(y),b=!0)),y=y||"#000",(y!==g.fill||m!==g.stroke||b!==g.autoStroke||o!==g.align||s!==g.verticalAlign)&&(l=!0,g.fill=y,g.stroke=m,g.autoStroke=b,g.align=o,g.verticalAlign=s,r.setDefaultTextStyle(g)),r.__dirty|=qi,l&&r.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(t){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?gI:pI},e.prototype.getOutsideStroke=function(t){var r=this.__zr&&this.__zr.getBackgroundColor(),n=typeof r=="string"&&il(r);n||(n=[255,255,255,1]);for(var i=n[3],a=this.__zr.isDarkMode(),o=0;o<3;o++)n[o]=n[o]*i+(a?0:255)*(1-i);return n[3]=1,ZT(n,"rgba")},e.prototype.traverse=function(t,r){},e.prototype.attrKV=function(t,r){t==="textConfig"?this.setTextConfig(r):t==="textContent"?this.setTextContent(r):t==="clipPath"?this.setClipPath(r):t==="extra"?(this.extra=this.extra||{},Le(this.extra,r)):this[t]=r},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(t,r){if(typeof t=="string")this.attrKV(t,r);else if(dt(t))for(var n=t,i=Dr(n),a=0;a<i.length;a++){var o=i[a];this.attrKV(o,t[o])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var r=this._normalState,n=0;n<this.animators.length;n++){var i=this.animators[n],a=i.__fromStateTransition;if(!(i.getLoop()||a&&a!==sR)){var o=i.targetName,s=o?r[o]:r;i.saveTo(s)}}},e.prototype._innerSaveToNormal=function(t){var r=this._normalState;r||(r=this._normalState={}),t.textConfig&&!r.textConfig&&(r.textConfig=this.textConfig),this._savePrimaryToNormal(t,r,lR)},e.prototype._savePrimaryToNormal=function(t,r,n){for(var i=0;i<n.length;i++){var a=n[i];t[a]!=null&&!(a in r)&&(r[a]=this[a])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(t){return this.states[t]},e.prototype.ensureState=function(t){var r=this.states;return r[t]||(r[t]={}),r[t]},e.prototype.clearStates=function(t){this.useState(sR,!1,t)},e.prototype.useState=function(t,r,n,i){var a=t===sR,o=this.hasState();if(!(!o&&a)){var s=this.currentStates,l=this.stateTransition;if(!(yr(s,t)>=0&&(r||s.length===1))){var u;if(this.stateProxy&&!a&&(u=this.stateProxy(t)),u||(u=this.states&&this.states[t]),!u&&!a){ON("State "+t+" not exists.");return}a||this.saveCurrentToNormalState(u);var f=!!(u&&u.hoverLayer||i);f&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,u,this._normalState,r,!n&&!this.__inHover&&l&&l.duration>0,l);var c=this._textContent,h=this._textGuide;return c&&c.useState(t,r,n,f),h&&h.useState(t,r,n,f),a?(this.currentStates=[],this._normalState={}):r?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!f&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~qi),u}}},e.prototype.useStates=function(t,r,n){if(!t.length)this.clearStates();else{var i=[],a=this.currentStates,o=t.length,s=o===a.length;if(s){for(var l=0;l<o;l++)if(t[l]!==a[l]){s=!1;break}}if(s)return;for(var l=0;l<o;l++){var u=t[l],f=void 0;this.stateProxy&&(f=this.stateProxy(u,t)),f||(f=this.states[u]),f&&i.push(f)}var c=i[o-1],h=!!(c&&c.hoverLayer||n);h&&this._toggleHoverLayerFlag(!0);var d=this._mergeStates(i),v=this.stateTransition;this.saveCurrentToNormalState(d),this._applyStateObj(t.join(","),d,this._normalState,!1,!r&&!this.__inHover&&v&&v.duration>0,v);var p=this._textContent,g=this._textGuide;p&&p.useStates(t,r,h),g&&g.useStates(t,r,h),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~qi)}},e.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var r=this.animators[t];r.targetName&&r.changeTarget(this[r.targetName])}},e.prototype.removeState=function(t){var r=yr(this.currentStates,t);if(r>=0){var n=this.currentStates.slice();n.splice(r,1),this.useStates(n)}},e.prototype.replaceState=function(t,r,n){var i=this.currentStates.slice(),a=yr(i,t),o=yr(i,r)>=0;a>=0?o?i.splice(a,1):i[a]=r:n&&!o&&i.push(r),this.useStates(i)},e.prototype.toggleState=function(t,r){r?this.useState(t,!0):this.removeState(t)},e.prototype._mergeStates=function(t){for(var r={},n,i=0;i<t.length;i++){var a=t[i];Le(r,a),a.textConfig&&(n=n||{},Le(n,a.textConfig))}return n&&(r.textConfig=n),r},e.prototype._applyStateObj=function(t,r,n,i,a,o){var s=!(r&&i);r&&r.textConfig?(this.textConfig=Le({},i?this.textConfig:n.textConfig),Le(this.textConfig,r.textConfig)):s&&n.textConfig&&(this.textConfig=n.textConfig);for(var l={},u=!1,f=0;f<lR.length;f++){var c=lR[f],h=a&&Nde[c];r&&r[c]!=null?h?(u=!0,l[c]=r[c]):this[c]=r[c]:s&&n[c]!=null&&(h?(u=!0,l[c]=n[c]):this[c]=n[c])}if(!a)for(var f=0;f<this.animators.length;f++){var d=this.animators[f],v=d.targetName;d.getLoop()||d.__changeFinalValue(v?(r||n)[v]:r||n)}u&&this._transitionState(t,l,o)},e.prototype._attachComponent=function(t){if(!(t.__zr&&!t.__hostTarget)&&t!==this){var r=this.__zr;r&&t.addSelfToZr(r),t.__zr=r,t.__hostTarget=this}},e.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},e.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(t){var r=this._textContent;r!==t&&(r&&r!==t&&this.removeTextContent(),t.innerTransformable=new MN,this._attachComponent(t),this._textContent=t,this.markRedraw())},e.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),Le(this.textConfig,t),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=qi;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var r=this._textContent,n=this._textGuide;r&&(r.__inHover=t),n&&(n.__inHover=t)},e.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.addAnimator(r[n]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.removeAnimator(r[n]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},e.prototype.animate=function(t,r,n){var i=t?this[t]:this,a=new IN(i,r,n);return t&&(a.targetName=t),this.addAnimator(a,t),a},e.prototype.addAnimator=function(t,r){var n=this.__zr,i=this;t.during(function(){i.updateDuringAnimation(r)}).done(function(){var a=i.animators,o=yr(a,t);o>=0&&a.splice(o,1)}),this.animators.push(t),n&&n.animation.addAnimator(t),n&&n.wakeUp()},e.prototype.updateDuringAnimation=function(t){this.markRedraw()},e.prototype.stopAnimation=function(t,r){for(var n=this.animators,i=n.length,a=[],o=0;o<i;o++){var s=n[o];!t||t===s.scope?s.stop(r):a.push(s)}return this.animators=a,this},e.prototype.animateTo=function(t,r,n){uR(this,t,r,n)},e.prototype.animateFrom=function(t,r,n){uR(this,t,r,n,!0)},e.prototype._transitionState=function(t,r,n,i){for(var a=uR(this,r,n,i),o=0;o<a.length;o++)a[o].__fromStateTransition=t},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=qi;function r(n,i,a,o){Object.defineProperty(t,n,{get:function(){if(!this[i]){var l=this[i]=[];s(this,l)}return this[i]},set:function(l){this[a]=l[0],this[o]=l[1],this[i]=l,s(this,l)}});function s(l,u){Object.defineProperty(u,0,{get:function(){return l[a]},set:function(f){l[a]=f}}),Object.defineProperty(u,1,{get:function(){return l[o]},set:function(f){l[o]=f}})}}Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),e}();es(NN,ts);es(NN,MN);function uR(e,t,r,n,i){r=r||{};var a=[];xZ(e,"",e,t,r,n,a,i);var o=a.length,s=!1,l=r.done,u=r.aborted,f=function(){s=!0,o--,o<=0&&(s?l&&l():u&&u())},c=function(){o--,o<=0&&(s?l&&l():u&&u())};o||l&&l(),a.length>0&&r.during&&a[0].during(function(v,p){r.during(p)});for(var h=0;h<a.length;h++){var d=a[h];f&&d.done(f),c&&d.aborted(c),r.force&&d.duration(r.duration),d.start(r.easing)}return a}function fR(e,t,r){for(var n=0;n<r;n++)e[n]=t[n]}function Fde(e){return Ni(e[0])}function Hde(e,t,r){if(Ni(t[r]))if(Ni(e[r])||(e[r]=[]),ta(t[r])){var n=t[r].length;e[r].length!==n&&(e[r]=new t[r].constructor(n),fR(e[r],t[r],n))}else{var i=t[r],a=e[r],o=i.length;if(Fde(i))for(var s=i[0].length,l=0;l<o;l++)a[l]?fR(a[l],i[l],s):a[l]=Array.prototype.slice.call(i[l]);else fR(a,i,o);a.length=i.length}else e[r]=t[r]}function Bde(e,t){return e===t||Ni(e)&&Ni(t)&&Vde(e,t)}function Vde(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function xZ(e,t,r,n,i,a,o,s){for(var l=Dr(n),u=i.duration,f=i.delay,c=i.additive,h=i.setToFinal,d=!dt(a),v=e.animators,p=[],g=0;g<l.length;g++){var y=l[g],m=n[y];if(m!=null&&r[y]!=null&&(d||a[y]))if(dt(m)&&!Ni(m)&&!XT(m)){if(t){s||(r[y]=m,e.updateDuringAnimation(t));continue}xZ(e,y,r[y],m,i,a&&a[y],o,s)}else p.push(y);else s||(r[y]=m,e.updateDuringAnimation(t),p.push(y))}var b=p.length;if(!c&&b)for(var _=0;_<v.length;_++){var x=v[_];if(x.targetName===t){var T=x.stopTracks(p);if(T){var E=yr(v,x);v.splice(E,1)}}}if(i.force||(p=hi(p,function(D){return!Bde(n[D],r[D])}),b=p.length),b>0||i.force&&!o.length){var P=void 0,R=void 0,M=void 0;if(s){R={},h&&(P={});for(var _=0;_<b;_++){var y=p[_];R[y]=r[y],h?P[y]=n[y]:r[y]=n[y]}}else if(h){M={};for(var _=0;_<b;_++){var y=p[_];M[y]=F1(r[y]),Hde(r,n,y)}}var x=new IN(r,!1,!1,c?hi(v,function(N){return N.targetName===t}):null);x.targetName=t,i.scope&&(x.scope=i.scope),h&&P&&x.whenWithKeys(0,P,p),M&&x.whenWithKeys(0,M,p),x.whenWithKeys(u??500,s?R:n,p).delay(f||0),e.addAnimator(x,t),o.push(x)}}const TZ=NN;var OZ=function(e){Ye(t,e);function t(r){var n=e.call(this)||this;return n.isGroup=!0,n._children=[],n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(r){return this._children[r]},t.prototype.childOfName=function(r){for(var n=this._children,i=0;i<n.length;i++)if(n[i].name===r)return n[i]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(r){return r&&r!==this&&r.parent!==this&&(this._children.push(r),this._doAdd(r)),this},t.prototype.addBefore=function(r,n){if(r&&r!==this&&r.parent!==this&&n&&n.parent===this){var i=this._children,a=i.indexOf(n);a>=0&&(i.splice(a,0,r),this._doAdd(r))}return this},t.prototype.replace=function(r,n){var i=yr(this._children,r);return i>=0&&this.replaceAt(n,i),this},t.prototype.replaceAt=function(r,n){var i=this._children,a=i[n];if(r&&r!==this&&r.parent!==this&&r!==a){i[n]=r,a.parent=null;var o=this.__zr;o&&a.removeSelfFromZr(o),this._doAdd(r)}return this},t.prototype._doAdd=function(r){r.parent&&r.parent.remove(r),r.parent=this;var n=this.__zr;n&&n!==r.__zr&&r.addSelfToZr(n),n&&n.refresh()},t.prototype.remove=function(r){var n=this.__zr,i=this._children,a=yr(i,r);return a<0?this:(i.splice(a,1),r.parent=null,n&&r.removeSelfFromZr(n),n&&n.refresh(),this)},t.prototype.removeAll=function(){for(var r=this._children,n=this.__zr,i=0;i<r.length;i++){var a=r[i];n&&a.removeSelfFromZr(n),a.parent=null}return r.length=0,this},t.prototype.eachChild=function(r,n){for(var i=this._children,a=0;a<i.length;a++){var o=i[a];r.call(n,o,a)}return this},t.prototype.traverse=function(r,n){for(var i=0;i<this._children.length;i++){var a=this._children[i],o=r.call(n,a);a.isGroup&&!o&&a.traverse(r,n)}return this},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.addSelfToZr(r)}},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.removeSelfFromZr(r)}},t.prototype.getBoundingRect=function(r){for(var n=new or(0,0,0,0),i=r||this._children,a=[],o=null,s=0;s<i.length;s++){var l=i[s];if(!(l.ignore||l.invisible)){var u=l.getBoundingRect(),f=l.getLocalTransform(a);f?(or.applyTransform(n,u,f),o=o||n.clone(),o.union(n)):(o=o||u.clone(),o.union(u))}}return o||n},t}(TZ);OZ.prototype.type="group";const Kn=OZ;/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var j1={},EZ={};function jde(e){delete EZ[e]}function Wde(e){if(!e)return!1;if(typeof e=="string")return KC(e,1)<vI;if(e.colorStops){for(var t=e.colorStops,r=0,n=t.length,i=0;i<n;i++)r+=KC(t[i].color,1);return r/=n,r<vI}return!1}var Ude=function(){function e(t,r,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=r,this.id=t;var a=new ide,o=n.renderer||"canvas";j1[o]||(o=Dr(j1)[0]),n.useDirtyRect=n.useDirtyRect==null?!1:n.useDirtyRect;var s=new j1[o](r,a,n,t),l=n.ssr||s.ssrOnly;this.storage=a,this.painter=s;var u=!Bt.node&&!Bt.worker&&!l?new Mde(s.getViewportRoot(),s.root):null,f=n.useCoarsePointer,c=f==null||f==="auto"?Bt.touchEventsSupported:!!f,h=44,d;c&&(d=Xt(n.pointerSize,h)),this.handler=new Qhe(a,s,u,s.root,d),this.animation=new Tde({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return e.prototype.add=function(t){t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},e.prototype.remove=function(t){t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(t,r){this.painter.configLayer&&this.painter.configLayer(t,r),this.refresh()},e.prototype.setBackgroundColor=function(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=Wde(t)},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(t){this._darkMode=t},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(t){t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},e.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},e.prototype.flush=function(){this._flush(!1)},e.prototype._flush=function(t){var r,n=Sd();this._needsRefresh&&(r=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var i=Sd();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},e.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover()},e.prototype.resize=function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},e.prototype.clearAnimation=function(){this.animation.clear()},e.prototype.getWidth=function(){return this.painter.getWidth()},e.prototype.getHeight=function(){return this.painter.getHeight()},e.prototype.setCursorStyle=function(t){this.handler.setCursorStyle(t)},e.prototype.findHover=function(t,r){return this.handler.findHover(t,r)},e.prototype.on=function(t,r,n){return this.handler.on(t,r,n),this},e.prototype.off=function(t,r){this.handler.off(t,r)},e.prototype.trigger=function(t,r){this.handler.trigger(t,r)},e.prototype.clear=function(){for(var t=this.storage.getRoots(),r=0;r<t.length;r++)t[r]instanceof Kn&&t[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},e.prototype.dispose=function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,jde(this.id)},e}();function H4(e,t){var r=new Ude(tZ(),e,t);return EZ[r.id]=r,r}function zde(e,t){j1[e]=t}var B4=1e-4,RZ=20;function Gde(e){return e.replace(/^\s+|\s+$/g,"")}function yI(e,t,r,n){var i=t[0],a=t[1],o=r[0],s=r[1],l=a-i,u=s-o;if(l===0)return u===0?o:(o+s)/2;if(n)if(l>0){if(e<=i)return o;if(e>=a)return s}else{if(e>=i)return o;if(e<=a)return s}else{if(e===i)return o;if(e===a)return s}return(e-i)/l*u+o}function Mr(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%";break}return st(e)?Gde(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):e==null?NaN:+e}function dn(e,t,r){return t==null&&(t=10),t=Math.min(Math.max(0,t),RZ),e=(+e).toFixed(t),r?e:+e}function Os(e){if(e=+e,isNaN(e))return 0;if(e>1e-14){for(var t=1,r=0;r<15;r++,t*=10)if(Math.round(e*t)/t===e)return r}return Yde(e)}function Yde(e){var t=e.toString().toLowerCase(),r=t.indexOf("e"),n=r>0?+t.slice(r+1):0,i=r>0?r:t.length,a=t.indexOf("."),o=a<0?0:i-1-a;return Math.max(0,o-n)}function Kde(e,t){var r=Math.log,n=Math.LN10,i=Math.floor(r(e[1]-e[0])/n),a=Math.round(r(Math.abs(t[1]-t[0]))/n),o=Math.min(Math.max(-i+a,0),20);return isFinite(o)?o:20}function Xde(e,t){var r=ku(e,function(d,v){return d+(isNaN(v)?0:v)},0);if(r===0)return[];for(var n=Math.pow(10,t),i=pt(e,function(d){return(isNaN(d)?0:d)/r*n*100}),a=n*100,o=pt(i,function(d){return Math.floor(d)}),s=ku(o,function(d,v){return d+v},0),l=pt(i,function(d,v){return d-o[v]});s<a;){for(var u=Number.NEGATIVE_INFINITY,f=null,c=0,h=l.length;c<h;++c)l[c]>u&&(u=l[c],f=c);++o[f],l[f]=0,++s}return pt(o,function(d){return d/n})}function qde(e,t){var r=Math.max(Os(e),Os(t)),n=e+t;return r>RZ?n:dn(n,r)}function kZ(e){var t=Math.PI*2;return(e%t+t)%t}function ZC(e){return e>-B4&&e<B4}var Zde=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function fl(e){if(e instanceof Date)return e;if(st(e)){var t=Zde.exec(e);if(!t)return new Date(NaN);if(t[8]){var r=+t[4]||0;return t[8].toUpperCase()!=="Z"&&(r-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,r,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}else return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}else if(e==null)return new Date(NaN);return new Date(Math.round(e))}function Jde(e){return Math.pow(10,LN(e))}function LN(e){if(e===0)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return e/Math.pow(10,t)>=10&&t++,t}function AZ(e,t){var r=LN(e),n=Math.pow(10,r),i=e/n,a;return t?i<1.5?a=1:i<2.5?a=2:i<4?a=3:i<7?a=5:a=10:i<1?a=1:i<2?a=2:i<3?a=3:i<5?a=5:a=10,e=a*n,r>=-20?+e.toFixed(r<0?-r:0):e}function JC(e){var t=parseFloat(e);return t==e&&(t!==0||!st(e)||e.indexOf("x")<=0)?t:NaN}function Qde(e){return!isNaN(JC(e))}function PZ(){return Math.round(Math.random()*9)}function IZ(e,t){return t===0?e:IZ(t,e%t)}function V4(e,t){return e==null?t:t==null?e:e*t/IZ(e,t)}function Pi(e){throw new Error(e)}function j4(e,t,r){return(t-e)*r+e}var MZ="series\0",eve="\0_ec_\0";function gi(e){return e instanceof Array?e:e==null?[]:[e]}function mI(e,t,r){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var n=0,i=r.length;n<i;n++){var a=r[n];!e.emphasis[t].hasOwnProperty(a)&&e[t].hasOwnProperty(a)&&(e.emphasis[t][a]=e[t][a])}}}var W4=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Ow(e){return dt(e)&&!et(e)&&!(e instanceof Date)?e.value:e}function tve(e){return dt(e)&&!(e instanceof Array)}function rve(e,t,r){var n=r==="normalMerge",i=r==="replaceMerge",a=r==="replaceAll";e=e||[],t=(t||[]).slice();var o=Vt();le(t,function(l,u){if(!dt(l)){t[u]=null;return}});var s=nve(e,o,r);return(n||i)&&ive(s,e,o,t),n&&ave(s,t),n||i?ove(s,t,i):a&&sve(s,t),lve(s),s}function nve(e,t,r){var n=[];if(r==="replaceAll")return n;for(var i=0;i<e.length;i++){var a=e[i];a&&a.id!=null&&t.set(a.id,i),n.push({existing:r==="replaceMerge"||Zm(a)?null:a,newOption:null,keyInfo:null,brandNew:null})}return n}function ive(e,t,r,n){le(n,function(i,a){if(!(!i||i.id==null)){var o=fm(i.id),s=r.get(o);if(s!=null){var l=e[s];ul(!l.newOption,'Duplicated option on id "'+o+'".'),l.newOption=i,l.existing=t[s],n[a]=null}}})}function ave(e,t){le(t,function(r,n){if(!(!r||r.name==null))for(var i=0;i<e.length;i++){var a=e[i].existing;if(!e[i].newOption&&a&&(a.id==null||r.id==null)&&!Zm(r)&&!Zm(a)&&DZ("name",a,r)){e[i].newOption=r,t[n]=null;return}}})}function ove(e,t,r){le(t,function(n){if(n){for(var i,a=0;(i=e[a])&&(i.newOption||Zm(i.existing)||i.existing&&n.id!=null&&!DZ("id",n,i.existing));)a++;i?(i.newOption=n,i.brandNew=r):e.push({newOption:n,brandNew:r,existing:null,keyInfo:null}),a++}})}function sve(e,t){le(t,function(r){e.push({newOption:r,brandNew:!0,existing:null,keyInfo:null})})}function lve(e){var t=Vt();le(e,function(r){var n=r.existing;n&&t.set(n.id,r)}),le(e,function(r){var n=r.newOption;ul(!n||n.id==null||!t.get(n.id)||t.get(n.id)===r,"id duplicates: "+(n&&n.id)),n&&n.id!=null&&t.set(n.id,r),!r.keyInfo&&(r.keyInfo={})}),le(e,function(r,n){var i=r.existing,a=r.newOption,o=r.keyInfo;if(dt(a)){if(o.name=a.name!=null?fm(a.name):i?i.name:MZ+n,i)o.id=fm(i.id);else if(a.id!=null)o.id=fm(a.id);else{var s=0;do o.id="\0"+o.name+"\0"+s++;while(t.get(o.id))}t.set(o.id,r)}})}function DZ(e,t,r){var n=Ko(t[e],null),i=Ko(r[e],null);return n!=null&&i!=null&&n===i}function fm(e){return Ko(e,"")}function Ko(e,t){return e==null?t:st(e)?e:_r(e)||JP(e)?e+"":t}function FN(e){var t=e.name;return!!(t&&t.indexOf(MZ))}function Zm(e){return e&&e.id!=null&&fm(e.id).indexOf(eve)===0}function uve(e,t,r){le(e,function(n){var i=n.newOption;dt(i)&&(n.keyInfo.mainType=t,n.keyInfo.subType=fve(t,i,n.existing,r))})}function fve(e,t,r,n){var i=t.type?t.type:r?r.subType:n.determineSubType(e,t);return i}function Ac(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return et(t.dataIndex)?pt(t.dataIndex,function(r){return e.indexOfRawIndex(r)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return et(t.name)?pt(t.name,function(r){return e.indexOfName(r)}):e.indexOfName(t.name)}function pn(){var e="__ec_inner_"+cve++;return function(t){return t[e]||(t[e]={})}}var cve=PZ();function cR(e,t,r){var n=HN(t,r),i=n.mainTypeSpecified,a=n.queryOptionMap,o=n.others,s=o,l=r?r.defaultMainType:null;return!i&&l&&a.set(l,{}),a.each(function(u,f){var c=Ew(e,f,u,{useDefault:l===f,enableAll:r&&r.enableAll!=null?r.enableAll:!0,enableNone:r&&r.enableNone!=null?r.enableNone:!0});s[f+"Models"]=c.models,s[f+"Model"]=c.models[0]}),s}function HN(e,t){var r;if(st(e)){var n={};n[e+"Index"]=0,r=n}else r=e;var i=Vt(),a={},o=!1;return le(r,function(s,l){if(l==="dataIndex"||l==="dataIndexInside"){a[l]=s;return}var u=l.match(/^(\w+)(Index|Id|Name)$/)||[],f=u[1],c=(u[2]||"").toLowerCase();if(!(!f||!c||t&&t.includeMainTypes&&yr(t.includeMainTypes,f)<0)){o=o||!!f;var h=i.get(f)||i.set(f,{});h[c]=s}}),{mainTypeSpecified:o,queryOptionMap:i,others:a}}var ao={useDefault:!0,enableAll:!1,enableNone:!1};function Ew(e,t,r,n){n=n||ao;var i=r.index,a=r.id,o=r.name,s={models:null,specified:i!=null||a!=null||o!=null};if(!s.specified){var l=void 0;return s.models=n.useDefault&&(l=e.getComponent(t))?[l]:[],s}return i==="none"||i===!1?(ul(n.enableNone,'`"none"` or `false` is not a valid value on index option.'),s.models=[],s):(i==="all"&&(ul(n.enableAll,'`"all"` is not a valid value on index option.'),i=a=o=null),s.models=e.queryComponents({mainType:t,index:i,id:a,name:o}),s)}function $Z(e,t,r){e.setAttribute?e.setAttribute(t,r):e[t]=r}function hve(e,t){return e.getAttribute?e.getAttribute(t):e[t]}function dve(e){return e==="auto"?Bt.domSupported?"html":"richText":e||"html"}function vve(e,t,r,n,i){var a=t==null||t==="auto";if(n==null)return n;if(_r(n)){var o=j4(r||0,n,i);return dn(o,a?Math.max(Os(r||0),Os(n)):t)}else{if(st(n))return i<1?r:n;for(var s=[],l=r,u=n,f=Math.max(l?l.length:0,u.length),c=0;c<f;++c){var h=e.getDimensionInfo(c);if(h&&h.type==="ordinal")s[c]=(i<1&&l?l:u)[c];else{var d=l&&l[c]?l[c]:0,v=u[c],o=j4(d,v,i);s[c]=dn(o,a?Math.max(Os(d),Os(v)):t)}}return s}}var pve=".",tf="___EC__COMPONENT__CONTAINER___",NZ="___EC__EXTENDED_CLASS___";function zo(e){var t={main:"",sub:""};if(e){var r=e.split(pve);t.main=r[0]||"",t.sub=r[1]||""}return t}function gve(e){ul(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function yve(e){return!!(e&&e[NZ])}function BN(e,t){e.$constructor=e,e.extend=function(r){var n=this,i;return mve(n)?i=function(a){Ye(o,a);function o(){return a.apply(this,arguments)||this}return o}(n):(i=function(){(r.$constructor||n).apply(this,arguments)},vhe(i,this)),Le(i.prototype,r),i[NZ]=!0,i.extend=this.extend,i.superCall=_ve,i.superApply=Sve,i.superClass=n,i}}function mve(e){return Nt(e)&&/^class\s/.test(Function.prototype.toString.call(e))}function LZ(e,t){e.extend=t.extend}var bve=Math.round(Math.random()*10);function wve(e){var t=["__\0is_clz",bve++].join("_");e.prototype[t]=!0,e.isInstance=function(r){return!!(r&&r[t])}}function _ve(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.superClass.prototype[t].apply(e,r)}function Sve(e,t,r){return this.superClass.prototype[t].apply(e,r)}function JT(e){var t={};e.registerClass=function(n){var i=n.type||n.prototype.type;if(i){gve(i),n.prototype.type=i;var a=zo(i);if(!a.sub)t[a.main]=n;else if(a.sub!==tf){var o=r(a);o[a.sub]=n}}return n},e.getClass=function(n,i,a){var o=t[n];if(o&&o[tf]&&(o=i?o[i]:null),a&&!o)throw new Error(i?"Component "+n+"."+(i||"")+" is used but not imported.":n+".type should be specified.");return o},e.getClassesByMainType=function(n){var i=zo(n),a=[],o=t[i.main];return o&&o[tf]?le(o,function(s,l){l!==tf&&a.push(s)}):a.push(o),a},e.hasClass=function(n){var i=zo(n);return!!t[i.main]},e.getAllClassMainTypes=function(){var n=[];return le(t,function(i,a){n.push(a)}),n},e.hasSubTypes=function(n){var i=zo(n),a=t[i.main];return a&&a[tf]};function r(n){var i=t[n.main];return(!i||!i[tf])&&(i=t[n.main]={},i[tf]=!0),i}}function Jm(e,t){for(var r=0;r<e.length;r++)e[r][1]||(e[r][1]=e[r][0]);return t=t||!1,function(n,i,a){for(var o={},s=0;s<e.length;s++){var l=e[s][1];if(!(i&&yr(i,l)>=0||a&&yr(a,l)<0)){var u=n.getShallow(l,t);u!=null&&(o[e[s][0]]=u)}}return o}}var Cve=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],xve=Jm(Cve),Tve=function(){function e(){}return e.prototype.getAreaStyle=function(t,r){return xve(this,t,r)},e}(),bI=new Tw(50);function Ove(e){if(typeof e=="string"){var t=bI.get(e);return t&&t.image}else return e}function FZ(e,t,r,n,i){if(e)if(typeof e=="string"){if(t&&t.__zrImageSrc===e||!r)return t;var a=bI.get(e),o={hostEl:r,cb:n,cbPayload:i};return a?(t=a.image,!QT(t)&&a.pending.push(o)):(t=wg.loadImage(e,U4,U4),t.__zrImageSrc=e,bI.put(e,t.__cachedImgObj={image:t,pending:[o]})),t}else return e;else return t}function U4(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var r=e.pending[t],n=r.cb;n&&n(this,r.cbPayload),r.hostEl.dirty()}e.pending.length=0}function QT(e){return e&&e.width&&e.height}var hR=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function Eve(e,t,r,n,i){if(!t)return"";var a=(e+"").split(`
`);i=HZ(t,r,n,i);for(var o=0,s=a.length;o<s;o++)a[o]=BZ(a[o],i);return a.join(`
`)}function HZ(e,t,r,n){n=n||{};var i=Le({},n);i.font=t,r=Xt(r,"..."),i.maxIterations=Xt(n.maxIterations,2);var a=i.minChar=Xt(n.minChar,0);i.cnCharWidth=ea("国",t);var o=i.ascCharWidth=ea("a",t);i.placeholder=Xt(n.placeholder,"");for(var s=e=Math.max(0,e-1),l=0;l<a&&s>=o;l++)s-=o;var u=ea(r,t);return u>s&&(r="",u=0),s=e-u,i.ellipsis=r,i.ellipsisWidth=u,i.contentWidth=s,i.containerWidth=e,i}function BZ(e,t){var r=t.containerWidth,n=t.font,i=t.contentWidth;if(!r)return"";var a=ea(e,n);if(a<=r)return e;for(var o=0;;o++){if(a<=i||o>=t.maxIterations){e+=t.ellipsis;break}var s=o===0?Rve(e,i,t.ascCharWidth,t.cnCharWidth):a>0?Math.floor(e.length*i/a):0;e=e.substr(0,s),a=ea(e,n)}return e===""&&(e=t.placeholder),e}function Rve(e,t,r,n){for(var i=0,a=0,o=e.length;a<o&&i<t;a++){var s=e.charCodeAt(a);i+=0<=s&&s<=127?r:n}return a}function kve(e,t){e!=null&&(e+="");var r=t.overflow,n=t.padding,i=t.font,a=r==="truncate",o=$N(i),s=Xt(t.lineHeight,o),l=!!t.backgroundColor,u=t.lineOverflow==="truncate",f=t.width,c;f!=null&&(r==="break"||r==="breakAll")?c=e?VZ(e,t.font,f,r==="breakAll",0).lines:[]:c=e?e.split(`
`):[];var h=c.length*s,d=Xt(t.height,h);if(h>d&&u){var v=Math.floor(d/s);c=c.slice(0,v)}if(e&&a&&f!=null)for(var p=HZ(f,i,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),g=0;g<c.length;g++)c[g]=BZ(c[g],p);for(var y=d,m=0,g=0;g<c.length;g++)m=Math.max(ea(c[g],i),m);f==null&&(f=m);var b=m;return n&&(y+=n[0]+n[2],b+=n[1]+n[3],f+=n[1]+n[3]),l&&(b=f),{lines:c,height:d,outerWidth:b,outerHeight:y,lineHeight:s,calculatedLineHeight:o,contentWidth:m,contentHeight:h,width:f}}var Ave=function(){function e(){}return e}(),z4=function(){function e(t){this.tokens=[],t&&(this.tokens=t)}return e}(),Pve=function(){function e(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return e}();function Ive(e,t){var r=new Pve;if(e!=null&&(e+=""),!e)return r;for(var n=t.width,i=t.height,a=t.overflow,o=(a==="break"||a==="breakAll")&&n!=null?{width:n,accumWidth:0,breakAll:a==="breakAll"}:null,s=hR.lastIndex=0,l;(l=hR.exec(e))!=null;){var u=l.index;u>s&&dR(r,e.substring(s,u),t,o),dR(r,l[2],t,o,l[1]),s=hR.lastIndex}s<e.length&&dR(r,e.substring(s,e.length),t,o);var f=[],c=0,h=0,d=t.padding,v=a==="truncate",p=t.lineOverflow==="truncate";function g(k,w,C){k.width=w,k.lineHeight=C,c+=C,h=Math.max(h,w)}e:for(var y=0;y<r.lines.length;y++){for(var m=r.lines[y],b=0,_=0,x=0;x<m.tokens.length;x++){var T=m.tokens[x],E=T.styleName&&t.rich[T.styleName]||{},P=T.textPadding=E.padding,R=P?P[1]+P[3]:0,M=T.font=E.font||t.font;T.contentHeight=$N(M);var D=Xt(E.height,T.contentHeight);if(T.innerHeight=D,P&&(D+=P[0]+P[2]),T.height=D,T.lineHeight=sm(E.lineHeight,t.lineHeight,D),T.align=E&&E.align||t.align,T.verticalAlign=E&&E.verticalAlign||"middle",p&&i!=null&&c+T.lineHeight>i){x>0?(m.tokens=m.tokens.slice(0,x),g(m,_,b),r.lines=r.lines.slice(0,y+1)):r.lines=r.lines.slice(0,y);break e}var N=E.width,B=N==null||N==="auto";if(typeof N=="string"&&N.charAt(N.length-1)==="%")T.percentWidth=N,f.push(T),T.contentWidth=ea(T.text,M);else{if(B){var K=E.backgroundColor,Z=K&&K.image;Z&&(Z=Ove(Z),QT(Z)&&(T.width=Math.max(T.width,Z.width*D/Z.height)))}var ie=v&&n!=null?n-_:null;ie!=null&&ie<T.width?!B||ie<R?(T.text="",T.width=T.contentWidth=0):(T.text=Eve(T.text,ie-R,M,t.ellipsis,{minChar:t.truncateMinChar}),T.width=T.contentWidth=ea(T.text,M)):T.contentWidth=ea(T.text,M)}T.width+=R,_+=T.width,E&&(b=Math.max(b,T.lineHeight))}g(m,_,b)}r.outerWidth=r.width=Xt(n,h),r.outerHeight=r.height=Xt(i,c),r.contentHeight=c,r.contentWidth=h,d&&(r.outerWidth+=d[1]+d[3],r.outerHeight+=d[0]+d[2]);for(var y=0;y<f.length;y++){var T=f[y],me=T.percentWidth;T.width=parseInt(me,10)/100*r.width}return r}function dR(e,t,r,n,i){var a=t==="",o=i&&r.rich[i]||{},s=e.lines,l=o.font||r.font,u=!1,f,c;if(n){var h=o.padding,d=h?h[1]+h[3]:0;if(o.width!=null&&o.width!=="auto"){var v=Au(o.width,n.width)+d;s.length>0&&v+n.accumWidth>n.width&&(f=t.split(`
`),u=!0),n.accumWidth=v}else{var p=VZ(t,l,n.width,n.breakAll,n.accumWidth);n.accumWidth=p.accumWidth+d,c=p.linesWidths,f=p.lines}}else f=t.split(`
`);for(var g=0;g<f.length;g++){var y=f[g],m=new Ave;if(m.styleName=i,m.text=y,m.isLineHolder=!y&&!a,typeof o.width=="number"?m.width=o.width:m.width=c?c[g]:ea(y,l),!g&&!u){var b=(s[s.length-1]||(s[0]=new z4)).tokens,_=b.length;_===1&&b[0].isLineHolder?b[0]=m:(y||!_||a)&&b.push(m)}else s.push(new z4([m]))}}function Mve(e){var t=e.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var Dve=ku(",&?/;] ".split(""),function(e,t){return e[t]=!0,e},{});function $ve(e){return Mve(e)?!!Dve[e]:!0}function VZ(e,t,r,n,i){for(var a=[],o=[],s="",l="",u=0,f=0,c=0;c<e.length;c++){var h=e.charAt(c);if(h===`
`){l&&(s+=l,f+=u),a.push(s),o.push(f),s="",l="",u=0,f=0;continue}var d=ea(h,t),v=n?!1:!$ve(h);if(a.length?f+d>r:i+f+d>r){f?(s||l)&&(v?(s||(s=l,l="",u=0,f=u),a.push(s),o.push(f-u),l+=h,u+=d,s="",f=u):(l&&(s+=l,l="",u=0),a.push(s),o.push(f),s=h,f=d)):v?(a.push(l),o.push(u),l=h,u=d):(a.push(h),o.push(d));continue}f+=d,v?(l+=h,u+=d):(l&&(s+=l,l="",u=0),s+=h)}return!a.length&&!s&&(s=e,l="",u=0),l&&(s+=l),s&&(a.push(s),o.push(f)),a.length===1&&(f+=i),{accumWidth:f,lines:a,linesWidths:o}}var wI="__zr_style_"+Math.round(Math.random()*10),bc={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},eO={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};bc[wI]=!0;var G4=["z","z2","invisible"],Nve=["invisible"],Lve=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype._init=function(r){for(var n=Dr(r),i=0;i<n.length;i++){var a=n[i];a==="style"?this.useStyle(r[a]):e.prototype.attrKV.call(this,a,r[a])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(r,n,i,a){var o=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&Fve(this,r,n)||o&&!o[0]&&!o[3])return!1;if(i&&this.__clipPaths){for(var s=0;s<this.__clipPaths.length;++s)if(this.__clipPaths[s].isZeroArea())return!1}if(a&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},t.prototype.contain=function(r,n){return this.rectContain(r,n)},t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.rectContain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();return a.contain(i[0],i[1])},t.prototype.getPaintRect=function(){var r=this._paintRect;if(!this._paintRect||this.__dirty){var n=this.transform,i=this.getBoundingRect(),a=this.style,o=a.shadowBlur||0,s=a.shadowOffsetX||0,l=a.shadowOffsetY||0;r=this._paintRect||(this._paintRect=new or(0,0,0,0)),n?or.applyTransform(r,i,n):r.copy(i),(o||s||l)&&(r.width+=o*2+Math.abs(s),r.height+=o*2+Math.abs(l),r.x=Math.min(r.x,r.x+s-o),r.y=Math.min(r.y,r.y+l-o));var u=this.dirtyRectTolerance;r.isZero()||(r.x=Math.floor(r.x-u),r.y=Math.floor(r.y-u),r.width=Math.ceil(r.width+1+u*2),r.height=Math.ceil(r.height+1+u*2))}return r},t.prototype.setPrevPaintRect=function(r){r?(this._prevPaintRect=this._prevPaintRect||new or(0,0,0,0),this._prevPaintRect.copy(r)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(r){return this.animate("style",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(r,n){r!=="style"?e.prototype.attrKV.call(this,r,n):this.style?this.setStyle(n):this.useStyle(n)},t.prototype.setStyle=function(r,n){return typeof r=="string"?this.style[r]=n:Le(this.style,r),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(r){r||this.markRedraw(),this.__dirty|=jy,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&jy)},t.prototype.styleUpdated=function(){this.__dirty&=~jy},t.prototype.createStyle=function(r){return qT(bc,r)},t.prototype.useStyle=function(r){r[wI]||(r=this.createStyle(r)),this.__inHover?this.__hoverStyle=r:this.style=r,this.dirtyStyle()},t.prototype.isStyleObject=function(r){return r[wI]},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(r,n,G4)},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.style?o?a?u=n.style:(u=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(u,n.style)):(u=this._mergeStyle(this.createStyle(),a?this.style:i.style),this._mergeStyle(u,n.style)):l&&(u=i.style),u)if(o){var f=this.style;if(this.style=this.createStyle(l?{}:f),l)for(var c=Dr(f),h=0;h<c.length;h++){var d=c[h];d in u&&(u[d]=u[d],this.style[d]=f[d])}for(var v=Dr(u),h=0;h<v.length;h++){var d=v[h];this.style[d]=this.style[d]}this._transitionState(r,{style:u},s,this.getAnimationStyleProps())}else this.useStyle(u);for(var p=this.__inHover?Nve:G4,h=0;h<p.length;h++){var d=p[h];n&&n[d]!=null?this[d]=n[d]:l&&i[d]!=null&&(this[d]=i[d])}},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.style&&(i=i||{},this._mergeStyle(i,o.style))}return i&&(n.style=i),n},t.prototype._mergeStyle=function(r,n){return Le(r,n),r},t.prototype.getAnimationStyleProps=function(){return eO},t.initDefaultProps=function(){var r=t.prototype;r.type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,r.__dirty=qi|jy}(),t}(TZ),vR=new or(0,0,0,0),pR=new or(0,0,0,0);function Fve(e,t,r){return vR.copy(e.getBoundingRect()),e.transform&&vR.applyTransform(e.transform),pR.width=t,pR.height=r,!vR.intersect(pR)}const Rw=Lve;var Sa=Math.min,Ca=Math.max,gR=Math.sin,yR=Math.cos,rf=Math.PI*2,j_=_g(),W_=_g(),U_=_g();function Y4(e,t,r,n,i,a){i[0]=Sa(e,r),i[1]=Sa(t,n),a[0]=Ca(e,r),a[1]=Ca(t,n)}var K4=[],X4=[];function Hve(e,t,r,n,i,a,o,s,l,u){var f=gZ,c=mn,h=f(e,r,i,o,K4);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<h;d++){var v=c(e,r,i,o,K4[d]);l[0]=Sa(v,l[0]),u[0]=Ca(v,u[0])}h=f(t,n,a,s,X4);for(var d=0;d<h;d++){var p=c(t,n,a,s,X4[d]);l[1]=Sa(p,l[1]),u[1]=Ca(p,u[1])}l[0]=Sa(e,l[0]),u[0]=Ca(e,u[0]),l[0]=Sa(o,l[0]),u[0]=Ca(o,u[0]),l[1]=Sa(t,l[1]),u[1]=Ca(t,u[1]),l[1]=Sa(s,l[1]),u[1]=Ca(s,u[1])}function Bve(e,t,r,n,i,a,o,s){var l=yZ,u=Hn,f=Ca(Sa(l(e,r,i),1),0),c=Ca(Sa(l(t,n,a),1),0),h=u(e,r,i,f),d=u(t,n,a,c);o[0]=Sa(e,i,h),o[1]=Sa(t,a,d),s[0]=Ca(e,i,h),s[1]=Ca(t,a,d)}function Vve(e,t,r,n,i,a,o,s,l){var u=wd,f=_d,c=Math.abs(i-a);if(c%rf<1e-4&&c>1e-4){s[0]=e-r,s[1]=t-n,l[0]=e+r,l[1]=t+n;return}if(j_[0]=yR(i)*r+e,j_[1]=gR(i)*n+t,W_[0]=yR(a)*r+e,W_[1]=gR(a)*n+t,u(s,j_,W_),f(l,j_,W_),i=i%rf,i<0&&(i=i+rf),a=a%rf,a<0&&(a=a+rf),i>a&&!o?a+=rf:i<a&&o&&(i+=rf),o){var h=a;a=i,i=h}for(var d=0;d<a;d+=Math.PI/2)d>i&&(U_[0]=yR(d)*r+e,U_[1]=gR(d)*n+t,u(s,U_,s),f(l,U_,l))}var ir={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},nf=[],af=[],_o=[],Rl=[],So=[],Co=[],mR=Math.min,bR=Math.max,of=Math.cos,sf=Math.sin,cs=Math.abs,_I=Math.PI,zl=_I*2,wR=typeof Float32Array<"u",Kg=[];function _R(e){var t=Math.round(e/_I*1e8)/1e8;return t%2*_I}function jve(e,t){var r=_R(e[0]);r<0&&(r+=zl);var n=r-e[0],i=e[1];i+=n,!t&&i-r>=zl?i=r+zl:t&&r-i>=zl?i=r-zl:!t&&r>i?i=r+(zl-_R(r-i)):t&&r<i&&(i=r-(zl-_R(i-r))),e[0]=r,e[1]=i}var Wve=function(){function e(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(t,r,n){n=n||0,n>0&&(this._ux=cs(n/XC/t)||0,this._uy=cs(n/XC/r)||0)},e.prototype.setDPR=function(t){this.dpr=t},e.prototype.setContext=function(t){this._ctx=t},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(t,r){return this._drawPendingPt(),this.addData(ir.M,t,r),this._ctx&&this._ctx.moveTo(t,r),this._x0=t,this._y0=r,this._xi=t,this._yi=r,this},e.prototype.lineTo=function(t,r){var n=cs(t-this._xi),i=cs(r-this._yi),a=n>this._ux||i>this._uy;if(this.addData(ir.L,t,r),this._ctx&&a&&this._ctx.lineTo(t,r),a)this._xi=t,this._yi=r,this._pendingPtDist=0;else{var o=n*n+i*i;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=r,this._pendingPtDist=o)}return this},e.prototype.bezierCurveTo=function(t,r,n,i,a,o){return this._drawPendingPt(),this.addData(ir.C,t,r,n,i,a,o),this._ctx&&this._ctx.bezierCurveTo(t,r,n,i,a,o),this._xi=a,this._yi=o,this},e.prototype.quadraticCurveTo=function(t,r,n,i){return this._drawPendingPt(),this.addData(ir.Q,t,r,n,i),this._ctx&&this._ctx.quadraticCurveTo(t,r,n,i),this._xi=n,this._yi=i,this},e.prototype.arc=function(t,r,n,i,a,o){this._drawPendingPt(),Kg[0]=i,Kg[1]=a,jve(Kg,o),i=Kg[0],a=Kg[1];var s=a-i;return this.addData(ir.A,t,r,n,n,i,s,0,o?0:1),this._ctx&&this._ctx.arc(t,r,n,i,a,o),this._xi=of(a)*n+t,this._yi=sf(a)*n+r,this},e.prototype.arcTo=function(t,r,n,i,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,r,n,i,a),this},e.prototype.rect=function(t,r,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,r,n,i),this.addData(ir.R,t,r,n,i),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(ir.Z);var t=this._ctx,r=this._x0,n=this._y0;return t&&t.closePath(),this._xi=r,this._yi=n,this},e.prototype.fill=function(t){t&&t.fill(),this.toStatic()},e.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(t){var r=t.length;!(this.data&&this.data.length===r)&&wR&&(this.data=new Float32Array(r));for(var n=0;n<r;n++)this.data[n]=t[n];this._len=r},e.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var r=t.length,n=0,i=this._len,a=0;a<r;a++)n+=t[a].len();wR&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(var a=0;a<r;a++)for(var o=t[a].data,s=0;s<o.length;s++)this.data[i++]=o[s];this._len=i},e.prototype.addData=function(t,r,n,i,a,o,s,l,u){if(this._saveData){var f=this.data;this._len+arguments.length>f.length&&(this._expandData(),f=this.data);for(var c=0;c<arguments.length;c++)f[this._len++]=arguments[c]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],r=0;r<this._len;r++)t[r]=this.data[r];this.data=t}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,wR&&this._len>11&&(this.data=new Float32Array(t)))}},e.prototype.getBoundingRect=function(){_o[0]=_o[1]=So[0]=So[1]=Number.MAX_VALUE,Rl[0]=Rl[1]=Co[0]=Co[1]=-Number.MAX_VALUE;var t=this.data,r=0,n=0,i=0,a=0,o;for(o=0;o<this._len;){var s=t[o++],l=o===1;switch(l&&(r=t[o],n=t[o+1],i=r,a=n),s){case ir.M:r=i=t[o++],n=a=t[o++],So[0]=i,So[1]=a,Co[0]=i,Co[1]=a;break;case ir.L:Y4(r,n,t[o],t[o+1],So,Co),r=t[o++],n=t[o++];break;case ir.C:Hve(r,n,t[o++],t[o++],t[o++],t[o++],t[o],t[o+1],So,Co),r=t[o++],n=t[o++];break;case ir.Q:Bve(r,n,t[o++],t[o++],t[o],t[o+1],So,Co),r=t[o++],n=t[o++];break;case ir.A:var u=t[o++],f=t[o++],c=t[o++],h=t[o++],d=t[o++],v=t[o++]+d;o+=1;var p=!t[o++];l&&(i=of(d)*c+u,a=sf(d)*h+f),Vve(u,f,c,h,d,v,p,So,Co),r=of(v)*c+u,n=sf(v)*h+f;break;case ir.R:i=r=t[o++],a=n=t[o++];var g=t[o++],y=t[o++];Y4(i,a,i+g,a+y,So,Co);break;case ir.Z:r=i,n=a;break}wd(_o,_o,So),_d(Rl,Rl,Co)}return o===0&&(_o[0]=_o[1]=Rl[0]=Rl[1]=0),new or(_o[0],_o[1],Rl[0]-_o[0],Rl[1]-_o[1])},e.prototype._calculateLength=function(){var t=this.data,r=this._len,n=this._ux,i=this._uy,a=0,o=0,s=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var u=this._pathSegLen,f=0,c=0,h=0;h<r;){var d=t[h++],v=h===1;v&&(a=t[h],o=t[h+1],s=a,l=o);var p=-1;switch(d){case ir.M:a=s=t[h++],o=l=t[h++];break;case ir.L:{var g=t[h++],y=t[h++],m=g-a,b=y-o;(cs(m)>n||cs(b)>i||h===r-1)&&(p=Math.sqrt(m*m+b*b),a=g,o=y);break}case ir.C:{var _=t[h++],x=t[h++],g=t[h++],y=t[h++],T=t[h++],E=t[h++];p=ode(a,o,_,x,g,y,T,E,10),a=T,o=E;break}case ir.Q:{var _=t[h++],x=t[h++],g=t[h++],y=t[h++];p=ude(a,o,_,x,g,y,10),a=g,o=y;break}case ir.A:var P=t[h++],R=t[h++],M=t[h++],D=t[h++],N=t[h++],B=t[h++],K=B+N;h+=1,t[h++],v&&(s=of(N)*M+P,l=sf(N)*D+R),p=bR(M,D)*mR(zl,Math.abs(B)),a=of(K)*M+P,o=sf(K)*D+R;break;case ir.R:{s=a=t[h++],l=o=t[h++];var Z=t[h++],ie=t[h++];p=Z*2+ie*2;break}case ir.Z:{var m=s-a,b=l-o;p=Math.sqrt(m*m+b*b),a=s,o=l;break}}p>=0&&(u[c++]=p,f+=p)}return this._pathLen=f,f},e.prototype.rebuildPath=function(t,r){var n=this.data,i=this._ux,a=this._uy,o=this._len,s,l,u,f,c,h,d=r<1,v,p,g=0,y=0,m,b=0,_,x;if(!(d&&(this._pathSegLen||this._calculateLength(),v=this._pathSegLen,p=this._pathLen,m=r*p,!m)))e:for(var T=0;T<o;){var E=n[T++],P=T===1;switch(P&&(u=n[T],f=n[T+1],s=u,l=f),E!==ir.L&&b>0&&(t.lineTo(_,x),b=0),E){case ir.M:s=u=n[T++],l=f=n[T++],t.moveTo(u,f);break;case ir.L:{c=n[T++],h=n[T++];var R=cs(c-u),M=cs(h-f);if(R>i||M>a){if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;t.lineTo(u*(1-N)+c*N,f*(1-N)+h*N);break e}g+=D}t.lineTo(c,h),u=c,f=h,b=0}else{var B=R*R+M*M;B>b&&(_=c,x=h,b=B)}break}case ir.C:{var K=n[T++],Z=n[T++],ie=n[T++],me=n[T++],k=n[T++],w=n[T++];if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;GC(u,K,ie,k,N,nf),GC(f,Z,me,w,N,af),t.bezierCurveTo(nf[1],af[1],nf[2],af[2],nf[3],af[3]);break e}g+=D}t.bezierCurveTo(K,Z,ie,me,k,w),u=k,f=w;break}case ir.Q:{var K=n[T++],Z=n[T++],ie=n[T++],me=n[T++];if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;YC(u,K,ie,N,nf),YC(f,Z,me,N,af),t.quadraticCurveTo(nf[1],af[1],nf[2],af[2]);break e}g+=D}t.quadraticCurveTo(K,Z,ie,me),u=ie,f=me;break}case ir.A:var C=n[T++],O=n[T++],S=n[T++],A=n[T++],I=n[T++],L=n[T++],V=n[T++],Y=!n[T++],ae=S>A?S:A,re=cs(S-A)>.001,te=I+L,ge=!1;if(d){var D=v[y++];g+D>m&&(te=I+L*(m-g)/D,ge=!0),g+=D}if(re&&t.ellipse?t.ellipse(C,O,S,A,V,I,te,Y):t.arc(C,O,ae,I,te,Y),ge)break e;P&&(s=of(I)*S+C,l=sf(I)*A+O),u=of(te)*S+C,f=sf(te)*A+O;break;case ir.R:s=u=n[T],l=f=n[T+1],c=n[T++],h=n[T++];var H=n[T++],Ce=n[T++];if(d){var D=v[y++];if(g+D>m){var oe=m-g;t.moveTo(c,h),t.lineTo(c+mR(oe,H),h),oe-=H,oe>0&&t.lineTo(c+H,h+mR(oe,Ce)),oe-=Ce,oe>0&&t.lineTo(c+bR(H-oe,0),h+Ce),oe-=H,oe>0&&t.lineTo(c,h+bR(Ce-oe,0));break e}g+=D}t.rect(c,h,H,Ce);break;case ir.Z:if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;t.lineTo(u*(1-N)+s*N,f*(1-N)+l*N);break e}g+=D}t.closePath(),u=s,f=l}}},e.prototype.clone=function(){var t=new e,r=this.data;return t.data=r.slice?r.slice():Array.prototype.slice.call(r),t._len=this._len,t},e.CMD=ir,e.initDefaultProps=function(){var t=e.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),e}();const Pu=Wve;function Th(e,t,r,n,i,a,o){if(i===0)return!1;var s=i,l=0,u=e;if(o>t+s&&o>n+s||o<t-s&&o<n-s||a>e+s&&a>r+s||a<e-s&&a<r-s)return!1;if(e!==r)l=(t-n)/(e-r),u=(e*n-r*t)/(e-r);else return Math.abs(a-e)<=s/2;var f=l*a-o+u,c=f*f/(l*l+1);return c<=s/2*s/2}function Uve(e,t,r,n,i,a,o,s,l,u,f){if(l===0)return!1;var c=l;if(f>t+c&&f>n+c&&f>a+c&&f>s+c||f<t-c&&f<n-c&&f<a-c&&f<s-c||u>e+c&&u>r+c&&u>i+c&&u>o+c||u<e-c&&u<r-c&&u<i-c&&u<o-c)return!1;var h=ade(e,t,r,n,i,a,o,s,u,f,null);return h<=c/2}function zve(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;if(l>t+u&&l>n+u&&l>a+u||l<t-u&&l<n-u&&l<a-u||s>e+u&&s>r+u&&s>i+u||s<e-u&&s<r-u&&s<i-u)return!1;var f=lde(e,t,r,n,i,a,s,l,null);return f<=u/2}var q4=Math.PI*2;function z_(e){return e%=q4,e<0&&(e+=q4),e}var Xg=Math.PI*2;function Gve(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;s-=e,l-=t;var f=Math.sqrt(s*s+l*l);if(f-u>r||f+u<r)return!1;if(Math.abs(n-i)%Xg<1e-4)return!0;if(a){var c=n;n=z_(i),i=z_(c)}else n=z_(n),i=z_(i);n>i&&(i+=Xg);var h=Math.atan2(l,s);return h<0&&(h+=Xg),h>=n&&h<=i||h+Xg>=n&&h+Xg<=i}function lf(e,t,r,n,i,a){if(a>t&&a>n||a<t&&a<n||n===t)return 0;var o=(a-t)/(n-t),s=n<t?1:-1;(o===1||o===0)&&(s=n<t?.5:-.5);var l=o*(r-e)+e;return l===i?1/0:l>i?s:0}var kl=Pu.CMD,uf=Math.PI*2,Yve=1e-4;function Kve(e,t){return Math.abs(e-t)<Yve}var li=[-1,-1,-1],ma=[-1,-1];function Xve(){var e=ma[0];ma[0]=ma[1],ma[1]=e}function qve(e,t,r,n,i,a,o,s,l,u){if(u>t&&u>n&&u>a&&u>s||u<t&&u<n&&u<a&&u<s)return 0;var f=zC(t,n,a,s,u,li);if(f===0)return 0;for(var c=0,h=-1,d=void 0,v=void 0,p=0;p<f;p++){var g=li[p],y=g===0||g===1?.5:1,m=mn(e,r,i,o,g);m<l||(h<0&&(h=gZ(t,n,a,s,ma),ma[1]<ma[0]&&h>1&&Xve(),d=mn(t,n,a,s,ma[0]),h>1&&(v=mn(t,n,a,s,ma[1]))),h===2?g<ma[0]?c+=d<t?y:-y:g<ma[1]?c+=v<d?y:-y:c+=s<v?y:-y:g<ma[0]?c+=d<t?y:-y:c+=s<d?y:-y)}return c}function Zve(e,t,r,n,i,a,o,s){if(s>t&&s>n&&s>a||s<t&&s<n&&s<a)return 0;var l=sde(t,n,a,s,li);if(l===0)return 0;var u=yZ(t,n,a);if(u>=0&&u<=1){for(var f=0,c=Hn(t,n,a,u),h=0;h<l;h++){var d=li[h]===0||li[h]===1?.5:1,v=Hn(e,r,i,li[h]);v<o||(li[h]<u?f+=c<t?d:-d:f+=a<c?d:-d)}return f}else{var d=li[0]===0||li[0]===1?.5:1,v=Hn(e,r,i,li[0]);return v<o?0:a<t?d:-d}}function Jve(e,t,r,n,i,a,o,s){if(s-=t,s>r||s<-r)return 0;var l=Math.sqrt(r*r-s*s);li[0]=-l,li[1]=l;var u=Math.abs(n-i);if(u<1e-4)return 0;if(u>=uf-1e-4){n=0,i=uf;var f=a?1:-1;return o>=li[0]+e&&o<=li[1]+e?f:0}if(n>i){var c=n;n=i,i=c}n<0&&(n+=uf,i+=uf);for(var h=0,d=0;d<2;d++){var v=li[d];if(v+e>o){var p=Math.atan2(s,v),f=a?1:-1;p<0&&(p=uf+p),(p>=n&&p<=i||p+uf>=n&&p+uf<=i)&&(p>Math.PI/2&&p<Math.PI*1.5&&(f=-f),h+=f)}}return h}function jZ(e,t,r,n,i){for(var a=e.data,o=e.len(),s=0,l=0,u=0,f=0,c=0,h,d,v=0;v<o;){var p=a[v++],g=v===1;switch(p===kl.M&&v>1&&(r||(s+=lf(l,u,f,c,n,i))),g&&(l=a[v],u=a[v+1],f=l,c=u),p){case kl.M:f=a[v++],c=a[v++],l=f,u=c;break;case kl.L:if(r){if(Th(l,u,a[v],a[v+1],t,n,i))return!0}else s+=lf(l,u,a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case kl.C:if(r){if(Uve(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=qve(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case kl.Q:if(r){if(zve(l,u,a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=Zve(l,u,a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case kl.A:var y=a[v++],m=a[v++],b=a[v++],_=a[v++],x=a[v++],T=a[v++];v+=1;var E=!!(1-a[v++]);h=Math.cos(x)*b+y,d=Math.sin(x)*_+m,g?(f=h,c=d):s+=lf(l,u,h,d,n,i);var P=(n-y)*_/b+y;if(r){if(Gve(y,m,_,x,x+T,E,t,P,i))return!0}else s+=Jve(y,m,_,x,x+T,E,P,i);l=Math.cos(x+T)*b+y,u=Math.sin(x+T)*_+m;break;case kl.R:f=l=a[v++],c=u=a[v++];var R=a[v++],M=a[v++];if(h=f+R,d=c+M,r){if(Th(f,c,h,c,t,n,i)||Th(h,c,h,d,t,n,i)||Th(h,d,f,d,t,n,i)||Th(f,d,f,c,t,n,i))return!0}else s+=lf(h,c,h,d,n,i),s+=lf(f,d,f,c,n,i);break;case kl.Z:if(r){if(Th(l,u,f,c,t,n,i))return!0}else s+=lf(l,u,f,c,n,i);l=f,u=c;break}}return!r&&!Kve(u,c)&&(s+=lf(l,u,f,c,n,i)||0),s!==0}function Qve(e,t,r){return jZ(e,0,!1,t,r)}function epe(e,t,r,n){return jZ(e,t,!0,r,n)}var WZ=lr({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},bc),tpe={style:lr({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},eO.style)},SR=qm.concat(["invisible","culling","z","z2","zlevel","parent"]),rpe=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.update=function(){var r=this;e.prototype.update.call(this);var n=this.style;if(n.decal){var i=this._decalEl=this._decalEl||new t;i.buildPath===t.prototype.buildPath&&(i.buildPath=function(l){r.buildPath(l,r.shape)}),i.silent=!0;var a=i.style;for(var o in n)a[o]!==n[o]&&(a[o]=n[o]);a.fill=n.fill?n.decal:null,a.decal=null,a.shadowColor=null,n.strokeFirst&&(a.stroke=null);for(var s=0;s<SR.length;++s)i[SR[s]]=this[SR[s]];i.__dirty|=qi}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(r){var n=Dr(r);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var a=0;a<n.length;a++){var o=n[a],s=r[o];o==="style"?this.style?Le(this.style,s):this.useStyle(s):o==="shape"?Le(this.shape,s):e.prototype.attrKV.call(this,o,s)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var r=this.style.fill;if(r!=="none"){if(st(r)){var n=KC(r,0);return n>.5?pI:n>.2?Dde:gI}else if(r)return gI}return pI},t.prototype.getInsideTextStroke=function(r){var n=this.style.fill;if(st(n)){var i=this.__zr,a=!!(i&&i.isDarkMode()),o=KC(r,0)<vI;if(a===o)return n}},t.prototype.buildPath=function(r,n,i){},t.prototype.pathUpdated=function(){this.__dirty&=~hd},t.prototype.getUpdatedPathProxy=function(r){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,r),this.path},t.prototype.createPathProxy=function(){this.path=new Pu(!1)},t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return!(n==null||n==="none"||!(r.lineWidth>0))},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.getBoundingRect=function(){var r=this._rect,n=this.style,i=!r;if(i){var a=!1;this.path||(a=!0,this.createPathProxy());var o=this.path;(a||this.__dirty&hd)&&(o.beginPath(),this.buildPath(o,this.shape,!1),this.pathUpdated()),r=o.getBoundingRect()}if(this._rect=r,this.hasStroke()&&this.path&&this.path.len()>0){var s=this._rectStroke||(this._rectStroke=r.clone());if(this.__dirty||i){s.copy(r);var l=n.strokeNoScale?this.getLineScale():1,u=n.lineWidth;if(!this.hasFill()){var f=this.strokeContainThreshold;u=Math.max(u,f??4)}l>1e-10&&(s.width+=u/l,s.height+=u/l,s.x-=u/l/2,s.y-=u/l/2)}return s}return r},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect(),o=this.style;if(r=i[0],n=i[1],a.contain(r,n)){var s=this.path;if(this.hasStroke()){var l=o.lineWidth,u=o.strokeNoScale?this.getLineScale():1;if(u>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),epe(s,l/u,r,n)))return!0}if(this.hasFill())return Qve(s,r,n)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=hd,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(r){return this.animate("shape",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():r==="shape"?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(r,n){r==="shape"?this.setShape(n):e.prototype.attrKV.call(this,r,n)},t.prototype.setShape=function(r,n){var i=this.shape;return i||(i=this.shape={}),typeof r=="string"?i[r]=n:Le(i,r),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&hd)},t.prototype.createStyle=function(r){return qT(WZ,r)},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.shape&&!n.shape&&(n.shape=Le({},this.shape))},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.shape?o?a?u=n.shape:(u=Le({},i.shape),Le(u,n.shape)):(u=Le({},a?this.shape:i.shape),Le(u,n.shape)):l&&(u=i.shape),u)if(o){this.shape=Le({},this.shape);for(var f={},c=Dr(u),h=0;h<c.length;h++){var d=c[h];typeof u[d]=="object"?this.shape[d]=u[d]:f[d]=u[d]}this._transitionState(r,{shape:f},s)}else this.shape=u,this.dirtyShape()},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.shape&&(i=i||{},this._mergeStyle(i,o.shape))}return i&&(n.shape=i),n},t.prototype.getAnimationStyleProps=function(){return tpe},t.prototype.isZeroArea=function(){return!1},t.extend=function(r){var n=function(a){Ye(o,a);function o(s){var l=a.call(this,s)||this;return r.init&&r.init.call(l,s),l}return o.prototype.getDefaultStyle=function(){return Qt(r.style)},o.prototype.getDefaultShape=function(){return Qt(r.shape)},o}(t);for(var i in r)typeof r[i]=="function"&&(n.prototype[i]=r[i]);return n},t.initDefaultProps=function(){var r=t.prototype;r.type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,r.__dirty=qi|jy|hd}(),t}(Rw);const cr=rpe;var npe=lr({strokeFirst:!0,font:kc,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},WZ),UZ=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return n!=null&&n!=="none"&&r.lineWidth>0},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.createStyle=function(r){return qT(npe,r)},t.prototype.setBoundingRect=function(r){this._rect=r},t.prototype.getBoundingRect=function(){var r=this.style;if(!this._rect){var n=r.text;n!=null?n+="":n="";var i=DN(n,r.font,r.textAlign,r.textBaseline);if(i.x+=r.x||0,i.y+=r.y||0,this.hasStroke()){var a=r.lineWidth;i.x-=a/2,i.y-=a/2,i.width+=a,i.height+=a}this._rect=i}return this._rect},t.initDefaultProps=function(){var r=t.prototype;r.dirtyRectTolerance=10}(),t}(Rw);UZ.prototype.type="tspan";const SI=UZ;var ipe=lr({x:0,y:0},bc),ape={style:lr({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},eO.style)};function ope(e){return!!(e&&typeof e!="string"&&e.width&&e.height)}var zZ=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.createStyle=function(r){return qT(ipe,r)},t.prototype._getSize=function(r){var n=this.style,i=n[r];if(i!=null)return i;var a=ope(n.image)?n.image:this.__image;if(!a)return 0;var o=r==="width"?"height":"width",s=n[o];return s==null?a[r]:a[r]/a[o]*s},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return ape},t.prototype.getBoundingRect=function(){var r=this.style;return this._rect||(this._rect=new or(r.x||0,r.y||0,this.getWidth(),this.getHeight())),this._rect},t}(Rw);zZ.prototype.type="image";const Zc=zZ;function spe(e,t){var r=t.x,n=t.y,i=t.width,a=t.height,o=t.r,s,l,u,f;i<0&&(r=r+i,i=-i),a<0&&(n=n+a,a=-a),typeof o=="number"?s=l=u=f=o:o instanceof Array?o.length===1?s=l=u=f=o[0]:o.length===2?(s=u=o[0],l=f=o[1]):o.length===3?(s=o[0],l=f=o[1],u=o[2]):(s=o[0],l=o[1],u=o[2],f=o[3]):s=l=u=f=0;var c;s+l>i&&(c=s+l,s*=i/c,l*=i/c),u+f>i&&(c=u+f,u*=i/c,f*=i/c),l+u>a&&(c=l+u,l*=a/c,u*=a/c),s+f>a&&(c=s+f,s*=a/c,f*=a/c),e.moveTo(r+s,n),e.lineTo(r+i-l,n),l!==0&&e.arc(r+i-l,n+l,l,-Math.PI/2,0),e.lineTo(r+i,n+a-u),u!==0&&e.arc(r+i-u,n+a-u,u,0,Math.PI/2),e.lineTo(r+f,n+a),f!==0&&e.arc(r+f,n+a-f,f,Math.PI/2,Math.PI),e.lineTo(r,n+s),s!==0&&e.arc(r+s,n+s,s,Math.PI,Math.PI*1.5)}var Cd=Math.round;function GZ(e,t,r){if(t){var n=t.x1,i=t.x2,a=t.y1,o=t.y2;e.x1=n,e.x2=i,e.y1=a,e.y2=o;var s=r&&r.lineWidth;return s&&(Cd(n*2)===Cd(i*2)&&(e.x1=e.x2=jf(n,s,!0)),Cd(a*2)===Cd(o*2)&&(e.y1=e.y2=jf(a,s,!0))),e}}function YZ(e,t,r){if(t){var n=t.x,i=t.y,a=t.width,o=t.height;e.x=n,e.y=i,e.width=a,e.height=o;var s=r&&r.lineWidth;return s&&(e.x=jf(n,s,!0),e.y=jf(i,s,!0),e.width=Math.max(jf(n+a,s,!1)-e.x,a===0?0:1),e.height=Math.max(jf(i+o,s,!1)-e.y,o===0?0:1)),e}}function jf(e,t,r){if(!t)return e;var n=Cd(e*2);return(n+Cd(t))%2===0?n/2:(n+(r?1:-1))/2}var lpe=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0}return e}(),upe={},KZ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new lpe},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=YZ(upe,n,this.style);i=l.x,a=l.y,o=l.width,s=l.height,l.r=n.r,n=l}else i=n.x,a=n.y,o=n.width,s=n.height;n.r?spe(r,n):r.rect(i,a,o,s)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(cr);KZ.prototype.type="rect";const _n=KZ;var Z4={fill:"#000"},J4=2,fpe={style:lr({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},eO.style)},XZ=function(e){Ye(t,e);function t(r){var n=e.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=Z4,n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var r=0;r<this._children.length;r++){var n=this._children[r];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},t.prototype.updateTransform=function(){var r=this.innerTransformable;r?(r.updateTransform(),r.transform&&(this.transform=r.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(r){var n=this.innerTransformable;return n?n.getLocalTransform(r):e.prototype.getLocalTransform.call(this,r)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,ppe(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=r},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var r=new or(0,0,0,0),n=this._children,i=[],a=null,o=0;o<n.length;o++){var s=n[o],l=s.getBoundingRect(),u=s.getLocalTransform(i);u?(r.copy(l),r.applyTransform(u),a=a||r.clone(),a.union(r)):(a=a||l.clone(),a.union(l))}this._rect=a||r}return this._rect},t.prototype.setDefaultTextStyle=function(r){this._defaultStyle=r||Z4},t.prototype.setTextContent=function(r){},t.prototype._mergeStyle=function(r,n){if(!n)return r;var i=n.rich,a=r.rich||i&&{};return Le(r,n),i&&a?(this._mergeRich(a,i),r.rich=a):a&&(r.rich=a),r},t.prototype._mergeRich=function(r,n){for(var i=Dr(n),a=0;a<i.length;a++){var o=i[a];r[o]=r[o]||{},Le(r[o],n[o])}},t.prototype.getAnimationStyleProps=function(){return fpe},t.prototype._getOrCreateChild=function(r){var n=this._children[this._childCursor];return(!n||!(n instanceof r))&&(n=new r),this._children[this._childCursor++]=n,n.__zr=this.__zr,n.parent=this,n},t.prototype._updatePlainTexts=function(){var r=this.style,n=r.font||kc,i=r.padding,a=aV(r),o=kve(a,r),s=CR(r),l=!!r.backgroundColor,u=o.outerHeight,f=o.outerWidth,c=o.contentWidth,h=o.lines,d=o.lineHeight,v=this._defaultStyle,p=r.x||0,g=r.y||0,y=r.align||v.align||"left",m=r.verticalAlign||v.verticalAlign||"top",b=p,_=dd(g,o.contentHeight,m);if(s||i){var x=Uy(p,f,y),T=dd(g,u,m);s&&this._renderBackground(r,r,x,T,f,u)}_+=d/2,i&&(b=iV(p,y,i),m==="top"?_+=i[0]:m==="bottom"&&(_-=i[2]));for(var E=0,P=!1,R=nV("fill"in r?r.fill:(P=!0,v.fill)),M=rV("stroke"in r?r.stroke:!l&&(!v.autoStroke||P)?(E=J4,v.stroke):null),D=r.textShadowBlur>0,N=r.width!=null&&(r.overflow==="truncate"||r.overflow==="break"||r.overflow==="breakAll"),B=o.calculatedLineHeight,K=0;K<h.length;K++){var Z=this._getOrCreateChild(SI),ie=Z.createStyle();Z.useStyle(ie),ie.text=h[K],ie.x=b,ie.y=_,y&&(ie.textAlign=y),ie.textBaseline="middle",ie.opacity=r.opacity,ie.strokeFirst=!0,D&&(ie.shadowBlur=r.textShadowBlur||0,ie.shadowColor=r.textShadowColor||"transparent",ie.shadowOffsetX=r.textShadowOffsetX||0,ie.shadowOffsetY=r.textShadowOffsetY||0),ie.stroke=M,ie.fill=R,M&&(ie.lineWidth=r.lineWidth||E,ie.lineDash=r.lineDash,ie.lineDashOffset=r.lineDashOffset||0),ie.font=n,eV(ie,r),_+=d,N&&Z.setBoundingRect(new or(Uy(ie.x,r.width,ie.textAlign),dd(ie.y,B,ie.textBaseline),c,B))}},t.prototype._updateRichTexts=function(){var r=this.style,n=aV(r),i=Ive(n,r),a=i.width,o=i.outerWidth,s=i.outerHeight,l=r.padding,u=r.x||0,f=r.y||0,c=this._defaultStyle,h=r.align||c.align,d=r.verticalAlign||c.verticalAlign,v=Uy(u,o,h),p=dd(f,s,d),g=v,y=p;l&&(g+=l[3],y+=l[0]);var m=g+a;CR(r)&&this._renderBackground(r,r,v,p,o,s);for(var b=!!r.backgroundColor,_=0;_<i.lines.length;_++){for(var x=i.lines[_],T=x.tokens,E=T.length,P=x.lineHeight,R=x.width,M=0,D=g,N=m,B=E-1,K=void 0;M<E&&(K=T[M],!K.align||K.align==="left");)this._placeToken(K,r,P,y,D,"left",b),R-=K.width,D+=K.width,M++;for(;B>=0&&(K=T[B],K.align==="right");)this._placeToken(K,r,P,y,N,"right",b),R-=K.width,N-=K.width,B--;for(D+=(a-(D-g)-(m-N)-R)/2;M<=B;)K=T[M],this._placeToken(K,r,P,y,D+K.width/2,"center",b),D+=K.width,M++;y+=P}},t.prototype._placeToken=function(r,n,i,a,o,s,l){var u=n.rich[r.styleName]||{};u.text=r.text;var f=r.verticalAlign,c=a+i/2;f==="top"?c=a+r.height/2:f==="bottom"&&(c=a+i-r.height/2);var h=!r.isLineHolder&&CR(u);h&&this._renderBackground(u,n,s==="right"?o-r.width:s==="center"?o-r.width/2:o,c-r.height/2,r.width,r.height);var d=!!u.backgroundColor,v=r.textPadding;v&&(o=iV(o,s,v),c-=r.height/2-v[0]-r.innerHeight/2);var p=this._getOrCreateChild(SI),g=p.createStyle();p.useStyle(g);var y=this._defaultStyle,m=!1,b=0,_=nV("fill"in u?u.fill:"fill"in n?n.fill:(m=!0,y.fill)),x=rV("stroke"in u?u.stroke:"stroke"in n?n.stroke:!d&&!l&&(!y.autoStroke||m)?(b=J4,y.stroke):null),T=u.textShadowBlur>0||n.textShadowBlur>0;g.text=r.text,g.x=o,g.y=c,T&&(g.shadowBlur=u.textShadowBlur||n.textShadowBlur||0,g.shadowColor=u.textShadowColor||n.textShadowColor||"transparent",g.shadowOffsetX=u.textShadowOffsetX||n.textShadowOffsetX||0,g.shadowOffsetY=u.textShadowOffsetY||n.textShadowOffsetY||0),g.textAlign=s,g.textBaseline="middle",g.font=r.font||kc,g.opacity=sm(u.opacity,n.opacity,1),eV(g,u),x&&(g.lineWidth=sm(u.lineWidth,n.lineWidth,b),g.lineDash=Xt(u.lineDash,n.lineDash),g.lineDashOffset=n.lineDashOffset||0,g.stroke=x),_&&(g.fill=_);var E=r.contentWidth,P=r.contentHeight;p.setBoundingRect(new or(Uy(g.x,E,g.textAlign),dd(g.y,P,g.textBaseline),E,P))},t.prototype._renderBackground=function(r,n,i,a,o,s){var l=r.backgroundColor,u=r.borderWidth,f=r.borderColor,c=l&&l.image,h=l&&!c,d=r.borderRadius,v=this,p,g;if(h||r.lineHeight||u&&f){p=this._getOrCreateChild(_n),p.useStyle(p.createStyle()),p.style.fill=null;var y=p.shape;y.x=i,y.y=a,y.width=o,y.height=s,y.r=d,p.dirtyShape()}if(h){var m=p.style;m.fill=l||null,m.fillOpacity=Xt(r.fillOpacity,1)}else if(c){g=this._getOrCreateChild(Zc),g.onload=function(){v.dirtyStyle()};var b=g.style;b.image=l.image,b.x=i,b.y=a,b.width=o,b.height=s}if(u&&f){var m=p.style;m.lineWidth=u,m.stroke=f,m.strokeOpacity=Xt(r.strokeOpacity,1),m.lineDash=r.borderDash,m.lineDashOffset=r.borderDashOffset||0,p.strokeContainThreshold=0,p.hasFill()&&p.hasStroke()&&(m.strokeFirst=!0,m.lineWidth*=2)}var _=(p||g).style;_.shadowBlur=r.shadowBlur||0,_.shadowColor=r.shadowColor||"transparent",_.shadowOffsetX=r.shadowOffsetX||0,_.shadowOffsetY=r.shadowOffsetY||0,_.opacity=sm(r.opacity,n.opacity,1)},t.makeFont=function(r){var n="";return vpe(r)&&(n=[r.fontStyle,r.fontWeight,dpe(r.fontSize),r.fontFamily||"sans-serif"].join(" ")),n&&Uo(n)||r.textFont||r.font},t}(Rw),cpe={left:!0,right:1,center:1},hpe={top:1,bottom:1,middle:1},Q4=["fontStyle","fontWeight","fontSize","fontFamily"];function dpe(e){return typeof e=="string"&&(e.indexOf("px")!==-1||e.indexOf("rem")!==-1||e.indexOf("em")!==-1)?e:isNaN(+e)?CN+"px":e+"px"}function eV(e,t){for(var r=0;r<Q4.length;r++){var n=Q4[r],i=t[n];i!=null&&(e[n]=i)}}function vpe(e){return e.fontSize!=null||e.fontFamily||e.fontWeight}function ppe(e){return tV(e),le(e.rich,tV),e}function tV(e){if(e){e.font=XZ.makeFont(e);var t=e.align;t==="middle"&&(t="center"),e.align=t==null||cpe[t]?t:"left";var r=e.verticalAlign;r==="center"&&(r="middle"),e.verticalAlign=r==null||hpe[r]?r:"top";var n=e.padding;n&&(e.padding=rZ(e.padding))}}function rV(e,t){return e==null||t<=0||e==="transparent"||e==="none"?null:e.image||e.colorStops?"#000":e}function nV(e){return e==null||e==="none"?null:e.image||e.colorStops?"#000":e}function iV(e,t,r){return t==="right"?e-r[1]:t==="center"?e+r[3]/2-r[1]/2:e+r[3]}function aV(e){var t=e.text;return t!=null&&(t+=""),t}function CR(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}const Xn=XZ;var ur=pn(),gpe=function(e,t,r,n){if(n){var i=ur(n);i.dataIndex=r,i.dataType=t,i.seriesIndex=e,n.type==="group"&&n.traverse(function(a){var o=ur(a);o.seriesIndex=e,o.dataIndex=r,o.dataType=t})}},oV=1,sV={},qZ=pn(),VN=pn(),jN=0,tO=1,rO=2,Aa=["emphasis","blur","select"],QC=["normal","emphasis","blur","select"],ype=10,mpe=9,wc="highlight",W1="downplay",cm="select",U1="unselect",hm="toggleSelect";function Oh(e){return e!=null&&e!=="none"}var lV=new Tw(100);function uV(e){if(st(e)){var t=lV.get(e);return t||(t=R4(e,-.1),lV.put(e,t)),t}else if(XT(e)){var r=Le({},e);return r.colorStops=pt(e.colorStops,function(n){return{offset:n.offset,color:R4(n.color,-.1)}}),r}return e}function nO(e,t,r){e.onHoverStateChange&&(e.hoverState||0)!==r&&e.onHoverStateChange(t),e.hoverState=r}function ZZ(e){nO(e,"emphasis",rO)}function JZ(e){e.hoverState===rO&&nO(e,"normal",jN)}function WN(e){nO(e,"blur",tO)}function QZ(e){e.hoverState===tO&&nO(e,"normal",jN)}function bpe(e){e.selected=!0}function wpe(e){e.selected=!1}function fV(e,t,r){t(e,r)}function bl(e,t,r){fV(e,t,r),e.isGroup&&e.traverse(function(n){fV(n,t,r)})}function cV(e,t){switch(t){case"emphasis":e.hoverState=rO;break;case"normal":e.hoverState=jN;break;case"blur":e.hoverState=tO;break;case"select":e.selected=!0}}function _pe(e,t,r,n){for(var i=e.style,a={},o=0;o<t.length;o++){var s=t[o],l=i[s];a[s]=l??(n&&n[s])}for(var o=0;o<e.animators.length;o++){var u=e.animators[o];u.__fromStateTransition&&u.__fromStateTransition.indexOf(r)<0&&u.targetName==="style"&&u.saveTo(a,t)}return a}function Spe(e,t,r,n){var i=r&&yr(r,"select")>=0,a=!1;if(e instanceof cr){var o=qZ(e),s=i&&o.selectFill||o.normalFill,l=i&&o.selectStroke||o.normalStroke;if(Oh(s)||Oh(l)){n=n||{};var u=n.style||{};u.fill==="inherit"?(a=!0,n=Le({},n),u=Le({},u),u.fill=s):!Oh(u.fill)&&Oh(s)?(a=!0,n=Le({},n),u=Le({},u),u.fill=uV(s)):!Oh(u.stroke)&&Oh(l)&&(a||(n=Le({},n),u=Le({},u)),u.stroke=uV(l)),n.style=u}}if(n&&n.z2==null){a||(n=Le({},n));var f=e.z2EmphasisLift;n.z2=e.z2+(f??ype)}return n}function Cpe(e,t,r){if(r&&r.z2==null){r=Le({},r);var n=e.z2SelectLift;r.z2=e.z2+(n??mpe)}return r}function xpe(e,t,r){var n=yr(e.currentStates,t)>=0,i=e.style.opacity,a=n?null:_pe(e,["opacity"],t,{opacity:1});r=r||{};var o=r.style||{};return o.opacity==null&&(r=Le({},r),o=Le({opacity:n?i:a.opacity*.1},o),r.style=o),r}function xR(e,t){var r=this.states[e];if(this.style){if(e==="emphasis")return Spe(this,e,t,r);if(e==="blur")return xpe(this,e,r);if(e==="select")return Cpe(this,e,r)}return r}function Tpe(e){e.stateProxy=xR;var t=e.getTextContent(),r=e.getTextGuideLine();t&&(t.stateProxy=xR),r&&(r.stateProxy=xR)}function hV(e,t){!nJ(e,t)&&!e.__highByOuter&&bl(e,ZZ)}function dV(e,t){!nJ(e,t)&&!e.__highByOuter&&bl(e,JZ)}function ex(e,t){e.__highByOuter|=1<<(t||0),bl(e,ZZ)}function tx(e,t){!(e.__highByOuter&=~(1<<(t||0)))&&bl(e,JZ)}function Ope(e){bl(e,WN)}function eJ(e){bl(e,QZ)}function tJ(e){bl(e,bpe)}function rJ(e){bl(e,wpe)}function nJ(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function iJ(e){var t=e.getModel(),r=[],n=[];t.eachComponent(function(i,a){var o=VN(a),s=i==="series",l=s?e.getViewOfSeriesModel(a):e.getViewOfComponentModel(a);!s&&n.push(l),o.isBlured&&(l.group.traverse(function(u){QZ(u)}),s&&r.push(a)),o.isBlured=!1}),le(n,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(r,!1,t)})}function CI(e,t,r,n){var i=n.getModel();r=r||"coordinateSystem";function a(u,f){for(var c=0;c<f.length;c++){var h=u.getItemGraphicEl(f[c]);h&&eJ(h)}}if(e!=null&&!(!t||t==="none")){var o=i.getSeriesByIndex(e),s=o.coordinateSystem;s&&s.master&&(s=s.master);var l=[];i.eachSeries(function(u){var f=o===u,c=u.coordinateSystem;c&&c.master&&(c=c.master);var h=c&&s?c===s:f;if(!(r==="series"&&!f||r==="coordinateSystem"&&!h||t==="series"&&f)){var d=n.getViewOfSeriesModel(u);if(d.group.traverse(function(g){WN(g)}),Ni(t))a(u.getData(),t);else if(dt(t))for(var v=Dr(t),p=0;p<v.length;p++)a(u.getData(v[p]),t[v[p]]);l.push(u),VN(u).isBlured=!0}}),i.eachComponent(function(u,f){if(u!=="series"){var c=n.getViewOfComponentModel(f);c&&c.toggleBlurSeries&&c.toggleBlurSeries(l,!0,i)}})}}function xI(e,t,r){if(!(e==null||t==null)){var n=r.getModel().getComponent(e,t);if(n){VN(n).isBlured=!0;var i=r.getViewOfComponentModel(n);!i||!i.focusBlurEnabled||i.group.traverse(function(a){WN(a)})}}}function Epe(e,t,r){var n=e.seriesIndex,i=e.getData(t.dataType);if(i){var a=Ac(i,t);a=(et(a)?a[0]:a)||0;var o=i.getItemGraphicEl(a);if(!o)for(var s=i.count(),l=0;!o&&l<s;)o=i.getItemGraphicEl(l++);if(o){var u=ur(o);CI(n,u.focus,u.blurScope,r)}else{var f=e.get(["emphasis","focus"]),c=e.get(["emphasis","blurScope"]);f!=null&&CI(n,f,c,r)}}}function UN(e,t,r,n){var i={focusSelf:!1,dispatchers:null};if(e==null||e==="series"||t==null||r==null)return i;var a=n.getModel().getComponent(e,t);if(!a)return i;var o=n.getViewOfComponentModel(a);if(!o||!o.findHighDownDispatchers)return i;for(var s=o.findHighDownDispatchers(r),l,u=0;u<s.length;u++)if(ur(s[u]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:s}}function Rpe(e,t,r){var n=ur(e),i=UN(n.componentMainType,n.componentIndex,n.componentHighDownName,r),a=i.dispatchers,o=i.focusSelf;a?(o&&xI(n.componentMainType,n.componentIndex,r),le(a,function(s){return hV(s,t)})):(CI(n.seriesIndex,n.focus,n.blurScope,r),n.focus==="self"&&xI(n.componentMainType,n.componentIndex,r),hV(e,t))}function kpe(e,t,r){iJ(r);var n=ur(e),i=UN(n.componentMainType,n.componentIndex,n.componentHighDownName,r).dispatchers;i?le(i,function(a){return dV(a,t)}):dV(e,t)}function Ape(e,t,r){if(EI(t)){var n=t.dataType,i=e.getData(n),a=Ac(i,t);et(a)||(a=[a]),e[t.type===hm?"toggleSelect":t.type===cm?"select":"unselect"](a,n)}}function vV(e){var t=e.getAllData();le(t,function(r){var n=r.data,i=r.type;n.eachItemGraphicEl(function(a,o){e.isSelected(o,i)?tJ(a):rJ(a)})})}function Ppe(e){var t=[];return e.eachSeries(function(r){var n=r.getAllData();le(n,function(i){i.data;var a=i.type,o=r.getSelectedDataIndices();if(o.length>0){var s={dataIndex:o,seriesIndex:r.seriesIndex};a!=null&&(s.dataType=a),t.push(s)}})}),t}function TI(e,t,r){aJ(e,!0),bl(e,Tpe),Mpe(e,t,r)}function Ipe(e){aJ(e,!1)}function Qm(e,t,r,n){n?Ipe(e):TI(e,t,r)}function Mpe(e,t,r){var n=ur(e);t!=null?(n.focus=t,n.blurScope=r):n.focus&&(n.focus=null)}var pV=["emphasis","blur","select"],Dpe={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function rx(e,t,r,n){r=r||"itemStyle";for(var i=0;i<pV.length;i++){var a=pV[i],o=t.getModel([a,r]),s=e.ensureState(a);s.style=n?n(o):o[Dpe[r]]()}}function aJ(e,t){var r=t===!1,n=e;e.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=e.highDownSilentOnTouch),(!r||n.__highDownDispatcher)&&(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!r)}function OI(e){return!!(e&&e.__highDownDispatcher)}function $pe(e){var t=sV[e];return t==null&&oV<=32&&(t=sV[e]=oV++),t}function EI(e){var t=e.type;return t===cm||t===U1||t===hm}function gV(e){var t=e.type;return t===wc||t===W1}function Npe(e){var t=qZ(e);t.normalFill=e.style.fill,t.normalStroke=e.style.stroke;var r=e.states.select||{};t.selectFill=r.style&&r.style.fill||null,t.selectStroke=r.style&&r.style.stroke||null}var Eh=Pu.CMD,Lpe=[[],[],[]],yV=Math.sqrt,Fpe=Math.atan2;function Hpe(e,t){if(t){var r=e.data,n=e.len(),i,a,o,s,l,u,f=Eh.M,c=Eh.C,h=Eh.L,d=Eh.R,v=Eh.A,p=Eh.Q;for(o=0,s=0;o<n;){switch(i=r[o++],s=o,a=0,i){case f:a=1;break;case h:a=1;break;case c:a=3;break;case p:a=2;break;case v:var g=t[4],y=t[5],m=yV(t[0]*t[0]+t[1]*t[1]),b=yV(t[2]*t[2]+t[3]*t[3]),_=Fpe(-t[1]/b,t[0]/m);r[o]*=m,r[o++]+=g,r[o]*=b,r[o++]+=y,r[o++]*=m,r[o++]*=b,r[o++]+=_,r[o++]+=_,o+=2,s=o;break;case d:u[0]=r[o++],u[1]=r[o++],Ra(u,u,t),r[s++]=u[0],r[s++]=u[1],u[0]+=r[o++],u[1]+=r[o++],Ra(u,u,t),r[s++]=u[0],r[s++]=u[1]}for(l=0;l<a;l++){var x=Lpe[l];x[0]=r[o++],x[1]=r[o++],Ra(x,x,t),r[s++]=x[0],r[s++]=x[1]}}e.increaseVersion()}}var TR=Math.sqrt,G_=Math.sin,Y_=Math.cos,qg=Math.PI;function mV(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function RI(e,t){return(e[0]*t[0]+e[1]*t[1])/(mV(e)*mV(t))}function bV(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(RI(e,t))}function wV(e,t,r,n,i,a,o,s,l,u,f){var c=l*(qg/180),h=Y_(c)*(e-r)/2+G_(c)*(t-n)/2,d=-1*G_(c)*(e-r)/2+Y_(c)*(t-n)/2,v=h*h/(o*o)+d*d/(s*s);v>1&&(o*=TR(v),s*=TR(v));var p=(i===a?-1:1)*TR((o*o*(s*s)-o*o*(d*d)-s*s*(h*h))/(o*o*(d*d)+s*s*(h*h)))||0,g=p*o*d/s,y=p*-s*h/o,m=(e+r)/2+Y_(c)*g-G_(c)*y,b=(t+n)/2+G_(c)*g+Y_(c)*y,_=bV([1,0],[(h-g)/o,(d-y)/s]),x=[(h-g)/o,(d-y)/s],T=[(-1*h-g)/o,(-1*d-y)/s],E=bV(x,T);if(RI(x,T)<=-1&&(E=qg),RI(x,T)>=1&&(E=0),E<0){var P=Math.round(E/qg*1e6)/1e6;E=qg*2+P%2*qg}f.addData(u,m,b,o,s,_,E,c,a)}var Bpe=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,Vpe=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function jpe(e){var t=new Pu;if(!e)return t;var r=0,n=0,i=r,a=n,o,s=Pu.CMD,l=e.match(Bpe);if(!l)return t;for(var u=0;u<l.length;u++){for(var f=l[u],c=f.charAt(0),h=void 0,d=f.match(Vpe)||[],v=d.length,p=0;p<v;p++)d[p]=parseFloat(d[p]);for(var g=0;g<v;){var y=void 0,m=void 0,b=void 0,_=void 0,x=void 0,T=void 0,E=void 0,P=r,R=n,M=void 0,D=void 0;switch(c){case"l":r+=d[g++],n+=d[g++],h=s.L,t.addData(h,r,n);break;case"L":r=d[g++],n=d[g++],h=s.L,t.addData(h,r,n);break;case"m":r+=d[g++],n+=d[g++],h=s.M,t.addData(h,r,n),i=r,a=n,c="l";break;case"M":r=d[g++],n=d[g++],h=s.M,t.addData(h,r,n),i=r,a=n,c="L";break;case"h":r+=d[g++],h=s.L,t.addData(h,r,n);break;case"H":r=d[g++],h=s.L,t.addData(h,r,n);break;case"v":n+=d[g++],h=s.L,t.addData(h,r,n);break;case"V":n=d[g++],h=s.L,t.addData(h,r,n);break;case"C":h=s.C,t.addData(h,d[g++],d[g++],d[g++],d[g++],d[g++],d[g++]),r=d[g-2],n=d[g-1];break;case"c":h=s.C,t.addData(h,d[g++]+r,d[g++]+n,d[g++]+r,d[g++]+n,d[g++]+r,d[g++]+n),r+=d[g-2],n+=d[g-1];break;case"S":y=r,m=n,M=t.len(),D=t.data,o===s.C&&(y+=r-D[M-4],m+=n-D[M-3]),h=s.C,P=d[g++],R=d[g++],r=d[g++],n=d[g++],t.addData(h,y,m,P,R,r,n);break;case"s":y=r,m=n,M=t.len(),D=t.data,o===s.C&&(y+=r-D[M-4],m+=n-D[M-3]),h=s.C,P=r+d[g++],R=n+d[g++],r+=d[g++],n+=d[g++],t.addData(h,y,m,P,R,r,n);break;case"Q":P=d[g++],R=d[g++],r=d[g++],n=d[g++],h=s.Q,t.addData(h,P,R,r,n);break;case"q":P=d[g++]+r,R=d[g++]+n,r+=d[g++],n+=d[g++],h=s.Q,t.addData(h,P,R,r,n);break;case"T":y=r,m=n,M=t.len(),D=t.data,o===s.Q&&(y+=r-D[M-4],m+=n-D[M-3]),r=d[g++],n=d[g++],h=s.Q,t.addData(h,y,m,r,n);break;case"t":y=r,m=n,M=t.len(),D=t.data,o===s.Q&&(y+=r-D[M-4],m+=n-D[M-3]),r+=d[g++],n+=d[g++],h=s.Q,t.addData(h,y,m,r,n);break;case"A":b=d[g++],_=d[g++],x=d[g++],T=d[g++],E=d[g++],P=r,R=n,r=d[g++],n=d[g++],h=s.A,wV(P,R,r,n,T,E,b,_,x,h,t);break;case"a":b=d[g++],_=d[g++],x=d[g++],T=d[g++],E=d[g++],P=r,R=n,r+=d[g++],n+=d[g++],h=s.A,wV(P,R,r,n,T,E,b,_,x,h,t);break}}(c==="z"||c==="Z")&&(h=s.Z,t.addData(h),r=i,n=a),o=h}return t.toStatic(),t}var oJ=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.applyTransform=function(r){},t}(cr);function sJ(e){return e.setData!=null}function lJ(e,t){var r=jpe(e),n=Le({},t);return n.buildPath=function(i){if(sJ(i)){i.setData(r.data);var a=i.getContext();a&&i.rebuildPath(a,1)}else{var a=i;r.rebuildPath(a,1)}},n.applyTransform=function(i){Hpe(r,i),this.dirtyShape()},n}function Wpe(e,t){return new oJ(lJ(e,t))}function Upe(e,t){var r=lJ(e,t),n=function(i){Ye(a,i);function a(o){var s=i.call(this,o)||this;return s.applyTransform=r.applyTransform,s.buildPath=r.buildPath,s}return a}(oJ);return n}function zpe(e,t){for(var r=[],n=e.length,i=0;i<n;i++){var a=e[i];r.push(a.getUpdatedPathProxy(!0))}var o=new cr(t);return o.createPathProxy(),o.buildPath=function(s){if(sJ(s)){s.appendPath(r);var l=s.getContext();l&&s.rebuildPath(l,1)}},o}var Gpe=function(){function e(){this.cx=0,this.cy=0,this.r=0}return e}(),uJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new Gpe},t.prototype.buildPath=function(r,n){r.moveTo(n.cx+n.r,n.cy),r.arc(n.cx,n.cy,n.r,0,Math.PI*2)},t}(cr);uJ.prototype.type="circle";const zN=uJ;var Ype=function(){function e(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return e}(),fJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new Ype},t.prototype.buildPath=function(r,n){var i=.5522848,a=n.cx,o=n.cy,s=n.rx,l=n.ry,u=s*i,f=l*i;r.moveTo(a-s,o),r.bezierCurveTo(a-s,o-f,a-u,o-l,a,o-l),r.bezierCurveTo(a+u,o-l,a+s,o-f,a+s,o),r.bezierCurveTo(a+s,o+f,a+u,o+l,a,o+l),r.bezierCurveTo(a-u,o+l,a-s,o+f,a-s,o),r.closePath()},t}(cr);fJ.prototype.type="ellipse";const cJ=fJ;var hJ=Math.PI,OR=hJ*2,ff=Math.sin,Rh=Math.cos,Kpe=Math.acos,Nn=Math.atan2,_V=Math.abs,dm=Math.sqrt,zy=Math.max,xo=Math.min,Ka=1e-4;function Xpe(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=c*l-f*u;if(!(h*h<Ka))return h=(f*(t-a)-c*(e-i))/h,[e+h*l,t+h*u]}function K_(e,t,r,n,i,a,o){var s=e-r,l=t-n,u=(o?a:-a)/dm(s*s+l*l),f=u*l,c=-u*s,h=e+f,d=t+c,v=r+f,p=n+c,g=(h+v)/2,y=(d+p)/2,m=v-h,b=p-d,_=m*m+b*b,x=i-a,T=h*p-v*d,E=(b<0?-1:1)*dm(zy(0,x*x*_-T*T)),P=(T*b-m*E)/_,R=(-T*m-b*E)/_,M=(T*b+m*E)/_,D=(-T*m+b*E)/_,N=P-g,B=R-y,K=M-g,Z=D-y;return N*N+B*B>K*K+Z*Z&&(P=M,R=D),{cx:P,cy:R,x0:-f,y0:-c,x1:P*(i/x-1),y1:R*(i/x-1)}}function qpe(e){var t;if(et(e)){var r=e.length;if(!r)return e;r===1?t=[e[0],e[0],0,0]:r===2?t=[e[0],e[0],e[1],e[1]]:r===3?t=e.concat(e[2]):t=e}else t=[e,e,e,e];return t}function Zpe(e,t){var r,n=zy(t.r,0),i=zy(t.r0||0,0),a=n>0,o=i>0;if(!(!a&&!o)){if(a||(n=i,i=0),i>n){var s=n;n=i,i=s}var l=t.startAngle,u=t.endAngle;if(!(isNaN(l)||isNaN(u))){var f=t.cx,c=t.cy,h=!!t.clockwise,d=_V(u-l),v=d>OR&&d%OR;if(v>Ka&&(d=v),!(n>Ka))e.moveTo(f,c);else if(d>OR-Ka)e.moveTo(f+n*Rh(l),c+n*ff(l)),e.arc(f,c,n,l,u,!h),i>Ka&&(e.moveTo(f+i*Rh(u),c+i*ff(u)),e.arc(f,c,i,u,l,h));else{var p=void 0,g=void 0,y=void 0,m=void 0,b=void 0,_=void 0,x=void 0,T=void 0,E=void 0,P=void 0,R=void 0,M=void 0,D=void 0,N=void 0,B=void 0,K=void 0,Z=n*Rh(l),ie=n*ff(l),me=i*Rh(u),k=i*ff(u),w=d>Ka;if(w){var C=t.cornerRadius;C&&(r=qpe(C),p=r[0],g=r[1],y=r[2],m=r[3]);var O=_V(n-i)/2;if(b=xo(O,y),_=xo(O,m),x=xo(O,p),T=xo(O,g),R=E=zy(b,_),M=P=zy(x,T),(E>Ka||P>Ka)&&(D=n*Rh(u),N=n*ff(u),B=i*Rh(l),K=i*ff(l),d<hJ)){var S=Xpe(Z,ie,B,K,D,N,me,k);if(S){var A=Z-S[0],I=ie-S[1],L=D-S[0],V=N-S[1],Y=1/ff(Kpe((A*L+I*V)/(dm(A*A+I*I)*dm(L*L+V*V)))/2),ae=dm(S[0]*S[0]+S[1]*S[1]);R=xo(E,(n-ae)/(Y+1)),M=xo(P,(i-ae)/(Y-1))}}}if(!w)e.moveTo(f+Z,c+ie);else if(R>Ka){var re=xo(y,R),te=xo(m,R),ge=K_(B,K,Z,ie,n,re,h),H=K_(D,N,me,k,n,te,h);e.moveTo(f+ge.cx+ge.x0,c+ge.cy+ge.y0),R<E&&re===te?e.arc(f+ge.cx,c+ge.cy,R,Nn(ge.y0,ge.x0),Nn(H.y0,H.x0),!h):(re>0&&e.arc(f+ge.cx,c+ge.cy,re,Nn(ge.y0,ge.x0),Nn(ge.y1,ge.x1),!h),e.arc(f,c,n,Nn(ge.cy+ge.y1,ge.cx+ge.x1),Nn(H.cy+H.y1,H.cx+H.x1),!h),te>0&&e.arc(f+H.cx,c+H.cy,te,Nn(H.y1,H.x1),Nn(H.y0,H.x0),!h))}else e.moveTo(f+Z,c+ie),e.arc(f,c,n,l,u,!h);if(!(i>Ka)||!w)e.lineTo(f+me,c+k);else if(M>Ka){var re=xo(p,M),te=xo(g,M),ge=K_(me,k,D,N,i,-te,h),H=K_(Z,ie,B,K,i,-re,h);e.lineTo(f+ge.cx+ge.x0,c+ge.cy+ge.y0),M<P&&re===te?e.arc(f+ge.cx,c+ge.cy,M,Nn(ge.y0,ge.x0),Nn(H.y0,H.x0),!h):(te>0&&e.arc(f+ge.cx,c+ge.cy,te,Nn(ge.y0,ge.x0),Nn(ge.y1,ge.x1),!h),e.arc(f,c,i,Nn(ge.cy+ge.y1,ge.cx+ge.x1),Nn(H.cy+H.y1,H.cx+H.x1),h),re>0&&e.arc(f+H.cx,c+H.cy,re,Nn(H.y1,H.x1),Nn(H.y0,H.x0),!h))}else e.lineTo(f+me,c+k),e.arc(f,c,i,u,l,h)}e.closePath()}}}var Jpe=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return e}(),dJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new Jpe},t.prototype.buildPath=function(r,n){Zpe(r,n)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(cr);dJ.prototype.type="sector";const Jc=dJ;var Qpe=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return e}(),vJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new Qpe},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.PI*2;r.moveTo(i+n.r,a),r.arc(i,a,n.r,0,o,!1),r.moveTo(i+n.r0,a),r.arc(i,a,n.r0,0,o,!0)},t}(cr);vJ.prototype.type="ring";const pJ=vJ;function ege(e,t,r,n){var i=[],a=[],o=[],s=[],l,u,f,c;if(n){f=[1/0,1/0],c=[-1/0,-1/0];for(var h=0,d=e.length;h<d;h++)wd(f,f,e[h]),_d(c,c,e[h]);wd(f,f,n[0]),_d(c,c,n[1])}for(var h=0,d=e.length;h<d;h++){var v=e[h];if(r)l=e[h?h-1:d-1],u=e[(h+1)%d];else if(h===0||h===d-1){i.push(She(e[h]));continue}else l=e[h-1],u=e[h+1];Che(a,u,l),WE(a,a,t);var p=eI(v,l),g=eI(v,u),y=p+g;y!==0&&(p/=y,g/=y),WE(o,a,-p),WE(s,a,g);var m=d4([],v,o),b=d4([],v,s);n&&(_d(m,m,f),wd(m,m,c),_d(b,b,f),wd(b,b,c)),i.push(m),i.push(b)}return r&&i.push(i.shift()),i}function gJ(e,t,r){var n=t.smooth,i=t.points;if(i&&i.length>=2){if(n){var a=ege(i,n,r,t.smoothConstraint);e.moveTo(i[0][0],i[0][1]);for(var o=i.length,s=0;s<(r?o:o-1);s++){var l=a[s*2],u=a[s*2+1],f=i[(s+1)%o];e.bezierCurveTo(l[0],l[1],u[0],u[1],f[0],f[1])}}else{e.moveTo(i[0][0],i[0][1]);for(var s=1,c=i.length;s<c;s++)e.lineTo(i[s][0],i[s][1])}r&&e.closePath()}}var tge=function(){function e(){this.points=null,this.smooth=0,this.smoothConstraint=null}return e}(),yJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new tge},t.prototype.buildPath=function(r,n){gJ(r,n,!0)},t}(cr);yJ.prototype.type="polygon";const mJ=yJ;var rge=function(){function e(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return e}(),bJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new rge},t.prototype.buildPath=function(r,n){gJ(r,n,!1)},t}(cr);bJ.prototype.type="polyline";const iO=bJ;var nge={},ige=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return e}(),wJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new ige},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=GZ(nge,n,this.style);i=l.x1,a=l.y1,o=l.x2,s=l.y2}else i=n.x1,a=n.y1,o=n.x2,s=n.y2;var u=n.percent;u!==0&&(r.moveTo(i,a),u<1&&(o=i*(1-u)+o*u,s=a*(1-u)+s*u),r.lineTo(o,s))},t.prototype.pointAt=function(r){var n=this.shape;return[n.x1*(1-r)+n.x2*r,n.y1*(1-r)+n.y2*r]},t}(cr);wJ.prototype.type="line";const Pc=wJ;var xi=[],age=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return e}();function SV(e,t,r){var n=e.cpx2,i=e.cpy2;return n!=null||i!=null?[(r?x4:mn)(e.x1,e.cpx1,e.cpx2,e.x2,t),(r?x4:mn)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(r?T4:Hn)(e.x1,e.cpx1,e.x2,t),(r?T4:Hn)(e.y1,e.cpy1,e.y2,t)]}var _J=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new age},t.prototype.buildPath=function(r,n){var i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.cpx1,u=n.cpy1,f=n.cpx2,c=n.cpy2,h=n.percent;h!==0&&(r.moveTo(i,a),f==null||c==null?(h<1&&(YC(i,l,o,h,xi),l=xi[1],o=xi[2],YC(a,u,s,h,xi),u=xi[1],s=xi[2]),r.quadraticCurveTo(l,u,o,s)):(h<1&&(GC(i,l,f,o,h,xi),l=xi[1],f=xi[2],o=xi[3],GC(a,u,c,s,h,xi),u=xi[1],c=xi[2],s=xi[3]),r.bezierCurveTo(l,u,f,c,o,s)))},t.prototype.pointAt=function(r){return SV(this.shape,r,!1)},t.prototype.tangentAt=function(r){var n=SV(this.shape,r,!0);return Ohe(n,n)},t}(cr);_J.prototype.type="bezier-curve";const SJ=_J;var oge=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),CJ=function(e){Ye(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new oge},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r,0),s=n.startAngle,l=n.endAngle,u=n.clockwise,f=Math.cos(s),c=Math.sin(s);r.moveTo(f*o+i,c*o+a),r.arc(i,a,o,s,l,!u)},t}(cr);CJ.prototype.type="arc";const GN=CJ;var sge=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="compound",r}return t.prototype._updatePathDirty=function(){for(var r=this.shape.paths,n=this.shapeChanged(),i=0;i<r.length;i++)n=n||r[i].shapeChanged();n&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var r=this.shape.paths||[],n=this.getGlobalScale(),i=0;i<r.length;i++)r[i].path||r[i].createPathProxy(),r[i].path.setScale(n[0],n[1],r[i].segmentIgnoreThreshold)},t.prototype.buildPath=function(r,n){for(var i=n.paths||[],a=0;a<i.length;a++)i[a].buildPath(r,i[a].shape,!0)},t.prototype.afterBrush=function(){for(var r=this.shape.paths||[],n=0;n<r.length;n++)r[n].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),cr.prototype.getBoundingRect.call(this)},t}(cr);const lge=sge;var uge=function(){function e(t){this.colorStops=t||[]}return e.prototype.addColorStop=function(t,r){this.colorStops.push({offset:t,color:r})},e}();const xJ=uge;var fge=function(e){Ye(t,e);function t(r,n,i,a,o,s){var l=e.call(this,o)||this;return l.x=r??0,l.y=n??0,l.x2=i??1,l.y2=a??0,l.type="linear",l.global=s||!1,l}return t}(xJ);const TJ=fge;var cge=function(e){Ye(t,e);function t(r,n,i,a,o){var s=e.call(this,a)||this;return s.x=r??.5,s.y=n??.5,s.r=i??.5,s.type="radial",s.global=o||!1,s}return t}(xJ);const hge=cge;var cf=[0,0],hf=[0,0],X_=new St,q_=new St,dge=function(){function e(t,r){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new St;for(var n=0;n<2;n++)this._axes[n]=new St;t&&this.fromBoundingRect(t,r)}return e.prototype.fromBoundingRect=function(t,r){var n=this._corners,i=this._axes,a=t.x,o=t.y,s=a+t.width,l=o+t.height;if(n[0].set(a,o),n[1].set(s,o),n[2].set(s,l),n[3].set(a,l),r)for(var u=0;u<4;u++)n[u].transform(r);St.sub(i[0],n[1],n[0]),St.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(var u=0;u<2;u++)this._origin[u]=i[u].dot(n[0])},e.prototype.intersect=function(t,r){var n=!0,i=!r;return X_.set(1/0,1/0),q_.set(0,0),!this._intersectCheckOneSide(this,t,X_,q_,i,1)&&(n=!1,i)||!this._intersectCheckOneSide(t,this,X_,q_,i,-1)&&(n=!1,i)||i||St.copy(r,n?X_:q_),n},e.prototype._intersectCheckOneSide=function(t,r,n,i,a,o){for(var s=!0,l=0;l<2;l++){var u=this._axes[l];if(this._getProjMinMaxOnAxis(l,t._corners,cf),this._getProjMinMaxOnAxis(l,r._corners,hf),cf[1]<hf[0]||cf[0]>hf[1]){if(s=!1,a)return s;var f=Math.abs(hf[0]-cf[1]),c=Math.abs(cf[0]-hf[1]);Math.min(f,c)>i.len()&&(f<c?St.scale(i,u,-f*o):St.scale(i,u,c*o))}else if(n){var f=Math.abs(hf[0]-cf[1]),c=Math.abs(cf[0]-hf[1]);Math.min(f,c)<n.len()&&(f<c?St.scale(n,u,f*o):St.scale(n,u,-c*o))}}return s},e.prototype._getProjMinMaxOnAxis=function(t,r,n){for(var i=this._axes[t],a=this._origin,o=r[0].dot(i)+a[t],s=o,l=o,u=1;u<r.length;u++){var f=r[u].dot(i)+a[t];s=Math.min(f,s),l=Math.max(f,l)}n[0]=s,n[1]=l},e}();const nx=dge;var vge=[],pge=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.notClear=!0,r.incremental=!0,r._displayables=[],r._temporaryDisplayables=[],r._cursor=0,r}return t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(r,n){n?this._temporaryDisplayables.push(r):this._displayables.push(r),this.markRedraw()},t.prototype.addDisplayables=function(r,n){n=n||!1;for(var i=0;i<r.length;i++)this.addDisplayable(r[i],n)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(r){for(var n=this._cursor;n<this._displayables.length;n++)r&&r(this._displayables[n]);for(var n=0;n<this._temporaryDisplayables.length;n++)r&&r(this._temporaryDisplayables[n])},t.prototype.update=function(){this.updateTransform();for(var r=this._cursor;r<this._displayables.length;r++){var n=this._displayables[r];n.parent=this,n.update(),n.parent=null}for(var r=0;r<this._temporaryDisplayables.length;r++){var n=this._temporaryDisplayables[r];n.parent=this,n.update(),n.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var r=new or(1/0,1/0,-1/0,-1/0),n=0;n<this._displayables.length;n++){var i=this._displayables[n],a=i.getBoundingRect().clone();i.needLocalTransform()&&a.applyTransform(i.getLocalTransform(vge)),r.union(a)}this._rect=r}return this._rect},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(a.contain(i[0],i[1]))for(var o=0;o<this._displayables.length;o++){var s=this._displayables[o];if(s.contain(r,n))return!0}return!1},t}(Rw);const gge=pge;var yge=pn();function mge(e,t,r,n,i){var a;if(t&&t.ecModel){var o=t.ecModel.getUpdatePayload();a=o&&o.animation}var s=t&&t.isAnimationEnabled(),l=e==="update";if(s){var u=void 0,f=void 0,c=void 0;n?(u=Xt(n.duration,200),f=Xt(n.easing,"cubicOut"),c=0):(u=t.getShallow(l?"animationDurationUpdate":"animationDuration"),f=t.getShallow(l?"animationEasingUpdate":"animationEasing"),c=t.getShallow(l?"animationDelayUpdate":"animationDelay")),a&&(a.duration!=null&&(u=a.duration),a.easing!=null&&(f=a.easing),a.delay!=null&&(c=a.delay)),Nt(c)&&(c=c(r,i)),Nt(u)&&(u=u(r));var h={duration:u||0,delay:c,easing:f};return h}else return null}function YN(e,t,r,n,i,a,o){var s=!1,l;Nt(i)?(o=a,a=i,i=null):dt(i)&&(a=i.cb,o=i.during,s=i.isFrom,l=i.removeOpt,i=i.dataIndex);var u=e==="leave";u||t.stopAnimation("leave");var f=mge(e,n,i,u?l||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(t,i):null);if(f&&f.duration>0){var c=f.duration,h=f.delay,d=f.easing,v={duration:c,delay:h||0,easing:d,done:a,force:!!a||!!o,setToFinal:!u,scope:e,during:o};s?t.animateFrom(r,v):t.animateTo(r,v)}else t.stopAnimation(),!s&&t.attr(r),o&&o(1),a&&a()}function mi(e,t,r,n,i,a){YN("update",e,t,r,n,i,a)}function ka(e,t,r,n,i,a){YN("enter",e,t,r,n,i,a)}function vm(e){if(!e.__zr)return!0;for(var t=0;t<e.animators.length;t++){var r=e.animators[t];if(r.scope==="leave")return!0}return!1}function ix(e,t,r,n,i,a){vm(e)||YN("leave",e,t,r,n,i,a)}function CV(e,t,r,n){e.removeTextContent(),e.removeTextGuideLine(),ix(e,{style:{opacity:0}},t,r,n)}function ax(e,t,r){function n(){e.parent&&e.parent.remove(e)}e.isGroup?e.traverse(function(i){i.isGroup||CV(i,t,r,n)}):CV(e,t,r,n)}function KN(e){yge(e).oldStyle=e.style}var ox=Math.max,sx=Math.min,kI={};function bge(e){return cr.extend(e)}var wge=Upe;function _ge(e,t){return wge(e,t)}function yo(e,t){kI[e]=t}function Sge(e){if(kI.hasOwnProperty(e))return kI[e]}function XN(e,t,r,n){var i=Wpe(e,t);return r&&(n==="center"&&(r=EJ(r,i.getBoundingRect())),RJ(i,r)),i}function OJ(e,t,r){var n=new Zc({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(i){if(r==="center"){var a={width:i.width,height:i.height};n.setStyle(EJ(t,a))}}});return n}function EJ(e,t){var r=t.width/t.height,n=e.height*r,i;n<=e.width?i=e.height:(n=e.width,i=n/r);var a=e.x+e.width/2,o=e.y+e.height/2;return{x:a-n/2,y:o-i/2,width:n,height:i}}var Cge=zpe;function RJ(e,t){if(e.applyTransform){var r=e.getBoundingRect(),n=r.calculateTransform(t);e.applyTransform(n)}}function e0(e,t){return GZ(e,e,{lineWidth:t}),e}function xge(e){return YZ(e.shape,e.shape,e.style),e}var Tge=jf;function Oge(e,t){for(var r=kN([]);e&&e!==t;)Dd(r,e.getLocalTransform(),r),e=e.parent;return r}function qN(e,t,r){return t&&!Ni(t)&&(t=MN.getLocalTransform(t)),r&&(t=PN([],t)),Ra([],e,t)}function Ege(e,t,r){var n=t[4]===0||t[5]===0||t[0]===0?1:Math.abs(2*t[4]/t[0]),i=t[4]===0||t[5]===0||t[2]===0?1:Math.abs(2*t[4]/t[2]),a=[e==="left"?-n:e==="right"?n:0,e==="top"?-i:e==="bottom"?i:0];return a=qN(a,t,r),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function xV(e){return!e.isGroup}function Rge(e){return e.shape!=null}function kJ(e,t,r){if(!e||!t)return;function n(o){var s={};return o.traverse(function(l){xV(l)&&l.anid&&(s[l.anid]=l)}),s}function i(o){var s={x:o.x,y:o.y,rotation:o.rotation};return Rge(o)&&(s.shape=Le({},o.shape)),s}var a=n(e);t.traverse(function(o){if(xV(o)&&o.anid){var s=a[o.anid];if(s){var l=i(o);o.attr(i(s)),mi(o,l,r,ur(o).dataIndex)}}})}function kge(e,t){return pt(e,function(r){var n=r[0];n=ox(n,t.x),n=sx(n,t.x+t.width);var i=r[1];return i=ox(i,t.y),i=sx(i,t.y+t.height),[n,i]})}function Age(e,t){var r=ox(e.x,t.x),n=sx(e.x+e.width,t.x+t.width),i=ox(e.y,t.y),a=sx(e.y+e.height,t.y+t.height);if(n>=r&&a>=i)return{x:r,y:i,width:n-r,height:a-i}}function ZN(e,t,r){var n=Le({rectHover:!0},t),i=n.style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},e)return e.indexOf("image://")===0?(i.image=e.slice(8),lr(i,r),new Zc(n)):XN(e.replace("path://",""),n,r,"center")}function Pge(e,t,r,n,i){for(var a=0,o=i[i.length-1];a<i.length;a++){var s=i[a];if(AJ(e,t,r,n,s[0],s[1],o[0],o[1]))return!0;o=s}}function AJ(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=ER(f,c,l,u);if(Ige(h))return!1;var d=e-i,v=t-a,p=ER(d,v,l,u)/h;if(p<0||p>1)return!1;var g=ER(d,v,f,c)/h;return!(g<0||g>1)}function ER(e,t,r,n){return e*n-r*t}function Ige(e){return e<=1e-6&&e>=-1e-6}function JN(e){var t=e.itemTooltipOption,r=e.componentModel,n=e.itemName,i=st(t)?{formatter:t}:t,a=r.mainType,o=r.componentIndex,s={componentType:a,name:n,$vars:["name"]};s[a+"Index"]=o;var l=e.formatterParamsExtra;l&&le(Dr(l),function(f){nv(s,f)||(s[f]=l[f],s.$vars.push(f))});var u=ur(e.el);u.componentMainType=a,u.componentIndex=o,u.tooltipConfig={name:n,option:lr({content:n,formatterParams:s},i)}}function TV(e,t){var r;e.isGroup&&(r=t(e)),r||e.traverse(t)}function aO(e,t){if(e)if(et(e))for(var r=0;r<e.length;r++)TV(e[r],t);else TV(e,t)}yo("circle",zN);yo("ellipse",cJ);yo("sector",Jc);yo("ring",pJ);yo("polygon",mJ);yo("polyline",iO);yo("rect",_n);yo("line",Pc);yo("bezierCurve",SJ);yo("arc",GN);const Mge=Object.freeze(Object.defineProperty({__proto__:null,Arc:GN,BezierCurve:SJ,BoundingRect:or,Circle:zN,CompoundPath:lge,Ellipse:cJ,Group:Kn,Image:Zc,IncrementalDisplayable:gge,Line:Pc,LinearGradient:TJ,OrientedBoundingRect:nx,Path:cr,Point:St,Polygon:mJ,Polyline:iO,RadialGradient:hge,Rect:_n,Ring:pJ,Sector:Jc,Text:Xn,applyTransform:qN,clipPointsByRect:kge,clipRectByRect:Age,createIcon:ZN,extendPath:_ge,extendShape:bge,getShapeClass:Sge,getTransform:Oge,groupTransition:kJ,initProps:ka,isElementRemoved:vm,lineLineIntersect:AJ,linePolygonIntersect:Pge,makeImage:OJ,makePath:XN,mergePath:Cge,registerShape:yo,removeElement:ix,removeElementWithFadeOut:ax,resizePath:RJ,setTooltipConfig:JN,subPixelOptimize:Tge,subPixelOptimizeLine:e0,subPixelOptimizeRect:xge,transformDirection:Ege,traverseElements:aO,updateProps:mi},Symbol.toStringTag,{value:"Module"}));var oO={};function Dge(e,t){for(var r=0;r<Aa.length;r++){var n=Aa[r],i=t[n],a=e.ensureState(n);a.style=a.style||{},a.style.text=i}var o=e.currentStates.slice();e.clearStates(!0),e.setStyle({text:t.normal}),e.useStates(o,!0)}function OV(e,t,r){var n=e.labelFetcher,i=e.labelDataIndex,a=e.labelDimIndex,o=t.normal,s;n&&(s=n.getFormattedLabel(i,"normal",null,a,o&&o.get("formatter"),r!=null?{interpolatedValue:r}:null)),s==null&&(s=Nt(e.defaultText)?e.defaultText(i,e,r):e.defaultText);for(var l={normal:s},u=0;u<Aa.length;u++){var f=Aa[u],c=t[f];l[f]=Xt(n?n.getFormattedLabel(i,f,null,a,c&&c.get("formatter")):null,s)}return l}function kw(e,t,r,n){r=r||oO;for(var i=e instanceof Xn,a=!1,o=0;o<QC.length;o++){var s=t[QC[o]];if(s&&s.getShallow("show")){a=!0;break}}var l=i?e:e.getTextContent();if(a){i||(l||(l=new Xn,e.setTextContent(l)),e.stateProxy&&(l.stateProxy=e.stateProxy));var u=OV(r,t),f=t.normal,c=!!f.getShallow("show"),h=Iu(f,n&&n.normal,r,!1,!i);h.text=u.normal,i||e.setTextConfig(EV(f,r,!1));for(var o=0;o<Aa.length;o++){var d=Aa[o],s=t[d];if(s){var v=l.ensureState(d),p=!!Xt(s.getShallow("show"),c);if(p!==c&&(v.ignore=!p),v.style=Iu(s,n&&n[d],r,!0,!i),v.style.text=u[d],!i){var g=e.ensureState(d);g.textConfig=EV(s,r,!0)}}}l.silent=!!f.getShallow("silent"),l.style.x!=null&&(h.x=l.style.x),l.style.y!=null&&(h.y=l.style.y),l.ignore=!c,l.useStyle(h),l.dirty(),r.enableTextSetter&&(sO(l).setLabelText=function(y){var m=OV(r,t,y);Dge(l,m)})}else l&&(l.ignore=!0);e.dirty()}function Aw(e,t){t=t||"label";for(var r={normal:e.getModel(t)},n=0;n<Aa.length;n++){var i=Aa[n];r[i]=e.getModel([i,t])}return r}function Iu(e,t,r,n,i){var a={};return $ge(a,e,r,n,i),t&&Le(a,t),a}function EV(e,t,r){t=t||{};var n={},i,a=e.getShallow("rotate"),o=Xt(e.getShallow("distance"),r?null:5),s=e.getShallow("offset");return i=e.getShallow("position")||(r?null:"inside"),i==="outside"&&(i=t.defaultOutsidePosition||"top"),i!=null&&(n.position=i),s!=null&&(n.offset=s),a!=null&&(a*=Math.PI/180,n.rotation=a),o!=null&&(n.distance=o),n.outsideFill=e.get("color")==="inherit"?t.inheritColor||null:"auto",n}function $ge(e,t,r,n,i){r=r||oO;var a=t.ecModel,o=a&&a.option.textStyle,s=Nge(t),l;if(s){l={};for(var u in s)if(s.hasOwnProperty(u)){var f=t.getModel(["rich",u]);PV(l[u]={},f,o,r,n,i,!1,!0)}}l&&(e.rich=l);var c=t.get("overflow");c&&(e.overflow=c);var h=t.get("minMargin");h!=null&&(e.margin=h),PV(e,t,o,r,n,i,!0,!1)}function Nge(e){for(var t;e&&e!==e.ecModel;){var r=(e.option||oO).rich;if(r){t=t||{};for(var n=Dr(r),i=0;i<n.length;i++){var a=n[i];t[a]=1}}e=e.parentModel}return t}var RV=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],kV=["align","lineHeight","width","height","tag","verticalAlign"],AV=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function PV(e,t,r,n,i,a,o,s){r=!i&&r||oO;var l=n&&n.inheritColor,u=t.getShallow("color"),f=t.getShallow("textBorderColor"),c=Xt(t.getShallow("opacity"),r.opacity);(u==="inherit"||u==="auto")&&(l?u=l:u=null),(f==="inherit"||f==="auto")&&(l?f=l:f=null),a||(u=u||r.color,f=f||r.textBorderColor),u!=null&&(e.fill=u),f!=null&&(e.stroke=f);var h=Xt(t.getShallow("textBorderWidth"),r.textBorderWidth);h!=null&&(e.lineWidth=h);var d=Xt(t.getShallow("textBorderType"),r.textBorderType);d!=null&&(e.lineDash=d);var v=Xt(t.getShallow("textBorderDashOffset"),r.textBorderDashOffset);v!=null&&(e.lineDashOffset=v),!i&&c==null&&!s&&(c=n&&n.defaultOpacity),c!=null&&(e.opacity=c),!i&&!a&&e.fill==null&&n.inheritColor&&(e.fill=n.inheritColor);for(var p=0;p<RV.length;p++){var g=RV[p],y=Xt(t.getShallow(g),r[g]);y!=null&&(e[g]=y)}for(var p=0;p<kV.length;p++){var g=kV[p],y=t.getShallow(g);y!=null&&(e[g]=y)}if(e.verticalAlign==null){var m=t.getShallow("baseline");m!=null&&(e.verticalAlign=m)}if(!o||!n.disableBox){for(var p=0;p<AV.length;p++){var g=AV[p],y=t.getShallow(g);y!=null&&(e[g]=y)}var b=t.getShallow("borderType");b!=null&&(e.borderDash=b),(e.backgroundColor==="auto"||e.backgroundColor==="inherit")&&l&&(e.backgroundColor=l),(e.borderColor==="auto"||e.borderColor==="inherit")&&l&&(e.borderColor=l)}}function Lge(e,t){var r=t&&t.getModel("textStyle");return Uo([e.fontStyle||r&&r.getShallow("fontStyle")||"",e.fontWeight||r&&r.getShallow("fontWeight")||"",(e.fontSize||r&&r.getShallow("fontSize")||12)+"px",e.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}var sO=pn();function Fge(e,t,r,n){if(e){var i=sO(e);i.prevValue=i.value,i.value=r;var a=t.normal;i.valueAnimation=a.get("valueAnimation"),i.valueAnimation&&(i.precision=a.get("precision"),i.defaultInterpolatedText=n,i.statesModels=t)}}var Hge=["textStyle","color"],RR=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],kR=new Xn,Bge=function(){function e(){}return e.prototype.getTextColor=function(t){var r=this.ecModel;return this.getShallow("color")||(!t&&r?r.get(Hge):null)},e.prototype.getFont=function(){return Lge({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},e.prototype.getTextRect=function(t){for(var r={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<RR.length;n++)r[RR[n]]=this.getShallow(RR[n]);return kR.useStyle(r),kR.update(),kR.getBoundingRect()},e}();const Vge=Bge;var PJ=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],jge=Jm(PJ),Wge=function(){function e(){}return e.prototype.getLineStyle=function(t){return jge(this,t)},e}(),IJ=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],Uge=Jm(IJ),zge=function(){function e(){}return e.prototype.getItemStyle=function(t,r){return Uge(this,t,r)},e}(),Qc=function(){function e(t,r,n){this.parentModel=r,this.ecModel=n,this.option=t}return e.prototype.init=function(t,r,n){},e.prototype.mergeOption=function(t,r){ar(this.option,t,!0)},e.prototype.get=function(t,r){return t==null?this.option:this._doGet(this.parsePath(t),!r&&this.parentModel)},e.prototype.getShallow=function(t,r){var n=this.option,i=n==null?n:n[t];if(i==null&&!r){var a=this.parentModel;a&&(i=a.getShallow(t))}return i},e.prototype.getModel=function(t,r){var n=t!=null,i=n?this.parsePath(t):null,a=n?this._doGet(i):this.option;return r=r||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new e(a,r,this.ecModel)},e.prototype.isEmpty=function(){return this.option==null},e.prototype.restoreData=function(){},e.prototype.clone=function(){var t=this.constructor;return new t(Qt(this.option))},e.prototype.parsePath=function(t){return typeof t=="string"?t.split("."):t},e.prototype.resolveParentPath=function(t){return t},e.prototype.isAnimationEnabled=function(){if(!Bt.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},e.prototype._doGet=function(t,r){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&!(t[i]&&(n=n&&typeof n=="object"?n[t[i]]:null,n==null));i++);return n==null&&r&&(n=r._doGet(this.resolveParentPath(t),r.parentModel)),n},e}();BN(Qc);wve(Qc);es(Qc,Wge);es(Qc,zge);es(Qc,Tve);es(Qc,Vge);const Un=Qc;var Gge=Math.round(Math.random()*10);function lO(e){return[e||"",Gge++].join("_")}function Yge(e){var t={};e.registerSubTypeDefaulter=function(r,n){var i=zo(r);t[i.main]=n},e.determineSubType=function(r,n){var i=n.type;if(!i){var a=zo(r).main;e.hasSubTypes(r)&&t[a]&&(i=t[a](n))}return i}}function Kge(e,t){e.topologicalTravel=function(a,o,s,l){if(!a.length)return;var u=r(o),f=u.graph,c=u.noEntryList,h={};for(le(a,function(m){h[m]=!0});c.length;){var d=c.pop(),v=f[d],p=!!h[d];p&&(s.call(l,d,v.originalDeps.slice()),delete h[d]),le(v.successor,p?y:g)}le(h,function(){var m="";throw new Error(m)});function g(m){f[m].entryCount--,f[m].entryCount===0&&c.push(m)}function y(m){h[m]=!0,g(m)}};function r(a){var o={},s=[];return le(a,function(l){var u=n(o,l),f=u.originalDeps=t(l),c=i(f,a);u.entryCount=c.length,u.entryCount===0&&s.push(l),le(c,function(h){yr(u.predecessor,h)<0&&u.predecessor.push(h);var d=n(o,h);yr(d.successor,h)<0&&d.successor.push(l)})}),{graph:o,noEntryList:s}}function n(a,o){return a[o]||(a[o]={predecessor:[],successor:[]}),a[o]}function i(a,o){var s=[];return le(a,function(l){yr(o,l)>=0&&s.push(l)}),s}}function MJ(e,t){return ar(ar({},e,!0),t,!0)}const Xge={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},qge={time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}};var lx="ZH",QN="EN",t0=QN,z1={},eL={},DJ=Bt.domSupported?function(){var e=(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase();return e.indexOf(lx)>-1?lx:t0}():t0;function $J(e,t){e=e.toUpperCase(),eL[e]=new Un(t),z1[e]=t}function Zge(e){if(st(e)){var t=z1[e.toUpperCase()]||{};return e===lx||e===QN?Qt(t):ar(Qt(t),Qt(z1[t0]),!1)}else return ar(Qt(e),Qt(z1[t0]),!1)}function Jge(e){return eL[e]}function Qge(){return eL[t0]}$J(QN,Xge);$J(lx,qge);var tL=1e3,rL=tL*60,pm=rL*60,Oa=pm*24,IV=Oa*365,Gy={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},Z_="{yyyy}-{MM}-{dd}",MV={year:"{yyyy}",month:"{yyyy}-{MM}",day:Z_,hour:Z_+" "+Gy.hour,minute:Z_+" "+Gy.minute,second:Z_+" "+Gy.second,millisecond:Gy.none},AR=["year","month","day","hour","minute","second","millisecond"],NJ=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function df(e,t){return e+="","0000".substr(0,t-e.length)+e}function Nd(e){switch(e){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return e}}function eye(e){return e===Nd(e)}function tye(e){switch(e){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function uO(e,t,r,n){var i=fl(e),a=i[nL(r)](),o=i[Ld(r)]()+1,s=Math.floor((o-1)/3)+1,l=i[fO(r)](),u=i["get"+(r?"UTC":"")+"Day"](),f=i[r0(r)](),c=(f-1)%12+1,h=i[cO(r)](),d=i[hO(r)](),v=i[dO(r)](),p=n instanceof Un?n:Jge(n||DJ)||Qge(),g=p.getModel("time"),y=g.get("month"),m=g.get("monthAbbr"),b=g.get("dayOfWeek"),_=g.get("dayOfWeekAbbr");return(t||"").replace(/{yyyy}/g,a+"").replace(/{yy}/g,a%100+"").replace(/{Q}/g,s+"").replace(/{MMMM}/g,y[o-1]).replace(/{MMM}/g,m[o-1]).replace(/{MM}/g,df(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,df(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,b[u]).replace(/{ee}/g,_[u]).replace(/{e}/g,u+"").replace(/{HH}/g,df(f,2)).replace(/{H}/g,f+"").replace(/{hh}/g,df(c+"",2)).replace(/{h}/g,c+"").replace(/{mm}/g,df(h,2)).replace(/{m}/g,h+"").replace(/{ss}/g,df(d,2)).replace(/{s}/g,d+"").replace(/{SSS}/g,df(v,3)).replace(/{S}/g,v+"")}function rye(e,t,r,n,i){var a=null;if(st(r))a=r;else if(Nt(r))a=r(e.value,t,{level:e.level});else{var o=Le({},Gy);if(e.level>0)for(var s=0;s<AR.length;++s)o[AR[s]]="{primary|"+o[AR[s]]+"}";var l=r?r.inherit===!1?r:lr(r,o):o,u=LJ(e.value,i);if(l[u])a=l[u];else if(l.inherit){for(var f=NJ.indexOf(u),s=f-1;s>=0;--s)if(l[u]){a=l[u];break}a=a||o.none}if(et(a)){var c=e.level==null?0:e.level>=0?e.level:a.length+e.level;c=Math.min(c,a.length-1),a=a[c]}}return uO(new Date(e.value),a,i,n)}function LJ(e,t){var r=fl(e),n=r[Ld(t)]()+1,i=r[fO(t)](),a=r[r0(t)](),o=r[cO(t)](),s=r[hO(t)](),l=r[dO(t)](),u=l===0,f=u&&s===0,c=f&&o===0,h=c&&a===0,d=h&&i===1,v=d&&n===1;return v?"year":d?"month":h?"day":c?"hour":f?"minute":u?"second":"millisecond"}function DV(e,t,r){var n=_r(e)?fl(e):e;switch(t=t||LJ(e,r),t){case"year":return n[nL(r)]();case"half-year":return n[Ld(r)]()>=6?1:0;case"quarter":return Math.floor((n[Ld(r)]()+1)/4);case"month":return n[Ld(r)]();case"day":return n[fO(r)]();case"half-day":return n[r0(r)]()/24;case"hour":return n[r0(r)]();case"minute":return n[cO(r)]();case"second":return n[hO(r)]();case"millisecond":return n[dO(r)]()}}function nL(e){return e?"getUTCFullYear":"getFullYear"}function Ld(e){return e?"getUTCMonth":"getMonth"}function fO(e){return e?"getUTCDate":"getDate"}function r0(e){return e?"getUTCHours":"getHours"}function cO(e){return e?"getUTCMinutes":"getMinutes"}function hO(e){return e?"getUTCSeconds":"getSeconds"}function dO(e){return e?"getUTCMilliseconds":"getMilliseconds"}function nye(e){return e?"setUTCFullYear":"setFullYear"}function FJ(e){return e?"setUTCMonth":"setMonth"}function HJ(e){return e?"setUTCDate":"setDate"}function BJ(e){return e?"setUTCHours":"setHours"}function VJ(e){return e?"setUTCMinutes":"setMinutes"}function jJ(e){return e?"setUTCSeconds":"setSeconds"}function WJ(e){return e?"setUTCMilliseconds":"setMilliseconds"}function UJ(e){if(!Qde(e))return st(e)?e:"-";var t=(e+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function zJ(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(r,n){return n.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var vO=rZ;function AI(e,t,r){var n="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(f){return f&&Uo(f)?f:"-"}function a(f){return!!(f!=null&&!isNaN(f)&&isFinite(f))}var o=t==="time",s=e instanceof Date;if(o||s){var l=o?fl(e):e;if(isNaN(+l)){if(s)return"-"}else return uO(l,n,r)}if(t==="ordinal")return JP(e)?i(e):_r(e)&&a(e)?e+"":"-";var u=JC(e);return a(u)?UJ(u):JP(e)?i(e):typeof e=="boolean"?e+"":"-"}var $V=["a","b","c","d","e","f","g"],PR=function(e,t){return"{"+e+(t??"")+"}"};function GJ(e,t,r){et(t)||(t=[t]);var n=t.length;if(!n)return"";for(var i=t[0].$vars||[],a=0;a<i.length;a++){var o=$V[a];e=e.replace(PR(o),PR(o,0))}for(var s=0;s<n;s++)for(var l=0;l<i.length;l++){var u=t[s][i[l]];e=e.replace(PR($V[l],s),r?wa(u):u)}return e}function iye(e,t){var r=st(e)?{color:e,extraCssText:t}:e||{},n=r.color,i=r.type;t=r.extraCssText;var a=r.renderMode||"html";if(!n)return"";if(a==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+wa(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+wa(n)+";"+(t||"")+'"></span>';var o=r.markerId||"markerX";return{renderMode:a,content:"{"+o+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}}function Ic(e,t){return t=t||"transparent",st(e)?e:dt(e)&&e.colorStops&&(e.colorStops[0]||{}).color||t}function NV(e,t){if(t==="_blank"||t==="blank"){var r=window.open();r.opener=null,r.location.href=e}else window.open(e,t)}var G1=le,aye=["left","right","top","bottom","width","height"],J_=[["width","left","right"],["height","top","bottom"]];function iL(e,t,r,n,i){var a=0,o=0;n==null&&(n=1/0),i==null&&(i=1/0);var s=0;t.eachChild(function(l,u){var f=l.getBoundingRect(),c=t.childAt(u+1),h=c&&c.getBoundingRect(),d,v;if(e==="horizontal"){var p=f.width+(h?-h.x+f.x:0);d=a+p,d>n||l.newline?(a=0,d=p,o+=s+r,s=f.height):s=Math.max(s,f.height)}else{var g=f.height+(h?-h.y+f.y:0);v=o+g,v>i||l.newline?(a+=s+r,o=0,v=g,s=f.width):s=Math.max(s,f.width)}l.newline||(l.x=a,l.y=o,l.markRedraw(),e==="horizontal"?a=d+r:o=v+r)})}var gm=iL;en(iL,"vertical");en(iL,"horizontal");function iv(e,t,r){r=vO(r||0);var n=t.width,i=t.height,a=Mr(e.left,n),o=Mr(e.top,i),s=Mr(e.right,n),l=Mr(e.bottom,i),u=Mr(e.width,n),f=Mr(e.height,i),c=r[2]+r[0],h=r[1]+r[3],d=e.aspect;switch(isNaN(u)&&(u=n-s-h-a),isNaN(f)&&(f=i-l-c-o),d!=null&&(isNaN(u)&&isNaN(f)&&(d>n/i?u=n*.8:f=i*.8),isNaN(u)&&(u=d*f),isNaN(f)&&(f=u/d)),isNaN(a)&&(a=n-s-u-h),isNaN(o)&&(o=i-l-f-c),e.left||e.right){case"center":a=n/2-u/2-r[3];break;case"right":a=n-u-h;break}switch(e.top||e.bottom){case"middle":case"center":o=i/2-f/2-r[0];break;case"bottom":o=i-f-c;break}a=a||0,o=o||0,isNaN(u)&&(u=n-h-a-(s||0)),isNaN(f)&&(f=i-c-o-(l||0));var v=new or(a+r[3],o+r[0],u,f);return v.margin=r,v}function n0(e){var t=e.layoutMode||e.constructor.layoutMode;return dt(t)?t:t?{type:t}:null}function av(e,t,r){var n=r&&r.ignoreSize;!et(n)&&(n=[n,n]);var i=o(J_[0],0),a=o(J_[1],1);u(J_[0],e,i),u(J_[1],e,a);function o(f,c){var h={},d=0,v={},p=0,g=2;if(G1(f,function(b){v[b]=e[b]}),G1(f,function(b){s(t,b)&&(h[b]=v[b]=t[b]),l(h,b)&&d++,l(v,b)&&p++}),n[c])return l(t,f[1])?v[f[2]]=null:l(t,f[2])&&(v[f[1]]=null),v;if(p===g||!d)return v;if(d>=g)return h;for(var y=0;y<f.length;y++){var m=f[y];if(!s(h,m)&&s(e,m)){h[m]=e[m];break}}return h}function s(f,c){return f.hasOwnProperty(c)}function l(f,c){return f[c]!=null&&f[c]!=="auto"}function u(f,c,h){G1(f,function(d){c[d]=h[d]})}}function pO(e){return oye({},e)}function oye(e,t){return t&&e&&G1(aye,function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e}var sye=pn(),Sg=function(e){Ye(t,e);function t(r,n,i){var a=e.call(this,r,n,i)||this;return a.uid=lO("ec_cpt_model"),a}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=n0(this),a=i?pO(r):{},o=n.getTheme();ar(r,o.get(this.mainType)),ar(r,this.getDefaultOption()),i&&av(r,a,i)},t.prototype.mergeOption=function(r,n){ar(this.option,r,!0);var i=n0(this);i&&av(this.option,r,i)},t.prototype.optionUpdated=function(r,n){},t.prototype.getDefaultOption=function(){var r=this.constructor;if(!yve(r))return r.defaultOption;var n=sye(this);if(!n.defaultOption){for(var i=[],a=r;a;){var o=a.prototype.defaultOption;o&&i.push(o),a=a.superClass}for(var s={},l=i.length-1;l>=0;l--)s=ar(s,i[l],!0);n.defaultOption=s}return n.defaultOption},t.prototype.getReferringComponents=function(r,n){var i=r+"Index",a=r+"Id";return Ew(this.ecModel,r,{index:this.get(i,!0),id:this.get(a,!0)},n)},t.prototype.getBoxLayoutParams=function(){var r=this;return{left:r.get("left"),top:r.get("top"),right:r.get("right"),bottom:r.get("bottom"),width:r.get("width"),height:r.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(r){this.option.zlevel=r},t.protoInitialize=function(){var r=t.prototype;r.type="component",r.id="",r.name="",r.mainType="",r.subType="",r.componentIndex=0}(),t}(Un);LZ(Sg,Un);JT(Sg);Yge(Sg);Kge(Sg,lye);function lye(e){var t=[];return le(Sg.getClassesByMainType(e),function(r){t=t.concat(r.dependencies||r.prototype.dependencies||[])}),t=pt(t,function(r){return zo(r).main}),e!=="dataset"&&yr(t,"dataset")<=0&&t.unshift("dataset"),t}const Pr=Sg;var YJ="";typeof navigator<"u"&&(YJ=navigator.platform||"");var kh="rgba(0, 0, 0, 0.2)";const uye={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:kh,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:kh,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:kh,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:kh,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:kh,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:kh,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:YJ.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var KJ=Vt(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),Da="original",Li="arrayRows",mo="objectRows",rs="keyedColumns",cu="typedArray",XJ="unknown",al="column",Cg="row",An={Must:1,Might:2,Not:3},qJ=pn();function fye(e){qJ(e).datasetMap=Vt()}function cye(e,t,r){var n={},i=aL(t);if(!i||!e)return n;var a=[],o=[],s=t.ecModel,l=qJ(s).datasetMap,u=i.uid+"_"+r.seriesLayoutBy,f,c;e=e.slice(),le(e,function(p,g){var y=dt(p)?p:e[g]={name:p};y.type==="ordinal"&&f==null&&(f=g,c=v(y)),n[y.name]=[]});var h=l.get(u)||l.set(u,{categoryWayDim:c,valueWayDim:0});le(e,function(p,g){var y=p.name,m=v(p);if(f==null){var b=h.valueWayDim;d(n[y],b,m),d(o,b,m),h.valueWayDim+=m}else if(f===g)d(n[y],0,m),d(a,0,m);else{var b=h.categoryWayDim;d(n[y],b,m),d(o,b,m),h.categoryWayDim+=m}});function d(p,g,y){for(var m=0;m<y;m++)p.push(g+m)}function v(p){var g=p.dimsDef;return g?g.length:1}return a.length&&(n.itemName=a),o.length&&(n.seriesName=o),n}function hye(e,t,r){var n={},i=aL(e);if(!i)return n;var a=t.sourceFormat,o=t.dimensionsDefine,s;(a===mo||a===rs)&&le(o,function(f,c){(dt(f)?f.name:f)==="name"&&(s=c)});var l=function(){for(var f={},c={},h=[],d=0,v=Math.min(5,r);d<v;d++){var p=JJ(t.data,a,t.seriesLayoutBy,o,t.startIndex,d);h.push(p);var g=p===An.Not;if(g&&f.v==null&&d!==s&&(f.v=d),(f.n==null||f.n===f.v||!g&&h[f.n]===An.Not)&&(f.n=d),y(f)&&h[f.n]!==An.Not)return f;g||(p===An.Might&&c.v==null&&d!==s&&(c.v=d),(c.n==null||c.n===c.v)&&(c.n=d))}function y(m){return m.v!=null&&m.n!=null}return y(f)?f:y(c)?c:null}();if(l){n.value=[l.v];var u=s??l.n;n.itemName=[u],n.seriesName=[u]}return n}function aL(e){var t=e.get("data",!0);if(!t)return Ew(e.ecModel,"dataset",{index:e.get("datasetIndex",!0),id:e.get("datasetId",!0)},ao).models[0]}function dye(e){return!e.get("transform",!0)&&!e.get("fromTransformResult",!0)?[]:Ew(e.ecModel,"dataset",{index:e.get("fromDatasetIndex",!0),id:e.get("fromDatasetId",!0)},ao).models}function ZJ(e,t){return JJ(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function JJ(e,t,r,n,i,a){var o,s=5;if(ta(e))return An.Not;var l,u;if(n){var f=n[a];dt(f)?(l=f.name,u=f.type):st(f)&&(l=f)}if(u!=null)return u==="ordinal"?An.Must:An.Not;if(t===Li){var c=e;if(r===Cg){for(var h=c[a],d=0;d<(h||[]).length&&d<s;d++)if((o=_(h[i+d]))!=null)return o}else for(var d=0;d<c.length&&d<s;d++){var v=c[i+d];if(v&&(o=_(v[a]))!=null)return o}}else if(t===mo){var p=e;if(!l)return An.Not;for(var d=0;d<p.length&&d<s;d++){var g=p[d];if(g&&(o=_(g[l]))!=null)return o}}else if(t===rs){var y=e;if(!l)return An.Not;var h=y[l];if(!h||ta(h))return An.Not;for(var d=0;d<h.length&&d<s;d++)if((o=_(h[d]))!=null)return o}else if(t===Da)for(var m=e,d=0;d<m.length&&d<s;d++){var g=m[d],b=Ow(g);if(!et(b))return An.Not;if((o=_(b[a]))!=null)return o}function _(x){var T=st(x);if(x!=null&&isFinite(x)&&x!=="")return T?An.Might:An.Not;if(T&&x!=="-")return An.Must}return An.Not}var vye=Vt();function pye(e,t,r){var n=vye.get(t);if(!n)return r;var i=n(e);return i?r.concat(i):r}var LV=pn();pn();var oL=function(){function e(){}return e.prototype.getColorFromPalette=function(t,r,n){var i=gi(this.get("color",!0)),a=this.get("colorLayer",!0);return yye(this,LV,i,a,t,r,n)},e.prototype.clearColorPalette=function(){mye(this,LV)},e}();function gye(e,t){for(var r=e.length,n=0;n<r;n++)if(e[n].length>t)return e[n];return e[r-1]}function yye(e,t,r,n,i,a,o){a=a||e;var s=t(a),l=s.paletteIdx||0,u=s.paletteNameMap=s.paletteNameMap||{};if(u.hasOwnProperty(i))return u[i];var f=o==null||!n?r:gye(n,o);if(f=f||r,!(!f||!f.length)){var c=f[l];return i&&(u[i]=c),s.paletteIdx=(l+1)%f.length,c}}function mye(e,t){t(e).paletteIdx=0,t(e).paletteNameMap={}}var Q_,Zg,FV,HV="\0_ec_inner",bye=1,QJ=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r,n,i,a,o,s){a=a||{},this.option=null,this._theme=new Un(a),this._locale=new Un(o),this._optionManager=s},t.prototype.setOption=function(r,n,i){var a=jV(n);this._optionManager.setOption(r,i,a),this._resetOption(null,a)},t.prototype.resetOption=function(r,n){return this._resetOption(r,jV(n))},t.prototype._resetOption=function(r,n){var i=!1,a=this._optionManager;if(!r||r==="recreate"){var o=a.mountOption(r==="recreate");!this.option||r==="recreate"?FV(this,o):(this.restoreData(),this._mergeOption(o,n)),i=!0}if((r==="timeline"||r==="media")&&this.restoreData(),!r||r==="recreate"||r==="timeline"){var s=a.getTimelineOption(this);s&&(i=!0,this._mergeOption(s,n))}if(!r||r==="recreate"||r==="media"){var l=a.getMediaOption(this);l.length&&le(l,function(u){i=!0,this._mergeOption(u,n)},this)}return i},t.prototype.mergeOption=function(r){this._mergeOption(r,null)},t.prototype._mergeOption=function(r,n){var i=this.option,a=this._componentsMap,o=this._componentsCount,s=[],l=Vt(),u=n&&n.replaceMergeMainTypeMap;fye(this),le(r,function(c,h){c!=null&&(Pr.hasClass(h)?h&&(s.push(h),l.set(h,!0)):i[h]=i[h]==null?Qt(c):ar(i[h],c,!0))}),u&&u.each(function(c,h){Pr.hasClass(h)&&!l.get(h)&&(s.push(h),l.set(h,!0))}),Pr.topologicalTravel(s,Pr.getAllClassMainTypes(),f,this);function f(c){var h=pye(this,c,gi(r[c])),d=a.get(c),v=d?u&&u.get(c)?"replaceMerge":"normalMerge":"replaceAll",p=rve(d,h,v);uve(p,c,Pr),i[c]=null,a.set(c,null),o.set(c,0);var g=[],y=[],m=0,b;le(p,function(_,x){var T=_.existing,E=_.newOption;if(!E)T&&(T.mergeOption({},this),T.optionUpdated({},!1));else{var P=c==="series",R=Pr.getClass(c,_.keyInfo.subType,!P);if(!R)return;if(c==="tooltip"){if(b)return;b=!0}if(T&&T.constructor===R)T.name=_.keyInfo.name,T.mergeOption(E,this),T.optionUpdated(E,!1);else{var M=Le({componentIndex:x},_.keyInfo);T=new R(E,this,this,M),Le(T,M),_.brandNew&&(T.__requireNewView=!0),T.init(E,this,this),T.optionUpdated(null,!0)}}T?(g.push(T.option),y.push(T),m++):(g.push(void 0),y.push(void 0))},this),i[c]=g,a.set(c,y),o.set(c,m),c==="series"&&Q_(this)}this._seriesIndices||Q_(this)},t.prototype.getOption=function(){var r=Qt(this.option);return le(r,function(n,i){if(Pr.hasClass(i)){for(var a=gi(n),o=a.length,s=!1,l=o-1;l>=0;l--)a[l]&&!Zm(a[l])?s=!0:(a[l]=null,!s&&o--);a.length=o,r[i]=a}}),delete r[HV],r},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(r){this._payload=r},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(r,n){var i=this._componentsMap.get(r);if(i){var a=i[n||0];if(a)return a;if(n==null){for(var o=0;o<i.length;o++)if(i[o])return i[o]}}},t.prototype.queryComponents=function(r){var n=r.mainType;if(!n)return[];var i=r.index,a=r.id,o=r.name,s=this._componentsMap.get(n);if(!s||!s.length)return[];var l;return i!=null?(l=[],le(gi(i),function(u){s[u]&&l.push(s[u])})):a!=null?l=BV("id",a,s):o!=null?l=BV("name",o,s):l=hi(s,function(u){return!!u}),VV(l,r)},t.prototype.findComponents=function(r){var n=r.query,i=r.mainType,a=s(n),o=a?this.queryComponents(a):hi(this._componentsMap.get(i),function(u){return!!u});return l(VV(o,r));function s(u){var f=i+"Index",c=i+"Id",h=i+"Name";return u&&(u[f]!=null||u[c]!=null||u[h]!=null)?{mainType:i,index:u[f],id:u[c],name:u[h]}:null}function l(u){return r.filter?hi(u,r.filter):u}},t.prototype.eachComponent=function(r,n,i){var a=this._componentsMap;if(Nt(r)){var o=n,s=r;a.each(function(c,h){for(var d=0;c&&d<c.length;d++){var v=c[d];v&&s.call(o,h,v,v.componentIndex)}})}else for(var l=st(r)?a.get(r):dt(r)?this.findComponents(r):null,u=0;l&&u<l.length;u++){var f=l[u];f&&n.call(i,f,f.componentIndex)}},t.prototype.getSeriesByName=function(r){var n=Ko(r,null);return hi(this._componentsMap.get("series"),function(i){return!!i&&n!=null&&i.name===n})},t.prototype.getSeriesByIndex=function(r){return this._componentsMap.get("series")[r]},t.prototype.getSeriesByType=function(r){return hi(this._componentsMap.get("series"),function(n){return!!n&&n.subType===r})},t.prototype.getSeries=function(){return hi(this._componentsMap.get("series"),function(r){return!!r})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(r,n){Zg(this),le(this._seriesIndices,function(i){var a=this._componentsMap.get("series")[i];r.call(n,a,i)},this)},t.prototype.eachRawSeries=function(r,n){le(this._componentsMap.get("series"),function(i){i&&r.call(n,i,i.componentIndex)})},t.prototype.eachSeriesByType=function(r,n,i){Zg(this),le(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];o.subType===r&&n.call(i,o,a)},this)},t.prototype.eachRawSeriesByType=function(r,n,i){return le(this.getSeriesByType(r),n,i)},t.prototype.isSeriesFiltered=function(r){return Zg(this),this._seriesIndicesMap.get(r.componentIndex)==null},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(r,n){Zg(this);var i=[];le(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];r.call(n,o,a)&&i.push(a)},this),this._seriesIndices=i,this._seriesIndicesMap=Vt(i)},t.prototype.restoreData=function(r){Q_(this);var n=this._componentsMap,i=[];n.each(function(a,o){Pr.hasClass(o)&&i.push(o)}),Pr.topologicalTravel(i,Pr.getAllClassMainTypes(),function(a){le(n.get(a),function(o){o&&(a!=="series"||!wye(o,r))&&o.restoreData()})})},t.internalField=function(){Q_=function(r){var n=r._seriesIndices=[];le(r._componentsMap.get("series"),function(i){i&&n.push(i.componentIndex)}),r._seriesIndicesMap=Vt(n)},Zg=function(r){},FV=function(r,n){r.option={},r.option[HV]=bye,r._componentsMap=Vt({series:[]}),r._componentsCount=Vt();var i=n.aria;dt(i)&&i.enabled==null&&(i.enabled=!0),_ye(n,r._theme.option),ar(n,uye,!1),r._mergeOption(n,null)}}(),t}(Un);function wye(e,t){if(t){var r=t.seriesIndex,n=t.seriesId,i=t.seriesName;return r!=null&&e.componentIndex!==r||n!=null&&e.id!==n||i!=null&&e.name!==i}}function _ye(e,t){var r=e.color&&!e.colorLayer;le(t,function(n,i){i==="colorLayer"&&r||Pr.hasClass(i)||(typeof n=="object"?e[i]=e[i]?ar(e[i],n,!1):Qt(n):e[i]==null&&(e[i]=n))})}function BV(e,t,r){if(et(t)){var n=Vt();return le(t,function(a){if(a!=null){var o=Ko(a,null);o!=null&&n.set(a,!0)}}),hi(r,function(a){return a&&n.get(a[e])})}else{var i=Ko(t,null);return hi(r,function(a){return a&&i!=null&&a[e]===i})}}function VV(e,t){return t.hasOwnProperty("subType")?hi(e,function(r){return r&&r.subType===t.subType}):e}function jV(e){var t=Vt();return e&&le(gi(e.replaceMerge),function(r){t.set(r,!0)}),{replaceMergeMainTypeMap:t}}es(QJ,oL);const eQ=QJ;var Sye=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],Cye=function(){function e(t){le(Sye,function(r){this[r]=Or(t[r],t)},this)}return e}();const tQ=Cye;var IR={},xye=function(){function e(){this._coordinateSystems=[]}return e.prototype.create=function(t,r){var n=[];le(IR,function(i,a){var o=i.create(t,r);n=n.concat(o||[])}),this._coordinateSystems=n},e.prototype.update=function(t,r){le(this._coordinateSystems,function(n){n.update&&n.update(t,r)})},e.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},e.register=function(t,r){IR[t]=r},e.get=function(t){return IR[t]},e}();const sL=xye;var Tye=/^(min|max)?(.+)$/,Oye=function(){function e(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return e.prototype.setOption=function(t,r,n){t&&(le(gi(t.series),function(o){o&&o.data&&ta(o.data)&&QP(o.data)}),le(gi(t.dataset),function(o){o&&o.source&&ta(o.source)&&QP(o.source)})),t=Qt(t);var i=this._optionBackup,a=Eye(t,r,!i);this._newBaseOption=a.baseOption,i?(a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},e.prototype.mountOption=function(t){var r=this._optionBackup;return this._timelineOptions=r.timelineOptions,this._mediaList=r.mediaList,this._mediaDefault=r.mediaDefault,this._currentMediaIndices=[],Qt(t?r.baseOption:this._newBaseOption)},e.prototype.getTimelineOption=function(t){var r,n=this._timelineOptions;if(n.length){var i=t.getComponent("timeline");i&&(r=Qt(n[i.getCurrentIndex()]))}return r},e.prototype.getMediaOption=function(t){var r=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,a=this._mediaDefault,o=[],s=[];if(!i.length&&!a)return s;for(var l=0,u=i.length;l<u;l++)Rye(i[l].query,r,n)&&o.push(l);return!o.length&&a&&(o=[-1]),o.length&&!Aye(o,this._currentMediaIndices)&&(s=pt(o,function(f){return Qt(f===-1?a.option:i[f].option)})),this._currentMediaIndices=o,s},e}();function Eye(e,t,r){var n=[],i,a,o=e.baseOption,s=e.timeline,l=e.options,u=e.media,f=!!e.media,c=!!(l||s||o&&o.timeline);o?(a=o,a.timeline||(a.timeline=s)):((c||f)&&(e.options=e.media=null),a=e),f&&et(u)&&le(u,function(d){d&&d.option&&(d.query?n.push(d):i||(i=d))}),h(a),le(l,function(d){return h(d)}),le(n,function(d){return h(d.option)});function h(d){le(t,function(v){v(d,r)})}return{baseOption:a,timelineOptions:l||[],mediaDefault:i,mediaList:n}}function Rye(e,t,r){var n={width:t,height:r,aspectratio:t/r},i=!0;return le(e,function(a,o){var s=o.match(Tye);if(!(!s||!s[1]||!s[2])){var l=s[1],u=s[2].toLowerCase();kye(n[u],a,l)||(i=!1)}}),i}function kye(e,t,r){return r==="min"?e>=t:r==="max"?e<=t:e===t}function Aye(e,t){return e.join(",")===t.join(",")}const Pye=Oye;var Va=le,i0=dt,WV=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function MR(e){var t=e&&e.itemStyle;if(t)for(var r=0,n=WV.length;r<n;r++){var i=WV[r],a=t.normal,o=t.emphasis;a&&a[i]&&(e[i]=e[i]||{},e[i].normal?ar(e[i].normal,a[i]):e[i].normal=a[i],a[i]=null),o&&o[i]&&(e[i]=e[i]||{},e[i].emphasis?ar(e[i].emphasis,o[i]):e[i].emphasis=o[i],o[i]=null)}}function Bn(e,t,r){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,i=e[t].emphasis;n&&(r?(e[t].normal=e[t].emphasis=null,lr(e[t],n)):e[t]=n),i&&(e.emphasis=e.emphasis||{},e.emphasis[t]=i,i.focus&&(e.emphasis.focus=i.focus),i.blurScope&&(e.emphasis.blurScope=i.blurScope))}}function Yy(e){Bn(e,"itemStyle"),Bn(e,"lineStyle"),Bn(e,"areaStyle"),Bn(e,"label"),Bn(e,"labelLine"),Bn(e,"upperLabel"),Bn(e,"edgeLabel")}function Qr(e,t){var r=i0(e)&&e[t],n=i0(r)&&r.textStyle;if(n)for(var i=0,a=W4.length;i<a;i++){var o=W4[i];n.hasOwnProperty(o)&&(r[o]=n[o])}}function ga(e){e&&(Yy(e),Qr(e,"label"),e.emphasis&&Qr(e.emphasis,"label"))}function Iye(e){if(i0(e)){MR(e),Yy(e),Qr(e,"label"),Qr(e,"upperLabel"),Qr(e,"edgeLabel"),e.emphasis&&(Qr(e.emphasis,"label"),Qr(e.emphasis,"upperLabel"),Qr(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(MR(t),ga(t));var r=e.markLine;r&&(MR(r),ga(r));var n=e.markArea;n&&ga(n);var i=e.data;if(e.type==="graph"){i=i||e.nodes;var a=e.links||e.edges;if(a&&!ta(a))for(var o=0;o<a.length;o++)ga(a[o]);le(e.categories,function(u){Yy(u)})}if(i&&!ta(i))for(var o=0;o<i.length;o++)ga(i[o]);if(t=e.markPoint,t&&t.data)for(var s=t.data,o=0;o<s.length;o++)ga(s[o]);if(r=e.markLine,r&&r.data)for(var l=r.data,o=0;o<l.length;o++)et(l[o])?(ga(l[o][0]),ga(l[o][1])):ga(l[o]);e.type==="gauge"?(Qr(e,"axisLabel"),Qr(e,"title"),Qr(e,"detail")):e.type==="treemap"?(Bn(e.breadcrumb,"itemStyle"),le(e.levels,function(u){Yy(u)})):e.type==="tree"&&Yy(e.leaves)}}function hs(e){return et(e)?e:e?[e]:[]}function UV(e){return(et(e)?e[0]:e)||{}}function Mye(e,t){Va(hs(e.series),function(n){i0(n)&&Iye(n)});var r=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&r.push("valueAxis","categoryAxis","logAxis","timeAxis"),Va(r,function(n){Va(hs(e[n]),function(i){i&&(Qr(i,"axisLabel"),Qr(i.axisPointer,"label"))})}),Va(hs(e.parallel),function(n){var i=n&&n.parallelAxisDefault;Qr(i,"axisLabel"),Qr(i&&i.axisPointer,"label")}),Va(hs(e.calendar),function(n){Bn(n,"itemStyle"),Qr(n,"dayLabel"),Qr(n,"monthLabel"),Qr(n,"yearLabel")}),Va(hs(e.radar),function(n){Qr(n,"name"),n.name&&n.axisName==null&&(n.axisName=n.name,delete n.name),n.nameGap!=null&&n.axisNameGap==null&&(n.axisNameGap=n.nameGap,delete n.nameGap)}),Va(hs(e.geo),function(n){i0(n)&&(ga(n),Va(hs(n.regions),function(i){ga(i)}))}),Va(hs(e.timeline),function(n){ga(n),Bn(n,"label"),Bn(n,"itemStyle"),Bn(n,"controlStyle",!0);var i=n.data;et(i)&&le(i,function(a){dt(a)&&(Bn(a,"label"),Bn(a,"itemStyle"))})}),Va(hs(e.toolbox),function(n){Bn(n,"iconStyle"),Va(n.feature,function(i){Bn(i,"iconStyle")})}),Qr(UV(e.axisPointer),"label"),Qr(UV(e.tooltip).axisPointer,"label")}function Dye(e,t){for(var r=t.split(","),n=e,i=0;i<r.length&&(n=n&&n[r[i]],n!=null);i++);return n}function $ye(e,t,r,n){for(var i=t.split(","),a=e,o,s=0;s<i.length-1;s++)o=i[s],a[o]==null&&(a[o]={}),a=a[o];(n||a[i[s]]==null)&&(a[i[s]]=r)}function zV(e){e&&le(Nye,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var Nye=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],Lye=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],DR=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function Jg(e){var t=e&&e.itemStyle;if(t)for(var r=0;r<DR.length;r++){var n=DR[r][1],i=DR[r][0];t[n]!=null&&(t[i]=t[n])}}function GV(e){e&&e.alignTo==="edge"&&e.margin!=null&&e.edgeDistance==null&&(e.edgeDistance=e.margin)}function YV(e){e&&e.downplay&&!e.blur&&(e.blur=e.downplay)}function Fye(e){e&&e.focusNodeAdjacency!=null&&(e.emphasis=e.emphasis||{},e.emphasis.focus==null&&(e.emphasis.focus="adjacency"))}function rQ(e,t){if(e)for(var r=0;r<e.length;r++)t(e[r]),e[r]&&rQ(e[r].children,t)}function nQ(e,t){Mye(e,t),e.series=gi(e.series),le(e.series,function(r){if(dt(r)){var n=r.type;if(n==="line")r.clipOverflow!=null&&(r.clip=r.clipOverflow);else if(n==="pie"||n==="gauge"){r.clockWise!=null&&(r.clockwise=r.clockWise),GV(r.label);var i=r.data;if(i&&!ta(i))for(var a=0;a<i.length;a++)GV(i[a]);r.hoverOffset!=null&&(r.emphasis=r.emphasis||{},(r.emphasis.scaleSize=null)&&(r.emphasis.scaleSize=r.hoverOffset))}else if(n==="gauge"){var o=Dye(r,"pointer.color");o!=null&&$ye(r,"itemStyle.color",o)}else if(n==="bar"){Jg(r),Jg(r.backgroundStyle),Jg(r.emphasis);var i=r.data;if(i&&!ta(i))for(var a=0;a<i.length;a++)typeof i[a]=="object"&&(Jg(i[a]),Jg(i[a]&&i[a].emphasis))}else if(n==="sunburst"){var s=r.highlightPolicy;s&&(r.emphasis=r.emphasis||{},r.emphasis.focus||(r.emphasis.focus=s)),YV(r),rQ(r.data,YV)}else n==="graph"||n==="sankey"?Fye(r):n==="map"&&(r.mapType&&!r.map&&(r.map=r.mapType),r.mapLocation&&lr(r,r.mapLocation));r.hoverAnimation!=null&&(r.emphasis=r.emphasis||{},r.emphasis&&r.emphasis.scale==null&&(r.emphasis.scale=r.hoverAnimation)),zV(r)}}),e.dataRange&&(e.visualMap=e.dataRange),le(Lye,function(r){var n=e[r];n&&(et(n)||(n=[n]),le(n,function(i){zV(i)}))})}function Hye(e){var t=Vt();e.eachSeries(function(r){var n=r.get("stack");if(n){var i=t.get(n)||t.set(n,[]),a=r.getData(),o={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:r};if(!o.stackedDimension||!(o.isStackedByIndex||o.stackedByDimension))return;i.length&&a.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(o)}}),t.each(Bye)}function Bye(e){le(e,function(t,r){var n=[],i=[NaN,NaN],a=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";o.modify(a,function(u,f,c){var h=o.get(t.stackedDimension,c);if(isNaN(h))return i;var d,v;s?v=o.getRawIndex(c):d=o.get(t.stackedByDimension,c);for(var p=NaN,g=r-1;g>=0;g--){var y=e[g];if(s||(v=y.data.rawIndexOf(y.stackedByDimension,d)),v>=0){var m=y.data.getByRawIndex(y.stackResultDimension,v);if(l==="all"||l==="positive"&&m>0||l==="negative"&&m<0||l==="samesign"&&h>=0&&m>0||l==="samesign"&&h<=0&&m<0){h=qde(h,m),p=m;break}}}return n[0]=h,n[1]=p,n})})}var gO=function(){function e(t){this.data=t.data||(t.sourceFormat===rs?{}:[]),this.sourceFormat=t.sourceFormat||XJ,this.seriesLayoutBy=t.seriesLayoutBy||al,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var r=this.dimensionsDefine=t.dimensionsDefine;if(r)for(var n=0;n<r.length;n++){var i=r[n];i.type==null&&ZJ(this,n)===An.Must&&(i.type="ordinal")}}return e}();function lL(e){return e instanceof gO}function PI(e,t,r){r=r||iQ(e);var n=t.seriesLayoutBy,i=jye(e,r,n,t.sourceHeader,t.dimensions),a=new gO({data:e,sourceFormat:r,seriesLayoutBy:n,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:Qt(t)});return a}function uL(e){return new gO({data:e,sourceFormat:ta(e)?cu:Da})}function Vye(e){return new gO({data:e.data,sourceFormat:e.sourceFormat,seriesLayoutBy:e.seriesLayoutBy,dimensionsDefine:Qt(e.dimensionsDefine),startIndex:e.startIndex,dimensionsDetectedCount:e.dimensionsDetectedCount})}function iQ(e){var t=XJ;if(ta(e))t=cu;else if(et(e)){e.length===0&&(t=Li);for(var r=0,n=e.length;r<n;r++){var i=e[r];if(i!=null){if(et(i)){t=Li;break}else if(dt(i)){t=mo;break}}}}else if(dt(e)){for(var a in e)if(nv(e,a)&&Ni(e[a])){t=rs;break}}return t}function jye(e,t,r,n,i){var a,o;if(!e)return{dimensionsDefine:KV(i),startIndex:o,dimensionsDetectedCount:a};if(t===Li){var s=e;n==="auto"||n==null?XV(function(u){u!=null&&u!=="-"&&(st(u)?o==null&&(o=1):o=0)},r,s,10):o=_r(n)?n:n?1:0,!i&&o===1&&(i=[],XV(function(u,f){i[f]=u!=null?u+"":""},r,s,1/0)),a=i?i.length:r===Cg?s.length:s[0]?s[0].length:null}else if(t===mo)i||(i=Wye(e));else if(t===rs)i||(i=[],le(e,function(u,f){i.push(f)}));else if(t===Da){var l=Ow(e[0]);a=et(l)&&l.length||1}return{startIndex:o,dimensionsDefine:KV(i),dimensionsDetectedCount:a}}function Wye(e){for(var t=0,r;t<e.length&&!(r=e[t++]););if(r)return Dr(r)}function KV(e){if(e){var t=Vt();return pt(e,function(r,n){r=dt(r)?r:{name:r};var i={name:r.name,displayName:r.displayName,type:r.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var a=t.get(i.name);return a?i.name+="-"+a.count++:t.set(i.name,{count:1}),i})}}function XV(e,t,r,n){if(t===Cg)for(var i=0;i<r.length&&i<n;i++)e(r[i]?r[i][0]:null,i);else for(var a=r[0]||[],i=0;i<a.length&&i<n;i++)e(a[i],i)}function aQ(e){var t=e.sourceFormat;return t===mo||t===rs}var vf,pf,gf,qV,ZV,oQ=function(){function e(t,r){var n=lL(t)?t:uL(t);this._source=n;var i=this._data=n.data;n.sourceFormat===cu&&(this._offset=0,this._dimSize=r,this._data=i),ZV(this,i,n)}return e.prototype.getSource=function(){return this._source},e.prototype.count=function(){return 0},e.prototype.getItem=function(t,r){},e.prototype.appendData=function(t){},e.prototype.clean=function(){},e.protoInitialize=function(){var t=e.prototype;t.pure=!1,t.persistent=!0}(),e.internalField=function(){var t;ZV=function(o,s,l){var u=l.sourceFormat,f=l.seriesLayoutBy,c=l.startIndex,h=l.dimensionsDefine,d=qV[fL(u,f)];if(Le(o,d),u===cu)o.getItem=r,o.count=i,o.fillStorage=n;else{var v=sQ(u,f);o.getItem=Or(v,null,s,c,h);var p=lQ(u,f);o.count=Or(p,null,s,c,h)}};var r=function(o,s){o=o-this._offset,s=s||[];for(var l=this._data,u=this._dimSize,f=u*o,c=0;c<u;c++)s[c]=l[f+c];return s},n=function(o,s,l,u){for(var f=this._data,c=this._dimSize,h=0;h<c;h++){for(var d=u[h],v=d[0]==null?1/0:d[0],p=d[1]==null?-1/0:d[1],g=s-o,y=l[h],m=0;m<g;m++){var b=f[m*c+h];y[o+m]=b,b<v&&(v=b),b>p&&(p=b)}d[0]=v,d[1]=p}},i=function(){return this._data?this._data.length/this._dimSize:0};qV=(t={},t[Li+"_"+al]={pure:!0,appendData:a},t[Li+"_"+Cg]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[mo]={pure:!0,appendData:a},t[rs]={pure:!0,appendData:function(o){var s=this._data;le(o,function(l,u){for(var f=s[u]||(s[u]=[]),c=0;c<(l||[]).length;c++)f.push(l[c])})}},t[Da]={appendData:a},t[cu]={persistent:!1,pure:!0,appendData:function(o){this._data=o},clean:function(){this._offset+=this.count(),this._data=null}},t);function a(o){for(var s=0;s<o.length;s++)this._data.push(o[s])}}(),e}(),JV=function(e,t,r,n){return e[n]},Uye=(vf={},vf[Li+"_"+al]=function(e,t,r,n){return e[n+t]},vf[Li+"_"+Cg]=function(e,t,r,n,i){n+=t;for(var a=i||[],o=e,s=0;s<o.length;s++){var l=o[s];a[s]=l?l[n]:null}return a},vf[mo]=JV,vf[rs]=function(e,t,r,n,i){for(var a=i||[],o=0;o<r.length;o++){var s=r[o].name,l=e[s];a[o]=l?l[n]:null}return a},vf[Da]=JV,vf);function sQ(e,t){var r=Uye[fL(e,t)];return r}var QV=function(e,t,r){return e.length},zye=(pf={},pf[Li+"_"+al]=function(e,t,r){return Math.max(0,e.length-t)},pf[Li+"_"+Cg]=function(e,t,r){var n=e[0];return n?Math.max(0,n.length-t):0},pf[mo]=QV,pf[rs]=function(e,t,r){var n=r[0].name,i=e[n];return i?i.length:0},pf[Da]=QV,pf);function lQ(e,t){var r=zye[fL(e,t)];return r}var $R=function(e,t,r){return e[t]},Gye=(gf={},gf[Li]=$R,gf[mo]=function(e,t,r){return e[r]},gf[rs]=$R,gf[Da]=function(e,t,r){var n=Ow(e);return n instanceof Array?n[t]:n},gf[cu]=$R,gf);function uQ(e){var t=Gye[e];return t}function fL(e,t){return e===Li?e+"_"+t:e}function ov(e,t,r){if(e){var n=e.getRawDataItem(t);if(n!=null){var i=e.getStore(),a=i.getSource().sourceFormat;if(r!=null){var o=e.getDimensionIndex(r),s=i.getDimensionProperty(o);return uQ(a)(n,o,s)}else{var l=n;return a===Da&&(l=Ow(n)),l}}}}var Yye=/\{@(.+?)\}/g,Kye=function(){function e(){}return e.prototype.getDataParams=function(t,r){var n=this.getData(r),i=this.getRawValue(t,r),a=n.getRawIndex(t),o=n.getName(t),s=n.getRawDataItem(t),l=n.getItemVisual(t,"style"),u=l&&l[n.getItemVisual(t,"drawType")||"fill"],f=l&&l.stroke,c=this.mainType,h=c==="series",d=n.userOutput&&n.userOutput.get();return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:h?this.subType:null,seriesIndex:this.seriesIndex,seriesId:h?this.id:null,seriesName:h?this.name:null,name:o,dataIndex:a,data:s,dataType:r,value:i,color:u,borderColor:f,dimensionNames:d?d.fullDimensions:null,encode:d?d.encode:null,$vars:["seriesName","name","value"]}},e.prototype.getFormattedLabel=function(t,r,n,i,a,o){r=r||"normal";var s=this.getData(n),l=this.getDataParams(t,n);if(o&&(l.value=o.interpolatedValue),i!=null&&et(l.value)&&(l.value=l.value[i]),!a){var u=s.getItemModel(t);a=u.get(r==="normal"?["label","formatter"]:[r,"label","formatter"])}if(Nt(a))return l.status=r,l.dimensionIndex=i,a(l);if(st(a)){var f=GJ(a,l);return f.replace(Yye,function(c,h){var d=h.length,v=h;v.charAt(0)==="["&&v.charAt(d-1)==="]"&&(v=+v.slice(1,d-1));var p=ov(s,t,v);if(o&&et(o.interpolatedValue)){var g=s.getDimensionIndex(v);g>=0&&(p=o.interpolatedValue[g])}return p!=null?p+"":""})}},e.prototype.getRawValue=function(t,r){return ov(this.getData(r),t)},e.prototype.formatTooltip=function(t,r,n){},e}();function ej(e){var t,r;return dt(e)?e.type&&(r=e):t=e,{text:t,frag:r}}function ym(e){return new Xye(e)}var Xye=function(){function e(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return e.prototype.perform=function(t){var r=this._upstream,n=t&&t.skip;if(this._dirty&&r){var i=this.context;i.data=i.outputData=r.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var a;this._plan&&!n&&(a=this._plan(this.context));var o=f(this._modBy),s=this._modDataCount||0,l=f(t&&t.modBy),u=t&&t.modDataCount||0;(o!==l||s!==u)&&(a="reset");function f(m){return!(m>=1)&&(m=1),m}var c;(this._dirty||a==="reset")&&(this._dirty=!1,c=this._doReset(n)),this._modBy=l,this._modDataCount=u;var h=t&&t.step;if(r?this._dueEnd=r._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var d=this._dueIndex,v=Math.min(h!=null?this._dueIndex+h:1/0,this._dueEnd);if(!n&&(c||d<v)){var p=this._progress;if(et(p))for(var g=0;g<p.length;g++)this._doProgress(p[g],d,v,l,u);else this._doProgress(p,d,v,l,u)}this._dueIndex=v;var y=this._settedOutputEnd!=null?this._settedOutputEnd:v;this._outputDueEnd=y}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},e.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},e.prototype._doProgress=function(t,r,n,i,a){tj.reset(r,n,i,a),this._callingProgress=t,this._callingProgress({start:r,end:n,count:n-r,next:tj.next},this.context)},e.prototype._doReset=function(t){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var r,n;!t&&this._reset&&(r=this._reset(this.context),r&&r.progress&&(n=r.forceFirstProgress,r=r.progress),et(r)&&!r.length&&(r=null)),this._progress=r,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),n},e.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},e.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},e.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},e.prototype.getUpstream=function(){return this._upstream},e.prototype.getDownstream=function(){return this._downstream},e.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},e}(),tj=function(){var e,t,r,n,i,a={reset:function(l,u,f,c){t=l,e=u,r=f,n=c,i=Math.ceil(n/r),a.next=r>1&&n>0?s:o}};return a;function o(){return t<e?t++:null}function s(){var l=t%i*r+Math.ceil(t/i),u=t>=e?null:l<n?l:t;return t++,u}}();function Y1(e,t){var r=t&&t.type;return r==="ordinal"?e:(r==="time"&&!_r(e)&&e!=null&&e!=="-"&&(e=+fl(e)),e==null||e===""?NaN:+e)}Vt({number:function(e){return parseFloat(e)},time:function(e){return+fl(e)},trim:function(e){return st(e)?Uo(e):e}});var qye=function(){function e(t,r){var n=t==="desc";this._resultLT=n?1:-1,r==null&&(r=n?"min":"max"),this._incomparable=r==="min"?-1/0:1/0}return e.prototype.evaluate=function(t,r){var n=_r(t)?t:JC(t),i=_r(r)?r:JC(r),a=isNaN(n),o=isNaN(i);if(a&&(n=this._incomparable),o&&(i=this._incomparable),a&&o){var s=st(t),l=st(r);s&&(n=l?t:0),l&&(i=s?r:0)}return n<i?this._resultLT:n>i?-this._resultLT:0},e}(),Zye=function(){function e(){}return e.prototype.getRawData=function(){throw new Error("not supported")},e.prototype.getRawDataItem=function(t){throw new Error("not supported")},e.prototype.cloneRawData=function(){},e.prototype.getDimensionInfo=function(t){},e.prototype.cloneAllDimensionInfo=function(){},e.prototype.count=function(){},e.prototype.retrieveValue=function(t,r){},e.prototype.retrieveValueFromItem=function(t,r){},e.prototype.convertValue=function(t,r){return Y1(t,r)},e}();function Jye(e,t){var r=new Zye,n=e.data,i=r.sourceFormat=e.sourceFormat,a=e.startIndex,o="";e.seriesLayoutBy!==al&&Pi(o);var s=[],l={},u=e.dimensionsDefine;if(u)le(u,function(p,g){var y=p.name,m={index:g,name:y,displayName:p.displayName};if(s.push(m),y!=null){var b="";nv(l,y)&&Pi(b),l[y]=m}});else for(var f=0;f<e.dimensionsDetectedCount;f++)s.push({index:f});var c=sQ(i,al);t.__isBuiltIn&&(r.getRawDataItem=function(p){return c(n,a,s,p)},r.getRawData=Or(Qye,null,e)),r.cloneRawData=Or(eme,null,e);var h=lQ(i,al);r.count=Or(h,null,n,a,s);var d=uQ(i);r.retrieveValue=function(p,g){var y=c(n,a,s,p);return v(y,g)};var v=r.retrieveValueFromItem=function(p,g){if(p!=null){var y=s[g];if(y)return d(p,g,y.name)}};return r.getDimensionInfo=Or(tme,null,s,l),r.cloneAllDimensionInfo=Or(rme,null,s),r}function Qye(e){var t=e.sourceFormat;if(!cL(t)){var r="";Pi(r)}return e.data}function eme(e){var t=e.sourceFormat,r=e.data;if(!cL(t)){var n="";Pi(n)}if(t===Li){for(var i=[],a=0,o=r.length;a<o;a++)i.push(r[a].slice());return i}else if(t===mo){for(var i=[],a=0,o=r.length;a<o;a++)i.push(Le({},r[a]));return i}}function tme(e,t,r){if(r!=null){if(_r(r)||!isNaN(r)&&!nv(t,r))return e[r];if(nv(t,r))return t[r]}}function rme(e){return Qt(e)}var fQ=Vt();function nme(e){e=Qt(e);var t=e.type,r="";t||Pi(r);var n=t.split(":");n.length!==2&&Pi(r);var i=!1;n[0]==="echarts"&&(t=n[1],i=!0),e.__isBuiltIn=i,fQ.set(t,e)}function ime(e,t,r){var n=gi(e),i=n.length,a="";i||Pi(a);for(var o=0,s=i;o<s;o++){var l=n[o];t=ame(l,t),o!==s-1&&(t.length=Math.max(t.length,1))}return t}function ame(e,t,r,n){var i="";t.length||Pi(i),dt(e)||Pi(i);var a=e.type,o=fQ.get(a);o||Pi(i);var s=pt(t,function(u){return Jye(u,o)}),l=gi(o.transform({upstream:s[0],upstreamList:s,config:Qt(e.config)}));return pt(l,function(u,f){var c="";dt(u)||Pi(c),u.data||Pi(c);var h=iQ(u.data);cL(h)||Pi(c);var d,v=t[0];if(v&&f===0&&!u.dimensions){var p=v.startIndex;p&&(u.data=v.data.slice(0,p).concat(u.data)),d={seriesLayoutBy:al,sourceHeader:p,dimensions:v.metaRawOption.dimensions}}else d={seriesLayoutBy:al,sourceHeader:0,dimensions:u.dimensions};return PI(u.data,d,null)})}function cL(e){return e===Li||e===mo}var yO="undefined",ome=typeof Uint32Array===yO?Array:Uint32Array,sme=typeof Uint16Array===yO?Array:Uint16Array,cQ=typeof Int32Array===yO?Array:Int32Array,rj=typeof Float64Array===yO?Array:Float64Array,hQ={float:rj,int:cQ,ordinal:Array,number:Array,time:rj},NR;function Qg(e){return e>65535?ome:sme}function Ah(){return[1/0,-1/0]}function lme(e){var t=e.constructor;return t===Array?e.slice():new t(e)}function nj(e,t,r,n,i){var a=hQ[r||"float"];if(i){var o=e[t],s=o&&o.length;if(s!==n){for(var l=new a(n),u=0;u<s;u++)l[u]=o[u];e[t]=l}}else e[t]=new a(n)}var II=function(){function e(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=Vt()}return e.prototype.initData=function(t,r,n){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=t.getSource(),a=this.defaultDimValueGetter=NR[i.sourceFormat];this._dimValueGetter=n||a,this._rawExtent=[],aQ(i),this._dimensions=pt(r,function(o){return{type:o.type,property:o.property}}),this._initDataFromProvider(0,t.count())},e.prototype.getProvider=function(){return this._provider},e.prototype.getSource=function(){return this._provider.getSource()},e.prototype.ensureCalculationDimension=function(t,r){var n=this._calcDimNameToIdx,i=this._dimensions,a=n.get(t);if(a!=null){if(i[a].type===r)return a}else a=i.length;return i[a]={type:r},n.set(t,a),this._chunks[a]=new hQ[r||"float"](this._rawCount),this._rawExtent[a]=Ah(),a},e.prototype.collectOrdinalMeta=function(t,r){var n=this._chunks[t],i=this._dimensions[t],a=this._rawExtent,o=i.ordinalOffset||0,s=n.length;o===0&&(a[t]=Ah());for(var l=a[t],u=o;u<s;u++){var f=n[u]=r.parseAndCollect(n[u]);isNaN(f)||(l[0]=Math.min(f,l[0]),l[1]=Math.max(f,l[1]))}i.ordinalMeta=r,i.ordinalOffset=s,i.type="ordinal"},e.prototype.getOrdinalMeta=function(t){var r=this._dimensions[t],n=r.ordinalMeta;return n},e.prototype.getDimensionProperty=function(t){var r=this._dimensions[t];return r&&r.property},e.prototype.appendData=function(t){var r=this._provider,n=this.count();r.appendData(t);var i=r.count();return r.persistent||(i+=n),n<i&&this._initDataFromProvider(n,i,!0),[n,i]},e.prototype.appendValues=function(t,r){for(var n=this._chunks,i=this._dimensions,a=i.length,o=this._rawExtent,s=this.count(),l=s+Math.max(t.length,r||0),u=0;u<a;u++){var f=i[u];nj(n,u,f.type,l,!0)}for(var c=[],h=s;h<l;h++)for(var d=h-s,v=0;v<a;v++){var f=i[v],p=NR.arrayRows.call(this,t[d]||c,f.property,d,v);n[v][h]=p;var g=o[v];p<g[0]&&(g[0]=p),p>g[1]&&(g[1]=p)}return this._rawCount=this._count=l,{start:s,end:l}},e.prototype._initDataFromProvider=function(t,r,n){for(var i=this._provider,a=this._chunks,o=this._dimensions,s=o.length,l=this._rawExtent,u=pt(o,function(m){return m.property}),f=0;f<s;f++){var c=o[f];l[f]||(l[f]=Ah()),nj(a,f,c.type,r,n)}if(i.fillStorage)i.fillStorage(t,r,a,l);else for(var h=[],d=t;d<r;d++){h=i.getItem(d,h);for(var v=0;v<s;v++){var p=a[v],g=this._dimValueGetter(h,u[v],d,v);p[d]=g;var y=l[v];g<y[0]&&(y[0]=g),g>y[1]&&(y[1]=g)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=r,this._extent=[]},e.prototype.count=function(){return this._count},e.prototype.get=function(t,r){if(!(r>=0&&r<this._count))return NaN;var n=this._chunks[t];return n?n[this.getRawIndex(r)]:NaN},e.prototype.getValues=function(t,r){var n=[],i=[];if(r==null){r=t,t=[];for(var a=0;a<this._dimensions.length;a++)i.push(a)}else i=t;for(var a=0,o=i.length;a<o;a++)n.push(this.get(i[a],r));return n},e.prototype.getByRawIndex=function(t,r){if(!(r>=0&&r<this._rawCount))return NaN;var n=this._chunks[t];return n?n[r]:NaN},e.prototype.getSum=function(t){var r=this._chunks[t],n=0;if(r)for(var i=0,a=this.count();i<a;i++){var o=this.get(t,i);isNaN(o)||(n+=o)}return n},e.prototype.getMedian=function(t){var r=[];this.each([t],function(a){isNaN(a)||r.push(a)});var n=r.sort(function(a,o){return a-o}),i=this.count();return i===0?0:i%2===1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},e.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var r=this._indices,n=r[t];if(n!=null&&n<this._count&&n===t)return t;for(var i=0,a=this._count-1;i<=a;){var o=(i+a)/2|0;if(r[o]<t)i=o+1;else if(r[o]>t)a=o-1;else return o}return-1},e.prototype.indicesOfNearest=function(t,r,n){var i=this._chunks,a=i[t],o=[];if(!a)return o;n==null&&(n=1/0);for(var s=1/0,l=-1,u=0,f=0,c=this.count();f<c;f++){var h=this.getRawIndex(f),d=r-a[h],v=Math.abs(d);v<=n&&((v<s||v===s&&d>=0&&l<0)&&(s=v,l=d,u=0),d===l&&(o[u++]=f))}return o.length=u,o},e.prototype.getIndices=function(){var t,r=this._indices;if(r){var n=r.constructor,i=this._count;if(n===Array){t=new n(i);for(var a=0;a<i;a++)t[a]=r[a]}else t=new n(r.buffer,0,i)}else{var n=Qg(this._rawCount);t=new n(this.count());for(var a=0;a<t.length;a++)t[a]=a}return t},e.prototype.filter=function(t,r){if(!this._count)return this;for(var n=this.clone(),i=n.count(),a=Qg(n._rawCount),o=new a(i),s=[],l=t.length,u=0,f=t[0],c=n._chunks,h=0;h<i;h++){var d=void 0,v=n.getRawIndex(h);if(l===0)d=r(h);else if(l===1){var p=c[f][v];d=r(p,h)}else{for(var g=0;g<l;g++)s[g]=c[t[g]][v];s[g]=h,d=r.apply(null,s)}d&&(o[u++]=v)}return u<i&&(n._indices=o),n._count=u,n._extent=[],n._updateGetRawIdx(),n},e.prototype.selectRange=function(t){var r=this.clone(),n=r._count;if(!n)return this;var i=Dr(t),a=i.length;if(!a)return this;var o=r.count(),s=Qg(r._rawCount),l=new s(o),u=0,f=i[0],c=t[f][0],h=t[f][1],d=r._chunks,v=!1;if(!r._indices){var p=0;if(a===1){for(var g=d[i[0]],y=0;y<n;y++){var m=g[y];(m>=c&&m<=h||isNaN(m))&&(l[u++]=p),p++}v=!0}else if(a===2){for(var g=d[i[0]],b=d[i[1]],_=t[i[1]][0],x=t[i[1]][1],y=0;y<n;y++){var m=g[y],T=b[y];(m>=c&&m<=h||isNaN(m))&&(T>=_&&T<=x||isNaN(T))&&(l[u++]=p),p++}v=!0}}if(!v)if(a===1)for(var y=0;y<o;y++){var E=r.getRawIndex(y),m=d[i[0]][E];(m>=c&&m<=h||isNaN(m))&&(l[u++]=E)}else for(var y=0;y<o;y++){for(var P=!0,E=r.getRawIndex(y),R=0;R<a;R++){var M=i[R],m=d[M][E];(m<t[M][0]||m>t[M][1])&&(P=!1)}P&&(l[u++]=r.getRawIndex(y))}return u<o&&(r._indices=l),r._count=u,r._extent=[],r._updateGetRawIdx(),r},e.prototype.map=function(t,r){var n=this.clone(t);return this._updateDims(n,t,r),n},e.prototype.modify=function(t,r){this._updateDims(this,t,r)},e.prototype._updateDims=function(t,r,n){for(var i=t._chunks,a=[],o=r.length,s=t.count(),l=[],u=t._rawExtent,f=0;f<r.length;f++)u[r[f]]=Ah();for(var c=0;c<s;c++){for(var h=t.getRawIndex(c),d=0;d<o;d++)l[d]=i[r[d]][h];l[o]=c;var v=n&&n.apply(null,l);if(v!=null){typeof v!="object"&&(a[0]=v,v=a);for(var f=0;f<v.length;f++){var p=r[f],g=v[f],y=u[p],m=i[p];m&&(m[h]=g),g<y[0]&&(y[0]=g),g>y[1]&&(y[1]=g)}}}},e.prototype.lttbDownSample=function(t,r){var n=this.clone([t],!0),i=n._chunks,a=i[t],o=this.count(),s=0,l=Math.floor(1/r),u=this.getRawIndex(0),f,c,h,d=new(Qg(this._rawCount))(Math.min((Math.ceil(o/l)+2)*2,o));d[s++]=u;for(var v=1;v<o-1;v+=l){for(var p=Math.min(v+l,o-1),g=Math.min(v+l*2,o),y=(g+p)/2,m=0,b=p;b<g;b++){var _=this.getRawIndex(b),x=a[_];isNaN(x)||(m+=x)}m/=g-p;var T=v,E=Math.min(v+l,o),P=v-1,R=a[u];f=-1,h=T;for(var M=-1,D=0,b=T;b<E;b++){var _=this.getRawIndex(b),x=a[_];if(isNaN(x)){D++,M<0&&(M=_);continue}c=Math.abs((P-y)*(x-R)-(P-b)*(m-R)),c>f&&(f=c,h=_)}D>0&&D<E-T&&(d[s++]=Math.min(M,h),h=Math.max(M,h)),d[s++]=h,u=h}return d[s++]=this.getRawIndex(o-1),n._count=s,n._indices=d,n.getRawIndex=this._getRawIdx,n},e.prototype.downSample=function(t,r,n,i){for(var a=this.clone([t],!0),o=a._chunks,s=[],l=Math.floor(1/r),u=o[t],f=this.count(),c=a._rawExtent[t]=Ah(),h=new(Qg(this._rawCount))(Math.ceil(f/l)),d=0,v=0;v<f;v+=l){l>f-v&&(l=f-v,s.length=l);for(var p=0;p<l;p++){var g=this.getRawIndex(v+p);s[p]=u[g]}var y=n(s),m=this.getRawIndex(Math.min(v+i(s,y)||0,f-1));u[m]=y,y<c[0]&&(c[0]=y),y>c[1]&&(c[1]=y),h[d++]=m}return a._count=d,a._indices=h,a._updateGetRawIdx(),a},e.prototype.each=function(t,r){if(this._count)for(var n=t.length,i=this._chunks,a=0,o=this.count();a<o;a++){var s=this.getRawIndex(a);switch(n){case 0:r(a);break;case 1:r(i[t[0]][s],a);break;case 2:r(i[t[0]][s],i[t[1]][s],a);break;default:for(var l=0,u=[];l<n;l++)u[l]=i[t[l]][s];u[l]=a,r.apply(null,u)}}},e.prototype.getDataExtent=function(t){var r=this._chunks[t],n=Ah();if(!r)return n;var i=this.count(),a=!this._indices,o;if(a)return this._rawExtent[t].slice();if(o=this._extent[t],o)return o.slice();o=n;for(var s=o[0],l=o[1],u=0;u<i;u++){var f=this.getRawIndex(u),c=r[f];c<s&&(s=c),c>l&&(l=c)}return o=[s,l],this._extent[t]=o,o},e.prototype.getRawDataItem=function(t){var r=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(r);for(var n=[],i=this._chunks,a=0;a<i.length;a++)n.push(i[a][r]);return n},e.prototype.clone=function(t,r){var n=new e,i=this._chunks,a=t&&ku(t,function(s,l){return s[l]=!0,s},{});if(a)for(var o=0;o<i.length;o++)n._chunks[o]=a[o]?lme(i[o]):i[o];else n._chunks=i;return this._copyCommonProps(n),r||(n._indices=this._cloneIndices()),n._updateGetRawIdx(),n},e.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=Qt(this._extent),t._rawExtent=Qt(this._rawExtent)},e.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,r=void 0;if(t===Array){var n=this._indices.length;r=new t(n);for(var i=0;i<n;i++)r[i]=this._indices[i]}else r=new t(this._indices);return r}return null},e.prototype._getRawIdxIdentity=function(t){return t},e.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},e.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},e.internalField=function(){function t(r,n,i,a){return Y1(r[a],this._dimensions[a])}NR={arrayRows:t,objectRows:function(r,n,i,a){return Y1(r[n],this._dimensions[a])},keyedColumns:t,original:function(r,n,i,a){var o=r&&(r.value==null?r:r.value);return Y1(o instanceof Array?o[a]:o,this._dimensions[a])},typedArray:function(r,n,i,a){return r[a]}}}(),e}(),ume=function(){function e(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return e.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},e.prototype._setLocalSource=function(t,r){this._sourceList=t,this._upstreamSignList=r,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},e.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},e.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},e.prototype._createSource=function(){this._setLocalSource([],[]);var t=this._sourceHost,r=this._getUpstreamSourceManagers(),n=!!r.length,i,a;if(eS(t)){var o=t,s=void 0,l=void 0,u=void 0;if(n){var f=r[0];f.prepareSource(),u=f.getSource(),s=u.data,l=u.sourceFormat,a=[f._getVersionSign()]}else s=o.get("data",!0),l=ta(s)?cu:Da,a=[];var c=this._getSourceMetaRawOption()||{},h=u&&u.metaRawOption||{},d=Xt(c.seriesLayoutBy,h.seriesLayoutBy)||null,v=Xt(c.sourceHeader,h.sourceHeader),p=Xt(c.dimensions,h.dimensions),g=d!==h.seriesLayoutBy||!!v!=!!h.sourceHeader||p;i=g?[PI(s,{seriesLayoutBy:d,sourceHeader:v,dimensions:p},l)]:[]}else{var y=t;if(n){var m=this._applyTransform(r);i=m.sourceList,a=m.upstreamSignList}else{var b=y.get("source",!0);i=[PI(b,this._getSourceMetaRawOption(),null)],a=[]}}this._setLocalSource(i,a)},e.prototype._applyTransform=function(t){var r=this._sourceHost,n=r.get("transform",!0),i=r.get("fromTransformResult",!0);if(i!=null){var a="";t.length!==1&&ij(a)}var o,s=[],l=[];return le(t,function(u){u.prepareSource();var f=u.getSource(i||0),c="";i!=null&&!f&&ij(c),s.push(f),l.push(u._getVersionSign())}),n?o=ime(n,s,{datasetIndex:r.componentIndex}):i!=null&&(o=[Vye(s[0])]),{sourceList:o,upstreamSignList:l}},e.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),r=0;r<t.length;r++){var n=t[r];if(n._isDirty()||this._upstreamSignList[r]!==n._getVersionSign())return!0}},e.prototype.getSource=function(t){t=t||0;var r=this._sourceList[t];if(!r){var n=this._getUpstreamSourceManagers();return n[0]&&n[0].getSource(t)}return r},e.prototype.getSharedDataStore=function(t){var r=t.makeStoreSchema();return this._innerGetDataStore(r.dimensions,t.source,r.hash)},e.prototype._innerGetDataStore=function(t,r,n){var i=0,a=this._storeList,o=a[i];o||(o=a[i]={});var s=o[n];if(!s){var l=this._getUpstreamSourceManagers()[0];eS(this._sourceHost)&&l?s=l._innerGetDataStore(t,r,n):(s=new II,s.initData(new oQ(r,t.length),t)),o[n]=s}return s},e.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(eS(t)){var r=aL(t);return r?[r.getSourceManager()]:[]}else return pt(dye(t),function(n){return n.getSourceManager()})},e.prototype._getSourceMetaRawOption=function(){var t=this._sourceHost,r,n,i;if(eS(t))r=t.get("seriesLayoutBy",!0),n=t.get("sourceHeader",!0),i=t.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=t;r=a.get("seriesLayoutBy",!0),n=a.get("sourceHeader",!0),i=a.get("dimensions",!0)}return{seriesLayoutBy:r,sourceHeader:n,dimensions:i}},e}();function eS(e){return e.mainType==="series"}function ij(e){throw new Error(e)}var dQ="line-height:1";function vQ(e,t){var r=e.color||"#6e7079",n=e.fontSize||12,i=e.fontWeight||"400",a=e.color||"#464646",o=e.fontSize||14,s=e.fontWeight||"900";return t==="html"?{nameStyle:"font-size:"+wa(n+"")+"px;color:"+wa(r)+";font-weight:"+wa(i+""),valueStyle:"font-size:"+wa(o+"")+"px;color:"+wa(a)+";font-weight:"+wa(s+"")}:{nameStyle:{fontSize:n,fill:r,fontWeight:i},valueStyle:{fontSize:o,fill:a,fontWeight:s}}}var fme=[0,10,20,30],cme=["",`
`,`

`,`


`];function a0(e,t){return t.type=e,t}function MI(e){return e.type==="section"}function pQ(e){return MI(e)?hme:dme}function gQ(e){if(MI(e)){var t=0,r=e.blocks.length,n=r>1||r>0&&!e.noHeader;return le(e.blocks,function(i){var a=gQ(i);a>=t&&(t=a+ +(n&&(!a||MI(i)&&!i.noHeader)))}),t}return 0}function hme(e,t,r,n){var i=t.noHeader,a=vme(gQ(t)),o=[],s=t.blocks||[];ul(!s||et(s)),s=s||[];var l=e.orderMode;if(t.sortBlocks&&l){s=s.slice();var u={valueAsc:"asc",valueDesc:"desc"};if(nv(u,l)){var f=new qye(u[l],null);s.sort(function(v,p){return f.evaluate(v.sortParam,p.sortParam)})}else l==="seriesDesc"&&s.reverse()}le(s,function(v,p){var g=t.valueFormatter,y=pQ(v)(g?Le(Le({},e),{valueFormatter:g}):e,v,p>0?a.html:0,n);y!=null&&o.push(y)});var c=e.renderMode==="richText"?o.join(a.richText):DI(o.join(""),i?r:a.html);if(i)return c;var h=AI(t.header,"ordinal",e.useUTC),d=vQ(n,e.renderMode).nameStyle;return e.renderMode==="richText"?yQ(e,h,d)+a.richText+c:DI('<div style="'+d+";"+dQ+';">'+wa(h)+"</div>"+c,r)}function dme(e,t,r,n){var i=e.renderMode,a=t.noName,o=t.noValue,s=!t.markerType,l=t.name,u=e.useUTC,f=t.valueFormatter||e.valueFormatter||function(_){return _=et(_)?_:[_],pt(_,function(x,T){return AI(x,et(d)?d[T]:d,u)})};if(!(a&&o)){var c=s?"":e.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",i),h=a?"":AI(l,"ordinal",u),d=t.valueType,v=o?[]:f(t.value),p=!s||!a,g=!s&&a,y=vQ(n,i),m=y.nameStyle,b=y.valueStyle;return i==="richText"?(s?"":c)+(a?"":yQ(e,h,m))+(o?"":yme(e,v,p,g,b)):DI((s?"":c)+(a?"":pme(h,!s,m))+(o?"":gme(v,p,g,b)),r)}}function aj(e,t,r,n,i,a){if(e){var o=pQ(e),s={useUTC:i,renderMode:r,orderMode:n,markupStyleCreator:t,valueFormatter:e.valueFormatter};return o(s,e,0,a)}}function vme(e){return{html:fme[e],richText:cme[e]}}function DI(e,t){var r='<div style="clear:both"></div>',n="margin: "+t+"px 0 0";return'<div style="'+n+";"+dQ+';">'+e+r+"</div>"}function pme(e,t,r){var n=t?"margin-left:2px":"";return'<span style="'+r+";"+n+'">'+wa(e)+"</span>"}function gme(e,t,r,n){var i=r?"10px":"20px",a=t?"float:right;margin-left:"+i:"";return e=et(e)?e:[e],'<span style="'+a+";"+n+'">'+pt(e,function(o){return wa(o)}).join("&nbsp;&nbsp;")+"</span>"}function yQ(e,t,r){return e.markupStyleCreator.wrapRichTextStyle(t,r)}function yme(e,t,r,n,i){var a=[i],o=n?10:20;return r&&a.push({padding:[0,0,0,o],align:"right"}),e.markupStyleCreator.wrapRichTextStyle(et(t)?t.join("  "):t,a)}function mme(e,t){var r=e.getData().getItemVisual(t,"style"),n=r[e.visualDrawType];return Ic(n)}function mQ(e,t){var r=e.get("padding");return r??(t==="richText"?[8,10]:10)}var LR=function(){function e(){this.richTextStyles={},this._nextStyleNameId=PZ()}return e.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},e.prototype.makeTooltipMarker=function(t,r,n){var i=n==="richText"?this._generateStyleName():null,a=iye({color:r,type:t,renderMode:n,markerId:i});return st(a)?a:(this.richTextStyles[i]=a.style,a.content)},e.prototype.wrapRichTextStyle=function(t,r){var n={};et(r)?le(r,function(a){return Le(n,a)}):Le(n,r);var i=this._generateStyleName();return this.richTextStyles[i]=n,"{"+i+"|"+t+"}"},e}();function bme(e){var t=e.series,r=e.dataIndex,n=e.multipleSeries,i=t.getData(),a=i.mapDimensionsAll("defaultedTooltip"),o=a.length,s=t.getRawValue(r),l=et(s),u=mme(t,r),f,c,h,d;if(o>1||l&&!o){var v=wme(s,t,r,a,u);f=v.inlineValues,c=v.inlineValueTypes,h=v.blocks,d=v.inlineValues[0]}else if(o){var p=i.getDimensionInfo(a[0]);d=f=ov(i,r,a[0]),c=p.type}else d=f=l?s[0]:s;var g=FN(t),y=g&&t.name||"",m=i.getName(r),b=n?y:m;return a0("section",{header:y,noHeader:n||!g,sortParam:d,blocks:[a0("nameValue",{markerType:"item",markerColor:u,name:b,noName:!Uo(b),value:f,valueType:c})].concat(h||[])})}function wme(e,t,r,n,i){var a=t.getData(),o=ku(e,function(c,h,d){var v=a.getDimensionInfo(d);return c=c||v&&v.tooltip!==!1&&v.displayName!=null},!1),s=[],l=[],u=[];n.length?le(n,function(c){f(ov(a,r,c),c)}):le(e,f);function f(c,h){var d=a.getDimensionInfo(h);!d||d.otherDims.tooltip===!1||(o?u.push(a0("nameValue",{markerType:"subItem",markerColor:i,name:d.displayName,value:c,valueType:d.type})):(s.push(c),l.push(d.type)))}return{inlineValues:s,inlineValueTypes:l,blocks:u}}var Al=pn();function tS(e,t){return e.getName(t)||e.getId(t)}var _me="__universalTransitionEnabled",mO=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._selectedDataIndicesMap={},r}return t.prototype.init=function(r,n,i){this.seriesIndex=this.componentIndex,this.dataTask=ym({count:Cme,reset:xme}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(r,i);var a=Al(this).sourceManager=new ume(this);a.prepareSource();var o=this.getInitialData(r,i);sj(o,this),this.dataTask.context.data=o,Al(this).dataBeforeProcessed=o,oj(this),this._initSelectedMapFromData(o)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=n0(this),a=i?pO(r):{},o=this.subType;Pr.hasClass(o)&&(o+="Series"),ar(r,n.getTheme().get(this.subType)),ar(r,this.getDefaultOption()),mI(r,"label",["show"]),this.fillDataTextStyle(r.data),i&&av(r,a,i)},t.prototype.mergeOption=function(r,n){r=ar(this.option,r,!0),this.fillDataTextStyle(r.data);var i=n0(this);i&&av(this.option,r,i);var a=Al(this).sourceManager;a.dirty(),a.prepareSource();var o=this.getInitialData(r,n);sj(o,this),this.dataTask.dirty(),this.dataTask.context.data=o,Al(this).dataBeforeProcessed=o,oj(this),this._initSelectedMapFromData(o)},t.prototype.fillDataTextStyle=function(r){if(r&&!ta(r))for(var n=["show"],i=0;i<r.length;i++)r[i]&&r[i].label&&mI(r[i],"label",n)},t.prototype.getInitialData=function(r,n){},t.prototype.appendData=function(r){var n=this.getRawData();n.appendData(r.data)},t.prototype.getData=function(r){var n=$I(this);if(n){var i=n.context.data;return r==null?i:i.getLinkedData(r)}else return Al(this).data},t.prototype.getAllData=function(){var r=this.getData();return r&&r.getLinkedDataAll?r.getLinkedDataAll():[{data:r}]},t.prototype.setData=function(r){var n=$I(this);if(n){var i=n.context;i.outputData=r,n!==this.dataTask&&(i.data=r)}Al(this).data=r},t.prototype.getEncode=function(){var r=this.get("encode",!0);if(r)return Vt(r)},t.prototype.getSourceManager=function(){return Al(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return Al(this).dataBeforeProcessed},t.prototype.getColorBy=function(){var r=this.get("colorBy");return r||"series"},t.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},t.prototype.getBaseAxis=function(){var r=this.coordinateSystem;return r&&r.getBaseAxis&&r.getBaseAxis()},t.prototype.formatTooltip=function(r,n,i){return bme({series:this,dataIndex:r,multipleSeries:n})},t.prototype.isAnimationEnabled=function(){var r=this.ecModel;if(Bt.node&&!(r&&r.ssr))return!1;var n=this.getShallow("animation");return n&&this.getData().count()>this.getShallow("animationThreshold")&&(n=!1),!!n},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(r,n,i){var a=this.ecModel,o=oL.prototype.getColorFromPalette.call(this,r,n,i);return o||(o=a.getColorFromPalette(r,n,i)),o},t.prototype.coordDimToDataDim=function(r){return this.getRawData().mapDimensionsAll(r)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(r,n){this._innerSelect(this.getData(n),r)},t.prototype.unselect=function(r,n){var i=this.option.selectedMap;if(i){var a=this.option.selectedMode,o=this.getData(n);if(a==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var s=0;s<r.length;s++){var l=r[s],u=tS(o,l);i[u]=!1,this._selectedDataIndicesMap[u]=-1}}},t.prototype.toggleSelect=function(r,n){for(var i=[],a=0;a<r.length;a++)i[0]=r[a],this.isSelected(r[a],n)?this.unselect(i,n):this.select(i,n)},t.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var r=this._selectedDataIndicesMap,n=Dr(r),i=[],a=0;a<n.length;a++){var o=r[n[a]];o>=0&&i.push(o)}return i},t.prototype.isSelected=function(r,n){var i=this.option.selectedMap;if(!i)return!1;var a=this.getData(n);return(i==="all"||i[tS(a,r)])&&!a.getItemModel(r).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[_me])return!0;var r=this.option.universalTransition;return r?r===!0?!0:r&&r.enabled:!1},t.prototype._innerSelect=function(r,n){var i,a,o=this.option,s=o.selectedMode,l=n.length;if(!(!s||!l)){if(s==="series")o.selectedMap="all";else if(s==="multiple"){dt(o.selectedMap)||(o.selectedMap={});for(var u=o.selectedMap,f=0;f<l;f++){var c=n[f],h=tS(r,c);u[h]=!0,this._selectedDataIndicesMap[h]=r.getRawIndex(c)}}else if(s==="single"||s===!0){var d=n[l-1],h=tS(r,d);o.selectedMap=(i={},i[h]=!0,i),this._selectedDataIndicesMap=(a={},a[h]=r.getRawIndex(d),a)}}},t.prototype._initSelectedMapFromData=function(r){if(!this.option.selectedMap){var n=[];r.hasItemOption&&r.each(function(i){var a=r.getRawDataItem(i);a&&a.selected&&n.push(i)}),n.length>0&&this._innerSelect(r,n)}},t.registerClass=function(r){return Pr.registerClass(r)},t.protoInitialize=function(){var r=t.prototype;r.type="series.__base__",r.seriesIndex=0,r.ignoreStyleOnData=!1,r.hasSymbolVisual=!1,r.defaultSymbol="circle",r.visualStyleAccessPath="itemStyle",r.visualDrawType="fill"}(),t}(Pr);es(mO,Kye);es(mO,oL);LZ(mO,Pr);function oj(e){var t=e.name;FN(e)||(e.name=Sme(e)||t)}function Sme(e){var t=e.getRawData(),r=t.mapDimensionsAll("seriesName"),n=[];return le(r,function(i){var a=t.getDimensionInfo(i);a.displayName&&n.push(a.displayName)}),n.join(" ")}function Cme(e){return e.model.getRawData().count()}function xme(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),Tme}function Tme(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function sj(e,t){le(whe(e.CHANGABLE_METHODS,e.DOWNSAMPLE_METHODS),function(r){e.wrapMethod(r,en(Ome,t))})}function Ome(e,t){var r=$I(e);return r&&r.setOutputEnd((t||this).count()),t}function $I(e){var t=(e.ecModel||{}).scheduler,r=t&&t.getPipeline(e.uid);if(r){var n=r.currentTask;if(n){var i=n.agentStubMap;i&&(n=i.get(e.uid))}return n}}const Mu=mO;var hL=function(){function e(){this.group=new Kn,this.uid=lO("viewComponent")}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){},e.prototype.updateLayout=function(t,r,n,i){},e.prototype.updateVisual=function(t,r,n,i){},e.prototype.toggleBlurSeries=function(t,r,n){},e.prototype.eachRendered=function(t){var r=this.group;r&&r.traverse(t)},e}();BN(hL);JT(hL);const cl=hL;function dL(){var e=pn();return function(t){var r=e(t),n=t.pipelineContext,i=!!r.large,a=!!r.progressiveRender,o=r.large=!!(n&&n.large),s=r.progressiveRender=!!(n&&n.progressiveRender);return(i!==o||a!==s)&&"reset"}}var bQ=pn(),Eme=dL(),vL=function(){function e(){this.group=new Kn,this.uid=lO("viewChart"),this.renderTask=ym({plan:Rme,reset:kme}),this.renderTask.context={view:this}}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.highlight=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&uj(a,i,"emphasis")},e.prototype.downplay=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&uj(a,i,"normal")},e.prototype.remove=function(t,r){this.group.removeAll()},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateLayout=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateVisual=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.eachRendered=function(t){aO(this.group,t)},e.markUpdateMethod=function(t,r){bQ(t).updateMethod=r},e.protoInitialize=function(){var t=e.prototype;t.type="chart"}(),e}();function lj(e,t,r){e&&OI(e)&&(t==="emphasis"?ex:tx)(e,r)}function uj(e,t,r){var n=Ac(e,t),i=t&&t.highlightKey!=null?$pe(t.highlightKey):null;n!=null?le(gi(n),function(a){lj(e.getItemGraphicEl(a),r,i)}):e.eachItemGraphicEl(function(a){lj(a,r,i)})}BN(vL);JT(vL);function Rme(e){return Eme(e.model)}function kme(e){var t=e.model,r=e.ecModel,n=e.api,i=e.payload,a=t.pipelineContext.progressiveRender,o=e.view,s=i&&bQ(i).updateMethod,l=a?"incrementalPrepareRender":s&&o[s]?s:"render";return l!=="render"&&o[l](t,r,n,i),Ame[l]}var Ame={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}};const Xo=vL;var ux="\0__throttleOriginMethod",fj="\0__throttleRate",cj="\0__throttleType";function bO(e,t,r){var n,i=0,a=0,o=null,s,l,u,f;t=t||0;function c(){a=new Date().getTime(),o=null,e.apply(l,u||[])}var h=function(){for(var d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];n=new Date().getTime(),l=this,u=d;var p=f||t,g=f||r;f=null,s=n-(g?i:a)-p,clearTimeout(o),g?o=setTimeout(c,p):s>=0?c():o=setTimeout(c,-s),i=n};return h.clear=function(){o&&(clearTimeout(o),o=null)},h.debounceNextCall=function(d){f=d},h}function wQ(e,t,r,n){var i=e[t];if(i){var a=i[ux]||i,o=i[cj],s=i[fj];if(s!==r||o!==n){if(r==null||!n)return e[t]=a;i=e[t]=bO(a,r,n==="debounce"),i[ux]=a,i[cj]=n,i[fj]=r}return i}}function NI(e,t){var r=e[t];r&&r[ux]&&(r.clear&&r.clear(),e[t]=r[ux])}var hj=pn(),dj={itemStyle:Jm(IJ,!0),lineStyle:Jm(PJ,!0)},Pme={lineStyle:"stroke",itemStyle:"fill"};function _Q(e,t){var r=e.visualStyleMapper||dj[t];return r||(console.warn("Unknown style type '"+t+"'."),dj.itemStyle)}function SQ(e,t){var r=e.visualDrawType||Pme[t];return r||(console.warn("Unknown style type '"+t+"'."),"fill")}var Ime={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=e.getModel(n),a=_Q(e,n),o=a(i),s=i.getShallow("decal");s&&(r.setVisual("decal",s),s.dirty=!0);var l=SQ(e,n),u=o[l],f=Nt(u)?u:null,c=o.fill==="auto"||o.stroke==="auto";if(!o[l]||f||c){var h=e.getColorFromPalette(e.name,null,t.getSeriesCount());o[l]||(o[l]=h,r.setVisual("colorFromPalette",!0)),o.fill=o.fill==="auto"||Nt(o.fill)?h:o.fill,o.stroke=o.stroke==="auto"||Nt(o.stroke)?h:o.stroke}if(r.setVisual("style",o),r.setVisual("drawType",l),!t.isSeriesFiltered(e)&&f)return r.setVisual("colorFromPalette",!1),{dataEach:function(d,v){var p=e.getDataParams(v),g=Le({},o);g[l]=f(p),d.setItemVisual(v,"style",g)}}}},ey=new Un,Mme={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!(e.ignoreStyleOnData||t.isSeriesFiltered(e))){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=_Q(e,n),a=r.getVisual("drawType");return{dataEach:r.hasItemOption?function(o,s){var l=o.getRawDataItem(s);if(l&&l[n]){ey.option=l[n];var u=i(ey),f=o.ensureUniqueItemVisual(s,"style");Le(f,u),ey.option.decal&&(o.setItemVisual(s,"decal",ey.option.decal),ey.option.decal.dirty=!0),a in u&&o.setItemVisual(s,"colorFromPalette",!1)}}:null}}}},Dme={performRawSeries:!0,overallReset:function(e){var t=Vt();e.eachSeries(function(r){var n=r.getColorBy();if(!r.isColorBySeries()){var i=r.type+"-"+n,a=t.get(i);a||(a={},t.set(i,a)),hj(r).scope=a}}),e.eachSeries(function(r){if(!(r.isColorBySeries()||e.isSeriesFiltered(r))){var n=r.getRawData(),i={},a=r.getData(),o=hj(r).scope,s=r.visualStyleAccessPath||"itemStyle",l=SQ(r,s);a.each(function(u){var f=a.getRawIndex(u);i[f]=u}),n.each(function(u){var f=i[u],c=a.getItemVisual(f,"colorFromPalette");if(c){var h=a.ensureUniqueItemVisual(f,"style"),d=n.getName(u)||u+"",v=n.count();h[l]=r.getColorFromPalette(d,o,v)}})}})}},rS=Math.PI;function $me(e,t){t=t||{},lr(t,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var r=new Kn,n=new _n({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});r.add(n);var i=new Xn({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),a=new _n({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});r.add(a);var o;return t.showSpinner&&(o=new GN({shape:{startAngle:-rS/2,endAngle:-rS/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001}),o.animateShape(!0).when(1e3,{endAngle:rS*3/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:rS*3/2}).delay(300).start("circularInOut"),r.add(o)),r.resize=function(){var s=i.getBoundingRect().width,l=t.showSpinner?t.spinnerRadius:0,u=(e.getWidth()-l*2-(t.showSpinner&&s?10:0)-s)/2-(t.showSpinner&&s?0:5+s/2)+(t.showSpinner?0:s/2)+(s?0:l),f=e.getHeight()/2;t.showSpinner&&o.setShape({cx:u,cy:f}),a.setShape({x:u-l,y:f-l,width:l*2,height:l*2}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},r.resize(),r}var Nme=function(){function e(t,r,n,i){this._stageTaskMap=Vt(),this.ecInstance=t,this.api=r,n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=n.concat(i)}return e.prototype.restoreData=function(t,r){t.restoreData(r),this._stageTaskMap.each(function(n){var i=n.overallTask;i&&i.dirty()})},e.prototype.getPerformArgs=function(t,r){if(t.__pipeline){var n=this._pipelineMap.get(t.__pipeline.id),i=n.context,a=!r&&n.progressiveEnabled&&(!i||i.progressiveRender)&&t.__idxInPipeline>n.blockIndex,o=a?n.step:null,s=i&&i.modDataCount,l=s!=null?Math.ceil(s/o):null;return{step:o,modBy:l,modDataCount:s}}},e.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},e.prototype.updateStreamModes=function(t,r){var n=this._pipelineMap.get(t.uid),i=t.getData(),a=i.count(),o=n.progressiveEnabled&&r.incrementalPrepareRender&&a>=n.threshold,s=t.get("large")&&a>=t.get("largeThreshold"),l=t.get("progressiveChunkMode")==="mod"?a:null;t.pipelineContext=n.context={progressiveRender:o,modDataCount:l,large:s}},e.prototype.restorePipelines=function(t){var r=this,n=r._pipelineMap=Vt();t.eachSeries(function(i){var a=i.getProgressive(),o=i.uid;n.set(o,{id:o,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:a&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(a||700),count:0}),r._pipe(i,i.dataTask)})},e.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,r=this.api.getModel(),n=this.api;le(this._allHandlers,function(i){var a=t.get(i.uid)||t.set(i.uid,{}),o="";ul(!(i.reset&&i.overallReset),o),i.reset&&this._createSeriesStageTask(i,a,r,n),i.overallReset&&this._createOverallStageTask(i,a,r,n)},this)},e.prototype.prepareView=function(t,r,n,i){var a=t.renderTask,o=a.context;o.model=r,o.ecModel=n,o.api=i,a.__block=!t.incrementalPrepareRender,this._pipe(r,a)},e.prototype.performDataProcessorTasks=function(t,r){this._performStageTasks(this._dataProcessorHandlers,t,r,{block:!0})},e.prototype.performVisualTasks=function(t,r,n){this._performStageTasks(this._visualHandlers,t,r,n)},e.prototype._performStageTasks=function(t,r,n,i){i=i||{};var a=!1,o=this;le(t,function(l,u){if(!(i.visualType&&i.visualType!==l.visualType)){var f=o._stageTaskMap.get(l.uid),c=f.seriesTaskMap,h=f.overallTask;if(h){var d,v=h.agentStubMap;v.each(function(g){s(i,g)&&(g.dirty(),d=!0)}),d&&h.dirty(),o.updatePayload(h,n);var p=o.getPerformArgs(h,i.block);v.each(function(g){g.perform(p)}),h.perform(p)&&(a=!0)}else c&&c.each(function(g,y){s(i,g)&&g.dirty();var m=o.getPerformArgs(g,i.block);m.skip=!l.performRawSeries&&r.isSeriesFiltered(g.context.model),o.updatePayload(g,n),g.perform(m)&&(a=!0)})}});function s(l,u){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(u.__pipeline.id))}this.unfinished=a||this.unfinished},e.prototype.performSeriesTasks=function(t){var r;t.eachSeries(function(n){r=n.dataTask.perform()||r}),this.unfinished=r||this.unfinished},e.prototype.plan=function(){this._pipelineMap.each(function(t){var r=t.tail;do{if(r.__block){t.blockIndex=r.__idxInPipeline;break}r=r.getUpstream()}while(r)})},e.prototype.updatePayload=function(t,r){r!=="remain"&&(t.context.payload=r)},e.prototype._createSeriesStageTask=function(t,r,n,i){var a=this,o=r.seriesTaskMap,s=r.seriesTaskMap=Vt(),l=t.seriesType,u=t.getTargetSeries;t.createOnAllSeries?n.eachRawSeries(f):l?n.eachRawSeriesByType(l,f):u&&u(n,i).each(f);function f(c){var h=c.uid,d=s.set(h,o&&o.get(h)||ym({plan:Vme,reset:jme,count:Ume}));d.context={model:c,ecModel:n,api:i,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:a},a._pipe(c,d)}},e.prototype._createOverallStageTask=function(t,r,n,i){var a=this,o=r.overallTask=r.overallTask||ym({reset:Lme});o.context={ecModel:n,api:i,overallReset:t.overallReset,scheduler:a};var s=o.agentStubMap,l=o.agentStubMap=Vt(),u=t.seriesType,f=t.getTargetSeries,c=!0,h=!1,d="";ul(!t.createOnAllSeries,d),u?n.eachRawSeriesByType(u,v):f?f(n,i).each(v):(c=!1,le(n.getSeries(),v));function v(p){var g=p.uid,y=l.set(g,s&&s.get(g)||(h=!0,ym({reset:Fme,onDirty:Bme})));y.context={model:p,overallProgress:c},y.agent=o,y.__block=c,a._pipe(p,y)}h&&o.dirty()},e.prototype._pipe=function(t,r){var n=t.uid,i=this._pipelineMap.get(n);!i.head&&(i.head=r),i.tail&&i.tail.pipe(r),i.tail=r,r.__idxInPipeline=i.count++,r.__pipeline=i},e.wrapStageHandler=function(t,r){return Nt(t)&&(t={overallReset:t,seriesType:zme(t)}),t.uid=lO("stageHandler"),r&&(t.visualType=r),t},e}();function Lme(e){e.overallReset(e.ecModel,e.api,e.payload)}function Fme(e){return e.overallProgress&&Hme}function Hme(){this.agent.dirty(),this.getDownstream().dirty()}function Bme(){this.agent&&this.agent.dirty()}function Vme(e){return e.plan?e.plan(e.model,e.ecModel,e.api,e.payload):null}function jme(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=gi(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?pt(t,function(r,n){return CQ(n)}):Wme}var Wme=CQ(0);function CQ(e){return function(t,r){var n=r.data,i=r.resetDefines[e];if(i&&i.dataEach)for(var a=t.start;a<t.end;a++)i.dataEach(n,a);else i&&i.progress&&i.progress(t,n)}}function Ume(e){return e.data.count()}function zme(e){fx=null;try{e(o0,xQ)}catch{}return fx}var o0={},xQ={},fx;TQ(o0,eQ);TQ(xQ,tQ);o0.eachSeriesByType=o0.eachRawSeriesByType=function(e){fx=e};o0.eachComponent=function(e){e.mainType==="series"&&e.subType&&(fx=e.subType)};function TQ(e,t){for(var r in t.prototype)e[r]=Di}const OQ=Nme;var vj=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const Gme={color:vj,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],vj]};var ii="#B9B8CE",pj="#100C2A",nS=function(){return{axisLine:{lineStyle:{color:ii}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},gj=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],EQ={darkMode:!0,color:gj,backgroundColor:pj,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:ii}},textStyle:{color:ii},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:ii}},dataZoom:{borderColor:"#71708A",textStyle:{color:ii},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:ii}},timeline:{lineStyle:{color:ii},label:{color:ii},controlStyle:{color:ii,borderColor:ii}},calendar:{itemStyle:{color:pj},dayLabel:{color:ii},monthLabel:{color:ii},yearLabel:{color:ii}},timeAxis:nS(),logAxis:nS(),valueAxis:nS(),categoryAxis:nS(),line:{symbol:"circle"},graph:{color:gj},gauge:{title:{color:ii},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:ii},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};EQ.categoryAxis.splitLine.show=!1;const Yme=EQ;var Kme=function(){function e(){}return e.prototype.normalizeQuery=function(t){var r={},n={},i={};if(st(t)){var a=zo(t);r.mainType=a.main||null,r.subType=a.sub||null}else{var o=["Index","Name","Id"],s={name:1,dataIndex:1,dataType:1};le(t,function(l,u){for(var f=!1,c=0;c<o.length;c++){var h=o[c],d=u.lastIndexOf(h);if(d>0&&d===u.length-h.length){var v=u.slice(0,d);v!=="data"&&(r.mainType=v,r[h.toLowerCase()]=l,f=!0)}}s.hasOwnProperty(u)&&(n[u]=l,f=!0),f||(i[u]=l)})}return{cptQuery:r,dataQuery:n,otherQuery:i}},e.prototype.filter=function(t,r){var n=this.eventInfo;if(!n)return!0;var i=n.targetEl,a=n.packedEvent,o=n.model,s=n.view;if(!o||!s)return!0;var l=r.cptQuery,u=r.dataQuery;return f(l,o,"mainType")&&f(l,o,"subType")&&f(l,o,"index","componentIndex")&&f(l,o,"name")&&f(l,o,"id")&&f(u,a,"name")&&f(u,a,"dataIndex")&&f(u,a,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,r.otherQuery,i,a));function f(c,h,d,v){return c[d]==null||h[v||d]===c[d]}},e.prototype.afterTrigger=function(){this.eventInfo=null},e}(),LI=["symbol","symbolSize","symbolRotate","symbolOffset"],yj=LI.concat(["symbolKeepAspect"]),Xme={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData();if(e.legendIcon&&r.setVisual("legendIcon",e.legendIcon),!e.hasSymbolVisual)return;for(var n={},i={},a=!1,o=0;o<LI.length;o++){var s=LI[o],l=e.get(s);Nt(l)?(a=!0,i[s]=l):n[s]=l}if(n.symbol=n.symbol||e.defaultSymbol,r.setVisual(Le({legendIcon:e.legendIcon||n.symbol,symbolKeepAspect:e.get("symbolKeepAspect")},n)),t.isSeriesFiltered(e))return;var u=Dr(i);function f(c,h){for(var d=e.getRawValue(h),v=e.getDataParams(h),p=0;p<u.length;p++){var g=u[p];c.setItemVisual(h,g,i[g](d,v))}}return{dataEach:a?f:null}}},qme={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!e.hasSymbolVisual||t.isSeriesFiltered(e))return;var r=e.getData();function n(i,a){for(var o=i.getItemModel(a),s=0;s<yj.length;s++){var l=yj[s],u=o.getShallow(l,!0);u!=null&&i.setItemVisual(a,l,u)}}return{dataEach:r.hasItemOption?n:null}}};function Zme(e,t,r){switch(r){case"color":var n=e.getItemVisual(t,"style");return n[e.getVisual("drawType")];case"opacity":return e.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getItemVisual(t,r)}}function Jme(e,t){switch(t){case"color":var r=e.getVisual("style");return r[e.getVisual("drawType")];case"opacity":return e.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getVisual(t)}}function Qme(e,t){function r(n,i){var a=[];return n.eachComponent({mainType:"series",subType:e,query:i},function(o){a.push(o.seriesIndex)}),a}le([[e+"ToggleSelect","toggleSelect"],[e+"Select","select"],[e+"UnSelect","unselect"]],function(n){t(n[0],function(i,a,o){i=Le({},i),o.dispatchAction(Le(i,{type:n[1],seriesIndex:r(a,i)}))})})}function Ph(e,t,r,n,i){var a=e+t;r.isSilent(a)||n.eachComponent({mainType:"series",subType:"pie"},function(o){for(var s=o.seriesIndex,l=o.option.selectedMap,u=i.selected,f=0;f<u.length;f++)if(u[f].seriesIndex===s){var c=o.getData(),h=Ac(c,i.fromActionPayload);r.trigger(a,{type:a,seriesId:o.id,name:et(h)?c.getName(h[0]):c.getName(h),selected:st(l)?l:Le({},l)})}})}function e0e(e,t,r){e.on("selectchanged",function(n){var i=r.getModel();n.isFromClick?(Ph("map","selectchanged",t,i,n),Ph("pie","selectchanged",t,i,n)):n.fromAction==="select"?(Ph("map","selected",t,i,n),Ph("pie","selected",t,i,n)):n.fromAction==="unselect"&&(Ph("map","unselected",t,i,n),Ph("pie","unselected",t,i,n))})}function Ky(e,t,r){for(var n;e&&!(t(e)&&(n=e,r));)e=e.__hostTarget||e.parent;return n}var t0e=Math.round(Math.random()*9),r0e=typeof Object.defineProperty=="function",n0e=function(){function e(){this._id="__ec_inner_"+t0e++}return e.prototype.get=function(t){return this._guard(t)[this._id]},e.prototype.set=function(t,r){var n=this._guard(t);return r0e?Object.defineProperty(n,this._id,{value:r,enumerable:!1,configurable:!0}):n[this._id]=r,this},e.prototype.delete=function(t){return this.has(t)?(delete this._guard(t)[this._id],!0):!1},e.prototype.has=function(t){return!!this._guard(t)[this._id]},e.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},e}();const i0e=n0e;var a0e=cr.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n+a),e.lineTo(r-i,n+a),e.closePath()}}),o0e=cr.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n),e.lineTo(r,n+a),e.lineTo(r-i,n),e.closePath()}}),s0e=cr.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.x,n=t.y,i=t.width/5*3,a=Math.max(i,t.height),o=i/2,s=o*o/(a-o),l=n-a+o+s,u=Math.asin(s/o),f=Math.cos(u)*o,c=Math.sin(u),h=Math.cos(u),d=o*.6,v=o*.7;e.moveTo(r-f,l+s),e.arc(r,l,o,Math.PI-u,Math.PI*2+u),e.bezierCurveTo(r+f-c*d,l+s+h*d,r,n-v,r,n),e.bezierCurveTo(r,n-v,r-f+c*d,l+s+h*d,r-f,l+s),e.closePath()}}),l0e=cr.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.height,n=t.width,i=t.x,a=t.y,o=n/3*2;e.moveTo(i,a),e.lineTo(i+o,a+r),e.lineTo(i,a+r/4*3),e.lineTo(i-o,a+r),e.lineTo(i,a),e.closePath()}}),u0e={line:Pc,rect:_n,roundRect:_n,square:_n,circle:zN,diamond:o0e,pin:s0e,arrow:l0e,triangle:a0e},f0e={line:function(e,t,r,n,i){i.x1=e,i.y1=t+n/2,i.x2=e+r,i.y2=t+n/2},rect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n},roundRect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n,i.r=Math.min(r,n)/4},square:function(e,t,r,n,i){var a=Math.min(r,n);i.x=e,i.y=t,i.width=a,i.height=a},circle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.r=Math.min(r,n)/2},diamond:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n},pin:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},arrow:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},triangle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n}},FI={};le(u0e,function(e,t){FI[t]=new e});var c0e=cr.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,r){var n=qC(e,t,r),i=this.shape;return i&&i.symbolType==="pin"&&t.position==="inside"&&(n.y=r.y+r.height*.4),n},buildPath:function(e,t,r){var n=t.symbolType;if(n!=="none"){var i=FI[n];i||(n="rect",i=FI[n]),f0e[n](t.x,t.y,t.width,t.height,i.shape),i.buildPath(e,i.shape,r)}}});function h0e(e,t){if(this.type!=="image"){var r=this.style;this.__isEmptyBrush?(r.stroke=e,r.fill=t||"#fff",r.lineWidth=2):this.shape.symbolType==="line"?r.stroke=e:r.fill=e,this.markRedraw()}}function sv(e,t,r,n,i,a,o){var s=e.indexOf("empty")===0;s&&(e=e.substr(5,1).toLowerCase()+e.substr(6));var l;return e.indexOf("image://")===0?l=OJ(e.slice(8),new or(t,r,n,i),o?"center":"cover"):e.indexOf("path://")===0?l=XN(e.slice(7),{},new or(t,r,n,i),o?"center":"cover"):l=new c0e({shape:{symbolType:e,x:t,y:r,width:n,height:i}}),l.__isEmptyBrush=s,l.setColor=h0e,a&&l.setColor(a),l}function d0e(e){return et(e)||(e=[+e,+e]),[e[0]||0,e[1]||0]}function RQ(e,t){if(e!=null)return et(e)||(e=[e,e]),[Mr(e[0],t[0])||0,Mr(Xt(e[1],e[0]),t[1])||0]}function Wf(e){return isFinite(e)}function v0e(e,t,r){var n=t.x==null?0:t.x,i=t.x2==null?1:t.x2,a=t.y==null?0:t.y,o=t.y2==null?0:t.y2;t.global||(n=n*r.width+r.x,i=i*r.width+r.x,a=a*r.height+r.y,o=o*r.height+r.y),n=Wf(n)?n:0,i=Wf(i)?i:1,a=Wf(a)?a:0,o=Wf(o)?o:0;var s=e.createLinearGradient(n,a,i,o);return s}function p0e(e,t,r){var n=r.width,i=r.height,a=Math.min(n,i),o=t.x==null?.5:t.x,s=t.y==null?.5:t.y,l=t.r==null?.5:t.r;t.global||(o=o*n+r.x,s=s*i+r.y,l=l*a),o=Wf(o)?o:.5,s=Wf(s)?s:.5,l=l>=0&&Wf(l)?l:.5;var u=e.createRadialGradient(o,s,0,o,s,l);return u}function HI(e,t,r){for(var n=t.type==="radial"?p0e(e,t,r):v0e(e,t,r),i=t.colorStops,a=0;a<i.length;a++)n.addColorStop(i[a].offset,i[a].color);return n}function g0e(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!0;return!1}function iS(e){return parseInt(e,10)}function aS(e,t,r){var n=["width","height"][t],i=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(r[n]!=null&&r[n]!=="auto")return parseFloat(r[n]);var s=document.defaultView.getComputedStyle(e);return(e[i]||iS(s[n])||iS(e.style[n]))-(iS(s[a])||0)-(iS(s[o])||0)|0}function y0e(e,t){return!e||e==="solid"||!(t>0)?null:e==="dashed"?[4*t,2*t]:e==="dotted"?[t]:_r(e)?[e]:et(e)?e:null}function kQ(e){var t=e.style,r=t.lineDash&&t.lineWidth>0&&y0e(t.lineDash,t.lineWidth),n=t.lineDashOffset;if(r){var i=t.strokeNoScale&&e.getLineScale?e.getLineScale():1;i&&i!==1&&(r=pt(r,function(a){return a/i}),n/=i)}return[r,n]}var m0e=new Pu(!0);function cx(e){var t=e.stroke;return!(t==null||t==="none"||!(e.lineWidth>0))}function mj(e){return typeof e=="string"&&e!=="none"}function hx(e){var t=e.fill;return t!=null&&t!=="none"}function bj(e,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=r}else e.fill()}function wj(e,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=r}else e.stroke()}function BI(e,t,r){var n=FZ(t.image,t.__image,r);if(QT(n)){var i=e.createPattern(n,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var a=new DOMMatrix;a.translateSelf(t.x||0,t.y||0),a.rotateSelf(0,0,(t.rotation||0)*_he),a.scaleSelf(t.scaleX||1,t.scaleY||1),i.setTransform(a)}return i}}function b0e(e,t,r,n){var i,a=cx(r),o=hx(r),s=r.strokePercent,l=s<1,u=!t.path;(!t.silent||l)&&u&&t.createPathProxy();var f=t.path||m0e,c=t.__dirty;if(!n){var h=r.fill,d=r.stroke,v=o&&!!h.colorStops,p=a&&!!d.colorStops,g=o&&!!h.image,y=a&&!!d.image,m=void 0,b=void 0,_=void 0,x=void 0,T=void 0;(v||p)&&(T=t.getBoundingRect()),v&&(m=c?HI(e,h,T):t.__canvasFillGradient,t.__canvasFillGradient=m),p&&(b=c?HI(e,d,T):t.__canvasStrokeGradient,t.__canvasStrokeGradient=b),g&&(_=c||!t.__canvasFillPattern?BI(e,h,t):t.__canvasFillPattern,t.__canvasFillPattern=_),y&&(x=c||!t.__canvasStrokePattern?BI(e,d,t):t.__canvasStrokePattern,t.__canvasStrokePattern=_),v?e.fillStyle=m:g&&(_?e.fillStyle=_:o=!1),p?e.strokeStyle=b:y&&(x?e.strokeStyle=x:a=!1)}var E=t.getGlobalScale();f.setScale(E[0],E[1],t.segmentIgnoreThreshold);var P,R;e.setLineDash&&r.lineDash&&(i=kQ(t),P=i[0],R=i[1]);var M=!0;(u||c&hd)&&(f.setDPR(e.dpr),l?f.setContext(null):(f.setContext(e),M=!1),f.reset(),t.buildPath(f,t.shape,n),f.toStatic(),t.pathUpdated()),M&&f.rebuildPath(e,l?s:1),P&&(e.setLineDash(P),e.lineDashOffset=R),n||(r.strokeFirst?(a&&wj(e,r),o&&bj(e,r)):(o&&bj(e,r),a&&wj(e,r))),P&&e.setLineDash([])}function w0e(e,t,r){var n=t.__image=FZ(r.image,t.__image,t,t.onload);if(!(!n||!QT(n))){var i=r.x||0,a=r.y||0,o=t.getWidth(),s=t.getHeight(),l=n.width/n.height;if(o==null&&s!=null?o=s*l:s==null&&o!=null?s=o/l:o==null&&s==null&&(o=n.width,s=n.height),r.sWidth&&r.sHeight){var u=r.sx||0,f=r.sy||0;e.drawImage(n,u,f,r.sWidth,r.sHeight,i,a,o,s)}else if(r.sx&&r.sy){var u=r.sx,f=r.sy,c=o-u,h=s-f;e.drawImage(n,u,f,c,h,i,a,o,s)}else e.drawImage(n,i,a,o,s)}}function _0e(e,t,r){var n,i=r.text;if(i!=null&&(i+=""),i){e.font=r.font||kc,e.textAlign=r.textAlign,e.textBaseline=r.textBaseline;var a=void 0,o=void 0;e.setLineDash&&r.lineDash&&(n=kQ(t),a=n[0],o=n[1]),a&&(e.setLineDash(a),e.lineDashOffset=o),r.strokeFirst?(cx(r)&&e.strokeText(i,r.x,r.y),hx(r)&&e.fillText(i,r.x,r.y)):(hx(r)&&e.fillText(i,r.x,r.y),cx(r)&&e.strokeText(i,r.x,r.y)),a&&e.setLineDash([])}}var _j=["shadowBlur","shadowOffsetX","shadowOffsetY"],Sj=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function AQ(e,t,r,n,i){var a=!1;if(!n&&(r=r||{},t===r))return!1;if(n||t.opacity!==r.opacity){Mi(e,i),a=!0;var o=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(o)?bc.opacity:o}(n||t.blend!==r.blend)&&(a||(Mi(e,i),a=!0),e.globalCompositeOperation=t.blend||bc.blend);for(var s=0;s<_j.length;s++){var l=_j[s];(n||t[l]!==r[l])&&(a||(Mi(e,i),a=!0),e[l]=e.dpr*(t[l]||0))}return(n||t.shadowColor!==r.shadowColor)&&(a||(Mi(e,i),a=!0),e.shadowColor=t.shadowColor||bc.shadowColor),a}function Cj(e,t,r,n,i){var a=s0(t,i.inHover),o=n?null:r&&s0(r,i.inHover)||{};if(a===o)return!1;var s=AQ(e,a,o,n,i);if((n||a.fill!==o.fill)&&(s||(Mi(e,i),s=!0),mj(a.fill)&&(e.fillStyle=a.fill)),(n||a.stroke!==o.stroke)&&(s||(Mi(e,i),s=!0),mj(a.stroke)&&(e.strokeStyle=a.stroke)),(n||a.opacity!==o.opacity)&&(s||(Mi(e,i),s=!0),e.globalAlpha=a.opacity==null?1:a.opacity),t.hasStroke()){var l=a.lineWidth,u=l/(a.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==u&&(s||(Mi(e,i),s=!0),e.lineWidth=u)}for(var f=0;f<Sj.length;f++){var c=Sj[f],h=c[0];(n||a[h]!==o[h])&&(s||(Mi(e,i),s=!0),e[h]=a[h]||c[1])}return s}function S0e(e,t,r,n,i){return AQ(e,s0(t,i.inHover),r&&s0(r,i.inHover),n,i)}function PQ(e,t){var r=t.transform,n=e.dpr||1;r?e.setTransform(n*r[0],n*r[1],n*r[2],n*r[3],n*r[4],n*r[5]):e.setTransform(n,0,0,n,0,0)}function C0e(e,t,r){for(var n=!1,i=0;i<e.length;i++){var a=e[i];n=n||a.isZeroArea(),PQ(t,a),t.beginPath(),a.buildPath(t,a.shape),t.clip()}r.allClipped=n}function x0e(e,t){return e&&t?e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]:!(!e&&!t)}var xj=1,Tj=2,Oj=3,Ej=4;function T0e(e){var t=hx(e),r=cx(e);return!(e.lineDash||!(+t^+r)||t&&typeof e.fill!="string"||r&&typeof e.stroke!="string"||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}function Mi(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function s0(e,t){return t&&e.__hoverStyle||e.style}function IQ(e,t){Uf(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Uf(e,t,r,n){var i=t.transform;if(!t.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1)){t.__dirty&=~qi,t.__isRendered=!1;return}var a=t.__clipPaths,o=r.prevElClipPaths,s=!1,l=!1;if((!o||g0e(a,o))&&(o&&o.length&&(Mi(e,r),e.restore(),l=s=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),a&&a.length&&(Mi(e,r),e.save(),C0e(a,e,r),s=!0),r.prevElClipPaths=a),r.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var u=r.prevEl;u||(l=s=!0);var f=t instanceof cr&&t.autoBatch&&T0e(t.style);s||x0e(i,u.transform)?(Mi(e,r),PQ(e,t)):f||Mi(e,r);var c=s0(t,r.inHover);t instanceof cr?(r.lastDrawType!==xj&&(l=!0,r.lastDrawType=xj),Cj(e,t,u,l,r),(!f||!r.batchFill&&!r.batchStroke)&&e.beginPath(),b0e(e,t,c,f),f&&(r.batchFill=c.fill||"",r.batchStroke=c.stroke||"")):t instanceof SI?(r.lastDrawType!==Oj&&(l=!0,r.lastDrawType=Oj),Cj(e,t,u,l,r),_0e(e,t,c)):t instanceof Zc?(r.lastDrawType!==Tj&&(l=!0,r.lastDrawType=Tj),S0e(e,t,u,l,r),w0e(e,t,c)):t.getTemporalDisplayables&&(r.lastDrawType!==Ej&&(l=!0,r.lastDrawType=Ej),O0e(e,t,r)),f&&n&&Mi(e,r),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),r.prevEl=t,t.__dirty=0,t.__isRendered=!0}function O0e(e,t,r){var n=t.getDisplayables(),i=t.getTemporalDisplayables();e.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover},o,s;for(o=t.getCursor(),s=n.length;o<s;o++){var l=n[o];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Uf(e,l,a,o===s-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}for(var u=0,f=i.length;u<f;u++){var l=i[u];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Uf(e,l,a,u===f-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}var FR=new i0e,Rj=new Tw(100),kj=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function VI(e,t){if(e==="none")return null;var r=t.getDevicePixelRatio(),n=t.getZr(),i=n.painter.type==="svg";e.dirty&&FR.delete(e);var a=FR.get(e);if(a)return a;var o=lr(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});o.backgroundColor==="none"&&(o.backgroundColor=null);var s={repeat:"repeat"};return l(s),s.rotation=o.rotation,s.scaleX=s.scaleY=i?1:1/r,FR.set(e,s),e.dirty=!1,s;function l(u){for(var f=[r],c=!0,h=0;h<kj.length;++h){var d=o[kj[h]];if(d!=null&&!et(d)&&!st(d)&&!_r(d)&&typeof d!="boolean"){c=!1;break}f.push(d)}var v;if(c){v=f.join(",")+(i?"-svg":"");var p=Rj.get(v);p&&(i?u.svgElement=p:u.image=p)}var g=DQ(o.dashArrayX),y=E0e(o.dashArrayY),m=MQ(o.symbol),b=R0e(g),_=$Q(y),x=!i&&wg.createCanvas(),T=i&&{tag:"g",attrs:{},key:"dcl",children:[]},E=R(),P;x&&(x.width=E.width*r,x.height=E.height*r,P=x.getContext("2d")),M(),c&&Rj.put(v,x||T),u.image=x,u.svgElement=T,u.svgWidth=E.width,u.svgHeight=E.height;function R(){for(var D=1,N=0,B=b.length;N<B;++N)D=V4(D,b[N]);for(var K=1,N=0,B=m.length;N<B;++N)K=V4(K,m[N].length);D*=K;var Z=_*b.length*m.length;return{width:Math.max(1,Math.min(D,o.maxTileWidth)),height:Math.max(1,Math.min(Z,o.maxTileHeight))}}function M(){P&&(P.clearRect(0,0,x.width,x.height),o.backgroundColor&&(P.fillStyle=o.backgroundColor,P.fillRect(0,0,x.width,x.height)));for(var D=0,N=0;N<y.length;++N)D+=y[N];if(D<=0)return;for(var B=-_,K=0,Z=0,ie=0;B<E.height;){if(K%2===0){for(var me=Z/2%m.length,k=0,w=0,C=0;k<E.width*2;){for(var O=0,N=0;N<g[ie].length;++N)O+=g[ie][N];if(O<=0)break;if(w%2===0){var S=(1-o.symbolSize)*.5,A=k+g[ie][w]*S,I=B+y[K]*S,L=g[ie][w]*o.symbolSize,V=y[K]*o.symbolSize,Y=C/2%m[me].length;ae(A,I,L,V,m[me][Y])}k+=g[ie][w],++C,++w,w===g[ie].length&&(w=0)}++ie,ie===g.length&&(ie=0)}B+=y[K],++Z,++K,K===y.length&&(K=0)}function ae(re,te,ge,H,Ce){var oe=i?1:r,Oe=sv(Ce,re*oe,te*oe,ge*oe,H*oe,o.color,o.symbolKeepAspect);if(i){var Ee=n.painter.renderOneToVNode(Oe);Ee&&T.children.push(Ee)}else IQ(P,Oe)}}}}function MQ(e){if(!e||e.length===0)return[["rect"]];if(st(e))return[[e]];for(var t=!0,r=0;r<e.length;++r)if(!st(e[r])){t=!1;break}if(t)return MQ([e]);for(var n=[],r=0;r<e.length;++r)st(e[r])?n.push([e[r]]):n.push(e[r]);return n}function DQ(e){if(!e||e.length===0)return[[0,0]];if(_r(e)){var t=Math.ceil(e);return[[t,t]]}for(var r=!0,n=0;n<e.length;++n)if(!_r(e[n])){r=!1;break}if(r)return DQ([e]);for(var i=[],n=0;n<e.length;++n)if(_r(e[n])){var t=Math.ceil(e[n]);i.push([t,t])}else{var t=pt(e[n],function(s){return Math.ceil(s)});t.length%2===1?i.push(t.concat(t)):i.push(t)}return i}function E0e(e){if(!e||typeof e=="object"&&e.length===0)return[0,0];if(_r(e)){var t=Math.ceil(e);return[t,t]}var r=pt(e,function(n){return Math.ceil(n)});return e.length%2?r.concat(r):r}function R0e(e){return pt(e,function(t){return $Q(t)})}function $Q(e){for(var t=0,r=0;r<e.length;++r)t+=e[r];return e.length%2===1?t*2:t}function k0e(e,t){e.eachRawSeries(function(r){if(!e.isSeriesFiltered(r)){var n=r.getData();n.hasItemVisual()&&n.each(function(o){var s=n.getItemVisual(o,"decal");if(s){var l=n.ensureUniqueItemVisual(o,"style");l.decal=VI(s,t)}});var i=n.getVisual("decal");if(i){var a=n.getVisual("style");a.decal=VI(i,t)}}})}var A0e=new ts;const Za=A0e;var NQ={};function P0e(e,t){NQ[e]=t}function I0e(e){return NQ[e]}var M0e=1,D0e=800,$0e=900,N0e=1e3,L0e=2e3,F0e=5e3,LQ=1e3,H0e=1100,pL=2e3,FQ=3e3,B0e=4e3,wO=4500,V0e=4600,j0e=5e3,W0e=6e3,HQ=7e3,U0e={PROCESSOR:{FILTER:N0e,SERIES_FILTER:D0e,STATISTIC:F0e},VISUAL:{LAYOUT:LQ,PROGRESSIVE_LAYOUT:H0e,GLOBAL:pL,CHART:FQ,POST_CHART_LAYOUT:V0e,COMPONENT:B0e,BRUSH:j0e,CHART_ITEM:wO,ARIA:W0e,DECAL:HQ}},Ln="__flagInMainProcess",Ti="__pendingUpdate",HR="__needsUpdateStatus",Aj=/^[a-zA-Z0-9_]+$/,BR="__connectUpdateStatus",Pj=0,z0e=1,G0e=2;function BQ(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.isDisposed()){this.id;return}return jQ(this,e,t)}}function VQ(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return jQ(this,e,t)}}function jQ(e,t,r){return r[0]=r[0]&&r[0].toLowerCase(),ts.prototype[t].apply(e,r)}var WQ=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(ts),UQ=WQ.prototype;UQ.on=VQ("on");UQ.off=VQ("off");var Ih,VR,oS,Pl,jR,WR,UR,ty,ry,Ij,Mj,zR,Dj,sS,$j,zQ,sa,Nj,GQ=function(e){Ye(t,e);function t(r,n,i){var a=e.call(this,new Kme)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],i=i||{},st(n)&&(n=YQ[n]),a._dom=r;var o="canvas",s="auto",l=!1,u=a._zr=H4(r,{renderer:i.renderer||o,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:Xt(i.useDirtyRect,l),useCoarsePointer:Xt(i.useCoarsePointer,s),pointerSize:i.pointerSize});a._ssr=i.ssr,a._throttledZrFlush=bO(Or(u.flush,u),17),n=Qt(n),n&&nQ(n,!0),a._theme=n,a._locale=Zge(i.locale||DJ),a._coordSysMgr=new sL;var f=a._api=$j(a);function c(h,d){return h.__prio-d.__prio}return N1(vx,c),N1(jI,c),a._scheduler=new OQ(a,f,jI,vx),a._messageCenter=new WQ,a._initEvents(),a.resize=Or(a.resize,a),u.animation.on("frame",a._onframe,a),Ij(u,a),Mj(u,a),QP(a),a}return t.prototype._onframe=function(){if(!this._disposed){Nj(this);var r=this._scheduler;if(this[Ti]){var n=this[Ti].silent;this[Ln]=!0;try{Ih(this),Pl.update.call(this,null,this[Ti].updateParams)}catch(l){throw this[Ln]=!1,this[Ti]=null,l}this._zr.flush(),this[Ln]=!1,this[Ti]=null,ty.call(this,n),ry.call(this,n)}else if(r.unfinished){var i=M0e,a=this._model,o=this._api;r.unfinished=!1;do{var s=+new Date;r.performSeriesTasks(a),r.performDataProcessorTasks(a),WR(this,a),r.performVisualTasks(a),sS(this,this._model,o,"remain",{}),i-=+new Date-s}while(i>0&&r.unfinished);r.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(r,n,i){if(!this[Ln]){if(this._disposed){this.id;return}var a,o,s;if(dt(n)&&(i=n.lazyUpdate,a=n.silent,o=n.replaceMerge,s=n.transition,n=n.notMerge),this[Ln]=!0,!this._model||n){var l=new Pye(this._api),u=this._theme,f=this._model=new eQ;f.scheduler=this._scheduler,f.ssr=this._ssr,f.init(null,null,null,u,this._locale,l)}this._model.setOption(r,{replaceMerge:o},WI);var c={seriesTransition:s,optionChanged:!0};if(i)this[Ti]={silent:a,updateParams:c},this[Ln]=!1,this.getZr().wakeUp();else{try{Ih(this),Pl.update.call(this,null,c)}catch(h){throw this[Ti]=null,this[Ln]=!1,h}this._ssr||this._zr.flush(),this[Ti]=null,this[Ln]=!1,ty.call(this,a),ry.call(this,a)}}},t.prototype.setTheme=function(){},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||Bt.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(r){return this.renderToCanvas(r)},t.prototype.renderToCanvas=function(r){r=r||{};var n=this._zr.painter;return n.getRenderedCanvas({backgroundColor:r.backgroundColor||this._model.get("backgroundColor"),pixelRatio:r.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(r){r=r||{};var n=this._zr.painter;return n.renderToString({useViewBox:r.useViewBox})},t.prototype.getSvgDataURL=function(){if(Bt.svgSupported){var r=this._zr,n=r.storage.getDisplayList();return le(n,function(i){i.stopAnimation(null,!0)}),r.painter.toDataURL()}},t.prototype.getDataURL=function(r){if(this._disposed){this.id;return}r=r||{};var n=r.excludeComponents,i=this._model,a=[],o=this;le(n,function(l){i.eachComponent({mainType:l},function(u){var f=o._componentsMap[u.__viewId];f.group.ignore||(a.push(f),f.group.ignore=!0)})});var s=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(r).toDataURL("image/"+(r&&r.type||"png"));return le(a,function(l){l.group.ignore=!1}),s},t.prototype.getConnectedDataURL=function(r){if(this._disposed){this.id;return}var n=r.type==="svg",i=this.group,a=Math.min,o=Math.max,s=1/0;if(Lj[i]){var l=s,u=s,f=-s,c=-s,h=[],d=r&&r.pixelRatio||this.getDevicePixelRatio();le(bm,function(b,_){if(b.group===i){var x=n?b.getZr().painter.getSvgDom().innerHTML:b.renderToCanvas(Qt(r)),T=b.getDom().getBoundingClientRect();l=a(T.left,l),u=a(T.top,u),f=o(T.right,f),c=o(T.bottom,c),h.push({dom:x,left:T.left,top:T.top})}}),l*=d,u*=d,f*=d,c*=d;var v=f-l,p=c-u,g=wg.createCanvas(),y=H4(g,{renderer:n?"svg":"canvas"});if(y.resize({width:v,height:p}),n){var m="";return le(h,function(b){var _=b.left-l,x=b.top-u;m+='<g transform="translate('+_+","+x+')">'+b.dom+"</g>"}),y.painter.getSvgRoot().innerHTML=m,r.connectedBackgroundColor&&y.painter.setBackgroundColor(r.connectedBackgroundColor),y.refreshImmediately(),y.painter.toDataURL()}else return r.connectedBackgroundColor&&y.add(new _n({shape:{x:0,y:0,width:v,height:p},style:{fill:r.connectedBackgroundColor}})),le(h,function(b){var _=new Zc({style:{x:b.left*d-l,y:b.top*d-u,image:b.dom}});y.add(_)}),y.refreshImmediately(),g.toDataURL("image/"+(r&&r.type||"png"))}else return this.getDataURL(r)},t.prototype.convertToPixel=function(r,n){return jR(this,"convertToPixel",r,n)},t.prototype.convertFromPixel=function(r,n){return jR(this,"convertFromPixel",r,n)},t.prototype.containPixel=function(r,n){if(this._disposed){this.id;return}var i=this._model,a,o=cR(i,r);return le(o,function(s,l){l.indexOf("Models")>=0&&le(s,function(u){var f=u.coordinateSystem;if(f&&f.containPoint)a=a||!!f.containPoint(n);else if(l==="seriesModels"){var c=this._chartsMap[u.__viewId];c&&c.containPoint&&(a=a||c.containPoint(n,u))}},this)},this),!!a},t.prototype.getVisual=function(r,n){var i=this._model,a=cR(i,r,{defaultMainType:"series"}),o=a.seriesModel,s=o.getData(),l=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?s.indexOfRawIndex(a.dataIndex):null;return l!=null?Zme(s,l,n):Jme(s,n)},t.prototype.getViewOfComponentModel=function(r){return this._componentsMap[r.__viewId]},t.prototype.getViewOfSeriesModel=function(r){return this._chartsMap[r.__viewId]},t.prototype._initEvents=function(){var r=this;le(Y0e,function(n){var i=function(a){var o=r.getModel(),s=a.target,l,u=n==="globalout";if(u?l={}:s&&Ky(s,function(v){var p=ur(v);if(p&&p.dataIndex!=null){var g=p.dataModel||o.getSeriesByIndex(p.seriesIndex);return l=g&&g.getDataParams(p.dataIndex,p.dataType)||{},!0}else if(p.eventData)return l=Le({},p.eventData),!0},!0),l){var f=l.componentType,c=l.componentIndex;(f==="markLine"||f==="markPoint"||f==="markArea")&&(f="series",c=l.seriesIndex);var h=f&&c!=null&&o.getComponent(f,c),d=h&&r[h.mainType==="series"?"_chartsMap":"_componentsMap"][h.__viewId];l.event=a,l.type=n,r._$eventProcessor.eventInfo={targetEl:s,packedEvent:l,model:h,view:d},r.trigger(n,l)}};i.zrEventfulCallAtLast=!0,r._zr.on(n,i,r)}),le(mm,function(n,i){r._messageCenter.on(i,function(a){this.trigger(i,a)},r)}),le(["selectchanged"],function(n){r._messageCenter.on(n,function(i){this.trigger(n,i)},r)}),e0e(this._messageCenter,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var r=this.getDom();r&&$Z(this.getDom(),yL,"");var n=this,i=n._api,a=n._model;le(n._componentsViews,function(o){o.dispose(a,i)}),le(n._chartsViews,function(o){o.dispose(a,i)}),n._zr.dispose(),n._dom=n._model=n._chartsMap=n._componentsMap=n._chartsViews=n._componentsViews=n._scheduler=n._api=n._zr=n._throttledZrFlush=n._theme=n._coordSysMgr=n._messageCenter=null,delete bm[n.id]},t.prototype.resize=function(r){if(!this[Ln]){if(this._disposed){this.id;return}this._zr.resize(r);var n=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!n){var i=n.resetOption("media"),a=r&&r.silent;this[Ti]&&(a==null&&(a=this[Ti].silent),i=!0,this[Ti]=null),this[Ln]=!0;try{i&&Ih(this),Pl.update.call(this,{type:"resize",animation:Le({duration:0},r&&r.animation)})}catch(o){throw this[Ln]=!1,o}this[Ln]=!1,ty.call(this,a),ry.call(this,a)}}},t.prototype.showLoading=function(r,n){if(this._disposed){this.id;return}if(dt(r)&&(n=r,r=""),r=r||"default",this.hideLoading(),!!UI[r]){var i=UI[r](this._api,n),a=this._zr;this._loadingFX=i,a.add(i)}},t.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},t.prototype.makeActionFromEvent=function(r){var n=Le({},r);return n.type=mm[r.type],n},t.prototype.dispatchAction=function(r,n){if(this._disposed){this.id;return}if(dt(n)||(n={silent:!!n}),!!dx[r.type]&&this._model){if(this[Ln]){this._pendingActions.push(r);return}var i=n.silent;UR.call(this,r,i);var a=n.flush;a?this._zr.flush():a!==!1&&Bt.browser.weChat&&this._throttledZrFlush(),ty.call(this,i),ry.call(this,i)}},t.prototype.updateLabelLayout=function(){Za.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(r){if(this._disposed){this.id;return}var n=r.seriesIndex,i=this.getModel(),a=i.getSeriesByIndex(n);a.appendData(r),this._scheduler.unfinished=!0,this.getZr().wakeUp()},t.internalField=function(){Ih=function(c){var h=c._scheduler;h.restorePipelines(c._model),h.prepareStageTasks(),VR(c,!0),VR(c,!1),h.plan()},VR=function(c,h){for(var d=c._model,v=c._scheduler,p=h?c._componentsViews:c._chartsViews,g=h?c._componentsMap:c._chartsMap,y=c._zr,m=c._api,b=0;b<p.length;b++)p[b].__alive=!1;h?d.eachComponent(function(T,E){T!=="series"&&_(E)}):d.eachSeries(_);function _(T){var E=T.__requireNewView;T.__requireNewView=!1;var P="_ec_"+T.id+"_"+T.type,R=!E&&g[P];if(!R){var M=zo(T.type),D=h?cl.getClass(M.main,M.sub):Xo.getClass(M.sub);R=new D,R.init(d,m),g[P]=R,p.push(R),y.add(R.group)}T.__viewId=R.__id=P,R.__alive=!0,R.__model=T,R.group.__ecComponentInfo={mainType:T.mainType,index:T.componentIndex},!h&&v.prepareView(R,T,d,m)}for(var b=0;b<p.length;){var x=p[b];x.__alive?b++:(!h&&x.renderTask.dispose(),y.remove(x.group),x.dispose(d,m),p.splice(b,1),g[x.__id]===x&&delete g[x.__id],x.__id=x.group.__ecComponentInfo=null)}},oS=function(c,h,d,v,p){var g=c._model;if(g.setUpdatePayload(d),!v){le([].concat(c._componentsViews).concat(c._chartsViews),x);return}var y={};y[v+"Id"]=d[v+"Id"],y[v+"Index"]=d[v+"Index"],y[v+"Name"]=d[v+"Name"];var m={mainType:v,query:y};p&&(m.subType=p);var b=d.excludeSeriesId,_;b!=null&&(_=Vt(),le(gi(b),function(T){var E=Ko(T,null);E!=null&&_.set(E,!0)})),g&&g.eachComponent(m,function(T){var E=_&&_.get(T.id)!=null;if(!E)if(gV(d))if(T instanceof Mu)d.type===wc&&!d.notBlur&&!T.get(["emphasis","disabled"])&&Epe(T,d,c._api);else{var P=UN(T.mainType,T.componentIndex,d.name,c._api),R=P.focusSelf,M=P.dispatchers;d.type===wc&&R&&!d.notBlur&&xI(T.mainType,T.componentIndex,c._api),M&&le(M,function(D){d.type===wc?ex(D):tx(D)})}else EI(d)&&T instanceof Mu&&(Ape(T,d,c._api),vV(T),sa(c))},c),g&&g.eachComponent(m,function(T){var E=_&&_.get(T.id)!=null;E||x(c[v==="series"?"_chartsMap":"_componentsMap"][T.__viewId])},c);function x(T){T&&T.__alive&&T[h]&&T[h](T.__model,g,c._api,d)}},Pl={prepareAndUpdate:function(c){Ih(this),Pl.update.call(this,c,{optionChanged:c.newOption!=null})},update:function(c,h){var d=this._model,v=this._api,p=this._zr,g=this._coordSysMgr,y=this._scheduler;if(d){d.setUpdatePayload(c),y.restoreData(d,c),y.performSeriesTasks(d),g.create(d,v),y.performDataProcessorTasks(d,c),WR(this,d),g.update(d,v),r(d),y.performVisualTasks(d,c),zR(this,d,v,c,h);var m=d.get("backgroundColor")||"transparent",b=d.get("darkMode");p.setBackgroundColor(m),b!=null&&b!=="auto"&&p.setDarkMode(b),Za.trigger("afterupdate",d,v)}},updateTransform:function(c){var h=this,d=this._model,v=this._api;if(d){d.setUpdatePayload(c);var p=[];d.eachComponent(function(y,m){if(y!=="series"){var b=h.getViewOfComponentModel(m);if(b&&b.__alive)if(b.updateTransform){var _=b.updateTransform(m,d,v,c);_&&_.update&&p.push(b)}else p.push(b)}});var g=Vt();d.eachSeries(function(y){var m=h._chartsMap[y.__viewId];if(m.updateTransform){var b=m.updateTransform(y,d,v,c);b&&b.update&&g.set(y.uid,1)}else g.set(y.uid,1)}),r(d),this._scheduler.performVisualTasks(d,c,{setDirty:!0,dirtyMap:g}),sS(this,d,v,c,{},g),Za.trigger("afterupdate",d,v)}},updateView:function(c){var h=this._model;h&&(h.setUpdatePayload(c),Xo.markUpdateMethod(c,"updateView"),r(h),this._scheduler.performVisualTasks(h,c,{setDirty:!0}),zR(this,h,this._api,c,{}),Za.trigger("afterupdate",h,this._api))},updateVisual:function(c){var h=this,d=this._model;d&&(d.setUpdatePayload(c),d.eachSeries(function(v){v.getData().clearAllVisual()}),Xo.markUpdateMethod(c,"updateVisual"),r(d),this._scheduler.performVisualTasks(d,c,{visualType:"visual",setDirty:!0}),d.eachComponent(function(v,p){if(v!=="series"){var g=h.getViewOfComponentModel(p);g&&g.__alive&&g.updateVisual(p,d,h._api,c)}}),d.eachSeries(function(v){var p=h._chartsMap[v.__viewId];p.updateVisual(v,d,h._api,c)}),Za.trigger("afterupdate",d,this._api))},updateLayout:function(c){Pl.update.call(this,c)}},jR=function(c,h,d,v){if(c._disposed){c.id;return}for(var p=c._model,g=c._coordSysMgr.getCoordinateSystems(),y,m=cR(p,d),b=0;b<g.length;b++){var _=g[b];if(_[h]&&(y=_[h](p,m,v))!=null)return y}},WR=function(c,h){var d=c._chartsMap,v=c._scheduler;h.eachSeries(function(p){v.updateStreamModes(p,d[p.__viewId])})},UR=function(c,h){var d=this,v=this.getModel(),p=c.type,g=c.escapeConnect,y=dx[p],m=y.actionInfo,b=(m.update||"update").split(":"),_=b.pop(),x=b[0]!=null&&zo(b[0]);this[Ln]=!0;var T=[c],E=!1;c.batch&&(E=!0,T=pt(c.batch,function(K){return K=lr(Le({},K),c),K.batch=null,K}));var P=[],R,M=EI(c),D=gV(c);if(D&&iJ(this._api),le(T,function(K){if(R=y.action(K,d._model,d._api),R=R||Le({},K),R.type=m.event||R.type,P.push(R),D){var Z=HN(c),ie=Z.queryOptionMap,me=Z.mainTypeSpecified,k=me?ie.keys()[0]:"series";oS(d,_,K,k),sa(d)}else M?(oS(d,_,K,"series"),sa(d)):x&&oS(d,_,K,x.main,x.sub)}),_!=="none"&&!D&&!M&&!x)try{this[Ti]?(Ih(this),Pl.update.call(this,c),this[Ti]=null):Pl[_].call(this,c)}catch(K){throw this[Ln]=!1,K}if(E?R={type:m.event||p,escapeConnect:g,batch:P}:R=P[0],this[Ln]=!1,!h){var N=this._messageCenter;if(N.trigger(R.type,R),M){var B={type:"selectchanged",escapeConnect:g,selected:Ppe(v),isFromClick:c.isFromClick||!1,fromAction:c.type,fromActionPayload:c};N.trigger(B.type,B)}}},ty=function(c){for(var h=this._pendingActions;h.length;){var d=h.shift();UR.call(this,d,c)}},ry=function(c){!c&&this.trigger("updated")},Ij=function(c,h){c.on("rendered",function(d){h.trigger("rendered",d),c.animation.isFinished()&&!h[Ti]&&!h._scheduler.unfinished&&!h._pendingActions.length&&h.trigger("finished")})},Mj=function(c,h){c.on("mouseover",function(d){var v=d.target,p=Ky(v,OI);p&&(Rpe(p,d,h._api),sa(h))}).on("mouseout",function(d){var v=d.target,p=Ky(v,OI);p&&(kpe(p,d,h._api),sa(h))}).on("click",function(d){var v=d.target,p=Ky(v,function(m){return ur(m).dataIndex!=null},!0);if(p){var g=p.selected?"unselect":"select",y=ur(p);h._api.dispatchAction({type:g,dataType:y.dataType,dataIndexInside:y.dataIndex,seriesIndex:y.seriesIndex,isFromClick:!0})}})};function r(c){c.clearColorPalette(),c.eachSeries(function(h){h.clearColorPalette()})}function n(c){var h=[],d=[],v=!1;if(c.eachComponent(function(m,b){var _=b.get("zlevel")||0,x=b.get("z")||0,T=b.getZLevelKey();v=v||!!T,(m==="series"?d:h).push({zlevel:_,z:x,idx:b.componentIndex,type:m,key:T})}),v){var p=h.concat(d),g,y;N1(p,function(m,b){return m.zlevel===b.zlevel?m.z-b.z:m.zlevel-b.zlevel}),le(p,function(m){var b=c.getComponent(m.type,m.idx),_=m.zlevel,x=m.key;g!=null&&(_=Math.max(g,_)),x?(_===g&&x!==y&&_++,y=x):y&&(_===g&&_++,y=""),g=_,b.setZLevel(_)})}}zR=function(c,h,d,v,p){n(h),Dj(c,h,d,v,p),le(c._chartsViews,function(g){g.__alive=!1}),sS(c,h,d,v,p),le(c._chartsViews,function(g){g.__alive||g.remove(h,d)})},Dj=function(c,h,d,v,p,g){le(g||c._componentsViews,function(y){var m=y.__model;u(m,y),y.render(m,h,d,v),s(m,y),f(m,y)})},sS=function(c,h,d,v,p,g){var y=c._scheduler;p=Le(p||{},{updatedSeries:h.getSeries()}),Za.trigger("series:beforeupdate",h,d,p);var m=!1;h.eachSeries(function(b){var _=c._chartsMap[b.__viewId];_.__alive=!0;var x=_.renderTask;y.updatePayload(x,v),u(b,_),g&&g.get(b.uid)&&x.dirty(),x.perform(y.getPerformArgs(x))&&(m=!0),_.group.silent=!!b.get("silent"),o(b,_),vV(b)}),y.unfinished=m||y.unfinished,Za.trigger("series:layoutlabels",h,d,p),Za.trigger("series:transition",h,d,p),h.eachSeries(function(b){var _=c._chartsMap[b.__viewId];s(b,_),f(b,_)}),a(c,h),Za.trigger("series:afterupdate",h,d,p)},sa=function(c){c[HR]=!0,c.getZr().wakeUp()},Nj=function(c){c[HR]&&(c.getZr().storage.traverse(function(h){vm(h)||i(h)}),c[HR]=!1)};function i(c){for(var h=[],d=c.currentStates,v=0;v<d.length;v++){var p=d[v];p==="emphasis"||p==="blur"||p==="select"||h.push(p)}c.selected&&c.states.select&&h.push("select"),c.hoverState===rO&&c.states.emphasis?h.push("emphasis"):c.hoverState===tO&&c.states.blur&&h.push("blur"),c.useStates(h)}function a(c,h){var d=c._zr,v=d.storage,p=0;v.traverse(function(g){g.isGroup||p++}),p>h.get("hoverLayerThreshold")&&!Bt.node&&!Bt.worker&&h.eachSeries(function(g){if(!g.preventUsingHoverLayer){var y=c._chartsMap[g.__viewId];y.__alive&&y.eachRendered(function(m){m.states.emphasis&&(m.states.emphasis.hoverLayer=!0)})}})}function o(c,h){var d=c.get("blendMode")||null;h.eachRendered(function(v){v.isGroup||(v.style.blend=d)})}function s(c,h){if(!c.preventAutoZ){var d=c.get("z")||0,v=c.get("zlevel")||0;h.eachRendered(function(p){return l(p,d,v,-1/0),!0})}}function l(c,h,d,v){var p=c.getTextContent(),g=c.getTextGuideLine(),y=c.isGroup;if(y)for(var m=c.childrenRef(),b=0;b<m.length;b++)v=Math.max(l(m[b],h,d,v),v);else c.z=h,c.zlevel=d,v=Math.max(c.z2,v);if(p&&(p.z=h,p.zlevel=d,isFinite(v)&&(p.z2=v+2)),g){var _=c.textGuideLineConfig;g.z=h,g.zlevel=d,isFinite(v)&&(g.z2=v+(_&&_.showAbove?1:-1))}return v}function u(c,h){h.eachRendered(function(d){if(!vm(d)){var v=d.getTextContent(),p=d.getTextGuideLine();d.stateTransition&&(d.stateTransition=null),v&&v.stateTransition&&(v.stateTransition=null),p&&p.stateTransition&&(p.stateTransition=null),d.hasState()?(d.prevStates=d.currentStates,d.clearStates()):d.prevStates&&(d.prevStates=null)}})}function f(c,h){var d=c.getModel("stateAnimation"),v=c.isAnimationEnabled(),p=d.get("duration"),g=p>0?{duration:p,delay:d.get("delay"),easing:d.get("easing")}:null;h.eachRendered(function(y){if(y.states&&y.states.emphasis){if(vm(y))return;if(y instanceof cr&&Npe(y),y.__dirty){var m=y.prevStates;m&&y.useStates(m)}if(v){y.stateTransition=g;var b=y.getTextContent(),_=y.getTextGuideLine();b&&(b.stateTransition=g),_&&(_.stateTransition=g)}y.__dirty&&i(y)}})}$j=function(c){return new(function(h){Ye(d,h);function d(){return h!==null&&h.apply(this,arguments)||this}return d.prototype.getCoordinateSystems=function(){return c._coordSysMgr.getCoordinateSystems()},d.prototype.getComponentByElement=function(v){for(;v;){var p=v.__ecComponentInfo;if(p!=null)return c._model.getComponent(p.mainType,p.index);v=v.parent}},d.prototype.enterEmphasis=function(v,p){ex(v,p),sa(c)},d.prototype.leaveEmphasis=function(v,p){tx(v,p),sa(c)},d.prototype.enterBlur=function(v){Ope(v),sa(c)},d.prototype.leaveBlur=function(v){eJ(v),sa(c)},d.prototype.enterSelect=function(v){tJ(v),sa(c)},d.prototype.leaveSelect=function(v){rJ(v),sa(c)},d.prototype.getModel=function(){return c.getModel()},d.prototype.getViewOfComponentModel=function(v){return c.getViewOfComponentModel(v)},d.prototype.getViewOfSeriesModel=function(v){return c.getViewOfSeriesModel(v)},d}(tQ))(c)},zQ=function(c){function h(d,v){for(var p=0;p<d.length;p++){var g=d[p];g[BR]=v}}le(mm,function(d,v){c._messageCenter.on(v,function(p){if(Lj[c.group]&&c[BR]!==Pj){if(p&&p.escapeConnect)return;var g=c.makeActionFromEvent(p),y=[];le(bm,function(m){m!==c&&m.group===c.group&&y.push(m)}),h(y,Pj),le(y,function(m){m[BR]!==z0e&&m.dispatchAction(g)}),h(y,G0e)}})})}}(),t}(ts),gL=GQ.prototype;gL.on=BQ("on");gL.off=BQ("off");gL.one=function(e,t,r){var n=this;function i(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];t&&t.apply&&t.apply(this,a),n.off(e,i)}this.on.call(this,e,i,r)};var Y0e=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var dx={},mm={},jI=[],WI=[],vx=[],YQ={},UI={},bm={},Lj={},K0e=+new Date-0,yL="_echarts_instance_";function X0e(e,t,r){var n=!(r&&r.ssr);if(n){var i=q0e(e);if(i)return i}var a=new GQ(e,t,r);return a.id="ec_"+K0e++,bm[a.id]=a,n&&$Z(e,yL,a.id),zQ(a),Za.trigger("afterinit",a),a}function q0e(e){return bm[hve(e,yL)]}function mL(e,t){YQ[e]=t}function KQ(e){yr(WI,e)<0&&WI.push(e)}function XQ(e,t){wL(jI,e,t,L0e)}function Z0e(e){bL("afterinit",e)}function J0e(e){bL("afterupdate",e)}function bL(e,t){Za.on(e,t)}function xg(e,t,r){Nt(t)&&(r=t,t="");var n=dt(e)?e.type:[e,e={event:t}][0];e.event=(e.event||n).toLowerCase(),t=e.event,!mm[t]&&(ul(Aj.test(n)&&Aj.test(t)),dx[n]||(dx[n]={action:r,actionInfo:e}),mm[t]=n)}function Q0e(e,t){sL.register(e,t)}function ebe(e,t){wL(vx,e,t,LQ,"layout")}function eh(e,t){wL(vx,e,t,FQ,"visual")}var Fj=[];function wL(e,t,r,n,i){if((Nt(t)||dt(t))&&(r=t,t=n),!(yr(Fj,r)>=0)){Fj.push(r);var a=OQ.wrapStageHandler(r,i);a.__prio=t,a.__raw=r,e.push(a)}}function qQ(e,t){UI[e]=t}function tbe(e,t,r){var n=I0e("registerMap");n&&n(e,t,r)}var rbe=nme;eh(pL,Ime);eh(wO,Mme);eh(wO,Dme);eh(pL,Xme);eh(wO,qme);eh(HQ,k0e);KQ(nQ);XQ($0e,Hye);qQ("default",$me);xg({type:wc,event:wc,update:wc},Di);xg({type:W1,event:W1,update:W1},Di);xg({type:cm,event:cm,update:cm},Di);xg({type:U1,event:U1,update:U1},Di);xg({type:hm,event:hm,update:hm},Di);mL("light",Gme);mL("dark",Yme);function ny(e){return e==null?0:e.length||1}function Hj(e){return e}var nbe=function(){function e(t,r,n,i,a,o){this._old=t,this._new=r,this._oldKeyGetter=n||Hj,this._newKeyGetter=i||Hj,this.context=a,this._diffModeMultiple=o==="multiple"}return e.prototype.add=function(t){return this._add=t,this},e.prototype.update=function(t){return this._update=t,this},e.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},e.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},e.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},e.prototype.remove=function(t){return this._remove=t,this},e.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},e.prototype._executeOneToOne=function(){var t=this._old,r=this._new,n={},i=new Array(t.length),a=new Array(r.length);this._initIndexMap(t,null,i,"_oldKeyGetter"),this._initIndexMap(r,n,a,"_newKeyGetter");for(var o=0;o<t.length;o++){var s=i[o],l=n[s],u=ny(l);if(u>1){var f=l.shift();l.length===1&&(n[s]=l[0]),this._update&&this._update(f,o)}else u===1?(n[s]=null,this._update&&this._update(l,o)):this._remove&&this._remove(o)}this._performRestAdd(a,n)},e.prototype._executeMultiple=function(){var t=this._old,r=this._new,n={},i={},a=[],o=[];this._initIndexMap(t,n,a,"_oldKeyGetter"),this._initIndexMap(r,i,o,"_newKeyGetter");for(var s=0;s<a.length;s++){var l=a[s],u=n[l],f=i[l],c=ny(u),h=ny(f);if(c>1&&h===1)this._updateManyToOne&&this._updateManyToOne(f,u),i[l]=null;else if(c===1&&h>1)this._updateOneToMany&&this._updateOneToMany(f,u),i[l]=null;else if(c===1&&h===1)this._update&&this._update(f,u),i[l]=null;else if(c>1&&h>1)this._updateManyToMany&&this._updateManyToMany(f,u),i[l]=null;else if(c>1)for(var d=0;d<c;d++)this._remove&&this._remove(u[d]);else this._remove&&this._remove(u)}this._performRestAdd(o,i)},e.prototype._performRestAdd=function(t,r){for(var n=0;n<t.length;n++){var i=t[n],a=r[i],o=ny(a);if(o>1)for(var s=0;s<o;s++)this._add&&this._add(a[s]);else o===1&&this._add&&this._add(a);r[i]=null}},e.prototype._initIndexMap=function(t,r,n,i){for(var a=this._diffModeMultiple,o=0;o<t.length;o++){var s="_ec_"+this[i](t[o],o);if(a||(n[o]=s),!!r){var l=r[s],u=ny(l);u===0?(r[s]=o,a&&n.push(s)):u===1?r[s]=[l,o]:l.push(o)}}},e}();const ibe=nbe;var abe=function(){function e(t,r){this._encode=t,this._schema=r}return e.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},e.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},e}();function obe(e,t){var r={},n=r.encode={},i=Vt(),a=[],o=[],s={};le(e.dimensions,function(h){var d=e.getDimensionInfo(h),v=d.coordDim;if(v){var p=d.coordDimIndex;GR(n,v)[p]=h,d.isExtraCoord||(i.set(v,1),lbe(d.type)&&(a[0]=h),GR(s,v)[p]=e.getDimensionIndex(d.name)),d.defaultTooltip&&o.push(h)}KJ.each(function(g,y){var m=GR(n,y),b=d.otherDims[y];b!=null&&b!==!1&&(m[b]=d.name)})});var l=[],u={};i.each(function(h,d){var v=n[d];u[d]=v[0],l=l.concat(v)}),r.dataDimsOnCoord=l,r.dataDimIndicesOnCoord=pt(l,function(h){return e.getDimensionInfo(h).storeDimIndex}),r.encodeFirstDimNotExtra=u;var f=n.label;f&&f.length&&(a=f.slice());var c=n.tooltip;return c&&c.length?o=c.slice():o.length||(o=a.slice()),n.defaultedLabel=a,n.defaultedTooltip=o,r.userOutput=new abe(s,t),r}function GR(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}function sbe(e){return e==="category"?"ordinal":e==="time"?"time":"float"}function lbe(e){return!(e==="ordinal"||e==="time")}var ube=function(){function e(t){this.otherDims={},t!=null&&Le(this,t)}return e}();const K1=ube;var fbe=pn(),cbe={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},ZQ=function(){function e(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return e.prototype.isDimensionOmitted=function(){return this._dimOmitted},e.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=eee(this.source)))},e.prototype.getSourceDimensionIndex=function(t){return Xt(this._dimNameMap.get(t),-1)},e.prototype.getSourceDimension=function(t){var r=this.source.dimensionsDefine;if(r)return r[t]},e.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,r=aQ(this.source),n=!tee(t),i="",a=[],o=0,s=0;o<t;o++){var l=void 0,u=void 0,f=void 0,c=this.dimensions[s];if(c&&c.storeDimIndex===o)l=r?c.name:null,u=c.type,f=c.ordinalMeta,s++;else{var h=this.getSourceDimension(o);h&&(l=r?h.name:null,u=h.type)}a.push({property:l,type:u,ordinalMeta:f}),r&&l!=null&&(!c||!c.isCalculationCoord)&&(i+=n?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),i+="$",i+=cbe[u]||"f",f&&(i+=f.uid),i+="$"}var d=this.source,v=[d.seriesLayoutBy,d.startIndex,i].join("$$");return{dimensions:a,hash:v}},e.prototype.makeOutputDimensionNames=function(){for(var t=[],r=0,n=0;r<this._fullDimCount;r++){var i=void 0,a=this.dimensions[n];if(a&&a.storeDimIndex===r)a.isCalculationCoord||(i=a.name),n++;else{var o=this.getSourceDimension(r);o&&(i=o.name)}t.push(i)}return t},e.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},e}();function JQ(e){return e instanceof ZQ}function QQ(e){for(var t=Vt(),r=0;r<(e||[]).length;r++){var n=e[r],i=dt(n)?n.name:n;i!=null&&t.get(i)==null&&t.set(i,r)}return t}function eee(e){var t=fbe(e);return t.dimNameMap||(t.dimNameMap=QQ(e.dimensionsDefine))}function tee(e){return e>30}var iy=dt,Il=pt,hbe=typeof Int32Array>"u"?Array:Int32Array,dbe="e\0\0",Bj=-1,vbe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],pbe=["_approximateExtent"],Vj,lS,ay,oy,YR,uS,KR,gbe=function(){function e(t,r){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var n,i=!1;JQ(t)?(n=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(i=!0,n=t),n=n||["x","y"];for(var a={},o=[],s={},l=!1,u={},f=0;f<n.length;f++){var c=n[f],h=st(c)?new K1({name:c}):c instanceof K1?c:new K1(c),d=h.name;h.type=h.type||"float",h.coordDim||(h.coordDim=d,h.coordDimIndex=0);var v=h.otherDims=h.otherDims||{};o.push(d),a[d]=h,u[d]!=null&&(l=!0),h.createInvertedIndices&&(s[d]=[]),v.itemName===0&&(this._nameDimIdx=f),v.itemId===0&&(this._idDimIdx=f),i&&(h.storeDimIndex=f)}if(this.dimensions=o,this._dimInfos=a,this._initGetDimensionInfo(l),this.hostModel=r,this._invertedIndicesMap=s,this._dimOmitted){var p=this._dimIdxToName=Vt();le(o,function(g){p.set(a[g].storeDimIndex,g)})}}return e.prototype.getDimension=function(t){var r=this._recognizeDimIndex(t);if(r==null)return t;if(r=t,!this._dimOmitted)return this.dimensions[r];var n=this._dimIdxToName.get(r);if(n!=null)return n;var i=this._schema.getSourceDimension(r);if(i)return i.name},e.prototype.getDimensionIndex=function(t){var r=this._recognizeDimIndex(t);if(r!=null)return r;if(t==null)return-1;var n=this._getDimInfo(t);return n?n.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},e.prototype._recognizeDimIndex=function(t){if(_r(t)||t!=null&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},e.prototype._getStoreDimIndex=function(t){var r=this.getDimensionIndex(t);return r},e.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},e.prototype._initGetDimensionInfo=function(t){var r=this._dimInfos;this._getDimInfo=t?function(n){return r.hasOwnProperty(n)?r[n]:void 0}:function(n){return r[n]}},e.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},e.prototype.mapDimension=function(t,r){var n=this._dimSummary;if(r==null)return n.encodeFirstDimNotExtra[t];var i=n.encode[t];return i?i[r]:null},e.prototype.mapDimensionsAll=function(t){var r=this._dimSummary,n=r.encode[t];return(n||[]).slice()},e.prototype.getStore=function(){return this._store},e.prototype.initData=function(t,r,n){var i=this,a;if(t instanceof II&&(a=t),!a){var o=this.dimensions,s=lL(t)||Ni(t)?new oQ(t,o.length):t;a=new II;var l=Il(o,function(u){return{type:i._dimInfos[u].type,property:u}});a.initData(s,l,n)}this._store=a,this._nameList=(r||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,a.count()),this._dimSummary=obe(this,this._schema),this.userOutput=this._dimSummary.userOutput},e.prototype.appendData=function(t){var r=this._store.appendData(t);this._doInit(r[0],r[1])},e.prototype.appendValues=function(t,r){var n=this._store.appendValues(t,r.length),i=n.start,a=n.end,o=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),r)for(var s=i;s<a;s++){var l=s-i;this._nameList[s]=r[l],o&&KR(this,s)}},e.prototype._updateOrdinalMeta=function(){for(var t=this._store,r=this.dimensions,n=0;n<r.length;n++){var i=this._dimInfos[r[n]];i.ordinalMeta&&t.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},e.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return this._idDimIdx==null&&t.getSource().sourceFormat!==cu&&!t.fillStorage},e.prototype._doInit=function(t,r){if(!(t>=r)){var n=this._store,i=n.getProvider();this._updateOrdinalMeta();var a=this._nameList,o=this._idList,s=i.getSource().sourceFormat,l=s===Da;if(l&&!i.pure)for(var u=[],f=t;f<r;f++){var c=i.getItem(f,u);if(!this.hasItemOption&&tve(c)&&(this.hasItemOption=!0),c){var h=c.name;a[f]==null&&h!=null&&(a[f]=Ko(h,null));var d=c.id;o[f]==null&&d!=null&&(o[f]=Ko(d,null))}}if(this._shouldMakeIdFromName())for(var f=t;f<r;f++)KR(this,f);Vj(this)}},e.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.setApproximateExtent=function(t,r){r=this.getDimension(r),this._approximateExtent[r]=t.slice()},e.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},e.prototype.setCalculationInfo=function(t,r){iy(t)?Le(this._calculationInfo,t):this._calculationInfo[t]=r},e.prototype.getName=function(t){var r=this.getRawIndex(t),n=this._nameList[r];return n==null&&this._nameDimIdx!=null&&(n=ay(this,this._nameDimIdx,r)),n==null&&(n=""),n},e.prototype._getCategory=function(t,r){var n=this._store.get(t,r),i=this._store.getOrdinalMeta(t);return i?i.categories[n]:n},e.prototype.getId=function(t){return lS(this,this.getRawIndex(t))},e.prototype.count=function(){return this._store.count()},e.prototype.get=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.get(i.storeDimIndex,r)},e.prototype.getByRawIndex=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.getByRawIndex(i.storeDimIndex,r)},e.prototype.getIndices=function(){return this._store.getIndices()},e.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},e.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},e.prototype.getValues=function(t,r){var n=this,i=this._store;return et(t)?i.getValues(Il(t,function(a){return n._getStoreDimIndex(a)}),r):i.getValues(t)},e.prototype.hasValue=function(t){for(var r=this._dimSummary.dataDimIndicesOnCoord,n=0,i=r.length;n<i;n++)if(isNaN(this._store.get(r[n],t)))return!1;return!0},e.prototype.indexOfName=function(t){for(var r=0,n=this._store.count();r<n;r++)if(this.getName(r)===t)return r;return-1},e.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},e.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},e.prototype.rawIndexOf=function(t,r){var n=t&&this._invertedIndicesMap[t],i=n[r];return i==null||isNaN(i)?Bj:i},e.prototype.indicesOfNearest=function(t,r,n){return this._store.indicesOfNearest(this._getStoreDimIndex(t),r,n)},e.prototype.each=function(t,r,n){Nt(t)&&(n=r,r=t,t=[]);var i=n||this,a=Il(oy(t),this._getStoreDimIndex,this);this._store.each(a,i?Or(r,i):r)},e.prototype.filterSelf=function(t,r,n){Nt(t)&&(n=r,r=t,t=[]);var i=n||this,a=Il(oy(t),this._getStoreDimIndex,this);return this._store=this._store.filter(a,i?Or(r,i):r),this},e.prototype.selectRange=function(t){var r=this,n={},i=Dr(t);return le(i,function(a){var o=r._getStoreDimIndex(a);n[o]=t[a]}),this._store=this._store.selectRange(n),this},e.prototype.mapArray=function(t,r,n){Nt(t)&&(n=r,r=t,t=[]),n=n||this;var i=[];return this.each(t,function(){i.push(r&&r.apply(this,arguments))},n),i},e.prototype.map=function(t,r,n,i){var a=n||i||this,o=Il(oy(t),this._getStoreDimIndex,this),s=uS(this);return s._store=this._store.map(o,a?Or(r,a):r),s},e.prototype.modify=function(t,r,n,i){var a=n||i||this,o=Il(oy(t),this._getStoreDimIndex,this);this._store.modify(o,a?Or(r,a):r)},e.prototype.downSample=function(t,r,n,i){var a=uS(this);return a._store=this._store.downSample(this._getStoreDimIndex(t),r,n,i),a},e.prototype.lttbDownSample=function(t,r){var n=uS(this);return n._store=this._store.lttbDownSample(this._getStoreDimIndex(t),r),n},e.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},e.prototype.getItemModel=function(t){var r=this.hostModel,n=this.getRawDataItem(t);return new Un(n,r,r&&r.ecModel)},e.prototype.diff=function(t){var r=this;return new ibe(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(n){return lS(t,n)},function(n){return lS(r,n)})},e.prototype.getVisual=function(t){var r=this._visual;return r&&r[t]},e.prototype.setVisual=function(t,r){this._visual=this._visual||{},iy(t)?Le(this._visual,t):this._visual[t]=r},e.prototype.getItemVisual=function(t,r){var n=this._itemVisuals[t],i=n&&n[r];return i??this.getVisual(r)},e.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},e.prototype.ensureUniqueItemVisual=function(t,r){var n=this._itemVisuals,i=n[t];i||(i=n[t]={});var a=i[r];return a==null&&(a=this.getVisual(r),et(a)?a=a.slice():iy(a)&&(a=Le({},a)),i[r]=a),a},e.prototype.setItemVisual=function(t,r,n){var i=this._itemVisuals[t]||{};this._itemVisuals[t]=i,iy(r)?Le(i,r):i[r]=n},e.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},e.prototype.setLayout=function(t,r){iy(t)?Le(this._layout,t):this._layout[t]=r},e.prototype.getLayout=function(t){return this._layout[t]},e.prototype.getItemLayout=function(t){return this._itemLayouts[t]},e.prototype.setItemLayout=function(t,r,n){this._itemLayouts[t]=n?Le(this._itemLayouts[t]||{},r):r},e.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},e.prototype.setItemGraphicEl=function(t,r){var n=this.hostModel&&this.hostModel.seriesIndex;gpe(n,this.dataType,t,r),this._graphicEls[t]=r},e.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},e.prototype.eachItemGraphicEl=function(t,r){le(this._graphicEls,function(n,i){n&&t&&t.call(r,n,i)})},e.prototype.cloneShallow=function(t){return t||(t=new e(this._schema?this._schema:Il(this.dimensions,this._getDimInfo,this),this.hostModel)),YR(t,this),t._store=this._store,t},e.prototype.wrapMethod=function(t,r){var n=this[t];Nt(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var i=n.apply(this,arguments);return r.apply(this,[i].concat(EN(arguments)))})},e.internalField=function(){Vj=function(t){var r=t._invertedIndicesMap;le(r,function(n,i){var a=t._dimInfos[i],o=a.ordinalMeta,s=t._store;if(o){n=r[i]=new hbe(o.categories.length);for(var l=0;l<n.length;l++)n[l]=Bj;for(var l=0;l<s.count();l++)n[s.get(a.storeDimIndex,l)]=l}})},ay=function(t,r,n){return Ko(t._getCategory(r,n),null)},lS=function(t,r){var n=t._idList[r];return n==null&&t._idDimIdx!=null&&(n=ay(t,t._idDimIdx,r)),n==null&&(n=dbe+r),n},oy=function(t){return et(t)||(t=t!=null?[t]:[]),t},uS=function(t){var r=new e(t._schema?t._schema:Il(t.dimensions,t._getDimInfo,t),t.hostModel);return YR(r,t),r},YR=function(t,r){le(vbe.concat(r.__wrappedMethods||[]),function(n){r.hasOwnProperty(n)&&(t[n]=r[n])}),t.__wrappedMethods=r.__wrappedMethods,le(pbe,function(n){t[n]=Qt(r[n])}),t._calculationInfo=Le({},r._calculationInfo)},KR=function(t,r){var n=t._nameList,i=t._idList,a=t._nameDimIdx,o=t._idDimIdx,s=n[r],l=i[r];if(s==null&&a!=null&&(n[r]=s=ay(t,a,r)),l==null&&o!=null&&(i[r]=l=ay(t,o,r)),l==null&&s!=null){var u=t._nameRepeatCount,f=u[s]=(u[s]||0)+1;l=s,f>1&&(l+="__ec__"+f),i[r]=l}}}(),e}();const ree=gbe;function nee(e,t){lL(e)||(e=uL(e)),t=t||{};var r=t.coordDimensions||[],n=t.dimensionsDefine||e.dimensionsDefine||[],i=Vt(),a=[],o=mbe(e,r,n,t.dimensionsCount),s=t.canOmitUnusedDimensions&&tee(o),l=n===e.dimensionsDefine,u=l?eee(e):QQ(n),f=t.encodeDefine;!f&&t.encodeDefaulter&&(f=t.encodeDefaulter(e,o));for(var c=Vt(f),h=new cQ(o),d=0;d<h.length;d++)h[d]=-1;function v(R){var M=h[R];if(M<0){var D=n[R],N=dt(D)?D:{name:D},B=new K1,K=N.name;K!=null&&u.get(K)!=null&&(B.name=B.displayName=K),N.type!=null&&(B.type=N.type),N.displayName!=null&&(B.displayName=N.displayName);var Z=a.length;return h[R]=Z,B.storeDimIndex=R,a.push(B),B}return a[M]}if(!s)for(var d=0;d<o;d++)v(d);c.each(function(R,M){var D=gi(R).slice();if(D.length===1&&!st(D[0])&&D[0]<0){c.set(M,!1);return}var N=c.set(M,[]);le(D,function(B,K){var Z=st(B)?u.get(B):B;Z!=null&&Z<o&&(N[K]=Z,g(v(Z),M,K))})});var p=0;le(r,function(R){var M,D,N,B;if(st(R))M=R,B={};else{B=R,M=B.name;var K=B.ordinalMeta;B.ordinalMeta=null,B=Le({},B),B.ordinalMeta=K,D=B.dimsDef,N=B.otherDims,B.name=B.coordDim=B.coordDimIndex=B.dimsDef=B.otherDims=null}var Z=c.get(M);if(Z!==!1){if(Z=gi(Z),!Z.length)for(var ie=0;ie<(D&&D.length||1);ie++){for(;p<o&&v(p).coordDim!=null;)p++;p<o&&Z.push(p++)}le(Z,function(me,k){var w=v(me);if(l&&B.type!=null&&(w.type=B.type),g(lr(w,B),M,k),w.name==null&&D){var C=D[k];!dt(C)&&(C={name:C}),w.name=w.displayName=C.name,w.defaultTooltip=C.defaultTooltip}N&&lr(w.otherDims,N)})}});function g(R,M,D){KJ.get(M)!=null?R.otherDims[M]=D:(R.coordDim=M,R.coordDimIndex=D,i.set(M,!0))}var y=t.generateCoord,m=t.generateCoordCount,b=m!=null;m=y?m||1:0;var _=y||"value";function x(R){R.name==null&&(R.name=R.coordDim)}if(s)le(a,function(R){x(R)}),a.sort(function(R,M){return R.storeDimIndex-M.storeDimIndex});else for(var T=0;T<o;T++){var E=v(T),P=E.coordDim;P==null&&(E.coordDim=bbe(_,i,b),E.coordDimIndex=0,(!y||m<=0)&&(E.isExtraCoord=!0),m--),x(E),E.type==null&&(ZJ(e,T)===An.Must||E.isExtraCoord&&(E.otherDims.itemName!=null||E.otherDims.seriesName!=null))&&(E.type="ordinal")}return ybe(a),new ZQ({source:e,dimensions:a,fullDimensionCount:o,dimensionOmitted:s})}function ybe(e){for(var t=Vt(),r=0;r<e.length;r++){var n=e[r],i=n.name,a=t.get(i)||0;a>0&&(n.name=i+(a-1)),a++,t.set(i,a)}}function mbe(e,t,r,n){var i=Math.max(e.dimensionsDetectedCount||1,t.length,r.length,n||0);return le(t,function(a){var o;dt(a)&&(o=a.dimsDef)&&(i=Math.max(i,o.length))}),i}function bbe(e,t,r){if(r||t.hasKey(e)){for(var n=0;t.hasKey(e+n);)n++;e+=n}return t.set(e,!0),e}var wbe=function(){function e(t){this.coordSysDims=[],this.axisMap=Vt(),this.categoryAxisMap=Vt(),this.coordSysName=t}return e}();function _be(e){var t=e.get("coordinateSystem"),r=new wbe(t),n=Sbe[t];if(n)return n(e,r,r.axisMap,r.categoryAxisMap),r}var Sbe={cartesian2d:function(e,t,r,n){var i=e.getReferringComponents("xAxis",ao).models[0],a=e.getReferringComponents("yAxis",ao).models[0];t.coordSysDims=["x","y"],r.set("x",i),r.set("y",a),Mh(i)&&(n.set("x",i),t.firstCategoryDimIndex=0),Mh(a)&&(n.set("y",a),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},singleAxis:function(e,t,r,n){var i=e.getReferringComponents("singleAxis",ao).models[0];t.coordSysDims=["single"],r.set("single",i),Mh(i)&&(n.set("single",i),t.firstCategoryDimIndex=0)},polar:function(e,t,r,n){var i=e.getReferringComponents("polar",ao).models[0],a=i.findAxisModel("radiusAxis"),o=i.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],r.set("radius",a),r.set("angle",o),Mh(a)&&(n.set("radius",a),t.firstCategoryDimIndex=0),Mh(o)&&(n.set("angle",o),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},geo:function(e,t,r,n){t.coordSysDims=["lng","lat"]},parallel:function(e,t,r,n){var i=e.ecModel,a=i.getComponent("parallel",e.get("parallelIndex")),o=t.coordSysDims=a.dimensions.slice();le(a.parallelAxisIndex,function(s,l){var u=i.getComponent("parallelAxis",s),f=o[l];r.set(f,u),Mh(u)&&(n.set(f,u),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=l))})}};function Mh(e){return e.get("type")==="category"}function Cbe(e,t,r){r=r||{};var n=r.byIndex,i=r.stackedCoordDimension,a,o,s;xbe(t)?a=t:(o=t.schema,a=o.dimensions,s=t.store);var l=!!(e&&e.get("stack")),u,f,c,h;if(le(a,function(m,b){st(m)&&(a[b]=m={name:m}),l&&!m.isExtraCoord&&(!n&&!u&&m.ordinalMeta&&(u=m),!f&&m.type!=="ordinal"&&m.type!=="time"&&(!i||i===m.coordDim)&&(f=m))}),f&&!n&&!u&&(n=!0),f){c="__\0ecstackresult_"+e.id,h="__\0ecstackedover_"+e.id,u&&(u.createInvertedIndices=!0);var d=f.coordDim,v=f.type,p=0;le(a,function(m){m.coordDim===d&&p++});var g={name:c,coordDim:d,coordDimIndex:p,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length},y={name:h,coordDim:h,coordDimIndex:p+1,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length+1};o?(s&&(g.storeDimIndex=s.ensureCalculationDimension(h,v),y.storeDimIndex=s.ensureCalculationDimension(c,v)),o.appendCalculationDimension(g),o.appendCalculationDimension(y)):(a.push(g),a.push(y))}return{stackedDimension:f&&f.name,stackedByDimension:u&&u.name,isStackedByIndex:n,stackedOverDimension:h,stackResultDimension:c}}function xbe(e){return!JQ(e.schema)}function lv(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function Tbe(e,t){return lv(e,t)?e.getCalculationInfo("stackResultDimension"):t}function Obe(e,t){var r=e.get("coordinateSystem"),n=sL.get(r),i;return t&&t.coordSysDims&&(i=pt(t.coordSysDims,function(a){var o={name:a},s=t.axisMap.get(a);if(s){var l=s.get("type");o.type=sbe(l)}return o})),i||(i=n&&(n.getDimensionsInfo?n.getDimensionsInfo():n.dimensions.slice())||["x","y"]),i}function Ebe(e,t,r){var n,i;return r&&le(e,function(a,o){var s=a.coordDim,l=r.categoryAxisMap.get(s);l&&(n==null&&(n=o),a.ordinalMeta=l.getOrdinalMeta(),t&&(a.createInvertedIndices=!0)),a.otherDims.itemName!=null&&(i=!0)}),!i&&n!=null&&(e[n].otherDims.itemName=0),n}function _L(e,t,r){r=r||{};var n=t.getSourceManager(),i,a=!1;e?(a=!0,i=uL(e)):(i=n.getSource(),a=i.sourceFormat===Da);var o=_be(t),s=Obe(t,o),l=r.useEncodeDefaulter,u=Nt(l)?l:l?en(cye,s,t):null,f={coordDimensions:s,generateCoord:r.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!a},c=nee(i,f),h=Ebe(c.dimensions,r.createInvertedIndices,o),d=a?null:n.getSharedDataStore(c),v=Cbe(t,{schema:c,store:d}),p=new ree(c,t);p.setCalculationInfo(v);var g=h!=null&&Rbe(i)?function(y,m,b,_){return _===h?b:this.defaultDimValueGetter(y,m,b,_)}:null;return p.hasItemOption=!1,p.initData(a?i:d,null,g),p}function Rbe(e){if(e.sourceFormat===Da){var t=kbe(e.data||[]);return!et(Ow(t))}}function kbe(e){for(var t=0;t<e.length&&e[t]==null;)t++;return e[t]}var iee=function(){function e(t){this._setting=t||{},this._extent=[1/0,-1/0]}return e.prototype.getSetting=function(t){return this._setting[t]},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1])},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.setExtent=function(t,r){var n=this._extent;isNaN(t)||(n[0]=t),isNaN(r)||(n[1]=r)},e.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},e.prototype.isBlank=function(){return this._isBlank},e.prototype.setBlank=function(t){this._isBlank=t},e}();JT(iee);const wl=iee;var Abe=0,Pbe=function(){function e(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++Abe}return e.createByAxisModel=function(t){var r=t.option,n=r.data,i=n&&pt(n,Ibe);return new e({categories:i,needCollect:!i,deduplication:r.dedplication!==!1})},e.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},e.prototype.parseAndCollect=function(t){var r,n=this._needCollect;if(!st(t)&&!n)return t;if(n&&!this._deduplication)return r=this.categories.length,this.categories[r]=t,r;var i=this._getOrCreateMap();return r=i.get(t),r==null&&(n?(r=this.categories.length,this.categories[r]=t,i.set(t,r)):r=NaN),r},e.prototype._getOrCreateMap=function(){return this._map||(this._map=Vt(this.categories))},e}();function Ibe(e){return dt(e)&&e.value!=null?e.value:e+""}const zI=Pbe;function GI(e){return e.type==="interval"||e.type==="log"}function Mbe(e,t,r,n){var i={},a=e[1]-e[0],o=i.interval=AZ(a/t,!0);r!=null&&o<r&&(o=i.interval=r),n!=null&&o>n&&(o=i.interval=n);var s=i.intervalPrecision=aee(o),l=i.niceTickExtent=[dn(Math.ceil(e[0]/o)*o,s),dn(Math.floor(e[1]/o)*o,s)];return Dbe(l,e),i}function XR(e){var t=Math.pow(10,LN(e)),r=e/t;return r?r===2?r=3:r===3?r=5:r*=2:r=1,dn(r*t)}function aee(e){return Os(e)+2}function jj(e,t,r){e[t]=Math.max(Math.min(e[t],r[1]),r[0])}function Dbe(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),jj(e,0,t),jj(e,1,t),e[0]>e[1]&&(e[0]=e[1])}function _O(e,t){return e>=t[0]&&e<=t[1]}function SO(e,t){return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])}function CO(e,t){return e*(t[1]-t[0])+t[0]}var oee=function(e){Ye(t,e);function t(r){var n=e.call(this,r)||this;n.type="ordinal";var i=n.getSetting("ordinalMeta");return i||(i=new zI({})),et(i)&&(i=new zI({categories:pt(i,function(a){return dt(a)?a.value:a})})),n._ordinalMeta=i,n._extent=n.getSetting("extent")||[0,i.categories.length-1],n}return t.prototype.parse=function(r){return r==null?NaN:st(r)?this._ordinalMeta.getOrdinal(r):Math.round(r)},t.prototype.contain=function(r){return r=this.parse(r),_O(r,this._extent)&&this._ordinalMeta.categories[r]!=null},t.prototype.normalize=function(r){return r=this._getTickNumber(this.parse(r)),SO(r,this._extent)},t.prototype.scale=function(r){return r=Math.round(CO(r,this._extent)),this.getRawOrdinalNumber(r)},t.prototype.getTicks=function(){for(var r=[],n=this._extent,i=n[0];i<=n[1];)r.push({value:i}),i++;return r},t.prototype.getMinorTicks=function(r){},t.prototype.setSortInfo=function(r){if(r==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var n=r.ordinalNumbers,i=this._ordinalNumbersByTick=[],a=this._ticksByOrdinalNumber=[],o=0,s=this._ordinalMeta.categories.length,l=Math.min(s,n.length);o<l;++o){var u=n[o];i[o]=u,a[u]=o}for(var f=0;o<s;++o){for(;a[f]!=null;)f++;i.push(f),a[f]=o}},t.prototype._getTickNumber=function(r){var n=this._ticksByOrdinalNumber;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getRawOrdinalNumber=function(r){var n=this._ordinalNumbersByTick;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getLabel=function(r){if(!this.isBlank()){var n=this.getRawOrdinalNumber(r.value),i=this._ordinalMeta.categories[n];return i==null?"":i+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.isInExtentRange=function(r){return r=this._getTickNumber(r),this._extent[0]<=r&&this._extent[1]>=r},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(wl);wl.registerClass(oee);const see=oee;var yf=dn,lee=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="interval",r._interval=0,r._intervalPrecision=2,r}return t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return _O(r,this._extent)},t.prototype.normalize=function(r){return SO(r,this._extent)},t.prototype.scale=function(r){return CO(r,this._extent)},t.prototype.setExtent=function(r,n){var i=this._extent;isNaN(r)||(i[0]=parseFloat(r)),isNaN(n)||(i[1]=parseFloat(n))},t.prototype.unionExtent=function(r){var n=this._extent;r[0]<n[0]&&(n[0]=r[0]),r[1]>n[1]&&(n[1]=r[1]),this.setExtent(n[0],n[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(r){this._interval=r,this._niceExtent=this._extent.slice(),this._intervalPrecision=aee(r)},t.prototype.getTicks=function(r){var n=this._interval,i=this._extent,a=this._niceExtent,o=this._intervalPrecision,s=[];if(!n)return s;var l=1e4;i[0]<a[0]&&(r?s.push({value:yf(a[0]-n,o)}):s.push({value:i[0]}));for(var u=a[0];u<=a[1]&&(s.push({value:u}),u=yf(u+n,o),u!==s[s.length-1].value);)if(s.length>l)return[];var f=s.length?s[s.length-1].value:a[1];return i[1]>f&&(r?s.push({value:yf(f+n,o)}):s.push({value:i[1]})),s},t.prototype.getMinorTicks=function(r){for(var n=this.getTicks(!0),i=[],a=this.getExtent(),o=1;o<n.length;o++){for(var s=n[o],l=n[o-1],u=0,f=[],c=s.value-l.value,h=c/r;u<r-1;){var d=yf(l.value+(u+1)*h);d>a[0]&&d<a[1]&&f.push(d),u++}i.push(f)}return i},t.prototype.getLabel=function(r,n){if(r==null)return"";var i=n&&n.precision;i==null?i=Os(r.value)||0:i==="auto"&&(i=this._intervalPrecision);var a=yf(r.value,i,!0);return UJ(a)},t.prototype.calcNiceTicks=function(r,n,i){r=r||5;var a=this._extent,o=a[1]-a[0];if(isFinite(o)){o<0&&(o=-o,a.reverse());var s=Mbe(a,r,n,i);this._intervalPrecision=s.intervalPrecision,this._interval=s.interval,this._niceExtent=s.niceTickExtent}},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1])if(n[0]!==0){var i=Math.abs(n[0]);r.fixMax||(n[1]+=i/2),n[0]-=i/2}else n[1]=1;var a=n[1]-n[0];isFinite(a)||(n[0]=0,n[1]=1),this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval);var o=this._interval;r.fixMin||(n[0]=yf(Math.floor(n[0]/o)*o)),r.fixMax||(n[1]=yf(Math.ceil(n[1]/o)*o))},t.prototype.setNiceExtent=function(r,n){this._niceExtent=[r,n]},t.type="interval",t}(wl);wl.registerClass(lee);const Pw=lee;var uee=typeof Float32Array<"u",$be=uee?Float32Array:Array;function Es(e){return et(e)?uee?new Float32Array(e):e:new $be(e)}var Nbe="__ec_stack_";function SL(e){return e.get("stack")||Nbe+e.seriesIndex}function CL(e){return e.dim+e.index}function fee(e,t){var r=[];return t.eachSeriesByType(e,function(n){hee(n)&&r.push(n)}),r}function Lbe(e){var t={};le(e,function(l){var u=l.coordinateSystem,f=u.getBaseAxis();if(!(f.type!=="time"&&f.type!=="value"))for(var c=l.getData(),h=f.dim+"_"+f.index,d=c.getDimensionIndex(c.mapDimension(f.dim)),v=c.getStore(),p=0,g=v.count();p<g;++p){var y=v.get(d,p);t[h]?t[h].push(y):t[h]=[y]}});var r={};for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(i){i.sort(function(l,u){return l-u});for(var a=null,o=1;o<i.length;++o){var s=i[o]-i[o-1];s>0&&(a=a===null?s:Math.min(a,s))}r[n]=a}}return r}function cee(e){var t=Lbe(e),r=[];return le(e,function(n){var i=n.coordinateSystem,a=i.getBaseAxis(),o=a.getExtent(),s;if(a.type==="category")s=a.getBandWidth();else if(a.type==="value"||a.type==="time"){var l=a.dim+"_"+a.index,u=t[l],f=Math.abs(o[1]-o[0]),c=a.scale.getExtent(),h=Math.abs(c[1]-c[0]);s=u?f/h*u:f}else{var d=n.getData();s=Math.abs(o[1]-o[0])/d.count()}var v=Mr(n.get("barWidth"),s),p=Mr(n.get("barMaxWidth"),s),g=Mr(n.get("barMinWidth")||(dee(n)?.5:1),s),y=n.get("barGap"),m=n.get("barCategoryGap");r.push({bandWidth:s,barWidth:v,barMaxWidth:p,barMinWidth:g,barGap:y,barCategoryGap:m,axisKey:CL(a),stackId:SL(n)})}),Fbe(r)}function Fbe(e){var t={};le(e,function(n,i){var a=n.axisKey,o=n.bandWidth,s=t[a]||{bandWidth:o,remainedWidth:o,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=s.stacks;t[a]=s;var u=n.stackId;l[u]||s.autoWidthCount++,l[u]=l[u]||{width:0,maxWidth:0};var f=n.barWidth;f&&!l[u].width&&(l[u].width=f,f=Math.min(s.remainedWidth,f),s.remainedWidth-=f);var c=n.barMaxWidth;c&&(l[u].maxWidth=c);var h=n.barMinWidth;h&&(l[u].minWidth=h);var d=n.barGap;d!=null&&(s.gap=d);var v=n.barCategoryGap;v!=null&&(s.categoryGap=v)});var r={};return le(t,function(n,i){r[i]={};var a=n.stacks,o=n.bandWidth,s=n.categoryGap;if(s==null){var l=Dr(a).length;s=Math.max(35-l*4,15)+"%"}var u=Mr(s,o),f=Mr(n.gap,1),c=n.remainedWidth,h=n.autoWidthCount,d=(c-u)/(h+(h-1)*f);d=Math.max(d,0),le(a,function(y){var m=y.maxWidth,b=y.minWidth;if(y.width){var _=y.width;m&&(_=Math.min(_,m)),b&&(_=Math.max(_,b)),y.width=_,c-=_+f*_,h--}else{var _=d;m&&m<_&&(_=Math.min(m,c)),b&&b>_&&(_=b),_!==d&&(y.width=_,c-=_+f*_,h--)}}),d=(c-u)/(h+(h-1)*f),d=Math.max(d,0);var v=0,p;le(a,function(y,m){y.width||(y.width=d),p=y,v+=y.width*(1+f)}),p&&(v-=p.width*f);var g=-v/2;le(a,function(y,m){r[i][m]=r[i][m]||{bandWidth:o,offset:g,width:y.width},g+=y.width*(1+f)})}),r}function Hbe(e,t,r){if(e&&t){var n=e[CL(t)];return n!=null&&r!=null?n[SL(r)]:n}}function Bbe(e,t){var r=fee(e,t),n=cee(r);le(r,function(i){var a=i.getData(),o=i.coordinateSystem,s=o.getBaseAxis(),l=SL(i),u=n[CL(s)][l],f=u.offset,c=u.width;a.setLayout({bandWidth:u.bandWidth,offset:f,size:c})})}function Vbe(e){return{seriesType:e,plan:dL(),reset:function(t){if(hee(t)){var r=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),a=n.getOtherAxis(i),o=r.getDimensionIndex(r.mapDimension(a.dim)),s=r.getDimensionIndex(r.mapDimension(i.dim)),l=t.get("showBackground",!0),u=r.mapDimension(a.dim),f=r.getCalculationInfo("stackResultDimension"),c=lv(r,u)&&!!r.getCalculationInfo("stackedOnSeries"),h=a.isHorizontal(),d=jbe(i,a),v=dee(t),p=t.get("barMinHeight")||0,g=f&&r.getDimensionIndex(f),y=r.getLayout("size"),m=r.getLayout("offset");return{progress:function(b,_){for(var x=b.count,T=v&&Es(x*3),E=v&&l&&Es(x*3),P=v&&Es(x),R=n.master.getRect(),M=h?R.width:R.height,D,N=_.getStore(),B=0;(D=b.next())!=null;){var K=N.get(c?g:o,D),Z=N.get(s,D),ie=d,me=void 0;c&&(me=+K-N.get(o,D));var k=void 0,w=void 0,C=void 0,O=void 0;if(h){var S=n.dataToPoint([K,Z]);if(c){var A=n.dataToPoint([me,Z]);ie=A[0]}k=ie,w=S[1]+m,C=S[0]-ie,O=y,Math.abs(C)<p&&(C=(C<0?-1:1)*p)}else{var S=n.dataToPoint([Z,K]);if(c){var A=n.dataToPoint([Z,me]);ie=A[1]}k=S[0]+m,w=ie,C=y,O=S[1]-ie,Math.abs(O)<p&&(O=(O<=0?-1:1)*p)}v?(T[B]=k,T[B+1]=w,T[B+2]=h?C:O,E&&(E[B]=h?R.x:k,E[B+1]=h?w:R.y,E[B+2]=M),P[D]=D):_.setItemLayout(D,{x:k,y:w,width:C,height:O}),B+=3}v&&_.setLayout({largePoints:T,largeDataIndices:P,largeBackgroundPoints:E,valueAxisHorizontal:h})}}}}}}function hee(e){return e.coordinateSystem&&e.coordinateSystem.type==="cartesian2d"}function dee(e){return e.pipelineContext&&e.pipelineContext.large}function jbe(e,t){return t.toGlobalCoord(t.dataToCoord(t.type==="log"?1:0))}var Wbe=function(e,t,r,n){for(;r<n;){var i=r+n>>>1;e[i][1]<t?r=i+1:n=i}return r},vee=function(e){Ye(t,e);function t(r){var n=e.call(this,r)||this;return n.type="time",n}return t.prototype.getLabel=function(r){var n=this.getSetting("useUTC");return uO(r.value,MV[tye(Nd(this._minLevelUnit))]||MV.second,n,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(r,n,i){var a=this.getSetting("useUTC"),o=this.getSetting("locale");return rye(r,n,i,o,a)},t.prototype.getTicks=function(){var r=this._interval,n=this._extent,i=[];if(!r)return i;i.push({value:n[0],level:0});var a=this.getSetting("useUTC"),o=qbe(this._minLevelUnit,this._approxInterval,a,n);return i=i.concat(o),i.push({value:n[1],level:0}),i},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1]&&(n[0]-=Oa,n[1]+=Oa),n[1]===-1/0&&n[0]===1/0){var i=new Date;n[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),n[0]=n[1]-Oa}this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval)},t.prototype.calcNiceTicks=function(r,n,i){r=r||10;var a=this._extent,o=a[1]-a[0];this._approxInterval=o/r,n!=null&&this._approxInterval<n&&(this._approxInterval=n),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var s=fS.length,l=Math.min(Wbe(fS,this._approxInterval,0,s),s-1);this._interval=fS[l][1],this._minLevelUnit=fS[Math.max(l-1,0)][0]},t.prototype.parse=function(r){return _r(r)?r:+fl(r)},t.prototype.contain=function(r){return _O(this.parse(r),this._extent)},t.prototype.normalize=function(r){return SO(this.parse(r),this._extent)},t.prototype.scale=function(r){return CO(r,this._extent)},t.type="time",t}(Pw),fS=[["second",tL],["minute",rL],["hour",pm],["quarter-day",pm*6],["half-day",pm*12],["day",Oa*1.2],["half-week",Oa*3.5],["week",Oa*7],["month",Oa*31],["quarter",Oa*95],["half-year",IV/2],["year",IV]];function Ube(e,t,r,n){var i=fl(t),a=fl(r),o=function(v){return DV(i,v,n)===DV(a,v,n)},s=function(){return o("year")},l=function(){return s()&&o("month")},u=function(){return l()&&o("day")},f=function(){return u()&&o("hour")},c=function(){return f()&&o("minute")},h=function(){return c()&&o("second")},d=function(){return h()&&o("millisecond")};switch(e){case"year":return s();case"month":return l();case"day":return u();case"hour":return f();case"minute":return c();case"second":return h();case"millisecond":return d()}}function zbe(e,t){return e/=Oa,e>16?16:e>7.5?7:e>3.5?4:e>1.5?2:1}function Gbe(e){var t=30*Oa;return e/=t,e>6?6:e>3?3:e>2?2:1}function Ybe(e){return e/=pm,e>12?12:e>6?6:e>3.5?4:e>2?2:1}function Wj(e,t){return e/=t?rL:tL,e>30?30:e>20?20:e>15?15:e>10?10:e>5?5:e>2?2:1}function Kbe(e){return AZ(e,!0)}function Xbe(e,t,r){var n=new Date(e);switch(Nd(t)){case"year":case"month":n[FJ(r)](0);case"day":n[HJ(r)](1);case"hour":n[BJ(r)](0);case"minute":n[VJ(r)](0);case"second":n[jJ(r)](0),n[WJ(r)](0)}return n.getTime()}function qbe(e,t,r,n){var i=1e4,a=NJ,o=0;function s(M,D,N,B,K,Z,ie){for(var me=new Date(D),k=D,w=me[B]();k<N&&k<=n[1];)ie.push({value:k}),w+=M,me[K](w),k=me.getTime();ie.push({value:k,notAdd:!0})}function l(M,D,N){var B=[],K=!D.length;if(!Ube(Nd(M),n[0],n[1],r)){K&&(D=[{value:Xbe(new Date(n[0]),M,r)},{value:n[1]}]);for(var Z=0;Z<D.length-1;Z++){var ie=D[Z].value,me=D[Z+1].value;if(ie!==me){var k=void 0,w=void 0,C=void 0,O=!1;switch(M){case"year":k=Math.max(1,Math.round(t/Oa/365)),w=nL(r),C=nye(r);break;case"half-year":case"quarter":case"month":k=Gbe(t),w=Ld(r),C=FJ(r);break;case"week":case"half-week":case"day":k=zbe(t),w=fO(r),C=HJ(r),O=!0;break;case"half-day":case"quarter-day":case"hour":k=Ybe(t),w=r0(r),C=BJ(r);break;case"minute":k=Wj(t,!0),w=cO(r),C=VJ(r);break;case"second":k=Wj(t,!1),w=hO(r),C=jJ(r);break;case"millisecond":k=Kbe(t),w=dO(r),C=WJ(r);break}s(k,ie,me,w,C,O,B),M==="year"&&N.length>1&&Z===0&&N.unshift({value:N[0].value-k})}}for(var Z=0;Z<B.length;Z++)N.push(B[Z]);return B}}for(var u=[],f=[],c=0,h=0,d=0;d<a.length&&o++<i;++d){var v=Nd(a[d]);if(eye(a[d])){l(a[d],u[u.length-1]||[],f);var p=a[d+1]?Nd(a[d+1]):null;if(v!==p){if(f.length){h=c,f.sort(function(M,D){return M.value-D.value});for(var g=[],y=0;y<f.length;++y){var m=f[y].value;(y===0||f[y-1].value!==m)&&(g.push(f[y]),m>=n[0]&&m<=n[1]&&c++)}var b=(n[1]-n[0])/t;if(c>b*1.5&&h>b/1.5||(u.push(g),c>b||e===a[d]))break}f=[]}}}for(var _=hi(pt(u,function(M){return hi(M,function(D){return D.value>=n[0]&&D.value<=n[1]&&!D.notAdd})}),function(M){return M.length>0}),x=[],T=_.length-1,d=0;d<_.length;++d)for(var E=_[d],P=0;P<E.length;++P)x.push({value:E[P].value,level:T-d});x.sort(function(M,D){return M.value-D.value});for(var R=[],d=0;d<x.length;++d)(d===0||x[d].value!==x[d-1].value)&&R.push(x[d]);return R}wl.registerClass(vee);const Zbe=vee;var Uj=wl.prototype,wm=Pw.prototype,Jbe=dn,Qbe=Math.floor,ewe=Math.ceil,cS=Math.pow,ja=Math.log,xL=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="log",r.base=10,r._originalScale=new Pw,r._interval=0,r}return t.prototype.getTicks=function(r){var n=this._originalScale,i=this._extent,a=n.getExtent(),o=wm.getTicks.call(this,r);return pt(o,function(s){var l=s.value,u=dn(cS(this.base,l));return u=l===i[0]&&this._fixMin?hS(u,a[0]):u,u=l===i[1]&&this._fixMax?hS(u,a[1]):u,{value:u}},this)},t.prototype.setExtent=function(r,n){var i=ja(this.base);r=ja(Math.max(0,r))/i,n=ja(Math.max(0,n))/i,wm.setExtent.call(this,r,n)},t.prototype.getExtent=function(){var r=this.base,n=Uj.getExtent.call(this);n[0]=cS(r,n[0]),n[1]=cS(r,n[1]);var i=this._originalScale,a=i.getExtent();return this._fixMin&&(n[0]=hS(n[0],a[0])),this._fixMax&&(n[1]=hS(n[1],a[1])),n},t.prototype.unionExtent=function(r){this._originalScale.unionExtent(r);var n=this.base;r[0]=ja(r[0])/ja(n),r[1]=ja(r[1])/ja(n),Uj.unionExtent.call(this,r)},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.calcNiceTicks=function(r){r=r||10;var n=this._extent,i=n[1]-n[0];if(!(i===1/0||i<=0)){var a=Jde(i),o=r/i*a;for(o<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var s=[dn(ewe(n[0]/a)*a),dn(Qbe(n[1]/a)*a)];this._interval=a,this._niceExtent=s}},t.prototype.calcNiceExtent=function(r){wm.calcNiceExtent.call(this,r),this._fixMin=r.fixMin,this._fixMax=r.fixMax},t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return r=ja(r)/ja(this.base),_O(r,this._extent)},t.prototype.normalize=function(r){return r=ja(r)/ja(this.base),SO(r,this._extent)},t.prototype.scale=function(r){return r=CO(r,this._extent),cS(this.base,r)},t.type="log",t}(wl),pee=xL.prototype;pee.getMinorTicks=wm.getMinorTicks;pee.getLabel=wm.getLabel;function hS(e,t){return Jbe(e,Os(t))}wl.registerClass(xL);const twe=xL;var rwe=function(){function e(t,r,n){this._prepareParams(t,r,n)}return e.prototype._prepareParams=function(t,r,n){n[1]<n[0]&&(n=[NaN,NaN]),this._dataMin=n[0],this._dataMax=n[1];var i=this._isOrdinal=t.type==="ordinal";this._needCrossZero=t.type==="interval"&&r.getNeedCrossZero&&r.getNeedCrossZero();var a=this._modelMinRaw=r.get("min",!0);Nt(a)?this._modelMinNum=dS(t,a({min:n[0],max:n[1]})):a!=="dataMin"&&(this._modelMinNum=dS(t,a));var o=this._modelMaxRaw=r.get("max",!0);if(Nt(o)?this._modelMaxNum=dS(t,o({min:n[0],max:n[1]})):o!=="dataMax"&&(this._modelMaxNum=dS(t,o)),i)this._axisDataLen=r.getCategories().length;else{var s=r.get("boundaryGap"),l=et(s)?s:[s||0,s||0];typeof l[0]=="boolean"||typeof l[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[Au(l[0],1),Au(l[1],1)]}},e.prototype.calculate=function(){var t=this._isOrdinal,r=this._dataMin,n=this._dataMax,i=this._axisDataLen,a=this._boundaryGapInner,o=t?null:n-r||Math.abs(r),s=this._modelMinRaw==="dataMin"?r:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?n:this._modelMaxNum,u=s!=null,f=l!=null;s==null&&(s=t?i?0:NaN:r-a[0]*o),l==null&&(l=t?i?i-1:NaN:n+a[1]*o),(s==null||!isFinite(s))&&(s=NaN),(l==null||!isFinite(l))&&(l=NaN);var c=WC(s)||WC(l)||t&&!i;this._needCrossZero&&(s>0&&l>0&&!u&&(s=0),s<0&&l<0&&!f&&(l=0));var h=this._determinedMin,d=this._determinedMax;return h!=null&&(s=h,u=!0),d!=null&&(l=d,f=!0),{min:s,max:l,minFixed:u,maxFixed:f,isBlank:c}},e.prototype.modifyDataMinMax=function(t,r){this[iwe[t]]=r},e.prototype.setDeterminedMinMax=function(t,r){var n=nwe[t];this[n]=r},e.prototype.freeze=function(){this.frozen=!0},e}(),nwe={min:"_determinedMin",max:"_determinedMax"},iwe={min:"_dataMin",max:"_dataMax"};function awe(e,t,r){var n=e.rawExtentInfo;return n||(n=new rwe(e,t,r),e.rawExtentInfo=n,n)}function dS(e,t){return t==null?null:WC(t)?NaN:e.parse(t)}function gee(e,t){var r=e.type,n=awe(e,t,e.getExtent()).calculate();e.setBlank(n.isBlank);var i=n.min,a=n.max,o=t.ecModel;if(o&&r==="time"){var s=fee("bar",o),l=!1;if(le(s,function(c){l=l||c.getBaseAxis()===t.axis}),l){var u=cee(s),f=owe(i,a,t,u);i=f.min,a=f.max}}return{extent:[i,a],fixMin:n.minFixed,fixMax:n.maxFixed}}function owe(e,t,r,n){var i=r.axis.getExtent(),a=i[1]-i[0],o=Hbe(n,r.axis);if(o===void 0)return{min:e,max:t};var s=1/0;le(o,function(d){s=Math.min(d.offset,s)});var l=-1/0;le(o,function(d){l=Math.max(d.offset+d.width,l)}),s=Math.abs(s),l=Math.abs(l);var u=s+l,f=t-e,c=1-(s+l)/a,h=f/c-f;return t+=h*(l/u),e-=h*(s/u),{min:e,max:t}}function zj(e,t){var r=t,n=gee(e,r),i=n.extent,a=r.get("splitNumber");e instanceof twe&&(e.base=r.get("logBase"));var o=e.type,s=r.get("interval"),l=o==="interval"||o==="time";e.setExtent(i[0],i[1]),e.calcNiceExtent({splitNumber:a,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:l?r.get("minInterval"):null,maxInterval:l?r.get("maxInterval"):null}),s!=null&&e.setInterval&&e.setInterval(s)}function swe(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new see({ordinalMeta:e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),extent:[1/0,-1/0]});case"time":return new Zbe({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new(wl.getClass(t)||Pw)}}function lwe(e){var t=e.scale.getExtent(),r=t[0],n=t[1];return!(r>0&&n>0||r<0&&n<0)}function Iw(e){var t=e.getLabelModel().get("formatter"),r=e.type==="category"?e.scale.getExtent()[0]:null;return e.scale.type==="time"?function(n){return function(i,a){return e.scale.getFormattedLabel(i,a,n)}}(t):st(t)?function(n){return function(i){var a=e.scale.getLabel(i),o=n.replace("{value}",a??"");return o}}(t):Nt(t)?function(n){return function(i,a){return r!=null&&(a=i.value-r),n(TL(e,i),a,i.level!=null?{level:i.level}:null)}}(t):function(n){return e.scale.getLabel(n)}}function TL(e,t){return e.type==="category"?e.scale.getLabel(t):t.value}function uwe(e){var t=e.model,r=e.scale;if(!(!t.get(["axisLabel","show"])||r.isBlank())){var n,i,a=r.getExtent();r instanceof see?i=r.count():(n=r.getTicks(),i=n.length);var o=e.getLabelModel(),s=Iw(e),l,u=1;i>40&&(u=Math.ceil(i/40));for(var f=0;f<i;f+=u){var c=n?n[f]:{value:a[0]+f},h=s(c,f),d=o.getTextRect(h),v=fwe(d,o.get("rotate")||0);l?l.union(v):l=v}return l}}function fwe(e,t){var r=t*Math.PI/180,n=e.width,i=e.height,a=n*Math.abs(Math.cos(r))+Math.abs(i*Math.sin(r)),o=n*Math.abs(Math.sin(r))+Math.abs(i*Math.cos(r)),s=new or(e.x,e.y,a,o);return s}function OL(e){var t=e.get("interval");return t??"auto"}function yee(e){return e.type==="category"&&OL(e.getLabelModel())===0}function cwe(e,t){var r={};return le(e.mapDimensionsAll(t),function(n){r[Tbe(e,n)]=!0}),Dr(r)}var hwe=function(){function e(){}return e.prototype.getNeedCrossZero=function(){var t=this.option;return!t.scale},e.prototype.getCoordSysModel=function(){},e}(),Gj=[],dwe={registerPreprocessor:KQ,registerProcessor:XQ,registerPostInit:Z0e,registerPostUpdate:J0e,registerUpdateLifecycle:bL,registerAction:xg,registerCoordinateSystem:Q0e,registerLayout:ebe,registerVisual:eh,registerTransform:rbe,registerLoading:qQ,registerMap:tbe,registerImpl:P0e,PRIORITY:U0e,ComponentModel:Pr,ComponentView:cl,SeriesModel:Mu,ChartView:Xo,registerComponentModel:function(e){Pr.registerClass(e)},registerComponentView:function(e){cl.registerClass(e)},registerSeriesModel:function(e){Mu.registerClass(e)},registerChartView:function(e){Xo.registerClass(e)},registerSubTypeDefaulter:function(e,t){Pr.registerSubTypeDefaulter(e,t)},registerPainter:function(e,t){zde(e,t)}};function Du(e){if(et(e)){le(e,function(t){Du(t)});return}yr(Gj,e)>=0||(Gj.push(e),Nt(e)&&(e={install:e}),e.install(dwe))}var l0=pn();function vwe(e){return e.type==="category"?gwe(e):mwe(e)}function pwe(e,t){return e.type==="category"?ywe(e,t):{ticks:pt(e.scale.getTicks(),function(r){return r.value})}}function gwe(e){var t=e.getLabelModel(),r=mee(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r}function mee(e,t){var r=bee(e,"labels"),n=OL(t),i=wee(r,n);if(i)return i;var a,o;return Nt(n)?a=Cee(e,n):(o=n==="auto"?bwe(e):n,a=See(e,o)),_ee(r,n,{labels:a,labelCategoryInterval:o})}function ywe(e,t){var r=bee(e,"ticks"),n=OL(t),i=wee(r,n);if(i)return i;var a,o;if((!t.get("show")||e.scale.isBlank())&&(a=[]),Nt(n))a=Cee(e,n,!0);else if(n==="auto"){var s=mee(e,e.getLabelModel());o=s.labelCategoryInterval,a=pt(s.labels,function(l){return l.tickValue})}else o=n,a=See(e,o,!0);return _ee(r,n,{ticks:a,tickCategoryInterval:o})}function mwe(e){var t=e.scale.getTicks(),r=Iw(e);return{labels:pt(t,function(n,i){return{level:n.level,formattedLabel:r(n,i),rawLabel:e.scale.getLabel(n),tickValue:n.value}})}}function bee(e,t){return l0(e)[t]||(l0(e)[t]=[])}function wee(e,t){for(var r=0;r<e.length;r++)if(e[r].key===t)return e[r].value}function _ee(e,t,r){return e.push({key:t,value:r}),r}function bwe(e){var t=l0(e).autoInterval;return t??(l0(e).autoInterval=e.calculateCategoryInterval())}function wwe(e){var t=_we(e),r=Iw(e),n=(t.axisRotate-t.labelRotate)/180*Math.PI,i=e.scale,a=i.getExtent(),o=i.count();if(a[1]-a[0]<1)return 0;var s=1;o>40&&(s=Math.max(1,Math.floor(o/40)));for(var l=a[0],u=e.dataToCoord(l+1)-e.dataToCoord(l),f=Math.abs(u*Math.cos(n)),c=Math.abs(u*Math.sin(n)),h=0,d=0;l<=a[1];l+=s){var v=0,p=0,g=DN(r({value:l}),t.font,"center","top");v=g.width*1.3,p=g.height*1.3,h=Math.max(h,v,7),d=Math.max(d,p,7)}var y=h/f,m=d/c;isNaN(y)&&(y=1/0),isNaN(m)&&(m=1/0);var b=Math.max(0,Math.floor(Math.min(y,m))),_=l0(e.model),x=e.getExtent(),T=_.lastAutoInterval,E=_.lastTickCount;return T!=null&&E!=null&&Math.abs(T-b)<=1&&Math.abs(E-o)<=1&&T>b&&_.axisExtent0===x[0]&&_.axisExtent1===x[1]?b=T:(_.lastTickCount=o,_.lastAutoInterval=b,_.axisExtent0=x[0],_.axisExtent1=x[1]),b}function _we(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function See(e,t,r){var n=Iw(e),i=e.scale,a=i.getExtent(),o=e.getLabelModel(),s=[],l=Math.max((t||0)+1,1),u=a[0],f=i.count();u!==0&&l>1&&f/l>2&&(u=Math.round(Math.ceil(u/l)*l));var c=yee(e),h=o.get("showMinLabel")||c,d=o.get("showMaxLabel")||c;h&&u!==a[0]&&p(a[0]);for(var v=u;v<=a[1];v+=l)p(v);d&&v-l!==a[1]&&p(a[1]);function p(g){var y={value:g};s.push(r?g:{formattedLabel:n(y),rawLabel:i.getLabel(y),tickValue:g})}return s}function Cee(e,t,r){var n=e.scale,i=Iw(e),a=[];return le(n.getTicks(),function(o){var s=n.getLabel(o),l=o.value;t(o.value,s)&&a.push(r?l:{formattedLabel:i(o),rawLabel:s,tickValue:l})}),a}var Yj=[0,1],Swe=function(){function e(t,r,n){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=r,this._extent=n||[0,0]}return e.prototype.contain=function(t){var r=this._extent,n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return t>=n&&t<=i},e.prototype.containData=function(t){return this.scale.contain(t)},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.getPixelPrecision=function(t){return Kde(t||this.scale.getExtent(),this._extent)},e.prototype.setExtent=function(t,r){var n=this._extent;n[0]=t,n[1]=r},e.prototype.dataToCoord=function(t,r){var n=this._extent,i=this.scale;return t=i.normalize(t),this.onBand&&i.type==="ordinal"&&(n=n.slice(),Kj(n,i.count())),yI(t,Yj,n,r)},e.prototype.coordToData=function(t,r){var n=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(n=n.slice(),Kj(n,i.count()));var a=yI(t,n,Yj,r);return this.scale.scale(a)},e.prototype.pointToData=function(t,r){},e.prototype.getTicksCoords=function(t){t=t||{};var r=t.tickModel||this.getTickModel(),n=pwe(this,r),i=n.ticks,a=pt(i,function(s){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(s):s),tickValue:s}},this),o=r.get("alignWithLabel");return Cwe(this,a,o,t.clamp),a},e.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var t=this.model.getModel("minorTick"),r=t.get("splitNumber");r>0&&r<100||(r=5);var n=this.scale.getMinorTicks(r),i=pt(n,function(a){return pt(a,function(o){return{coord:this.dataToCoord(o),tickValue:o}},this)},this);return i},e.prototype.getViewLabels=function(){return vwe(this).labels},e.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},e.prototype.getTickModel=function(){return this.model.getModel("axisTick")},e.prototype.getBandWidth=function(){var t=this._extent,r=this.scale.getExtent(),n=r[1]-r[0]+(this.onBand?1:0);n===0&&(n=1);var i=Math.abs(t[1]-t[0]);return Math.abs(i)/n},e.prototype.calculateCategoryInterval=function(){return wwe(this)},e}();function Kj(e,t){var r=e[1]-e[0],n=t,i=r/n/2;e[0]+=i,e[1]-=i}function Cwe(e,t,r,n){var i=t.length;if(!e.onBand||r||!i)return;var a=e.getExtent(),o,s;if(i===1)t[0].coord=a[0],o=t[1]={coord:a[0]};else{var l=t[i-1].tickValue-t[0].tickValue,u=(t[i-1].coord-t[0].coord)/l;le(t,function(d){d.coord-=u/2});var f=e.scale.getExtent();s=1+f[1]-t[i-1].tickValue,o={coord:t[i-1].coord+u*s},t.push(o)}var c=a[0]>a[1];h(t[0].coord,a[0])&&(n?t[0].coord=a[0]:t.shift()),n&&h(a[0],t[0].coord)&&t.unshift({coord:a[0]}),h(a[1],o.coord)&&(n?o.coord=a[1]:t.pop()),n&&h(o.coord,a[1])&&t.push({coord:a[1]});function h(d,v){return d=dn(d),v=dn(v),c?d>v:d<v}}const xwe=Swe;Pu.CMD;function xee(e,t,r,n,i,a,o,s){var l=i-e,u=a-t,f=r-e,c=n-t,h=Math.sqrt(f*f+c*c);f/=h,c/=h;var d=l*f+u*c,v=d/h;s&&(v=Math.min(Math.max(v,0),1)),v*=h;var p=o[0]=e+v*f,g=o[1]=t+v*c;return Math.sqrt((p-i)*(p-i)+(g-a)*(g-a))}var tu=new St,zr=new St,Pn=new St,ru=new St,Vo=new St,px=[],ui=new St;function Twe(e,t){if(t<=180&&t>0){t=t/180*Math.PI,tu.fromArray(e[0]),zr.fromArray(e[1]),Pn.fromArray(e[2]),St.sub(ru,tu,zr),St.sub(Vo,Pn,zr);var r=ru.len(),n=Vo.len();if(!(r<.001||n<.001)){ru.scale(1/r),Vo.scale(1/n);var i=ru.dot(Vo),a=Math.cos(t);if(a<i){var o=xee(zr.x,zr.y,Pn.x,Pn.y,tu.x,tu.y,px,!1);ui.fromArray(px),ui.scaleAndAdd(Vo,o/Math.tan(Math.PI-t));var s=Pn.x!==zr.x?(ui.x-zr.x)/(Pn.x-zr.x):(ui.y-zr.y)/(Pn.y-zr.y);if(isNaN(s))return;s<0?St.copy(ui,zr):s>1&&St.copy(ui,Pn),ui.toArray(e[1])}}}}function Owe(e,t,r){if(r<=180&&r>0){r=r/180*Math.PI,tu.fromArray(e[0]),zr.fromArray(e[1]),Pn.fromArray(e[2]),St.sub(ru,zr,tu),St.sub(Vo,Pn,zr);var n=ru.len(),i=Vo.len();if(!(n<.001||i<.001)){ru.scale(1/n),Vo.scale(1/i);var a=ru.dot(t),o=Math.cos(r);if(a<o){var s=xee(zr.x,zr.y,Pn.x,Pn.y,tu.x,tu.y,px,!1);ui.fromArray(px);var l=Math.PI/2,u=Math.acos(Vo.dot(t)),f=l+u-r;if(f>=l)St.copy(ui,Pn);else{ui.scaleAndAdd(Vo,s/Math.tan(Math.PI/2-f));var c=Pn.x!==zr.x?(ui.x-zr.x)/(Pn.x-zr.x):(ui.y-zr.y)/(Pn.y-zr.y);if(isNaN(c))return;c<0?St.copy(ui,zr):c>1&&St.copy(ui,Pn)}ui.toArray(e[1])}}}}function Xj(e,t,r,n){var i=r==="normal",a=i?e:e.ensureState(r);a.ignore=t;var o=n.get("smooth");o&&o===!0&&(o=.3),a.shape=a.shape||{},o>0&&(a.shape.smooth=o);var s=n.getModel("lineStyle").getLineStyle();i?e.useStyle(s):a.style=s}function Ewe(e,t){var r=t.smooth,n=t.points;if(n)if(e.moveTo(n[0][0],n[0][1]),r>0&&n.length>=3){var i=tI(n[0],n[1]),a=tI(n[1],n[2]);if(!i||!a){e.lineTo(n[1][0],n[1][1]),e.lineTo(n[2][0],n[2][1]);return}var o=Math.min(i,a)*r,s=UE([],n[1],n[0],o/i),l=UE([],n[1],n[2],o/a),u=UE([],s,l,.5);e.bezierCurveTo(s[0],s[1],s[0],s[1],u[0],u[1]),e.bezierCurveTo(l[0],l[1],l[0],l[1],n[2][0],n[2][1])}else for(var f=1;f<n.length;f++)e.lineTo(n[f][0],n[f][1])}function Rwe(e,t,r){var n=e.getTextGuideLine(),i=e.getTextContent();if(!i){n&&e.removeTextGuideLine();return}for(var a=t.normal,o=a.get("show"),s=i.ignore,l=0;l<QC.length;l++){var u=QC[l],f=t[u],c=u==="normal";if(f){var h=f.get("show"),d=c?s:Xt(i.states[u]&&i.states[u].ignore,s);if(d||!Xt(h,o)){var v=c?n:n&&n.states[u];v&&(v.ignore=!0);continue}n||(n=new iO,e.setTextGuideLine(n),!c&&(s||!o)&&Xj(n,!0,"normal",t.normal),e.stateProxy&&(n.stateProxy=e.stateProxy)),Xj(n,!1,u,f)}}if(n){lr(n.style,r),n.style.fill=null;var p=a.get("showAbove"),g=e.textGuideLineConfig=e.textGuideLineConfig||{};g.showAbove=p||!1,n.buildPath=Ewe}}function kwe(e,t){t=t||"labelLine";for(var r={normal:e.getModel(t)},n=0;n<Aa.length;n++){var i=Aa[n];r[i]=e.getModel([i,t])}return r}function Awe(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(!n.defaultAttr.ignore){var i=n.label,a=i.getComputedTransform(),o=i.getBoundingRect(),s=!a||a[1]<1e-5&&a[2]<1e-5,l=i.style.margin||0,u=o.clone();u.applyTransform(a),u.x-=l/2,u.y-=l/2,u.width+=l,u.height+=l;var f=s?new nx(o,a):null;t.push({label:i,labelLine:n.labelLine,rect:u,localRect:o,obb:f,priority:n.priority,defaultAttr:n.defaultAttr,layoutOption:n.computedLayoutOption,axisAligned:s,transform:a})}}return t}function Pwe(e,t,r,n,i,a){var o=e.length;if(o<2)return;e.sort(function(P,R){return P.rect[t]-R.rect[t]});for(var s=0,l,u=!1,f=0,c=0;c<o;c++){var h=e[c],d=h.rect;l=d[t]-s,l<0&&(d[t]-=l,h.label[t]-=l,u=!0);var v=Math.max(-l,0);f+=v,s=d[t]+d[r]}f>0&&a&&x(-f/o,0,o);var p=e[0],g=e[o-1],y,m;b(),y<0&&T(-y,.8),m<0&&T(m,.8),b(),_(y,m,1),_(m,y,-1),b(),y<0&&E(-y),m<0&&E(m);function b(){y=p.rect[t]-n,m=i-g.rect[t]-g.rect[r]}function _(P,R,M){if(P<0){var D=Math.min(R,-P);if(D>0){x(D*M,0,o);var N=D+P;N<0&&T(-N*M,1)}else T(-P*M,1)}}function x(P,R,M){P!==0&&(u=!0);for(var D=R;D<M;D++){var N=e[D],B=N.rect;B[t]+=P,N.label[t]+=P}}function T(P,R){for(var M=[],D=0,N=1;N<o;N++){var B=e[N-1].rect,K=Math.max(e[N].rect[t]-B[t]-B[r],0);M.push(K),D+=K}if(D){var Z=Math.min(Math.abs(P)/D,R);if(P>0)for(var N=0;N<o-1;N++){var ie=M[N]*Z;x(ie,0,N+1)}else for(var N=o-1;N>0;N--){var ie=M[N-1]*Z;x(-ie,N,o)}}}function E(P){var R=P<0?-1:1;P=Math.abs(P);for(var M=Math.ceil(P/(o-1)),D=0;D<o-1;D++)if(R>0?x(M,0,D+1):x(-M,o-D-1,o),P-=M,P<=0)return}return u}function Iwe(e,t,r,n){return Pwe(e,"y","height",t,r,n)}function Mwe(e){var t=[];e.sort(function(p,g){return g.priority-p.priority});var r=new or(0,0,0,0);function n(p){if(!p.ignore){var g=p.ensureState("emphasis");g.ignore==null&&(g.ignore=!1)}p.ignore=!0}for(var i=0;i<e.length;i++){var a=e[i],o=a.axisAligned,s=a.localRect,l=a.transform,u=a.label,f=a.labelLine;r.copy(a.rect),r.width-=.1,r.height-=.1,r.x+=.05,r.y+=.05;for(var c=a.obb,h=!1,d=0;d<t.length;d++){var v=t[d];if(r.intersect(v.rect)){if(o&&v.axisAligned){h=!0;break}if(v.obb||(v.obb=new nx(v.localRect,v.transform)),c||(c=new nx(s,l)),c.intersect(v.obb)){h=!0;break}}}h?(n(u),f&&n(f)):(u.attr("ignore",a.defaultAttr.ignore),f&&f.attr("ignore",a.defaultAttr.labelGuideIgnore),t.push(a))}}function qj(e,t,r){var n=wg.createCanvas(),i=t.getWidth(),a=t.getHeight(),o=n.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=i+"px",o.height=a+"px",n.setAttribute("data-zr-dom-id",e)),n.width=i*r,n.height=a*r,n}var Dwe=function(e){Ye(t,e);function t(r,n,i){var a=e.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var o;i=i||XC,typeof r=="string"?o=qj(r,n,i):dt(r)&&(o=r,r=o.id),a.id=r,a.dom=o;var s=o.style;return s&&(aZ(o),o.onselectstart=function(){return!1},s.padding="0",s.margin="0",s.borderWidth="0"),a.painter=n,a.dpr=i,a}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var r=this.dpr;this.domBack=qj("back-"+this.id,this.painter,r),this.ctxBack=this.domBack.getContext("2d"),r!==1&&this.ctxBack.scale(r,r)},t.prototype.createRepaintRects=function(r,n,i,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var o=[],s=this.maxRepaintRectCount,l=!1,u=new or(0,0,0,0);function f(m){if(!(!m.isFinite()||m.isZero()))if(o.length===0){var b=new or(0,0,0,0);b.copy(m),o.push(b)}else{for(var _=!1,x=1/0,T=0,E=0;E<o.length;++E){var P=o[E];if(P.intersect(m)){var R=new or(0,0,0,0);R.copy(P),R.union(m),o[E]=R,_=!0;break}else if(l){u.copy(m),u.union(P);var M=m.width*m.height,D=P.width*P.height,N=u.width*u.height,B=N-M-D;B<x&&(x=B,T=E)}}if(l&&(o[T].union(m),_=!0),!_){var b=new or(0,0,0,0);b.copy(m),o.push(b)}l||(l=o.length>=s)}}for(var c=this.__startIndex;c<this.__endIndex;++c){var h=r[c];if(h){var d=h.shouldBePainted(i,a,!0,!0),v=h.__isRendered&&(h.__dirty&qi||!d)?h.getPrevPaintRect():null;v&&f(v);var p=d&&(h.__dirty&qi||!h.__isRendered)?h.getPaintRect():null;p&&f(p)}}for(var c=this.__prevStartIndex;c<this.__prevEndIndex;++c){var h=n[c],d=h.shouldBePainted(i,a,!0,!0);if(h&&(!d||!h.__zr)&&h.__isRendered){var v=h.getPrevPaintRect();v&&f(v)}}var g;do{g=!1;for(var c=0;c<o.length;){if(o[c].isZero()){o.splice(c,1);continue}for(var y=c+1;y<o.length;)o[c].intersect(o[y])?(g=!0,o[c].union(o[y]),o.splice(y,1)):y++;c++}}while(g);return this._paintRects=o,o},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(r,n){var i=this.dpr,a=this.dom,o=a.style,s=this.domBack;o&&(o.width=r+"px",o.height=n+"px"),a.width=r*i,a.height=n*i,s&&(s.width=r*i,s.height=n*i,i!==1&&this.ctxBack.scale(i,i))},t.prototype.clear=function(r,n,i){var a=this.dom,o=this.ctx,s=a.width,l=a.height;n=n||this.clearColor;var u=this.motionBlur&&!r,f=this.lastFrameAlpha,c=this.dpr,h=this;u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,s/c,l/c));var d=this.domBack;function v(p,g,y,m){if(o.clearRect(p,g,y,m),n&&n!=="transparent"){var b=void 0;if(XT(n)){var _=n.global||n.__width===y&&n.__height===m;b=_&&n.__canvasGradient||HI(o,n,{x:0,y:0,width:y,height:m}),n.__canvasGradient=b,n.__width=y,n.__height=m}else ghe(n)&&(n.scaleX=n.scaleX||c,n.scaleY=n.scaleY||c,b=BI(o,n,{dirty:function(){h.setUnpainted(),h.__painter.refresh()}}));o.save(),o.fillStyle=b||n,o.fillRect(p,g,y,m),o.restore()}u&&(o.save(),o.globalAlpha=f,o.drawImage(d,p,g,y,m),o.restore())}!i||u?v(0,0,s,l):i.length&&le(i,function(p){v(p.x*c,p.y*c,p.width*c,p.height*c)})},t}(ts);const qR=Dwe;var Zj=1e5,mf=314159,vS=.01,$we=.001;function Nwe(e){return e?e.__builtin__?!0:!(typeof e.resize!="function"||typeof e.refresh!="function"):!1}function Lwe(e,t){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var Fwe=function(){function e(t,r,n,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=n=Le({},n||{}),this.dpr=n.devicePixelRatio||XC,this._singleCanvas=a,this.root=t;var o=t.style;o&&(aZ(t),t.innerHTML=""),this.storage=r;var s=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(a){var f=t,c=f.width,h=f.height;n.width!=null&&(c=n.width),n.height!=null&&(h=n.height),this.dpr=n.devicePixelRatio||1,f.width=c*this.dpr,f.height=h*this.dpr,this._width=c,this._height=h;var d=new qR(f,this,this.dpr);d.__builtin__=!0,d.initContext(),l[mf]=d,d.zlevel=mf,s.push(mf),this._domRoot=t}else{this._width=aS(t,0,n),this._height=aS(t,1,n);var u=this._domRoot=Lwe(this._width,this._height);t.appendChild(u)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.refresh=function(t){var r=this.storage.getDisplayList(!0),n=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(r,n,t,this._redrawId);for(var a=0;a<i.length;a++){var o=i[a],s=this._layers[o];if(!s.__builtin__&&s.refresh){var l=a===0?this._backgroundColor:null;s.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=r.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(t){var r=t.length,n=this._hoverlayer;if(n&&n.clear(),!!r){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,o=0;o<r;o++){var s=t[o];s.__inHover&&(n||(n=this._hoverlayer=this.getLayer(Zj)),a||(a=n.ctx,a.save()),Uf(a,s,i,o===r-1))}a&&a.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(Zj)},e.prototype.paintOne=function(t,r){IQ(t,r)},e.prototype._paintList=function(t,r,n,i){if(this._redrawId===i){n=n||!1,this._updateLayerStatus(t);var a=this._doPaintList(t,r,n),o=a.finished,s=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),s&&this._paintHoverList(t),o)this.eachLayer(function(u){u.afterBrush&&u.afterBrush()});else{var l=this;oI(function(){l._paintList(t,r,n,i)})}}},e.prototype._compositeManually=function(){var t=this.getLayer(mf).ctx,r=this._domRoot.width,n=this._domRoot.height;t.clearRect(0,0,r,n),this.eachBuiltinLayer(function(i){i.virtual&&t.drawImage(i.dom,0,0,r,n)})},e.prototype._doPaintList=function(t,r,n){for(var i=this,a=[],o=this._opts.useDirtyRect,s=0;s<this._zlevelList.length;s++){var l=this._zlevelList[s],u=this._layers[l];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||n)&&a.push(u)}for(var f=!0,c=!1,h=function(p){var g=a[p],y=g.ctx,m=o&&g.createRepaintRects(t,r,d._width,d._height),b=n?g.__startIndex:g.__drawIndex,_=!n&&g.incremental&&Date.now,x=_&&Date.now(),T=g.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(g.__startIndex===g.__endIndex)g.clear(!1,T,m);else if(b===g.__startIndex){var E=t[b];(!E.incremental||!E.notClear||n)&&g.clear(!1,T,m)}b===-1&&(console.error("For some unknown reason. drawIndex is -1"),b=g.__startIndex);var P,R=function(B){var K={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(P=b;P<g.__endIndex;P++){var Z=t[P];if(Z.__inHover&&(c=!0),i._doPaintEl(Z,g,o,B,K,P===g.__endIndex-1),_){var ie=Date.now()-x;if(ie>15)break}}K.prevElClipPaths&&y.restore()};if(m)if(m.length===0)P=g.__endIndex;else for(var M=d.dpr,D=0;D<m.length;++D){var N=m[D];y.save(),y.beginPath(),y.rect(N.x*M,N.y*M,N.width*M,N.height*M),y.clip(),R(N),y.restore()}else y.save(),R(),y.restore();g.__drawIndex=P,g.__drawIndex<g.__endIndex&&(f=!1)},d=this,v=0;v<a.length;v++)h(v);return Bt.wxa&&le(this._layers,function(p){p&&p.ctx&&p.ctx.draw&&p.ctx.draw()}),{finished:f,needsRefreshHover:c}},e.prototype._doPaintEl=function(t,r,n,i,a,o){var s=r.ctx;if(n){var l=t.getPaintRect();(!i||l&&l.intersect(i))&&(Uf(s,t,a,o),t.setPrevPaintRect(l))}else Uf(s,t,a,o)},e.prototype.getLayer=function(t,r){this._singleCanvas&&!this._needsManuallyCompositing&&(t=mf);var n=this._layers[t];return n||(n=new qR("zr_"+t,this,this.dpr),n.zlevel=t,n.__builtin__=!0,this._layerConfig[t]?ar(n,this._layerConfig[t],!0):this._layerConfig[t-vS]&&ar(n,this._layerConfig[t-vS],!0),r&&(n.virtual=r),this.insertLayer(t,n),n.initContext()),n},e.prototype.insertLayer=function(t,r){var n=this._layers,i=this._zlevelList,a=i.length,o=this._domRoot,s=null,l=-1;if(!n[t]&&Nwe(r)){if(a>0&&t>i[0]){for(l=0;l<a-1&&!(i[l]<t&&i[l+1]>t);l++);s=n[i[l]]}if(i.splice(l+1,0,t),n[t]=r,!r.virtual)if(s){var u=s.dom;u.nextSibling?o.insertBefore(r.dom,u.nextSibling):o.appendChild(r.dom)}else o.firstChild?o.insertBefore(r.dom,o.firstChild):o.appendChild(r.dom);r.__painter=this}},e.prototype.eachLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i];t.call(r,this._layers[a],a)}},e.prototype.eachBuiltinLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__&&t.call(r,o,a)}},e.prototype.eachOtherLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__||t.call(r,o,a)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(c,h){c.__dirty=c.__used=!1});function r(c){a&&(a.__endIndex!==c&&(a.__dirty=!0),a.__endIndex=c)}if(this._singleCanvas)for(var n=1;n<t.length;n++){var i=t[n];if(i.zlevel!==t[n-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var a=null,o=0,s,l;for(l=0;l<t.length;l++){var i=t[l],u=i.zlevel,f=void 0;s!==u&&(s=u,o=0),i.incremental?(f=this.getLayer(u+$we,this._needsManuallyCompositing),f.incremental=!0,o=1):f=this.getLayer(u+(o>0?vS:0),this._needsManuallyCompositing),f.__builtin__||ON("ZLevel "+u+" has been used by unkown layer "+f.id),f!==a&&(f.__used=!0,f.__startIndex!==l&&(f.__dirty=!0),f.__startIndex=l,f.incremental?f.__drawIndex=-1:f.__drawIndex=l,r(l),a=f),i.__dirty&qi&&!i.__inHover&&(f.__dirty=!0,f.incremental&&f.__drawIndex<0&&(f.__drawIndex=l))}r(l),this.eachBuiltinLayer(function(c,h){!c.__used&&c.getElementCount()>0&&(c.__dirty=!0,c.__startIndex=c.__endIndex=c.__drawIndex=0),c.__dirty&&c.__drawIndex<0&&(c.__drawIndex=c.__startIndex)})},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(t){t.clear()},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t,le(this._layers,function(r){r.setUnpainted()})},e.prototype.configLayer=function(t,r){if(r){var n=this._layerConfig;n[t]?ar(n[t],r,!0):n[t]=r;for(var i=0;i<this._zlevelList.length;i++){var a=this._zlevelList[i];if(a===t||a===t+vS){var o=this._layers[a];ar(o,n[t],!0)}}}},e.prototype.delLayer=function(t){var r=this._layers,n=this._zlevelList,i=r[t];i&&(i.dom.parentNode.removeChild(i.dom),delete r[t],n.splice(yr(n,t),1))},e.prototype.resize=function(t,r){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var i=this._opts,a=this.root;if(t!=null&&(i.width=t),r!=null&&(i.height=r),t=aS(a,0,i),r=aS(a,1,i),n.style.display="",this._width!==t||r!==this._height){n.style.width=t+"px",n.style.height=r+"px";for(var o in this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(t,r);this.refresh(!0)}this._width=t,this._height=r}else{if(t==null||r==null)return;this._width=t,this._height=r,this.getLayer(mf).resize(t,r)}return this},e.prototype.clearLayer=function(t){var r=this._layers[t];r&&r.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[mf].dom;var r=new qR("image",this,t.pixelRatio||this.dpr);r.initContext(),r.clear(!1,t.backgroundColor||this._backgroundColor);var n=r.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var i=r.dom.width,a=r.dom.height;this.eachLayer(function(c){c.__builtin__?n.drawImage(c.dom,0,0,i,a):c.renderToCanvas&&(n.save(),c.renderToCanvas(n),n.restore())})}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},s=this.storage.getDisplayList(!0),l=0,u=s.length;l<u;l++){var f=s[l];Uf(n,f,o,l===u-1)}return r.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();const Hwe=Fwe;function Bwe(e){e.registerPainter("canvas",Hwe)}var Vwe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r){return _L(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(r){var n=new Kn,i=sv("line",0,r.itemHeight/2,r.itemWidth,0,r.lineStyle.stroke,!1);n.add(i),i.setStyle(r.lineStyle);var a=this.getData().getVisual("symbol"),o=this.getData().getVisual("symbolRotate"),s=a==="none"?"circle":a,l=r.itemHeight*.8,u=sv(s,(r.itemWidth-l)/2,(r.itemHeight-l)/2,l,l,r.itemStyle.fill);n.add(u),u.setStyle(r.itemStyle);var f=r.iconRotate==="inherit"?o:r.iconRotate||0;return u.rotation=f*Math.PI/180,u.setOrigin([r.itemWidth/2,r.itemHeight/2]),s.indexOf("empty")>-1&&(u.style.stroke=u.style.fill,u.style.fill="#fff",u.style.lineWidth=2),n},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(Mu);const jwe=Vwe;function EL(e,t){var r=e.mapDimensionsAll("defaultedLabel"),n=r.length;if(n===1){var i=ov(e,t,r[0]);return i!=null?i+"":null}else if(n){for(var a=[],o=0;o<r.length;o++)a.push(ov(e,t,r[o]));return a.join(" ")}}function Tee(e,t){var r=e.mapDimensionsAll("defaultedLabel");if(!et(t))return t+"";for(var n=[],i=0;i<r.length;i++){var a=e.getDimensionIndex(r[i]);a>=0&&n.push(t[a])}return n.join(" ")}var Wwe=function(e){Ye(t,e);function t(r,n,i,a){var o=e.call(this)||this;return o.updateData(r,n,i,a),o}return t.prototype._createSymbol=function(r,n,i,a,o){this.removeAll();var s=sv(r,-1,-1,2,2,null,o);s.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),s.drift=Uwe,this._symbolType=r,this.add(s)},t.prototype.stopSymbolAnimation=function(r){this.childAt(0).stopAnimation(null,r)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){ex(this.childAt(0))},t.prototype.downplay=function(){tx(this.childAt(0))},t.prototype.setZ=function(r,n){var i=this.childAt(0);i.zlevel=r,i.z=n},t.prototype.setDraggable=function(r,n){var i=this.childAt(0);i.draggable=r,i.cursor=!n&&r?"move":i.cursor},t.prototype.updateData=function(r,n,i,a){this.silent=!1;var o=r.getItemVisual(n,"symbol")||"circle",s=r.hostModel,l=t.getSymbolSize(r,n),u=o!==this._symbolType,f=a&&a.disableAnimation;if(u){var c=r.getItemVisual(n,"symbolKeepAspect");this._createSymbol(o,r,n,l,c)}else{var h=this.childAt(0);h.silent=!1;var d={scaleX:l[0]/2,scaleY:l[1]/2};f?h.attr(d):mi(h,d,s,n),KN(h)}if(this._updateCommon(r,n,l,i,a),u){var h=this.childAt(0);if(!f){var d={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:h.style.opacity}};h.scaleX=h.scaleY=0,h.style.opacity=0,ka(h,d,s,n)}}f&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(r,n,i,a,o){var s=this.childAt(0),l=r.hostModel,u,f,c,h,d,v,p,g,y;if(a&&(u=a.emphasisItemStyle,f=a.blurItemStyle,c=a.selectItemStyle,h=a.focus,d=a.blurScope,p=a.labelStatesModels,g=a.hoverScale,y=a.cursorStyle,v=a.emphasisDisabled),!a||r.hasItemOption){var m=a&&a.itemModel?a.itemModel:r.getItemModel(n),b=m.getModel("emphasis");u=b.getModel("itemStyle").getItemStyle(),c=m.getModel(["select","itemStyle"]).getItemStyle(),f=m.getModel(["blur","itemStyle"]).getItemStyle(),h=b.get("focus"),d=b.get("blurScope"),v=b.get("disabled"),p=Aw(m),g=b.getShallow("scale"),y=m.getShallow("cursor")}var _=r.getItemVisual(n,"symbolRotate");s.attr("rotation",(_||0)*Math.PI/180||0);var x=RQ(r.getItemVisual(n,"symbolOffset"),i);x&&(s.x=x[0],s.y=x[1]),y&&s.attr("cursor",y);var T=r.getItemVisual(n,"style"),E=T.fill;if(s instanceof Zc){var P=s.style;s.useStyle(Le({image:P.image,x:P.x,y:P.y,width:P.width,height:P.height},T))}else s.__isEmptyBrush?s.useStyle(Le({},T)):s.useStyle(T),s.style.decal=null,s.setColor(E,o&&o.symbolInnerColor),s.style.strokeNoScale=!0;var R=r.getItemVisual(n,"liftZ"),M=this._z2;R!=null?M==null&&(this._z2=s.z2,s.z2+=R):M!=null&&(s.z2=M,this._z2=null);var D=o&&o.useNameLabel;kw(s,p,{labelFetcher:l,labelDataIndex:n,defaultText:N,inheritColor:E,defaultOpacity:T.opacity});function N(Z){return D?r.getName(Z):EL(r,Z)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var B=s.ensureState("emphasis");B.style=u,s.ensureState("select").style=c,s.ensureState("blur").style=f;var K=g==null||g===!0?Math.max(1.1,3/this._sizeY):isFinite(g)&&g>0?+g:1;B.scaleX=this._sizeX*K,B.scaleY=this._sizeY*K,this.setSymbolScale(1),Qm(this,h,d,v)},t.prototype.setSymbolScale=function(r){this.scaleX=this.scaleY=r},t.prototype.fadeOut=function(r,n,i){var a=this.childAt(0),o=ur(this).dataIndex,s=i&&i.animation;if(this.silent=a.silent=!0,i&&i.fadeLabel){var l=a.getTextContent();l&&ix(l,{style:{opacity:0}},n,{dataIndex:o,removeOpt:s,cb:function(){a.removeTextContent()}})}else a.removeTextContent();ix(a,{style:{opacity:0},scaleX:0,scaleY:0},n,{dataIndex:o,cb:r,removeOpt:s})},t.getSymbolSize=function(r,n){return d0e(r.getItemVisual(n,"symbolSize"))},t}(Kn);function Uwe(e,t){this.parent.drift(e,t)}const RL=Wwe;function ZR(e,t,r,n){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(n.isIgnore&&n.isIgnore(r))&&!(n.clipShape&&!n.clipShape.contain(t[0],t[1]))&&e.getItemVisual(r,"symbol")!=="none"}function Jj(e){return e!=null&&!dt(e)&&(e={isIgnore:e}),e||{}}function Qj(e){var t=e.hostModel,r=t.getModel("emphasis");return{emphasisItemStyle:r.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:r.get("focus"),blurScope:r.get("blurScope"),emphasisDisabled:r.get("disabled"),hoverScale:r.get("scale"),labelStatesModels:Aw(t),cursorStyle:t.get("cursor")}}var zwe=function(){function e(t){this.group=new Kn,this._SymbolCtor=t||RL}return e.prototype.updateData=function(t,r){this._progressiveEls=null,r=Jj(r);var n=this.group,i=t.hostModel,a=this._data,o=this._SymbolCtor,s=r.disableAnimation,l=Qj(t),u={disableAnimation:s},f=r.getSymbolPoint||function(c){return t.getItemLayout(c)};a||n.removeAll(),t.diff(a).add(function(c){var h=f(c);if(ZR(t,h,c,r)){var d=new o(t,c,l,u);d.setPosition(h),t.setItemGraphicEl(c,d),n.add(d)}}).update(function(c,h){var d=a.getItemGraphicEl(h),v=f(c);if(!ZR(t,v,c,r)){n.remove(d);return}var p=t.getItemVisual(c,"symbol")||"circle",g=d&&d.getSymbolType&&d.getSymbolType();if(!d||g&&g!==p)n.remove(d),d=new o(t,c,l,u),d.setPosition(v);else{d.updateData(t,c,l,u);var y={x:v[0],y:v[1]};s?d.attr(y):mi(d,y,i)}n.add(d),t.setItemGraphicEl(c,d)}).remove(function(c){var h=a.getItemGraphicEl(c);h&&h.fadeOut(function(){n.remove(h)},i)}).execute(),this._getSymbolPoint=f,this._data=t},e.prototype.updateLayout=function(){var t=this,r=this._data;r&&r.eachItemGraphicEl(function(n,i){var a=t._getSymbolPoint(i);n.setPosition(a),n.markRedraw()})},e.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=Qj(t),this._data=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(t,r,n){this._progressiveEls=[],n=Jj(n);function i(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var a=t.start;a<t.end;a++){var o=r.getItemLayout(a);if(ZR(r,o,a,n)){var s=new this._SymbolCtor(r,a,this._seriesScope);s.traverse(i),s.setPosition(o),this.group.add(s),r.setItemGraphicEl(a,s),this._progressiveEls.push(s)}}},e.prototype.eachRendered=function(t){aO(this._progressiveEls||this.group,t)},e.prototype.remove=function(t){var r=this.group,n=this._data;n&&t?n.eachItemGraphicEl(function(i){i.fadeOut(function(){r.remove(i)},n.hostModel)}):r.removeAll()},e}();const Gwe=zwe;function Oee(e,t,r){var n=e.getBaseAxis(),i=e.getOtherAxis(n),a=Ywe(i,r),o=n.dim,s=i.dim,l=t.mapDimension(s),u=t.mapDimension(o),f=s==="x"||s==="radius"?1:0,c=pt(e.dimensions,function(v){return t.mapDimension(v)}),h=!1,d=t.getCalculationInfo("stackResultDimension");return lv(t,c[0])&&(h=!0,c[0]=d),lv(t,c[1])&&(h=!0,c[1]=d),{dataDimsForPoint:c,valueStart:a,valueAxisDim:s,baseAxisDim:o,stacked:!!h,valueDim:l,baseDim:u,baseDataOffset:f,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function Ywe(e,t){var r=0,n=e.scale.getExtent();return t==="start"?r=n[0]:t==="end"?r=n[1]:_r(t)&&!isNaN(t)?r=t:n[0]>0?r=n[0]:n[1]<0&&(r=n[1]),r}function Eee(e,t,r,n){var i=NaN;e.stacked&&(i=r.get(r.getCalculationInfo("stackedOverDimension"),n)),isNaN(i)&&(i=e.valueStart);var a=e.baseDataOffset,o=[];return o[a]=r.get(e.baseDim,n),o[1-a]=i,t.dataToPoint(o)}function Kwe(e,t){var r=[];return t.diff(e).add(function(n){r.push({cmd:"+",idx:n})}).update(function(n,i){r.push({cmd:"=",idx:i,idx1:n})}).remove(function(n){r.push({cmd:"-",idx:n})}).execute(),r}function Xwe(e,t,r,n,i,a,o,s){for(var l=Kwe(e,t),u=[],f=[],c=[],h=[],d=[],v=[],p=[],g=Oee(i,t,o),y=e.getLayout("points")||[],m=t.getLayout("points")||[],b=0;b<l.length;b++){var _=l[b],x=!0,T=void 0,E=void 0;switch(_.cmd){case"=":T=_.idx*2,E=_.idx1*2;var P=y[T],R=y[T+1],M=m[E],D=m[E+1];(isNaN(P)||isNaN(R))&&(P=M,R=D),u.push(P,R),f.push(M,D),c.push(r[T],r[T+1]),h.push(n[E],n[E+1]),p.push(t.getRawIndex(_.idx1));break;case"+":var N=_.idx,B=g.dataDimsForPoint,K=i.dataToPoint([t.get(B[0],N),t.get(B[1],N)]);E=N*2,u.push(K[0],K[1]),f.push(m[E],m[E+1]);var Z=Eee(g,i,t,N);c.push(Z[0],Z[1]),h.push(n[E],n[E+1]),p.push(t.getRawIndex(N));break;case"-":x=!1}x&&(d.push(_),v.push(v.length))}v.sort(function(L,V){return p[L]-p[V]});for(var ie=u.length,me=Es(ie),k=Es(ie),w=Es(ie),C=Es(ie),O=[],b=0;b<v.length;b++){var S=v[b],A=b*2,I=S*2;me[A]=u[I],me[A+1]=u[I+1],k[A]=f[I],k[A+1]=f[I+1],w[A]=c[I],w[A+1]=c[I+1],C[A]=h[I],C[A+1]=h[I+1],O[b]=d[S]}return{current:me,next:k,stackedOnCurrent:w,stackedOnNext:C,status:O}}var Ml=Math.min,Dl=Math.max;function _c(e,t){return isNaN(e)||isNaN(t)}function YI(e,t,r,n,i,a,o,s,l){for(var u,f,c,h,d,v,p=r,g=0;g<n;g++){var y=t[p*2],m=t[p*2+1];if(p>=i||p<0)break;if(_c(y,m)){if(l){p+=a;continue}break}if(p===r)e[a>0?"moveTo":"lineTo"](y,m),c=y,h=m;else{var b=y-u,_=m-f;if(b*b+_*_<.5){p+=a;continue}if(o>0){for(var x=p+a,T=t[x*2],E=t[x*2+1];T===y&&E===m&&g<n;)g++,x+=a,p+=a,T=t[x*2],E=t[x*2+1],y=t[p*2],m=t[p*2+1],b=y-u,_=m-f;var P=g+1;if(l)for(;_c(T,E)&&P<n;)P++,x+=a,T=t[x*2],E=t[x*2+1];var R=.5,M=0,D=0,N=void 0,B=void 0;if(P>=n||_c(T,E))d=y,v=m;else{M=T-u,D=E-f;var K=y-u,Z=T-y,ie=m-f,me=E-m,k=void 0,w=void 0;if(s==="x"){k=Math.abs(K),w=Math.abs(Z);var C=M>0?1:-1;d=y-C*k*o,v=m,N=y+C*w*o,B=m}else if(s==="y"){k=Math.abs(ie),w=Math.abs(me);var O=D>0?1:-1;d=y,v=m-O*k*o,N=y,B=m+O*w*o}else k=Math.sqrt(K*K+ie*ie),w=Math.sqrt(Z*Z+me*me),R=w/(w+k),d=y-M*o*(1-R),v=m-D*o*(1-R),N=y+M*o*R,B=m+D*o*R,N=Ml(N,Dl(T,y)),B=Ml(B,Dl(E,m)),N=Dl(N,Ml(T,y)),B=Dl(B,Ml(E,m)),M=N-y,D=B-m,d=y-M*k/w,v=m-D*k/w,d=Ml(d,Dl(u,y)),v=Ml(v,Dl(f,m)),d=Dl(d,Ml(u,y)),v=Dl(v,Ml(f,m)),M=y-d,D=m-v,N=y+M*w/k,B=m+D*w/k}e.bezierCurveTo(c,h,d,v,y,m),c=N,h=B}else e.lineTo(y,m)}u=y,f=m,p+=a}return g}var Ree=function(){function e(){this.smooth=0,this.smoothConstraint=!0}return e}(),qwe=function(e){Ye(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polyline",n}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Ree},t.prototype.buildPath=function(r,n){var i=n.points,a=0,o=i.length/2;if(n.connectNulls){for(;o>0&&_c(i[o*2-2],i[o*2-1]);o--);for(;a<o&&_c(i[a*2],i[a*2+1]);a++);}for(;a<o;)a+=YI(r,i,a,o,o,1,n.smooth,n.smoothMonotone,n.connectNulls)+1},t.prototype.getPointOn=function(r,n){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,a=i.data,o=Pu.CMD,s,l,u=n==="x",f=[],c=0;c<a.length;){var h=a[c++],d=void 0,v=void 0,p=void 0,g=void 0,y=void 0,m=void 0,b=void 0;switch(h){case o.M:s=a[c++],l=a[c++];break;case o.L:if(d=a[c++],v=a[c++],b=u?(r-s)/(d-s):(r-l)/(v-l),b<=1&&b>=0){var _=u?(v-l)*b+l:(d-s)*b+s;return u?[r,_]:[_,r]}s=d,l=v;break;case o.C:d=a[c++],v=a[c++],p=a[c++],g=a[c++],y=a[c++],m=a[c++];var x=u?zC(s,d,p,y,r,f):zC(l,v,g,m,r,f);if(x>0)for(var T=0;T<x;T++){var E=f[T];if(E<=1&&E>=0){var _=u?mn(l,v,g,m,E):mn(s,d,p,y,E);return u?[r,_]:[_,r]}}s=y,l=m;break}}},t}(cr),Zwe=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Ree),Jwe=function(e){Ye(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polygon",n}return t.prototype.getDefaultShape=function(){return new Zwe},t.prototype.buildPath=function(r,n){var i=n.points,a=n.stackedOnPoints,o=0,s=i.length/2,l=n.smoothMonotone;if(n.connectNulls){for(;s>0&&_c(i[s*2-2],i[s*2-1]);s--);for(;o<s&&_c(i[o*2],i[o*2+1]);o++);}for(;o<s;){var u=YI(r,i,o,s,s,1,n.smooth,l,n.connectNulls);YI(r,a,o+u-1,u,s,-1,n.stackedOnSmooth,l,n.connectNulls),o+=u+1,r.closePath()}},t}(cr);function kee(e,t,r,n,i){var a=e.getArea(),o=a.x,s=a.y,l=a.width,u=a.height,f=r.get(["lineStyle","width"])||2;o-=f/2,s-=f/2,l+=f,u+=f,o=Math.floor(o),l=Math.round(l);var c=new _n({shape:{x:o,y:s,width:l,height:u}});if(t){var h=e.getBaseAxis(),d=h.isHorizontal(),v=h.inverse;d?(v&&(c.shape.x+=l),c.shape.width=0):(v||(c.shape.y+=u),c.shape.height=0);var p=Nt(i)?function(g){i(g,c)}:null;ka(c,{shape:{width:l,height:u,x:o,y:s}},r,null,n,p)}return c}function Aee(e,t,r){var n=e.getArea(),i=dn(n.r0,1),a=dn(n.r,1),o=new Jc({shape:{cx:dn(e.cx,1),cy:dn(e.cy,1),r0:i,r:a,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});if(t){var s=e.getBaseAxis().dim==="angle";s?o.shape.endAngle=n.startAngle:o.shape.r=i,ka(o,{shape:{endAngle:n.endAngle,r:a}},r)}return o}function Qwe(e,t,r,n,i){if(e){if(e.type==="polar")return Aee(e,t,r);if(e.type==="cartesian2d")return kee(e,t,r,n,i)}else return null;return null}function kL(e,t){return e.type===t}function eW(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return;return!0}}function tW(e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,a=0;a<e.length;){var o=e[a++],s=e[a++];isNaN(o)||(t=Math.min(o,t),n=Math.max(o,n)),isNaN(s)||(r=Math.min(s,r),i=Math.max(s,i))}return[[t,r],[n,i]]}function rW(e,t){var r=tW(e),n=r[0],i=r[1],a=tW(t),o=a[0],s=a[1];return Math.max(Math.abs(n[0]-o[0]),Math.abs(n[1]-o[1]),Math.abs(i[0]-s[0]),Math.abs(i[1]-s[1]))}function nW(e){return _r(e)?e:e?.5:0}function e_e(e,t,r){if(!r.valueDim)return[];for(var n=t.count(),i=Es(n*2),a=0;a<n;a++){var o=Eee(r,e,t,a);i[a*2]=o[0],i[a*2+1]=o[1]}return i}function $l(e,t,r,n){var i=t.getBaseAxis(),a=i.dim==="x"||i.dim==="radius"?0:1,o=[],s=0,l=[],u=[],f=[],c=[];if(n){for(s=0;s<e.length;s+=2)!isNaN(e[s])&&!isNaN(e[s+1])&&c.push(e[s],e[s+1]);e=c}for(s=0;s<e.length-2;s+=2)switch(f[0]=e[s+2],f[1]=e[s+3],u[0]=e[s],u[1]=e[s+1],o.push(u[0],u[1]),r){case"end":l[a]=f[a],l[1-a]=u[1-a],o.push(l[0],l[1]);break;case"middle":var h=(u[a]+f[a])/2,d=[];l[a]=d[a]=h,l[1-a]=u[1-a],d[1-a]=f[1-a],o.push(l[0],l[1]),o.push(d[0],d[1]);break;default:l[a]=u[a],l[1-a]=f[1-a],o.push(l[0],l[1])}return o.push(e[s++],e[s++]),o}function t_e(e,t){var r=[],n=e.length,i,a;function o(f,c,h){var d=f.coord,v=(h-d)/(c.coord-d),p=pde(v,[f.color,c.color]);return{coord:h,color:p}}for(var s=0;s<n;s++){var l=e[s],u=l.coord;if(u<0)i=l;else if(u>t){a?r.push(o(a,l,t)):i&&r.push(o(i,l,0),o(i,l,t));break}else i&&(r.push(o(i,l,0)),i=null),r.push(l),a=l}return r}function r_e(e,t,r){var n=e.getVisual("visualMeta");if(!(!n||!n.length||!e.count())&&t.type==="cartesian2d"){for(var i,a,o=n.length-1;o>=0;o--){var s=e.getDimensionInfo(n[o].dimension);if(i=s&&s.coordDim,i==="x"||i==="y"){a=n[o];break}}if(a){var l=t.getAxis(i),u=pt(a.stops,function(b){return{coord:l.toGlobalCoord(l.dataToCoord(b.value)),color:b.color}}),f=u.length,c=a.outerColors.slice();f&&u[0].coord>u[f-1].coord&&(u.reverse(),c.reverse());var h=t_e(u,i==="x"?r.getWidth():r.getHeight()),d=h.length;if(!d&&f)return u[0].coord<0?c[1]?c[1]:u[f-1].color:c[0]?c[0]:u[0].color;var v=10,p=h[0].coord-v,g=h[d-1].coord+v,y=g-p;if(y<.001)return"transparent";le(h,function(b){b.offset=(b.coord-p)/y}),h.push({offset:d?h[d-1].offset:.5,color:c[1]||"transparent"}),h.unshift({offset:d?h[0].offset:.5,color:c[0]||"transparent"});var m=new TJ(0,0,0,0,h,!0);return m[i]=p,m[i+"2"]=g,m}}}function n_e(e,t,r){var n=e.get("showAllSymbol"),i=n==="auto";if(!(n&&!i)){var a=r.getAxesByScale("ordinal")[0];if(a&&!(i&&i_e(a,t))){var o=t.mapDimension(a.dim),s={};return le(a.getViewLabels(),function(l){var u=a.scale.getRawOrdinalNumber(l.tickValue);s[u]=1}),function(l){return!s.hasOwnProperty(t.get(o,l))}}}}function i_e(e,t){var r=e.getExtent(),n=Math.abs(r[1]-r[0])/e.scale.count();isNaN(n)&&(n=0);for(var i=t.count(),a=Math.max(1,Math.round(i/5)),o=0;o<i;o+=a)if(RL.getSymbolSize(t,o)[e.isHorizontal()?1:0]*1.5>n)return!1;return!0}function a_e(e,t){return isNaN(e)||isNaN(t)}function o_e(e){for(var t=e.length/2;t>0&&a_e(e[t*2-2],e[t*2-1]);t--);return t-1}function iW(e,t){return[e[t*2],e[t*2+1]]}function s_e(e,t,r){for(var n=e.length/2,i=r==="x"?0:1,a,o,s=0,l=-1,u=0;u<n;u++)if(o=e[u*2+i],!(isNaN(o)||isNaN(e[u*2+1-i]))){if(u===0){a=o;continue}if(a<=t&&o>=t||a>=t&&o<=t){l=u;break}s=u,a=o}return{range:[s,l],t:(t-a)/(o-a)}}function Pee(e){if(e.get(["endLabel","show"]))return!0;for(var t=0;t<Aa.length;t++)if(e.get([Aa[t],"endLabel","show"]))return!0;return!1}function JR(e,t,r,n){if(kL(t,"cartesian2d")){var i=n.getModel("endLabel"),a=i.get("valueAnimation"),o=n.getData(),s={lastFrameIndex:0},l=Pee(n)?function(d,v){e._endLabelOnDuring(d,v,o,s,a,i,t)}:null,u=t.getBaseAxis().isHorizontal(),f=kee(t,r,n,function(){var d=e._endLabel;d&&r&&s.originalX!=null&&d.attr({x:s.originalX,y:s.originalY})},l);if(!n.get("clip",!0)){var c=f.shape,h=Math.max(c.width,c.height);u?(c.y-=h,c.height+=h*2):(c.x-=h,c.width+=h*2)}return l&&l(1,f),f}else return Aee(t,r,n)}function l_e(e,t){var r=t.getBaseAxis(),n=r.isHorizontal(),i=r.inverse,a=n?i?"right":"left":"center",o=n?"middle":i?"top":"bottom";return{normal:{align:e.get("align")||a,verticalAlign:e.get("verticalAlign")||o}}}var u_e=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(){var r=new Kn,n=new Gwe;this.group.add(n.group),this._symbolDraw=n,this._lineGroup=r},t.prototype.render=function(r,n,i){var a=this,o=r.coordinateSystem,s=this.group,l=r.getData(),u=r.getModel("lineStyle"),f=r.getModel("areaStyle"),c=l.getLayout("points")||[],h=o.type==="polar",d=this._coordSys,v=this._symbolDraw,p=this._polyline,g=this._polygon,y=this._lineGroup,m=!n.ssr&&r.isAnimationEnabled(),b=!f.isEmpty(),_=f.get("origin"),x=Oee(o,l,_),T=b&&e_e(o,l,x),E=r.get("showSymbol"),P=r.get("connectNulls"),R=E&&!h&&n_e(r,l,o),M=this._data;M&&M.eachItemGraphicEl(function(V,Y){V.__temp&&(s.remove(V),M.setItemGraphicEl(Y,null))}),E||v.remove(),s.add(y);var D=h?!1:r.get("step"),N;o&&o.getArea&&r.get("clip",!0)&&(N=o.getArea(),N.width!=null?(N.x-=.1,N.y-=.1,N.width+=.2,N.height+=.2):N.r0&&(N.r0-=.5,N.r+=.5)),this._clipShapeForSymbol=N;var B=r_e(l,o,i)||l.getVisual("style")[l.getVisual("drawType")];if(!(p&&d.type===o.type&&D===this._step))E&&v.updateData(l,{isIgnore:R,clipShape:N,disableAnimation:!0,getSymbolPoint:function(V){return[c[V*2],c[V*2+1]]}}),m&&this._initSymbolLabelAnimation(l,o,N),D&&(c=$l(c,o,D,P),T&&(T=$l(T,o,D,P))),p=this._newPolyline(c),b?g=this._newPolygon(c,T):g&&(y.remove(g),g=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,Ic(B)),y.setClipPath(JR(this,o,!0,r));else{b&&!g?g=this._newPolygon(c,T):g&&!b&&(y.remove(g),g=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,Ic(B));var K=y.getClipPath();if(K){var Z=JR(this,o,!1,r);ka(K,{shape:Z.shape},r)}else y.setClipPath(JR(this,o,!0,r));E&&v.updateData(l,{isIgnore:R,clipShape:N,disableAnimation:!0,getSymbolPoint:function(V){return[c[V*2],c[V*2+1]]}}),(!eW(this._stackedOnPoints,T)||!eW(this._points,c))&&(m?this._doUpdateAnimation(l,T,o,i,D,_,P):(D&&(c=$l(c,o,D,P),T&&(T=$l(T,o,D,P))),p.setShape({points:c}),g&&g.setShape({points:c,stackedOnPoints:T})))}var ie=r.getModel("emphasis"),me=ie.get("focus"),k=ie.get("blurScope"),w=ie.get("disabled");if(p.useStyle(lr(u.getLineStyle(),{fill:"none",stroke:B,lineJoin:"bevel"})),rx(p,r,"lineStyle"),p.style.lineWidth>0&&r.get(["emphasis","lineStyle","width"])==="bolder"){var C=p.getState("emphasis").style;C.lineWidth=+p.style.lineWidth+1}ur(p).seriesIndex=r.seriesIndex,Qm(p,me,k,w);var O=nW(r.get("smooth")),S=r.get("smoothMonotone");if(p.setShape({smooth:O,smoothMonotone:S,connectNulls:P}),g){var A=l.getCalculationInfo("stackedOnSeries"),I=0;g.useStyle(lr(f.getAreaStyle(),{fill:B,opacity:.7,lineJoin:"bevel",decal:l.getVisual("style").decal})),A&&(I=nW(A.get("smooth"))),g.setShape({smooth:O,stackedOnSmooth:I,smoothMonotone:S,connectNulls:P}),rx(g,r,"areaStyle"),ur(g).seriesIndex=r.seriesIndex,Qm(g,me,k,w)}var L=function(V){a._changePolyState(V)};l.eachItemGraphicEl(function(V){V&&(V.onHoverStateChange=L)}),this._polyline.onHoverStateChange=L,this._data=l,this._coordSys=o,this._stackedOnPoints=T,this._points=c,this._step=D,this._valueOrigin=_,r.get("triggerLineEvent")&&(this.packEventData(r,p),g&&this.packEventData(r,g))},t.prototype.packEventData=function(r,n){ur(n).eventData={componentType:"series",componentSubType:"line",componentIndex:r.componentIndex,seriesIndex:r.seriesIndex,seriesName:r.name,seriesType:"line"}},t.prototype.highlight=function(r,n,i,a){var o=r.getData(),s=Ac(o,a);if(this._changePolyState("emphasis"),!(s instanceof Array)&&s!=null&&s>=0){var l=o.getLayout("points"),u=o.getItemGraphicEl(s);if(!u){var f=l[s*2],c=l[s*2+1];if(isNaN(f)||isNaN(c)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(f,c))return;var h=r.get("zlevel")||0,d=r.get("z")||0;u=new RL(o,s),u.x=f,u.y=c,u.setZ(h,d);var v=u.getSymbolPath().getTextContent();v&&(v.zlevel=h,v.z=d,v.z2=this._polyline.z2+1),u.__temp=!0,o.setItemGraphicEl(s,u),u.stopSymbolAnimation(!0),this.group.add(u)}u.highlight()}else Xo.prototype.highlight.call(this,r,n,i,a)},t.prototype.downplay=function(r,n,i,a){var o=r.getData(),s=Ac(o,a);if(this._changePolyState("normal"),s!=null&&s>=0){var l=o.getItemGraphicEl(s);l&&(l.__temp?(o.setItemGraphicEl(s,null),this.group.remove(l)):l.downplay())}else Xo.prototype.downplay.call(this,r,n,i,a)},t.prototype._changePolyState=function(r){var n=this._polygon;cV(this._polyline,r),n&&cV(n,r)},t.prototype._newPolyline=function(r){var n=this._polyline;return n&&this._lineGroup.remove(n),n=new qwe({shape:{points:r},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(n),this._polyline=n,n},t.prototype._newPolygon=function(r,n){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new Jwe({shape:{points:r,stackedOnPoints:n},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},t.prototype._initSymbolLabelAnimation=function(r,n,i){var a,o,s=n.getBaseAxis(),l=s.inverse;n.type==="cartesian2d"?(a=s.isHorizontal(),o=!1):n.type==="polar"&&(a=s.dim==="angle",o=!0);var u=r.hostModel,f=u.get("animationDuration");Nt(f)&&(f=f(null));var c=u.get("animationDelay")||0,h=Nt(c)?c(null):c;r.eachItemGraphicEl(function(d,v){var p=d;if(p){var g=[d.x,d.y],y=void 0,m=void 0,b=void 0;if(i)if(o){var _=i,x=n.pointToCoord(g);a?(y=_.startAngle,m=_.endAngle,b=-x[1]/180*Math.PI):(y=_.r0,m=_.r,b=x[0])}else{var T=i;a?(y=T.x,m=T.x+T.width,b=d.x):(y=T.y+T.height,m=T.y,b=d.y)}var E=m===y?0:(b-y)/(m-y);l&&(E=1-E);var P=Nt(c)?c(v):f*E+h,R=p.getSymbolPath(),M=R.getTextContent();p.attr({scaleX:0,scaleY:0}),p.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:P}),M&&M.animateFrom({style:{opacity:0}},{duration:300,delay:P}),R.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(r,n,i){var a=r.getModel("endLabel");if(Pee(r)){var o=r.getData(),s=this._polyline,l=o.getLayout("points");if(!l){s.removeTextContent(),this._endLabel=null;return}var u=this._endLabel;u||(u=this._endLabel=new Xn({z2:200}),u.ignoreClip=!0,s.setTextContent(this._endLabel),s.disableLabelAnimation=!0);var f=o_e(l);f>=0&&(kw(s,Aw(r,"endLabel"),{inheritColor:i,labelFetcher:r,labelDataIndex:f,defaultText:function(c,h,d){return d!=null?Tee(o,d):EL(o,c)},enableTextSetter:!0},l_e(a,n)),s.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(r,n,i,a,o,s,l){var u=this._endLabel,f=this._polyline;if(u){r<1&&a.originalX==null&&(a.originalX=u.x,a.originalY=u.y);var c=i.getLayout("points"),h=i.hostModel,d=h.get("connectNulls"),v=s.get("precision"),p=s.get("distance")||0,g=l.getBaseAxis(),y=g.isHorizontal(),m=g.inverse,b=n.shape,_=m?y?b.x:b.y+b.height:y?b.x+b.width:b.y,x=(y?p:0)*(m?-1:1),T=(y?0:-p)*(m?-1:1),E=y?"x":"y",P=s_e(c,_,E),R=P.range,M=R[1]-R[0],D=void 0;if(M>=1){if(M>1&&!d){var N=iW(c,R[0]);u.attr({x:N[0]+x,y:N[1]+T}),o&&(D=h.getRawValue(R[0]))}else{var N=f.getPointOn(_,E);N&&u.attr({x:N[0]+x,y:N[1]+T});var B=h.getRawValue(R[0]),K=h.getRawValue(R[1]);o&&(D=vve(i,v,B,K,P.t))}a.lastFrameIndex=R[0]}else{var Z=r===1||a.lastFrameIndex>0?R[0]:0,N=iW(c,Z);o&&(D=h.getRawValue(Z)),u.attr({x:N[0]+x,y:N[1]+T})}o&&sO(u).setLabelText(D)}},t.prototype._doUpdateAnimation=function(r,n,i,a,o,s,l){var u=this._polyline,f=this._polygon,c=r.hostModel,h=Xwe(this._data,r,this._stackedOnPoints,n,this._coordSys,i,this._valueOrigin),d=h.current,v=h.stackedOnCurrent,p=h.next,g=h.stackedOnNext;if(o&&(d=$l(h.current,i,o,l),v=$l(h.stackedOnCurrent,i,o,l),p=$l(h.next,i,o,l),g=$l(h.stackedOnNext,i,o,l)),rW(d,p)>3e3||f&&rW(v,g)>3e3){u.stopAnimation(),u.setShape({points:p}),f&&(f.stopAnimation(),f.setShape({points:p,stackedOnPoints:g}));return}u.shape.__points=h.current,u.shape.points=d;var y={shape:{points:p}};h.current!==d&&(y.shape.__points=h.next),u.stopAnimation(),mi(u,y,c),f&&(f.setShape({points:d,stackedOnPoints:v}),f.stopAnimation(),mi(f,{shape:{stackedOnPoints:g}},c),u.shape.points!==f.shape.points&&(f.shape.points=u.shape.points));for(var m=[],b=h.status,_=0;_<b.length;_++){var x=b[_].cmd;if(x==="="){var T=r.getItemGraphicEl(b[_].idx1);T&&m.push({el:T,ptIdx:_})}}u.animators&&u.animators.length&&u.animators[0].during(function(){f&&f.dirtyShape();for(var E=u.shape.__points,P=0;P<m.length;P++){var R=m[P].el,M=m[P].ptIdx*2;R.x=E[M],R.y=E[M+1],R.markRedraw()}})},t.prototype.remove=function(r){var n=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(a,o){a.__temp&&(n.remove(a),i.setItemGraphicEl(o,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(Xo);const f_e=u_e;function c_e(e,t){return{seriesType:e,plan:dL(),reset:function(r){var n=r.getData(),i=r.coordinateSystem,a=r.pipelineContext,o=t||a.large;if(i){var s=pt(i.dimensions,function(d){return n.mapDimension(d)}).slice(0,2),l=s.length,u=n.getCalculationInfo("stackResultDimension");lv(n,s[0])&&(s[0]=u),lv(n,s[1])&&(s[1]=u);var f=n.getStore(),c=n.getDimensionIndex(s[0]),h=n.getDimensionIndex(s[1]);return l&&{progress:function(d,v){for(var p=d.end-d.start,g=o&&Es(p*l),y=[],m=[],b=d.start,_=0;b<d.end;b++){var x=void 0;if(l===1){var T=f.get(c,b);x=i.dataToPoint(T,null,m)}else y[0]=f.get(c,b),y[1]=f.get(h,b),x=i.dataToPoint(y,null,m);o?(g[_++]=x[0],g[_++]=x[1]):v.setItemLayout(b,x.slice())}o&&v.setLayout("points",g)}}}}}}var h_e={average:function(e){for(var t=0,r=0,n=0;n<e.length;n++)isNaN(e[n])||(t+=e[n],r++);return r===0?NaN:t/r},sum:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r]||0;return t},max:function(e){for(var t=-1/0,r=0;r<e.length;r++)e[r]>t&&(t=e[r]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,r=0;r<e.length;r++)e[r]<t&&(t=e[r]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},d_e=function(e){return Math.round(e.length/2)};function Iee(e){return{seriesType:e,reset:function(t,r,n){var i=t.getData(),a=t.get("sampling"),o=t.coordinateSystem,s=i.count();if(s>10&&o.type==="cartesian2d"&&a){var l=o.getBaseAxis(),u=o.getOtherAxis(l),f=l.getExtent(),c=n.getDevicePixelRatio(),h=Math.abs(f[1]-f[0])*(c||1),d=Math.round(s/h);if(isFinite(d)&&d>1){a==="lttb"&&t.setData(i.lttbDownSample(i.mapDimension(u.dim),1/d));var v=void 0;st(a)?v=h_e[a]:Nt(a)&&(v=a),v&&t.setData(i.downSample(i.mapDimension(u.dim),1/d,v,d_e))}}}}}function v_e(e){e.registerChartView(f_e),e.registerSeriesModel(jwe),e.registerLayout(c_e("line",!0)),e.registerVisual({seriesType:"line",reset:function(t){var r=t.getData(),n=t.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=r.getVisual("style").fill),r.setVisual("legendLineStyle",n)}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Iee("line"))}var Mee=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){return _L(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(r,n,i){var a=this.coordinateSystem;if(a&&a.clampData){var o=a.clampData(r),s=a.dataToPoint(o);if(i)le(a.getAxes(),function(h,d){if(h.type==="category"&&n!=null){var v=h.getTicksCoords(),p=o[d],g=n[d]==="x1"||n[d]==="y1";if(g&&(p+=1),v.length<2)return;if(v.length===2){s[d]=h.toGlobalCoord(h.getExtent()[g?1:0]);return}for(var y=void 0,m=void 0,b=1,_=0;_<v.length;_++){var x=v[_].coord,T=_===v.length-1?v[_-1].tickValue+b:v[_].tickValue;if(T===p){m=x;break}else if(T<p)y=x;else if(y!=null&&T>p){m=(x+y)/2;break}_===1&&(b=T-v[0].tickValue)}m==null&&(y?y&&(m=v[v.length-1].coord):m=v[0].coord),s[d]=h.toGlobalCoord(m)}});else{var l=this.getData(),u=l.getLayout("offset"),f=l.getLayout("size"),c=a.getBaseAxis().isHorizontal()?0:1;s[c]+=u+f/2}return s}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(Mu);Mu.registerClass(Mee);const aW=Mee;var p_e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(){return _L(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},t.prototype.getProgressiveThreshold=function(){var r=this.get("progressiveThreshold"),n=this.get("largeThreshold");return n>r&&(r=n),r},t.prototype.brushSelector=function(r,n,i){return i.rect(n.getItemLayout(r))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=MJ(aW.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(aW);const g_e=p_e;var y_e=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),m_e=function(e){Ye(t,e);function t(r){var n=e.call(this,r)||this;return n.type="sausage",n}return t.prototype.getDefaultShape=function(){return new y_e},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r0||0,0),s=Math.max(n.r,0),l=(s-o)*.5,u=o+l,f=n.startAngle,c=n.endAngle,h=n.clockwise,d=Math.PI*2,v=h?c-f<d:f-c<d;v||(f=c-(h?d:-d));var p=Math.cos(f),g=Math.sin(f),y=Math.cos(c),m=Math.sin(c);v?(r.moveTo(p*o+i,g*o+a),r.arc(p*u+i,g*u+a,l,-Math.PI+f,f,!h)):r.moveTo(p*s+i,g*s+a),r.arc(i,a,s,f,c,!h),r.arc(y*u+i,m*u+a,l,c-Math.PI*2,c-Math.PI,!h),o!==0&&r.arc(i,a,o,c,f,h)},t}(cr);const oW=m_e;function b_e(e,t){t=t||{};var r=t.isRoundCap;return function(n,i,a){var o=i.position;if(!o||o instanceof Array)return qC(n,i,a);var s=e(o),l=i.distance!=null?i.distance:5,u=this.shape,f=u.cx,c=u.cy,h=u.r,d=u.r0,v=(h+d)/2,p=u.startAngle,g=u.endAngle,y=(p+g)/2,m=r?Math.abs(h-d)/2:0,b=Math.cos,_=Math.sin,x=f+h*b(p),T=c+h*_(p),E="left",P="top";switch(s){case"startArc":x=f+(d-l)*b(y),T=c+(d-l)*_(y),E="center",P="top";break;case"insideStartArc":x=f+(d+l)*b(y),T=c+(d+l)*_(y),E="center",P="bottom";break;case"startAngle":x=f+v*b(p)+pS(p,l+m,!1),T=c+v*_(p)+gS(p,l+m,!1),E="right",P="middle";break;case"insideStartAngle":x=f+v*b(p)+pS(p,-l+m,!1),T=c+v*_(p)+gS(p,-l+m,!1),E="left",P="middle";break;case"middle":x=f+v*b(y),T=c+v*_(y),E="center",P="middle";break;case"endArc":x=f+(h+l)*b(y),T=c+(h+l)*_(y),E="center",P="bottom";break;case"insideEndArc":x=f+(h-l)*b(y),T=c+(h-l)*_(y),E="center",P="top";break;case"endAngle":x=f+v*b(g)+pS(g,l+m,!0),T=c+v*_(g)+gS(g,l+m,!0),E="left",P="middle";break;case"insideEndAngle":x=f+v*b(g)+pS(g,-l+m,!0),T=c+v*_(g)+gS(g,-l+m,!0),E="right",P="middle";break;default:return qC(n,i,a)}return n=n||{},n.x=x,n.y=T,n.align=E,n.verticalAlign=P,n}}function w_e(e,t,r,n){if(_r(n)){e.setTextConfig({rotation:n});return}else if(et(t)){e.setTextConfig({rotation:0});return}var i=e.shape,a=i.clockwise?i.startAngle:i.endAngle,o=i.clockwise?i.endAngle:i.startAngle,s=(a+o)/2,l,u=r(t);switch(u){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=s;break;case"startAngle":case"insideStartAngle":l=a;break;case"endAngle":case"insideEndAngle":l=o;break;default:e.setTextConfig({rotation:0});return}var f=Math.PI*1.5-l;u==="middle"&&f>Math.PI/2&&f<Math.PI*1.5&&(f-=Math.PI),e.setTextConfig({rotation:f})}function pS(e,t,r){return t*Math.sin(e)*(r?-1:1)}function gS(e,t,r){return t*Math.cos(e)*(r?1:-1)}function Xy(e,t,r){var n=e.get("borderRadius");if(n==null)return r?{cornerRadius:0}:null;et(n)||(n=[n,n,n,n]);var i=Math.abs(t.r||0-t.r0||0);return{cornerRadius:pt(n,function(a){return Au(a,i)})}}var QR=Math.max,ek=Math.min;function __e(e,t){var r=e.getArea&&e.getArea();if(kL(e,"cartesian2d")){var n=e.getBaseAxis();if(n.type!=="category"||!n.onBand){var i=t.getLayout("bandWidth");n.isHorizontal()?(r.x-=i,r.width+=i*2):(r.y-=i,r.height+=i*2)}}return r}var S_e=function(e){Ye(t,e);function t(){var r=e.call(this)||this;return r.type=t.type,r._isFirstFrame=!0,r}return t.prototype.render=function(r,n,i,a){this._model=r,this._removeOnRenderedListener(i),this._updateDrawMode(r);var o=r.get("coordinateSystem");(o==="cartesian2d"||o==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(r,n,i):this._renderNormal(r,n,i,a))},t.prototype.incrementalPrepareRender=function(r){this._clear(),this._updateDrawMode(r),this._updateLargeClip(r)},t.prototype.incrementalRender=function(r,n){this._progressiveEls=[],this._incrementalRenderLarge(r,n)},t.prototype.eachRendered=function(r){aO(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},t.prototype._renderNormal=function(r,n,i,a){var o=this.group,s=r.getData(),l=this._data,u=r.coordinateSystem,f=u.getBaseAxis(),c;u.type==="cartesian2d"?c=f.isHorizontal():u.type==="polar"&&(c=f.dim==="angle");var h=r.isAnimationEnabled()?r:null,d=C_e(r,u);d&&this._enableRealtimeSort(d,s,i);var v=r.get("clip",!0)||d,p=__e(u,s);o.removeClipPath();var g=r.get("roundCap",!0),y=r.get("showBackground",!0),m=r.getModel("backgroundStyle"),b=m.get("borderRadius")||0,_=[],x=this._backgroundEls,T=a&&a.isInitSort,E=a&&a.type==="changeAxisOrder";function P(D){var N=yS[u.type](s,D),B=A_e(u,c,N);return B.useStyle(m.getItemStyle()),u.type==="cartesian2d"?B.setShape("r",b):B.setShape("cornerRadius",b),_[D]=B,B}s.diff(l).add(function(D){var N=s.getItemModel(D),B=yS[u.type](s,D,N);if(y&&P(D),!(!s.hasValue(D)||!cW[u.type](B))){var K=!1;v&&(K=sW[u.type](p,B));var Z=lW[u.type](r,s,D,B,c,h,f.model,!1,g);d&&(Z.forceLabelAnimation=!0),hW(Z,s,D,N,B,r,c,u.type==="polar"),T?Z.attr({shape:B}):d?uW(d,h,Z,B,D,c,!1,!1):ka(Z,{shape:B},r,D),s.setItemGraphicEl(D,Z),o.add(Z),Z.ignore=K}}).update(function(D,N){var B=s.getItemModel(D),K=yS[u.type](s,D,B);if(y){var Z=void 0;x.length===0?Z=P(N):(Z=x[N],Z.useStyle(m.getItemStyle()),u.type==="cartesian2d"?Z.setShape("r",b):Z.setShape("cornerRadius",b),_[D]=Z);var ie=yS[u.type](s,D),me=$ee(c,ie,u);mi(Z,{shape:me},h,D)}var k=l.getItemGraphicEl(N);if(!s.hasValue(D)||!cW[u.type](K)){o.remove(k);return}var w=!1;if(v&&(w=sW[u.type](p,K),w&&o.remove(k)),k?KN(k):k=lW[u.type](r,s,D,K,c,h,f.model,!!k,g),d&&(k.forceLabelAnimation=!0),E){var C=k.getTextContent();if(C){var O=sO(C);O.prevValue!=null&&(O.prevValue=O.value)}}else hW(k,s,D,B,K,r,c,u.type==="polar");T?k.attr({shape:K}):d?uW(d,h,k,K,D,c,!0,E):mi(k,{shape:K},r,D,null),s.setItemGraphicEl(D,k),k.ignore=w,o.add(k)}).remove(function(D){var N=l.getItemGraphicEl(D);N&&ax(N,r,D)}).execute();var R=this._backgroundGroup||(this._backgroundGroup=new Kn);R.removeAll();for(var M=0;M<_.length;++M)R.add(_[M]);o.add(R),this._backgroundEls=_,this._data=s},t.prototype._renderLarge=function(r,n,i){this._clear(),vW(r,this.group),this._updateLargeClip(r)},t.prototype._incrementalRenderLarge=function(r,n){this._removeBackground(),vW(n,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(r){var n=r.get("clip",!0)&&Qwe(r.coordinateSystem,!1,r),i=this.group;n?i.setClipPath(n):i.removeClipPath()},t.prototype._enableRealtimeSort=function(r,n,i){var a=this;if(n.count()){var o=r.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(n,r,i),this._isFirstFrame=!1;else{var s=function(l){var u=n.getItemGraphicEl(l),f=u&&u.shape;return f&&Math.abs(o.isHorizontal()?f.height:f.width)||0};this._onRendered=function(){a._updateSortWithinSameData(n,s,o,i)},i.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(r,n,i){var a=[];return r.each(r.mapDimension(n.dim),function(o,s){var l=i(s);l=l??NaN,a.push({dataIndex:s,mappedValue:l,ordinalNumber:o})}),a.sort(function(o,s){return s.mappedValue-o.mappedValue}),{ordinalNumbers:pt(a,function(o){return o.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(r,n,i){for(var a=i.scale,o=r.mapDimension(i.dim),s=Number.MAX_VALUE,l=0,u=a.getOrdinalMeta().categories.length;l<u;++l){var f=r.rawIndexOf(o,a.getRawOrdinalNumber(l)),c=f<0?Number.MIN_VALUE:n(r.indexOfRawIndex(f));if(c>s)return!0;s=c}return!1},t.prototype._isOrderDifferentInView=function(r,n){for(var i=n.scale,a=i.getExtent(),o=Math.max(0,a[0]),s=Math.min(a[1],i.getOrdinalMeta().categories.length-1);o<=s;++o)if(r.ordinalNumbers[o]!==i.getRawOrdinalNumber(o))return!0},t.prototype._updateSortWithinSameData=function(r,n,i,a){if(this._isOrderChangedWithinSameData(r,n,i)){var o=this._dataSort(r,i,n);this._isOrderDifferentInView(o,i)&&(this._removeOnRenderedListener(a),a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:o}))}},t.prototype._dispatchInitSort=function(r,n,i){var a=n.baseAxis,o=this._dataSort(r,a,function(s){return r.get(r.mapDimension(n.otherAxis.dim),s)});i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",isInitSort:!0,axisId:a.index,sortInfo:o})},t.prototype.remove=function(r,n){this._clear(this._model),this._removeOnRenderedListener(n)},t.prototype.dispose=function(r,n){this._removeOnRenderedListener(n)},t.prototype._removeOnRenderedListener=function(r){this._onRendered&&(r.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(r){var n=this.group,i=this._data;r&&r.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(a){ax(a,r,ur(a).dataIndex)})):n.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(Xo),sW={cartesian2d:function(e,t){var r=t.width<0?-1:1,n=t.height<0?-1:1;r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height);var i=e.x+e.width,a=e.y+e.height,o=QR(t.x,e.x),s=ek(t.x+t.width,i),l=QR(t.y,e.y),u=ek(t.y+t.height,a),f=s<o,c=u<l;return t.x=f&&o>i?s:o,t.y=c&&l>a?u:l,t.width=f?0:s-o,t.height=c?0:u-l,r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height),f||c},polar:function(e,t){var r=t.r0<=t.r?1:-1;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}var i=ek(t.r,e.r),a=QR(t.r0,e.r0);t.r=i,t.r0=a;var o=i-a<0;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}return o}},lW={cartesian2d:function(e,t,r,n,i,a,o,s,l){var u=new _n({shape:Le({},n),z2:1});if(u.__dataIndex=r,u.name="item",a){var f=u.shape,c=i?"height":"width";f[c]=0}return u},polar:function(e,t,r,n,i,a,o,s,l){var u=!i&&l?oW:Jc,f=new u({shape:n,z2:1});f.name="item";var c=Dee(i);if(f.calculateTextPosition=b_e(c,{isRoundCap:u===oW}),a){var h=f.shape,d=i?"r":"endAngle",v={};h[d]=i?n.r0:n.startAngle,v[d]=n[d],(s?mi:ka)(f,{shape:v},a)}return f}};function C_e(e,t){var r=e.get("realtimeSort",!0),n=t.getBaseAxis();if(r&&n.type==="category"&&t.type==="cartesian2d")return{baseAxis:n,otherAxis:t.getOtherAxis(n)}}function uW(e,t,r,n,i,a,o,s){var l,u;a?(u={x:n.x,width:n.width},l={y:n.y,height:n.height}):(u={y:n.y,height:n.height},l={x:n.x,width:n.width}),s||(o?mi:ka)(r,{shape:l},t,i,null);var f=t?e.baseAxis.model:null;(o?mi:ka)(r,{shape:u},f,i)}function fW(e,t){for(var r=0;r<t.length;r++)if(!isFinite(e[t[r]]))return!0;return!1}var x_e=["x","y","width","height"],T_e=["cx","cy","r","startAngle","endAngle"],cW={cartesian2d:function(e){return!fW(e,x_e)},polar:function(e){return!fW(e,T_e)}},yS={cartesian2d:function(e,t,r){var n=e.getItemLayout(t),i=r?E_e(r,n):0,a=n.width>0?1:-1,o=n.height>0?1:-1;return{x:n.x+a*i/2,y:n.y+o*i/2,width:n.width-a*i,height:n.height-o*i}},polar:function(e,t,r){var n=e.getItemLayout(t);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function O_e(e){return e.startAngle!=null&&e.endAngle!=null&&e.startAngle===e.endAngle}function Dee(e){return function(t){var r=t?"Arc":"Angle";return function(n){switch(n){case"start":case"insideStart":case"end":case"insideEnd":return n+r;default:return n}}}(e)}function hW(e,t,r,n,i,a,o,s){var l=t.getItemVisual(r,"style");if(s){if(!a.get("roundCap")){var f=e.shape,c=Xy(n.getModel("itemStyle"),f,!0);Le(f,c),e.setShape(f)}}else{var u=n.get(["itemStyle","borderRadius"])||0;e.setShape("r",u)}e.useStyle(l);var h=n.getShallow("cursor");h&&e.attr("cursor",h);var d=s?o?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":o?i.height>=0?"bottom":"top":i.width>=0?"right":"left",v=Aw(n);kw(e,v,{labelFetcher:a,labelDataIndex:r,defaultText:EL(a.getData(),r),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var p=e.getTextContent();if(s&&p){var g=n.get(["label","position"]);e.textConfig.inside=g==="middle"?!0:null,w_e(e,g==="outside"?d:g,Dee(o),n.get(["label","rotate"]))}Fge(p,v,a.getRawValue(r),function(m){return Tee(t,m)});var y=n.getModel(["emphasis"]);Qm(e,y.get("focus"),y.get("blurScope"),y.get("disabled")),rx(e,n),O_e(i)&&(e.style.fill="none",e.style.stroke="none",le(e.states,function(m){m.style&&(m.style.fill=m.style.stroke="none")}))}function E_e(e,t){var r=e.get(["itemStyle","borderColor"]);if(!r||r==="none")return 0;var n=e.get(["itemStyle","borderWidth"])||0,i=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),a=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(n,i,a)}var R_e=function(){function e(){}return e}(),dW=function(e){Ye(t,e);function t(r){var n=e.call(this,r)||this;return n.type="largeBar",n}return t.prototype.getDefaultShape=function(){return new R_e},t.prototype.buildPath=function(r,n){for(var i=n.points,a=this.baseDimIdx,o=1-this.baseDimIdx,s=[],l=[],u=this.barWidth,f=0;f<i.length;f+=3)l[a]=u,l[o]=i[f+2],s[a]=i[f+a],s[o]=i[f+o],r.rect(s[0],s[1],l[0],l[1])},t}(cr);function vW(e,t,r,n){var i=e.getData(),a=i.getLayout("valueAxisHorizontal")?1:0,o=i.getLayout("largeDataIndices"),s=i.getLayout("size"),l=e.getModel("backgroundStyle"),u=i.getLayout("largeBackgroundPoints");if(u){var f=new dW({shape:{points:u},incremental:!!n,silent:!0,z2:0});f.baseDimIdx=a,f.largeDataIndices=o,f.barWidth=s,f.useStyle(l.getItemStyle()),t.add(f),r&&r.push(f)}var c=new dW({shape:{points:i.getLayout("largePoints")},incremental:!!n,ignoreCoarsePointer:!0,z2:1});c.baseDimIdx=a,c.largeDataIndices=o,c.barWidth=s,t.add(c),c.useStyle(i.getVisual("style")),ur(c).seriesIndex=e.seriesIndex,e.get("silent")||(c.on("mousedown",pW),c.on("mousemove",pW)),r&&r.push(c)}var pW=bO(function(e){var t=this,r=k_e(t,e.offsetX,e.offsetY);ur(t).dataIndex=r>=0?r:null},30,!1);function k_e(e,t,r){for(var n=e.baseDimIdx,i=1-n,a=e.shape.points,o=e.largeDataIndices,s=[],l=[],u=e.barWidth,f=0,c=a.length/3;f<c;f++){var h=f*3;if(l[n]=u,l[i]=a[h+2],s[n]=a[h+n],s[i]=a[h+i],l[i]<0&&(s[i]+=l[i],l[i]=-l[i]),t>=s[0]&&t<=s[0]+l[0]&&r>=s[1]&&r<=s[1]+l[1])return o[f]}return-1}function $ee(e,t,r){if(kL(r,"cartesian2d")){var n=t,i=r.getArea();return{x:e?n.x:i.x,y:e?i.y:n.y,width:e?n.width:i.width,height:e?i.height:n.height}}else{var i=r.getArea(),a=t;return{cx:i.cx,cy:i.cy,r0:e?i.r0:a.r0,r:e?i.r:a.r,startAngle:e?a.startAngle:0,endAngle:e?a.endAngle:Math.PI*2}}}function A_e(e,t,r){var n=e.type==="polar"?Jc:_n;return new n({shape:$ee(t,r,e),silent:!0,z2:0})}const P_e=S_e;function I_e(e){e.registerChartView(P_e),e.registerSeriesModel(g_e),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,en(Bbe,"bar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,Vbe("bar")),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Iee("bar")),e.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,r){var n=t.componentType||"series";r.eachComponent({mainType:n,query:t},function(i){t.sortInfo&&i.axis.setCategorySortInfo(t.sortInfo)})})}var mS=Math.PI*2,gW=Math.PI/180;function Nee(e,t){return iv(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Lee(e,t){var r=Nee(e,t),n=e.get("center"),i=e.get("radius");et(i)||(i=[0,i]);var a=Mr(r.width,t.getWidth()),o=Mr(r.height,t.getHeight()),s=Math.min(a,o),l=Mr(i[0],s/2),u=Mr(i[1],s/2),f,c,h=e.coordinateSystem;if(h){var d=h.dataToPoint(n);f=d[0]||0,c=d[1]||0}else et(n)||(n=[n,n]),f=Mr(n[0],a)+r.x,c=Mr(n[1],o)+r.y;return{cx:f,cy:c,r0:l,r:u}}function M_e(e,t,r){t.eachSeriesByType(e,function(n){var i=n.getData(),a=i.mapDimension("value"),o=Nee(n,r),s=Lee(n,r),l=s.cx,u=s.cy,f=s.r,c=s.r0,h=-n.get("startAngle")*gW,d=n.get("minAngle")*gW,v=0;i.each(a,function(M){!isNaN(M)&&v++});var p=i.getSum(a),g=Math.PI/(p||v)*2,y=n.get("clockwise"),m=n.get("roseType"),b=n.get("stillShowZeroSum"),_=i.getDataExtent(a);_[0]=0;var x=mS,T=0,E=h,P=y?1:-1;if(i.setLayout({viewRect:o,r:f}),i.each(a,function(M,D){var N;if(isNaN(M)){i.setItemLayout(D,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:y,cx:l,cy:u,r0:c,r:m?NaN:f});return}m!=="area"?N=p===0&&b?g:M*g:N=mS/v,N<d?(N=d,x-=d):T+=M;var B=E+P*N;i.setItemLayout(D,{angle:N,startAngle:E,endAngle:B,clockwise:y,cx:l,cy:u,r0:c,r:m?yI(M,_,[c,f]):f}),E=B}),x<mS&&v)if(x<=.001){var R=mS/v;i.each(a,function(M,D){if(!isNaN(M)){var N=i.getItemLayout(D);N.angle=R,N.startAngle=h+P*D*R,N.endAngle=h+P*(D+1)*R}})}else g=x/T,E=h,i.each(a,function(M,D){if(!isNaN(M)){var N=i.getItemLayout(D),B=N.angle===d?d:M*g;N.startAngle=E,N.endAngle=E+P*B,E+=P*B}})})}function D_e(e){return{seriesType:e,reset:function(t,r){var n=r.findComponents({mainType:"legend"});if(!(!n||!n.length)){var i=t.getData();i.filterSelf(function(a){for(var o=i.getName(a),s=0;s<n.length;s++)if(!n[s].isSelected(o))return!1;return!0})}}}}var $_e=Math.PI/180;function yW(e,t,r,n,i,a,o,s,l,u){if(e.length<2)return;function f(p){for(var g=p.rB,y=g*g,m=0;m<p.list.length;m++){var b=p.list[m],_=Math.abs(b.label.y-r),x=n+b.len,T=x*x,E=Math.sqrt((1-Math.abs(_*_/y))*T),P=t+(E+b.len2)*i,R=P-b.label.x,M=b.targetTextWidth-R*i;Fee(b,M,!0),b.label.x=P}}function c(p){for(var g={list:[],maxY:0},y={list:[],maxY:0},m=0;m<p.length;m++)if(p[m].labelAlignTo==="none"){var b=p[m],_=b.label.y>r?y:g,x=Math.abs(b.label.y-r);if(x>=_.maxY){var T=b.label.x-t-b.len2*i,E=n+b.len,P=Math.abs(T)<E?Math.sqrt(x*x/(1-T*T/E/E)):E;_.rB=P,_.maxY=x}_.list.push(b)}f(g),f(y)}for(var h=e.length,d=0;d<h;d++)if(e[d].position==="outer"&&e[d].labelAlignTo==="labelLine"){var v=e[d].label.x-u;e[d].linePoints[1][0]+=v,e[d].label.x=u}Iwe(e,l,l+o)&&c(e)}function N_e(e,t,r,n,i,a,o,s){for(var l=[],u=[],f=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<e.length;h++){var d=e[h].label;tk(e[h])||(d.x<t?(f=Math.min(f,d.x),l.push(e[h])):(c=Math.max(c,d.x),u.push(e[h])))}for(var h=0;h<e.length;h++){var v=e[h];if(!tk(v)&&v.linePoints){if(v.labelStyleWidth!=null)continue;var d=v.label,p=v.linePoints,g=void 0;v.labelAlignTo==="edge"?d.x<t?g=p[2][0]-v.labelDistance-o-v.edgeDistance:g=o+i-v.edgeDistance-p[2][0]-v.labelDistance:v.labelAlignTo==="labelLine"?d.x<t?g=f-o-v.bleedMargin:g=o+i-c-v.bleedMargin:d.x<t?g=d.x-o-v.bleedMargin:g=o+i-d.x-v.bleedMargin,v.targetTextWidth=g,Fee(v,g)}}yW(u,t,r,n,1,i,a,o,s,c),yW(l,t,r,n,-1,i,a,o,s,f);for(var h=0;h<e.length;h++){var v=e[h];if(!tk(v)&&v.linePoints){var d=v.label,p=v.linePoints,y=v.labelAlignTo==="edge",m=d.style.padding,b=m?m[1]+m[3]:0,_=d.style.backgroundColor?0:b,x=v.rect.width+_,T=p[1][0]-p[2][0];y?d.x<t?p[2][0]=o+v.edgeDistance+x+v.labelDistance:p[2][0]=o+i-v.edgeDistance-x-v.labelDistance:(d.x<t?p[2][0]=d.x+v.labelDistance:p[2][0]=d.x-v.labelDistance,p[1][0]=p[2][0]+T),p[1][1]=p[2][1]=d.y}}}function Fee(e,t,r){if(r===void 0&&(r=!1),e.labelStyleWidth==null){var n=e.label,i=n.style,a=e.rect,o=i.backgroundColor,s=i.padding,l=s?s[1]+s[3]:0,u=i.overflow,f=a.width+(o?0:l);if(t<f||r){var c=a.height;if(u&&u.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",t-l);var h=n.getBoundingRect();n.setStyle("width",Math.ceil(h.width)),n.setStyle("backgroundColor",o)}else{var d=t-l,v=t<f?d:r?d>e.unconstrainedWidth?null:d:null;n.setStyle("width",v)}var p=n.getBoundingRect();a.width=p.width;var g=(n.style.margin||0)+2.1;a.height=p.height+g,a.y-=(a.height-c)/2}}}function tk(e){return e.position==="center"}function L_e(e){var t=e.getData(),r=[],n,i,a=!1,o=(e.get("minShowLabelAngle")||0)*$_e,s=t.getLayout("viewRect"),l=t.getLayout("r"),u=s.width,f=s.x,c=s.y,h=s.height;function d(T){T.ignore=!0}function v(T){if(!T.ignore)return!0;for(var E in T.states)if(T.states[E].ignore===!1)return!0;return!1}t.each(function(T){var E=t.getItemGraphicEl(T),P=E.shape,R=E.getTextContent(),M=E.getTextGuideLine(),D=t.getItemModel(T),N=D.getModel("label"),B=N.get("position")||D.get(["emphasis","label","position"]),K=N.get("distanceToLabelLine"),Z=N.get("alignTo"),ie=Mr(N.get("edgeDistance"),u),me=N.get("bleedMargin"),k=D.getModel("labelLine"),w=k.get("length");w=Mr(w,u);var C=k.get("length2");if(C=Mr(C,u),Math.abs(P.endAngle-P.startAngle)<o){le(R.states,d),R.ignore=!0,M&&(le(M.states,d),M.ignore=!0);return}if(v(R)){var O=(P.startAngle+P.endAngle)/2,S=Math.cos(O),A=Math.sin(O),I,L,V,Y;n=P.cx,i=P.cy;var ae=B==="inside"||B==="inner";if(B==="center")I=P.cx,L=P.cy,Y="center";else{var re=(ae?(P.r+P.r0)/2*S:P.r*S)+n,te=(ae?(P.r+P.r0)/2*A:P.r*A)+i;if(I=re+S*3,L=te+A*3,!ae){var ge=re+S*(w+l-P.r),H=te+A*(w+l-P.r),Ce=ge+(S<0?-1:1)*C,oe=H;Z==="edge"?I=S<0?f+ie:f+u-ie:I=Ce+(S<0?-K:K),L=oe,V=[[re,te],[ge,H],[Ce,oe]]}Y=ae?"center":Z==="edge"?S>0?"right":"left":S>0?"left":"right"}var Oe=Math.PI,Ee=0,be=N.get("rotate");if(_r(be))Ee=be*(Oe/180);else if(B==="center")Ee=0;else if(be==="radial"||be===!0){var Ie=S<0?-O+Oe:-O;Ee=Ie}else if(be==="tangential"&&B!=="outside"&&B!=="outer"){var Me=Math.atan2(S,A);Me<0&&(Me=Oe*2+Me);var j=A>0;j&&(Me=Oe+Me),Ee=Me-Oe}if(a=!!Ee,R.x=I,R.y=L,R.rotation=Ee,R.setStyle({verticalAlign:"middle"}),ae){R.setStyle({align:Y});var fe=R.states.select;fe&&(fe.x+=R.x,fe.y+=R.y)}else{var U=R.getBoundingRect().clone();U.applyTransform(R.getComputedTransform());var Q=(R.style.margin||0)+2.1;U.y-=Q/2,U.height+=Q,r.push({label:R,labelLine:M,position:B,len:w,len2:C,minTurnAngle:k.get("minTurnAngle"),maxSurfaceAngle:k.get("maxSurfaceAngle"),surfaceNormal:new St(S,A),linePoints:V,textAlign:Y,labelDistance:K,labelAlignTo:Z,edgeDistance:ie,bleedMargin:me,rect:U,unconstrainedWidth:U.width,labelStyleWidth:R.style.width})}E.setTextConfig({inside:ae})}}),!a&&e.get("avoidLabelOverlap")&&N_e(r,n,i,l,u,h,f,c);for(var p=0;p<r.length;p++){var g=r[p],y=g.label,m=g.labelLine,b=isNaN(y.x)||isNaN(y.y);if(y){y.setStyle({align:g.textAlign}),b&&(le(y.states,d),y.ignore=!0);var _=y.states.select;_&&(_.x+=y.x,_.y+=y.y)}if(m){var x=g.linePoints;b||!x?(le(m.states,d),m.ignore=!0):(Twe(x,g.minTurnAngle),Owe(x,g.surfaceNormal,g.maxSurfaceAngle),m.setShape({points:x}),y.__hostTarget.textGuideLineConfig={anchor:new St(x[0][0],x[0][1])})}}}var F_e=function(e){Ye(t,e);function t(r,n,i){var a=e.call(this)||this;a.z2=2;var o=new Xn;return a.setTextContent(o),a.updateData(r,n,i,!0),a}return t.prototype.updateData=function(r,n,i,a){var o=this,s=r.hostModel,l=r.getItemModel(n),u=l.getModel("emphasis"),f=r.getItemLayout(n),c=Le(Xy(l.getModel("itemStyle"),f,!0),f);if(isNaN(c.startAngle)){o.setShape(c);return}if(a){o.setShape(c);var h=s.getShallow("animationType");s.ecModel.ssr?(ka(o,{scaleX:0,scaleY:0},s,{dataIndex:n,isFrom:!0}),o.originX=c.cx,o.originY=c.cy):h==="scale"?(o.shape.r=f.r0,ka(o,{shape:{r:f.r}},s,n)):i!=null?(o.setShape({startAngle:i,endAngle:i}),ka(o,{shape:{startAngle:f.startAngle,endAngle:f.endAngle}},s,n)):(o.shape.endAngle=f.startAngle,mi(o,{shape:{endAngle:f.endAngle}},s,n))}else KN(o),mi(o,{shape:c},s,n);o.useStyle(r.getItemVisual(n,"style")),rx(o,l);var d=(f.startAngle+f.endAngle)/2,v=s.get("selectedOffset"),p=Math.cos(d)*v,g=Math.sin(d)*v,y=l.getShallow("cursor");y&&o.attr("cursor",y),this._updateLabel(s,r,n),o.ensureState("emphasis").shape=Le({r:f.r+(u.get("scale")&&u.get("scaleSize")||0)},Xy(u.getModel("itemStyle"),f)),Le(o.ensureState("select"),{x:p,y:g,shape:Xy(l.getModel(["select","itemStyle"]),f)}),Le(o.ensureState("blur"),{shape:Xy(l.getModel(["blur","itemStyle"]),f)});var m=o.getTextGuideLine(),b=o.getTextContent();m&&Le(m.ensureState("select"),{x:p,y:g}),Le(b.ensureState("select"),{x:p,y:g}),Qm(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r,n,i){var a=this,o=n.getItemModel(i),s=o.getModel("labelLine"),l=n.getItemVisual(i,"style"),u=l&&l.fill,f=l&&l.opacity;kw(a,Aw(o),{labelFetcher:n.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:f,defaultText:r.getFormattedLabel(i,"normal")||n.getName(i)});var c=a.getTextContent();a.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var h=r.get(["label","position"]);if(h!=="outside"&&h!=="outer")a.removeTextGuideLine();else{var d=this.getTextGuideLine();d||(d=new iO,this.setTextGuideLine(d)),Rwe(this,kwe(o),{stroke:u,opacity:sm(s.get(["lineStyle","opacity"]),f,1)})}},t}(Jc),H_e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,n,i,a){var o=r.getData(),s=this._data,l=this.group,u;if(!s&&o.count()>0){for(var f=o.getItemLayout(0),c=1;isNaN(f&&f.startAngle)&&c<o.count();++c)f=o.getItemLayout(c);f&&(u=f.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),o.count()===0&&r.get("showEmptyCircle")){var h=new Jc({shape:Lee(r,i)});h.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=h,l.add(h)}o.diff(s).add(function(d){var v=new F_e(o,d,u);o.setItemGraphicEl(d,v),l.add(v)}).update(function(d,v){var p=s.getItemGraphicEl(v);p.updateData(o,d,u),p.off("click"),l.add(p),o.setItemGraphicEl(d,p)}).remove(function(d){var v=s.getItemGraphicEl(d);ax(v,r,d)}).execute(),L_e(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=o)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var o=r[0]-a.cx,s=r[1]-a.cy,l=Math.sqrt(o*o+s*s);return l<=a.r&&l>=a.r0}},t.type="pie",t}(Xo);const B_e=H_e;function V_e(e,t,r){t=et(t)&&{coordDimensions:t}||Le({encodeDefine:e.getEncode()},t);var n=e.getSource(),i=nee(n,t).dimensions,a=new ree(i,e);return a.initData(n,r),a}var j_e=function(){function e(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return e.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},e.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},e.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},e.prototype.getItemVisual=function(t,r){var n=this._getDataWithEncodedVisual();return n.getItemVisual(t,r)},e}();const W_e=j_e;var U_e=pn(),z_e=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new W_e(Or(this.getData,this),Or(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return V_e(this,{coordDimensions:["value"],encodeDefaulter:en(hye,this)})},t.prototype.getDataParams=function(r){var n=this.getData(),i=U_e(n),a=i.seats;if(!a){var o=[];n.each(n.mapDimension("value"),function(l){o.push(l)}),a=i.seats=Xde(o,n.hostModel.get("percentPrecision"))}var s=e.prototype.getDataParams.call(this,r);return s.percent=a[r]||0,s.$vars.push("percent"),s},t.prototype._defaultLabelLine=function(r){mI(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(Mu);const G_e=z_e;function Y_e(e){return{seriesType:e,reset:function(t,r){var n=t.getData();n.filterSelf(function(i){var a=n.mapDimension("value"),o=n.get(a,i);return!(_r(o)&&!isNaN(o)&&o<0)})}}}function K_e(e){e.registerChartView(B_e),e.registerSeriesModel(G_e),Qme("pie",e.registerAction),e.registerLayout(en(M_e,"pie")),e.registerProcessor(D_e("pie")),e.registerProcessor(Y_e("pie"))}var X_e=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}(Pr);const q_e=X_e;var KI=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",ao).models[0]},t.type="cartesian2dAxis",t}(Pr);es(KI,hwe);var Hee={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},Z_e=ar({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},Hee),AL=ar({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},Hee),J_e=ar({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},AL),Q_e=lr({logBase:10},AL);const eSe={category:Z_e,value:AL,time:J_e,log:Q_e};var tSe={value:1,category:1,time:1,log:1};function mW(e,t,r,n){le(tSe,function(i,a){var o=ar(ar({},eSe[a],!0),n,!0),s=function(l){Ye(u,l);function u(){var f=l!==null&&l.apply(this,arguments)||this;return f.type=t+"Axis."+a,f}return u.prototype.mergeDefaultAndTheme=function(f,c){var h=n0(this),d=h?pO(f):{},v=c.getTheme();ar(f,v.get(a+"Axis")),ar(f,this.getDefaultOption()),f.type=bW(f),h&&av(f,d,h)},u.prototype.optionUpdated=function(){var f=this.option;f.type==="category"&&(this.__ordinalMeta=zI.createByAxisModel(this))},u.prototype.getCategories=function(f){var c=this.option;if(c.type==="category")return f?c.data:this.__ordinalMeta.categories},u.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},u.type=t+"Axis."+a,u.defaultOption=o,u}(r);e.registerComponentModel(s)}),e.registerSubTypeDefaulter(t+"Axis",bW)}function bW(e){return e.type||(e.data?"category":"value")}var rSe=function(){function e(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return e.prototype.getAxis=function(t){return this._axes[t]},e.prototype.getAxes=function(){return pt(this._dimList,function(t){return this._axes[t]},this)},e.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),hi(this.getAxes(),function(r){return r.scale.type===t})},e.prototype.addAxis=function(t){var r=t.dim;this._axes[r]=t,this._dimList.push(r)},e}();const nSe=rSe;var XI=["x","y"];function wW(e){return e.type==="interval"||e.type==="time"}var iSe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cartesian2d",r.dimensions=XI,r}return t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var r=this.getAxis("x").scale,n=this.getAxis("y").scale;if(!(!wW(r)||!wW(n))){var i=r.getExtent(),a=n.getExtent(),o=this.dataToPoint([i[0],a[0]]),s=this.dataToPoint([i[1],a[1]]),l=i[1]-i[0],u=a[1]-a[0];if(!(!l||!u)){var f=(s[0]-o[0])/l,c=(s[1]-o[1])/u,h=o[0]-i[0]*f,d=o[1]-a[0]*c,v=this._transform=[f,0,0,c,h,d];this._invTransform=PN([],v)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(r){var n=this.getAxis("x"),i=this.getAxis("y");return n.contain(n.toLocalCoord(r[0]))&&i.contain(i.toLocalCoord(r[1]))},t.prototype.containData=function(r){return this.getAxis("x").containData(r[0])&&this.getAxis("y").containData(r[1])},t.prototype.containZone=function(r,n){var i=this.dataToPoint(r),a=this.dataToPoint(n),o=this.getArea(),s=new or(i[0],i[1],a[0]-i[0],a[1]-i[1]);return o.intersect(s)},t.prototype.dataToPoint=function(r,n,i){i=i||[];var a=r[0],o=r[1];if(this._transform&&a!=null&&isFinite(a)&&o!=null&&isFinite(o))return Ra(i,r,this._transform);var s=this.getAxis("x"),l=this.getAxis("y");return i[0]=s.toGlobalCoord(s.dataToCoord(a,n)),i[1]=l.toGlobalCoord(l.dataToCoord(o,n)),i},t.prototype.clampData=function(r,n){var i=this.getAxis("x").scale,a=this.getAxis("y").scale,o=i.getExtent(),s=a.getExtent(),l=i.parse(r[0]),u=a.parse(r[1]);return n=n||[],n[0]=Math.min(Math.max(Math.min(o[0],o[1]),l),Math.max(o[0],o[1])),n[1]=Math.min(Math.max(Math.min(s[0],s[1]),u),Math.max(s[0],s[1])),n},t.prototype.pointToData=function(r,n){var i=[];if(this._invTransform)return Ra(i,r,this._invTransform);var a=this.getAxis("x"),o=this.getAxis("y");return i[0]=a.coordToData(a.toLocalCoord(r[0]),n),i[1]=o.coordToData(o.toLocalCoord(r[1]),n),i},t.prototype.getOtherAxis=function(r){return this.getAxis(r.dim==="x"?"y":"x")},t.prototype.getArea=function(){var r=this.getAxis("x").getGlobalExtent(),n=this.getAxis("y").getGlobalExtent(),i=Math.min(r[0],r[1]),a=Math.min(n[0],n[1]),o=Math.max(r[0],r[1])-i,s=Math.max(n[0],n[1])-a;return new or(i,a,o,s)},t}(nSe),aSe=function(e){Ye(t,e);function t(r,n,i,a,o){var s=e.call(this,r,n,i)||this;return s.index=0,s.type=a||"value",s.position=o||"bottom",s}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.getGlobalExtent=function(r){var n=this.getExtent();return n[0]=this.toGlobalCoord(n[0]),n[1]=this.toGlobalCoord(n[1]),r&&n[0]>n[1]&&n.reverse(),n},t.prototype.pointToData=function(r,n){return this.coordToData(this.toLocalCoord(r[this.dim==="x"?0:1]),n)},t.prototype.setCategorySortInfo=function(r){if(this.type!=="category")return!1;this.model.option.categorySortInfo=r,this.scale.setSortInfo(r)},t}(xwe);const oSe=aSe;function qI(e,t,r){r=r||{};var n=e.coordinateSystem,i=t.axis,a={},o=i.getAxesOnZeroOf()[0],s=i.position,l=o?"onZero":s,u=i.dim,f=n.getRect(),c=[f.x,f.x+f.width,f.y,f.y+f.height],h={left:0,right:1,top:0,bottom:1,onZero:2},d=t.get("offset")||0,v=u==="x"?[c[2]-d,c[3]+d]:[c[0]-d,c[1]+d];if(o){var p=o.toGlobalCoord(o.dataToCoord(0));v[h.onZero]=Math.max(Math.min(p,v[1]),v[0])}a.position=[u==="y"?v[h[l]]:c[0],u==="x"?v[h[l]]:c[3]],a.rotation=Math.PI/2*(u==="x"?0:1);var g={top:-1,bottom:1,left:-1,right:1};a.labelDirection=a.tickDirection=a.nameDirection=g[s],a.labelOffset=o?v[h[s]]-v[h.onZero]:0,t.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),Km(r.labelInside,t.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var y=t.get(["axisLabel","rotate"]);return a.labelRotate=l==="top"?-y:y,a.z2=1,a}function _W(e){return e.get("coordinateSystem")==="cartesian2d"}function SW(e){var t={xAxisModel:null,yAxisModel:null};return le(t,function(r,n){var i=n.replace(/Model$/,""),a=e.getReferringComponents(i,ao).models[0];t[n]=a}),t}var rk=Math.log;function sSe(e,t,r){var n=Pw.prototype,i=n.getTicks.call(r),a=n.getTicks.call(r,!0),o=i.length-1,s=n.getInterval.call(r),l=gee(e,t),u=l.extent,f=l.fixMin,c=l.fixMax;if(e.type==="log"){var h=rk(e.base);u=[rk(u[0])/h,rk(u[1])/h]}e.setExtent(u[0],u[1]),e.calcNiceExtent({splitNumber:o,fixMin:f,fixMax:c});var d=n.getExtent.call(e);f&&(u[0]=d[0]),c&&(u[1]=d[1]);var v=n.getInterval.call(e),p=u[0],g=u[1];if(f&&c)v=(g-p)/o;else if(f)for(g=u[0]+v*o;g<u[1]&&isFinite(g)&&isFinite(u[1]);)v=XR(v),g=u[0]+v*o;else if(c)for(p=u[1]-v*o;p>u[0]&&isFinite(p)&&isFinite(u[0]);)v=XR(v),p=u[1]-v*o;else{var y=e.getTicks().length-1;y>o&&(v=XR(v));var m=v*o;g=Math.ceil(u[1]/v)*v,p=dn(g-m),p<0&&u[0]>=0?(p=0,g=dn(m)):g>0&&u[1]<=0&&(g=0,p=-dn(m))}var b=(i[0].value-a[0].value)/s,_=(i[o].value-a[o].value)/s;n.setExtent.call(e,p+v*b,g+v*_),n.setInterval.call(e,v),(b||_)&&n.setNiceExtent.call(e,p+v,g-v)}var lSe=function(){function e(t,r,n){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=XI,this._initCartesian(t,r,n),this.model=t}return e.prototype.getRect=function(){return this._rect},e.prototype.update=function(t,r){var n=this._axesMap;this._updateScale(t,this.model);function i(o){var s,l=Dr(o),u=l.length;if(u){for(var f=[],c=u-1;c>=0;c--){var h=+l[c],d=o[h],v=d.model,p=d.scale;GI(p)&&v.get("alignTicks")&&v.get("interval")==null?f.push(d):(zj(p,v),GI(p)&&(s=d))}f.length&&(s||(s=f.pop(),zj(s.scale,s.model)),le(f,function(g){sSe(g.scale,g.model,s.scale)}))}}i(n.x),i(n.y);var a={};le(n.x,function(o){CW(n,"y",o,a)}),le(n.y,function(o){CW(n,"x",o,a)}),this.resize(this.model,r)},e.prototype.resize=function(t,r,n){var i=t.getBoxLayoutParams(),a=!n&&t.get("containLabel"),o=iv(i,{width:r.getWidth(),height:r.getHeight()});this._rect=o;var s=this._axesList;l(),a&&(le(s,function(u){if(!u.model.get(["axisLabel","inside"])){var f=uwe(u);if(f){var c=u.isHorizontal()?"height":"width",h=u.model.get(["axisLabel","margin"]);o[c]-=f[c]+h,u.position==="top"?o.y+=f.height+h:u.position==="left"&&(o.x+=f.width+h)}}}),l()),le(this._coordsList,function(u){u.calcAffineTransform()});function l(){le(s,function(u){var f=u.isHorizontal(),c=f?[0,o.width]:[0,o.height],h=u.inverse?1:0;u.setExtent(c[h],c[1-h]),uSe(u,f?o.x:o.y)})}},e.prototype.getAxis=function(t,r){var n=this._axesMap[t];if(n!=null)return n[r||0]},e.prototype.getAxes=function(){return this._axesList.slice()},e.prototype.getCartesian=function(t,r){if(t!=null&&r!=null){var n="x"+t+"y"+r;return this._coordsMap[n]}dt(t)&&(r=t.yAxisIndex,t=t.xAxisIndex);for(var i=0,a=this._coordsList;i<a.length;i++)if(a[i].getAxis("x").index===t||a[i].getAxis("y").index===r)return a[i]},e.prototype.getCartesians=function(){return this._coordsList.slice()},e.prototype.convertToPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},e.prototype.convertFromPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},e.prototype._findConvertTarget=function(t){var r=t.seriesModel,n=t.xAxisModel||r&&r.getReferringComponents("xAxis",ao).models[0],i=t.yAxisModel||r&&r.getReferringComponents("yAxis",ao).models[0],a=t.gridModel,o=this._coordsList,s,l;if(r)s=r.coordinateSystem,yr(o,s)<0&&(s=null);else if(n&&i)s=this.getCartesian(n.componentIndex,i.componentIndex);else if(n)l=this.getAxis("x",n.componentIndex);else if(i)l=this.getAxis("y",i.componentIndex);else if(a){var u=a.coordinateSystem;u===this&&(s=this._coordsList[0])}return{cartesian:s,axis:l}},e.prototype.containPoint=function(t){var r=this._coordsList[0];if(r)return r.containPoint(t)},e.prototype._initCartesian=function(t,r,n){var i=this,a=this,o={left:!1,right:!1,top:!1,bottom:!1},s={x:{},y:{}},l={x:0,y:0};if(r.eachComponent("xAxis",u("x"),this),r.eachComponent("yAxis",u("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=s,le(s.x,function(f,c){le(s.y,function(h,d){var v="x"+c+"y"+d,p=new iSe(v);p.master=i,p.model=t,i._coordsMap[v]=p,i._coordsList.push(p),p.addAxis(f),p.addAxis(h)})});function u(f){return function(c,h){if(nk(c,t)){var d=c.get("position");f==="x"?d!=="top"&&d!=="bottom"&&(d=o.bottom?"top":"bottom"):d!=="left"&&d!=="right"&&(d=o.left?"right":"left"),o[d]=!0;var v=new oSe(f,swe(c),[0,0],c.get("type"),d),p=v.type==="category";v.onBand=p&&c.get("boundaryGap"),v.inverse=c.get("inverse"),c.axis=v,v.model=c,v.grid=a,v.index=h,a._axesList.push(v),s[f][h]=v,l[f]++}}}},e.prototype._updateScale=function(t,r){le(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var a=i.model.get("categorySortInfo");i.scale.setSortInfo(a)}}),t.eachSeries(function(i){if(_W(i)){var a=SW(i),o=a.xAxisModel,s=a.yAxisModel;if(!nk(o,r)||!nk(s,r))return;var l=this.getCartesian(o.componentIndex,s.componentIndex),u=i.getData(),f=l.getAxis("x"),c=l.getAxis("y");n(u,f),n(u,c)}},this);function n(i,a){le(cwe(i,a.dim),function(o){a.scale.unionExtentFromData(i,o)})}},e.prototype.getTooltipAxes=function(t){var r=[],n=[];return le(this.getCartesians(),function(i){var a=t!=null&&t!=="auto"?i.getAxis(t):i.getBaseAxis(),o=i.getOtherAxis(a);yr(r,a)<0&&r.push(a),yr(n,o)<0&&n.push(o)}),{baseAxes:r,otherAxes:n}},e.create=function(t,r){var n=[];return t.eachComponent("grid",function(i,a){var o=new e(i,t,r);o.name="grid_"+a,o.resize(i,r,!0),i.coordinateSystem=o,n.push(o)}),t.eachSeries(function(i){if(_W(i)){var a=SW(i),o=a.xAxisModel,s=a.yAxisModel,l=o.getCoordSysModel(),u=l.coordinateSystem;i.coordinateSystem=u.getCartesian(o.componentIndex,s.componentIndex)}}),n},e.dimensions=XI,e}();function nk(e,t){return e.getCoordSysModel()===t}function CW(e,t,r,n){r.getAxesOnZeroOf=function(){return a?[a]:[]};var i=e[t],a,o=r.model,s=o.get(["axisLine","onZero"]),l=o.get(["axisLine","onZeroAxisIndex"]);if(!s)return;if(l!=null)xW(i[l])&&(a=i[l]);else for(var u in i)if(i.hasOwnProperty(u)&&xW(i[u])&&!n[f(i[u])]){a=i[u];break}a&&(n[f(a)]=!0);function f(c){return c.dim+"_"+c.index}}function xW(e){return e&&e.type!=="category"&&e.type!=="time"&&lwe(e)}function uSe(e,t){var r=e.getExtent(),n=r[0]+r[1];e.toGlobalCoord=e.dim==="x"?function(i){return i+t}:function(i){return n-i+t},e.toLocalCoord=e.dim==="x"?function(i){return i-t}:function(i){return n-i+t}}const fSe=lSe;var nu=Math.PI,Sc=function(){function e(t,r){this.group=new Kn,this.opt=r,this.axisModel=t,lr(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var n=new Kn({x:r.position[0],y:r.position[1],rotation:r.rotation});n.updateTransform(),this._transformGroup=n}return e.prototype.hasBuilder=function(t){return!!TW[t]},e.prototype.add=function(t){TW[t](this.opt,this.axisModel,this.group,this._transformGroup)},e.prototype.getGroup=function(){return this.group},e.innerTextLayout=function(t,r,n){var i=kZ(r-t),a,o;return ZC(i)?(o=n>0?"top":"bottom",a="center"):ZC(i-nu)?(o=n>0?"bottom":"top",a="center"):(o="middle",i>0&&i<nu?a=n>0?"right":"left":a=n>0?"left":"right"),{rotation:i,textAlign:a,textVerticalAlign:o}},e.makeAxisEventDataBase=function(t){var r={componentType:t.mainType,componentIndex:t.componentIndex};return r[t.mainType+"Index"]=t.componentIndex,r},e.isLabelSilent=function(t){var r=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||r&&r.show)},e}(),TW={axisLine:function(e,t,r,n){var i=t.get(["axisLine","show"]);if(i==="auto"&&e.handleAutoShown&&(i=e.handleAutoShown("axisLine")),!!i){var a=t.axis.getExtent(),o=n.transform,s=[a[0],0],l=[a[1],0],u=s[0]>l[0];o&&(Ra(s,s,o),Ra(l,l,o));var f=Le({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),c=new Pc({shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:f,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1});e0(c.shape,c.style.lineWidth),c.anid="line",r.add(c);var h=t.get(["axisLine","symbol"]);if(h!=null){var d=t.get(["axisLine","symbolSize"]);st(h)&&(h=[h,h]),(st(d)||_r(d))&&(d=[d,d]);var v=RQ(t.get(["axisLine","symbolOffset"])||0,d),p=d[0],g=d[1];le([{rotate:e.rotation+Math.PI/2,offset:v[0],r:0},{rotate:e.rotation-Math.PI/2,offset:v[1],r:Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1]))}],function(y,m){if(h[m]!=="none"&&h[m]!=null){var b=sv(h[m],-p/2,-g/2,p,g,f.stroke,!0),_=y.r+y.offset,x=u?l:s;b.attr({rotation:y.rotate,x:x[0]+_*Math.cos(e.rotation),y:x[1]-_*Math.sin(e.rotation),silent:!0,z2:11}),r.add(b)}})}}},axisTickLabel:function(e,t,r,n){var i=dSe(r,n,t,e),a=pSe(r,n,t,e);if(hSe(t,a,i),vSe(r,n,t,e.tickDirection),t.get(["axisLabel","hideOverlap"])){var o=Awe(pt(a,function(s){return{label:s,priority:s.z2,defaultAttr:{ignore:s.ignore}}}));Mwe(o)}},axisName:function(e,t,r,n){var i=Km(e.axisName,t.get("name"));if(i){var a=t.get("nameLocation"),o=e.nameDirection,s=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,u=t.axis.getExtent(),f=u[0]>u[1]?-1:1,c=[a==="start"?u[0]-f*l:a==="end"?u[1]+f*l:(u[0]+u[1])/2,EW(a)?e.labelOffset+o*l:0],h,d=t.get("nameRotate");d!=null&&(d=d*nu/180);var v;EW(a)?h=Sc.innerTextLayout(e.rotation,d??e.rotation,o):(h=cSe(e.rotation,a,d||0,u),v=e.axisNameAvailableWidth,v!=null&&(v=Math.abs(v/Math.sin(h.rotation)),!isFinite(v)&&(v=null)));var p=s.getFont(),g=t.get("nameTruncate",!0)||{},y=g.ellipsis,m=Km(e.nameTruncateMaxWidth,g.maxWidth,v),b=new Xn({x:c[0],y:c[1],rotation:h.rotation,silent:Sc.isLabelSilent(t),style:Iu(s,{text:i,font:p,overflow:"truncate",width:m,ellipsis:y,fill:s.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:s.get("align")||h.textAlign,verticalAlign:s.get("verticalAlign")||h.textVerticalAlign}),z2:1});if(JN({el:b,componentModel:t,itemName:i}),b.__fullText=i,b.anid="name",t.get("triggerEvent")){var _=Sc.makeAxisEventDataBase(t);_.targetType="axisName",_.name=i,ur(b).eventData=_}n.add(b),b.updateTransform(),r.add(b),b.decomposeTransform()}}};function cSe(e,t,r,n){var i=kZ(r-e),a,o,s=n[0]>n[1],l=t==="start"&&!s||t!=="start"&&s;return ZC(i-nu/2)?(o=l?"bottom":"top",a="center"):ZC(i-nu*1.5)?(o=l?"top":"bottom",a="center"):(o="middle",i<nu*1.5&&i>nu/2?a=l?"left":"right":a=l?"right":"left"),{rotation:i,textAlign:a,textVerticalAlign:o}}function hSe(e,t,r){if(!yee(e.axis)){var n=e.get(["axisLabel","showMinLabel"]),i=e.get(["axisLabel","showMaxLabel"]);t=t||[],r=r||[];var a=t[0],o=t[1],s=t[t.length-1],l=t[t.length-2],u=r[0],f=r[1],c=r[r.length-1],h=r[r.length-2];n===!1?(la(a),la(u)):OW(a,o)&&(n?(la(o),la(f)):(la(a),la(u))),i===!1?(la(s),la(c)):OW(l,s)&&(i?(la(l),la(h)):(la(s),la(c)))}}function la(e){e&&(e.ignore=!0)}function OW(e,t){var r=e&&e.getBoundingRect().clone(),n=t&&t.getBoundingRect().clone();if(!(!r||!n)){var i=kN([]);return AN(i,i,-e.rotation),r.applyTransform(Dd([],i,e.getLocalTransform())),n.applyTransform(Dd([],i,t.getLocalTransform())),r.intersect(n)}}function EW(e){return e==="middle"||e==="center"}function Bee(e,t,r,n,i){for(var a=[],o=[],s=[],l=0;l<e.length;l++){var u=e[l].coord;o[0]=u,o[1]=0,s[0]=u,s[1]=r,t&&(Ra(o,o,t),Ra(s,s,t));var f=new Pc({shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:n,z2:2,autoBatch:!0,silent:!0});e0(f.shape,f.style.lineWidth),f.anid=i+"_"+e[l].tickValue,a.push(f)}return a}function dSe(e,t,r,n){var i=r.axis,a=r.getModel("axisTick"),o=a.get("show");if(o==="auto"&&n.handleAutoShown&&(o=n.handleAutoShown("axisTick")),!(!o||i.scale.isBlank())){for(var s=a.getModel("lineStyle"),l=n.tickDirection*a.get("length"),u=i.getTicksCoords(),f=Bee(u,t.transform,l,lr(s.getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])}),"ticks"),c=0;c<f.length;c++)e.add(f[c]);return f}}function vSe(e,t,r,n){var i=r.axis,a=r.getModel("minorTick");if(!(!a.get("show")||i.scale.isBlank())){var o=i.getMinorTicksCoords();if(o.length)for(var s=a.getModel("lineStyle"),l=n*a.get("length"),u=lr(s.getLineStyle(),lr(r.getModel("axisTick").getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])})),f=0;f<o.length;f++)for(var c=Bee(o[f],t.transform,l,u,"minorticks_"+f),h=0;h<c.length;h++)e.add(c[h])}}function pSe(e,t,r,n){var i=r.axis,a=Km(n.axisLabelShow,r.get(["axisLabel","show"]));if(!(!a||i.scale.isBlank())){var o=r.getModel("axisLabel"),s=o.get("margin"),l=i.getViewLabels(),u=(Km(n.labelRotate,o.get("rotate"))||0)*nu/180,f=Sc.innerTextLayout(n.rotation,u,n.labelDirection),c=r.getCategories&&r.getCategories(!0),h=[],d=Sc.isLabelSilent(r),v=r.get("triggerEvent");return le(l,function(p,g){var y=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(p.tickValue):p.tickValue,m=p.formattedLabel,b=p.rawLabel,_=o;if(c&&c[y]){var x=c[y];dt(x)&&x.textStyle&&(_=new Un(x.textStyle,o,r.ecModel))}var T=_.getTextColor()||r.get(["axisLine","lineStyle","color"]),E=i.dataToCoord(y),P=new Xn({x:E,y:n.labelOffset+n.labelDirection*s,rotation:f.rotation,silent:d,z2:10+(p.level||0),style:Iu(_,{text:m,align:_.getShallow("align",!0)||f.textAlign,verticalAlign:_.getShallow("verticalAlign",!0)||_.getShallow("baseline",!0)||f.textVerticalAlign,fill:Nt(T)?T(i.type==="category"?b:i.type==="value"?y+"":y,g):T})});if(P.anid="label_"+y,v){var R=Sc.makeAxisEventDataBase(r);R.targetType="axisLabel",R.value=b,R.tickIndex=g,i.type==="category"&&(R.dataIndex=y),ur(P).eventData=R}t.add(P),P.updateTransform(),h.push(P),e.add(P),P.decomposeTransform()}),h}}const Vee=Sc;function gSe(e,t){var r={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return ySe(r,e,t),r.seriesInvolved&&bSe(r,e),r}function ySe(e,t,r){var n=t.getComponent("tooltip"),i=t.getComponent("axisPointer"),a=i.get("link",!0)||[],o=[];le(r.getCoordinateSystems(),function(s){if(!s.axisPointerEnabled)return;var l=u0(s.model),u=e.coordSysAxesInfo[l]={};e.coordSysMap[l]=s;var f=s.model,c=f.getModel("tooltip",n);if(le(s.getAxes(),en(p,!1,null)),s.getTooltipAxes&&n&&c.get("show")){var h=c.get("trigger")==="axis",d=c.get(["axisPointer","type"])==="cross",v=s.getTooltipAxes(c.get(["axisPointer","axis"]));(h||d)&&le(v.baseAxes,en(p,d?"cross":!0,h)),d&&le(v.otherAxes,en(p,"cross",!1))}function p(g,y,m){var b=m.model.getModel("axisPointer",i),_=b.get("show");if(!(!_||_==="auto"&&!g&&!ZI(b))){y==null&&(y=b.get("triggerTooltip")),b=g?mSe(m,c,i,t,g,y):b;var x=b.get("snap"),T=u0(m.model),E=y||x||m.type==="category",P=e.axesInfo[T]={key:T,axis:m,coordSys:s,axisPointerModel:b,triggerTooltip:y,involveSeries:E,snap:x,useHandle:ZI(b),seriesModels:[],linkGroup:null};u[T]=P,e.seriesInvolved=e.seriesInvolved||E;var R=wSe(a,m);if(R!=null){var M=o[R]||(o[R]={axesInfo:{}});M.axesInfo[T]=P,M.mapper=a[R].mapper,P.linkGroup=M}}}})}function mSe(e,t,r,n,i,a){var o=t.getModel("axisPointer"),s=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};le(s,function(h){l[h]=Qt(o.get(h))}),l.snap=e.type!=="category"&&!!a,o.get("type")==="cross"&&(l.type="line");var u=l.label||(l.label={});if(u.show==null&&(u.show=!1),i==="cross"){var f=o.get(["label","show"]);if(u.show=f??!0,!a){var c=l.lineStyle=o.get("crossStyle");c&&lr(u,c.textStyle)}}return e.model.getModel("axisPointer",new Un(l,r,n))}function bSe(e,t){t.eachSeries(function(r){var n=r.coordinateSystem,i=r.get(["tooltip","trigger"],!0),a=r.get(["tooltip","show"],!0);!n||i==="none"||i===!1||i==="item"||a===!1||r.get(["axisPointer","show"],!0)===!1||le(e.coordSysAxesInfo[u0(n.model)],function(o){var s=o.axis;n.getAxis(s.dim)===s&&(o.seriesModels.push(r),o.seriesDataCount==null&&(o.seriesDataCount=0),o.seriesDataCount+=r.getData().count())})})}function wSe(e,t){for(var r=t.model,n=t.dim,i=0;i<e.length;i++){var a=e[i]||{};if(ik(a[n+"AxisId"],r.id)||ik(a[n+"AxisIndex"],r.componentIndex)||ik(a[n+"AxisName"],r.name))return i}}function ik(e,t){return e==="all"||et(e)&&yr(e,t)>=0||e===t}function _Se(e){var t=PL(e);if(t){var r=t.axisPointerModel,n=t.axis.scale,i=r.option,a=r.get("status"),o=r.get("value");o!=null&&(o=n.parse(o));var s=ZI(r);a==null&&(i.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(o==null||o>l[1])&&(o=l[1]),o<l[0]&&(o=l[0]),i.value=o,s&&(i.status=t.axis.scale.isBlank()?"hide":"show")}}function PL(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[u0(e)]}function SSe(e){var t=PL(e);return t&&t.axisPointerModel}function ZI(e){return!!e.get(["handle","show"])}function u0(e){return e.type+"||"+e.id}var RW={},CSe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){this.axisPointerClass&&_Se(r),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(r,i,!0)},t.prototype.updateAxisPointer=function(r,n,i,a){this._doUpdateAxisPointerClass(r,i,!1)},t.prototype.remove=function(r,n){var i=this._axisPointer;i&&i.remove(n)},t.prototype.dispose=function(r,n){this._disposeAxisPointer(n),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(r,n,i){var a=t.getAxisPointerClass(this.axisPointerClass);if(a){var o=SSe(r);o?(this._axisPointer||(this._axisPointer=new a)).render(r,o,n,i):this._disposeAxisPointer(n)}},t.prototype._disposeAxisPointer=function(r){this._axisPointer&&this._axisPointer.dispose(r),this._axisPointer=null},t.registerAxisPointerClass=function(r,n){RW[r]=n},t.getAxisPointerClass=function(r){return r&&RW[r]},t.type="axis",t}(cl);const jee=CSe;var JI=pn();function xSe(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitArea"),o=a.getModel("areaStyle"),s=o.get("color"),l=n.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:a,clamp:!0});if(u.length){var f=s.length,c=JI(e).splitAreaColors,h=Vt(),d=0;if(c)for(var v=0;v<u.length;v++){var p=c.get(u[v].tickValue);if(p!=null){d=(p+(f-1)*v)%f;break}}var g=i.toGlobalCoord(u[0].coord),y=o.getAreaStyle();s=et(s)?s:[s];for(var v=1;v<u.length;v++){var m=i.toGlobalCoord(u[v].coord),b=void 0,_=void 0,x=void 0,T=void 0;i.isHorizontal()?(b=g,_=l.y,x=m-b,T=l.height,g=b+x):(b=l.x,_=g,x=l.width,T=m-_,g=_+T);var E=u[v-1].tickValue;E!=null&&h.set(E,d),t.add(new _n({anid:E!=null?"area_"+E:null,shape:{x:b,y:_,width:x,height:T},style:lr({fill:s[d]},y),autoBatch:!0,silent:!0})),d=(d+1)%f}JI(e).splitAreaColors=h}}}function TSe(e){JI(e).splitAreaColors=null}var OSe=["axisLine","axisTickLabel","axisName"],ESe=["splitArea","splitLine","minorSplitLine"],Wee=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="CartesianAxisPointer",r}return t.prototype.render=function(r,n,i,a){this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new Kn,this.group.add(this._axisGroup),!!r.get("show")){var s=r.getCoordSysModel(),l=qI(s,r),u=new Vee(r,Le({handleAutoShown:function(c){for(var h=s.coordinateSystem.getCartesians(),d=0;d<h.length;d++)if(GI(h[d].getOtherAxis(r.axis).scale))return!0;return!1}},l));le(OSe,u.add,u),this._axisGroup.add(u.getGroup()),le(ESe,function(c){r.get([c,"show"])&&RSe[c](this,this._axisGroup,r,s)},this);var f=a&&a.type==="changeAxisOrder"&&a.isInitSort;f||kJ(o,this._axisGroup,r),e.prototype.render.call(this,r,n,i,a)}},t.prototype.remove=function(){TSe(this)},t.type="cartesianAxis",t}(jee),RSe={splitLine:function(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitLine"),o=a.getModel("lineStyle"),s=o.get("color");s=et(s)?s:[s];for(var l=n.coordinateSystem.getRect(),u=i.isHorizontal(),f=0,c=i.getTicksCoords({tickModel:a}),h=[],d=[],v=o.getLineStyle(),p=0;p<c.length;p++){var g=i.toGlobalCoord(c[p].coord);u?(h[0]=g,h[1]=l.y,d[0]=g,d[1]=l.y+l.height):(h[0]=l.x,h[1]=g,d[0]=l.x+l.width,d[1]=g);var y=f++%s.length,m=c[p].tickValue,b=new Pc({anid:m!=null?"line_"+c[p].tickValue:null,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:d[0],y2:d[1]},style:lr({stroke:s[y]},v),silent:!0});e0(b.shape,v.lineWidth),t.add(b)}}},minorSplitLine:function(e,t,r,n){var i=r.axis,a=r.getModel("minorSplitLine"),o=a.getModel("lineStyle"),s=n.coordinateSystem.getRect(),l=i.isHorizontal(),u=i.getMinorTicksCoords();if(u.length)for(var f=[],c=[],h=o.getLineStyle(),d=0;d<u.length;d++)for(var v=0;v<u[d].length;v++){var p=i.toGlobalCoord(u[d][v].coord);l?(f[0]=p,f[1]=s.y,c[0]=p,c[1]=s.y+s.height):(f[0]=s.x,f[1]=p,c[0]=s.x+s.width,c[1]=p);var g=new Pc({anid:"minor_line_"+u[d][v].tickValue,autoBatch:!0,shape:{x1:f[0],y1:f[1],x2:c[0],y2:c[1]},style:h,silent:!0});e0(g.shape,h.lineWidth),t.add(g)}},splitArea:function(e,t,r,n){xSe(e,t,r,n)}},Uee=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="xAxis",t}(Wee),kSe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=Uee.type,r}return t.type="yAxis",t}(Wee),ASe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="grid",r}return t.prototype.render=function(r,n){this.group.removeAll(),r.get("show")&&this.group.add(new _n({shape:r.coordinateSystem.getRect(),style:lr({fill:r.get("backgroundColor")},r.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(cl),kW={offset:0};function PSe(e){e.registerComponentView(ASe),e.registerComponentModel(q_e),e.registerCoordinateSystem("cartesian2d",fSe),mW(e,"x",KI,kW),mW(e,"y",KI,kW),e.registerComponentView(Uee),e.registerComponentView(kSe),e.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}var Lf=pn(),AW=Qt,ak=Or,ISe=function(){function e(){this._dragging=!1,this.animationThreshold=15}return e.prototype.render=function(t,r,n,i){var a=r.get("value"),o=r.get("status");if(this._axisModel=t,this._axisPointerModel=r,this._api=n,!(!i&&this._lastValue===a&&this._lastStatus===o)){this._lastValue=a,this._lastStatus=o;var s=this._group,l=this._handle;if(!o||o==="hide"){s&&s.hide(),l&&l.hide();return}s&&s.show(),l&&l.show();var u={};this.makeElOption(u,a,t,r,n);var f=u.graphicKey;f!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=f;var c=this._moveAnimation=this.determineAnimation(t,r);if(!s)s=this._group=new Kn,this.createPointerEl(s,u,t,r),this.createLabelEl(s,u,t,r),n.getZr().add(s);else{var h=en(PW,r,c);this.updatePointerEl(s,u,h),this.updateLabelEl(s,u,h,r)}MW(s,r,!0),this._renderHandle(a)}},e.prototype.remove=function(t){this.clear(t)},e.prototype.dispose=function(t){this.clear(t)},e.prototype.determineAnimation=function(t,r){var n=r.get("animation"),i=t.axis,a=i.type==="category",o=r.get("snap");if(!o&&!a)return!1;if(n==="auto"||n==null){var s=this.animationThreshold;if(a&&i.getBandWidth()>s)return!0;if(o){var l=PL(t).seriesDataCount,u=i.getExtent();return Math.abs(u[0]-u[1])/l>s}return!1}return n===!0},e.prototype.makeElOption=function(t,r,n,i,a){},e.prototype.createPointerEl=function(t,r,n,i){var a=r.pointer;if(a){var o=Lf(t).pointerEl=new Mge[a.type](AW(r.pointer));t.add(o)}},e.prototype.createLabelEl=function(t,r,n,i){if(r.label){var a=Lf(t).labelEl=new Xn(AW(r.label));t.add(a),IW(a,i)}},e.prototype.updatePointerEl=function(t,r,n){var i=Lf(t).pointerEl;i&&r.pointer&&(i.setStyle(r.pointer.style),n(i,{shape:r.pointer.shape}))},e.prototype.updateLabelEl=function(t,r,n,i){var a=Lf(t).labelEl;a&&(a.setStyle(r.label.style),n(a,{x:r.label.x,y:r.label.y}),IW(a,i))},e.prototype._renderHandle=function(t){if(!(this._dragging||!this.updateHandleTransform)){var r=this._axisPointerModel,n=this._api.getZr(),i=this._handle,a=r.getModel("handle"),o=r.get("status");if(!a.get("show")||!o||o==="hide"){i&&n.remove(i),this._handle=null;return}var s;this._handle||(s=!0,i=this._handle=ZN(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(u){sZ(u.event)},onmousedown:ak(this._onHandleDragMove,this,0,0),drift:ak(this._onHandleDragMove,this),ondragend:ak(this._onHandleDragEnd,this)}),n.add(i)),MW(i,r,!1),i.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=a.get("size");et(l)||(l=[l,l]),i.scaleX=l[0]/2,i.scaleY=l[1]/2,wQ(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,s)}},e.prototype._moveHandleToValue=function(t,r){PW(this._axisPointerModel,!r&&this._moveAnimation,this._handle,ok(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},e.prototype._onHandleDragMove=function(t,r){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(ok(n),[t,r],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(ok(i)),Lf(n).lastProp=null,this._doDispatchAxisPointer()}},e.prototype._doDispatchAxisPointer=function(){var t=this._handle;if(t){var r=this._payloadInfo,n=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:r.cursorPoint[0],y:r.cursorPoint[1],tooltipOption:r.tooltipOption,axesInfo:[{axisDim:n.axis.dim,axisIndex:n.componentIndex}]})}},e.prototype._onHandleDragEnd=function(){this._dragging=!1;var t=this._handle;if(t){var r=this._axisPointerModel.get("value");this._moveHandleToValue(r),this._api.dispatchAction({type:"hideTip"})}},e.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var r=t.getZr(),n=this._group,i=this._handle;r&&n&&(this._lastGraphicKey=null,n&&r.remove(n),i&&r.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),NI(this,"_doDispatchAxisPointer")},e.prototype.doClear=function(){},e.prototype.buildLabel=function(t,r,n){return n=n||0,{x:t[n],y:t[1-n],width:r[n],height:r[1-n]}},e}();function PW(e,t,r,n){zee(Lf(r).lastProp,n)||(Lf(r).lastProp=n,t?mi(r,n,e):(r.stopAnimation(),r.attr(n)))}function zee(e,t){if(dt(e)&&dt(t)){var r=!0;return le(t,function(n,i){r=r&&zee(e[i],n)}),!!r}else return e===t}function IW(e,t){e[t.get(["label","show"])?"show":"hide"]()}function ok(e){return{x:e.x||0,y:e.y||0,rotation:e.rotation||0}}function MW(e,t,r){var n=t.get("z"),i=t.get("zlevel");e&&e.traverse(function(a){a.type!=="group"&&(n!=null&&(a.z=n),i!=null&&(a.zlevel=i),a.silent=r)})}const MSe=ISe;function DSe(e){var t=e.get("type"),r=e.getModel(t+"Style"),n;return t==="line"?(n=r.getLineStyle(),n.fill=null):t==="shadow"&&(n=r.getAreaStyle(),n.stroke=null),n}function $Se(e,t,r,n,i){var a=r.get("value"),o=Gee(a,t.axis,t.ecModel,r.get("seriesDataIndices"),{precision:r.get(["label","precision"]),formatter:r.get(["label","formatter"])}),s=r.getModel("label"),l=vO(s.get("padding")||0),u=s.getFont(),f=DN(o,u),c=i.position,h=f.width+l[1]+l[3],d=f.height+l[0]+l[2],v=i.align;v==="right"&&(c[0]-=h),v==="center"&&(c[0]-=h/2);var p=i.verticalAlign;p==="bottom"&&(c[1]-=d),p==="middle"&&(c[1]-=d/2),NSe(c,h,d,n);var g=s.get("backgroundColor");(!g||g==="auto")&&(g=t.get(["axisLine","lineStyle","color"])),e.label={x:c[0],y:c[1],style:Iu(s,{text:o,font:u,fill:s.getTextColor(),padding:l,backgroundColor:g}),z2:10}}function NSe(e,t,r,n){var i=n.getWidth(),a=n.getHeight();e[0]=Math.min(e[0]+t,i)-t,e[1]=Math.min(e[1]+r,a)-r,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}function Gee(e,t,r,n,i){e=t.scale.parse(e);var a=t.scale.getLabel({value:e},{precision:i.precision}),o=i.formatter;if(o){var s={value:TL(t,{value:e}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};le(n,function(l){var u=r.getSeriesByIndex(l.seriesIndex),f=l.dataIndexInside,c=u&&u.getDataParams(f);c&&s.seriesData.push(c)}),st(o)?a=o.replace("{value}",a):Nt(o)&&(a=o(s))}return a}function Yee(e,t,r){var n=Xm();return AN(n,n,r.rotation),aI(n,n,r.position),qN([e.dataToCoord(t),(r.labelOffset||0)+(r.labelDirection||1)*(r.labelMargin||0)],n)}function LSe(e,t,r,n,i,a){var o=Vee.innerTextLayout(r.rotation,0,r.labelDirection);r.labelMargin=i.get(["label","margin"]),$Se(t,n,i,a,{position:Yee(n.axis,e,r),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function FSe(e,t,r){return r=r||0,{x1:e[r],y1:e[1-r],x2:t[r],y2:t[1-r]}}function HSe(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}}var BSe=function(e){Ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,i,a,o){var s=i.axis,l=s.grid,u=a.get("type"),f=DW(l,s).getOtherAxis(s).getGlobalExtent(),c=s.toGlobalCoord(s.dataToCoord(n,!0));if(u&&u!=="none"){var h=DSe(a),d=VSe[u](s,c,f);d.style=h,r.graphicKey=d.type,r.pointer=d}var v=qI(l.model,i);LSe(n,r,v,i,a,o)},t.prototype.getHandleTransform=function(r,n,i){var a=qI(n.axis.grid.model,n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var o=Yee(n.axis,r,a);return{x:o[0],y:o[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,n,i,a){var o=i.axis,s=o.grid,l=o.getGlobalExtent(!0),u=DW(s,o).getOtherAxis(o).getGlobalExtent(),f=o.dim==="x"?0:1,c=[r.x,r.y];c[f]+=n[f],c[f]=Math.min(l[1],c[f]),c[f]=Math.max(l[0],c[f]);var h=(u[1]+u[0])/2,d=[h,h];d[f]=c[f];var v=[{verticalAlign:"middle"},{align:"center"}];return{x:c[0],y:c[1],rotation:r.rotation,cursorPoint:d,tooltipOption:v[f]}},t}(MSe);function DW(e,t){var r={};return r[t.dim+"AxisIndex"]=t.index,e.getCartesian(r)}var VSe={line:function(e,t,r){var n=FSe([t,r[0]],[t,r[1]],$W(e));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(e,t,r){var n=Math.max(1,e.getBandWidth()),i=r[1]-r[0];return{type:"Rect",shape:HSe([t-n/2,r[0]],[n,i],$W(e))}}};function $W(e){return e.dim==="x"?0:1}const jSe=BSe;var WSe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}(Pr);const USe=WSe;var Rs=pn(),zSe=le;function Kee(e,t,r){if(!Bt.node){var n=t.getZr();Rs(n).records||(Rs(n).records={}),GSe(n,t);var i=Rs(n).records[e]||(Rs(n).records[e]={});i.handler=r}}function GSe(e,t){if(Rs(e).initialized)return;Rs(e).initialized=!0,r("click",en(NW,"click")),r("mousemove",en(NW,"mousemove")),r("globalout",KSe);function r(n,i){e.on(n,function(a){var o=XSe(t);zSe(Rs(e).records,function(s){s&&i(s,a,o.dispatchAction)}),YSe(o.pendings,t)})}}function YSe(e,t){var r=e.showTip.length,n=e.hideTip.length,i;r?i=e.showTip[r-1]:n&&(i=e.hideTip[n-1]),i&&(i.dispatchAction=null,t.dispatchAction(i))}function KSe(e,t,r){e.handler("leave",null,r)}function NW(e,t,r,n){t.handler(e,r,n)}function XSe(e){var t={showTip:[],hideTip:[]},r=function(n){var i=t[n.type];i?i.push(n):(n.dispatchAction=r,e.dispatchAction(n))};return{dispatchAction:r,pendings:t}}function QI(e,t){if(!Bt.node){var r=t.getZr(),n=(Rs(r).records||{})[e];n&&(Rs(r).records[e]=null)}}var qSe=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=n.getComponent("tooltip"),o=r.get("triggerOn")||a&&a.get("triggerOn")||"mousemove|click";Kee("axisPointer",i,function(s,l,u){o!=="none"&&(s==="leave"||o.indexOf(s)>=0)&&u({type:"updateAxisPointer",currTrigger:s,x:l&&l.offsetX,y:l&&l.offsetY})})},t.prototype.remove=function(r,n){QI("axisPointer",n)},t.prototype.dispose=function(r,n){QI("axisPointer",n)},t.type="axisPointer",t}(cl);const ZSe=qSe;function Xee(e,t){var r=[],n=e.seriesIndex,i;if(n==null||!(i=t.getSeriesByIndex(n)))return{point:[]};var a=i.getData(),o=Ac(a,e);if(o==null||o<0||et(o))return{point:[]};var s=a.getItemGraphicEl(o),l=i.coordinateSystem;if(i.getTooltipPosition)r=i.getTooltipPosition(o)||[];else if(l&&l.dataToPoint)if(e.isStacked){var u=l.getBaseAxis(),f=l.getOtherAxis(u),c=f.dim,h=u.dim,d=c==="x"||c==="radius"?1:0,v=a.mapDimension(h),p=[];p[d]=a.get(v,o),p[1-d]=a.get(a.getCalculationInfo("stackResultDimension"),o),r=l.dataToPoint(p)||[]}else r=l.dataToPoint(a.getValues(pt(l.dimensions,function(y){return a.mapDimension(y)}),o))||[];else if(s){var g=s.getBoundingRect().clone();g.applyTransform(s.transform),r=[g.x+g.width/2,g.y+g.height/2]}return{point:r,el:s}}var LW=pn();function JSe(e,t,r){var n=e.currTrigger,i=[e.x,e.y],a=e,o=e.dispatchAction||Or(r.dispatchAction,r),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){X1(i)&&(i=Xee({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},t).point);var l=X1(i),u=a.axesInfo,f=s.axesInfo,c=n==="leave"||X1(i),h={},d={},v={list:[],map:{}},p={showPointer:en(e1e,d),showTooltip:en(t1e,v)};le(s.coordSysMap,function(y,m){var b=l||y.containPoint(i);le(s.coordSysAxesInfo[m],function(_,x){var T=_.axis,E=a1e(u,_);if(!c&&b&&(!u||E)){var P=E&&E.value;P==null&&!l&&(P=T.pointToData(i)),P!=null&&FW(_,P,p,!1,h)}})});var g={};return le(f,function(y,m){var b=y.linkGroup;b&&!d[m]&&le(b.axesInfo,function(_,x){var T=d[x];if(_!==y&&T){var E=T.value;b.mapper&&(E=y.axis.scale.parse(b.mapper(E,HW(_),HW(y)))),g[y.key]=E}})}),le(g,function(y,m){FW(f[m],y,p,!0,h)}),r1e(d,f,h),n1e(v,i,e,o),i1e(f,o,r),h}}function FW(e,t,r,n,i){var a=e.axis;if(!(a.scale.isBlank()||!a.containData(t))){if(!e.involveSeries){r.showPointer(e,t);return}var o=QSe(t,e),s=o.payloadBatch,l=o.snapToValue;s[0]&&i.seriesIndex==null&&Le(i,s[0]),!n&&e.snap&&a.containData(l)&&l!=null&&(t=l),r.showPointer(e,t,s),r.showTooltip(e,o,l)}}function QSe(e,t){var r=t.axis,n=r.dim,i=e,a=[],o=Number.MAX_VALUE,s=-1;return le(t.seriesModels,function(l,u){var f=l.getData().mapDimensionsAll(n),c,h;if(l.getAxisTooltipData){var d=l.getAxisTooltipData(f,e,r);h=d.dataIndices,c=d.nestestValue}else{if(h=l.getData().indicesOfNearest(f[0],e,r.type==="category"?.5:null),!h.length)return;c=l.getData().get(f[0],h[0])}if(!(c==null||!isFinite(c))){var v=e-c,p=Math.abs(v);p<=o&&((p<o||v>=0&&s<0)&&(o=p,s=v,i=c,a.length=0),le(h,function(g){a.push({seriesIndex:l.seriesIndex,dataIndexInside:g,dataIndex:l.getData().getRawIndex(g)})}))}}),{payloadBatch:a,snapToValue:i}}function e1e(e,t,r,n){e[t.key]={value:r,payloadBatch:n}}function t1e(e,t,r,n){var i=r.payloadBatch,a=t.axis,o=a.model,s=t.axisPointerModel;if(!(!t.triggerTooltip||!i.length)){var l=t.coordSys.model,u=u0(l),f=e.map[u];f||(f=e.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(f)),f.dataByAxis.push({axisDim:a.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:n,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function r1e(e,t,r){var n=r.axesInfo=[];le(t,function(i,a){var o=i.axisPointerModel.option,s=e[a];s?(!i.useHandle&&(o.status="show"),o.value=s.value,o.seriesDataIndices=(s.payloadBatch||[]).slice()):!i.useHandle&&(o.status="hide"),o.status==="show"&&n.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:o.value})})}function n1e(e,t,r,n){if(X1(t)||!e.list.length){n({type:"hideTip"});return}var i=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:r.tooltipOption,position:r.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:e.list})}function i1e(e,t,r){var n=r.getZr(),i="axisPointerLastHighlights",a=LW(n)[i]||{},o=LW(n)[i]={};le(e,function(u,f){var c=u.axisPointerModel.option;c.status==="show"&&le(c.seriesDataIndices,function(h){var d=h.seriesIndex+" | "+h.dataIndex;o[d]=h})});var s=[],l=[];le(a,function(u,f){!o[f]&&l.push(u)}),le(o,function(u,f){!a[f]&&s.push(u)}),l.length&&r.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&r.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}function a1e(e,t){for(var r=0;r<(e||[]).length;r++){var n=e[r];if(t.axis.dim===n.axisDim&&t.axis.model.componentIndex===n.axisIndex)return n}}function HW(e){var t=e.axis.model,r={},n=r.axisDim=e.axis.dim;return r.axisIndex=r[n+"AxisIndex"]=t.componentIndex,r.axisName=r[n+"AxisName"]=t.name,r.axisId=r[n+"AxisId"]=t.id,r}function X1(e){return!e||e[0]==null||isNaN(e[0])||e[1]==null||isNaN(e[1])}function qee(e){jee.registerAxisPointerClass("CartesianAxisPointer",jSe),e.registerComponentModel(USe),e.registerComponentView(ZSe),e.registerPreprocessor(function(t){if(t){(!t.axisPointer||t.axisPointer.length===0)&&(t.axisPointer={});var r=t.axisPointer.link;r&&!et(r)&&(t.axisPointer.link=[r])}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,function(t,r){t.getComponent("axisPointer").coordSysAxesInfo=gSe(t,r)}),e.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},JSe)}function o1e(e){Du(PSe),Du(qee)}function s1e(e,t){var r=vO(t.get("padding")),n=t.getItemStyle(["color","opacity"]);return n.fill=t.get("backgroundColor"),e=new _n({shape:{x:e.x-r[3],y:e.y-r[0],width:e.width+r[1]+r[3],height:e.height+r[0]+r[2],r:t.get("borderRadius")},style:n,silent:!0,z2:-1}),e}var l1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}(Pr);const u1e=l1e;function Zee(e){var t=e.get("confine");return t!=null?!!t:e.get("renderMode")==="richText"}function Jee(e){if(Bt.domSupported){for(var t=document.documentElement.style,r=0,n=e.length;r<n;r++)if(e[r]in t)return e[r]}}var Qee=Jee(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),f1e=Jee(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function ete(e,t){if(!e)return t;t=zJ(t,!0);var r=e.indexOf(t);return e=r===-1?t:"-"+e.slice(0,r)+"-"+t,e.toLowerCase()}function c1e(e,t){var r=e.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(e);return r?t?r[t]:r:null}var h1e=ete(f1e,"transition"),IL=ete(Qee,"transform"),d1e="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(Bt.transform3dSupported?"will-change:transform;":"");function v1e(e){return e=e==="left"?"right":e==="right"?"left":e==="top"?"bottom":"top",e}function p1e(e,t,r){if(!st(r)||r==="inside")return"";var n=e.get("backgroundColor"),i=e.get("borderWidth");t=Ic(t);var a=v1e(r),o=Math.max(Math.round(i)*1.5,6),s="",l=IL+":",u;yr(["left","right"],a)>-1?(s+="top:50%",l+="translateY(-50%) rotate("+(u=a==="left"?-225:-45)+"deg)"):(s+="left:50%",l+="translateX(-50%) rotate("+(u=a==="top"?225:45)+"deg)");var f=u*Math.PI/180,c=o+i,h=c*Math.abs(Math.cos(f))+c*Math.abs(Math.sin(f)),d=Math.round(((h-Math.SQRT2*i)/2+Math.SQRT2*i-(h-c)/2)*100)/100;s+=";"+a+":-"+d+"px";var v=t+" solid "+i+"px;",p=["position:absolute;width:"+o+"px;height:"+o+"px;z-index:-1;",s+";"+l+";","border-bottom:"+v,"border-right:"+v,"background-color:"+n+";"];return'<div style="'+p.join("")+'"></div>'}function g1e(e,t){var r="cubic-bezier(0.23,1,0.32,1)",n=" "+e/2+"s "+r,i="opacity"+n+",visibility"+n;return t||(n=" "+e+"s "+r,i+=Bt.transformSupported?","+IL+n:",left"+n+",top"+n),h1e+":"+i}function BW(e,t,r){var n=e.toFixed(0)+"px",i=t.toFixed(0)+"px";if(!Bt.transformSupported)return r?"top:"+i+";left:"+n+";":[["top",i],["left",n]];var a=Bt.transform3dSupported,o="translate"+(a?"3d":"")+"("+n+","+i+(a?",0":"")+")";return r?"top:0;left:0;"+IL+":"+o+";":[["top",0],["left",0],[Qee,o]]}function y1e(e){var t=[],r=e.get("fontSize"),n=e.getTextColor();n&&t.push("color:"+n),t.push("font:"+e.getFont()),r&&t.push("line-height:"+Math.round(r*3/2)+"px");var i=e.get("textShadowColor"),a=e.get("textShadowBlur")||0,o=e.get("textShadowOffsetX")||0,s=e.get("textShadowOffsetY")||0;return i&&a&&t.push("text-shadow:"+o+"px "+s+"px "+a+"px "+i),le(["decoration","align"],function(l){var u=e.get(l);u&&t.push("text-"+l+":"+u)}),t.join(";")}function m1e(e,t,r){var n=[],i=e.get("transitionDuration"),a=e.get("backgroundColor"),o=e.get("shadowBlur"),s=e.get("shadowColor"),l=e.get("shadowOffsetX"),u=e.get("shadowOffsetY"),f=e.getModel("textStyle"),c=mQ(e,"html"),h=l+"px "+u+"px "+o+"px "+s;return n.push("box-shadow:"+h),t&&i&&n.push(g1e(i,r)),a&&n.push("background-color:"+a),le(["width","color","radius"],function(d){var v="border-"+d,p=zJ(v),g=e.get(p);g!=null&&n.push(v+":"+g+(d==="color"?"":"px"))}),n.push(y1e(f)),c!=null&&n.push("padding:"+vO(c).join("px ")+"px"),n.join(";")+";"}function VW(e,t,r,n,i){var a=t&&t.painter;if(r){var o=a&&a.getViewportRoot();o&&Ihe(e,o,document.body,n,i)}else{e[0]=n,e[1]=i;var s=a&&a.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var b1e=function(){function e(t,r,n){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,Bt.wxa)return null;var i=document.createElement("div");i.domBelongToZr=!0,this.el=i;var a=this._zr=r.getZr(),o=this._appendToBody=n&&n.appendToBody;VW(this._styleCoord,a,o,r.getWidth()/2,r.getHeight()/2),o?document.body.appendChild(i):t.appendChild(i),this._container=t;var s=this;i.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},i.onmousemove=function(l){if(l=l||window.event,!s._enterable){var u=a.handler,f=a.painter.getViewportRoot();pa(f,l,!0),u.dispatch("mousemove",l)}},i.onmouseleave=function(){s._inContent=!1,s._enterable&&s._show&&s.hideLater(s._hideDelay)}}return e.prototype.update=function(t){var r=this._container,n=c1e(r,"position"),i=r.style;i.position!=="absolute"&&n!=="absolute"&&(i.position="relative");var a=t.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=t.get("className")||""},e.prototype.show=function(t,r){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var n=this.el,i=n.style,a=this._styleCoord;n.innerHTML?i.cssText=d1e+m1e(t,!this._firstShow,this._longHide)+BW(a[0],a[1],!0)+("border-color:"+Ic(r)+";")+(t.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},e.prototype.setContent=function(t,r,n,i,a){var o=this.el;if(t==null){o.innerHTML="";return}var s="";if(st(a)&&n.get("trigger")==="item"&&!Zee(n)&&(s=p1e(n,i,a)),st(t))o.innerHTML=t+s;else if(t){o.innerHTML="",et(t)||(t=[t]);for(var l=0;l<t.length;l++)jC(t[l])&&t[l].parentNode!==o&&o.appendChild(t[l]);if(s&&o.childNodes.length){var u=document.createElement("div");u.innerHTML=s,o.appendChild(u)}}},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el;return[t.offsetWidth,t.offsetHeight]},e.prototype.moveTo=function(t,r){var n=this._styleCoord;if(VW(n,this._zr,this._appendToBody,t,r),n[0]!=null&&n[1]!=null){var i=this.el.style,a=BW(n[0],n[1]);le(a,function(o){i[o[0]]=o[1]})}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){var t=this,r=this.el.style;r.visibility="hidden",r.opacity="0",Bt.transform3dSupported&&(r.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(Or(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},e}();const w1e=b1e;var _1e=function(){function e(t){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=t.getZr(),WW(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return e.prototype.update=function(t){var r=t.get("alwaysShowContent");r&&this._moveIfResized(),this._alwaysShowContent=r},e.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},e.prototype.setContent=function(t,r,n,i,a){var o=this;dt(t)&&Pi(""),this.el&&this._zr.remove(this.el);var s=n.getModel("textStyle");this.el=new Xn({style:{rich:r.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:s.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:mQ(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),le(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(u){o.el.style[u]=n.get(u)}),le(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(u){o.el.style[u]=s.get(u)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el,r=this.el.getBoundingRect(),n=jW(t.style);return[r.width+n.left+n.right,r.height+n.top+n.bottom]},e.prototype.moveTo=function(t,r){var n=this.el;if(n){var i=this._styleCoord;WW(i,this._zr,t,r),t=i[0],r=i[1];var a=n.style,o=Gl(a.borderWidth||0),s=jW(a);n.x=t+o+s.left,n.y=r+o+s.top,n.markRedraw()}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(Or(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this._zr.remove(this.el)},e}();function Gl(e){return Math.max(0,e)}function jW(e){var t=Gl(e.shadowBlur||0),r=Gl(e.shadowOffsetX||0),n=Gl(e.shadowOffsetY||0);return{left:Gl(t-r),right:Gl(t+r),top:Gl(t-n),bottom:Gl(t+n)}}function WW(e,t,r,n){e[0]=r,e[1]=n,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}const S1e=_1e;var C1e=new _n({shape:{x:-1,y:-1,width:2,height:2}}),x1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){if(!(Bt.node||!n.getDom())){var i=r.getComponent("tooltip"),a=this._renderMode=dve(i.get("renderMode"));this._tooltipContent=a==="richText"?new S1e(n):new w1e(n.getDom(),n,{appendToBody:i.get("appendToBody",!0)})}},t.prototype.render=function(r,n,i){if(!(Bt.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=r,this._ecModel=n,this._api=i;var a=this._tooltipContent;a.update(r),a.setEnterable(r.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&r.get("transitionDuration")?wQ(this,"_updatePosition",50,"fixRate"):NI(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var r=this._tooltipModel,n=r.get("triggerOn");Kee("itemTooltip",this._api,Or(function(i,a,o){n!=="none"&&(n.indexOf(i)>=0?this._tryShow(a,o):i==="leave"&&this._hide(o))},this))},t.prototype._keepShow=function(){var r=this._tooltipModel,n=this._ecModel,i=this._api,a=r.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&o.manuallyShowTip(r,n,i,{x:o._lastX,y:o._lastY,dataByCoordSys:o._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(r,n,i,a){if(!(a.from===this.uid||Bt.node||!i.getDom())){var o=UW(a,i);this._ticket="";var s=a.dataByCoordSys,l=R1e(a,n,i);if(l){var u=l.el.getBoundingRect().clone();u.applyTransform(l.el.transform),this._tryShow({offsetX:u.x+u.width/2,offsetY:u.y+u.height/2,target:l.el,position:a.position,positionDefault:"bottom"},o)}else if(a.tooltip&&a.x!=null&&a.y!=null){var f=C1e;f.x=a.x,f.y=a.y,f.update(),ur(f).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:f},o)}else if(s)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:s,tooltipOption:a.tooltipOption},o);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(r,n,i,a))return;var c=Xee(a,n),h=c.point[0],d=c.point[1];h!=null&&d!=null&&this._tryShow({offsetX:h,offsetY:d,target:c.el,position:a.position,positionDefault:"bottom"},o)}else a.x!=null&&a.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:i.getZr().findHover(a.x,a.y).target},o))}},t.prototype.manuallyHideTip=function(r,n,i,a){var o=this._tooltipContent;this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(UW(a,i))},t.prototype._manuallyAxisShowTip=function(r,n,i,a){var o=a.seriesIndex,s=a.dataIndex,l=n.getComponent("axisPointer").coordSysAxesInfo;if(!(o==null||s==null||l==null)){var u=n.getSeriesByIndex(o);if(u){var f=u.getData(),c=sy([f.getItemModel(s),u,(u.coordinateSystem||{}).model],this._tooltipModel);if(c.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:s,position:a.position}),!0}}},t.prototype._tryShow=function(r,n){var i=r.target,a=this._tooltipModel;if(a){this._lastX=r.offsetX,this._lastY=r.offsetY;var o=r.dataByCoordSys;if(o&&o.length)this._showAxisTooltip(o,r);else if(i){this._lastDataByCoordSys=null;var s,l;Ky(i,function(u){if(ur(u).dataIndex!=null)return s=u,!0;if(ur(u).tooltipConfig!=null)return l=u,!0},!0),s?this._showSeriesItemTooltip(r,s,n):l?this._showComponentItemTooltip(r,l,n):this._hide(n)}else this._lastDataByCoordSys=null,this._hide(n)}},t.prototype._showOrMove=function(r,n){var i=r.get("showDelay");n=Or(n,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(n,i):n()},t.prototype._showAxisTooltip=function(r,n){var i=this._ecModel,a=this._tooltipModel,o=[n.offsetX,n.offsetY],s=sy([n.tooltipOption],a),l=this._renderMode,u=[],f=a0("section",{blocks:[],noHeader:!0}),c=[],h=new LR;le(r,function(m){le(m.dataByAxis,function(b){var _=i.getComponent(b.axisDim+"Axis",b.axisIndex),x=b.value;if(!(!_||x==null)){var T=Gee(x,_.axis,i,b.seriesDataIndices,b.valueLabelOpt),E=a0("section",{header:T,noHeader:!Uo(T),sortBlocks:!0,blocks:[]});f.blocks.push(E),le(b.seriesDataIndices,function(P){var R=i.getSeriesByIndex(P.seriesIndex),M=P.dataIndexInside,D=R.getDataParams(M);if(!(D.dataIndex<0)){D.axisDim=b.axisDim,D.axisIndex=b.axisIndex,D.axisType=b.axisType,D.axisId=b.axisId,D.axisValue=TL(_.axis,{value:x}),D.axisValueLabel=T,D.marker=h.makeTooltipMarker("item",Ic(D.color),l);var N=ej(R.formatTooltip(M,!0,null)),B=N.frag;if(B){var K=sy([R],a).get("valueFormatter");E.blocks.push(K?Le({valueFormatter:K},B):B)}N.text&&c.push(N.text),u.push(D)}})}})}),f.blocks.reverse(),c.reverse();var d=n.position,v=s.get("order"),p=aj(f,h,l,v,i.get("useUTC"),s.get("textStyle"));p&&c.unshift(p);var g=l==="richText"?`

`:"<br/>",y=c.join(g);this._showOrMove(s,function(){this._updateContentNotChangedOnAxis(r,u)?this._updatePosition(s,d,o[0],o[1],this._tooltipContent,u):this._showTooltipContent(s,y,u,Math.random()+"",o[0],o[1],d,null,h)})},t.prototype._showSeriesItemTooltip=function(r,n,i){var a=this._ecModel,o=ur(n),s=o.seriesIndex,l=a.getSeriesByIndex(s),u=o.dataModel||l,f=o.dataIndex,c=o.dataType,h=u.getData(c),d=this._renderMode,v=r.positionDefault,p=sy([h.getItemModel(f),u,l&&(l.coordinateSystem||{}).model],this._tooltipModel,v?{position:v}:null),g=p.get("trigger");if(!(g!=null&&g!=="item")){var y=u.getDataParams(f,c),m=new LR;y.marker=m.makeTooltipMarker("item",Ic(y.color),d);var b=ej(u.formatTooltip(f,!1,c)),_=p.get("order"),x=p.get("valueFormatter"),T=b.frag,E=T?aj(x?Le({valueFormatter:x},T):T,m,d,_,a.get("useUTC"),p.get("textStyle")):b.text,P="item_"+u.name+"_"+f;this._showOrMove(p,function(){this._showTooltipContent(p,E,y,P,r.offsetX,r.offsetY,r.position,r.target,m)}),i({type:"showTip",dataIndexInside:f,dataIndex:h.getRawIndex(f),seriesIndex:s,from:this.uid})}},t.prototype._showComponentItemTooltip=function(r,n,i){var a=ur(n),o=a.tooltipConfig,s=o.option||{};if(st(s)){var l=s;s={content:l,formatter:l}}var u=[s],f=this._ecModel.getComponent(a.componentMainType,a.componentIndex);f&&u.push(f),u.push({formatter:s.content});var c=r.positionDefault,h=sy(u,this._tooltipModel,c?{position:c}:null),d=h.get("content"),v=Math.random()+"",p=new LR;this._showOrMove(h,function(){var g=Qt(h.get("formatterParams")||{});this._showTooltipContent(h,d,g,v,r.offsetX,r.offsetY,r.position,n,p)}),i({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(r,n,i,a,o,s,l,u,f){if(this._ticket="",!(!r.get("showContent")||!r.get("show"))){var c=this._tooltipContent;c.setEnterable(r.get("enterable"));var h=r.get("formatter");l=l||r.get("position");var d=n,v=this._getNearestPoint([o,s],i,r.get("trigger"),r.get("borderColor")),p=v.color;if(h)if(st(h)){var g=r.ecModel.get("useUTC"),y=et(i)?i[0]:i,m=y&&y.axisType&&y.axisType.indexOf("time")>=0;d=h,m&&(d=uO(y.axisValue,d,g)),d=GJ(d,i,!0)}else if(Nt(h)){var b=Or(function(_,x){_===this._ticket&&(c.setContent(x,f,r,p,l),this._updatePosition(r,l,o,s,c,i,u))},this);this._ticket=a,d=h(i,a,b)}else d=h;c.setContent(d,f,r,p,l),c.show(r,p),this._updatePosition(r,l,o,s,c,i,u)}},t.prototype._getNearestPoint=function(r,n,i,a){if(i==="axis"||et(n))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!et(n))return{color:a||n.color||n.borderColor}},t.prototype._updatePosition=function(r,n,i,a,o,s,l){var u=this._api.getWidth(),f=this._api.getHeight();n=n||r.get("position");var c=o.getSize(),h=r.get("align"),d=r.get("verticalAlign"),v=l&&l.getBoundingRect().clone();if(l&&v.applyTransform(l.transform),Nt(n)&&(n=n([i,a],s,o.el,v,{viewSize:[u,f],contentSize:c.slice()})),et(n))i=Mr(n[0],u),a=Mr(n[1],f);else if(dt(n)){var p=n;p.width=c[0],p.height=c[1];var g=iv(p,{width:u,height:f});i=g.x,a=g.y,h=null,d=null}else if(st(n)&&l){var y=E1e(n,v,c,r.get("borderWidth"));i=y[0],a=y[1]}else{var y=T1e(i,a,o,u,f,h?null:20,d?null:20);i=y[0],a=y[1]}if(h&&(i-=zW(h)?c[0]/2:h==="right"?c[0]:0),d&&(a-=zW(d)?c[1]/2:d==="bottom"?c[1]:0),Zee(r)){var y=O1e(i,a,o,u,f);i=y[0],a=y[1]}o.moveTo(i,a)},t.prototype._updateContentNotChangedOnAxis=function(r,n){var i=this._lastDataByCoordSys,a=this._cbParamsList,o=!!i&&i.length===r.length;return o&&le(i,function(s,l){var u=s.dataByAxis||[],f=r[l]||{},c=f.dataByAxis||[];o=o&&u.length===c.length,o&&le(u,function(h,d){var v=c[d]||{},p=h.seriesDataIndices||[],g=v.seriesDataIndices||[];o=o&&h.value===v.value&&h.axisType===v.axisType&&h.axisId===v.axisId&&p.length===g.length,o&&le(p,function(y,m){var b=g[m];o=o&&y.seriesIndex===b.seriesIndex&&y.dataIndex===b.dataIndex}),a&&le(h.seriesDataIndices,function(y){var m=y.seriesIndex,b=n[m],_=a[m];b&&_&&_.data!==b.data&&(o=!1)})})}),this._lastDataByCoordSys=r,this._cbParamsList=n,!!o},t.prototype._hide=function(r){this._lastDataByCoordSys=null,r({type:"hideTip",from:this.uid})},t.prototype.dispose=function(r,n){Bt.node||!n.getDom()||(NI(this,"_updatePosition"),this._tooltipContent.dispose(),QI("itemTooltip",n))},t.type="tooltip",t}(cl);function sy(e,t,r){var n=t.ecModel,i;r?(i=new Un(r,n,n),i=new Un(t.option,i,n)):i=t;for(var a=e.length-1;a>=0;a--){var o=e[a];o&&(o instanceof Un&&(o=o.get("tooltip",!0)),st(o)&&(o={formatter:o}),o&&(i=new Un(o,i,n)))}return i}function UW(e,t){return e.dispatchAction||Or(t.dispatchAction,t)}function T1e(e,t,r,n,i,a,o){var s=r.getSize(),l=s[0],u=s[1];return a!=null&&(e+l+a+2>n?e-=l+a:e+=a),o!=null&&(t+u+o>i?t-=u+o:t+=o),[e,t]}function O1e(e,t,r,n,i){var a=r.getSize(),o=a[0],s=a[1];return e=Math.min(e+o,n)-o,t=Math.min(t+s,i)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}function E1e(e,t,r,n){var i=r[0],a=r[1],o=Math.ceil(Math.SQRT2*n)+8,s=0,l=0,u=t.width,f=t.height;switch(e){case"inside":s=t.x+u/2-i/2,l=t.y+f/2-a/2;break;case"top":s=t.x+u/2-i/2,l=t.y-a-o;break;case"bottom":s=t.x+u/2-i/2,l=t.y+f+o;break;case"left":s=t.x-i-o,l=t.y+f/2-a/2;break;case"right":s=t.x+u+o,l=t.y+f/2-a/2}return[s,l]}function zW(e){return e==="center"||e==="middle"}function R1e(e,t,r){var n=HN(e).queryOptionMap,i=n.keys()[0];if(!(!i||i==="series")){var a=Ew(t,i,n.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),o=a.models[0];if(o){var s=r.getViewOfComponentModel(o),l;if(s.group.traverse(function(u){var f=ur(u).tooltipConfig;if(f&&f.name===e.name)return l=u,!0}),l)return{componentMainType:i,componentIndex:o.componentIndex,el:l}}}}const k1e=x1e;function A1e(e){Du(qee),e.registerComponentModel(u1e),e.registerComponentView(k1e),e.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Di),e.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Di)}var P1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}(Pr),I1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){if(this.group.removeAll(),!!r.get("show")){var a=this.group,o=r.getModel("textStyle"),s=r.getModel("subtextStyle"),l=r.get("textAlign"),u=Xt(r.get("textBaseline"),r.get("textVerticalAlign")),f=new Xn({style:Iu(o,{text:r.get("text"),fill:o.getTextColor()},{disableBox:!0}),z2:10}),c=f.getBoundingRect(),h=r.get("subtext"),d=new Xn({style:Iu(s,{text:h,fill:s.getTextColor(),y:c.height+r.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),v=r.get("link"),p=r.get("sublink"),g=r.get("triggerEvent",!0);f.silent=!v&&!g,d.silent=!p&&!g,v&&f.on("click",function(){NV(v,"_"+r.get("target"))}),p&&d.on("click",function(){NV(p,"_"+r.get("subtarget"))}),ur(f).eventData=ur(d).eventData=g?{componentType:"title",componentIndex:r.componentIndex}:null,a.add(f),h&&a.add(d);var y=a.getBoundingRect(),m=r.getBoxLayoutParams();m.width=y.width,m.height=y.height;var b=iv(m,{width:i.getWidth(),height:i.getHeight()},r.get("padding"));l||(l=r.get("left")||r.get("right"),l==="middle"&&(l="center"),l==="right"?b.x+=b.width:l==="center"&&(b.x+=b.width/2)),u||(u=r.get("top")||r.get("bottom"),u==="center"&&(u="middle"),u==="bottom"?b.y+=b.height:u==="middle"&&(b.y+=b.height/2),u=u||"top"),a.x=b.x,a.y=b.y,a.markRedraw();var _={align:l,verticalAlign:u};f.setStyle(_),d.setStyle(_),y=a.getBoundingRect();var x=b.margin,T=r.getItemStyle(["color","opacity"]);T.fill=r.get("backgroundColor");var E=new _n({shape:{x:y.x-x[3],y:y.y-x[0],width:y.width+x[1]+x[3],height:y.height+x[0]+x[2],r:r.get("borderRadius")},style:T,subPixelOptimize:!0,silent:!0});a.add(E)}},t.type="title",t}(cl);function M1e(e){e.registerComponentModel(P1e),e.registerComponentView(I1e)}var D1e=function(e,t){if(t==="all")return{type:"all",title:e.getLocaleModel().get(["legend","selector","all"])};if(t==="inverse")return{type:"inverse",title:e.getLocaleModel().get(["legend","selector","inverse"])}},$1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),r.selected=r.selected||{},this._updateSelector(r)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),this._updateSelector(r)},t.prototype._updateSelector=function(r){var n=r.selector,i=this.ecModel;n===!0&&(n=r.selector=["all","inverse"]),et(n)&&le(n,function(a,o){st(a)&&(a={type:a}),n[o]=ar(a,D1e(i,a.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var r=this._data;if(r[0]&&this.get("selectedMode")==="single"){for(var n=!1,i=0;i<r.length;i++){var a=r[i].get("name");if(this.isSelected(a)){this.select(a),n=!0;break}}!n&&this.select(r[0].get("name"))}},t.prototype._updateData=function(r){var n=[],i=[];r.eachRawSeries(function(l){var u=l.name;i.push(u);var f;if(l.legendVisualProvider){var c=l.legendVisualProvider,h=c.getAllNames();r.isSeriesFiltered(l)||(i=i.concat(h)),h.length?n=n.concat(h):f=!0}else f=!0;f&&FN(l)&&n.push(l.name)}),this._availableNames=i;var a=this.get("data")||n,o=Vt(),s=pt(a,function(l){return(st(l)||_r(l))&&(l={name:l}),o.get(l.name)?null:(o.set(l.name,!0),new Un(l,this,this.ecModel))},this);this._data=hi(s,function(l){return!!l})},t.prototype.getData=function(){return this._data},t.prototype.select=function(r){var n=this.option.selected,i=this.get("selectedMode");if(i==="single"){var a=this._data;le(a,function(o){n[o.get("name")]=!1})}n[r]=!0},t.prototype.unSelect=function(r){this.get("selectedMode")!=="single"&&(this.option.selected[r]=!1)},t.prototype.toggleSelected=function(r){var n=this.option.selected;n.hasOwnProperty(r)||(n[r]=!0),this[n[r]?"unSelect":"select"](r)},t.prototype.allSelect=function(){var r=this._data,n=this.option.selected;le(r,function(i){n[i.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var r=this._data,n=this.option.selected;le(r,function(i){var a=i.get("name",!0);n.hasOwnProperty(a)||(n[a]=!0),n[a]=!n[a]})},t.prototype.isSelected=function(r){var n=this.option.selected;return!(n.hasOwnProperty(r)&&!n[r])&&yr(this._availableNames,r)>=0},t.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}(Pr);const eM=$1e;var Dh=en,tM=le,bS=Kn,N1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!1,r}return t.prototype.init=function(){this.group.add(this._contentGroup=new bS),this.group.add(this._selectorGroup=new bS),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(r,n,i){var a=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!r.get("show",!0)){var o=r.get("align"),s=r.get("orient");(!o||o==="auto")&&(o=r.get("left")==="right"&&s==="vertical"?"right":"left");var l=r.get("selector",!0),u=r.get("selectorPosition",!0);l&&(!u||u==="auto")&&(u=s==="horizontal"?"end":"start"),this.renderInner(o,r,n,i,l,s,u);var f=r.getBoxLayoutParams(),c={width:i.getWidth(),height:i.getHeight()},h=r.get("padding"),d=iv(f,c,h),v=this.layoutInner(r,o,d,a,l,u),p=iv(lr({width:v.width,height:v.height},f),c,h);this.group.x=p.x-v.x,this.group.y=p.y-v.y,this.group.markRedraw(),this.group.add(this._backgroundEl=s1e(v,r))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this.getContentGroup(),f=Vt(),c=n.get("selectedMode"),h=[];i.eachRawSeries(function(d){!d.get("legendHoverLink")&&h.push(d.id)}),tM(n.getData(),function(d,v){var p=d.get("name");if(!this.newlineDisabled&&(p===""||p===`
`)){var g=new bS;g.newline=!0,u.add(g);return}var y=i.getSeriesByName(p)[0];if(!f.get(p))if(y){var m=y.getData(),b=m.getVisual("legendLineStyle")||{},_=m.getVisual("legendIcon"),x=m.getVisual("style"),T=this._createItem(y,p,v,d,n,r,b,x,_,c,a);T.on("click",Dh(GW,p,null,a,h)).on("mouseover",Dh(rM,y.name,null,a,h)).on("mouseout",Dh(nM,y.name,null,a,h)),f.set(p,!0)}else i.eachRawSeries(function(E){if(!f.get(p)&&E.legendVisualProvider){var P=E.legendVisualProvider;if(!P.containName(p))return;var R=P.indexOfName(p),M=P.getItemVisual(R,"style"),D=P.getItemVisual(R,"legendIcon"),N=il(M.fill);N&&N[3]===0&&(N[3]=.2,M=Le(Le({},M),{fill:ZT(N,"rgba")}));var B=this._createItem(E,p,v,d,n,r,{},M,D,c,a);B.on("click",Dh(GW,null,p,a,h)).on("mouseover",Dh(rM,null,p,a,h)).on("mouseout",Dh(nM,null,p,a,h)),f.set(p,!0)}},this)},this),o&&this._createSelector(o,n,a,s,l)},t.prototype._createSelector=function(r,n,i,a,o){var s=this.getSelectorGroup();tM(r,function(u){var f=u.type,c=new Xn({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:f==="all"?"legendAllSelect":"legendInverseSelect"})}});s.add(c);var h=n.getModel("selectorLabel"),d=n.getModel(["emphasis","selectorLabel"]);kw(c,{normal:h,emphasis:d},{defaultText:u.title}),TI(c)})},t.prototype._createItem=function(r,n,i,a,o,s,l,u,f,c,h){var d=r.visualDrawType,v=o.get("itemWidth"),p=o.get("itemHeight"),g=o.isSelected(n),y=a.get("symbolRotate"),m=a.get("symbolKeepAspect"),b=a.get("icon");f=b||f||"roundRect";var _=L1e(f,a,l,u,d,g,h),x=new bS,T=a.getModel("textStyle");if(Nt(r.getLegendIcon)&&(!b||b==="inherit"))x.add(r.getLegendIcon({itemWidth:v,itemHeight:p,icon:f,iconRotate:y,itemStyle:_.itemStyle,lineStyle:_.lineStyle,symbolKeepAspect:m}));else{var E=b==="inherit"&&r.getData().getVisual("symbol")?y==="inherit"?r.getData().getVisual("symbolRotate"):y:0;x.add(F1e({itemWidth:v,itemHeight:p,icon:f,iconRotate:E,itemStyle:_.itemStyle,lineStyle:_.lineStyle,symbolKeepAspect:m}))}var P=s==="left"?v+5:-5,R=s,M=o.get("formatter"),D=n;st(M)&&M?D=M.replace("{name}",n??""):Nt(M)&&(D=M(n));var N=a.get("inactiveColor");x.add(new Xn({style:Iu(T,{text:D,x:P,y:p/2,fill:g?T.getTextColor():N,align:R,verticalAlign:"middle"})}));var B=new _n({shape:x.getBoundingRect(),invisible:!0}),K=a.getModel("tooltip");return K.get("show")&&JN({el:B,componentModel:o,itemName:n,itemTooltipOption:K.option}),x.add(B),x.eachChild(function(Z){Z.silent=!0}),B.silent=!c,this.getContentGroup().add(x),TI(x),x.__legendDataIndex=i,x},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getContentGroup(),u=this.getSelectorGroup();gm(r.get("orient"),l,r.get("itemGap"),i.width,i.height);var f=l.getBoundingRect(),c=[-f.x,-f.y];if(u.markRedraw(),l.markRedraw(),o){gm("horizontal",u,r.get("selectorItemGap",!0));var h=u.getBoundingRect(),d=[-h.x,-h.y],v=r.get("selectorButtonGap",!0),p=r.getOrient().index,g=p===0?"width":"height",y=p===0?"height":"width",m=p===0?"y":"x";s==="end"?d[p]+=f[g]+v:c[p]+=h[g]+v,d[1-p]+=f[y]/2-h[y]/2,u.x=d[0],u.y=d[1],l.x=c[0],l.y=c[1];var b={x:0,y:0};return b[g]=f[g]+v+h[g],b[y]=Math.max(f[y],h[y]),b[m]=Math.min(0,h[m]+d[1-p]),b}else return l.x=c[0],l.y=c[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(cl);function L1e(e,t,r,n,i,a,o){function s(g,y){g.lineWidth==="auto"&&(g.lineWidth=y.lineWidth>0?2:0),tM(g,function(m,b){g[b]==="inherit"&&(g[b]=y[b])})}var l=t.getModel("itemStyle"),u=l.getItemStyle(),f=e.lastIndexOf("empty",0)===0?"fill":"stroke",c=l.getShallow("decal");u.decal=!c||c==="inherit"?n.decal:VI(c,o),u.fill==="inherit"&&(u.fill=n[i]),u.stroke==="inherit"&&(u.stroke=n[f]),u.opacity==="inherit"&&(u.opacity=(i==="fill"?n:r).opacity),s(u,n);var h=t.getModel("lineStyle"),d=h.getLineStyle();if(s(d,r),u.fill==="auto"&&(u.fill=n.fill),u.stroke==="auto"&&(u.stroke=n.fill),d.stroke==="auto"&&(d.stroke=n.fill),!a){var v=t.get("inactiveBorderWidth"),p=u[f];u.lineWidth=v==="auto"?n.lineWidth>0&&p?2:0:u.lineWidth,u.fill=t.get("inactiveColor"),u.stroke=t.get("inactiveBorderColor"),d.stroke=h.get("inactiveColor"),d.lineWidth=h.get("inactiveWidth")}return{itemStyle:u,lineStyle:d}}function F1e(e){var t=e.icon||"roundRect",r=sv(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill,e.symbolKeepAspect);return r.setStyle(e.itemStyle),r.rotation=(e.iconRotate||0)*Math.PI/180,r.setOrigin([e.itemWidth/2,e.itemHeight/2]),t.indexOf("empty")>-1&&(r.style.stroke=r.style.fill,r.style.fill="#fff",r.style.lineWidth=2),r}function GW(e,t,r,n){nM(e,t,r,n),r.dispatchAction({type:"legendToggleSelect",name:e??t}),rM(e,t,r,n)}function tte(e){for(var t=e.getZr().storage.getDisplayList(),r,n=0,i=t.length;n<i&&!(r=t[n].states.emphasis);)n++;return r&&r.hoverLayer}function rM(e,t,r,n){tte(r)||r.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:n})}function nM(e,t,r,n){tte(r)||r.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:n})}const rte=N1e;function H1e(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(r){for(var n=0;n<t.length;n++)if(!t[n].isSelected(r.name))return!1;return!0})}function ly(e,t,r){var n={},i=e==="toggleSelected",a;return r.eachComponent("legend",function(o){i&&a!=null?o[a?"select":"unSelect"](t.name):e==="allSelect"||e==="inverseSelect"?o[e]():(o[e](t.name),a=o.isSelected(t.name));var s=o.getData();le(s,function(l){var u=l.get("name");if(!(u===`
`||u==="")){var f=o.isSelected(u);n.hasOwnProperty(u)?n[u]=n[u]&&f:n[u]=f}})}),e==="allSelect"||e==="inverseSelect"?{selected:n}:{name:t.name,selected:n}}function B1e(e){e.registerAction("legendToggleSelect","legendselectchanged",en(ly,"toggleSelected")),e.registerAction("legendAllSelect","legendselectall",en(ly,"allSelect")),e.registerAction("legendInverseSelect","legendinverseselect",en(ly,"inverseSelect")),e.registerAction("legendSelect","legendselected",en(ly,"select")),e.registerAction("legendUnSelect","legendunselected",en(ly,"unSelect"))}function nte(e){e.registerComponentModel(eM),e.registerComponentView(rte),e.registerProcessor(e.PRIORITY.PROCESSOR.SERIES_FILTER,H1e),e.registerSubTypeDefaulter("legend",function(){return"plain"}),B1e(e)}var V1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.setScrollDataIndex=function(r){this.option.scrollDataIndex=r},t.prototype.init=function(r,n,i){var a=pO(r);e.prototype.init.call(this,r,n,i),YW(this,r,a)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),YW(this,this.option,r)},t.type="legend.scroll",t.defaultOption=MJ(eM.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(eM);function YW(e,t,r){var n=e.getOrient(),i=[1,1];i[n.index]=0,av(t,r,{type:"box",ignoreSize:!!i})}const j1e=V1e;var KW=Kn,sk=["width","height"],lk=["x","y"],W1e=function(e){Ye(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!0,r._currentIndex=0,r}return t.prototype.init=function(){e.prototype.init.call(this),this.group.add(this._containerGroup=new KW),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new KW)},t.prototype.resetInner=function(){e.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this;e.prototype.renderInner.call(this,r,n,i,a,o,s,l);var f=this._controllerGroup,c=n.get("pageIconSize",!0),h=et(c)?c:[c,c];v("pagePrev",0);var d=n.getModel("pageTextStyle");f.add(new Xn({name:"pageText",style:{text:"xx/xx",fill:d.getTextColor(),font:d.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),v("pageNext",1);function v(p,g){var y=p+"DataIndex",m=ZN(n.get("pageIcons",!0)[n.getOrient().name][g],{onclick:Or(u._pageGo,u,y,n,a)},{x:-h[0]/2,y:-h[1]/2,width:h[0],height:h[1]});m.name=p,f.add(m)}},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getSelectorGroup(),u=r.getOrient().index,f=sk[u],c=lk[u],h=sk[1-u],d=lk[1-u];o&&gm("horizontal",l,r.get("selectorItemGap",!0));var v=r.get("selectorButtonGap",!0),p=l.getBoundingRect(),g=[-p.x,-p.y],y=Qt(i);o&&(y[f]=i[f]-p[f]-v);var m=this._layoutContentAndController(r,a,y,u,f,h,d,c);if(o){if(s==="end")g[u]+=m[f]+v;else{var b=p[f]+v;g[u]-=b,m[c]-=b}m[f]+=p[f]+v,g[1-u]+=m[d]+m[h]/2-p[h]/2,m[h]=Math.max(m[h],p[h]),m[d]=Math.min(m[d],p[d]+g[1-u]),l.x=g[0],l.y=g[1],l.markRedraw()}return m},t.prototype._layoutContentAndController=function(r,n,i,a,o,s,l,u){var f=this.getContentGroup(),c=this._containerGroup,h=this._controllerGroup;gm(r.get("orient"),f,r.get("itemGap"),a?i.width:null,a?null:i.height),gm("horizontal",h,r.get("pageButtonItemGap",!0));var d=f.getBoundingRect(),v=h.getBoundingRect(),p=this._showController=d[o]>i[o],g=[-d.x,-d.y];n||(g[a]=f[u]);var y=[0,0],m=[-v.x,-v.y],b=Xt(r.get("pageButtonGap",!0),r.get("itemGap",!0));if(p){var _=r.get("pageButtonPosition",!0);_==="end"?m[a]+=i[o]-v[o]:y[a]+=v[o]+b}m[1-a]+=d[s]/2-v[s]/2,f.setPosition(g),c.setPosition(y),h.setPosition(m);var x={x:0,y:0};if(x[o]=p?i[o]:d[o],x[s]=Math.max(d[s],v[s]),x[l]=Math.min(0,v[l]+m[1-a]),c.__rectSize=i[o],p){var T={x:0,y:0};T[o]=Math.max(i[o]-v[o]-b,0),T[s]=x[s],c.setClipPath(new _n({shape:T})),c.__rectSize=T[o]}else h.eachChild(function(P){P.attr({invisible:!0,silent:!0})});var E=this._getPageInfo(r);return E.pageIndex!=null&&mi(f,{x:E.contentPosition[0],y:E.contentPosition[1]},p?r:null),this._updatePageInfoView(r,E),x},t.prototype._pageGo=function(r,n,i){var a=this._getPageInfo(n)[r];a!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:a,legendId:n.id})},t.prototype._updatePageInfoView=function(r,n){var i=this._controllerGroup;le(["pagePrev","pageNext"],function(f){var c=f+"DataIndex",h=n[c]!=null,d=i.childOfName(f);d&&(d.setStyle("fill",h?r.get("pageIconColor",!0):r.get("pageIconInactiveColor",!0)),d.cursor=h?"pointer":"default")});var a=i.childOfName("pageText"),o=r.get("pageFormatter"),s=n.pageIndex,l=s!=null?s+1:0,u=n.pageCount;a&&o&&a.setStyle("text",st(o)?o.replace("{current}",l==null?"":l+"").replace("{total}",u==null?"":u+""):o({current:l,total:u}))},t.prototype._getPageInfo=function(r){var n=r.get("scrollDataIndex",!0),i=this.getContentGroup(),a=this._containerGroup.__rectSize,o=r.getOrient().index,s=sk[o],l=lk[o],u=this._findTargetItemIndex(n),f=i.children(),c=f[u],h=f.length,d=h?1:0,v={contentPosition:[i.x,i.y],pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return v;var p=_(c);v.contentPosition[o]=-p.s;for(var g=u+1,y=p,m=p,b=null;g<=h;++g)b=_(f[g]),(!b&&m.e>y.s+a||b&&!x(b,y.s))&&(m.i>y.i?y=m:y=b,y&&(v.pageNextDataIndex==null&&(v.pageNextDataIndex=y.i),++v.pageCount)),m=b;for(var g=u-1,y=p,m=p,b=null;g>=-1;--g)b=_(f[g]),(!b||!x(m,b.s))&&y.i<m.i&&(m=y,v.pagePrevDataIndex==null&&(v.pagePrevDataIndex=y.i),++v.pageCount,++v.pageIndex),y=b;return v;function _(T){if(T){var E=T.getBoundingRect(),P=E[l]+T[l];return{s:P,e:P+E[s],i:T.__legendDataIndex}}}function x(T,E){return T.e>=E&&T.s<=E+a}},t.prototype._findTargetItemIndex=function(r){if(!this._showController)return 0;var n,i=this.getContentGroup(),a;return i.eachChild(function(o,s){var l=o.__legendDataIndex;a==null&&l!=null&&(a=s),l===r&&(n=s)}),n??a},t.type="legend.scroll",t}(rte);const U1e=W1e;function z1e(e){e.registerAction("legendScroll","legendscroll",function(t,r){var n=t.scrollDataIndex;n!=null&&r.eachComponent({mainType:"legend",subType:"scroll",query:t},function(i){i.setScrollDataIndex(n)})})}function G1e(e){Du(nte),e.registerComponentModel(j1e),e.registerComponentView(U1e),z1e(e)}function Y1e(e){Du(nte),Du(G1e)}var uk=null;function K1e(e){return uk||(uk=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),uk(e)}var fk=null;function X1e(e){fk||(fk=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),fk(e)}function q1e(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function wS(e,t){t===void 0&&(t={});var r=document.createElement(e);return Object.keys(t).forEach(function(n){r[n]=t[n]}),r}function ite(e,t,r){var n=window.getComputedStyle(e,r||null)||{display:"none"};return n[t]}function iM(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(ite(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var Z1e='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',aM=0,q1=null;function J1e(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=tCe.bind(e));var r=e.__resize_listeners__;if(!r){if(e.__resize_listeners__=[],window.ResizeObserver){var n=e.offsetWidth,i=e.offsetHeight,a=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===n&&e.offsetHeight===i)||gx(e)}),o=iM(e),s=o.detached,l=o.rendered;e.__resize_observer_triggered__=s===!1&&l===!1,e.__resize_observer__=a,a.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){gx(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(aM||(q1=q1e(Z1e)),rCe(e),e.__resize_rendered__=iM(e).rendered,window.MutationObserver){var u=new MutationObserver(e.__resize_mutation_handler__);u.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=u}}e.__resize_listeners__.push(t),aM++}function Q1e(e,t){var r=e.__resize_listeners__;if(r){if(t&&r.splice(r.indexOf(t),1),!r.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",ML),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--aM&&q1&&q1.parentNode.removeChild(q1)}}function eCe(e){var t=e.__resize_last__,r=t.width,n=t.height,i=e.offsetWidth,a=e.offsetHeight;return i!==r||a!==n?{width:i,height:a}:null}function tCe(){var e=iM(this),t=e.rendered,r=e.detached;t!==this.__resize_rendered__&&(!r&&this.__resize_triggers__&&(DL(this),this.addEventListener("scroll",ML,!0)),this.__resize_rendered__=t,gx(this))}function ML(){var e=this;DL(this),this.__resize_raf__&&X1e(this.__resize_raf__),this.__resize_raf__=K1e(function(){var t=eCe(e);t&&(e.__resize_last__=t,gx(e))})}function gx(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function rCe(e){var t=ite(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var r=wS("div",{className:"resize-triggers"}),n=wS("div",{className:"resize-expand-trigger"}),i=wS("div"),a=wS("div",{className:"resize-contract-trigger"});n.appendChild(i),r.appendChild(n),r.appendChild(a),e.appendChild(r),e.__resize_triggers__={triggers:r,expand:n,expandChild:i,contract:a},DL(e),e.addEventListener("scroll",ML,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function DL(e){var t=e.__resize_triggers__,r=t.expand,n=t.expandChild,i=t.contract,a=i.scrollWidth,o=i.scrollHeight,s=r.offsetWidth,l=r.offsetHeight,u=r.scrollWidth,f=r.scrollHeight;i.scrollLeft=a,i.scrollTop=o,n.style.width=s+1+"px",n.style.height=l+1+"px",r.scrollLeft=u,r.scrollTop=f}var ws=function(){return ws=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ws.apply(this,arguments)},nCe=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function iCe(e){return t=Object.create(null),nCe.forEach(function(r){t[r]=function(n){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[n].apply(e.value,i)}}(r)}),t;var t}var aCe={autoresize:Boolean},oCe=/^on[^a-z]/,sCe=function(e){return oCe.test(e)};function _S(e,t){var r=Tr(e);return r&&typeof r=="object"&&"value"in r?r.value||t:r||t}var lCe={loading:Boolean,loadingOptions:Object},uy=null,XW=[],fy=[];(function(e,t){if(e&&typeof document<"u"){var r,n=t.prepend===!0?"prepend":"append",i=t.singleTag===!0,a=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var o=XW.indexOf(a);o===-1&&(o=XW.push(a)-1,fy[o]={}),r=fy[o]&&fy[o][n]?fy[o][n]:fy[o][n]=s()}else r=s();e.charCodeAt(0)===65279&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function s(){var l=document.createElement("style");if(l.setAttribute("type","text/css"),t.attributes)for(var u=Object.keys(t.attributes),f=0;f<u.length;f++)l.setAttribute(u[f],t.attributes[u[f]]);var c=n==="prepend"?"afterbegin":"beforeend";return a.insertAdjacentElement(c,l),l}})(`x-vue-echarts{display:block;width:100%;height:100%;min-width:0}
`,{});var uCe=function(){if(uy!=null)return uy;if(typeof HTMLElement>"u"||typeof customElements>"u")return uy=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)("x-vue-echarts")}catch{return uy=!1}return uy=!0}(),fCe="ecTheme",cCe=_i({name:"echarts",props:ws(ws({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},aCe),lCe),emits:{},inheritAttrs:!1,setup:function(e,t){var r=t.attrs,n=jE(),i=jE(),a=jE(),o=Vy("ecTheme",null),s=Vy("ecInitOptions",null),l=Vy("ecUpdateOptions",null),u=vce(e),f=u.autoresize,c=u.manualUpdate,h=u.loading,d=u.loadingOptions,v=eo(function(){return a.value||e.option||null}),p=eo(function(){return e.theme||_S(o,{})}),g=eo(function(){return e.initOptions||_S(s,{})}),y=eo(function(){return e.updateOptions||_S(l,{})}),m=eo(function(){return function(P){var R={};for(var M in P)sCe(M)||(R[M]=P[M]);return R}(r)}),b=pce().proxy.$listeners;function _(P){if(n.value){var R=i.value=X0e(n.value,p.value,g.value);e.group&&(R.group=e.group);var M=b;M||(M={},Object.keys(r).filter(function(N){return N.indexOf("on")===0&&N.length>2}).forEach(function(N){var B=N.charAt(2).toLowerCase()+N.slice(3);B.substring(B.length-4)==="Once"&&(B="~".concat(B.substring(0,B.length-4))),M[B]=r[N]})),Object.keys(M).forEach(function(N){var B=M[N];if(B){var K=N.toLowerCase();K.charAt(0)==="~"&&(K=K.substring(1),B.__once__=!0);var Z=R;if(K.indexOf("zr:")===0&&(Z=R.getZr(),K=K.substring(3)),B.__once__){delete B.__once__;var ie=B;B=function(){for(var me=[],k=0;k<arguments.length;k++)me[k]=arguments[k];ie.apply(void 0,me),Z.off(K,B)}}Z.on(K,B)}}),f.value?VC(function(){R&&!R.isDisposed()&&R.resize(),D()}):D()}function D(){var N=P||v.value;N&&R.setOption(N,y.value)}}function x(){i.value&&(i.value.dispose(),i.value=void 0)}var T=null;bd(c,function(P){typeof T=="function"&&(T(),T=null),P||(T=bd(function(){return e.option},function(R,M){R&&(i.value?i.value.setOption(R,ws({notMerge:R!==M},y.value)):_())},{deep:!0}))},{immediate:!0}),bd([p,g],function(){x(),_()},{deep:!0}),f4(function(){e.group&&i.value&&(i.value.group=e.group)});var E=iCe(i);return function(P,R,M){var D=Vy("ecLoadingOptions",{}),N=eo(function(){return ws(ws({},_S(D,{})),M==null?void 0:M.value)});f4(function(){var B=P.value;B&&(R.value?B.showLoading(N.value):B.hideLoading())})}(i,h,d),function(P,R,M){var D=null;bd([M,P,R],function(N,B,K){var Z=N[0],ie=N[1],me=N[2];Z&&ie&&me&&(D=bO(function(){ie.resize()},100),J1e(Z,D)),K(function(){D&&Z&&Q1e(Z,D)})})}(i,f,n),qc(function(){_()}),gce(function(){uCe&&n.value?n.value.__dispose=x:x()}),ws({chart:i,root:n,setOption:function(P,R){e.manualUpdate&&(a.value=P),i.value?i.value.setOption(P,R||{}):_(P)},nonEventAttrs:m},E)},render:function(){var e=ws({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",yce("x-vue-echarts",e)}});const hCe={type:"bar"},dCe={type:"DYNAMIC_RANKING_BAR"},vCe={type:"DYNAMIC_RING"},pCe={type:"line"},gCe={type:"pie"},yCe={type:"bar"},mCe={type:"ring"},xO={DYNAMIC_LINE_BAR_MIX:hCe,DYNAMIC_RANKING_BAR:dCe,DYNAMIC_RING:vCe,LINE_BASICS:pCe,PIE_BASICS:gCe,BAR_BASICS:yCe,RING_BASICS:mCe},oM={westeros:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],wonderland:["#4ea397","#22c3aa","#7bd9a5","#d0648a","#f58db2","#f2b3c9"],walden:["#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],chalk:["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb","#d2f5a6","#76f2f2"],macarons:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"]},bCe=Object.keys(oM).map(e=>({value:e,color:oM[e]})),ate=e=>{var r;const t=(r=e==null?void 0:e.config)==null?void 0:r.title;return{title:{show:t.show,text:t.value,left:10,top:10,textStyle:{color:t.color}}}},ote=e=>{var r;const t=((r=e==null?void 0:e.config)==null?void 0:r.theme)||"westeros";return{color:oM[t]}},ste=e=>{var r;return{backgroundColor:((r=e==null?void 0:e.config)==null?void 0:r.backgroundColor)||"#ffffff"}},Go=(e,t)=>{const{type:r}=e;return xO[r].type===t},lte=e=>{const{config:t}=e;return{legend:{show:t==null?void 0:t.legend,bottom:"10"}}},ute=e=>{var n;const{type:t}=e,r=(n=xO[t])==null?void 0:n.type;return!!["bar","line"].includes(r)},wCe=e=>{const{config:t}=e,{data:r=[]}=t,n={};if(ute(e)){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{xAxis:n}}return{}},_Ce=e=>{const{config:t,type:r}=e,{data:n=[]}=t,a=xO[r].type,o=[],s=Ji.cloneDeep(n);if((Go(e,"line")||Go(e,"bar"))&&(s[0].shift(),s[0].forEach((u,f)=>{const c={name:u,type:a,data:[],markPoint:{data:[{type:"max",name:"Max"},{type:"min",name:"Min"}]}};for(let h=1;h<s.length;h++){const d=s[h];c.data.push(+d[f+1])}o.push(c)}),console.log("series: ",o)),Go(e,"pie")){const l={name:s.shift()[0],radius:"50%",data:[],type:a};s.forEach(u=>{const[f,c]=u;l.data.push({value:c,name:f})}),o.push(l)}if(Go(e,"ring")){const l={name:s.shift()[0],data:[],radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},type:"pie"};s.forEach(u=>{const[f,c]=u;l.data.push({value:c,name:f})}),o.push(l)}return{series:o}},SCe=e=>{const t={};return ute(e)?(t.type="value",{yAxis:t}):{}};function CCe(e){const t=Ji.cloneDeep(e),r=wCe(t),n=SCe(t),i=_Ce(t),a=lte(t),o=ate(t),s=ote(t),l=ste(t),u={...s,...r,...n,...i,...a,...o,...l,grid:{},tooltip:{trigger:"item"}};return console.log("option: ",u),u}const xCe=e=>{const t={axisTick:{show:!1}};return Go(e,"DYNAMIC_RANKING_BAR")?(t.type="value",{xAxis:t}):{}},TCe=e=>{const{config:t}=e,{data:r=[]}=t,n={axisTick:{show:!1}};if(Go(e,"DYNAMIC_RANKING_BAR")){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{yAxis:n}}return{}},OCe=e=>{const{config:t,type:r}=e,{data:n=[]}=t;xO[r].type;const a=[],o=Ji.cloneDeep(n);if(Go(e,"DYNAMIC_RANKING_BAR")&&(o[0].shift(),o[0].forEach((l,u)=>{const f={name:l,type:"bar",barMaxWidth:40,data:[]};for(let c=1;c<o.length;c++){const h=o[c];f.data.push(+h[u+1])}a.push(f)})),Go(e,"DYNAMIC_RING")){const s={name:o.shift()[0],data:[],radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},type:"pie"};o.forEach(l=>{const[u,f]=l;s.data.push({value:f,name:u})}),a.push(s)}return{series:a}},ECe=(e,t)=>{const r=Ji.cloneDeep(e.config.data),n=r.shift();if(Go(e,"DYNAMIC_RANKING_BAR")){const i=r.reverse().filter((a,o)=>o<=t);return i.unshift(n),i}return Go(e,"DYNAMIC_RING")?n.map((a,o)=>[a,r[t][o]]):r};function qW(e,t){const r=Ji.cloneDeep(e),{config:n}=r;n.data=ECe(r,t);const{animation:i}=n,a=xCe(r),o=TCe(r),s=OCe(r),l=lte(r),u=ate(r),f=ote(r),c=ste(r);return{...f,...a,...o,...s,...l,...u,...c,animationDuration:i.moveTime*1e3,animationEasing:"linear",animationEasingUpdate:"linear",grid:{},tooltip:{trigger:"item"}}}const RCe=1e3;let TO=null,xd=0;const Mw=Mn("clear"),kCe=e=>{var r;return(((r=e==null?void 0:e.config)==null?void 0:r.data)||[]).length-1},ZW=(e,t)=>{TO=setInterval(()=>{Mw.value="start",xd=xd+1,xd>=kCe(e)&&PCe(),t&&t(xd-1)},RCe)},ACe=()=>{Mw.value="stop",clearInterval(TO)},PCe=()=>{clearInterval(TO),setTimeout(()=>{Mw.value="end",xd=0},1e3)},fte=()=>{Mw.value="clear",clearInterval(TO),xd=0};Kq(()=>{fte()});const JW=(e,t,r="png")=>{const n=document.createElement("a");n.download=e.name+"."+r,n.href=t,document.body.appendChild(n),n.click(),n.remove()};var sM={},ICe={get exports(){return sM},set exports(e){sM=e}};(function(e,t){(function(r,n,i,a){var o={URL:r.URL||r.webkitURL||r.mozURL||r.msURL,getUserMedia:function(){var k=i.getUserMedia||i.webkitGetUserMedia||i.mozGetUserMedia||i.msGetUserMedia;return k&&k.bind(i)}(),requestAnimFrame:r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame,requestTimeout:function(w,C){if(w=w||o.noop,C=C||0,!o.requestAnimFrame)return setTimeout(w,C);var O=new Date().getTime(),S=new Object,A=o.requestAnimFrame,I=function L(){var V=new Date().getTime(),Y=V-O;Y>=C?w.call():S.value=A(L)};return S.value=A(I),S},Blob:r.Blob||r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder,btoa:function(){var k=r.btoa||function(w){for(var C="",O=0,S=w.length,A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",I=void 0,L=void 0,V=void 0,Y=void 0,ae=void 0,re=void 0,te=void 0;O<S;)I=w.charCodeAt(O++),L=w.charCodeAt(O++),V=w.charCodeAt(O++),Y=I>>2,ae=(I&3)<<4|L>>4,re=(L&15)<<2|V>>6,te=V&63,isNaN(L)?re=te=64:isNaN(V)&&(te=64),C=C+A.charAt(Y)+A.charAt(ae)+A.charAt(re)+A.charAt(te);return C};return k?k.bind(r):o.noop}(),isObject:function(w){return w&&Object.prototype.toString.call(w)==="[object Object]"},isEmptyObject:function(w){return o.isObject(w)&&!Object.keys(w).length},isArray:function(w){return w&&Array.isArray(w)},isFunction:function(w){return w&&typeof w=="function"},isElement:function(w){return w&&w.nodeType===1},isString:function(w){return typeof w=="string"||Object.prototype.toString.call(w)==="[object String]"},isSupported:{canvas:function(){var w=n.createElement("canvas");return w&&w.getContext&&w.getContext("2d")},webworkers:function(){return r.Worker},blob:function(){return o.Blob},Uint8Array:function(){return r.Uint8Array},Uint32Array:function(){return r.Uint32Array},videoCodecs:function(){var k=n.createElement("video"),w={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{k&&k.canPlayType&&(w.mp4=k.canPlayType('video/mp4; codecs="mp4v.20.8"')!=="",w.h264=(k.canPlayType('video/mp4; codecs="avc1.42E01E"')||k.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))!=="",w.ogv=k.canPlayType('video/ogg; codecs="theora"')!=="",w.ogg=k.canPlayType('video/ogg; codecs="theora"')!=="",w.webm=k.canPlayType('video/webm; codecs="vp8, vorbis"')!==-1)}catch{}return w}()},noop:function(){},each:function(w,C){var O=void 0,S=void 0;if(o.isArray(w))for(O=-1,S=w.length;++O<S&&C(O,w[O])!==!1;);else if(o.isObject(w)){for(O in w)if(w.hasOwnProperty(O)&&C(O,w[O])===!1)break}},mergeOptions:function(w,C){if(!(!o.isObject(w)||!o.isObject(C)||!Object.keys)){var O={};return o.each(w,function(S,A){O[S]=w[S]}),o.each(C,function(S,A){var I=C[S];o.isObject(I)&&w[S]?O[S]=o.mergeOptions(w[S],I):O[S]=I}),O}},setCSSAttr:function(w,C,O){o.isElement(w)&&(o.isString(C)&&o.isString(O)?w.style[C]=O:o.isObject(C)&&o.each(C,function(S,A){w.style[S]=A}))},removeElement:function(w){o.isElement(w)&&w.parentNode&&w.parentNode.removeChild(w)},createWebWorker:function(w){if(!o.isString(w))return{};try{var C=new o.Blob([w],{type:"text/javascript"}),O=o.URL.createObjectURL(C),S=new Worker(O);return{objectUrl:O,worker:S}}catch(A){return""+A}},getExtension:function(w){return w.substr(w.lastIndexOf(".")+1,w.length)},getFontSize:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{};if(!n.body||w.resizeFont===!1)return w.fontSize;var C=w.text,O=w.gifWidth,S=parseInt(w.fontSize,10),A=parseInt(w.minFontSize,10),I=n.createElement("div"),L=n.createElement("span");for(I.setAttribute("width",O),I.appendChild(L),L.innerHTML=C,L.style.fontSize=S+"px",L.style.textIndent="-9999px",L.style.visibility="hidden",n.body.appendChild(L);L.offsetWidth>O&&S>=A;)L.style.fontSize=--S+"px";return n.body.removeChild(L),S+"px"},webWorkerError:!1},s=Object.freeze({default:o}),l={validate:function(w){w=o.isObject(w)?w:{};var C={};return o.each(l.validators,function(O,S){var A=S.errorCode;if(!w[A]&&!S.condition)return C=S,C.error=!0,!1}),delete C.condition,C},isValid:function(w){var C=l.validate(w),O=C.error!==!0;return O},validators:[{condition:o.isFunction(o.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:o.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:o.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:o.isFunction(o.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:o.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:o.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:o.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},u=Object.freeze({default:l}),f=function(){},c={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:f,completeCallback:f,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},h=Object.freeze({default:c});function d(){return l.isValid()}function v(){return l.isValid()}function p(){var k={getUserMedia:!0};return l.isValid(k)}function g(k){var w=!1;if(o.isArray(k)&&k.length){if(o.each(k,function(C,O){o.isSupported.videoCodecs[O]&&(w=!0)}),!w)return!1}else if(o.isString(k)&&k.length&&!o.isSupported.videoCodecs[k])return!1;return l.isValid({getUserMedia:!0})}function y(){var k=256,w=499,C=491,O=487,S=503,A=3*S,I=k-1,L=4,V=100,Y=16,ae=1<<Y,re=10,te=10,ge=ae>>te,H=ae<<re-te,Ce=k>>3,oe=6,Oe=1<<oe,Ee=Ce*Oe,be=30,Ie=10,Me=1<<Ie,j,U=8,Q=1<<U,fe=Ie+U,ee=1<<fe,pe,se,ue,ce,ve=[],de=[],Te=[],$e=[];function Fe(Ke,Be,at){var He,ot;for(pe=Ke,se=Be,ue=at,ce=new Array(k),He=0;He<k;He++)ce[He]=new Array(4),ot=ce[He],ot[0]=ot[1]=ot[2]=(He<<L+8)/k|0,Te[He]=ae/k|0,de[He]=0}function it(){for(var Ke=[],Be=new Array(k),at=0;at<k;at++)Be[ce[at][3]]=at;for(var He=0,ot=0;ot<k;ot++){var je=Be[ot];Ke[He++]=ce[je][0],Ke[He++]=ce[je][1],Ke[He++]=ce[je][2]}return Ke}function gt(){var Ke,Be,at,He,ot,je,Ze,Wt;for(Ze=0,Wt=0,Ke=0;Ke<k;Ke++){for(ot=ce[Ke],at=Ke,He=ot[1],Be=Ke+1;Be<k;Be++)je=ce[Be],je[1]<He&&(at=Be,He=je[1]);if(je=ce[at],Ke!=at&&(Be=je[0],je[0]=ot[0],ot[0]=Be,Be=je[1],je[1]=ot[1],ot[1]=Be,Be=je[2],je[2]=ot[2],ot[2]=Be,Be=je[3],je[3]=ot[3],ot[3]=Be),He!=Ze){for(ve[Ze]=Wt+Ke>>1,Be=Ze+1;Be<He;Be++)ve[Be]=Ke;Ze=He,Wt=Ke}}for(ve[Ze]=Wt+I>>1,Be=Ze+1;Be<256;Be++)ve[Be]=I}function Ht(){var Ke,Be,at,He,ot,je,Ze,Wt,Ut,Jt,kn,hr,F,X;for(se<A&&(ue=1),j=30+(ue-1)/3,hr=pe,F=0,X=se,kn=se/(3*ue),Jt=kn/V|0,Wt=Me,je=Ee,Ze=je>>oe,Ze<=1&&(Ze=0),Ke=0;Ke<Ze;Ke++)$e[Ke]=Wt*((Ze*Ze-Ke*Ke)*Q/(Ze*Ze));for(se<A?Ut=3:se%w!==0?Ut=3*w:se%C!==0?Ut=3*C:se%O!==0?Ut=3*O:Ut=3*S,Ke=0;Ke<kn;)if(at=(hr[F+0]&255)<<L,He=(hr[F+1]&255)<<L,ot=(hr[F+2]&255)<<L,Be=bt(at,He,ot),It(Wt,Be,at,He,ot),Ze!==0&&Lt(Ze,Be,at,He,ot),F+=Ut,F>=X&&(F-=se),Ke++,Jt===0&&(Jt=1),Ke%Jt===0)for(Wt-=Wt/j,je-=je/be,Ze=je>>oe,Ze<=1&&(Ze=0),Be=0;Be<Ze;Be++)$e[Be]=Wt*((Ze*Ze-Be*Be)*Q/(Ze*Ze))}function ut(Ke,Be,at){var He,ot,je,Ze,Wt,Ut,Jt;for(Wt=1e3,Jt=-1,He=ve[Be],ot=He-1;He<k||ot>=0;)He<k&&(Ut=ce[He],je=Ut[1]-Be,je>=Wt?He=k:(He++,je<0&&(je=-je),Ze=Ut[0]-Ke,Ze<0&&(Ze=-Ze),je+=Ze,je<Wt&&(Ze=Ut[2]-at,Ze<0&&(Ze=-Ze),je+=Ze,je<Wt&&(Wt=je,Jt=Ut[3])))),ot>=0&&(Ut=ce[ot],je=Be-Ut[1],je>=Wt?ot=-1:(ot--,je<0&&(je=-je),Ze=Ut[0]-Ke,Ze<0&&(Ze=-Ze),je+=Ze,je<Wt&&(Ze=Ut[2]-at,Ze<0&&(Ze=-Ze),je+=Ze,je<Wt&&(Wt=je,Jt=Ut[3]))));return Jt}function ft(){return Ht(),Tt(),gt(),it()}function Tt(){var Ke;for(Ke=0;Ke<k;Ke++)ce[Ke][0]>>=L,ce[Ke][1]>>=L,ce[Ke][2]>>=L,ce[Ke][3]=Ke}function Lt(Ke,Be,at,He,ot){var je,Ze,Wt,Ut,Jt,kn,hr;for(Wt=Be-Ke,Wt<-1&&(Wt=-1),Ut=Be+Ke,Ut>k&&(Ut=k),je=Be+1,Ze=Be-1,kn=1;je<Ut||Ze>Wt;){if(Jt=$e[kn++],je<Ut){hr=ce[je++];try{hr[0]-=Jt*(hr[0]-at)/ee|0,hr[1]-=Jt*(hr[1]-He)/ee|0,hr[2]-=Jt*(hr[2]-ot)/ee|0}catch{}}if(Ze>Wt){hr=ce[Ze--];try{hr[0]-=Jt*(hr[0]-at)/ee|0,hr[1]-=Jt*(hr[1]-He)/ee|0,hr[2]-=Jt*(hr[2]-ot)/ee|0}catch{}}}}function It(Ke,Be,at,He,ot){var je=ce[Be],Ze=Ke/Me;je[0]-=Ze*(je[0]-at)|0,je[1]-=Ze*(je[1]-He)|0,je[2]-=Ze*(je[2]-ot)|0}function bt(Ke,Be,at){var He,ot,je,Ze,Wt,Ut,Jt,kn,hr,F;for(kn=~(1<<31),hr=kn,Ut=-1,Jt=Ut,He=0;He<k;He++)F=ce[He],ot=F[0]-Ke,ot<0&&(ot=-ot),je=F[1]-Be,je<0&&(je=-je),ot+=je,je=F[2]-at,je<0&&(je=-je),ot+=je,ot<kn&&(kn=ot,Ut=He),Ze=ot-(de[He]>>Y-L),Ze<hr&&(hr=Ze,Jt=He),Wt=Te[He]>>te,Te[He]-=Wt,de[He]+=Wt<<re;return Te[Ut]+=ge,de[Ut]-=H,Jt}Fe.apply(this,arguments);var ht={};return ht.map=ut,ht.process=ft,ht}function m(){var k=this;try{k.onmessage=function(C){var O=C.data||{},S;O.gifshot&&(S=w.run(O),postMessage(S))}}catch{}var w={dataToRGB:function(O,S,A){for(var I=S*A*4,L=0,V=[];L<I;)V.push(O[L++]),V.push(O[L++]),V.push(O[L++]),L++;return V},componentizedPaletteToArray:function(O){O=O||[];for(var S=[],A=0;A<O.length;A+=3){var I=O[A],L=O[A+1],V=O[A+2];S.push(I<<16|L<<8|V)}return S},processFrameWithQuantizer:function(O,S,A,I){for(var L=this.dataToRGB(O,S,A),V=new y(L,L.length,I),Y=V.process(),ae=new Uint32Array(this.componentizedPaletteToArray(Y)),re=S*A,te=new Uint8Array(re),ge=0,H=0;H<re;H++){var Ce=L[ge++],oe=L[ge++],Oe=L[ge++];te[H]=V.map(Ce,oe,Oe)}return{pixels:te,palette:ae}},run:function(O){O=O||{};var S=O,A=S.height;S.palette;var I=S.sampleInterval,L=S.width,V=O.data;return this.processFrameWithQuantizer(V,L,A,I)}};return w}function b(k,w,C,O){var S=0;O=O===a?{}:O;var A=O.loop===a?null:O.loop,I=O.palette===a?null:O.palette;if(w<=0||C<=0||w>65535||C>65535)throw"Width/Height invalid.";function L(te){var ge=te.length;if(ge<2||ge>256||ge&ge-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return ge}k[S++]=71,k[S++]=73,k[S++]=70,k[S++]=56,k[S++]=57,k[S++]=97;var V=0,Y=0;if(k[S++]=w&255,k[S++]=w>>8&255,k[S++]=C&255,k[S++]=C>>8&255,k[S++]=(I!==null?128:0)|V,k[S++]=Y,k[S++]=0,A!==null){if(A<0||A>65535)throw"Loop count invalid.";k[S++]=33,k[S++]=255,k[S++]=11,k[S++]=78,k[S++]=69,k[S++]=84,k[S++]=83,k[S++]=67,k[S++]=65,k[S++]=80,k[S++]=69,k[S++]=50,k[S++]=46,k[S++]=48,k[S++]=3,k[S++]=1,k[S++]=A&255,k[S++]=A>>8&255,k[S++]=0}var ae=!1;this.addFrame=function(te,ge,H,Ce,oe,Oe){if(ae===!0&&(--S,ae=!1),Oe=Oe===a?{}:Oe,te<0||ge<0||te>65535||ge>65535)throw"x/y invalid.";if(H<=0||Ce<=0||H>65535||Ce>65535)throw"Width/Height invalid.";if(oe.length<H*Ce)throw"Not enough pixels for the frame size.";var Ee=!0,be=Oe.palette;if((be===a||be===null)&&(Ee=!1,be=I),be===a||be===null)throw"Must supply either a local or global palette.";for(var Ie=L(be),Me=0;Ie>>=1;)++Me;Ie=1<<Me;var j=Oe.delay===a?0:Oe.delay,U=Oe.disposal===a?0:Oe.disposal;if(U<0||U>3)throw"Disposal out of range.";var Q=!1,fe=0;if(Oe.transparent!==a&&Oe.transparent!==null&&(Q=!0,fe=Oe.transparent,fe<0||fe>=Ie))throw"Transparent color index.";if((U!==0||Q||j!==0)&&(k[S++]=33,k[S++]=249,k[S++]=4,k[S++]=U<<2|(Q===!0?1:0),k[S++]=j&255,k[S++]=j>>8&255,k[S++]=fe,k[S++]=0),k[S++]=44,k[S++]=te&255,k[S++]=te>>8&255,k[S++]=ge&255,k[S++]=ge>>8&255,k[S++]=H&255,k[S++]=H>>8&255,k[S++]=Ce&255,k[S++]=Ce>>8&255,k[S++]=Ee===!0?128|Me-1:0,Ee===!0)for(var ee=0,pe=be.length;ee<pe;++ee){var se=be[ee];k[S++]=se>>16&255,k[S++]=se>>8&255,k[S++]=se&255}S=re(k,S,Me<2?2:Me,oe)},this.end=function(){return ae===!1&&(k[S++]=59,ae=!0),S};function re(te,ge,H,Ce){te[ge++]=H;var oe=ge++,Oe=1<<H,Ee=Oe-1,be=Oe+1,Ie=be+1,Me=H+1,j=0,U=0;function Q(Te){for(;j>=Te;)te[ge++]=U&255,U>>=8,j-=8,ge===oe+256&&(te[oe]=255,oe=ge++)}function fe(Te){U|=Te<<j,j+=Me,Q(8)}var ee=Ce[0]&Ee,pe={};fe(Oe);for(var se=1,ue=Ce.length;se<ue;++se){var ce=Ce[se]&Ee,ve=ee<<8|ce,de=pe[ve];if(de===a){for(U|=ee<<j,j+=Me;j>=8;)te[ge++]=U&255,U>>=8,j-=8,ge===oe+256&&(te[oe]=255,oe=ge++);Ie===4096?(fe(Oe),Ie=be+1,Me=H+1,pe={}):(Ie>=1<<Me&&++Me,pe[ve]=Ie++),ee=ce}else ee=de}return fe(ee),fe(be),Q(1),oe+1===ge?te[oe]=0:(te[oe]=ge-oe-1,te[ge++]=0),ge}}var _=function(){},x=function(w){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=_,this.onRenderProgressCallback=_,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=w,this.initializeWebWorkers(w)};x.prototype={workerMethods:m(),initializeWebWorkers:function(w){var C=this,O=y.toString()+"("+m.toString()+"());",S=void 0,A=void 0,I=void 0,L=void 0,V=-1,Y="";for(L=w.numWorkers;++V<L;)S=o.createWebWorker(O),o.isObject(S)?(A=S.objectUrl,I=S.worker,C.workers.push({worker:I,objectUrl:A}),C.availableWorkers.push(I)):(Y=S,o.webWorkerError=!!S);this.workerError=Y,this.canvas=n.createElement("canvas"),this.canvas.width=w.gifWidth,this.canvas.height=w.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(w){this.availableWorkers.push(w)},byteMap:function(){for(var k=[],w=0;w<256;w++)k[w]=String.fromCharCode(w);return k}(),bufferToString:function(w){for(var C=w.length,O="",S=-1;++S<C;)O+=this.byteMap[w[S]];return O},onFrameFinished:function(w){var C=this,O=C.frames,S=C.options,A=!!(S.images||[]).length,I=O.every(function(L){return!L.beingProcessed&&L.done});C.numRenderedFrames++,A&&w(C.numRenderedFrames/O.length),C.onRenderProgressCallback(C.numRenderedFrames*.75/O.length),I?C.generatingGIF||C.generateGIF(O,C.onRenderCompleteCallback):o.requestTimeout(function(){C.processNextFrame()},1)},processFrame:function(w){var C=this;this.options;var O=this.options,S=O.progressCallback,A=O.sampleInterval,I=this.frames,L=void 0,V=void 0,Y=function(){var re=arguments.length>0&&arguments[0]!==a?arguments[0]:{},te=re.data;delete L.data,L.pixels=Array.prototype.slice.call(te.pixels),L.palette=Array.prototype.slice.call(te.palette),L.done=!0,L.beingProcessed=!1,C.freeWorker(V),C.onFrameFinished(S)};if(L=I[w],L.beingProcessed||L.done){this.onFrameFinished();return}L.sampleInterval=A,L.beingProcessed=!0,L.gifshot=!0,V=this.getWorker(),V?(V.onmessage=Y,V.postMessage(L)):Y({data:C.workerMethods.run(L)})},startRendering:function(w){this.onRenderCompleteCallback=w;for(var C=0;C<this.options.numWorkers&&C<this.frames.length;C++)this.processFrame(C)},processNextFrame:function(){for(var w=-1,C=0;C<this.frames.length;C++){var O=this.frames[C];if(!O.done&&!O.beingProcessed){w=C;break}}w>=0&&this.processFrame(w)},generateGIF:function(w,C){var O=[],S={loop:this.repeat},A=this.options,I=A.interval,L=A.frameDuration,V=A.images,Y=!!V.length,ae=A.gifHeight,re=A.gifWidth,te=new b(O,re,ae,S),ge=this.onRenderProgressCallback,H=Y?I*100:0,Ce=void 0,oe=void 0;this.generatingGIF=!0,o.each(w,function(Oe,Ee){var be=Ee.palette;ge(.75+.25*Ee.position*1/w.length);for(var Ie=0;Ie<L;Ie++)te.addFrame(0,0,re,ae,Ee.pixels,{palette:be,delay:H})}),te.end(),ge(1),this.frames=[],this.generatingGIF=!1,o.isFunction(C)&&(Ce=this.bufferToString(O),oe="data:image/gif;base64,"+o.btoa(Ce),C(oe))},setRepeat:function(w){this.repeat=w},addFrame:function(w,C){C=o.isObject(C)?C:{};var O=this,S=O.ctx,A=O.options,I=A.gifWidth,L=A.gifHeight,V=o.getFontSize(C),Y=C,ae=Y.filter,re=Y.fontColor,te=Y.fontFamily,ge=Y.fontWeight;Y.gifHeight,Y.gifWidth;var H=Y.text,Ce=Y.textAlign,oe=Y.textBaseline,Oe=C.textXCoordinate?C.textXCoordinate:Ce==="left"?1:Ce==="right"?I:I/2,Ee=C.textYCoordinate?C.textYCoordinate:oe==="top"?1:oe==="center"?L/2:L,be=ge+" "+V+" "+te,Ie=void 0;try{S.filter=ae,S.drawImage(w,0,0,I,L),H&&(S.font=be,S.fillStyle=re,S.textAlign=Ce,S.textBaseline=oe,S.fillText(H,Oe,Ee)),Ie=S.getImageData(0,0,I,L),O.addFrameImageData(Ie)}catch(Me){return""+Me}},addFrameImageData:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{},C=this.frames,O=w.data;this.frames.push({data:O,width:w.width,height:w.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:C.length})},onRenderProgress:function(w){this.onRenderProgressCallback=w},isRendering:function(){return this.generatingGIF},getBase64GIF:function(w){var C=this,O=function(A){C.destroyWorkers(),o.requestTimeout(function(){w(A)},0)};C.startRendering(O)},destroyWorkers:function(){if(!this.workerError){var w=this.workers;o.each(w,function(C,O){var S=O.worker,A=O.objectUrl;S.terminate(),o.URL.revokeObjectURL(A)})}}};function T(k,w){k.getBase64GIF(function(C){w({error:!1,errorCode:"",errorMsg:"",image:C})})}function E(){var k=arguments.length>0&&arguments[0]!==a?arguments[0]:{},w=k.callback,C=k.images,O=k.options,S=k.imagesLength,A={getUserMedia:!0,"window.URL":!0},I=l.validate(A),L=[],V=0,Y=void 0,ae=void 0;if(I.error)return w(I);ae=new x(O),o.each(C,function(te,ge){var H=ge;ge.src&&(H=H.src),o.isElement(H)?(O.crossOrigin&&(H.crossOrigin=O.crossOrigin),L[te]=H,V+=1,V===S&&re()):o.isString(H)&&(Y=new Image,O.crossOrigin&&(Y.crossOrigin=O.crossOrigin),function(Ce){ge.text&&(Ce.text=ge.text),Ce.onerror=function(oe){var Oe=void 0;if(--S,S===0)return Oe={},Oe.error="None of the requested images was capable of being retrieved",w(Oe)},Ce.onload=function(oe){ge.text?L[te]={img:Ce,text:Ce.text}:L[te]=Ce,V+=1,V===S&&re(),o.removeElement(Ce)},Ce.src=H}(Y),o.setCSSAttr(Y,{position:"fixed",opacity:"0"}),n.body.appendChild(Y))});function re(){o.each(L,function(te,ge){ge&&(ge.text?ae.addFrame(ge.img,O,ge.text):ae.addFrame(ge,O))}),T(ae,w)}}var P=function(){},R={getGIF:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{},C=arguments[1];C=o.isFunction(C)?C:P;var O=n.createElement("canvas"),S=void 0,A=w.images,I=!!A.length,L=w.cameraStream,V=w.crop,Y=w.filter,ae=w.fontColor,re=w.fontFamily,te=w.fontWeight,ge=w.keepCameraOn;w.numWorkers;var H=w.progressCallback,Ce=w.saveRenderingContexts,oe=w.savedRenderingContexts,Oe=w.text,Ee=w.textAlign,be=w.textBaseline,Ie=w.videoElement,Me=w.videoHeight,j=w.videoWidth,U=w.webcamVideoElement,Q=Number(w.gifWidth),fe=Number(w.gifHeight),ee=Number(w.interval);Number(w.sampleInterval);var pe=I?0:ee*1e3,se=[],ue=oe.length?oe.length:w.numFrames,ce=ue,ve=new x(w),de=o.getFontSize(w),Te=w.textXCoordinate?w.textXCoordinate:Ee==="left"?1:Ee==="right"?Q:Q/2,$e=w.textYCoordinate?w.textYCoordinate:be==="top"?1:be==="center"?fe/2:fe,Fe=te+" "+de+" "+re,it=V?Math.floor(V.scaledWidth/2):0,gt=V?j-V.scaledWidth:0,Ht=V?Math.floor(V.scaledHeight/2):0,ut=V?Me-V.scaledHeight:0,ft=function Tt(){var Lt=ce-1;oe.length?(S.putImageData(oe[ue-ce],0,0),bt()):It();function It(){try{gt>j&&(gt=j),ut>Me&&(ut=Me),it<0&&(it=0),Ht<0&&(Ht=0),S.filter=Y,S.drawImage(Ie,it,Ht,gt,ut,0,0,Q,fe),bt()}catch(ht){if(ht.name==="NS_ERROR_NOT_AVAILABLE")o.requestTimeout(It,100);else throw ht}}function bt(){var ht=void 0;Ce&&se.push(S.getImageData(0,0,Q,fe)),Oe&&(S.font=Fe,S.fillStyle=ae,S.textAlign=Ee,S.textBaseline=be,S.fillText(Oe,Te,$e)),ht=S.getImageData(0,0,Q,fe),ve.addFrameImageData(ht),ce=Lt,H((ue-ce)/ue),Lt>0&&o.requestTimeout(Tt,pe),ce||ve.getBase64GIF(function(Ke){C({error:!1,errorCode:"",errorMsg:"",image:Ke,cameraStream:L,videoElement:Ie,webcamVideoElement:U,savedRenderingContexts:se,keepCameraOn:ge})})}};ue=ue!==a?ue:10,ee=ee!==a?ee:.1,O.width=Q,O.height=fe,S=O.getContext("2d"),function Tt(){if(!oe.length&&Ie.currentTime===0){o.requestTimeout(Tt,100);return}ft()}()},getCropDimensions:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{},C=w.videoWidth,O=w.videoHeight,S=w.gifWidth,A=w.gifHeight,I={width:0,height:0,scaledWidth:0,scaledHeight:0};return C>O?(I.width=Math.round(C*(A/O))-S,I.scaledWidth=Math.round(I.width*(O/A))):(I.height=Math.round(O*(S/C))-A,I.scaledHeight=Math.round(I.height*(C/S))),I}},M={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function k(w){k.attempts=k.attempts||0;var C=w.cameraStream,O=w.completedCallback,S=w.videoElement;S&&(S.videoWidth>0&&S.videoHeight>0?(S.removeEventListener("loadeddata",M.findVideoSize),O({videoElement:S,cameraStream:C,videoWidth:S.videoWidth,videoHeight:S.videoHeight})):k.attempts<10?(k.attempts+=1,o.requestTimeout(function(){M.findVideoSize(w)},400)):O({videoElement:S,cameraStream:C,videoWidth:M.defaultVideoDimensions.width,videoHeight:M.defaultVideoDimensions.height}))},onStreamingTimeout:function(w){o.isFunction(w)&&w({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(w){var C=o.isArray(w.existingVideo)?w.existingVideo[0]:w.existingVideo,O=w.cameraStream,S=w.completedCallback,A=w.streamedCallback,I=w.videoElement;if(o.isFunction(A)&&A(),C){if(o.isString(C))I.src=C,I.innerHTML='<source src="'+C+'" type="video/'+o.getExtension(C)+'" />';else if(C instanceof Blob){try{I.src=o.URL.createObjectURL(C)}catch{}I.innerHTML='<source src="'+C+'" type="'+C.type+'" />'}}else if(I.mozSrcObject)I.mozSrcObject=O;else if(o.URL)try{I.srcObject=O,I.src=o.URL.createObjectURL(O)}catch{I.srcObject=O}I.play(),o.requestTimeout(function L(){L.count=L.count||0,M.loadedData===!0?(M.findVideoSize({videoElement:I,cameraStream:O,completedCallback:S}),M.loadedData=!1):(L.count+=1,L.count>10?M.findVideoSize({videoElement:I,cameraStream:O,completedCallback:S}):L())},0)},startStreaming:function(w){var C=o.isFunction(w.error)?w.error:o.noop,O=o.isFunction(w.streamed)?w.streamed:o.noop,S=o.isFunction(w.completed)?w.completed:o.noop,A=w.crossOrigin,I=w.existingVideo,L=w.lastCameraStream,V=w.options,Y=w.webcamVideoElement,ae=o.isElement(I)?I:Y||n.createElement("video");A&&(ae.crossOrigin=V.crossOrigin),ae.autoplay=!0,ae.loop=!0,ae.muted=!0,ae.addEventListener("loadeddata",function(re){M.loadedData=!0,V.offset&&(ae.currentTime=V.offset)}),I?M.stream({videoElement:ae,existingVideo:I,completedCallback:S}):L?M.stream({videoElement:ae,cameraStream:L,streamedCallback:O,completedCallback:S}):o.getUserMedia({video:!0},function(re){M.stream({videoElement:ae,cameraStream:re,streamedCallback:O,completedCallback:S})},C)},startVideoStreaming:function(w){var C=arguments.length>1&&arguments[1]!==a?arguments[1]:{},O=C.timeout!==a?C.timeout:0,S=C.callback,A=C.webcamVideoElement,I=void 0;O>0&&(I=o.requestTimeout(function(){M.onStreamingTimeout(S)},1e4)),M.startStreaming({error:function(){S({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(I)},completed:function(){var V=arguments.length>0&&arguments[0]!==a?arguments[0]:{},Y=V.cameraStream,ae=V.videoElement,re=V.videoHeight,te=V.videoWidth;w({cameraStream:Y,videoElement:ae,videoHeight:re,videoWidth:te})},lastCameraStream:C.lastCameraStream,webcamVideoElement:A,crossOrigin:C.crossOrigin,options:C})},stopVideoStreaming:function(w){w=o.isObject(w)?w:{};var C=w,O=C.keepCameraOn,S=C.videoElement,A=C.webcamVideoElement,I=w.cameraStream||{},L=I.getTracks?I.getTracks()||[]:[],V=!!L.length,Y=L[0];!O&&V&&o.isFunction(Y.stop)&&Y.stop(),o.isElement(S)&&!A&&(S.pause(),o.isFunction(o.URL.revokeObjectURL)&&!o.webWorkerError&&S.src&&o.URL.revokeObjectURL(S.src),o.removeElement(S))}};function D(k){k=o.isObject(k)?k:{},M.stopVideoStreaming(k)}function N(k,w){var C=k.options||{},O=C.images,S=C.video,A=Number(C.gifWidth),I=Number(C.gifHeight);Number(C.numFrames);var L=k.cameraStream,V=k.videoElement,Y=k.videoWidth,ae=k.videoHeight,re=R.getCropDimensions({videoWidth:Y,videoHeight:ae,gifHeight:I,gifWidth:A}),te=w;C.crop=re,C.videoElement=V,C.videoWidth=Y,C.videoHeight=ae,C.cameraStream=L,o.isElement(V)&&(V.width=A+re.width,V.height=I+re.height,C.webcamVideoElement||(o.setCSSAttr(V,{position:"fixed",opacity:"0"}),n.body.appendChild(V)),V.play(),R.getGIF(C,function(ge){(!O||!O.length)&&(!S||!S.length)&&D(ge),te(ge)}))}function B(){var k=arguments.length>0&&arguments[0]!==a?arguments[0]:{},w=k.callback,C=k.existingVideo,O=k.options,S={getUserMedia:!0,"window.URL":!0},A=l.validate(S),I=void 0,L=void 0;if(A.error)return w(A);if(o.isElement(C)&&C.src){if(L=C.src,I=o.getExtension(L),!o.isSupported.videoCodecs[I])return w(l.messages.videoCodecs)}else o.isArray(C)&&o.each(C,function(V,Y){if(Y instanceof Blob?I=Y.type.substr(Y.type.lastIndexOf("/")+1,Y.length):I=Y.substr(Y.lastIndexOf(".")+1,Y.length),o.isSupported.videoCodecs[I])return C=Y,!1});M.startStreaming({completed:function(Y){Y.options=O||{},N(Y,w)},existingVideo:C,crossOrigin:O.crossOrigin,options:O})}function K(){var k=arguments.length>0&&arguments[0]!==a?arguments[0]:{},w=k.callback,C=k.lastCameraStream,O=k.options,S=k.webcamVideoElement;if(!v())return w(l.validate());if(O.savedRenderingContexts.length){R.getGIF(O,function(A){w(A)});return}M.startVideoStreaming(function(){var A=arguments.length>0&&arguments[0]!==a?arguments[0]:{};A.options=O||{},N(A,w)},{lastCameraStream:C,callback:w,webcamVideoElement:S,crossOrigin:O.crossOrigin})}function Z(k,w){if(w=o.isFunction(k)?k:w,k=o.isObject(k)?k:{},!!o.isFunction(w)){var C=o.mergeOptions(c,k)||{},O=k.cameraStream,S=C.images,A=S?S.length:0,I=C.video,L=C.webcamVideoElement;C=o.mergeOptions(C,{gifWidth:Math.floor(C.gifWidth),gifHeight:Math.floor(C.gifHeight)}),A?E({images:S,imagesLength:A,callback:w,options:C}):I?B({existingVideo:I,callback:w,options:C}):K({lastCameraStream:O,callback:w,webcamVideoElement:L,options:C})}}function ie(k,w){if(w=o.isFunction(k)?k:w,k=o.isObject(k)?k:{},!!o.isFunction(w)){var C=o.mergeOptions(c,k),O=o.mergeOptions(C,{interval:.1,numFrames:1,gifWidth:Math.floor(C.gifWidth),gifHeight:Math.floor(C.gifHeight)});Z(O,w)}}var me={utils:s,error:u,defaultOptions:h,createGIF:Z,takeSnapShot:ie,stopVideoStreaming:D,isSupported:d,isWebCamGIFSupported:v,isExistingVideoGIFSupported:g,isExistingImagesGIFSupported:p,VERSION:"0.4.5"};typeof a=="function"&&a.amd?a([],function(){return me}):e.exports=me})(typeof window<"u"?window:{},typeof document<"u"?document:{createElement:function(){}},typeof window<"u"?window.navigator:{})})(ICe);const MCe=sM,DCe={class:"preview-block"},$Ce={class:"v-chart-box"},NCe={key:0,class:"iconfont icon-weibiaoti519"},LCe={key:1,class:"iconfont icon-bofang"},FCe=_i({__name:"previewBlock",setup(e){Du([o1e,Bwe,K_e,v_e,I_e,M1e,A1e,Y1e]),mL("westeros",ehe),Xq(fCe,"westeros");const t=ml(Qo),r=eo(()=>~t.value.type.indexOf(fce)),n=Mn(null),i=Mn(!1),a=Mn(!1);let o=[],s=null;bd(()=>Mw.value,d=>{i.value=d==="start",a.value&&d==="end"&&h()},{deep:!0});const l=eo(()=>t!=null&&t.value.id?r.value?qW(t.value,0):CCe(t.value):{}),u=()=>{i.value=!i.value,i.value?ZW(t.value,f):ACe()},f=d=>{VC(()=>{var p;const v=(p=n.value)==null?void 0:p.setOption;v&&v(qW(t.value,d))})},c=()=>{o=[],s=setInterval(()=>{var v;const d=(v=n.value)==null?void 0:v.getDataURL({type:"png",pixelRatio:3,backgroundColor:t.value.config.backgroundColor});o.push(d)},100)},h=()=>{clearInterval(s),!(!o.length||!a.value)&&(MCe.createGIF({gifWidth:1e3,gifHeight:630,interval:.1,images:o},d=>{if(!d.error){const v=d.image;console.log("src: ",v),JW(t.value,v,"gif"),o=[],Ta.emit("chartLoading",!1)}}),a.value=!1)};return Ta.on("handleChart",d=>{r.value?(Ta.emit("chartLoading",!0),fte(),ZW(t.value,f),a.value=!0,c()):VC(()=>{var p;Ta.emit("chartLoading",!0);const v=(p=n.value)==null?void 0:p.getDataURL({type:"png",pixelRatio:10,backgroundColor:t.value.config.backgroundColor});JW(t.value,v,"png"),setTimeout(()=>{Ta.emit("chartLoading",!1)},1e3)})}),Kq(()=>{o=[],clearInterval(s)}),(d,v)=>(Yt(),vr("div",DCe,[$t("div",$Ce,[rn(Tr(cCe),{ref_key:"chartRef",ref:n,class:"chart",autoresize:"",option:Tr(l)},null,8,["option"]),Tr(r)?(Yt(),vr("div",{key:0,class:"play-btn",onClick:u},[i.value?(Yt(),vr("i",NCe)):(Yt(),vr("i",LCe))])):Rc("",!0)])]))}});const HCe=Ma(FCe,[["__scopeId","data-v-836df3e8"]]);var SS=function(e){return e&&e.Math==Math&&e},Sr=SS(typeof globalThis=="object"&&globalThis)||SS(typeof window=="object"&&window)||SS(typeof self=="object"&&self)||SS(typeof qP=="object"&&qP)||function(){return this}()||Function("return this")(),ns={},Ct=function(e){try{return!!e()}catch{return!0}},BCe=Ct,an=!BCe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),VCe=Ct,Dw=!VCe(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),jCe=Dw,CS=Function.prototype.call,gn=jCe?CS.bind(CS):function(){return CS.apply(CS,arguments)},$w={},cte={}.propertyIsEnumerable,hte=Object.getOwnPropertyDescriptor,WCe=hte&&!cte.call({1:2},1);$w.f=WCe?function(t){var r=hte(this,t);return!!r&&r.enumerable}:cte;var Nw=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},dte=Dw,vte=Function.prototype,lM=vte.call,UCe=dte&&vte.bind.bind(lM,lM),Pt=dte?UCe:function(e){return function(){return lM.apply(e,arguments)}},pte=Pt,zCe=pte({}.toString),GCe=pte("".slice),is=function(e){return GCe(zCe(e),8,-1)},YCe=Pt,KCe=Ct,XCe=is,ck=Object,qCe=YCe("".split),Lw=KCe(function(){return!ck("z").propertyIsEnumerable(0)})?function(e){return XCe(e)=="String"?qCe(e,""):ck(e)}:ck,bo=function(e){return e==null},ZCe=bo,JCe=TypeError,Fi=function(e){if(ZCe(e))throw JCe("Can't call method on "+e);return e},QCe=Lw,exe=Fi,aa=function(e){return QCe(exe(e))},uM=typeof document=="object"&&document.all,txe=typeof uM>"u"&&uM!==void 0,gte={all:uM,IS_HTMLDDA:txe},yte=gte,rxe=yte.all,Rr=yte.IS_HTMLDDA?function(e){return typeof e=="function"||e===rxe}:function(e){return typeof e=="function"},QW=Rr,mte=gte,nxe=mte.all,on=mte.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:QW(e)||e===nxe}:function(e){return typeof e=="object"?e!==null:QW(e)},hk=Sr,ixe=Rr,axe=function(e){return ixe(e)?e:void 0},_l=function(e,t){return arguments.length<2?axe(hk[e]):hk[e]&&hk[e][t]},oxe=Pt,Wu=oxe({}.isPrototypeOf),th=typeof navigator<"u"&&String(navigator.userAgent)||"",bte=Sr,dk=th,eU=bte.process,tU=bte.Deno,rU=eU&&eU.versions||tU&&tU.version,nU=rU&&rU.v8,to,yx;nU&&(to=nU.split("."),yx=to[0]>0&&to[0]<4?1:+(to[0]+to[1]));!yx&&dk&&(to=dk.match(/Edge\/(\d+)/),(!to||to[1]>=74)&&(to=dk.match(/Chrome\/(\d+)/),to&&(yx=+to[1])));var Fw=yx,iU=Fw,sxe=Ct,Tg=!!Object.getOwnPropertySymbols&&!sxe(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&iU&&iU<41}),lxe=Tg,wte=lxe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",uxe=_l,fxe=Rr,cxe=Wu,hxe=wte,dxe=Object,Hw=hxe?function(e){return typeof e=="symbol"}:function(e){var t=uxe("Symbol");return fxe(t)&&cxe(t.prototype,dxe(e))},vxe=String,Og=function(e){try{return vxe(e)}catch{return"Object"}},pxe=Rr,gxe=Og,yxe=TypeError,rh=function(e){if(pxe(e))return e;throw yxe(gxe(e)+" is not a function")},mxe=rh,bxe=bo,nh=function(e,t){var r=e[t];return bxe(r)?void 0:mxe(r)},vk=gn,pk=Rr,gk=on,wxe=TypeError,_te=function(e,t){var r,n;if(t==="string"&&pk(r=e.toString)&&!gk(n=vk(r,e))||pk(r=e.valueOf)&&!gk(n=vk(r,e))||t!=="string"&&pk(r=e.toString)&&!gk(n=vk(r,e)))return n;throw wxe("Can't convert object to primitive value")},$u={},_xe={get exports(){return $u},set exports(e){$u=e}},Sxe=!1,aU=Sr,Cxe=Object.defineProperty,$L=function(e,t){try{Cxe(aU,e,{value:t,configurable:!0,writable:!0})}catch{aU[e]=t}return t},xxe=Sr,Txe=$L,oU="__core-js_shared__",Oxe=xxe[oU]||Txe(oU,{}),NL=Oxe,sU=NL;(_xe.exports=function(e,t){return sU[e]||(sU[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Exe=Fi,Rxe=Object,Hi=function(e){return Rxe(Exe(e))},kxe=Pt,Axe=Hi,Pxe=kxe({}.hasOwnProperty),jr=Object.hasOwn||function(t,r){return Pxe(Axe(t),r)},Ixe=Pt,Mxe=0,Dxe=Math.random(),$xe=Ixe(1 .toString),OO=function(e){return"Symbol("+(e===void 0?"":e)+")_"+$xe(++Mxe+Dxe,36)},Nxe=Sr,Lxe=$u,lU=jr,Fxe=OO,Hxe=Tg,Bxe=wte,Td=Nxe.Symbol,yk=Lxe("wks"),Vxe=Bxe?Td.for||Td:Td&&Td.withoutSetter||Fxe,xr=function(e){return lU(yk,e)||(yk[e]=Hxe&&lU(Td,e)?Td[e]:Vxe("Symbol."+e)),yk[e]},jxe=gn,uU=on,fU=Hw,Wxe=nh,Uxe=_te,zxe=xr,Gxe=TypeError,Yxe=zxe("toPrimitive"),Ste=function(e,t){if(!uU(e)||fU(e))return e;var r=Wxe(e,Yxe),n;if(r){if(t===void 0&&(t="default"),n=jxe(r,e,t),!uU(n)||fU(n))return n;throw Gxe("Can't convert object to primitive value")}return t===void 0&&(t="number"),Uxe(e,t)},Kxe=Ste,Xxe=Hw,EO=function(e){var t=Kxe(e,"string");return Xxe(t)?t:t+""},qxe=Sr,cU=on,fM=qxe.document,Zxe=cU(fM)&&cU(fM.createElement),RO=function(e){return Zxe?fM.createElement(e):{}},Jxe=an,Qxe=Ct,eTe=RO,Cte=!Jxe&&!Qxe(function(){return Object.defineProperty(eTe("div"),"a",{get:function(){return 7}}).a!=7}),tTe=an,rTe=gn,nTe=$w,iTe=Nw,aTe=aa,oTe=EO,sTe=jr,lTe=Cte,hU=Object.getOwnPropertyDescriptor;ns.f=tTe?hU:function(t,r){if(t=aTe(t),r=oTe(r),lTe)try{return hU(t,r)}catch{}if(sTe(t,r))return iTe(!rTe(nTe.f,t,r),t[r])};var Si={},uTe=an,fTe=Ct,xte=uTe&&fTe(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),cTe=on,hTe=String,dTe=TypeError,Kr=function(e){if(cTe(e))return e;throw dTe(hTe(e)+" is not an object")},vTe=an,pTe=Cte,gTe=xte,xS=Kr,dU=EO,yTe=TypeError,mk=Object.defineProperty,mTe=Object.getOwnPropertyDescriptor,bk="enumerable",wk="configurable",_k="writable";Si.f=vTe?gTe?function(t,r,n){if(xS(t),r=dU(r),xS(n),typeof t=="function"&&r==="prototype"&&"value"in n&&_k in n&&!n[_k]){var i=mTe(t,r);i&&i[_k]&&(t[r]=n.value,n={configurable:wk in n?n[wk]:i[wk],enumerable:bk in n?n[bk]:i[bk],writable:!1})}return mk(t,r,n)}:mk:function(t,r,n){if(xS(t),r=dU(r),xS(n),pTe)try{return mk(t,r,n)}catch{}if("get"in n||"set"in n)throw yTe("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var bTe=an,wTe=Si,_Te=Nw,ih=bTe?function(e,t,r){return wTe.f(e,t,_Te(1,r))}:function(e,t,r){return e[t]=r,e},mx={},STe={get exports(){return mx},set exports(e){mx=e}},cM=an,CTe=jr,Tte=Function.prototype,xTe=cM&&Object.getOwnPropertyDescriptor,LL=CTe(Tte,"name"),TTe=LL&&function(){}.name==="something",OTe=LL&&(!cM||cM&&xTe(Tte,"name").configurable),Bw={EXISTS:LL,PROPER:TTe,CONFIGURABLE:OTe},ETe=Pt,RTe=Rr,hM=NL,kTe=ETe(Function.toString);RTe(hM.inspectSource)||(hM.inspectSource=function(e){return kTe(e)});var Ote=hM.inspectSource,ATe=Sr,PTe=Rr,vU=ATe.WeakMap,Ete=PTe(vU)&&/native code/.test(String(vU)),ITe=$u,MTe=OO,pU=ITe("keys"),kO=function(e){return pU[e]||(pU[e]=MTe(e))},Vw={},DTe=Ete,Rte=Sr,$Te=on,NTe=ih,Sk=jr,Ck=NL,LTe=kO,FTe=Vw,gU="Object already initialized",dM=Rte.TypeError,HTe=Rte.WeakMap,bx,f0,_x,BTe=function(e){return _x(e)?f0(e):bx(e,{})},VTe=function(e){return function(t){var r;if(!$Te(t)||(r=f0(t)).type!==e)throw dM("Incompatible receiver, "+e+" required");return r}};if(DTe||Ck.state){var To=Ck.state||(Ck.state=new HTe);To.get=To.get,To.has=To.has,To.set=To.set,bx=function(e,t){if(To.has(e))throw dM(gU);return t.facade=e,To.set(e,t),t},f0=function(e){return To.get(e)||{}},_x=function(e){return To.has(e)}}else{var $h=LTe("state");FTe[$h]=!0,bx=function(e,t){if(Sk(e,$h))throw dM(gU);return t.facade=e,NTe(e,$h,t),t},f0=function(e){return Sk(e,$h)?e[$h]:{}},_x=function(e){return Sk(e,$h)}}var Sl={set:bx,get:f0,has:_x,enforce:BTe,getterFor:VTe},FL=Pt,jTe=Ct,WTe=Rr,TS=jr,vM=an,UTe=Bw.CONFIGURABLE,zTe=Ote,kte=Sl,GTe=kte.enforce,YTe=kte.get,yU=String,Z1=Object.defineProperty,KTe=FL("".slice),XTe=FL("".replace),qTe=FL([].join),ZTe=vM&&!jTe(function(){return Z1(function(){},"length",{value:8}).length!==8}),JTe=String(String).split("String"),QTe=STe.exports=function(e,t,r){KTe(yU(t),0,7)==="Symbol("&&(t="["+XTe(yU(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!TS(e,"name")||UTe&&e.name!==t)&&(vM?Z1(e,"name",{value:t,configurable:!0}):e.name=t),ZTe&&r&&TS(r,"arity")&&e.length!==r.arity&&Z1(e,"length",{value:r.arity});try{r&&TS(r,"constructor")&&r.constructor?vM&&Z1(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=GTe(e);return TS(n,"source")||(n.source=qTe(JTe,typeof t=="string"?t:"")),e};Function.prototype.toString=QTe(function(){return WTe(this)&&YTe(this).source||zTe(this)},"toString");var eOe=Rr,tOe=Si,rOe=mx,nOe=$L,$a=function(e,t,r,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:t;if(eOe(r)&&rOe(r,a,n),n.global)i?e[t]=r:nOe(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:tOe.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},ah={},iOe=Math.ceil,aOe=Math.floor,oOe=Math.trunc||function(t){var r=+t;return(r>0?aOe:iOe)(r)},sOe=oOe,Uu=function(e){var t=+e;return t!==t||t===0?0:sOe(t)},lOe=Uu,uOe=Math.max,fOe=Math.min,jw=function(e,t){var r=lOe(e);return r<0?uOe(r+t,0):fOe(r,t)},cOe=Uu,hOe=Math.min,oh=function(e){return e>0?hOe(cOe(e),9007199254740991):0},dOe=oh,Na=function(e){return dOe(e.length)},vOe=aa,pOe=jw,gOe=Na,mU=function(e){return function(t,r,n){var i=vOe(t),a=gOe(i),o=pOe(n,a),s;if(e&&r!=r){for(;a>o;)if(s=i[o++],s!=s)return!0}else for(;a>o;o++)if((e||o in i)&&i[o]===r)return e||o||0;return!e&&-1}},HL={includes:mU(!0),indexOf:mU(!1)},yOe=Pt,xk=jr,mOe=aa,bOe=HL.indexOf,wOe=Vw,bU=yOe([].push),Ate=function(e,t){var r=mOe(e),n=0,i=[],a;for(a in r)!xk(wOe,a)&&xk(r,a)&&bU(i,a);for(;t.length>n;)xk(r,a=t[n++])&&(~bOe(i,a)||bU(i,a));return i},BL=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_Oe=Ate,SOe=BL,COe=SOe.concat("length","prototype");ah.f=Object.getOwnPropertyNames||function(t){return _Oe(t,COe)};var Ww={};Ww.f=Object.getOwnPropertySymbols;var xOe=_l,TOe=Pt,OOe=ah,EOe=Ww,ROe=Kr,kOe=TOe([].concat),Pte=xOe("Reflect","ownKeys")||function(t){var r=OOe.f(ROe(t)),n=EOe.f;return n?kOe(r,n(t)):r},wU=jr,AOe=Pte,POe=ns,IOe=Si,Ite=function(e,t,r){for(var n=AOe(t),i=IOe.f,a=POe.f,o=0;o<n.length;o++){var s=n[o];!wU(e,s)&&!(r&&wU(r,s))&&i(e,s,a(t,s))}},MOe=Ct,DOe=Rr,$Oe=/#|\.prototype\./,Uw=function(e,t){var r=LOe[NOe(e)];return r==HOe?!0:r==FOe?!1:DOe(t)?MOe(t):!!t},NOe=Uw.normalize=function(e){return String(e).replace($Oe,".").toLowerCase()},LOe=Uw.data={},FOe=Uw.NATIVE="N",HOe=Uw.POLYFILL="P",AO=Uw,Tk=Sr,BOe=ns.f,VOe=ih,jOe=$a,WOe=$L,UOe=Ite,zOe=AO,vt=function(e,t){var r=e.target,n=e.global,i=e.stat,a,o,s,l,u,f;if(n?o=Tk:i?o=Tk[r]||WOe(r,{}):o=(Tk[r]||{}).prototype,o)for(s in t){if(u=t[s],e.dontCallGetSet?(f=BOe(o,s),l=f&&f.value):l=o[s],a=zOe(n?s:r+(i?".":"#")+s,e.forced),!a&&l!==void 0){if(typeof u==typeof l)continue;UOe(u,l)}(e.sham||l&&l.sham)&&VOe(u,"sham",!0),jOe(o,s,u,e)}},GOe=xr,YOe=GOe("toStringTag"),Mte={};Mte[YOe]="z";var VL=String(Mte)==="[object z]",KOe=VL,XOe=Rr,J1=is,qOe=xr,ZOe=qOe("toStringTag"),JOe=Object,QOe=J1(function(){return arguments}())=="Arguments",eEe=function(e,t){try{return e[t]}catch{}},PO=KOe?J1:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=eEe(t=JOe(e),ZOe))=="string"?r:QOe?J1(t):(n=J1(t))=="Object"&&XOe(t.callee)?"Arguments":n},tEe=PO,rEe=String,sn=function(e){if(tEe(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return rEe(e)},jL={},nEe=Ate,iEe=BL,zw=Object.keys||function(t){return nEe(t,iEe)},aEe=an,oEe=xte,sEe=Si,lEe=Kr,uEe=aa,fEe=zw;jL.f=aEe&&!oEe?Object.defineProperties:function(t,r){lEe(t);for(var n=uEe(r),i=fEe(r),a=i.length,o=0,s;a>o;)sEe.f(t,s=i[o++],n[s]);return t};var cEe=_l,Dte=cEe("document","documentElement"),hEe=Kr,dEe=jL,_U=BL,vEe=Vw,pEe=Dte,gEe=RO,yEe=kO,SU=">",CU="<",pM="prototype",gM="script",$te=yEe("IE_PROTO"),Ok=function(){},Nte=function(e){return CU+gM+SU+e+CU+"/"+gM+SU},xU=function(e){e.write(Nte("")),e.close();var t=e.parentWindow.Object;return e=null,t},mEe=function(){var e=gEe("iframe"),t="java"+gM+":",r;return e.style.display="none",pEe.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(Nte("document.F=Object")),r.close(),r.F},OS,Q1=function(){try{OS=new ActiveXObject("htmlfile")}catch{}Q1=typeof document<"u"?document.domain&&OS?xU(OS):mEe():xU(OS);for(var e=_U.length;e--;)delete Q1[pM][_U[e]];return Q1()};vEe[$te]=!0;var Eg=Object.create||function(t,r){var n;return t!==null?(Ok[pM]=hEe(t),n=new Ok,Ok[pM]=null,n[$te]=t):n=Q1(),r===void 0?n:dEe.f(n,r)},IO={},bEe=EO,wEe=Si,_Ee=Nw,Rg=function(e,t,r){var n=bEe(t);n in e?wEe.f(e,n,_Ee(0,r)):e[n]=r},TU=jw,SEe=Na,CEe=Rg,xEe=Array,TEe=Math.max,WL=function(e,t,r){for(var n=SEe(e),i=TU(t,n),a=TU(r===void 0?n:r,n),o=xEe(TEe(a-i,0)),s=0;i<a;i++,s++)CEe(o,s,e[i]);return o.length=s,o},OEe=is,EEe=aa,Lte=ah.f,REe=WL,Fte=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],kEe=function(e){try{return Lte(e)}catch{return REe(Fte)}};IO.f=function(t){return Fte&&OEe(t)=="Window"?kEe(t):Lte(EEe(t))};var OU=mx,AEe=Si,Gw=function(e,t,r){return r.get&&OU(r.get,t,{getter:!0}),r.set&&OU(r.set,t,{setter:!0}),AEe.f(e,t,r)},UL={},PEe=xr;UL.f=PEe;var IEe=Sr,Hte=IEe,EU=Hte,MEe=jr,DEe=UL,$Ee=Si.f,zL=function(e){var t=EU.Symbol||(EU.Symbol={});MEe(t,e)||$Ee(t,e,{value:DEe.f(e)})},NEe=gn,LEe=_l,FEe=xr,HEe=$a,Bte=function(){var e=LEe("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=FEe("toPrimitive");t&&!t[n]&&HEe(t,n,function(i){return NEe(r,this)},{arity:1})},BEe=Si.f,VEe=jr,jEe=xr,RU=jEe("toStringTag"),MO=function(e,t,r){e&&!r&&(e=e.prototype),e&&!VEe(e,RU)&&BEe(e,RU,{configurable:!0,value:t})},WEe=is,UEe=Pt,Yw=function(e){if(WEe(e)==="Function")return UEe(e)},kU=Yw,zEe=rh,GEe=Dw,YEe=kU(kU.bind),Kw=function(e,t){return zEe(e),t===void 0?e:GEe?YEe(e,t):function(){return e.apply(t,arguments)}},KEe=is,kg=Array.isArray||function(t){return KEe(t)=="Array"},XEe=Pt,qEe=Ct,Vte=Rr,ZEe=PO,JEe=_l,QEe=Ote,jte=function(){},eRe=[],Wte=JEe("Reflect","construct"),GL=/^\s*(?:class|function)\b/,tRe=XEe(GL.exec),rRe=!GL.exec(jte),cy=function(t){if(!Vte(t))return!1;try{return Wte(jte,eRe,t),!0}catch{return!1}},Ute=function(t){if(!Vte(t))return!1;switch(ZEe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return rRe||!!tRe(GL,QEe(t))}catch{return!0}};Ute.sham=!0;var DO=!Wte||qEe(function(){var e;return cy(cy.call)||!cy(Object)||!cy(function(){e=!0})||e})?Ute:cy,AU=kg,nRe=DO,iRe=on,aRe=xr,oRe=aRe("species"),PU=Array,sRe=function(e){var t;return AU(e)&&(t=e.constructor,nRe(t)&&(t===PU||AU(t.prototype))?t=void 0:iRe(t)&&(t=t[oRe],t===null&&(t=void 0))),t===void 0?PU:t},lRe=sRe,YL=function(e,t){return new(lRe(e))(t===0?0:t)},uRe=Kw,fRe=Pt,cRe=Lw,hRe=Hi,dRe=Na,vRe=YL,IU=fRe([].push),Nl=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,a=e==6,o=e==7,s=e==5||a;return function(l,u,f,c){for(var h=hRe(l),d=cRe(h),v=uRe(u,f),p=dRe(d),g=0,y=c||vRe,m=t?y(l,p):r||o?y(l,0):void 0,b,_;p>g;g++)if((s||g in d)&&(b=d[g],_=v(b,g,h),e))if(t)m[g]=_;else if(_)switch(e){case 3:return!0;case 5:return b;case 6:return g;case 2:IU(m,b)}else switch(e){case 4:return!1;case 7:IU(m,b)}return a?-1:n||i?i:m}},sh={forEach:Nl(0),map:Nl(1),filter:Nl(2),some:Nl(3),every:Nl(4),find:Nl(5),findIndex:Nl(6),filterReject:Nl(7)},$O=vt,KL=Sr,XL=gn,pRe=Pt,uv=an,fv=Tg,gRe=Ct,En=jr,yRe=Wu,yM=Kr,NO=aa,qL=EO,mRe=sn,mM=Nw,c0=Eg,zte=zw,bRe=ah,Gte=IO,wRe=Ww,Yte=ns,Kte=Si,_Re=jL,Xte=$w,Ek=$a,SRe=Gw,ZL=$u,CRe=kO,qte=Vw,MU=OO,xRe=xr,TRe=UL,ORe=zL,ERe=Bte,RRe=MO,Zte=Sl,LO=sh.forEach,Ii=CRe("hidden"),FO="Symbol",h0="prototype",kRe=Zte.set,DU=Zte.getterFor(FO),Ea=Object[h0],Cc=KL.Symbol,qy=Cc&&Cc[h0],ARe=KL.TypeError,Rk=KL.QObject,Jte=Yte.f,Ff=Kte.f,Qte=Gte.f,PRe=Xte.f,ere=pRe([].push),hl=ZL("symbols"),Xw=ZL("op-symbols"),IRe=ZL("wks"),bM=!Rk||!Rk[h0]||!Rk[h0].findChild,wM=uv&&gRe(function(){return c0(Ff({},"a",{get:function(){return Ff(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=Jte(Ea,t);n&&delete Ea[t],Ff(e,t,r),n&&e!==Ea&&Ff(Ea,t,n)}:Ff,kk=function(e,t){var r=hl[e]=c0(qy);return kRe(r,{type:FO,tag:e,description:t}),uv||(r.description=t),r},HO=function(t,r,n){t===Ea&&HO(Xw,r,n),yM(t);var i=qL(r);return yM(n),En(hl,i)?(n.enumerable?(En(t,Ii)&&t[Ii][i]&&(t[Ii][i]=!1),n=c0(n,{enumerable:mM(0,!1)})):(En(t,Ii)||Ff(t,Ii,mM(1,{})),t[Ii][i]=!0),wM(t,i,n)):Ff(t,i,n)},JL=function(t,r){yM(t);var n=NO(r),i=zte(n).concat(nre(n));return LO(i,function(a){(!uv||XL(_M,n,a))&&HO(t,a,n[a])}),t},MRe=function(t,r){return r===void 0?c0(t):JL(c0(t),r)},_M=function(t){var r=qL(t),n=XL(PRe,this,r);return this===Ea&&En(hl,r)&&!En(Xw,r)?!1:n||!En(this,r)||!En(hl,r)||En(this,Ii)&&this[Ii][r]?n:!0},tre=function(t,r){var n=NO(t),i=qL(r);if(!(n===Ea&&En(hl,i)&&!En(Xw,i))){var a=Jte(n,i);return a&&En(hl,i)&&!(En(n,Ii)&&n[Ii][i])&&(a.enumerable=!0),a}},rre=function(t){var r=Qte(NO(t)),n=[];return LO(r,function(i){!En(hl,i)&&!En(qte,i)&&ere(n,i)}),n},nre=function(e){var t=e===Ea,r=Qte(t?Xw:NO(e)),n=[];return LO(r,function(i){En(hl,i)&&(!t||En(Ea,i))&&ere(n,hl[i])}),n};fv||(Cc=function(){if(yRe(qy,this))throw ARe("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:mRe(arguments[0]),r=MU(t),n=function(i){this===Ea&&XL(n,Xw,i),En(this,Ii)&&En(this[Ii],r)&&(this[Ii][r]=!1),wM(this,r,mM(1,i))};return uv&&bM&&wM(Ea,r,{configurable:!0,set:n}),kk(r,t)},qy=Cc[h0],Ek(qy,"toString",function(){return DU(this).tag}),Ek(Cc,"withoutSetter",function(e){return kk(MU(e),e)}),Xte.f=_M,Kte.f=HO,_Re.f=JL,Yte.f=tre,bRe.f=Gte.f=rre,wRe.f=nre,TRe.f=function(e){return kk(xRe(e),e)},uv&&(SRe(qy,"description",{configurable:!0,get:function(){return DU(this).description}}),Ek(Ea,"propertyIsEnumerable",_M,{unsafe:!0})));$O({global:!0,constructor:!0,wrap:!0,forced:!fv,sham:!fv},{Symbol:Cc});LO(zte(IRe),function(e){ORe(e)});$O({target:FO,stat:!0,forced:!fv},{useSetter:function(){bM=!0},useSimple:function(){bM=!1}});$O({target:"Object",stat:!0,forced:!fv,sham:!uv},{create:MRe,defineProperty:HO,defineProperties:JL,getOwnPropertyDescriptor:tre});$O({target:"Object",stat:!0,forced:!fv},{getOwnPropertyNames:rre});ERe();RRe(Cc,FO);qte[Ii]=!0;var DRe=Tg,ire=DRe&&!!Symbol.for&&!!Symbol.keyFor,$Re=vt,NRe=_l,LRe=jr,FRe=sn,are=$u,HRe=ire,Ak=are("string-to-symbol-registry"),BRe=are("symbol-to-string-registry");$Re({target:"Symbol",stat:!0,forced:!HRe},{for:function(e){var t=FRe(e);if(LRe(Ak,t))return Ak[t];var r=NRe("Symbol")(t);return Ak[t]=r,BRe[r]=t,r}});var VRe=vt,jRe=jr,WRe=Hw,URe=Og,zRe=$u,GRe=ire,$U=zRe("symbol-to-string-registry");VRe({target:"Symbol",stat:!0,forced:!GRe},{keyFor:function(t){if(!WRe(t))throw TypeError(URe(t)+" is not a symbol");if(jRe($U,t))return $U[t]}});var YRe=Dw,ore=Function.prototype,NU=ore.apply,LU=ore.call,lh=typeof Reflect=="object"&&Reflect.apply||(YRe?LU.bind(NU):function(){return LU.apply(NU,arguments)}),KRe=Pt,qw=KRe([].slice),XRe=Pt,FU=kg,qRe=Rr,HU=is,ZRe=sn,BU=XRe([].push),JRe=function(e){if(qRe(e))return e;if(FU(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?BU(r,i):(typeof i=="number"||HU(i)=="Number"||HU(i)=="String")&&BU(r,ZRe(i))}var a=r.length,o=!0;return function(s,l){if(o)return o=!1,l;if(FU(this))return l;for(var u=0;u<a;u++)if(r[u]===s)return l}}},QRe=vt,sre=_l,lre=lh,eke=gn,Zw=Pt,ure=Ct,VU=Rr,jU=Hw,fre=qw,tke=JRe,rke=Tg,nke=String,hu=sre("JSON","stringify"),ES=Zw(/./.exec),WU=Zw("".charAt),ike=Zw("".charCodeAt),ake=Zw("".replace),oke=Zw(1 .toString),ske=/[\uD800-\uDFFF]/g,UU=/^[\uD800-\uDBFF]$/,zU=/^[\uDC00-\uDFFF]$/,GU=!rke||ure(function(){var e=sre("Symbol")();return hu([e])!="[null]"||hu({a:e})!="{}"||hu(Object(e))!="{}"}),YU=ure(function(){return hu("\uDF06\uD834")!=='"\\udf06\\ud834"'||hu("\uDEAD")!=='"\\udead"'}),lke=function(e,t){var r=fre(arguments),n=tke(t);if(!(!VU(n)&&(e===void 0||jU(e))))return r[1]=function(i,a){if(VU(n)&&(a=eke(n,this,nke(i),a)),!jU(a))return a},lre(hu,null,r)},uke=function(e,t,r){var n=WU(r,t-1),i=WU(r,t+1);return ES(UU,e)&&!ES(zU,i)||ES(zU,e)&&!ES(UU,n)?"\\u"+oke(ike(e,0),16):e};hu&&QRe({target:"JSON",stat:!0,arity:3,forced:GU||YU},{stringify:function(t,r,n){var i=fre(arguments),a=lre(GU?lke:hu,null,i);return YU&&typeof a=="string"?ake(a,ske,uke):a}});var fke=vt,cke=Tg,hke=Ct,cre=Ww,dke=Hi,vke=!cke||hke(function(){cre.f(1)});fke({target:"Object",stat:!0,forced:vke},{getOwnPropertySymbols:function(t){var r=cre.f;return r?r(dke(t)):[]}});var pke=vt,gke=an,yke=Sr,RS=Pt,mke=jr,bke=Rr,wke=Wu,_ke=sn,Ske=Gw,Cke=Ite,_s=yke.Symbol,bf=_s&&_s.prototype;if(gke&&bke(_s)&&(!("description"in bf)||_s().description!==void 0)){var KU={},kS=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:_ke(arguments[0]),r=wke(bf,this)?new _s(t):t===void 0?_s():_s(t);return t===""&&(KU[r]=!0),r};Cke(kS,_s),kS.prototype=bf,bf.constructor=kS;var xke=String(_s("test"))=="Symbol(test)",Tke=RS(bf.valueOf),Oke=RS(bf.toString),Eke=/^Symbol\((.*)\)[^)]+$/,Rke=RS("".replace),kke=RS("".slice);Ske(bf,"description",{configurable:!0,get:function(){var t=Tke(this);if(mke(KU,t))return"";var r=Oke(t),n=xke?kke(r,7,-1):Rke(r,Eke,"$1");return n===""?void 0:n}}),pke({global:!0,constructor:!0,forced:!0},{Symbol:kS})}var Ake=zL;Ake("iterator");var Pke=an,Ike=Bw.EXISTS,hre=Pt,Mke=Gw,dre=Function.prototype,Dke=hre(dre.toString),vre=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,$ke=hre(vre.exec),Nke="name";Pke&&!Ike&&Mke(dre,Nke,{configurable:!0,get:function(){try{return $ke(vre,Dke(this))[1]}catch{return""}}});var Lke=Ct,QL=!Lke(function(){return Object.isExtensible(Object.preventExtensions({}))}),Mc={},Fke={get exports(){return Mc},set exports(e){Mc=e}},Hke=Ct,Bke=Hke(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),Vke=Ct,jke=on,Wke=is,XU=Bke,eC=Object.isExtensible,Uke=Vke(function(){eC(1)}),zke=Uke||XU?function(t){return!jke(t)||XU&&Wke(t)=="ArrayBuffer"?!1:eC?eC(t):!0}:eC,Gke=vt,Yke=Pt,Kke=Vw,Xke=on,eF=jr,qke=Si.f,qU=ah,Zke=IO,tF=zke,Jke=OO,Qke=QL,pre=!1,dl=Jke("meta"),eAe=0,rF=function(e){qke(e,dl,{value:{objectID:"O"+eAe++,weakData:{}}})},tAe=function(e,t){if(!Xke(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!eF(e,dl)){if(!tF(e))return"F";if(!t)return"E";rF(e)}return e[dl].objectID},rAe=function(e,t){if(!eF(e,dl)){if(!tF(e))return!0;if(!t)return!1;rF(e)}return e[dl].weakData},nAe=function(e){return Qke&&pre&&tF(e)&&!eF(e,dl)&&rF(e),e},iAe=function(){aAe.enable=function(){},pre=!0;var e=qU.f,t=Yke([].splice),r={};r[dl]=1,e(r).length&&(qU.f=function(n){for(var i=e(n),a=0,o=i.length;a<o;a++)if(i[a]===dl){t(i,a,1);break}return i},Gke({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Zke.f}))},aAe=Fke.exports={enable:iAe,fastKey:tAe,getWeakData:rAe,onFreeze:nAe};Kke[dl]=!0;var oAe=vt,sAe=QL,lAe=Ct,uAe=on,fAe=Mc.onFreeze,SM=Object.freeze,cAe=lAe(function(){SM(1)});oAe({target:"Object",stat:!0,forced:cAe,sham:!sAe},{freeze:function(t){return SM&&uAe(t)?SM(fAe(t)):t}});var hAe=xr,dAe=Eg,vAe=Si.f,CM=hAe("unscopables"),xM=Array.prototype;xM[CM]==null&&vAe(xM,CM,{configurable:!0,value:dAe(null)});var Jw=function(e){xM[CM][e]=!0},Qw={},pAe=Ct,gre=!pAe(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),gAe=jr,yAe=Rr,mAe=Hi,bAe=kO,wAe=gre,ZU=bAe("IE_PROTO"),TM=Object,_Ae=TM.prototype,BO=wAe?TM.getPrototypeOf:function(e){var t=mAe(e);if(gAe(t,ZU))return t[ZU];var r=t.constructor;return yAe(r)&&t instanceof r?r.prototype:t instanceof TM?_Ae:null},SAe=Ct,CAe=Rr,xAe=on,JU=BO,TAe=$a,OAe=xr,OM=OAe("iterator"),yre=!1,Dc,Pk,Ik;[].keys&&(Ik=[].keys(),"next"in Ik?(Pk=JU(JU(Ik)),Pk!==Object.prototype&&(Dc=Pk)):yre=!0);var EAe=!xAe(Dc)||SAe(function(){var e={};return Dc[OM].call(e)!==e});EAe&&(Dc={});CAe(Dc[OM])||TAe(Dc,OM,function(){return this});var mre={IteratorPrototype:Dc,BUGGY_SAFARI_ITERATORS:yre},RAe=mre.IteratorPrototype,kAe=Eg,AAe=Nw,PAe=MO,IAe=Qw,MAe=function(){return this},DAe=function(e,t,r,n){var i=t+" Iterator";return e.prototype=kAe(RAe,{next:AAe(+!n,r)}),PAe(e,i,!1),IAe[i]=MAe,e},$Ae=Pt,NAe=rh,LAe=function(e,t,r){try{return $Ae(NAe(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},FAe=Rr,HAe=String,BAe=TypeError,VAe=function(e){if(typeof e=="object"||FAe(e))return e;throw BAe("Can't set "+HAe(e)+" as a prototype")},jAe=LAe,WAe=Kr,UAe=VAe,nF=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=jAe(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,a){return WAe(i),UAe(a),e?r(i,a):i.__proto__=a,i}}():void 0),zAe=vt,GAe=gn,bre=Bw,YAe=Rr,KAe=DAe,QU=BO,e8=nF,XAe=MO,qAe=ih,Mk=$a,ZAe=xr,JAe=Qw,wre=mre,QAe=bre.PROPER,ePe=bre.CONFIGURABLE,t8=wre.IteratorPrototype,AS=wre.BUGGY_SAFARI_ITERATORS,hy=ZAe("iterator"),r8="keys",dy="values",n8="entries",tPe=function(){return this},iF=function(e,t,r,n,i,a,o){KAe(r,t,n);var s=function(y){if(y===i&&h)return h;if(!AS&&y in f)return f[y];switch(y){case r8:return function(){return new r(this,y)};case dy:return function(){return new r(this,y)};case n8:return function(){return new r(this,y)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,f=e.prototype,c=f[hy]||f["@@iterator"]||i&&f[i],h=!AS&&c||s(i),d=t=="Array"&&f.entries||c,v,p,g;if(d&&(v=QU(d.call(new e)),v!==Object.prototype&&v.next&&(QU(v)!==t8&&(e8?e8(v,t8):YAe(v[hy])||Mk(v,hy,tPe)),XAe(v,l,!0))),QAe&&i==dy&&c&&c.name!==dy&&(ePe?qAe(f,"name",dy):(u=!0,h=function(){return GAe(c,this)})),i)if(p={values:s(dy),keys:a?h:s(r8),entries:s(n8)},o)for(g in p)(AS||u||!(g in f))&&Mk(f,g,p[g]);else zAe({target:t,proto:!0,forced:AS||u},p);return f[hy]!==h&&Mk(f,hy,h,{name:i}),JAe[t]=h,p},aF=function(e,t){return{value:e,done:t}},rPe=aa,oF=Jw,i8=Qw,_re=Sl,nPe=Si.f,iPe=iF,PS=aF,aPe=an,Sre="Array Iterator",oPe=_re.set,sPe=_re.getterFor(Sre),lPe=iPe(Array,"Array",function(e,t){oPe(this,{type:Sre,target:rPe(e),index:0,kind:t})},function(){var e=sPe(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,PS(void 0,!0)):r=="keys"?PS(n,!1):r=="values"?PS(t[n],!1):PS([n,t[n]],!1)},"values"),a8=i8.Arguments=i8.Array;oF("keys");oF("values");oF("entries");if(aPe&&a8.name!=="values")try{nPe(a8,"name",{value:"values"})}catch{}var uPe=VL,fPe=PO,cPe=uPe?{}.toString:function(){return"[object "+fPe(this)+"]"},hPe=VL,dPe=$a,vPe=cPe;hPe||dPe(Object.prototype,"toString",vPe,{unsafe:!0});var pPe=xr,gPe=Qw,yPe=pPe("iterator"),mPe=Array.prototype,Cre=function(e){return e!==void 0&&(gPe.Array===e||mPe[yPe]===e)},bPe=PO,o8=nh,wPe=bo,_Pe=Qw,SPe=xr,CPe=SPe("iterator"),sF=function(e){if(!wPe(e))return o8(e,CPe)||o8(e,"@@iterator")||_Pe[bPe(e)]},xPe=gn,TPe=rh,OPe=Kr,EPe=Og,RPe=sF,kPe=TypeError,xre=function(e,t){var r=arguments.length<2?RPe(e):t;if(TPe(r))return OPe(xPe(r,e));throw kPe(EPe(e)+" is not iterable")},APe=gn,s8=Kr,PPe=nh,Tre=function(e,t,r){var n,i;s8(e);try{if(n=PPe(e,"return"),!n){if(t==="throw")throw r;return r}n=APe(n,e)}catch(a){i=!0,n=a}if(t==="throw")throw r;if(i)throw n;return s8(n),r},IPe=Kw,MPe=gn,DPe=Kr,$Pe=Og,NPe=Cre,LPe=Na,l8=Wu,FPe=xre,HPe=sF,u8=Tre,BPe=TypeError,tC=function(e,t){this.stopped=e,this.result=t},f8=tC.prototype,lF=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),a=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=IPe(t,n),u,f,c,h,d,v,p,g=function(m){return u&&u8(u,"normal",m),new tC(!0,m)},y=function(m){return i?(DPe(m),s?l(m[0],m[1],g):l(m[0],m[1])):s?l(m,g):l(m)};if(a)u=e.iterator;else if(o)u=e;else{if(f=HPe(e),!f)throw BPe($Pe(e)+" is not iterable");if(NPe(f)){for(c=0,h=LPe(e);h>c;c++)if(d=y(e[c]),d&&l8(f8,d))return d;return new tC(!1)}u=FPe(e,f)}for(v=a?e.next:u.next;!(p=MPe(v,u)).done;){try{d=y(p.value)}catch(m){u8(u,"throw",m)}if(typeof d=="object"&&d&&l8(f8,d))return d}return new tC(!1)},VPe=Wu,jPe=TypeError,uF=function(e,t){if(VPe(t,e))return e;throw jPe("Incorrect invocation")},WPe=xr,Ore=WPe("iterator"),Ere=!1;try{var UPe=0,c8={next:function(){return{done:!!UPe++}},return:function(){Ere=!0}};c8[Ore]=function(){return this},Array.from(c8,function(){throw 2})}catch{}var Rre=function(e,t){if(!t&&!Ere)return!1;var r=!1;try{var n={};n[Ore]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},zPe=Rr,GPe=on,h8=nF,fF=function(e,t,r){var n,i;return h8&&zPe(n=t.constructor)&&n!==r&&GPe(i=n.prototype)&&i!==r.prototype&&h8(e,i),e},YPe=vt,KPe=Sr,XPe=Pt,d8=AO,qPe=$a,ZPe=Mc,JPe=lF,QPe=uF,eIe=Rr,tIe=bo,Dk=on,$k=Ct,rIe=Rre,nIe=MO,iIe=fF,VO=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,a=n?"set":"add",o=KPe[e],s=o&&o.prototype,l=o,u={},f=function(y){var m=XPe(s[y]);qPe(s,y,y=="add"?function(_){return m(this,_===0?0:_),this}:y=="delete"?function(b){return i&&!Dk(b)?!1:m(this,b===0?0:b)}:y=="get"?function(_){return i&&!Dk(_)?void 0:m(this,_===0?0:_)}:y=="has"?function(_){return i&&!Dk(_)?!1:m(this,_===0?0:_)}:function(_,x){return m(this,_===0?0:_,x),this})},c=d8(e,!eIe(o)||!(i||s.forEach&&!$k(function(){new o().entries().next()})));if(c)l=r.getConstructor(t,e,n,a),ZPe.enable();else if(d8(e,!0)){var h=new l,d=h[a](i?{}:-0,1)!=h,v=$k(function(){h.has(1)}),p=rIe(function(y){new o(y)}),g=!i&&$k(function(){for(var y=new o,m=5;m--;)y[a](m,m);return!y.has(-0)});p||(l=t(function(y,m){QPe(y,s);var b=iIe(new o,y,l);return tIe(m)||JPe(m,b[a],{that:b,AS_ENTRIES:n}),b}),l.prototype=s,s.constructor=l),(v||g)&&(f("delete"),f("has"),n&&f("get")),(g||d)&&f(a),i&&s.clear&&delete s.clear}return u[e]=l,YPe({global:!0,constructor:!0,forced:l!=o},u),nIe(l,e),i||r.setStrong(l,e,n),l},aIe=$a,cF=function(e,t,r){for(var n in t)aIe(e,n,t[n],r);return e},oIe=_l,sIe=Gw,lIe=xr,uIe=an,v8=lIe("species"),kre=function(e){var t=oIe(e);uIe&&t&&!t[v8]&&sIe(t,v8,{configurable:!0,get:function(){return this}})},fIe=Eg,cIe=Gw,p8=cF,hIe=Kw,dIe=uF,vIe=bo,pIe=lF,gIe=iF,IS=aF,yIe=kre,vy=an,g8=Mc.fastKey,Are=Sl,y8=Are.set,Nk=Are.getterFor,Pre={getConstructor:function(e,t,r,n){var i=e(function(u,f){dIe(u,a),y8(u,{type:t,index:fIe(null),first:void 0,last:void 0,size:0}),vy||(u.size=0),vIe(f)||pIe(f,u[n],{that:u,AS_ENTRIES:r})}),a=i.prototype,o=Nk(t),s=function(u,f,c){var h=o(u),d=l(u,f),v,p;return d?d.value=c:(h.last=d={index:p=g8(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),vy?h.size++:u.size++,p!=="F"&&(h.index[p]=d)),u},l=function(u,f){var c=o(u),h=g8(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return p8(a,{clear:function(){for(var f=this,c=o(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,vy?c.size=0:f.size=0},delete:function(u){var f=this,c=o(f),h=l(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),vy?c.size--:f.size--}return!!h},forEach:function(f){for(var c=o(this),h=hIe(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!l(this,f)}}),p8(a,r?{get:function(f){var c=l(this,f);return c&&c.value},set:function(f,c){return s(this,f===0?0:f,c)}}:{add:function(f){return s(this,f=f===0?0:f,f)}}),vy&&cIe(a,"size",{configurable:!0,get:function(){return o(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=Nk(t),a=Nk(n);gIe(e,t,function(o,s){y8(this,{type:n,target:o,state:i(o),kind:s,last:void 0})},function(){for(var o=a(this),s=o.kind,l=o.last;l&&l.removed;)l=l.previous;return!o.target||!(o.last=l=l?l.next:o.state.first)?(o.target=void 0,IS(void 0,!0)):s=="keys"?IS(l.key,!1):s=="values"?IS(l.value,!1):IS([l.key,l.value],!1)},r?"entries":"values",!r,!0),yIe(t)}},mIe=VO,bIe=Pre;mIe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},bIe);var hF=Pt,wIe=Uu,_Ie=sn,SIe=Fi,CIe=hF("".charAt),m8=hF("".charCodeAt),xIe=hF("".slice),b8=function(e){return function(t,r){var n=_Ie(SIe(t)),i=wIe(r),a=n.length,o,s;return i<0||i>=a?e?"":void 0:(o=m8(n,i),o<55296||o>56319||i+1===a||(s=m8(n,i+1))<56320||s>57343?e?CIe(n,i):o:e?xIe(n,i,i+2):(o-55296<<10)+(s-56320)+65536)}},dF={codeAt:b8(!1),charAt:b8(!0)},TIe=dF.charAt,OIe=sn,Ire=Sl,EIe=iF,w8=aF,Mre="String Iterator",RIe=Ire.set,kIe=Ire.getterFor(Mre);EIe(String,"String",function(e){RIe(this,{type:Mre,string:OIe(e),index:0})},function(){var t=kIe(this),r=t.string,n=t.index,i;return n>=r.length?w8(void 0,!0):(i=TIe(r,n),t.index+=i.length,w8(i,!1))});var Dre={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},AIe=RO,Lk=AIe("span").classList,_8=Lk&&Lk.constructor&&Lk.constructor.prototype,$re=_8===Object.prototype?void 0:_8,S8=Sr,Nre=Dre,PIe=$re,Zy=lPe,Fk=ih,Lre=xr,Hk=Lre("iterator"),C8=Lre("toStringTag"),Bk=Zy.values,Fre=function(e,t){if(e){if(e[Hk]!==Bk)try{Fk(e,Hk,Bk)}catch{e[Hk]=Bk}if(e[C8]||Fk(e,C8,t),Nre[t]){for(var r in Zy)if(e[r]!==Zy[r])try{Fk(e,r,Zy[r])}catch{e[r]=Zy[r]}}}};for(var Vk in Nre)Fre(S8[Vk]&&S8[Vk].prototype,Vk);Fre(PIe,"DOMTokenList");var IIe=vt,MIe=HL.includes,DIe=Ct,$Ie=Jw,NIe=DIe(function(){return!Array(1).includes()});IIe({target:"Array",proto:!0,forced:NIe},{includes:function(t){return MIe(this,t,arguments.length>1?arguments[1]:void 0)}});$Ie("includes");var x8=Og,LIe=TypeError,Hre=function(e,t){if(!delete e[t])throw LIe("Cannot delete property "+x8(t)+" of "+x8(e))},T8=WL,FIe=Math.floor,EM=function(e,t){var r=e.length,n=FIe(r/2);return r<8?HIe(e,t):BIe(e,EM(T8(e,0,n),t),EM(T8(e,n),t),t)},HIe=function(e,t){for(var r=e.length,n=1,i,a;n<r;){for(a=n,i=e[n];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==n++&&(e[a]=i)}return e},BIe=function(e,t,r,n){for(var i=t.length,a=r.length,o=0,s=0;o<i||s<a;)e[o+s]=o<i&&s<a?n(t[o],r[s])<=0?t[o++]:r[s++]:o<i?t[o++]:r[s++];return e},VIe=EM,jIe=Ct,Ag=function(e,t){var r=[][e];return!!r&&jIe(function(){r.call(null,t||function(){return 1},1)})},WIe=th,O8=WIe.match(/firefox\/(\d+)/i),UIe=!!O8&&+O8[1],zIe=th,GIe=/MSIE|Trident/.test(zIe),YIe=th,E8=YIe.match(/AppleWebKit\/(\d+)\./),KIe=!!E8&&+E8[1],XIe=vt,Bre=Pt,qIe=rh,ZIe=Hi,R8=Na,JIe=Hre,k8=sn,vF=Ct,QIe=VIe,eMe=Ag,A8=UIe,tMe=GIe,P8=Fw,I8=KIe,iu=[],M8=Bre(iu.sort),rMe=Bre(iu.push),nMe=vF(function(){iu.sort(void 0)}),iMe=vF(function(){iu.sort(null)}),aMe=eMe("sort"),Vre=!vF(function(){if(P8)return P8<70;if(!(A8&&A8>3)){if(tMe)return!0;if(I8)return I8<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)iu.push({k:r+i,v:n})}for(iu.sort(function(a,o){return o.v-a.v}),i=0;i<iu.length;i++)r=iu[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),oMe=nMe||!iMe||!aMe||!Vre,sMe=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:k8(t)>k8(r)?1:-1}};XIe({target:"Array",proto:!0,forced:oMe},{sort:function(t){t!==void 0&&qIe(t);var r=ZIe(this);if(Vre)return t===void 0?M8(r):M8(r,t);var n=[],i=R8(r),a,o;for(o=0;o<i;o++)o in r&&rMe(n,r[o]);for(QIe(n,sMe(t)),a=R8(n),o=0;o<a;)r[o]=n[o++];for(;o<i;)JIe(r,o++);return r}});var lMe=an,uMe=kg,fMe=TypeError,cMe=Object.getOwnPropertyDescriptor,hMe=lMe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),dMe=hMe?function(e,t){if(uMe(e)&&!cMe(e,"length").writable)throw fMe("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},vMe=TypeError,pMe=9007199254740991,jre=function(e){if(e>pMe)throw vMe("Maximum allowed index exceeded");return e},gMe=Ct,yMe=xr,mMe=Fw,bMe=yMe("species"),e_=function(e){return mMe>=51||!gMe(function(){var t=[],r=t.constructor={};return r[bMe]=function(){return{foo:1}},t[e](Boolean).foo!==1})},wMe=vt,_Me=Hi,SMe=jw,CMe=Uu,xMe=Na,TMe=dMe,OMe=jre,EMe=YL,RMe=Rg,jk=Hre,kMe=e_,AMe=kMe("splice"),PMe=Math.max,IMe=Math.min;wMe({target:"Array",proto:!0,forced:!AMe},{splice:function(t,r){var n=_Me(this),i=xMe(n),a=SMe(t,i),o=arguments.length,s,l,u,f,c,h;for(o===0?s=l=0:o===1?(s=0,l=i-a):(s=o-2,l=IMe(PMe(CMe(r),0),i-a)),OMe(i+s-l),u=EMe(n,l),f=0;f<l;f++)c=a+f,c in n&&RMe(u,f,n[c]);if(u.length=l,s<l){for(f=a;f<i-l;f++)c=f+l,h=f+s,c in n?n[h]=n[c]:jk(n,h);for(f=i;f>i-l+s;f--)jk(n,f-1)}else if(s>l)for(f=i-l;f>a;f--)c=f+l-1,h=f+s-1,c in n?n[h]=n[c]:jk(n,h);for(f=0;f<s;f++)n[f+a]=arguments[f+2];return TMe(n,i-l+s),u}});var MMe=on,DMe=Math.floor,$Me=Number.isInteger||function(t){return!MMe(t)&&isFinite(t)&&DMe(t)===t},NMe=vt,LMe=$Me;NMe({target:"Number",stat:!0},{isInteger:LMe});var FMe=Pt,Wre=FMe(1 .valueOf),Ure=`	
\v\f\r                　\u2028\u2029\uFEFF`,HMe=Pt,BMe=Fi,VMe=sn,RM=Ure,D8=HMe("".replace),jMe=RegExp("^["+RM+"]+"),WMe=RegExp("(^|[^"+RM+"])["+RM+"]+$"),Wk=function(e){return function(t){var r=VMe(BMe(t));return e&1&&(r=D8(r,jMe,"")),e&2&&(r=D8(r,WMe,"$1")),r}},zre={start:Wk(1),end:Wk(2),trim:Wk(3)},UMe=vt,Gre=Sxe,zMe=an,Yre=Sr,Kre=Hte,Xre=Pt,GMe=AO,$8=jr,YMe=fF,KMe=Wu,XMe=Hw,qre=Ste,qMe=Ct,ZMe=ah.f,JMe=ns.f,QMe=Si.f,e2e=Wre,t2e=zre.trim,jO="Number",Fd=Yre[jO];Kre[jO];var pF=Fd.prototype,r2e=Yre.TypeError,n2e=Xre("".slice),MS=Xre("".charCodeAt),i2e=function(e){var t=qre(e,"number");return typeof t=="bigint"?t:a2e(t)},a2e=function(e){var t=qre(e,"number"),r,n,i,a,o,s,l,u;if(XMe(t))throw r2e("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=t2e(t),r=MS(t,0),r===43||r===45){if(n=MS(t,2),n===88||n===120)return NaN}else if(r===48){switch(MS(t,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(o=n2e(t,2),s=o.length,l=0;l<s;l++)if(u=MS(o,l),u<48||u>a)return NaN;return parseInt(o,i)}}return+t},gF=GMe(jO,!Fd(" 0o1")||!Fd("0b1")||Fd("+0x1")),o2e=function(e){return KMe(pF,e)&&qMe(function(){e2e(e)})},WO=function(t){var r=arguments.length<1?0:Fd(i2e(t));return o2e(this)?YMe(Object(r),this,WO):r};WO.prototype=pF;gF&&!Gre&&(pF.constructor=WO);UMe({global:!0,constructor:!0,wrap:!0,forced:gF},{Number:WO});var s2e=function(e,t){for(var r=zMe?ZMe(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)$8(t,i=r[n])&&!$8(e,i)&&QMe(e,i,JMe(t,i))};(gF||Gre)&&s2e(Kre[jO],Fd);var l2e=vt,N8=kg,u2e=DO,f2e=on,L8=jw,c2e=Na,h2e=aa,d2e=Rg,v2e=xr,p2e=e_,g2e=qw,y2e=p2e("slice"),m2e=v2e("species"),Uk=Array,b2e=Math.max;l2e({target:"Array",proto:!0,forced:!y2e},{slice:function(t,r){var n=h2e(this),i=c2e(n),a=L8(t,i),o=L8(r===void 0?i:r,i),s,l,u;if(N8(n)&&(s=n.constructor,u2e(s)&&(s===Uk||N8(s.prototype))?s=void 0:f2e(s)&&(s=s[m2e],s===null&&(s=void 0)),s===Uk||s===void 0))return g2e(n,a,o);for(l=new(s===void 0?Uk:s)(b2e(o-a,0)),u=0;a<o;a++,u++)a in n&&d2e(l,u,n[a]);return l.length=u,l}});var w2e=vt,_2e=Ct,S2e=kg,C2e=on,x2e=Hi,T2e=Na,F8=jre,H8=Rg,O2e=YL,E2e=e_,R2e=xr,k2e=Fw,Zre=R2e("isConcatSpreadable"),A2e=k2e>=51||!_2e(function(){var e=[];return e[Zre]=!1,e.concat()[0]!==e}),P2e=function(e){if(!C2e(e))return!1;var t=e[Zre];return t!==void 0?!!t:S2e(e)},I2e=!A2e||!E2e("concat");w2e({target:"Array",proto:!0,arity:1,forced:I2e},{concat:function(t){var r=x2e(this),n=O2e(r,0),i=0,a,o,s,l,u;for(a=-1,s=arguments.length;a<s;a++)if(u=a===-1?r:arguments[a],P2e(u))for(l=T2e(u),F8(i+l),o=0;o<l;o++,i++)o in u&&H8(n,i,u[o]);else F8(i+1),H8(n,i++,u);return n.length=i,n}});var M2e=Hi,B8=jw,D2e=Na,$2e=function(t){for(var r=M2e(this),n=D2e(r),i=arguments.length,a=B8(i>1?arguments[1]:void 0,n),o=i>2?arguments[2]:void 0,s=o===void 0?n:B8(o,n);s>a;)r[a++]=t;return r},N2e=vt,L2e=$2e,F2e=Jw;N2e({target:"Array",proto:!0},{fill:L2e});F2e("fill");var H2e=vt,B2e=sh.map,V2e=e_,j2e=V2e("map");H2e({target:"Array",proto:!0,forced:!j2e},{map:function(t){return B2e(this,t,arguments.length>1?arguments[1]:void 0)}});var W2e=Kr,Jre=function(){var e=W2e(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},yF=Ct,U2e=Sr,mF=U2e.RegExp,bF=yF(function(){var e=mF("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),z2e=bF||yF(function(){return!mF("a","y").sticky}),G2e=bF||yF(function(){var e=mF("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),wF={BROKEN_CARET:G2e,MISSED_STICKY:z2e,UNSUPPORTED_Y:bF},Y2e=Ct,K2e=Sr,X2e=K2e.RegExp,Qre=Y2e(function(){var e=X2e(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),q2e=Ct,Z2e=Sr,J2e=Z2e.RegExp,ene=q2e(function(){var e=J2e("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Od=gn,UO=Pt,Q2e=sn,eDe=Jre,tDe=wF,rDe=$u,nDe=Eg,iDe=Sl.get,aDe=Qre,oDe=ene,sDe=rDe("native-string-replace",String.prototype.replace),Sx=RegExp.prototype.exec,kM=Sx,lDe=UO("".charAt),uDe=UO("".indexOf),fDe=UO("".replace),zk=UO("".slice),AM=function(){var e=/a/,t=/b*/g;return Od(Sx,e,"a"),Od(Sx,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),tne=tDe.BROKEN_CARET,PM=/()??/.exec("")[1]!==void 0,cDe=AM||PM||tne||aDe||oDe;cDe&&(kM=function(t){var r=this,n=iDe(r),i=Q2e(t),a=n.raw,o,s,l,u,f,c,h;if(a)return a.lastIndex=r.lastIndex,o=Od(kM,a,i),r.lastIndex=a.lastIndex,o;var d=n.groups,v=tne&&r.sticky,p=Od(eDe,r),g=r.source,y=0,m=i;if(v&&(p=fDe(p,"y",""),uDe(p,"g")===-1&&(p+="g"),m=zk(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&lDe(i,r.lastIndex-1)!==`
`)&&(g="(?: "+g+")",m=" "+m,y++),s=new RegExp("^(?:"+g+")",p)),PM&&(s=new RegExp("^"+g+"$(?!\\s)",p)),AM&&(l=r.lastIndex),u=Od(Sx,v?s:r,m),v?u?(u.input=zk(u.input,y),u[0]=zk(u[0],y),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:AM&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),PM&&u&&u.length>1&&Od(sDe,u[0],s,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=nDe(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var zO=kM,hDe=vt,V8=zO;hDe({target:"RegExp",proto:!0,forced:/./.exec!==V8},{exec:V8});var j8=Yw,W8=$a,dDe=zO,U8=Ct,rne=xr,vDe=ih,pDe=rne("species"),Gk=RegExp.prototype,GO=function(e,t,r,n){var i=rne(e),a=!U8(function(){var u={};return u[i]=function(){return 7},""[e](u)!=7}),o=a&&!U8(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[pDe]=function(){return f},f.flags="",f[i]=/./[i]),f.exec=function(){return u=!0,null},f[i](""),!u});if(!a||!o||r){var s=j8(/./[i]),l=t(i,""[e],function(u,f,c,h,d){var v=j8(u),p=f.exec;return p===dDe||p===Gk.exec?a&&!d?{done:!0,value:s(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});W8(String.prototype,e,l[0]),W8(Gk,i,l[1])}n&&vDe(Gk[i],"sham",!0)},gDe=dF.charAt,_F=function(e,t,r){return t+(r?gDe(e,t).length:1)},SF=Pt,yDe=Hi,mDe=Math.floor,Yk=SF("".charAt),bDe=SF("".replace),Kk=SF("".slice),wDe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,_De=/\$([$&'`]|\d{1,2})/g,SDe=function(e,t,r,n,i,a){var o=r+e.length,s=n.length,l=_De;return i!==void 0&&(i=yDe(i),l=wDe),bDe(a,l,function(u,f){var c;switch(Yk(f,0)){case"$":return"$";case"&":return e;case"`":return Kk(t,0,r);case"'":return Kk(t,o);case"<":c=i[Kk(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>s){var d=mDe(h/10);return d===0?u:d<=s?n[d-1]===void 0?Yk(f,1):n[d-1]+Yk(f,1):u}c=n[h-1]}return c===void 0?"":c})},z8=gn,CDe=Kr,xDe=Rr,TDe=is,ODe=zO,EDe=TypeError,YO=function(e,t){var r=e.exec;if(xDe(r)){var n=z8(r,e,t);return n!==null&&CDe(n),n}if(TDe(e)==="RegExp")return z8(ODe,e,t);throw EDe("RegExp#exec called on incompatible receiver")},RDe=lh,G8=gn,KO=Pt,kDe=GO,ADe=Ct,PDe=Kr,IDe=Rr,MDe=bo,DDe=Uu,$De=oh,Nh=sn,NDe=Fi,LDe=_F,FDe=nh,HDe=SDe,BDe=YO,VDe=xr,IM=VDe("replace"),jDe=Math.max,WDe=Math.min,UDe=KO([].concat),Xk=KO([].push),Y8=KO("".indexOf),K8=KO("".slice),zDe=function(e){return e===void 0?e:String(e)},GDe=function(){return"a".replace(/./,"$0")==="$0"}(),X8=function(){return/./[IM]?/./[IM]("a","$0")==="":!1}(),YDe=!ADe(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});kDe("replace",function(e,t,r){var n=X8?"$":"$0";return[function(a,o){var s=NDe(this),l=MDe(a)?void 0:FDe(a,IM);return l?G8(l,a,s,o):G8(t,Nh(s),a,o)},function(i,a){var o=PDe(this),s=Nh(i);if(typeof a=="string"&&Y8(a,n)===-1&&Y8(a,"$<")===-1){var l=r(t,o,s,a);if(l.done)return l.value}var u=IDe(a);u||(a=Nh(a));var f=o.global;if(f){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var d=BDe(o,s);if(d===null||(Xk(h,d),!f))break;var v=Nh(d[0]);v===""&&(o.lastIndex=LDe(s,$De(o.lastIndex),c))}for(var p="",g=0,y=0;y<h.length;y++){d=h[y];for(var m=Nh(d[0]),b=jDe(WDe(DDe(d.index),s.length),0),_=[],x=1;x<d.length;x++)Xk(_,zDe(d[x]));var T=d.groups;if(u){var E=UDe([m],_,b,s);T!==void 0&&Xk(E,T);var P=Nh(RDe(a,void 0,E))}else P=HDe(m,s,b,_,T,a);b>=g&&(p+=K8(s,g,b)+P,g=b+m.length)}return p+K8(s,g)}]},!YDe||!GDe||X8);var KDe=Kr,XDe=Tre,qDe=function(e,t,r,n){try{return n?t(KDe(r)[0],r[1]):t(r)}catch(i){XDe(e,"throw",i)}},ZDe=Kw,JDe=gn,QDe=Hi,e$e=qDe,t$e=Cre,r$e=DO,n$e=Na,q8=Rg,i$e=xre,a$e=sF,Z8=Array,o$e=function(t){var r=QDe(t),n=r$e(this),i=arguments.length,a=i>1?arguments[1]:void 0,o=a!==void 0;o&&(a=ZDe(a,i>2?arguments[2]:void 0));var s=a$e(r),l=0,u,f,c,h,d,v;if(s&&!(this===Z8&&t$e(s)))for(h=i$e(r,s),d=h.next,f=n?new this:[];!(c=JDe(d,h)).done;l++)v=o?e$e(h,a,[c.value,l],!0):c.value,q8(f,l,v);else for(u=n$e(r),f=n?new this(u):Z8(u);u>l;l++)v=o?a(r[l],l):r[l],q8(f,l,v);return f.length=l,f},s$e=vt,l$e=o$e,u$e=Rre,f$e=!u$e(function(e){Array.from(e)});s$e({target:"Array",stat:!0,forced:f$e},{from:l$e});var c$e=vt,h$e=Yw,d$e=HL.indexOf,v$e=Ag,MM=h$e([].indexOf),nne=!!MM&&1/MM([1],1,-0)<0,p$e=nne||!v$e("indexOf");c$e({target:"Array",proto:!0,forced:p$e},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return nne?MM(this,t,r)||0:d$e(this,t,r)}});var g$e=vt,y$e=Pt,m$e=kg,b$e=y$e([].reverse),J8=[1,2];g$e({target:"Array",proto:!0,forced:String(J8)===String(J8.reverse())},{reverse:function(){return m$e(this)&&(this.length=this.length),b$e(this)}});var w$e=sh.forEach,_$e=Ag,S$e=_$e("forEach"),C$e=S$e?[].forEach:function(t){return w$e(this,t,arguments.length>1?arguments[1]:void 0)},Q8=Sr,e5=Dre,x$e=$re,qk=C$e,T$e=ih,ine=function(e){if(e&&e.forEach!==qk)try{T$e(e,"forEach",qk)}catch{e.forEach=qk}};for(var Zk in e5)e5[Zk]&&ine(Q8[Zk]&&Q8[Zk].prototype);ine(x$e);var O$e=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",E$e=TypeError,ane=function(e,t){if(e<t)throw E$e("Not enough arguments");return e},one=Sr,R$e=lh,k$e=Rr,A$e=O$e,P$e=th,I$e=qw,M$e=ane,D$e=one.Function,$$e=/MSIE .\./.test(P$e)||A$e&&function(){var e=one.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),CF=function(e,t){var r=t?2:1;return $$e?function(n,i){var a=M$e(arguments.length,1)>r,o=k$e(n)?n:D$e(n),s=a?I$e(arguments,r):[],l=a?function(){R$e(o,this,s)}:o;return t?e(l,i):e(l)}:e},N$e=vt,sne=Sr,L$e=CF,t5=L$e(sne.setInterval,!0);N$e({global:!0,bind:!0,forced:sne.setInterval!==t5},{setInterval:t5});var F$e=vt,lne=Sr,H$e=CF,r5=H$e(lne.setTimeout,!0);F$e({global:!0,bind:!0,forced:lne.setTimeout!==r5},{setTimeout:r5});var B$e=th,V$e=/(?:ipad|iphone|ipod).*applewebkit/i.test(B$e),j$e=is,une=typeof process<"u"&&j$e(process)=="process",Qi=Sr,W$e=lh,U$e=Kw,n5=Rr,z$e=jr,fne=Ct,i5=Dte,G$e=qw,a5=RO,Y$e=ane,K$e=V$e,X$e=une,DM=Qi.setImmediate,$M=Qi.clearImmediate,q$e=Qi.process,Jk=Qi.Dispatch,Z$e=Qi.Function,o5=Qi.MessageChannel,J$e=Qi.String,Qk=0,_m={},s5="onreadystatechange",d0,wf,eA,tA;fne(function(){d0=Qi.location});var xF=function(e){if(z$e(_m,e)){var t=_m[e];delete _m[e],t()}},rA=function(e){return function(){xF(e)}},l5=function(e){xF(e.data)},u5=function(e){Qi.postMessage(J$e(e),d0.protocol+"//"+d0.host)};(!DM||!$M)&&(DM=function(t){Y$e(arguments.length,1);var r=n5(t)?t:Z$e(t),n=G$e(arguments,1);return _m[++Qk]=function(){W$e(r,void 0,n)},wf(Qk),Qk},$M=function(t){delete _m[t]},X$e?wf=function(e){q$e.nextTick(rA(e))}:Jk&&Jk.now?wf=function(e){Jk.now(rA(e))}:o5&&!K$e?(eA=new o5,tA=eA.port2,eA.port1.onmessage=l5,wf=U$e(tA.postMessage,tA)):Qi.addEventListener&&n5(Qi.postMessage)&&!Qi.importScripts&&d0&&d0.protocol!=="file:"&&!fne(u5)?(wf=u5,Qi.addEventListener("message",l5,!1)):s5 in a5("script")?wf=function(e){i5.appendChild(a5("script"))[s5]=function(){i5.removeChild(this),xF(e)}}:wf=function(e){setTimeout(rA(e),0)});var cne={set:DM,clear:$M},Q$e=vt,eNe=Sr,f5=cne.clear;Q$e({global:!0,bind:!0,enumerable:!0,forced:eNe.clearImmediate!==f5},{clearImmediate:f5});var tNe=vt,hne=Sr,c5=cne.set,rNe=CF,h5=hne.setImmediate?rNe(c5,!1):c5;tNe({global:!0,bind:!0,enumerable:!0,forced:hne.setImmediate!==h5},{setImmediate:h5});var nNe=VO,iNe=Pre;nNe("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},iNe);var aNe=vt,oNe=Ct,sNe=Hi,dne=BO,lNe=gre,uNe=oNe(function(){dne(1)});aNe({target:"Object",stat:!0,forced:uNe,sham:!lNe},{getPrototypeOf:function(t){return dne(sNe(t))}});var fNe=on,cNe=is,hNe=xr,dNe=hNe("match"),TF=function(e){var t;return fNe(e)&&((t=e[dNe])!==void 0?!!t:cNe(e)=="RegExp")},vNe=TF,pNe=TypeError,OF=function(e){if(vNe(e))throw pNe("The method doesn't accept regular expressions");return e},gNe=xr,yNe=gNe("match"),EF=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[yNe]=!1,"/./"[e](t)}catch{}}return!1},mNe=vt,bNe=Pt,wNe=OF,_Ne=Fi,d5=sn,SNe=EF,CNe=bNe("".indexOf);mNe({target:"String",proto:!0,forced:!SNe("includes")},{includes:function(t){return!!~CNe(d5(_Ne(this)),d5(wNe(t)),arguments.length>1?arguments[1]:void 0)}});var xNe=vt,TNe=sh.filter,ONe=e_,ENe=ONe("filter");xNe({target:"Array",proto:!0,forced:!ENe},{filter:function(t){return TNe(this,t,arguments.length>1?arguments[1]:void 0)}});var RNe=gn,kNe=jr,ANe=Wu,PNe=Jre,v5=RegExp.prototype,vne=function(e){var t=e.flags;return t===void 0&&!("flags"in v5)&&!kNe(e,"flags")&&ANe(v5,e)?RNe(PNe,e):t},INe=Si.f,MNe=function(e,t,r){r in e||INe(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},DNe=an,RF=Sr,t_=Pt,$Ne=AO,NNe=fF,LNe=ih,FNe=ah.f,p5=Wu,HNe=TF,g5=sn,BNe=vne,pne=wF,VNe=MNe,jNe=$a,WNe=Ct,UNe=jr,zNe=Sl.enforce,GNe=kre,YNe=xr,gne=Qre,yne=ene,KNe=YNe("match"),du=RF.RegExp,vd=du.prototype,XNe=RF.SyntaxError,qNe=t_(vd.exec),Cx=t_("".charAt),y5=t_("".replace),m5=t_("".indexOf),ZNe=t_("".slice),JNe=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,xc=/a/g,nA=/a/g,QNe=new du(xc)!==xc,mne=pne.MISSED_STICKY,eLe=pne.UNSUPPORTED_Y,tLe=DNe&&(!QNe||mne||gne||yne||WNe(function(){return nA[KNe]=!1,du(xc)!=xc||du(nA)==nA||du(xc,"i")!="/a/i"})),rLe=function(e){for(var t=e.length,r=0,n="",i=!1,a;r<=t;r++){if(a=Cx(e,r),a==="\\"){n+=a+Cx(e,++r);continue}!i&&a==="."?n+="[\\s\\S]":(a==="["?i=!0:a==="]"&&(i=!1),n+=a)}return n},nLe=function(e){for(var t=e.length,r=0,n="",i=[],a={},o=!1,s=!1,l=0,u="",f;r<=t;r++){if(f=Cx(e,r),f==="\\")f=f+Cx(e,++r);else if(f==="]")o=!1;else if(!o)switch(!0){case f==="[":o=!0;break;case f==="(":qNe(JNe,ZNe(e,r+1))&&(r+=2,s=!0),n+=f,l++;continue;case(f===">"&&s):if(u===""||UNe(a,u))throw new XNe("Invalid capture group name");a[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=f:n+=f}return[n,i]};if($Ne("RegExp",tLe)){for(var _f=function(t,r){var n=p5(vd,this),i=HNe(t),a=r===void 0,o=[],s=t,l,u,f,c,h,d;if(!n&&i&&a&&t.constructor===_f)return t;if((i||p5(vd,t))&&(t=t.source,a&&(r=BNe(s))),t=t===void 0?"":g5(t),r=r===void 0?"":g5(r),s=t,gne&&"dotAll"in xc&&(u=!!r&&m5(r,"s")>-1,u&&(r=y5(r,/s/g,""))),l=r,mne&&"sticky"in xc&&(f=!!r&&m5(r,"y")>-1,f&&eLe&&(r=y5(r,/y/g,""))),yne&&(c=nLe(t),t=c[0],o=c[1]),h=NNe(du(t,r),n?this:vd,_f),(u||f||o.length)&&(d=zNe(h),u&&(d.dotAll=!0,d.raw=_f(rLe(t),l)),f&&(d.sticky=!0),o.length&&(d.groups=o)),t!==s)try{LNe(h,"source",s===""?"(?:)":s)}catch{}return h},b5=FNe(du),w5=0;b5.length>w5;)VNe(_f,du,b5[w5++]);vd.constructor=_f,_f.prototype=vd,jNe(RF,"RegExp",_f,{constructor:!0})}GNe("RegExp");var iLe=Bw.PROPER,aLe=$a,oLe=Kr,_5=sn,sLe=Ct,lLe=vne,kF="toString",uLe=RegExp.prototype,bne=uLe[kF],fLe=sLe(function(){return bne.call({source:"a",flags:"b"})!="/a/b"}),cLe=iLe&&bne.name!=kF;(fLe||cLe)&&aLe(RegExp.prototype,kF,function(){var t=oLe(this),r=_5(t.source),n=_5(lLe(t));return"/"+r+"/"+n},{unsafe:!0});var hLe=vt,dLe=Pt,vLe=Lw,pLe=aa,gLe=Ag,yLe=dLe([].join),mLe=vLe!=Object,bLe=mLe||!gLe("join",",");hLe({target:"Array",proto:!0,forced:bLe},{join:function(t){return yLe(pLe(this),t===void 0?",":t)}});var wLe=Bw.PROPER,_Le=Ct,S5=Ure,C5="​᠎",SLe=function(e){return _Le(function(){return!!S5[e]()||C5[e]()!==C5||wLe&&S5[e].name!==e})},CLe=vt,xLe=zre.trim,TLe=SLe;CLe({target:"String",proto:!0,forced:TLe("trim")},{trim:function(){return xLe(this)}});function NM(e){return NM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NM(e)}function XO(e){return window.requestAnimationFrame(e)}function wne(){return!!document.documentElement.classList}function _ne(){return!!document.createTextNode("test").textContent}function Sne(){return!!window.getComputedStyle}function v0(e){window.cancelAnimationFrame(e)}function AF(){return"ontouchstart"in window}var LM;function OLe(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),LM=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function PF(){return LM===void 0&&OLe(),LM}var Lh;function Cne(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Lh||((typeof Intl>"u"?"undefined":NM(Intl))==="object"?Lh=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?Lh=function(n,i){return"".concat(n).localeCompare(i)}:Lh=function(n,i){return n===i?0:n>i?-1:1},Lh)}var py;function xne(){if(py!==void 0)return py;try{var e={get passive(){py=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{py=!1}return py}const ELe=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:v0,getComparisonFunction:Cne,hasCaptionProblem:PF,isClassListSupported:wne,isGetComputedStyleSupported:Sne,isPassiveEventSupported:xne,isTextContentSupported:_ne,isTouchSupported:AF,requestAnimationFrame:XO},Symbol.toStringTag,{value:"Module"}));var RLe=zL,kLe=Bte;RLe("toPrimitive");kLe();var ALe=Kr,PLe=_te,ILe=TypeError,MLe=function(e){if(ALe(this),e==="string"||e==="default")e="string";else if(e!=="number")throw ILe("Incorrect hint");return PLe(this,e)},DLe=jr,$Le=$a,NLe=MLe,LLe=xr,x5=LLe("toPrimitive"),T5=Date.prototype;DLe(T5,x5)||$Le(T5,x5,NLe);var FLe=DO,HLe=Og,BLe=TypeError,Tne=function(e){if(FLe(e))return e;throw BLe(HLe(e)+" is not a constructor")},O5=Kr,VLe=Tne,jLe=bo,WLe=xr,ULe=WLe("species"),zLe=function(e,t){var r=O5(e).constructor,n;return r===void 0||jLe(n=O5(r)[ULe])?t:VLe(n)},GLe=lh,gy=gn,IF=Pt,YLe=GO,KLe=Kr,XLe=bo,qLe=TF,E5=Fi,ZLe=zLe,JLe=_F,QLe=oh,iA=sn,eFe=nh,R5=WL,k5=YO,tFe=zO,rFe=wF,nFe=Ct,Fh=rFe.UNSUPPORTED_Y,A5=4294967295,iFe=Math.min,One=[].push,aFe=IF(/./.exec),Hh=IF(One),yy=IF("".slice),oFe=!nFe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});YLe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var o=iA(E5(this)),s=a===void 0?A5:a>>>0;if(s===0)return[];if(i===void 0)return[o];if(!qLe(i))return gy(t,o,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),f=0,c=new RegExp(i.source,u+"g"),h,d,v;(h=gy(tFe,c,o))&&(d=c.lastIndex,!(d>f&&(Hh(l,yy(o,f,h.index)),h.length>1&&h.index<o.length&&GLe(One,l,R5(h,1)),v=h[0].length,f=d,l.length>=s)));)c.lastIndex===h.index&&c.lastIndex++;return f===o.length?(v||!aFe(c,""))&&Hh(l,""):Hh(l,yy(o,f)),l.length>s?R5(l,0,s):l}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:gy(t,this,i,a)}:n=t,[function(a,o){var s=E5(this),l=XLe(a)?void 0:eFe(a,e);return l?gy(l,a,s,o):gy(n,iA(s),a,o)},function(i,a){var o=KLe(this),s=iA(i),l=r(n,o,s,a,n!==t);if(l.done)return l.value;var u=ZLe(o,RegExp),f=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(Fh?"g":"y"),h=new u(Fh?"^(?:"+o.source+")":o,c),d=a===void 0?A5:a>>>0;if(d===0)return[];if(s.length===0)return k5(h,s)===null?[s]:[];for(var v=0,p=0,g=[];p<s.length;){h.lastIndex=Fh?0:p;var y=k5(h,Fh?yy(s,p):s),m;if(y===null||(m=iFe(QLe(h.lastIndex+(Fh?p:0)),s.length))===v)p=JLe(s,p,f);else{if(Hh(g,yy(s,v,p)),g.length===d)return g;for(var b=1;b<=y.length-1;b++)if(Hh(g,y[b]),g.length===d)return g;p=v=m}}return Hh(g,yy(s,v)),g}]},!oFe,Fh);function Ene(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function FM(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function Sm(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var a=0;a<n;a++)t[a]||(t[a]=[]),t[a][i]=e[i][a];return t}function Xr(e,t,r,n){var i=-1,a=e,o=r;Array.isArray(e)||(a=Array.from(e));var s=a.length;for(n&&s&&(i+=1,o=a[i]),i+=1;i<s;)o=t(o,a[i],i,a),i+=1;return o}function ra(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];t(s,r,n)&&(o+=1,a[o]=s),r+=1}return a}function Rt(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];o+=1,a[o]=t(s,r,n),r+=1}return a}function ne(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function Rne(e){return Xr(e,function(t,r){return t+r},0)}function sFe(e){return Xr(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function lFe(e){return Xr(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function uFe(e){return e.length?Rne(e)/e.length:0}function kne(e){return Xr(e,function(t,r){return t.concat(Array.isArray(r)?kne(r):r)},[])}function MF(e){var t=[];return ne(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function HM(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ne(a,function(s){o=o.filter(function(l){return!s.includes(l)})}),o}function fFe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ne(a,function(s){o=o.filter(function(l){return s.includes(l)})}),o}function cFe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=new Set(i);return ne(a,function(s){ne(s,function(l){o.has(l)||o.add(l)})}),Array.from(o)}function BM(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const hFe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:uFe,arrayEach:ne,arrayFilter:ra,arrayFlatten:kne,arrayMap:Rt,arrayMax:sFe,arrayMin:lFe,arrayReduce:Xr,arraySum:Rne,arrayUnique:MF,extendArray:FM,getDifferenceOfArrays:HM,getIntersectionOfArrays:fFe,getUnionOfArrays:cFe,pivot:Sm,stringToArray:BM,to2dArray:Ene},Symbol.toStringTag,{value:"Module"}));function P5(e,t,r){return t=dFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dFe(e){var t=vFe(e,"string");return vl(t)==="symbol"?t:String(t)}function vFe(e,t){if(vl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vl(e){return vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vl(e)}function cv(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},At(e,function(r,n){n!=="__children"&&(r&&vl(r)==="object"&&!Array.isArray(r)?t[n]=cv(r):Array.isArray(r)?r.length&&vl(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[cv(r[0])]:t[n]=[]:t[n]=null)})),t}function Cl(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function nn(e,t,r){var n=Array.isArray(r);return At(t,function(i,a){(n===!1||r.includes(a))&&(e[a]=i)}),e}function r_(e,t){At(t,function(r,n){t[n]&&vl(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),r_(e[n],t[n])):e[n]=t[n]})}function qn(e){return vl(e)==="object"?JSON.parse(JSON.stringify(e)):e}function vi(e){var t={};return At(e,function(r,n){t[n]=r}),t}function mr(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ne(r,function(i){e.MIXINS.push(i.MIXIN_NAME),At(i,function(a,o){if(e.prototype[o]!==void 0)throw new Error("Mixin conflict. Property '".concat(o,"' already exist and cannot be overwritten."));if(typeof a=="function")e.prototype[o]=a;else{var s=function(f,c){var h="_".concat(f),d=function(p){var g=p;return(Array.isArray(g)||kt(g))&&(g=qn(g)),g};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},l=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,o,{get:s(o,a),set:l(o),configurable:!0})}})}),e}function DF(e,t){return JSON.stringify(e)===JSON.stringify(t)}function kt(e){return Object.prototype.toString.call(e)==="[object Object]"}function as(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function At(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function Ane(e,t){var r=t.split("."),n=e;return At(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function rC(e,t,r){var n=t.split("."),i=e;n.forEach(function(a,o){o!==n.length-1?(Br(i,a)||(i[a]={}),i=i[a]):i[a]=r})}function qO(e){if(!kt(e))return 0;var t=function r(n){var i=0;return kt(n)?At(n,function(a,o){o!=="__children"&&(i+=r(a))}):i+=1,i};return t(e)}function $c(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},P5(t,n,e),P5(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(o){this._touched=!0,this[n]=o},enumerable:!0,configurable:!0}),i}function Br(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const pFe=Object.freeze(Object.defineProperty({__proto__:null,clone:vi,createObjectPropListener:$c,deepClone:qn,deepExtend:r_,deepObjectSize:qO,defineGetter:as,duckSchema:cv,extend:nn,getProperty:Ane,hasOwnProperty:Br,inherit:Cl,isObject:kt,isObjectEqual:DF,mixin:mr,objectEach:At,setProperty:rC},Symbol.toStringTag,{value:"Module"}));var ki=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},na={chrome:ki(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:ki(function(e){return/CriOS/.test(e)}),edge:ki(function(e){return/Edge/.test(e)}),edgeWebKit:ki(function(e){return/EdgiOS/.test(e)}),firefox:ki(function(e){return/Firefox/.test(e)}),firefoxWebKit:ki(function(e){return/FxiOS/.test(e)}),ie:ki(function(e){return/Trident/.test(e)}),ie9:ki(function(){return!!document.documentMode}),mobile:ki(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:ki(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Pg={mac:ki(function(e){return/^Mac/.test(e)}),win:ki(function(e){return/^Win/.test(e)}),linux:ki(function(e){return/^Linux/.test(e)}),ios:ki(function(e){return/iPhone|iPad|iPod/i.test(e)})};function Pne(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;At(na,function(a){var o=a.test;return void o(r,i)})}function Ine(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;At(Pg,function(n){var i=n.test;return void i(r)})}Pne();Ine();function $F(){return na.chrome.value}function Mne(){return na.chromeWebKit.value}function nC(){return na.firefox.value}function Dne(){return na.firefoxWebKit.value}function $ne(){return na.safari.value}function Nne(){return na.edge.value}function gFe(){return na.edgeWebKit.value}function Lne(){return na.ie.value}function Fne(){return na.ie9.value}function yFe(){return na.ie.value||na.edge.value}function oo(){return na.mobile.value}function NF(){return Pg.ios.value}function LF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Pg.mac.value}function VM(){return Pg.win.value}function xx(){return Pg.mac.value}function mFe(){return Pg.linux.value}const bFe=Object.freeze(Object.defineProperty({__proto__:null,isChrome:$F,isChromeWebKit:Mne,isEdge:Nne,isEdgeWebKit:gFe,isFirefox:nC,isFirefoxWebKit:Dne,isIE:Lne,isIE9:Fne,isIOS:NF,isIpadOS:LF,isLinuxOS:mFe,isMSBrowser:yFe,isMacOS:xx,isMobileBrowser:oo,isSafari:$ne,isWindowsOS:VM,setBrowserMeta:Pne,setPlatformMeta:Ine},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function ql(e){return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function jM(e,t){return jM=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},jM(e,t)}function wFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iC(e,t,r){return wFe()?iC=Reflect.construct:iC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&jM(u,o.prototype),u},iC.apply(null,arguments)}function Xa(e){return _Fe(e)||SFe(e)||CFe(e)||xFe()}function _Fe(e){if(Array.isArray(e))return WM(e)}function SFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CFe(e,t){if(e){if(typeof e=="string")return WM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WM(e,t)}}function WM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var TFe=Object.hasOwnProperty,I5=Object.setPrototypeOf,OFe=Object.isFrozen,EFe=Object.getPrototypeOf,RFe=Object.getOwnPropertyDescriptor,bi=Object.freeze,co=Object.seal,kFe=Object.create,Hne=typeof Reflect<"u"&&Reflect,Tx=Hne.apply,UM=Hne.construct;Tx||(Tx=function(t,r,n){return t.apply(r,n)});bi||(bi=function(t){return t});co||(co=function(t){return t});UM||(UM=function(t,r){return iC(t,Xa(r))});var AFe=Pa(Array.prototype.forEach),M5=Pa(Array.prototype.pop),my=Pa(Array.prototype.push),aC=Pa(String.prototype.toLowerCase),aA=Pa(String.prototype.toString),PFe=Pa(String.prototype.match),Wa=Pa(String.prototype.replace),IFe=Pa(String.prototype.indexOf),MFe=Pa(String.prototype.trim),ti=Pa(RegExp.prototype.test),oA=DFe(TypeError);function Pa(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Tx(e,t,n)}}function DFe(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return UM(e,r)}}function Ft(e,t,r){r=r||aC,I5&&I5(e,null);for(var n=t.length;n--;){var i=t[n];if(typeof i=="string"){var a=r(i);a!==i&&(OFe(t)||(t[n]=a),i=a)}e[i]=!0}return e}function Sf(e){var t=kFe(null),r;for(r in e)Tx(TFe,e,[r])===!0&&(t[r]=e[r]);return t}function DS(e,t){for(;e!==null;){var r=RFe(e,t);if(r){if(r.get)return Pa(r.get);if(typeof r.value=="function")return Pa(r.value)}e=EFe(e)}function n(i){return console.warn("fallback value for",i),null}return n}var D5=bi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sA=bi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lA=bi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),$Fe=bi(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uA=bi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),NFe=bi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$5=bi(["#text"]),N5=bi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),fA=bi(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),L5=bi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$S=bi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),LFe=co(/\{\{[\w\W]*|[\w\W]*\}\}/gm),FFe=co(/<%[\w\W]*|[\w\W]*%>/gm),HFe=co(/\${[\w\W]*}/gm),BFe=co(/^data-[\-\w.\u00B7-\uFFFF]/),VFe=co(/^aria-[\-\w]+$/),jFe=co(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),WFe=co(/^(?:\w+script|data):/i),UFe=co(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zFe=co(/^html$/i),GFe=function(){return typeof window>"u"?null:window},YFe=function(t,r){if(ql(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var a="dompurify"+(n?"#"+n:"");try{return t.createPolicy(a,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}};function Bne(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:GFe(),t=function(W){return Bne(W)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,a=e.HTMLTemplateElement,o=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=s.prototype,p=DS(v,"cloneNode"),g=DS(v,"nextSibling"),y=DS(v,"childNodes"),m=DS(v,"parentNode");if(typeof a=="function"){var b=n.createElement("template");b.content&&b.content.ownerDocument&&(n=b.content.ownerDocument)}var _=YFe(d,r),x=_?_.createHTML(""):"",T=n,E=T.implementation,P=T.createNodeIterator,R=T.createDocumentFragment,M=T.getElementsByTagName,D=r.importNode,N={};try{N=Sf(n).documentMode?n.documentMode:{}}catch{}var B={};t.isSupported=typeof m=="function"&&E&&typeof E.createHTMLDocument<"u"&&N!==9;var K=LFe,Z=FFe,ie=HFe,me=BFe,k=VFe,w=WFe,C=UFe,O=jFe,S=null,A=Ft({},[].concat(Xa(D5),Xa(sA),Xa(lA),Xa(uA),Xa($5))),I=null,L=Ft({},[].concat(Xa(N5),Xa(fA),Xa(L5),Xa($S))),V=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Y=null,ae=null,re=!0,te=!0,ge=!1,H=!0,Ce=!1,oe=!1,Oe=!1,Ee=!1,be=!1,Ie=!1,Me=!1,j=!0,U=!1,Q="user-content-",fe=!0,ee=!1,pe={},se=null,ue=Ft({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ce=null,ve=Ft({},["audio","video","img","source","image","track"]),de=null,Te=Ft({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$e="http://www.w3.org/1998/Math/MathML",Fe="http://www.w3.org/2000/svg",it="http://www.w3.org/1999/xhtml",gt=it,Ht=!1,ut=null,ft=Ft({},[$e,Fe,it],aA),Tt,Lt=["application/xhtml+xml","text/html"],It="text/html",bt,ht=null,Ke=n.createElement("form"),Be=function(W){return W instanceof RegExp||W instanceof Function},at=function(W){ht&&ht===W||((!W||ql(W)!=="object")&&(W={}),W=Sf(W),Tt=Lt.indexOf(W.PARSER_MEDIA_TYPE)===-1?Tt=It:Tt=W.PARSER_MEDIA_TYPE,bt=Tt==="application/xhtml+xml"?aA:aC,S="ALLOWED_TAGS"in W?Ft({},W.ALLOWED_TAGS,bt):A,I="ALLOWED_ATTR"in W?Ft({},W.ALLOWED_ATTR,bt):L,ut="ALLOWED_NAMESPACES"in W?Ft({},W.ALLOWED_NAMESPACES,aA):ft,de="ADD_URI_SAFE_ATTR"in W?Ft(Sf(Te),W.ADD_URI_SAFE_ATTR,bt):Te,ce="ADD_DATA_URI_TAGS"in W?Ft(Sf(ve),W.ADD_DATA_URI_TAGS,bt):ve,se="FORBID_CONTENTS"in W?Ft({},W.FORBID_CONTENTS,bt):ue,Y="FORBID_TAGS"in W?Ft({},W.FORBID_TAGS,bt):{},ae="FORBID_ATTR"in W?Ft({},W.FORBID_ATTR,bt):{},pe="USE_PROFILES"in W?W.USE_PROFILES:!1,re=W.ALLOW_ARIA_ATTR!==!1,te=W.ALLOW_DATA_ATTR!==!1,ge=W.ALLOW_UNKNOWN_PROTOCOLS||!1,H=W.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ce=W.SAFE_FOR_TEMPLATES||!1,oe=W.WHOLE_DOCUMENT||!1,be=W.RETURN_DOM||!1,Ie=W.RETURN_DOM_FRAGMENT||!1,Me=W.RETURN_TRUSTED_TYPE||!1,Ee=W.FORCE_BODY||!1,j=W.SANITIZE_DOM!==!1,U=W.SANITIZE_NAMED_PROPS||!1,fe=W.KEEP_CONTENT!==!1,ee=W.IN_PLACE||!1,O=W.ALLOWED_URI_REGEXP||O,gt=W.NAMESPACE||it,V=W.CUSTOM_ELEMENT_HANDLING||{},W.CUSTOM_ELEMENT_HANDLING&&Be(W.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=W.CUSTOM_ELEMENT_HANDLING.tagNameCheck),W.CUSTOM_ELEMENT_HANDLING&&Be(W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),W.CUSTOM_ELEMENT_HANDLING&&typeof W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ce&&(te=!1),Ie&&(be=!0),pe&&(S=Ft({},Xa($5)),I=[],pe.html===!0&&(Ft(S,D5),Ft(I,N5)),pe.svg===!0&&(Ft(S,sA),Ft(I,fA),Ft(I,$S)),pe.svgFilters===!0&&(Ft(S,lA),Ft(I,fA),Ft(I,$S)),pe.mathMl===!0&&(Ft(S,uA),Ft(I,L5),Ft(I,$S))),W.ADD_TAGS&&(S===A&&(S=Sf(S)),Ft(S,W.ADD_TAGS,bt)),W.ADD_ATTR&&(I===L&&(I=Sf(I)),Ft(I,W.ADD_ATTR,bt)),W.ADD_URI_SAFE_ATTR&&Ft(de,W.ADD_URI_SAFE_ATTR,bt),W.FORBID_CONTENTS&&(se===ue&&(se=Sf(se)),Ft(se,W.FORBID_CONTENTS,bt)),fe&&(S["#text"]=!0),oe&&Ft(S,["html","head","body"]),S.table&&(Ft(S,["tbody"]),delete Y.tbody),bi&&bi(W),ht=W)},He=Ft({},["mi","mo","mn","ms","mtext"]),ot=Ft({},["foreignobject","desc","title","annotation-xml"]),je=Ft({},["title","style","font","a","script"]),Ze=Ft({},sA);Ft(Ze,lA),Ft(Ze,$Fe);var Wt=Ft({},uA);Ft(Wt,NFe);var Ut=function(W){var ye=m(W);(!ye||!ye.tagName)&&(ye={namespaceURI:gt,tagName:"template"});var Se=aC(W.tagName),Pe=aC(ye.tagName);return ut[W.namespaceURI]?W.namespaceURI===Fe?ye.namespaceURI===it?Se==="svg":ye.namespaceURI===$e?Se==="svg"&&(Pe==="annotation-xml"||He[Pe]):!!Ze[Se]:W.namespaceURI===$e?ye.namespaceURI===it?Se==="math":ye.namespaceURI===Fe?Se==="math"&&ot[Pe]:!!Wt[Se]:W.namespaceURI===it?ye.namespaceURI===Fe&&!ot[Pe]||ye.namespaceURI===$e&&!He[Pe]?!1:!Wt[Se]&&(je[Se]||!Ze[Se]):!!(Tt==="application/xhtml+xml"&&ut[W.namespaceURI]):!1},Jt=function(W){my(t.removed,{element:W});try{W.parentNode.removeChild(W)}catch{try{W.outerHTML=x}catch{W.remove()}}},kn=function(W,ye){try{my(t.removed,{attribute:ye.getAttributeNode(W),from:ye})}catch{my(t.removed,{attribute:null,from:ye})}if(ye.removeAttribute(W),W==="is"&&!I[W])if(be||Ie)try{Jt(ye)}catch{}else try{ye.setAttribute(W,"")}catch{}},hr=function(W){var ye,Se;if(Ee)W="<remove></remove>"+W;else{var Pe=PFe(W,/^[\r\n\t ]+/);Se=Pe&&Pe[0]}Tt==="application/xhtml+xml"&&gt===it&&(W='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+W+"</body></html>");var Re=_?_.createHTML(W):W;if(gt===it)try{ye=new h().parseFromString(Re,Tt)}catch{}if(!ye||!ye.documentElement){ye=E.createDocument(gt,"template",null);try{ye.documentElement.innerHTML=Ht?x:Re}catch{}}var Ne=ye.body||ye.documentElement;return W&&Se&&Ne.insertBefore(n.createTextNode(Se),Ne.childNodes[0]||null),gt===it?M.call(ye,oe?"html":"body")[0]:oe?ye.documentElement:Ne},F=function(W){return P.call(W.ownerDocument||W,W,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},X=function(W){return W instanceof c&&(typeof W.nodeName!="string"||typeof W.textContent!="string"||typeof W.removeChild!="function"||!(W.attributes instanceof f)||typeof W.removeAttribute!="function"||typeof W.setAttribute!="function"||typeof W.namespaceURI!="string"||typeof W.insertBefore!="function"||typeof W.hasChildNodes!="function")},z=function(W){return ql(o)==="object"?W instanceof o:W&&ql(W)==="object"&&typeof W.nodeType=="number"&&typeof W.nodeName=="string"},G=function(W,ye,Se){B[W]&&AFe(B[W],function(Pe){Pe.call(t,ye,Se,ht)})},q=function(W){var ye;if(G("beforeSanitizeElements",W,null),X(W)||ti(/[\u0080-\uFFFF]/,W.nodeName))return Jt(W),!0;var Se=bt(W.nodeName);if(G("uponSanitizeElement",W,{tagName:Se,allowedTags:S}),W.hasChildNodes()&&!z(W.firstElementChild)&&(!z(W.content)||!z(W.content.firstElementChild))&&ti(/<[/\w]/g,W.innerHTML)&&ti(/<[/\w]/g,W.textContent)||Se==="select"&&ti(/<template/i,W.innerHTML))return Jt(W),!0;if(!S[Se]||Y[Se]){if(!Y[Se]&&_e(Se)&&(V.tagNameCheck instanceof RegExp&&ti(V.tagNameCheck,Se)||V.tagNameCheck instanceof Function&&V.tagNameCheck(Se)))return!1;if(fe&&!se[Se]){var Pe=m(W)||W.parentNode,Re=y(W)||W.childNodes;if(Re&&Pe)for(var Ne=Re.length,nt=Ne-1;nt>=0;--nt)Pe.insertBefore(p(Re[nt],!0),g(W))}return Jt(W),!0}return W instanceof s&&!Ut(W)||(Se==="noscript"||Se==="noembed")&&ti(/<\/no(script|embed)/i,W.innerHTML)?(Jt(W),!0):(Ce&&W.nodeType===3&&(ye=W.textContent,ye=Wa(ye,K," "),ye=Wa(ye,Z," "),ye=Wa(ye,ie," "),W.textContent!==ye&&(my(t.removed,{element:W.cloneNode()}),W.textContent=ye)),G("afterSanitizeElements",W,null),!1)},J=function(W,ye,Se){if(j&&(ye==="id"||ye==="name")&&(Se in n||Se in Ke))return!1;if(!(te&&!ae[ye]&&ti(me,ye))){if(!(re&&ti(k,ye))){if(!I[ye]||ae[ye]){if(!(_e(W)&&(V.tagNameCheck instanceof RegExp&&ti(V.tagNameCheck,W)||V.tagNameCheck instanceof Function&&V.tagNameCheck(W))&&(V.attributeNameCheck instanceof RegExp&&ti(V.attributeNameCheck,ye)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(ye))||ye==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&ti(V.tagNameCheck,Se)||V.tagNameCheck instanceof Function&&V.tagNameCheck(Se))))return!1}else if(!de[ye]){if(!ti(O,Wa(Se,C,""))){if(!((ye==="src"||ye==="xlink:href"||ye==="href")&&W!=="script"&&IFe(Se,"data:")===0&&ce[W])){if(!(ge&&!ti(w,Wa(Se,C,"")))){if(Se)return!1}}}}}}return!0},_e=function(W){return W.indexOf("-")>0},xe=function(W){var ye,Se,Pe,Re;G("beforeSanitizeAttributes",W,null);var Ne=W.attributes;if(Ne){var nt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};for(Re=Ne.length;Re--;){ye=Ne[Re];var dr=ye,Ot=dr.name,un=dr.namespaceURI;if(Se=Ot==="value"?ye.value:MFe(ye.value),Pe=bt(Ot),nt.attrName=Pe,nt.attrValue=Se,nt.keepAttr=!0,nt.forceKeepAttr=void 0,G("uponSanitizeAttribute",W,nt),Se=nt.attrValue,!nt.forceKeepAttr&&(kn(Ot,W),!!nt.keepAttr)){if(!H&&ti(/\/>/i,Se)){kn(Ot,W);continue}Ce&&(Se=Wa(Se,K," "),Se=Wa(Se,Z," "),Se=Wa(Se,ie," "));var El=bt(W.nodeName);if(J(El,Pe,Se)){if(U&&(Pe==="id"||Pe==="name")&&(kn(Ot,W),Se=Q+Se),_&&ql(d)==="object"&&typeof d.getAttributeType=="function"&&!un)switch(d.getAttributeType(El,Pe)){case"TrustedHTML":Se=_.createHTML(Se);break;case"TrustedScriptURL":Se=_.createScriptURL(Se);break}try{un?W.setAttributeNS(un,Ot,Se):W.setAttribute(Ot,Se),M5(t.removed)}catch{}}}}G("afterSanitizeAttributes",W,null)}},we=function he(W){var ye,Se=F(W);for(G("beforeSanitizeShadowDOM",W,null);ye=Se.nextNode();)G("uponSanitizeShadowNode",ye,null),!q(ye)&&(ye.content instanceof i&&he(ye.content),xe(ye));G("afterSanitizeShadowDOM",W,null)};return t.sanitize=function(he){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye,Se,Pe,Re,Ne;if(Ht=!he,Ht&&(he="<!-->"),typeof he!="string"&&!z(he)){if(typeof he.toString!="function")throw oA("toString is not a function");if(he=he.toString(),typeof he!="string")throw oA("dirty is not a string, aborting")}if(!t.isSupported){if(ql(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof he=="string")return e.toStaticHTML(he);if(z(he))return e.toStaticHTML(he.outerHTML)}return he}if(Oe||at(W),t.removed=[],typeof he=="string"&&(ee=!1),ee){if(he.nodeName){var nt=bt(he.nodeName);if(!S[nt]||Y[nt])throw oA("root node is forbidden and cannot be sanitized in-place")}}else if(he instanceof o)ye=hr("<!---->"),Se=ye.ownerDocument.importNode(he,!0),Se.nodeType===1&&Se.nodeName==="BODY"||Se.nodeName==="HTML"?ye=Se:ye.appendChild(Se);else{if(!be&&!Ce&&!oe&&he.indexOf("<")===-1)return _&&Me?_.createHTML(he):he;if(ye=hr(he),!ye)return be?null:Me?x:""}ye&&Ee&&Jt(ye.firstChild);for(var dr=F(ee?he:ye);Pe=dr.nextNode();)Pe.nodeType===3&&Pe===Re||q(Pe)||(Pe.content instanceof i&&we(Pe.content),xe(Pe),Re=Pe);if(Re=null,ee)return he;if(be){if(Ie)for(Ne=R.call(ye.ownerDocument);ye.firstChild;)Ne.appendChild(ye.firstChild);else Ne=ye;return(I.shadowroot||I.shadowrootmod)&&(Ne=D.call(r,Ne,!0)),Ne}var Ot=oe?ye.outerHTML:ye.innerHTML;return oe&&S["!doctype"]&&ye.ownerDocument&&ye.ownerDocument.doctype&&ye.ownerDocument.doctype.name&&ti(zFe,ye.ownerDocument.doctype.name)&&(Ot="<!DOCTYPE "+ye.ownerDocument.doctype.name+`>
`+Ot),Ce&&(Ot=Wa(Ot,K," "),Ot=Wa(Ot,Z," "),Ot=Wa(Ot,ie," ")),_&&Me?_.createHTML(Ot):Ot},t.setConfig=function(he){at(he),Oe=!0},t.clearConfig=function(){ht=null,Oe=!1},t.isValidAttribute=function(he,W,ye){ht||at({});var Se=bt(he),Pe=bt(W);return J(Se,Pe,ye)},t.addHook=function(he,W){typeof W=="function"&&(B[he]=B[he]||[],my(B[he],W))},t.removeHook=function(he){if(B[he])return M5(B[he])},t.removeHooks=function(he){B[he]&&(B[he]=[])},t.removeAllHooks=function(){B={}},t}var KFe=Bne(),XFe=vt,qFe=dF.codeAt;XFe({target:"String",proto:!0},{codePointAt:function(t){return qFe(this,t)}});var ZFe=Uu,JFe=sn,QFe=Fi,eHe=RangeError,Vne=function(t){var r=JFe(QFe(this)),n="",i=ZFe(t);if(i<0||i==1/0)throw eHe("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},jne=Pt,tHe=oh,F5=sn,rHe=Vne,nHe=Fi,iHe=jne(rHe),aHe=jne("".slice),oHe=Math.ceil,H5=function(e){return function(t,r,n){var i=F5(nHe(t)),a=tHe(r),o=i.length,s=n===void 0?" ":F5(n),l,u;return a<=o||s==""?i:(l=a-o,u=iHe(s,oHe(l/s.length)),u.length>l&&(u=aHe(u,0,l)),e?i+u:u+i)}},sHe={start:H5(!1),end:H5(!0)},lHe=th,uHe=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(lHe),fHe=vt,cHe=sHe.start,hHe=uHe;fHe({target:"String",proto:!0,forced:hHe},{padStart:function(t){return cHe(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Wne;function Ae(){return Wne.apply(null,arguments)}function dHe(e){Wne=e}function ho(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Tc(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function rr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function FF(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(rr(e,t))return!1;return!0}function Ei(e){return e===void 0}function pl(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function n_(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function Une(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function au(e,t){for(var r in t)rr(t,r)&&(e[r]=t[r]);return rr(t,"toString")&&(e.toString=t.toString),rr(t,"valueOf")&&(e.valueOf=t.valueOf),e}function os(e,t,r,n){return vie(e,t,r,n,!0).utc()}function vHe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Mt(e){return e._pf==null&&(e._pf=vHe()),e._pf}var zM;Array.prototype.some?zM=Array.prototype.some:zM=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function HF(e){if(e._isValid==null){var t=Mt(e),r=zM.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function ZO(e){var t=os(NaN);return e!=null?au(Mt(t),e):Mt(t).userInvalidated=!0,t}var B5=Ae.momentProperties=[],cA=!1;function BF(e,t){var r,n,i,a=B5.length;if(Ei(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Ei(t._i)||(e._i=t._i),Ei(t._f)||(e._f=t._f),Ei(t._l)||(e._l=t._l),Ei(t._strict)||(e._strict=t._strict),Ei(t._tzm)||(e._tzm=t._tzm),Ei(t._isUTC)||(e._isUTC=t._isUTC),Ei(t._offset)||(e._offset=t._offset),Ei(t._pf)||(e._pf=Mt(t)),Ei(t._locale)||(e._locale=t._locale),a>0)for(r=0;r<a;r++)n=B5[r],i=t[n],Ei(i)||(e[n]=i);return e}function i_(e){BF(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),cA===!1&&(cA=!0,Ae.updateOffset(this),cA=!1)}function vo(e){return e instanceof i_||e!=null&&e._isAMomentObject!=null}function zne(e){Ae.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function La(e,t){var r=!0;return au(function(){if(Ae.deprecationHandler!=null&&Ae.deprecationHandler(null,e),r){var n=[],i,a,o,s=arguments.length;for(a=0;a<s;a++){if(i="",typeof arguments[a]=="object"){i+=`
[`+a+"] ";for(o in arguments[0])rr(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[a];n.push(i)}zne(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var V5={};function Gne(e,t){Ae.deprecationHandler!=null&&Ae.deprecationHandler(e,t),V5[e]||(zne(t),V5[e]=!0)}Ae.suppressDeprecationWarnings=!1;Ae.deprecationHandler=null;function ss(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function pHe(e){var t,r;for(r in e)rr(e,r)&&(t=e[r],ss(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function GM(e,t){var r=au({},e),n;for(n in t)rr(t,n)&&(Tc(e[n])&&Tc(t[n])?(r[n]={},au(r[n],e[n]),au(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)rr(e,n)&&!rr(t,n)&&Tc(e[n])&&(r[n]=au({},r[n]));return r}function VF(e){e!=null&&this.set(e)}var YM;Object.keys?YM=Object.keys:YM=function(e){var t,r=[];for(t in e)rr(e,t)&&r.push(t);return r};var gHe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function yHe(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return ss(n)?n.call(t,r):n}function Zo(e,t,r){var n=""+Math.abs(e),i=t-n.length,a=e>=0;return(a?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var jF=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,NS=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,hA={},Hd={};function lt(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(Hd[e]=i),t&&(Hd[t[0]]=function(){return Zo(i.apply(this,arguments),t[1],t[2])}),r&&(Hd[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function mHe(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function bHe(e){var t=e.match(jF),r,n;for(r=0,n=t.length;r<n;r++)Hd[t[r]]?t[r]=Hd[t[r]]:t[r]=mHe(t[r]);return function(i){var a="",o;for(o=0;o<n;o++)a+=ss(t[o])?t[o].call(i,e):t[o];return a}}function oC(e,t){return e.isValid()?(t=Yne(t,e.localeData()),hA[t]=hA[t]||bHe(t),hA[t](e)):e.localeData().invalidDate()}function Yne(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(NS.lastIndex=0;r>=0&&NS.test(e);)e=e.replace(NS,n),NS.lastIndex=0,r-=1;return e}var wHe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function _He(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(jF).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var SHe="Invalid date";function CHe(){return this._invalidDate}var xHe="%d",THe=/\d{1,2}/;function OHe(e){return this._ordinal.replace("%d",e)}var EHe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function RHe(e,t,r,n){var i=this._relativeTime[r];return ss(i)?i(e,t,r,n):i.replace(/%d/i,e)}function kHe(e,t){var r=this._relativeTime[e>0?"future":"past"];return ss(r)?r(t):r.replace(/%s/i,t)}var Cm={};function Jn(e,t){var r=e.toLowerCase();Cm[r]=Cm[r+"s"]=Cm[t]=e}function Fa(e){return typeof e=="string"?Cm[e]||Cm[e.toLowerCase()]:void 0}function WF(e){var t={},r,n;for(n in e)rr(e,n)&&(r=Fa(n),r&&(t[r]=e[n]));return t}var Kne={};function Qn(e,t){Kne[e]=t}function AHe(e){var t=[],r;for(r in e)rr(e,r)&&t.push({unit:r,priority:Kne[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function JO(e){return e%4===0&&e%100!==0||e%400===0}function xa(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function jt(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=xa(t)),r}function Ig(e,t){return function(r){return r!=null?(Xne(this,e,r),Ae.updateOffset(this,t),this):Ox(this,e)}}function Ox(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Xne(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&JO(e.year())&&e.month()===1&&e.date()===29?(r=jt(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),iE(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function PHe(e){return e=Fa(e),ss(this[e])?this[e]():this}function IHe(e,t){if(typeof e=="object"){e=WF(e);var r=AHe(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=Fa(e),ss(this[e]))return this[e](t);return this}var qne=/\d/,oa=/\d\d/,Zne=/\d{3}/,UF=/\d{4}/,QO=/[+-]?\d{6}/,kr=/\d\d?/,Jne=/\d\d\d\d?/,Qne=/\d\d\d\d\d\d?/,eE=/\d{1,3}/,zF=/\d{1,4}/,tE=/[+-]?\d{1,6}/,Mg=/\d+/,rE=/[+-]?\d+/,MHe=/Z|[+-]\d\d:?\d\d/gi,nE=/Z|[+-]\d\d(?::?\d\d)?/gi,DHe=/[+-]?\d+(\.\d{1,3})?/,a_=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ex;Ex={};function tt(e,t,r){Ex[e]=ss(t)?t:function(n,i){return n&&r?r:t}}function $He(e,t){return rr(Ex,e)?Ex[e](t._strict,t._locale):new RegExp(NHe(e))}function NHe(e){return Yi(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,a){return r||n||i||a}))}function Yi(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var KM={};function br(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),pl(t)&&(n=function(a,o){o[t]=jt(a)}),i=e.length,r=0;r<i;r++)KM[e[r]]=n}function o_(e,t){br(e,function(r,n,i,a){i._w=i._w||{},t(r,i._w,i,a)})}function LHe(e,t,r){t!=null&&rr(KM,e)&&KM[e](t,r._a,r,e)}var Gn=0,ks=1,jo=2,bn=3,so=4,As=5,zf=6,FHe=7,HHe=8;function BHe(e,t){return(e%t+t)%t}var Jr;Array.prototype.indexOf?Jr=Array.prototype.indexOf:Jr=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function iE(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=BHe(t,12);return e+=(t-r)/12,r===1?JO(e)?29:28:31-r%7%2}lt("M",["MM",2],"Mo",function(){return this.month()+1});lt("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});lt("MMMM",0,0,function(e){return this.localeData().months(this,e)});Jn("month","M");Qn("month",8);tt("M",kr);tt("MM",kr,oa);tt("MMM",function(e,t){return t.monthsShortRegex(e)});tt("MMMM",function(e,t){return t.monthsRegex(e)});br(["M","MM"],function(e,t){t[ks]=jt(e)-1});br(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[ks]=i:Mt(r).invalidMonth=e});var VHe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),eie="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),tie=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,jHe=a_,WHe=a_;function UHe(e,t){return e?ho(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||tie).test(t)?"format":"standalone"][e.month()]:ho(this._months)?this._months:this._months.standalone}function zHe(e,t){return e?ho(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[tie.test(t)?"format":"standalone"][e.month()]:ho(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function GHe(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=os([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return r?t==="MMM"?(i=Jr.call(this._shortMonthsParse,o),i!==-1?i:null):(i=Jr.call(this._longMonthsParse,o),i!==-1?i:null):t==="MMM"?(i=Jr.call(this._shortMonthsParse,o),i!==-1?i:(i=Jr.call(this._longMonthsParse,o),i!==-1?i:null)):(i=Jr.call(this._longMonthsParse,o),i!==-1?i:(i=Jr.call(this._shortMonthsParse,o),i!==-1?i:null))}function YHe(e,t,r){var n,i,a;if(this._monthsParseExact)return GHe.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=os([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function rie(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=jt(t);else if(t=e.localeData().monthsParse(t),!pl(t))return e}return r=Math.min(e.date(),iE(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function nie(e){return e!=null?(rie(this,e),Ae.updateOffset(this,!0),this):Ox(this,"Month")}function KHe(){return iE(this.year(),this.month())}function XHe(e){return this._monthsParseExact?(rr(this,"_monthsRegex")||iie.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(rr(this,"_monthsShortRegex")||(this._monthsShortRegex=jHe),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function qHe(e){return this._monthsParseExact?(rr(this,"_monthsRegex")||iie.call(this),e?this._monthsStrictRegex:this._monthsRegex):(rr(this,"_monthsRegex")||(this._monthsRegex=WHe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function iie(){function e(o,s){return s.length-o.length}var t=[],r=[],n=[],i,a;for(i=0;i<12;i++)a=os([2e3,i]),t.push(this.monthsShort(a,"")),r.push(this.months(a,"")),n.push(this.months(a,"")),n.push(this.monthsShort(a,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=Yi(t[i]),r[i]=Yi(r[i]);for(i=0;i<24;i++)n[i]=Yi(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}lt("Y",0,0,function(){var e=this.year();return e<=9999?Zo(e,4):"+"+e});lt(0,["YY",2],0,function(){return this.year()%100});lt(0,["YYYY",4],0,"year");lt(0,["YYYYY",5],0,"year");lt(0,["YYYYYY",6,!0],0,"year");Jn("year","y");Qn("year",1);tt("Y",rE);tt("YY",kr,oa);tt("YYYY",zF,UF);tt("YYYYY",tE,QO);tt("YYYYYY",tE,QO);br(["YYYYY","YYYYYY"],Gn);br("YYYY",function(e,t){t[Gn]=e.length===2?Ae.parseTwoDigitYear(e):jt(e)});br("YY",function(e,t){t[Gn]=Ae.parseTwoDigitYear(e)});br("Y",function(e,t){t[Gn]=parseInt(e,10)});function xm(e){return JO(e)?366:365}Ae.parseTwoDigitYear=function(e){return jt(e)+(jt(e)>68?1900:2e3)};var aie=Ig("FullYear",!0);function ZHe(){return JO(this.year())}function JHe(e,t,r,n,i,a,o){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,i,a,o),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,i,a,o),s}function p0(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Rx(e,t,r){var n=7+t-r,i=(7+p0(e,0,n).getUTCDay()-t)%7;return-i+n-1}function oie(e,t,r,n,i){var a=(7+r-n)%7,o=Rx(e,n,i),s=1+7*(t-1)+a+o,l,u;return s<=0?(l=e-1,u=xm(l)+s):s>xm(e)?(l=e+1,u=s-xm(e)):(l=e,u=s),{year:l,dayOfYear:u}}function g0(e,t,r){var n=Rx(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;return i<1?(o=e.year()-1,a=i+ol(o,t,r)):i>ol(e.year(),t,r)?(a=i-ol(e.year(),t,r),o=e.year()+1):(o=e.year(),a=i),{week:a,year:o}}function ol(e,t,r){var n=Rx(e,t,r),i=Rx(e+1,t,r);return(xm(e)-n+i)/7}lt("w",["ww",2],"wo","week");lt("W",["WW",2],"Wo","isoWeek");Jn("week","w");Jn("isoWeek","W");Qn("week",5);Qn("isoWeek",5);tt("w",kr);tt("ww",kr,oa);tt("W",kr);tt("WW",kr,oa);o_(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=jt(e)});function QHe(e){return g0(e,this._week.dow,this._week.doy).week}var eBe={dow:0,doy:6};function tBe(){return this._week.dow}function rBe(){return this._week.doy}function nBe(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function iBe(e){var t=g0(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}lt("d",0,"do","day");lt("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});lt("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});lt("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});lt("e",0,0,"weekday");lt("E",0,0,"isoWeekday");Jn("day","d");Jn("weekday","e");Jn("isoWeekday","E");Qn("day",11);Qn("weekday",11);Qn("isoWeekday",11);tt("d",kr);tt("e",kr);tt("E",kr);tt("dd",function(e,t){return t.weekdaysMinRegex(e)});tt("ddd",function(e,t){return t.weekdaysShortRegex(e)});tt("dddd",function(e,t){return t.weekdaysRegex(e)});o_(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:Mt(r).invalidWeekday=e});o_(["d","e","E"],function(e,t,r,n){t[n]=jt(e)});function aBe(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function oBe(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function GF(e,t){return e.slice(t,7).concat(e.slice(0,t))}var sBe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),sie="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),lBe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),uBe=a_,fBe=a_,cBe=a_;function hBe(e,t){var r=ho(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?GF(r,this._week.dow):e?r[e.day()]:r}function dBe(e){return e===!0?GF(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function vBe(e){return e===!0?GF(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function pBe(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=os([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return r?t==="dddd"?(i=Jr.call(this._weekdaysParse,o),i!==-1?i:null):t==="ddd"?(i=Jr.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=Jr.call(this._minWeekdaysParse,o),i!==-1?i:null):t==="dddd"?(i=Jr.call(this._weekdaysParse,o),i!==-1||(i=Jr.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=Jr.call(this._minWeekdaysParse,o),i!==-1?i:null)):t==="ddd"?(i=Jr.call(this._shortWeekdaysParse,o),i!==-1||(i=Jr.call(this._weekdaysParse,o),i!==-1)?i:(i=Jr.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=Jr.call(this._minWeekdaysParse,o),i!==-1||(i=Jr.call(this._weekdaysParse,o),i!==-1)?i:(i=Jr.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function gBe(e,t,r){var n,i,a;if(this._weekdaysParseExact)return pBe.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=os([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function yBe(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=aBe(e,this.localeData()),this.add(e-t,"d")):t}function mBe(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function bBe(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=oBe(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function wBe(e){return this._weekdaysParseExact?(rr(this,"_weekdaysRegex")||YF.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(rr(this,"_weekdaysRegex")||(this._weekdaysRegex=uBe),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function _Be(e){return this._weekdaysParseExact?(rr(this,"_weekdaysRegex")||YF.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(rr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=fBe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function SBe(e){return this._weekdaysParseExact?(rr(this,"_weekdaysRegex")||YF.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(rr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=cBe),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function YF(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],i=[],a,o,s,l,u;for(a=0;a<7;a++)o=os([2e3,1]).day(a),s=Yi(this.weekdaysMin(o,"")),l=Yi(this.weekdaysShort(o,"")),u=Yi(this.weekdays(o,"")),t.push(s),r.push(l),n.push(u),i.push(s),i.push(l),i.push(u);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function KF(){return this.hours()%12||12}function CBe(){return this.hours()||24}lt("H",["HH",2],0,"hour");lt("h",["hh",2],0,KF);lt("k",["kk",2],0,CBe);lt("hmm",0,0,function(){return""+KF.apply(this)+Zo(this.minutes(),2)});lt("hmmss",0,0,function(){return""+KF.apply(this)+Zo(this.minutes(),2)+Zo(this.seconds(),2)});lt("Hmm",0,0,function(){return""+this.hours()+Zo(this.minutes(),2)});lt("Hmmss",0,0,function(){return""+this.hours()+Zo(this.minutes(),2)+Zo(this.seconds(),2)});function lie(e,t){lt(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}lie("a",!0);lie("A",!1);Jn("hour","h");Qn("hour",13);function uie(e,t){return t._meridiemParse}tt("a",uie);tt("A",uie);tt("H",kr);tt("h",kr);tt("k",kr);tt("HH",kr,oa);tt("hh",kr,oa);tt("kk",kr,oa);tt("hmm",Jne);tt("hmmss",Qne);tt("Hmm",Jne);tt("Hmmss",Qne);br(["H","HH"],bn);br(["k","kk"],function(e,t,r){var n=jt(e);t[bn]=n===24?0:n});br(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});br(["h","hh"],function(e,t,r){t[bn]=jt(e),Mt(r).bigHour=!0});br("hmm",function(e,t,r){var n=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n)),Mt(r).bigHour=!0});br("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n,2)),t[As]=jt(e.substr(i)),Mt(r).bigHour=!0});br("Hmm",function(e,t,r){var n=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n))});br("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n,2)),t[As]=jt(e.substr(i))});function xBe(e){return(e+"").toLowerCase().charAt(0)==="p"}var TBe=/[ap]\.?m?\.?/i,OBe=Ig("Hours",!0);function EBe(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var fie={calendar:gHe,longDateFormat:wHe,invalidDate:SHe,ordinal:xHe,dayOfMonthOrdinalParse:THe,relativeTime:EHe,months:VHe,monthsShort:eie,week:eBe,weekdays:sBe,weekdaysMin:lBe,weekdaysShort:sie,meridiemParse:TBe},Ar={},by={},y0;function RBe(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function j5(e){return e&&e.toLowerCase().replace("_","-")}function kBe(e){for(var t=0,r,n,i,a;t<e.length;){for(a=j5(e[t]).split("-"),r=a.length,n=j5(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=aE(a.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&RBe(a,n)>=r-1)break;r--}t++}return y0}function ABe(e){return e.match("^[^/\\\\]*$")!=null}function aE(e){var t=null,r;if(Ar[e]===void 0&&typeof module<"u"&&module&&module.exports&&ABe(e))try{t=y0._abbr,r=require,r("./locale/"+e),vu(t)}catch{Ar[e]=null}return Ar[e]}function vu(e,t){var r;return e&&(Ei(t)?r=xl(e):r=XF(e,t),r?y0=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),y0._abbr}function XF(e,t){if(t!==null){var r,n=fie;if(t.abbr=e,Ar[e]!=null)Gne("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ar[e]._config;else if(t.parentLocale!=null)if(Ar[t.parentLocale]!=null)n=Ar[t.parentLocale]._config;else if(r=aE(t.parentLocale),r!=null)n=r._config;else return by[t.parentLocale]||(by[t.parentLocale]=[]),by[t.parentLocale].push({name:e,config:t}),null;return Ar[e]=new VF(GM(n,t)),by[e]&&by[e].forEach(function(i){XF(i.name,i.config)}),vu(e),Ar[e]}else return delete Ar[e],null}function PBe(e,t){if(t!=null){var r,n,i=fie;Ar[e]!=null&&Ar[e].parentLocale!=null?Ar[e].set(GM(Ar[e]._config,t)):(n=aE(e),n!=null&&(i=n._config),t=GM(i,t),n==null&&(t.abbr=e),r=new VF(t),r.parentLocale=Ar[e],Ar[e]=r),vu(e)}else Ar[e]!=null&&(Ar[e].parentLocale!=null?(Ar[e]=Ar[e].parentLocale,e===vu()&&vu(e)):Ar[e]!=null&&delete Ar[e]);return Ar[e]}function xl(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return y0;if(!ho(e)){if(t=aE(e),t)return t;e=[e]}return kBe(e)}function IBe(){return YM(Ar)}function qF(e){var t,r=e._a;return r&&Mt(e).overflow===-2&&(t=r[ks]<0||r[ks]>11?ks:r[jo]<1||r[jo]>iE(r[Gn],r[ks])?jo:r[bn]<0||r[bn]>24||r[bn]===24&&(r[so]!==0||r[As]!==0||r[zf]!==0)?bn:r[so]<0||r[so]>59?so:r[As]<0||r[As]>59?As:r[zf]<0||r[zf]>999?zf:-1,Mt(e)._overflowDayOfYear&&(t<Gn||t>jo)&&(t=jo),Mt(e)._overflowWeeks&&t===-1&&(t=FHe),Mt(e)._overflowWeekday&&t===-1&&(t=HHe),Mt(e).overflow=t),e}var MBe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,DBe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,$Be=/Z|[+-]\d\d(?::?\d\d)?/,LS=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],dA=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],NBe=/^\/?Date\((-?\d+)/i,LBe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,FBe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function cie(e){var t,r,n=e._i,i=MBe.exec(n)||DBe.exec(n),a,o,s,l,u=LS.length,f=dA.length;if(i){for(Mt(e).iso=!0,t=0,r=u;t<r;t++)if(LS[t][1].exec(i[1])){o=LS[t][0],a=LS[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(i[3]){for(t=0,r=f;t<r;t++)if(dA[t][1].exec(i[3])){s=(i[2]||" ")+dA[t][0];break}if(s==null){e._isValid=!1;return}}if(!a&&s!=null){e._isValid=!1;return}if(i[4])if($Be.exec(i[4]))l="Z";else{e._isValid=!1;return}e._f=o+(s||"")+(l||""),JF(e)}else e._isValid=!1}function HBe(e,t,r,n,i,a){var o=[BBe(e),eie.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return a&&o.push(parseInt(a,10)),o}function BBe(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function VBe(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function jBe(e,t,r){if(e){var n=sie.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return Mt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function WBe(e,t,r){if(e)return FBe[e];if(t)return 0;var n=parseInt(r,10),i=n%100,a=(n-i)/100;return a*60+i}function hie(e){var t=LBe.exec(VBe(e._i)),r;if(t){if(r=HBe(t[4],t[3],t[2],t[5],t[6],t[7]),!jBe(t[1],r,e))return;e._a=r,e._tzm=WBe(t[8],t[9],t[10]),e._d=p0.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Mt(e).rfc2822=!0}else e._isValid=!1}function UBe(e){var t=NBe.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(cie(e),e._isValid===!1)delete e._isValid;else return;if(hie(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Ae.createFromInputFallback(e)}Ae.createFromInputFallback=La("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function pd(e,t,r){return e??t??r}function zBe(e){var t=new Date(Ae.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function ZF(e){var t,r,n=[],i,a,o;if(!e._d){for(i=zBe(e),e._w&&e._a[jo]==null&&e._a[ks]==null&&GBe(e),e._dayOfYear!=null&&(o=pd(e._a[Gn],i[Gn]),(e._dayOfYear>xm(o)||e._dayOfYear===0)&&(Mt(e)._overflowDayOfYear=!0),r=p0(o,0,e._dayOfYear),e._a[ks]=r.getUTCMonth(),e._a[jo]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[bn]===24&&e._a[so]===0&&e._a[As]===0&&e._a[zf]===0&&(e._nextDay=!0,e._a[bn]=0),e._d=(e._useUTC?p0:JHe).apply(null,n),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[bn]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==a&&(Mt(e).weekdayMismatch=!0)}}function GBe(e){var t,r,n,i,a,o,s,l,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(a=1,o=4,r=pd(t.GG,e._a[Gn],g0(Er(),1,4).year),n=pd(t.W,1),i=pd(t.E,1),(i<1||i>7)&&(l=!0)):(a=e._locale._week.dow,o=e._locale._week.doy,u=g0(Er(),a,o),r=pd(t.gg,e._a[Gn],u.year),n=pd(t.w,u.week),t.d!=null?(i=t.d,(i<0||i>6)&&(l=!0)):t.e!=null?(i=t.e+a,(t.e<0||t.e>6)&&(l=!0)):i=a),n<1||n>ol(r,a,o)?Mt(e)._overflowWeeks=!0:l!=null?Mt(e)._overflowWeekday=!0:(s=oie(r,n,i,a,o),e._a[Gn]=s.year,e._dayOfYear=s.dayOfYear)}Ae.ISO_8601=function(){};Ae.RFC_2822=function(){};function JF(e){if(e._f===Ae.ISO_8601){cie(e);return}if(e._f===Ae.RFC_2822){hie(e);return}e._a=[],Mt(e).empty=!0;var t=""+e._i,r,n,i,a,o,s=t.length,l=0,u,f;for(i=Yne(e._f,e._locale).match(jF)||[],f=i.length,r=0;r<f;r++)a=i[r],n=(t.match($He(a,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&Mt(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),l+=n.length),Hd[a]?(n?Mt(e).empty=!1:Mt(e).unusedTokens.push(a),LHe(a,n,e)):e._strict&&!n&&Mt(e).unusedTokens.push(a);Mt(e).charsLeftOver=s-l,t.length>0&&Mt(e).unusedInput.push(t),e._a[bn]<=12&&Mt(e).bigHour===!0&&e._a[bn]>0&&(Mt(e).bigHour=void 0),Mt(e).parsedDateParts=e._a.slice(0),Mt(e).meridiem=e._meridiem,e._a[bn]=YBe(e._locale,e._a[bn],e._meridiem),u=Mt(e).era,u!==null&&(e._a[Gn]=e._locale.erasConvertYear(u,e._a[Gn])),ZF(e),qF(e)}function YBe(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function KBe(e){var t,r,n,i,a,o,s=!1,l=e._f.length;if(l===0){Mt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<l;i++)a=0,o=!1,t=BF({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],JF(t),HF(t)&&(o=!0),a+=Mt(t).charsLeftOver,a+=Mt(t).unusedTokens.length*10,Mt(t).score=a,s?a<n&&(n=a,r=t):(n==null||a<n||o)&&(n=a,r=t,o&&(s=!0));au(e,r||t)}function XBe(e){if(!e._d){var t=WF(e._i),r=t.day===void 0?t.date:t.day;e._a=Une([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),ZF(e)}}function qBe(e){var t=new i_(qF(die(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function die(e){var t=e._i,r=e._f;return e._locale=e._locale||xl(e._l),t===null||r===void 0&&t===""?ZO({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),vo(t)?new i_(qF(t)):(n_(t)?e._d=t:ho(r)?KBe(e):r?JF(e):ZBe(e),HF(e)||(e._d=null),e))}function ZBe(e){var t=e._i;Ei(t)?e._d=new Date(Ae.now()):n_(t)?e._d=new Date(t.valueOf()):typeof t=="string"?UBe(e):ho(t)?(e._a=Une(t.slice(0),function(r){return parseInt(r,10)}),ZF(e)):Tc(t)?XBe(e):pl(t)?e._d=new Date(t):Ae.createFromInputFallback(e)}function vie(e,t,r,n,i){var a={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Tc(e)&&FF(e)||ho(e)&&e.length===0)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=r,a._i=e,a._f=t,a._strict=n,qBe(a)}function Er(e,t,r,n){return vie(e,t,r,n,!1)}var JBe=La("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Er.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:ZO()}),QBe=La("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Er.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:ZO()});function pie(e,t){var r,n;if(t.length===1&&ho(t[0])&&(t=t[0]),!t.length)return Er();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function e3e(){var e=[].slice.call(arguments,0);return pie("isBefore",e)}function t3e(){var e=[].slice.call(arguments,0);return pie("isAfter",e)}var r3e=function(){return Date.now?Date.now():+new Date},wy=["year","quarter","month","week","day","hour","minute","second","millisecond"];function n3e(e){var t,r=!1,n,i=wy.length;for(t in e)if(rr(e,t)&&!(Jr.call(wy,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[wy[n]]){if(r)return!1;parseFloat(e[wy[n]])!==jt(e[wy[n]])&&(r=!0)}return!0}function i3e(){return this._isValid}function a3e(){return wo(NaN)}function oE(e){var t=WF(e),r=t.year||0,n=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=n3e(t),this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60,this._days=+o+a*7,this._months=+i+n*3+r*12,this._data={},this._locale=xl(),this._bubble()}function sC(e){return e instanceof oE}function XM(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function o3e(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0,o;for(o=0;o<n;o++)(r&&e[o]!==t[o]||!r&&jt(e[o])!==jt(t[o]))&&a++;return a+i}function gie(e,t){lt(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Zo(~~(r/60),2)+t+Zo(~~r%60,2)})}gie("Z",":");gie("ZZ","");tt("Z",nE);tt("ZZ",nE);br(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=QF(nE,e)});var s3e=/([\+\-]|\d\d)/gi;function QF(e,t){var r=(t||"").match(e),n,i,a;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(s3e)||["-",0,0],a=+(i[1]*60)+jt(i[2]),a===0?0:i[0]==="+"?a:-a)}function eH(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(vo(e)||n_(e)?e.valueOf():Er(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ae.updateOffset(r,!1),r):Er(e).local()}function qM(e){return-Math.round(e._d.getTimezoneOffset())}Ae.updateOffset=function(){};function l3e(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=QF(nE,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=qM(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?bie(this,wo(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ae.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:qM(this)}function u3e(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function f3e(e){return this.utcOffset(0,e)}function c3e(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(qM(this),"m")),this}function h3e(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=QF(MHe,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function d3e(e){return this.isValid()?(e=e?Er(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function v3e(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function p3e(){if(!Ei(this._isDSTShifted))return this._isDSTShifted;var e={},t;return BF(e,this),e=die(e),e._a?(t=e._isUTC?os(e._a):Er(e._a),this._isDSTShifted=this.isValid()&&o3e(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function g3e(){return this.isValid()?!this._isUTC:!1}function y3e(){return this.isValid()?this._isUTC:!1}function yie(){return this.isValid()?this._isUTC&&this._offset===0:!1}var m3e=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,b3e=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function wo(e,t){var r=e,n=null,i,a,o;return sC(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:pl(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=m3e.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:jt(n[jo])*i,h:jt(n[bn])*i,m:jt(n[so])*i,s:jt(n[As])*i,ms:jt(XM(n[zf]*1e3))*i}):(n=b3e.exec(e))?(i=n[1]==="-"?-1:1,r={y:Cf(n[2],i),M:Cf(n[3],i),w:Cf(n[4],i),d:Cf(n[5],i),h:Cf(n[6],i),m:Cf(n[7],i),s:Cf(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=w3e(Er(r.from),Er(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),a=new oE(r),sC(e)&&rr(e,"_locale")&&(a._locale=e._locale),sC(e)&&rr(e,"_isValid")&&(a._isValid=e._isValid),a}wo.fn=oE.prototype;wo.invalid=a3e;function Cf(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function W5(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function w3e(e,t){var r;return e.isValid()&&t.isValid()?(t=eH(t,e),e.isBefore(t)?r=W5(e,t):(r=W5(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function mie(e,t){return function(r,n){var i,a;return n!==null&&!isNaN(+n)&&(Gne(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=r,r=n,n=a),i=wo(r,n),bie(this,i,e),this}}function bie(e,t,r,n){var i=t._milliseconds,a=XM(t._days),o=XM(t._months);e.isValid()&&(n=n??!0,o&&rie(e,Ox(e,"Month")+o*r),a&&Xne(e,"Date",Ox(e,"Date")+a*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&Ae.updateOffset(e,a||o))}var _3e=mie(1,"add"),S3e=mie(-1,"subtract");function wie(e){return typeof e=="string"||e instanceof String}function C3e(e){return vo(e)||n_(e)||wie(e)||pl(e)||T3e(e)||x3e(e)||e===null||e===void 0}function x3e(e){var t=Tc(e)&&!FF(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,a,o=n.length;for(i=0;i<o;i+=1)a=n[i],r=r||rr(e,a);return t&&r}function T3e(e){var t=ho(e),r=!1;return t&&(r=e.filter(function(n){return!pl(n)&&wie(e)}).length===0),t&&r}function O3e(e){var t=Tc(e)&&!FF(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,a;for(i=0;i<n.length;i+=1)a=n[i],r=r||rr(e,a);return t&&r}function E3e(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function R3e(e,t){arguments.length===1&&(arguments[0]?C3e(arguments[0])?(e=arguments[0],t=void 0):O3e(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Er(),n=eH(r,this).startOf("day"),i=Ae.calendarFormat(this,n)||"sameElse",a=t&&(ss(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,Er(r)))}function k3e(){return new i_(this)}function A3e(e,t){var r=vo(e)?e:Er(e);return this.isValid()&&r.isValid()?(t=Fa(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function P3e(e,t){var r=vo(e)?e:Er(e);return this.isValid()&&r.isValid()?(t=Fa(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function I3e(e,t,r,n){var i=vo(e)?e:Er(e),a=vo(t)?t:Er(t);return this.isValid()&&i.isValid()&&a.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(a,r):!this.isAfter(a,r))):!1}function M3e(e,t){var r=vo(e)?e:Er(e),n;return this.isValid()&&r.isValid()?(t=Fa(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function D3e(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function $3e(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function N3e(e,t,r){var n,i,a;if(!this.isValid())return NaN;if(n=eH(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=Fa(t),t){case"year":a=lC(this,n)/12;break;case"month":a=lC(this,n);break;case"quarter":a=lC(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return r?a:xa(a)}function lC(e,t){if(e.date()<t.date())return-lC(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,a;return t-n<0?(i=e.clone().add(r-1,"months"),a=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),a=(t-n)/(i-n)),-(r+a)||0}Ae.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ae.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function L3e(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function F3e(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?oC(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ss(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",oC(r,"Z")):oC(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function H3e(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,a;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",a=t+'[")]',this.format(r+n+i+a)}function B3e(e){e||(e=this.isUtc()?Ae.defaultFormatUtc:Ae.defaultFormat);var t=oC(this,e);return this.localeData().postformat(t)}function V3e(e,t){return this.isValid()&&(vo(e)&&e.isValid()||Er(e).isValid())?wo({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function j3e(e){return this.from(Er(),e)}function W3e(e,t){return this.isValid()&&(vo(e)&&e.isValid()||Er(e).isValid())?wo({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function U3e(e){return this.to(Er(),e)}function _ie(e){var t;return e===void 0?this._locale._abbr:(t=xl(e),t!=null&&(this._locale=t),this)}var Sie=La("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function Cie(){return this._locale}var kx=1e3,Bd=60*kx,Ax=60*Bd,xie=(365*400+97)*24*Ax;function Vd(e,t){return(e%t+t)%t}function Tie(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-xie:new Date(e,t,r).valueOf()}function Oie(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-xie:Date.UTC(e,t,r)}function z3e(e){var t,r;if(e=Fa(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Oie:Tie,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Vd(t+(this._isUTC?0:this.utcOffset()*Bd),Ax);break;case"minute":t=this._d.valueOf(),t-=Vd(t,Bd);break;case"second":t=this._d.valueOf(),t-=Vd(t,kx);break}return this._d.setTime(t),Ae.updateOffset(this,!0),this}function G3e(e){var t,r;if(e=Fa(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Oie:Tie,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Ax-Vd(t+(this._isUTC?0:this.utcOffset()*Bd),Ax)-1;break;case"minute":t=this._d.valueOf(),t+=Bd-Vd(t,Bd)-1;break;case"second":t=this._d.valueOf(),t+=kx-Vd(t,kx)-1;break}return this._d.setTime(t),Ae.updateOffset(this,!0),this}function Y3e(){return this._d.valueOf()-(this._offset||0)*6e4}function K3e(){return Math.floor(this.valueOf()/1e3)}function X3e(){return new Date(this.valueOf())}function q3e(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Z3e(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function J3e(){return this.isValid()?this.toISOString():null}function Q3e(){return HF(this)}function e4e(){return au({},Mt(this))}function t4e(){return Mt(this).overflow}function r4e(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}lt("N",0,0,"eraAbbr");lt("NN",0,0,"eraAbbr");lt("NNN",0,0,"eraAbbr");lt("NNNN",0,0,"eraName");lt("NNNNN",0,0,"eraNarrow");lt("y",["y",1],"yo","eraYear");lt("y",["yy",2],0,"eraYear");lt("y",["yyy",3],0,"eraYear");lt("y",["yyyy",4],0,"eraYear");tt("N",tH);tt("NN",tH);tt("NNN",tH);tt("NNNN",d4e);tt("NNNNN",v4e);br(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?Mt(r).era=i:Mt(r).invalidEra=e});tt("y",Mg);tt("yy",Mg);tt("yyy",Mg);tt("yyyy",Mg);tt("yo",p4e);br(["y","yy","yyy","yyyy"],Gn);br(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Gn]=r._locale.eraYearOrdinalParse(e,i):t[Gn]=parseInt(e,10)});function n4e(e,t){var r,n,i,a=this._eras||xl("en")._eras;for(r=0,n=a.length;r<n;++r){switch(typeof a[r].since){case"string":i=Ae(a[r].since).startOf("day"),a[r].since=i.valueOf();break}switch(typeof a[r].until){case"undefined":a[r].until=1/0;break;case"string":i=Ae(a[r].until).startOf("day").valueOf(),a[r].until=i.valueOf();break}}return a}function i4e(e,t,r){var n,i,a=this.eras(),o,s,l;for(e=e.toUpperCase(),n=0,i=a.length;n<i;++n)if(o=a[n].name.toUpperCase(),s=a[n].abbr.toUpperCase(),l=a[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return a[n];break;case"NNNN":if(o===e)return a[n];break;case"NNNNN":if(l===e)return a[n];break}else if([o,s,l].indexOf(e)>=0)return a[n]}function a4e(e,t){var r=e.since<=e.until?1:-1;return t===void 0?Ae(e.since).year():Ae(e.since).year()+(t-e.offset)*r}function o4e(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function s4e(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function l4e(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function u4e(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-Ae(i[e].since).year())*r+i[e].offset;return this.year()}function f4e(e){return rr(this,"_erasNameRegex")||rH.call(this),e?this._erasNameRegex:this._erasRegex}function c4e(e){return rr(this,"_erasAbbrRegex")||rH.call(this),e?this._erasAbbrRegex:this._erasRegex}function h4e(e){return rr(this,"_erasNarrowRegex")||rH.call(this),e?this._erasNarrowRegex:this._erasRegex}function tH(e,t){return t.erasAbbrRegex(e)}function d4e(e,t){return t.erasNameRegex(e)}function v4e(e,t){return t.erasNarrowRegex(e)}function p4e(e,t){return t._eraYearOrdinalRegex||Mg}function rH(){var e=[],t=[],r=[],n=[],i,a,o=this.eras();for(i=0,a=o.length;i<a;++i)t.push(Yi(o[i].name)),e.push(Yi(o[i].abbr)),r.push(Yi(o[i].narrow)),n.push(Yi(o[i].name)),n.push(Yi(o[i].abbr)),n.push(Yi(o[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}lt(0,["gg",2],0,function(){return this.weekYear()%100});lt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function sE(e,t){lt(0,[e,e.length],0,t)}sE("gggg","weekYear");sE("ggggg","weekYear");sE("GGGG","isoWeekYear");sE("GGGGG","isoWeekYear");Jn("weekYear","gg");Jn("isoWeekYear","GG");Qn("weekYear",1);Qn("isoWeekYear",1);tt("G",rE);tt("g",rE);tt("GG",kr,oa);tt("gg",kr,oa);tt("GGGG",zF,UF);tt("gggg",zF,UF);tt("GGGGG",tE,QO);tt("ggggg",tE,QO);o_(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=jt(e)});o_(["gg","GG"],function(e,t,r,n){t[n]=Ae.parseTwoDigitYear(e)});function g4e(e){return Eie.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function y4e(e){return Eie.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function m4e(){return ol(this.year(),1,4)}function b4e(){return ol(this.isoWeekYear(),1,4)}function w4e(){var e=this.localeData()._week;return ol(this.year(),e.dow,e.doy)}function _4e(){var e=this.localeData()._week;return ol(this.weekYear(),e.dow,e.doy)}function Eie(e,t,r,n,i){var a;return e==null?g0(this,n,i).year:(a=ol(e,n,i),t>a&&(t=a),S4e.call(this,e,t,r,n,i))}function S4e(e,t,r,n,i){var a=oie(e,t,r,n,i),o=p0(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}lt("Q",0,"Qo","quarter");Jn("quarter","Q");Qn("quarter",7);tt("Q",qne);br("Q",function(e,t){t[ks]=(jt(e)-1)*3});function C4e(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}lt("D",["DD",2],"Do","date");Jn("date","D");Qn("date",9);tt("D",kr);tt("DD",kr,oa);tt("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});br(["D","DD"],jo);br("Do",function(e,t){t[jo]=jt(e.match(kr)[0])});var Rie=Ig("Date",!0);lt("DDD",["DDDD",3],"DDDo","dayOfYear");Jn("dayOfYear","DDD");Qn("dayOfYear",4);tt("DDD",eE);tt("DDDD",Zne);br(["DDD","DDDD"],function(e,t,r){r._dayOfYear=jt(e)});function x4e(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}lt("m",["mm",2],0,"minute");Jn("minute","m");Qn("minute",14);tt("m",kr);tt("mm",kr,oa);br(["m","mm"],so);var T4e=Ig("Minutes",!1);lt("s",["ss",2],0,"second");Jn("second","s");Qn("second",15);tt("s",kr);tt("ss",kr,oa);br(["s","ss"],As);var O4e=Ig("Seconds",!1);lt("S",0,0,function(){return~~(this.millisecond()/100)});lt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});lt(0,["SSS",3],0,"millisecond");lt(0,["SSSS",4],0,function(){return this.millisecond()*10});lt(0,["SSSSS",5],0,function(){return this.millisecond()*100});lt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});lt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});lt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});lt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Jn("millisecond","ms");Qn("millisecond",16);tt("S",eE,qne);tt("SS",eE,oa);tt("SSS",eE,Zne);var ou,kie;for(ou="SSSS";ou.length<=9;ou+="S")tt(ou,Mg);function E4e(e,t){t[zf]=jt(("0."+e)*1e3)}for(ou="S";ou.length<=9;ou+="S")br(ou,E4e);kie=Ig("Milliseconds",!1);lt("z",0,0,"zoneAbbr");lt("zz",0,0,"zoneName");function R4e(){return this._isUTC?"UTC":""}function k4e(){return this._isUTC?"Coordinated Universal Time":""}var De=i_.prototype;De.add=_3e;De.calendar=R3e;De.clone=k3e;De.diff=N3e;De.endOf=G3e;De.format=B3e;De.from=V3e;De.fromNow=j3e;De.to=W3e;De.toNow=U3e;De.get=PHe;De.invalidAt=t4e;De.isAfter=A3e;De.isBefore=P3e;De.isBetween=I3e;De.isSame=M3e;De.isSameOrAfter=D3e;De.isSameOrBefore=$3e;De.isValid=Q3e;De.lang=Sie;De.locale=_ie;De.localeData=Cie;De.max=QBe;De.min=JBe;De.parsingFlags=e4e;De.set=IHe;De.startOf=z3e;De.subtract=S3e;De.toArray=q3e;De.toObject=Z3e;De.toDate=X3e;De.toISOString=F3e;De.inspect=H3e;typeof Symbol<"u"&&Symbol.for!=null&&(De[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});De.toJSON=J3e;De.toString=L3e;De.unix=K3e;De.valueOf=Y3e;De.creationData=r4e;De.eraName=o4e;De.eraNarrow=s4e;De.eraAbbr=l4e;De.eraYear=u4e;De.year=aie;De.isLeapYear=ZHe;De.weekYear=g4e;De.isoWeekYear=y4e;De.quarter=De.quarters=C4e;De.month=nie;De.daysInMonth=KHe;De.week=De.weeks=nBe;De.isoWeek=De.isoWeeks=iBe;De.weeksInYear=w4e;De.weeksInWeekYear=_4e;De.isoWeeksInYear=m4e;De.isoWeeksInISOWeekYear=b4e;De.date=Rie;De.day=De.days=yBe;De.weekday=mBe;De.isoWeekday=bBe;De.dayOfYear=x4e;De.hour=De.hours=OBe;De.minute=De.minutes=T4e;De.second=De.seconds=O4e;De.millisecond=De.milliseconds=kie;De.utcOffset=l3e;De.utc=f3e;De.local=c3e;De.parseZone=h3e;De.hasAlignedHourOffset=d3e;De.isDST=v3e;De.isLocal=g3e;De.isUtcOffset=y3e;De.isUtc=yie;De.isUTC=yie;De.zoneAbbr=R4e;De.zoneName=k4e;De.dates=La("dates accessor is deprecated. Use date instead.",Rie);De.months=La("months accessor is deprecated. Use month instead",nie);De.years=La("years accessor is deprecated. Use year instead",aie);De.zone=La("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",u3e);De.isDSTShifted=La("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",p3e);function A4e(e){return Er(e*1e3)}function P4e(){return Er.apply(null,arguments).parseZone()}function Aie(e){return e}var nr=VF.prototype;nr.calendar=yHe;nr.longDateFormat=_He;nr.invalidDate=CHe;nr.ordinal=OHe;nr.preparse=Aie;nr.postformat=Aie;nr.relativeTime=RHe;nr.pastFuture=kHe;nr.set=pHe;nr.eras=n4e;nr.erasParse=i4e;nr.erasConvertYear=a4e;nr.erasAbbrRegex=c4e;nr.erasNameRegex=f4e;nr.erasNarrowRegex=h4e;nr.months=UHe;nr.monthsShort=zHe;nr.monthsParse=YHe;nr.monthsRegex=qHe;nr.monthsShortRegex=XHe;nr.week=QHe;nr.firstDayOfYear=rBe;nr.firstDayOfWeek=tBe;nr.weekdays=hBe;nr.weekdaysMin=vBe;nr.weekdaysShort=dBe;nr.weekdaysParse=gBe;nr.weekdaysRegex=wBe;nr.weekdaysShortRegex=_Be;nr.weekdaysMinRegex=SBe;nr.isPM=xBe;nr.meridiem=EBe;function Px(e,t,r,n){var i=xl(),a=os().set(n,t);return i[r](a,e)}function Pie(e,t,r){if(pl(e)&&(t=e,e=void 0),e=e||"",t!=null)return Px(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=Px(e,n,r,"month");return i}function nH(e,t,r,n){typeof e=="boolean"?(pl(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,pl(t)&&(r=t,t=void 0),t=t||"");var i=xl(),a=e?i._week.dow:0,o,s=[];if(r!=null)return Px(t,(r+a)%7,n,"day");for(o=0;o<7;o++)s[o]=Px(t,(o+a)%7,n,"day");return s}function I4e(e,t){return Pie(e,t,"months")}function M4e(e,t){return Pie(e,t,"monthsShort")}function D4e(e,t,r){return nH(e,t,r,"weekdays")}function $4e(e,t,r){return nH(e,t,r,"weekdaysShort")}function N4e(e,t,r){return nH(e,t,r,"weekdaysMin")}vu("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=jt(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});Ae.lang=La("moment.lang is deprecated. Use moment.locale instead.",vu);Ae.langData=La("moment.langData is deprecated. Use moment.localeData instead.",xl);var ds=Math.abs;function L4e(){var e=this._data;return this._milliseconds=ds(this._milliseconds),this._days=ds(this._days),this._months=ds(this._months),e.milliseconds=ds(e.milliseconds),e.seconds=ds(e.seconds),e.minutes=ds(e.minutes),e.hours=ds(e.hours),e.months=ds(e.months),e.years=ds(e.years),this}function Iie(e,t,r,n){var i=wo(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function F4e(e,t){return Iie(this,e,t,1)}function H4e(e,t){return Iie(this,e,t,-1)}function U5(e){return e<0?Math.floor(e):Math.ceil(e)}function B4e(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,a,o,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=U5(ZM(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=xa(e/1e3),n.seconds=i%60,a=xa(i/60),n.minutes=a%60,o=xa(a/60),n.hours=o%24,t+=xa(o/24),l=xa(Mie(t)),r+=l,t-=U5(ZM(l)),s=xa(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function Mie(e){return e*4800/146097}function ZM(e){return e*146097/4800}function V4e(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Fa(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+Mie(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(ZM(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function j4e(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+jt(this._months/12)*31536e6:NaN}function Tl(e){return function(){return this.as(e)}}var W4e=Tl("ms"),U4e=Tl("s"),z4e=Tl("m"),G4e=Tl("h"),Y4e=Tl("d"),K4e=Tl("w"),X4e=Tl("M"),q4e=Tl("Q"),Z4e=Tl("y");function J4e(){return wo(this)}function Q4e(e){return e=Fa(e),this.isValid()?this[e+"s"]():NaN}function uh(e){return function(){return this.isValid()?this._data[e]:NaN}}var eVe=uh("milliseconds"),tVe=uh("seconds"),rVe=uh("minutes"),nVe=uh("hours"),iVe=uh("days"),aVe=uh("months"),oVe=uh("years");function sVe(){return xa(this.days()/7)}var Ss=Math.round,Ed={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function lVe(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function uVe(e,t,r,n){var i=wo(e).abs(),a=Ss(i.as("s")),o=Ss(i.as("m")),s=Ss(i.as("h")),l=Ss(i.as("d")),u=Ss(i.as("M")),f=Ss(i.as("w")),c=Ss(i.as("y")),h=a<=r.ss&&["s",a]||a<r.s&&["ss",a]||o<=1&&["m"]||o<r.m&&["mm",o]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,lVe.apply(null,h)}function fVe(e){return e===void 0?Ss:typeof e=="function"?(Ss=e,!0):!1}function cVe(e,t){return Ed[e]===void 0?!1:t===void 0?Ed[e]:(Ed[e]=t,e==="s"&&(Ed.ss=t-1),!0)}function hVe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Ed,i,a;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Ed,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),a=uVe(this,!r,n,i),r&&(a=i.pastFuture(+this,a)),i.postformat(a)}var vA=Math.abs;function Bh(e){return(e>0)-(e<0)||+e}function lE(){if(!this.isValid())return this.localeData().invalidDate();var e=vA(this._milliseconds)/1e3,t=vA(this._days),r=vA(this._months),n,i,a,o,s=this.asSeconds(),l,u,f,c;return s?(n=xa(e/60),i=xa(n/60),e%=60,n%=60,a=xa(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=Bh(this._months)!==Bh(s)?"-":"",f=Bh(this._days)!==Bh(s)?"-":"",c=Bh(this._milliseconds)!==Bh(s)?"-":"",l+"P"+(a?u+a+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(i||n||e?"T":"")+(i?c+i+"H":"")+(n?c+n+"M":"")+(e?c+o+"S":"")):"P0D"}var Zt=oE.prototype;Zt.isValid=i3e;Zt.abs=L4e;Zt.add=F4e;Zt.subtract=H4e;Zt.as=V4e;Zt.asMilliseconds=W4e;Zt.asSeconds=U4e;Zt.asMinutes=z4e;Zt.asHours=G4e;Zt.asDays=Y4e;Zt.asWeeks=K4e;Zt.asMonths=X4e;Zt.asQuarters=q4e;Zt.asYears=Z4e;Zt.valueOf=j4e;Zt._bubble=B4e;Zt.clone=J4e;Zt.get=Q4e;Zt.milliseconds=eVe;Zt.seconds=tVe;Zt.minutes=rVe;Zt.hours=nVe;Zt.days=iVe;Zt.weeks=sVe;Zt.months=aVe;Zt.years=oVe;Zt.humanize=hVe;Zt.toISOString=lE;Zt.toString=lE;Zt.toJSON=lE;Zt.locale=_ie;Zt.localeData=Cie;Zt.toIsoString=La("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",lE);Zt.lang=Sie;lt("X",0,0,"unix");lt("x",0,0,"valueOf");tt("x",rE);tt("X",DHe);br("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});br("x",function(e,t,r){r._d=new Date(jt(e))});//! moment.js
Ae.version="2.29.4";dHe(Er);Ae.fn=De;Ae.min=e3e;Ae.max=t3e;Ae.now=r3e;Ae.utc=os;Ae.unix=A4e;Ae.months=I4e;Ae.isDate=n_;Ae.locale=vu;Ae.invalid=ZO;Ae.duration=wo;Ae.isMoment=vo;Ae.weekdays=D4e;Ae.parseZone=P4e;Ae.localeData=xl;Ae.isDuration=sC;Ae.monthsShort=M4e;Ae.weekdaysMin=N4e;Ae.defineLocale=XF;Ae.updateLocale=PBe;Ae.locales=IBe;Ae.weekdaysShort=$4e;Ae.normalizeUnits=Fa;Ae.relativeTimeRounding=fVe;Ae.relativeTimeThreshold=cVe;Ae.calendarFormat=E3e;Ae.prototype=De;Ae.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const dVe=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"}));function sr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=Xr(e,function(a,o,s){var l=o.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return a+l+u},"");return i.trim()}var z5,G5,Y5,K5,X5,q5;function jd(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function JM(e){return JM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JM(e)}function Vr(e){var t;switch(JM(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function Xe(e){return typeof e<"u"}function pr(e){return typeof e>"u"}function vn(e){return e===null||e===""||pr(e)}function Die(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var Jy="length",Tm=function(t){return parseInt(t,16)},Z5=function(t){return parseInt(t,10)},Ix=function(t,r,n){return t.substr(r,n)},Om=function(t){return t.codePointAt(0)-65},QM=function(t){return"".concat(t).replace(/\-/g,"")},vVe=function(t){return Tm(Ix(QM(t),Tm("12"),Om("F")))/(Tm(Ix(QM(t),Om("B"),~~![][Jy]))||9)},pVe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},J5=!1,Q5={invalid:function(){return sr(z5||(z5=jd([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return sr(G5||(G5=jd([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return sr(Y5||(Y5=jd([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},e6={invalid:function(){return sr(K5||(K5=jd([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return sr(X5||(X5=jd([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return sr(q5||(q5=jd([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function $ie(e,t){var r=!vn(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",a,o="invalid",s="invalid";e=QM(e||"");var l=gVe(e);if(r||n||l)if(l){var u=Ae("28/03/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=vVe(e);a=Ae((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(o="expired",s="expired"):(o="valid",s="valid")}else n?(o="non_commercial",s="valid"):(o="invalid",s="invalid");else o="missing",s="missing";if(pVe()&&(o="valid",s="valid"),!J5&&o!=="valid"){var h=Q5[o]({keyValidityDate:a,hotVersion:i});h&&console[o==="non_commercial"?"info":"warn"](Q5[o]({keyValidityDate:a,hotVersion:i})),J5=!0}if(s!=="valid"&&t.parentNode){var d=e6[s]({keyValidityDate:a,hotVersion:i});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=e6[s]({keyValidityDate:a,hotVersion:i}),t.parentNode.insertBefore(v,t.nextSibling)}}}function gVe(e){var t=[][Jy],r=t;if(e[Jy]!==Om("Z"))return!1;for(var n="",i="B<H4P+".split(""),a=Om(i.shift());a;a=Om(i.shift()||"A"))--a<""[Jy]?r=r|(Z5("".concat(Z5(Tm(n)+(Tm(Ix(e,Math.abs(a),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Ix(e,a,a?i[Jy]===1?9:8:6);return r===t}const yVe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:$ie,isDefined:Xe,isEmpty:vn,isRegExp:Die,isUndefined:pr,stringify:Vr},Symbol.toStringTag,{value:"Module"}));function $i(e){return e[0].toUpperCase()+e.substr(1)}function mVe(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=r.length;i;){i-=1;var a=Vr(r[i]).toLowerCase();e.indexOf(a)===-1&&e.push(a)}return e.length===1}function iH(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function aH(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function oH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function e2(e){return uE("".concat(e),{ALLOWED_TAGS:[]})}function uE(e,t){return KFe.sanitize(e,t)}const bVe=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:mVe,isPercentValue:aH,randomString:iH,sanitize:uE,stripTags:e2,substitute:oH,toUpperCaseFirst:$i},Symbol.toStringTag,{value:"Module"}));function t6(e){return CVe(e)||SVe(e)||_Ve(e)||wVe()}function wVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ve(e,t){if(e){if(typeof e=="string")return t2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t2(e,t)}}function SVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CVe(e){if(Array.isArray(e))return t2(e)}function t2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nie(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Lie(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function m0(e){return Lie(e)&&e.parent}function xVe(e){return!!Object.getPrototypeOf(e.parent)}function pu(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,a=n.DOCUMENT_FRAGMENT_NODE,o=e;o!=null&&o!==r;){var s=o,l=s.nodeType,u=s.nodeName;if(l===i&&(t.includes(u)||t.includes(o)))return o;var f=o,c=f.host;c&&l===a?o=c:o=o.parentNode}return null}function Qy(e,t,r){for(var n=[],i=e;i&&(i=pu(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var a=n.length;return a?n[a-1]:null}function gu(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function Fie(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function Yl(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var r2,n2,i2;function FS(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(wne()){var r6=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};r2=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},n2=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=FS(i),i.length>0)if(r6(n)){var a;(a=t.classList).add.apply(a,t6(i))}else for(var o=0;i[o];)t.classList.add(i[o]),o+=1},i2=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=FS(i),i.length>0)if(r6(n)){var a;(a=t.classList).remove.apply(a,t6(i))}else for(var o=0;i[o];)t.classList.remove(i[o]),o+=1}}else{var pA=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};r2=function(t,r){return t.className!==void 0&&pA(r).test(t.className)},n2=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=FS(i),n==="")n=i.join(" ");else for(var a=0;a<i.length;a++)i[a]&&!pA(i[a]).test(n)&&(n+=" ".concat(i[a]));t.className=n},i2=function(t,r){var n=0,i=t.className,a=r;for(typeof a=="string"&&(a=a.split(" ")),a=FS(a);a[n];)i=i.replace(pA(a[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function mt(e,t){return r2(e,t)}function ke(e,t){n2(e,t)}function wt(e,t){i2(e,t)}function sH(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)sH(t[r])}function po(e){for(var t;t=e.lastChild;)e.removeChild(t)}var Hie=/(<(.*)>|&(.*);)/;function fh(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Hie.test(t)?e.innerHTML=r?uE(t):t:Nu(e,t)}function Nu(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?_ne?r.textContent=t:r.data=t:(po(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function hv(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return hv(r.host.impl);if(r.host)return hv(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function tn(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,a,o,s,l;if(PF()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(a=i.offsetLeft,o=i.offsetTop,s=i;(i=i.offsetParent)&&i!==t.body;)a+=i.offsetLeft,o+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(a+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:a,top:o}}function dv(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Nc(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function b0(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?dv(t):e.scrollTop}function Mx(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Nc(t):e.scrollLeft}function w0(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=Sne(),a=e.parentNode;a&&a.style&&t.body!==a;){var o=a.style,s=o.overflow,l=o.overflowX,u=o.overflowY;if([s,l,u].includes("scroll"))return a;if(i){var f=r.getComputedStyle(a);if(s=f.overflow,l=f.overflowX,u=f.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return a}if(a.clientHeight<=a.scrollHeight+1&&(n.includes(u)||n.includes(s))||a.clientWidth<=a.scrollWidth+1&&(n.includes(l)||n.includes(s)))return a;a=a.parentNode}return r}function vv(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Lu(n,r),a=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(a.includes(o)||a.includes(s)||a.includes(l))return n;n=n.parentNode}return r}function pv(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=Lu(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function TVe(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Lu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function fr(e){return e.offsetWidth}function $r(e){return PF()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function Ps(e){return e.clientHeight||e.innerHeight}function Em(e){return e.clientWidth||e.innerWidth}function OVe(e,t,r){e.addEventListener(t,r,!1)}function EVe(e,t,r){e.removeEventListener(t,r,!1)}function lH(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function Bie(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function Vie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function a2(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function s_(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var gA;function RVe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function Sn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return gA===void 0&&(gA=RVe(e)),gA}function jie(e){return e.offsetWidth!==e.clientWidth}function Wie(e){return e.offsetHeight!==e.clientHeight}function fE(e,t,r){Fne()?(e.style.top=r,e.style.left=t):$ne()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function kVe(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function l_(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function _0(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function cE(e){return _0(e)&&e.hasAttribute("data-hot-input")===!1}function Uie(e){var t=e.ownerDocument.activeElement;cE(t)||e.select()}function uH(e){return!e.parentNode}function zie(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(a){a.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const AVe=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Hie,addClass:ke,addEvent:OVe,clearTextSelection:a2,closest:pu,closestDown:Qy,empty:po,fastInnerHTML:fh,fastInnerText:Nu,getCaretPosition:lH,getComputedStyle:Lu,getCssTransform:kVe,getFrameElement:Lie,getParent:Nie,getParentWindow:m0,getScrollLeft:Mx,getScrollTop:b0,getScrollableElement:w0,getScrollbarWidth:Sn,getSelectionEndPosition:Bie,getSelectionText:Vie,getStyle:pv,getTrimmingContainer:vv,getWindowScrollLeft:Nc,getWindowScrollTop:dv,hasAccessToParentWindow:xVe,hasClass:mt,hasHorizontalScrollbar:Wie,hasVerticalScrollbar:jie,index:Fie,innerHeight:Ps,innerWidth:Em,isChildOf:gu,isDetached:uH,isInput:_0,isOutsideInput:cE,isVisible:hv,matchesCSSRules:TVe,observeVisibilityChangeOnce:zie,offset:tn,outerHeight:$r,outerWidth:fr,overlayContainsElement:Yl,removeClass:wt,removeEvent:EVe,removeTextNodes:sH,resetCssTransform:l_,selectElementIfAllowed:Uie,setCaretPosition:s_,setOverlayPosition:fE},Symbol.toStringTag,{value:"Module"}));function wr(e){return typeof e=="function"}function Gie(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},i=null;function a(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,l)):(i&&clearTimeout(i),i=setTimeout(function(){n.lastCallThrottled=!1,e.apply(o,l),r=0,i=void 0},h)),n}return a}function PVe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=Gie(e,t),i=r;function a(){i=r}function o(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return i?(i-=1,e.apply(this,l)):n.apply(this,l)}return o.clearHits=a,o}function fH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var a=this,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(a,s)},t),n}return i}function IVe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t.slice(1);return function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return Xr(i,function(u,f){return f(u)},n.apply(this,s))}}function cH(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return e.apply(this,r.concat(o))}}function Yie(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function MVe(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o.reverse()),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function Dx(e,t,r,n,i,a,o,s){return Xe(s)?e.call(t,r,n,i,a,o,s):Xe(o)?e.call(t,r,n,i,a,o):Xe(a)?e.call(t,r,n,i,a):Xe(i)?e.call(t,r,n,i):Xe(n)?e.call(t,r,n):Xe(r)?e.call(t,r):e.call(t)}const DVe=Object.freeze(Object.defineProperty({__proto__:null,curry:Yie,curryRight:MVe,debounce:fH,fastCall:Dx,isFunction:wr,partial:cH,pipe:IVe,throttle:Gie,throttleAfterHits:PVe},Symbol.toStringTag,{value:"Module"}));function gr(){if(Xe(console)){var e;(e=console).warn.apply(e,arguments)}}function hH(){if(Xe(console)){var e;(e=console).error.apply(e,arguments)}}var $Ve=Pt,n6=cF,HS=Mc.getWeakData,NVe=uF,LVe=Kr,FVe=bo,yA=on,HVe=lF,Kie=sh,i6=jr,Xie=Sl,BVe=Xie.set,VVe=Xie.getterFor,jVe=Kie.find,WVe=Kie.findIndex,UVe=$Ve([].splice),zVe=0,BS=function(e){return e.frozen||(e.frozen=new qie)},qie=function(){this.entries=[]},mA=function(e,t){return jVe(e.entries,function(r){return r[0]===t})};qie.prototype={get:function(e){var t=mA(this,e);if(t)return t[1]},has:function(e){return!!mA(this,e)},set:function(e,t){var r=mA(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=WVe(this.entries,function(r){return r[0]===e});return~t&&UVe(this.entries,t,1),!!~t}};var Zie={getConstructor:function(e,t,r,n){var i=e(function(l,u){NVe(l,a),BVe(l,{type:t,id:zVe++,frozen:void 0}),FVe(u)||HVe(u,l[n],{that:l,AS_ENTRIES:r})}),a=i.prototype,o=VVe(t),s=function(l,u,f){var c=o(l),h=HS(LVe(u),!0);return h===!0?BS(c).set(u,f):h[c.id]=f,l};return n6(a,{delete:function(l){var u=o(this);if(!yA(l))return!1;var f=HS(l);return f===!0?BS(u).delete(l):f&&i6(f,u.id)&&delete f[u.id]},has:function(u){var f=o(this);if(!yA(u))return!1;var c=HS(u);return c===!0?BS(f).has(u):c&&i6(c,f.id)}}),n6(a,r?{get:function(u){var f=o(this);if(yA(u)){var c=HS(u);return c===!0?BS(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return s(this,u,f)}}:{add:function(u){return s(this,u,!0)}}),i}},GVe=QL,a6=Sr,uC=Pt,o6=cF,YVe=Mc,KVe=VO,Jie=Zie,VS=on,jS=Sl.enforce,XVe=Ct,qVe=Ete,u_=Object,ZVe=Array.isArray,WS=u_.isExtensible,Qie=u_.isFrozen,JVe=u_.isSealed,eae=u_.freeze,QVe=u_.seal,s6={},l6={},eje=!a6.ActiveXObject&&"ActiveXObject"in a6,_y,tae=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},rae=KVe("WeakMap",tae,Jie),gd=rae.prototype,fC=uC(gd.set),tje=function(){return GVe&&XVe(function(){var e=eae([]);return fC(new rae,e,1),!Qie(e)})};if(qVe)if(eje){_y=Jie.getConstructor(tae,"WeakMap",!0),YVe.enable();var u6=uC(gd.delete),US=uC(gd.has),f6=uC(gd.get);o6(gd,{delete:function(e){if(VS(e)&&!WS(e)){var t=jS(this);return t.frozen||(t.frozen=new _y),u6(this,e)||t.frozen.delete(e)}return u6(this,e)},has:function(t){if(VS(t)&&!WS(t)){var r=jS(this);return r.frozen||(r.frozen=new _y),US(this,t)||r.frozen.has(t)}return US(this,t)},get:function(t){if(VS(t)&&!WS(t)){var r=jS(this);return r.frozen||(r.frozen=new _y),US(this,t)?f6(this,t):r.frozen.get(t)}return f6(this,t)},set:function(t,r){if(VS(t)&&!WS(t)){var n=jS(this);n.frozen||(n.frozen=new _y),US(this,t)?fC(this,t,r):n.frozen.set(t,r)}else fC(this,t,r);return this}})}else tje()&&o6(gd,{set:function(t,r){var n;return ZVe(t)&&(Qie(t)?n=s6:JVe(t)&&(n=l6)),fC(this,t,r),n==s6&&eae(t),n==l6&&QVe(t),this}});var Qe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:nC()?182:174,AUDIO_MUTE:nC()?181:173,AUDIO_UP:nC()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},rje=[Qe.ALT,Qe.ARROW_DOWN,Qe.ARROW_LEFT,Qe.ARROW_RIGHT,Qe.ARROW_UP,Qe.AUDIO_DOWN,Qe.AUDIO_MUTE,Qe.AUDIO_UP,Qe.BACKSPACE,Qe.CAPS_LOCK,Qe.DELETE,Qe.END,Qe.ENTER,Qe.ESCAPE,Qe.F1,Qe.F2,Qe.F3,Qe.F4,Qe.F5,Qe.F6,Qe.F7,Qe.F8,Qe.F9,Qe.F10,Qe.F11,Qe.F12,Qe.F13,Qe.F14,Qe.F15,Qe.F16,Qe.F17,Qe.F18,Qe.F19,Qe.HOME,Qe.INSERT,Qe.MEDIA_NEXT,Qe.MEDIA_PLAY_PAUSE,Qe.MEDIA_PREV,Qe.MEDIA_STOP,Qe.NULL,Qe.NUM_LOCK,Qe.PAGE_DOWN,Qe.PAGE_UP,Qe.PAUSE,Qe.SCROLL_LOCK,Qe.SHIFT,Qe.TAB];function nae(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function dH(e){return rje.includes(e)}function nje(e){var t=[];return xx()?t.push(Qe.COMMAND_LEFT,Qe.COMMAND_RIGHT,Qe.COMMAND_FIREFOX):t.push(Qe.CONTROL),t.includes(e)}function iae(e){return[Qe.CONTROL,Qe.COMMAND_LEFT,Qe.COMMAND_RIGHT,Qe.COMMAND_FIREFOX].includes(e)}function gv(e,t){var r=t.split("|"),n=!1;return ne(r,function(i){if(e===Qe[i])return n=!0,!1}),n}const ije=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Qe,isCtrlKey:nje,isCtrlMetaKey:iae,isFunctionKey:dH,isKey:gv,isPrintableChar:nae},Symbol.toStringTag,{value:"Module"}));function go(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Hf(e){return e.isImmediatePropagationEnabled===!1}function Fu(e){return e.button===2}function hE(e){return e.button===0}const aje=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Hf,isLeftClick:hE,isRightClick:Fu,stopImmediatePropagation:go},Symbol.toStringTag,{value:"Module"}));function S0(e){return S0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S0(e)}var c6;function oje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lje(n.key),n)}}function sje(e,t,r){return t&&h6(e.prototype,t),r&&h6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lje(e){var t=uje(e,"string");return S0(t)==="symbol"?t:String(t)}function uje(e,t){if(S0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fje(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Vh=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],cje=sr(c6||(c6=fje([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),bA=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),wA=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),aae=function(){function e(){oje(this,e),this.globalBucket=this.createEmptyBucket()}return sje(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return ne(Vh,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))ne(n,function(l){return i.add(r,l,a)});else{bA.has(r)&&gr(oH(cje,{hookName:r,removedInVersion:bA.get(r)})),wA.has(r)&&gr(wA.get(r));var o=this.getBucket(a);if(typeof o[r]>"u"&&(this.register(r),o[r]=[]),n.skip=!1,o[r].indexOf(n)===-1){var s=!1;n.initialHook&&ne(o[r],function(l,u){if(l.initialHook)return o[r][u]=n,s=!0,!1}),s||o[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?ne(n,function(o){return i.once(r,o,a)}):(n.runOnce=!0,this.add(r,n,a))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=this.getBucket(i);return typeof a[r]<"u"&&a[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,a,o,s,l,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=Dx(f[h],r,i,a,o,s,l,u);d!==void 0&&(i=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],p=v?v.length:0,g=0;if(p)for(;g<p;){if(!v[g]||v[g].skip){g+=1;continue}var y=Dx(v[g],r,i,a,o,s,l,u);y!==void 0&&(i=y),v[g]&&v[g].runOnce&&this.remove(n,v[g],r),g+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;At(this.getBucket(r),function(n,i,a){return a[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||Vh.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&Vh.splice(Vh.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return wA.has(r)||bA.has(r)}},{key:"isRegistered",value:function(r){return Vh.indexOf(r)>=0}},{key:"getRegistered",value:function(){return Vh}}],[{key:"getSingleton",value:function(){return dje()}}]),e}(),hje=new aae;function dje(){return hje}const Je=aae;function d6(e){return yje(e)||gje(e)||pje(e)||vje()}function vje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pje(e,t){if(e){if(typeof e=="string")return o2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o2(e,t)}}function gje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yje(e){if(Array.isArray(e))return o2(e)}function o2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _A=new Map;function Ha(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";_A.has(e)||_A.set(e,new Map);var t=_A.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function i(s){return t.has(s)}function a(){return d6(t.keys())}function o(){return d6(t.values())}return{register:r,getItem:n,hasItem:i,getNames:a,getValues:o}}var s2=new WeakMap,f_=Ha("editors"),mje=f_.register,oae=f_.getItem,sae=f_.hasItem,bje=f_.getNames;f_.getValues;function wje(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},Je.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function lae(e,t){var r;if(typeof e=="function")s2.get(e)||Ri(null,e),r=s2.get(e);else if(typeof e=="string")r=oae(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function $x(e){if(typeof e=="function")return e;if(!sae(e))throw Error('No registered editor found under "'.concat(e,'" name'));return oae(e).getConstructor()}function Ri(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new wje(t);typeof e=="string"&&mje(e,r),s2.set(t,r)}function C0(e){return C0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C0(e)}function _je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cje(n.key),n)}}function Sje(e,t,r){return t&&v6(e.prototype,t),r&&v6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cje(e){var t=xje(e,"string");return C0(t)==="symbol"?t:String(t)}function xje(e,t){if(C0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(C0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cC=0,Tje=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_je(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return Sje(e,[{key:"addEventListener",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,Oje(l))}return typeof o!="boolean"&&!xne()&&(o=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:o,eventManager:this}),r.addEventListener(n,s,o),cC+=1,function(){a.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===r){if(i&&i!==s.callback||a&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),cC-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),cC-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,a=r;i||(i=r.ownerDocument?r.ownerDocument:r,a=i.defaultView);var o={bubbles:!0,cancelable:n!=="mousemove",view:a,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),e}();function Oje(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),go(this)},e}const Nr=Tje;function Eje(){return cC}function x0(e){return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x0(e)}function Rje(e,t){return Ije(e)||Pje(e,t)||Aje(e,t)||kje()}function kje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aje(e,t){if(e){if(typeof e=="string")return p6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p6(e,t)}}function p6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Ije(e){if(Array.isArray(e))return e}function Mje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$je(n.key),n)}}function Dje(e,t,r){return t&&g6(e.prototype,t),r&&g6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $je(e){var t=Nje(e,"string");return x0(t)==="symbol"?t:String(t)}function Nje(e,t){if(x0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(x0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dE="editorManager.navigation",Rm="editorManager.handlingEditor",l2=function(){function e(t,r,n){var i=this;Mje(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Nr(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var a=this.instance.getShortcutManager();a.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(o){!i.destroyed&&i.instance.isListening()&&i.openEditor("",o)}),this.instance.view._wt.update("onCellDblClick",function(o,s,l){return i.onCellDblClick(o,s,l)})}return Dje(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),a=n.getContext("editor"),o={group:Rm};a.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],o),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),go(l)}}],o)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(p){p&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance.runHooks("modifyGetCellCoords",i,a),s=i,l=a;if(Array.isArray(o)){var u=Rje(o,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var f=this.instance.rootDocument.activeElement;if(f&&cE(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(i,a,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=lae(h,this.instance),this.activeEditor.prepare(i,a,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var a=this.instance.getSelectedRangeLast().highlight,o=a.row,s=a.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance,s=o.rowIndexMapper,l=o.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(a));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var a=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!dH(i)&&!iae(i)&&!a&&!this.isEditorOpened()){var o=this.instance.getShortcutManager(),s=o.getContext("editor"),l={runOnlyIf:function(){return Xe(n.instance.getSelected())},group:dE};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),y6=new WeakMap;l2.getInstance=function(e,t,r){var n=y6.get(e);return n||(n=new l2(e,t,r),y6.set(e,n)),n};const Lje=l2;var Fje=vt,Hje=Hi,uae=zw,Bje=Ct,Vje=Bje(function(){uae(1)});Fje({target:"Object",stat:!0,forced:Vje},{keys:function(t){return uae(Hje(t))}});var jje=gn,Wje=GO,Uje=Kr,zje=bo,Gje=oh,SA=sn,Yje=Fi,Kje=nh,Xje=_F,m6=YO;Wje("match",function(e,t,r){return[function(i){var a=Yje(this),o=zje(i)?void 0:Kje(i,e);return o?jje(o,i,a):new RegExp(i)[e](SA(a))},function(n){var i=Uje(this),a=SA(n),o=r(t,i,a);if(o.done)return o.value;if(!i.global)return m6(i,a);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,f;(f=m6(i,a))!==null;){var c=SA(f[0]);l[u]=c,c===""&&(i.lastIndex=Xje(a,Gje(i.lastIndex),s)),u++}return u===0?null:l}]});var qje=lh,Zje=aa,Jje=Uu,Qje=Na,eWe=Ag,tWe=Math.min,u2=[].lastIndexOf,fae=!!u2&&1/[1].lastIndexOf(1,-0)<0,rWe=eWe("lastIndexOf"),nWe=fae||!rWe,iWe=nWe?function(t){if(fae)return qje(u2,this,arguments)||0;var r=Zje(this),n=Qje(r),i=n-1;for(arguments.length>1&&(i=tWe(i,Jje(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:u2,aWe=vt,b6=iWe;aWe({target:"Array",proto:!0,forced:b6!==[].lastIndexOf},{lastIndexOf:b6});var oWe=rh,sWe=Hi,lWe=Lw,uWe=Na,fWe=TypeError,w6=function(e){return function(t,r,n,i){oWe(r);var a=sWe(t),o=lWe(a),s=uWe(a),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in o){i=o[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw fWe("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in o&&(i=r(i,o[l],l,a));return i}},cWe={left:w6(!1),right:w6(!0)},hWe=vt,dWe=cWe.left,vWe=Ag,_6=Fw,pWe=une,gWe=!pWe&&_6>79&&_6<83,yWe=gWe||!vWe("reduce");hWe({target:"Array",proto:!0,forced:yWe},{reduce:function(t){var r=arguments.length;return dWe(this,t,r,r>1?arguments[1]:void 0)}});var mWe=vt,bWe=sh.findIndex,wWe=Jw,f2="findIndex",cae=!0;f2 in[]&&Array(1)[f2](function(){cae=!1});mWe({target:"Array",proto:!0,forced:cae},{findIndex:function(t){return bWe(this,t,arguments.length>1?arguments[1]:void 0)}});wWe(f2);function CA(e){return xWe(e)||CWe(e)||SWe(e)||_We()}function _We(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SWe(e,t){if(e){if(typeof e=="string")return c2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c2(e,t)}}function CWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xWe(e){if(Array.isArray(e))return c2(e)}function c2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hae={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},TWe=new RegExp(Object.keys(hae).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function OWe(e){return(e&&e.nodeName||"")==="TABLE"}function h2(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),a=i.length,o=a>0?i[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<a;h+=1){for(var d=t&&h===0,v=[],p=0;p<o;p+=1){var g=!d&&r&&p===0,y="";if(d)y="<th>".concat(e.getColHeader(p-f),"</th>");else if(g)y="<th>".concat(e.getRowHeader(h-c),"</th>");else{var m=i[h][p],b=e.getCellMeta(h-c,p-f),_=b.hidden,x=b.rowspan,T=b.colspan;if(!_){var E=[];if(x&&E.push('rowspan="'.concat(x,'"')),T&&E.push('colspan="'.concat(T,'"')),vn(m))y="<td ".concat(E.join(" "),"></td>");else{var P=m.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y="<td ".concat(E.join(" "),">").concat(P,"</td>")}}}v.push(y)}var R=["<tr>"].concat(v,["</tr>"]).join("");d?l.splice(1,0,R):u.splice(-1,0,R)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function d2(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var i=e[n],a=i.length,o=[];n===0&&r.push("<tbody>");for(var s=0;s<a;s+=1){var l=i[s],u=vn(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");o.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(o,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function dae(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);var a=e;if(typeof a=="string"){var o=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(S){var A=S.match(/<td\b[^>]*?>/g)[0],I=S.substring(A.length,S.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),L="</td>";return"".concat(A).concat(I).concat(L)});i.insertAdjacentHTML("afterbegin","".concat(o)),a=i.querySelector("table")}if(!(!a||!OWe(a))){var s=i.querySelector('meta[name$="enerator"]'),l=a.querySelector("tbody th")!==null,u=a.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(S,A){return S+A.colSpan},0)-(l?1:0):0,c=a.tFoot&&Array.from(a.tFoot.rows)||[],h=[],d=!1,v=0,p=0;if(a.tHead){var g=Array.from(a.tHead.rows).filter(function(S){var A=S.querySelector("td")!==null;return A&&h.push(S),!A});v=g.length,d=v>0,v>1?r.nestedHeaders=Array.from(g).reduce(function(S,A){var I=Array.from(A.cells).reduce(function(L,V,Y){if(l&&Y===0)return L;var ae=V.colSpan,re=V.innerHTML,te=ae>1?{label:re,colspan:ae}:re;return L.push(te),L},[]);return S.push(I),S},[]):d&&(r.colHeaders=Array.from(g[0].children).reduce(function(S,A,I){return l&&I===0||S.push(A.innerHTML),S},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var y=[].concat(h,CA(Array.from(a.tBodies).reduce(function(S,A){return S.push.apply(S,CA(Array.from(A.rows))),S},[])),CA(c));p=y.length;for(var m=new Array(p),b=0;b<p;b++)m[b]=new Array(f);for(var _=[],x=[],T=0;T<p;T++)for(var E=y[T],P=Array.from(E.cells),R=P.length,M=0;M<R;M++){var D=P[M],N=D.nodeName,B=D.innerHTML,K=D.rowSpan,Z=D.colSpan,ie=m[T].findIndex(function(S){return S===void 0});if(N==="TD"){if(K>1||Z>1){for(var me=T;me<T+K;me++)if(me<p)for(var k=ie;k<ie+Z;k++)m[me][k]=null;var w=D.getAttribute("style"),C=w&&w.includes("mso-ignore:colspan");C||_.push({col:ie,row:T,rowspan:K,colspan:Z})}var O="";s&&/excel/gi.test(s.content)?O=B.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):O=B.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),m[T][ie]=O.replace(TWe,function(S){return hae[S]})}else x.push(B)}return _.length&&(r.mergeCells=_),x.length&&(r.rowHeaders=x),m.length&&(r.data=m),r}}const EWe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:d2,htmlToGridSettings:dae,instanceToHTML:h2},Symbol.toStringTag,{value:"Module"}));function RWe(e){return IWe(e)||PWe(e)||AWe(e)||kWe()}function kWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AWe(e,t){if(e){if(typeof e=="string")return v2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v2(e,t)}}function PWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IWe(e){if(Array.isArray(e))return v2(e)}function v2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p2(e){return p2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p2(e)}function Ki(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=p2(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(RWe(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function vae(e){return Ki(e,[","])}function rt(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function Nx(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function vH(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const MWe=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:Ki,isNumericLike:vae,rangeEach:rt,rangeEachReverse:Nx,valueAccordingPercent:vH},Symbol.toStringTag,{value:"Module"}));function DWe(e){return LWe(e)||NWe(e)||pae(e)||$We()}function $We(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function LWe(e){if(Array.isArray(e))return g2(e)}function FWe(e,t){return VWe(e)||BWe(e,t)||pae(e,t)||HWe()}function HWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pae(e,t){if(e){if(typeof e=="string")return g2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g2(e,t)}}function g2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function VWe(e){if(Array.isArray(e))return e}var y2="asc",jWe="desc",S6=new Map([[y2,[-1,1]],[jWe,[1,-1]]]),WWe=function(t){return"The priority '".concat(t,"' is already declared in a map.")},UWe=function(t){return"The priority '".concat(t,"' is not a number.")};function zWe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=wr(t)?t:WWe,r=wr(r)?r:UWe;function i(o,s){if(!Ki(o))throw new Error(r(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function a(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y2,s=S6.get(o)||S6.get(y2),l=FWe(s,2),u=l[0],f=l[1];return DWe(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:i,getItems:a}}var GWe=vt,YWe=sh.find,KWe=Jw,m2="find",gae=!0;m2 in[]&&Array(1)[m2](function(){gae=!1});GWe({target:"Array",proto:!0,forced:gae},{find:function(t){return YWe(this,t,arguments.length>1?arguments[1]:void 0)}});KWe(m2);function XWe(e){return JWe(e)||ZWe(e)||yae(e)||qWe()}function qWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JWe(e){if(Array.isArray(e))return b2(e)}function C6(e,t){return tUe(e)||eUe(e,t)||yae(e,t)||QWe()}function QWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yae(e,t){if(e){if(typeof e=="string")return b2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b2(e,t)}}function b2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function tUe(e){if(Array.isArray(e))return e}var rUe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function vE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=wr(t)?t:rUe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function i(f){return r.delete(f)}function a(){r.clear()}function o(f){var c=l().find(function(v){var p=C6(v,2),g=p[0],y=p[1];return f===y?g:!1})||[null],h=C6(c,1),d=h[0];return d}function s(f){return r.get(f)}function l(){return XWe(r)}function u(f){return r.has(f)}return{addItem:n,clear:a,getId:o,getItem:s,getItems:l,hasItem:u,removeItem:i}}function nUe(e){return sUe(e)||oUe(e)||aUe(e)||iUe()}function iUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aUe(e,t){if(e){if(typeof e=="string")return w2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w2(e,t)}}function oUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sUe(e){if(Array.isArray(e))return w2(e)}function w2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lUe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function uUe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=wr(t)?t:lUe;function n(o){if(r.has(o))throw new Error(t(o));r.add(o)}function i(){return nUe(r)}function a(){r.clear()}return{addItem:n,clear:a,getItems:i}}function fUe(e,t){return dUe(e)||hUe(e,t)||mae(e,t)||cUe()}function cUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function dUe(e){if(Array.isArray(e))return e}function x6(e){return gUe(e)||pUe(e)||mae(e)||vUe()}function vUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mae(e,t){if(e){if(typeof e=="string")return _2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _2(e,t)}}function pUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gUe(e){if(Array.isArray(e))return _2(e)}function _2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var pH=function(t){return'There is already registered "'.concat(t,'" plugin.')},yUe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},mUe=function(t){return'The priority "'.concat(t,'" is not a number.')},bae=zWe({errorPriorityExists:yUe,errorPriorityNaN:mUe}),wae=uUe({errorItemExists:pH}),S2=vE({errorIdExists:pH});function gH(){return[].concat(x6(bae.getItems()),x6(wae.getItems()))}function c_(e){var t=$i(e);return S2.getItem(t)}function bUe(e){return!!c_(e)}function Gt(e,t,r){var n=_Ue(e,t,r),i=fUe(n,3);e=i[0],t=i[1],r=i[2],c_(e)===void 0&&wUe(e,t,r)}function wUe(e,t,r){var n=$i(e);if(S2.hasItem(n))throw new Error(pH(n));r===void 0?wae.addItem(n):bae.addItem(r,n),S2.addItem(n,t)}function _Ue(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var h_=Ha("renderers"),SUe=h_.register,CUe=h_.getItem,_ae=h_.hasItem,xUe=h_.getNames;h_.getValues;function Lx(e){if(typeof e=="function")return e;if(!_ae(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return CUe(e)}function Lo(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),SUe(e,t)}var d_=Ha("validators"),TUe=d_.register,OUe=d_.getItem,Sae=d_.hasItem,EUe=d_.getNames;d_.getValues;function yH(e){if(typeof e=="function")return e;if(!Sae(e))throw Error('No registered validator found under "'.concat(e,'" name'));return OUe(e)}function Rd(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),TUe(e,t)}var Bf=1,jn=2;function T0(e){return T0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T0(e)}function RUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AUe(n.key),n)}}function kUe(e,t,r){return t&&T6(e.prototype,t),r&&T6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AUe(e){var t=PUe(e,"string");return T0(t)==="symbol"?t:String(t)}function PUe(e,t){if(T0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jh=new WeakMap,IUe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;RUe(this,e),jh.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:a,overrideFn:o,calculationType:s,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return kUe(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],a,o=0,s=0,l=jh.get(this),u=l.calculationType,f=l.overrideFn,c=l.scrollOffset,h=Math.max(l.scrollOffset,0),d=l.totalColumns,v=l.viewportWidth,p=h>0?v+1:v,g=0;g<d;g++)if(a=this._getColumnWidth(g),r<=h&&u!==jn&&(this.startColumn=g,o=a),r>=h&&r+(u===jn?a:0)<=h+p&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=g,o=a),this.endColumn=g),i.push(r),r+=a,s=a,u!==jn&&(this.endColumn=g),r>=h+v){n=!1;break}var y=c+v-p,m=u===jn?0:s,b=u===jn?o:0;if(y<-1*l.inlineStartOffset||c>i.at(-1)+m||-1*l.scrollOffset-l.viewportWidth>-1*b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var _=i[this.endColumn]+a-i[this.startColumn-1];if((_<=v||u!==jn)&&(this.startColumn-=1),_>v)break}u===Bf&&this.startColumn!==null&&f&&f(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=jh.get(this),a=i.totalColumns,o=0,s=0;s<a;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:o+=l}var f=n-o;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(a-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,a=jh.get(this),o=a.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=a.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=jh.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=jh.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const mH=IUe;function O0(e){return O0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O0(e)}function MUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ue(n.key),n)}}function DUe(e,t,r){return t&&O6(e.prototype,t),r&&O6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ue(e){var t=NUe(e,"string");return O0(t)==="symbol"?t:String(t)}function NUe(e,t){if(O0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E6=new WeakMap,LUe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;MUe(this,e),E6.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:a,overrideFn:o,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return DUe(e,[{key:"calculate",value:function(){for(var r=E6.get(this),n=r.calculationType,i=r.overrideFn,a=r.rowHeightFn,o=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,p=0,g=0,y=0;y<l;y++)if(v=a(y),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=s&&n!==jn&&(this.startRow=y,p=v),c>=s&&c+(n===jn?v:0)<=s+u-f&&(this.startRow===null&&(this.startRow=y,p=v),this.endRow=y),d.push(c),c+=v,g=v,n!==jn&&(this.endRow=y),c>=s+u-f){h=!1;break}var m=o+u-f,b=n===jn?p:0,_=n===jn?0:g;if(m<b||o>d.at(-1)+_?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var x=d[this.endRow]+v-d[this.startRow-1];if((x<=u-f||n!==jn)&&(this.startRow-=1),x>=u-f)break}n===Bf&&this.startRow!==null&&i&&i(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const Cae=LUe;function E0(e){return E0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E0(e)}function FUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xae(n.key),n)}}function HUe(e,t,r){return t&&R6(e.prototype,t),r&&R6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BUe(e,t,r){VUe(e,t),t.set(e,r)}function VUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k6(e,t,r){return t=xae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xae(e){var t=jUe(e,"string");return E0(t)==="symbol"?t:String(t)}function jUe(e,t){if(E0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sy(e,t){var r=Tae(e,t,"get");return WUe(e,r)}function WUe(e,t){return t.get?t.get.call(e):t.value}function UUe(e,t,r){var n=Tae(e,t,"set");return zUe(e,n,r),r}function Tae(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function zUe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var xf=new WeakMap,GUe=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;FUe(this,e),k6(this,"row",null),k6(this,"col",null),BUe(this,xf,{writable:!0,value:!1}),UUe(this,xf,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return HUe(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Sy(this,xf)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Sy(this,xf)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Sy(this,xf)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Sy(this,xf)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Sy(this,xf))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const Fx=GUe;function R0(e){return R0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R0(e)}function YUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oae(n.key),n)}}function KUe(e,t,r){return t&&A6(e.prototype,t),r&&A6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XUe(e,t,r){qUe(e,t),t.set(e,r)}function qUe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xA(e,t,r){return t=Oae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oae(e){var t=ZUe(e,"string");return R0(t)==="symbol"?t:String(t)}function ZUe(e,t){if(R0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(R0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oo(e,t){var r=Eae(e,t,"get");return JUe(e,r)}function JUe(e,t){return t.get?t.get.call(e):t.value}function QUe(e,t,r){var n=Eae(e,t,"set");return e8e(e,n,r),r}function Eae(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function e8e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ua=new WeakMap,t8e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;YUe(this,e),xA(this,"highlight",null),xA(this,"from",null),xA(this,"to",null),XUe(this,ua,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),QUe(this,ua,i)}return KUe(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,a=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return a.row<=n&&o.row>=n&&a.col<=i&&o.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=this.getDirection(),o=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),f=Math.max(i.row,s.row),c=Math.max(i.col,s.col),h=this._createCellCoords(l,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(a),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var a=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=a[0],this.to=a[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Oo(this,ua)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Oo(this,ua)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Oo(this,ua)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Oo(this,ua)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Oo(this,ua)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Oo(this,ua)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Oo(this,ua)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Oo(this,ua)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof Fx))return!1;if(n){var i=n.from,a=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,a.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(a.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(a.row,a.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},a=[];return n.top===i.top&&a.push("top"),n.right===i.right&&a.push("right"),n.bottom===i.bottom&&a.push("bottom"),n.left===i.left&&a.push("left"),a}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)!(this.from.row===a&&this.from.col===o)&&!(this.to.row===a&&this.to.col===o)&&i.push(this._createCellCoords(a,o));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)r.row===a&&r.col===o?i.push(r):n.row===a&&n.col===o?i.push(n):i.push(this._createCellCoords(a,o));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=n.row;a<=i.row;a++)for(var o=n.col;o<=i.col;o++){var s=r(a,o);if(s===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Oo(this,ua))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new Fx(r,n,Oo(this,ua))}}]),e}();const bH=t8e;var r8e=vt,n8e=nF;r8e({target:"Object",stat:!0},{setPrototypeOf:n8e});var Rae=Pt,i8e=rh,a8e=on,o8e=jr,P6=qw,s8e=Dw,kae=Function,l8e=Rae([].concat),u8e=Rae([].join),TA={},f8e=function(e,t,r){if(!o8e(TA,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";TA[t]=kae("C,a","return new C("+u8e(n,",")+")")}return TA[t](e,r)},c8e=s8e?kae.bind:function(t){var r=i8e(this),n=r.prototype,i=P6(arguments,1),a=function(){var s=l8e(i,P6(arguments));return this instanceof a?f8e(r,s.length,s):r.apply(t,s)};return a8e(n)&&(a.prototype=n),a},h8e=vt,d8e=_l,OA=lh,v8e=c8e,I6=Tne,p8e=Kr,M6=on,g8e=Eg,Aae=Ct,wH=d8e("Reflect","construct"),y8e=Object.prototype,m8e=[].push,Pae=Aae(function(){function e(){}return!(wH(function(){},[],e)instanceof e)}),Iae=!Aae(function(){wH(function(){})}),D6=Pae||Iae;h8e({target:"Reflect",stat:!0,forced:D6,sham:D6},{construct:function(t,r){I6(t),p8e(r);var n=arguments.length<3?t:I6(arguments[2]);if(Iae&&!Pae)return wH(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return OA(m8e,i,r),new(OA(v8e,t,i))}var a=n.prototype,o=g8e(M6(a)?a:y8e),s=OA(t,o,r);return M6(s)?s:o}});function k0(e){return k0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k0(e)}function b8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_8e(n.key),n)}}function w8e(e,t,r){return t&&$6(e.prototype,t),r&&$6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _8e(e){var t=S8e(e,"string");return k0(t)==="symbol"?t:String(t)}function S8e(e,t){if(k0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(k0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wh=new WeakMap,C8e=function(){function e(t,r,n,i,a,o){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;b8e(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=a,this.selections=o,this.parent=s,this.eventManager=i,this.facadeGetter=t,Wh.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return w8e(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(a){return r.onContextMenu(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(a){return r.onMouseOver(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(a){return r.onMouseOut(a)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(o){return r.onTouchStart(o)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(o){return r.onTouchEnd(o)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(o){return r.onMouseUp(o)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(o){return r.onMouseDown(o)})};oo()?n():(AF()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=Wh.get(this),i=this.parentCell(r),a=i.coords;if(n.selectedCellBeforeTouchEnd&&a){var o=[a.row,n.selectedCellBeforeTouchEnd.from.row],s=o[0],l=o[1],u=[a.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return s===l&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,a=Qy(r,["TD","TH"],i);return a?(n.coords=this.wtTable.getCoords(a),n.TD=a):mt(r,"wtBorder")&&mt(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):mt(r,"wtBorder")&&mt(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Wh.get(this),i=this.domBindings.rootDocument.activeElement,a=cH(Nie,r.target),o=r.target;if(!(o===i||a(0)===i||a(1)===i)){var s=this.parentCell(o);mt(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,o):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=Qy(r.target,["TD","TH"],n),a=this.parent||this;i&&i!==a.lastMouseOver&&gu(i,n)&&(a.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=Qy(r.target,["TD","TH"],n),a=Qy(r.relatedTarget,["TD","TH"],n);i&&i!==a&&gu(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=Wh.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(mt(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Wh.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,a=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=Xe(a)&&a.row>=0&&a.col>=0,s=r.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];NF()&&(Mne()||Dne())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,a){var o=this.wtSettings.getSettingPure(r);o&&o(n,i,a,this.facadeGetter())}},{key:"destroy",value:function(){var r=Wh.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const Mae=C8e;function A0(e){return A0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A0(e)}function x8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O8e(n.key),n)}}function T8e(e,t,r){return t&&N6(e.prototype,t),r&&N6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O8e(e){var t=E8e(e,"string");return A0(t)==="symbol"?t:String(t)}function E8e(e,t){if(A0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(A0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R8e=function(){function e(t,r,n){x8e(this,e),this.offset=t,this.total=r,this.countTH=n}return T8e(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const k8e=R8e;function P0(e){return P0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P0(e)}function A8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I8e(n.key),n)}}function P8e(e,t,r){return t&&L6(e.prototype,t),r&&L6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I8e(e){var t=M8e(e,"string");return P0(t)==="symbol"?t:String(t)}function M8e(e,t){if(P0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D8e=function(){function e(t,r,n){A8e(this,e),this.offset=t,this.total=r,this.countTH=n}return P8e(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const $8e=D8e;var N8e=0,Hx=1,Bx=2;function I0(e){return I0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I0(e)}function L8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H8e(n.key),n)}}function F8e(e,t,r){return t&&F6(e.prototype,t),r&&F6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H8e(e){var t=B8e(e,"string");return I0(t)==="symbol"?t:String(t)}function B8e(e,t){if(I0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(I0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H6=function(){function e(){L8e(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return F8e(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function M0(e){return M0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M0(e)}function V8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W8e(n.key),n)}}function j8e(e,t,r){return t&&B6(e.prototype,t),r&&B6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W8e(e){var t=U8e(e,"string");return M0(t)==="symbol"?t:String(t)}function U8e(e,t){if(M0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z8e=function(){function e(){V8e(this,e),this.size=new H6,this.workingSpace=N8e,this.sharedSize=null}return j8e(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof H6}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=Hx,r.workingSpace=Bx,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=Bx,r.workingSpace=Hx,this.sharedSize=r.getViewSize()}}]),e}();function D0(e){return D0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D0(e)}function G8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K8e(n.key),n)}}function Y8e(e,t,r){return t&&V6(e.prototype,t),r&&V6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K8e(e){var t=X8e(e,"string");return D0(t)==="symbol"?t:String(t)}function X8e(e,t){if(D0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(D0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dae=function(){function e(t,r,n){G8e(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new z8e,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Y8e(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var a=r.firstElementChild;a;){if(a.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(Hx))break;a=a.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),a=n.getViewSize(),o=a.nextSize,s=this.getRenderedChildCount();s<o;){var l=this.nodesPool();!i||i&&n.isPlaceOn(Bx)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(Hx);s>o;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Bx)&&(i+=n.sharedSize.nextSize);var a=r.childNodes[i];if(a.tagName!==this.childNodeType){var o=this.nodesPool();r.replaceChild(o,a),a=o}this.collectedNodes.push(a),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function yv(e){return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yv(e)}function q8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J8e(n.key),n)}}function Z8e(e,t,r){return t&&j6(e.prototype,t),r&&j6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J8e(e){var t=Q8e(e,"string");return yv(t)==="symbol"?t:String(t)}function Q8e(e,t){if(yv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C2(e,t)}function C2(e,t){return C2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},C2(e,t)}function t5e(e){var t=i5e();return function(){var n=Vx(e),i;if(t){var a=Vx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return r5e(this,i)}}function r5e(e,t){if(t&&(yv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n5e(e)}function n5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vx(e){return Vx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vx(e)}var $ae=function(e){e5e(r,e);var t=t5e(r);function r(){return q8e(this,r),t.apply(this,arguments)}return Z8e(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(Dae);function $0(e){return $0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$0(e)}function a5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s5e(n.key),n)}}function o5e(e,t,r){return t&&W6(e.prototype,t),r&&W6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s5e(e){var t=l5e(e,"string");return $0(t)==="symbol"?t:String(t)}function l5e(e,t){if($0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u5e=function(){function e(t){a5e(this,e),this.nodeType=t.toUpperCase()}return o5e(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function N0(e){return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N0(e)}function f5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h5e(n.key),n)}}function c5e(e,t,r){return t&&U6(e.prototype,t),r&&U6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h5e(e){var t=d5e(e,"string");return N0(t)==="symbol"?t:String(t)}function d5e(e,t){if(N0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v_=function(){function e(t,r){f5e(this,e),this.nodesPool=typeof t=="string"?new u5e(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return c5e(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function mv(e){return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mv(e)}function v5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g5e(n.key),n)}}function p5e(e,t,r){return t&&z6(e.prototype,t),r&&z6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g5e(e){var t=y5e(e,"string");return mv(t)==="symbol"?t:String(t)}function y5e(e,t){if(mv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x2(e,t)}function x2(e,t){return x2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},x2(e,t)}function b5e(e){var t=S5e();return function(){var n=jx(e),i;if(t){var a=jx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return w5e(this,i)}}function w5e(e,t){if(t&&(mv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _5e(e)}function _5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jx(e){return jx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jx(e)}var C5e=function(e){m5e(r,e);var t=b5e(r);function r(){var n;return v5e(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return p5e(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new $ae(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,f=0;f<a;f++){var c=this.table.renderedRowToSource(f),h=l.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<s;p++){d.render();var g=d.getCurrentNode();g.className="",g.removeAttribute("style"),o[p](c,g,p)}d.end()}}}]),r}(v_);function bv(e){return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bv(e)}function x5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O5e(n.key),n)}}function T5e(e,t,r){return t&&G6(e.prototype,t),r&&G6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O5e(e){var t=E5e(e,"string");return bv(t)==="symbol"?t:String(t)}function E5e(e,t){if(bv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T2(e,t)}function T2(e,t){return T2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},T2(e,t)}function k5e(e){var t=I5e();return function(){var n=Wx(e),i;if(t){var a=Wx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return A5e(this,i)}}function A5e(e,t){if(t&&(bv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P5e(e)}function P5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wx(e){return Wx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wx(e)}var M5e=function(e){R5e(r,e);var t=k5e(r);function r(n){return x5e(this,r),t.call(this,null,n)}return T5e(r,[{key:"adjust",value:function(){var i=this.table,a=i.columnHeadersCount,o=i.rowHeadersCount,s=this.rootNode.firstChild;if(a){for(var l=this.table.columnsToRender,u=l+o,f=0,c=a;f<c;f++){for(s=this.rootNode.childNodes[f],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>a)for(var d=a;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&po(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,a=0;a<i;a+=1)for(var o=this.table,s=o.columnHeaderFunctions,l=o.columnsToRender,u=o.rowHeadersCount,f=this.rootNode.childNodes[a],c=-1*u;c<l;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),s[a](h,d,a)}}}]),r}(v_);function wv(e){return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wv(e)}function D5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N5e(n.key),n)}}function $5e(e,t,r){return t&&Y6(e.prototype,t),r&&Y6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N5e(e){var t=L5e(e,"string");return wv(t)==="symbol"?t:String(t)}function L5e(e,t){if(wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O2(e,t)}function O2(e,t){return O2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},O2(e,t)}function H5e(e){var t=j5e();return function(){var n=Ux(e),i;if(t){var a=Ux(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return B5e(this,i)}}function B5e(e,t){if(t&&(wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V5e(e)}function V5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ux(e){return Ux=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ux(e)}var W5e=function(e){F5e(r,e);var t=H5e(r);function r(n){return D5e(this,r),t.call(this,null,n)}return $5e(r,[{key:"adjust",value:function(){for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=a+o;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=0;s<o;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var f=0;f<a;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+o].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&ke(d,"rowHeader")}}]),r}(v_);function _v(e){return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_v(e)}var K6;function U5e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function z5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y5e(n.key),n)}}function G5e(e,t,r){return t&&X6(e.prototype,t),r&&X6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y5e(e){var t=K5e(e,"string");return _v(t)==="symbol"?t:String(t)}function K5e(e,t){if(_v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E2(e,t)}function E2(e,t){return E2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},E2(e,t)}function q5e(e){var t=Q5e();return function(){var n=zx(e),i;if(t){var a=zx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Z5e(this,i)}}function Z5e(e,t){if(t&&(_v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J5e(e)}function J5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zx(e){return zx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zx(e)}var q6=!1,e6e=function(e){X5e(r,e);var t=q5e(r);function r(n){var i;return z5e(this,r),i=t.call(this,"TR",n),i.orderView=new Dae(n,function(a){return i.nodesPool.obtain(a)},i.nodeType),i}return G5e(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!q6&&i>1e3&&(q6=!0,gr(sr(K6||(K6=U5e([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var a=0;a<i;a++)this.orderView.render();this.orderView.end()}}]),r}(v_);function Sv(e){return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sv(e)}function t6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n6e(n.key),n)}}function r6e(e,t,r){return t&&Z6(e.prototype,t),r&&Z6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n6e(e){var t=i6e(e,"string");return Sv(t)==="symbol"?t:String(t)}function i6e(e,t){if(Sv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function a6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R2(e,t)}function R2(e,t){return R2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},R2(e,t)}function o6e(e){var t=u6e();return function(){var n=Gx(e),i;if(t){var a=Gx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return s6e(this,i)}}function s6e(e,t){if(t&&(Sv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l6e(e)}function l6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gx(e){return Gx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gx(e)}var f6e=function(e){a6e(r,e);var t=o6e(r);function r(){var n;return t6e(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return r6e(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new $ae(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<a;u++){var f=this.table.renderedRowToSource(u),c=s.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=l.obtainOrderView(c);h.prependView(d).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<o;v++){h.render();var p=h.getCurrentNode(),g=this.table.renderedColumnToSource(v);mt(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),this.table.cellRenderer(f,g,p)}h.end()}}}]),r}(v_);function L0(e){return L0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L0(e)}function c6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d6e(n.key),n)}}function h6e(e,t,r){return t&&J6(e.prototype,t),r&&J6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d6e(e){var t=v6e(e,"string");return L0(t)==="symbol"?t:String(t)}function v6e(e,t){if(L0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(L0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p6e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;c6e(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return h6e(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,a=r.colGroup,o=r.rows,s=r.cells;n.setTable(this),i.setTable(this),a.setTable(this),o.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=a,this.rows=o,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var a=n.getRenderedNode(i);if(a.firstChild){var o=this.renderedRowToSource(i),s=this.rowUtils.getHeight(o);s?a.firstChild.style.height="".concat(s-1,"px"):a.firstChild.style.height=""}}}}]),e}();function F0(e){return F0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F0(e)}function g6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m6e(n.key),n)}}function y6e(e,t,r){return t&&Q6(e.prototype,t),r&&Q6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m6e(e){var t=b6e(e,"string");return F0(t)==="symbol"?t:String(t)}function b6e(e,t){if(F0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w6e=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,a=t.TBODY,o=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;g6e(this,e),this.renderer=new p6e(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new C5e,columnHeaders:new M5e(n),colGroup:new W5e(i),rows:new e6e(a),cells:new f6e}),this.renderer.setAxisUtils(o,s)}return y6e(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function H0(e){return H0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H0(e)}function _6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ez(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C6e(n.key),n)}}function S6e(e,t,r){return t&&ez(e.prototype,t),r&&ez(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C6e(e){var t=x6e(e,"string");return H0(t)==="symbol"?t:String(t)}function x6e(e,t){if(H0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(H0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T6e=function(){function e(t,r){_6e(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return S6e(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var a=n.getStretchedColumnWidth(r,i);a&&(i=a)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,a=n.wtViewport,o=n.cloneSource,s=o?o.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?Sn():0,u=r.getSetting("rowHeaderWidth");if(a.columnsRenderCalculator.refreshStretching(a.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function B0(e){return B0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B0(e)}function O6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R6e(n.key),n)}}function E6e(e,t,r){return t&&tz(e.prototype,t),r&&tz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R6e(e){var t=k6e(e,"string");return B0(t)==="symbol"?t:String(t)}function k6e(e,t){if(B0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(B0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A6e=function(){function e(t,r){O6e(this,e),this.dataAccessObject=t,this.wtSettings=r}return E6e(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function V0(e){return V0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V0(e)}function P6e(e){return D6e(e)||M6e(e)||Nae(e)||I6e()}function I6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function D6e(e){if(Array.isArray(e))return k2(e)}function $6e(e,t){return F6e(e)||L6e(e,t)||Nae(e,t)||N6e()}function N6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nae(e,t){if(e){if(typeof e=="string")return k2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k2(e,t)}}function k2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function F6e(e){if(Array.isArray(e))return e}function H6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lae(n.key),n)}}function B6e(e,t,r){return t&&rz(e.prototype,t),r&&rz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eo(e,t,r){return t=Lae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lae(e){var t=V6e(e,"string");return V0(t)==="symbol"?t:String(t)}function V6e(e,t){if(V0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(V0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j6e=function(){function e(t,r,n,i,a){var o=this;H6e(this,e),Eo(this,"wtSettings",null),Eo(this,"domBindings",void 0),Eo(this,"TBODY",null),Eo(this,"THEAD",null),Eo(this,"COLGROUP",null),Eo(this,"hasTableHeight",!0),Eo(this,"hasTableWidth",!0),Eo(this,"isTableVisible",!1),Eo(this,"tableOffset",0),Eo(this,"holderOffset",0),this.domBindings=n,this.isMaster=a==="master",this.name=a,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,sH(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return o._modifyRowHeaderWidth(s)}),this.rowUtils=new A6e(this.dataAccessObject,this.wtSettings),this.columnUtils=new T6e(this.dataAccessObject,this.wtSettings),this.tableRenderer=new w6e({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return B6e(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!mt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!mt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!mt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,a=i.wtOverlays,o=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=tn(this.holder),v=o.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var p=a.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,g!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=a.updateStateOfRendering()),v)this.isMaster&&o.createVisibleCalculators(),a&&a.refresh(!0);else{this.isMaster?this.tableOffset=tn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var y=s>0?this.getFirstRenderedRow():0,m=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new $8e(y,s,h),this.columnFilter=new k8e(m,l,f);var b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var _={};this.wtSettings.getSetting("beforeDraw",!0,_),b=_.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(Wo)||this.is(yu))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var x;if(this.isMaster&&(x=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Wo))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var T=fr(this.hider),E=fr(this.TABLE);T!==0&&E!==T&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),x!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Wo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var P=!1;return this.isMaster&&(P=a.topOverlay.resetFixedPosition(),a.bottomOverlay.clone&&(P=a.bottomOverlay.resetFixedPosition()||P),P=a.inlineStartOverlay.resetFixedPosition()||P,a.topInlineStartCornerOverlay&&a.topInlineStartCornerOverlay.resetFixedPosition(),a.bottomInlineStartCornerOverlay&&a.bottomInlineStartCornerOverlay.clone&&a.bottomInlineStartCornerOverlay.resetFixedPosition()),P?(a.refreshAll(),a.adjustElementsSize()):this.refreshSelections(v),d&&a.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,a=this.wtSettings.getSetting("defaultRowHeight"),o,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=Ps(s),(!o&&a<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,a=r.getSetting("columnHeaders"),o=0,s=a.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height="".concat(i[o],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(Wo))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),a=0;a<i;a++){var o=this.rowFilter.renderedToSource(a);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,a=n.length;i<a;i++)wt(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var a=Array.from(i),o=a.length;if(r){for(var s=[],l=0;l<o;l++){for(var u=a[l].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=a[l].classNames,v=d.length,p=0;p<v;p++)s.includes(d[p])||s.push(d[p]);f&&!s.includes(f)&&s.push(f),c&&!s.includes(c)&&s.push(c),h&&!s.includes(h)&&s.push(h)}var g=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var y=0;y<g.length;y++)s.push(g[y]);for(var m=s.length,b=0;b<m;b++)this.removeClassFromCells(s[b])}for(var _=0;_<o;_++)a[_].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,a=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(a&&Array.isArray(a)){var o=$6e(a,2);n=o[0],i=o[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(a){var o=a.childNodes[i];o&&n.push(o)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return a==null?void 0:a.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,a=0;a<i;a++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=o==null?void 0:o.childNodes[a];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=pu(n,["TD","TH"])),n===null)return null;var i=n.parentNode,a=i.parentNode,o=Fie(i),s=n.cellIndex;if(Yl(Hc,n,this.wtRootElement)||Yl(Lc,n,this.wtRootElement))a.nodeName==="THEAD"&&(o-=a.childNodes.length);else if(Yl(yu,n,this.wtRootElement)||Yl(Wo,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");o=l-a.childNodes.length+o}else a===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o);return Yl(Hc,n,this.wtRootElement)||Yl(Fc,n,this.wtRootElement)||Yl(yu,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=Ps(this.TBODY)-1,a,o,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),a=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?o=Ps(u):o=Ps(l)-1,(!a&&this.wtSettings.getSetting("defaultRowHeight")<o||a<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return fr(this.TABLE)}},{key:"getHeight",value:function(){return $r(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=fr(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=$r(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return hv(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=wr(r)?r():null;return Array.isArray(n)?(n=P6e(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Dg=j6e;var W6e="stickyRowsBottom",Fae={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};as(Fae,"MIXIN_NAME",W6e,{writable:!1,enumerable:!1});const Hae=Fae;var U6e="stickyColumnsStart",Bae={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};as(Bae,"MIXIN_NAME",U6e,{writable:!1,enumerable:!1});const _H=Bae;function Cv(e){return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cv(e)}function nz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G6e(n.key),n)}}function z6e(e,t,r){return t&&nz(e.prototype,t),r&&nz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function G6e(e){var t=Y6e(e,"string");return Cv(t)==="symbol"?t:String(t)}function Y6e(e,t){if(Cv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A2(e,t)}function A2(e,t){return A2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},A2(e,t)}function q6e(e){var t=Q6e();return function(){var n=Yx(e),i;if(t){var a=Yx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Z6e(this,i)}}function Z6e(e,t){if(t&&(Cv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J6e(e)}function J6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yx(e){return Yx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yx(e)}var SH=function(e){X6e(r,e);var t=q6e(r);function r(n,i,a,o){return K6e(this,r),t.call(this,n,i,a,o,yu)}return z6e(r)}(Dg);mr(SH,Hae);mr(SH,_H);const eze=SH;var Lc="top",Wo="bottom",Fc="inline_start",Hc="top_inline_start_corner",yu="bottom_inline_start_corner",tze=[Lc,Wo,Fc,Hc,yu],rze=new Map([[Lc,"ht_clone_".concat(Lc)],[Wo,"ht_clone_".concat(Wo)],[Fc,"ht_clone_".concat(Fc," ht_clone_left")],[Hc,"ht_clone_".concat(Hc," ht_clone_top_left_corner")],[yu,"ht_clone_".concat(yu," ht_clone_bottom_left_corner")]]);function j0(e){return j0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j0(e)}function nze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vae(n.key),n)}}function ize(e,t,r){return t&&iz(e.prototype,t),r&&iz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EA(e,t,r){return t=Vae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vae(e){var t=aze(e,"string");return j0(t)==="symbol"?t:String(t)}function aze(e,t){if(j0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oze=function(){function e(t){nze(this,e),EA(this,"dataAccessObject",void 0),EA(this,"lastScrolledColumnPos",-1),EA(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return ize(e,[{key:"scrollViewport",value:function(r,n,i,a,o){var s=this.scrollViewportHorizontally(r.col,i,o),l=this.scrollViewportVertically(r.row,n,a);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalColumns;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return l===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<l||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalRows;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>s-h-1))return!1;var p=!1;return l===-1?p=v.scrollTo(r,f?r>this.lastScrolledRowPos:i):(f&&(r<l||r>u)||!f)&&(p=v.scrollTo(r,f?r>u:i)),p&&(this.lastScrolledRowPos=r),p}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var f=tn(i.wtRootElement),c=Ps(i.hider),h=Ps(l),d=b0(l,l);if(f.top+c-h<=d){var v=a.getColumnHeaderHeight();v+=n.sumCellSizes(0,s);for(var p=o;p>0;p--)if(v+=n.sumCellSizes(p-1,p),f.top+c-v<=d){u=p;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=tn(i.wtRootElement),f=b0(s,s);if(u.top>f){for(var c=Ps(s),h=a.getColumnHeaderHeight(),d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=tn(i.wtRootElement),f=Em(i.hider),c=Em(s),h=Math.abs(Mx(s,s));if(u.left+f-c<=h){for(var d=a.getRowHeaderWidth(),v=o;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){l=v;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,a=r.wtTable,o=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=a.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var f=n.getSetting("rtlMode"),c=null;if(f){var h=a.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var p=tn(a.wtRootElement);c=p.left}var g=Math.abs(Mx(l,l));if(c>g){for(var y=Em(l),m=o.getRowHeaderWidth(),b=1;b<=s;b++)if(m+=i.sumCellSizes(b-1,b),c+m-g>=y){u=b-2;break}}}return u}}]),e}();const sze=oze;function W0(e){return W0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W0(e)}function lze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function az(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jae(n.key),n)}}function uze(e,t,r){return t&&az(e.prototype,t),r&&az(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ua(e,t,r){return t=jae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jae(e){var t=fze(e,"string");return W0(t)==="symbol"?t:String(t)}function fze(e,t){if(W0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(W0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CH=function(){function e(t,r){lze(this,e),Ua(this,"wtTable",void 0),Ua(this,"wtScroll",void 0),Ua(this,"wtViewport",void 0),Ua(this,"wtOverlays",void 0),Ua(this,"selections",void 0),Ua(this,"wtEvent",void 0),Ua(this,"guid","wt_".concat(iH())),Ua(this,"drawInterrupted",!1),Ua(this,"drawn",!1),Ua(this,"domBindings",void 0),Ua(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new sze(this.createScrollDao())}return uze(e,[{key:"eventManager",get:function(){return new Nr(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(a,o){Nu(o,r[a])}])}}},{key:"createCellCoords",value:function(r,n){return new Fx(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new bH(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),a=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<a&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<a)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,a,o){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function xv(e){return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(e)}function oz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wae(n.key),n)}}function cze(e,t,r){return t&&oz(e.prototype,t),r&&oz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P2(e,t)}function P2(e,t){return P2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},P2(e,t)}function vze(e){var t=gze();return function(){var n=Kx(e),i;if(t){var a=Kx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pze(this,i)}}function pze(e,t){if(t&&(xv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hC(e)}function hC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kx(e){return Kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kx(e)}function sz(e,t,r){return t=Wae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wae(e){var t=yze(e,"string");return xv(t)==="symbol"?t:String(t)}function yze(e,t){if(xv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mze=function(e){dze(r,e);var t=vze(r);function r(n,i,a){var o;hze(this,r),o=t.call(this,n,i),sz(hC(o),"cloneSource",void 0),sz(hC(o),"cloneOverlay",void 0);var s=o.wtSettings.getSetting("facade",hC(o));return o.cloneSource=a.source,o.cloneOverlay=a.overlay,o.wtTable=o.cloneOverlay.createTable(o.getTableDao(),s,o.domBindings,o.wtSettings),o.wtViewport=a.viewport,o.selections=a.selections,o.wtEvent=new Mae(s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections,a.event),o.findOriginalHeaders(),o}return cze(r)}(CH);function U0(e){return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U0(e)}function bze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uae(n.key),n)}}function wze(e,t,r){return t&&lz(e.prototype,t),r&&lz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ze(e,t,r){return t=Uae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uae(e){var t=Sze(e,"string");return U0(t)==="symbol"?t:String(t)}function Sze(e,t){if(U0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(U0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p_=function(){function e(t,r,n,i,a){bze(this,e),_ze(this,"wtSettings",null),as(this,"wot",t,{writable:!1}),this.domBindings=a,this.facadeGetter=r,this.wtSettings=i;var o=this.wot.wtTable,s=o.TABLE,l=o.hider,u=o.spreader,f=o.holder,c=o.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=vv(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return wze(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=vv(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=w0(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){gr("The provided element is not a child of the ".concat(this.type," overlay"));return}var a=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return a?h=this.getRelativeCellPositionWithinWindow(s,o,c,f):h=this.getRelativeCellPositionWithinHolder(s,l,o,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,a){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=a.start;else{var u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Sn())),s=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();l=f.top-o.top}else l=a.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,a,o){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-o.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=s.vertical-o.top);return{start:a.start-l,top:a.top-u}}},{key:"makeClone",value:function(){if(tze.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;o.className="".concat(rze.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,s.className=r.TABLE.className,o.appendChild(s),l.appendChild(o);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Lc||u==="vertical"&&this.type===Fc?this.mainTableScrollableElement=a:a.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=w0(r.TABLE),new mze(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,a=n.style,o=r.parentNode.style;ne([i,a,o],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Tv(e){return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tv(e)}function dC(e,t,r){return zae()?dC=Reflect.construct.bind():dC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&Xx(u,o.prototype),u},dC.apply(null,arguments)}function Cze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tze(n.key),n)}}function xze(e,t,r){return t&&uz(e.prototype,t),r&&uz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tze(e){var t=Oze(e,"string");return Tv(t)==="symbol"?t:String(t)}function Oze(e,t){if(Tv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xx(e,t)}function Xx(e,t){return Xx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Xx(e,t)}function Rze(e){var t=zae();return function(){var n=qx(e),i;if(t){var a=qx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return kze(this,i)}}function kze(e,t){if(t&&(Tv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aze(e)}function Aze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qx(e){return qx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qx(e)}var Pze=function(e){Eze(r,e);var t=Rze(r);function r(n,i,a,o,s,l){var u;return Cze(this,r),u=t.call(this,n,i,yu,a,o),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return xze(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return dC(eze,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var a=this.clone.wtTable.holder.parentNode;if(a.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();a.style[this.isRtl()?"right":"left"]="".concat(o,"px"),a.style.bottom="".concat(s,"px")}else l_(a),this.repositionOverlay();var l=$r(this.clone.wtTable.TABLE),u=fr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),a.style.height="".concat(l,"px"),a.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=Sn(s)),l.style.bottom="".concat(u,"px")}}]),r}(p_),Ize="calculatedColumns",Gae={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};as(Gae,"MIXIN_NAME",Ize,{writable:!1,enumerable:!1});const xH=Gae;function Ov(e){return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ov(e)}function fz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dze(n.key),n)}}function Mze(e,t,r){return t&&fz(e.prototype,t),r&&fz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dze(e){var t=$ze(e,"string");return Ov(t)==="symbol"?t:String(t)}function $ze(e,t){if(Ov(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I2(e,t)}function I2(e,t){return I2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},I2(e,t)}function Fze(e){var t=Vze();return function(){var n=Zx(e),i;if(t){var a=Zx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Hze(this,i)}}function Hze(e,t){if(t&&(Ov(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bze(e)}function Bze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zx(e){return Zx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zx(e)}var TH=function(e){Lze(r,e);var t=Fze(r);function r(n,i,a,o){return Nze(this,r),t.call(this,n,i,a,o,Wo)}return Mze(r)}(Dg);mr(TH,Hae);mr(TH,xH);const jze=TH;function Ev(e){return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ev(e)}function vC(e,t,r){return Kae()?vC=Reflect.construct.bind():vC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&Jx(u,o.prototype),u},vC.apply(null,arguments)}function Wze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xae(n.key),n)}}function Uze(e,t,r){return t&&cz(e.prototype,t),r&&cz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jx(e,t)}function Jx(e,t){return Jx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Jx(e,t)}function Gze(e){var t=Kae();return function(){var n=Qx(e),i;if(t){var a=Qx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Yze(this,i)}}function Yze(e,t){if(t&&(Ev(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yae(e)}function Yae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qx(e){return Qx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qx(e)}function Kze(e,t,r){return t=Xae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xae(e){var t=Xze(e,"string");return Ev(t)==="symbol"?t:String(t)}function Xze(e,t){if(Ev(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qze=function(e){zze(r,e);var t=Gze(r);function r(n,i,a,o){var s;return Wze(this,r),s=t.call(this,n,i,Wo,a,o),Kze(Yae(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return Uze(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return vC(jze,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode;a.style.top="";var o=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(o=this.getOverlayOffset(),a.style.bottom="".concat(o,"px")):(o=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=Sn(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a?(a.scrollTo(Nc(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wot,s=o.wtTable,l=o.wtSettings,u=l.getSetting("defaultRowHeight"),f=i,c=0;f<a;){var h=s.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,f=Sn(l),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=o.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,a.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var p=$r(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(p=0),h.height="".concat(p,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;a&&l.offsetHeight!==l.clientHeight&&(u=Sn(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return b0(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,f=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+s,0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==a,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((o||a===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,f=mt(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(ke(u,"innerBorderBottom"),l=!f):(wt(u,"innerBorderBottom"),l=f)}return l}}]),r}(p_),Zze="calculatedRows",qae={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};as(qae,"MIXIN_NAME",Zze,{writable:!1,enumerable:!1});const Zae=qae;function Rv(e){return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rv(e)}function hz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qze(n.key),n)}}function Jze(e,t,r){return t&&hz(e.prototype,t),r&&hz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qze(e){var t=eGe(e,"string");return Rv(t)==="symbol"?t:String(t)}function eGe(e,t){if(Rv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M2(e,t)}function M2(e,t){return M2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},M2(e,t)}function nGe(e){var t=oGe();return function(){var n=eT(e),i;if(t){var a=eT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return iGe(this,i)}}function iGe(e,t){if(t&&(Rv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aGe(e)}function aGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eT(e){return eT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eT(e)}var OH=function(e){rGe(r,e);var t=nGe(r);function r(n,i,a,o){return tGe(this,r),t.call(this,n,i,a,o,Fc)}return Jze(r)}(Dg);mr(OH,Zae);mr(OH,_H);const sGe=OH;function kv(e){return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(e)}function pC(e,t,r){return Jae()?pC=Reflect.construct.bind():pC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&tT(u,o.prototype),u},pC.apply(null,arguments)}function lGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fGe(n.key),n)}}function uGe(e,t,r){return t&&dz(e.prototype,t),r&&dz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fGe(e){var t=cGe(e,"string");return kv(t)==="symbol"?t:String(t)}function cGe(e,t){if(kv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tT(e,t)}function tT(e,t){return tT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tT(e,t)}function dGe(e){var t=Jae();return function(){var n=rT(e),i;if(t){var a=rT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return vGe(this,i)}}function vGe(e,t){if(t&&(kv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pGe(e)}function pGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rT(e){return rT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rT(e)}var gGe=function(e){hGe(r,e);var t=dGe(r);function r(n,i,a,o){return lGe(this,r),t.call(this,n,i,Fc,a,o)}return uGe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return pC(sGe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var a=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===a&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),fE(o,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),l_(o));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===a&&a.scrollX!==i?(a.scrollTo(i,dv(a)),o=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<a;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||o,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=Sn(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=fr(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,a.style.height=a.parentNode.style.height,a.style.width="".concat(parseInt(a.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),a=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[a]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[a]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(a){var f=this.wot.wtTable.getColumnWidth(i),c=this.wot.wtViewport.getViewportWidth();f>c&&(a=!1)}return a&&l.offsetWidth!==l.clientWidth&&(u=Sn(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),a=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(a=this.wot.wtTable.holderOffset.left),a}},{key:"getScrollPosition",value:function(){return Math.abs(Mx(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="horizontal")){this.isRtl()?o=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?wt(a,"emptyRows"):ke(a,"emptyRows");var u=!1;if(s&&!o.length)ke(a,"innerBorderLeft innerBorderInlineStart");else if(!s&&o.length){var f=mt(a,"innerBorderInlineStart");i?(ke(a,"innerBorderLeft innerBorderInlineStart"),u=!f):(wt(a,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(p_),yGe="stickyRowsTop",Qae={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};as(Qae,"MIXIN_NAME",yGe,{writable:!1,enumerable:!1});const eoe=Qae;function Av(e){return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Av(e)}function vz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bGe(n.key),n)}}function mGe(e,t,r){return t&&vz(e.prototype,t),r&&vz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bGe(e){var t=wGe(e,"string");return Av(t)==="symbol"?t:String(t)}function wGe(e,t){if(Av(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D2(e,t)}function D2(e,t){return D2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},D2(e,t)}function CGe(e){var t=OGe();return function(){var n=nT(e),i;if(t){var a=nT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return xGe(this,i)}}function xGe(e,t){if(t&&(Av(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TGe(e)}function TGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nT(e){return nT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nT(e)}var EH=function(e){SGe(r,e);var t=CGe(r);function r(n,i,a,o){return _Ge(this,r),t.call(this,n,i,a,o,Hc)}return mGe(r)}(Dg);mr(EH,eoe);mr(EH,_H);const EGe=EH;function Pv(e){return Pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pv(e)}function gC(e,t,r){return toe()?gC=Reflect.construct.bind():gC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&iT(u,o.prototype),u},gC.apply(null,arguments)}function RGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,roe(n.key),n)}}function kGe(e,t,r){return t&&pz(e.prototype,t),r&&pz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iT(e,t)}function iT(e,t){return iT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iT(e,t)}function PGe(e){var t=toe();return function(){var n=aT(e),i;if(t){var a=aT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return IGe(this,i)}}function IGe(e,t){if(t&&(Pv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $2(e)}function $2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function toe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function aT(e){return aT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aT(e)}function gz(e,t,r){return t=roe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function roe(e){var t=MGe(e,"string");return Pv(t)==="symbol"?t:String(t)}function MGe(e,t){if(Pv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DGe=function(e){AGe(r,e);var t=PGe(r);function r(n,i,a,o,s,l){var u;return RGe(this,r),u=t.call(this,n,i,Hc,a,o),gz($2(u),"topOverlay",void 0),gz($2(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return kGe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return gC(EGe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();fE(i,"".concat(a,"px"),"".concat(o,"px"))}else l_(i);var s=$r(this.clone.wtTable.TABLE),l=fr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}(p_);function Iv(e){return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iv(e)}function yz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NGe(n.key),n)}}function $Ge(e,t,r){return t&&yz(e.prototype,t),r&&yz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NGe(e){var t=LGe(e,"string");return Iv(t)==="symbol"?t:String(t)}function LGe(e,t){if(Iv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N2(e,t)}function N2(e,t){return N2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},N2(e,t)}function BGe(e){var t=WGe();return function(){var n=oT(e),i;if(t){var a=oT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return VGe(this,i)}}function VGe(e,t){if(t&&(Iv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jGe(e)}function jGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oT(e){return oT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oT(e)}var RH=function(e){HGe(r,e);var t=BGe(r);function r(n,i,a,o){return FGe(this,r),t.call(this,n,i,a,o,Lc)}return $Ge(r)}(Dg);mr(RH,eoe);mr(RH,xH);const UGe=RH;function Mv(e){return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mv(e)}function yC(e,t,r){return ioe()?yC=Reflect.construct.bind():yC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&sT(u,o.prototype),u},yC.apply(null,arguments)}function zGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aoe(n.key),n)}}function GGe(e,t,r){return t&&mz(e.prototype,t),r&&mz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sT(e,t)}function sT(e,t){return sT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sT(e,t)}function KGe(e){var t=ioe();return function(){var n=lT(e),i;if(t){var a=lT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return XGe(this,i)}}function XGe(e,t){if(t&&(Mv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return noe(e)}function noe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ioe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lT(e){return lT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lT(e)}function qGe(e,t,r){return t=aoe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aoe(e){var t=ZGe(e,"string");return Mv(t)==="symbol"?t:String(t)}function ZGe(e,t){if(Mv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JGe=function(e){YGe(r,e);var t=KGe(r);function r(n,i,a,o){var s;return zGe(this,r),s=t.call(this,n,i,Lc,a,o),qGe(noe(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return GGe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return yC(UGe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,a=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===a&&(!o||o!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=i.offsetHeight;l=c===h,s=this.getOverlayOffset(),fE(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),l_(i);var d=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a&&a.scrollY!==i?(a.scrollTo(Nc(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<a;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?o:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=Sn(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=$r(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,a.style.width=a.parentNode.style.width,a.style.height="".concat(parseInt(a.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.wot,s=this.wtSettings,l=o.cloneSource?o.cloneSource:o,u=l.wtTable.holder,f=this.getTableParentOffset(),c=0;if(a){var h=this.wot.wtTable.getRowHeight(i),d=this.wot.wtViewport.getViewportHeight();h>d&&(a=!1)}if(a&&u.offsetHeight!==u.clientHeight&&(c=Sn(this.domBindings.rootDocument)),a){var v=s.getSetting("fixedRowsBottom"),p=s.getSetting("totalRows");f+=this.sumCellSizes(0,i+1),f-=o.wtViewport.getViewportHeight()-this.sumCellSizes(p-v,p),f+=1}else f+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return b0(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?wt(o,"emptyColumns"):ke(o,"emptyColumns");var l=!1;if(!a){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=mt(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(ke(o,"innerBorderTop"),l=!h):(wt(o,"innerBorderTop"),l=h)}}return l}}]),r}(p_);function z0(e){return z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z0(e)}function Zl(e,t,r){return QGe()?Zl=Reflect.construct.bind():Zl=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&L2(u,o.prototype),u},Zl.apply(null,arguments)}function QGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function L2(e,t){return L2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},L2(e,t)}function e9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ooe(n.key),n)}}function t9e(e,t,r){return t&&bz(e.prototype,t),r&&bz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vs(e,t,r){return t=ooe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ooe(e){var t=r9e(e,"string");return z0(t)==="symbol"?t:String(t)}function r9e(e,t){if(z0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n9e=function(){function e(t,r,n,i,a,o){var s=this;e9e(this,e),vs(this,"wot",null),vs(this,"topOverlay",null),vs(this,"bottomOverlay",null),vs(this,"inlineStartOverlay",null),vs(this,"topInlineStartCornerOverlay",null),vs(this,"bottomInlineStartCornerOverlay",null),vs(this,"browserLineHeight",void 0),vs(this,"wtSettings",null),vs(this,"resizeObserver",new ResizeObserver(function(h){XO(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;var l=this.domBindings,u=l.rootDocument,f=l.rootWindow;this.instance=this.wot,this.eventManager=a,this.scrollbarSize=Sn(u);var c=f.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:w0(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return t9e(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,a=n.getComputedStyle(i.body),o=parseInt(a.lineHeight,10),s=parseInt(a.fontSize,10)*1.2;this.browserLineHeight=o||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=Zl(JGe,r),this.bottomOverlay=Zl(qze,r),this.inlineStartOverlay=Zl(gGe,r),this.topInlineStartCornerOverlay=Zl(DGe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=Zl(Pze,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),o!==s&&this.eventManager.addEventListener(s,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var l=a.devicePixelRatio&&a.devicePixelRatio>1,u=this.scrollableElement===a,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||l||!$F())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var p=v.clone.wtTable.holder;r.eventManager.addEventListener(p,"wheel",function(g){return r.onCloneWheel(g,f)},c)}});var d;this.eventManager.addEventListener(a,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,o=r.target;this.keyPressed&&(a!==n&&o!==n&&!r.target.contains(a)||i!==n&&o!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,a=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=r.target,l=o!==i&&s!==i&&!s.contains(o),u=a!==i&&s!==i&&!s.contains(a);if(!(this.keyPressed&&(l||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=gv(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var a=this.scrollVertically(n),o=this.scrollHorizontally(i);return a||o}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,a=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=a[0],s=a[1];if(this.horizontalScrolling=n.scrollLeft!==o||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=o;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=o)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=w0(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,a=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return a&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),a}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,a=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,a),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var f=i.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=i.holder,v=d.scrollHeight,p=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<p,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return ne(n,function(a){a&&a.clone&&a.clone.wtTable.TABLE.contains(r)&&(i=a.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];ne(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const i9e=n9e;function G0(e){return G0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G0(e)}function a9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,soe(n.key),n)}}function o9e(e,t,r){return t&&wz(e.prototype,t),r&&wz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _z(e,t,r){return t=soe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function soe(e){var t=s9e(e,"string");return G0(t)==="symbol"?t:String(t)}function s9e(e,t){if(G0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l9e=function(){function e(t){var r=this;a9e(this,e),_z(this,"settings",{}),_z(this,"defaults",Object.freeze(this.getDefaults())),At(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return o9e(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,a,o){var s=r.getSetting("data",i,a);Nu(o,s??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?At(r,function(a,o){i.settings[o]=a}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,a,o){return typeof this.settings[r]=="function"?this.settings[r](n,i,a,o):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Dv(e){return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(e)}function u9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c9e(n.key),n)}}function f9e(e,t,r){return t&&Sz(e.prototype,t),r&&Sz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c9e(e){var t=h9e(e,"string");return Dv(t)==="symbol"?t:String(t)}function h9e(e,t){if(Dv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F2(e,t)}function F2(e,t){return F2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},F2(e,t)}function v9e(e){var t=y9e();return function(){var n=uT(e),i;if(t){var a=uT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return p9e(this,i)}}function p9e(e,t){if(t&&(Dv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g9e(e)}function g9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uT(e){return uT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uT(e)}var kH=function(e){d9e(r,e);var t=v9e(r);function r(n,i,a,o){return u9e(this,r),t.call(this,n,i,a,o,"master")}return f9e(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=vv(this.wtRootElement),a=this.domBindings.rootWindow;if(i===a){var o=this.wtSettings.getSetting("preventOverflow");o||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=pv(i,"height",a),u=pv(i,"overflow",a),f=this.holder.style,c=i.scrollWidth,h=i.scrollHeight,d=i.getBoundingClientRect(),v=d.width,p=d.height,g=["auto","hidden","scroll"];if(s&&g.includes(u)){var y=i.cloneNode(!1);y.style.overflow="auto",y.style.position="absolute",i.nextElementSibling?s.insertBefore(y,i.nextElementSibling):s.appendChild(y);var m=parseInt(Lu(y,a).height,10);s.removeChild(y),m===0&&(p=0)}p=Math.min(p,h),f.height=l==="auto"?"auto":"".concat(p,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:p>0,this.hasTableWidth=v>0}this.isTableVisible=hv(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,a=this.dataAccessObject.wtViewport,o="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!a.hasOversizedColumnHeadersMarked[o]){for(var u=i.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<l;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);a.hasOversizedColumnHeadersMarked[o]=!0}}}]),r}(Dg);mr(kH,Zae);mr(kH,xH);const m9e=kH;function Y0(e){return Y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y0(e)}function b9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_9e(n.key),n)}}function w9e(e,t,r){return t&&Cz(e.prototype,t),r&&Cz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _9e(e){var t=S9e(e,"string");return Y0(t)==="symbol"?t:String(t)}function S9e(e,t){if(Y0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Y0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C9e=function(){function e(t,r,n,i,a){var o=this;b9e(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=a,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){o.clientHeight=o.getWorkspaceHeight()})}return w9e(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var a=$r(n);i=a>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-s:c.left,d=s-h,v,p;if(u)return fr(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,s):v=Math.min(this.getContainerFillWidth(),d,s),o===a&&l>0&&this.sumColumnWidths(0,l-1)>v)return i.documentElement.clientWidth;if(o!==a&&(p=pv(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",a),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(v,o.clientWidth);var g=r.getSetting("stretchH");return g==="none"||!g?Math.max(v,fr(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,a=r;a<n;)i+=this.wtTable.getColumnWidth(a),a+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return tn(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=$r(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,a=n.length;i<a;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)o?(this.rowHeaderWidth+=fr(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bf,n=this.wtSettings,i=this.wtTable,a,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Bf?a=1/0:a=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,a-=s),f&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),a-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=Sn(this.domBindings.rootDocument),new Cae({viewportSize:a,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return i.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:o})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bf,n=this.wtSettings,i=this.wtTable,a=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&o>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=l,a-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(a-=Sn(this.domBindings.rootDocument)),new mH({viewportSize:a,scrollOffset:o,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return i.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(jn),a=this.createColumnsCalculator(jn);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(a)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Bf),this.columnsRenderCalculator=this.createColumnsCalculator(Bf)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(jn),this.columnsVisibleCalculator=this.createColumnsCalculator(jn)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.rowsRenderCalculator,s=o.startRow,l=o.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.columnsRenderCalculator,s=o.startColumn,l=o.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){At(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const x9e=C9e;function $v(e){return $v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$v(e)}function T9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E9e(n.key),n)}}function O9e(e,t,r){return t&&xz(e.prototype,t),r&&xz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E9e(e){var t=R9e(e,"string");return $v(t)==="symbol"?t:String(t)}function R9e(e,t){if($v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H2(e,t)}function H2(e,t){return H2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},H2(e,t)}function A9e(e){var t=I9e();return function(){var n=fT(e),i;if(t){var a=fT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return P9e(this,i)}}function P9e(e,t){if(t&&($v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B2(e)}function B2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fT(e){return fT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fT(e)}var M9e=function(e){k9e(r,e);var t=A9e(r);function r(n,i){var a;T9e(this,r),a=t.call(this,n,new l9e(i));var o=a.wtSettings.getSetting("facade",B2(a));return a.wtTable=new m9e(a.getTableDao(),o,a.domBindings,a.wtSettings),a.wtViewport=new x9e(a.getViewportDao(),a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.selections=a.wtSettings.getSetting("selections"),a.wtEvent=new Mae(o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections),a.wtOverlays=new i9e(B2(a),o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.exportSettingsAsClassNames(),a.findOriginalHeaders(),a}return O9e(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,a={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},o=[],s=[];At(a,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),o.push(l)}),wt(this.wtTable.wtRootElement.parentNode,o),ke(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(CH);function K0(e){return K0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K0(e)}function D9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N9e(n.key),n)}}function $9e(e,t,r){return t&&Tz(e.prototype,t),r&&Tz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N9e(e){var t=L9e(e,"string");return K0(t)==="symbol"?t:String(t)}function L9e(e,t){if(K0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var F9e=function(){function e(t){D9e(this,e),t instanceof CH?this._wot=t:this._initFromSettings(t)}return $9e(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new M9e(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wot.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,a,o){return this._wot.wtSettings.getSetting(r,n,i,a,o)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),H9e=an,loe=Pt,B9e=zw,V9e=aa,j9e=$w.f,W9e=loe(j9e),U9e=loe([].push),Oz=function(e){return function(t){for(var r=V9e(t),n=B9e(r),i=n.length,a=0,o=[],s;i>a;)s=n[a++],(!H9e||W9e(r,s))&&U9e(o,e?[s,r[s]]:r[s]);return o}},z9e={entries:Oz(!0),values:Oz(!1)},G9e=vt,Y9e=z9e.values;G9e({target:"Object",stat:!0},{values:function(t){return Y9e(t)}});function X0(e){return X0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X0(e)}function RA(e,t){return Z9e(e)||q9e(e,t)||X9e(e,t)||K9e()}function K9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X9e(e,t){if(e){if(typeof e=="string")return Ez(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ez(e,t)}}function Ez(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q9e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Z9e(e){if(Array.isArray(e))return e}function J9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e7e(n.key),n)}}function Q9e(e,t,r){return t&&Rz(e.prototype,t),r&&Rz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e7e(e){var t=t7e(e,"string");return X0(t)==="symbol"?t:String(t)}function t7e(e,t){if(X0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r7e=function(){function e(t,r){J9e(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Q9e(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[l])})},a=0,o=this.main.childNodes.length;a<o;a++)i(a)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),go(r);var i=this,a=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(a,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(a,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],a=this.main.style;a.position="absolute",a.top=0,a.left=0;for(var o=0;o<5;o++){var s=i[o],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),a=l.style,a.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,a.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),a.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),oo()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,a=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(a,"px"),width:"".concat(a,"px"),"border-radius":"".concat(parseInt(a/1.5,10),"px")};At(o,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};At(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,a,o,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,p=parseInt(c.borderWidth,10),g=parseInt(c.width,10),y=parseInt(h.width,10),m=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();c.top="".concat(parseInt(i-g-1,10),"px"),c[u]="".concat(parseInt(a-g-1,10),"px"),h.top="".concat(parseInt(i-y/4*3,10),"px"),h[u]="".concat(parseInt(a-y/4*3,10),"px");var _=Math.min(parseInt(a+o,10),m-g-p*2),x=Math.min(parseInt(a+o-y/4,10),m-y-p*2);d[u]="".concat(_,"px"),v[u]="".concat(x,"px");var T=Math.min(parseInt(i+s,10),b-g-p*2),E=Math.min(parseInt(i+s-y/4,10),b-y-p*2);d.top="".concat(T,"px"),v.top="".concat(E,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,a=n.rootDocument,o=n.rootWindow,s,l,u,f,c,h,d=i.getRenderedRowsCount(),v=0;v<d;v+=1){var p=i.rowFilter.renderedToSource(v);if(p>=r[0]&&p<=r[2]){s=p,c=r[0];break}}for(var g=d-1;g>=0;g-=1){var y=i.rowFilter.renderedToSource(g);if(y>=r[0]&&y<=r[2]){l=y;break}}for(var m=i.getRenderedColumnsCount(),b=0;b<m;b+=1){var _=i.columnFilter.renderedToSource(b);if(_>=r[1]&&_<=r[3]){u=_,h=r[1];break}}for(var x=m-1;x>=0;x-=1){var T=i.columnFilter.renderedToSource(x);if(T>=r[1]&&T<=r[3]){f=T;break}}if(s===void 0||u===void 0){this.disappear();return}var E=i.getCell(this.wot.createCellCoords(s,u)),P=s!==l||u!==f,R=P?i.getCell(this.wot.createCellCoords(l,f)):E,M=tn(E),D=P?tn(R):M,N=tn(i.TABLE),B=fr(i.TABLE),K=M.top,Z=M.left,ie=this.wot.wtSettings.getSetting("rtlMode"),me=0,k=0;if(ie){var w=fr(E),C=o.innerWidth-N.left-B;k=Z+w-D.left,me=o.innerWidth-Z-w-C-1}else k=D.left+fr(R)-Z,me=Z-N.left-1;if(this.isEntireColumnSelected(s,l)){var O=this.getDimensionsFromHeader("columns",u,f,c,N),S=null;if(O){var A=RA(O,3);S=A[0],me=A[1],k=A[2]}S&&(E=S)}var I=K-N.top-1,L=D.top+$r(R)-K;if(this.isEntireRowSelected(u,f)){var V=this.getDimensionsFromHeader("rows",s,l,h,N),Y=null;if(V){var ae=RA(V,3);Y=ae[0],I=ae[1],L=ae[2]}Y&&(E=Y)}var re=Lu(E,o);parseInt(re.borderTopWidth,10)>0&&(I+=1,L=L>0?L-1:0),parseInt(re[ie?"borderRightWidth":"borderLeftWidth"],10)>0&&(me+=1,k=k>0?k-1:0);var te=ie?"right":"left";this.topStyle.top="".concat(I,"px"),this.topStyle[te]="".concat(me,"px"),this.topStyle.width="".concat(k,"px"),this.topStyle.display="block",this.startStyle.top="".concat(I,"px"),this.startStyle[te]="".concat(me,"px"),this.startStyle.height="".concat(L,"px"),this.startStyle.display="block";var ge=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(I+L-ge,"px"),this.bottomStyle[te]="".concat(me,"px"),this.bottomStyle.width="".concat(k,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(I,"px"),this.endStyle[te]="".concat(me+k-ge,"px"),this.endStyle.height="".concat(L+1,"px"),this.endStyle.display="block";var H=this.settings.border.cornerVisible;H=typeof H=="function"?H(this.settings.layerLevel):H;var Ce=this.wot.getSetting("onModifyGetCellCoords",l,f),oe=l,Oe=f;if(Ce&&Array.isArray(Ce)){var Ee=RA(Ce,4);oe=Ee[2],Oe=Ee[3]}if(oo()||!H||this.isPartRange(oe,Oe))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(I+L+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[te]="".concat(me+k+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var be=vv(i.TABLE),Ie=be===o;Ie&&(be=a.documentElement);var Me=parseInt(this.cornerDefaultStyle.width,10)/2,j=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var U=Ie?R.getBoundingClientRect().left:R.offsetLeft,Q=!1,fe=0;ie?(fe=U-parseInt(this.cornerDefaultStyle.width,10)/2,Q=fe<0):(fe=U+fr(R)+parseInt(this.cornerDefaultStyle.width,10)/2,Q=fe>=Em(be)),Q&&(this.cornerStyle[te]="".concat(Math.floor(me+k+this.cornerCenterPointOffset-Me),"px"),this.cornerStyle[ie?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var ee=Ie?R.getBoundingClientRect().top:R.offsetTop,pe=ee+$r(R)+parseInt(this.cornerDefaultStyle.height,10)/2,se=pe>=Ps(be);se&&(this.cornerStyle.top="".concat(Math.floor(I+L+this.cornerCenterPointOffset-j),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}oo()&&this.updateMultipleSelectionHandlesPosition(l,f,I,me,k,L)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,a,o){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,p=null,g=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},f=function(){return $r.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},f=function(){return fr.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(l.classList.contains(c)){var y=this.wot.getSetting("columnHeaders").length;if(p=u(n,y-a),g=u(i,y-a),!p||!g)return!1;var m=tn(p),b=tn(g);return p&&g&&(h=m[v]-o[v]-1,d=b[v]+f(g)-m[v]),[p,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,a=n[r];!a||a.hide?ke(this[r],"hidden"):(mt(this[r],"hidden")&&wt(this[r],"hidden"),i.backgroundColor=a.color,(r==="top"||r==="bottom")&&(i.height="".concat(a.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(a.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?ke(this[r],"hidden"):wt(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",oo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const n7e=r7e;function i7e(e,t){return l7e(e)||s7e(e,t)||o7e(e,t)||a7e()}function a7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o7e(e,t){if(e){if(typeof e=="string")return kz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kz(e,t)}}function kz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function l7e(e){if(Array.isArray(e))return e}function Nv(e){return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}function u7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Az(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c7e(n.key),n)}}function f7e(e,t,r){return t&&Az(e.prototype,t),r&&Az(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c7e(e){var t=h7e(e,"string");return Nv(t)==="symbol"?t:String(t)}function h7e(e,t){if(Nv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d7e=function(){function e(t,r){u7e(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return f7e(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new n7e(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(Nv(s)==="object"){var l=a;o&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),ke(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||o===0)return r;var s=o>=0?o:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(mt(a,u)){var f=s+1;l="".concat(r,"-").concat(f)}else l=i(a,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),a=this.getCorners(),o=i7e(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,p=c.highlightOnlyClosestHeader,g=c.selectionType,y=g===void 0||["active-header","header"].includes(g);if(y&&l!==null&&f!==null)for(var m=0,b=0;b<i;b+=1){var _=r.wtTable.columnFilter.renderedToSource(b);if(_>=l&&_<=f){var x=r.wtTable.getColumnHeaders(_),T=x.length-1;p&&x.length>1&&(x=[x[T]]);for(var E=0;E<x.length;E+=1){var P=[],R=x[E];h&&P.push(h),d&&P.push(d),E=p?T:E;var M=r.getSetting("onBeforeHighlightingColumnHeader",_,E,{selectionType:g,columnCursor:m,selectionWidth:f-l+1,classNames:P});M!==_&&(R=r.wtTable.getColumnHeader(M,E)),ke(R,P)}m+=1}}if(s!==null&&u!==null)for(var D=0,N=0;N<n;N+=1){var B=r.wtTable.rowFilter.renderedToSource(N);if(y&&B>=s&&B<=u){var K=r.wtTable.getRowHeaders(B),Z=K.length-1;p&&K.length>1&&(K=[K[Z]]);for(var ie=0;ie<K.length;ie+=1){var me=[],k=K[ie];h&&me.push(h),v&&me.push(v),ie=p?Z:ie;var w=r.getSetting("onBeforeHighlightingRowHeader",B,ie,{selectionType:g,rowCursor:D,selectionHeight:u-s+1,classNames:me});w!==B&&(k=r.wtTable.getRowHeader(w,ie)),ke(k,me)}D+=1}if(l!==null&&f!==null)for(var C=0;C<i;C+=1){var O=r.wtTable.columnFilter.renderedToSource(C);B>=s&&B<=u&&O>=l&&O<=f?this.settings.className&&this.addClassAtCoords(r,B,O,this.settings.className,this.settings.markIntersections):B>=s&&B<=u?v&&this.addClassAtCoords(r,B,O,v):O>=l&&O<=f&&d&&this.addClassAtCoords(r,B,O,d);var S=r.getSetting("onAfterDrawSelection",B,O,this.settings.layerLevel);typeof S=="string"&&this.addClassAtCoords(r,B,O,S)}}r.getSetting("onBeforeDrawBorders",a,this.settings.className),this.settings.border&&this.getBorder(r).appear(a)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const v7e=d7e;function Pz(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,a=e.selection,o=e.controller,s=e.cellCoordsFactory,l=a.isSelected()?a.getSelectedRange().current():null,u=a.isSelectedByCorner(),f=a.isSelectedByRowHeader();if(t&&l)i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(i):(u||f)&&i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!o.column?a.setRangeEnd(s(l.to.row,i.col)):f&&i.col<0&&!o.row?a.setRangeEnd(s(i.row,l.to.col)):(!u&&!f&&i.col<0||u&&i.col<0)&&!o.row?a.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!f&&i.row<0||f&&i.row<0)&&!o.column&&a.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var c=!a.inInSelection(i),h=r||n&&c;i.row<0&&i.col>=0&&!o.column?h&&a.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?h&&a.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?h&&a.setRangeStart(i):i.col<0&&i.row<0&&a.selectAll(!0,!0)}}function p7e(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,a=e.cellCoordsFactory;if(t){var o=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(a(u-1,r.col)):o&&!i.row?n.setRangeEnd(a(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var g7e=new Map([["mousedown",Pz],["mouseover",p7e],["touchstart",Pz]]);function Iz(e,t){var r=t.coords,n=t.selection,i=t.controller,a=t.cellCoordsFactory;g7e.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:a,isShiftKey:e.shiftKey,isLeftClick:hE(e)||e.type==="touchstart",isRightClick:Fu(e)})}var uoe=new WeakMap,AH=Symbol("rootInstance");function y7e(e){uoe.set(e,!0)}function m7e(e){return e===AH}function V2(e){return uoe.has(e)}function q0(e){return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(e)}function Cy(e,t){return _7e(e)||w7e(e,t)||foe(e,t)||b7e()}function b7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function _7e(e){if(Array.isArray(e))return e}function Mz(e){return x7e(e)||C7e(e)||foe(e)||S7e()}function S7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function foe(e,t){if(e){if(typeof e=="string")return j2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j2(e,t)}}function C7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function x7e(e){if(Array.isArray(e))return j2(e)}function j2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,coe(n.key),n)}}function O7e(e,t,r){return t&&Dz(e.prototype,t),r&&Dz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $z(e,t,r){E7e(e,t),t.set(e,r)}function E7e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(e,t,r){return t=coe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function coe(e){var t=R7e(e,"string");return q0(t)==="symbol"?t:String(t)}function R7e(e,t){if(q0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nz(e,t){var r=hoe(e,t,"get");return k7e(e,r)}function k7e(e,t){return t.get?t.get.call(e):t.value}function Lz(e,t,r){var n=hoe(e,t,"set");return A7e(e,n,r),r}function hoe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function A7e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Tf=new WeakMap,kA=new WeakMap,AA=new WeakMap,P7e=function(){function e(t){T7e(this,e),Ll(this,"instance",void 0),Ll(this,"eventManager",void 0),Ll(this,"settings",void 0),Ll(this,"THEAD",void 0),Ll(this,"TBODY",void 0),Ll(this,"_wt",void 0),Ll(this,"activeWt",void 0),$z(this,kA,{writable:!0,value:0}),$z(this,AA,{writable:!0,value:0}),Ll(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Nr(this.instance),this.settings=this.instance.getSettings(),Tf.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return O7e(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wt.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=Tf.get(this),n=this.instance,i=n.rootElement,a=n.rootDocument,o=i.getAttribute("style");o&&i.setAttribute("data-originalstyle",o),ke(i,"handsontable"),r.table=a.createElement("TABLE"),ke(r.table,"htCore"),this.instance.getSettings().tableClassName&&ke(r.table,this.instance.getSettings().tableClassName),this.THEAD=a.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=a.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Tf.get(this),i=this.instance,a=i.rootElement,o=i.rootDocument,s=i.selection,l=o.documentElement;this.eventManager.addEventListener(a,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;a2(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(a,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(a,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&a2(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&hE(u)&&s.finish(),n.mouseDown=!1,(cE(o.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!a.contains(u.target)&&!Fu(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&Fu(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!a||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var p=Sn(o);if(o.elementFromPoint(c+p,h)!==v||o.elementFromPoint(c,h+p)!==v)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===a)return;d=d.parentNode}var g=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;g?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||_0(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,a=r.col;return(n=this.instance)._createCellCoords.apply(n,Mz(this.translateFromRenderableToVisualIndex(i,a)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,a=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),a===null&&(a=n),[i,a]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),a=r.getNearestNotHiddenIndex(i-1,-1);return a===null?0:r.getRenderableFromVisualIndex(a)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,a){if(isNaN(r)||r<0)return 0;var o=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=a-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Tf.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return V2(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,Mz(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),Lz(r,AA,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),Lz(r,kA,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=Cy(d,2),p=v[0],g=v[1],y=r.instance.runHooks("modifyGetCellCoords",p,g),m=p,b=g;if(Array.isArray(y)){var _=Cy(y,2);m=_[0],b=_[1]}var x=r.instance.getCellMeta(m,b),T=r.instance.colToProp(b),E=r.instance.getDataAtRowProp(m,T);r.instance.hasHook("beforeValueRender")&&(E=r.instance.runHooks("beforeValueRender",E,x)),r.instance.runHooks("beforeRenderer",h,p,g,T,E,x),r.instance.getCellRenderer(x)(r.instance,h,p,g,T,E,x),r.instance.runHooks("afterRenderer",h,p,g,T,E,x)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,p),!Hf(f)&&(Iz(f,{coords:v,selection:r.instance.selection,controller:p,cellCoordsFactory:function(y,m){return r.instance._createCellCoords(y,m)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!Hf(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!Hf(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,p),!Hf(f)&&(n.mouseDown&&Iz(f,{coords:v,selection:r.instance.selection,controller:p,cellCoordsFactory:function(y,m){return r.instance._createCellCoords(y,m)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!(Hf(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),p=Cy(v,2),g=p[0],y=p[1],m=r.instance.selection.getSelectedRange(),b=m.size();if(b>0){var _=(h??0)+1-b,x=m.peekByIndex(_);d=[x.from.row,x.from.col,x.to.row,x.to.col]}return r.instance.runHooks("afterDrawSelection",g,y,d,h)},onBeforeDrawBorders:function(f,c){var h=Cy(f,4),d=h[0],v=h[1],p=h[2],g=h[3],y=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(p),r.instance.columnIndexMapper.getVisualFromRenderableIndex(g)];return r.instance.runHooks("beforeDrawBorders",y,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,p=c>=0?v.getVisualFromRenderableIndex(c):c,g=f>=0?d.getVisualFromRenderableIndex(f):f,y=r.instance.runHooks("modifyGetCellCoords",g,p,h);if(Array.isArray(y)){var m=Cy(y,4),b=m[0],_=m[1],x=m[2],T=m[3];return[b>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(b,1)):b,_>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(_,1)):_,x>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(x,-1)):x,T>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(T,-1)):T]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var p=Math.ceil(v/h*12);f.startRow=Math.max(d-p,0),f.endRow=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var p=Math.ceil(v/h*6);f.startColumn=Math.max(d-p,0),f.endColumn=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new F9e(i),this.activeWt=this._wt;var a=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),s=o.width,l=o.height;this.setLastSize(s,l),this.eventManager.addEventListener(a,"mousedown",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(a,"contextmenu",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(_0(r))return!0;var n=gu(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Tf.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!mt(i,"relative")){po(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var a=this.instance,o=a.rootDocument,s=a.getRowHeader,l=o.createElement("div"),u=o.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var o=n.firstChild;mt(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),r,i,a):(po(n),this.appendColHeader(r,n,i,a))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,a),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,a)}},{key:"updateCellHeader",value:function(r,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(mt(r,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):mt(r,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?fh(r,i(n,a)):(Nu(r,String.fromCharCode(160)),ke(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=Tf.get(this),a=[r,n];i.lastWidth=a[0],i.lastHeight=a[1]}},{key:"getLastSize",value:function(){var r=Tf.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Nz(this,kA)}},{key:"getRowHeadersCount",value:function(){return Nz(this,AA)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const I7e=P7e;function W2(e){return W2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W2(e)}var doe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",U2=doe.length;function pE(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%U2,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/U2,10);return r}function M7e(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(U2,n)*(doe.indexOf(e[r])+1);return t-=1,t}function D7e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a=[];for(i=0;i<t;i++)a.push(pE(i)+(n+1));r.push(a)}return r}function $7e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a={};for(i=0;i<t;i++)a["prop".concat(i)]=pE(i)+(n+1);r.push(a)}return r}function N7e(e,t){for(var r=[],n,i=0;i<e;i++){n=[];for(var a=0;a<t;a++)n.push("");r.push(n)}return r}function z2(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(i,a){Array.isArray(i)?i.forEach(function(o,s){n.push([a+t,s,o])}):Object.keys(i).forEach(function(o){n.push([a+t,o,i[o]])})}),n}function PH(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&kt(e[0])&&(t=qO(e[0]))),t}function voe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function poe(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return W2(t)==="object"&&!Array.isArray(t)&&t!==null}))}const L7e=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:PH,createEmptySpreadsheetData:N7e,createSpreadsheetData:D7e,createSpreadsheetObjectData:$7e,dataRowToChangesArray:z2,isArrayOfArrays:voe,isArrayOfObjects:poe,spreadsheetColumnIndex:M7e,spreadsheetColumnLabel:pE},Symbol.toStringTag,{value:"Module"}));function Z0(e){return Z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z0(e)}function F7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B7e(n.key),n)}}function H7e(e,t,r){return t&&Fz(e.prototype,t),r&&Fz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B7e(e){var t=V7e(e,"string");return Z0(t)==="symbol"?t:String(t)}function V7e(e,t){if(Z0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j7e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];F7e(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return H7e(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return ne(this.data,function(a,o){var s=n.getAtCell(o,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=a.getAtPhysicalCell(r,d,l)}):rt(n,i,function(h){u[h-n]=a.getAtPhysicalCell(r,h,l)});else if(kt(l)||wr(l))if(o?u=[]:u={},!s||o){var f=0,c=this.countFirstRowKeys()-1;rt(f,c,function(h){var d=a.colToProp(h);if(h>=(n||f)&&h<=(i||c)&&!Number.isInteger(d)){var v=a.getAtPhysicalCell(r,d,l);o?u.push(v):rC(u,d,v)}})}else At(l,function(h,d){rC(u,d,a.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var a=$c(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),a,"set"),a.isTouched()&&(i=a.value)}Number.isInteger(n)?this.data[r][n]=i:rC(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var a=null;if(i&&(typeof n=="string"?a=Ane(i,n):typeof n=="function"?a=n(i):a=i[n]),this.hot.hasHook("modifySourceData")){var o=$c(a);this.hot.runHooks("modifySourceData",r,this.colToProp(n),o,"get"),o.isTouched()&&(a=o.value)}return a}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=null,l=null,u=null,f=null;n===null||i===null?(o=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),f=Math.max(n.col,i.col));var c=[];return rt(s,u,function(h){c.push(o?r.getAtRow(h,void 0,void 0,a):r.getAtRow(h,l,f,a))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return PH(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const W7e=j7e;var Hz=jr,U7e=function(e){return e!==void 0&&(Hz(e,"value")||Hz(e,"writable"))},z7e=vt,G7e=gn,Y7e=on,K7e=Kr,X7e=U7e,q7e=ns,Z7e=BO;function goe(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(K7e(e)===r)return e[t];if(n=q7e.f(e,t),n)return X7e(n)?n.value:n.get===void 0?void 0:G7e(n.get,r);if(Y7e(i=Z7e(e)))return goe(i,t,r)}z7e({target:"Reflect",stat:!0},{get:goe});var J7e=vt,Q7e=Ct,eYe=aa,yoe=ns.f,moe=an,tYe=!moe||Q7e(function(){yoe(1)});J7e({target:"Object",stat:!0,forced:tYe,sham:!moe},{getOwnPropertyDescriptor:function(t,r){return yoe(eYe(t),r)}});var rYe="localHooks",boe={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,a,o,s){if(this._localHooks[t])for(var l=this._localHooks[t].length,u=0;u<l;u++)Dx(this._localHooks[t][u],this,r,n,i,a,o,s)},clearLocalHooks:function(){return this._localHooks={},this}};as(boe,"MIXIN_NAME",rYe,{writable:!1,enumerable:!1});const Bi=boe;function J0(e){return J0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J0(e)}function nYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aYe(n.key),n)}}function iYe(e,t,r){return t&&Bz(e.prototype,t),r&&Bz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aYe(e){var t=oYe(e,"string");return J0(t)==="symbol"?t:String(t)}function oYe(e,t){if(J0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(J0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ch=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;nYe(this,e),this.indexedValues=[],this.initValueOrFn=t}return iYe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wr(this.initValueOrFn)?rt(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):rt(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();mr(ch,Bi);function PA(e){return fYe(e)||uYe(e)||lYe(e)||sYe()}function sYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lYe(e,t){if(e){if(typeof e=="string")return G2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G2(e,t)}}function uYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fYe(e){if(Array.isArray(e))return G2(e)}function G2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IH(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(PA(e.slice(0,i)),PA(r.map(function(a,o){return wr(n)?n(a,o):n})),PA(i===void 0?[]:e.slice(i)))}function MH(e,t){return ra(e,function(r,n){return t.includes(n)===!1})}function Lv(e){return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(e)}function cYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dYe(n.key),n)}}function hYe(e,t,r){return t&&Vz(e.prototype,t),r&&Vz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dYe(e){var t=vYe(e,"string");return Lv(t)==="symbol"?t:String(t)}function vYe(e,t){if(Lv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function km(){return typeof Reflect<"u"&&Reflect.get?km=Reflect.get.bind():km=function(t,r,n){var i=pYe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},km.apply(this,arguments)}function pYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bc(e),e!==null););return e}function gYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y2(e,t)}function Y2(e,t){return Y2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Y2(e,t)}function yYe(e){var t=wYe();return function(){var n=Bc(e),i;if(t){var a=Bc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mYe(this,i)}}function mYe(e,t){if(t&&(Lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bYe(e)}function bYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bc(e){return Bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bc(e)}var zu=function(e){gYe(r,e);var t=yYe(r);function r(){return cYe(this,r),t.apply(this,arguments)}return hYe(r,[{key:"insert",value:function(i,a){this.indexedValues=IH(this.indexedValues,i,a,this.initValueOrFn),km(Bc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=MH(this.indexedValues,i),km(Bc(r.prototype),"remove",this).call(this,i)}}]),r}(ch);function Fv(e){return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(e)}function _Ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CYe(n.key),n)}}function SYe(e,t,r){return t&&jz(e.prototype,t),r&&jz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CYe(e){var t=xYe(e,"string");return Fv(t)==="symbol"?t:String(t)}function xYe(e,t){if(Fv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K2(e,t)}function K2(e,t){return K2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},K2(e,t)}function OYe(e){var t=kYe();return function(){var n=cT(e),i;if(t){var a=cT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return EYe(this,i)}}function EYe(e,t){if(t&&(Fv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RYe(e)}function RYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cT(e){return cT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cT(e)}var gE=function(e){TYe(r,e);var t=OYe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return _Ye(this,r),t.call(this,n)}return SYe(r,[{key:"getHiddenIndexes",value:function(){return Xr(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}(zu);function IA(e){return MYe(e)||IYe(e)||PYe(e)||AYe()}function AYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PYe(e,t){if(e){if(typeof e=="string")return X2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X2(e,t)}}function IYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MYe(e){if(Array.isArray(e))return X2(e)}function X2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DH(e,t,r){return[].concat(IA(e.slice(0,t)),IA(r),IA(e.slice(t)))}function Q0(e,t){return ra(e,function(r){return t.includes(r)===!1})}function $H(e,t){return Rt(e,function(r){return r-t.filter(function(n){return n<r}).length})}function NH(e,t){var r=t[0],n=t.length;return Rt(e,function(i){return i>=r?i+n:i})}function Hv(e){return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(e)}function DYe(e){return FYe(e)||LYe(e)||NYe(e)||$Ye()}function $Ye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NYe(e,t){if(e){if(typeof e=="string")return q2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q2(e,t)}}function LYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FYe(e){if(Array.isArray(e))return q2(e)}function q2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_oe(n.key),n)}}function BYe(e,t,r){return t&&Wz(e.prototype,t),r&&Wz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xs(){return typeof Reflect<"u"&&Reflect.get?xs=Reflect.get.bind():xs=function(t,r,n){var i=VYe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},xs.apply(this,arguments)}function VYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ro(e),e!==null););return e}function jYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z2(e,t)}function Z2(e,t){return Z2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Z2(e,t)}function WYe(e){var t=zYe();return function(){var n=ro(e),i;if(t){var a=ro(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return UYe(this,i)}}function UYe(e,t){if(t&&(Hv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return woe(e)}function woe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ro(e){return ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ro(e)}function GYe(e,t,r){return t=_oe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _oe(e){var t=YYe(e,"string");return Hv(t)==="symbol"?t:String(t)}function YYe(e,t){if(Hv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yE=function(e){jYe(r,e);var t=WYe(r);function r(){var n;HYe(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),GYe(woe(n),"orderOfIndexes",[]),n}return BYe(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return i.indexedValues[a]})}},{key:"setValues",value:function(i){this.orderOfIndexes=DYe(Array(i.length).keys()),xs(ro(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=a,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(o,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=Q0(this.orderOfIndexes,[i]),wr(this.initValueOrFn)?xs(ro(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):xs(ro(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,xs(ro(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,a){this.indexedValues=IH(this.indexedValues,i,a,this.initValueOrFn),this.orderOfIndexes=NH(this.orderOfIndexes,a),xs(ro(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=MH(this.indexedValues,i),this.orderOfIndexes=Q0(this.orderOfIndexes,i),this.orderOfIndexes=$H(this.orderOfIndexes,i),xs(ro(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return[a,i.getValueAtIndex(a)]})}}]),r}(ch);function Bv(e){return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bv(e)}function KYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qYe(n.key),n)}}function XYe(e,t,r){return t&&Uz(e.prototype,t),r&&Uz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qYe(e){var t=ZYe(e,"string");return Bv(t)==="symbol"?t:String(t)}function ZYe(e,t){if(Bv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J2(e,t)}function J2(e,t){return J2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},J2(e,t)}function QYe(e){var t=rKe();return function(){var n=hT(e),i;if(t){var a=hT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return eKe(this,i)}}function eKe(e,t){if(t&&(Bv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tKe(e)}function tKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hT(e){return hT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hT(e)}var g_=function(e){JYe(r,e);var t=QYe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return KYe(this,r),t.call(this,n)}return XYe(r,[{key:"getTrimmedIndexes",value:function(){return Xr(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}(zu),zz=new Map([["indexesSequence",{getListWithInsertedItems:DH,getListWithRemovedItems:Q0}],["physicallyIndexed",{getListWithInsertedItems:IH,getListWithRemovedItems:MH}]]),Soe=function(t){if(zz.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return zz.get(t)};function Vv(e){return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function nKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aKe(n.key),n)}}function iKe(e,t,r){return t&&Gz(e.prototype,t),r&&Gz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aKe(e){var t=oKe(e,"string");return Vv(t)==="symbol"?t:String(t)}function oKe(e,t){if(Vv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Am(){return typeof Reflect<"u"&&Reflect.get?Am=Reflect.get.bind():Am=function(t,r,n){var i=sKe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Am.apply(this,arguments)}function sKe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vc(e),e!==null););return e}function lKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q2(e,t)}function Q2(e,t){return Q2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Q2(e,t)}function uKe(e){var t=hKe();return function(){var n=Vc(e),i;if(t){var a=Vc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return fKe(this,i)}}function fKe(e,t){if(t&&(Vv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cKe(e)}function cKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vc(e){return Vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vc(e)}var Coe=function(e){lKe(r,e);var t=uKe(r);function r(){return nKe(this,r),t.call(this,function(n){return n})}return iKe(r,[{key:"insert",value:function(i,a){var o=NH(this.indexedValues,a);this.indexedValues=DH(o,i,a),Am(Vc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=Q0(this.indexedValues,i);this.indexedValues=$H(a,i),Am(Vc(r.prototype),"remove",this).call(this,i)}}]),r}(ch),Yz=new Map([["hiding",gE],["index",ch],["linkedPhysicalIndexToValue",yE],["physicalIndexToValue",zu],["trimming",g_]]);function dKe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Yz.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(Yz.get(e))(t)}function eb(e){return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function vKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gKe(n.key),n)}}function pKe(e,t,r){return t&&Kz(e.prototype,t),r&&Kz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gKe(e){var t=yKe(e,"string");return eb(t)==="symbol"?t:String(t)}function yKe(e,t){if(eb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eD=0,LH=function(){function e(){vKe(this,e),this.collection=new Map}return pKe(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}),eD+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);Xe(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),eD-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return pr(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();mr(LH,Bi);function mKe(){return eD}function jv(e){return jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jv(e)}function bKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ke(n.key),n)}}function wKe(e,t,r){return t&&Xz(e.prototype,t),r&&Xz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ke(e){var t=SKe(e,"string");return jv(t)==="symbol"?t:String(t)}function SKe(e,t){if(jv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tD(e,t)}function tD(e,t){return tD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tD(e,t)}function xKe(e){var t=EKe();return function(){var n=dT(e),i;if(t){var a=dT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return TKe(this,i)}}function TKe(e,t){if(t&&(jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OKe(e)}function OKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dT(e){return dT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dT(e)}var qz=function(e){CKe(r,e);var t=xKe(r);function r(n,i){var a;return bKe(this,r),a=t.call(this),a.mergedValuesCache=[],a.aggregationFunction=n,a.fallbackValue=i,a}return wKe(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var a=Rt(this.get(),function(c){return c.getValues()}),o=[],s=Xe(a[0])&&a[0].length||0,l=0;l<s;l+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(a[f][l]);o.push(u)}return Rt(o,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,a){var o=this.getMergedValues(a)[i];return Xe(o)?o:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(LH);function tb(e){return tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tb(e)}function RKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AKe(n.key),n)}}function kKe(e,t,r){return t&&Zz(e.prototype,t),r&&Zz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AKe(e){var t=PKe(e,"string");return tb(t)==="symbol"?t:String(t)}function PKe(e,t){if(tb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IKe(e,t,r){MKe(e,t),t.set(e,r)}function MKe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DKe(e,t,r){var n=xoe(e,t,"set");return $Ke(e,n,r),r}function $Ke(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function NKe(e,t){var r=xoe(e,t,"get");return LKe(e,r)}function xoe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function LKe(e,t){return t.get?t.get.call(e):t.value}var MA=new WeakMap,Toe=function(){function e(){RKe(this,e),IKe(this,MA,{writable:!0,value:[]})}return kKe(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(NKe(this,MA)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){DKe(this,MA,r)}}]),e}();mr(Toe,Bi);function Jz(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function rb(e){return rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rb(e)}function FKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BKe(n.key),n)}}function HKe(e,t,r){return t&&Qz(e.prototype,t),r&&Qz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BKe(e){var t=VKe(e,"string");return rb(t)==="symbol"?t:String(t)}function VKe(e,t){if(rb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xy(e,t,r){jKe(e,t),t.set(e,r)}function jKe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fa(e,t){var r=Ooe(e,t,"get");return WKe(e,r)}function WKe(e,t){return t.get?t.get.call(e):t.value}function zS(e,t,r){var n=Ooe(e,t,"set");return UKe(e,n,r),r}function Ooe(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function UKe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var GS=new WeakMap,Ty=new WeakMap,YS=new WeakMap,KS=new WeakMap,XS=new WeakMap,zKe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;FKe(this,e),xy(this,GS,{writable:!0,value:new Set}),xy(this,Ty,{writable:!0,value:[]}),xy(this,YS,{writable:!0,value:[]}),xy(this,KS,{writable:!0,value:!1}),xy(this,XS,{writable:!0,value:!1}),zS(this,XS,r??!1)}return HKe(e,[{key:"createObserver",value:function(){var r=this,n=new Toe;return fa(this,GS).add(n),n.addLocalHook("unsubscribe",function(){fa(r,GS).delete(n)}),n._writeInitialChanges(Jz(fa(this,Ty),fa(this,YS))),n}},{key:"emit",value:function(r){var n=fa(this,YS);(!fa(this,KS)||fa(this,Ty).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(fa(this,XS)):zS(this,Ty,new Array(r.length).fill(fa(this,XS))),fa(this,KS)||(zS(this,KS,!0),n=fa(this,Ty)));var i=Jz(n,r);fa(this,GS).forEach(function(a){return a._write(i)}),zS(this,YS,r)}}]),e}();function nb(e){return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}var eG;function DA(e){return XKe(e)||KKe(e)||YKe(e)||GKe()}function GKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YKe(e,t){if(e){if(typeof e=="string")return rD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rD(e,t)}}function KKe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XKe(e){if(Array.isArray(e))return rD(e)}function rD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qKe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function ZKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QKe(n.key),n)}}function JKe(e,t,r){return t&&tG(e.prototype,t),r&&tG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QKe(e){var t=eXe(e,"string");return nb(t)==="symbol"?t:String(t)}function eXe(e,t){if(nb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rG=new Set(["getFirstNotHiddenIndex"]),nD=function(){function e(){var t=this;ZKe(this,e),this.indexesSequence=new Coe,this.trimmingMapsCollection=new qz(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new qz(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new LH,this.hidingChangesObservable=new zKe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return JKe(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,dKe(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof g_?this.trimmingMapsCollection.register(r,n):n instanceof gE?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return Xe(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return Xe(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return Xe(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return Xe(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;rG.has("getFirstNotHiddenIndex")&&(rG.delete("getFirstNotHiddenIndex"),gr(sr(eG||(eG=qKe([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var o=this.getPhysicalFromVisualIndex(r);return o===null?i===!0&&a!==r-n?this.getFirstNotHiddenIndex(a,-n,!1,a):null:this.isHidden(o)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,a)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.getPhysicalFromVisualIndex(r);if(a===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=o.findIndex(function(l){return l>r}):s=o.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:o[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=DA(new Array(r).keys()),this.notHiddenIndexesCache=DA(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=DA(Array(this.getNumberOfIndexes()-r).keys()).map(function(a){return a+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isTrimmed(a)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var a=Rt(r,function(c){return i.getPhysicalFromVisualIndex(c)}),o=this.getNotTrimmedIndexesLength(),s=r.length,l=Q0(this.getIndexesSequence(),a),u=o-s;if(n+s<o){var f=l.filter(function(c){return i.isTrimmed(c)===!1})[n];u=l.indexOf(f)}this.setIndexesSequence(DH(l,u,a))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],a=Xe(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=Rt(new Array(n).fill(a),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(o,s),this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),a=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(a,n)}}}]),e}();mr(nD,Bi);var nG;function tXe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function rXe(e,t){return At(t,function(r,n){pr(e[n])&&(e[n]=r)}),e}function Eoe(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function Roe(e){Xe(e)&&hH(sr(nG||(nG=tXe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function nXe(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var koe=Ha("phraseFormatters"),iXe=koe.register,aXe=koe.getValues;function oXe(e,t){iXe(e,t)}function sXe(){return aXe()}oXe("pluralize",nXe);var Aoe="ContextMenu:items",xt=Aoe,FH="".concat(xt,".noItems"),HH="".concat(xt,".insertRowAbove"),BH="".concat(xt,".insertRowBelow"),VH="".concat(xt,".insertColumnOnTheLeft"),jH="".concat(xt,".insertColumnOnTheRight"),WH="".concat(xt,".removeRow"),UH="".concat(xt,".removeColumn"),zH="".concat(xt,".undo"),GH="".concat(xt,".redo"),YH="".concat(xt,".readOnly"),KH="".concat(xt,".clearColumn"),XH="".concat(xt,".copy"),qH="".concat(xt,".copyWithHeaders"),ZH="".concat(xt,".copyWithGroupHeaders"),JH="".concat(xt,".copyHeadersOnly"),QH="".concat(xt,".cut"),eB="".concat(xt,".freezeColumn"),tB="".concat(xt,".unfreezeColumn"),rB="".concat(xt,".mergeCells"),nB="".concat(xt,".unmergeCells"),iB="".concat(xt,".addComment"),aB="".concat(xt,".editComment"),oB="".concat(xt,".removeComment"),sB="".concat(xt,".readOnlyComment"),lB="".concat(xt,".align"),uB="".concat(xt,".align.left"),fB="".concat(xt,".align.center"),cB="".concat(xt,".align.right"),hB="".concat(xt,".align.justify"),dB="".concat(xt,".align.top"),vB="".concat(xt,".align.middle"),pB="".concat(xt,".align.bottom"),gB="".concat(xt,".borders"),yB="".concat(xt,".borders.top"),mB="".concat(xt,".borders.right"),bB="".concat(xt,".borders.bottom"),wB="".concat(xt,".borders.left"),_B="".concat(xt,".borders.remove"),SB="".concat(xt,".nestedHeaders.insertChildRow"),CB="".concat(xt,".nestedHeaders.detachFromParent"),xB="".concat(xt,".hideColumn"),TB="".concat(xt,".showColumn"),OB="".concat(xt,".hideRow"),EB="".concat(xt,".showRow"),Ci="Filters:",Wr="".concat(Ci,"conditions"),mE="".concat(Wr,".none"),RB="".concat(Wr,".isEmpty"),kB="".concat(Wr,".isNotEmpty"),AB="".concat(Wr,".isEqualTo"),PB="".concat(Wr,".isNotEqualTo"),IB="".concat(Wr,".beginsWith"),MB="".concat(Wr,".endsWith"),DB="".concat(Wr,".contains"),$B="".concat(Wr,".doesNotContain"),lXe="".concat(Wr,".byValue"),NB="".concat(Wr,".greaterThan"),LB="".concat(Wr,".greaterThanOrEqualTo"),FB="".concat(Wr,".lessThan"),HB="".concat(Wr,".lessThanOrEqualTo"),BB="".concat(Wr,".isBetween"),VB="".concat(Wr,".isNotBetween"),jB="".concat(Wr,".after"),WB="".concat(Wr,".before"),UB="".concat(Wr,".today"),zB="".concat(Wr,".tomorrow"),GB="".concat(Wr,".yesterday"),YB="".concat(Ci,"labels.filterByCondition"),KB="".concat(Ci,"labels.filterByValue"),XB="".concat(Ci,"labels.conjunction"),bE="".concat(Ci,"labels.disjunction"),vT="".concat(Ci,"values.blankCells"),qB="".concat(Ci,"buttons.selectAll"),ZB="".concat(Ci,"buttons.clear"),JB="".concat(Ci,"buttons.ok"),QB="".concat(Ci,"buttons.cancel"),e3="".concat(Ci,"buttons.placeholder.search"),t3="".concat(Ci,"buttons.placeholder.value"),r3="".concat(Ci,"buttons.placeholder.secondValue");const uXe=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:iB,CONTEXTMENU_ITEMS_ALIGNMENT:lB,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:pB,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:fB,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:hB,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:uB,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:vB,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:cB,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:dB,CONTEXTMENU_ITEMS_BORDERS:gB,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:bB,CONTEXTMENU_ITEMS_BORDERS_LEFT:wB,CONTEXTMENU_ITEMS_BORDERS_RIGHT:mB,CONTEXTMENU_ITEMS_BORDERS_TOP:yB,CONTEXTMENU_ITEMS_CLEAR_COLUMN:KH,CONTEXTMENU_ITEMS_COPY:XH,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:JH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:ZH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:qH,CONTEXTMENU_ITEMS_CUT:QH,CONTEXTMENU_ITEMS_EDIT_COMMENT:aB,CONTEXTMENU_ITEMS_FREEZE_COLUMN:eB,CONTEXTMENU_ITEMS_HIDE_COLUMN:xB,CONTEXTMENU_ITEMS_HIDE_ROW:OB,CONTEXTMENU_ITEMS_INSERT_LEFT:VH,CONTEXTMENU_ITEMS_INSERT_RIGHT:jH,CONTEXTMENU_ITEMS_MERGE_CELLS:rB,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:CB,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:SB,CONTEXTMENU_ITEMS_NO_ITEMS:FH,CONTEXTMENU_ITEMS_READ_ONLY:YH,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:sB,CONTEXTMENU_ITEMS_REDO:GH,CONTEXTMENU_ITEMS_REMOVE_BORDERS:_B,CONTEXTMENU_ITEMS_REMOVE_COLUMN:UH,CONTEXTMENU_ITEMS_REMOVE_COMMENT:oB,CONTEXTMENU_ITEMS_REMOVE_ROW:WH,CONTEXTMENU_ITEMS_ROW_ABOVE:HH,CONTEXTMENU_ITEMS_ROW_BELOW:BH,CONTEXTMENU_ITEMS_SHOW_COLUMN:TB,CONTEXTMENU_ITEMS_SHOW_ROW:EB,CONTEXTMENU_ITEMS_UNDO:zH,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:tB,CONTEXTMENU_ITEMS_UNMERGE_CELLS:nB,CONTEXT_MENU_ITEMS_NAMESPACE:Aoe,FILTERS_BUTTONS_CANCEL:QB,FILTERS_BUTTONS_CLEAR:ZB,FILTERS_BUTTONS_OK:JB,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:e3,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:r3,FILTERS_BUTTONS_PLACEHOLDER_VALUE:t3,FILTERS_BUTTONS_SELECT_ALL:qB,FILTERS_CONDITIONS_AFTER:jB,FILTERS_CONDITIONS_BEFORE:WB,FILTERS_CONDITIONS_BEGINS_WITH:IB,FILTERS_CONDITIONS_BETWEEN:BB,FILTERS_CONDITIONS_BY_VALUE:lXe,FILTERS_CONDITIONS_CONTAINS:DB,FILTERS_CONDITIONS_EMPTY:RB,FILTERS_CONDITIONS_ENDS_WITH:MB,FILTERS_CONDITIONS_EQUAL:AB,FILTERS_CONDITIONS_GREATER_THAN:NB,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:LB,FILTERS_CONDITIONS_LESS_THAN:FB,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:HB,FILTERS_CONDITIONS_NAMESPACE:Wr,FILTERS_CONDITIONS_NONE:mE,FILTERS_CONDITIONS_NOT_BETWEEN:VB,FILTERS_CONDITIONS_NOT_CONTAIN:$B,FILTERS_CONDITIONS_NOT_EMPTY:kB,FILTERS_CONDITIONS_NOT_EQUAL:PB,FILTERS_CONDITIONS_TODAY:UB,FILTERS_CONDITIONS_TOMORROW:zB,FILTERS_CONDITIONS_YESTERDAY:GB,FILTERS_DIVS_FILTER_BY_CONDITION:YB,FILTERS_DIVS_FILTER_BY_VALUE:KB,FILTERS_LABELS_CONJUNCTION:XB,FILTERS_LABELS_DISJUNCTION:bE,FILTERS_NAMESPACE:Ci,FILTERS_VALUES_BLANK_CELLS:vT},Symbol.toStringTag,{value:"Module"}));function ib(e){return ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ib(e)}var Ve;function Ue(e,t,r){return t=fXe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fXe(e){var t=cXe(e,"string");return ib(t)==="symbol"?t:String(t)}function cXe(e,t){if(ib(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ib(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hXe=(Ve={languageCode:"en-US"},Ue(Ve,FH,"No available options"),Ue(Ve,HH,"Insert row above"),Ue(Ve,BH,"Insert row below"),Ue(Ve,VH,"Insert column left"),Ue(Ve,jH,"Insert column right"),Ue(Ve,WH,["Remove row","Remove rows"]),Ue(Ve,UH,["Remove column","Remove columns"]),Ue(Ve,zH,"Undo"),Ue(Ve,GH,"Redo"),Ue(Ve,YH,"Read only"),Ue(Ve,KH,"Clear column"),Ue(Ve,lB,"Alignment"),Ue(Ve,uB,"Left"),Ue(Ve,fB,"Center"),Ue(Ve,cB,"Right"),Ue(Ve,hB,"Justify"),Ue(Ve,dB,"Top"),Ue(Ve,vB,"Middle"),Ue(Ve,pB,"Bottom"),Ue(Ve,eB,"Freeze column"),Ue(Ve,tB,"Unfreeze column"),Ue(Ve,gB,"Borders"),Ue(Ve,yB,"Top"),Ue(Ve,mB,"Right"),Ue(Ve,bB,"Bottom"),Ue(Ve,wB,"Left"),Ue(Ve,_B,"Remove border(s)"),Ue(Ve,iB,"Add comment"),Ue(Ve,aB,"Edit comment"),Ue(Ve,oB,"Delete comment"),Ue(Ve,sB,"Read-only comment"),Ue(Ve,rB,"Merge cells"),Ue(Ve,nB,"Unmerge cells"),Ue(Ve,XH,"Copy"),Ue(Ve,qH,["Copy with header","Copy with headers"]),Ue(Ve,ZH,["Copy with group header","Copy with group headers"]),Ue(Ve,JH,["Copy header only","Copy headers only"]),Ue(Ve,QH,"Cut"),Ue(Ve,SB,"Insert child row"),Ue(Ve,CB,"Detach from parent"),Ue(Ve,xB,["Hide column","Hide columns"]),Ue(Ve,TB,["Show column","Show columns"]),Ue(Ve,OB,["Hide row","Hide rows"]),Ue(Ve,EB,["Show row","Show rows"]),Ue(Ve,mE,"None"),Ue(Ve,RB,"Is empty"),Ue(Ve,kB,"Is not empty"),Ue(Ve,AB,"Is equal to"),Ue(Ve,PB,"Is not equal to"),Ue(Ve,IB,"Begins with"),Ue(Ve,MB,"Ends with"),Ue(Ve,DB,"Contains"),Ue(Ve,$B,"Does not contain"),Ue(Ve,NB,"Greater than"),Ue(Ve,LB,"Greater than or equal to"),Ue(Ve,FB,"Less than"),Ue(Ve,HB,"Less than or equal to"),Ue(Ve,BB,"Is between"),Ue(Ve,VB,"Is not between"),Ue(Ve,jB,"After"),Ue(Ve,WB,"Before"),Ue(Ve,UB,"Today"),Ue(Ve,zB,"Tomorrow"),Ue(Ve,GB,"Yesterday"),Ue(Ve,vT,"Blank cells"),Ue(Ve,YB,"Filter by condition"),Ue(Ve,KB,"Filter by value"),Ue(Ve,XB,"And"),Ue(Ve,bE,"Or"),Ue(Ve,qB,"Select all"),Ue(Ve,ZB,"Clear"),Ue(Ve,JB,"OK"),Ue(Ve,QB,"Cancel"),Ue(Ve,e3,"Search"),Ue(Ve,t3,"Value"),Ue(Ve,r3,"Second value"),Ve);const Poe=hXe;var iD=Poe.languageCode,wE=Ha("languagesDictionaries"),dXe=wE.register,Ioe=wE.getItem,vXe=wE.hasItem,pXe=wE.getValues;Moe(Poe);function Moe(e,t){var r=e,n=t;return kt(e)&&(n=e,r=n.languageCode),gXe(r,n),dXe(r,qn(n)),qn(n)}function gXe(e,t){e!==iD&&rXe(t,Ioe(iD))}function Doe(e){return n3(e)?qn(Ioe(e)):null}function n3(e){return vXe(e)}function yXe(){return pXe()}function $oe(e,t,r){var n=Doe(e);if(n===null)return null;var i=n[t];if(pr(i))return null;var a=mXe(i,r);return Array.isArray(a)?a[0]:a}function mXe(e,t){var r=e;return ne(sXe(),function(n){r=n(e,t)}),r}function bXe(e){var t=Eoe(e);return n3(t)||(t=iD,Roe(e)),t}var wXe=vt,_Xe=an,SXe=Pte,CXe=aa,xXe=ns,TXe=Rg;wXe({target:"Object",stat:!0,sham:!_Xe},{getOwnPropertyDescriptors:function(t){for(var r=CXe(t),n=xXe.f,i=SXe(r),a={},o=0,s,l;i.length>o;)l=n(r,s=i[o++]),l!==void 0&&TXe(a,s,l);return a}});var _E="active-header",SE="area",ab="cell",i3="fill",y_="header",a3="custom-selection";function Wv(e){return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function OXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Loe(n.key),n)}}function EXe(e,t,r){return t&&iG(e.prototype,t),r&&iG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mC(){return typeof Reflect<"u"&&Reflect.get?mC=Reflect.get.bind():mC=function(t,r,n){var i=RXe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},mC.apply(this,arguments)}function RXe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Uv(e),e!==null););return e}function kXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aD(e,t)}function aD(e,t){return aD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aD(e,t)}function AXe(e){var t=IXe();return function(){var n=Uv(e),i;if(t){var a=Uv(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return PXe(this,i)}}function PXe(e,t){if(t&&(Wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Noe(e)}function Noe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uv(e){return Uv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Uv(e)}function MXe(e,t,r){return t=Loe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Loe(e){var t=DXe(e,"string");return Wv(t)==="symbol"?t:String(t)}function DXe(e,t){if(Wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Xe=function(e){kXe(r,e);var t=AXe(r);function r(n,i){var a;return OXe(this,r),a=t.call(this,n,null),MXe(Noe(a),"visualCellRange",null),a.visualCellRange=i||null,a.commit(),a}return EXe(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,mC(Uv(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var a=i.from,o=i.to,s=this.getNearestNotHiddenCoords(a,1),l=this.getNearestNotHiddenCoords(o,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=a,l=o}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,a);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,o);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,a,o){if(a<0)return a;var s=i.getNearestNotHiddenIndex(a,o),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var a=i.getVerticalDirection()==="N-S"?1:-1,o=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),a,o);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,a=i.from,o=i.to,s=a.row===null||o.row===null,l=a.col===null||o.col===null,u=this.settings.createCellCoords(s?null:Math.min(a.row,o.row),l?null:Math.min(a.col,o.col)),f=this.settings.createCellCoords(s?null:Math.max(a.row,o.row),l?null:Math.max(a.col,o.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),a=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,a.row,a.col]}},{key:"createRenderableCellRange",value:function(i,a){var o=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(a);return this.settings.createCellRange(o,o,s)}}]),r}(v7e);const $g=$Xe;function ob(e){return ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ob(e)}var NXe=["activeHeaderClassName"];function aG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aG(Object(r),!0).forEach(function(n){LXe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LXe(e,t,r){return t=FXe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FXe(e){var t=HXe(e,"string");return ob(t)==="symbol"?t:String(t)}function HXe(e,t){if(ob(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ob(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BXe(e,t){if(e==null)return{};var r=VXe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VXe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function jXe(e){var t=e.activeHeaderClassName,r=BXe(e,NXe),n=new $g(oG(oG({highlightHeaderClassName:t},r),{},{selectionType:_E}));return n}function sb(e){return sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sb(e)}var WXe=["layerLevel","areaCornerVisible"];function sG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sG(Object(r),!0).forEach(function(n){UXe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UXe(e,t,r){return t=zXe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zXe(e){var t=GXe(e,"string");return sb(t)==="symbol"?t:String(t)}function GXe(e,t){if(sb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YXe(e,t){if(e==null)return{};var r=KXe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KXe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function XXe(e){var t=e.layerLevel,r=e.areaCornerVisible,n=YXe(e,WXe),i=new $g(lG(lG({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:SE}));return i}function lb(e){return lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lb(e)}var qXe=["cellCornerVisible"];function uG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uG(Object(r),!0).forEach(function(n){ZXe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZXe(e,t,r){return t=JXe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JXe(e){var t=QXe(e,"string");return lb(t)==="symbol"?t:String(t)}function QXe(e,t){if(lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eqe(e,t){if(e==null)return{};var r=tqe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tqe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function rqe(e){var t=e.cellCornerVisible,r=eqe(e,qXe),n=new $g(fG(fG({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:ab}));return n}function ub(e){return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}var nqe=["border","visualCellRange"];function cG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $A(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cG(Object(r),!0).forEach(function(n){iqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iqe(e,t,r){return t=aqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aqe(e){var t=oqe(e,"string");return ub(t)==="symbol"?t:String(t)}function oqe(e,t){if(ub(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ub(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sqe(e,t){if(e==null)return{};var r=lqe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lqe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function uqe(e){var t=e.border,r=e.visualCellRange,n=sqe(e,nqe),i=new $g($A($A($A({},t),n),{},{selectionType:a3}),r);return i}var hG=an,fqe=Pt,cqe=gn,hqe=Ct,NA=zw,dqe=Ww,vqe=$w,pqe=Hi,gqe=Lw,Uh=Object.assign,dG=Object.defineProperty,yqe=fqe([].concat),mqe=!Uh||hqe(function(){if(hG&&Uh({b:1},Uh(dG({},"a",{enumerable:!0,get:function(){dG(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),Uh({},e)[r]!=7||NA(Uh({},t)).join("")!=n})?function(t,r){for(var n=pqe(t),i=arguments.length,a=1,o=dqe.f,s=vqe.f;i>a;)for(var l=gqe(arguments[a++]),u=o?yqe(NA(l),o(l)):NA(l),f=u.length,c=0,h;f>c;)h=u[c++],(!hG||cqe(s,l,h))&&(n[h]=l[h]);return n}:Uh,bqe=vt,vG=mqe;bqe({target:"Object",stat:!0,arity:2,forced:Object.assign!==vG},{assign:vG});function fb(e){return fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fb(e)}function pG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pG(Object(r),!0).forEach(function(n){wqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wqe(e,t,r){return t=_qe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _qe(e){var t=Sqe(e,"string");return fb(t)==="symbol"?t:String(t)}function Sqe(e,t){if(fb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cqe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function xqe(e){var t=Object.assign({},(Cqe(e),e)),r=new $g(gG(gG({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:i3}));return r}function cb(e){return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}var Tqe=["headerClassName","rowClassName","columnClassName"];function yG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yG(Object(r),!0).forEach(function(n){Oqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oqe(e,t,r){return t=Eqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eqe(e){var t=Rqe(e,"string");return cb(t)==="symbol"?t:String(t)}function Rqe(e,t){if(cb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kqe(e,t){if(e==null)return{};var r=Aqe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Aqe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Pqe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=kqe(e,Tqe),a=new $g(mG(mG({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:y_}));return a}function hb(e){return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function bG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Iqe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bG(Object(r),!0).forEach(function(n){Mqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mqe(e,t,r){return t=Dqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dqe(e){var t=$qe(e,"string");return hb(t)==="symbol"?t:String(t)}function $qe(e,t){if(hb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Foe=Ha("highlight/types"),Ng=Foe.register,Nqe=Foe.getItem;Ng(_E,jXe);Ng(SE,XXe);Ng(ab,rqe);Ng(a3,uqe);Ng(i3,xqe);Ng(y_,Pqe);function zh(e,t){return Nqe(e)(Iqe({type:e},t))}function db(e){return db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},db(e)}function Fl(e){return Bqe(e)||Hqe(e)||Fqe(e)||Lqe()}function Lqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fqe(e,t){if(e){if(typeof e=="string")return oD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oD(e,t)}}function Hqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bqe(e){if(Array.isArray(e))return oD(e)}function oD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Oy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wG(Object(r),!0).forEach(function(n){Vqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vqe(e,t,r){return t=Hoe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hoe(n.key),n)}}function Wqe(e,t,r){return t&&_G(e.prototype,t),r&&_G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hoe(e){var t=Uqe(e,"string");return db(t)==="symbol"?t:String(t)}function Uqe(e,t){if(db(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(db(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zqe=function(e){function t(r){jqe(this,t),this.options=r,this.layerLevel=0,this.cell=zh(ab,r),this.fill=zh(i3,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Wqe(t,[{key:"isEnabledFor",value:function(n,i){var a=n;n===ab&&(a="current");var o=this.options.disabledCellSelection(i.row,i.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(a)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=zh(SE,Oy({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return Fl(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=zh(y_,Oy({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return Fl(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=zh(_E,Oy({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return Fl(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Fl(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(zh(a3,Oy(Oy({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),ne(this.areas.values(),function(n){return void n.clear()}),ne(this.headers.values(),function(n){return void n.clear()}),ne(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Fl(this.areas.values()),Fl(this.headers.values()),Fl(this.activeHeaders.values()),Fl(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const Gqe=zqe;function vb(e){return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function Yqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xqe(n.key),n)}}function Kqe(e,t,r){return t&&SG(e.prototype,t),r&&SG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xqe(e){var t=qqe(e,"string");return vb(t)==="symbol"?t:String(t)}function qqe(e,t){if(vb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zqe=function(e){function t(r){Yqe(this,t),this.ranges=[],this.createCellRange=r}return Kqe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,a;return i>=0&&(a=this.ranges[i]),a}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const Jqe=Zqe;function pb(e){return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function Qqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tZe(n.key),n)}}function eZe(e,t,r){return t&&CG(e.prototype,t),r&&CG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tZe(e){var t=rZe(e,"string");return pb(t)==="symbol"?t:String(t)}function rZe(e,t){if(pb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Boe=function(){function e(t,r){Qqe(this,e),this.range=t,this.options=r}return eZe(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.options.createCellCoords(r,n),o=this.range.current().highlight,s=this.options.visualToRenderableCoords(o),l=s.row,u=s.col,f=o,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",a),l!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),p=this.options.fixedRowsBottom(),g=this.options.minSpareRows(),y=this.options.minSpareCols(),m=this.options.autoWrapRow(),b=this.options.autoWrapCol();l+r>d-1?i&&g>0&&!(p&&l>=d-p-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):b&&(a.row=1-d,a.col=u+a.col===v-1?1-v:1):b&&l+a.row<0&&u+a.col>=0&&(a.row=d-1,a.col=u+a.col===0?v-1:-1),u+a.col>v-1?i&&y>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):m&&(a.row=l+a.row===d-1?1-d:1,a.col=1-v):m&&u+a.col<0&&l+a.row>=0&&(a.row=l+a.row===0?d-1:-1,a.col=v-1);var _=this.options.createCellCoords(l+a.row,u+a.col);c=0,h=0,_.row<0?(c=-1,_.row=0):_.row>0&&_.row>=d&&(c=1,_.row=d-1),_.col<0?(h=-1,_.col=0):_.col>0&&_.col>=v&&(h=1,_.col=v-1),f=this.options.renderableToVisualCoords(_)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),a=this.range.current(),o=a.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(a.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(a.to),p=v.row,g=v.col,y=this.options.createCellCoords(p+i.row,g+i.col);s=0,l=0,y.row<0?(s=-1,y.row=0):y.row>0&&y.row>=h&&(s=1,y.row=h-1),y.col<0?(l=-1,y.col=0):y.col>0&&y.col>=d&&(l=1,y.col=d-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,s,l),o}}]),e}();mr(Boe,Bi);const nZe=Boe;function Voe(e,t){return sZe(e)||oZe(e,t)||aZe(e,t)||iZe()}function iZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aZe(e,t){if(e){if(typeof e=="string")return xG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xG(e,t)}}function xG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sZe(e){if(Array.isArray(e))return e}function sD(e){return sD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sD(e)}var CE=0,xE=1,joe=2,o3=3,lZe=[o3,joe],uZe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],LA=Symbol("root"),TG=Symbol("child");function zv(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:LA;if(t!==LA&&t!==TG)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===LA,i=CE;if(r){var a=e[0];if(e.length===0)i=xE;else if(n&&a instanceof bH)i=o3;else if(n&&Array.isArray(a))i=zv(a,TG);else if(e.length>=2&&e.length<=4){var o=!e.some(function(s,l){return!uZe[l].includes(sD(s))});o&&(i=joe)}}return i}function gb(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!lZe.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(a){var o=e===o3,s=o?a.from.row:a[0],l=o?a.from.col:a[1],u=o?a.to.row:a[2],f=o?a.to.col:a[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof f=="string"&&(f=i(f))),pr(u)&&(u=s),pr(f)&&(f=l),!n){var c=s,h=l,d=u,v=f;s=Math.min(c,d),l=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[s,l,u,f]}}function fZe(e){var t=zv(e);if(t===CE||t===xE)return[];var r=gb(t),n=new Set;ne(e,function(o){var s=r(o),l=Voe(s,4),u=l[1],f=l[3],c=Math.max(u,0),h=f-c+1;ne(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=Xr(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function cZe(e){var t=zv(e);if(t===CE||t===xE)return[];var r=gb(t),n=new Set;ne(e,function(o){var s=r(o),l=Voe(s,3),u=l[0],f=l[2],c=Math.max(u,0),h=f-c+1;ne(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=Xr(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function Hl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function yb(e){return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}var OG;function EG(e,t){return pZe(e)||vZe(e,t)||dZe(e,t)||hZe()}function hZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dZe(e,t){if(e){if(typeof e=="string")return RG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RG(e,t)}}function RG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function pZe(e){if(Array.isArray(e))return e}function gZe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function yZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bZe(n.key),n)}}function mZe(e,t,r){return t&&kG(e.prototype,t),r&&kG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bZe(e){var t=wZe(e,"string");return yb(t)==="symbol"?t:String(t)}function wZe(e,t){if(yb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Woe=function(){function e(t,r){var n=this;yZe(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Jqe(function(i,a,o){return n.tableProps.createCellRange(i,a,o)}),this.highlight=new Gqe({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(a,o){return n.tableProps.isDisabledCellSelection(a,o)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},createCellRange:function(a,o,s){return n.tableProps.createCellRange(a,o,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new nZe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(a))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertColRequire"].concat(a))})}return mZe(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.settings.selectionMode==="multiple",o=pr(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),f),(!a||a&&!o&&pr(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(ab,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var a=this.getLayerLevel();a<this.highlight.layerLevel&&(ne(this.highlight.getAreas(),function(p){return void p.clear()}),ne(this.highlight.getHeaders(),function(p){return void p.clear()}),ne(this.highlight.getActiveHeaders(),function(p){return void p.clear()})),this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(SE,i.highlight)&&(this.isMultiple()||a>=1)&&(o.add(i.from).add(i.to).commit(),a===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(a-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(y_,i.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=i;if((f||c)&&(h=i.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===i.getWidth();d&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===i.getHeight();v&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=$c(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),a=this.tableProps.countCols();if(!(!r&&!n&&(i===0||a===0))){var o=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,a-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=zv(r);if(i===xE)return!1;if(i===CE)throw new Error(sr(OG||(OG=gZe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var a=gb(i,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var f=a(u),c=EG(f,4),h=c[0],d=c[1],v=c[2],p=c[3],g=Hl(h,o)&&Hl(d,s)&&Hl(v,o)&&Hl(p,s);return!g});return l&&(this.clear(),ne(r,function(u){var f=a(u),c=EG(f,4),h=c[0],d=c[1],v=c[2],p=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,p)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=typeof r=="string"?this.tableProps.propToCol(r):r,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=Hl(a,s)&&Hl(o,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,a)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,o)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=this.tableProps.countRows(),o=this.tableProps.countCols(),s=Hl(r,a)&&Hl(n,a);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,o-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var a=0;a<this.selectedRange.size();a+=1){this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();o.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),e}();mr(Woe,Bi);const _Ze=Woe;var SZe=vt,Uoe=Yw,CZe=ns.f,xZe=oh,AG=sn,TZe=OF,OZe=Fi,EZe=EF,PG=Uoe("".startsWith),RZe=Uoe("".slice),kZe=Math.min,zoe=EZe("startsWith"),AZe=!zoe&&!!function(){var e=CZe(String.prototype,"startsWith");return e&&!e.writable}();SZe({target:"String",proto:!0,forced:!AZe&&!zoe},{startsWith:function(t){var r=AG(OZe(this));TZe(t);var n=xZe(kZe(arguments.length>1?arguments[1]:void 0,r.length)),i=AG(t);return PG?PG(r,i,n):RZe(r,n,n+i.length)===i}});var IG=/^(\r\n|\n\r|\r|\n)/,PZe=/^[^\t\r\n]+/,MG=/^\t/;function IZe(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,i;e.length>0&&i!==e.length;)if(i=e.length,e.match(MG))e=e.replace(MG,""),r+=1,t[n][r]="";else if(e.match(IG))e=e.replace(IG,""),r=0,n+=1,t[n]=[""];else{var a="";if(e.startsWith('"')){for(var o=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(o+=1),a+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&o%2===0)&&(s=!1)}a=a.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(PZe);a=u?u[0]:"",e=e.slice(a.length)}t[n][r]=a}return t}function Pm(e){var t,r,n,i,a="",o;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(a+="	"),o=e[t][n],typeof o=="string"?o.indexOf(`
`)>-1?a+='"'.concat(o.replace(/"/g,'""'),'"'):a+=o:o==null?a+="":a+=o;t!==r-1&&(a+=`
`)}return a}function FA(e){return NZe(e)||$Ze(e)||DZe(e)||MZe()}function MZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DZe(e,t){if(e){if(typeof e=="string")return lD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lD(e,t)}}function $Ze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NZe(e){if(Array.isArray(e))return lD(e)}function lD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gv(e){return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gv(e)}function LZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HZe(n.key),n)}}function FZe(e,t,r){return t&&DG(e.prototype,t),r&&DG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HZe(e){var t=BZe(e,"string");return Gv(t)==="symbol"?t:String(t)}function BZe(e,t){if(Gv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VZe=function(){function e(t,r,n){LZe(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return FZe(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var a=0,o=0,s=!1;if(typeof n=="function"){var l=qO(r);a=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;a=Math.min(u,n.length)}for(i=0;i<a;i++){var f=s?n(i):n[i];if(kt(f)){if(typeof f.data<"u"){var c=s?o:i;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}o+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return PH(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var a=this,o=n,s=i,l;return typeof o>"u"&&(o=0,s=""),Gv(r)==="object"&&!Array.isArray(r)&&At(r,function(u,f){u===null?(l=s+f,a.colToPropCache.push(l),a.propToColCache.set(l,o),o+=1):o=a.recursiveDuckColumns(u,o,"".concat(f,"."))}),o}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&Xe(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(Xe(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?cv(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.source,s=a.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,i,o);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,p=this.getSchema().length,g=[],y=function(){var _=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?_=qn(n.getSchema()):(_=[],rt(p-1,function(){return _.push(null)})):n.instance.dataType==="function"?_=n.tableMeta.dataSchema(h+c):(_={},r_(_,n.getSchema())),g.push(_),c+=1};c<i&&u+c<v;)y();this.instance.rowIndexMapper.insertIndexes(h,c),l==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,g);var m=this.instance.toVisualRow(f);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):o!=="auto"&&this.metaManager.createRow(f,i)),this.instance.runHooks("afterCreateRow",m,c,o),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,o=i.mode,s=o===void 0?"start":o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,a);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),p=this.instance.countCols(),g=0,y=d;s==="end"&&(y=Math.min(y+1,f));for(var m=y;g<n&&p<u;){if(typeof c!="number"||c>=p)if(v>0)for(var b=0;b<v;b+=1)typeof l[b]>"u"&&(l[b]=[]),l[b].push(null);else l.push([null]);else for(var _=0;_<v;_++)l[_].splice(y,0,null);g+=1,y+=1,p+=1}this.instance.columnIndexMapper.insertIndexes(c,g),g>0&&(r==null?this.metaManager.createColumn(null,g):a!=="auto"&&this.metaManager.createColumn(m,n));var x=this.instance.toVisualColumn(m);return this.instance.runHooks("afterCreateCol",x,g,a),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:m}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(o,i),l=this.instance.countSourceRows();o=(l+o)%l;var u=this.instance.runHooks("beforeRemoveRow",o,s.length,s,a);if(u===!1)return!1;var f=s.length;if(this.filterData(o,f,s),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var c=Xe(this.tableMeta.columns)||Xe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=s.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",o,f,s,a),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var a=typeof r!="number"?-n:r;a=(this.instance.countCols()+a)%this.instance.countCols();var o=this.visualColumnsToPhysical(a,n),s=o.slice(0).sort(function(m,b){return b-m}),l=this.instance.runHooks("beforeRemoveCol",a,n,o,i);if(l===!1)return!1;for(var u=!0,f=s.length,c=this.dataSource,h=0;h<f;h++)u&&o[0]!==o[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(var p=0,g=this.instance.countSourceRows();p<g;p++)for(var y=0;y<f;y++)c[p].splice(s[y],1),p===0&&this.metaManager.removeColumn(s[y],1);return a<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",a,n,o,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var a=this.instance.getDataAtCol(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];FM(u,s);for(var c=0;c<i;)u.push(null),c+=1;return Ene(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(r,n,i){for(var a=this.instance.getSourceDataAtRow(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];FM(u,s);for(var c=0;c<i;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),o}},{key:"spliceData",value:function(r,n,i){var a=this,o=this.instance.runHooks("beforeDataSplice",r,n,i);if(o!==!1){var s=[].concat(FA(this.dataSource.slice(0,r)),FA(i),FA(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return a.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var a=this.instance.runHooks("filterData",r,n,i);Array.isArray(a)===!1&&(a=this.dataSource.filter(function(o,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,a)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),a=this.dataSource[i],o=this.instance.runHooks("modifyRowData",i);a=isNaN(o)?o:a;var s=null;if(a&&a.hasOwnProperty&&Br(a,n))s=a[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=a;if(!u)return null;for(var f=0,c=l.length;f<c;f++)if(u=u[l[f]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=$c(s);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var a=this.instance.toPhysicalRow(r),o=i,s=this.dataSource[a],l=this.instance.runHooks("modifyRowData",a);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=$c(o);this.instance.runHooks("modifyData",a,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}if(s&&s.hasOwnProperty&&Br(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=s,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=o}else typeof n=="function"?n(this.dataSource.slice(a,a+1)[0],o):s[n]=o}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),a=[],o=(i+r)%i,s=n,l;o<i&&s;)l=this.instance.toPhysicalRow(o),a.push(l),s-=1,o+=1;return a}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),a=[],o=(i+r)%i,s=n;o<i&&s;){var l=this.instance.toPhysicalColumn(o);a.push(l),s-=1,o+=1}return a}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var a=[],o,s,l,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(o=Math.min(r.row,n.row);o<=h;o++){l=[];var v=o>=0?this.instance.toPhysicalRow(o):o;for(s=Math.min(r.col,n.col);s<=d&&v!==null;s++)l.push(c.call(this,o,this.colToProp(s)));v!==null&&a.push(l)}return a}},{key:"getText",value:function(r,n){return Pm(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return Pm(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const jZe=VZe;var m_=Ha("cellTypes"),WZe=m_.register,UZe=m_.getItem,Goe=m_.hasItem,zZe=m_.getNames;m_.getValues;function s3(e){if(!Goe(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return UZe(e)}function Ja(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,a=r.validator;n&&Ri(e,n),i&&Lo(e,i),a&&Rd(e,a),WZe(e,t)}function GZe(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Br(t,e)}function TE(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?s3(t.type):t.type;if(e._automaticallyAssignedMetaProps&&At(t,function(a,o){return void e._automaticallyAssignedMetaProps.delete(o)}),!!kt(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};At(n,function(a,o){if(GZe(o,r)){var s;i[o]=a,(s=e._automaticallyAssignedMetaProps)===null||s===void 0||s.add(o)}}),nn(e,i)}}function YZe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Cl(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function bC(e){return Number.isInteger(e)&&e>=0}function wC(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function qS(e){return e==null}function uD(e){return uD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uD(e)}const Yoe=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),vn(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,a;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),vn(i)===!1)return uD(i)==="object"?(a=this.getCellMeta(t,r),DF(this.getSchema()[a.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function mb(e){return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}function $G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function NG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$G(Object(r),!0).forEach(function(n){KZe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$G(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KZe(e,t,r){return t=Xoe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xoe(n.key),n)}}function Koe(e,t,r){return t&&LG(e.prototype,t),r&&LG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xoe(e){var t=XZe(e,"string");return mb(t)==="symbol"?t:String(t)}function XZe(e,t){if(mb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qZe(){return Koe(function e(){qoe(this,e)})}var ZZe=function(){function e(t){qoe(this,e),this.metaCtor=qZe(),this.meta=this.metaCtor.prototype,nn(this.meta,Yoe()),this.meta.instance=t}return Koe(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;nn(this.meta,r),TE(this.meta,NG(NG({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function bb(e){return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bb(e)}function JZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eJe(n.key),n)}}function QZe(e,t,r){return t&&FG(e.prototype,t),r&&FG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eJe(e){var t=tJe(e,"string");return bb(t)==="symbol"?t:String(t)}function tJe(e,t){if(bb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rJe=function(){function e(t){JZe(this,e);var r=t.getMetaConstructor();this.meta=new r}return QZe(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){nn(this.meta,r),TE(this.meta,r,r)}}]),e}();function wb(e){return wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wb(e)}function HG(e){return oJe(e)||aJe(e)||iJe(e)||nJe()}function nJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iJe(e,t){if(e){if(typeof e=="string")return fD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fD(e,t)}}function aJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oJe(e){if(Array.isArray(e))return fD(e)}function fD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uJe(n.key),n)}}function lJe(e,t,r){return t&&BG(e.prototype,t),r&&BG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uJe(e){var t=fJe(e,"string");return wb(t)==="symbol"?t:String(t)}function fJe(e,t){if(wb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cD=function(e){function t(r){sJe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return lJe(t,[{key:"obtain",value:function(n){wC(function(){return bC(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),a;if(i>=0)a=this.data[i],a===void 0&&(a=this.valueFactory(n),this.data[i]=a);else if(a=this.valueFactory(n),this.holes.size>0){var o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=a,this.index[n]=o}else this.data.push(a),this.index[n]=this.data.length-1;return a}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;wC(function(){return bC(n)||qS(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=[],o=this.data.length,s=0;s<i;s++)a.push(o+s),this.data.push(void 0);var l=qS(n)?this.index.length:n;this.index=[].concat(HG(this.index.slice(0,l)),a,HG(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;wC(function(){return bC(n)||qS(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=this.index.splice(qS(n)?this.index.length-i:n,i),o=0;o<a.length;o++){var s=a[o];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return ra(this.data,function(i,a){return!n.holes.has(a)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var a=this._getKeyByStorageIndex(i);a!==-1&&n.push([a,this.data[i]])}var o=0;return{next:function(){if(o<n.length){var l=n[o];return o+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function _b(e){return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function cJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dJe(n.key),n)}}function hJe(e,t,r){return t&&VG(e.prototype,t),r&&VG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dJe(e){var t=vJe(e,"string");return _b(t)==="symbol"?t:String(t)}function vJe(e,t){if(_b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pJe=["data","width"],gJe=function(){function e(t){var r=this;cJe(this,e),this.globalMeta=t,this.metas=new cD(function(){return r._createMeta()})}return hJe(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);nn(i,n),TE(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return YZe(this.globalMeta.getMetaConstructor(),pJe).prototype}}]),e}();function Sb(e){return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sb(e)}function yJe(e){return _Je(e)||wJe(e)||bJe(e)||mJe()}function mJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bJe(e,t){if(e){if(typeof e=="string")return hD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(e,t)}}function wJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Je(e){if(Array.isArray(e))return hD(e)}function hD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xJe(n.key),n)}}function CJe(e,t,r){return t&&jG(e.prototype,t),r&&jG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xJe(e){var t=TJe(e,"string");return Sb(t)==="symbol"?t:String(t)}function TJe(e,t){if(Sb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OJe=function(){function e(t){var r=this;SJe(this,e),this.columnMeta=t,this.metas=new cD(function(){return r._createRow()})}return CJe(e,[{key:"updateMeta",value:function(r,n,i){var a=this.getMeta(r,n);nn(a,i),TE(a,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);return i===void 0?a:a[i]}},{key:"setMeta",value:function(r,n,i,a){var o,s=this.metas.obtain(r).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=a}},{key:"removeMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);delete a[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,yJe(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){wC(function(){return bC(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new cD(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function Cb(e){return Cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(e)}function EJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kJe(n.key),n)}}function RJe(e,t,r){return t&&WG(e.prototype,t),r&&WG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kJe(e){var t=AJe(e,"string");return Cb(t)==="symbol"?t:String(t)}function AJe(e,t){if(Cb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zoe=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];EJe(this,e),this.hot=t,this.globalMeta=new ZZe(t),this.tableMeta=new rJe(this.globalMeta),this.columnMeta=new gJe(this.globalMeta),this.cellMeta=new OJe(this.columnMeta),i.forEach(function(a){return new a(r)}),this.globalMeta.updateMeta(n)}return RJe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var a=i.visualRow,o=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=a,s.visualCol=o,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,a){this.cellMeta.setMeta(r,n,i,a)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();mr(Zoe,Bi);function pT(e){return pT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pT(e)}function UG(e,t,r,n){var i=n.hotInstance,a=n.dataMap,o=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,f=n.firstRun,c=$i(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":wr(h.dataSchema)?i.dataType="function":i.dataType="object",a&&a.destroy(),e=i.runHooks("before".concat(c),e,f,l);var d=new jZe(i,e,u);if(t(d),pT(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var p,g=0,y=0;for(g=0,y=h.startRows;g<y;g++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)p=qn(v),e.push(p);else if(i.dataType==="array")p=qn(v[0]),e.push(p);else{p=[];for(var m=0,b=h.startCols;m<b;m++)p.push(null);e.push(p)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(pT(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),h.data=e,d.dataSource=e,o.data=e,o.dataType=i.dataType,o.colToProp=d.colToProp.bind(d),o.propToCol=d.propToCol.bind(d),o.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks("after".concat(c),e,f,l),f||(i.runHooks("afterChange",null,s),i.render())}function xb(e){return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function PJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MJe(n.key),n)}}function IJe(e,t,r){return t&&zG(e.prototype,t),r&&zG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MJe(e){var t=DJe(e,"string");return xb(t)==="symbol"?t:String(t)}function DJe(e,t){if(xb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Je=function(){function e(t){var r=this;PJe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Je.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return IJe(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,a=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(a))){var o=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",o,s,r);var f=Br(r,"type")?r.type:null,c=wr(r.cells)?r.cells(i,a,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(i,a,c),l.runHooks("afterGetCellMeta",o,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(a)}}}]),e}();function Tb(e){return Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tb(e)}function NJe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FJe(n.key),n)}}function LJe(e,t,r){return t&&GG(e.prototype,t),r&&GG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FJe(e){var t=HJe(e,"string");return Tb(t)==="symbol"?t:String(t)}function HJe(e,t){if(Tb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BJe=function(){function e(t){NJe(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,a){if(!a)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return LJe(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var a=n.target,o=n.onChange,s=o===void 0?function(){}:o,l=typeof a=="string",u=l?a:i,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,f,s),l&&r.installPropWatcher(a,f,s)})}},{key:"installPropWatcher",value:function(r,n,i){var a=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!a.usageTracker.has(r);a.usageTracker.add(r),i.call(a,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),e}(),YG=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ZS=function(t){return t.map(function(r){var n=r.toLowerCase();return YG.has(n)?YG.get(n):n}).sort().join("+")},VJe=function(t){return t.split("+")},KG=function(t){return t.toLowerCase()},XG;function jJe(e){return zJe(e)||UJe(e)||Joe(e)||WJe()}function WJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UJe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zJe(e){if(Array.isArray(e))return dD(e)}function GJe(e,t){return XJe(e)||KJe(e,t)||Joe(e,t)||YJe()}function YJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Joe(e,t){if(e){if(typeof e=="string")return dD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dD(e,t)}}function dD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function XJe(e){if(Array.isArray(e))return e}function qJe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ZJe=function(t){var r=vE({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,p=v===void 0?function(){return!0}:v,g=f.captureCtrl,y=g===void 0?!1:g,m=f.preventDefault,b=m===void 0?!0:m,_=f.stopPropagation,x=_===void 0?!1:_,T=f.relativeToGroup,E=f.position;if(pr(d))throw new Error("You need to define the shortcut's group.");if(wr(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(sr(XG||(XG=qJe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var P={callback:h,group:d,runOnlyIf:p,captureCtrl:y,preventDefault:b,stopPropagation:x};if(Xe(T)){var R=[T,E];P.relativeToGroup=R[0],P.position=R[1]}c.forEach(function(M){var D=ZS(M),N=r.hasItem(D);if(N){var B=r.getItem(D),K=B.findIndex(function(Z){return Z.group===T});K!==-1?E==="before"?K-=1:K+=1:K=B.length,B.splice(K,0,P)}else r.addItem(D,[P])})},i=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){At(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},a=function(f){var c=ZS(f);r.removeItem(c)},o=function(f){var c=r.getItems();c.forEach(function(h){var d=GJe(h,2),v=d[0],p=d[1],g=p.filter(function(y){return y.group!==f});g.length===0?a(VJe(v)):(p.length=0,p.push.apply(p,jJe(g)))})},s=function(f){var c=ZS(f),h=r.getItem(c);return Xe(h)?h.slice():[]},l=function(f){var c=ZS(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:a,removeShortcutsByGroup:o}};function JJe(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var QJe=["meta","alt","shift","control"],Ey=JJe();function eQe(e,t,r,n,i){var a=function(d){return QJe.includes(d)},o=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=[];return d.altKey&&p.push("alt"),v&&(d.ctrlKey||d.metaKey)?p.push("control/meta"):(d.ctrlKey&&p.push("control"),d.metaKey&&p.push("meta")),d.shiftKey&&p.push("shift"),p},s=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||Hf(d))){var p=KG(d.key),g=[];a(p)?Ey.press(p):g=o(d);var y=[p].concat(g),m=i(d,y);!m&&(xx()&&g.includes("meta")||!xx()&&g.includes("control"))&&i(d,[p].concat(o(d,!0))),n(d)}}},l=function(d){if(t(d)!==!1){var v=KG(d.key);a(v)!==!1&&Ey.release(v)}},u=function(){Ey.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",s),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=m0(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",s),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=m0(d)};return{mount:f,unmount:c,isPressed:function(d){return Ey.isPressed(d)},releasePressedKeys:function(){return Ey.releaseAll()}}}var tQe=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,a=t.afterKeyDown,o=vE({errorIdExists:function(p){return'The "'.concat(p,'" context name is already registered.')}}),s="grid",l=function(p){var g=ZJe(p);return o.addItem(p,g),g},u=function(){return s},f=function(p){return o.getItem(p)},c=function(p){s=p},h=!1,d=eQe(r,n,i,a,function(v,p){var g=f(u()),y=!1;if(!g.hasShortcut(p))return y;for(var m=g.getShortcuts(p),b=0;b<m.length;b++){var _=m[b],x=_.callback,T=_.runOnlyIf,E=_.preventDefault,P=_.stopPropagation,R=_.captureCtrl;if(T(v)!==!1&&(h=R,y=x(v,p)===!1,h=!1,E&&v.preventDefault(),P&&v.stopPropagation(),y))break}return y});return d.mount(),{addContext:l,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},qG,ZG;function Oi(e){return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oi(e)}function JG(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ro(e,t){return iQe(e)||nQe(e,t)||Qoe(e,t)||rQe()}function rQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nQe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function iQe(e){if(Array.isArray(e))return e}function Gh(e){return sQe(e)||oQe(e)||Qoe(e)||aQe()}function aQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qoe(e,t){if(e){if(typeof e=="string")return vD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vD(e,t)}}function oQe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sQe(e){if(Array.isArray(e))return vD(e)}function vD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lQe="gridDefault",HA=null,JS=new Set;function l3(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,o=this,s=new Nr(o),l,u,f,c,h=!0;m7e(i)&&y7e(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=bXe(t.language);var p=new Zoe(o,t,[$Je,BJe]),g=p.getTableMeta(),y=p.getGlobalMeta(),m=vE();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),V2(this)&&$ie(t.licenseKey,e),this.guid="ht_".concat(iH()),this.columnIndexMapper=new nD,this.rowIndexMapper=new nD,u=new W7e(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var b=function(C){var O=C.row,S=C.col;return o._createCellCoords(O>=0?o.rowIndexMapper.getRenderableFromVisualIndex(O):O,S>=0?o.columnIndexMapper.getRenderableFromVisualIndex(S):S)},_=function(C){var O=C.row,S=C.col;return o._createCellCoords(O>=0?o.rowIndexMapper.getVisualFromRenderableIndex(O):O,S>=0?o.columnIndexMapper.getVisualFromRenderableIndex(S):S)},x=new _Ze(g,{rowIndexMapper:function(){return o.rowIndexMapper},columnIndexMapper:function(){return o.columnIndexMapper},countCols:function(){return o.countCols()},countRows:function(){return o.countRows()},propToCol:function(C){return l.propToCol(C)},isEditorOpened:function(){return o.getActiveEditor()?o.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return o.getShortcutManager()},createCellCoords:function(C,O){return o._createCellCoords(C,O)},createCellRange:function(C,O,S){return o._createCellRange(C,O,S)},visualToRenderableCoords:b,renderableToVisualCoords:_,isDisabledCellSelection:function(C,O){return o.getCellMeta(C,O).disableVisualSelection}});this.selection=x;var T=function(C){var O=C.hiddenIndexesChanged;O&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",T),this.rowIndexMapper.addLocalHook("cacheUpdated",T),this.selection.addLocalHook("beforeSetRangeStart",function(w){n.runHooks("beforeSetRangeStart",w)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(w){n.runHooks("beforeSetRangeStartOnly",w)}),this.selection.addLocalHook("beforeSetRangeEnd",function(w){n.runHooks("beforeSetRangeEnd",w),w.row<0&&(w.row=n.view._wt.wtTable.getFirstVisibleRow()),w.col<0&&(w.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(w){var C=$c(!1),O=n.selection.getSelectedRange(),S=O.current(),A=S.from,I=S.to,L=O.size()-1;n.runHooks("afterSelection",A.row,A.col,I.row,I.col,C,L),n.runHooks("afterSelectionByProp",A.row,o.colToProp(A.col),I.row,o.colToProp(I.col),C,L);var V=n.selection.isSelectedByAnyHeader(),Y=n.selection.selectedRange.current(),ae=!0;a&&(ae=!1),C.isTouched()&&(ae=!C.value);var re=n.selection.isSelectedByRowHeader(),te=n.selection.isSelectedByColumnHeader();ae!==!1&&(V?re?n.view.scrollViewportVertically(o.rowIndexMapper.getRenderableFromVisualIndex(w.row)):te&&n.view.scrollViewportHorizontally(o.columnIndexMapper.getRenderableFromVisualIndex(w.col)):Y&&!n.selection.isMultiple()?n.view.scrollViewport(b(Y.from)):n.view.scrollViewport(b(w))),re&&te?ke(n.rootElement,["ht__selection--rows","ht__selection--columns"]):re?(wt(n.rootElement,"ht__selection--columns"),ke(n.rootElement,"ht__selection--rows")):te?(wt(n.rootElement,"ht__selection--rows"),ke(n.rootElement,"ht__selection--columns")):wt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(w){var C=w.length-1,O=w[C],S=O.from,A=O.to;n.runHooks("afterSelectionEnd",S.row,S.col,A.row,A.col,C),n.runHooks("afterSelectionEndByProp",S.row,o.colToProp(S.col),A.row,o.colToProp(A.col),C)}),this.selection.addLocalHook("afterIsMultipleSelection",function(w){var C=n.runHooks("afterIsMultipleSelection",w.value);w.value&&(w.value=C)}),this.selection.addLocalHook("beforeModifyTransformStart",function(w){n.runHooks("modifyTransformStart",w)}),this.selection.addLocalHook("afterModifyTransformStart",function(w,C,O){n.runHooks("afterModifyTransformStart",w,C,O)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(w){n.runHooks("modifyTransformEnd",w)}),this.selection.addLocalHook("afterModifyTransformEnd",function(w,C,O){n.runHooks("afterModifyTransformEnd",w,C,O)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),wt(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(w){n.alter("insert_row_above",w,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(w){n.alter("insert_col_start",w,1,"auto")}),f={alter:function(C,O){var S,A,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,L=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0,Y=function(ut){if(ut.length===0)return[];var ft=Gh(ut);ft.sort(function(Lt,It){var bt=Ro(Lt,1),ht=bt[0],Ke=Ro(It,1),Be=Ke[0];return ht===Be?0:ht>Be?1:-1});var Tt=Xr(ft,function(Lt,It){var bt=Ro(It,2),ht=bt[0],Ke=bt[1],Be=Lt[Lt.length-1],at=Ro(Be,2),He=at[0],ot=at[1],je=He+ot;if(ht<=je){var Ze=Math.max(Ke-(je-ht),0);Be[1]+=Ze}else Lt.push([ht,Ke]);return Lt},[ft[0]]);return Tt};switch(C){case"insert_row":JS.has(C)||(JS.add(C),gr(sr(qG||(qG=JG(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),C)));case"insert_row_below":case"insert_row_above":var ae=o.countSourceRows();if(g.maxRows===ae)return;var re=C==="insert_row_below"?"below":"above";O=(S=O)!==null&&S!==void 0?S:C==="insert_row"||re==="below"?ae:0;var te=l.createRow(O,I,{source:L,mode:re}),ge=te.delta,H=te.startPhysicalIndex;if(ge){var Ce=x.selectedRange.current(),oe=Ce==null?void 0:Ce.from,Oe=oe==null?void 0:oe.row,Ee=o.toVisualRow(H);if(x.isSelectedByCorner())o.selectAll();else if(Xe(Oe)&&Oe>=Ee){var be=Ce.to,Ie=be.row,Me=be.col,j=oe.col;x.isSelectedByRowHeader()&&(j=-1),x.getSelectedRange().pop(),x.setRangeStartOnly(o._createCellCoords(Oe+ge,j),!0),x.setRangeEnd(o._createCellCoords(Ie+ge,Me))}else o._refreshBorders()}break;case"insert_col":JS.has(C)||(JS.add(C),gr(sr(ZG||(ZG=JG(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),C)));case"insert_col_start":case"insert_col_end":var U=C==="insert_col_end"?"end":"start";O=(A=O)!==null&&A!==void 0?A:C==="insert_col"||U==="end"?o.countSourceCols():0;var Q=l.createCol(O,I,{source:L,mode:U}),fe=Q.delta,ee=Q.startPhysicalIndex;if(fe){if(Array.isArray(g.colHeaders)){var pe=[o.toVisualColumn(ee),0];pe.length+=fe,Array.prototype.splice.apply(g.colHeaders,pe)}var se=x.selectedRange.current(),ue=se==null?void 0:se.from,ce=ue==null?void 0:ue.col,ve=o.toVisualColumn(ee);if(x.isSelectedByCorner())o.selectAll();else if(Xe(ce)&&ce>=ve){var de=se.to,Te=de.row,$e=de.col,Fe=ue.row;x.isSelectedByColumnHeader()&&(Fe=-1),x.getSelectedRange().pop(),x.setRangeStartOnly(o._createCellCoords(Fe,ce+fe),!0),x.setRangeEnd(o._createCellCoords(Te,$e+fe))}else o._refreshBorders()}break;case"remove_row":var it=function(ut){var ft=0;ne(ut,function(Tt){var Lt=Ro(Tt,2),It=Lt[0],bt=Lt[1],ht=vn(It)?o.countRows()-1:Math.max(It-ft,0);Number.isInteger(It)&&(It=Math.max(It-ft,0));var Ke=l.removeRow(It,bt,L);if(Ke){var Be=o.countRows(),at=g.fixedRowsTop;at>=ht+1&&(g.fixedRowsTop-=Math.min(bt,at-ht));var He=g.fixedRowsBottom;He&&ht>=Be-He&&(g.fixedRowsBottom-=Math.min(bt,He)),ft+=bt}})};Array.isArray(O)?it(Y(O)):it([[O,I]]),f.adjustRowsAndCols(),o._refreshBorders();break;case"remove_col":var gt=function(ut){var ft=0;ne(ut,function(Tt){var Lt=Ro(Tt,2),It=Lt[0],bt=Lt[1],ht=vn(It)?o.countCols()-1:Math.max(It-ft,0),Ke=o.toPhysicalColumn(ht);Number.isInteger(It)&&(It=Math.max(It-ft,0));var Be=l.removeCol(It,bt,L);if(Be){var at=g.fixedColumnsStart;at>=ht+1&&(g.fixedColumnsStart-=Math.min(bt,at-ht)),Array.isArray(g.colHeaders)&&(typeof Ke>"u"&&(Ke=-1),g.colHeaders.splice(Ke,bt)),ft+=bt}})};Array.isArray(O)?gt(Y(O)):gt([[O,I]]),f.adjustRowsAndCols(),o._refreshBorders();break;default:throw new Error('There is no such action "'.concat(C,'"'))}V||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var C=g.minRows,O=g.minSpareRows,S=g.minCols,A=g.minSpareCols;if(o.countRows()===0&&o.countCols()===0&&x.deselect(),C){var I=o.countRows();I<C&&l.createRow(I,C-I,{source:"auto"})}if(O){var L=o.countEmptyRows(!0);if(L<O){var V=O-L,Y=Math.min(V,g.maxRows-o.countSourceRows());l.createRow(o.countRows(),Y,{source:"auto"})}}{var ae;(S||A)&&(ae=o.countEmptyCols(!0));var re=o.countCols();if(S&&!g.columns&&re<S){var te=S-re;ae+=te,l.createCol(re,te,{source:"auto"})}if(A&&!g.columns&&o.dataType==="array"&&ae<A){re=o.countCols();var ge=A-ae,H=Math.min(ge,g.maxCols-re);l.createCol(re,H,{source:"auto"})}}if(x.isSelected()){var Ce=o.countRows(),oe=o.countCols();ne(x.selectedRange,function(Oe){var Ee=!1,be=Oe.from.row,Ie=Oe.from.col,Me=Oe.to.row,j=Oe.to.col;be>Ce-1?(be=Ce-1,Ee=!0,Me>be&&(Me=be)):Me>Ce-1&&(Me=Ce-1,Ee=!0,be>Me&&(be=Me)),Ie>oe-1?(Ie=oe-1,Ee=!0,j>Ie&&(j=Ie)):j>oe-1&&(j=oe-1,Ee=!0,Ie>j&&(Ie=j)),Ee&&o.selectCell(be,Ie,Me,j)})}o.view&&o.view.adjustElementsSize()},populateFromArray:function(C,O,S,A,I,L,V){var Y,ae,re,te,ge=[],H={},Ce=[],oe=C.row,Oe=C.col;if(ae=O.length,ae===0)return!1;var Ee=0,be=0;switch(kt(S)&&(Ee=S.col-Oe+1,be=S.row-oe+1),I){case"shift_down":var Ie=Sm(O),Me=Ie.length,j=Math.max(Me,Ee),U=o.getData().slice(oe),Q=Sm(U).slice(Oe,Oe+j);for(re=0;re<j;re+=1)if(re<Me){for(Y=0,ae=Ie[re].length;Y<be-ae;Y+=1)Ie[re].push(Ie[re][Y%ae]);re<Q.length?Ce.push(Ie[re].concat(Q[re])):Ce.push(Ie[re].concat(new Array(U.length).fill(null)))}else Ce.push(Ie[re%Me].concat(Q[re]));o.populateFromArray(oe,Oe,Sm(Ce));break;case"shift_right":var fe=O.length,ee=Math.max(fe,be),pe=o.getData().slice(oe).map(function(at){return at.slice(Oe)});for(Y=0;Y<ee;Y+=1)if(Y<fe){for(re=0,te=O[Y].length;re<Ee-te;re+=1)O[Y].push(O[Y][re%te]);if(Y<pe.length)for(var se=0;se<pe[Y].length;se+=1)O[Y].push(pe[Y][se]);else{var ue;(ue=O[Y]).push.apply(ue,Gh(new Array(pe[0].length).fill(null)))}}else O.push(O[Y%ae].slice(0,ee).concat(pe[Y]));o.populateFromArray(oe,Oe,O);break;case"overwrite":default:H.row=C.row,H.col=C.col;var ce={row:S&&C?S.row-C.row+1:1,col:S&&C?S.col-C.col+1:1},ve=0,de=0,Te=!0,$e,Fe=function(He){var ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,je=O[He%O.length];return ot!==null?je[ot%je.length]:je},it=O.length,gt=S?S.row-C.row+1:0;for(S?ae=gt:ae=Math.max(it,gt),Y=0;Y<ae&&!(S&&H.row>S.row&&gt>it||!g.allowInsertRow&&H.row>o.countRows()-1||H.row>=g.maxRows);Y++){var Ht=Y-ve,ut=Fe(Ht).length,ft=S?S.col-C.col+1:0;if(S?te=ft:te=Math.max(ut,ft),H.col=C.col,$e=o.getCellMeta(H.row,H.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&$e.skipRowOnPaste){ve+=1,H.row+=1,ae+=1;continue}for(de=0,re=0;re<te&&!(S&&H.col>S.col&&ft>ut||!g.allowInsertColumn&&H.col>o.countCols()-1||H.col>=g.maxCols);re++){if($e=o.getCellMeta(H.row,H.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&$e.skipColumnOnPaste){de+=1,H.col+=1,te+=1;continue}if($e.readOnly&&A!=="UndoRedo.undo"){H.col+=1;continue}var Tt=re-de,Lt=Fe(Ht,Tt),It=o.getDataAtCell(H.row,H.col),bt={row:Ht,col:Tt};if(A==="Autofill.fill"){var ht=o.runHooks("beforeAutofillInsidePopulate",bt,L,O,V,{},ce);ht&&(Lt=pr(ht.value)?Lt:ht.value)}if(Lt!==null&&Oi(Lt)==="object")if(Array.isArray(Lt)&&It===null&&(It=[]),It===null||Oi(It)!=="object")Te=!1;else{var Ke=cv(Array.isArray(It)?It:It[0]||It),Be=cv(Array.isArray(Lt)?Lt:Lt[0]||Lt);DF(Ke,Be)||Array.isArray(Ke)&&Array.isArray(Be)?Lt=qn(Lt):Te=!1}else It!==null&&Oi(It)==="object"&&(Te=!1);Te&&ge.push([H.row,H.col,Lt]),Te=!0,H.col+=1}H.row+=1}o.setDataAtCell(ge,null,null,A||"populateFromArray");break}}};function E(w){var C=Eoe(w);n3(C)?(o.runHooks("beforeLanguageChange",C),y.language=C,o.runHooks("afterLanguageChange",C)):Roe(w)}function P(w,C){var O=w==="className"?o.rootElement:o.table;if(h)ke(O,C);else{var S=[],A=[];y[w]&&(S=Array.isArray(y[w])?y[w]:BM(y[w])),C&&(A=Array.isArray(C)?C:BM(C));var I=HM(S,A),L=HM(A,S);I.length&&wt(O,I),L.length&&ke(O,L)}y[w]=C}this.init=function(){u.setData(g.data),o.runHooks("beforeInit"),(oo()||LF())&&ke(o.rootElement,"mobile"),this.updateSettings(g,!0),this.view=new I7e(this),c=Lje.getInstance(o,g,x),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&o.rootElement.offsetParent===null&&zie(o.rootElement,function(){o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),Oi(h)==="object"&&(o.runHooks("afterChange",h[0],h[1]),h=!1),o.runHooks("afterInit")};function R(){var w=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,w=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&w===!1&&(w=!0,this.onQueueEmpty(this.valid))}}}function M(w){var C=w.replace(",",".");return isNaN(parseFloat(C))===!1?parseFloat(C):w}function D(w,C,O){if(w.length){var S=o.getActiveEditor(),A=o.runHooks("beforeChange",w,C||"edit"),I=!0;if(A===!1){S&&S.cancelChanges();return}var L=new R;L.onQueueEmpty=function(Ce){S&&I&&S.cancelChanges(),O(Ce)};for(var V=w.length-1;V>=0;V--)if(w[V]===null)w.splice(V,1);else{var Y=Ro(w[V],4),ae=Y[0],re=Y[1],te=Y[3],ge=l.propToCol(re),H=o.getCellMeta(ae,ge);H.type==="numeric"&&typeof te=="string"&&vae(te)&&(w[V][3]=M(te)),o.getCellValidator(H)&&(L.addValidatorToQueue(),o.validateCell(w[V][3],H,function(Ce,oe){return function(Oe){if(typeof Oe!="boolean")throw new Error("Validation error: result is not boolean");if(Oe===!1&&oe.allowInvalid===!1){I=!1,w.splice(Ce,1),oe.valid=!0;var Ee=o.getCell(oe.visualRow,oe.visualCol);Ee!==null&&wt(Ee,g.invalidCellClassName)}L.removeValidatorFormQueue()}}(V,H),C))}L.checkIfQueueIsEmpty()}}function N(w,C){var O=w.length-1;if(!(O<0)){for(;O>=0;O--){var S=!1;if(w[O]===null){w.splice(O,1);continue}if(!((w[O][2]===null||w[O][2]===void 0)&&(w[O][3]===null||w[O][3]===void 0))){if(g.allowInsertRow)for(;w[O][0]>o.countRows()-1;){var A=l.createRow(void 0,void 0,{source:C}),I=A.delta;if(I===0){S=!0;break}}if(o.dataType==="array"&&(!g.columns||g.columns.length===0)&&g.allowInsertColumn)for(;l.propToCol(w[O][1])>o.countCols()-1;){var L=l.createCol(void 0,void 0,{source:C}),V=L.delta;if(V===0){S=!0;break}}S||l.set(w[O][0],w[O][1],w[O][3])}}o.forceFullRender=!0,f.adjustRowsAndCols(),o.runHooks("beforeChangeRender",w,C),c.lockEditor(),o._refreshBorders(null),c.unlockEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",w,C||"edit");var Y=o.getActiveEditor();Y&&Xe(Y.refreshValue)&&Y.refreshValue()}}this._createCellCoords=function(w,C){return o.view._wt.createCellCoords(w,C)},this._createCellRange=function(w,C,O){return o.view._wt.createCellRange(w,C,O)},this.validateCell=function(w,C,O,S){var A=o.getCellValidator(C);function I(L){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!V||C.hidden===!0){O(L);return}var Y=C.visualCol,ae=C.visualRow,re=o.getCell(ae,Y,!0);if(re&&re.nodeName!=="TH"){var te=o.rowIndexMapper.getRenderableFromVisualIndex(ae),ge=o.columnIndexMapper.getRenderableFromVisualIndex(Y);o.view._wt.getSetting("cellRenderer",te,ge,re)}O(L)}Die(A)&&(A=function(L){return function(V,Y){Y(L.test(V))}}(A)),wr(A)?(w=o.runHooks("beforeValidate",w,C.visualRow,C.prop,S),o._registerImmediate(function(){A.call(C,w,function(L){o&&(L=o.runHooks("afterValidate",L,w,C.visualRow,C.prop,S),C.valid=L,I(L),o.runHooks("postAfterValidate",L,w,C.visualRow,C.prop,S))})})):o._registerImmediate(function(){C.valid=!0,I(C.valid,!1)})};function B(w,C,O){return Array.isArray(w)?w:[[w,C,O]]}this.setDataAtCell=function(w,C,O,S){var A=B(w,C,O),I=[],L=S,V,Y,ae;for(V=0,Y=A.length;V<Y;V++){if(Oi(A[V])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof A[V][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");A[V][1]>=this.countCols()?ae=A[V][1]:ae=l.colToProp(A[V][1]),I.push([A[V][0],ae,u.getAtCell(this.toPhysicalRow(A[V][0]),A[V][1]),A[V][2]])}!L&&Oi(w)==="object"&&(L=C),o.runHooks("afterSetDataAtCell",I,L),D(I,L,function(){N(I,L)})},this.setDataAtRowProp=function(w,C,O,S){var A=B(w,C,O),I=[],L=S,V,Y;for(V=0,Y=A.length;V<Y;V++)I.push([A[V][0],A[V][1],u.getAtCell(this.toPhysicalRow(A[V][0]),A[V][1]),A[V][2]]);!L&&Oi(w)==="object"&&(L=C),o.runHooks("afterSetDataAtRowProp",I,L),D(I,L,function(){N(I,L)})},this.listen=function(){o&&!o.isListening()&&(HA=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(HA=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return HA===o.guid},this.destroyEditor=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o._refreshBorders(w,C)},this.populateFromArray=function(w,C,O,S,A,I,L,V,Y){if(!(Oi(O)==="object"&&Oi(O[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var ae=typeof S=="number"?o._createCellCoords(S,A):null;return f.populateFromArray(o._createCellCoords(w,C),O,ae,I,L,V,Y)},this.spliceCol=function(w,C,O){for(var S,A=arguments.length,I=new Array(A>3?A-3:0),L=3;L<A;L++)I[L-3]=arguments[L];return(S=l).spliceCol.apply(S,[w,C,O].concat(I))},this.spliceRow=function(w,C,O){for(var S,A=arguments.length,I=new Array(A>3?A-3:0),L=3;L<A;L++)I[L-3]=arguments[L];return(S=l).spliceRow.apply(S,[w,C,O].concat(I))},this.getSelected=function(){if(x.isSelected())return Rt(x.getSelectedRange(),function(w){var C=w.from,O=w.to;return[C.row,C.col,O.row,O.col]})},this.getSelectedLast=function(){var w=this.getSelected(),C;return w&&w.length>0&&(C=w[w.length-1]),C},this.getSelectedRange=function(){if(x.isSelected())return Array.from(x.getSelectedRange())},this.getSelectedRangeLast=function(){var w=this.getSelectedRange(),C;return w&&w.length>0&&(C=w[w.length-1]),C},this.emptySelectedCells=function(w){var C=this;if(!(!x.isSelected()||this.countRows()===0||this.countCols()===0)){var O=[];ne(x.getSelectedRange(),function(S){var A=S.getTopStartCorner(),I=S.getBottomEndCorner();rt(A.row,I.row,function(L){rt(A.col,I.col,function(V){C.getCellMeta(L,V).readOnly||O.push([L,V,null])})})}),O.length>0&&this.setDataAtCell(O,w)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var w=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(w,0),!this.isRenderSuspended()&&w===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(w){this.suspendRender();var C=w();return this.resumeRender(),C},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(C,0),(!this.isExecutionSuspended()&&C===this.executionSuspendedCounter||w)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var O=w();return this.resumeExecution(C),O},this.batch=function(w){this.suspendRender(),this.suspendExecution();var C=w();return this.resumeExecution(),this.resumeRender(),C},this.refreshDimensions=function(){if(o.view){var w=o.view.getLastSize(),C=w.width,O=w.height,S=o.rootElement.getBoundingClientRect(),A=S.width,I=S.height,L=A!==C||I!==O,V=o.runHooks("beforeRefreshDimensions",{width:C,height:O},{width:A,height:I},L)===!1;V||((L||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(A,I),o.render()),o.runHooks("afterRefreshDimensions",{width:C,height:O},{width:A,height:I},L))}},this.updateData=function(w,C){var O=this;UG(w,function(S){l=S},function(S){l=S,o.columnIndexMapper.fitToLength(O.getInitialColumnCount()),o.rowIndexMapper.fitToLength(O.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:C,metaManager:p,firstRun:h})},this.loadData=function(w,C){UG(w,function(O){l=O},function(){p.clearCellsCache(),o.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:C,metaManager:p,firstRun:h})},this.getInitialColumnCount=function(){var w=g.columns,C=0;if(Array.isArray(w))C=w.length;else if(wr(w))if(o.dataType==="array")for(var O=this.countSourceCols(),S=0;S<O;S+=1)w(S)&&(C+=1);else(o.dataType==="object"||o.dataType==="function")&&(C=l.colToPropCache.length);else if(Xe(g.dataSchema)){var A=l.getSchema();C=Array.isArray(A)?A.length:qO(A)}else C=this.countSourceCols();return C},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(w,C,O,S){return pr(w)?l.getAll():l.getRange(o._createCellCoords(w,C),o._createCellCoords(O,S),l.DESTINATION_RENDERER)},this.getCopyableText=function(w,C,O,S){return l.getCopyableText(o._createCellCoords(w,C),o._createCellCoords(O,S))},this.getCopyableData=function(w,C){return l.getCopyable(w,l.colToProp(C))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,O=(h?o.loadData:o.updateData).bind(this),S=!1,A,I;if(Xe(w.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Xe(w.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Xe(w.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(A in w)A==="data"||(A==="language"?E(w.language):A==="className"?P("className",w.className):A==="tableClassName"&&o.table?(P("tableClassName",w.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Je.getSingleton().isRegistered(A)||Je.getSingleton().isDeprecated(A)?(wr(w[A])||Array.isArray(w[A]))&&(w[A].initialHook=!0,o.addHook(A,w[A])):!C&&Br(w,A)&&(y[A]=w[A]));w.data===void 0&&g.data===void 0?O(null,"updateSettings"):w.data!==void 0?O(w.data,"updateSettings"):w.columns!==void 0&&(l.createMap(),o.initIndexMappers());var L=o.countCols(),V=g.columns;if(V&&wr(V)&&(S=!0),(w.cell!==void 0||w.cells!==void 0||w.columns!==void 0)&&p.clearCache(),L>0)for(A=0,I=0;A<L;A++){if(V){var Y=S?V(A):V[I];Y&&p.updateColumnMeta(I,Y)}I+=1}Xe(w.cell)&&At(w.cell,function(Ce){o.setCellMetaObject(Ce.row,Ce.col,Ce)}),o.runHooks("afterCellMetaReset");var ae=o.rootElement.style.height;ae!==""&&(ae=parseInt(o.rootElement.style.height,10));var re=w.height;if(wr(re)&&(re=re()),C){var te=o.rootElement.getAttribute("style");te&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(re===null){var ge=o.rootElement.getAttribute("data-initialstyle");ge&&(ge.indexOf("height")>-1||ge.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",ge):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else re!==void 0&&(o.rootElement.style.height=isNaN(re)?"".concat(re):"".concat(re,"px"),o.rootElement.style.overflow="hidden");if(typeof w.width<"u"){var H=w.width;wr(H)&&(H=H()),o.rootElement.style.width=isNaN(H)?"".concat(H):"".concat(H,"px")}C||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",w)),f.adjustRowsAndCols(),o.view&&!h&&(o.forceFullRender=!0,c.lockEditor(),o._refreshBorders(null),o.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!C&&o.view&&(ae===""||re===""||re===void 0)&&ae!==re&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var w=o.getSelectedLast();if(g.getValue){if(wr(g.getValue))return g.getValue.call(o);if(w)return o.getData()[w[0][0]][g.getValue]}else if(w)return o.getDataAtCell(w[0],w[1])},this.getSettings=function(){return g},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(w,C,O,S,A){f.alter(w,C,O,S,A)},this.getCell=function(w,C){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,S=C,A=w;if(C>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(C)))return null;S=this.columnIndexMapper.getRenderableFromVisualIndex(C)}if(w>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(w)))return null;A=this.rowIndexMapper.getRenderableFromVisualIndex(w)}return A===null||S===null?null:o.view.getCellAtCoords(o._createCellCoords(A,S),O)},this.getCoords=function(w){var C=this.view._wt.wtTable.getCoords(w);if(C===null)return null;var O=C.row,S=C.col,A=O,I=S;return O>=0&&(A=this.rowIndexMapper.getVisualFromRenderableIndex(O)),S>=0&&(I=this.columnIndexMapper.getVisualFromRenderableIndex(S)),o._createCellCoords(A,I)},this.colToProp=function(w){return l.colToProp(w)},this.propToCol=function(w){return l.propToCol(w)},this.toVisualRow=function(w){return n.rowIndexMapper.getVisualFromPhysicalIndex(w)},this.toVisualColumn=function(w){return n.columnIndexMapper.getVisualFromPhysicalIndex(w)},this.toPhysicalRow=function(w){return n.rowIndexMapper.getPhysicalFromVisualIndex(w)},this.toPhysicalColumn=function(w){return n.columnIndexMapper.getPhysicalFromVisualIndex(w)},this.getDataAtCell=function(w,C){return l.get(w,l.colToProp(C))},this.getDataAtRowProp=function(w,C){return l.get(w,C)},this.getDataAtCol=function(w){for(var C=[],O=l.getRange(o._createCellCoords(0,w),o._createCellCoords(g.data.length-1,w),l.DESTINATION_RENDERER),S=0;S<O.length;S+=1)for(var A=0;A<O[S].length;A+=1)C.push(O[S][A]);return C},this.getDataAtProp=function(w){for(var C=[],O=l.getRange(o._createCellCoords(0,l.propToCol(w)),o._createCellCoords(g.data.length-1,l.propToCol(w)),l.DESTINATION_RENDERER),S=0;S<O.length;S+=1)for(var A=0;A<O[S].length;A+=1)C.push(O[S][A]);return C},this.getSourceData=function(w,C,O,S){var A;return w===void 0?A=u.getData():A=u.getByRange(o._createCellCoords(w,C),o._createCellCoords(O,S)),A},this.getSourceDataArray=function(w,C,O,S){var A;return w===void 0?A=u.getData(!0):A=u.getByRange(o._createCellCoords(w,C),o._createCellCoords(O,S),!0),A},this.getSourceDataAtCol=function(w){return u.getAtColumn(w)},this.setSourceDataAtCell=function(w,C,O,S){var A=B(w,C,O),I=this.hasHook("afterSetSourceDataAtCell"),L=[];I&&ne(A,function(Y){var ae=Ro(Y,3),re=ae[0],te=ae[1],ge=ae[2];L.push([re,te,u.getAtCell(re,te),ge])}),ne(A,function(Y){var ae=Ro(Y,3),re=ae[0],te=ae[1],ge=ae[2];u.setAtCell(re,te,ge)}),I&&this.runHooks("afterSetSourceDataAtCell",L,S),this.render();var V=o.getActiveEditor();V&&Xe(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(w){return u.getAtRow(w)},this.getSourceDataAtCell=function(w,C){return u.getAtCell(w,C)},this.getDataAtRow=function(w){var C=l.getRange(o._createCellCoords(w,0),o._createCellCoords(w,this.countCols()-1),l.DESTINATION_RENDERER);return C[0]||[]},this.getDataType=function(w,C,O,S){var A=this,I=w===void 0?[0,0,this.countRows(),this.countCols()]:[w,C,O,S],L=I[0],V=I[1],Y=I[2],ae=I[3],re=null,te=null;Y===void 0&&(Y=L),ae===void 0&&(ae=V);var ge="mixed";return rt(Math.max(Math.min(L,Y),0),Math.max(L,Y),function(H){var Ce=!0;return rt(Math.max(Math.min(V,ae),0),Math.max(V,ae),function(oe){var Oe=A.getCellMeta(H,oe);return te=Oe.type,re?Ce=re===te:re=te,Ce}),ge=Ce?te:"mixed",Ce}),ge},this.removeCellMeta=function(w,C,O){var S=[this.toPhysicalRow(w),this.toPhysicalColumn(C)],A=S[0],I=S[1],L=p.getCellMetaKeyValue(A,I,O),V=o.runHooks("beforeRemoveCellMeta",w,C,O,L);V!==!1&&(p.removeCellMeta(A,I,O),o.runHooks("afterRemoveCellMeta",w,C,O,L)),L=null},this.spliceCellsMeta=function(w){for(var C=this,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=arguments.length,A=new Array(S>2?S-2:0),I=2;I<S;I++)A[I-2]=arguments[I];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");O>0&&p.removeRow(this.toPhysicalRow(w),O),A.length>0&&ne(A.reverse(),function(L){p.createRow(C.toPhysicalRow(w)),ne(L,function(V,Y){return C.setCellMetaObject(w,Y,V)})}),o.render()},this.setCellMetaObject=function(w,C,O){var S=this;Oi(O)==="object"&&At(O,function(A,I){S.setCellMeta(w,C,I,A)})},this.setCellMeta=function(w,C,O,S){var A=o.runHooks("beforeSetCellMeta",w,C,O,S);if(A!==!1){var I=w,L=C;w<this.countRows()&&(I=this.toPhysicalRow(w)),C<this.countCols()&&(L=this.toPhysicalColumn(C)),p.setCellMeta(I,L,O,S),o.runHooks("afterSetCellMeta",w,C,O,S)}},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(w,C){var O=this.toPhysicalRow(w),S=this.toPhysicalColumn(C);return O===null&&(O=w),S===null&&(S=C),p.getCellMeta(O,S,{visualRow:w,visualColumn:C})},this.getCellMetaAtRow=function(w){return p.getCellsMetaAtRow(w)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||g.columns)},this.getCellRenderer=function(w,C){var O=typeof w=="number"?o.getCellMeta(w,C).renderer:w.renderer;return typeof O=="string"?Lx(O):pr(O)?Lx("text"):O},this.getCellEditor=function(w,C){var O=typeof w=="number"?o.getCellMeta(w,C).editor:w.editor;return typeof O=="string"?$x(O):pr(O)?$x("text"):O},this.getCellValidator=function(w,C){var O=typeof w=="number"?o.getCellMeta(w,C).validator:w.validator;return typeof O=="string"?yH(O):O},this.validateCells=function(w){this._validateCells(w)},this.validateRows=function(w,C){if(!Array.isArray(w))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(C,w)},this.validateColumns=function(w,C){if(!Array.isArray(w))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(C,void 0,w)},this._validateCells=function(w,C,O){var S=new R;w&&(S.onQueueEmpty=w);for(var A=o.countRows()-1;A>=0;){if(C!==void 0&&C.indexOf(A)===-1){A-=1;continue}for(var I=o.countCols()-1;I>=0;){if(O!==void 0&&O.indexOf(I)===-1){I-=1;continue}S.addValidatorToQueue(),o.validateCell(o.getDataAtCell(A,I),o.getCellMeta(A,I),function(L){if(typeof L!="boolean")throw new Error("Validation error: result is not boolean");L===!1&&(S.valid=!1),S.removeValidatorFormQueue()},"validateCells"),I-=1}A-=1}S.checkIfQueueIsEmpty()},this.getRowHeader=function(w){var C=g.rowHeaders,O=w;return O!==void 0&&(O=o.runHooks("modifyRowHeader",O)),O===void 0?(C=[],rt(o.countRows()-1,function(S){C.push(o.getRowHeader(S))})):Array.isArray(C)&&C[O]!==void 0?C=C[O]:wr(C)?C=C(O):C&&typeof C!="string"&&typeof C!="number"&&(C=O+1),C},this.hasRowHeaders=function(){return!!g.rowHeaders},this.hasColHeaders=function(){if(g.colHeaders!==void 0&&g.colHeaders!==null)return!!g.colHeaders;for(var w=0,C=o.countCols();w<C;w++)if(o.getColHeader(w))return!0;return!1},this.getColHeader=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,O=o.runHooks("modifyColHeader",w);if(O===void 0){for(var S=[],A=o.countCols(),I=0;I<A;I++)S.push(o.getColHeader(I));return S}var L=g.colHeaders,V=function(te){for(var ge=[],H=o.countCols(),Ce=0;Ce<H;Ce++)wr(g.columns)&&g.columns(Ce)&&ge.push(Ce);return ge[te]},Y=o.toPhysicalColumn(O),ae=V(Y);return g.colHeaders===!1?L=null:g.columns&&wr(g.columns)&&g.columns(ae)&&g.columns(ae).title?L=g.columns(ae).title:g.columns&&g.columns[Y]&&g.columns[Y].title?L=g.columns[Y].title:Array.isArray(g.colHeaders)&&g.colHeaders[Y]!==void 0?L=g.colHeaders[Y]:wr(g.colHeaders)?L=g.colHeaders(Y):g.colHeaders&&typeof g.colHeaders!="string"&&typeof g.colHeaders!="number"&&(L=pE(O)),L=o.runHooks("modifyColumnHeaderValue",L,w,C),L},this._getColWidthFromSettings=function(w){var C;if(w>=0){var O=o.getCellMeta(0,w);C=O.width}if((C===void 0||C===g.width)&&(C=g.colWidths),C!=null){switch(Oi(C)){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getColWidth=function(w){var C=o._getColWidthFromSettings(w);return C=o.runHooks("modifyColWidth",C,w),C===void 0&&(C=mH.DEFAULT_WIDTH),C},this._getRowHeightFromSettings=function(w){var C=g.rowHeights;if(C!=null){switch(Oi(C)){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getRowHeight=function(w){var C=o._getRowHeightFromSettings(w);return C=o.runHooks("modifyRowHeight",C,w),C},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var w=g.maxCols,C=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(w,C)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return Nx(o.countRows()-1,function(O){if(o.isEmptyRow(O))C+=1;else if(w===!0)return!1}),C},this.countEmptyCols=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return Nx(o.countCols()-1,function(O){if(o.isEmptyCol(O))C+=1;else if(w===!0)return!1}),C},this.isEmptyRow=function(w){return g.isEmptyRow.call(o,w)},this.isEmptyCol=function(w){return g.isEmptyCol.call(o,w)},this.selectCell=function(w,C,O,S){var A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return pr(w)||pr(C)?!1:this.selectCells([[w,C,O,S]],A,I)},this.selectCells=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;C===!1&&(a=!0);var S=x.selectCells(w);return S&&O&&o.listen(),a=!1,S},this.selectColumns=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w;return x.selectColumns(w,C)},this.selectRows=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w;return x.selectRows(w,C)},this.deselectCell=function(){x.deselect()},this.selectAll=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,C=w&&this.hasRowHeaders(),O=w&&this.hasColHeaders();a=!0,x.selectAll(C,O),a=!1};var K=function(C,O){return C.getNearestNotHiddenIndex(O,1,!0)};this.scrollViewportTo=function(w,C){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=!O,L=!S,V=w,Y=C;if(A){var ae=Number.isInteger(w),re=Number.isInteger(C),te=ae?K(this.rowIndexMapper,w):void 0,ge=re?K(this.columnIndexMapper,C):void 0;if(te===null||ge===null)return!1;V=ae?o.rowIndexMapper.getRenderableFromVisualIndex(te):void 0,Y=re?o.columnIndexMapper.getRenderableFromVisualIndex(ge):void 0}var H=Number.isInteger(V),Ce=Number.isInteger(Y);return H&&Ce?o.view.scrollViewport(o._createCellCoords(V,Y),I,S,O,L):H&&Ce===!1?o.view.scrollViewportVertically(V,I,O):Ce&&H===!1?o.view.scrollViewportHorizontally(Y,S,L):!1},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),p.clearCache(),V2(o)){var w=this.rootDocument.querySelector(".hot-display-license-info");w&&w.parentNode.removeChild(w)}po(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(function(){o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),m.getItems().forEach(function(C){var O=Ro(C,2),S=O[1];S.destroy()}),m.clear(),o.runHooks("afterDestroy")},!0),Je.getSingleton().destroy(o),At(o,function(C,O,S){wr(C)?S[O]=Z(O):O!=="guid"&&(S[O]=null)}),o.isDestroyed=!0,l&&l.destroy(),o.rowIndexMapper=null,o.columnIndexMapper=null,l=null,f=null,x=null,c=null,o=null};function Z(w){return function(){throw new Error('The "'.concat(w,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(w){var C=$i(w);return C==="UndoRedo"?this.undoRedo:m.getItem(C)},this.getPluginName=function(w){return w===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:m.getId(w)},this.getInstance=function(){return o},this.addHook=function(w,C){Je.getSingleton().add(w,C,o)},this.hasHook=function(w){return Je.getSingleton().has(w,o)||Je.getSingleton().has(w)},this.addHookOnce=function(w,C){Je.getSingleton().once(w,C,o)},this.removeHook=function(w,C){Je.getSingleton().remove(w,C,o)},this.runHooks=function(w,C,O,S,A,I,L){return Je.getSingleton().run(o,w,C,O,S,A,I,L)},this.getTranslatedPhrase=function(w,C){return $oe(g.language,w,C)},this.toHTML=function(){return h2(n)},this.toTableElement=function(){var w=n.rootDocument.createElement("div");return w.insertAdjacentHTML("afterbegin",h2(n)),w.firstElementChild},this.timeouts=[],this._registerTimeout=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=w;typeof O=="function"&&(O=setTimeout(O,C)),this.timeouts.push(O)},this._clearTimeouts=function(){ne(this.timeouts,function(w){clearTimeout(w)})},this.immediates=[],this._registerImmediate=function(w){this.immediates.push(setImmediate(w))},this._clearImmediates=function(){ne(this.immediates,function(w){clearImmediate(w)})},this._refreshBorders=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(w),o.view.render(),C&&x.isSelected()&&c.prepareEditor()},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};var ie=tQe({handleEvent:function(C){var O=o.isListening(),S=(C==null?void 0:C.key)!==void 0;return O&&S},beforeKeyDown:function(C){return n.runHooks("beforeKeyDown",C)},afterKeyDown:function(C){n.isDestroyed||o.runHooks("afterDocumentKeyDown",C)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(w){w.ctrlKey===!1&&w.metaKey===!1&&ie.releasePressedKeys()}),this.getShortcutManager=function(){return ie};var me=ie.addContext("grid"),k={runOnlyIf:function(){return Xe(o.getSelected())&&o.countRenderedRows()>0&&o.countRenderedCols()>0},group:lQe};ie.setActiveContextName("grid"),me.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){o.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var C=o.getSelectedRange(),O=C[C.length-1].highlight,S=O.row,A=O.col,I=o.getDataAtCell(S,A),L=new Map,V=0;V<C.length;V++)C[V].forAll(function(Y,ae){if(Y>=0&&ae>=0&&(Y!==S||ae!==A)){var re=o.getCellMeta(Y,ae),te=re.readOnly;te||L.set("".concat(Y,"x").concat(ae),[Y,ae,I])}});o.setDataAtCell(Array.from(L.values()))},runOnlyIf:function(){return o.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){x.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){x.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(0,1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){x.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C=o.getSelectedRangeLast(),O=C.from,S=C.to,A=o.rowIndexMapper.getNearestNotHiddenIndex(0,1);x.setRangeStart(O.clone()),x.setRangeEnd(o._createCellCoords(A,S.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){x.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){x.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){x.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C=o.getSelectedRangeLast(),O=C.from,S=C.to,A=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1);x.setRangeStart(O.clone()),x.setRangeEnd(o._createCellCoords(A,S.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){x.transformStart(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast().highlight.row,S=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Gh(o.isRtl()?[o.countCols()-1,-1]:[0,1]));x.setRangeStart(o._createCellCoords(O,S))}},{keys:[["ArrowLeft","Shift"]],callback:function(){x.transformEnd(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast(),S=O.from,A=O.to,I=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Gh(o.isRtl()?[o.countCols()-1,-1]:[0,1]));x.setRangeStart(S.clone()),x.setRangeEnd(o._createCellCoords(A.row,I))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){x.transformStart(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast().highlight.row,S=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Gh(o.isRtl()?[0,1]:[o.countCols()-1,-1]));x.setRangeStart(o._createCellCoords(O,S))}},{keys:[["ArrowRight","Shift"]],callback:function(){x.transformEnd(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast(),S=O.from,A=O.to,I=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Gh(o.isRtl()?[0,1]:[o.countCols()-1,-1]));x.setRangeStart(S.clone()),x.setRangeEnd(o._createCellCoords(A.row,I))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var C=parseInt(o.getSettings().fixedColumnsStart,10),O=o.getSelectedRangeLast().highlight.row,S=o.columnIndexMapper.getNearestNotHiddenIndex(C,1);x.setRangeStart(o._createCellCoords(O,S))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){x.setRangeEnd(o._createCellCoords(x.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var C=parseInt(o.getSettings().fixedRowsTop,10),O=parseInt(o.getSettings().fixedColumnsStart,10),S=o.rowIndexMapper.getNearestNotHiddenIndex(C,1),A=o.columnIndexMapper.getNearestNotHiddenIndex(O,1);x.setRangeStart(o._createCellCoords(S,A))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){x.setRangeStart(o._createCellCoords(o.getSelectedRangeLast().highlight.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){x.setRangeEnd(o._createCellCoords(x.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var C=parseInt(o.getSettings().fixedRowsBottom,10),O=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-C-1,-1),S=o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1);x.setRangeStart(o._createCellCoords(O,S))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){x.transformStart(-o.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var C=o.getSelectedRangeLast(),O=C.to,S=Math.max(O.row-o.countVisibleRows(),0),A=o.rowIndexMapper.getNearestNotHiddenIndex(S,1);if(A!==null){var I=o._createCellCoords(A,O.col),L=O.row-o.view.getFirstFullyVisibleRow(),V=Math.max(I.row-L,0);x.setRangeEnd(I),o.scrollViewportTo(V)}}},{keys:[["PageDown"]],callback:function(){x.transformStart(o.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var C=o.getSelectedRangeLast(),O=C.to,S=Math.min(O.row+o.countVisibleRows(),o.countRows()-1),A=o.rowIndexMapper.getNearestNotHiddenIndex(S,-1);if(A!==null){var I=o._createCellCoords(A,O.col),L=O.row-o.view.getFirstFullyVisibleRow(),V=Math.min(I.row-L,o.countRows()-1);x.setRangeEnd(I),o.scrollViewportTo(V)}}},{keys:[["Tab"]],callback:function(C){var O=typeof g.tabMoves=="function"?g.tabMoves(C):g.tabMoves;x.transformStart(O.row,O.col,!0)}},{keys:[["Shift","Tab"]],callback:function(C){var O=typeof g.tabMoves=="function"?g.tabMoves(C):g.tabMoves;x.transformStart(-O.row,-O.col)}}],k),gH().forEach(function(w){var C=c_(w);m.addItem(w,new C(n))}),Je.getSingleton().run(o,"construct")}var uQe="hooksRefRegisterer",ese={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;ne(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;At(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};as(ese,"MIXIN_NAME",uQe,{writable:!1,enumerable:!1});const fQe=ese;function Yv(e){return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yv(e)}function cQe(e,t){return pQe(e)||vQe(e,t)||dQe(e,t)||hQe()}function hQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dQe(e,t){if(e){if(typeof e=="string")return QG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QG(e,t)}}function QG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vQe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function pQe(e){if(Array.isArray(e))return e}function gQe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pD(e,t)}function pD(e,t){return pD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pD(e,t)}function yQe(e){var t=wQe();return function(){var n=gT(e),i;if(t){var a=gT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mQe(this,i)}}function mQe(e,t){if(t&&(Yv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bQe(e)}function bQe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gT(e){return gT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gT(e)}function e9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Qe(n.key),n)}}function r9(e,t,r){return t&&t9(e.prototype,t),r&&t9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Qe(e){var t=SQe(e,"string");return Yv(t)==="symbol"?t:String(t)}function SQe(e,t){if(Yv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CQe="base",xn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),gD="baseEditor",Lg=function(){function e(t){e9(this,e),this.hot=t,this.instance=t,this.state=xn.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return r9(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,a,o,s){this.TD=a,this.row=r,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=xn.VIRGIN}},{key:"extend",value:function(){return function(r){gQe(i,r);var n=yQe(i);function i(){return e9(this,i),n.apply(this,arguments)}return r9(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,a,o,s,l;if(n){var u=this.hot.getSelectedLast();a=Math.max(Math.min(u[0],u[2]),0),o=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];a=f[0],o=f[1],s=f[2],l=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",a,o);if(Array.isArray(c)){var h=cQe(c,2);a=h[0],o=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),p={runOnlyIf:function(){return Xe(i.hot.getSelected())},group:gD};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],p),this.hot.populateFromArray(a,o,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===xn.VIRGIN){var i=this.hot,a=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(a,o)),this.state=xn.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:Vr(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var a=this,o;if(i){var s=this._closeCallback;this._closeCallback=function(c){s&&s(c),i(c),a.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(gD),u.removeShortcutsByGroup(dE),this.state===xn.VIRGIN){this.hot._registerTimeout(function(){a._fireCallbacks(!0)});return}if(this.state===xn.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:o=[[f]],this.state=xn.WAITING,this.saveValue(o,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){a.state=xn.FINISHED,a.discardEditor(c)}):(this.state=xn.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=xn.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===xn.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=xn.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=xn.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===xn.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,a=i.wtOverlays,o=i.wtViewport,s=this.hot.rootWindow,l=tn(n),u=fr(n),f=tn(this.hot.rootElement),c=fr(this.hot.rootElement),h=a.topOverlay.holder,d=a.inlineStartOverlay.holder,v=h!==s?h.scrollTop:0,p=d!==s?d.scrollLeft:0,g=s.innerWidth-f.left-c,y=(r=a.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,m=y.wtTable,b=m.name,_=["master","inline_start"].includes(b)?v:0,x=["master","top","bottom"].includes(b)?p:0,T=l.top===f.top?0:1,E=l.top-f.top-T-_,P=0;this.hot.isRtl()?P=s.innerWidth-l.left-u-g-1+x:P=l.left-f.left-1-x,["top","top_inline_start_corner"].includes(b)&&(E+=a.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(P+=Math.abs(a.inlineStartOverlay.getOverlayOffset()));var R=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),D=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),N=this.hot.rowIndexMapper.getRenderableIndexesLength(),B=N-this.hot.view._wt.getSetting("fixedRowsBottom");(R&&M<=0||M===B)&&(E+=1),D<=0&&(P+=1);var K=o.rowsRenderCalculator.startPosition,Z=o.columnsRenderCalculator.startPosition,ie=Math.abs(a.inlineStartOverlay.getScrollPosition()),me=a.topOverlay.getScrollPosition(),k=Sn(this.hot.rootDocument),w=n.offsetTop+K-me,C=0;if(this.hot.isRtl()){var O=n.offsetLeft;O>=0?C=m.getWidth()-n.offsetLeft:C=Math.abs(O),C+=Z-ie-u}else C=n.offsetLeft+Z-ie;var S=Lu(this.TD,this.hot.rootWindow),A=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",I=parseInt(S[A],10)>0?0:1,L=parseInt(S.borderTopWidth,10)>0?0:1,V=fr(n)+I,Y=$r(n)+L,ae=jie(h)?k:0,re=Wie(d)?k:0,te=this.hot.view.maximumVisibleElementWidth(C)-ae+I,ge=Math.max(this.hot.view.maximumVisibleElementHeight(w)-re+L,23);return{top:E,start:P,height:Y,maxHeight:ge,width:V,maxWidth:te}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return CQe}}]),e}();mr(Lg,fQe);function xQe(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),a=function(d,v,p){d.addEventListener(v,p,!1)},o=function(d,v,p){d.removeEventListener(v,p,!1)},s=function(d){var v,p;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,i.style.position="absolute",i.style.fontSize=c(t).fontSize,i.style.fontFamily=c(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),v=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",p=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>p?t.style.height=e.minHeight+"px":e.maxHeight<p?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=p+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var p=parseInt(d.maxHeight);isNaN(p)||(e.maxHeight=p)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var g=parseInt(d.minWidth);isNaN(g)||(e.minWidth=g)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var y=parseInt(d.maxWidth);isNaN(y)||(e.maxWidth=y)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},f=function(d,v,p){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),p&&(a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)),s()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,p){f(d,v,p)},unObserve:function(){o(t,"change",s),o(t,"cut",l),o(t,"paste",l),o(t,"drop",l),o(t,"keydown",l),o(t,"focus",s),o(t,"compositionstart",l),o(t,"compositionupdate",l),o(t,"compositionend",l)},resize:s}}function n9(e,t){for(var r=lH(t),n=t.value.split(`
`),i=r,a=0,o=0;o<n.length;o++){var s=n[o];o!==0&&(a+=n[o-1].length+1);var l=a+s.length;if(e==="home"?i=a:e==="end"&&(i=l),r<=l)break}s_(t,i)}function Kv(e){return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kv(e)}function i9(e,t){return RQe(e)||EQe(e,t)||OQe(e,t)||TQe()}function TQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OQe(e,t){if(e){if(typeof e=="string")return a9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a9(e,t)}}function a9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EQe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function RQe(e){if(Array.isArray(e))return e}function kQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PQe(n.key),n)}}function AQe(e,t,r){return t&&o9(e.prototype,t),r&&o9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PQe(e){var t=IQe(e,"string");return Kv(t)==="symbol"?t:String(t)}function IQe(e,t){if(Kv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Im(){return typeof Reflect<"u"&&Reflect.get?Im=Reflect.get.bind():Im=function(t,r,n){var i=MQe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Im.apply(this,arguments)}function MQe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=jc(e),e!==null););return e}function DQe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yD(e,t)}function yD(e,t){return yD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yD(e,t)}function $Qe(e){var t=LQe();return function(){var n=jc(e),i;if(t){var a=jc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return NQe(this,i)}}function NQe(e,t){if(t&&(Kv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tse(e)}function tse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jc(e){return jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jc(e)}var FQe="ht_editor_visible",QS="ht_editor_hidden",s9="textEditor",HQe="text",hh=function(e){DQe(r,e);var t=$Qe(r);function r(n){var i;return kQe(this,r),i=t.call(this,n),i.eventManager=new Nr(tse(i)),i.autoResize=xQe(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return AQe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var a=this.hot.getShortcutManager();a.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this.state;if(Im(jc(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==xn.FINISHED&&this.hideEditableElement();var d=!h;d&&!oo()&&this.focus()}}},{key:"beginEditing",value:function(i,a){this.state===xn.VIRGIN&&(this.TEXTAREA.value="",Im(jc(r.prototype),"beginEditing",this).call(this,i,a))}},{key:"focus",value:function(){this.TEXTAREA.select(),s_(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,ke(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),ke(this.TEXTAREA_PARENT,"handsontableInputHolder"),mt(this.TEXTAREA_PARENT,this.layerClass)&&wt(this.TEXTAREA_PARENT,this.layerClass),ke(this.TEXTAREA_PARENT,QS),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Lne()||Nne())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",wt(this.TEXTAREA_PARENT,this.layerClass),ke(this.TEXTAREA_PARENT,QS)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,a=!1;rt(i.length-1,function(o){var s=i[o];if(mt(s,"handsontableEditor"))return a=!0,!1}),mt(this.TEXTAREA_PARENT,QS)&&wt(this.TEXTAREA_PARENT,QS),a?(this.layerClass=FQe,ke(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ke(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),a=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=a,this.setValue(a),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==xn.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var a=this.getEditedCellRect(),o=a.top,s=a.start,l=a.width,u=a.maxWidth,f=a.height,c=a.maxHeight;this.textareaParentStyle.top="".concat(o,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var h=Lu(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Lu(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),p=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),g=l-v,y=f-p,m=u-v,b=c-p;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,m),minHeight:Math.min(y,b),maxWidth:m,maxHeight:b},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(a){return a.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(a){return a.stopPropagation()}),NF()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={runOnlyIf:function(){return Xe(i.hot.getSelected())},group:s9},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};o.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(f){return!i.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:Rm,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:Rm,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:Rm,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=i9(c,1),d=h[0];n9(d,i.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=i9(c,1),d=h[0];n9(d,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(dE),a.removeShortcutsByGroup(s9),a.removeShortcutsByGroup(gD)}},{key:"onAfterDocumentKeyDown",value:function(i){var a=[Qe.ARROW_UP,Qe.ARROW_RIGHT,Qe.ARROW_DOWN,Qe.ARROW_LEFT];a.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return HQe}}]),r}(Lg),BQe="base";function b_(e,t,r,n,i,a,o){var s=[],l=[];o.className&&ke(t,o.className),o.readOnly&&s.push(o.readOnlyCellClassName),o.valid===!1&&o.invalidCellClassName?s.push(o.invalidCellClassName):l.push(o.invalidCellClassName),o.wordWrap===!1&&o.noWordWrapClassName&&s.push(o.noWordWrapClassName),!a&&o.placeholder&&s.push(o.placeholderCellClassName),wt(t,l),ke(t,s)}b_.RENDERER_TYPE=BQe;var VQe="text";function Gu(e,t,r,n,i,a,o){b_.apply(this,[e,t,r,n,i,a,o]);var s=a;if(!s&&o.placeholder&&(s=o.placeholder),s=Vr(s),o.trimWhitespace&&(s=s.trim()),o.rendererTemplate){po(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else Nu(t,s)}Gu.RENDERER_TYPE=VQe;var jQe="text",rse={CELL_TYPE:jQe,editor:hh,renderer:Gu};Ja(rse);ct.editors={BaseEditor:Lg};function ct(e,t){var r=new l3(e,t||{},AH);return r.init(),r}ct.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new l3(e,t,AH)};ct.DefaultSettings=Yoe();ct.hooks=Je.getSingleton();ct.CellCoords=Fx;ct.CellRange=bH;ct.packageName="handsontable";ct.buildDate="28/03/2023 12:24:11";ct.version="12.3.3";ct.languages={dictionaryKeys:uXe,getLanguageDictionary:Doe,getLanguagesDictionaries:yXe,registerLanguageDictionary:Moe,getTranslatedPhrase:$oe};var Wd=Symbol("unassigned"),WQe="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function yT(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function nse(e){var t=ct.hooks.getRegistered(),r={};Object.assign(r,ct.DefaultSettings);for(var n in r)r[n]={default:Wd};for(var i=0;i<t.length;i++)r[t[i]]={default:Wd};return r.settings={default:Wd},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function ise(e){var t={},r=e.settings;if(r!==Wd)for(var n in r)yT(r,n)&&r[n]!==Wd&&(t[n]=r[n]);for(var i in e)yT(e,i)&&i!=="settings"&&e[i]!==Wd&&(t[i]=e[i]);return t}function l9(e,t){var r=ise(e),n=e.settings?e.settings:r,i=e.settings?r:null,a={};for(var o in n)yT(n,o)&&n[o]!==void 0&&(!(t&&o!=="data")||!u9(t[o],n[o]))&&(a[o]=n[o]);for(var s in i)yT(i,s)&&s!=="id"&&s!=="settings"&&i[s]!==void 0&&(!(t&&s!=="data")||!u9(t[s],i[s]))&&(a[s]=i[s]);return a}function u9(e,t){return JSON.stringify(e)===JSON.stringify(t)}var UQe="12.3.3",u3=_i({name:"HotTable",props:nse("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=l9(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(WQe),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=l9(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=mce(new ct.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],i=[],a=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),o=this.hotInstance.isColumnModificationAllowed(),s=0;if(r&&r.length!==a&&r.length<a)for(var l=r.length;l<a;l++)n.push(l);if(o){var u;if(s=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==s&&r[0].length<s)for(var f=r[0].length;f<s;f++)i.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(a-1,r.length-a),o&&r.length!==0&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(s-1,r[0].length-s))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:UQe}),zQe=["id"];function GQe(e,t,r,n,i,a){return Yt(),vr("div",{id:e.id},[qq(e.$slots,"default")],8,zQe)}u3.render=GQe;u3.__file="src/HotTable.vue";function f9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function YQe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f9(Object(r),!0).forEach(function(n){KQe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KQe(e,t,r){return t=qQe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XQe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qQe(e){var t=XQe(e,"string");return typeof t=="symbol"?t:String(t)}var ZQe=_i({name:"HotColumn",props:nse("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=ise(this.$props),r=YQe({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});ZQe.__file="src/HotColumn.vue";function Xv(e){return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(e)}function JQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eet(n.key),n)}}function QQe(e,t,r){return t&&c9(e.prototype,t),r&&c9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eet(e){var t=tet(e,"string");return Xv(t)==="symbol"?t:String(t)}function tet(e,t){if(Xv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qa(){return typeof Reflect<"u"&&Reflect.get?Qa=Reflect.get.bind():Qa=function(t,r,n){var i=ret(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Qa.apply(this,arguments)}function ret(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gi(e),e!==null););return e}function net(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mD(e,t)}function mD(e,t){return mD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mD(e,t)}function iet(e){var t=set();return function(){var n=Gi(e),i;if(t){var a=Gi(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return aet(this,i)}}function aet(e,t){if(t&&(Xv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oet(e)}function oet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function set(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gi(e){return Gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gi(e)}var h9="handsontableEditor",uet="handsontable",f3=function(e){net(r,e);var t=iet(r);function r(){return JQe(this,r),t.apply(this,arguments)}return QQe(r,[{key:"open",value:function(){Qa(Gi(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),s_(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),Qa(Gi(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,a,o,s,l,u){Qa(Gi(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var p=this.getSourceData(v.row,v.col);p!==void 0&&f.setValue(p),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&nn(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(i,a){var o=this.hot.getSettings().onBeginEditing;o&&o()===!1||Qa(Gi(r.prototype),"beginEditing",this).call(this,i,a)}},{key:"createElements",value:function(){Qa(Gi(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,a,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}Qa(Gi(r.prototype),"finishEditing",this).call(this,i,a,o)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor");Qa(Gi(r.prototype),"registerShortcuts",this).call(this);var s={group:h9,relativeToGroup:dE,position:"before"},l=function(f,c){var h=i.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),go(c),i.hot.listen(),i.TEXTAREA.focus(),!1};o.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),l(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return l(h,f)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){Qa(Gi(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(h9)}}],[{key:"EDITOR_TYPE",get:function(){return uet}}]),r}(hh);function qv(e){return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(e)}function fet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ase(n.key),n)}}function cet(e,t,r){return t&&d9(e.prototype,t),r&&d9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gf(){return typeof Reflect<"u"&&Reflect.get?Gf=Reflect.get.bind():Gf=function(t,r,n){var i=het(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Gf.apply(this,arguments)}function het(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Is(e),e!==null););return e}function det(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bD(e,t)}function bD(e,t){return bD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bD(e,t)}function vet(e){var t=get();return function(){var n=Is(e),i;if(t){var a=Is(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pet(this,i)}}function pet(e,t){if(t&&(qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wD(e)}function wD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function get(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Is(e){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Is(e)}function yet(e,t,r){return t=ase(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ase(e){var t=met(e,"string");return qv(t)==="symbol"?t:String(t)}function met(e,t){if(qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BA=new WeakMap,bet="autocomplete",c3=function(e){det(r,e);var t=vet(r);function r(n){var i;return fet(this,r),i=t.call(this,n),yet(wD(i),"sortByRelevance",function(a,o,s){var l=[],u=[],f=a.length,c=o.length,h,d,v,p;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=e2(Vr(o[v])),s)p=d.indexOf(a);else{var g=this.cellProperties.locale;p=d.toLocaleLowerCase(g).indexOf(a.toLocaleLowerCase(g))}p!==-1&&(h=d.length-p-f,l.push({baseIndex:v,index:p,charsLeft:h,value:d}))}for(l.sort(function(y,m){if(m.index===-1)return-1;if(y.index===-1)return 1;if(y.index<m.index)return-1;if(m.index<y.index)return 1;if(y.index===m.index){if(y.charsLeft<m.charsLeft)return-1;if(y.charsLeft>m.charsLeft)return 1}return 0}),v=0,c=l.length;v<c;v++)u.push(l[v].baseIndex);return u}),i.query=null,i.strippedChoices=[],i.rawChoices=[],BA.set(wD(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return cet(r,[{key:"getValue",value:function(){var i=this,a=this.rawChoices.find(function(o){var s=i.stripValueIfNeeded(o);return s===i.TEXTAREA.value});return Xe(a)?a:this.TEXTAREA.value}},{key:"createElements",value:function(){Gf(Is(r.prototype),"createElements",this).call(this),ke(this.htContainer,"autocompleteEditor"),ke(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,a=BA.get(this);Gf(Is(r.prototype),"open",this).call(this);var o=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=Sn();l===0&&a.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return i.onBeforeKeyDown(u)}),o.updateSettings({colWidths:s?[fr(this.TEXTAREA)-2]:void 0,width:s?fr(this.TEXTAREA)+l:void 0,renderer:function(f,c,h,d,v,p,g){Gu(f,c,h,d,v,p,g);var y=i.cellProperties,m=y.filteringCaseSensitive,b=y.allowHtml,_=y.locale,x=i.query,T=Vr(p),E,P;T&&!b&&(E=m===!0?T.indexOf(x):T.toLocaleLowerCase(_).indexOf(x.toLocaleLowerCase(_)),E!==-1&&(P=T.substr(E,x.length),T=T.replace(P,"<strong>".concat(P,"</strong>")))),c.innerHTML=T},autoColumnSize:!0}),a.skipOne&&(a.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Gf(Is(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Gf(Is(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var a=this,o=this.cellProperties.source;this.query=i,typeof o=="function"?o.call(this.cellProperties,i,function(s){a.rawChoices=s,a.updateChoicesList(a.stripValuesIfNeeded(s))}):Array.isArray(o)?(this.rawChoices=o,this.updateChoicesList(this.stripValuesIfNeeded(o))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var a=lH(this.TEXTAREA),o=Bie(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,f=null,c=i;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(f=u[0]);else{for(var d=[],v=0,p=c.length;v<p&&!(s&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(Sm([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),s_(this.TEXTAREA,a,a===o?void 0:o)}},{key:"flipDropdownIfNeeded",value:function(){var i=vv(this.hot.view._wt.wtTable.TABLE),a=i===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(a||!a&&(o||o==="horizontal"))return!1;var s=tn(this.TEXTAREA),l=$r(this.TEXTAREA),u=this.getDropdownHeight(),f=i.scrollTop,c=$r(this.hot.view._wt.wtTable.THEAD),h=tn(i),d=s.top-h.top-c+f,v=i.scrollHeight-d-c-l,p=u>v&&d>v;return p?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(p?d:v,u),p}},{key:"limitDropdownIfNeeded",value:function(i,a){if(a>i){var o=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=l,s+=1;while(o<i);u=o-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+a-u,"px")),this.setDropdownHeight(o-l)}}},{key:"flipDropdown",value:function(i){var a=this.htEditor.rootElement.style;a.position="absolute",a.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+Sn(this.hot.rootDocument)+2,a=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:a?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,a=this.cellProperties.visibleRows;return this.strippedChoices.length>=a?a*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var a=this.cellProperties.allowHtml,o=Rt(i,function(l){return Vr(l)}),s=Rt(o,function(l){return a?l:e2(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var a=this.htEditor.getSelectedRangeLast(),o={row:a?a.from.row:-1},s=!1;return i===Qe.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(s=!0),i===Qe.ARROW_UP&&o.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var a=this,o=BA.get(this);if(o.skipOne=!1,nae(i.keyCode)||i.keyCode===Qe.BACKSPACE||i.keyCode===Qe.DELETE||i.keyCode===Qe.INSERT){var s=10;if(i.keyCode===Qe.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){a.queryChoices(a.TEXTAREA.value),o.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return bet}}]),r}(f3);function Zv(e){return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zv(e)}function wet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cet(n.key),n)}}function _et(e,t,r){return t&&v9(e.prototype,t),r&&v9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cet(e){var t=xet(e,"string");return Zv(t)==="symbol"?t:String(t)}function xet(e,t){if(Zv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_D(e,t)}function _D(e,t){return _D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_D(e,t)}function Oet(e){var t=ket();return function(){var n=mT(e),i;if(t){var a=mT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Eet(this,i)}}function Eet(e,t){if(t&&(Zv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ret(e)}function Ret(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ket(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mT(e){return mT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mT(e)}var Aet="checkbox",ose=function(e){Tet(r,e);var t=Oet(r);function r(){return wet(this,r),t.apply(this,arguments)}return _et(r,[{key:"beginEditing",value:function(i,a){if(a&&a.type==="mouseup"){var o=this.TD.querySelector('input[type="checkbox"]');mt(o,"htBadValue")||o.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return Aet}}]),r}(Lg),SD={},Pet={get exports(){return SD},set exports(e){SD=e}};const Iet=bce(dVe);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var i;{try{i=Iet}catch{}e.exports=n(i)}})(qP,function(r){var n=typeof r=="function",i=!!window.addEventListener,a=window.document,o=window.setTimeout,s=function(k,w,C,O){i?k.addEventListener(w,C,!!O):k.attachEvent("on"+w,C)},l=function(k,w,C,O){i?k.removeEventListener(w,C,!!O):k.detachEvent("on"+w,C)},u=function(k){return k.trim?k.trim():k.replace(/^\s+|\s+$/g,"")},f=function(k,w){return(" "+k.className+" ").indexOf(" "+w+" ")!==-1},c=function(k,w){f(k,w)||(k.className=k.className===""?w:k.className+" "+w)},h=function(k,w){k.className=u((" "+k.className+" ").replace(" "+w+" "," "))},d=function(k){return/Array/.test(Object.prototype.toString.call(k))},v=function(k){return/Date/.test(Object.prototype.toString.call(k))&&!isNaN(k.getTime())},p=function(k){var w=k.getDay();return w===0||w===6},g=function(k){return k%4===0&&k%100!==0||k%400===0},y=function(k,w){return[31,g(k)?29:28,31,30,31,30,31,31,30,31,30,31][w]},m=function(k){v(k)&&k.setHours(0,0,0,0)},b=function(k,w){return k.getTime()===w.getTime()},_=function(k,w,C){var O,S;for(O in w)S=k[O]!==void 0,S&&typeof w[O]=="object"&&w[O]!==null&&w[O].nodeName===void 0?v(w[O])?C&&(k[O]=new Date(w[O].getTime())):d(w[O])?C&&(k[O]=w[O].slice(0)):k[O]=_({},w[O],C):(C||!S)&&(k[O]=w[O]);return k},x=function(k,w,C){var O;a.createEvent?(O=a.createEvent("HTMLEvents"),O.initEvent(w,!0,!1),O=_(O,C),k.dispatchEvent(O)):a.createEventObject&&(O=a.createEventObject(),O=_(O,C),k.fireEvent("on"+w,O))},T=function(k){return k.month<0&&(k.year-=Math.ceil(Math.abs(k.month)/12),k.month+=12),k.month>11&&(k.year+=Math.floor(Math.abs(k.month)/12),k.month-=12),k},E={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},P=function(k,w,C){for(w+=k.firstDay;w>=7;)w-=7;return C?k.i18n.weekdaysShort[w]:k.i18n.weekdays[w]},R=function(k){var w=[],C="false";if(k.isEmpty)if(k.showDaysInNextAndPreviousMonths)w.push("is-outside-current-month"),k.enableSelectionDaysInNextAndPreviousMonths||w.push("is-selection-disabled");else return'<td class="is-empty"></td>';return k.isDisabled&&w.push("is-disabled"),k.isToday&&w.push("is-today"),k.isSelected&&(w.push("is-selected"),C="true"),k.hasEvent&&w.push("has-event"),k.isInRange&&w.push("is-inrange"),k.isStartRange&&w.push("is-startrange"),k.isEndRange&&w.push("is-endrange"),'<td data-day="'+k.day+'" class="'+w.join(" ")+'" aria-selected="'+C+'"><button class="pika-button pika-day" type="button" data-pika-year="'+k.year+'" data-pika-month="'+k.month+'" data-pika-day="'+k.day+'">'+k.day+"</button></td>"},M=function(k,w){k.setHours(0,0,0,0);var C=k.getDate(),O=k.getDay(),S=w,A=S-1,I=7,L=function(te){return(te+I-1)%I};k.setDate(C+A-L(O));var V=new Date(k.getFullYear(),0,S),Y=24*60*60*1e3,ae=(k.getTime()-V.getTime())/Y,re=1+Math.round((ae-A+L(V.getDay()))/I);return re},D=function(k,w,C,O){var S=new Date(C,w,k),A=n?r(S).isoWeek():M(S,O);return'<td class="pika-week">'+A+"</td>"},N=function(k,w,C,O){return'<tr class="pika-row'+(C?" pick-whole-week":"")+(O?" is-selected":"")+'">'+(w?k.reverse():k).join("")+"</tr>"},B=function(k){return"<tbody>"+k.join("")+"</tbody>"},K=function(k){var w,C=[];for(k.showWeekNumber&&C.push("<th></th>"),w=0;w<7;w++)C.push('<th scope="col"><abbr title="'+P(k,w)+'">'+P(k,w,!0)+"</abbr></th>");return"<thead><tr>"+(k.isRTL?C.reverse():C).join("")+"</tr></thead>"},Z=function(k,w,C,O,S,A){var I,L,V,Y=k._o,ae=C===Y.minYear,re=C===Y.maxYear,te='<div id="'+A+'" class="pika-title" role="heading" aria-live="assertive">',ge,H,Ce=!0,oe=!0;for(V=[],I=0;I<12;I++)V.push('<option value="'+(C===S?I-w:12+I-w)+'"'+(I===O?' selected="selected"':"")+(ae&&I<Y.minMonth||re&&I>Y.maxMonth?' disabled="disabled"':"")+">"+Y.i18n.months[I]+"</option>");for(ge='<div class="pika-label">'+Y.i18n.months[O]+'<select class="pika-select pika-select-month" tabindex="-1">'+V.join("")+"</select></div>",d(Y.yearRange)?(I=Y.yearRange[0],L=Y.yearRange[1]+1):(I=C-Y.yearRange,L=1+C+Y.yearRange),V=[];I<L&&I<=Y.maxYear;I++)I>=Y.minYear&&V.push('<option value="'+I+'"'+(I===C?' selected="selected"':"")+">"+I+"</option>");return H='<div class="pika-label">'+C+Y.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+V.join("")+"</select></div>",Y.showMonthAfterYear?te+=H+ge:te+=ge+H,ae&&(O===0||Y.minMonth>=O)&&(Ce=!1),re&&(O===11||Y.maxMonth<=O)&&(oe=!1),w===0&&(te+='<button class="pika-prev'+(Ce?"":" is-disabled")+'" type="button">'+Y.i18n.previousMonth+"</button>"),w===k._o.numberOfMonths-1&&(te+='<button class="pika-next'+(oe?"":" is-disabled")+'" type="button">'+Y.i18n.nextMonth+"</button>"),te+="</div>"},ie=function(k,w,C){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+C+'">'+K(k)+B(w)+"</table>"},me=function(k){var w=this,C=w.config(k);w._onMouseDown=function(S){if(w._v){S=S||window.event;var A=S.target||S.srcElement;if(A)if(f(A,"is-disabled")||(f(A,"pika-button")&&!f(A,"is-empty")&&!f(A.parentNode,"is-disabled")?(w.setDate(new Date(A.getAttribute("data-pika-year"),A.getAttribute("data-pika-month"),A.getAttribute("data-pika-day"))),C.bound&&o(function(){w.hide(),C.blurFieldOnSelect&&C.field&&C.field.blur()},100)):f(A,"pika-prev")?w.prevMonth():f(A,"pika-next")&&w.nextMonth()),f(A,"pika-select"))w._c=!0;else if(S.preventDefault)S.preventDefault();else return S.returnValue=!1,!1}},w._onChange=function(S){S=S||window.event;var A=S.target||S.srcElement;A&&(f(A,"pika-select-month")?w.gotoMonth(A.value):f(A,"pika-select-year")&&w.gotoYear(A.value))},w._onKeyChange=function(S){if(S=S||window.event,w.isVisible())switch(S.keyCode){case 13:case 27:C.field&&C.field.blur();break;case 37:w.adjustDate("subtract",1);break;case 38:w.adjustDate("subtract",7);break;case 39:w.adjustDate("add",1);break;case 40:w.adjustDate("add",7);break;case 8:case 46:w.setDate(null);break}},w._parseFieldValue=function(){if(C.parse)return C.parse(C.field.value,C.format);if(n){var S=r(C.field.value,C.format,C.formatStrict);return S&&S.isValid()?S.toDate():null}else return new Date(Date.parse(C.field.value))},w._onInputChange=function(S){var A;S.firedBy!==w&&(A=w._parseFieldValue(),v(A)&&w.setDate(A),w._v||w.show())},w._onInputFocus=function(){w.show()},w._onInputClick=function(){w.show()},w._onInputBlur=function(){var S=a.activeElement;do if(f(S,"pika-single"))return;while(S=S.parentNode);w._c||(w._b=o(function(){w.hide()},50)),w._c=!1},w._onClick=function(S){S=S||window.event;var A=S.target||S.srcElement,I=A;if(A){!i&&f(A,"pika-select")&&(A.onchange||(A.setAttribute("onchange","return;"),s(A,"change",w._onChange)));do if(f(I,"pika-single")||I===C.trigger)return;while(I=I.parentNode);w._v&&A!==C.trigger&&I!==C.trigger&&w.hide()}},w.el=a.createElement("div"),w.el.className="pika-single"+(C.isRTL?" is-rtl":"")+(C.theme?" "+C.theme:""),s(w.el,"mousedown",w._onMouseDown,!0),s(w.el,"touchend",w._onMouseDown,!0),s(w.el,"change",w._onChange),C.keyboardInput&&s(a,"keydown",w._onKeyChange),C.field&&(C.container?C.container.appendChild(w.el):C.bound?a.body.appendChild(w.el):C.field.parentNode.insertBefore(w.el,C.field.nextSibling),s(C.field,"change",w._onInputChange),C.defaultDate||(C.defaultDate=w._parseFieldValue(),C.setDefaultDate=!0));var O=C.defaultDate;v(O)?C.setDefaultDate?w.setDate(O,!0):w.gotoDate(O):w.gotoDate(new Date),C.bound?(this.hide(),w.el.className+=" is-bound",s(C.trigger,"click",w._onInputClick),s(C.trigger,"focus",w._onInputFocus),s(C.trigger,"blur",w._onInputBlur)):this.show()};return me.prototype={config:function(k){this._o||(this._o=_({},E,!0));var w=_(this._o,k,!0);w.isRTL=!!w.isRTL,w.field=w.field&&w.field.nodeName?w.field:null,w.theme=typeof w.theme=="string"&&w.theme?w.theme:null,w.bound=!!(w.bound!==void 0?w.field&&w.bound:w.field),w.trigger=w.trigger&&w.trigger.nodeName?w.trigger:w.field,w.disableWeekends=!!w.disableWeekends,w.disableDayFn=typeof w.disableDayFn=="function"?w.disableDayFn:null;var C=parseInt(w.numberOfMonths,10)||1;if(w.numberOfMonths=C>4?4:C,v(w.minDate)||(w.minDate=!1),v(w.maxDate)||(w.maxDate=!1),w.minDate&&w.maxDate&&w.maxDate<w.minDate&&(w.maxDate=w.minDate=!1),w.minDate&&this.setMinDate(w.minDate),w.maxDate&&this.setMaxDate(w.maxDate),d(w.yearRange)){var O=new Date().getFullYear()-10;w.yearRange[0]=parseInt(w.yearRange[0],10)||O,w.yearRange[1]=parseInt(w.yearRange[1],10)||O}else w.yearRange=Math.abs(parseInt(w.yearRange,10))||E.yearRange,w.yearRange>100&&(w.yearRange=100);return w},toString:function(k){return k=k||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,k):n?r(this._d).format(k):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(k,w){n&&r.isMoment(k)&&this.setDate(k.toDate(),w)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(k,w){if(!k)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof k=="string"&&(k=new Date(Date.parse(k))),!!v(k)){var C=this._o.minDate,O=this._o.maxDate;v(C)&&k<C?k=C:v(O)&&k>O&&(k=O),this._d=new Date(k.getTime()),m(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!w&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(k){var w=!0;if(v(k)){if(this.calendars){var C=new Date(this.calendars[0].year,this.calendars[0].month,1),O=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),S=k.getTime();O.setMonth(O.getMonth()+1),O.setDate(O.getDate()-1),w=S<C.getTime()||O.getTime()<S}w&&(this.calendars=[{month:k.getMonth(),year:k.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(k,w){var C=this.getDate()||new Date,O=parseInt(w)*24*60*60*1e3,S;k==="add"?S=new Date(C.valueOf()+O):k==="subtract"&&(S=new Date(C.valueOf()-O)),this.setDate(S)},adjustCalendars:function(){this.calendars[0]=T(this.calendars[0]);for(var k=1;k<this._o.numberOfMonths;k++)this.calendars[k]=T({month:this.calendars[0].month+k,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(k){isNaN(k)||(this.calendars[0].month=parseInt(k,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(k){isNaN(k)||(this.calendars[0].year=parseInt(k,10),this.adjustCalendars())},setMinDate:function(k){k instanceof Date?(m(k),this._o.minDate=k,this._o.minYear=k.getFullYear(),this._o.minMonth=k.getMonth()):(this._o.minDate=E.minDate,this._o.minYear=E.minYear,this._o.minMonth=E.minMonth,this._o.startRange=E.startRange),this.draw()},setMaxDate:function(k){k instanceof Date?(m(k),this._o.maxDate=k,this._o.maxYear=k.getFullYear(),this._o.maxMonth=k.getMonth()):(this._o.maxDate=E.maxDate,this._o.maxYear=E.maxYear,this._o.maxMonth=E.maxMonth,this._o.endRange=E.endRange),this.draw()},setStartRange:function(k){this._o.startRange=k},setEndRange:function(k){this._o.endRange=k},draw:function(k){if(!(!this._v&&!k)){var w=this._o,C=w.minYear,O=w.maxYear,S=w.minMonth,A=w.maxMonth,I="",L;this._y<=C&&(this._y=C,!isNaN(S)&&this._m<S&&(this._m=S)),this._y>=O&&(this._y=O,!isNaN(A)&&this._m>A&&(this._m=A));for(var V=0;V<w.numberOfMonths;V++)L="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),I+='<div class="pika-lendar">'+Z(this,V,this.calendars[V].year,this.calendars[V].month,this.calendars[0].year,L)+this.render(this.calendars[V].year,this.calendars[V].month,L)+"</div>";this.el.innerHTML=I,w.bound&&w.field.type!=="hidden"&&o(function(){w.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),w.bound&&w.field.setAttribute("aria-label",w.ariaLabel)}},adjustPosition:function(){var k,w,C,O,S,A,I,L,V,Y,ae,re;if(!this._o.container){if(this.el.style.position="absolute",k=this._o.trigger,w=k,C=this.el.offsetWidth,O=this.el.offsetHeight,S=window.innerWidth||a.documentElement.clientWidth,A=window.innerHeight||a.documentElement.clientHeight,I=window.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop,ae=!0,re=!0,typeof k.getBoundingClientRect=="function")Y=k.getBoundingClientRect(),L=Y.left+window.pageXOffset,V=Y.bottom+window.pageYOffset;else for(L=w.offsetLeft,V=w.offsetTop+w.offsetHeight;w=w.offsetParent;)L+=w.offsetLeft,V+=w.offsetTop;(this._o.reposition&&L+C>S||this._o.position.indexOf("right")>-1&&L-C+k.offsetWidth>0)&&(L=L-C+k.offsetWidth,ae=!1),(this._o.reposition&&V+O>A+I||this._o.position.indexOf("top")>-1&&V-O-k.offsetHeight>0)&&(V=V-O-k.offsetHeight,re=!1),this.el.style.left=L+"px",this.el.style.top=V+"px",c(this.el,ae?"left-aligned":"right-aligned"),c(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,ae?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function(k,w,C){var O=this._o,S=new Date,A=y(k,w),I=new Date(k,w,1).getDay(),L=[],V=[];m(S),O.firstDay>0&&(I-=O.firstDay,I<0&&(I+=7));for(var Y=w===0?11:w-1,ae=w===11?0:w+1,re=w===0?k-1:k,te=w===11?k+1:k,ge=y(re,Y),H=A+I,Ce=H;Ce>7;)Ce-=7;H+=7-Ce;for(var oe=!1,Oe=0,Ee=0;Oe<H;Oe++){var be=new Date(k,w,1+(Oe-I)),Ie=v(this._d)?b(be,this._d):!1,Me=b(be,S),j=O.events.indexOf(be.toDateString())!==-1,U=Oe<I||Oe>=A+I,Q=1+(Oe-I),fe=w,ee=k,pe=O.startRange&&b(O.startRange,be),se=O.endRange&&b(O.endRange,be),ue=O.startRange&&O.endRange&&O.startRange<be&&be<O.endRange,ce=O.minDate&&be<O.minDate||O.maxDate&&be>O.maxDate||O.disableWeekends&&p(be)||O.disableDayFn&&O.disableDayFn(be);U&&(Oe<I?(Q=ge+Q,fe=Y,ee=re):(Q=Q-A,fe=ae,ee=te));var ve={day:Q,month:fe,year:ee,hasEvent:j,isSelected:Ie,isToday:Me,isDisabled:ce,isEmpty:U,isStartRange:pe,isEndRange:se,isInRange:ue,showDaysInNextAndPreviousMonths:O.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:O.enableSelectionDaysInNextAndPreviousMonths};O.pickWholeWeek&&Ie&&(oe=!0),V.push(R(ve)),++Ee===7&&(O.showWeekNumber&&V.unshift(D(Oe-I,w,k,O.firstWeekOfYearMinDays)),L.push(N(V,O.isRTL,O.pickWholeWeek,oe)),V=[],Ee=0,oe=!1)}return ie(O,L,C)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(a,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var k=this._v;k!==!1&&(this._o.bound&&l(a,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,k!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var k=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),k.keyboardInput&&l(a,"keydown",this._onKeyChange),k.field&&(l(k.field,"change",this._onInputChange),k.bound&&(l(k.trigger,"click",this._onInputClick),l(k.trigger,"focus",this._onInputFocus),l(k.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},me})})(Pet);const p9=SD;function Jv(e){return Jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jv(e)}function Met(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$et(n.key),n)}}function Det(e,t,r){return t&&g9(e.prototype,t),r&&g9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $et(e){var t=Net(e,"string");return Jv(t)==="symbol"?t:String(t)}function Net(e,t){if(Jv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ts(){return typeof Reflect<"u"&&Reflect.get?Ts=Reflect.get.bind():Ts=function(t,r,n){var i=Let(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Ts.apply(this,arguments)}function Let(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=no(e),e!==null););return e}function Fet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CD(e,t)}function CD(e,t){return CD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CD(e,t)}function Het(e){var t=jet();return function(){var n=no(e),i;if(t){var a=no(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Bet(this,i)}}function Bet(e,t){if(t&&(Jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vet(e)}function Vet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function no(e){return no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},no(e)}var sse="date",y9="dateEditor",lse=function(e){Fet(r,e);var t=Het(r);function r(n){var i;return Met(this,r),i=t.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return Det(r,[{key:"init",value:function(){var i=this;if(typeof Ae!="function")throw new Error("You need to include moment.js to your project.");if(typeof p9!="function")throw new Error("You need to include Pikaday to your project.");Ts(no(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){Ts(no(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ke(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new Nr(this);i.addEventListener(this.datePicker,"mousedown",function(a){return a.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,a,o,s,l,u){Ts(no(r.prototype),"prepare",this).call(this,i,a,o,s,l,u)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=this.hot.getShortcutManager(),o=a.getContext("editor");Ts(no(r.prototype),"open",this).call(this),this.showDatepicker(i),o.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:y9})}},{key:"close",value:function(){var i,a=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){a.instance._refreshBorders()});var o=this.hot.getShortcutManager(),s=o.getContext("editor");s.removeShortcutsByGroup(y9),Ts(no(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var o=this.originalValue;o!==void 0&&this.setValue(o)}Ts(no(r.prototype),"finishEditing",this).call(this,i,a)}},{key:"showDatepicker",value:function(i){var a=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?dH(i.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new p9(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+a.top+$r(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=a.right-fr(this.datePicker):f=a.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,Ae(u,o,!0).isValid()&&this.$datePicker.setMoment(Ae(u,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,Ae(u,o,!0).isValid()&&this.$datePicker.setMoment(Ae(u,o),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,a=this.TEXTAREA,o={};this.cellProperties&&this.cellProperties.datePickerConfig&&r_(o,this.cellProperties.datePickerConfig);var s=o.onSelect,l=o.onClose;return o.field=a,o.trigger=a,o.container=this.datePicker,o.bound=!1,o.format=o.format||this.defaultDateFormat,o.reposition=o.reposition||!1,o.isRTL=!1,o.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=Ae(f).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(f),i.hideDatepicker(),s&&s()},o.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},o}}],[{key:"EDITOR_TYPE",get:function(){return sse}}]),r}(hh);function Qv(e){return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}function Wet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zet(n.key),n)}}function Uet(e,t,r){return t&&m9(e.prototype,t),r&&m9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zet(e){var t=Get(e,"string");return Qv(t)==="symbol"?t:String(t)}function Get(e,t){if(Qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _C(){return typeof Reflect<"u"&&Reflect.get?_C=Reflect.get.bind():_C=function(t,r,n){var i=Yet(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},_C.apply(this,arguments)}function Yet(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ep(e),e!==null););return e}function Ket(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xD(e,t)}function xD(e,t){return xD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xD(e,t)}function Xet(e){var t=Jet();return function(){var n=ep(e),i;if(t){var a=ep(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return qet(this,i)}}function qet(e,t){if(t&&(Qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zet(e)}function Zet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ep(e){return ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ep(e)}var Qet="dropdown",h3=function(e){Ket(r,e);var t=Xet(r);function r(){return Wet(this,r),t.apply(this,arguments)}return Uet(r,[{key:"prepare",value:function(i,a,o,s,l,u){_C(ep(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Qet}}]),r}(c3);Je.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===h3&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function tp(e){return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tp(e)}function ett(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rtt(n.key),n)}}function ttt(e,t,r){return t&&b9(e.prototype,t),r&&b9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rtt(e){var t=ntt(e,"string");return tp(t)==="symbol"?t:String(t)}function ntt(e,t){if(tp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function itt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TD(e,t)}function TD(e,t){return TD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TD(e,t)}function att(e){var t=ltt();return function(){var n=bT(e),i;if(t){var a=bT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ott(this,i)}}function ott(e,t){if(t&&(tp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return stt(e)}function stt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ltt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bT(e){return bT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bT(e)}var utt="numeric",use=function(e){itt(r,e);var t=att(r);function r(){return ett(this,r),t.apply(this,arguments)}return ttt(r,null,[{key:"EDITOR_TYPE",get:function(){return utt}}]),r}(hh);function rp(e){return rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rp(e)}function ftt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,htt(n.key),n)}}function ctt(e,t,r){return t&&w9(e.prototype,t),r&&w9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function htt(e){var t=dtt(e,"string");return rp(t)==="symbol"?t:String(t)}function dtt(e,t){if(rp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SC(){return typeof Reflect<"u"&&Reflect.get?SC=Reflect.get.bind():SC=function(t,r,n){var i=vtt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},SC.apply(this,arguments)}function vtt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=np(e),e!==null););return e}function ptt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OD(e,t)}function OD(e,t){return OD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OD(e,t)}function gtt(e){var t=btt();return function(){var n=np(e),i;if(t){var a=np(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ytt(this,i)}}function ytt(e,t){if(t&&(rp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mtt(e)}function mtt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function btt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function np(e){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(e)}var wtt="password",fse=function(e){ptt(r,e);var t=gtt(r);function r(){return ftt(this,r),t.apply(this,arguments)}return ctt(r,[{key:"createElements",value:function(){SC(np(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,po(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return wtt}}]),r}(hh);function Wc(e){return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wc(e)}function _tt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ctt(n.key),n)}}function Stt(e,t,r){return t&&_9(e.prototype,t),r&&_9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ctt(e){var t=xtt(e,"string");return Wc(t)==="symbol"?t:String(t)}function xtt(e,t){if(Wc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CC(){return typeof Reflect<"u"&&Reflect.get?CC=Reflect.get.bind():CC=function(t,r,n){var i=Ttt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},CC.apply(this,arguments)}function Ttt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ip(e),e!==null););return e}function Ott(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ED(e,t)}function ED(e,t){return ED=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ED(e,t)}function Ett(e){var t=Att();return function(){var n=ip(e),i;if(t){var a=ip(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Rtt(this,i)}}function Rtt(e,t){if(t&&(Wc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ktt(e)}function ktt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Att(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ip(e){return ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ip(e)}var VA="ht_editor_visible",S9="selectEditor",Ptt="select",Itt=function(e){Ott(r,e);var t=Ett(r);function r(){return _tt(this,r),t.apply(this,arguments)}return Stt(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),ke(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",mt(this.select,VA)&&wt(this.select,VA),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this;CC(ip(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),po(this.select),At(h,function(d,v){var p=f.hot.rootDocument.createElement("OPTION");p.value=v,fh(p,d),f.select.appendChild(p)})}},{key:"prepareOptions",value:function(i){var a={};if(Array.isArray(i))for(var o=0,s=i.length;o<s;o++)a[i[o]]=i[o];else Wc(i)==="object"&&(a=i);return a}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===xn.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),a=i.top,o=i.start,s=i.width,l=i.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(a,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),u.margin="0px",ke(this.select,VA)}}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={group:S9};this.isInFullEditMode()!==!1&&o.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=i.select.selectedIndex-1;u>=0&&(i.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=i.select.selectedIndex+1;u<=i.select.length-1&&(i.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(S9)}}],[{key:"EDITOR_TYPE",get:function(){return Ptt}}]),r}(Lg);function ap(e){return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function Mtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$tt(n.key),n)}}function Dtt(e,t,r){return t&&C9(e.prototype,t),r&&C9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $tt(e){var t=Ntt(e,"string");return ap(t)==="symbol"?t:String(t)}function Ntt(e,t){if(ap(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ap(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xC(){return typeof Reflect<"u"&&Reflect.get?xC=Reflect.get.bind():xC=function(t,r,n){var i=Ltt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},xC.apply(this,arguments)}function Ltt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=op(e),e!==null););return e}function Ftt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RD(e,t)}function RD(e,t){return RD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RD(e,t)}function Htt(e){var t=jtt();return function(){var n=op(e),i;if(t){var a=op(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Btt(this,i)}}function Btt(e,t){if(t&&(ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vtt(e)}function Vtt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function op(e){return op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},op(e)}var Wtt="time",cse=function(e){Ftt(r,e);var t=Htt(r);function r(){return Mtt(this,r),t.apply(this,arguments)}return Dtt(r,[{key:"prepare",value:function(i,a,o,s,l,u){xC(op(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return Wtt}}]),r}(hh);function Utt(){Ri(Lg),Ri(c3),Ri(ose),Ri(lse),Ri(h3),Ri(f3),Ri(use),Ri(fse),Ri(Itt),Ri(hh),Ri(cse)}var ztt="html";function d3(e,t,r,n,i,a,o){b_.apply(this,[e,t,r,n,i,a,o]),fh(t,a??"",!1)}d3.RENDERER_TYPE=ztt;var Gtt="autocomplete";function Fg(e,t,r,n,i,a,o){var s=e.rootDocument,l=o.allowHtml?d3:Gu,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,r,n,i,a,o]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),ke(t,"htAutocomplete"),!e.acArrowListener){var f=new Nr(e);e.acArrowListener=function(c){mt(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Fg.RENDERER_TYPE=Gtt;var x9=new WeakMap,T9=new WeakMap,Ytt="htBadValue",sp="data-row",lp="data-col",Ktt="checkboxRenderer",hse="checkbox";Je.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,i=t.type,a=t.row,o=t.column,s=t.prop;if(i===hse){if(n){var l=n.value,u=n.property,f=r;if(l)f=typeof l=="function"?l(a,o,s,r):l;else if(u){var c=this.getDataAtRowProp(a,u);f=c!==null?c:r}e=f}return e}});function v3(e,t,r,n,i,a,o){var s=e.rootDocument;b_.apply(this,[e,t,r,n,i,a,o]),Xtt(e);var l=qtt(s),u=o.label,f=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),po(t),a===o.checkedTemplate||Vr(a).toLocaleLowerCase(o.locale)===Vr(o.checkedTemplate).toLocaleLowerCase(o.locale)?l.checked=!0:a===o.uncheckedTemplate||Vr(a).toLocaleLowerCase(o.locale)===Vr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?l.checked=!1:vn(a)?ke(l,"noValue"):(l.style.display="none",ke(l,Ytt),f=!0),l.setAttribute(sp,r),l.setAttribute(lp,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,i,a):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=Ztt(s,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(l),t.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&t.appendChild(l),f&&t.appendChild(s.createTextNode("#bad-value#")),x9.has(e)||(x9.set(e,!0),v());function v(){var y=e.getShortcutManager(),m=y.getContext("grid"),b={group:Ktt};m.addShortcuts([{keys:[["space"]],callback:function(){return p(),!g()}},{keys:[["enter"]],callback:function(){return p(),!g()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return p(!0),!g()},relativeToGroup:Rm,position:"before"}],b)}function p(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=e.getSelectedRange();if(m)for(var b=0;b<m.length;b++){for(var _=m[b].getTopStartCorner(),x=_.row,T=_.col,E=m[b].getBottomEndCorner(),P=E.row,R=E.col,M=[],D=x;D<=P;D+=1)for(var N=T;N<=R;N+=1){var B=e.getCellMeta(D,N);if(B.type!=="checkbox")return;if(B.readOnly!==!0){typeof B.checkedTemplate>"u"&&(B.checkedTemplate=!0),typeof B.uncheckedTemplate>"u"&&(B.uncheckedTemplate=!1);var K=e.getDataAtCell(D,N);y===!1?[B.checkedTemplate,B.checkedTemplate.toString()].includes(K)?M.push([D,N,B.uncheckedTemplate]):[B.uncheckedTemplate,B.uncheckedTemplate.toString(),null,void 0].includes(K)&&M.push([D,N,B.checkedTemplate]):M.push([D,N,B.uncheckedTemplate])}}M.length>0&&e.setDataAtCell(M)}}function g(){var y=e.getSelectedRange();if(y){for(var m=0;m<y.length;m++)for(var b=y[m].getTopStartCorner(),_=y[m].getBottomEndCorner(),x=b.row;x<=_.row;x++)for(var T=b.col;T<=_.col;T++){var E=e.getCellMeta(x,T);if(E.type!=="checkbox")return!1;var P=e.getCell(x,T);if(P==null)return!0;var R=P.querySelectorAll("input[type=checkbox]");if(R.length>0&&!E.readOnly)return!0}return!1}}}v3.RENDERER_TYPE=hse;function Xtt(e){var t=T9.get(e);if(!t){var r=e.rootElement;t=new Nr(e),t.addEventListener(r,"click",function(n){return Qtt(n,e)}),t.addEventListener(r,"mouseup",function(n){return Jtt(n,e)}),t.addEventListener(r,"change",function(n){return ert(n,e)}),T9.set(e,t)}return t}function qtt(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function Ztt(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function Jtt(e,t){var r=e.target;p3(r)&&(!r.hasAttribute(sp)||!r.hasAttribute(lp)||setTimeout(t.listen,10))}function Qtt(e,t){var r=e.target;if(p3(r)&&!(!r.hasAttribute(sp)||!r.hasAttribute(lp))){var n=parseInt(r.getAttribute(sp),10),i=parseInt(r.getAttribute(lp),10),a=t.getCellMeta(n,i);a.readOnly&&e.preventDefault()}}function ert(e,t){var r=e.target;if(p3(r)&&!(!r.hasAttribute(sp)||!r.hasAttribute(lp))){var n=parseInt(r.getAttribute(sp),10),i=parseInt(r.getAttribute(lp),10),a=t.getCellMeta(n,i);if(!a.readOnly){var o=null;e.target.checked?o=a.uncheckedTemplate===void 0?!0:a.checkedTemplate:o=a.uncheckedTemplate===void 0?!1:a.uncheckedTemplate,t.setDataAtCell(n,i,o)}}}function p3(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function e1(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kD={},trt={get exports(){return kD},set exports(e){kD=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,a){function o(u,f){if(!i[u]){if(!n[u]){var c=typeof e1=="function"&&e1;if(!f&&c)return c(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(v){return o(n[u][1][v]||v)},d,d.exports,r,n,i,a)}return i[u].exports}for(var s=typeof e1=="function"&&e1,l=0;l<a.length;l++)o(a[l]);return o}({1:[function(r,n,i){(function(a){var o,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],g=1e7,y=1e9;function m(R){var M=0|R;return 0<R||R===M?M:M-1}function b(R){for(var M,D,N=1,B=R.length,K=R[0]+"";N<B;){for(M=R[N++]+"",D=d-M.length;D--;M="0"+M);K+=M}for(B=K.length;K.charCodeAt(--B)===48;);return K.slice(0,B+1||1)}function _(R,M){var D,N,B=R.c,K=M.c,Z=R.s,ie=M.s,me=R.e,k=M.e;if(!Z||!ie)return null;if(D=B&&!B[0],N=K&&!K[0],D||N)return D?N?0:-ie:Z;if(Z!=ie)return Z;if(D=Z<0,N=me==k,!B||!K)return N?0:!B^D?1:-1;if(!N)return k<me^D?1:-1;for(ie=(me=B.length)<(k=K.length)?me:k,Z=0;Z<ie;Z++)if(B[Z]!=K[Z])return B[Z]>K[Z]^D?1:-1;return me==k?0:k<me^D?1:-1}function x(R,M,D,N){if(R<M||D<R||R!==(R<0?l(R):u(R)))throw Error(f+(N||"Argument")+(typeof R=="number"?R<M||D<R?" out of range: ":" not an integer: ":" not a primitive number: ")+String(R))}function T(R){var M=R.c.length-1;return m(R.e/d)==M&&R.c[M]%2!=0}function E(R,M){return(1<R.length?R.charAt(0)+"."+R.slice(1):R)+(M<0?"e":"e+")+M}function P(R,M,D){var N,B;if(M<0){for(B=D+".";++M;B+=D);R=B+R}else if(++M>(N=R.length)){for(B=D,M-=N;--M;B+=D);R+=B}else M<N&&(R=R.slice(0,M)+"."+R.slice(M));return R}(o=function R(M){var D,N,B,K,Z,ie,me,k,w,C,O=oe.prototype={constructor:oe,toString:null,valueOf:null},S=new oe(1),A=20,I=4,L=-7,V=21,Y=-1e7,ae=1e7,re=!1,te=1,ge=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Ce="0123456789abcdefghijklmnopqrstuvwxyz";function oe(j,U){var Q,fe,ee,pe,se,ue,ce,ve,de=this;if(!(de instanceof oe))return new oe(j,U);if(U==null){if(j instanceof oe)return de.s=j.s,de.e=j.e,void(de.c=(j=j.c)?j.slice():j);if((ue=typeof j=="number")&&0*j==0){if(de.s=1/j<0?(j=-j,-1):1,j===~~j){for(pe=0,se=j;10<=se;se/=10,pe++);return de.e=pe,void(de.c=[j])}ve=String(j)}else{if(ve=String(j),!s.test(ve))return B(de,ve,ue);de.s=ve.charCodeAt(0)==45?(ve=ve.slice(1),-1):1}-1<(pe=ve.indexOf("."))&&(ve=ve.replace(".","")),0<(se=ve.search(/e/i))?(pe<0&&(pe=se),pe+=+ve.slice(se+1),ve=ve.substring(0,se)):pe<0&&(pe=ve.length)}else{if(x(U,2,Ce.length,"Base"),ve=String(j),U==10)return Ie(de=new oe(j instanceof oe?j:ve),A+de.e+1,I);if(ue=typeof j=="number"){if(0*j!=0)return B(de,ve,ue,U);if(de.s=1/j<0?(ve=ve.slice(1),-1):1,oe.DEBUG&&15<ve.replace(/^0\.0*|\./,"").length)throw Error(c+j);ue=!1}else de.s=ve.charCodeAt(0)===45?(ve=ve.slice(1),-1):1;for(Q=Ce.slice(0,U),pe=se=0,ce=ve.length;se<ce;se++)if(Q.indexOf(fe=ve.charAt(se))<0){if(fe=="."){if(pe<se){pe=ce;continue}}else if(!ee&&(ve==ve.toUpperCase()&&(ve=ve.toLowerCase())||ve==ve.toLowerCase()&&(ve=ve.toUpperCase()))){ee=!0,se=-1,pe=0;continue}return B(de,String(j),ue,U)}-1<(pe=(ve=N(ve,U,10,de.s)).indexOf("."))?ve=ve.replace(".",""):pe=ve.length}for(se=0;ve.charCodeAt(se)===48;se++);for(ce=ve.length;ve.charCodeAt(--ce)===48;);if(ve=ve.slice(se,++ce)){if(ce-=se,ue&&oe.DEBUG&&15<ce&&(v<j||j!==u(j)))throw Error(c+de.s*j);if(ae<(pe=pe-se-1))de.c=de.e=null;else if(pe<Y)de.c=[de.e=0];else{if(de.e=pe,de.c=[],se=(pe+1)%d,pe<0&&(se+=d),se<ce){for(se&&de.c.push(+ve.slice(0,se)),ce-=d;se<ce;)de.c.push(+ve.slice(se,se+=d));ve=ve.slice(se),se=d-ve.length}else se-=ce;for(;se--;ve+="0");de.c.push(+ve)}}else de.c=[de.e=0]}function Oe(j,U,Q,fe){var ee,pe,se,ue,ce;if(Q==null?Q=I:x(Q,0,8),!j.c)return j.toString();if(ee=j.c[0],se=j.e,U==null)ce=b(j.c),ce=fe==1||fe==2&&(se<=L||V<=se)?E(ce,se):P(ce,se,"0");else if(pe=(j=Ie(new oe(j),U,Q)).e,ue=(ce=b(j.c)).length,fe==1||fe==2&&(U<=pe||pe<=L)){for(;ue<U;ce+="0",ue++);ce=E(ce,pe)}else if(U-=se,ce=P(ce,pe,"0"),ue<pe+1){if(0<--U)for(ce+=".";U--;ce+="0");}else if(0<(U+=pe-ue))for(pe+1==ue&&(ce+=".");U--;ce+="0");return j.s<0&&ee?"-"+ce:ce}function Ee(j,U){for(var Q,fe=1,ee=new oe(j[0]);fe<j.length;fe++){if(!(Q=new oe(j[fe])).s){ee=Q;break}U.call(ee,Q)&&(ee=Q)}return ee}function be(j,U,Q){for(var fe=1,ee=U.length;!U[--ee];U.pop());for(ee=U[0];10<=ee;ee/=10,fe++);return(Q=fe+Q*d-1)>ae?j.c=j.e=null:j.c=Q<Y?[j.e=0]:(j.e=Q,U),j}function Ie(j,U,Q,fe){var ee,pe,se,ue,ce,ve,de,Te=j.c,$e=p;if(Te){e:{for(ee=1,ue=Te[0];10<=ue;ue/=10,ee++);if((pe=U-ee)<0)pe+=d,se=U,de=(ce=Te[ve=0])/$e[ee-se-1]%10|0;else if((ve=l((pe+1)/d))>=Te.length){if(!fe)break e;for(;Te.length<=ve;Te.push(0));ce=de=0,se=(pe%=d)-d+(ee=1)}else{for(ce=ue=Te[ve],ee=1;10<=ue;ue/=10,ee++);de=(se=(pe%=d)-d+ee)<0?0:ce/$e[ee-se-1]%10|0}if(fe=fe||U<0||Te[ve+1]!=null||(se<0?ce:ce%$e[ee-se-1]),fe=Q<4?(de||fe)&&(Q==0||Q==(j.s<0?3:2)):5<de||de==5&&(Q==4||fe||Q==6&&(0<pe?0<se?ce/$e[ee-se]:0:Te[ve-1])%10&1||Q==(j.s<0?8:7)),U<1||!Te[0])return Te.length=0,fe?(U-=j.e+1,Te[0]=$e[(d-U%d)%d],j.e=-U||0):Te[0]=j.e=0,j;if(pe==0?(Te.length=ve,ue=1,ve--):(Te.length=ve+1,ue=$e[d-pe],Te[ve]=0<se?u(ce/$e[ee-se]%$e[se])*ue:0),fe)for(;;){if(ve==0){for(pe=1,se=Te[0];10<=se;se/=10,pe++);for(se=Te[0]+=ue,ue=1;10<=se;se/=10,ue++);pe!=ue&&(j.e++,Te[0]==h&&(Te[0]=1));break}if(Te[ve]+=ue,Te[ve]!=h)break;Te[ve--]=0,ue=1}for(pe=Te.length;Te[--pe]===0;Te.pop());}j.e>ae?j.c=j.e=null:j.e<Y&&(j.c=[j.e=0])}return j}function Me(j){var U,Q=j.e;return Q===null?j.toString():(U=b(j.c),U=Q<=L||V<=Q?E(U,Q):P(U,Q,"0"),j.s<0?"-"+U:U)}return oe.clone=R,oe.ROUND_UP=0,oe.ROUND_DOWN=1,oe.ROUND_CEIL=2,oe.ROUND_FLOOR=3,oe.ROUND_HALF_UP=4,oe.ROUND_HALF_DOWN=5,oe.ROUND_HALF_EVEN=6,oe.ROUND_HALF_CEIL=7,oe.ROUND_HALF_FLOOR=8,oe.EUCLID=9,oe.config=oe.set=function(j){var U,Q;if(j!=null){if(typeof j!="object")throw Error(f+"Object expected: "+j);if(j.hasOwnProperty(U="DECIMAL_PLACES")&&(x(Q=j[U],0,y,U),A=Q),j.hasOwnProperty(U="ROUNDING_MODE")&&(x(Q=j[U],0,8,U),I=Q),j.hasOwnProperty(U="EXPONENTIAL_AT")&&((Q=j[U])&&Q.pop?(x(Q[0],-y,0,U),x(Q[1],0,y,U),L=Q[0],V=Q[1]):(x(Q,-y,y,U),L=-(V=Q<0?-Q:Q))),j.hasOwnProperty(U="RANGE"))if((Q=j[U])&&Q.pop)x(Q[0],-y,-1,U),x(Q[1],1,y,U),Y=Q[0],ae=Q[1];else{if(x(Q,-y,y,U),!Q)throw Error(f+U+" cannot be zero: "+Q);Y=-(ae=Q<0?-Q:Q)}if(j.hasOwnProperty(U="CRYPTO")){if((Q=j[U])!==!!Q)throw Error(f+U+" not true or false: "+Q);if(Q){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!Q,Error(f+"crypto unavailable");re=Q}else re=Q}if(j.hasOwnProperty(U="MODULO_MODE")&&(x(Q=j[U],0,9,U),te=Q),j.hasOwnProperty(U="POW_PRECISION")&&(x(Q=j[U],0,y,U),ge=Q),j.hasOwnProperty(U="FORMAT")){if(typeof(Q=j[U])!="object")throw Error(f+U+" not an object: "+Q);H=Q}if(j.hasOwnProperty(U="ALPHABET")){if(typeof(Q=j[U])!="string"||/^.$|[+-.\s]|(.).*\1/.test(Q))throw Error(f+U+" invalid: "+Q);Ce=Q}}return{DECIMAL_PLACES:A,ROUNDING_MODE:I,EXPONENTIAL_AT:[L,V],RANGE:[Y,ae],CRYPTO:re,MODULO_MODE:te,POW_PRECISION:ge,FORMAT:H,ALPHABET:Ce}},oe.isBigNumber=function(j){return j instanceof oe||j&&j._isBigNumber===!0||!1},oe.maximum=oe.max=function(){return Ee(arguments,O.lt)},oe.minimum=oe.min=function(){return Ee(arguments,O.gt)},oe.random=(K=9007199254740992,Z=Math.random()*K&2097151?function(){return u(Math.random()*K)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(j){var U,Q,fe,ee,pe,se=0,ue=[],ce=new oe(S);if(j==null?j=A:x(j,0,y),ee=l(j/d),re)if(crypto.getRandomValues){for(U=crypto.getRandomValues(new Uint32Array(ee*=2));se<ee;)9e15<=(pe=131072*U[se]+(U[se+1]>>>11))?(Q=crypto.getRandomValues(new Uint32Array(2)),U[se]=Q[0],U[se+1]=Q[1]):(ue.push(pe%1e14),se+=2);se=ee/2}else{if(!crypto.randomBytes)throw re=!1,Error(f+"crypto unavailable");for(U=crypto.randomBytes(ee*=7);se<ee;)9e15<=(pe=281474976710656*(31&U[se])+1099511627776*U[se+1]+4294967296*U[se+2]+16777216*U[se+3]+(U[se+4]<<16)+(U[se+5]<<8)+U[se+6])?crypto.randomBytes(7).copy(U,se):(ue.push(pe%1e14),se+=7);se=ee/7}if(!re)for(;se<ee;)(pe=Z())<9e15&&(ue[se++]=pe%1e14);for(ee=ue[--se],j%=d,ee&&j&&(pe=p[d-j],ue[se]=u(ee/pe)*pe);ue[se]===0;ue.pop(),se--);if(se<0)ue=[fe=0];else{for(fe=-1;ue[0]===0;ue.splice(0,1),fe-=d);for(se=1,pe=ue[0];10<=pe;pe/=10,se++);se<d&&(fe-=d-se)}return ce.e=fe,ce.c=ue,ce}),oe.sum=function(){for(var j=1,U=arguments,Q=new oe(U[0]);j<U.length;)Q=Q.plus(U[j++]);return Q},N=function(){var j="0123456789";function U(Q,fe,ee,pe){for(var se,ue,ce=[0],ve=0,de=Q.length;ve<de;){for(ue=ce.length;ue--;ce[ue]*=fe);for(ce[0]+=pe.indexOf(Q.charAt(ve++)),se=0;se<ce.length;se++)ce[se]>ee-1&&(ce[se+1]==null&&(ce[se+1]=0),ce[se+1]+=ce[se]/ee|0,ce[se]%=ee)}return ce.reverse()}return function(Q,fe,ee,pe,se){var ue,ce,ve,de,Te,$e,Fe,it,gt=Q.indexOf("."),Ht=A,ut=I;for(0<=gt&&(de=ge,ge=0,Q=Q.replace(".",""),$e=(it=new oe(fe)).pow(Q.length-gt),ge=de,it.c=U(P(b($e.c),$e.e,"0"),10,ee,j),it.e=it.c.length),ve=de=(Fe=U(Q,fe,ee,se?(ue=Ce,j):(ue=j,Ce))).length;Fe[--de]==0;Fe.pop());if(!Fe[0])return ue.charAt(0);if(gt<0?--ve:($e.c=Fe,$e.e=ve,$e.s=pe,Fe=($e=D($e,it,Ht,ut,ee)).c,Te=$e.r,ve=$e.e),gt=Fe[ce=ve+Ht+1],de=ee/2,Te=Te||ce<0||Fe[ce+1]!=null,Te=ut<4?(gt!=null||Te)&&(ut==0||ut==($e.s<0?3:2)):de<gt||gt==de&&(ut==4||Te||ut==6&&1&Fe[ce-1]||ut==($e.s<0?8:7)),ce<1||!Fe[0])Q=Te?P(ue.charAt(1),-Ht,ue.charAt(0)):ue.charAt(0);else{if(Fe.length=ce,Te)for(--ee;++Fe[--ce]>ee;)Fe[ce]=0,ce||(++ve,Fe=[1].concat(Fe));for(de=Fe.length;!Fe[--de];);for(gt=0,Q="";gt<=de;Q+=ue.charAt(Fe[gt++]));Q=P(Q,ve,ue.charAt(0))}return Q}}(),D=function(){function j(fe,ee,pe){var se,ue,ce,ve,de=0,Te=fe.length,$e=ee%g,Fe=ee/g|0;for(fe=fe.slice();Te--;)de=((ue=$e*(ce=fe[Te]%g)+(se=Fe*ce+(ve=fe[Te]/g|0)*$e)%g*g+de)/pe|0)+(se/g|0)+Fe*ve,fe[Te]=ue%pe;return de&&(fe=[de].concat(fe)),fe}function U(fe,ee,pe,se){var ue,ce;if(pe!=se)ce=se<pe?1:-1;else for(ue=ce=0;ue<pe;ue++)if(fe[ue]!=ee[ue]){ce=fe[ue]>ee[ue]?1:-1;break}return ce}function Q(fe,ee,pe,se){for(var ue=0;pe--;)fe[pe]-=ue,ue=fe[pe]<ee[pe]?1:0,fe[pe]=ue*se+fe[pe]-ee[pe];for(;!fe[0]&&1<fe.length;fe.splice(0,1));}return function(fe,ee,pe,se,ue){var ce,ve,de,Te,$e,Fe,it,gt,Ht,ut,ft,Tt,Lt,It,bt,ht,Ke,Be=fe.s==ee.s?1:-1,at=fe.c,He=ee.c;if(!(at&&at[0]&&He&&He[0]))return new oe(fe.s&&ee.s&&(at?!He||at[0]!=He[0]:He)?at&&at[0]==0||!He?0*Be:Be/0:NaN);for(Ht=(gt=new oe(Be)).c=[],Be=pe+(ve=fe.e-ee.e)+1,ue||(ue=h,ve=m(fe.e/d)-m(ee.e/d),Be=Be/d|0),de=0;He[de]==(at[de]||0);de++);if(He[de]>(at[de]||0)&&ve--,Be<0)Ht.push(1),Te=!0;else{for(It=at.length,ht=He.length,Be+=2,1<($e=u(ue/(He[de=0]+1)))&&(He=j(He,$e,ue),at=j(at,$e,ue),ht=He.length,It=at.length),Lt=ht,ft=(ut=at.slice(0,ht)).length;ft<ht;ut[ft++]=0);Ke=He.slice(),Ke=[0].concat(Ke),bt=He[0],He[1]>=ue/2&&bt++;do{if($e=0,(ce=U(He,ut,ht,ft))<0){if(Tt=ut[0],ht!=ft&&(Tt=Tt*ue+(ut[1]||0)),1<($e=u(Tt/bt)))for(ue<=$e&&($e=ue-1),it=(Fe=j(He,$e,ue)).length,ft=ut.length;U(Fe,ut,it,ft)==1;)$e--,Q(Fe,ht<it?Ke:He,it,ue),it=Fe.length,ce=1;else $e==0&&(ce=$e=1),it=(Fe=He.slice()).length;if(it<ft&&(Fe=[0].concat(Fe)),Q(ut,Fe,ft,ue),ft=ut.length,ce==-1)for(;U(He,ut,ht,ft)<1;)$e++,Q(ut,ht<ft?Ke:He,ft,ue),ft=ut.length}else ce===0&&($e++,ut=[0]);Ht[de++]=$e,ut[0]?ut[ft++]=at[Lt]||0:(ut=[at[Lt]],ft=1)}while((Lt++<It||ut[0]!=null)&&Be--);Te=ut[0]!=null,Ht[0]||Ht.splice(0,1)}if(ue==h){for(de=1,Be=Ht[0];10<=Be;Be/=10,de++);Ie(gt,pe+(gt.e=de+ve*d-1)+1,se,Te)}else gt.e=ve,gt.r=+Te;return gt}}(),ie=/^(-?)0([xbo])(?=\w[\w.]*$)/i,me=/^([^.]+)\.$/,k=/^\.([^.]+)$/,w=/^-?(Infinity|NaN)$/,C=/^\s*\+(?=[\w.])|^\s+|\s+$/g,B=function(j,U,Q,fe){var ee,pe=Q?U:U.replace(C,"");if(w.test(pe))j.s=isNaN(pe)?null:pe<0?-1:1,j.c=j.e=null;else{if(!Q&&(pe=pe.replace(ie,function(se,ue,ce){return ee=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,fe&&fe!=ee?se:ue}),fe&&(ee=fe,pe=pe.replace(me,"$1").replace(k,"0.$1")),U!=pe))return new oe(pe,ee);if(oe.DEBUG)throw Error(f+"Not a"+(fe?" base "+fe:"")+" number: "+U);j.c=j.e=j.s=null}},O.absoluteValue=O.abs=function(){var j=new oe(this);return j.s<0&&(j.s=1),j},O.comparedTo=function(j,U){return _(this,new oe(j,U))},O.decimalPlaces=O.dp=function(j,U){var Q,fe,ee;if(j!=null)return x(j,0,y),U==null?U=I:x(U,0,8),Ie(new oe(this),j+this.e+1,U);if(!(Q=this.c))return null;if(fe=((ee=Q.length-1)-m(this.e/d))*d,ee=Q[ee])for(;ee%10==0;ee/=10,fe--);return fe<0&&(fe=0),fe},O.dividedBy=O.div=function(j,U){return D(this,new oe(j,U),A,I)},O.dividedToIntegerBy=O.idiv=function(j,U){return D(this,new oe(j,U),0,1)},O.exponentiatedBy=O.pow=function(j,U){var Q,fe,ee,pe,se,ue,ce,ve,de=this;if((j=new oe(j)).c&&!j.isInteger())throw Error(f+"Exponent not an integer: "+Me(j));if(U!=null&&(U=new oe(U)),se=14<j.e,!de.c||!de.c[0]||de.c[0]==1&&!de.e&&de.c.length==1||!j.c||!j.c[0])return ve=new oe(Math.pow(+Me(de),se?2-T(j):+Me(j))),U?ve.mod(U):ve;if(ue=j.s<0,U){if(U.c?!U.c[0]:!U.s)return new oe(NaN);(fe=!ue&&de.isInteger()&&U.isInteger())&&(de=de.mod(U))}else{if(9<j.e&&(0<de.e||de.e<-1||(de.e==0?1<de.c[0]||se&&24e7<=de.c[1]:de.c[0]<8e13||se&&de.c[0]<=9999975e7)))return pe=de.s<0&&T(j)?-0:0,-1<de.e&&(pe=1/pe),new oe(ue?1/pe:pe);ge&&(pe=l(ge/d+2))}for(ce=se?(Q=new oe(.5),ue&&(j.s=1),T(j)):(ee=Math.abs(+Me(j)))%2,ve=new oe(S);;){if(ce){if(!(ve=ve.times(de)).c)break;pe?ve.c.length>pe&&(ve.c.length=pe):fe&&(ve=ve.mod(U))}if(ee){if((ee=u(ee/2))===0)break;ce=ee%2}else if(Ie(j=j.times(Q),j.e+1,1),14<j.e)ce=T(j);else{if((ee=+Me(j))==0)break;ce=ee%2}de=de.times(de),pe?de.c&&de.c.length>pe&&(de.c.length=pe):fe&&(de=de.mod(U))}return fe?ve:(ue&&(ve=S.div(ve)),U?ve.mod(U):pe?Ie(ve,ge,I,void 0):ve)},O.integerValue=function(j){var U=new oe(this);return j==null?j=I:x(j,0,8),Ie(U,U.e+1,j)},O.isEqualTo=O.eq=function(j,U){return _(this,new oe(j,U))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(j,U){return 0<_(this,new oe(j,U))},O.isGreaterThanOrEqualTo=O.gte=function(j,U){return(U=_(this,new oe(j,U)))===1||U===0},O.isInteger=function(){return!!this.c&&m(this.e/d)>this.c.length-2},O.isLessThan=O.lt=function(j,U){return _(this,new oe(j,U))<0},O.isLessThanOrEqualTo=O.lte=function(j,U){return(U=_(this,new oe(j,U)))===-1||U===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return 0<this.s},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(j,U){var Q,fe,ee,pe,se=this,ue=se.s;if(U=(j=new oe(j,U)).s,!ue||!U)return new oe(NaN);if(ue!=U)return j.s=-U,se.plus(j);var ce=se.e/d,ve=j.e/d,de=se.c,Te=j.c;if(!ce||!ve){if(!de||!Te)return de?(j.s=-U,j):new oe(Te?se:NaN);if(!de[0]||!Te[0])return Te[0]?(j.s=-U,j):new oe(de[0]?se:I==3?-0:0)}if(ce=m(ce),ve=m(ve),de=de.slice(),ue=ce-ve){for((ee=(pe=ue<0)?(ue=-ue,de):(ve=ce,Te)).reverse(),U=ue;U--;ee.push(0));ee.reverse()}else for(fe=(pe=(ue=de.length)<(U=Te.length))?ue:U,ue=U=0;U<fe;U++)if(de[U]!=Te[U]){pe=de[U]<Te[U];break}if(pe&&(ee=de,de=Te,Te=ee,j.s=-j.s),0<(U=(fe=Te.length)-(Q=de.length)))for(;U--;de[Q++]=0);for(U=h-1;ue<fe;){if(de[--fe]<Te[fe]){for(Q=fe;Q&&!de[--Q];de[Q]=U);--de[Q],de[fe]+=h}de[fe]-=Te[fe]}for(;de[0]==0;de.splice(0,1),--ve);return de[0]?be(j,de,ve):(j.s=I==3?-1:1,j.c=[j.e=0],j)},O.modulo=O.mod=function(j,U){var Q,fe,ee=this;return j=new oe(j,U),!ee.c||!j.s||j.c&&!j.c[0]?new oe(NaN):!j.c||ee.c&&!ee.c[0]?new oe(ee):(te==9?(fe=j.s,j.s=1,Q=D(ee,j,0,3),j.s=fe,Q.s*=fe):Q=D(ee,j,0,te),(j=ee.minus(Q.times(j))).c[0]||te!=1||(j.s=ee.s),j)},O.multipliedBy=O.times=function(j,U){var Q,fe,ee,pe,se,ue,ce,ve,de,Te,$e,Fe,it,gt,Ht,ut=this,ft=ut.c,Tt=(j=new oe(j,U)).c;if(!(ft&&Tt&&ft[0]&&Tt[0]))return!ut.s||!j.s||ft&&!ft[0]&&!Tt||Tt&&!Tt[0]&&!ft?j.c=j.e=j.s=null:(j.s*=ut.s,ft&&Tt?(j.c=[0],j.e=0):j.c=j.e=null),j;for(fe=m(ut.e/d)+m(j.e/d),j.s*=ut.s,(ce=ft.length)<(Te=Tt.length)&&(it=ft,ft=Tt,Tt=it,ee=ce,ce=Te,Te=ee),ee=ce+Te,it=[];ee--;it.push(0));for(gt=h,Ht=g,ee=Te;0<=--ee;){for(Q=0,$e=Tt[ee]%Ht,Fe=Tt[ee]/Ht|0,pe=ee+(se=ce);ee<pe;)Q=((ve=$e*(ve=ft[--se]%Ht)+(ue=Fe*ve+(de=ft[se]/Ht|0)*$e)%Ht*Ht+it[pe]+Q)/gt|0)+(ue/Ht|0)+Fe*de,it[pe--]=ve%gt;it[pe]=Q}return Q?++fe:it.splice(0,1),be(j,it,fe)},O.negated=function(){var j=new oe(this);return j.s=-j.s||null,j},O.plus=function(j,U){var Q,fe=this,ee=fe.s;if(U=(j=new oe(j,U)).s,!ee||!U)return new oe(NaN);if(ee!=U)return j.s=-U,fe.minus(j);var pe=fe.e/d,se=j.e/d,ue=fe.c,ce=j.c;if(!pe||!se){if(!ue||!ce)return new oe(ee/0);if(!ue[0]||!ce[0])return ce[0]?j:new oe(ue[0]?fe:0*ee)}if(pe=m(pe),se=m(se),ue=ue.slice(),ee=pe-se){for((Q=0<ee?(se=pe,ce):(ee=-ee,ue)).reverse();ee--;Q.push(0));Q.reverse()}for((ee=ue.length)-(U=ce.length)<0&&(Q=ce,ce=ue,ue=Q,U=ee),ee=0;U;)ee=(ue[--U]=ue[U]+ce[U]+ee)/h|0,ue[U]=h===ue[U]?0:ue[U]%h;return ee&&(ue=[ee].concat(ue),++se),be(j,ue,se)},O.precision=O.sd=function(j,U){var Q,fe,ee;if(j!=null&&j!==!!j)return x(j,1,y),U==null?U=I:x(U,0,8),Ie(new oe(this),j,U);if(!(Q=this.c))return null;if(fe=(ee=Q.length-1)*d+1,ee=Q[ee]){for(;ee%10==0;ee/=10,fe--);for(ee=Q[0];10<=ee;ee/=10,fe++);}return j&&this.e+1>fe&&(fe=this.e+1),fe},O.shiftedBy=function(j){return x(j,-v,v),this.times("1e"+j)},O.squareRoot=O.sqrt=function(){var j,U,Q,fe,ee,pe=this,se=pe.c,ue=pe.s,ce=pe.e,ve=A+4,de=new oe("0.5");if(ue!==1||!se||!se[0])return new oe(!ue||ue<0&&(!se||se[0])?NaN:se?pe:1/0);if((Q=(ue=Math.sqrt(+Me(pe)))==0||ue==1/0?(((U=b(se)).length+ce)%2==0&&(U+="0"),ue=Math.sqrt(+U),ce=m((ce+1)/2)-(ce<0||ce%2),new oe(U=ue==1/0?"1e"+ce:(U=ue.toExponential()).slice(0,U.indexOf("e")+1)+ce)):new oe(ue+"")).c[0]){for((ue=(ce=Q.e)+ve)<3&&(ue=0);;)if(ee=Q,Q=de.times(ee.plus(D(pe,ee,ve,1))),b(ee.c).slice(0,ue)===(U=b(Q.c)).slice(0,ue)){if(Q.e<ce&&--ue,(U=U.slice(ue-3,ue+1))!="9999"&&(fe||U!="4999")){+U&&(+U.slice(1)||U.charAt(0)!="5")||(Ie(Q,Q.e+A+2,1),j=!Q.times(Q).eq(pe));break}if(!fe&&(Ie(ee,ee.e+A+2,0),ee.times(ee).eq(pe))){Q=ee;break}ve+=4,ue+=4,fe=1}}return Ie(Q,Q.e+A+1,I,j)},O.toExponential=function(j,U){return j!=null&&(x(j,0,y),j++),Oe(this,j,U,1)},O.toFixed=function(j,U){return j!=null&&(x(j,0,y),j=j+this.e+1),Oe(this,j,U)},O.toFormat=function(j,U,Q){var fe;if(Q==null)j!=null&&U&&typeof U=="object"?(Q=U,U=null):j&&typeof j=="object"?(Q=j,j=U=null):Q=H;else if(typeof Q!="object")throw Error(f+"Argument not an object: "+Q);if(fe=this.toFixed(j,U),this.c){var ee,pe=fe.split("."),se=+Q.groupSize,ue=+Q.secondaryGroupSize,ce=Q.groupSeparator||"",ve=pe[0],de=pe[1],Te=this.s<0,$e=Te?ve.slice(1):ve,Fe=$e.length;if(ue&&(ee=se,se=ue,Fe-=ue=ee),0<se&&0<Fe){for(ee=Fe%se||se,ve=$e.substr(0,ee);ee<Fe;ee+=se)ve+=ce+$e.substr(ee,se);0<ue&&(ve+=ce+$e.slice(ee)),Te&&(ve="-"+ve)}fe=de?ve+(Q.decimalSeparator||"")+((ue=+Q.fractionGroupSize)?de.replace(new RegExp("\\d{"+ue+"}\\B","g"),"$&"+(Q.fractionGroupSeparator||"")):de):ve}return(Q.prefix||"")+fe+(Q.suffix||"")},O.toFraction=function(j){var U,Q,fe,ee,pe,se,ue,ce,ve,de,Te,$e,Fe=this,it=Fe.c;if(j!=null&&(!(ue=new oe(j)).isInteger()&&(ue.c||ue.s!==1)||ue.lt(S)))throw Error(f+"Argument "+(ue.isInteger()?"out of range: ":"not an integer: ")+Me(ue));if(!it)return new oe(Fe);for(U=new oe(S),ve=Q=new oe(S),fe=ce=new oe(S),$e=b(it),pe=U.e=$e.length-Fe.e-1,U.c[0]=p[(se=pe%d)<0?d+se:se],j=!j||0<ue.comparedTo(U)?0<pe?U:ve:ue,se=ae,ae=1/0,ue=new oe($e),ce.c[0]=0;de=D(ue,U,0,1),(ee=Q.plus(de.times(fe))).comparedTo(j)!=1;)Q=fe,fe=ee,ve=ce.plus(de.times(ee=ve)),ce=ee,U=ue.minus(de.times(ee=U)),ue=ee;return ee=D(j.minus(Q),fe,0,1),ce=ce.plus(ee.times(ve)),Q=Q.plus(ee.times(fe)),ce.s=ve.s=Fe.s,Te=D(ve,fe,pe*=2,I).minus(Fe).abs().comparedTo(D(ce,Q,pe,I).minus(Fe).abs())<1?[ve,fe]:[ce,Q],ae=se,Te},O.toNumber=function(){return+Me(this)},O.toPrecision=function(j,U){return j!=null&&x(j,1,y),Oe(this,j,U,2)},O.toString=function(j){var U,Q=this,fe=Q.s,ee=Q.e;return ee===null?fe?(U="Infinity",fe<0&&(U="-"+U)):U="NaN":(U=j==null?ee<=L||V<=ee?E(b(Q.c),ee):P(b(Q.c),ee,"0"):j===10?P(b((Q=Ie(new oe(Q),A+ee+1,I)).c),Q.e,"0"):(x(j,2,Ce.length,"Base"),N(P(b(Q.c),ee,"0"),10,j,fe,!0)),fe<0&&Q.c[0]&&(U="-"+U)),U},O.valueOf=O.toJSON=function(){return Me(this)},O._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(O[Symbol.toStringTag]="BigNumber",O[Symbol.for("nodejs.util.inspect.custom")]=O.valueOf),M!=null&&oe.set(M),oe}()).default=o.BigNumber=o,n!==void 0&&n.exports?n.exports=o:(a||(a=typeof self<"u"&&self?self:window),a.BigNumber=o)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(a){var o=a%10;return~~(a%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function a(m,b){return function(_){if(Array.isArray(_))return _}(m)||function(_,x){var T=[],E=!0,P=!1,R=void 0;try{for(var M,D=_[Symbol.iterator]();!(E=(M=D.next()).done)&&(T.push(M.value),!x||T.length!==x);E=!0);}catch(N){P=!0,R=N}finally{try{E||D.return==null||D.return()}finally{if(P)throw R}}return T}(m,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(m){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},_=2<arguments.length?arguments[2]:void 0;if(typeof b=="string"&&(b=l.parseFormat(b)),!s.validateFormat(b))return"ERROR: invalid format";var x=b.prefix||"",T=b.postfix||"",E=function(P,R,M){switch(R.output){case"currency":return R=y(R,o.currentCurrencyDefaultFormat()),function(Ce,oe,Oe){var Ee=Oe.currentCurrency(),be=Object.assign({},c,oe),Ie=void 0,Me="",j=!!be.totalLength||!!be.forceAverage||be.average,U=oe.currencyPosition||Ee.position,Q=oe.currencySymbol||Ee.symbol;be.spaceSeparated&&(Me=" "),U==="infix"&&(Ie=Me+Q+Me);var fe=g({instance:Ce,providedFormat:oe,state:Oe,decimalSeparator:Ie});return U==="prefix"&&(fe=Ce._value<0&&be.negative==="sign"?"-".concat(Me).concat(Q).concat(fe.slice(1)):Q+Me+fe),U&&U!=="postfix"||(fe=fe+(Me=j?"":Me)+Q),fe}(P,R,o);case"percent":return R=y(R,o.currentPercentageDefaultFormat()),function(Ce,oe,Oe,Ee){var be=oe.prefixSymbol,Ie=g({instance:Ee(100*Ce._value),providedFormat:oe,state:Oe}),Me=Object.assign({},c,oe);return be?"%".concat(Me.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Me.spaceSeparated?" ":"","%")}(P,R,o,M);case"byte":return R=y(R,o.currentByteDefaultFormat()),S=P,I=o,L=M,V=(A=R).base||"binary",Y=f[V],ae=d(S._value,Y.suffixes,Y.scale),re=ae.value,te=ae.suffix,ge=g({instance:L(re),providedFormat:A,state:I,defaults:I.currentByteDefaultFormat()}),H=I.currentAbbreviations(),"".concat(ge).concat(H.spaced?" ":"").concat(te);case"time":return R=y(R,o.currentTimeDefaultFormat()),k=P,w=Math.floor(k._value/60/60),C=Math.floor((k._value-60*w*60)/60),O=Math.round(k._value-60*w*60-60*C),"".concat(w,":").concat(C<10?"0":"").concat(C,":").concat(O<10?"0":"").concat(O);case"ordinal":return R=y(R,o.currentOrdinalDefaultFormat()),D=P,N=R,K=(B=o).currentOrdinal(),Z=Object.assign({},c,N),ie=g({instance:D,providedFormat:N,state:B}),me=K(D._value),"".concat(ie).concat(Z.spaceSeparated?" ":"").concat(me);case"number":default:return g({instance:P,providedFormat:R,numbro:M})}var D,N,B,K,Z,ie,me,k,w,C,O,S,A,I,L,V,Y,ae,re,te,ge,H}(m,b,_);return E=(E=x+E)+T}function d(m,b,_){var x=b[0],T=Math.abs(m);if(_<=T){for(var E=1;E<b.length;++E){var P=Math.pow(_,E),R=Math.pow(_,E+1);if(P<=T&&T<R){x=b[E],m/=P;break}}x===b[0]&&(m/=Math.pow(_,b.length-1),x=b[b.length-1])}return{value:m,suffix:x}}function v(m){for(var b="",_=0;_<m;_++)b+="0";return b}function p(m,b){return m.toString().indexOf("e")!==-1?function(_,x){var T=_.toString(),E=a(T.split("e"),2),P=E[0],R=E[1],M=a(P.split("."),2),D=M[0],N=M[1],B=N===void 0?"":N;if(0<+R)T=D+B+v(R-B.length);else{var K=".";K=+D<0?"-0".concat(K):"0".concat(K);var Z=(v(-R-1)+Math.abs(D)+B).substr(0,x);Z.length<x&&(Z+=v(x-Z.length)),T=K+Z}return 0<+R&&0<x&&(T+=".".concat(v(x))),T}(m,b):(Math.round(+"".concat(m,"e+").concat(b))/Math.pow(10,b)).toFixed(b)}function g(m){var b=m.instance,_=m.providedFormat,x=m.state,T=x===void 0?o:x,E=m.decimalSeparator,P=m.defaults,R=P===void 0?T.currentDefaults():P,M=b._value;if(M===0&&T.hasZeroFormat())return T.getZeroFormat();if(!isFinite(M))return M.toString();var D,N,B,K,Z,ie,me,k,w=Object.assign({},c,R,_),C=w.totalLength,O=C?0:w.characteristic,S=w.optionalCharacteristic,A=w.forceAverage,I=!!C||!!A||w.average,L=C?-1:I&&_.mantissa===void 0?0:w.mantissa,V=!C&&(_.optionalMantissa===void 0?L===-1:w.optionalMantissa),Y=w.trimMantissa,ae=w.thousandSeparated,re=w.spaceSeparated,te=w.negative,ge=w.forceSign,H=w.exponential,Ce="";if(I){var oe=function(j){var U=j.value,Q=j.forceAverage,fe=j.abbreviations,ee=j.spaceSeparated,pe=ee!==void 0&&ee,se=j.totalLength,ue=se===void 0?0:se,ce="",ve=Math.abs(U),de=-1;if(ve>=Math.pow(10,12)&&!Q||Q==="trillion"?(ce=fe.trillion,U/=Math.pow(10,12)):ve<Math.pow(10,12)&&ve>=Math.pow(10,9)&&!Q||Q==="billion"?(ce=fe.billion,U/=Math.pow(10,9)):ve<Math.pow(10,9)&&ve>=Math.pow(10,6)&&!Q||Q==="million"?(ce=fe.million,U/=Math.pow(10,6)):(ve<Math.pow(10,6)&&ve>=Math.pow(10,3)&&!Q||Q==="thousand")&&(ce=fe.thousand,U/=Math.pow(10,3)),ce&&(ce=(pe?" ":"")+ce),ue){var Te=U.toString().split(".")[0];de=Math.max(ue-Te.length,0)}return{value:U,abbreviation:ce,mantissaPrecision:de}}({value:M,forceAverage:A,abbreviations:T.currentAbbreviations(),spaceSeparated:re,totalLength:C});M=oe.value,Ce+=oe.abbreviation,C&&(L=oe.mantissaPrecision)}if(H){var Oe=(N=(D={value:M,characteristicPrecision:O}).value,B=D.characteristicPrecision,K=B===void 0?0:B,Z=a(N.toExponential().split("e"),2),ie=Z[0],me=Z[1],k=+ie,K&&1<K&&(k*=Math.pow(10,K-1),me=0<=(me=+me-(K-1))?"+".concat(me):me),{value:k,abbreviation:"e".concat(me)});M=Oe.value,Ce=Oe.abbreviation+Ce}var Ee,be,Ie,Me=function(j,U,Q,fe,ee){if(fe===-1)return j;var pe=p(U,fe),se=a(pe.toString().split("."),2),ue=se[0],ce=se[1],ve=ce===void 0?"":ce;if(ve.match(/^0+$/)&&(Q||ee))return ue;var de=ve.match(/0+$/);return ee&&de?"".concat(ue,".").concat(ve.toString().slice(0,de.index)):pe.toString()}(M.toString(),M,V,L,Y);return Me=function(j,U,Q,fe,ee){var pe=fe.currentDelimiters(),se=pe.thousands;ee=ee||pe.decimal;var ue=pe.thousandsSize||3,ce=j.toString(),ve=ce.split(".")[0],de=ce.split(".")[1];return Q&&(U<0&&(ve=ve.slice(1)),function(Te,$e){for(var Fe=[],it=0,gt=Te;0<gt;gt--)it===$e&&(Fe.unshift(gt),it=0),it++;return Fe}(ve.length,ue).forEach(function(Te,$e){ve=ve.slice(0,Te+$e)+se+ve.slice(Te+$e)}),U<0&&(ve="-".concat(ve))),ce=de?ve+ee+de:ve}(Me=function(j,U,Q,fe){var ee=j,pe=a(ee.toString().split("."),2),se=pe[0],ue=pe[1];if(se.match(/^-?0$/)&&Q)return ue?"".concat(se.replace("0",""),".").concat(ue):se.replace("0","");if(se.length<fe)for(var ce=fe-se.length,ve=0;ve<ce;ve++)ee="0".concat(ee);return ee.toString()}(Me,0,S,O),M,ae,T,E),(I||H)&&(Me=Me+Ce),(ge||M<0)&&(Ee=Me,Ie=te,Me=(be=M)===0?Ee:+Ee==0?Ee.replace("-",""):0<be?"+".concat(Ee):Ie==="sign"?Ee:"(".concat(Ee.replace("-",""),")")),Me}function y(m,b){if(!m)return b;var _=Object.keys(m);return _.length===1&&_[0]==="output"?b:m}n.exports=function(m){return{format:function(){for(var b=arguments.length,_=new Array(b),x=0;x<b;x++)_[x]=arguments[x];return h.apply(void 0,_.concat([m]))},getByteUnit:function(){for(var b=arguments.length,_=new Array(b),x=0;x<b;x++)_[x]=arguments[x];return function(T){var E=f.general;return d(T._value,E.suffixes,E.scale).suffix}.apply(void 0,_.concat([m]))},getBinaryByteUnit:function(){for(var b=arguments.length,_=new Array(b),x=0;x<b;x++)_[x]=arguments[x];return function(T){var E=f.binary;return d(T._value,E.suffixes,E.scale).suffix}.apply(void 0,_.concat([m]))},getDecimalByteUnit:function(){for(var b=arguments.length,_=new Array(b),x=0;x<b;x++)_[x]=arguments[x];return function(T){var E=f.decimal;return d(T._value,E.suffixes,E.scale).suffix}.apply(void 0,_.concat([m]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var a=r("./en-US"),o=r("./validating"),s=r("./parsing"),l={},u=void 0,f={},c=null,h={};function d(p){u=p}function v(){return f[u]}l.languages=function(){return Object.assign({},f)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return v().currency},l.currentAbbreviations=function(){return v().abbreviations},l.currentDelimiters=function(){return v().delimiters},l.currentOrdinal=function(){return v().ordinal},l.currentDefaults=function(){return Object.assign({},v().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().timeFormat)},l.setDefaults=function(p){p=s.parseFormat(p),o.validateFormat(p)&&(h=p)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(p){return c=typeof p=="string"?p:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(p){if(p){if(f[p])return f[p];throw new Error('Unknown tag "'.concat(p,'"'))}return v()},l.registerLanguage=function(p){var g=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(p))throw new Error("Invalid language data");f[p.languageTag]=p,g&&d(p.languageTag)},l.setLanguage=function(p){var g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.languageTag;if(!f[p]){var y=p.split("-")[0],m=Object.keys(f).find(function(b){return b.split("-")[0]===y});return f[m]?void d(m):void d(g)}d(p)},l.registerLanguage(a),u=a.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(a){return{loadLanguagesInNode:function(o){return s=a,void o.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,i){var a=r("bignumber.js");function o(s,l,u){var f=new a(s._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new a(c),s._value=f.minus(c).toNumber(),s}n.exports=function(s){return{add:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(l,u){return o(l,u,s)},multiply:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(l,u){return f=l,h=c=u,s.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(l,u){return f=u,o(h=(c=s)(l._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,i){function a(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}var o=r("./globalState"),s=r("./validating"),l=r("./loading")(p),u=r("./unformatting"),f=r("./formatting")(p),c=r("./manipulating")(p),h=r("./parsing"),d=function(){function g(b){(function(_,x){if(!(_ instanceof x))throw new TypeError("Cannot call a class as a function")})(this,g),this._value=b}var y,m;return y=g,(m=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,b)}},{key:"formatCurrency",value:function(b){return typeof b=="string"&&(b=h.parseFormat(b)),(b=f.formatOrDefault(b,o.currentCurrencyDefaultFormat())).output="currency",f.format(this,b)}},{key:"formatTime",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return b.output="time",f.format(this,b)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(b){return c.difference(this,b)}},{key:"add",value:function(b){return c.add(this,b)}},{key:"subtract",value:function(b){return c.subtract(this,b)}},{key:"multiply",value:function(b){return c.multiply(this,b)}},{key:"divide",value:function(b){return c.divide(this,b)}},{key:"set",value:function(b){return c.set(this,v(b))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&a(y.prototype,m),g}();function v(g){var y=g;return p.isNumbro(g)?y=g._value:typeof g=="string"?y=p.unformat(g):isNaN(g)&&(y=NaN),y}function p(g){return new d(v(g))}p.version="2.1.2",p.isNumbro=function(g){return g instanceof d},p.language=o.currentLanguage,p.registerLanguage=o.registerLanguage,p.setLanguage=o.setLanguage,p.languages=o.languages,p.languageData=o.languageData,p.zeroFormat=o.setZeroFormat,p.defaultFormat=o.currentDefaults,p.setDefaults=o.setDefaults,p.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,p.validate=s.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,n.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(a){var o,s,l,u,f,c,h,d,v,p,g,y,m,b,_,x,T,E,P,R,M=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof a!="string"?a:(s=M,a=(l=(o=a).match(/^{([^}]*)}/))?(s.prefix=l[1],o.slice(l[0].length)):o,f=M,function(D,N){if(D.indexOf("$")===-1){if(D.indexOf("%")===-1)return D.indexOf("bd")!==-1?(N.output="byte",N.base="general"):D.indexOf("b")!==-1?(N.output="byte",N.base="binary"):D.indexOf("d")!==-1?(N.output="byte",N.base="decimal"):D.indexOf(":")===-1?D.indexOf("o")!==-1&&(N.output="ordinal"):N.output="time";N.output="percent"}else N.output="currency"}(a=(c=(u=a).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,M),h=M,(d=a.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=M,(p=a.split(".")[0].match(/0+/))&&(v.characteristic=p[0].length),function(D,N){if(D.indexOf(".")!==-1){var B=D.split(".")[0];N.optionalCharacteristic=B.indexOf("0")===-1}}(a,M),g=M,a.indexOf("a")!==-1&&(g.average=!0),m=M,(y=a).indexOf("K")!==-1?m.forceAverage="thousand":y.indexOf("M")!==-1?m.forceAverage="million":y.indexOf("B")!==-1?m.forceAverage="billion":y.indexOf("T")!==-1&&(m.forceAverage="trillion"),function(D,N){var B=D.split(".")[1];if(B){var K=B.match(/0+/);K&&(N.mantissa=K[0].length)}}(a,M),_=M,(b=a).match(/\[\.]/)?_.optionalMantissa=!0:b.match(/\./)&&(_.optionalMantissa=!1),x=M,a.indexOf(",")!==-1&&(x.thousandSeparated=!0),T=M,a.indexOf(" ")!==-1&&(T.spaceSeparated=!0),P=M,(E=a).match(/^\+?\([^)]*\)$/)&&(P.negative="parenthesis"),E.match(/^\+?-/)&&(P.negative="sign"),R=M,a.match(/^\+/)&&(R.forceSign=!0),M)}}},{}],9:[function(r,n,i){var a=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function p(g,y){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=3<arguments.length?arguments[3]:void 0,_=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,T=6<arguments.length?arguments[6]:void 0;if(!isNaN(+g))return+g;var E="",P=g.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(P!==g)return-1*p(P,y,m,b,_,x,T);for(var R=0;R<a.length;R++){var M=a[R];if((E=g.replace(M.key,""))!==g)return p(E,y,m,b,_,x,T)*M.factor}if((E=g.replace("%",""))!==g)return p(E,y,m,b,_,x,T)/100;var D=parseFloat(g);if(!isNaN(D)){var N=b(D);if(N&&N!=="."&&(E=g.replace(new RegExp("".concat(o(N),"$")),""))!==g)return p(E,y,m,b,_,x,T);var B={};Object.keys(x).forEach(function(C){B[x[C]]=C});for(var K=Object.keys(B).sort().reverse(),Z=K.length,ie=0;ie<Z;ie++){var me=K[ie],k=B[me];if((E=g.replace(me,""))!==g){var w=void 0;switch(k){case"thousand":w=Math.pow(10,3);break;case"million":w=Math.pow(10,6);break;case"billion":w=Math.pow(10,9);break;case"trillion":w=Math.pow(10,12)}return p(E,y,m,b,_,x,T)*w}}}}(function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",m=p.replace(y,"");return m=(m=m.replace(new RegExp("([0-9])".concat(o(g.thousands),"([0-9])"),"g"),"$1$2")).replace(g.decimal,".")}(l,u,f),u,f,c,h,d,v)}n.exports={unformat:function(l,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),p=d.currentCurrency().symbol,g=d.currentOrdinal(),y=d.getZeroFormat(),m=d.currentAbbreviations(),b=void 0;if(typeof l=="string")b=function(_,x){if(!_.indexOf(":")||x.thousands===":")return!1;var T=_.split(":");if(T.length!==3)return!1;var E=+T[0],P=+T[1],R=+T[2];return!isNaN(E)&&!isNaN(P)&&!isNaN(R)}(l,v)?(f=l.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):s(l,v,p,g,y,m,u);else{if(typeof l!="number")return;b=l}if(b!==void 0)return b}}},{"./globalState":4}],10:[function(r,n,i){function a(v){return function(p){if(Array.isArray(p)){for(var g=0,y=new Array(p.length);g<p.length;g++)y[g]=p[g];return y}}(v)||function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(v)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!s.unformat(v)}function h(v,p,g){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],m=Object.keys(v).map(function(b){if(!p[b])return console.error("".concat(g," Invalid key: ").concat(b)),!1;var _=v[b],x=p[b];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!h(_,u,"[Validate ".concat(b,"]"),!0))return!1}else if(o(_)!==x.type)return console.error("".concat(g," ").concat(b,' type mismatched: "').concat(x.type,'" expected, "').concat(o(_),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var T=x.restrictions.length,E=0;E<T;E++){var P=x.restrictions[E],R=P.restriction,M=P.message;if(!R(_,v))return console.error("".concat(g," ").concat(b," invalid value: ").concat(M)),!1}return x.restriction&&!x.restriction(_,v)?(console.error("".concat(g," ").concat(b," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(_)===-1?(console.error("".concat(g," ").concat(b," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(_,'" provided')),!1):!(x.children&&!h(_,x.children,"[Validate ".concat(b,"]")))});return y||m.push.apply(m,a(Object.keys(p).map(function(b){var _=p[b];if(typeof _=="string"&&(_={type:_}),_.mandatory){var x=_.mandatory;if(typeof x=="function"&&(x=x(v)),x&&v[b]===void 0)return console.error("".concat(g,' Missing mandatory key "').concat(b,'"')),!1}return!0}))),m.reduce(function(b,_){return b&&_},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,p){var g=c(v),y=d(p);return g&&y},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(trt);const Of=kD;var rrt="numeric";function g3(e,t,r,n,i,a,o){var s=a;if(Ki(s)){var l=o.numericFormat,u=l&&l.culture||"-",f=l&&l.pattern,c=o.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!Of.languages()[u]){var d=u.replace("-",""),v=Of.allLanguages?Of.allLanguages[u]:Of[d];v&&Of.registerLanguage(v)}Of.setLanguage(u),s=Of(s).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),o.className=h.join(" "),t.dir="ltr"}Gu(e,t,r,n,i,s,o)}g3.RENDERER_TYPE=rrt;var nrt="password";function y3(e,t,r,n,i,a,o){Gu.apply(this,[e,t,r,n,i,a,o]);var s=o.hashLength||t.innerHTML.length,l=o.hashSymbol||"*",u="";rt(s-1,function(){u+=l}),fh(t,u)}y3.RENDERER_TYPE=nrt;var irt="time";function m3(e,t,r,n,i,a,o){Gu.apply(this,[e,t,r,n,i,a,o]),t.dir="ltr"}m3.RENDERER_TYPE=irt;function art(){Lo(Fg),Lo(b_),Lo(v3),Lo(d3),Lo(g3),Lo(y3),Lo(Gu),Lo(m3)}var ort="autocomplete";function OE(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,O9(r,t)):O9(r,t)(this.source):t(!0)}OE.VALIDATOR_TYPE=ort;function O9(e,t){var r=e;return function(n){for(var i=!1,a=0,o=n.length;a<o;a++)if(r===n[a]){i=!0;break}t(i)}}var srt=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},lrt=gn,urt=GO,frt=Kr,crt=bo,hrt=Fi,E9=srt,R9=sn,drt=nh,vrt=YO;urt("search",function(e,t,r){return[function(i){var a=hrt(this),o=crt(i)?void 0:drt(i,e);return o?lrt(o,i,a):new RegExp(i)[e](R9(a))},function(n){var i=frt(this),a=R9(n),o=r(t,i,a);if(o.done)return o.value;var s=i.lastIndex;E9(s,0)||(i.lastIndex=0);var l=vrt(i,a);return E9(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function dse(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const prt=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:dse},Symbol.toStringTag,{value:"Module"}));var grt="date";function b3(e,t){var r=lae(sse,this.instance),n=e,i=!0;n==null&&(n="");var a=Ae(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=Ae(new Date(n)).isValid()||a;if(this.allowEmpty&&n===""&&(o=!0,a=!0),o||(i=!1),!o&&a&&(i=!0),o&&!a)if(this.correctFormat===!0){var s=yrt(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;t(i)}b3.VALIDATOR_TYPE=grt;function yrt(e,t){var r=Ae(dse(e)),n=Ae(e,t),i=e.search(/[A-z]/g)>-1,a;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?a=r:a=n,a.format(t)}var mrt="numeric";function w3(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:Ki(e))}w3.VALIDATOR_TYPE=mrt;var brt=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],wrt="time";function _3(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,i=e;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var a=/^\d{1,2}$/.test(i);a&&(i+=":00");var o=Ae(i,brt,!0).isValid()?Ae(i):Ae(i,r),s=o.isValid(),l=Ae(i,r,!0).isValid()&&!a;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=o.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}_3.VALIDATOR_TYPE=wrt;function _rt(){Rd(OE),Rd(b3),Rd(w3),Rd(_3)}var Srt="autocomplete",Crt={CELL_TYPE:Srt,editor:c3,renderer:Fg,validator:OE},xrt="checkbox",Trt={CELL_TYPE:xrt,editor:ose,renderer:v3},Ort="date",Ert={CELL_TYPE:Ort,editor:lse,renderer:Fg,validator:b3},Rrt="dropdown",krt={CELL_TYPE:Rrt,editor:h3,renderer:Fg,validator:OE},Art="handsontable",Prt={CELL_TYPE:Art,editor:f3,renderer:Fg},Irt="numeric",Mrt={CELL_TYPE:Irt,editor:use,renderer:g3,validator:w3,dataType:"number"},Drt="password",$rt={CELL_TYPE:Drt,editor:fse,renderer:y3,copyable:!1},Nrt="time",Lrt={CELL_TYPE:Nrt,editor:cse,renderer:m3,validator:_3};function Frt(){Ja(Crt),Ja(Trt),Ja(Ert),Ja(krt),Ja(Prt),Ja(Mrt),Ja($rt),Ja(rse),Ja(Lrt)}var Hrt=VO,Brt=Zie;Hrt("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Brt);function Ob(e){return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ob(e)}function Vrt(e,t){return zrt(e)||Urt(e,t)||Wrt(e,t)||jrt()}function jrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wrt(e,t){if(e){if(typeof e=="string")return k9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k9(e,t)}}function k9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Urt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function zrt(e){if(Array.isArray(e))return e}function Grt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Krt(n.key),n)}}function Yrt(e,t,r){return t&&A9(e.prototype,t),r&&A9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Krt(e){var t=Xrt(e,"string");return Ob(t)==="symbol"?t:String(t)}function Xrt(e,t){if(Ob(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ob(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qrt(e,t){Zrt(e,t),t.add(e)}function Zrt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jrt(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var P9=new Map([["plugin",bUe],["cell-type",Goe],["editor",sae],["renderer",_ae],["validator",Sae]]),Qrt="base",Ef=new WeakMap,jA=[],ko=null,I9=new WeakSet,tr=function(){function e(t){var r=this;Grt(this,e),qrt(this,I9),as(this,"hot",t,{writable:!1}),Ef.set(this,{hooks:{}}),ko=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return Yrt(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var a=[];if(i.forEach(function(u){var f=u.split(":"),c=Vrt(f,2),h=c[0],d=c[1];if(!P9.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));P9.get(h)(d)||a.push(" - ".concat(d," (").concat(h,")"))}),a.length>0){var o=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(a.join(`
`),`
`)].join("");jA.push(o)}}ko||(ko=gH()),ko.indexOf("UndoRedo")>=0&&ko.splice(ko.indexOf("UndoRedo"),1),ko.indexOf(this.pluginName)>=0&&ko.splice(ko.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=ko.length===0;if(s){if(jA.length>0){var l=["".concat(jA.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Ef.get(this).hooks[r]=Ef.get(this).hooks[r]||[];var i=Ef.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),Ef.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;ne(Ef.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=Ef.get(this).hooks;At(n,function(i,a){return r.removeHooks(a)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){ne(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=Jrt(this,I9,ent).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),At(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Qrt}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function ent(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function Eb(e){return Eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eb(e)}function tnt(e,t){return ant(e)||int(e,t)||nnt(e,t)||rnt()}function rnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nnt(e,t){if(e){if(typeof e=="string")return M9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M9(e,t)}}function M9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function int(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ant(e){if(Array.isArray(e))return e}function ont(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lnt(n.key),n)}}function snt(e,t,r){return t&&D9(e.prototype,t),r&&D9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lnt(e){var t=unt(e,"string");return Eb(t)==="symbol"?t:String(t)}function unt(e,t){if(Eb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fnt=function(){function e(t){ont(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return snt(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),ne(this.rows,function(n){r(n.row,$r(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),ne(this.columns,function(n){var i=n.table.getBoundingClientRect(),a=i.width;r(n.col,Math.ceil(a))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){ne(i.strings,function(a){n.appendChild(r.createColElement(a.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment(),o=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,o),a.appendChild(o)),this.samples.forEach(function(s){ne(s.strings,function(l){var u=l.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=i.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),l.value,f),a.appendChild(h)})}),a}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),a=[];if(this.hot.hasRowHeaders()){var o=n.createElement("th");a.push([-1,o]),i.appendChild(o)}this.samples.forEach(function(s){ne(s.strings,function(l){var u=l.col,f=n.createElement("th");a.push([u,f]),i.appendChild(f)})}),this.table.tHead.appendChild(i),ne(a,function(s){var l=tnt(s,2),u=l[0],f=l[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment();return this.samples.forEach(function(o){ne(o.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var f=n.hot.getCellRenderer(u),c=i.createElement("td"),h=i.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(c),a.appendChild(h)})}),a}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&a.appendChild(l),this.isHorizontal()&&(u.appendChild(f),o.appendChild(u),a.style.tableLayout="auto",a.style.width="auto"),a.appendChild(o),this.isVertical()&&s.appendChild(u),a.appendChild(s),ke(a,r),i.appendChild(a),{fragment:i,table:a,tHead:o,tBody:s,colGroup:l,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("div"),o="htGhostTable htAutoSize ".concat(r.trim());return ke(a,o),i.appendChild(a),{fragment:i,container:a}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const S3=fnt;function Rb(e){return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(e)}function cnt(e,t,r){return t=vse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vse(n.key),n)}}function dnt(e,t,r){return t&&$9(e.prototype,t),r&&$9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vse(e){var t=vnt(e,"string");return Rb(t)==="symbol"?t:String(t)}function vnt(e,t){if(Rb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pnt=function(){function e(t){hnt(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return dnt(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var a=this,o=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return rt(l,u,function(f){var c=a.generateSample(r,n,f);o.set(f,c)}),o}},{key:"generateSample",value:function(r,n,i){var a=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var o=new Map,s=r==="row"?"col":"row",l=[];return rt(n.from,n.to,function(u){var f=r==="row"?a.dataFactory(i,u):a.dataFactory(u,i),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:kt(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(Vr(c).length),o.has(v)||o.set(v,{needed:a.getSampleCount(),strings:[]});var p=o.get(v);if(p.needed){var g=l.indexOf(c)>-1;(!g||a.allowDuplicates||d)&&(p.strings.push(cnt({value:c},s,u)),l.push(c),p.needed-=1)}}),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const pse=pnt;function up(e){return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(e)}function N9(e,t){return bnt(e)||mnt(e,t)||ynt(e,t)||gnt()}function gnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ynt(e,t){if(e){if(typeof e=="string")return L9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L9(e,t)}}function L9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mnt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function bnt(e){if(Array.isArray(e))return e}function wnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Snt(n.key),n)}}function _nt(e,t,r){return t&&F9(e.prototype,t),r&&F9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Snt(e){var t=Cnt(e,"string");return up(t)==="symbol"?t:String(t)}function Cnt(e,t){if(up(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yf(){return typeof Reflect<"u"&&Reflect.get?Yf=Reflect.get.bind():Yf=function(t,r,n){var i=xnt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Yf.apply(this,arguments)}function xnt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ms(e),e!==null););return e}function Tnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AD(e,t)}function AD(e,t){return AD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AD(e,t)}function Ont(e){var t=Rnt();return function(){var n=Ms(e),i;if(t){var a=Ms(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ent(this,i)}}function Ent(e,t){if(t&&(up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gse(e)}function gse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ms(e){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ms(e)}Je.getSingleton().register("modifyAutoColumnSizeSeed");var Ry="autoColumnSize",knt=10,WA=new WeakMap,Ant="autoColumnSize",Pnt=function(e){Tnt(r,e);var t=Ont(r);function r(n){var i;return wnt(this,r),i=t.call(this,n),WA.set(gse(i),{cachedColumnHeaders:[]}),i.ghostTable=new S3(i.hot),i.samplesGenerator=new pse(function(a,o){var s=i.hot.getCellMeta(a,o),l="";s.spanned||(l=i.hot.getDataAtCell(a,o));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new zu,i.hot.columnIndexMapper.registerMap(Ant,i.columnWidthsMap),i.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),i}return _nt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Ry]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[Ry];a&&a.useHeaders!==null&&a.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",a.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("afterFormulasValuesUpdate",function(o){return i.onAfterFormulasValuesUpdate(o)}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyColWidth",function(o,s){return i.getColumnWidth(s,o)}),this.addHook("afterInit",function(){return i.onAfterInit()}),Yf(Ms(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),Yf(Ms(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;Yf(Ms(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var a=this.hot.renderCall,o=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();o===-1||s===-1||this.calculateColumnsWidth({from:o,to:s},void 0,a)}}},{key:"calculateColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;rt(l.from,l.to,function(f){var c=i.hot.toPhysicalColumn(f);if(c===null&&(c=f),s||i.columnWidthsMap.getValueAtIndex(c)===null&&!i.hot._getColWidthFromSettings(c)){var h=i.samplesGenerator.generateColumnSamples(f,u);ne(h,function(d){var v=N9(d,2),p=v[0],g=v[1];return i.ghostTable.addColumn(p,g)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(f,c){var h=i.hot.toPhysicalColumn(f);i.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){v0(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=XO(c):(v0(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[Ry],a=i&&Br(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&Br(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[Ry],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countCols()-1;return kt(i)&&(a=i.syncLimit,aH(a)?a=vH(o,a):a>>=0),Math.min(a,o)}},{key:"getColumnWidth",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=a;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),o&&typeof s=="number"&&(s=Math.max(s,mH.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getFirstVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getFirstRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getLastVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getLastRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),a=WA.get(this),o=a.cachedColumnHeaders,s=Xr(i,function(l,u,f){var c=o.length;return(c-1<f||o[f]!==u)&&l.push(f),c-1<f?o.push(u):o[f]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];a.length?this.hot.batchExecution(function(){ne(a,function(o){i.columnWidthsMap.setValueAtIndex(o,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!ra(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var a=this,o=Rt(i,function(s){var l=N9(s,2),u=l[1];return a.hot.toPhysicalColumn(a.hot.propToCol(u))});this.clearCache(Array.from(new Set(o)))}},{key:"onBeforeColumnResize",value:function(i,a,o){var s=i;return o&&(this.calculateColumnsWidth(a,void 0,!0),s=this.getColumnWidth(a,void 0,!1)),s}},{key:"onAfterInit",value:function(){WA.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var a=ra(i,function(s){var l;return Xe((l=s.address)===null||l===void 0?void 0:l.col)}),o=Rt(a,function(s){return s.address.col});this.clearCache(Array.from(new Set(o)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Yf(Ms(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ry}},{key:"PLUGIN_PRIORITY",get:function(){return knt}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(tr),Kf={horizontal:"horizontal",vertical:"vertical"};function Int(e,t,r,n){var i=r.length,a=r?r[0].length:0,o=[],s=t.row-e.row,l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<l;f++){var c=parseInt(r[0][f],10),h=parseInt(r[i-1][f],10),d=(n==="down"?h-c:c-h)/(i-1)||0;u.push(d)}o.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<s;v++){var p=parseInt(r[v][0],10),g=parseInt(r[v][a-1],10),y=(n==="right"?g-p:p-g)/(a-1)||0;o.push([y])}return o}function Mnt(e,t,r){var n,i,a;return t[0]===e[0]&&t[1]<e[1]?(a="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(a="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(a="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(a="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:a,startOfDragCoords:n,endOfDragCoords:i}}function Dnt(e){var t={};return e===!0?(t.directions=Object.keys(Kf),t.autoInsertRow=!0):kt(e)?(Xe(e.autoInsertRow)?e.direction===Kf.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Xe(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Kf)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function fp(e){return fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fp(e)}function $nt(e){return Fnt(e)||Lnt(e)||yse(e)||Nnt()}function Nnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lnt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Fnt(e){if(Array.isArray(e))return PD(e)}function Hnt(e,t){return jnt(e)||Vnt(e,t)||yse(e,t)||Bnt()}function Bnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yse(e,t){if(e){if(typeof e=="string")return PD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PD(e,t)}}function PD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vnt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function jnt(e){if(Array.isArray(e))return e}function Wnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,znt(n.key),n)}}function Unt(e,t,r){return t&&H9(e.prototype,t),r&&H9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function znt(e){var t=Gnt(e,"string");return fp(t)==="symbol"?t:String(t)}function Gnt(e,t){if(fp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xf(){return typeof Reflect<"u"&&Reflect.get?Xf=Reflect.get.bind():Xf=function(t,r,n){var i=Ynt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Xf.apply(this,arguments)}function Ynt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ds(e),e!==null););return e}function Knt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ID(e,t)}function ID(e,t){return ID=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ID(e,t)}function Xnt(e){var t=Znt();return function(){var n=Ds(e),i;if(t){var a=Ds(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return qnt(this,i)}}function qnt(e,t){if(t&&(fp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mse(e)}function mse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Znt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ds(e){return Ds=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ds(e)}Je.getSingleton().register("modifyAutofillRange");Je.getSingleton().register("beforeAutofill");Je.getSingleton().register("afterAutofill");var B9="autofill",Jnt=20,Qnt=["fillHandle"],eit="insert_row_below",tit=200,rit=function(e){Knt(r,e);var t=Xnt(r);function r(n){var i;return Wnt(this,r),i=t.call(this,n),i.eventManager=new Nr(mse(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return Unt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(a){return i.onAfterCellCornerMouseDown(a)}),this.addHook("afterOnCellCornerDblClick",function(a){return i.onCellCornerDblClick(a)}),this.addHook("beforeOnCellMouseOver",function(a,o){return i.onBeforeCellMouseOver(o)}),Xf(Ds(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Xf(Ds(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Xf(Ds(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,a=this.hot.getSelectedRangeLast(),o=a.getTopStartCorner(),s=o.row,l=o.col,u=a.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:f,endCol:c}]),d=[],v=[],p=[];return ne(h,function(g){for(var y=g.startRow;y<=g.endRow;y+=1)d.indexOf(y)===-1&&d.push(y);for(var m=g.startCol;m<=g.endCol;m+=1)v.indexOf(m)===-1&&v.push(m)}),ne(d,function(g){var y=[];ne(v,function(m){y.push(i.hot.getCopyableData(g,m))}),p.push(y)}),p}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var a=this.hot.selection.highlight.getFill().getVisualCorners(),o=Hnt(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],p=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,s),Math.min(h.col,l),Math.max(d.row,u),Math.max(d.col,f)],v),g=Mnt(v,p,function(k,w){return i.hot._createCellCoords(k,w)}),y=g.directionOfDrag,m=g.startOfDragCoords,b=g.endOfDragCoords;if(m&&m.row>-1&&m.col>-1){var _=this.getSelectionData(),x=c.clone(),T=this.hot._createCellRange(m,m,b),E=this.hot.runHooks("beforeAutofill",_,x,T,y);if(E===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var P=Int(m,b,_,y),R=E,M=E;if(["up","left"].indexOf(y)>-1&&!(M.length===1&&M[0].length===0))if(R=[],y==="up")for(var D=b.row-m.row+1,N=D%M.length,B=0;B<D;B++)R.push(M[(B+(M.length-N))%M.length]);else for(var K=b.col-m.col+1,Z=K%M[0].length,ie=0;ie<M.length;ie++){R.push([]);for(var me=0;me<K;me++)R[ie].push(M[ie][(me+(M[ie].length-Z))%M[ie].length])}this.hot.populateFromArray(m.row,m.col,R,b.row,b.col,"".concat(this.pluginName,".fill"),null,y,P),this.setSelection(p),this.hot.runHooks("afterAutofill",R,x,T,y),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var a=this.hot.getSelectedRangeLast(),o=a.getBottomEndCorner(),s=i;if(this.directions.includes(Kf.vertical)&&this.directions.includes(Kf.horizontal)){var l=a.getTopStartCorner();(o.col<=i.col||l.col>=i.col)&&(s=this.hot._createCellCoords(o.row,i.col)),(o.row<i.row||l.row>i.row)&&(s=this.hot._createCellCoords(i.row,o.col))}else if(this.directions.includes(Kf.vertical))s=this.hot._createCellCoords(i.row,o.col);else if(this.directions.includes(Kf.horizontal))s=this.hot._createCellCoords(o.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var a=this.getCoordsOfDragAndDropBorders(i);a&&this.redrawBorders(a)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(eit,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},tit)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),a=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();i[2]<o-1&&a[2]===o-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var a=this.hot.getData(),o=this.hot.countRows(),s,l=i[2]+1;l<o;l++){for(var u=i[1];u<=i[3];u++){var f=a[l][u];if(f)return-1}var c=a[l][i[1]-1],h=a[l][i[3]+1];(c||h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,a){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(a,i[3])).commit()}},{key:"setSelection",value:function(i){var a;(a=this.hot).selectCell.apply(a,$nt(Rt(i,function(o){return Math.max(o,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),a=this.getIndexOfLastAdjacentFilledInRow(i);return a===-1||a===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,a),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var a=this.hot.rootDocument.documentElement,o=tn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||a.scrollTop)+$r(this.hot.table),s=tn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||a.scrollLeft)+fr(this.hot.table);return i.clientY>o&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var a=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&a?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=Dnt(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){Xf(Ds(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return B9}},{key:"PLUGIN_PRIORITY",get:function(){return Jnt}},{key:"SETTING_KEYS",get:function(){return[B9].concat(Qnt)}}]),r}(tr);function cp(e){return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}function nit(e,t){return sit(e)||oit(e,t)||ait(e,t)||iit()}function iit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ait(e,t){if(e){if(typeof e=="string")return V9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V9(e,t)}}function V9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sit(e){if(Array.isArray(e))return e}function lit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fit(n.key),n)}}function uit(e,t,r){return t&&j9(e.prototype,t),r&&j9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fit(e){var t=cit(e,"string");return cp(t)==="symbol"?t:String(t)}function cit(e,t){if(cp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ud(){return typeof Reflect<"u"&&Reflect.get?Ud=Reflect.get.bind():Ud=function(t,r,n){var i=hit(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Ud.apply(this,arguments)}function hit(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mu(e),e!==null););return e}function dit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MD(e,t)}function MD(e,t){return MD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MD(e,t)}function vit(e){var t=yit();return function(){var n=mu(e),i;if(t){var a=mu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pit(this,i)}}function pit(e,t){if(t&&(cp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return git(e)}function git(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mu(e)}var t1="autoRowSize",mit=40,bit="autoRowSize",wit=function(e){dit(r,e);var t=vit(r);function r(n){var i;return lit(this,r),i=t.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new S3(i.hot),i.samplesGenerator=new pse(function(a,o){var s;return a>=0?s=i.hot.getDataAtCell(a,o):a===-1&&(s=i.hot.getColHeader(o)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new zu,i.hot.rowIndexMapper.registerMap(bit,i.rowHeightsMap),i.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)}),i}return uit(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[t1];return i===!0||kt(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyRowHeight",function(a,o){return i.getRowHeight(o,a)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),Ud(mu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,Ud(mu(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}rt(l.from,l.to,function(c){if(s||i.rowHeightsMap.getValueAtIndex(c)===null){var h=i.samplesGenerator.generateRowSamples(c,u);ne(h,function(d){var v=nit(d,2),p=v[0],g=v[1];return i.ghostTable.addRow(p,g)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(c,h){c<0?i.headerHeight=h:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){v0(l),i.inProgress=!1;return}i.calculateRowsHeight({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=XO(c):(v0(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[t1],a=i&&Br(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&Br(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllRowsHeight",value:function(){hv(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[t1],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countRows()-1;return kt(i)&&(a=i.syncLimit,aH(a)?a=vH(o,a):a>>=0),Math.min(a,o)}},{key:"getRowHeight",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=a;return o!==null&&o>(a||0)&&(s=o),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var a=this,o=typeof i=="number"?{from:i,to:i}:i,s=o.from,l=o.to;this.hot.batchExecution(function(){rt(Math.min(s,l),Math.max(s,l),function(u){a.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!ra(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,a=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(o===-1||s===-1)){if(this.calculateRowsHeight({from:o,to:s},void 0,i),a){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-a,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,a){this.clearCacheByRange({from:i,to:a}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,a,o){var s=i;return o&&(this.calculateRowsHeight(a,void 0,!0),s=this.getRowHeight(a)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var a=null;i.length===1?a=i[0][0]:i.length>1&&(a={from:i[0][0],to:i[i.length-1][0]}),a!==null&&this.clearCacheByRange(a)}},{key:"destroy",value:function(){this.ghostTable.clean(),Ud(mu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return t1}},{key:"PLUGIN_PRIORITY",get:function(){return mit}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(tr);function hp(e){return hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hp(e)}function _it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cit(n.key),n)}}function Sit(e,t,r){return t&&W9(e.prototype,t),r&&W9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cit(e){var t=xit(e,"string");return hp(t)==="symbol"?t:String(t)}function xit(e,t){if(hp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mm(){return typeof Reflect<"u"&&Reflect.get?Mm=Reflect.get.bind():Mm=function(t,r,n){var i=Tit(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Mm.apply(this,arguments)}function Tit(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Uc(e),e!==null););return e}function Oit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DD(e,t)}function DD(e,t){return DD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DD(e,t)}function Eit(e){var t=Ait();return function(){var n=Uc(e),i;if(t){var a=Uc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Rit(this,i)}}function Rit(e,t){if(t&&(hp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kit(e)}function kit(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ait(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uc(e){return Uc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Uc(e)}var bse=Soe("physicallyIndexed"),Pit=bse.getListWithInsertedItems,Iit=bse.getListWithRemovedItems,Mit=function(e){Oit(r,e);var t=Eit(r);function r(){return _it(this,r),t.call(this,function(n){return n})}return Sit(r,[{key:"insert",value:function(i,a){var o=NH(this.indexedValues,a);this.indexedValues=Pit(o,i,a,this.initValueOrFn),Mm(Uc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=Iit(this.indexedValues,i);this.indexedValues=$H(a,i),Mm(Uc(r.prototype),"remove",this).call(this,i)}}]),r}(ch);const Dit=Mit;function dp(e){return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dp(e)}function $it(e){return Hit(e)||Fit(e)||Lit(e)||Nit()}function Nit(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lit(e,t){if(e){if(typeof e=="string")return $D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $D(e,t)}}function Fit(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Hit(e){if(Array.isArray(e))return $D(e)}function $D(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jit(n.key),n)}}function Vit(e,t,r){return t&&U9(e.prototype,t),r&&U9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jit(e){var t=Wit(e,"string");return dp(t)==="symbol"?t:String(t)}function Wit(e,t){if(dp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dm(){return typeof Reflect<"u"&&Reflect.get?Dm=Reflect.get.bind():Dm=function(t,r,n){var i=Uit(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Dm.apply(this,arguments)}function Uit(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zc(e),e!==null););return e}function zit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ND(e,t)}function ND(e,t){return ND=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ND(e,t)}function Git(e){var t=Xit();return function(){var n=zc(e),i;if(t){var a=zc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Yit(this,i)}}function Yit(e,t){if(t&&(dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kit(e)}function Kit(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zc(e){return zc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zc(e)}var wse=Soe("physicallyIndexed"),qit=wse.getListWithInsertedItems,Zit=wse.getListWithRemovedItems,Jit=function(e){zit(r,e);var t=Git(r);function r(){return Bit(this,r),t.call(this,function(n){return n})}return Vit(r,[{key:"insert",value:function(i,a){var o=this;this.indexedValues=qit(this.indexedValues,i,a,function(s,l){return o.getNextValue(l)}),Dm(zc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=Zit(this.indexedValues,i),Dm(zc(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,$it(this.getValues()))+1+i}}]),r}(ch);const Qit=Jit;function vp(e){return vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vp(e)}function eat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rat(n.key),n)}}function tat(e,t,r){return t&&z9(e.prototype,t),r&&z9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rat(e){var t=nat(e,"string");return vp(t)==="symbol"?t:String(t)}function nat(e,t){if(vp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zd(){return typeof Reflect<"u"&&Reflect.get?zd=Reflect.get.bind():zd=function(t,r,n){var i=iat(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},zd.apply(this,arguments)}function iat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function aat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LD(e,t)}function LD(e,t){return LD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LD(e,t)}function oat(e){var t=uat();return function(){var n=bu(e),i;if(t){var a=bu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return sat(this,i)}}function sat(e,t){if(t&&(vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lat(e)}function lat(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var UA="bindRowsWithHeaders",fat=210,cat="loose",hat=new Map([["loose",Dit],["strict",Qit]]),dat=function(e){aat(r,e);var t=oat(r);function r(n){var i;return eat(this,r),i=t.call(this,n),i.headerIndexes=null,i}return tat(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[UA]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[UA];typeof a!="string"&&(a=cat);var o=hat.get(a);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new o),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),zd(bu(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),zd(bu(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){zd(bu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return UA}},{key:"PLUGIN_PRIORITY",get:function(){return fat}}]),r}(tr);function pp(e){return pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(e)}function G9(e){return yat(e)||gat(e)||pat(e)||vat()}function vat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pat(e,t){if(e){if(typeof e=="string")return FD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FD(e,t)}}function gat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yat(e){if(Array.isArray(e))return FD(e)}function FD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_se(n.key),n)}}function bat(e,t,r){return t&&Y9(e.prototype,t),r&&Y9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qf(){return typeof Reflect<"u"&&Reflect.get?qf=Reflect.get.bind():qf=function(t,r,n){var i=wat(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},qf.apply(this,arguments)}function wat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$s(e),e!==null););return e}function _at(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HD(e,t)}function HD(e,t){return HD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HD(e,t)}function Sat(e){var t=xat();return function(){var n=$s(e),i;if(t){var a=$s(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Cat(this,i)}}function Cat(e,t){if(t&&(pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yd(e)}function yd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $s(e){return $s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$s(e)}function Tat(e,t,r){Oat(e,t),t.set(e,r)}function Oat(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zA(e,t,r){return t=_se(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _se(e){var t=Eat(e,"string");return pp(t)==="symbol"?t:String(t)}function Eat(e,t){if(pp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K9(e,t){var r=Sse(e,t,"get");return Rat(e,r)}function Rat(e,t){return t.get?t.get.call(e):t.value}function GA(e,t,r){var n=Sse(e,t,"set");return kat(e,n,r),r}function Sse(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function kat(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var YA="collapsibleColumns",Aat=290,Pat=["nestedHeaders"],Yh="collapsibleIndicator",X9=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Kh=new WeakMap,Iat=function(e){_at(r,e);var t=Sat(r);function r(){var n;mat(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),zA(yd(n),"nestedHeadersPlugin",null),zA(yd(n),"eventManager",new Nr(yd(n))),zA(yd(n),"headerStateManager",null),Tat(yd(n),Kh,{writable:!0,value:null}),n}return bat(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YA]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;o||gr("You need to configure the Nested Headers plugin in order to use collapsible headers."),GA(this,Kh,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return i.onBeforeOnCellMouseDown(s,l,u)}),qf($s(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),a=i.collapsibleColumns;typeof a=="boolean"?this.headerStateManager.mapState(function(o){return{collapsible:o.origColspan>1}}):Array.isArray(a)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(a))}qf($s(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),GA(this,Kh,null),this.nestedHeadersPlugin=null,this.clearButtons(),qf($s(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,a=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(f){f&&f.parentNode.removeChild(f)};rt(0,i-1,function(u){var f=a.childNodes[u],c=o.childNodes[u],h=s?s.childNodes[u]:null;rt(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(Yh));l(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(Yh)),l(v)),s&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(Yh)),l(v))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var a=this,o=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,f=s.headerLevel,c=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&i==="expand"||!h&&i==="collapse"))return{row:a.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(o,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,a){var o=this;if(!X9.has(a))throw new Error("Unsupported action is passed (".concat(a,")."));if(Array.isArray(i)){var s=ra(i,function(g){var y=g.row;return y<0}),l=s.length>0;ne(s,function(g){var y,m=g.row,b=g.col,_=(y=o.headerStateManager.getHeaderSettings(m,b))!==null&&y!==void 0?y:{},x=_.collapsible,T=_.isCollapsed;if(!x||T&&a==="collapse"||!T&&a==="expand")return l=!1,!1});var u=[],f=[];l&&ne(s,function(g){var y=g.row,m=g.col,b=o.headerStateManager.triggerNodeModification(a,y,m),_=b.colspanCompensation,x=b.affectedColumns,T=b.rollbackModification;_>0&&(f.push.apply(f,G9(x)),u.push(T))});var c=this.getCollapsedColumns(),h=[];a==="collapse"?h=MF([].concat(G9(c),f)):a==="expand"&&(h=ra(c,function(g){return!f.includes(g)}));var d=X9.get(a),v=this.hot.runHooks(d.beforeHook,c,h,l);if(v===!1){ne(u,function(g){g()});return}this.hot.batchExecution(function(){ne(f,function(g){K9(o,Kh).setValueAtIndex(o.hot.toPhysicalColumn(g),d.hideColumn)})},!0);var p=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,l,p),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return K9(this,Kh).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,a,o){var s,l=(s=this.headerStateManager.getHeaderSettings(o,i))!==null&&s!==void 0?s:{},u=l.collapsible,f=l.origColspan,c=l.isCollapsed,h=u&&f>1&&i>=this.hot.getSettings().fixedColumnsStart,d=a.querySelector(".".concat(Yh));if(h)d||(d=this.hot.rootDocument.createElement("div"),ke(d,Yh),a.querySelector("div:first-child").appendChild(d)),wt(d,["collapsed","expanded"]),c?(ke(d,"collapsed"),Nu(d,"+")):(ke(d,"expanded"),Nu(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,a){mt(i.target,Yh)&&(mt(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"collapse")):mt(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"expand")),go(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){GA(this,Kh,null),qf($s(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YA}},{key:"PLUGIN_PRIORITY",get:function(){return Aat}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[YA].concat(Pat)}}]),r}(tr);function kb(e){return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kb(e)}function q9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Mat(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q9(Object(r),!0).forEach(function(n){Dat(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dat(e,t,r){return t=Cse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z9(e,t){return Fat(e)||Lat(e,t)||Nat(e,t)||$at()}function $at(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nat(e,t){if(e){if(typeof e=="string")return J9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J9(e,t)}}function J9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lat(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Fat(e){if(Array.isArray(e))return e}function Hat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cse(n.key),n)}}function Bat(e,t,r){return t&&Q9(e.prototype,t),r&&Q9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cse(e){var t=Vat(e,"string");return kb(t)==="symbol"?t:String(t)}function Vat(e,t){if(kb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jat=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Wat=!1,Uat=!0,zat=!0,Gat=function(){function e(t,r){Hat(this,e),this.hot=t,this.sortingStates=new yE,this.sortEmptyCells=Wat,this.indicator=Uat,this.headerAction=zat,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return Bat(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;kt(r)&&At(r,function(i,a){jat.includes(a)&&(n[a]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=Z9(n,1),a=i[0];return a===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return kt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var a=Z9(i,2),o=a[0],s=a[1];return Mat({column:r.hot.toVisualColumn(o)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(Xe(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),wT="asc",_T="desc",Yat="colHeader";function Kat(e){if(kt(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[wT,_T].includes(r)}function Xat(e){if(e.some(function(r){return Kat(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function e7(e){if(e!==_T)return e===wT?_T:wT}function t7(e){var t=e.querySelector(".".concat(Yat));return t}function r7(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function BD(e,t,r){return e===-1&&t>=0&&Fu(r)===!1}var qat="ascending",Zat="descending",xse="indicatorDisabled",Tse="columnSorting",Ose="sortAction",Ese=new Map([[wT,qat],[_T,Zat]]);function Jat(e,t,r,n){var i=[Tse];if(n&&i.push(Ose),r===!1)return i.push(xse),i;var a=e.getSortOrderOfColumn(t);return Xe(a)&&i.push(Ese.get(a)),i}function Qat(){return Array.from(Ese.values()).concat(Ose,xse,Tse)}function Rse(e,t,r){var n=t.locale;return function(i,a){var o=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof a=="string"&&(a=a.toLocaleLowerCase(n)),i===a?qo:vn(i)?vn(a)?qo:o&&e==="asc"?Fr:Hr:vn(a)?o&&e==="asc"?Hr:Fr:isNaN(i)&&!isNaN(a)?e==="asc"?Hr:Fr:!isNaN(i)&&isNaN(a)||(isNaN(i)||isNaN(a)||(i=parseFloat(i),a=parseFloat(a)),i<a)?e==="asc"?Fr:Hr:i>a?e==="asc"?Hr:Fr:qo}}var kse="default";function eot(e,t,r){return function(n,i){var a=parseFloat(n),o=parseFloat(i),s=r.sortEmptyCells;if(a===o||isNaN(a)&&isNaN(o))return qo;if(s){if(vn(n))return e==="asc"?Fr:Hr;if(vn(i))return e==="asc"?Hr:Fr}return isNaN(a)?Hr:isNaN(o)?Fr:a<o?e==="asc"?Fr:Hr:a>o?e==="asc"?Hr:Fr:qo}}var tot="numeric";function rot(e,t,r){var n=t.checkedTemplate,i=t.uncheckedTemplate,a=r.sortEmptyCells;return function(o,s){var l=vn(o),u=vn(s),f=l?i:o,c=u?i:s,h=f===i||f===n,d=c===i||c===n;if(a===!1){if(l&&u===!1)return Hr;if(l===!1&&u)return Fr}return h===!1&&d?e==="asc"?Fr:Hr:h&&d===!1?e==="asc"?Hr:Fr:h===!1&&d===!1?Rse(e,t,r)(o,s):f===i&&c===n?e==="asc"?Fr:Hr:f===n&&c===i?e==="asc"?Hr:Fr:qo}}var not="checkbox";function iot(e,t,r){return function(n,i){var a=r.sortEmptyCells;if(n===i)return qo;if(vn(n))return vn(i)?qo:a&&e==="asc"?Fr:Hr;if(vn(i))return a&&e==="asc"?Hr:Fr;var o=t.dateFormat,s=Ae(n,o),l=Ae(i,o);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?Fr:Hr:l.isBefore(s)?e==="asc"?Hr:Fr:qo:Fr:Hr}}var aot="date",C3=Ha("sorting.compareFunctionFactory"),EE=C3.register,n7=C3.getItem,oot=C3.hasItem,Ase=Ha("sorting.mainSortComparator"),Pse=Ase.register,sot=Ase.getItem;function Ise(e){return oot(e)?n7(e):n7(kse)}EE(tot,eot);EE(not,rot);EE(aot,iot);EE(kse,Rse);var qo=0,Fr=-1,Hr=1;function lot(e,t){for(var r=sot(t),n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];e.sort(r.apply(void 0,i))}function i7(e){return hot(e)||cot(e)||fot(e)||uot()}function uot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fot(e,t){if(e){if(typeof e=="string")return a7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a7(e,t)}}function a7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hot(e){if(Array.isArray(e))return e}function dot(e,t){return function(r,n){var i=i7(r),a=i.slice(1),o=i7(n),s=o.slice(1);return function(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.columnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:Ise(c.type),g=p(f,c,v)(h,d);return g}(0)}}function gp(e){return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}var vot=["column"],pot=["column"];function Xh(e){return bot(e)||mot(e)||yot(e)||got()}function got(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yot(e,t){if(e){if(typeof e=="string")return VD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VD(e,t)}}function mot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bot(e){if(Array.isArray(e))return VD(e)}function VD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function s7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(r),!0).forEach(function(n){wot(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wot(e,t,r){return t=Mse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l7(e,t){if(e==null)return{};var r=_ot(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _ot(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Sot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mse(n.key),n)}}function Cot(e,t,r){return t&&u7(e.prototype,t),r&&u7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mse(e){var t=xot(e,"string");return gp(t)==="symbol"?t:String(t)}function xot(e,t){if(gp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zf(){return typeof Reflect<"u"&&Reflect.get?Zf=Reflect.get.bind():Zf=function(t,r,n){var i=Tot(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Zf.apply(this,arguments)}function Tot(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ns(e),e!==null););return e}function Oot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jD(e,t)}function jD(e,t){return jD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jD(e,t)}function Eot(e){var t=Aot();return function(){var n=Ns(e),i;if(t){var a=Ns(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Rot(this,i)}}function Rot(e,t){if(t&&(gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kot(e)}function kot(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aot(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ns(e){return Ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ns(e)}var WD="columnSorting",Pot=50,f7="append",Iot="replace";Pse(WD,dot);Je.getSingleton().register("beforeColumnSort");Je.getSingleton().register("afterColumnSort");var Dse=function(e){Oot(r,e);var t=Eot(r);function r(n){var i;return Sot(this,r),i=t.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=WD,i.indexesSequenceCache=null,i}return Cot(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new Gat(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new zu(function(a){var o=i.hot.toVisualColumn(a);return o===null&&(o=a),i.getMergedPluginSettings(o)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(a,o){return i.onAfterOnCellMouseDown(a,o)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Zf(Ns(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,a=function(s,l){var u=t7(l);r7(s,l)===!1||u===null||i.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",a)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Zf(Ns(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var a=this.getSortConfig(),o=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(o),l=this.hot.runHooks("beforeColumnSort",a,o,s);l!==!1&&(a.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Coe),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",a,s?o:a,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return Xe(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var a=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(a)&&this.columnStatesManager.setSortStates(a)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var a=this.hot.countCols();return Xat(i)&&i.every(function(o){var s=o.column;return s<=a&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var a=this,o=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var f=u.column,c=l7(u,vot);return s7({column:a.hot.toPhysicalColumn(f)},c)};o.initialConfig=Rt(i,s),this.hot.runHooks("persistentStateSave","columnSorting",o)}},{key:"getAllSavedSortSettings",value:function(){var i=this,a={};this.hot.runHooks("persistentStateLoad","columnSorting",a);var o=a.value,s=function(u){var f=u.column,c=l7(u,pot);return s7({column:i.hot.toVisualColumn(f)},c)};return Xe(o)&&Array.isArray(o.initialConfig)&&(o.initialConfig=Rt(o.initialConfig,s)),o}},{key:"getColumnNextConfig",value:function(i){var a=this.columnStatesManager.getSortOrderOfColumn(i);if(Xe(a)){var o=e7(a);return Xe(o)?{column:i,sortOrder:o}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:e7()}}},{key:"getNextSortConfig",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f7,o=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=o!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(i);if(s){if(pr(u))return[].concat(Xh(l.slice(0,o)),Xh(l.slice(o+1)));if(a===f7)return[].concat(Xh(l.slice(0,o)),Xh(l.slice(o+1)),[u]);if(a===Iot)return[].concat(Xh(l.slice(0,o)),[u],Xh(l.slice(o+1)))}return Xe(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(i){if(kt(i)){var a=i[this.pluginKey];if(kt(a))return a}return{}}},{key:"getMergedPluginSettings",value:function(i){var a=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns[i])):wr(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns(i))):Object.assign(o,a)}},{key:"getFirstCellSettings",value:function(i){var a=this.hot.getCellMeta(0,i),o=Object.create(a);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),o}},{key:"getNumberOfRowsToSort",value:function(i){var a=this.hot.getSettings();return a.maxRows<=i?a.maxRows:i-a.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var a=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var o=[],s=this.hot.countRows(),l=function(g){return Rt(i,function(y){return a.hot.getDataAtCell(g,y.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)o.push([this.hot.toPhysicalRow(u)].concat(l(u)));var f=Rt(o,function(p){return p[0]});lot(o,this.pluginKey,Rt(i,function(p){return p.sortOrder}),Rt(i,function(p){return a.getFirstCellSettings(p.column)}));for(var c=o.length;c<s;c+=1)o.push([c].concat(l(c)));var h=Rt(o,function(p){return p[0]}),d=new Map(Rt(f,function(p,g){return[p,h[g]]})),v=Rt(this.hot.rowIndexMapper.getIndexesSequence(),function(p){return d.has(p)?d.get(p):p});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(kt(i))this.sortBySettings(i);else{var a=this.hot.getSettings()[this.pluginKey];this.sortBySettings(a)}}},{key:"sortBySettings",value:function(i){if(kt(i)){this.columnStatesManager.updateAllColumnsProperties(i);var a=i.initialConfig;(Array.isArray(a)||kt(a))&&this.sort(a)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,a){var o=t7(a);if(!(r7(i,a)===!1||o===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(o,this.columnStatesManager,i,l,u)}}},{key:"updateHeaderClasses",value:function(i){if(wt(i,Qat()),this.enabled!==!1){for(var a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];ke(i,Jat.apply(void 0,o))}}},{key:"onUpdateSettings",value:function(i){Zf(Ns(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Xe(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,a){var o=this.getFirstCellSettings(a)[this.pluginKey],s=o.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){BD(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){BD(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(a.col)),this.sort(this.getColumnNextConfig(a.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Zf(Ns(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return WD}},{key:"PLUGIN_PRIORITY",get:function(){return Pot}}]),r}(tr),Mot=vt,x3=Pt,Dot=Uu,$ot=Wre,Not=Vne,c7=Ct,Lot=RangeError,$se=String,Nse=Math.floor,UD=x3(Not),h7=x3("".slice),ky=x3(1 .toFixed),kd=function(e,t,r){return t===0?r:t%2===1?kd(e,t-1,r*e):kd(e*e,t/2,r)},Fot=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},qh=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=Nse(i/1e7)},KA=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=Nse(n/t),n=n%t*1e7},d7=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=$se(e[t]);r=r===""?n:r+UD("0",7-n.length)+n}return r},Hot=c7(function(){return ky(8e-5,3)!=="0.000"||ky(.9,0)!=="1"||ky(1.255,2)!=="1.25"||ky(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!c7(function(){ky({})});Mot({target:"Number",proto:!0,forced:Hot},{toFixed:function(t){var r=$ot(this),n=Dot(t),i=[0,0,0,0,0,0],a="",o="0",s,l,u,f;if(n<0||n>20)throw Lot("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return $se(r);if(r<0&&(a="-",r=-r),r>1e-21)if(s=Fot(r*kd(2,69,1))-69,l=s<0?r*kd(2,-s,1):r/kd(2,s,1),l*=4503599627370496,s=52-s,s>0){for(qh(i,0,l),u=n;u>=7;)qh(i,1e7,0),u-=7;for(qh(i,kd(10,u,1),0),u=s-1;u>=23;)KA(i,1<<23),u-=23;KA(i,1<<u),qh(i,1,1),KA(i,2),o=d7(i)}else qh(i,0,l),qh(i,1<<-s,0),o=d7(i)+UD("0",n);return n>0?(f=o.length,o=a+(f<=n?"0."+UD("0",n-f)+o:h7(o,0,f-n)+"."+h7(o,f-n))):o=a+o,o}});function Ab(e){return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(e)}function Bot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jot(n.key),n)}}function Vot(e,t,r){return t&&v7(e.prototype,t),r&&v7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jot(e){var t=Wot(e,"string");return Ab(t)==="symbol"?t:String(t)}function Wot(e,t){if(Ab(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ab(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uot=function(){function e(t,r){Bot(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return Vot(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],a=r;if(!a&&typeof this.settings=="function"){this.settingsType="function";return}return a||(a=this.settings),ne(a,function(o){var s={};n.assignSetting(o,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(o,s,"reversedRowCoords",!1),n.assignSetting(o,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"sourceColumn",o.destinationColumn),n.assignSetting(o,s,"type","sum"),n.assignSetting(o,s,"forceNumeric",!1),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"customFunction",null),n.assignSetting(o,s,"readOnly",!0),n.assignSetting(o,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(r,n,i,a){if(i==="ranges"&&r[i]===void 0){n[i]=a;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(a instanceof Error)throw a;n[i]=a}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var a=r.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();ne(o,function(s){a==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=i:r==="remove_row"&&(s.alterRowOffset=-1*i)),a==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=i:r==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,a,o){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function p(){return s.hot.removeHook("beforeViewRender",p),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;ne(h,function(p){f==="row"&&p.destinationRow>=v&&(p.alterRowOffset=c*i),f==="col"&&p.destinationColumn>=v&&(p.alterColumnOffset=c*i)}),this.resetAllEndpoints(h,!d),d?ne(h,function(p){s.extendEndpointRanges(p,v,a[0],a.length),s.recreatePhysicalRanges(p),s.clearOffsetInformation(p)}):ne(h,function(p){s.shiftEndpointCoordinates(p,v)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,a){ne(r.ranges,function(o){o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=a:i<o[0]&&(o[0]-=a):i>=o[0]&&i<=o[1]&&(o[1]-=a,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,a=[],o=[];ne(i,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));o.push(l)}),ne(o,function(s){var l=[];ne(s,function(u,f){f===0?l.push(u):s[f]!==s[f-1]+1&&(l.push(s[f-1]),a.push(l),l=[],l.push(u)),f===s.length-1&&(l.push(u),a.push(l))})}),r.ranges=a}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,ne(r.ranges,function(i){ne(i,function(a,o){a>=n&&(i[o]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=n.some(function(o){var s=o.alterRowOffset||0,l=o.alterColumnOffset||0;return o.destinationRow+s>=r.hot.countRows()||o.destinationColumn+l>=r.hot.countCols()});a||(this.cellsToSetCache=[],ne(n,function(o){r.resetEndpointValue(o,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],ne(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],ne(r,function(a,o,s){"".concat(a[2]||"")!=="".concat(a[3])&&ne(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[o][1])===l.sourceColumn&&i.indexOf(u)===-1&&i.push(u)})}),ne(i,function(a){n.refreshEndpoint(n.getEndpoint(a))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,a=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?a:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var o=this.hot.toVisualRow(r.destinationRow);if(o!==null){var s=this.hot.getCellMeta(o,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(a,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([a,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){gr("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const zot=Uot;function XA(e){return e==null||isNaN(e)}function yp(e){return yp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yp(e)}var p7;function Got(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Yot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xot(n.key),n)}}function Kot(e,t,r){return t&&g7(e.prototype,t),r&&g7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xot(e){var t=qot(e,"string");return yp(t)==="symbol"?t:String(t)}function qot(e,t){if(yp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TC(){return typeof Reflect<"u"&&Reflect.get?TC=Reflect.get.bind():TC=function(t,r,n){var i=Zot(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},TC.apply(this,arguments)}function Zot(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mp(e),e!==null););return e}function Jot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zD(e,t)}function zD(e,t){return zD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zD(e,t)}function Qot(e){var t=rst();return function(){var n=mp(e),i;if(t){var a=mp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return est(this,i)}}function est(e,t){if(t&&(yp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tst(e)}function tst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mp(e){return mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mp(e)}var qA="columnSummary",nst=220,ist=function(e){Jot(r,e);var t=Qot(r);function r(n){var i;return Yot(this,r),i=t.call(this,n),i.endpoints=null,i}return Kot(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qA]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[qA],this.endpoints=new zot(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",a,o,null,s)}),this.addHook("beforeCreateCol",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",a,o,null,s)}),this.addHook("beforeRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",a,o,null,s)}),this.addHook("afterCreateCol",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",a,o,null,s)}),this.addHook("afterRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),TC(mp(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var a=this,o=0;return At(i.ranges,function(s){o+=a.getPartialSum(s,i.sourceColumn)}),o}},{key:"getPartialSum",value:function(i,a){var o=0,s=i[1]||i[0],l=null,u=0;do{if(l=this.getCellValue(s,a),l=XA(l)?null:l,l!==null){var f=("".concat(l).split(".")[1]||[]).length||1;f>u&&(u=f)}o+=l||0,s-=1}while(s>=i[0]);return Math.round(o*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(i,a){var o=this,s=null;return At(i.ranges,function(l){var u=o.getPartialMinMax(l,i.sourceColumn,a);if(s===null&&u!==null&&(s=u),u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,a,o){var s=null,l=i[1]||i[0],u;do{if(u=this.getCellValue(l,a),u=XA(u)?null:u,s===null)s=u;else if(u!==null)switch(o){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,a){var o,s=0,l=i[1]||i[0];do o=this.getCellValue(l,a),o=XA(o)?null:o,o===null&&(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var a=this,o=0,s=i.ranges;return At(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,f=a.countEmpty(l,i.sourceColumn);o+=u,o-=f}),o}},{key:"calculateAverage",value:function(i){var a=this.calculateSum(i),o=this.countEntries(i);return a/o}},{key:"getCellValue",value:function(i,a){var o=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(a),l=this.hot.getSourceDataAtCell(i,a),u="";if(o!==null&&s!==null&&(u=this.hot.getCellMeta(o,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(sr(p7||(p7=Got(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,a));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,a){i&&a!=="ColumnSummary.reset"&&a!=="ColumnSummary.set"&&a!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,a){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",a,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return qA}},{key:"PLUGIN_PRIORITY",get:function(){return nst}}]),r}(tr);function Pb(e){return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pb(e)}function ast(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sst(n.key),n)}}function ost(e,t,r){return t&&y7(e.prototype,t),r&&y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sst(e){var t=lst(e,"string");return Pb(t)==="symbol"?t:String(t)}function lst(e,t){if(Pb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ust=function(){function e(t,r){ast(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return ost(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:fr(this.getInputElement()),height:$r(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ke(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ke(r,e.CLASS_EDITOR),ke(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const fst=ust;var Dt="---------";function cst(){return{name:Dt}}function hst(e){return Rt(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function r1(e){return mt(e,"htSeparator")}function dst(e){return mt(e,"htSubmenu")}function n1(e){return mt(e,"htDisabled")}function i1(e){return mt(e,"htSelectionDisabled")}function dh(e){var t=e.getSelected();return!t||t[0]<0?null:t}function vst(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function pst(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function Rf(e,t){var r={};return ne(e,function(n){n.forAll(function(i,a){i>=0&&a>=0&&(r[i]||(r[i]=[]),r[i][a]=t(i,a))})}),r}function Kl(e,t,r,n,i){ne(e,function(a){a.forAll(function(o,s){o>=0&&s>=0&&gst(o,s,t,r,n,i)})})}function gst(e,t,r,n,i,a){var o=i(e,t),s=n;o.className&&(r==="vertical"?s=vst(o.className,n):s=pst(o.className,n)),a(e,t,"className",s)}function Ho(e,t){var r=!1;return Array.isArray(e)&&ne(e,function(n){return n.forAll(function(i,a){if(i>=0&&a>=0&&t(i,a))return r=!0,!1}),r}),r}function Cs(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function yst(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function Lse(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function mst(e,t){var r=e.slice(0);return r.reverse(),r=Lse(r,t),r.reverse(),r}function bst(e){var t=[];return ne(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function wst(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Dt,r=e.slice(0);return r=Lse(r,t),r=mst(r,t),r=bst(r),r}function Ib(e){return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ib(e)}function _st(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cst(n.key),n)}}function Sst(e,t,r){return t&&m7(e.prototype,t),r&&m7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cst(e){var t=xst(e,"string");return Ib(t)==="symbol"?t:String(t)}function xst(e,t){if(Ib(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ib(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tst=250,Ost=250,Fse=function(){function e(t){_st(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return Sst(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},Ost)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tst;this.showDebounced=fH(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();mr(Fse,Bi);const Est=Fse;function bp(e){return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function ZA(e,t,r){return t=Hse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hse(n.key),n)}}function kst(e,t,r){return t&&b7(e.prototype,t),r&&b7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hse(e){var t=Ast(e,"string");return bp(t)==="symbol"?t:String(t)}function Ast(e,t){if(bp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jf(){return typeof Reflect<"u"&&Reflect.get?Jf=Reflect.get.bind():Jf=function(t,r,n){var i=Pst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Jf.apply(this,arguments)}function Pst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ls(e),e!==null););return e}function Ist(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GD(e,t)}function GD(e,t){return GD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GD(e,t)}function Mst(e){var t=$st();return function(){var n=Ls(e),i;if(t){var a=Ls(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Dst(this,i)}}function Dst(e,t){if(t&&(bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bse(e)}function Bse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $st(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ls(e){return Ls=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ls(e)}var JA="comments",Nst=60,a1=new WeakMap,Ao="comment",Zh="value",w7="style",o1="readOnly",Lst=function(e){Ist(r,e);var t=Mst(r);function r(n){var i;return Rst(this,r),i=t.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,a1.set(Bse(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return kst(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[JA]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new fst(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Nr(this)),this.displaySwitch||(this.displaySwitch=new Est(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(a){return i.addToContextMenu(a)}),this.addHook("afterRenderer",function(a,o,s,l,u,f){return i.onAfterRenderer(a,f)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(a,o){return i.showAtCell(a,o)}),this.registerListeners(),Jf(Ls(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Jf(Ls(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Jf(Ls(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,a=this.hot.rootDocument;this.eventManager.addEventListener(a,"mouseover",function(o){return i.onMouseOver(o)}),this.eventManager.addEventListener(a,"mousedown",function(o){return i.onMouseDown(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(o){return i.onEditorMouseDown(o)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(o){return i.onEditorMouseUp(o)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var a=pu(i.target,"TD","TBODY");return!!(a&&mt(a,"htCommentCell")&&pu(a,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.editor.getValue(),o="";i!=null?o=i:a!=null&&(o=a);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,ZA({},Zh,o)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,a,o){this.setRange({from:this.hot._createCellCoords(i,a)}),this.setComment(o)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ao),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,a)}),this.removeComment(o)}},{key:"getComment",value:function(){var i=this.range.from.row,a=this.range.from.col;return this.getCommentMeta(i,a,Zh)}},{key:"getCommentAtCell",value:function(i,a){return this.getCommentMeta(i,a,Zh)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,a=i.row,o=i.col;if(a<0||a>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[Ao]?s[Ao][Zh]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,a){return this.setRange({from:this.hot._createCellCoords(i,a)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,a,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!o&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=l.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),p=d===null;this.editor.setPosition(0,0),d===null&&(d=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var g=d===null,y=v===null;d=(i=d)!==null&&i!==void 0?i:0,v=(a=v)!==null&&a!==void 0?a:0;var m=this.hot,b=m.rootWindow,_=m.view._wt,x=_.wtTable,T=_.getCell({row:d,col:v},!0),E=this.getCommentMeta(c,h,w7);E?this.editor.setSize(E.width,E.height):this.editor.resetSize();var P=y?0:x.getStretchedColumnWidth(v),R=p&&!g?$r(T):0,M=T.getBoundingClientRect(),D=M.left,N=M.top,B=M.width,K=M.height,Z=this.editor.getSize(),ie=Z.width,me=Z.height,k=this.hot.rootWindow,w=k.innerWidth,C=k.innerHeight,O=this.hot.rootDocument.documentElement,S=D+b.scrollX+P,A=N+b.scrollY+R;this.hot.isRtl()&&(S-=ie+P),this.hot.isLtr()&&D+B+ie>w?S=D+b.scrollX-ie-1:this.hot.isRtl()&&S<-(O.scrollWidth-O.clientWidth)&&(S=D+b.scrollX+P+1),N+me>C&&(A-=me-K+1),this.editor.setPosition(S,A),this.editor.setReadOnlyState(this.getCommentMeta(c,h,o1))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var a=!1,o=i.getTopStartCorner();return this.getCommentMeta(o.row,o.col,Zh)&&(a=!0),a}},{key:"updateCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a)[Ao],l;s?(l=qn(s),r_(l,o)):l=o,this.hot.setCellMeta(i,a,Ao,l)}},{key:"getCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a);if(s[Ao])return s[Ao][o]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var a=pu(i.target,"TD","TBODY"),o=null;a&&(o=this.hot.getCoords(a)),(!a||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var a=a1.get(this),o=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||mt(i.target,"wtBorder")||a.cellBelowCursor===i.target||!this.editor))if(a.cellBelowCursor=o.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var s=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(s)}else gu(i.target,o)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,a){a[Ao]&&a[Ao][Zh]&&ke(i,a.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var a=a1.get(this);a.tempEditorDimensions={width:fr(i.target),height:$r(i.target)}}},{key:"onEditorMouseUp",value:function(i){var a=a1.get(this),o=fr(i.target),s=$r(i.target);(o!==a.tempEditorDimensions.width+1||s!==a.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,ZA({},w7,{width:o,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){o>=0&&s>=0&&i.removeCommentAtCell(o,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){if(o>=0&&s>=0){var l=!!i.getCommentMeta(o,s,o1);i.updateCommentMeta(o,s,ZA({},o1,!l))}})}},{key:"addToContextMenu",value:function(i){var a=this,o=function(){return a.hot.rowIndexMapper.getRenderableIndexesLength()>0&&a.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return a.checkSelectionCommentsConsistency()?a.hot.getTranslatedPhrase(aB):a.hot.getTranslatedPhrase(iB)},callback:function(){return a.onContextMenuAddComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(oB)},callback:function(){return a.onContextMenuRemoveComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(sB),f=Ho(this.getSelectedRangeLast(),function(c,h){var d=l.getCellMeta(c,h)[Ao];if(d&&(d=d[o1]),d)return!0});return f&&(u=Cs(u)),u},callback:function(){return a.onContextMenuMakeReadOnly()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner())||!a.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[JA];if(kt(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Jf(Ls(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return JA}},{key:"PLUGIN_PRIORITY",get:function(){return Nst}}]),r}(tr);function Mb(e){return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(e)}function Fst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bst(n.key),n)}}function Hst(e,t,r){return t&&_7(e.prototype,t),r&&_7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bst(e){var t=Vst(e,"string");return Mb(t)==="symbol"?t:String(t)}function Vst(e,t){if(Mb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jst=function(){function e(t){Fst(this,e),this.hot=t,this.commands={},this.commonCallback=null}return Hst(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,f=this.commands[l];if(!f)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&f.submenu&&(f=Wst(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!Br(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),a.unshift(s.join(":")),ne(c,function(h){return h.apply(n.hot,a)})}}}]),e}();function Wst(e,t){var r;return ne(t,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===e)return r=n,!1}),r}const Vse=jst;var ba="alignment";function Ust(){return{key:ba,name:function(){return this.getTranslatedPhrase(lB)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(ba,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(uB),n=Ho(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htLeft")!==-1)return!0});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Rf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htLeft";this.runHooks("beforeCellAlignment",n,r,i,a),Kl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(fB),n=Ho(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htCenter")!==-1)return!0});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Rf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htCenter";this.runHooks("beforeCellAlignment",n,r,i,a),Kl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(cB),n=Ho(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htRight")!==-1)return!0});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Rf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htRight";this.runHooks("beforeCellAlignment",n,r,i,a),Kl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(hB),n=Ho(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htJustify")!==-1)return!0});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Rf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htJustify";this.runHooks("beforeCellAlignment",n,r,i,a),Kl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{name:Dt},{key:"".concat(ba,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(dB),n=Ho(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htTop")!==-1)return!0});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Rf(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htTop";this.runHooks("beforeCellAlignment",n,r,i,a),Kl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(vB),n=Ho(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htMiddle")!==-1)return!0});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Rf(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,a),Kl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(pB),n=Ho(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htBottom")!==-1)return!0});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Rf(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htBottom";this.runHooks("beforeCellAlignment",n,r,i,a),Kl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1}]}}}var RE="clear_column";function zst(){return{key:RE,name:function(){return this.getTranslatedPhrase(KH)},callback:function(t,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=dh(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var w_="col_left";function Gst(){return{key:w_,name:function(){return this.getTranslatedPhrase(VH)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dh(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var __="col_right";function Yst(){return{key:__,name:function(){return this.getTranslatedPhrase(jH)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dh(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var S_="make_read_only";function Kst(){return{key:S_,name:function(){var t=this,r=this.getTranslatedPhrase(YH),n=Ho(this.getSelectedRange(),function(i,a){return t.getCellMeta(i,a).readOnly});return n&&(r=Cs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Ho(r,function(i,a){return t.getCellMeta(i,a).readOnly});ne(r,function(i){i.forAll(function(a,o){a>=0&&o>=0&&t.setCellMeta(a,o,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var kE="redo";function Xst(){return{key:kE,name:function(){return this.getTranslatedPhrase(GH)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function qst(e,t){return elt(e)||Qst(e,t)||Jst(e,t)||Zst()}function Zst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jst(e,t){if(e){if(typeof e=="string")return S7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S7(e,t)}}function S7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qst(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function elt(e){if(Array.isArray(e))return e}var C_="remove_col";function tlt(){return{key:C_,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=qst(t[0],4),i=n[1],a=n[3];i-a!==0&&(r=1)}return this.getTranslatedPhrase(UH,r)},callback:function(){this.alter("remove_col",fZe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=dh(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function rlt(e,t){return olt(e)||alt(e,t)||ilt(e,t)||nlt()}function nlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ilt(e,t){if(e){if(typeof e=="string")return C7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C7(e,t)}}function C7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function alt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function olt(e){if(Array.isArray(e))return e}var AE="remove_row";function slt(){return{key:AE,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=rlt(t[0],3),i=n[0],a=n[2];i-a!==0&&(r=1)}return this.getTranslatedPhrase(WH,r)},callback:function(){this.alter("remove_row",cZe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=dh(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var PE="row_above";function llt(){return{key:PE,name:function(){return this.getTranslatedPhrase(HH)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=dh(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var IE="row_below";function ult(){return{key:IE,name:function(){return this.getTranslatedPhrase(BH)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=dh(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Db="no_items";function flt(){return{key:Db,name:function(){return this.getTranslatedPhrase(FH)},disabled:!0,isCommand:!1}}var ME="undo";function clt(){return{key:ME,name:function(){return this.getTranslatedPhrase(zH)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function $b(e){return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}var ri;function Vi(e,t,r){return t=hlt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hlt(e){var t=dlt(e,"string");return $b(t)==="symbol"?t:String(t)}function dlt(e,t){if($b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vlt=[PE,IE,w_,__,RE,AE,C_,ME,kE,S_,ba,Dt,Db],plt=(ri={},Vi(ri,Dt,cst),Vi(ri,Db,flt),Vi(ri,PE,llt),Vi(ri,IE,ult),Vi(ri,w_,Gst),Vi(ri,__,Yst),Vi(ri,RE,zst),Vi(ri,AE,slt),Vi(ri,C_,tlt),Vi(ri,ME,clt),Vi(ri,kE,Xst),Vi(ri,S_,Kst),Vi(ri,ba,Ust),ri);function jse(){var e={};return At(plt,function(t,r){e[r]=t()}),e}function Nb(e){return Nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nb(e)}function glt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mlt(n.key),n)}}function ylt(e,t,r){return t&&x7(e.prototype,t),r&&x7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mlt(e){var t=blt(e,"string");return Nb(t)==="symbol"?t:String(t)}function blt(e,t){if(Nb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wlt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;glt(this,e),this.hot=t,this.predefinedItems=jse(),this.defaultOrderPattern=r}return ylt(e,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,At(r,function(a,o){var s="";a.name===Dt?(i[Dt]=a,s=Dt):isNaN(parseInt(o,10))?(a.key=a.key===void 0?o:a.key,i[o]=a,s=a.key):(i[a.key]=a,s=a.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return _lt(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function _lt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=e;return i&&i.items?i=i.items:Array.isArray(i)||(i=t),kt(i)?At(i,function(a,o){var s=r[typeof a=="string"?a:o];s||(s=a),kt(a)?nn(s,a):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=o),n.push(s)}):ne(i,function(a,o){var s=r[a];!s&&vlt.indexOf(a)>=0||(s||(s={name:a,key:"".concat(o)}),kt(a)&&nn(s,a),s.key===void 0&&(s.key=o),n.push(s))}),n}const Wse=wlt;function Lb(e){return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function Slt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xlt(n.key),n)}}function Clt(e,t,r){return t&&T7(e.prototype,t),r&&T7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xlt(e){var t=Tlt(e,"string");return Lb(t)==="symbol"?t:String(t)}function Tlt(e,t){if(Lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Olt=function(){function e(t,r){Slt(this,e);var n=dv(r),i=Nc(r),a,o,s,l,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(a=parseInt(t.top,10),s=parseInt(t.left,10),u=t.height||0,f=t.width||0,o=a,l=s,a+=n,s+=i):this.type==="event"&&(a=parseInt(t.pageY,10),s=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,o=a-n,l=s-i),this.top=a,this.topRelative=o,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=f}return Clt(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const Elt=Olt;function Fb(e){return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fb(e)}function O7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function E7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O7(Object(r),!0).forEach(function(n){Rlt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rlt(e,t,r){return t=Use(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function klt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Use(n.key),n)}}function Alt(e,t,r){return t&&R7(e.prototype,t),r&&R7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Use(e){var t=Plt(e,"string");return Fb(t)==="symbol"?t:String(t)}function Plt(e,t){if(Fb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k7=215,zse="menu",Ilt=zse,Gse=function(){function e(t,r){klt(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:k7,container:this.hot.rootDocument.documentElement},this.eventManager=new Nr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return Alt(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=m0(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=fH(function(d){return r.openSubMenu(d)},300),i=this.options.minWidth||k7,a=!1,o=ra(this.menuItems,function(d){return d.key===Db&&(a=!0),yst(d,r.hot)});if(o.length<1&&!a)o.push(jse()[Db]);else if(o.length===0)return;o=wst(o,Dt);var s=!1,l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return Xe(v)&&v<i?i:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,p,g,y,m,b){return r.menuItemRenderer(v,p,g,y,m,b)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,p){r.isAllSubMenusClosed()?n(p.row):r.openSubMenu(p.row)},rowHeights:function(v){return o[v].name===Dt?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),VM()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!VM()||!Fu(v))&&s&&r.hasSelectedItem()&&(oo()||LF()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new l3(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(Ilt),c={group:zse},h=E7(E7({},c),{},{runOnlyIf:function(v){return _0(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var p=r.openSubMenu(v[0]);p&&p.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(p[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!dst(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),a=new e(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return a.setMenuItems(i.submenu.items),a.open(),a.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=a,a}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;ne(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),a=i?hst(i):[];this.runLocalHooks("executeCommand",n.key,a,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,a,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,a=r.disabled,o=r.submenu,s=a===!0||typeof a=="function"&&a.call(this.hot)===!0;return n===!1||i===Dt||s===!0||o}},{key:"setPosition",value:function(r){var n=new Elt(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.right;n+=r.cellWidth+a-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.left;n-=r.left-a}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);r1(r)||n1(r)||i1(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);r1(n)||n1(n)||i1(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,a=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;a&&(r1(a)||n1(a)||i1(a)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,a=i>=0?this.hotMenu.getCell(i,n):null;a&&(r1(a)||n1(a)||i1(a)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,a,o,s){var l=this,u=r.getSourceDataAtRow(i),f=this.hot.rootDocument.createElement("div"),c=function(y){return Br(y,"submenu")},h=function(y){return new RegExp(Dt,"i").test(y.name)},d=function(y){return y.disabled===!0||typeof y.disabled=="function"&&y.disabled.call(l.hot)===!0},v=function(y){return y.disableSelection},p=s;typeof p=="function"&&(p=p.call(this.hot)),po(n),ke(f,"htItemWrapper"),n.appendChild(f),h(u)?ke(n,"htSeparator"):typeof u.renderer=="function"?(ke(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,i,a,o,p))):fh(f,p),d(u)?(ke(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(ke(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(ke(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)})):(wt(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,a;return i&&(wr(i)&&(i=i.call(this.hot),i===null||pr(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),a=n.querySelector(".".concat(this.options.className,".").concat(i))),a||(a=n.createElement("div"),ke(a,"htMenu ".concat(this.options.className)),i&&ke(a,i),this.options.container.appendChild(a)),a}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,a=r.holder.style,o=parseInt(i.width,10),s=Xr(n,function(l,u){return l+(u.name===Dt?1:26)},0);a.width="".concat(o+3,"px"),a.height="".concat(s+3,"px"),i.height=a.height}},{key:"onAfterSelection",value:function(r,n,i,a,o){this.keyEvent===!1&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!gu(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!gu(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&mt(r.target,"htCore")&&gu(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();mr(Gse,Bi);const T3=Gse;function wp(e){return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function Mlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$lt(n.key),n)}}function Dlt(e,t,r){return t&&A7(e.prototype,t),r&&A7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $lt(e){var t=Nlt(e,"string");return wp(t)==="symbol"?t:String(t)}function Nlt(e,t){if(wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qf(){return typeof Reflect<"u"&&Reflect.get?Qf=Reflect.get.bind():Qf=function(t,r,n){var i=Llt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Qf.apply(this,arguments)}function Llt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fs(e),e!==null););return e}function Flt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YD(e,t)}function YD(e,t){return YD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YD(e,t)}function Hlt(e){var t=Vlt();return function(){var n=Fs(e),i;if(t){var a=Fs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Blt(this,i)}}function Blt(e,t){if(t&&(wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yse(e)}function Yse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vlt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fs(e){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fs(e)}var s1="contextMenu",jlt=70;Je.getSingleton().register("afterContextMenuDefaultOptions");Je.getSingleton().register("beforeContextMenuShow");Je.getSingleton().register("afterContextMenuShow");Je.getSingleton().register("afterContextMenuHide");Je.getSingleton().register("afterContextMenuExecute");var Kse=function(e){Flt(r,e);var t=Hlt(r);function r(n){var i;return Mlt(this,r),i=t.call(this,n),i.eventManager=new Nr(Yse(i)),i.commandExecutor=new Vse(i.hot),i.itemsFactory=null,i.menu=null,i}return Dlt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[s1]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[s1];typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),this.menu=new T3(this.hot,{className:"htContextMenu",keepInViewport:!0,container:a.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var o,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(o=i.executeCommand).call.apply(o,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(o){return i.onAfterOnCellContextMenu(o)}),Qf(Fs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qf(Fs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Qf(Fs(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u-dv(i.view),o=f-Nc(i.view)}else a=-1*dv(this.menu.hotMenu.rootWindow),o=-1*Nc(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+a,left:parseInt(i.pageX,10)+o})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var a;this.itemsFactory===null&&this.prepareMenuItems();for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new Wse(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[s1],o={items:this.itemsFactory.getItems(a)};this.hot.runHooks("afterContextMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);var s=this.itemsFactory.getItems(a);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),ne(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var a=this.hot.getSettings(),o=a.rowHeaders,s=a.colHeaders;function l(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=i.target;this.close(),!mt(u,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(o||s)&&!l(u)&&!(mt(u,"current")&&mt(u,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Qf(Fs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return s1}},{key:"PLUGIN_PRIORITY",get:function(){return jlt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[PE,IE,Dt,w_,__,Dt,AE,C_,Dt,ME,kE,Dt,S_,Dt,ba]}}]),r}(tr);Kse.SEPARATOR={name:Dt};function Wlt(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(XH)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Ult(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(JH,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function zlt(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(ZH,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Glt(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(qH,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Ylt(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(QH)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Hb(e){return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(e)}function Klt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qlt(n.key),n)}}function Xlt(e,t,r){return t&&P7(e.prototype,t),r&&P7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qlt(e){var t=Zlt(e,"string");return Hb(t)==="symbol"?t:String(t)}function Zlt(e,t){if(Hb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jlt=function(){function e(){Klt(this,e),this.data={}}return Xlt(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function Bb(e){return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(e)}function I7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eut(n.key),n)}}function Qlt(e,t,r){return t&&I7(e.prototype,t),r&&I7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eut(e){var t=tut(e,"string");return Bb(t)==="symbol"?t:String(t)}function tut(e,t){if(Bb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var nut=Qlt(function e(){rut(this,e),this.clipboardData=new Jlt});function Vb(e){return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(e)}function iut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,out(n.key),n)}}function aut(e,t,r){return t&&M7(e.prototype,t),r&&M7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function out(e){var t=sut(e,"string");return Vb(t)==="symbol"?t:String(t)}function sut(e,t){if(Vb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O3=function(){function e(t){iut(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Nr(this),this.listenersCount=new WeakSet,this.container=t}return aut(e,[{key:"useSecondaryElement",value:function(){var r=fut(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),D7(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),D7(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",oo()||Uie(this.mainElement)}}]),e}();mr(O3,Bi);var ST=new WeakMap;function lut(e){var t=new O3(e),r=ST.get(e);return r=isNaN(r)?0:r,ST.set(e,r+1),t}function uut(e){e.eventManager.clear()}var QA=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function D7(e,t,r){e.addEventListener(t,"copy",QA("copy",r)),e.addEventListener(t,"cut",QA("cut",r)),e.addEventListener(t,"paste",QA("paste",r))}var CT=new WeakMap;function fut(e){var t=CT.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return CT.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function $7(e){if(e instanceof O3){var t=ST.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),uut(e),t<=0){t=0;var r=CT.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),CT.delete(e.container)),e.mainElement=null}ST.set(e.container,t)}}function jb(e){return jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jb(e)}function cut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dut(n.key),n)}}function hut(e,t,r){return t&&N7(e.prototype,t),r&&N7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dut(e){var t=vut(e,"string");return jb(t)==="symbol"?t:String(t)}function vut(e,t){if(jb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L7(e,t){Xse(e,t),t.add(e)}function Jh(e,t,r){Xse(e,t),t.set(e,r)}function Xse(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l1(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function oi(e,t){var r=qse(e,t,"get");return put(e,r)}function put(e,t){return t.get?t.get.call(e):t.value}function Qh(e,t,r){var n=qse(e,t,"set");return gut(e,n,r),r}function qse(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function gut(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Bl=new WeakMap,eP=new WeakMap,Ay=new WeakMap,KD=new WeakMap,XD=new WeakMap,Py=new WeakMap,u1=new WeakSet,F7=new WeakSet,yut=function(){function e(t){var r=t.countRows,n=t.countColumns,i=t.rowsLimit,a=t.columnsLimit,o=t.countColumnHeaders;cut(this,e),L7(this,F7),L7(this,u1),Jh(this,Bl,{writable:!0,value:void 0}),Jh(this,eP,{writable:!0,value:void 0}),Jh(this,Ay,{writable:!0,value:void 0}),Jh(this,KD,{writable:!0,value:void 0}),Jh(this,XD,{writable:!0,value:void 0}),Jh(this,Py,{writable:!0,value:void 0}),Qh(this,eP,r),Qh(this,Ay,n),Qh(this,KD,i),Qh(this,XD,a),Qh(this,Py,o)}return hut(e,[{key:"setSelectedRange",value:function(r){Qh(this,Bl,r)}},{key:"getCellsRange",value:function(){if(oi(this,eP).call(this)===0||oi(this,Ay).call(this)===0)return null;var r=oi(this,Bl).getTopStartCorner(),n=r.row,i=r.col,a=oi(this,Bl).getBottomEndCorner(),o=a.row,s=a.col,l=l1(this,F7,mut).call(this,n,o),u=l1(this,u1,tP).call(this,i,s),f=o!==l||s!==u;return{isRangeTrimmed:f,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(oi(this,Ay).call(this)===0||oi(this,Py).call(this)===0)return null;var r=oi(this,Bl).getTopStartCorner(),n=r.col,i=oi(this,Bl).getBottomEndCorner(),a=i.col,o=l1(this,u1,tP).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:o}}},{key:"getAllColumnHeadersRange",value:function(){if(oi(this,Ay).call(this)===0||oi(this,Py).call(this)===0)return null;var r=oi(this,Bl).getTopStartCorner(),n=r.col,i=oi(this,Bl).getBottomEndCorner(),a=i.col,o=l1(this,u1,tP).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-oi(this,Py).call(this),startCol:n,endRow:-1,endCol:o}}}]),e}();function tP(e,t){return Math.min(t,Math.max(e+oi(this,XD).call(this)-1,e))}function mut(e,t){return Math.min(t,Math.max(e+oi(this,KD).call(this)-1,e))}function Zse(e){var t=[],r=[];return ne(e,function(n){var i=Math.min(n.startRow,n.endRow),a=Math.max(n.startRow,n.endRow);rt(i,a,function(l){t.indexOf(l)===-1&&t.push(l)});var o=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);rt(o,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:t,columns:r}}function but(e,t){return Cut(e)||Sut(e,t)||_ut(e,t)||wut()}function wut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ut(e,t){if(e){if(typeof e=="string")return H7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H7(e,t)}}function H7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sut(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Cut(e){if(Array.isArray(e))return e}function Gc(e){return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(e)}function xut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qse(n.key),n)}}function Tut(e,t,r){return t&&B7(e.prototype,t),r&&B7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ec(){return typeof Reflect<"u"&&Reflect.get?ec=Reflect.get.bind():ec=function(t,r,n){var i=Out(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ec.apply(this,arguments)}function Out(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hs(e),e!==null););return e}function Eut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qD(e,t)}function qD(e,t){return qD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qD(e,t)}function Rut(e){var t=Aut();return function(){var n=Hs(e),i;if(t){var a=Hs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return kut(this,i)}}function kut(e,t){if(t&&(Gc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ai(e)}function ai(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hs(e){return Hs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hs(e)}function Put(e,t){Jse(e,t),t.add(e)}function kf(e,t,r){Jse(e,t),t.set(e,r)}function Jse(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ed(e,t,r){return t=Qse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qse(e){var t=Iut(e,"string");return Gc(t)==="symbol"?t:String(t)}function Iut(e,t){if(Gc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mut(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function ji(e,t){var r=ele(e,t,"get");return Dut(e,r)}function Dut(e,t){return t.get?t.get.call(e):t.value}function ps(e,t,r){var n=ele(e,t,"set");return $ut(e,n,r),r}function ele(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $ut(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Je.getSingleton().register("afterCopyLimit");Je.getSingleton().register("modifyCopyableRange");Je.getSingleton().register("beforeCut");Je.getSingleton().register("afterCut");Je.getSingleton().register("beforePaste");Je.getSingleton().register("afterPaste");Je.getSingleton().register("beforeCopy");Je.getSingleton().register("afterCopy");var f1="copyPaste",Nut=80,Lut=["fragmentSelection"],V7=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),rP=new WeakMap,nP=new WeakMap,iP=new WeakMap,td=new WeakMap,c1=new WeakMap,h1=new WeakMap,rd=new WeakMap,j7=new WeakSet,Fut=function(e){Eut(r,e);var t=Rut(r);function r(){var n;xut(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Put(ai(n),j7),ed(ai(n),"columnsLimit",1/0),ed(ai(n),"rowsLimit",1/0),ed(ai(n),"pasteMode","overwrite"),ed(ai(n),"uiContainer",n.hot.rootDocument.body),kf(ai(n),rP,{writable:!0,value:!1}),kf(ai(n),nP,{writable:!0,value:!1}),kf(ai(n),iP,{writable:!0,value:!1}),kf(ai(n),td,{writable:!0,value:"cells-only"}),kf(ai(n),c1,{writable:!0,value:!1}),kf(ai(n),h1,{writable:!0,value:!1}),kf(ai(n),rd,{writable:!0,value:new yut({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),ed(ai(n),"copyableRanges",[]),ed(ai(n),"focusableElement",void 0),n}return Tut(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[f1]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a[f1];if(Gc(o)==="object"){var s,l;this.pasteMode=(s=o.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(o.rowsLimit)?this.rowsLimit:o.rowsLimit,this.columnsLimit=isNaN(o.columnsLimit)?this.columnsLimit:o.columnsLimit,ps(this,rP,!!o.copyColumnHeaders),ps(this,nP,!!o.copyColumnGroupHeaders),ps(this,iP,!!o.copyColumnHeadersOnly),this.uiContainer=(l=o.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=lut(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),ec(Hs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ec(Hs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&$7(this.focusableElement),ec(Hs(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ps(this,td,i),ps(this,c1,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){ps(this,h1,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return Pm(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var a=this,o=[],s=Zse(i),l=s.rows,u=s.columns;return ne(l,function(f){var c=[];ne(u,function(h){f<0?c.push(a.hot.getColHeader(h,f)):c.push(a.hot.getCopyableData(f,h))}),o.push(c)}),o}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!a)){var o=new nut;i&&o.clipboardData.setData("text/plain",i),a&&o.clipboardData.setData("text/html",a),this.getOrCreateFocusableElement(),this.onPaste(o)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){ji(this,rd).setSelectedRange(i);var a=new Map([["headers",null],["cells",null]]);ji(this,td)==="column-headers-only"?a.set("headers",ji(this,rd).getMostBottomColumnHeadersRange()):(ji(this,td)==="with-column-headers"?a.set("headers",ji(this,rd).getMostBottomColumnHeadersRange()):ji(this,td)==="with-column-group-headers"&&a.set("headers",ji(this,rd).getAllColumnHeadersRange()),a.set("cells",ji(this,rd).getCellsRange())),this.copyableRanges=Array.from(a.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,p=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:p}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var o=a.get("cells");if(o!==null&&o.isRangeTrimmed){var s=o.startRow,l=o.startCol,u=o.endRow,f=o.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,f-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,a=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;a?this.focusableElement.setFocusableElement(a):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var o=i.length,s=i[0].length,l=[],u=a.getTopStartCorner(),f=u.row,c=u.col,h=a.getBottomEndCorner(),d=h.row,v=h.col,p=f,g=c,y=f,m=c;l.length<o||p<=d;){var b=this.hot.getCellMeta(p,c),_=b.skipRowOnPaste,x=b.visualRow;if(p=x+1,_!==!0){y=x,g=c;for(var T=[],E=l.length%o;T.length<s||g<=v;){var P=this.hot.getCellMeta(f,g),R=P.skipColumnOnPaste,M=P.visualCol;if(g=M+1,R!==!0){m=M;var D=T.length%s;T.push(i[E][D])}}l.push(T)}}return this.hot.populateFromArray(f,c,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,y,m]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!ji(this,c1)||this.isEditorOpened())){this.setCopyableText(),ps(this,c1,!1);var a=this.getRangedData(this.copyableRanges),o=Mut(this,j7,Hut).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges,o);if(s){var l=Pm(a);if(i&&i.clipboardData){var u=d2(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[V7,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",a,this.copyableRanges,o)}ps(this,td,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!ji(this,h1)||this.isEditorOpened())){this.setCopyableText(),ps(this,h1,!1);var a=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(o){var s=Pm(a);if(i&&i.clipboardData){var l=d2(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[V7,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var a;if(i&&typeof i.clipboardData<"u"){var o=uE(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){var s=dae(o,this.hot.rootDocument);a=s.data}else a=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(a=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof a=="string"&&(a=IZe(a)),!(a&&a.length===0)&&this.hot.runHooks("beforePaste",a,this.copyableRanges)!==!1){var l=this.populateValues(a),u=but(l,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",a,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},Wlt(this)),ji(this,rP)&&i.items.push(Glt(this)),ji(this,nP)&&i.items.push(zlt(this)),ji(this,iP)&&i.items.push(Ult(this)),i.items.push(Ylt(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Vie())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,a=this.hot.getActiveEditor();!a||i!==this.focusableElement.getFocusableElement()&&i!==a.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&($7(this.focusableElement),this.focusableElement=null),ec(Hs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return f1}},{key:"SETTING_KEYS",get:function(){return[f1].concat(Lut)}},{key:"PLUGIN_PRIORITY",get:function(){return Nut}}]),r}(tr);function Hut(e){for(var t=Zse(e),r=t.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function tle(e,t){return"border_row".concat(e,"col").concat(t)}function em(){return{width:1,color:"#000"}}function Bs(){return{hide:!0}}function But(){return{width:1,color:"#000",cornerVisible:!1}}function aP(e){if(Xe(e.start)||Xe(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(Xe(e.end)||Xe(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function Iy(e){return Xe(e.start)&&(e.left=e.start),Xe(e.end)&&(e.right=e.end),e}function oP(e,t){return{id:tle(e,t),border:But(),row:e,col:t,top:Bs(),bottom:Bs(),start:Bs(),end:Bs()}}function Vut(e,t){return Br(t,"border")&&t.border&&(e.border=t.border),Br(t,"top")&&Xe(t.top)&&(t.top?(kt(t.top)||(t.top=em()),e.top=t.top):(t.top=Bs(),e.top=t.top)),Br(t,"bottom")&&Xe(t.bottom)&&(t.bottom?(kt(t.bottom)||(t.bottom=em()),e.bottom=t.bottom):(t.bottom=Bs(),e.bottom=t.bottom)),Br(t,"start")&&Xe(t.start)&&(t.start?(kt(t.start)||(t.start=em()),e.start=t.start):(t.start=Bs(),e.start=t.start)),Br(t,"end")&&Xe(t.end)&&(t.end?(kt(t.end)||(t.end=em()),e.end=t.end):(t.end=Bs(),e.end=t.end)),e}function gl(e,t){var r=!1;return ne(e.getSelectedRange(),function(n){n.forAll(function(i,a){if(!(i<0||a<0)){var o=e.getCellMeta(i,a).borders;if(o)if(t){if(!Br(o[t],"hide")||o[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function DE(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function jut(e){return e.some(function(t){return Xe(t.left)||Xe(t.right)})}function Wut(e){return e.some(function(t){return Xe(t.start)||Xe(t.end)})}var Uut=new Map([["left","start"],["right","end"]]);function zut(e){var t;return(t=Uut.get(e))!==null&&t!==void 0?t:e}function Gut(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(bB),n=gl(this,"bottom");return n&&(r=DE(r)),r},callback:function(r,n){var i=gl(this,"bottom");e.prepareBorder(n,"bottom",i)}}}function Yut(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(wB),i=gl(this,t);return i&&(n=DE(n)),n},callback:function(n,i){var a=gl(this,t);e.prepareBorder(i,t,a)}}}function Kut(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(_B)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!gl(this)}}}function Xut(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(mB),i=gl(this,t);return i&&(n=DE(n)),n},callback:function(n,i){var a=gl(this,t);e.prepareBorder(i,t,a)}}}function qut(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(yB),n=gl(this,"top");return n&&(r=DE(r)),r},callback:function(r,n){var i=gl(this,"top");e.prepareBorder(n,"top",i)}}}function _p(e){return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function W7(e,t){return eft(e)||Qut(e,t)||Jut(e,t)||Zut()}function Zut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jut(e,t){if(e){if(typeof e=="string")return U7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U7(e,t)}}function U7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qut(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function eft(e){if(Array.isArray(e))return e}function tft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nle(n.key),n)}}function rft(e,t,r){return t&&z7(e.prototype,t),r&&z7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tc(){return typeof Reflect<"u"&&Reflect.get?tc=Reflect.get.bind():tc=function(t,r,n){var i=nft(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},tc.apply(this,arguments)}function nft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vs(e),e!==null););return e}function ift(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZD(e,t)}function ZD(e,t){return ZD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ZD(e,t)}function aft(e){var t=sft();return function(){var n=Vs(e),i;if(t){var a=Vs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return oft(this,i)}}function oft(e,t){if(t&&(_p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rle(e)}function rle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vs(e){return Vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vs(e)}function lft(e,t,r){return t=nle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nle(e){var t=uft(e,"string");return _p(t)==="symbol"?t:String(t)}function uft(e,t){if(_p(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_p(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d1="customBorders",fft=90,cft=function(e){ift(r,e);var t=aft(r);function r(){var n;tft(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),lft(rle(n),"savedBorders",[]),n}return rft(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[d1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.onAfterContextMenuDefaultOptions(a)}),this.addHook("init",function(){return i.onAfterInit()}),tc(Vs(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),tc(Vs(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),tc(Vs(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,a){var o=this,s=["top","bottom","start","end"],l=null;a&&(this.checkSettingsCohesion([a]),s=Object.keys(a),l=aP(a));var u=zv(i),f=gb(u);ne(i,function(c){for(var h=f(c),d=W7(h,4),v=d[0],p=d[1],g=d[2],y=d[3],m=function(x){for(var T=function(R){ne(s,function(M){o.prepareBorderFromCustomAdded(x,R,l,zut(M))})},E=p;E<=y;E+=1)T(E)},b=v;b<=g;b+=1)m(b)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var a=this;if(!Array.isArray(i))return this.savedBorders;var o=zv(i),s=gb(o),l=[];return ne(i,function(u){for(var f=s(u),c=W7(f,4),h=c[0],d=c[1],v=c[2],p=c[3],g=function(b){for(var _=function(E){ne(a.savedBorders,function(P){P.row===b&&P.col===E&&l.push(Iy(P))})},x=d;x<=p;x+=1)_(x)},y=h;y<=v;y+=1)g(y)}),l}},{key:"clearBorders",value:function(i){var a=this;i?this.setBorders(i):(ne(this.savedBorders,function(o){a.clearBordersFromSelectionSettings(o.id),a.clearNullCellRange(),a.hot.removeCellMeta(o.row,o.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,a){var o=this.checkSavedBorders(i);o||this.savedBorders.push(i);var s=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),l=this.checkCustomSelections(i,s,a);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,a,o,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(i>=l||a>=u)){var f=oP(i,a);o&&(f=Vut(f,o),ne(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,o),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(i,a,"borders",Iy(f)),this.insertBorderIntoSettings(f,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,a){var o=this,s=Math.min(i.to.row,this.hot.countRows()-1),l=Math.min(i.to.col,this.hot.countCols()-1);rt(i.from.row,s,function(u){rt(i.from.col,l,function(f){var c=oP(u,f),h=0;u===i.from.row&&Br(a,"top")&&(h+=1,c.top=a.top),u===i.to.row&&Br(a,"bottom")&&(h+=1,c.bottom=a.bottom),f===i.from.col&&Br(a,"start")&&(h+=1,c.start=a.start),f===i.to.col&&Br(a,"end")&&(h+=1,c.end=a.end),h>0&&(o.hot.setCellMeta(u,f,"borders",Iy(c)),o.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(i,a){var o=tle(i,a);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(i,a,"borders")}},{key:"setBorder",value:function(i,a,o,s){var l=this.hot.getCellMeta(i,a).borders;if(!l||l.border===void 0?l=oP(i,a):l=aP(l),s){l[o]=Bs();var u=this.countHide(l);if(u===4)this.removeAllBorders(i,a);else{var f=this.checkCustomSelectionsFromContextMenu(l,o,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",Iy(l))}}else{l[o]=em();var c=this.checkCustomSelectionsFromContextMenu(l,o,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",Iy(l))}}},{key:"prepareBorder",value:function(i,a,o){var s=this;ne(i,function(l){var u=l.start,f=l.end;if(u.row===f.row&&u.col===f.col)a==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,a,o);else switch(a){case"noBorders":rt(u.col,f.col,function(c){rt(u.row,f.row,function(h){s.removeAllBorders(h,c)})});break;case"top":rt(u.col,f.col,function(c){s.setBorder(u.row,c,a,o)});break;case"bottom":rt(u.col,f.col,function(c){s.setBorder(f.row,c,a,o)});break;case"start":rt(u.row,f.row,function(c){s.setBorder(c,u.col,a,o)});break;case"end":rt(u.row,f.row,function(c){s.setBorder(c,f.col,a,o)});break}})}},{key:"createCustomBorders",value:function(i){var a=this;ne(i,function(o){var s=aP(o);o.range?a.prepareBorderFromCustomAddedRange(o.range,s):a.prepareBorderFromCustomAdded(o.row,o.col,s)})}},{key:"countHide",value:function(i){var a=i.top,o=i.bottom,s=i.start,l=i.end,u=[a,o,s,l];return Xr(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var a=Rt(this.hot.selection.highlight.customSelections,function(o){return o.settings.id}).indexOf(i);a>-1&&this.hot.selection.highlight.customSelections[a].clear()}},{key:"clearNullCellRange",value:function(){var i=this;ne(this.hot.selection.highlight.customSelections,function(a,o){if(a.cellRange===null)return i.hot.selection.highlight.customSelections[o].destroy(),i.hot.selection.highlight.customSelections.splice(o,1),!1})}},{key:"hideBorders",value:function(){var i=this;ne(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var a=Rt(this.savedBorders,function(o){return o.id}).indexOf(i);a>-1&&this.savedBorders.splice(a,1)}},{key:"checkSavedBorders",value:function(i){var a=this,o=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),o=!0):ne(this.savedBorders,function(l,u){if(i.id===l.id)return a.savedBorders[u]=i,o=!0,!1}),o}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,a,o){var s=!1;return ne(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return At(l.instanceBorders,function(u){u.toggleHiddenClass(a,o)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,a,o){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):ne(this.hot.selection.highlight.customSelections,function(u){if(i.id===u.settings.id)return u.visualCellRange=a,u.commit(),o&&At(u.instanceBorders,function(f){f.changeBorderStyle(o,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[d1];if(Array.isArray(i)){var a=qn(i);this.checkSettingsCohesion(a),a.length||(this.savedBorders=a),this.createCustomBorders(a)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var a=jut(i),o=Wut(i);if(a&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&a)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){this.hot.getSettings()[d1]&&i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(gB)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[qut(this),Xut(this),Gut(this),Yut(this),Kut(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){tc(Vs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return d1}},{key:"PLUGIN_PRIORITY",get:function(){return fft}}]),r}(tr);function Sp(e){return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sp(e)}function hft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vft(n.key),n)}}function dft(e,t,r){return t&&G7(e.prototype,t),r&&G7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vft(e){var t=pft(e,"string");return Sp(t)==="symbol"?t:String(t)}function pft(e,t){if(Sp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rc(){return typeof Reflect<"u"&&Reflect.get?rc=Reflect.get.bind():rc=function(t,r,n){var i=gft(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},rc.apply(this,arguments)}function gft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=js(e),e!==null););return e}function yft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JD(e,t)}function JD(e,t){return JD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JD(e,t)}function mft(e){var t=wft();return function(){var n=js(e),i;if(t){var a=js(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return bft(this,i)}}function bft(e,t){if(t&&(Sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ile(e)}function ile(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function js(e){return js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},js(e)}var Y7="dragToScroll",_ft=100,Sft=function(e){yft(r,e);var t=mft(r);function r(n){var i;return hft(this,r),i=t.call(this,n),i.eventManager=new Nr(ile(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return dft(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Y7]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(a){return i.setupListening(a)}),this.addHook("afterOnCellCornerMouseDown",function(a){return i.setupListening(a)}),this.registerEvents(),rc(js(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),rc(js(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),rc(js(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,a){var o=0,s=0;a<this.boundaries.top?s=a-this.boundaries.top:a>this.boundaries.bottom&&(s=a-this.boundaries.bottom),i<this.boundaries.left?o=i-this.boundaries.left:i>this.boundaries.right&&(o=i-this.boundaries.right),this.callback(o,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,a=this.hot.rootWindow,o=a;o;)this.eventManager.addEventListener(o.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mousemove",function(s){return i.onMouseMove(s)}),o=m0(o)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!Fu(i)){var a=this.hot.view._wt.wtTable.holder;a!==this.hot.rootWindow&&(this.setBoundaries(a.getBoundingClientRect()),this.setCallback(function(o,s){o<0?a.scrollLeft-=50:o>0&&(a.scrollLeft+=50),s<0?a.scrollTop-=20:s>0&&(a.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){rc(js(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Y7}},{key:"PLUGIN_PRIORITY",get:function(){return _ft}}]),r}(tr);function Cp(e){return Cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cp(e)}function Cft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tft(n.key),n)}}function xft(e,t,r){return t&&K7(e.prototype,t),r&&K7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tft(e){var t=Oft(e,"string");return Cp(t)==="symbol"?t:String(t)}function Oft(e,t){if(Cp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nc(){return typeof Reflect<"u"&&Reflect.get?nc=Reflect.get.bind():nc=function(t,r,n){var i=Eft(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},nc.apply(this,arguments)}function Eft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ws(e),e!==null););return e}function Rft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QD(e,t)}function QD(e,t){return QD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QD(e,t)}function kft(e){var t=Pft();return function(){var n=Ws(e),i;if(t){var a=Ws(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Aft(this,i)}}function Aft(e,t){if(t&&(Cp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ale(e)}function ale(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ws(e){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ws(e)}Je.getSingleton().register("afterDropdownMenuDefaultOptions");Je.getSingleton().register("beforeDropdownMenuShow");Je.getSingleton().register("afterDropdownMenuShow");Je.getSingleton().register("afterDropdownMenuHide");Je.getSingleton().register("afterDropdownMenuExecute");var sP="dropdownMenu",Ift=230,lP="changeType",ole=function(e){Rft(r,e);var t=kft(r);function r(n){var i;return Cft(this,r),i=t.call(this,n),i.eventManager=new Nr(ale(i)),i.commandExecutor=new Vse(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return xft(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[sP]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new Wse(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[sP],o={items:this.itemsFactory.getItems(a)};this.registerEvents(),typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),nc(Ws(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",o),i.itemsFactory.setPredefinedItems(o.items);var s=i.itemsFactory.getItems(a);i.menu&&i.menu.destroy(),i.menu=new T3(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:a.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(l=i.executeCommand).call.apply(l,[i].concat(f))}),ne(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),nc(Ws(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),nc(Ws(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(a){return i.onTableClick(a)})}},{key:"open",value:function(i){this.menu&&(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),mt(i.target,lP)&&!this.menu.isOpened()){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u,o=f}var c=i.target.getBoundingClientRect();this.open({left:c.left+o,top:c.top+i.target.offsetHeight+3+a,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(i,a){var o=a.parentNode;if(o){var s=o.parentNode.childNodes,l=Array.prototype.indexOf.call(s,o);if(!(i<0||l!==s.length-1)){var u=a.querySelector(".".concat(lP));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=lP,f.type="button",f.onclick=function(){return!1},a.firstChild.insertBefore(f,a.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),nc(Ws(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sP}},{key:"PLUGIN_PRIORITY",get:function(){return Ift}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[w_,__,Dt,C_,Dt,RE,Dt,S_,Dt,ba]}}]),r}(tr);ole.SEPARATOR={name:Dt};function Wb(e){return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(e)}function Mft(e,t){return Lft(e)||Nft(e,t)||$ft(e,t)||Dft()}function Dft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ft(e,t){if(e){if(typeof e=="string")return X7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X7(e,t)}}function X7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nft(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Lft(e){if(Array.isArray(e))return e}function Fft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bft(n.key),n)}}function Hft(e,t,r){return t&&q7(e.prototype,t),r&&q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bft(e){var t=Vft(e,"string");return Wb(t)==="symbol"?t:String(t)}function Vft(e,t){if(Wb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jft=function(){function e(t){Fft(this,e),this.hot=t,this.options={}}return Hft(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,a=n.startCol,o=n.endRow,s=n.endCol,l=this.options,u=[];return rt(i,o,function(f){var c=[];!l.exportHiddenRows&&r._isHiddenRow(f)||(rt(a,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),a=i.startRow,o=i.endRow,s=this.hot.getRowHeader();rt(a,o,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),a=i.startCol,o=i.endCol,s=this.hot.getColHeader();rt(a,o,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=Mft(this.options.range,4),a=i[0],o=a===void 0?0:a,s=i[1],l=s===void 0?0:s,u=i[2],f=u===void 0?n:u,c=i[3],h=c===void 0?r:c;return o=Math.max(o,0),l=Math.max(l,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:o,startCol:l,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const Wft=jft;function Ub(e){return Ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ub(e)}function Uft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gft(n.key),n)}}function zft(e,t,r){return t&&Z7(e.prototype,t),r&&Z7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gft(e){var t=Yft(e,"string");return Ub(t)==="symbol"?t:String(t)}function Yft(e,t){if(Ub(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ub(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kft=function(){function e(t,r){Uft(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return zft(e,[{key:"_mergeOptions",value:function(r){var n=vi(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=nn(vi(e.DEFAULT_OPTIONS),n),n=nn(n,r),n.filename=oH(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const Xft=Kft;function xp(e){return xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xp(e)}function qft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jft(n.key),n)}}function Zft(e,t,r){return t&&J7(e.prototype,t),r&&J7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jft(e){var t=Qft(e,"string");return xp(t)==="symbol"?t:String(t)}function Qft(e,t){if(xp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ect(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e$(e,t)}function e$(e,t){return e$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},e$(e,t)}function tct(e){var t=ict();return function(){var n=xT(e),i;if(t){var a=xT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rct(this,i)}}function rct(e,t){if(t&&(xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nct(e)}function nct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ict(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xT(e){return xT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xT(e)}var act=String.fromCharCode(13),oct=String.fromCharCode(34),sct=String.fromCharCode(10),lct=function(e){ect(r,e);var t=tct(r);function r(){return qft(this,r),t.apply(this,arguments)}return Zft(r,[{key:"export",value:function(){var i=this,a=this.options,o=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=a.bom?String.fromCharCode(65279):"";return l&&(s=Rt(s,function(h){return i._escapeCell(h,!0)}),f&&(c+=a.columnDelimiter),c+=s.join(a.columnDelimiter),c+=a.rowDelimiter),ne(o,function(h,d){d>0&&(c+=a.rowDelimiter),f&&(c+=i._escapeCell(u[d])+a.columnDelimiter),c+=h.map(function(v){return i._escapeCell(v)}).join(a.columnDelimiter)}),c}},{key:"_escapeCell",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=Vr(i);return o!==""&&(a||o.indexOf(act)>=0||o.indexOf(oct)>=0||o.indexOf(sct)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o='"'.concat(o,'"')),o}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(Xft);const uct=lct;function zb(e){return zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zb(e)}function fct(e,t,r){return t=cct(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cct(e){var t=hct(e,"string");return zb(t)==="symbol"?t:String(t)}function hct(e,t){if(zb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dct="csv",t$=fct({},dct,uct);function vct(e,t,r){return typeof t$[e]=="function"?new t$[e](t,r):null}function Tp(e){return Tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tp(e)}function pct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yct(n.key),n)}}function gct(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yct(e){var t=mct(e,"string");return Tp(t)==="symbol"?t:String(t)}function mct(e,t){if(Tp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r$(e,t)}function r$(e,t){return r$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},r$(e,t)}function wct(e){var t=Cct();return function(){var n=TT(e),i;if(t){var a=TT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return _ct(this,i)}}function _ct(e,t){if(t&&(Tp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sct(e)}function Sct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function TT(e){return TT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TT(e)}var xct="exportFile",Tct=240,Oct=function(e){bct(r,e);var t=wct(r);function r(){return pct(this,r),t.apply(this,arguments)}return gct(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,a).export()}},{key:"exportAsBlob",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,a))}},{key:"downloadFile",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.hot,s=o.rootDocument,l=o.rootWindow,u=this._createTypeFormatter(i,a),f=this._createBlob(u),c=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t$[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return vct(i,new Wft(this.hot),a)}},{key:"_createBlob",value:function(i){var a=null;return typeof Blob<"u"&&(a=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),a}}],[{key:"PLUGIN_KEY",get:function(){return xct}},{key:"PLUGIN_PRIORITY",get:function(){return Tct}}]),r}(tr);function Gb(e){return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(e)}function Ect(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kct(n.key),n)}}function Rct(e,t,r){return t&&eY(e.prototype,t),r&&eY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kct(e){var t=Act(e,"string");return Gb(t)==="symbol"?t:String(t)}function Act(e,t){if(Gb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sle=function(){function e(t,r){var n=r.id,i=r.stateless,a=i===void 0?!0:i;Ect(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=a?null:this.hot.columnIndexMapper.registerMap(this.stateId,new yE)}return Rct(e,[{key:"reset",value:function(){ne(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),ne(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();mr(sle,Bi);const $E=sle;var Yb={};function Hu(e,t){if(!Yb[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Yb[e],n=r.condition,i=r.descriptor,a=t;return i.inputValuesDecorator&&(a=i.inputValuesDecorator(a)),function(o){return n.apply(o.meta.instance,[].concat([o],[a]))}}function ic(e){if(!Yb[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Yb[e].descriptor}function ln(e,t,r){r.key=e,Yb[e]={condition:t,descriptor:r}}var Tn="none";function Pct(){return!0}ln(Tn,Pct,{name:mE,inputsCount:0,showOperators:!1});var $m="empty";function Ict(e){return vn(e.value)}ln($m,Ict,{name:RB,inputsCount:0,showOperators:!0});var OC="not_empty";function Mct(e,t){return!Hu($m,t)(e)}ln(OC,Mct,{name:kB,inputsCount:0,showOperators:!0});function Dct(e,t){return Fct(e)||Lct(e,t)||Nct(e,t)||$ct()}function $ct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nct(e,t){if(e){if(typeof e=="string")return tY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tY(e,t)}}function tY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lct(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Fct(e){if(Array.isArray(e))return e}var Nm="eq";function Hct(e,t){var r=Dct(t,1),n=r[0];return Vr(e.value).toLocaleLowerCase(e.meta.locale)===Vr(n)}ln(Nm,Hct,{name:AB,inputsCount:1,showOperators:!0});var EC="neq";function Bct(e,t){return!Hu(Nm,t)(e)}ln(EC,Bct,{name:PB,inputsCount:1,showOperators:!0});function Vct(e,t){return zct(e)||Uct(e,t)||Wct(e,t)||jct()}function jct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wct(e,t){if(e){if(typeof e=="string")return rY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rY(e,t)}}function rY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uct(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function zct(e){if(Array.isArray(e))return e}var lle="gt";function Gct(e,t){var r=Vct(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>i}ln(lle,Gct,{name:NB,inputsCount:1,showOperators:!0});function Yct(e,t){return Zct(e)||qct(e,t)||Xct(e,t)||Kct()}function Kct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xct(e,t){if(e){if(typeof e=="string")return nY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nY(e,t)}}function nY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qct(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Zct(e){if(Array.isArray(e))return e}var ule="gte";function Jct(e,t){var r=Yct(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>=i}ln(ule,Jct,{name:LB,inputsCount:1,showOperators:!0});function Qct(e,t){return nht(e)||rht(e,t)||tht(e,t)||eht()}function eht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tht(e,t){if(e){if(typeof e=="string")return iY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iY(e,t)}}function iY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function nht(e){if(Array.isArray(e))return e}var fle="lt";function iht(e,t){var r=Qct(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<i}ln(fle,iht,{name:FB,inputsCount:1,showOperators:!0});function aht(e,t){return uht(e)||lht(e,t)||sht(e,t)||oht()}function oht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sht(e,t){if(e){if(typeof e=="string")return aY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aY(e,t)}}function aY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function uht(e){if(Array.isArray(e))return e}var cle="lte";function fht(e,t){var r=aht(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<=i}ln(cle,fht,{name:HB,inputsCount:1,showOperators:!0});function cht(e,t){return pht(e)||vht(e,t)||dht(e,t)||hht()}function hht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dht(e,t){if(e){if(typeof e=="string")return oY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oY(e,t)}}function oY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function pht(e){if(Array.isArray(e))return e}var E3="date_after";function ght(e,t){var r=cht(t,1),n=r[0],i=Ae(e.value,e.meta.dateFormat),a=Ae(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)>=0}ln(E3,ght,{name:jB,inputsCount:1,showOperators:!0});function yht(e,t){return _ht(e)||wht(e,t)||bht(e,t)||mht()}function mht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bht(e,t){if(e){if(typeof e=="string")return sY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sY(e,t)}}function sY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function _ht(e){if(Array.isArray(e))return e}var R3="date_before";function Sht(e,t){var r=yht(t,1),n=r[0],i=Ae(e.value,e.meta.dateFormat),a=Ae(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)<=0}ln(R3,Sht,{name:WB,inputsCount:1,showOperators:!0});function Cht(e,t){return Eht(e)||Oht(e,t)||Tht(e,t)||xht()}function xht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tht(e,t){if(e){if(typeof e=="string")return lY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lY(e,t)}}function lY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Eht(e){if(Array.isArray(e))return e}var OT="between";function Rht(e,t){var r=Cht(t,2),n=r[0],i=r[1],a=n,o=i;if(e.meta.type==="numeric"){var s=parseFloat(a,10),l=parseFloat(o,10);a=Math.min(s,l),o=Math.max(s,l)}else if(e.meta.type==="date"){var u=Hu(R3,[o]),f=Hu(E3,[a]);return u(e)&&f(e)}return e.value>=a&&e.value<=o}ln(OT,Rht,{name:BB,inputsCount:2,showOperators:!0});var hle="not_between";function kht(e,t){return!Hu(OT,t)(e)}ln(hle,kht,{name:VB,inputsCount:2,showOperators:!0});function Aht(e,t){return Dht(e)||Mht(e,t)||Iht(e,t)||Pht()}function Pht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iht(e,t){if(e){if(typeof e=="string")return uY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uY(e,t)}}function uY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Dht(e){if(Array.isArray(e))return e}var dle="begins_with";function $ht(e,t){var r=Aht(t,1),n=r[0];return Vr(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Vr(n))}ln(dle,$ht,{name:IB,inputsCount:1,showOperators:!0});var Nht=vt,vle=Yw,Lht=ns.f,Fht=oh,fY=sn,Hht=OF,Bht=Fi,Vht=EF,cY=vle("".endsWith),jht=vle("".slice),Wht=Math.min,ple=Vht("endsWith"),Uht=!ple&&!!function(){var e=Lht(String.prototype,"endsWith");return e&&!e.writable}();Nht({target:"String",proto:!0,forced:!Uht&&!ple},{endsWith:function(t){var r=fY(Bht(this));Hht(t);var n=arguments.length>1?arguments[1]:void 0,i=r.length,a=n===void 0?i:Wht(Fht(n),i),o=fY(t);return cY?cY(r,o,a):jht(r,a-o.length,a)===o}});function zht(e,t){return Xht(e)||Kht(e,t)||Yht(e,t)||Ght()}function Ght(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yht(e,t){if(e){if(typeof e=="string")return hY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hY(e,t)}}function hY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Xht(e){if(Array.isArray(e))return e}var gle="ends_with";function qht(e,t){var r=zht(t,1),n=r[0];return Vr(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Vr(n))}ln(gle,qht,{name:MB,inputsCount:1,showOperators:!0});function Zht(e,t){return tdt(e)||edt(e,t)||Qht(e,t)||Jht()}function Jht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qht(e,t){if(e){if(typeof e=="string")return dY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dY(e,t)}}function dY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function edt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function tdt(e){if(Array.isArray(e))return e}var k3="contains";function rdt(e,t){var r=Zht(t,1),n=r[0];return Vr(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Vr(n))>=0}ln(k3,rdt,{name:DB,inputsCount:1,showOperators:!0});var yle="not_contains";function ndt(e,t){return!Hu(k3,t)(e)}ln(yle,ndt,{name:$B,inputsCount:1,showOperators:!0});var mle="date_tomorrow";function idt(e){var t=Ae(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ae().subtract(-1,"days").startOf("day"),"d"):!1}ln(mle,idt,{name:zB,inputsCount:0});var ble="date_today";function adt(e){var t=Ae(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ae().startOf("day"),"d"):!1}ln(ble,adt,{name:UB,inputsCount:0});var wle="date_yesterday";function odt(e){var t=Ae(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ae().subtract(1,"days").startOf("day"),"d"):!1}ln(wle,odt,{name:GB,inputsCount:0});Cne();function sdt(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var n$=new Set([1]).has(1),ldt=n$&&typeof Array.from=="function";function x_(e){var t=e;return n$&&(t=new Set(t)),function(r){var n;return n$?n=t.has(r):n=!!~t.indexOf(r),n}}function _le(e){return e??""}function i$(e){var t=e;return ldt?t=Array.from(new Set(t)):t=MF(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function vY(e,t,r,n){var i=[],a=e===t,o;return a||(o=x_(t)),ne(e,function(s){var l=!1;(a||o(s))&&(l=!0);var u={checked:l,value:s,visualValue:sdt(s,r)};n&&n(u),i.push(u)}),i}function Sle(e,t){return hdt(e)||cdt(e,t)||fdt(e,t)||udt()}function udt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fdt(e,t){if(e){if(typeof e=="string")return pY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pY(e,t)}}function pY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cdt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function hdt(e){if(Array.isArray(e))return e}var ac="by_value";function ddt(e,t){var r=Sle(t,1),n=r[0];return n(e.value)}ln(ac,ddt,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=Sle(t,1),n=r[0];return[x_(n)]},showOperators:!1});var Kb={};function vdt(e){if(!Kb[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Kb[e].func;return function(r,n){return t(r,n)}}function pdt(e){return Kb[e].name}function A3(e,t,r){Kb[e]={name:t,func:r}}var wu="conjunction",gdt=XB;function ydt(e,t){return e.every(function(r){return r.func(t)})}A3(wu,gdt,ydt);var ET="disjunction",mdt=bE;function bdt(e,t){return e.some(function(r){return r.func(t)})}A3(ET,mdt,bdt);var P3="disjunctionWithExtraCondition",wdt=bE;function _dt(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}A3(P3,wdt,_dt);function Xb(e){return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}var My;function uP(e,t,r){return t=Sdt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sdt(e){var t=Cdt(e,"string");return Xb(t)==="symbol"?t:String(t)}function Cdt(e,t){if(Xb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xdt="numeric",Cle="text",Tdt="date",gY=(My={},uP(My,xdt,[Tn,Dt,$m,OC,Dt,Nm,EC,Dt,lle,ule,fle,cle,OT,hle]),uP(My,Cle,[Tn,Dt,$m,OC,Dt,Nm,EC,Dt,dle,gle,Dt,k3,yle]),uP(My,Tdt,[Tn,Dt,$m,OC,Dt,Nm,EC,Dt,R3,E3,OT,Dt,mle,ble,wle]),My);function Odt(e){var t=[],r=e;return gY[r]||(r=Cle),ne(gY[r],function(n){var i;n===Dt?i={name:Dt}:i=vi(ic(n)),t.push(i)}),t}function qb(e){return qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qb(e)}function Edt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kdt(n.key),n)}}function Rdt(e,t,r){return t&&yY(e.prototype,t),r&&yY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kdt(e){var t=Adt(e,"string");return qb(t)==="symbol"?t:String(t)}function Adt(e,t){if(qb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fP="built",cP="building",mY=["click","input","keydown","keypress","keyup","focus","blur","change"],xle=function(){function e(t,r){Edt(this,e),this.hot=t,this.eventManager=new Nr(this),this.options=nn(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return Rdt(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===cP?this._element:this.buildState===fP?(this.update(),this._element):(this.buildState=cP,this.build(),this.buildState=fP,this._element)}},{key:"isBuilt",value:function(){return this.buildState===fP}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(Ci)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(o,s){r.eventManager.addEventListener(o,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=cP),this.options.className&&ke(this._element,this.options.className),this.options.children.length)ne(this.options.children,function(a){return r._element.appendChild(a.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);At(this.options,function(a,o){i[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(i[o]=r.translateIfPossible(a))}),this._element.appendChild(i),ne(mY,function(a){return n(i,a)})}else ne(mY,function(a){return n(r._element,a)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return vi({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();mr(xle,Bi);const _u=xle;function Op(e){return Op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Op(e)}function Pdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mdt(n.key),n)}}function Idt(e,t,r){return t&&bY(e.prototype,t),r&&bY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mdt(e){var t=Ddt(e,"string");return Op(t)==="symbol"?t:String(t)}function Ddt(e,t){if(Op(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Op(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RC(){return typeof Reflect<"u"&&Reflect.get?RC=Reflect.get.bind():RC=function(t,r,n){var i=$dt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},RC.apply(this,arguments)}function $dt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ep(e),e!==null););return e}function Ndt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a$(e,t)}function a$(e,t){return a$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},a$(e,t)}function Ldt(e){var t=Hdt();return function(){var n=Ep(e),i;if(t){var a=Ep(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Fdt(this,i)}}function Fdt(e,t){if(t&&(Op(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tle(e)}function Tle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ep(e){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ep(e)}var v1=new WeakMap,Bdt=function(e){Ndt(r,e);var t=Ldt(r);function r(n,i){var a;return Pdt(this,r),a=t.call(this,n,nn(r.DEFAULTS,i)),v1.set(Tle(a),{}),a.registerHooks(),a}return Idt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(a){return i.onKeyup(a)})}},{key:"build",value:function(){RC(Ep(r.prototype),"build",this).call(this);var i=v1.get(this),a=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,ke(this._element,"htUIInput"),ke(a,"htUIInputIcon"),this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=v1.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&v1.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return vi({placeholder:"",type:"text",tagName:"input"})}}]),r}(_u);const Gd=Bdt;function Rp(e){return Rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rp(e)}function Vdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wdt(n.key),n)}}function jdt(e,t,r){return t&&wY(e.prototype,t),r&&wY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wdt(e){var t=Udt(e,"string");return Rp(t)==="symbol"?t:String(t)}function Udt(e,t){if(Rp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yd(){return typeof Reflect<"u"&&Reflect.get?Yd=Reflect.get.bind():Yd=function(t,r,n){var i=zdt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Yd.apply(this,arguments)}function zdt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Su(e),e!==null););return e}function Gdt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o$(e,t)}function o$(e,t){return o$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},o$(e,t)}function Ydt(e){var t=Xdt();return function(){var n=Su(e),i;if(t){var a=Su(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Kdt(this,i)}}function Kdt(e,t){if(t&&(Rp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ole(e)}function Ole(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xdt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Su(e)}var p1=new WeakMap,qdt=function(e){Gdt(r,e);var t=Ydt(r);function r(n,i){var a;return Vdt(this,r),a=t.call(this,n,nn(r.DEFAULTS,i)),p1.set(Ole(a),{}),a.menu=null,a.items=[],a.registerHooks(),a}return jdt(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var a=this;return ne(i,function(o){o.name=a.translateIfPossible(o.name)}),i}},{key:"build",value:function(){var i=this;Yd(Su(r.prototype),"build",this).call(this),this.menu=new T3(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var a=new _u(this.hot,{className:"htUISelectCaption"}),o=new _u(this.hot,{className:"htUISelectDropdown"}),s=p1.get(this);s.caption=a,s.captionElement=a.element,s.dropdown=o,ne([a,o],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(mE),p1.get(this).captionElement.textContent=i,Yd(Su(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==Dt&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=p1.get(this),a=i.caption,o=i.dropdown;a&&a.destroy(),o&&o.destroy(),Yd(Su(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return vi({className:"htUISelect",wrapIt:!1})}}]),r}(_u);const _Y=qdt;function kp(e){return kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kp(e)}function Zdt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qdt(n.key),n)}}function Jdt(e,t,r){return t&&SY(e.prototype,t),r&&SY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qdt(e){var t=evt(e,"string");return kp(t)==="symbol"?t:String(t)}function evt(e,t){if(kp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kC(){return typeof Reflect<"u"&&Reflect.get?kC=Reflect.get.bind():kC=function(t,r,n){var i=tvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},kC.apply(this,arguments)}function tvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ap(e),e!==null););return e}function rvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s$(e,t)}function s$(e,t){return s$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},s$(e,t)}function nvt(e){var t=ovt();return function(){var n=Ap(e),i;if(t){var a=Ap(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ivt(this,i)}}function ivt(e,t){if(t&&(kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return avt(e)}function avt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ovt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ap(e){return Ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ap(e)}var svt=function(e){rvt(r,e);var t=nvt(r);function r(n,i){var a;return Zdt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.addSeparator=i.addSeparator,a.elements.push(new _Y(a.hot,{menuContainer:i.menuContainer})),a.elements.push(new Gd(a.hot,{placeholder:t3})),a.elements.push(new Gd(a.hot,{placeholder:r3})),a.registerHooks(),a}return Jdt(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(a){return i.onConditionSelect(a)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),ne(this.getInputElements(),function(a){a.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})})}},{key:"setState",value:function(i){var a=this;if(this.reset(),!!i){var o=vi(i.command);o.name.startsWith(Wr)&&(o.name=this.hot.getTranslatedPhrase(o.name)),this.getSelectElement().setValue(o),ne(i.args,function(s,l){if(l>o.inputsCount-1)return!1;var u=a.getInputElement(l);u.setValue(s),u[o.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||ic(Tn),a=[];return ne(this.getInputElements(),function(o,s){i.inputsCount>s&&a.push(o.getValue())}),{command:i,args:a}}},{key:"updateState",value:function(i,a){var o=ic(i?i.name:Tn);this.state.setValueAtIndex(a,{command:o,args:i?i.args:[]}),i||ne(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof _Y})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof Gd})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){ke(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&ke(s.parentNode,"border");var h=i.hot.rootDocument.createElement("div");return ke(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),a=[ic(Tn)];if(i!==null){var o=i.visualIndex;a=Odt(this.hot.getDataType(0,o,this.hot.countRows(),o))}ne(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(a),kC(Ap(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(a[0])}},{key:"onConditionSelect",value:function(i){ne(this.getInputElements(),function(a,o){a[i.inputsCount>o?"show":"hide"](),o===0&&setTimeout(function(){return a.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){gv(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),go(i)):gv(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),go(i))}}]),r}($E);const hP=svt;function Pp(e){return Pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pp(e)}function lvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fvt(n.key),n)}}function uvt(e,t,r){return t&&CY(e.prototype,t),r&&CY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fvt(e){var t=cvt(e,"string");return Pp(t)==="symbol"?t:String(t)}function cvt(e,t){if(Pp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AC(){return typeof Reflect<"u"&&Reflect.get?AC=Reflect.get.bind():AC=function(t,r,n){var i=hvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},AC.apply(this,arguments)}function hvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ip(e),e!==null););return e}function dvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l$(e,t)}function l$(e,t){return l$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},l$(e,t)}function vvt(e){var t=gvt();return function(){var n=Ip(e),i;if(t){var a=Ip(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pvt(this,i)}}function pvt(e,t){if(t&&(Pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ele(e)}function Ele(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}var g1=new WeakMap,yvt=function(e){dvt(r,e);var t=vvt(r);function r(n,i){var a;return lvt(this,r),a=t.call(this,n,nn(r.DEFAULTS,i)),g1.set(Ele(a),{}),a}return uvt(r,[{key:"build",value:function(){AC(Ip(r.prototype),"build",this).call(this);var i=g1.get(this);i.input=this._element.firstChild;var a=this.hot.rootDocument.createElement("label");a.textContent=this.translateIfPossible(this.options.label.textContent),a.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=a,this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=g1.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&g1.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return vi({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(_u);const xY=yvt;function Mp(e){return Mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mp(e)}var TY;function mvt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_vt(n.key),n)}}function wvt(e,t,r){return t&&OY(e.prototype,t),r&&OY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _vt(e){var t=Svt(e,"string");return Mp(t)==="symbol"?t:String(t)}function Svt(e,t){if(Mp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u$(e,t)}function u$(e,t){return u$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},u$(e,t)}function xvt(e){var t=Evt();return function(){var n=RT(e),i;if(t){var a=RT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Tvt(this,i)}}function Tvt(e,t){if(t&&(Mp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ovt(e)}function Ovt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Evt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function RT(e){return RT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RT(e)}var EY=0,Rvt=function(e){Cvt(r,e);var t=xvt(r);function r(n,i){var a;return bvt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.buildOperatorsElement(),a}return wvt(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return ke(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,a=[wu,ET];ne(a,function(o){var s=new xY(i.hot,{name:"operator",label:{htmlFor:o,textContent:pdt(o)},value:o,checked:o===a[EY],id:o});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(sr(TY||(TY=mvt(["Radio button with index "," doesn't exist."])),i));ne(this.elements,function(a,o){a.setChecked(o===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(a){return a instanceof xY&&a.isChecked()});return i?i.getValue():wu}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&ne(this.elements,function(a){a.setChecked(a.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wu,a=arguments.length>1?arguments[1]:void 0,o=i;o===P3&&(o=ET),this.state.setValueAtIndex(a,o)}},{key:"reset",value:function(){this.setChecked(EY)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}($E);const kvt=Rvt;var Avt=Pt,Pvt=Fi,RY=sn,Ivt=/"/g,Mvt=Avt("".replace),Dvt=function(e,t,r,n){var i=RY(Pvt(e)),a="<"+t;return r!==""&&(a+=" "+r+'="'+Mvt(RY(n),Ivt,"&quot;")+'"'),a+">"+i+"</"+t+">"},$vt=Ct,Nvt=function(e){return $vt(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},Lvt=vt,Fvt=Dvt,Hvt=Nvt;Lvt({target:"String",proto:!0,forced:Hvt("link")},{link:function(t){return Fvt(this,"a","href",t)}});function Dp(e){return Dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(e)}function Bvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jvt(n.key),n)}}function Vvt(e,t,r){return t&&kY(e.prototype,t),r&&kY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jvt(e){var t=Wvt(e,"string");return Dp(t)==="symbol"?t:String(t)}function Wvt(e,t){if(Dp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PC(){return typeof Reflect<"u"&&Reflect.get?PC=Reflect.get.bind():PC=function(t,r,n){var i=Uvt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},PC.apply(this,arguments)}function Uvt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$p(e),e!==null););return e}function zvt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f$(e,t)}function f$(e,t){return f$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},f$(e,t)}function Gvt(e){var t=Kvt();return function(){var n=$p(e),i;if(t){var a=$p(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Yvt(this,i)}}function Yvt(e,t){if(t&&(Dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rle(e)}function Rle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kvt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $p(e){return $p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$p(e)}var dP=new WeakMap,Xvt=function(e){zvt(r,e);var t=Gvt(r);function r(n,i){var a;return Bvt(this,r),a=t.call(this,n,nn(r.DEFAULTS,i)),dP.set(Rle(a),{}),a}return Vvt(r,[{key:"build",value:function(){PC($p(r.prototype),"build",this).call(this);var i=dP.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(dP.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return vi({href:"#",tagName:"a"})}}]),r}(_u);const AY=Xvt;function Np(e){return Np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(e)}function PY(e){return Qvt(e)||Jvt(e)||Zvt(e)||qvt()}function qvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zvt(e,t){if(e){if(typeof e=="string")return c$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c$(e,t)}}function Jvt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qvt(e){if(Array.isArray(e))return c$(e)}function c$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ept(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rpt(n.key),n)}}function tpt(e,t,r){return t&&IY(e.prototype,t),r&&IY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rpt(e){var t=npt(e,"string");return Np(t)==="symbol"?t:String(t)}function npt(e,t){if(Np(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Np(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kd(){return typeof Reflect<"u"&&Reflect.get?Kd=Reflect.get.bind():Kd=function(t,r,n){var i=ipt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Kd.apply(this,arguments)}function ipt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cu(e),e!==null););return e}function apt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h$(e,t)}function h$(e,t){return h$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},h$(e,t)}function opt(e){var t=lpt();return function(){var n=Cu(e),i;if(t){var a=Cu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return spt(this,i)}}function spt(e,t){if(t&&(Np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kle(e)}function kle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cu(e)}var upt=new WeakMap,fpt="multipleSelect.itemBox",cpt=function(e){apt(r,e);var t=opt(r);function r(n,i){var a;return ept(this,r),a=t.call(this,n,nn(r.DEFAULTS,i)),upt.set(kle(a),{}),a.searchInput=new Gd(a.hot,{placeholder:e3,className:"htUIMultipleSelectSearch"}),a.selectAllUI=new AY(a.hot,{textContent:qB,className:"htUISelectAll"}),a.clearAllUI=new AY(a.hot,{textContent:ZB,className:"htUIClearAll"}),a.items=[],a.itemsBox=null,a.registerHooks(),a}return tpt(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)}),this.searchInput.addLocalHook("input",function(a){return i.onInput(a)}),this.selectAllUI.addLocalHook("click",function(a){return i.onSelectAllClick(a)}),this.clearAllUI.addLocalHook("click",function(a){return i.onClearAllClick(a)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return PY(this.items)}},{key:"getValue",value:function(){return dpt(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;Kd(Cu(r.prototype),"build",this).call(this);var a=this.hot.rootDocument,o=a.createElement("div"),s=new _u(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(o);var l=function(f){if(i._element){i.itemsBox&&i.itemsBox.destroy(),ke(f,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(f,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,p,g,y,m,b){v.title=b.instance.getDataAtRowProp(p,b.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-Sn(a)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var c=i.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){i.runLocalHooks("keydown",v,i)},group:fpt})}};l(o),setTimeout(function(){return l(o)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(hpt(this.items,this.options.value)),Kd(Cu(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Kd(Cu(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var a=this,o=i.target.value.toLocaleLowerCase(this.getLocale()),s;o===""?s=PY(this.items):s=ra(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(a.getLocale()).indexOf(o)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var a=cH(gv,i.keyCode);a("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(go(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var a=[];i.preventDefault(),ne(this.itemsBox.getSourceData(),function(o,s){o.checked=!0,a.push(z2(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}},{key:"onClearAllClick",value:function(i){var a=[];i.preventDefault(),ne(this.itemsBox.getSourceData(),function(o,s){o.checked=!1,a.push(z2(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}}],[{key:"DEFAULTS",get:function(){return vi({className:"htUIMultipleSelect",value:[]})}}]),r}(_u);const MY=cpt;function hpt(e,t){var r=x_(t);return Rt(e,function(n){return n.checked=r(n.value),n})}function dpt(e){var t=[];return ne(e,function(r){r.checked&&t.push(r.value)}),t}function Lp(e){return Lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lp(e)}function vpt(e,t){return mpt(e)||ypt(e,t)||gpt(e,t)||ppt()}function ppt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gpt(e,t){if(e){if(typeof e=="string")return DY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DY(e,t)}}function DY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ypt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function mpt(e){if(Array.isArray(e))return e}function bpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_pt(n.key),n)}}function wpt(e,t,r){return t&&$Y(e.prototype,t),r&&$Y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _pt(e){var t=Spt(e,"string");return Lp(t)==="symbol"?t:String(t)}function Spt(e,t){if(Lp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IC(){return typeof Reflect<"u"&&Reflect.get?IC=Reflect.get.bind():IC=function(t,r,n){var i=Cpt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},IC.apply(this,arguments)}function Cpt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fp(e),e!==null););return e}function xpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d$(e,t)}function d$(e,t){return d$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},d$(e,t)}function Tpt(e){var t=Rpt();return function(){var n=Fp(e),i;if(t){var a=Fp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Opt(this,i)}}function Opt(e,t){if(t&&(Lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ept(e)}function Ept(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fp(e){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(e)}var kpt=function(e){xpt(r,e);var t=Tpt(r);function r(n,i){var a;return bpt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.elements.push(new MY(a.hot)),a.registerHooks(),a}return wpt(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===ac){var a=this.getMultipleSelectElement();a.setItems(i.itemsSnapshot),a.setValue(i.args[0]),a.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),a=i.getItems();return{command:{key:i.isSelectedAllValues()||!a.length?Tn:ac},args:[i.getValue()],itemsSnapshot:a}}},{key:"updateState",value:function(i){var a=this,o=function(l,u,f,c,h){var d=ra(u,function(T){return T.name===ac}),v=vpt(d,1),p=v[0],g={},y=a.hot.getTranslatedPhrase(vT);if(p){var m=i$(Rt(c(l,h),function(T){return T.value}));f&&(p.args[0]=f);var b=[],_=vY(m,p.args[0],y,function(T){T.checked&&b.push(T.value)}),x=i.editedConditionStack.column;g.locale=a.hot.getCellMeta(0,x).locale,g.args=[b],g.command=ic(ac),g.itemsSnapshot=_}else g.args=[],g.command=ic(Tn);a.state.setValueAtIndex(l,g)};o(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&o(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof MY})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){ke(s.parentNode,"htFiltersMenuValue");var h=i.hot.rootDocument.createElement("div");return ke(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(vT),a=i$(this._getColumnVisibleValues()),o=vY(a,a,i);this.getMultipleSelectElement().setItems(o),IC(Fp(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(a);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){gv(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),go(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:Rt(this.hot.getDataAtCol(i.visualIndex),function(a){return _le(a)})}}]),r}($E);const Apt=kpt;function Hp(e){return Hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hp(e)}function Ppt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mpt(n.key),n)}}function Ipt(e,t,r){return t&&NY(e.prototype,t),r&&NY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mpt(e){var t=Dpt(e,"string");return Hp(t)==="symbol"?t:String(t)}function Dpt(e,t){if(Hp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $pt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v$(e,t)}function v$(e,t){return v$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},v$(e,t)}function Npt(e){var t=Hpt();return function(){var n=kT(e),i;if(t){var a=kT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Lpt(this,i)}}function Lpt(e,t){if(t&&(Hp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fpt(e)}function Fpt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hpt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kT(e){return kT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kT(e)}var Bpt=function(e){$pt(r,e);var t=Npt(r);function r(n,i){var a;return Ppt(this,r),a=t.call(this,n,{id:i.id,stateless:!0}),a.name=i.name,a.elements.push(new Gd(a.hot,{type:"button",value:JB,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),a.elements.push(new Gd(a.hot,{type:"button",value:QB,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),a.registerHooks(),a}return Ipt(r,[{key:"registerHooks",value:function(){var i=this;ne(this.elements,function(a){a.addLocalHook("click",function(o,s){return i.onButtonClick(o,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return ke(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,a){a.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}($E);const Vpt=Bpt;function Zb(e){return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(e)}var LY,FY;function HY(e,t){return zpt(e)||Upt(e,t)||Wpt(e,t)||jpt()}function jpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wpt(e,t){if(e){if(typeof e=="string")return BY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BY(e,t)}}function BY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Upt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function zpt(e){if(Array.isArray(e))return e}function VY(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Gpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kpt(n.key),n)}}function Ypt(e,t,r){return t&&jY(e.prototype,t),r&&jY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kpt(e){var t=Xpt(e,"string");return Zb(t)==="symbol"?t:String(t)}function Xpt(e,t){if(Zb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WY="ConditionCollection.filteringStates",Ale=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Gpt(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new yE,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(WY,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return Ypt(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,a=this.filteringStates.getValueAtIndex(n),o=(i=a==null?void 0:a.conditions)!==null&&i!==void 0?i:[],s=a==null?void 0:a.operation;return this.isMatchInConditions(o,r,s)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wu;return r.length?vdt(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wu,a=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,r).locale,s=Rt(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(o):c}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==i)throw Error(sr(LY||(LY=VY(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(pr(Kb[i]))throw new Error(sr(FY||(FY=VY(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:l,args:s,func:Hu(l,s)}]},a):f.push({name:l,args:s,func:Hu(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=HY(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Xr(this.filteringStates.getEntries(),function(r,n){var i=HY(n,2),a=i[0],o=i[1],s=o.operation,l=o.conditions;return r.push({column:a,operation:s,conditions:Rt(l,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),ne(r,function(i){ne(i.conditions,function(a){return n.addCondition(i.column,a)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(a){return a.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(WY),this.filteringStates=null,this.clearLocalHooks()}}]),e}();mr(Ale,Bi);const Ple=Ale;function Jb(e){return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(e)}function qpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jpt(n.key),n)}}function Zpt(e,t,r){return t&&UY(e.prototype,t),r&&UY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jpt(e){var t=Qpt(e,"string");return Jb(t)==="symbol"?t:String(t)}function Qpt(e,t){if(Jb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var egt=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};qpt(this,e),this.conditionCollection=t,this.columnDataFactory=r}return Zpt(e,[{key:"filter",value:function(){var r=this,n=[];return ne(this.conditionCollection.getFilteredColumns(),function(i,a){var o=r.columnDataFactory(i);a&&(o=r._getIntersectData(o,n)),n=r.filterByColumn(i,o)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[];return ne(i,function(o){o!==void 0&&n.conditionCollection.isMatch(o,r)&&a.push(o)}),a}},{key:"_getIntersectData",value:function(r,n){var i=[];return ne(n,function(a){var o=a.meta.visualRow;r[o]!==void 0&&(i[o]=r[o])}),i}}]),e}();const Ile=egt;function Qb(e){return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function tgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ngt(n.key),n)}}function rgt(e,t,r){return t&&zY(e.prototype,t),r&&zY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ngt(e){var t=igt(e,"string");return Qb(t)==="symbol"?t:String(t)}function igt(e,t){if(Qb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mle=function(){function e(t,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};tgt(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(a){return n._onConditionBeforeModify(a)}),this.conditionCollection.addLocalHook("afterRemove",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("afterAdd",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return rgt(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,ne(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var a=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(r);o===-1&&(o=this.latestEditedColumnPosition);var s=a.slice(0,o),l=a.slice(o);l.length&&l[0].column===r&&l.shift();var u=Yie(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new Ple(i.hot,!1),p=[].concat(c,d);v.importAllConditions(p);var g=i.columnDataFactory(h),y;v.isEmpty()?y=g:y=new Ile(v,function(b){return i.columnDataFactory(b)}).filter(),y=Rt(y,function(b){return b.meta.visualRow});var m=x_(y);return v.destroy(),ra(g,function(b){return m(b.meta.visualRow)})})(s),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;ne(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),At(this,function(n,i){r[i]=null})}}]),e}();mr(Mle,Bi);const agt=Mle;function Bp(e){return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bp(e)}var GY;function ogt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function sgt(e,t){return cgt(e)||fgt(e,t)||ugt(e,t)||lgt()}function lgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ugt(e,t){if(e){if(typeof e=="string")return YY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YY(e,t)}}function YY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fgt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function cgt(e){if(Array.isArray(e))return e}function hgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vgt(n.key),n)}}function dgt(e,t,r){return t&&KY(e.prototype,t),r&&KY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vgt(e){var t=pgt(e,"string");return Bp(t)==="symbol"?t:String(t)}function pgt(e,t){if(Bp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xd(){return typeof Reflect<"u"&&Reflect.get?Xd=Reflect.get.bind():Xd=function(t,r,n){var i=ggt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Xd.apply(this,arguments)}function ggt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xu(e),e!==null););return e}function ygt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p$(e,t)}function p$(e,t){return p$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},p$(e,t)}function mgt(e){var t=wgt();return function(){var n=xu(e),i;if(t){var a=xu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return bgt(this,i)}}function bgt(e,t){if(t&&(Bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dle(e)}function Dle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e){return xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xu(e)}var XY="filters",_gt=250,Sgt=function(e){ygt(r,e);var t=mgt(r);function r(n){var i;return hgt(this,r),i=t.call(this,n),i.eventManager=new Nr(Dle(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return dgt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[XY]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new g_),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var a=this.hot.getSettings().dropdownMenu,o=a&&a.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return i.onComponentChange(d,v)}),d},l=function(){return"".concat(i.hot.getTranslatedPhrase(YB),":")},u=function(){return"".concat(i.hot.getTranslatedPhrase(KB),":")};if(!this.components.get("filter_by_condition")){var f=new hP(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:o});f.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new kvt(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new hP(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:o});c.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new Apt(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new Vpt(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Ple(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new agt(this.hot,this.conditionCollection,function(h){return i.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return i.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return i.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return i.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return i.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Xd(xu(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var a;(a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(o,s){o.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}Xd(xu(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:wu,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:a},args:o},s)}},{key:"removeConditions",value:function(i){var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}}},{key:"filter",value:function(){var i=this,a=this._createDataFilter(),o=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(o){var f=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=Rt(a.filter(),function(h){return h.meta.visualRow});var c=x_(s);rt(i.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),ne(f,function(h){i.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return a?{visualIndex:a.col,physicalIndex:this.hot.toPhysicalColumn(a.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var a=this,o=this.hot.toVisualColumn(i),s=[];return ne(this.hot.getSourceDataAtCol(o),function(l,u){var f,c=a.hot.getCellMeta(u,o),h=c.row,d=c.col,v=c.visualCol,p=c.visualRow,g=c.type,y=c.instance,m=c.dateFormat,b=c.locale,_=(f=a.hot.getDataAtCell(a.hot.toVisualRow(u),o))!==null&&f!==void 0?f:l;s.push({meta:{row:h,col:d,visualCol:v,visualRow:p,type:g,instance:y,dateFormat:m,locale:b},value:_le(_)})}),s}},{key:"onAfterChange",value:function(i){var a=this;i&&ne(i,function(o){var s=sgt(o,2),l=s[1],u=a.hot.propToCol(l);a.conditionCollection.hasConditions(u)&&a.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(i){var a=this.hot.getDataAtCol(i),o=i$(a);this.conditionUpdateObserver.updateStatesAtColumn(i,o)}},{key:"restoreComponents",value:function(i){var a,o=(a=this.getSelectedColumn())===null||a===void 0?void 0:a.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(o)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:Dt}),this.components.forEach(function(a){i.items.push(a.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,a,o,s){var l=i;return l===ET&&a.command.key!==Tn&&o.command.key!==Tn&&s.command.key!==Tn?l=P3:s.command.key!==Tn&&(a.command.key===Tn||o.command.key===Tn)&&(l=wu),l}},{key:"onActionBarSubmit",value:function(i){var a;if(i==="accept"){var o=this.getSelectedColumn();if(o===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=o.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(l);d===-1&&(d=void 0),this.conditionCollection.removeConditions(l),u.command.key!==Tn&&(this.conditionCollection.addCondition(l,u,h,d),f.command.key!==Tn&&this.conditionCollection.addCondition(l,f,h,d)),c.command.key!==Tn&&this.conditionCollection.addCondition(l,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(a=this.dropdownMenuPlugin)===null||a===void 0||a.close()}},{key:"onComponentChange",value:function(i,a){this.updateDependentComponentsVisibility(),i.constructor===hP&&!a.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),a=i.getState(),o=a.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];o.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,a){var o=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(o)?ke(a,"htFiltersActive"):wt(a,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Ile(a,function(o){return i.getDataMapAtColumn(o)})}},{key:"updateComponents",value:function(i){var a;if((a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled){var o=i.editedConditionStack,s=o.conditions,l=o.column,u=s.filter(function(h){return h.name===ac}),f=s.filter(function(h){return h.name!==ac});if(u.length>=2||f.length>=3)gr(sr(GY||(GY=ogt([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(f[0],l),this.components.get("filter_by_condition2").updateState(f[1],l),this.components.get("filter_operators").updateState(c,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var a=this.dropdownMenuPlugin.menu,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return ne(s,function(u){ne(a.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&i.push(c)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var a=this.dropdownMenuPlugin.menu,o=a.hotMenu,s=o.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);i?s.showRows(c):s.hideRows(c),o.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!1].concat(a))}},{key:"showComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!0].concat(a))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(a,o){a!==null&&(a.destroy(),i.components.set(o,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),Xd(xu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return XY}},{key:"PLUGIN_PRIORITY",get:function(){return _gt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(tr);function ew(e){return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(e)}function qY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Lm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qY(Object(r),!0).forEach(function(n){Cgt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cgt(e,t,r){return t=xgt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xgt(e){var t=Tgt(e,"string");return ew(t)==="symbol"?t:String(t)}function Tgt(e,t){if(ew(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ew(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $le="internal-use-in-handsontable",Ogt={licenseKey:$le,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Nle(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[fi])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Lle(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function Egt(e){var t,r=e[fi],n=Lle(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Nle(e);return Lm(Lm(Lm({},Ogt),n),i)}function Rgt(e){var t,r=e[fi],n=Lle(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Nle(e);return Lm(Lm({},n),i)}function g$(e){return g$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g$(e)}function NE(){var e="engine_relationship",t=Ha(fi);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function I3(){var e="shared_engine_usage",t=Ha(fi);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function kgt(e){var t=e.getSettings(),r=t[fi],n=r==null?void 0:r.engine;if(r===!0||pr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return Agt((i=n.hyperformula)!==null&&i!==void 0?i:n,t,e)}else if(g$(n)==="object"&&pr(n.hyperformula)){var a=NE(),o=I3().get(n);return a.has(n)||a.set(n,[]),a.get(n).push(e),o&&o.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:$le}),n}return null}function Agt(e,t,r){var n=t[fi],i=Egt(t),a=NE(),o=I3();Pgt(e,n.functions),Igt(e,n.language);var s=e.buildEmpty(i);return a.set(s,[r]),o.set(s,[r.guid]),Mgt(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function ZY(e){var t,r=NE(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function JY(e,t){if(e){var r=NE(),n=r.get(e),i=I3(),a=i.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),a&&a.includes(t.guid)&&(a.splice(a.indexOf(t.guid),1),a.length===0&&(i.delete(e),e.destroy()))}}function Pgt(e,t){t&&t.forEach(function(r){var n=r.name,i=r.plugin,a=r.translations;try{e.registerFunction(n,i,a)}catch(o){gr(o.message)}})}function Igt(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){gr(n.message)}}}function Mgt(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,i=r.expression,a=r.scope,o=r.options;try{e.addNamedExpression(n,i,a,o)}catch(s){gr(s.message)}}),e.resumeEvaluation())}function Dgt(e,t){return(pr(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function Fle(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function $gt(e){return Fle(e)?e.substr(1):e}function Ngt(e){return Hgt(e)||Fgt(e)||Hle(e)||Lgt()}function Lgt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fgt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Hgt(e){if(Array.isArray(e))return y$(e)}function QY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function eK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QY(Object(r),!0).forEach(function(n){MC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bu(e){return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(e)}function nd(e,t){return jgt(e)||Vgt(e,t)||Hle(e,t)||Bgt()}function Bgt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hle(e,t){if(e){if(typeof e=="string")return y$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y$(e,t)}}function y$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vgt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function jgt(e){if(Array.isArray(e))return e}function Wgt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ble(n.key),n)}}function Ugt(e,t,r){return t&&tK(e.prototype,t),r&&tK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oc(){return typeof Reflect<"u"&&Reflect.get?oc=Reflect.get.bind():oc=function(t,r,n){var i=zgt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},oc.apply(this,arguments)}function zgt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Us(e),e!==null););return e}function Ggt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m$(e,t)}function m$(e,t){return m$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},m$(e,t)}function Ygt(e){var t=Xgt();return function(){var n=Us(e),i;if(t){var a=Us(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Kgt(this,i)}}function Kgt(e,t){if(t&&(Bu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nf(e)}function Nf(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xgt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Us(e){return Us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Us(e)}function MC(e,t,r){return t=Ble(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ble(e){var t=qgt(e,"string");return Bu(t)==="symbol"?t:String(t)}function qgt(e,t){if(Bu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vP(e,t,r){Zgt(e,t),t.set(e,r)}function Zgt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function id(e,t,r){var n=Vle(e,t,"set");return Jgt(e,n,r),r}function Jgt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function ad(e,t){var r=Vle(e,t,"get");return Qgt(e,r)}function Vle(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Qgt(e,t){return t.get?t.get.call(e):t.value}var fi="formulas",eyt=260,rK="row_move";Je.getSingleton().register("afterNamedExpressionAdded");Je.getSingleton().register("afterNamedExpressionRemoved");Je.getSingleton().register("afterSheetAdded");Je.getSingleton().register("afterSheetRemoved");Je.getSingleton().register("afterSheetRenamed");Je.getSingleton().register("afterFormulasValuesUpdate");var od=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Af=new WeakMap,pP=new WeakMap,Dy=new WeakMap,tyt=function(e){Ggt(r,e);var t=Ygt(r);function r(){var n;Wgt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),vP(Nf(n),Af,{writable:!0,value:!1}),vP(Nf(n),pP,{writable:!0,value:!1}),vP(Nf(n),Dy,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),MC(Nf(n),"staticRegister",Ha("formulas")),MC(Nf(n),"engine",null),MC(Nf(n),"sheetName",null),n}return Ugt(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fi]}},{key:"enablePlugin",value:function(){var i,a=this;if(!this.enabled){if(this.engine=(i=kgt(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){gr("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var o=this.addSheet(this.sheetName,this.hot.getSourceDataArray());o!==!1&&(this.sheetName=o)}this.addHook("beforeLoadData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterLoadData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("beforeUpdateData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterUpdateData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("modifyData",function(){return a.onModifyData.apply(a,arguments)}),this.addHook("modifySourceData",function(){return a.onModifySourceData.apply(a,arguments)}),this.addHook("beforeValidate",function(){return a.onBeforeValidate.apply(a,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return a.onAfterSetSourceDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtCell",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("beforeCreateRow",function(){return a.onBeforeCreateRow.apply(a,arguments)}),this.addHook("beforeCreateCol",function(){return a.onBeforeCreateCol.apply(a,arguments)}),this.addHook("afterCreateRow",function(){return a.onAfterCreateRow.apply(a,arguments)}),this.addHook("afterCreateCol",function(){return a.onAfterCreateCol.apply(a,arguments)}),this.addHook("beforeRemoveRow",function(){return a.onBeforeRemoveRow.apply(a,arguments)}),this.addHook("beforeRemoveCol",function(){return a.onBeforeRemoveCol.apply(a,arguments)}),this.addHook("afterRemoveRow",function(){return a.onAfterRemoveRow.apply(a,arguments)}),this.addHook("afterRemoveCol",function(){return a.onAfterRemoveCol.apply(a,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==rK&&a.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==rK&&a.engine.redo()}),this.addHook("afterDetachChild",function(){return a.onAfterDetachChild.apply(a,arguments)}),this.addHook("beforeAutofill",function(){return a.onBeforeAutofill.apply(a,arguments)}),ad(this,Dy).forEach(function(s){var l=nd(s,2),u=l[0],f=l[1];return a.engine.on(u,f)}),oc(Us(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;ad(this,Dy).forEach(function(a){var o=nd(a,2),s=o[0],l=o[1];return i.engine.off(s,l)}),JY(this.engine,this.hot),this.engine=null,oc(Us(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(Rgt(this.hot.getSettings()));var a=this.hot.getSettings()[fi];if(Xe(a)&&Xe(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!i.data&&this.sheetName===null){var o=this.hot.getSettings()[fi].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}oc(Us(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;ad(this,Dy).forEach(function(a){var o,s=nd(a,2),l=s[0],u=s[1];return(o=i.engine)===null||o===void 0?void 0:o.off(l,u)}),id(this,Dy,null),JY(this.engine,this.hot),this.engine=null,oc(Us(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,a,o,s,l){return!l&&i>=o?s+(i-o):a}},{key:"toPhysicalRowPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),a)}},{key:"toPhysicalColumnPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),a)}},{key:"addSheet",value:function(i,a){if(Xe(a)&&!voe(a))return gr("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return gr("Sheet with the provided name already exists."),!1;try{var o=this.engine.addSheet(i??void 0);return a&&this.engine.setSheetContent(this.engine.getSheetId(o),a),o}catch(s){return gr(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){hH("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var a=this.engine.getSheetSerialized(this.sheetId);a.length>0&&this.hot.loadData(a,"".concat($i(fi),".switchSheet"))}},{key:"getCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s!==null&&l!==null?this.engine.getCellType({sheet:o,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:o,row:s,col:l})}},{key:"renderDependentSheets",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var u,f=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(s.has(f)||s.add(f))}),ZY(this.engine).forEach(function(l,u){if((o||u!==a.sheetId)&&s.has(u)){var f;l.render(),(f=l.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,p=h.sheet;return Xe(p)?"".concat(p,":").concat(d,"x").concat(v):""},l=new Set(o.map(function(u){return s(u)}));i.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col,p=Xe(d)?a.hot.toVisualRow(d):null,g=Xe(v)?a.hot.toVisualColumn(v):null;if(!(p===null||g===null)){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=s(u);if(y!==void 0&&!l.has(m)){var b=ZY(a.engine).get(y);if(!b)return;b.validateCell(b.getDataAtCell(p,g),b.getCellMeta(p,g),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,a,o){var s={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(a),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){gr("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,o)}},{key:"onBeforeValidate",value:function(i,a,o){var s=this.hot.propToCol(o);if(this.isFormulaCellType(a,s)){var l={row:this.hot.toPhysicalRow(a),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return Bu(u)==="object"&&u!==null?u.value:u}return i}},{key:"onBeforeAutofill",value:function(i,a,o){var s=this,l=function(h){return eK(eK({},h),{},{sheet:s.sheetId})},u={start:l(a.getTopStartCorner()),end:l(a.getBottomEndCorner())},f={start:l(o.getTopStartCorner()),end:l(o.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(f)===!1?!1:this.engine.getFillRangeData(u,f)}},{key:"onBeforeLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";o.includes($i(fi))||id(this,pP,pr(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!o.includes($i(fi)))if(this.sheetName=Dgt(this.engine,this.hot.getSettings()[fi].sheetName),ad(this,pP))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){id(this,Af,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),id(this,Af,!1)}}}},{key:"onModifyData",value:function(i,a,o,s){if(!(s!=="get"||ad(this,Af)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.isFormulaCellType(l,a);if(!u){var f=this.getCellType(l,a);if(f!=="ARRAY"){Fle(o.value)&&(o.value=$gt(o.value));return}}var c={row:i,col:this.toPhysicalColumnPosition(a),sheet:this.sheetId},h=this.engine.getCellValue(c),d=Bu(h)==="object"&&h!==null?h.value:h;o.value=d}}},{key:"onModifySourceData",value:function(i,a,o,s){if(!(s!=="get"||ad(this,Af)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.hot.propToCol(a),f=this.isFormulaCellType(l,u);if(!f){var c=this.getCellType(l,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:i,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};o.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(i,a){var o=this;if(!od(a)){var s=[],l=[],u=this.engine.batch(function(){i.forEach(function(f){var c=nd(f,4),h=c[0],d=c[1],v=c[3],p=o.hot.propToCol(d),g=o.hot.toPhysicalRow(h),y=o.hot.toPhysicalColumn(p),m={row:g,col:y,sheet:o.sheetId};g!==null&&y!==null?o.syncChangeWithEngine(h,p,v):s.push([h,p,v]),l.push({address:m})})});s.length&&this.hot.addHookOnce("afterChange",function(){var f=o.engine.batch(function(){s.forEach(function(c){var h=nd(c,3),d=h[0],v=h[1],p=h[2];o.syncChangeWithEngine(d,v,p)})});o.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,a){var o=this;if(!od(a)){var s=[],l=[];i.forEach(function(u){var f=nd(u,4),c=f[0],h=f[1],d=f[3],v=o.hot.propToCol(h);if(Ki(v)){var p={row:c,col:o.toPhysicalColumnPosition(v),sheet:o.sheetId};if(!o.engine.isItPossibleToSetCellContents(p)){gr("Not possible to set source cell data at ".concat(JSON.stringify(p)));return}l.push({address:p}),s.push.apply(s,Ngt(o.engine.setCellContents(p,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),a]))return!1}},{key:"onBeforeCreateCol",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]))return!1}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,a,o){if(!od(o)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,a,o){if(!od(o)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(!od(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeRows(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(i,a,o,s){var l=this;if(!od(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeColumns(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(i,a,o){var s,l=this;id(this,Af,!0);var u=this.hot.getSourceDataArray(o,0,o+(((s=a.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());id(this,Af,!1),u.forEach(function(f,c){f.forEach(function(h,d){l.engine.setCellContents({col:d,row:o+c,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,a){this.hot.runHooks("afterNamedExpressionAdded",i,a)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,a){this.hot.runHooks("afterNamedExpressionRemoved",i,a)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,a){this.hot.runHooks("afterSheetRenamed",i,a)}},{key:"onEngineSheetRemoved",value:function(i,a){this.hot.runHooks("afterSheetRemoved",i,a)}}],[{key:"PLUGIN_KEY",get:function(){return fi}},{key:"PLUGIN_PRIORITY",get:function(){return eyt}}]),r}(tr);function ryt(e,t){return oyt(e)||ayt(e,t)||iyt(e,t)||nyt()}function nyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iyt(e,t){if(e){if(typeof e=="string")return nK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nK(e,t)}}function nK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ayt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function oyt(e){if(Array.isArray(e))return e}function syt(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=ryt(r,4),a=i[1],o=i[3];a-o!==0&&(n=1)}return this.getTranslatedPhrase(xB,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.col,i.col),0),o=Math.max(n.col,i.col),s=[],l=a;l<=o;l+=1)s.push(l);e.hideColumns(s);var u=s[s.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function y1(e){return cyt(e)||fyt(e)||uyt(e)||lyt()}function lyt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uyt(e,t){if(e){if(typeof e=="string")return b$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b$(e,t)}}function fyt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cyt(e){if(Array.isArray(e))return b$(e)}function b$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hyt(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(TB,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countCols();s||this.selectColumns(a,o)}},disabled:!1,hidden:function(){var n=this,i=Rt(e.getHiddenColumns(),function(m){return n.toPhysicalColumn(m)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().col,s=a.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var p=c.slice(o,s+1);h.push.apply(h,y1(p.filter(function(m){return i.includes(m)})))}}else if(u===0&&u<o)h.push.apply(h,y1(c.slice(0,o)));else if(u===null)h.push.apply(h,y1(c.slice(0,this.countCols())));else{var g=this.countCols()-1,y=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));f===y&&g>s&&h.push.apply(h,y1(c.slice(s+1)))}return ne(h,function(m){t.push(n.toVisualColumn(m))}),t.length===0}}}function Vp(e){return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vp(e)}function dyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pyt(n.key),n)}}function vyt(e,t,r){return t&&iK(e.prototype,t),r&&iK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pyt(e){var t=gyt(e,"string");return Vp(t)==="symbol"?t:String(t)}function gyt(e,t){if(Vp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sc(){return typeof Reflect<"u"&&Reflect.get?sc=Reflect.get.bind():sc=function(t,r,n){var i=yyt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},sc.apply(this,arguments)}function yyt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zs(e),e!==null););return e}function myt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w$(e,t)}function w$(e,t){return w$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},w$(e,t)}function byt(e){var t=_yt();return function(){var n=zs(e),i;if(t){var a=zs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return wyt(this,i)}}function wyt(e,t){if(t&&(Vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _$(e)}function _$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _yt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zs(e){return zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zs(e)}function aK(e,t,r){Syt(e,t),t.set(e,r)}function Syt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(e,t){var r=jle(e,t,"get");return Cyt(e,r)}function Cyt(e,t){return t.get?t.get.call(e):t.value}function $y(e,t,r){var n=jle(e,t,"set");return xyt(e,n,r),r}function jle(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function xyt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Je.getSingleton().register("beforeHideColumns");Je.getSingleton().register("afterHideColumns");Je.getSingleton().register("beforeUnhideColumns");Je.getSingleton().register("afterUnhideColumns");var gP="hiddenColumns",Tyt=310,Po=new WeakMap,Io=new WeakMap,Oyt=function(e){myt(r,e);var t=byt(r);function r(){var n;dyt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),aK(_$(n),Po,{writable:!0,value:{}}),aK(_$(n),Io,{writable:!0,value:null}),n}return vyt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[gP]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[gP];kt(a)&&($y(this,Po,a),pr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),$y(this,Io,new gE),Wi(this,Io).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Wi(this,Io)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyColWidth",function(o,s){return i.onModifyColWidth(o,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),sc(zs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sc(zs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),$y(this,Po,{}),sc(zs(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o,u=Wi(this,Io).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalColumn(d)});ne(c,function(d){u[d]=!1}),l=Xr(u,function(d,v,p){return v&&d.push(a.hot.toVisualColumn(p)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",o,l,s&&f);h!==!1&&(s&&f&&Wi(this,Io).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",o,l,s&&f,s&&l.length<o.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showColumns(a)}},{key:"hideColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideColumns",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ne(i,function(f){Wi(a,Io).setValueAtIndex(a.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",o,l,s,s&&l.length>o.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideColumns(a)}},{key:"getHiddenColumns",value:function(){var i=this;return Rt(Wi(this,Io).getHiddenIndexes(),function(a){return i.hot.toVisualColumn(a)})}},{key:"isHidden",value:function(i){return Wi(this,Io).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ne(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,a){if(this.isHidden(a))return 0;if(Wi(this,Po).indicators&&(this.isHidden(a+1)||this.isHidden(a-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(Wi(this,Po).copyPasteEnabled===!1&&this.isHidden(a)&&(o.skipColumnOnPaste=!0),this.isHidden(a-1))o.className=o.className||"",o.className.indexOf("afterHiddenColumn")===-1&&(o.className+=" afterHiddenColumn");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(Wi(this,Po).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ne(i,function(l){var u=!0,f=0;rt(l.startCol,l.endCol,function(c){a.isHidden(c)?(u||s(l.startRow,l.endRow,f,c-1),u=!0):(u&&(f=c),c===l.endCol&&s(l.startRow,l.endRow,f,c),u=!1)})}),o}},{key:"onAfterGetColHeader",value:function(i,a){if(!(!Wi(this,Po).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&o.push("beforeHiddenColumn"),ke(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:Dt},syt(this),hyt(this))}},{key:"onMapInit",value:function(){Array.isArray(Wi(this,Po).columns)&&this.hideColumns(Wi(this,Po).columns)}},{key:"destroy",value:function(){$y(this,Po,null),$y(this,Io,null),sc(zs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gP}},{key:"PLUGIN_PRIORITY",get:function(){return Tyt}}]),r}(tr);function Eyt(e,t){return Pyt(e)||Ayt(e,t)||kyt(e,t)||Ryt()}function Ryt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kyt(e,t){if(e){if(typeof e=="string")return oK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oK(e,t)}}function oK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ayt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Pyt(e){if(Array.isArray(e))return e}function Iyt(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=Eyt(r,3),a=i[0],o=i[2];a-o!==0&&(n=1)}return this.getTranslatedPhrase(OB,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.row,i.row),0),o=Math.max(n.row,i.row),s=[],l=a;l<=o;l+=1)s.push(l);e.hideRows(s);var u=s[s.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function m1(e){return Nyt(e)||$yt(e)||Dyt(e)||Myt()}function Myt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dyt(e,t){if(e){if(typeof e=="string")return S$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S$(e,t)}}function $yt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nyt(e){if(Array.isArray(e))return S$(e)}function S$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lyt(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(EB,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countRows();s||this.selectRows(a,o)}},disabled:!1,hidden:function(){var n=this,i=Rt(e.getHiddenRows(),function(m){return n.toPhysicalRow(m)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().row,s=a.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var p=c.slice(o,s+1);h.push.apply(h,m1(p.filter(function(m){return i.includes(m)})))}}else if(u===0&&u<o)h.push.apply(h,m1(c.slice(0,o)));else if(u===null)h.push.apply(h,m1(c.slice(0,this.countRows())));else{var g=this.countRows()-1,y=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));f===y&&g>s&&h.push.apply(h,m1(c.slice(s+1)))}return ne(h,function(m){t.push(n.toVisualRow(m))}),t.length===0}}}function jp(e){return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(e)}function Fyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Byt(n.key),n)}}function Hyt(e,t,r){return t&&sK(e.prototype,t),r&&sK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Byt(e){var t=Vyt(e,"string");return jp(t)==="symbol"?t:String(t)}function Vyt(e,t){if(jp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lc(){return typeof Reflect<"u"&&Reflect.get?lc=Reflect.get.bind():lc=function(t,r,n){var i=jyt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},lc.apply(this,arguments)}function jyt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gs(e),e!==null););return e}function Wyt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C$(e,t)}function C$(e,t){return C$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},C$(e,t)}function Uyt(e){var t=Gyt();return function(){var n=Gs(e),i;if(t){var a=Gs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zyt(this,i)}}function zyt(e,t){if(t&&(jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x$(e)}function x$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gyt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gs(e){return Gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gs(e)}function lK(e,t,r){Yyt(e,t),t.set(e,r)}function Yyt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ca(e,t){var r=Wle(e,t,"get");return Kyt(e,r)}function Kyt(e,t){return t.get?t.get.call(e):t.value}function Ny(e,t,r){var n=Wle(e,t,"set");return Xyt(e,n,r),r}function Wle(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Xyt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Je.getSingleton().register("beforeHideRows");Je.getSingleton().register("afterHideRows");Je.getSingleton().register("beforeUnhideRows");Je.getSingleton().register("afterUnhideRows");var yP="hiddenRows",qyt=320,gs=new WeakMap,Mo=new WeakMap,Zyt=function(e){Wyt(r,e);var t=Uyt(r);function r(){var n;Fyt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),lK(x$(n),gs,{writable:!0,value:{}}),lK(x$(n),Mo,{writable:!0,value:null}),n}return Hyt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[yP]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[yP];kt(a)&&(Ny(this,gs,a),pr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),Ny(this,Mo,new gE),ca(this,Mo).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,ca(this,Mo)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyRowHeight",function(o,s){return i.onModifyRowHeight(o,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),lc(Gs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),lc(Gs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ny(this,gs,{}),lc(Gs(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o,u=ca(this,Mo).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalRow(d)});ne(c,function(d){u[d]=!1}),l=Xr(u,function(d,v,p){return v&&d.push(a.hot.toVisualRow(p)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",o,l,s&&f);h!==!1&&(s&&f&&ca(this,Mo).setValues(u),this.hot.runHooks("afterUnhideRows",o,l,s&&f,s&&l.length<o.length))}},{key:"showRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showRows(a)}},{key:"hideRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideRows",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ne(i,function(f){ca(a,Mo).setValueAtIndex(a.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",o,l,s,s&&l.length>o.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideRows(a)}},{key:"getHiddenRows",value:function(){var i=this;return Rt(ca(this,Mo).getHiddenIndexes(),function(a){return i.hot.toVisualRow(a)})}},{key:"isHidden",value:function(i){return ca(this,Mo).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ne(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,a){return this.isHidden(a)?0:i}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(ca(this,gs).copyPasteEnabled===!1&&this.isHidden(i)&&(o.skipRowOnPaste=!0),this.isHidden(i-1))o.className=o.className||"",o.className.indexOf("afterHiddenRow")===-1&&(o.className+=" afterHiddenRow");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(ca(this,gs).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ne(i,function(l){var u=!0,f=0;rt(l.startRow,l.endRow,function(c){a.isHidden(c)?(u||s(f,c-1,l.startCol,l.endCol),u=!0):(u&&(f=c),c===l.endRow&&s(f,c,l.startCol,l.endCol),u=!1)})}),o}},{key:"onAfterGetRowHeader",value:function(i,a){if(!(!ca(this,gs).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&o.push("beforeHiddenRow"),ke(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:Dt},Iyt(this),Lyt(this))}},{key:"onMapInit",value:function(){Array.isArray(ca(this,gs).rows)&&this.hideRows(ca(this,gs).rows)}},{key:"destroy",value:function(){Ny(this,gs,null),Ny(this,Mo,null),lc(Gs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yP}},{key:"PLUGIN_PRIORITY",get:function(){return qyt}}]),r}(tr);function Jyt(e,t){return rmt(e)||tmt(e,t)||emt(e,t)||Qyt()}function Qyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function emt(e,t){if(e){if(typeof e=="string")return uK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uK(e,t)}}function uK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tmt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function rmt(e){if(Array.isArray(e))return e}function nmt(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(eB)},callback:function(r,n){var i=Jyt(n,1),a=i[0].start.col;e.freezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function imt(e,t){return lmt(e)||smt(e,t)||omt(e,t)||amt()}function amt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function omt(e,t){if(e){if(typeof e=="string")return fK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fK(e,t)}}function fK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function smt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function lmt(e){if(Array.isArray(e))return e}function umt(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(tB)},callback:function(r,n){var i=imt(n,1),a=i[0].start.col;e.unfreezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Wp(e){return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(e)}function fmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hmt(n.key),n)}}function cmt(e,t,r){return t&&cK(e.prototype,t),r&&cK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hmt(e){var t=dmt(e,"string");return Wp(t)==="symbol"?t:String(t)}function dmt(e,t){if(Wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qd(){return typeof Reflect<"u"&&Reflect.get?qd=Reflect.get.bind():qd=function(t,r,n){var i=vmt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},qd.apply(this,arguments)}function vmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Tu(e),e!==null););return e}function pmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T$(e,t)}function T$(e,t){return T$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},T$(e,t)}function gmt(e){var t=mmt();return function(){var n=Tu(e),i;if(t){var a=Tu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ymt(this,i)}}function ymt(e,t){if(t&&(Wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ule(e)}function Ule(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tu(e){return Tu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tu(e)}Je.getSingleton().register("beforeColumnFreeze");Je.getSingleton().register("afterColumnFreeze");Je.getSingleton().register("beforeColumnUnfreeze");Je.getSingleton().register("afterColumnUnfreeze");var hK="manualColumnFreeze",bmt=110,Ly=new WeakMap,wmt=function(e){pmt(r,e);var t=gmt(r);function r(n){var i;return fmt(this,r),i=t.call(this,n),Ly.set(Ule(i),{afterFirstUse:!1}),i}return cmt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hK]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.addContextMenuEntry(a)}),this.addHook("beforeColumnMove",function(a,o){return i.onBeforeColumnMove(a,o)}),qd(Tu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=Ly.get(this);i.afterFirstUse=!1,qd(Tu(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),qd(Tu(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var a=Ly.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart<this.hot.countCols()&&i>o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",i,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart),o._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,s))}},{key:"unfreezeColumn",value:function(i){var a=Ly.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart>0&&i<=o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",i,s);l!==!1&&(s&&(o._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,s))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},nmt(this),umt(this))}},{key:"onBeforeColumnMove",value:function(i,a){var o=Ly.get(this);if(o.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(a<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return hK}},{key:"PLUGIN_PRIORITY",get:function(){return bmt}}]),r}(tr);function tw(e){return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}function _mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cmt(n.key),n)}}function Smt(e,t,r){return t&&dK(e.prototype,t),r&&dK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cmt(e){var t=xmt(e,"string");return tw(t)==="symbol"?t:String(t)}function xmt(e,t){if(tw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mP=0,vK=1,pK=2,sd="px",Tmt=function(){function e(t){_mt(this,e),this.hot=t,this._element=null,this.state=mP,this.inlineProperty=t.isRtl()?"right":"left"}return Smt(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=pK}},{key:"build",value:function(){this.state===mP&&(this._element=this.hot.rootDocument.createElement("div"),this.state=vK)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=mP}},{key:"isAppended",value:function(){return this.state===pK}},{key:"isBuilt",value:function(){return this.state>=vK}},{key:"setPosition",value:function(r,n){Ki(r)&&(this._element.style.top=r+sd),Ki(n)&&(this._element.style[this.inlineProperty]=n+sd)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Ki(r)&&(this._element.style.width=r+sd),Ki(n)&&(this._element.style.height=n+sd)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Ki(r)&&(this._element.style.marginTop=r+sd),Ki(n)&&(this._element.style["margin".concat($i(this.inlineProperty))]=n+sd)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat($i(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const zle=Tmt;function Up(e){return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Up(e)}function Omt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rmt(n.key),n)}}function Emt(e,t,r){return t&&gK(e.prototype,t),r&&gK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rmt(e){var t=kmt(e,"string");return Up(t)==="symbol"?t:String(t)}function kmt(e,t){if(Up(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DC(){return typeof Reflect<"u"&&Reflect.get?DC=Reflect.get.bind():DC=function(t,r,n){var i=Amt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},DC.apply(this,arguments)}function Amt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zp(e),e!==null););return e}function Pmt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O$(e,t)}function O$(e,t){return O$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},O$(e,t)}function Imt(e){var t=$mt();return function(){var n=zp(e),i;if(t){var a=zp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Mmt(this,i)}}function Mmt(e,t){if(t&&(Up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dmt(e)}function Dmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $mt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zp(e){return zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zp(e)}var Nmt="ht__manualColumnMove--backlight",Lmt=function(e){Pmt(r,e);var t=Imt(r);function r(){return Omt(this,r),t.apply(this,arguments)}return Emt(r,[{key:"build",value:function(){DC(zp(r.prototype),"build",this).call(this),ke(this._element,Nmt)}}]),r}(zle);const Fmt=Lmt;function Gp(e){return Gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gp(e)}function Hmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vmt(n.key),n)}}function Bmt(e,t,r){return t&&yK(e.prototype,t),r&&yK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vmt(e){var t=jmt(e,"string");return Gp(t)==="symbol"?t:String(t)}function jmt(e,t){if(Gp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $C(){return typeof Reflect<"u"&&Reflect.get?$C=Reflect.get.bind():$C=function(t,r,n){var i=Wmt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},$C.apply(this,arguments)}function Wmt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yp(e),e!==null););return e}function Umt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E$(e,t)}function E$(e,t){return E$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},E$(e,t)}function zmt(e){var t=Kmt();return function(){var n=Yp(e),i;if(t){var a=Yp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Gmt(this,i)}}function Gmt(e,t){if(t&&(Gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ymt(e)}function Ymt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kmt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yp(e){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yp(e)}var Xmt="ht__manualColumnMove--guideline",qmt=function(e){Umt(r,e);var t=zmt(r);function r(){return Hmt(this,r),t.apply(this,arguments)}return Bmt(r,[{key:"build",value:function(){$C(Yp(r.prototype),"build",this).call(this),ke(this._element,Xmt)}}]),r}(zle);const Zmt=qmt;function Kp(e){return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kp(e)}function Jmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e0t(n.key),n)}}function Qmt(e,t,r){return t&&mK(e.prototype,t),r&&mK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e0t(e){var t=t0t(e,"string");return Kp(t)==="symbol"?t:String(t)}function t0t(e,t){if(Kp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uc(){return typeof Reflect<"u"&&Reflect.get?uc=Reflect.get.bind():uc=function(t,r,n){var i=r0t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},uc.apply(this,arguments)}function r0t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ys(e),e!==null););return e}function n0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R$(e,t)}function R$(e,t){return R$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},R$(e,t)}function i0t(e){var t=o0t();return function(){var n=Ys(e),i;if(t){var a=Ys(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return a0t(this,i)}}function a0t(e,t){if(t&&(Kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k$(e)}function k$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ys(e){return Ys=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ys(e)}Je.getSingleton().register("beforeColumnMove");Je.getSingleton().register("afterColumnMove");var bP="manualColumnMove",s0t=120,Vl=new WeakMap,bK="ht__manualColumnMove",b1="show-ui",wP="on-moving--columns",_P="after-selection--columns",l0t=function(e){n0t(r,e);var t=i0t(r);function r(n){var i;return Jmt(this,r),i=t.call(this,n),Vl.set(k$(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new Nr(k$(i)),i.backlight=new Fmt(n),i.guideline=new Zmt(n),i}return Qmt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bP]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),ke(this.hot.rootElement,bK),uc(Ys(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),uc(Ys(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){wt(this.hot.rootElement,bK),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),uc(Ys(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,a){return this.moveColumns([i],a)}},{key:"moveColumns",value:function(i,a){var o=Vl.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeColumnMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,a);var f=l&&this.isColumnOrderChanged(i,a);return this.hot.runHooks("afterColumnMove",i,a,s,l,f),f}}},{key:"dragColumn",value:function(i,a){return this.dragColumns([i],a)}},{key:"dragColumns",value:function(i,a){var o=this.countFinalIndex(i,a),s=Vl.get(this);return s.cachedDropIndex=a,this.moveColumns(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isColumnOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=Xr(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getColumnsWidth",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=0,l=i;l<=a;l+=1){var u=o.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[bP];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveColumns(a,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,a){var o=[];return rt(i,a,function(s){o.push(s)}),o}},{key:"refreshPositions",value:function(){var i=Vl.get(this),a=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&a>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1));var o=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),f=o.hider.offsetWidth,c=o.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,p=0;if(this.hot.isRtl()){var g=this.hot.rootWindow,y=fr(this.hot.rootElement),m=g.innerWidth-i.rootElementOffset-y;p=g.innerWidth-i.target.eventPageX-m-(s.scrollX===void 0?l:0)}else p=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=v,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=a>0?a-1:a;else if(i.target.TD.offsetWidth/2+u<=p){var b=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=b+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var _=p,x=u;p+d+h>=f?_=f-d-h:p+h<c+v&&(_=c+v+Math.abs(h)),u>=f-1?x=f-1:x===0?x=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(x-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,_),this.guideline.setPosition(null,x)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Vl.get(this),h=mt(i.target,"sortAction");if(!f||!u||c.pressed||i.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,wt(this.hot.rootElement,[wP,b1]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var p=f.from,g=f.to,y=Math.min(p.col,g.col),m=Math.max(p.col,g.col);if(a.row<0&&a.col>=y&&a.col<=m){s.column=!0,c.pressed=!0,c.target.eventPageX=i.pageX,c.target.eventOffsetX=i.offsetX,c.hoveredColumn=a.col,c.target.TD=o,c.target.col=a.col,c.columnsToMove=this.prepareColumnsToMoving(y,m),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=tn(this.hot.rootElement).left;var b=c.hasRowHeaders?-1:0,_=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,x=a.col<c.fixedColumnsStart,T=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),E=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),P=this.getColumnsWidth(y,a.col-1)+E,R=this.getColumnsWidth(b,y-1)+(x?T:0)+P;this.backlight.setPosition(_,R),this.backlight.setSize(this.getColumnsWidth(y,m),l.hider.offsetHeight-_),this.backlight.setOffset(null,-P),ke(this.hot.rootElement,wP)}else wt(this.hot.rootElement,_P),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=Vl.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(o)})}a.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=Vl.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(a.col)>-1?wt(this.hot.rootElement,b1):ke(this.hot.rootElement,b1),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=a.col,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=Vl.get(this),a=i.target.col,o=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,wt(this.hot.rootElement,[wP,b1,_P]),this.hot.selection.isSelectedByColumnHeader()&&ke(this.hot.rootElement,_P),!(o<1||a===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,a);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(l),c=f+o-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,a=i.getColumnHeaderHeight(0)+1,o=i.holder.scrollTop,s=a+o;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),uc(Ys(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bP}},{key:"PLUGIN_PRIORITY",get:function(){return s0t}}]),r}(tr);function Xp(e){return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(e)}function u0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c0t(n.key),n)}}function f0t(e,t,r){return t&&wK(e.prototype,t),r&&wK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c0t(e){var t=h0t(e,"string");return Xp(t)==="symbol"?t:String(t)}function h0t(e,t){if(Xp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fc(){return typeof Reflect<"u"&&Reflect.get?fc=Reflect.get.bind():fc=function(t,r,n){var i=d0t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},fc.apply(this,arguments)}function d0t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ks(e),e!==null););return e}function v0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A$(e,t)}function A$(e,t){return A$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},A$(e,t)}function p0t(e){var t=y0t();return function(){var n=Ks(e),i;if(t){var a=Ks(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return g0t(this,i)}}function g0t(e,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P$(e)}function P$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ks(e){return Ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ks(e)}var w1="manualColumnResize",m0t=130,_K="manualColumnWidths",SP=new WeakMap,b0t=function(e){v0t(r,e);var t=p0t(r);function r(n){var i;u0t(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new Nr(P$(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,SP.set(P$(i),{config:void 0}),ke(i.handle,"manualColumnResizer"),ke(i.guide,"manualColumnResizerGuide"),i}return f0t(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[w1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new zu,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(a,o){return i.onModifyColWidth(a,o)}),this.addHook("beforeStretchingColumnWidth",function(a,o){return i.onBeforeStretchingColumnWidth(a,o)}),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),this.bindEvents(),fc(Ks(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fc(Ks(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=SP.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),fc(Ks(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",_K,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",_K,i),i.value}},{key:"setManualSize",value:function(i,a){var o=Math.max(a,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,o),o}},{key:"clearManualSize",value:function(i){var a=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(a,null)}},{key:"onMapInit",value:function(){var i=this,a=SP.get(this),o=this.hot.getSettings()[w1],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(o)?(this.hot.batchExecution(function(){o.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0),a.config=o):o===!0&&Array.isArray(a.config)&&this.hot.batchExecution(function(){a.config.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var a=this;if(i.parentNode){this.currentTH=i;var o=this.hot.view._wt,s=o.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=$r(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=l<o.getSetting("fixedColumnsStart"),h;c&&(h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=o.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();ne(v,function(p){var g=p.getTopStartCorner().col,y=p.getBottomEndCorner().col;rt(g,y,function(m){a.selectedCols.includes(m)||a.selectedCols.push(m)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt($r(this.handle),10),a=parseInt(this.handle.style.top,10)+i,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ke(this.handle,"active"),ke(this.guide,"active"),this.guide.style.top="".concat(a,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){wt(this.handle,"active"),wt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!pu(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!uH(i.target)&&this.checkIfColumnHeader(i.target)){var a=this.getClosestTHParent(i.target);if(!a)return;var o=a.getAttribute("colspan");a&&(o===null||o==="1")&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeColumnResize",i.newSize,u,!0);c!==void 0&&(i.newSize=c),i.hot.getSettings().stretchH==="all"?i.clearManualSize(u):i.setManualSize(u,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(ne(this.selectedCols,function(l){o(l)}),a()):ne(this.selectedCols,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;mt(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var a=this;if(this.pressed){var o=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+o,ne(this.selectedCols,function(s){a.newSize=a.setManualSize(s,a.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeColumnResize",i.newSize,u,!1),f&&a(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(ne(this.selectedCols,function(l){o(l)}),a()):ne(this.selectedCols,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootWindow,s=a.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(o,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalColumn(a),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[w1]&&l&&(o=l)}return o}},{key:"onBeforeStretchingColumnWidth",value:function(i,a){var o=this.columnWidthsMap.getValueAtIndex(a);return o===null&&(o=i),o}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){fc(Ks(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return w1}},{key:"PLUGIN_PRIORITY",get:function(){return m0t}}]),r}(tr);function rw(e){return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(e)}function w0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S0t(n.key),n)}}function _0t(e,t,r){return t&&SK(e.prototype,t),r&&SK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S0t(e){var t=C0t(e,"string");return rw(t)==="symbol"?t:String(t)}function C0t(e,t){if(rw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CP=0,CK=1,xK=2,ld="px",x0t=function(){function e(t){w0t(this,e),this.hot=t,this._element=null,this.state=CP}return _0t(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=xK}},{key:"build",value:function(){this.state===CP&&(this._element=this.hot.rootDocument.createElement("div"),this.state=CK)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=CP}},{key:"isAppended",value:function(){return this.state===xK}},{key:"isBuilt",value:function(){return this.state>=CK}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+ld),n!==void 0&&(this._element.style.left=n+ld)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+ld),n&&(this._element.style.height=n+ld)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+ld),n&&(this._element.style.marginLeft=n+ld)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const Gle=x0t;function qp(e){return qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qp(e)}function T0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E0t(n.key),n)}}function O0t(e,t,r){return t&&TK(e.prototype,t),r&&TK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E0t(e){var t=R0t(e,"string");return qp(t)==="symbol"?t:String(t)}function R0t(e,t){if(qp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NC(){return typeof Reflect<"u"&&Reflect.get?NC=Reflect.get.bind():NC=function(t,r,n){var i=k0t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},NC.apply(this,arguments)}function k0t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zp(e),e!==null););return e}function A0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I$(e,t)}function I$(e,t){return I$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},I$(e,t)}function P0t(e){var t=D0t();return function(){var n=Zp(e),i;if(t){var a=Zp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return I0t(this,i)}}function I0t(e,t){if(t&&(qp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M0t(e)}function M0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zp(e){return Zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zp(e)}var $0t="ht__manualRowMove--backlight",N0t=function(e){A0t(r,e);var t=P0t(r);function r(){return T0t(this,r),t.apply(this,arguments)}return O0t(r,[{key:"build",value:function(){NC(Zp(r.prototype),"build",this).call(this),ke(this._element,$0t)}}]),r}(Gle);const L0t=N0t;function Jp(e){return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}function F0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B0t(n.key),n)}}function H0t(e,t,r){return t&&OK(e.prototype,t),r&&OK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B0t(e){var t=V0t(e,"string");return Jp(t)==="symbol"?t:String(t)}function V0t(e,t){if(Jp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LC(){return typeof Reflect<"u"&&Reflect.get?LC=Reflect.get.bind():LC=function(t,r,n){var i=j0t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},LC.apply(this,arguments)}function j0t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qp(e),e!==null););return e}function W0t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M$(e,t)}function M$(e,t){return M$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},M$(e,t)}function U0t(e){var t=Y0t();return function(){var n=Qp(e),i;if(t){var a=Qp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return z0t(this,i)}}function z0t(e,t){if(t&&(Jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G0t(e)}function G0t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y0t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qp(e)}var K0t="ht__manualRowMove--guideline",X0t=function(e){W0t(r,e);var t=U0t(r);function r(){return F0t(this,r),t.apply(this,arguments)}return H0t(r,[{key:"build",value:function(){LC(Qp(r.prototype),"build",this).call(this),ke(this._element,K0t)}}]),r}(Gle);const q0t=X0t;function eg(e){return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(e)}function Z0t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q0t(n.key),n)}}function J0t(e,t,r){return t&&EK(e.prototype,t),r&&EK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q0t(e){var t=ebt(e,"string");return eg(t)==="symbol"?t:String(t)}function ebt(e,t){if(eg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cc(){return typeof Reflect<"u"&&Reflect.get?cc=Reflect.get.bind():cc=function(t,r,n){var i=tbt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},cc.apply(this,arguments)}function tbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xs(e),e!==null););return e}function rbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D$(e,t)}function D$(e,t){return D$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},D$(e,t)}function nbt(e){var t=abt();return function(){var n=Xs(e),i;if(t){var a=Xs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ibt(this,i)}}function ibt(e,t){if(t&&(eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $$(e)}function $$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function abt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xs(e){return Xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xs(e)}Je.getSingleton().register("beforeRowMove");Je.getSingleton().register("afterRowMove");var xP="manualRowMove",obt=140,jl=new WeakMap,RK="ht__manualRowMove",_1="show-ui",TP="on-moving--rows",OP="after-selection--rows",sbt=function(e){rbt(r,e);var t=nbt(r);function r(n){var i;return Z0t(this,r),i=t.call(this,n),jl.set($$(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new Nr($$(i)),i.backlight=new L0t(n),i.guideline=new q0t(n),i}return J0t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xP]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),ke(this.hot.rootElement,RK),cc(Xs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),cc(Xs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){wt(this.hot.rootElement,RK),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),cc(Xs(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,a){return this.moveRows([i],a)}},{key:"moveRows",value:function(i,a){var o=jl.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeRowMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,a);var f=l&&this.isRowOrderChanged(i,a);return this.hot.runHooks("afterRowMove",i,a,s,l,f),f}}},{key:"dragRow",value:function(i,a){return this.dragRows([i],a)}},{key:"dragRows",value:function(i,a){var o=this.countFinalIndex(i,a),s=jl.get(this);return s.cachedDropIndex=a,this.moveRows(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isRowOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=Xr(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getRowsHeight",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=0,l=i;l<=a;l++){var u=o.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[xP];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveRows(a,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),a=[];if(!i)return a;var o=i.from,s=i.to,l=Math.min(o.row,s.row),u=Math.max(o.row,s.row);return rt(l,u,function(f){a.push(f)}),a}},{key:"refreshPositions",value:function(){var i=jl.get(this),a=i.target.coords,o=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(a.row)&&o>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1)),this.isFixedRowBottom(a.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=i.target.TD,c=tn(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,a.row-1),d=i.target.eventPageY-c.top+u.holder.scrollTop,v=u.hider.offsetHeight,p=u.TBODY.offsetTop,g=this.backlight.getOffset().top,y=this.backlight.getSize().height;this.isFixedRowTop(a.row)&&(h+=u.holder.scrollTop),a.row<0?i.target.row=o>0?o-1:o:f.offsetHeight/2+h<=d?(i.target.row=a.row+1,h+=a.row===0?f.offsetHeight-1:f.offsetHeight):i.target.row=a.row;var m=d,b=h;d+y+g>=v?m=v-y-g:d+g<p&&(m=p+Math.abs(g)),h>=v-1&&(b=v-1),this.backlight.setPosition(m),this.guideline.setPosition(b)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt,u=l.wtTable,f=l.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=jl.get(this);if(!h||!c||d.pressed||i.button!==0){d.pressed=!1,d.rowsToMove.length=0,wt(this.hot.rootElement,[TP,_1]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&p&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var g=h.from,y=h.to,m=Math.min(g.row,y.row),b=Math.max(g.row,y.row);if(a.col<0&&a.row>=m&&a.row<=b){s.row=!0,d.pressed=!0,d.target.eventPageY=i.pageY,d.target.coords=a,d.target.TD=o,d.rowsToMove=this.prepareRowsToMoving();var _=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,_),this.backlight.setSize(u.hider.offsetWidth-_,this.getRowsHeight(m,b)),this.backlight.setOffset((this.getRowsHeight(m,a.row-1)+i.offsetY)*-1,null),ke(this.hot.rootElement,TP),this.refreshPositions()}else wt(this.hot.rootElement,OP),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=jl.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,o)})}a.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=jl.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(a.row)>-1?wt(this.hot.rootElement,_1):ke(this.hot.rootElement,_1),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=a,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=jl.get(this),a=i.target.row,o=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,wt(this.hot.rootElement,[TP,_1,OP]),this.hot.selection.isSelectedByRowHeader()&&ke(this.hot.rootElement,OP),!(o<1||a===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(i.rowsToMove,a);if(i.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(l),c=f+o-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=i.holder.scrollLeft,s=a+o;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),cc(Xs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xP}},{key:"PLUGIN_PRIORITY",get:function(){return obt}}]),r}(tr);function tg(e){return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tg(e)}function lbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fbt(n.key),n)}}function ubt(e,t,r){return t&&kK(e.prototype,t),r&&kK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fbt(e){var t=cbt(e,"string");return tg(t)==="symbol"?t:String(t)}function cbt(e,t){if(tg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hc(){return typeof Reflect<"u"&&Reflect.get?hc=Reflect.get.bind():hc=function(t,r,n){var i=hbt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},hc.apply(this,arguments)}function hbt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qs(e),e!==null););return e}function dbt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N$(e,t)}function N$(e,t){return N$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},N$(e,t)}function vbt(e){var t=gbt();return function(){var n=qs(e),i;if(t){var a=qs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pbt(this,i)}}function pbt(e,t){if(t&&(tg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L$(e)}function L$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gbt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qs(e){return qs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qs(e)}var S1="manualRowResize",ybt=30,AK="manualRowHeights",EP=new WeakMap,mbt=function(e){dbt(r,e);var t=vbt(r);function r(n){var i;lbt(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new Nr(L$(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,EP.set(L$(i),{config:void 0}),ke(i.handle,"manualRowResizer"),ke(i.guide,"manualRowResizerGuide"),i}return ubt(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[S1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new zu,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(a,o){return i.onModifyRowHeight(a,o)}),this.bindEvents(),hc(qs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),hc(qs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=EP.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),hc(qs(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",AK,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",AK,i),i.value}},{key:"setManualSize",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=Math.max(a,Cae.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(o,s),s}},{key:"setupHandlePosition",value:function(i){var a=this;this.currentTH=i;var o=this.hot.view,s=o._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var f=fr(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=o.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),v;h?v=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(v=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),v||(v=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){var g=this.hot.getSelectedRange();ne(g,function(y){var m=y.getTopStartCorner().row,b=y.getBottomStartCorner().row;rt(m,b,function(_){a.selectedRows.includes(_)||a.selectedRows.push(_)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(fr(this.handle),10),a=parseInt(this.handle.style[this.inlineDir],10)+i,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ke(this.handle,"active"),ke(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(a,"px"),this.guide.style.width="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){wt(this.handle,"active"),wt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var a,o,s=pu(i,["TH"],this.hot.rootElement);return s&&((a=i.parentNode)===null||a===void 0||(o=a.parentNode)===null||o===void 0?void 0:o.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var a=this.hot.view._wt.wtTable.getRowHeight(i);return a!==void 0&&this.newSize<a?a:this.newSize}},{key:"onMouseOver",value:function(i){if(!uH(i.target)&&this.checkIfRowHeader(i.target)){var a=this.getClosestTHParent(i.target);a&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!0);c!==void 0&&(i.newSize=c),i.setManualSize(u,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(ne(this.selectedRows,function(l){o(l)}),a()):ne(this.selectedRows,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;mt(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var a=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),ne(this.selectedRows,function(o){a.newSize=a.setManualSize(o,a.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!1),f&&a(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(ne(this.selectedRows,function(l){o(l)}),a()):ne(this.selectedRows,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootElement,s=a.rootWindow;this.eventManager.addEventListener(o,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(o,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalRow(a),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[S1]&&l&&(o=l)}return o}},{key:"onMapInit",value:function(){var i=this,a=EP.get(this),o=this.hot.getSettings()[S1],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(o)?(o.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}),a.config=o):o===!0&&Array.isArray(a.config)&&a.config.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){hc(qs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return S1}},{key:"PLUGIN_PRIORITY",get:function(){return ybt}}]),r}(tr);function nw(e){return nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nw(e)}var PK,IK,MK,DK;function C1(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_bt(n.key),n)}}function wbt(e,t,r){return t&&$K(e.prototype,t),r&&$K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _bt(e){var t=Sbt(e,"string");return nw(t)==="symbol"?t:String(t)}function Sbt(e,t){if(nw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cbt=function(){function e(t,r,n,i,a,o){bbt(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=a,this.cellRangeFactory=o}return wbt(e,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],a=n+Math.abs(r[0]||r[1])-1,o=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,a),u=Math.max(n,a),f=this[s],c=this[s]+this[o]-1;if(f>=n&&(this[s]+=i),i>0)n<=c&&n>f&&(this[o]+=i);else if(i<0){if(l<=f&&u>=c)return this.removed=!0,!1;if(f>=l&&f<=u){var h=u-f+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(f<=l&&c>=u)this[o]+=i;else if(f<=l&&c>=l&&c<u){var v=c-l+1;this[o]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return sr(PK||(PK=C1(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return sr(IK||(IK=C1(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return sr(MK||(MK=C1(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return sr(DK||(DK=C1(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),e}();const Fo=Cbt;function F$(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function iw(e){return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}var NK;function xbt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function LK(e){return Rbt(e)||Ebt(e)||Obt(e)||Tbt()}function Tbt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Obt(e,t){if(e){if(typeof e=="string")return H$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H$(e,t)}}function Ebt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rbt(e){if(Array.isArray(e))return H$(e)}function H$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pbt(n.key),n)}}function Abt(e,t,r){return t&&FK(e.prototype,t),r&&FK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pbt(e){var t=Ibt(e,"string");return iw(t)==="symbol"?t:String(t)}function Ibt(e,t){if(iw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(iw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mbt=function(){function e(t){kbt(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return Abt(e,[{key:"get",value:function(r,n){var i=this.mergedCells,a=!1;return ne(i,function(o){return o.row<=r&&o.row+o.rowspan-1>=r&&o.col<=n&&o.col+o.colspan-1>=n?(a=o,!1):!0}),a}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return ne(n,function(a){return a.row<=r.from.row&&a.row+a.rowspan-1>=r.to.row&&a.col<=r.from.col&&a.col+a.colspan-1>=r.to.col?(i=a,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCells,o=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return ne(a,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);i?s.overlaps(d)&&o.push(f):s.includesRange(d)&&o.push(f)}),o.length?o:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,a=r.col,o=r.rowspan,s=r.colspan,l=new Fo(i,a,o,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(i,a),f=this.isOverlapping(l);return!u&&!f?(this.hot&&l.normalize(this.hot),n.push(l),l):(gr(e.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,a=this.get(r,n),o=a?this.mergedCells.indexOf(a):-1;return a&&o!==-1?(i.splice(o,1),a):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],a=[];ne(n,function(o){var s=r.hot.getCell(o.row,o.col);s&&i.push([s,r.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,ne(i,function(o,s){rt(0,o.rowspan-1,function(l){rt(0,o.colspan-1,function(u){if(u!==0||l!==0){var f=r.hot.getCell(o.row+l,o.col+u);f&&a.push([f,null,null,null])}})}),i[s][1]=null}),ne(i,function(o){F$.apply(void 0,LK(o))}),ne(a,function(o){F$.apply(void 0,LK(o))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),a=!1;return ne(this.mergedCells,function(o){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(o.row,o.col),n.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1));return s.overlaps(i)?(a=!0,!1):!0}),a}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var a=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(a,o)}},{key:"shiftCollections",value:function(r,n,i){var a=this,o=[0,0];switch(r){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break}ne(this.mergedCells,function(s){s.shift(o,n)}),Nx(this.mergedCells.length-1,0,function(s){var l=a.mergedCells[s];l&&l.removed&&a.mergedCells.splice(a.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return sr(NK||(NK=xbt(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const Dbt=Mbt;function aw(e){return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(e)}function Pf(e,t){return Fbt(e)||Lbt(e,t)||Nbt(e,t)||$bt()}function $bt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nbt(e,t){if(e){if(typeof e=="string")return HK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HK(e,t)}}function HK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lbt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Fbt(e){if(Array.isArray(e))return e}function Hbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vbt(n.key),n)}}function Bbt(e,t,r){return t&&BK(e.prototype,t),r&&BK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vbt(e){var t=jbt(e,"string");return aw(t)==="symbol"?t:String(t)}function jbt(e,t){if(aw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(aw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wbt=function(){function e(t){Hbt(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return Bbt(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,a){var o=n.slice(0),s=this.getAutofillSize(r,n,i),l=Pf(r,4),u=l[0],f=l[1],c=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,v=d?c-u+1:h-f+1,p=Math.floor(s/v)*v,g=s-p,y=this.getFarthestCollection(r,n,i,a);if(y){if(i==="down"){var m=y.row+y.rowspan-u-g,b=o[2]+m;b>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?m:0}else if(i==="right"){var _=y.col+y.colspan-f-g,x=o[3]+_;x>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?_:0}else if(i==="up"){var T=c-g-y.row+1,E=o[0]+T;E<0?o[0]+=g:o[0]-=g?T:0}else if(i==="left"){var P=h-g-y.col+1,R=o[1]+P;R<0?o[1]+=g:o[1]-=g?P:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:a,fillSize:s,dragArea:o,cycleLength:v}),o}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),nn(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var a=Pf(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=Pf(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return o-c;case"down":return d-l;case"left":return s-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,i){var a=Pf(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=Pf(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return[c,h,o-1,u];case"down":return[l+1,s,d,u];case"left":return[c,h,l,s-1];case"right":return[o,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,a){var o=Pf(r,4),s=o[0],l=o[1],u=o[2],f=o[3],c=["up","down"].indexOf(i)>-1,h=c?u:f,d=c?s:l,v=this.getAutofillSize(r,n,i),p=c?u-s+1:f-l+1,g=Math.floor(v/p)*p,y=v-g,m=null,b=null,_=null;switch(i){case"up":m="includesVertically",_=h-y+1;break;case"left":m="includesHorizontally",_=h-y+1;break;case"down":m="includesVertically",_=d+y-1;break;case"right":m="includesHorizontally",_=d+y-1;break}return ne(a,function(x){x[m](_)&&x.isFarther(b,i)&&(b=x)}),b}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,a=this.currentFillData.dragDirection,o=function(h,d){switch(a){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var f=0;f<i.length;f+=1){if(l=i[f],s=u*this.currentFillData.cycleLength,o(l,s))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}f===i.length-1&&(u+=1)}while(o(l,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},a={min:null,max:null};return ne(r,function(o){var s=o[0],l=n.plugin.hot.propToCol(o[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(a.min===null||l<a.min)&&(a.min=l),(a.max===null||l>a.max)&&(a.max=l)}),{from:{row:i.min,column:a.min},to:{row:i.max,column:a.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var a=this.getDragArea(r,n,i),o=Pf(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.plugin.hot._createCellCoords(s,l),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const Ubt=Wbt;function ow(e){return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(e)}function zbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ybt(n.key),n)}}function Gbt(e,t,r){return t&&VK(e.prototype,t),r&&VK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ybt(e){var t=Kbt(e,"string");return ow(t)==="symbol"?t:String(t)}function Kbt(e,t){if(ow(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ow(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xbt=function(){function e(t){zbt(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return Gbt(e,[{key:"snapDelta",value:function(r,n,i){var a=n.to,o=a.row+r.row,s=a.col+r.col;r.row?this.jumpOverMergedCell(r,i,o):r.col&&this.jumpOverMergedCell(r,i,s)}},{key:"jumpOverMergedCell",value:function(r,n,i){var a=r.row||r.col,o=null,s=null,l=null;r.row?(o=n.includesVertically(i),s=n.row,l=n.getLastRow()):r.col&&(o=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),a!==0&&(a>0?o&&i!==s&&(a+=l-i+1):o&&i!==l&&(a-=i-s+1),r.row?r.row=a:r.col&&(r.col=a))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,a){var o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(a!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=o<=c.row&&s<=c.col&&l>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(a);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var a=0;a<r.rowspan;a+=1)for(var o=0;o<r.colspan;o+=1)i.push(this.hot._createCellCoords(r.row+a,r.col+o));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const qbt=Xbt;function Zbt(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(nB)}return this.getTranslatedPhrase(rB)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Fo.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function rg(e){return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(e)}function Jbt(e,t){return twt(e)||ewt(e,t)||Yle(e,t)||Qbt()}function Qbt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ewt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function twt(e){if(Array.isArray(e))return e}function rwt(e){return awt(e)||iwt(e)||Yle(e)||nwt()}function nwt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yle(e,t){if(e){if(typeof e=="string")return B$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B$(e,t)}}function iwt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function awt(e){if(Array.isArray(e))return B$(e)}function B$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function owt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lwt(n.key),n)}}function swt(e,t,r){return t&&jK(e.prototype,t),r&&jK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lwt(e){var t=uwt(e,"string");return rg(t)==="symbol"?t:String(t)}function uwt(e,t){if(rg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zd(){return typeof Reflect<"u"&&Reflect.get?Zd=Reflect.get.bind():Zd=function(t,r,n){var i=fwt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Zd.apply(this,arguments)}function fwt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ou(e),e!==null););return e}function cwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V$(e,t)}function V$(e,t){return V$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},V$(e,t)}function hwt(e){var t=vwt();return function(){var n=Ou(e),i;if(t){var a=Ou(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dwt(this,i)}}function dwt(e,t){if(t&&(rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kle(e)}function Kle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vwt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ou(e){return Ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ou(e)}Je.getSingleton().register("beforeMergeCells");Je.getSingleton().register("afterMergeCells");Je.getSingleton().register("beforeUnmergeCells");Je.getSingleton().register("afterUnmergeCells");var tm="mergeCells",pwt=150,WK=new WeakMap,UK=tm,gwt=function(e){cwt(r,e);var t=hwt(r);function r(n){var i;return owt(this,r),i=t.call(this,n),WK.set(Kle(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return swt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tm]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new Dbt(this),this.autofillCalculations=new Ubt(this),this.selectionCalculations=new qbt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(a,o){if(o==="MergeCells")return!1}),this.registerShortcuts(),Zd(Ou(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Zd(Ou(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[tm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),Zd(Ou(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if($F()){var a=[],o=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,f=l+1;f<l+u;f++)o.push(f)}),o=rwt(new Set(o)),o.forEach(function(s){var l=i.hot.rowIndexMapper.getRenderableFromVisualIndex(s);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(l);f&&(f.style.background=pv(f,"backgroundColor").replace(")",", 0.99)"),a.push(f))})}),this.hot._registerTimeout(function(){a.forEach(function(s){s.style.background=pv(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var a=!0;return i?(Fo.containsNegativeValues(i)?(gr(Fo.NEGATIVE_VALUES_WARNING(i)),a=!1):Fo.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(gr(Fo.IS_OUT_OF_BOUNDS_WARNING(i)),a=!1):Fo.isSingleCell(i)?(gr(Fo.IS_SINGLE_CELL(i)),a=!1):Fo.containsZeroSpan(i)&&(gr(Fo.ZERO_SPAN_WARNING(i)),a=!1),a):!1}},{key:"generateFromSettings",value:function(i){var a=this;if(Array.isArray(i)){var o=[];if(ne(i,function(s){if(a.validateSetting(s)){var l=a.hot._createCellCoords(s.row,s.col),u=a.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),f=a.hot._createCellRange(l,l,u);a.mergeRange(f,!0,!0),rt(s.row,s.row+s.rowspan-1,function(c){rt(s.col,s.col+s.colspan-1,function(h){c===s.row&&h===s.col||o.push([c,h,null])})})}}),o.length===0)return;this.hot.setDataAtCell(o)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return a?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.toggleMerge(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){var a=i.from,o=i.to;this.unmergeRange(i,!0),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopStartCorner(),u=i.getBottomEndCorner(),f={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},c=[],h=null;if(!this.canMergeRange(f,o))return!1;this.hot.runHooks("beforeMergeCells",i,o),rt(0,f.rowspan-1,function(v){rt(0,f.colspan-1,function(p){var g=null;c[v]||(c[v]=[]),v===0&&p===0?g=a.hot.getSourceDataAtCell(a.hot.toPhysicalRow(f.row),a.hot.toPhysicalColumn(f.col)):a.hot.setCellMeta(f.row+v,f.col+p,"hidden",!0),c[v][p]=g})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(s?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),o||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,f,o),h):!0}},{key:"unmergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);s&&(this.hot.runHooks("beforeUnmergeCells",i,o),ne(s,function(l){a.mergedCellsCollection.remove(l.row,l.col),rt(0,l.rowspan-1,function(u){rt(0,l.colspan-1,function(f){a.hot.removeCellMeta(l.row+u,l.col+f,"hidden")})}),a.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,o),this.hot.render())}},{key:"toggleMerge",value:function(i){var a=this.mergedCellsCollection.get(i.from.row,i.from.col),o=a.row===i.from.row&&a.col===i.from.col&&a.row+a.rowspan-1===i.to.row&&a.col+a.colspan-1===i.to.col;o?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[tm]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("grid");o.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(l){return!l.altKey},group:UK})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("grid");a.removeShortcutsByGroup(UK)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var a=this.mergedCellsCollection.mergedCells,o=this.hot.getSelectedRangeLast(),s=0;s<a.length;s+=1)if(o.from.row===a[s].row&&o.from.col===a[s].col&&o.to.row===a[s].row+a[s].rowspan-1&&o.to.col===a[s].col+a[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var a=WK.get(this),o=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,u=this.hot._createCellCoords(o.highlight.row,o.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(a.lastDesiredCoords||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(a.lastDesiredCoords)||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=a.lastDesiredCoords.row?a.lastDesiredCoords.row-u.row:s.row,s.col=a.lastDesiredCoords.col?a.lastDesiredCoords.col-u.col:s.col,i.row>0?s.row=f.row+f.rowspan-1-u.row+i.row:i.row<0&&(s.row=u.row-f.row+i.row),i.col>0?s.col=f.col+f.colspan-1-u.col+i.col:i.col<0&&(s.col=u.col-f.col+i.col)}l=this.hot._createCellCoords(o.highlight.row+s.row,o.highlight.col+s.col);var v=this.mergedCellsCollection.get(l.row,l.col);if(v){var p=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);a.lastDesiredCoords=l,s={row:p.row-u.row,col:p.col-u.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var a=this,o=this.hot.getSelectedRangeLast(),s=vi(i),l=this.selectionCalculations.getUpdatedSelectionRange(o,i),u=vi(s),f=this.mergedCellsCollection.getWithinRange(l,!0);do u=vi(s),this.selectionCalculations.getUpdatedSelectionRange(o,s),ne(f,function(c){a.selectionCalculations.snapDelta(s,o,c)});while(s.row!==u.row||s.col!==u.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,a){if(!(i<0||a<0)){var o=this.mergedCellsCollection.get(i,a);if(o){var s=o.row,l=o.col,u=o.colspan,f=o.rowspan;return[s,l,s+f-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},Zbt(this))}},{key:"onAfterRenderer",value:function(i,a,o){var s=this.mergedCellsCollection.get(a,o),l=kt(s)?vi(s):void 0;if(kt(l)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=l.row,d=l.col,v=l.colspan,p=l.rowspan,g=this.translateMergedCellToRenderable(h,p,d,v),y=Jbt(g,2),m=y[0],b=y[1],_=f.getRenderableFromVisualIndex(a),x=c.getRenderableFromVisualIndex(o),T=m-_+1,E=b-x+1;l.row=f.getNearestNotHiddenIndex(l.row,1),l.col=c.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,T),l.colspan=Math.min(l.colspan,E)}F$(i,l,a,o)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var a=this.mergedCellsCollection.get(i.row,i.col),o=[a.row,a.col];i.row=o[0],i.col=o[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var a=this.hot.getSelectedRangeLast();a.highlight=this.hot._createCellCoords(a.highlight.row,a.highlight.col),a.to=i;var o=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{o=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();a.expandByRange(u)&&(i.row=a.to.row,i.col=a.to.col,o=!0)}}while(o)}},{key:"onAfterGetCellMeta",value:function(i,a,o){var s=this.mergedCellsCollection.get(i,a);s&&(s.row!==i||s.col!==a?o.copyable=!1:(o.rowspan=s.rowspan,o.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var a=this.hot.countCols();this.modifyViewportRowStart(i,a),this.modifyViewportRowEnd(i,a)}},{key:"modifyViewportRowStart",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.startRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(kt(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.row,1));if(f<i.startRow){i.startRow=f,this.modifyViewportRowStart(i,a);return}}}}},{key:"modifyViewportRowEnd",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.endRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(kt(u)){var f=u.row+u.rowspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endRow){i.endRow=c,this.modifyViewportRowEnd(i,a);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var a=this.hot.countRows();this.modifyViewportColumnStart(i,a),this.modifyViewportColumnEnd(i,a)}},{key:"modifyViewportColumnStart",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.startColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(kt(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.col,1));if(f<i.startColumn){i.startColumn=f,this.modifyViewportColumnStart(i,a);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.endColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(kt(u)){var f=u.col+u.colspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endColumn){i.endColumn=c,this.modifyViewportColumnEnd(i,a);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,a,o,s){var l=this.hot,u=l.rowIndexMapper,f=l.columnIndexMapper,c,h;a===0?c=u.getNearestNotHiddenIndex(i,1):c=u.getNearestNotHiddenIndex(i+a-1,-1),s===0?h=f.getNearestNotHiddenIndex(o,1):h=f.getNearestNotHiddenIndex(o+s-1,-1);var d=i>=0?u.getRenderableFromVisualIndex(c):i,v=o>=0?f.getRenderableFromVisualIndex(h):o;return[d,v]}},{key:"onModifyAutofillRange",value:function(i,a){this.autofillCalculations.correctSelectionAreaSize(a);var o=this.autofillCalculations.getDirection(a,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(a,s,o))return s=a,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:a[0],col:a[1]},to:{row:a[2],col:a[3]}});return l&&(s=this.autofillCalculations.snapDragArea(a,s,o,l)),s}},{key:"onAfterCreateCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("right",i,a)}},{key:"onAfterRemoveCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("left",i,a)}},{key:"onAfterCreateRow",value:function(i,a,o){o!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,a)}},{key:"onAfterRemoveRow",value:function(i,a){this.mergedCellsCollection.shiftCollections("up",i,a)}},{key:"onAfterChange",value:function(i,a){a==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,a){if(a&&a==="area"){var o=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(o);ne(s,function(l){o.getBottomEndCorner().row===l.getLastRow()&&o.getBottomEndCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,a,o){if(this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(s){var l=a>0,u=a<0,f=o<0,c=o>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,v=s.col+s.colspan-1===this.hot.countCols()-1,p=s.col===0;(l&&h||u&&d||c&&v||f&&p)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,a,o,s){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(i,a,o,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return tm}},{key:"PLUGIN_PRIORITY",get:function(){return pwt}}]),r}(tr);function zK(e){return wwt(e)||bwt(e)||mwt(e)||ywt()}function ywt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mwt(e,t){if(e){if(typeof e=="string")return GK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GK(e,t)}}function GK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bwt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wwt(e){if(Array.isArray(e))return e}function _wt(e,t){return function(r,n){var i=zK(r),a=i.slice(1),o=zK(n),s=o.slice(1);return function l(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.multiColumnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:Ise(c.type),g=p(f,c,v)(h,d);if(g===qo){var y=u+1;if(typeof t[y]<"u")return l(y)}return g}(0)}}var YK;function Swt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function KK(){gr(sr(YK||(YK=Swt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Xle="sort";function Cwt(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(Xle,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function xwt(e){var t=e.className.split(" "),r=new RegExp("^".concat(Xle,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function ng(e){return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ng(e)}function Twt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ewt(n.key),n)}}function Owt(e,t,r){return t&&XK(e.prototype,t),r&&XK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ewt(e){var t=Rwt(e,"string");return ng(t)==="symbol"?t:String(t)}function Rwt(e,t){if(ng(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ng(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zi(){return typeof Reflect<"u"&&Reflect.get?zi=Reflect.get.bind():zi=function(t,r,n){var i=kwt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},zi.apply(this,arguments)}function kwt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=si(e),e!==null););return e}function Awt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j$(e,t)}function j$(e,t){return j$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},j$(e,t)}function Pwt(e){var t=Dwt();return function(){var n=si(e),i;if(t){var a=si(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Iwt(this,i)}}function Iwt(e,t){if(t&&(ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mwt(e)}function Mwt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dwt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function si(e){return si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},si(e)}var W$="multiColumnSorting",$wt=170,Nwt="append",qK="columnSorting";Pse(W$,_wt);var Lwt=function(e){Awt(r,e);var t=Pwt(r);function r(n){var i;return Twt(this,r),i=t.call(this,n),i.pluginKey=W$,i}return Owt(r,[{key:"isEnabled",value:function(){return zi(si(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[qK]&&KK(),zi(si(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){zi(si(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){zi(si(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){zi(si(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return zi(si(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return zi(si(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){zi(si(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=zi(si(r.prototype),"updateHeaderClasses",this)).call.apply(a,[this,i].concat(s)),wt(i,xwt(i)),this.enabled!==!1&&ke(i,Cwt.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[qK]&&KK(),zi(si(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,a){BD(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(a.col),this.sort(this.getNextSortConfig(a.col,Nwt))):this.sort(this.getColumnNextConfig(a.col)))}}],[{key:"PLUGIN_KEY",get:function(){return W$}},{key:"PLUGIN_PRIORITY",get:function(){return $wt}}]),r}(Dse);function ig(e){return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}function Fwt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bwt(n.key),n)}}function Hwt(e,t,r){return t&&ZK(e.prototype,t),r&&ZK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bwt(e){var t=Vwt(e,"string");return ig(t)==="symbol"?t:String(t)}function Vwt(e,t){if(ig(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ig(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FC(){return typeof Reflect<"u"&&Reflect.get?FC=Reflect.get.bind():FC=function(t,r,n){var i=jwt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},FC.apply(this,arguments)}function jwt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ag(e),e!==null););return e}function Wwt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U$(e,t)}function U$(e,t){return U$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},U$(e,t)}function Uwt(e){var t=Ywt();return function(){var n=ag(e),i;if(t){var a=ag(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zwt(this,i)}}function zwt(e,t){if(t&&(ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gwt(e)}function Gwt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ywt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ag(e){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ag(e)}var Kwt="multipleSelectionHandles",Xwt=160,qwt=function(e){Wwt(r,e);var t=Uwt(r);function r(n){var i;return Fwt(this,r),i=t.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return Hwt(r,[{key:"isEnabled",value:function(){return oo()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Nr(this)),this.registerListeners(),FC(ag(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,a=this,o=this.hot.rootElement;function s(l){if(a.dragged.length===1)return a.dragged.splice(0,a.dragged.length),!0;var u=a.dragged.indexOf(l);if(u===-1)return!1;u===0?a.dragged=a.dragged.slice(0,1):u===1&&(a.dragged=a.dragged.slice(-1))}this.eventManager.addEventListener(o,"touchstart",function(l){var u;if(mt(l.target,"topSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("top"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(mt(l.target,"bottomSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("bottom"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchend",function(l){if(mt(l.target,"topSelectionHandle-HitArea"))return s.call(a,"top"),a.touchStartRange=void 0,l.preventDefault(),!1;if(mt(l.target,"bottomSelectionHandle-HitArea"))return s.call(a,"bottom"),a.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchmove",function(l){var u=i.hot.rootDocument,f,c,h,d,v,p;if(a.dragged.length!==0){var g=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!g||g===a.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(f=a.hot.getCoords(g),f.col===-1&&(f.col=0),c=a.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&a.hot.selection.setRangeEnd(f),p=a.getCurrentRangeCoords(c,f,a.touchStartRange.direction,v,a.dragged[0]),p.start!==null&&a.hot.selection.setRangeStart(p.start),a.hot.selection.setRangeEnd(p.end),a.lastSetCell=g),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,a,o,s,l){var u=i.getTopStartCorner(),f=i.getBottomEndCorner(),c=i.getBottomStartCorner(),h=i.getTopEndCorner(),d={start:null,end:null};switch(o){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?d={start:this.hot._createCellCoords(a.row,i.highlight.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,u.col)};break;case"SE-NW":l==="bottom"&&(d={start:this.hot._createCellCoords(f.row,a.col),end:this.hot._createCellCoords(a.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?d={start:a,end:c}:d.end=a;break;case"NW-SE":l==="top"?d={start:a,end:f}:d.end=a;break;case"SE-NW":l==="top"?d={start:a,end:u}:d.end=a;break;case"SW-NE":l==="top"?d={start:a,end:h}:d.end=a;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(u.row,a.col),end:this.hot._createCellCoords(a.row,f.col)};break;case"SW-NE":l==="top"?d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,f.col)}:d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(u.row,a.col)};break;case"SE-NW":l==="bottom"?d={start:this.hot._createCellCoords(a.row,h.col),end:this.hot._createCellCoords(u.row,a.col)}:l==="top"&&(d={start:c,end:a});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(d.end=a);break;case"SE-NW":l==="top"?d.end=a:d={start:a,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return Kwt}},{key:"PLUGIN_PRIORITY",get:function(){return Xwt}}]),r}(tr);function z$(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,i=n===void 0?1:n,a=e.origColspan,o=a===void 0?1:a,s=e.collapsible,l=s===void 0?!1:s,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,p=e.isRoot,g=p===void 0?!1:p,y=e.isPlaceholder,m=y===void 0?!1:y;return{label:r,colspan:i,origColspan:o,collapsible:l,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:g,isPlaceholder:m}}function qle(){return{label:"",isPlaceholder:!0}}function JK(e){return e_t(e)||Qwt(e)||Jwt(e)||Zwt()}function Zwt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jwt(e,t){if(e){if(typeof e=="string")return G$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G$(e,t)}}function Qwt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function e_t(e){if(Array.isArray(e))return G$(e)}function G$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function t_t(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;ne(e,function(i){var a=[],o=0;r.push(a),ne(i,function(s){var l=z$();if(kt(s)){var u=s.label,f=s.colspan;l.label=Vr(u),typeof f=="number"&&f>1&&(l.colspan=f,l.origColspan=f)}else l.label=Vr(s);o+=l.origColspan;var c=!1;if(o>=t&&(l.colspan=l.origColspan-(o-t),l.origColspan=l.colspan,c=!0),a.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)a.push(qle());return!c})});var n=Math.max.apply(Math,JK(Rt(r,function(i){return i.length})));return ne(r,function(i){if(i.length<n){var a=Rt(new Array(n-i.length),function(){return z$()});i.splice.apply(i,[i.length,0].concat(JK(a)))}}),r}function sw(e){return sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sw(e)}var r_t=["row","col"];function QK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function n_t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QK(Object(r),!0).forEach(function(n){i_t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i_t(e,t,r){return t=Zle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a_t(e,t){if(e==null)return{};var r=o_t(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o_t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function s_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zle(n.key),n)}}function l_t(e,t,r){return t&&eX(e.prototype,t),r&&eX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zle(e){var t=u_t(e,"string");return sw(t)==="symbol"?t:String(t)}function u_t(e,t){if(sw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RP(e,t,r){f_t(e,t),t.set(e,r)}function f_t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(e,t){var r=Jle(e,t,"get");return c_t(e,r)}function c_t(e,t){return t.get?t.get.call(e):t.value}function Fy(e,t,r){var n=Jle(e,t,"set");return h_t(e,n,r),r}function Jle(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function h_t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var tX=["label","collapsible"],ys=new WeakMap,If=new WeakMap,kP=new WeakMap,d_t=function(){function e(){s_t(this,e),RP(this,ys,{writable:!0,value:[]}),RP(this,If,{writable:!0,value:0}),RP(this,kP,{writable:!0,value:1/0})}return l_t(e,[{key:"setColumnsLimit",value:function(r){Fy(this,kP,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Fy(this,ys,t_t(r,za(this,kP))),Fy(this,If,za(this,ys).length)}},{key:"getData",value:function(){return za(this,ys)}},{key:"mergeWith",value:function(r){var n=this;ne(r,function(i){var a=i.row,o=i.col,s=a_t(i,r_t),l=n.getHeaderSettings(a,o);l!==null&&nn(l,s,tX)})}},{key:"map",value:function(r){ne(za(this,ys),function(n){ne(n,function(i){var a=r(n_t({},i));kt(a)&&nn(i,a,tX)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=za(this,If)||r<0)return null;var a=za(this,ys)[r];return n>=a.length?null:(i=a[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=[];if(r>=za(this,If)||r<0)return a;for(var o=za(this,ys)[r],s=0,l=n;l<o.length;l++){var u=o[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,a.push(u),u.colspan>1&&(l+=u.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return a}},{key:"getLayersCount",value:function(){return za(this,If)}},{key:"getColumnsCount",value:function(){return za(this,If)>0?za(this,ys)[0].length:0}},{key:"clear",value:function(){Fy(this,ys,[]),Fy(this,If,0)}}]),e}();function lw(e){return lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lw(e)}function rX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rX(Object(r),!0).forEach(function(n){HC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qle(n.key),n)}}function p_t(e,t,r){return t&&iX(e.prototype,t),r&&iX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HC(e,t,r){return t=Qle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qle(e){var t=g_t(e,"string");return lw(t)==="symbol"?t:String(t)}function g_t(e,t){if(lw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y_t(e){return __t(e)||w_t(e)||b_t(e)||m_t()}function m_t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b_t(e,t){if(e){if(typeof e=="string")return Y$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y$(e,t)}}function w_t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function __t(e){if(Array.isArray(e))return Y$(e)}function Y$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var S_t="DF-pre-order";function eue(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=eue.call(this.childs[n],e,t)}return r}var C_t="DF-post-order";function tue(e,t){for(var r=0;r<this.childs.length;r++){var n=tue.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var rue="BF";function x_t(e,t){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,y_t(i.childs)),e.call(t,i)!==!1&&n()}}n()}var T_t=rue,aX=new Map([[S_t,eue],[C_t,tue],[rue,x_t]]),oX=function(){function e(t){v_t(this,e),HC(this,"data",{}),HC(this,"parent",null),HC(this,"childs",[]),this.data=t}return p_t(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(nX({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=nX({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T_t;if(!aX.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));aX.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function a(o){var s=r.call(n,o);s!==!1&&o.parent!==null&&a(o.parent)};i(this)}}]),e}();function uw(e){return uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uw(e)}function sX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sX(Object(r),!0).forEach(function(n){O_t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O_t(e,t,r){return t=nue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E_t(e,t){return P_t(e)||A_t(e,t)||k_t(e,t)||R_t()}function R_t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k_t(e,t){if(e){if(typeof e=="string")return uX(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uX(e,t)}}function uX(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A_t(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function P_t(e){if(Array.isArray(e))return e}function I_t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nue(n.key),n)}}function M_t(e,t,r){return t&&fX(e.prototype,t),r&&fX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nue(e){var t=D_t(e,"string");return uw(t)==="symbol"?t:String(t)}function D_t(e,t){if(uw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(uw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AP(e,t,r){$_t(e,t),t.set(e,r)}function $_t(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ni(e,t){var r=iue(e,t,"get");return N_t(e,r)}function N_t(e,t){return t.get?t.get.call(e):t.value}function L_t(e,t,r){var n=iue(e,t,"set");return F_t(e,n,r),r}function iue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function F_t(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ud=new WeakMap,Mf=new WeakMap,fd=new WeakMap,H_t=function(){function e(t){I_t(this,e),AP(this,ud,{writable:!0,value:new Map}),AP(this,Mf,{writable:!0,value:new Map}),AP(this,fd,{writable:!0,value:null}),L_t(this,fd,t)}return M_t(e,[{key:"getRoots",value:function(){return Array.from(ni(this,ud).values())}},{key:"getRootByColumn",value:function(r){var n;return ni(this,Mf).has(r)&&(n=ni(this,ud).get(ni(this,Mf).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(i){var a=n-ni(this,Mf).get(n),o=0,s;return i.walkDown(function(l){var u=l.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(a>=o&&a<=o+f-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;o+=f}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;ni(this,Mf).clear(),ne(ni(this,ud),function(i){for(var a=E_t(i,2),o=a[1].data.colspan,s=n;s<n+o;s++)ni(r,Mf).set(s,n);n+=o})}},{key:"buildTree",value:function(){this.clear();for(var r=ni(this,fd).getColumnsCount(),n=0;n<r;){var i=ni(this,fd).getHeaderSettings(0,n),a=new oX;ni(this,ud).set(n,a),this.buildLeaves(a,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=ni(this,fd).getHeadersSettings(i,n,o);i+=1,ne(s,function(l){var u=lX(lX({},l),{},{headerLevel:i-1,columnIndex:n}),f;i===1?(r.data=u,f=r):(f=new oX(u),r.addChild(f)),i<ni(a,fd).getLayersCount()&&a.buildLeaves(f,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){ni(this,ud).clear(),ni(this,Mf).clear()}}]),e}();function aue(e,t){e.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(t(n.columnIndex),i.length===0))for(var a=1;a<n.colspan;a++)t(n.columnIndex+a)})}function AT(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function PT(e){return AT(e,"origColspan")===e.data.origColspan}function M3(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=PT(e);if(n)return M3(r[0]);t.isCollapsed=!1;var i=r.slice(1),a=new Set,o=0;if(i.length>0)ne(i,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;o+=h.colspan,aue(c,function(d){a.add(d)})});else{var s=t.colspan,l=t.origColspan,u=t.columnIndex;o=l-s;for(var f=1;f<l;f++)a.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=o,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):PT(c)&&(h.isCollapsed=AT(c,"isCollapsed"))}),{rollbackModification:function(){return D3(e)},affectedColumns:Array.from(a),colspanCompensation:o}}function D3(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=PT(e);if(i)return D3(n[0]);r.isCollapsed=!0;var a=n.slice(1),o=new Set;if(a.length>0)ne(a,function(h){aue(h,function(d){o.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var f=l+u;o.add(f)}var c=r.colspan-((t=AT(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):PT(h)&&(d.isCollapsed=AT(h,"isCollapsed"))}),{rollbackModification:function(){return M3(e)},affectedColumns:Array.from(o),colspanCompensation:c}}var cX;function B_t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function V_t(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(sr(cX||(cX=B_t([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.push(t),a.colspan>1?a.colspan-=1:a.isHidden=!0})}}var hX;function j_t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function W_t(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(sr(hX||(hX=j_t([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.splice(a.crossHiddenColumns.indexOf(t),1),!a.isHidden&&a.colspan<a.origColspan&&(a.colspan+=1),a.isHidden=!1})}}var dX=new Map([["collapse",D3],["expand",M3],["hide-column",V_t],["show-column",W_t]]);function U_t(e,t,r){if(!dX.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return dX.get(e)(t,r)}var z_t=["crossHiddenColumns"];function G_t(e,t){if(e==null)return{};var r=Y_t(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Y_t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function x1(e){var t=[];return ne(e,function(r){r.walkDown(function(n){for(var i=n.data,a=i.origColspan,o=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,u=X_t(t,s),f=!1,c=o;c<o+a;c++){var h=l.includes(c);if(h||f)u.push(qle());else{var d=K_t(i);d.isRoot=!0,u.push(d),f=!0}}})}),t}function K_t(e){var t=z$(e);t.crossHiddenColumns;var r=G_t(t,z_t);return r}function X_t(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function fw(e){return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}var q_t=["row"];function vX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vX(Object(r),!0).forEach(function(n){Z_t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z_t(e,t,r){return t=oue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J_t(e,t){if(e==null)return{};var r=Q_t(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Q_t(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function eSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oue(n.key),n)}}function tSt(e,t,r){return t&&gX(e.prototype,t),r&&gX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oue(e){var t=rSt(e,"string");return fw(t)==="symbol"?t:String(t)}function rSt(e,t){if(fw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PP(e,t,r){nSt(e,t),t.set(e,r)}function nSt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hy(e,t,r){var n=sue(e,t,"set");return iSt(e,n,r),r}function iSt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Ur(e,t){var r=sue(e,t,"get");return aSt(e,r)}function sue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function aSt(e,t){return t.get?t.get.call(e):t.value}var Do=new WeakMap,Ui=new WeakMap,Df=new WeakMap,oSt=function(){function e(){eSt(this,e),PP(this,Do,{writable:!0,value:new d_t}),PP(this,Ui,{writable:!0,value:new H_t(Ur(this,Do))}),PP(this,Df,{writable:!0,value:[[]]})}return tSt(e,[{key:"setState",value:function(r){Ur(this,Do).setData(r);var n=!1;try{Ur(this,Ui).buildTree()}catch{Ur(this,Ui).clear(),Ur(this,Do).clear(),n=!0}return Hy(this,Df,x1(Ur(this,Ui).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Ur(this,Do).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=Rt(r,function(a){var o=a.row,s=J_t(a,q_t);return pX({row:o<0?n.rowCoordsToLevel(o):o},s)});Ur(this,Do).mergeWith(i),Ur(this,Ui).buildTree(),Hy(this,Df,x1(Ur(this,Ui).getRoots()))}},{key:"mapState",value:function(r){Ur(this,Do).map(r),Ur(this,Ui).buildTree(),Hy(this,Df,x1(Ur(this,Ui).getRoots()))}},{key:"mapNodes",value:function(r){return Xr(Ur(this,Ui).getRoots(),function(n,i){return i.walkDown(function(a){var o=r(a.data);o!==void 0&&n.push(o)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var a=Ur(this,Ui).getNode(n,i),o;return a&&(o=U_t(r,a,i),Hy(this,Df,x1(Ur(this,Ui).getRoots()))),o}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,a;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(a=Ur(this,Df)[r])===null||a===void 0?void 0:a[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=Ur(this,Ui).getNode(r,n);return i?pX({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,a=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},o=a.isRoot;if(o)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},f=u.isRoot;if(f)break;s-=1}return s}},{key:"getLayersCount",value:function(){return Ur(this,Do).getLayersCount()}},{key:"getColumnsCount",value:function(){return Ur(this,Do).getColumnsCount()}},{key:"clear",value:function(){Hy(this,Df,[]),Ur(this,Do).clear(),Ur(this,Ui).clear()}}]),e}();function cw(e){return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cw(e)}function sSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lue(n.key),n)}}function lSt(e,t,r){return t&&yX(e.prototype,t),r&&yX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function By(e,t,r){return t=lue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lue(e){var t=uSt(e,"string");return cw(t)==="symbol"?t:String(t)}function uSt(e,t){if(cw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fSt=function(){function e(t,r){sSt(this,e),By(this,"hot",void 0),By(this,"nestedHeaderSettingsGetter",void 0),By(this,"layersCount",0),By(this,"container",void 0),By(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return lSt(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(a);this.widthsMap.setValueAtIndex(o,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,a=n.columnIndexMapper,o=i.createDocumentFragment(),s=i.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=a.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=i.createElement("tr"),h=0;h<u;h++){var d=a.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=i.createElement("th"),p=this.nestedHeaderSettingsGetter(f,d);if(p&&(!p.isPlaceholder||p.isHidden)){var g=p.label;l&&(g+='<button class="changeType"></button>'),fh(v,g),v.colSpan=p.colspan,c.appendChild(v)}}s.appendChild(c)}o.appendChild(s),r.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const cSt=fSt;function og(e){return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(e)}var mX,bX;function wX(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uue(n.key),n)}}function dSt(e,t,r){return t&&_X(e.prototype,t),r&&_X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dc(){return typeof Reflect<"u"&&Reflect.get?dc=Reflect.get.bind():dc=function(t,r,n){var i=vSt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},dc.apply(this,arguments)}function vSt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zs(e),e!==null););return e}function pSt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K$(e,t)}function K$(e,t){return K$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},K$(e,t)}function gSt(e){var t=mSt();return function(){var n=Zs(e),i;if(t){var a=Zs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ySt(this,i)}}function ySt(e,t){if(t&&(og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rm(e)}function rm(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zs(e){return Zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zs(e)}function SX(e,t,r){return t=uue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uue(e){var t=bSt(e,"string");return og(t)==="symbol"?t:String(t)}function bSt(e,t){if(og(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(og(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CX(e,t,r){wSt(e,t),t.set(e,r)}function wSt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T1(e,t,r){var n=fue(e,t,"set");return _St(e,n,r),r}function _St(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Lr(e,t){var r=fue(e,t,"get");return SSt(e,r)}function fue(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function SSt(e,t){return t.get?t.get.call(e):t.value}var xX="nestedHeaders",CSt=280,qr=new WeakMap,Wl=new WeakMap,xSt=function(e){pSt(r,e);var t=gSt(r);function r(){var n;hSt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),CX(rm(n),qr,{writable:!0,value:new oSt}),CX(rm(n),Wl,{writable:!0,value:null}),SX(rm(n),"ghostTable",new cSt(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),SX(rm(n),"detectedOverlappedHeaders",!1),n}return dSt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xX]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;(!Array.isArray(o)||!Array.isArray(o[0]))&&gr(sr(mX||(mX=wX([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),dc(Zs(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(this.hot.view){var a=this.hot.getSettings(),o=a.nestedHeaders;Lr(this,qr).setColumnsLimit(this.hot.countCols()),Array.isArray(o)&&(this.detectedOverlappedHeaders=Lr(this,qr).setState(o)),this.detectedOverlappedHeaders&&gr(sr(bX||(bX=wX([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";Lr(i,qr).triggerColumnModification(u,l)}),!Lr(this,Wl)&&this.enabled&&T1(this,Wl,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,f=l.index,c=l.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";Lr(i,qr).triggerColumnModification(h,f)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),dc(Zs(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Lr(this,qr).clear(),Lr(this,Wl).unsubscribe(),T1(this,Wl,null),this.ghostTable.clear(),dc(Zs(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Lr(this,qr)}},{key:"getLayersCount",value:function(){return Lr(this,qr).getLayersCount()}},{key:"getHeaderSettings",value:function(i,a){return Lr(this,qr).getHeaderSettings(i,a)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var i=this.hot.view._wt,a=i.getSetting("columnHeaders").length,o=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<a;u++){var f=o.childNodes[u];if(!f)break;for(var c=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),wt(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),wt(c.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),wt(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var a=this,o=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,f=a.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(s);d===null&&(d=s),l.removeAttribute("colspan"),wt(l,"hiddenHeader");var v=(u=Lr(a,qr).getHeaderSettings(i,d))!==null&&u!==void 0?u:{label:""},p=v.colspan,g=v.isHidden,y=v.isPlaceholder;if(y||g)ke(l,"hiddenHeader");else if(p>1){var m,b,_=h._wt.wtOverlays,x=(m=_.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(l),T=(b=_.inlineStartOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(l),E=x||T?Math.min(p,o-s):p;E>1&&l.setAttribute("colspan",E)}a.hot.view.appendColHeader(d,l,function(){return a.getColumnHeaderValue.apply(a,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,a){var o,s=(o=Lr(this,qr).getHeaderSettings(a,i))!==null&&o!==void 0?o:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(i,a)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,a,o){var s=Lr(this,qr).getHeaderTreeNodeData(a,i);if(!s)return i;var l=o.classNames,u=o.columnCursor,f=o.selectionType,c=o.selectionWidth,h=Lr(this,qr).getHeaderSettings(a,i),d=h.isRoot,v=h.colspan;if(f===y_){if(!d)return s.columnIndex}else f===_E&&(v>c-u||!d)&&(l.length=0);return i}},{key:"onBeforeCopy",value:function(i,a,o){var s=o.columnHeadersCount;if(s!==0)for(var l=0;l<a.length;l++){var u=a[l],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,p=c-d+1;if(f>=0||p===1)break;for(var g=c;g<=d;g++)for(var y=f;y<=h;y++){var m,b=v+y,_=g-c;if(_!==0){var x=(m=Lr(this,qr).getHeaderTreeNodeData(y,g))===null||m===void 0?void 0:m.isRoot;x===!1&&(i[b][_]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this._getHeaderTreeNodeDataByCoords(a);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){var o=this._getHeaderTreeNodeDataByCoords(a);if(o){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],f=o.columnIndex,c=o.origColspan,h=!s.inInSelection(a);i.shiftKey&&l?a.col<l.from.col?u.push(l.getTopEndCorner().col,f,a.row):a.col>l.from.col?u.push(l.getTopStartCorner().col,f+c-1,a.row):u.push(f,f+c-1,a.row):(hE(i)||Fu(i)&&h)&&u.push(f,f+c-1,a.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(a);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),p=h.from;s.column=!0,s.cell=!0;var g=[];a.col<p.col?g.push(v.col,f):a.col>p.col?g.push(d.col,f+c-1):g.push(f,f+c-1),(l=this.hot).selectColumns.apply(l,g)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var a=0;a<Lr(this,qr).getLayersCount();a++)i.push(this.headerRendererFactory(a))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var a=Lr(this,qr).getLayersCount(),o=i.startColumn,s=!!a,l=0;l<a;l++){var u=Lr(this,qr).findLeftMostColumnIndex(l,i.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),Ki(f)&&f<i.startColumn){o=f;break}}i.startColumn=s?Lr(this,qr).getHeaderTreeNodeData(0,o).columnIndex:o}},{key:"onModifyColWidth",value:function(i,a){var o=this.ghostTable.getWidth(a);return i>o?i:o}},{key:"onModifyColumnHeaderValue",value:function(i,a,o){var s,l=(s=Lr(this,qr).getHeaderTreeNodeData(o,a))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){T1(this,qr,null),Lr(this,Wl)!==null&&(Lr(this,Wl).unsubscribe(),T1(this,Wl,null)),dc(Zs(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return Lr(this,qr).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return xX}},{key:"PLUGIN_PRIORITY",get:function(){return CSt}}]),r}(tr);function TX(e){return RSt(e)||ESt(e)||OSt(e)||TSt()}function TSt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OSt(e,t){if(e){if(typeof e=="string")return X$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X$(e,t)}}function ESt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RSt(e){if(Array.isArray(e))return X$(e)}function X$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sg(e){return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sg(e)}function kSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PSt(n.key),n)}}function ASt(e,t,r){return t&&OX(e.prototype,t),r&&OX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PSt(e){var t=ISt(e,"string");return sg(t)==="symbol"?t:String(t)}function ISt(e,t){if(sg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MSt=function(){function e(t,r){kSt(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return ASt(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rt(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var a=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&ne(r.__children,function(o){a.cacheNode(o,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,a){var o=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:u,end:!0}:a!=null&&u===a?{result:l,end:!0}:(l+=1,u.__children&&ne(u.__children,function(f){if(o.parentReference.set(f,s?null:u),l=o.readTreeNodes(f,l,i,a),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return At(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,a=r;return isNaN(a)||(a=this.getDataObject(a)),!a||!a.__children?0:(ne(a.__children,function(o){i+=1,o.__children&&(i+=n.countChildren(o))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||sg(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var a=null;r&&(a=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",a+this.countChildren(r)+1,1);var o=r;r||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var a=i,o;if(a||(a=this.mockNode()),this.hot.runHooks("beforeAddChild",r,a,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,a),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),o=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);a=this.getDataObject(o),this.hot.runHooks("afterAddChild",r,a,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),a=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(a,o+1,null);break;case"above":this.addChildAtIndex(a,o,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=null,o=[];Array.isArray(r)?(rt(r[0],r[2],function(y){var m=n.translateTrimmedRow(y);o.push(n.getDataObject(m))}),rt(0,o.length-2,function(y){n.detachFromParent(o[y],!1)}),a=o[o.length-1]):a=r;var s=this.getRowIndex(a),l=this.countChildren(a),u=this.getRowIndexWithinParent(a),f=this.getRowParent(a),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,a),u!=null){var v=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var p=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",g+1,l+1,this.plugin.pluginName),c.__children.push(a)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(a)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,a,this.getRowIndex(a)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var a=this,o=[];ne(i,function(s){o.push(a.getDataObject(s))}),ne(o,function(s){var l=a.getRowIndexWithinParent(s),u=a.getRowParent(s);u===null?a.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var a=this.getDataObject(r-1),o=null,s=r;if(a&&a.__children&&a.__children.length===0?(o=a,s=0):r<this.countAllRows()&&(o=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),o)if(i){var l;(l=o.__children).splice.apply(l,[s,n].concat(TX(i)))}else o.__children.splice(s,n);else if(i){var u;(u=this.data).splice.apply(u,[s,n].concat(TX(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,a){var o=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),f=r>n,c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=o||i||a?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,u[0]),s.__children.splice(l+(f&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const DSt=MSt;function hw(e){return hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hw(e)}function EX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NSt(n.key),n)}}function $St(e,t,r){return t&&EX(e.prototype,t),r&&EX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NSt(e){var t=LSt(e,"string");return hw(t)==="symbol"?t:String(t)}function LSt(e,t){if(hw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var HSt=$St(function e(t,r){FSt(this,e),this.hot=r,this.plugin=t});const $3=HSt;function lg(e){return lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lg(e)}function BSt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jSt(n.key),n)}}function VSt(e,t,r){return t&&RX(e.prototype,t),r&&RX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jSt(e){var t=WSt(e,"string");return lg(t)==="symbol"?t:String(t)}function WSt(e,t){if(lg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function USt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q$(e,t)}function q$(e,t){return q$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},q$(e,t)}function zSt(e){var t=KSt();return function(){var n=IT(e),i;if(t){var a=IT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return GSt(this,i)}}function GSt(e,t){if(t&&(lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YSt(e)}function YSt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KSt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function IT(e){return IT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},IT(e)}var XSt=function(e){USt(r,e);var t=zSt(r);function r(n,i){var a;return BSt(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsingUI=a.plugin.collapsingUI,a.rowHeaderWidthCache=null,a}return VSt(r,[{key:"appendLevelIndicators",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(o),l=this.dataManager.getDataObject(o),u=a.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(ne(c,function(p){p&&u.removeChild(p)}),ke(a,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",rt(0,s-1,function(){var p=h.createElement("SPAN");ke(p,r.CSS_CLASSES.emptyIndicator),u.appendChild(p)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var v=this.hot.rootDocument.createElement("DIV");ke(a,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?ke(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):ke(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(i){var a=i;a||(a=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*a+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}($3);const cue=XSt;function ug(e){return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}function kX(e){return QSt(e)||JSt(e)||ZSt(e)||qSt()}function qSt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZSt(e,t){if(e){if(typeof e=="string")return Z$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z$(e,t)}}function JSt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QSt(e){if(Array.isArray(e))return Z$(e)}function Z$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r1t(n.key),n)}}function t1t(e,t,r){return t&&AX(e.prototype,t),r&&AX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r1t(e){var t=n1t(e,"string");return ug(t)==="symbol"?t:String(t)}function n1t(e,t){if(ug(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J$(e,t)}function J$(e,t){return J$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},J$(e,t)}function a1t(e){var t=l1t();return function(){var n=MT(e),i;if(t){var a=MT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return o1t(this,i)}}function o1t(e,t){if(t&&(ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s1t(e)}function s1t(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function MT(e){return MT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},MT(e)}var u1t=function(e){i1t(r,e);var t=a1t(r);function r(n,i){var a;return e1t(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsedRows=[],a.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;a.lastCollapsedRows=a.collapsedRows.slice(0),a.expandMultipleChildren(a.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),ne(a.lastCollapsedRows,function(f,c){f>=s&&f<l&&(a.lastCollapsedRows[c]=f+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;a.collapseMultipleChildren(a.lastCollapsedRows,s),a.lastCollapsedRows=void 0},trimStash:function(s,l){rt(s,s+l-1,function(u){var f=a.lastCollapsedRows.indexOf(u);f>-1&&a.lastCollapsedRows.splice(f,1)})}},a}return t1t(r,[{key:"collapseChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(i),f=i),this.dataManager.hasChildren(u)&&ne(u.__children,function(h){l.push(a.dataManager.getRowIndex(h))}),c=this.collapseRows(l,!0,!1),s&&this.trimRows(c),o&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ne(i,function(u){l.push.apply(l,kX(a.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),o&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],a)}},{key:"collapseRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ne(i,function(u){l.push(u),o&&a.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ne(l.__children,function(u){var f=a.dataManager.getRowIndex(u);o.push(f),a.collapseChildRows(f,o)})}s&&this.trimRows(o)}},{key:"expandRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],a)}},{key:"expandRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ne(i,function(u){l.push(u),o&&a.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ne(l.__children,function(u){if(!a.isAnyParentCollapsed(u)){var f=a.dataManager.getRowIndex(u);o.push(f),a.expandChildRows(f,o)}})}s&&this.untrimRows(o)}},{key:"expandChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(i)):(u=this.dataManager.getDataObject(i),f=i),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&ne(u.__children,function(h){var d=a.dataManager.getRowIndex(h);l.push(d)}),c=this.expandRows(l,!0,!1),s&&this.untrimRows(c),o&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ne(i,function(u){l.push.apply(l,kX(a.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),o&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ne(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.collapseMultipleChildren(o),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ne(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.expandMultipleChildren(o),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ne(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"untrimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ne(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var a=this,o=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return o===null&&(o={__children:this.dataManager.data}),this.dataManager.hasChildren(o)&&ne(o.__children,function(l){var u=a.dataManager.getRowIndex(l);if(!a.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var a=i;a!==null;){a=this.dataManager.getRowParent(a);var o=this.dataManager.getRowIndex(a);if(this.collapsedRows.indexOf(o)>-1)return!0}return!1}},{key:"toggleState",value:function(i,a){if(!(a.col>=0)){var o=this.translateTrimmedRow(a.row);mt(i.target,cue.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),go(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}($3);const f1t=u1t;function fg(e){return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fg(e)}function c1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d1t(n.key),n)}}function h1t(e,t,r){return t&&PX(e.prototype,t),r&&PX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d1t(e){var t=v1t(e,"string");return fg(t)==="symbol"?t:String(t)}function v1t(e,t){if(fg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function p1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q$(e,t)}function Q$(e,t){return Q$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Q$(e,t)}function g1t(e){var t=m1t();return function(){var n=DT(e),i;if(t){var a=DT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return y1t(this,i)}}function y1t(e,t){if(t&&(fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hue(e)}function hue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function DT(e){return DT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DT(e)}var IX=new WeakMap,b1t=function(e){p1t(r,e);var t=g1t(r);function r(n,i){var a;return c1t(this,r),a=t.call(this,n,i),IX.set(hue(a),{row_above:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"below")}}),a.dataManager=a.plugin.dataManager,a}return h1t(r,[{key:"appendOptions",value:function(i){var a=this,o=[{key:"add_child",name:function(){return this.getTranslatedPhrase(SB)},callback:function(){var l=a.dataManager.translateTrimmedRow(a.hot.getSelectedLast()[0]),u=a.dataManager.getDataObject(l);a.dataManager.addChild(u)},disabled:function(){var l=a.hot.getSelectedLast();return!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(CB)},callback:function(){a.dataManager.detachFromParent(a.hot.getSelectedLast())},disabled:function(){var l=a.hot.getSelectedLast(),u=a.dataManager.translateTrimmedRow(l[0]),f=a.dataManager.getRowParent(u);return!f||!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{name:"---------"}];return rt(0,i.items.length-1,function(s){if(s===0)return ne(o,function(l,u){i.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var a=IX.get(this);return rt(0,i.items.length-1,function(o){var s=a[i.items[o].key];s!=null&&(i.items[o].callback=s)}),i}}]),r}($3);const w1t=b1t;function dw(e){return dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dw(e)}var MX;function DX(e){return x1t(e)||C1t(e)||S1t(e)||_1t()}function _1t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S1t(e,t){if(e){if(typeof e=="string")return eN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eN(e,t)}}function C1t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function x1t(e){if(Array.isArray(e))return eN(e)}function eN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T1t(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function O1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R1t(n.key),n)}}function E1t(e,t,r){return t&&$X(e.prototype,t),r&&$X(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R1t(e){var t=k1t(e,"string");return dw(t)==="symbol"?t:String(t)}function k1t(e,t){if(dw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A1t=function(){function e(t){O1t(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return E1t(e,[{key:"onBeforeRowMove",value:function(r,n,i,a){var o=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:a});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),f=!0,c=r.map(function(g){if(!f)return!1;var y=o.dataManager.translateTrimmedRow(g);return f=o.shouldAllowMoving(y,u),y}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(l,u),p=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,p),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,a,a&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,a=r.dropIndex,o=r.movePossible,s=!1;return pr(a)&&(gr(sr(MX||(MX=T1t([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,a,o,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,DX(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var a=this,o=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(s){a.dataManager.moveRow(s,n,a.movedToCollapsed,o)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,a,o=[],s=Math.max.apply(Math,DX(r))<n;r.forEach(function(l){o.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(a=this.hot).spliceCellsMeta.apply(a,[n-(s?o.length:0),0].concat(o))}},{key:"selectCells",value:function(r,n){var i=r.length,a=0,o=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[i-1]<n?u=this.dataManager.translateTrimmedRow(n-i):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);a=this.dataManager.untranslateTrimmedRow(c),o=a}else r[i-1]<n?(o=n-1,a=o-i+1):(a=n,o=a+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(a,0)),s.setRangeEnd(this.hot._createCellCoords(o,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,a){return i-a!==n})}}]),e}();function cg(e){return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cg(e)}function P1t(e){return $1t(e)||D1t(e)||M1t(e)||I1t()}function I1t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M1t(e,t){if(e){if(typeof e=="string")return tN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tN(e,t)}}function D1t(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $1t(e){if(Array.isArray(e))return tN(e)}function tN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F1t(n.key),n)}}function L1t(e,t,r){return t&&NX(e.prototype,t),r&&NX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F1t(e){var t=H1t(e,"string");return cg(t)==="symbol"?t:String(t)}function H1t(e,t){if(cg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vc(){return typeof Reflect<"u"&&Reflect.get?vc=Reflect.get.bind():vc=function(t,r,n){var i=B1t(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},vc.apply(this,arguments)}function B1t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Js(e),e!==null););return e}function V1t(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rN(e,t)}function rN(e,t){return rN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rN(e,t)}function j1t(e){var t=U1t();return function(){var n=Js(e),i;if(t){var a=Js(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return W1t(this,i)}}function W1t(e,t){if(t&&(cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return due(e)}function due(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U1t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Js(e){return Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Js(e)}var IP="nestedRows",z1t=300,ms=new WeakMap,G1t="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",Y1t=function(e){V1t(r,e);var t=j1t(r);function r(n){var i;return N1t(this,r),i=t.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,ms.set(due(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return L1t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[IP]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new g_),this.dataManager=new DSt(this,this.hot),this.collapsingUI=new f1t(this,this.hot),this.headersUI=new cue(this,this.hot),this.contextMenuUI=new w1t(this,this.hot),this.rowMoveController=new A1t(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(a){return i.onBeforeLoadData(a)}),this.addHook("beforeUpdateData",function(a){return i.onBeforeLoadData(a)}),vc(Js(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),vc(Js(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),vc(Js(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,a,o,s){return this.rowMoveController.onBeforeRowMove(i,a,o,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=ms.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=ms.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o){this.collapsingUI.toggleState(i,a,o)}},{key:"onModifyRowData",value:function(i){var a=ms.get(this);if(!a.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=ms.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,a,o){var s=ms.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,a,o),!1)}},{key:"onFilterData",value:function(i,a,o){var s=ms.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],a),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*a),this.dataManager.filterData(i,a,o),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,a){this.headersUI.appendLevelIndicators(i,a)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(s!==this.pluginName){var u=ms.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=Array.from(o.reduce(function(u,f){if(s.dataManager.isParent(f)){var c=s.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));o.length=0,o.push.apply(o,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,a){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(a)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,a,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,P1t(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,a){var o=ms.get(this);o.skipRender&&(a.skipRender=!0)}},{key:"destroy",value:function(){vc(Js(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!poe(i)){hH(G1t),this.hot.getSettings()[IP]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return IP}},{key:"PLUGIN_PRIORITY",get:function(){return z1t}}]),r}(tr);function vw(e){return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}function K1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q1t(n.key),n)}}function X1t(e,t,r){return t&&LX(e.prototype,t),r&&LX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function q1t(e){var t=Z1t(e,"string");return vw(t)==="symbol"?t:String(t)}function Z1t(e,t){if(vw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J1t=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;K1t(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return X1t(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,a=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return a===null?void 0:JSON.parse(a)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;ne(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const Q1t=J1t;function hg(e){return hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hg(e)}function eCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rCt(n.key),n)}}function tCt(e,t,r){return t&&FX(e.prototype,t),r&&FX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rCt(e){var t=nCt(e,"string");return hg(t)==="symbol"?t:String(t)}function nCt(e,t){if(hg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pc(){return typeof Reflect<"u"&&Reflect.get?pc=Reflect.get.bind():pc=function(t,r,n){var i=iCt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},pc.apply(this,arguments)}function iCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qs(e),e!==null););return e}function aCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nN(e,t)}function nN(e,t){return nN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nN(e,t)}function oCt(e){var t=uCt();return function(){var n=Qs(e),i;if(t){var a=Qs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return sCt(this,i)}}function sCt(e,t){if(t&&(hg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lCt(e)}function lCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qs(e){return Qs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qs(e)}Je.getSingleton().register("persistentStateSave");Je.getSingleton().register("persistentStateLoad");Je.getSingleton().register("persistentStateReset");var HX="persistentState",fCt=0,cCt=function(e){aCt(r,e);var t=oCt(r);function r(n){var i;return eCt(this,r),i=t.call(this,n),i.storage=void 0,i}return tCt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[HX]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new Q1t(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(a,o){return i.saveValue(a,o)}),this.addHook("persistentStateLoad",function(a,o){return i.loadValue(a,o)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),pc(Qs(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,pc(Qs(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pc(Qs(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,a){a.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,a){this.storage.saveValue(i,a)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){pc(Qs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return HX}},{key:"PLUGIN_PRIORITY",get:function(){return fCt}}]),r}(tr);function dg(e){return dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dg(e)}function hCt(e){return gCt(e)||pCt(e)||vCt(e)||dCt()}function dCt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vCt(e,t){if(e){if(typeof e=="string")return iN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iN(e,t)}}function pCt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gCt(e){if(Array.isArray(e))return iN(e)}function iN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bCt(n.key),n)}}function mCt(e,t,r){return t&&BX(e.prototype,t),r&&BX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bCt(e){var t=wCt(e,"string");return dg(t)==="symbol"?t:String(t)}function wCt(e,t){if(dg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gc(){return typeof Reflect<"u"&&Reflect.get?gc=Reflect.get.bind():gc=function(t,r,n){var i=_Ct(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},gc.apply(this,arguments)}function _Ct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=el(e),e!==null););return e}function SCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aN(e,t)}function aN(e,t){return aN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aN(e,t)}function CCt(e){var t=OCt();return function(){var n=el(e),i;if(t){var a=el(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return xCt(this,i)}}function xCt(e,t){if(t&&(dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TCt(e)}function TCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function el(e){return el=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},el(e)}var MP="search",ECt=190,RCt="htSearchResult",kCt=function(t,r,n,i,a){t.getCellMeta(r,n).isSearchResult=a},ACt=function(t,r,n){return pr(t)||t===null||!t.toLocaleLowerCase||t.length===0||pr(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},PCt=function(e){SCt(r,e);var t=CCt(r);function r(n){var i;return yCt(this,r),i=t.call(this,n),i.callback=kCt,i.queryMethod=ACt,i.searchResultClass=RCt,i}return mCt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[MP]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[MP];this.updatePluginSettings(a),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),gc(el(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,a=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",a)}),gc(el(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),gc(el(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return rt(0,l-1,function(h){rt(0,u-1,function(d){var v=a.hot.getDataAtCell(h,d),p=a.hot.getCellMeta(h,d),g=p.search.callback||o,y=p.search.queryMethod||s,m=y(i,v,p);if(m){var b={row:h,col:d,data:v};f.push(b)}g&&g(c,h,d,v,m)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){kt(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,a,o,s,l,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,hCt(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){gc(el(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return MP}},{key:"PLUGIN_PRIORITY",get:function(){return ECt}}]),r}(tr);function vg(e){return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(e)}function ICt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DCt(n.key),n)}}function MCt(e,t,r){return t&&VX(e.prototype,t),r&&VX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DCt(e){var t=$Ct(e,"string");return vg(t)==="symbol"?t:String(t)}function $Ct(e,t){if(vg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jd(){return typeof Reflect<"u"&&Reflect.get?Jd=Reflect.get.bind():Jd=function(t,r,n){var i=NCt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Jd.apply(this,arguments)}function NCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Eu(e),e!==null););return e}function LCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oN(e,t)}function oN(e,t){return oN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oN(e,t)}function FCt(e){var t=VCt();return function(){var n=Eu(e),i;if(t){var a=Eu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return HCt(this,i)}}function HCt(e,t){if(t&&(vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BCt(e)}function BCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VCt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eu(e){return Eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eu(e)}var jCt="touchScroll",WCt=200,UCt=function(e){LCt(r,e);var t=FCt(r);function r(n){var i;return ICt(this,r),i=t.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return MCt(r,[{key:"isEnabled",value:function(){return AF()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),Jd(Eu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Jd(Eu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Jd(Eu(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,a=i.topOverlay,o=i.bottomOverlay,s=i.inlineStartOverlay,l=i.topInlineStartCornerOverlay,u=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(a),o.clone&&this.scrollbars.push(o),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,ne(this.clones,function(i){ke(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,ne(this.clones,function(a){wt(a,"hide-tween"),ke(a,"show-tween")}),this.hot._registerTimeout(function(){ne(i.clones,function(a){wt(a,"show-tween")})},400),ne(this.scrollbars,function(a){a.refresh(),a.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return jCt}},{key:"PLUGIN_PRIORITY",get:function(){return WCt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(tr);function pg(e){return pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pg(e)}function zCt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YCt(n.key),n)}}function GCt(e,t,r){return t&&jX(e.prototype,t),r&&jX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YCt(e){var t=KCt(e,"string");return pg(t)==="symbol"?t:String(t)}function KCt(e,t){if(pg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yc(){return typeof Reflect<"u"&&Reflect.get?yc=Reflect.get.bind():yc=function(t,r,n){var i=XCt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},yc.apply(this,arguments)}function XCt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tl(e),e!==null););return e}function qCt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sN(e,t)}function sN(e,t){return sN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sN(e,t)}function ZCt(e){var t=ext();return function(){var n=tl(e),i;if(t){var a=tl(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return JCt(this,i)}}function JCt(e,t){if(t&&(pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QCt(e)}function QCt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ext(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tl(e){return tl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tl(e)}var O1="trimRows",txt=330,rxt=function(e){qCt(r,e);var t=ZCt(r);function r(n){var i;return zCt(this,r),i=t.call(this,n),i.trimmedRowsMap=null,i}return GCt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[O1]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new g_),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),yc(tl(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,a=this.hot.getSettings()[O1];Array.isArray(a)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),ne(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),yc(tl(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),yc(tl(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var a=this,o=this.getTrimmedRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeTrimRow",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ne(i,function(f){a.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",o,l,s,s&&l.length>o.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.trimRows(a)}},{key:"untrimRows",value:function(i){var a=this.getTrimmedRows(),o=this.isValidConfig(i),s=a,l=this.trimmedRowsMap.getValues().slice(),u=i.length>0;o&&u&&(ne(i,function(c){l[c]=!1}),s=Xr(l,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",a,s,o&&u);f!==!1&&(o&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",a,s,o&&u,o&&s.length<a.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.untrimRows(a)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var a=this.hot.countSourceRows();return i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a})}},{key:"onMapInit",value:function(){var i=this,a=this.hot.getSettings()[O1];Array.isArray(a)&&this.hot.batchExecution(function(){ne(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"destroy",value:function(){yc(tl(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return O1}},{key:"PLUGIN_PRIORITY",get:function(){return txt}}]),r}(tr);function gg(e){return gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gg(e)}function vue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nxt(n.key),n)}}function pue(e,t,r){return t&&WX(e.prototype,t),r&&WX(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nxt(e){var t=ixt(e,"string");return gg(t)==="symbol"?t:String(t)}function ixt(e,t){if(gg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lN(e,t)}function lN(e,t){return lN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lN(e,t)}function yue(e){var t=sxt();return function(){var n=$T(e),i;if(t){var a=$T(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return axt(this,i)}}function axt(e,t){if(t&&(gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oxt(e)}function oxt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sxt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $T(e){return $T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$T(e)}function lxt(e){return cxt(e)||fxt(e)||bue(e)||uxt()}function uxt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fxt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cxt(e){if(Array.isArray(e))return uN(e)}function mue(e,t){return vxt(e)||dxt(e,t)||bue(e,t)||hxt()}function hxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bue(e,t){if(e){if(typeof e=="string")return uN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uN(e,t)}}function uN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dxt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function vxt(e){if(Array.isArray(e))return e}var wue="undoRedo",pxt="undoRedo";function qe(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var i=this,a=r&&r.length;if(a){var o=r.find(function(l){var u=mue(l,4),f=u[2],c=u[3];return f!==c});if(o){var s=function(){var u=r.reduce(function(c,h){return c.push(lxt(h)),c},[]);ne(u,function(c){c[1]=e.propToCol(c[1])});var f=a>1?i.getSelected():[[u[0][0],u[0][1]]];return new qe.ChangeAction(u,f)};t.done(s,n)}}}),e.addHook("afterCreateRow",function(r,n,i){t.done(function(){return new qe.CreateRowAction(r,n)},i)}),e.addHook("beforeRemoveRow",function(r,n,i,a){var o=function(){var l=e.toPhysicalRow(r),u=qn(t.instance.getSourceData(l,0,l+n-1,t.instance.countSourceCols()-1));return new qe.RemoveRowAction(l,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(o,a)}),e.addHook("afterCreateCol",function(r,n,i){t.done(function(){return new qe.CreateColumnAction(r,n)},i)}),e.addHook("beforeRemoveCol",function(r,n,i,a){var o=function(){var l=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];rt(l.length-1,function(p){var g=[],y=l[p];rt(u,u+(n-1),function(m){g.push(y[e.toPhysicalColumn(m)])}),f.push(g)}),rt(n-1,function(p){h.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&rt(n-1,function(p){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new qe.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(o,a)}),e.addHook("beforeCellAlignment",function(r,n,i,a){t.done(function(){return new qe.CellAlignmentAction(r,n,i,a)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new qe.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new qe.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new qe.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new qe.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}qe.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,t);if(i!==!1){var a=e(),o=this.undoneActions.slice();this.doneActions.push(a),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())}}}};qe.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=qn(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",a),t.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};qe.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=qn(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",a),t.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",a,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};qe.prototype.isUndoAvailable=function(){return this.doneActions.length>0};qe.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};qe.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};qe.prototype.isEnabled=function(){return this.enabled};qe.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,mxt(e),this.registerShortcuts(),e.addHook("afterChange",_ue)}};qe.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,bxt(e),this.unregisterShortcuts(),e.removeHook("afterChange",_ue)}};qe.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};qe.Action=function(){};qe.Action.prototype.undo=function(){};qe.Action.prototype.redo=function(){};qe.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};Cl(qe.ChangeAction,qe.Action);qe.ChangeAction.prototype.undo=function(e,t){for(var r=qn(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0),a=0,o=r.length;a<o;a++)r[a].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=mue(r[s],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};qe.ChangeAction.prototype.redo=function(e,t){for(var r=qn(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};qe.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};Cl(qe.CreateRowAction,qe.Action);qe.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};qe.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};qe.RemoveRowAction=function(e,t,r,n,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};Cl(qe.RemoveRowAction,qe.Action);qe.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(a,o){Object.keys(a).forEach(function(s){var l=parseInt(s,10);i.push([r.index+o,isNaN(l)?s:l,a[s]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};qe.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};qe.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};Cl(qe.CreateColumnAction,qe.Action);qe.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};qe.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};qe.RemoveColumnAction=function(e,t,r,n,i,a,o){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=a.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o};Cl(qe.RemoveColumnAction,qe.Action);qe.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),a=function(h,d,v){return v[r.indexes.indexOf(i[d])]},o=this.data.length,s=[],l=0;l<o;l++)s.push(Rt(this.data[l],a));var u=Rt(this.headers,a),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),ne(e.getSourceDataArray(),function(c,h){ne(i,function(d,v){c[d]=s[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&ne(u,function(c,h){e.getSettings().colHeaders[i[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};qe.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};qe.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};qe.CellAlignmentAction.prototype.undo=function(e,t){var r=this;ne(this.range,function(n){n.forAll(function(i,a){i>=0&&a>=0&&e.setCellMeta(i,a,"className",r.stateBefore[i][a]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};qe.CellAlignmentAction.prototype.redo=function(e,t){Kl(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,i,a){return e.setCellMeta(r,n,i,a)}),e.addHookOnce("afterViewRender",t),e.render()};qe.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};Cl(qe.FiltersAction,qe.Action);qe.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};qe.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var gxt=function(e){gue(r,e);var t=yue(r);function r(n,i){var a;vue(this,r),a=t.call(this),a.cellRange=i;var o=a.cellRange.getTopStartCorner(),s=a.cellRange.getBottomEndCorner();return a.rangeData=n.getData(o.row,o.col,s.row,s.col),a}return pue(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange)}}]),r}(qe.Action);qe.MergeCellsAction=gxt;var yxt=function(e){gue(r,e);var t=yue(r);function r(n,i){var a;return vue(this,r),a=t.call(this),a.cellRange=i,a}return pue(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0),i.render()}}]),r}(qe.Action);qe.UnmergeCellsAction=yxt;qe.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};Cl(qe.RowMoveAction,qe.Action);qe.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),i=[].concat(this.rows),a=i.filter(function(f){return f>r.finalIndex}),o=i.filter(function(f){return f<=r.finalIndex}),s=a.sort(function(f,c){return c-f}).concat(o.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};qe.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};qe.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};qe.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(o){return!o.altKey},i={runOnlyIf:n,group:wue};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],i)};qe.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(wue)};function _ue(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function mxt(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function bxt(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var T_=Je.getSingleton();T_.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});T_.register("beforeUndo");T_.register("afterUndo");T_.register("beforeRedo");T_.register("afterRedo");qe.PLUGIN_KEY=pxt;qe.SETTING_KEYS=!0;function wxt(){Gt(Pnt),Gt(rit),Gt(wit),Gt(dat),Gt(Iat),Gt(Dse),Gt(ist),Gt(Lst),Gt(Kse),Gt(Fut),Gt(cft),Gt(Sft),Gt(ole),Gt(Oct),Gt(Sgt),Gt(tyt),Gt(Oyt),Gt(Zyt),Gt(wmt),Gt(l0t),Gt(b0t),Gt(sbt),Gt(mbt),Gt(gwt),Gt(Lwt),Gt(qwt),Gt(xSt),Gt(Y1t),Gt(cCt),Gt(PCt),Gt(UCt),Gt(rxt),Gt(qe)}function Sue(){Utt(),art(),_rt(),Frt(),wxt()}var _xt=vt,Sxt=Ct,Cxt=IO.f,xxt=Sxt(function(){return!Object.getOwnPropertyNames(1)});_xt({target:"Object",stat:!0,forced:xxt},{getOwnPropertyNames:Cxt});function Txt(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),i=n.data("handsontable");if(typeof r!="string"){var a=r||{};return i?i.updateSettings(a):(i=new e.Core(n[0],a),n.data("handsontable",i),i.init()),n}var o;if(i)if(typeof i[r]<"u"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];o=(s=i[r]).call.apply(s,[i].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return o})}var DP,$P,NP,LP,FP;Sue();Txt(ct);ct.__GhostTable=S3;ct._getListenersCounter=Eje;ct._getRegisteredMapsCounter=mKe;ct.EventManager=Nr;var Oxt=[hFe,bFe,L7e,prt,ELe,DVe,yVe,MWe,pFe,bVe,ije,EWe],Ext=[AVe,aje];ct.helper={};ct.dom={};ne(Oxt,function(e){ne(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(ct.helper[t]=e[t])})});ne(Ext,function(e){ne(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(ct.dom[t]=e[t])})});ct.cellTypes=(DP=ct.cellTypes)!==null&&DP!==void 0?DP:{};ne(zZe(),function(e){ct.cellTypes[e]=s3(e)});ct.cellTypes.registerCellType=Ja;ct.cellTypes.getCellType=s3;ct.editors=($P=ct.editors)!==null&&$P!==void 0?$P:{};ne(bje(),function(e){ct.editors["".concat($i(e),"Editor")]=$x(e)});ct.editors.registerEditor=Ri;ct.editors.getEditor=$x;ct.renderers=(NP=ct.renderers)!==null&&NP!==void 0?NP:{};ne(xUe(),function(e){var t=Lx(e);e==="base"&&(ct.renderers.cellDecorator=t),ct.renderers["".concat($i(e),"Renderer")]=t});ct.renderers.registerRenderer=Lo;ct.renderers.getRenderer=Lx;ct.validators=(LP=ct.validators)!==null&&LP!==void 0?LP:{};ne(EUe(),function(e){ct.validators["".concat($i(e),"Validator")]=yH(e)});ct.validators.registerValidator=Rd;ct.validators.getValidator=yH;ct.plugins=(FP=ct.plugins)!==null&&FP!==void 0?FP:{};ne(gH(),function(e){ct.plugins[e]=c_(e)});ct.plugins["".concat($i(tr.PLUGIN_KEY),"Plugin")]=tr;ct.plugins.registerPlugin=Gt;ct.plugins.getPlugin=c_;function pw(e){return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}var We;function ze(e,t,r){return t=Rxt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rxt(e){var t=kxt(e,"string");return pw(t)==="symbol"?t:String(t)}function kxt(e,t){if(pw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ge=ct.languages.dictionaryKeys,Axt=(We={languageCode:"zh-CN"},ze(We,Ge.CONTEXTMENU_ITEMS_ROW_ABOVE,"上方插入行"),ze(We,Ge.CONTEXTMENU_ITEMS_ROW_BELOW,"下方插入行"),ze(We,Ge.CONTEXTMENU_ITEMS_INSERT_LEFT,"左方插入列"),ze(We,Ge.CONTEXTMENU_ITEMS_INSERT_RIGHT,"右方插入列"),ze(We,Ge.CONTEXTMENU_ITEMS_REMOVE_ROW,["移除该行","移除多行"]),ze(We,Ge.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["移除该列","移除多列"]),ze(We,Ge.CONTEXTMENU_ITEMS_UNDO,"撤销"),ze(We,Ge.CONTEXTMENU_ITEMS_REDO,"恢复"),ze(We,Ge.CONTEXTMENU_ITEMS_READ_ONLY,"只读"),ze(We,Ge.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"清空该列"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT,"对齐"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"左对齐"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"水平居中"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"右对齐"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"两端对齐"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"顶端对齐"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"垂直居中"),ze(We,Ge.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"底端对齐"),ze(We,Ge.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"冻结该列"),ze(We,Ge.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"取消冻结"),ze(We,Ge.CONTEXTMENU_ITEMS_BORDERS,"边框"),ze(We,Ge.CONTEXTMENU_ITEMS_BORDERS_TOP,"上"),ze(We,Ge.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"右"),ze(We,Ge.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"下"),ze(We,Ge.CONTEXTMENU_ITEMS_BORDERS_LEFT,"左"),ze(We,Ge.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"移除边框"),ze(We,Ge.CONTEXTMENU_ITEMS_ADD_COMMENT,"插入批注"),ze(We,Ge.CONTEXTMENU_ITEMS_EDIT_COMMENT,"编辑批注"),ze(We,Ge.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"删除批注"),ze(We,Ge.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"只读批注"),ze(We,Ge.CONTEXTMENU_ITEMS_MERGE_CELLS,"合并"),ze(We,Ge.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"取消合并"),ze(We,Ge.CONTEXTMENU_ITEMS_COPY,"复制"),ze(We,Ge.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,"带标题的复制"),ze(We,Ge.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,"带标题组的复制"),ze(We,Ge.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,"仅复制标题"),ze(We,Ge.CONTEXTMENU_ITEMS_CUT,"剪切"),ze(We,Ge.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"插入子行"),ze(We,Ge.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"与母行分离"),ze(We,Ge.CONTEXTMENU_ITEMS_HIDE_COLUMN,["隐藏该列","隐藏多列"]),ze(We,Ge.CONTEXTMENU_ITEMS_SHOW_COLUMN,["显示该列","显示多列"]),ze(We,Ge.CONTEXTMENU_ITEMS_HIDE_ROW,["隐藏该行","隐藏多行"]),ze(We,Ge.CONTEXTMENU_ITEMS_SHOW_ROW,["显示该行","显示多行"]),ze(We,Ge.FILTERS_CONDITIONS_NONE,"无"),ze(We,Ge.FILTERS_CONDITIONS_EMPTY,"为空"),ze(We,Ge.FILTERS_CONDITIONS_NOT_EMPTY,"不为空"),ze(We,Ge.FILTERS_CONDITIONS_EQUAL,"等于"),ze(We,Ge.FILTERS_CONDITIONS_NOT_EQUAL,"不等于"),ze(We,Ge.FILTERS_CONDITIONS_BEGINS_WITH,"开头是"),ze(We,Ge.FILTERS_CONDITIONS_ENDS_WITH,"结尾是"),ze(We,Ge.FILTERS_CONDITIONS_CONTAINS,"包含"),ze(We,Ge.FILTERS_CONDITIONS_NOT_CONTAIN,"不包含"),ze(We,Ge.FILTERS_CONDITIONS_GREATER_THAN,"大于"),ze(We,Ge.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"大于或等于"),ze(We,Ge.FILTERS_CONDITIONS_LESS_THAN,"小于"),ze(We,Ge.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"小于或等于"),ze(We,Ge.FILTERS_CONDITIONS_BETWEEN,"在此范围"),ze(We,Ge.FILTERS_CONDITIONS_NOT_BETWEEN,"不在此范围"),ze(We,Ge.FILTERS_CONDITIONS_AFTER,"之后"),ze(We,Ge.FILTERS_CONDITIONS_BEFORE,"之前"),ze(We,Ge.FILTERS_CONDITIONS_TODAY,"今天"),ze(We,Ge.FILTERS_CONDITIONS_TOMORROW,"明天"),ze(We,Ge.FILTERS_CONDITIONS_YESTERDAY,"昨天"),ze(We,Ge.FILTERS_VALUES_BLANK_CELLS,"空白单元格"),ze(We,Ge.FILTERS_DIVS_FILTER_BY_CONDITION,"按条件过滤"),ze(We,Ge.FILTERS_DIVS_FILTER_BY_VALUE,"按值过滤"),ze(We,Ge.FILTERS_LABELS_CONJUNCTION,"且"),ze(We,Ge.FILTERS_LABELS_DISJUNCTION,"或"),ze(We,Ge.FILTERS_BUTTONS_SELECT_ALL,"全选"),ze(We,Ge.FILTERS_BUTTONS_CLEAR,"清除"),ze(We,Ge.FILTERS_BUTTONS_OK,"确认"),ze(We,Ge.FILTERS_BUTTONS_CANCEL,"取消"),ze(We,Ge.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"搜索"),ze(We,Ge.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"值"),ze(We,Ge.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"第二值"),We);ct.languages.registerLanguageDictionary(Axt);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Cue=1252,Pxt=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N3={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},L3=function(e){Pxt.indexOf(e)!=-1&&(Cue=N3[0]=e)};function Ixt(){L3(1252)}var lo=function(e){L3(e)};function xue(){lo(1200),Ixt()}function UX(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Mxt(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Tue(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var nm=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Mxt(e.slice(2)):t==254&&r==255?Tue(e.slice(2)):t==65279?e.slice(1):e},E1=function(t){return String.fromCharCode(t)},zX=function(t){return String.fromCharCode(t)},Jl,su="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function GX(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),t+=su.charAt(a)+su.charAt(o)+su.charAt(s)+su.charAt(l);return t}function ia(e){var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=su.indexOf(e.charAt(u++)),o=su.indexOf(e.charAt(u++)),r=a<<2|o>>4,t+=String.fromCharCode(r),s=su.indexOf(e.charAt(u++)),n=(o&15)<<4|s>>2,s!==64&&(t+=String.fromCharCode(n)),l=su.indexOf(e.charAt(u++)),i=(s&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var zt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),vh=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Vu(e){return zt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function YX(e){return zt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var io=function(t){return zt?vh(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ph(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function F3(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return F3(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ql=zt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:vh(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Dxt(e){for(var t=[],r=0,n=e.length+250,i=Vu(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|s>>6&15|(o&3)<<4,i[r++]=128|s&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Vu(65535),n=65530)}return t.push(i.slice(0,r)),Ql(t)}var yi=/\u0000/g,im=/[\u0001-\u0006]/g;function Qd(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function uo(e,t){var r=""+e;return r.length>=t?r:Gr("0",t-r.length)+r}function H3(e,t){var r=""+e;return r.length>=t?r:Gr(" ",t-r.length)+r}function NT(e,t){var r=""+e;return r.length>=t?r:r+Gr(" ",t-r.length)}function $xt(e,t){var r=""+Math.round(e);return r.length>=t?r:Gr("0",t-r.length)+r}function Nxt(e,t){var r=""+e;return r.length>=t?r:Gr("0",t-r.length)+r}var KX=Math.pow(2,32);function cd(e,t){if(e>KX||e<-KX)return $xt(e,t);var r=Math.round(e);return Nxt(r,t)}function LT(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var XX=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],HP=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Lxt(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},qX={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Fxt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function FT(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,o=1,s=0,l=1,u=0,f=0,c=Math.floor(i);u<t&&(c=Math.floor(i),s=c*o+a,f=c*u+l,!(i-c<5e-8));)i=1/(i-c),a=o,o=s,l=u,u=f;if(f>t&&(u>t?(f=l,s=a):(f=u,s=o)),!r)return[0,n*s,f];var h=Math.floor(n*s/f);return[h,n*s-h*f,f]}function mc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],s={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,++i==86400&&(s.T=i=0,++n,++s.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=Uxt(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=a,s}var Oue=new Date(1899,11,31,0,0,0),Hxt=Oue.getTime(),Bxt=new Date(1900,2,1,0,0,0);function Eue(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Bxt&&(r+=24*60*60*1e3),(r-(Hxt+(e.getTimezoneOffset()-Oue.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function B3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Vxt(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jxt(e){var t=e<0?12:11,r=B3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Wxt(e){var t=B3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function gw(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jxt(e):t===10?r=e.toFixed(10).substr(0,12):r=Wxt(e),B3(Vxt(r.toUpperCase()))}function Yc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):gw(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ia(14,Eue(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Uxt(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function zxt(e,t,r,n){var i="",a=0,o=0,s=r.y,l,u=0;switch(e){case 98:s=r.y+543;case 121:switch(t.length){case 1:case 2:l=s%100,u=2;break;default:l=s%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return HP[r.m-1][1];case 5:return HP[r.m-1][0];default:return HP[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return XX[r.q][0];default:return XX[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?uo(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=uo(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=s,u=1;break}var f=u>0?uo(l,u):"";return f}function lu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Rue=/%/g;function Gxt(e,t,r){var n=t.replace(Rue,""),i=t.length-n.length;return sl(e,n,r*Math.pow(10,2*i))+Gr("%",i)}function Yxt(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return sl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kue(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+kue(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Aue=/# (\?+)( ?)\/( ?)(\d+)/;function Kxt(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),o=i-a*n,s=n;return r+(a===0?"":""+a)+" "+(o===0?Gr(" ",e[1].length+1+e[4].length):H3(o,e[1].length)+e[2]+"/"+e[3]+uo(s,e[4].length))}function Xxt(e,t,r){return r+(t===0?"":""+t)+Gr(" ",e[1].length+2+e[4].length)}var Pue=/^#*0*\.([0#]+)/,Iue=/\).*[0#]/,Mue=/\(###\) ###\\?-####/;function ci(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ZX(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function JX(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qxt(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Zxt(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function va(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Iue)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?va("n",n,r):"("+va("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Yxt(e,t,r);if(t.indexOf("%")!==-1)return Gxt(e,t,r);if(t.indexOf("E")!==-1)return kue(t,r);if(t.charCodeAt(0)===36)return"$"+va(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+cd(l,t.length);if(t.match(/^[#?]+$/))return i=cd(r,0),i==="0"&&(i=""),i.length>t.length?i:ci(t.substr(0,t.length-i.length))+i;if(a=t.match(Aue))return Kxt(a,l,u);if(t.match(/^#+0+$/))return u+cd(l,t.length-t.indexOf("0"));if(a=t.match(Pue))return i=ZX(r,a[1].length).replace(/^([^\.]+)$/,"$1."+ci(a[1])).replace(/\.$/,"."+ci(a[1])).replace(/\.(\d*)$/,function(v,p){return"."+p+Gr("0",ci(a[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+ZX(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+lu(cd(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+va(e,t,-r):lu(""+(Math.floor(r)+qxt(r,a[1].length)))+"."+uo(JX(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return va(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qd(va(e,t.replace(/[\\-]/g,""),r)),o=0,Qd(Qd(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(Mue))return i=va(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=FT(l,Math.pow(10,o)-1,!1),i=""+u,f=sl("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=NT(s[2],o),f.length<a[4].length&&(f=ci(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=FT(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?H3(s[1],o)+a[2]+"/"+a[3]+NT(s[2],o):Gr(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=cd(r,0),t.length<=i.length?i:ci(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return ci(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=JX(r,a[1].length),r<0?"-"+va(e,t,-r):lu(Zxt(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?uo(0,3-v.length):"")+v})+"."+uo(o,a[1].length);switch(t){case"###,##0.00":return va(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=lu(cd(l,0));return d!=="0"?u+d:"";case"###,###.00":return va(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return va(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Jxt(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return sl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Qxt(e,t,r){var n=t.replace(Rue,""),i=t.length-n.length;return sl(e,n,r*Math.pow(10,2*i))+Gr("%",i)}function Due(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Due(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function No(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Iue)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?No("n",n,r):"("+No("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Jxt(e,t,r);if(t.indexOf("%")!==-1)return Qxt(e,t,r);if(t.indexOf("E")!==-1)return Due(t,r);if(t.charCodeAt(0)===36)return"$"+No(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+uo(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:ci(t.substr(0,t.length-i.length))+i;if(a=t.match(Aue))return Xxt(a,l,u);if(t.match(/^#+0+$/))return u+uo(l,t.length-t.indexOf("0"));if(a=t.match(Pue))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ci(a[1])).replace(/\.$/,"."+ci(a[1])),i=i.replace(/\.(\d*)$/,function(v,p){return"."+p+Gr("0",ci(a[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+lu(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+No(e,t,-r):lu(""+r)+"."+Gr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return No(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qd(No(e,t.replace(/[\\-]/g,""),r)),o=0,Qd(Qd(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(Mue))return i=No(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=FT(l,Math.pow(10,o)-1,!1),i=""+u,f=sl("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=NT(s[2],o),f.length<a[4].length&&(f=ci(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=FT(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?H3(s[1],o)+a[2]+"/"+a[3]+NT(s[2],o):Gr(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:ci(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return ci(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+No(e,t,-r):lu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?uo(0,3-v.length):"")+v})+"."+uo(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=lu(""+l);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return No(e,t.slice(0,t.lastIndexOf(".")),r)+ci(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function sl(e,t,r){return(r|0)===r?No(e,t,r):va(e,t,r)}function eTt(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var $ue=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hg(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":LT(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match($ue))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function tTt(e,t,r,n){for(var i=[],a="",o=0,s="",l="t",u,f,c,h="H";o<e.length;)switch(s=e.charAt(o)){case"G":if(!LT(e,o))throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(c=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(c);i[i.length]={t:"t",v:a},++o;break;case"\\":var d=e.charAt(++o),v=d==="("||d===")"?d:"t";i[i.length]={t:v,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=mc(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=mc(t,r),u==null))return"";for(a=s;++o<e.length&&e.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&l.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=h),i[i.length]={t:s,v:a},l=s;break;case"A":case"a":case"上":var p={t:s,v:s};if(u==null&&(u=mc(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(p.v=u.H>=12?"下午":"上午"),p.t="T",o+=5,h="h"):(p.t="t",++o),u==null&&p.t==="T")return"";i[i.length]=p,l=s;break;case"[":for(a=s;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match($ue)){if(u==null&&(u=mc(t,r),u==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hg(e)||(i[i.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=s;++o<e.length&&(s=e.charAt(o))==="0";)a+=s;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<e.length&&"0#?.,E+-%".indexOf(s=e.charAt(o))>-1;)a+=s;i[i.length]={t:"n",v:a};break;case"?":for(a=s;e.charAt(++o)===s;)a+=s;i[i.length]={t:s,v:a},l=s;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"t",v:s},++o;break}var g=0,y=0,m;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,l="h",g<1&&(g=1);break;case"s":(m=i[o].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[o].v.match(/[Hh]/)&&(g=1),g<2&&i[o].v.match(/[Mm]/)&&(g=2),g<3&&i[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",_;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=zxt(i[o].t.charCodeAt(0),i[o].v,u,y),i[o].t="t";break;case"n":case"?":for(_=o+1;i[_]!=null&&((s=i[_].t)==="?"||s==="D"||(s===" "||s==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[o].v+=i[_].v,i[_]={v:"",t:";"},++_;b+=i[o].v,o=_-1;break;case"G":i[o].t="t",i[o].v=Yc(t,r);break}var x="",T,E;if(b.length>0){b.charCodeAt(0)==40?(T=t<0&&b.charCodeAt(0)===45?-t:t,E=sl("n",b,T)):(T=t<0&&n>1?-t:t,E=sl("n",b,T),T<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),_=E.length-1;var P=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){P=o;break}var R=i.length;if(P===i.length&&E.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(_>=i[o].v.length-1?(_-=i[o].v.length,i[o].v=E.substr(_+1,i[o].v.length)):_<0?i[o].v="":(i[o].v=E.substr(0,_+1),_=-1),i[o].t="t",R=o);_>=0&&R<i.length&&(i[R].v=E.substr(0,_+1)+i[R].v)}else if(P!==i.length&&E.indexOf("E")===-1){for(_=E.indexOf(".")-1,o=P;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(f=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")-1:i[o].v.length-1,x=i[o].v.substr(f+1);f>=0;--f)_>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#")&&(x=E.charAt(_--)+x);i[o].v=x,i[o].t="t",R=o}for(_>=0&&R<i.length&&(i[R].v=E.substr(0,_+1)+i[R].v),_=E.indexOf(".")+1,o=P;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==P)){for(f=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")+1:0,x=i[o].v.substr(0,f);f<i[o].v.length;++f)_<E.length&&(x+=E.charAt(_++));i[o].v=x,i[o].t="t",R=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(T=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=sl(i[o].t,i[o].v,T),i[o].t="t");var M="";for(o=0;o!==i.length;++o)i[o]!=null&&(M+=i[o].v);return M}var QX=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function eq(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function rTt(e,t){var r=eTt(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(QX),s=r[1].match(QX);return eq(t,o)?[n,r[0]]:eq(t,s)?[n,r[1]]:[n,r[o!=null&&s!=null?2:1]]}return[n,a]}function Ia(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Et)[e],n==null&&(n=r.table&&r.table[qX[e]]||Et[qX[e]]),n==null&&(n=Fxt[e]||"General");break}if(LT(n,0))return Yc(t,r);t instanceof Date&&(t=Eue(t,r.date1904));var i=rTt(n,t);if(LT(i[1]))return Yc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return tTt(i[1],t,r,i[0])}function Oc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Et[r]==null){t<0&&(t=r);continue}if(Et[r]==e){t=r;break}}t<0&&(t=391)}return Et[t]=e,t}function Nue(){Et=Lxt()}var nTt={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Lue=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iTt(e){var t=typeof e=="number"?Et[e]:e;return t=t.replace(Lue,"(\\d+)"),new RegExp("^"+t+"$")}function aTt(e,t,r){var n=-1,i=-1,a=-1,o=-1,s=-1,l=-1;(t.match(Lue)||[]).forEach(function(c,h){var d=parseInt(r[h+1],10);switch(c.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?s=d:i=d;break}}),l>=0&&s==-1&&i>=0&&(s=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&s==-1&&l==-1?u:n==-1&&i==-1&&a==-1?f:u+"T"+f}var oTt=function(){var e={};e.version="1.2.0";function t(){for(var E=0,P=new Array(256),R=0;R!=256;++R)E=R,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,P[R]=E;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(E){var P=0,R=0,M=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)D[M]=E[M];for(M=0;M!=256;++M)for(R=E[M],P=256+M;P<4096;P+=256)R=D[P]=R>>>8^E[R&255];var N=[];for(M=1;M!=16;++M)N[M-1]=typeof Int32Array<"u"?D.subarray(M*256,M*256+256):D.slice(M*256,M*256+256);return N}var i=n(r),a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],f=i[5],c=i[6],h=i[7],d=i[8],v=i[9],p=i[10],g=i[11],y=i[12],m=i[13],b=i[14];function _(E,P){for(var R=P^-1,M=0,D=E.length;M<D;)R=R>>>8^r[(R^E.charCodeAt(M++))&255];return~R}function x(E,P){for(var R=P^-1,M=E.length-15,D=0;D<M;)R=b[E[D++]^R&255]^m[E[D++]^R>>8&255]^y[E[D++]^R>>16&255]^g[E[D++]^R>>>24]^p[E[D++]]^v[E[D++]]^d[E[D++]]^h[E[D++]]^c[E[D++]]^f[E[D++]]^u[E[D++]]^l[E[D++]]^s[E[D++]]^o[E[D++]]^a[E[D++]]^r[E[D++]];for(M+=15;D<M;)R=R>>>8^r[(R^E[D++])&255];return~R}function T(E,P){for(var R=P^-1,M=0,D=E.length,N=0,B=0;M<D;)N=E.charCodeAt(M++),N<128?R=R>>>8^r[(R^N)&255]:N<2048?(R=R>>>8^r[(R^(192|N>>6&31))&255],R=R>>>8^r[(R^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,B=E.charCodeAt(M++)&1023,R=R>>>8^r[(R^(240|N>>8&7))&255],R=R>>>8^r[(R^(128|N>>2&63))&255],R=R>>>8^r[(R^(128|B>>6&15|(N&3)<<4))&255],R=R>>>8^r[(R^(128|B&63))&255]):(R=R>>>8^r[(R^(224|N>>12&15))&255],R=R>>>8^r[(R^(128|N>>6&63))&255],R=R>>>8^r[(R^(128|N&63))&255]);return~R}return e.table=r,e.bstr=_,e.buf=x,e.str=T,e}(),Kt=function(){var t={};t.version="1.2.1";function r(F,X){for(var z=F.split("/"),G=X.split("/"),q=0,J=0,_e=Math.min(z.length,G.length);q<_e;++q){if(J=z[q].length-G[q].length)return J;if(z[q]!=G[q])return z[q]<G[q]?-1:1}return z.length-G.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var X=F.lastIndexOf("/");return X===-1?F:F.slice(0,X+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var X=F.lastIndexOf("/");return X===-1?F:F.slice(X+1)}function a(F,X){typeof X=="string"&&(X=new Date(X));var z=X.getHours();z=z<<6|X.getMinutes(),z=z<<5|X.getSeconds()>>>1,F.write_shift(2,z);var G=X.getFullYear()-1980;G=G<<4|X.getMonth()+1,G=G<<5|X.getDate(),F.write_shift(2,G)}function o(F){var X=F.read_shift(2)&65535,z=F.read_shift(2)&65535,G=new Date,q=z&31;z>>>=5;var J=z&15;z>>>=4,G.setMilliseconds(0),G.setFullYear(z+1980),G.setMonth(J-1),G.setDate(q);var _e=X&31;X>>>=5;var xe=X&63;return X>>>=6,G.setHours(X),G.setMinutes(xe),G.setSeconds(_e<<1),G}function s(F){In(F,0);for(var X={},z=0;F.l<=F.length-4;){var G=F.read_shift(2),q=F.read_shift(2),J=F.l+q,_e={};switch(G){case 21589:z=F.read_shift(1),z&1&&(_e.mtime=F.read_shift(4)),q>5&&(z&2&&(_e.atime=F.read_shift(4)),z&4&&(_e.ctime=F.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}F.l=J,X[G]=_e}return X}var l;function u(){return l||(l={})}function f(F,X){if(F[0]==80&&F[1]==75)return Lt(F,X);if((F[0]|32)==109&&(F[1]|32)==105)return je(F,X);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var z=3,G=512,q=0,J=0,_e=0,xe=0,we=0,he=[],W=F.slice(0,512);In(W,0);var ye=c(W);switch(z=ye[0],z){case 3:G=512;break;case 4:G=4096;break;case 0:if(ye[1]==0)return Lt(F,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}G!==512&&(W=F.slice(0,G),In(W,28));var Se=F.slice(0,G);h(W,z);var Pe=W.read_shift(4,"i");if(z===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);W.l+=4,_e=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),xe=W.read_shift(4,"i"),q=W.read_shift(4,"i"),we=W.read_shift(4,"i"),J=W.read_shift(4,"i");for(var Re=-1,Ne=0;Ne<109&&(Re=W.read_shift(4,"i"),!(Re<0));++Ne)he[Ne]=Re;var nt=d(F,G);g(we,J,nt,G,he);var dr=m(nt,_e,he,G);dr[_e].name="!Directory",q>0&&xe!==B&&(dr[xe].name="!MiniFAT"),dr[he[0]].name="!FAT",dr.fat_addrs=he,dr.ssz=G;var Ot={},un=[],El=[],wh=[];b(_e,dr,nt,un,q,Ot,El,xe),v(El,wh,un),un.shift();var jg={FileIndex:El,FullPaths:wh};return X&&X.raw&&(jg.raw={header:Se,sectors:nt}),jg}function c(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(K,"Header Signature: "),F.l+=16;var X=F.read_shift(2,"u");return[F.read_shift(2,"u"),X]}function h(F,X){var z=9;switch(F.l+=2,z=F.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function d(F,X){for(var z=Math.ceil(F.length/X)-1,G=[],q=1;q<z;++q)G[q-1]=F.slice(q*X,(q+1)*X);return G[z-1]=F.slice(z*X),G}function v(F,X,z){for(var G=0,q=0,J=0,_e=0,xe=0,we=z.length,he=[],W=[];G<we;++G)he[G]=W[G]=G,X[G]=z[G];for(;xe<W.length;++xe)G=W[xe],q=F[G].L,J=F[G].R,_e=F[G].C,he[G]===G&&(q!==-1&&he[q]!==q&&(he[G]=he[q]),J!==-1&&he[J]!==J&&(he[G]=he[J])),_e!==-1&&(he[_e]=G),q!==-1&&G!=he[G]&&(he[q]=he[G],W.lastIndexOf(q)<xe&&W.push(q)),J!==-1&&G!=he[G]&&(he[J]=he[G],W.lastIndexOf(J)<xe&&W.push(J));for(G=1;G<we;++G)he[G]===G&&(J!==-1&&he[J]!==J?he[G]=he[J]:q!==-1&&he[q]!==q&&(he[G]=he[q]));for(G=1;G<we;++G)if(F[G].type!==0){if(xe=G,xe!=he[xe])do xe=he[xe],X[G]=X[xe]+"/"+X[G];while(xe!==0&&he[xe]!==-1&&xe!=he[xe]);he[G]=-1}for(X[0]+="/",G=1;G<we;++G)F[G].type!==2&&(X[G]+="/")}function p(F,X,z){for(var G=F.start,q=F.size,J=[],_e=G;z&&q>0&&_e>=0;)J.push(X.slice(_e*N,_e*N+N)),q-=N,_e=Vf(z,_e*4);return J.length===0?yn(0):Ql(J).slice(0,F.size)}function g(F,X,z,G,q){var J=B;if(F===B){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var _e=z[F],xe=(G>>>2)-1;if(!_e)return;for(var we=0;we<xe&&(J=Vf(_e,we*4))!==B;++we)q.push(J);g(Vf(_e,G-4),X-1,z,G,q)}}function y(F,X,z,G,q){var J=[],_e=[];q||(q=[]);var xe=G-1,we=0,he=0;for(we=X;we>=0;){q[we]=!0,J[J.length]=we,_e.push(F[we]);var W=z[Math.floor(we*4/G)];if(he=we*4&xe,G<4+he)throw new Error("FAT boundary crossed: "+we+" 4 "+G);if(!F[W])break;we=Vf(F[W],he)}return{nodes:J,data:fq([_e])}}function m(F,X,z,G){var q=F.length,J=[],_e=[],xe=[],we=[],he=G-1,W=0,ye=0,Se=0,Pe=0;for(W=0;W<q;++W)if(xe=[],Se=W+X,Se>=q&&(Se-=q),!_e[Se]){we=[];var Re=[];for(ye=Se;ye>=0;){Re[ye]=!0,_e[ye]=!0,xe[xe.length]=ye,we.push(F[ye]);var Ne=z[Math.floor(ye*4/G)];if(Pe=ye*4&he,G<4+Pe)throw new Error("FAT boundary crossed: "+ye+" 4 "+G);if(!F[Ne]||(ye=Vf(F[Ne],Pe),Re[ye]))break}J[Se]={nodes:xe,data:fq([we])}}return J}function b(F,X,z,G,q,J,_e,xe){for(var we=0,he=G.length?2:0,W=X[F].data,ye=0,Se=0,Pe;ye<W.length;ye+=128){var Re=W.slice(ye,ye+128);In(Re,64),Se=Re.read_shift(2),Pe=z3(Re,0,Se-he),G.push(Pe);var Ne={name:Pe,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},nt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);nt!==0&&(Ne.ct=_(Re,Re.l-8));var dr=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);dr!==0&&(Ne.mt=_(Re,Re.l-8)),Ne.start=Re.read_shift(4,"i"),Ne.size=Re.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=B,Ne.name=""),Ne.type===5?(we=Ne.start,q>0&&we!==B&&(X[we].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",X[Ne.start]===void 0&&(X[Ne.start]=y(z,Ne.start,X.fat_addrs,X.ssz)),X[Ne.start].name=Ne.name,Ne.content=X[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:we!==B&&Ne.start!==B&&X[we]&&(Ne.content=p(Ne,X[we].data,(X[xe]||{}).data))),Ne.content&&In(Ne.content,0),J[Pe]=Ne,_e.push(Ne)}}function _(F,X){return new Date((Xi(F,X+4)/1e7*Math.pow(2,32)+Xi(F,X)/1e7-11644473600)*1e3)}function x(F,X){return u(),f(l.readFileSync(F),X)}function T(F,X){var z=X&&X.type;switch(z||zt&&Buffer.isBuffer(F)&&(z="buffer"),z||"base64"){case"file":return x(F,X);case"base64":return f(io(ia(F)),X);case"binary":return f(io(F),X)}return f(F,X)}function E(F,X){var z=X||{},G=z.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=G+"/",F.FileIndex[0]={name:G,type:5}),z.CLSID&&(F.FileIndex[0].clsid=z.CLSID),P(F)}function P(F){var X="Sh33tJ5";if(!Kt.find(F,"/"+X)){var z=yn(4);z[0]=55,z[1]=z[3]=50,z[2]=54,F.FileIndex.push({name:X,type:2,content:z,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+X),R(F)}}function R(F,X){E(F);for(var z=!1,G=!1,q=F.FullPaths.length-1;q>=0;--q){var J=F.FileIndex[q];switch(J.type){case 0:G?z=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(J.R*J.L*J.C)&&(z=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!X)){var _e=new Date(1987,1,19),xe=0,we=Object.create?Object.create(null):{},he=[];for(q=0;q<F.FullPaths.length;++q)we[F.FullPaths[q]]=!0,F.FileIndex[q].type!==0&&he.push([F.FullPaths[q],F.FileIndex[q]]);for(q=0;q<he.length;++q){var W=n(he[q][0]);G=we[W],G||(he.push([W,{name:i(W).replace("/",""),type:1,clsid:ie,ct:_e,mt:_e,content:null}]),we[W]=!0)}for(he.sort(function(Pe,Re){return r(Pe[0],Re[0])}),F.FullPaths=[],F.FileIndex=[],q=0;q<he.length;++q)F.FullPaths[q]=he[q][0],F.FileIndex[q]=he[q][1];for(q=0;q<he.length;++q){var ye=F.FileIndex[q],Se=F.FullPaths[q];if(ye.name=i(Se).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||ie,q===0)ye.C=he.length>1?1:-1,ye.size=0,ye.type=5;else if(Se.slice(-1)=="/"){for(xe=q+1;xe<he.length&&n(F.FullPaths[xe])!=Se;++xe);for(ye.C=xe>=he.length?-1:xe,xe=q+1;xe<he.length&&n(F.FullPaths[xe])!=n(Se);++xe);ye.R=xe>=he.length?-1:xe,ye.type=1}else n(F.FullPaths[q+1]||"")==n(Se)&&(ye.R=q+1),ye.type=2}}}function M(F,X){var z=X||{};if(z.fileType=="mad")return Ze(F,z);switch(R(F),z.fileType){case"zip":return bt(F,z)}var G=function(Pe){for(var Re=0,Ne=0,nt=0;nt<Pe.FileIndex.length;++nt){var dr=Pe.FileIndex[nt];if(dr.content){var Ot=dr.content.length;Ot>0&&(Ot<4096?Re+=Ot+63>>6:Ne+=Ot+511>>9)}}for(var un=Pe.FullPaths.length+3>>2,El=Re+7>>3,wh=Re+127>>7,jg=El+Ne+un+wh,Ku=jg+127>>7,VE=Ku<=109?0:Math.ceil((Ku-109)/127);jg+Ku+VE+127>>7>Ku;)VE=++Ku<=109?0:Math.ceil((Ku-109)/127);var fs=[1,VE,Ku,wh,un,Ne,Re,0];return Pe.FileIndex[0].size=Re<<6,fs[7]=(Pe.FileIndex[0].start=fs[0]+fs[1]+fs[2]+fs[3]+fs[4]+fs[5])+(fs[6]+7>>3),fs}(F),q=yn(G[7]<<9),J=0,_e=0;{for(J=0;J<8;++J)q.write_shift(1,Z[J]);for(J=0;J<8;++J)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),J=0;J<3;++J)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,G[2]),q.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),q.write_shift(4,0),q.write_shift(4,1<<12),q.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:B),q.write_shift(4,G[3]),q.write_shift(-4,G[1]?G[0]-1:B),q.write_shift(4,G[1]),J=0;J<109;++J)q.write_shift(-4,J<G[2]?G[1]+J:-1)}if(G[1])for(_e=0;_e<G[1];++_e){for(;J<236+_e*127;++J)q.write_shift(-4,J<G[2]?G[1]+J:-1);q.write_shift(-4,_e===G[1]-1?B:_e+1)}var xe=function(Pe){for(_e+=Pe;J<_e-1;++J)q.write_shift(-4,J+1);Pe&&(++J,q.write_shift(-4,B))};for(_e=J=0,_e+=G[1];J<_e;++J)q.write_shift(-4,me.DIFSECT);for(_e+=G[2];J<_e;++J)q.write_shift(-4,me.FATSECT);xe(G[3]),xe(G[4]);for(var we=0,he=0,W=F.FileIndex[0];we<F.FileIndex.length;++we)W=F.FileIndex[we],W.content&&(he=W.content.length,!(he<4096)&&(W.start=_e,xe(he+511>>9)));for(xe(G[6]+7>>3);q.l&511;)q.write_shift(-4,me.ENDOFCHAIN);for(_e=J=0,we=0;we<F.FileIndex.length;++we)W=F.FileIndex[we],W.content&&(he=W.content.length,!(!he||he>=4096)&&(W.start=_e,xe(he+63>>6)));for(;q.l&511;)q.write_shift(-4,me.ENDOFCHAIN);for(J=0;J<G[4]<<2;++J){var ye=F.FullPaths[J];if(!ye||ye.length===0){for(we=0;we<17;++we)q.write_shift(4,0);for(we=0;we<3;++we)q.write_shift(4,-1);for(we=0;we<12;++we)q.write_shift(4,0);continue}W=F.FileIndex[J],J===0&&(W.start=W.size?W.start-1:B);var Se=J===0&&z.root||W.name;if(he=2*(Se.length+1),q.write_shift(64,Se,"utf16le"),q.write_shift(2,he),q.write_shift(1,W.type),q.write_shift(1,W.color),q.write_shift(-4,W.L),q.write_shift(-4,W.R),q.write_shift(-4,W.C),W.clsid)q.write_shift(16,W.clsid,"hex");else for(we=0;we<4;++we)q.write_shift(4,0);q.write_shift(4,W.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,W.start),q.write_shift(4,W.size),q.write_shift(4,0)}for(J=1;J<F.FileIndex.length;++J)if(W=F.FileIndex[J],W.size>=4096)if(q.l=W.start+1<<9,zt&&Buffer.isBuffer(W.content))W.content.copy(q,q.l,0,W.size),q.l+=W.size+511&-512;else{for(we=0;we<W.size;++we)q.write_shift(1,W.content[we]);for(;we&511;++we)q.write_shift(1,0)}for(J=1;J<F.FileIndex.length;++J)if(W=F.FileIndex[J],W.size>0&&W.size<4096)if(zt&&Buffer.isBuffer(W.content))W.content.copy(q,q.l,0,W.size),q.l+=W.size+63&-64;else{for(we=0;we<W.size;++we)q.write_shift(1,W.content[we]);for(;we&63;++we)q.write_shift(1,0)}if(zt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function D(F,X){var z=F.FullPaths.map(function(we){return we.toUpperCase()}),G=z.map(function(we){var he=we.split("/");return he[he.length-(we.slice(-1)=="/"?2:1)]}),q=!1;X.charCodeAt(0)===47?(q=!0,X=z[0].slice(0,-1)+X):q=X.indexOf("/")!==-1;var J=X.toUpperCase(),_e=q===!0?z.indexOf(J):G.indexOf(J);if(_e!==-1)return F.FileIndex[_e];var xe=!J.match(im);for(J=J.replace(yi,""),xe&&(J=J.replace(im,"!")),_e=0;_e<z.length;++_e)if((xe?z[_e].replace(im,"!"):z[_e]).replace(yi,"")==J||(xe?G[_e].replace(im,"!"):G[_e]).replace(yi,"")==J)return F.FileIndex[_e];return null}var N=64,B=-2,K="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function k(F,X,z){u();var G=M(F,z);l.writeFileSync(X,G)}function w(F){for(var X=new Array(F.length),z=0;z<F.length;++z)X[z]=String.fromCharCode(F[z]);return X.join("")}function C(F,X){var z=M(F,X);switch(X&&X.type||"buffer"){case"file":return u(),l.writeFileSync(X.filename,z),z;case"binary":return typeof z=="string"?z:w(z);case"base64":return GX(typeof z=="string"?z:w(z));case"buffer":if(zt)return Buffer.isBuffer(z)?z:vh(z);case"array":return typeof z=="string"?io(z):z}return z}var O;function S(F){try{var X=F.InflateRaw,z=new X;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)O=F;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function A(F,X){if(!O)return ft(F,X);var z=O.InflateRaw,G=new z,q=G._processChunk(F.slice(F.l),G._finishFlushFlag);return F.l+=G.bytesRead,q}function I(F){return O?O.deflateRawSync(F):de(F)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(F){var X=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(X>>16|X>>8|X)&255}for(var re=typeof Uint8Array<"u",te=re?new Uint8Array(1<<8):[],ge=0;ge<1<<8;++ge)te[ge]=ae(ge);function H(F,X){var z=te[F&255];return X<=8?z>>>8-X:(z=z<<8|te[F>>8&255],X<=16?z>>>16-X:(z=z<<8|te[F>>16&255],z>>>24-X))}function Ce(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=6?0:F[G+1]<<8))>>>z&3}function oe(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=5?0:F[G+1]<<8))>>>z&7}function Oe(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=4?0:F[G+1]<<8))>>>z&15}function Ee(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=3?0:F[G+1]<<8))>>>z&31}function be(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=1?0:F[G+1]<<8))>>>z&127}function Ie(F,X,z){var G=X&7,q=X>>>3,J=(1<<z)-1,_e=F[q]>>>G;return z<8-G||(_e|=F[q+1]<<8-G,z<16-G)||(_e|=F[q+2]<<16-G,z<24-G)||(_e|=F[q+3]<<24-G),_e&J}function Me(F,X,z){var G=X&7,q=X>>>3;return G<=5?F[q]|=(z&7)<<G:(F[q]|=z<<G&255,F[q+1]=(z&7)>>8-G),X+3}function j(F,X,z){var G=X&7,q=X>>>3;return z=(z&1)<<G,F[q]|=z,X+1}function U(F,X,z){var G=X&7,q=X>>>3;return z<<=G,F[q]|=z&255,z>>>=8,F[q+1]=z,X+8}function Q(F,X,z){var G=X&7,q=X>>>3;return z<<=G,F[q]|=z&255,z>>>=8,F[q+1]=z&255,F[q+2]=z>>>8,X+16}function fe(F,X){var z=F.length,G=2*z>X?2*z:X+5,q=0;if(z>=X)return F;if(zt){var J=YX(G);if(F.copy)F.copy(J);else for(;q<F.length;++q)J[q]=F[q];return J}else if(re){var _e=new Uint8Array(G);if(_e.set)_e.set(F);else for(;q<z;++q)_e[q]=F[q];return _e}return F.length=G,F}function ee(F){for(var X=new Array(F),z=0;z<F;++z)X[z]=0;return X}function pe(F,X,z){var G=1,q=0,J=0,_e=0,xe=0,we=F.length,he=re?new Uint16Array(32):ee(32);for(J=0;J<32;++J)he[J]=0;for(J=we;J<z;++J)F[J]=0;we=F.length;var W=re?new Uint16Array(we):ee(we);for(J=0;J<we;++J)he[q=F[J]]++,G<q&&(G=q),W[J]=0;for(he[0]=0,J=1;J<=G;++J)he[J+16]=xe=xe+he[J-1]<<1;for(J=0;J<we;++J)xe=F[J],xe!=0&&(W[J]=he[xe+16]++);var ye=0;for(J=0;J<we;++J)if(ye=F[J],ye!=0)for(xe=H(W[J],G)>>G-ye,_e=(1<<G+4-ye)-1;_e>=0;--_e)X[xe|_e<<ye]=ye&15|J<<4;return G}var se=re?new Uint16Array(512):ee(512),ue=re?new Uint16Array(32):ee(32);if(!re){for(var ce=0;ce<512;++ce)se[ce]=0;for(ce=0;ce<32;++ce)ue[ce]=0}(function(){for(var F=[],X=0;X<32;X++)F.push(5);pe(F,ue,32);var z=[];for(X=0;X<=143;X++)z.push(8);for(;X<=255;X++)z.push(9);for(;X<=279;X++)z.push(7);for(;X<=287;X++)z.push(8);pe(z,se,288)})();var ve=function(){for(var X=re?new Uint8Array(32768):[],z=0,G=0;z<Y.length-1;++z)for(;G<Y[z+1];++G)X[G]=z;for(;G<32768;++G)X[G]=29;var q=re?new Uint8Array(259):[];for(z=0,G=0;z<V.length-1;++z)for(;G<V[z+1];++G)q[G]=z;function J(xe,we){for(var he=0;he<xe.length;){var W=Math.min(65535,xe.length-he),ye=he+W==xe.length;for(we.write_shift(1,+ye),we.write_shift(2,W),we.write_shift(2,~W&65535);W-- >0;)we[we.l++]=xe[he++]}return we.l}function _e(xe,we){for(var he=0,W=0,ye=re?new Uint16Array(32768):[];W<xe.length;){var Se=Math.min(65535,xe.length-W);if(Se<10){for(he=Me(we,he,+(W+Se==xe.length)),he&7&&(he+=8-(he&7)),we.l=he/8|0,we.write_shift(2,Se),we.write_shift(2,~Se&65535);Se-- >0;)we[we.l++]=xe[W++];he=we.l*8;continue}he=Me(we,he,+(W+Se==xe.length)+2);for(var Pe=0;Se-- >0;){var Re=xe[W];Pe=(Pe<<5^Re)&32767;var Ne=-1,nt=0;if((Ne=ye[Pe])&&(Ne|=W&-32768,Ne>W&&(Ne-=32768),Ne<W))for(;xe[Ne+nt]==xe[W+nt]&&nt<250;)++nt;if(nt>2){Re=q[nt],Re<=22?he=U(we,he,te[Re+1]>>1)-1:(U(we,he,3),he+=5,U(we,he,te[Re-23]>>5),he+=3);var dr=Re<8?0:Re-4>>2;dr>0&&(Q(we,he,nt-V[Re]),he+=dr),Re=X[W-Ne],he=U(we,he,te[Re]>>3),he-=3;var Ot=Re<4?0:Re-2>>1;Ot>0&&(Q(we,he,W-Ne-Y[Re]),he+=Ot);for(var un=0;un<nt;++un)ye[Pe]=W&32767,Pe=(Pe<<5^xe[W])&32767,++W;Se-=nt-1}else Re<=143?Re=Re+48:he=j(we,he,1),he=U(we,he,te[Re]),ye[Pe]=W&32767,++W}he=U(we,he,0)-1}return we.l=(he+7)/8|0,we.l}return function(we,he){return we.length<8?J(we,he):_e(we,he)}}();function de(F){var X=yn(50+Math.floor(F.length*1.1)),z=ve(F,X);return X.slice(0,z)}var Te=re?new Uint16Array(32768):ee(32768),$e=re?new Uint16Array(32768):ee(32768),Fe=re?new Uint16Array(128):ee(128),it=1,gt=1;function Ht(F,X){var z=Ee(F,X)+257;X+=5;var G=Ee(F,X)+1;X+=5;var q=Oe(F,X)+4;X+=4;for(var J=0,_e=re?new Uint8Array(19):ee(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,he=re?new Uint8Array(8):ee(8),W=re?new Uint8Array(8):ee(8),ye=_e.length,Se=0;Se<q;++Se)_e[L[Se]]=J=oe(F,X),we<J&&(we=J),he[J]++,X+=3;var Pe=0;for(he[0]=0,Se=1;Se<=we;++Se)W[Se]=Pe=Pe+he[Se-1]<<1;for(Se=0;Se<ye;++Se)(Pe=_e[Se])!=0&&(xe[Se]=W[Pe]++);var Re=0;for(Se=0;Se<ye;++Se)if(Re=_e[Se],Re!=0){Pe=te[xe[Se]]>>8-Re;for(var Ne=(1<<7-Re)-1;Ne>=0;--Ne)Fe[Pe|Ne<<Re]=Re&7|Se<<3}var nt=[];for(we=1;nt.length<z+G;)switch(Pe=Fe[be(F,X)],X+=Pe&7,Pe>>>=3){case 16:for(J=3+Ce(F,X),X+=2,Pe=nt[nt.length-1];J-- >0;)nt.push(Pe);break;case 17:for(J=3+oe(F,X),X+=3;J-- >0;)nt.push(0);break;case 18:for(J=11+be(F,X),X+=7;J-- >0;)nt.push(0);break;default:nt.push(Pe),we<Pe&&(we=Pe);break}var dr=nt.slice(0,z),Ot=nt.slice(z);for(Se=z;Se<286;++Se)dr[Se]=0;for(Se=G;Se<30;++Se)Ot[Se]=0;return it=pe(dr,Te,286),gt=pe(Ot,$e,30),X}function ut(F,X){if(F[0]==3&&!(F[1]&3))return[Vu(X),2];for(var z=0,G=0,q=YX(X||1<<18),J=0,_e=q.length>>>0,xe=0,we=0;!(G&1);){if(G=oe(F,z),z+=3,G>>>1)G>>1==1?(xe=9,we=5):(z=Ht(F,z),xe=it,we=gt);else{z&7&&(z+=8-(z&7));var he=F[z>>>3]|F[(z>>>3)+1]<<8;if(z+=32,he>0)for(!X&&_e<J+he&&(q=fe(q,J+he),_e=q.length);he-- >0;)q[J++]=F[z>>>3],z+=8;continue}for(;;){!X&&_e<J+32767&&(q=fe(q,J+32767),_e=q.length);var W=Ie(F,z,xe),ye=G>>>1==1?se[W]:Te[W];if(z+=ye&15,ye>>>=4,!(ye>>>8&255))q[J++]=ye;else{if(ye==256)break;ye-=257;var Se=ye<8?0:ye-4>>2;Se>5&&(Se=0);var Pe=J+V[ye];Se>0&&(Pe+=Ie(F,z,Se),z+=Se),W=Ie(F,z,we),ye=G>>>1==1?ue[W]:$e[W],z+=ye&15,ye>>>=4;var Re=ye<4?0:ye-2>>1,Ne=Y[ye];for(Re>0&&(Ne+=Ie(F,z,Re),z+=Re),!X&&_e<Pe&&(q=fe(q,Pe+100),_e=q.length);J<Pe;)q[J]=q[J-Ne],++J}}}return X?[q,z+7>>>3]:[q.slice(0,J),z+7>>>3]}function ft(F,X){var z=F.slice(F.l||0),G=ut(z,X);return F.l+=G[1],G[0]}function Tt(F,X){if(F)typeof console<"u"&&console.error(X);else throw new Error(X)}function Lt(F,X){var z=F;In(z,0);var G=[],q=[],J={FileIndex:G,FullPaths:q};E(J,{root:X.root});for(var _e=z.length-4;(z[_e]!=80||z[_e+1]!=75||z[_e+2]!=5||z[_e+3]!=6)&&_e>=0;)--_e;z.l=_e+4,z.l+=4;var xe=z.read_shift(2);z.l+=6;var we=z.read_shift(4);for(z.l=we,_e=0;_e<xe;++_e){z.l+=20;var he=z.read_shift(4),W=z.read_shift(4),ye=z.read_shift(2),Se=z.read_shift(2),Pe=z.read_shift(2);z.l+=8;var Re=z.read_shift(4),Ne=s(z.slice(z.l+ye,z.l+ye+Se));z.l+=ye+Se+Pe;var nt=z.l;z.l=Re+4,It(z,he,W,J,Ne),z.l=nt}return J}function It(F,X,z,G,q){F.l+=2;var J=F.read_shift(2),_e=F.read_shift(2),xe=o(F);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var we=F.read_shift(4),he=F.read_shift(4),W=F.read_shift(4),ye=F.read_shift(2),Se=F.read_shift(2),Pe="",Re=0;Re<ye;++Re)Pe+=String.fromCharCode(F[F.l++]);if(Se){var Ne=s(F.slice(F.l,F.l+Se));(Ne[21589]||{}).mt&&(xe=Ne[21589].mt),((q||{})[21589]||{}).mt&&(xe=q[21589].mt)}F.l+=Se;var nt=F.slice(F.l,F.l+he);switch(_e){case 8:nt=A(F,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var dr=!1;J&8&&(we=F.read_shift(4),we==134695760&&(we=F.read_shift(4),dr=!0),he=F.read_shift(4),W=F.read_shift(4)),he!=X&&Tt(dr,"Bad compressed size: "+X+" != "+he),W!=z&&Tt(dr,"Bad uncompressed size: "+z+" != "+W),Ut(G,Pe,nt,{unsafe:!0,mt:xe})}function bt(F,X){var z=X||{},G=[],q=[],J=yn(1),_e=z.compression?8:0,xe=0,we=0,he=0,W=0,ye=0,Se=F.FullPaths[0],Pe=Se,Re=F.FileIndex[0],Ne=[],nt=0;for(we=1;we<F.FullPaths.length;++we)if(Pe=F.FullPaths[we].slice(Se.length),Re=F.FileIndex[we],!(!Re.size||!Re.content||Pe=="Sh33tJ5")){var dr=W,Ot=yn(Pe.length);for(he=0;he<Pe.length;++he)Ot.write_shift(1,Pe.charCodeAt(he)&127);Ot=Ot.slice(0,Ot.l),Ne[ye]=oTt.buf(Re.content,0);var un=Re.content;_e==8&&(un=I(un)),J=yn(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,xe),J.write_shift(2,_e),Re.mt?a(J,Re.mt):J.write_shift(4,0),J.write_shift(-4,Ne[ye]),J.write_shift(4,un.length),J.write_shift(4,Re.content.length),J.write_shift(2,Ot.length),J.write_shift(2,0),W+=J.length,G.push(J),W+=Ot.length,G.push(Ot),W+=un.length,G.push(un),J=yn(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,xe),J.write_shift(2,_e),J.write_shift(4,0),J.write_shift(-4,Ne[ye]),J.write_shift(4,un.length),J.write_shift(4,Re.content.length),J.write_shift(2,Ot.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,dr),nt+=J.l,q.push(J),nt+=Ot.length,q.push(Ot),++ye}return J=yn(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,ye),J.write_shift(2,ye),J.write_shift(4,nt),J.write_shift(4,W),J.write_shift(2,0),Ql([Ql(G),Ql(q),J])}var ht={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ke(F,X){if(F.ctype)return F.ctype;var z=F.name||"",G=z.match(/\.([^\.]+)$/);return G&&ht[G[1]]||X&&(G=(z=X).match(/[\.\\]([^\.\\])+$/),G&&ht[G[1]])?ht[G[1]]:"application/octet-stream"}function Be(F){for(var X=GX(F),z=[],G=0;G<X.length;G+=76)z.push(X.slice(G,G+76));return z.join(`\r
`)+`\r
`}function at(F){var X=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var W=he.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],G=X.split(`\r
`),q=0;q<G.length;++q){var J=G[q];if(J.length==0){z.push("");continue}for(var _e=0;_e<J.length;){var xe=76,we=J.slice(_e,_e+xe);we.charAt(xe-1)=="="?xe--:we.charAt(xe-2)=="="?xe-=2:we.charAt(xe-3)=="="&&(xe-=3),we=J.slice(_e,_e+xe),_e+=xe,_e<J.length&&(we+="="),z.push(we)}}return z.join(`\r
`)}function He(F){for(var X=[],z=0;z<F.length;++z){for(var G=F[z];z<=F.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+F[++z];X.push(G)}for(var q=0;q<X.length;++q)X[q]=X[q].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return io(X.join(`\r
`))}function ot(F,X,z){for(var G="",q="",J="",_e,xe=0;xe<10;++xe){var we=X[xe];if(!we||we.match(/^\s*$/))break;var he=we.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":G=he[2].trim();break;case"content-type":J=he[2].trim();break;case"content-transfer-encoding":q=he[2].trim();break}}switch(++xe,q.toLowerCase()){case"base64":_e=io(ia(X.slice(xe).join("")));break;case"quoted-printable":_e=He(X.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var W=Ut(F,G.slice(z.length),_e,{unsafe:!0});J&&(W.ctype=J)}function je(F,X){if(w(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=X&&X.root||"",G=(zt&&Buffer.isBuffer(F)?F.toString("binary"):w(F)).split(`\r
`),q=0,J="";for(q=0;q<G.length;++q)if(J=G[q],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),z||(z=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),J.slice(0,z.length)!=z););var _e=(G[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var xe="--"+(_e[1]||""),we=[],he=[],W={FileIndex:we,FullPaths:he};E(W);var ye,Se=0;for(q=0;q<G.length;++q){var Pe=G[q];Pe!==xe&&Pe!==xe+"--"||(Se++&&ot(W,G.slice(ye,q),z),ye=q)}return W}function Ze(F,X){var z=X||{},G=z.boundary||"SheetJS";G="------="+G;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],J=F.FullPaths[0],_e=J,xe=F.FileIndex[0],we=1;we<F.FullPaths.length;++we)if(_e=F.FullPaths[we].slice(J.length),xe=F.FileIndex[we],!(!xe.size||!xe.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var he=xe.content,W=zt&&Buffer.isBuffer(he)?he.toString("binary"):w(he),ye=0,Se=Math.min(1024,W.length),Pe=0,Re=0;Re<=Se;++Re)(Pe=W.charCodeAt(Re))>=32&&Pe<128&&++ye;var Ne=ye>=Se*4/5;q.push(G),q.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+_e),q.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),q.push("Content-Type: "+Ke(xe,_e)),q.push(""),q.push(Ne?at(W):Be(W))}return q.push(G+`--\r
`),q.join(`\r
`)}function Wt(F){var X={};return E(X,F),X}function Ut(F,X,z,G){var q=G&&G.unsafe;q||E(F);var J=!q&&Kt.find(F,X);if(!J){var _e=F.FullPaths[0];X.slice(0,_e.length)==_e?_e=X:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+X).replace("//","/")),J={name:i(X),type:2},F.FileIndex.push(J),F.FullPaths.push(_e),q||Kt.utils.cfb_gc(F)}return J.content=z,J.size=z?z.length:0,G&&(G.CLSID&&(J.clsid=G.CLSID),G.mt&&(J.mt=G.mt),G.ct&&(J.ct=G.ct)),J}function Jt(F,X){E(F);var z=Kt.find(F,X);if(z){for(var G=0;G<F.FileIndex.length;++G)if(F.FileIndex[G]==z)return F.FileIndex.splice(G,1),F.FullPaths.splice(G,1),!0}return!1}function kn(F,X,z){E(F);var G=Kt.find(F,X);if(G){for(var q=0;q<F.FileIndex.length;++q)if(F.FileIndex[q]==G)return F.FileIndex[q].name=i(z),F.FullPaths[q]=z,!0}return!1}function hr(F){R(F,!0)}return t.find=D,t.read=T,t.parse=f,t.write=C,t.writeFile=k,t.utils={cfb_new:Wt,cfb_add:Ut,cfb_del:Jt,cfb_mov:kn,cfb_gc:hr,ReadShift:Fm,CheckField:ofe,prep_blob:In,bconcat:Ql,use_zlib:S,_deflateRaw:de,_inflateRaw:ft,consts:me},t}();function sTt(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Jo(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function V3(e){for(var t=[],r=Jo(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var HT=new Date(1899,11,30,0,0,0);function wi(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=HT.getTime()+(e.getTimezoneOffset()-HT.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Fue=new Date,lTt=HT.getTime()+(Fue.getTimezoneOffset()-HT.getTimezoneOffset())*6e4,tq=Fue.getTimezoneOffset();function LE(e){var t=new Date;return t.setTime(e*24*60*60*1e3+lTt),t.getTimezoneOffset()!==tq&&t.setTime(t.getTime()+(t.getTimezoneOffset()-tq)*6e4),t}function uTt(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var rq=new Date("2017-02-19T19:06:09.000Z"),Hue=isNaN(rq.getFullYear())?new Date("2/19/17"):rq,fTt=Hue.getFullYear()==2017;function Rn(e,t){var r=new Date(e);if(fTt)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Hue.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Kc(e,t){if(zt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return om(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return om(Tue(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return om(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return om(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Dn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Dn(e[r]));return t}function Gr(e,t){for(var r="";r.length<t;)r+=e;return r}function fo(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var cTt=["january","february","march","april","may","june","july","august","september","october","november","december"];function yg(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&cTt.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var hTt=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],s=1;s<a.length;++s)o.push(i),o.push(a[s]);return o}}();function Bue(e){return e?e.content&&e.type?Kc(e.content,!0):e.data?nm(e.data):e.asNodeBuffer&&zt?nm(e.asNodeBuffer().toString("binary")):e.asBinary?nm(e.asBinary()):e._data&&e._data.getContent?nm(Kc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Vue(e){if(!e)return null;if(e.data)return UX(e.data);if(e.asNodeBuffer&&zt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?UX(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function dTt(e){return e&&e.name.slice(-4)===".bin"?Vue(e):Bue(e)}function ya(e,t){for(var r=e.FullPaths||Jo(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function j3(e,t){var r=ya(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function cn(e,t,r){if(!r)return dTt(j3(e,t));if(!t)return null;try{return cn(e,t)}catch{return null}}function Zi(e,t,r){if(!r)return Bue(j3(e,t));if(!t)return null;try{return Zi(e,t)}catch{return null}}function jue(e,t,r){if(!r)return Vue(j3(e,t));if(!t)return null;try{return jue(e,t)}catch{return null}}function nq(e){for(var t=e.FullPaths||Jo(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vTt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return zt?n=vh(r):n=Dxt(r),Kt.utils.cfb_add(e,t,n)}Kt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Wue(e,t){switch(t.type){case"base64":return Kt.read(e,{type:"base64"});case"binary":return Kt.read(e,{type:"binary"});case"buffer":case"array":return Kt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function am(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Uue=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,pTt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,iq=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,gTt=/<[^>]*>/g,ei=Uue.match(iq)?iq:gTt,yTt=/<\w*:/,mTt=/<(\/?)\w+:/;function yt(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(pTt),s=0,l="",u=0,f="",c="",h=1;if(o)for(u=0;u!=o.length;++u){for(c=o[u],a=0;a!=c.length&&c.charCodeAt(a)!==61;++a);for(f=c.slice(0,a).trim();c.charCodeAt(a+1)==32;)++a;for(h=(i=c.charCodeAt(a+1))==34||i==39?1:0,l=c.slice(a+1+h,c.length-h),s=0;s!=f.length&&f.charCodeAt(s)!==58;++s);if(s===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,r||(n[f.toLowerCase()]=l);else{var d=(s===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(s+1);if(n[d]&&f.slice(s-3,s)=="ext")continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function ls(e){return e.replace(mTt,"<$1")}var zue={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},bTt=V3(zue),er=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(s,l){return zue[s]||String.fromCharCode(parseInt(l,s.indexOf("x")>-1?16:10))||s}).replace(t,function(s,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),wTt=/[&<>'"]/g,_Tt=/[\u0000-\u001f]/g;function W3(e){var t=e+"";return t.replace(wTt,function(r){return bTt[r]}).replace(/\n/g,"<br/>").replace(_Tt,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var aq=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Ir(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function BP(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),s=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(s&1023))}return t}function oq(e){var t=Vu(2*e.length),r,n,i=1,a=0,o=0,s;for(n=0;n<e.length;n+=i)i=1,(s=e.charCodeAt(n))<128?r=s:s<224?(r=(s&31)*64+(e.charCodeAt(n+1)&63),i=2):s<240?(r=(s&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(s&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function sq(e){return vh(e,"binary").toString("utf8")}var R1="foo bar bazâð£",Cr=zt&&(sq(R1)==BP(R1)&&sq||oq(R1)==BP(R1)&&oq)||BP,om=zt?function(e){return vh(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},yw=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Gue=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),STt=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),CTt=/<\/?(?:vt:)?variant>/g,xTt=/<(?:vt:)([^>]*)>([\s\S]*)</;function lq(e,t){var r=yt(e),n=e.match(STt(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(CTt,"").match(xTt);o&&i.push({v:Cr(o[2]),t:o[1]})}),i}var TTt=/(^\s|\s$|\n)/;function OTt(e){return Jo(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ETt(e,t,r){return"<"+e+(r!=null?OTt(r):"")+(t!=null?(t.match(TTt)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function U3(e){if(zt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Cr(ph(F3(e)));throw new Error("Bad input format: expected Buffer or string")}var mw=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,RTt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},kTt=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function ATt(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function PTt(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=n?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var s=0;s<=5;++s,a/=256)e[r+s]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var uq=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},fq=zt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:vh(t)})):uq(e)}:uq,cq=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(rl(e,i)));return n.join("").replace(yi,"")},z3=zt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(yi,""):cq(e,t,r)}:cq,hq=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Yue=zt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):hq(e,t,r)}:hq,dq=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(md(e,i)));return n.join("")},O_=zt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):dq(t,r,n)}:dq,Kue=function(e,t){var r=Xi(e,t);return r>0?O_(e,t+4,t+4+r-1):""},Xue=Kue,que=function(e,t){var r=Xi(e,t);return r>0?O_(e,t+4,t+4+r-1):""},Zue=que,Jue=function(e,t){var r=2*Xi(e,t);return r>0?O_(e,t+4,t+4+r-1):""},Que=Jue,efe=function(t,r){var n=Xi(t,r);return n>0?z3(t,r+4,r+4+n):""},tfe=efe,rfe=function(e,t){var r=Xi(e,t);return r>0?O_(e,t+4,t+4+r):""},nfe=rfe,ife=function(e,t){return ATt(e,t)},BT=ife,afe=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};zt&&(Xue=function(t,r){if(!Buffer.isBuffer(t))return Kue(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Zue=function(t,r){if(!Buffer.isBuffer(t))return que(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Que=function(t,r){if(!Buffer.isBuffer(t))return Jue(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},tfe=function(t,r){if(!Buffer.isBuffer(t))return efe(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},nfe=function(t,r){if(!Buffer.isBuffer(t))return rfe(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},BT=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):ife(t,r)},afe=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var md=function(e,t){return e[t]},rl=function(e,t){return e[t+1]*(1<<8)+e[t]},ITt=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Xi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Vf=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},MTt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Fm(e,t){var r="",n,i,a=[],o,s,l,u;switch(t){case"dbcs":if(u=this.l,zt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(rl(this,u)),u+=2;e*=2;break;case"utf8":r=O_(this,this.l,this.l+e);break;case"utf16le":e*=2,r=z3(this,this.l,this.l+e);break;case"wstr":return Fm.call(this,e,"dbcs");case"lpstr-ansi":r=Xue(this,this.l),e=4+Xi(this,this.l);break;case"lpstr-cp":r=Zue(this,this.l),e=4+Xi(this,this.l);break;case"lpwstr":r=Que(this,this.l),e=4+2*Xi(this,this.l);break;case"lpp4":e=4+Xi(this,this.l),r=tfe(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Xi(this,this.l),r=nfe(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=md(this,this.l+e++))!==0;)a.push(E1(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=rl(this,this.l+e))!==0;)a.push(E1(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=md(this,u),this.l=u+1,s=Fm.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(E1(rl(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=md(this,u),this.l=u+1,s=Fm.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push(E1(md(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=md(this,this.l),this.l++,n;case 2:return n=(t==="i"?ITt:rl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Vf:MTt)(this,this.l),this.l+=4,n):(i=Xi(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=BT(this,this.l):i=BT([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Yue(this,this.l,e);break}}return this.l+=e,r}var DTt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},$Tt=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},NTt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function LTt(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)NTt(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,DTt(this,t,this.l);break;case 8:if(n=8,r==="f"){PTt(this,t,this.l);break}case 16:break;case-4:n=4,$Tt(this,t,this.l);break}return this.l+=n,this}function ofe(e,t){var r=Yue(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function In(e,t){e.l=t,e.read_shift=Fm,e.chk=ofe,e.write_shift=LTt}function Zn(e,t){e.l+=t}function yn(e){var t=Vu(e);return In(t,0),t}function Ol(e,t,r){if(e){var n,i,a;In(e,e.l||0);for(var o=e.length,s=0,l=0;e.l<o;){s=e.read_shift(1),s&128&&(s=(s&127)+((e.read_shift(1)&127)<<7));var u=GT[s]||GT[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;l=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=l,t(f,u,s))return}}}function fN(){var e=[],t=zt?256:2048,r=function(u){var f=yn(u);return In(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Ql(e)},s=function(u){i(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:s,end:o,_bufs:e}}function Hm(e,t,r){var n=Dn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vq(e,t,r){var n=Dn(e);return n.s=Hm(n.s,t.s,r),n.e=Hm(n.e,t.s,r),n}function Bm(e,t){if(e.cRel&&e.c<0)for(e=Dn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Dn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=_t(e);return!e.cRel&&e.cRel!=null&&(r=BTt(r)),!e.rRel&&e.rRel!=null&&(r=FTt(r)),r}function VP(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+wn(e.s.c)+":"+(e.e.cRel?"":"$")+wn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$n(e.s.r)+":"+(e.e.rRel?"":"$")+$n(e.e.r):Bm(e.s,t.biff)+":"+Bm(e.e,t.biff)}function G3(e){return parseInt(HTt(e),10)-1}function $n(e){return""+(e+1)}function FTt(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function HTt(e){return e.replace(/\$(\d+)$/,"$1")}function Y3(e){for(var t=VTt(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function wn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function BTt(e){return e.replace(/^([A-Z])/,"$$$1")}function VTt(e){return e.replace(/^\$([A-Z])/,"$1")}function jTt(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pi(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function _t(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Bg(e){var t=e.indexOf(":");return t==-1?{s:pi(e),e:pi(e)}:{s:pi(e.slice(0,t)),e:pi(e.slice(t+1))}}function qt(e,t){return typeof t>"u"||typeof t=="number"?qt(e.s,e.e):(typeof e!="string"&&(e=_t(e)),typeof t!="string"&&(t=_t(t)),e==t?e:e+":"+t)}function Yr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function pq(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ia(e.z,r?wi(t):t)}catch{}try{return e.w=Ia((e.XF||{}).numFmtId||(r?14:0),r?wi(t):t)}catch{return""+t}}function yl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?mh[e.v]||e.v:t==null?pq(e,e.v):pq(e,t))}function Yu(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function sfe(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),o=0,s=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?pi(n.origin):n.origin;o=l.r,s=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Yr(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(u.e.r=o=f.e.r+1)}for(var c=0;c!=t.length;++c)if(t[c]){if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[c].length;++h)if(!(typeof t[c][h]>"u")){var d={v:t[c][h]},v=o+c,p=s+h;if(u.s.r>v&&(u.s.r=v),u.s.c>p&&(u.s.c=p),u.e.r<v&&(u.e.r=v),u.e.c<p&&(u.e.c=p),t[c][h]&&typeof t[c][h]=="object"&&!Array.isArray(t[c][h])&&!(t[c][h]instanceof Date))d=t[c][h];else if(Array.isArray(d.v)&&(d.f=t[c][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Et[14],n.cellDates?(d.t="d",d.w=Ia(d.z,wi(d.v))):(d.t="n",d.v=wi(d.v),d.w=Ia(d.z,d.v))):d.t="s";if(i)a[v]||(a[v]=[]),a[v][p]&&a[v][p].z&&(d.z=a[v][p].z),a[v][p]=d;else{var g=_t({c:p,r:v});a[g]&&a[g].z&&(d.z=a[g].z),a[g]=d}}}return u.s.c<1e7&&(a["!ref"]=qt(u)),a}function Vg(e,t){return sfe(null,e,t)}function WTt(e){return e.read_shift(4,"i")}function Yn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function UTt(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function K3(e,t){var r=e.l,n=e.read_shift(1),i=Yn(e),a=[],o={t:i,h:i};if(n&1){for(var s=e.read_shift(4),l=0;l!=s;++l)a.push(UTt(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var zTt=K3;function Ba(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function gh(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var GTt=Yn;function X3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var YTt=Yn,cN=X3;function q3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?BT([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Vf(t,0)>>2;return r?i/100:i}function lfe(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var yh=lfe;function Wn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function KTt(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=Ec[i];u&&(t.rgb=ww(u));break;case 2:t.rgb=ww([o,s,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function XTt(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function ufe(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function qTt(e){return ufe(e,1)}function ZTt(e){return ufe(e,2)}var Z3=2,Ai=3,k1=11,gq=12,VT=19,A1=64,JTt=65,QTt=71,eOt=4108,tOt=4126,On=80,ffe=81,rOt=[On,ffe],nOt={1:{n:"CodePage",t:Z3},2:{n:"Category",t:On},3:{n:"PresentationFormat",t:On},4:{n:"ByteCount",t:Ai},5:{n:"LineCount",t:Ai},6:{n:"ParagraphCount",t:Ai},7:{n:"SlideCount",t:Ai},8:{n:"NoteCount",t:Ai},9:{n:"HiddenCount",t:Ai},10:{n:"MultimediaClipCount",t:Ai},11:{n:"ScaleCrop",t:k1},12:{n:"HeadingPairs",t:eOt},13:{n:"TitlesOfParts",t:tOt},14:{n:"Manager",t:On},15:{n:"Company",t:On},16:{n:"LinksUpToDate",t:k1},17:{n:"CharacterCount",t:Ai},19:{n:"SharedDoc",t:k1},22:{n:"HyperlinksChanged",t:k1},23:{n:"AppVersion",t:Ai,p:"version"},24:{n:"DigSig",t:JTt},26:{n:"ContentType",t:On},27:{n:"ContentStatus",t:On},28:{n:"Language",t:On},29:{n:"Version",t:On},255:{},2147483648:{n:"Locale",t:VT},2147483651:{n:"Behavior",t:VT},1919054434:{}},iOt={1:{n:"CodePage",t:Z3},2:{n:"Title",t:On},3:{n:"Subject",t:On},4:{n:"Author",t:On},5:{n:"Keywords",t:On},6:{n:"Comments",t:On},7:{n:"Template",t:On},8:{n:"LastAuthor",t:On},9:{n:"RevNumber",t:On},10:{n:"EditTime",t:A1},11:{n:"LastPrinted",t:A1},12:{n:"CreatedDate",t:A1},13:{n:"ModifiedDate",t:A1},14:{n:"PageCount",t:Ai},15:{n:"WordCount",t:Ai},16:{n:"CharCount",t:Ai},17:{n:"Thumbnail",t:QTt},18:{n:"Application",t:On},19:{n:"DocSecurity",t:Ai},255:{},2147483648:{n:"Locale",t:VT},2147483651:{n:"Behavior",t:VT},1919054434:{}},yq={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},aOt=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function oOt(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var sOt=oOt([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ec=Dn(sOt),mh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cfe={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},mq={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function lOt(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function uOt(e){var t=lOt();if(!e||!e.match)return t;var r={};if((e.match(ei)||[]).forEach(function(n){var i=yt(n);switch(i[0].replace(yTt,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[mq[i.ContentType]]!==void 0&&t[mq[i.ContentType]].push(i.PartName);break}}),t.xmlns!==RTt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Ad={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hN(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Vm(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ei)||[]).forEach(function(i){var a=yt(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var s=a.TargetMode==="External"?a.Target:am(a.Target,t);r[s]=o,n[a.Id]=o}}),r["!id"]=n,r}var fOt="application/vnd.oasis.opendocument.spreadsheet";function cOt(e,t){for(var r=U3(e),n,i;n=mw.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=yt(n[0],!1),i.path=="/"&&i.type!==fOt)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var jm=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],hOt=function(){for(var e=new Array(jm.length),t=0;t<jm.length;++t){var r=jm[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function hfe(e){var t={};e=Cr(e);for(var r=0;r<jm.length;++r){var n=jm[r],i=e.match(hOt[r]);i!=null&&i.length>0&&(t[n[1]]=er(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Rn(t[n[1]]))}return t}var dOt=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function dfe(e,t,r,n){var i=[];if(typeof e=="string")i=lq(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(f){return{v:f}}));var o=typeof t=="string"?lq(t,n).map(function(f){return f.v}):t,s=0,l=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=o.slice(s,s+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(s,s+l);break}s+=l}}function vOt(e,t,r){var n={};return t||(t={}),e=Cr(e),dOt.forEach(function(i){var a=(e.match(yw(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=er(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&dfe(n.HeadingPairs,n.TitlesOfParts,t,r),t}var pOt=/<[^>]+>[^<]*/g;function gOt(e,t){var r={},n="",i=e.match(pOt);if(i)for(var a=0;a!=i.length;++a){var o=i[a],s=yt(o);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":n=er(s.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=er(f);break;case"bool":r[n]=Ir(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Rn(f);break;case"cy":case"error":r[n]=er(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var yOt={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jP;function mOt(e,t,r){jP||(jP=V3(yOt)),t=jP[t]||t,e[t]=r}function J3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vfe(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function pfe(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function gfe(e,t,r){return t===31?pfe(e):vfe(e,t,r)}function dN(e,t,r){return gfe(e,t,r===!1?0:4)}function bOt(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return gfe(e,t,0)}function wOt(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(yi,""),e.l-i&2&&(e.l+=2)}return r}function _Ot(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(yi,"");return r}function SOt(e){var t=e.l,r=jT(e,ffe);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=jT(e,Ai);return[r,n]}function COt(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(SOt(e));return r}function bq(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(yi,"").replace(im,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function yfe(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function xOt(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function jT(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==gq&&n!==t&&rOt.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===gq?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return vfe(e,n,4).replace(yi,"");case 31:return pfe(e);case 64:return J3(e);case 65:return yfe(e);case 71:return xOt(e);case 80:return dN(e,n,!a.raw).replace(yi,"");case 81:return bOt(e,n).replace(yi,"");case 4108:return COt(e);case 4126:case 4127:return n==4127?wOt(e):_Ot(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function wq(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,s=0,l=-1,u={};for(o=0;o!=i;++o){var f=e.read_shift(4),c=e.read_shift(4);a[o]=[f,c+r]}a.sort(function(m,b){return m[1]-b[1]});var h={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var d=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(d=!1,e.l=a[o][1]),d)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[a[o][0]];if(h[v.n]=jT(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:lo(s=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(a[o][0]===1){if(s=h.CodePage=jT(e,Z3),lo(s),l!==-1){var p=e.l;e.l=a[l][1],u=bq(e,s),e.l=p}}else if(a[o][0]===0){if(s===0){l=o,e.l=a[o+1][1];continue}u=bq(e,s)}else{var g=u[a[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=yfe(e);break;case 30:e.l+=4,y=dN(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=dN(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Zr(e,4);break;case 64:e.l+=4,y=Rn(J3(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+n,h}function _q(e,t,r){var n=e.content;if(!n)return{};In(n,0);var i,a,o,s,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Kt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),s=n.read_shift(4),i===1&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var c=wq(n,t),h={SystemIdentifier:u};for(var d in c)h[d]=c[d];if(h.FMTID=a,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=wq(n,null)}catch{}for(d in v)h[d]=v[d];return h.FMTID=[a,o],h}function Ul(e,t){return e.read_shift(t),null}function TOt(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Zr(e,t){return e.read_shift(t)===1}function hn(e){return e.read_shift(2,"u")}function mfe(e,t){return TOt(e,t,hn)}function OOt(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function E_(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function EOt(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,s,l={};i&&(o=e.read_shift(2)),n&&(s=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=s),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Xc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function R_(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Xc(e,n,r)}function bh(e,t,r){if(r.biff>5)return R_(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ROt(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function kOt(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(yi,"");return n&&(e.l+=24),i}function AOt(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(yi,"");return r+o}function POt(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kOt(e);case"0303000000000000c000000000000046":return AOt(e);default:throw new Error("Unsupported Moniker "+r)}}function P1(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(yi,""):"";return r}function IOt(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,s,l,u="",f,c;i&16&&(a=P1(e,r-e.l)),i&128&&(o=P1(e,r-e.l)),(i&257)===257&&(s=P1(e,r-e.l)),(i&257)===1&&(l=POt(e,r-e.l)),i&8&&(u=P1(e,r-e.l)),i&32&&(f=e.read_shift(16)),i&64&&(c=J3(e)),e.l=r;var h=o||s||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return f&&(d.guid=f),c&&(d.time=c),a&&(d.Tooltip=a),d}function bfe(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function wfe(e,t){var r=bfe(e);return r[3]=0,r}function us(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function MOt(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function DOt(e,t,r){return t===0?"":bh(e,t,r)}function $Ot(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function _fe(e){var t=e.read_shift(2),r=q3(e);return[t,r]}function NOt(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=E_(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function FE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Sfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var LOt=Sfe;function Cfe(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function FOt(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function HOt(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Fn(e){e.l+=2,e.l+=e.read_shift(2)}var BOt={0:Fn,4:Fn,5:Fn,6:Fn,7:HOt,8:Fn,9:Fn,10:Fn,11:Fn,12:Fn,13:FOt,14:Fn,15:Fn,16:Fn,17:Fn,18:Fn,19:Fn,20:Fn,21:Cfe};function VOt(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(BOt[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function I1(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function jOt(e,t){return t===0||e.read_shift(2),1200}function WOt(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=bh(e,0,r);return e.read_shift(t+n-e.l),i}function UOt(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function zOt(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=E_(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function GOt(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<r;++o)a.push(EOt(e));return a.Count=n,a.Unique=i,a}function YOt(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function KOt(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function XOt(e){var t=MOt(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function qOt(e){return e.read_shift(2),e.read_shift(4)}function Sq(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function ZOt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:s,Selected:l,TabRatio:u}}function JOt(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function QOt(){}function eEt(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=E_(e,0,r),n}function tEt(e){var t=us(e);return t.isst=e.read_shift(4),t}function rEt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=us(e);r.biff==2&&e.l++;var a=R_(e,n-e.l,r);return i.val=a,i}function nEt(e,t,r){var n=e.read_shift(2),i=bh(e,0,r);return[n,i]}var iEt=bh;function Cq(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),s=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:s},e:{r:o,c:l}}}function aEt(e){var t=e.read_shift(2),r=e.read_shift(2),n=_fe(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function oEt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(_fe(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function sEt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function lEt(e,t,r,n){var i={},a=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(2);return i.patternType=aOt[s>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=s&127,i.icvBottom=s>>7&127,i.icvDiag=s>>14&127,i.dgDiag=s>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function uEt(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=lEt(e,t,n.fStyle,r),n}function fEt(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function xq(e,t,r){var n=us(e);(r.biff==2||t==9)&&++e.l;var i=OOt(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function cEt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=us(e),i=Wn(e);return n.val=i,n}var Tq=DOt;function hEt(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=Xc(e,a),s=[];n>e.l;)s.push(R_(e));return[a,i,o,s]}function Oq(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=NOt(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var dEt=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Eq(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Xc(e,o,r);i&32&&(u=dEt[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var c=n==e.l||s===0||!(f>0)?[]:KAt(e,f,r,s);return{chKey:a,Name:u,itab:l,rgce:c}}function xfe(e,t,r){if(r.biff<8)return vEt(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push($Ot(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function vEt(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=E_(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function pEt(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=Xc(e,n,r),o=Xc(e,i,r);return[a,o]}function gEt(e,t,r){var n=Sfe(e);e.l++;var i=e.read_shift(1);return t-=8,[XAt(e,t,r),i,n]}function Rq(e,t,r){var n=LOt(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,GAt(e,t,r)]}function yEt(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function mEt(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=bh(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},s,o,a]}}function bEt(e,t,r){return mEt(e,t,r)}function wEt(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(FE(e));return r}function _Et(e,t,r){if(r&&r.biff<8)return CEt(e,t,r);var n=Cfe(e),i=VOt(e,t-22,n[1]);return{cmo:n,ft:i}}var SEt={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function CEt(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((SEt[n]||Zn)(e,t,r)),{cmo:[i,n,a],ft:o}}function xEt(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=ROt(e,6,r);var s=e.read_shift(2);e.read_shift(2),hn(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],c=Xc(e,e.lens[u+1]-e.lens[u]-1);if(i+=c,i.length>=(f?s:2*s))break}if(i.length!==s&&i.length!==s*2)throw new Error("cchText: "+s+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function TEt(e,t){var r=FE(e);e.l+=16;var n=IOt(e,t-24);return[r,n]}function OEt(e,t){e.read_shift(2);var r=FE(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(yi,""),[r,n]}function EEt(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=yq[r]||r,r=e.read_shift(2),t[1]=yq[r]||r,t}function REt(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(wfe(e));return r}function kEt(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(wfe(e));return r}function AEt(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Tfe(e,t,r){if(!r.cellStyles)return Zn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:a,w:o,ixfe:s,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function PEt(e,t){var r={};return t<32||(e.l+=16,r.header=Wn(e),r.footer=Wn(e),e.l+=2),r}function IEt(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var MEt=us,DEt=mfe,$Et=R_;function NEt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function LEt(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=us(e);++e.l;var i=bh(e,t-7,r);return n.t="str",n.val=i,n}function FEt(e){var t=us(e);++e.l;var r=Wn(e);return t.t="n",t.val=r,t}function HEt(e){var t=us(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function BEt(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function VEt(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function jEt(e,t,r){var n=e.l+t,i=us(e),a=e.read_shift(2),o=Xc(e,a,r);return e.l=n,i.t="str",i.val=o,i}var WEt=[2,3,48,49,131,139,140,245],kq=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=V3({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(s,l){var u=[],f=Vu(1);switch(l.type){case"base64":f=io(ia(s));break;case"binary":f=io(s);break;case"buffer":case"array":f=s;break}In(f,0);var c=f.read_shift(1),h=!!(c&136),d=!1,v=!1;switch(c){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+c.toString(16))}var p=0,g=521;c==2&&(p=f.read_shift(2)),f.l+=3,c!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),c!=2&&(g=f.read_shift(2));var y=f.read_shift(2),m=l.codepage||1252;c!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(m=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var b=[],_={},x=Math.min(f.length,c==2?521:g-10-(d?264:0)),T=v?32:11;f.l<x&&f[f.l]!=13;)switch(_={},_.name=Jl.utils.decode(m,f.slice(f.l,f.l+T)).replace(/[\u0000\r\n].*$/g,""),f.l+=T,_.type=String.fromCharCode(f.read_shift(1)),c!=2&&!v&&(_.offset=f.read_shift(4)),_.len=f.read_shift(1),c==2&&(_.offset=f.read_shift(2)),_.dec=f.read_shift(1),_.name.length&&b.push(_),c!=2&&(f.l+=v?13:14),_.type){case"B":(!d||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var E=0,P=0;for(u[0]=[],P=0;P!=b.length;++P)u[0][P]=b[P].name;for(;p-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++E]=[],P=0,P=0;P!=b.length;++P){var R=f.slice(f.l,f.l+b[P].len);f.l+=b[P].len,In(R,0);var M=Jl.utils.decode(m,R);switch(b[P].type){case"C":M.trim().length&&(u[E][P]=M.replace(/\s+$/,""));break;case"D":M.length===8?u[E][P]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):u[E][P]=M;break;case"F":u[E][P]=parseFloat(M.trim());break;case"+":case"I":u[E][P]=v?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":u[E][P]=!0;break;case"N":case"F":u[E][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+c.toString(16));u[E][P]="##MEMO##"+(v?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(u[E][P]=+M||0);break;case"@":u[E][P]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":u[E][P]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":u[E][P]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][P]=-R.read_shift(-8,"f");break;case"B":if(d&&b[P].len==8){u[E][P]=R.read_shift(8,"f");break}case"G":case"P":R.l+=b[P].len;break;case"0":if(b[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[P].type)}}}if(c!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(s,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Vg(r(s,u),u);return f["!cols"]=u.DBF.map(function(c){return{wch:c.len,DBF:c}}),delete u.DBF,f}function i(s,l){try{return Yu(n(s,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,l){var u=l||{};if(+u.codepage>=0&&lo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=fN(),c=wN(s,{header:1,raw:!0,cellDates:!0}),h=c[0],d=c.slice(1),v=s["!cols"]||[],p=0,g=0,y=0,m=1;for(p=0;p<h.length;++p){if(((v[p]||{}).DBF||{}).name){h[p]=v[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var b=Yr(s["!ref"]),_=[],x=[],T=[];for(p=0;p<=b.e.c-b.s.c;++p){var E="",P="",R=0,M=[];for(g=0;g<d.length;++g)d[g][p]!=null&&M.push(d[g][p]);if(M.length==0||h[p]==null){_[p]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=M[g]instanceof Date?"D":"C";break;default:P="C"}R=Math.max(R,String(M[g]).length),E=E&&E!=P?"C":P}R>250&&(R=250),P=((v[p]||{}).DBF||{}).type,P=="C"&&v[p].DBF.len>R&&(R=v[p].DBF.len),E=="B"&&P=="N"&&(E="N",T[p]=v[p].DBF.dec,R=v[p].DBF.len),x[p]=E=="C"||P=="N"?R:a[E]||0,m+=x[p],_[p]=E}var D=f.next(32);for(D.write_shift(4,318902576),D.write_shift(4,d.length),D.write_shift(2,296+32*y),D.write_shift(2,m),p=0;p<4;++p)D.write_shift(4,0);for(D.write_shift(4,0|(+t[Cue]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var N=f.next(32),B=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,B,"sbcs"),N.write_shift(1,_[p]=="?"?"C":_[p],"sbcs"),N.write_shift(4,g),N.write_shift(1,x[p]||a[_[p]]||0),N.write_shift(1,T[p]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),g+=x[p]||a[_[p]]||0}var K=f.next(264);for(K.write_shift(4,13),p=0;p<65;++p)K.write_shift(4,0);for(p=0;p<d.length;++p){var Z=f.next(m);for(Z.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(_[g]){case"L":Z.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":Z.write_shift(8,d[p][g]||0,"f");break;case"N":var ie="0";for(typeof d[p][g]=="number"&&(ie=d[p][g].toFixed(T[g]||0)),y=0;y<x[g]-ie.length;++y)Z.write_shift(1,32);Z.write_shift(1,ie,"sbcs");break;case"D":d[p][g]?(Z.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var me=String(d[p][g]!=null?d[p][g]:"").slice(0,x[g]);for(Z.write_shift(1,me,"sbcs"),y=0;y<x[g]-me.length;++y)Z.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),UEt=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Jo(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var v=e[d];return typeof v=="number"?zX(v):v},n=function(h,d,v){var p=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?h:zX(p)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return a(ia(h),d);case"binary":return a(h,d);case"buffer":return a(zt&&Buffer.isBuffer(h)?h.toString("binary"):ph(h),d);case"array":return a(Kc(h),d)}throw new Error("Unrecognized type "+d.type)}function a(h,d){var v=h.split(/[\n\r]+/),p=-1,g=-1,y=0,m=0,b=[],_=[],x=null,T={},E=[],P=[],R=[],M=0,D;for(+d.codepage>=0&&lo(+d.codepage);y!==v.length;++y){M=0;var N=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),B=N.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),K=B[0],Z;if(N.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&_.push(N.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,me=!1,k=!1,w=!1,C=-1,O=-1;for(m=1;m<B.length;++m)switch(B[m].charAt(0)){case"A":break;case"X":g=parseInt(B[m].slice(1))-1,me=!0;break;case"Y":for(p=parseInt(B[m].slice(1))-1,me||(g=0),D=b.length;D<=p;++D)b[D]=[];break;case"K":Z=B[m].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(fo(Z))?isNaN(yg(Z).getDate())||(Z=Rn(Z)):(Z=fo(Z),x!==null&&Hg(x)&&(Z=LE(Z))),ie=!0;break;case"E":w=!0;var S=ev(B[m].slice(1),{r:p,c:g});b[p][g]=[b[p][g],S];break;case"S":k=!0,b[p][g]=[b[p][g],"S5S"];break;case"G":break;case"R":C=parseInt(B[m].slice(1))-1;break;case"C":O=parseInt(B[m].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}if(ie&&(b[p][g]&&b[p][g].length==2?b[p][g][0]=Z:b[p][g]=Z,x=null),k){if(w)throw new Error("SYLK shared formula cannot have own formula");var A=C>-1&&b[C][O];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");b[p][g][1]=$fe(A[1],{r:p-C,c:g-O})}break;case"F":var I=0;for(m=1;m<B.length;++m)switch(B[m].charAt(0)){case"X":g=parseInt(B[m].slice(1))-1,++I;break;case"Y":for(p=parseInt(B[m].slice(1))-1,D=b.length;D<=p;++D)b[D]=[];break;case"M":M=parseInt(B[m].slice(1))/20;break;case"F":break;case"G":break;case"P":x=_[parseInt(B[m].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=B[m].slice(1).split(" "),D=parseInt(R[0],10);D<=parseInt(R[1],10);++D)M=parseInt(R[2],10),P[D-1]=M===0?{hidden:!0}:{wch:M},mg(P[D-1]);break;case"C":g=parseInt(B[m].slice(1))-1,P[g]||(P[g]={});break;case"R":p=parseInt(B[m].slice(1))-1,E[p]||(E[p]={}),M>0?(E[p].hpt=M,E[p].hpx=_w(M)):M===0&&(E[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}I<1&&(x=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}}return E.length>0&&(T["!rows"]=E),P.length>0&&(T["!cols"]=P),d&&d.sheetRows&&(b=b.slice(0,d.sheetRows)),[b,T]}function o(h,d){var v=i(h,d),p=v[0],g=v[1],y=Vg(p,d);return Jo(g).forEach(function(m){y[m]=g[m]}),y}function s(h,d){return Yu(o(h,d),d)}function l(h,d,v,p){var g="C;Y"+(v+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Akt(h.f,{r:v,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,d){d.forEach(function(v,p){var g="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=UT(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=zT(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function f(h,d){d.forEach(function(v,p){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*Ife(v.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function c(h,d){var v=["ID;PWXL;N;E"],p=[],g=Yr(h["!ref"]),y,m=Array.isArray(h),b=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&u(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var x=g.s.c;x<=g.e.c;++x){var T=_t({r:_,c:x});y=m?(h[_]||[])[x]:h[T],!(!y||y.v==null&&(!y.f||y.F))&&p.push(l(y,h,_,x))}return v.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:s,to_sheet:o,from_sheet:c}}(),zEt=function(){function e(a,o){switch(o.type){case"base64":return t(ia(a),o);case"binary":return t(a,o);case"buffer":return t(zt&&Buffer.isBuffer(a)?a.toString("binary"):ph(a),o);case"array":return t(Kc(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var s=a.split(`
`),l=-1,u=-1,f=0,c=[];f!==s.length;++f){if(s[f].trim()==="BOT"){c[++l]=[],u=0;continue}if(!(l<0)){var h=s[f].trim().split(","),d=h[0],v=h[1];++f;for(var p=s[f]||"";(p.match(/["]/g)||[]).length&1&&f<s.length-1;)p+=`
`+s[++f];switch(p=p.trim(),+d){case-1:if(p==="BOT"){c[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?c[l][u]=!0:p==="FALSE"?c[l][u]=!1:isNaN(fo(v))?isNaN(yg(v).getDate())?c[l][u]=v:c[l][u]=Rn(v):c[l][u]=fo(v),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),c[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(c=c.slice(0,o.sheetRows)),c}function r(a,o){return Vg(e(a,o),o)}function n(a,o){return Yu(r(a,o),o)}var i=function(){var a=function(l,u,f,c,h){l.push(u),l.push(f+","+c),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,u,f,c){l.push(u+","+f),l.push(u==1?'"'+c.replace(/"/g,'""')+'"':c)};return function(l){var u=[],f=Yr(l["!ref"]),c,h=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){o(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var p=_t({r:d,c:v});if(c=h?(l[d]||[])[v]:l[p],!c){o(u,1,0,"");continue}switch(c.t){case"n":var g=c.w;!g&&c.v!=null&&(g=c.v),g==null?c.f&&!c.F?o(u,1,0,"="+c.f):o(u,1,0,""):o(u,0,g,"V");break;case"b":o(u,0,c.v?1:0,c.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(c.v)?c.v:'="'+c.v+'"');break;case"d":c.w||(c.w=Ia(c.z||Et[14],wi(Rn(c.v)))),o(u,0,c.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var y=`\r
`,m=u.join(y);return m}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),GEt=function(){function e(c){return c.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(c){return c.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(c,h){for(var d=c.split(`
`),v=-1,p=-1,g=0,y=[];g!==d.length;++g){var m=d[g].trim().split(":");if(m[0]==="cell"){var b=pi(m[1]);if(y.length<=b.r)for(v=y.length;v<=b.r;++v)y[v]||(y[v]=[]);switch(v=b.r,p=b.c,m[2]){case"t":y[v][p]=e(m[3]);break;case"v":y[v][p]=+m[3];break;case"vtf":var _=m[m.length-1];case"vtc":switch(m[3]){case"nl":y[v][p]=!!+m[4];break;default:y[v][p]=+m[4];break}m[2]=="vtf"&&(y[v][p]=[y[v][p],_])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(c,h){return Vg(r(c,h),h)}function i(c,h){return Yu(n(c,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(c){if(!c||!c["!ref"])return"";for(var h=[],d=[],v,p="",g=Bg(c["!ref"]),y=Array.isArray(c),m=g.s.r;m<=g.e.r;++m)for(var b=g.s.c;b<=g.e.c;++b)if(p=_t({r:m,c:b}),v=y?(c[m]||[])[b]:c[p],!(!v||v.v==null||v.t==="z")){switch(d=["cell",p,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var _=wi(Rn(v.v));d[2]="vtc",d[3]="nd",d[4]=""+_,d[5]=v.w||Ia(v.z||Et[14],_);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(c){return[a,o,s,o,u(c),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),bw=function(){function e(f,c,h,d,v){v.raw?c[h][d]=f:f===""||(f==="TRUE"?c[h][d]=!0:f==="FALSE"?c[h][d]=!1:isNaN(fo(f))?isNaN(yg(f).getDate())?c[h][d]=f:c[h][d]=Rn(f):c[h][d]=fo(f))}function t(f,c){var h=c||{},d=[];if(!f||f.length===0)return d;for(var v=f.split(/[\r\n]/),p=v.length-1;p>=0&&v[p].length===0;)--p;for(var g=10,y=0,m=0;m<=p;++m)y=v[m].indexOf(" "),y==-1?y=v[m].length:y++,g=Math.max(g,y);for(m=0;m<=p;++m){d[m]=[];var b=0;for(e(v[m].slice(0,g).trim(),d,m,b,h),b=1;b<=(v[m].length-g)/10+1;++b)e(v[m].slice(g+(b-1)*10,g+b*10).trim(),d,m,b,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var c={},h=!1,d=0,v=0;d<f.length;++d)(v=f.charCodeAt(d))==34?h=!h:!h&&v in r&&(c[v]=(c[v]||0)+1);v=[];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d]);if(!v.length){c=n;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d])}return v.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[v.pop()[1]]||44}function a(f,c){var h=c||{},d="",v=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=i(f.slice(0,1024)):h&&h.FS?d=h.FS:d=i(f.slice(0,1024));var g=0,y=0,m=0,b=0,_=0,x=d.charCodeAt(0),T=!1,E=0,P=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var R=h.dateNF!=null?iTt(h.dateNF):null;function M(){var D=f.slice(b,_),N={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)N.t="z";else if(h.raw)N.t="s",N.v=D;else if(D.trim().length===0)N.t="s",N.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(N.t="s",N.v=D.slice(2,-1).replace(/""/g,'"')):Ikt(D)?(N.t="n",N.f=D.slice(1)):(N.t="s",N.v=D);else if(D=="TRUE")N.t="b",N.v=!0;else if(D=="FALSE")N.t="b",N.v=!1;else if(!isNaN(m=fo(D)))N.t="n",h.cellText!==!1&&(N.w=D),N.v=m;else if(!isNaN(yg(D).getDate())||R&&D.match(R)){N.z=h.dateNF||Et[14];var B=0;R&&D.match(R)&&(D=aTt(D,h.dateNF,D.match(R)||[]),B=1),h.cellDates?(N.t="d",N.v=Rn(D,B)):(N.t="n",N.v=wi(Rn(D,B))),h.cellText!==!1&&(N.w=Ia(N.z,N.v instanceof Date?wi(N.v):N.v)),h.cellNF||delete N.z}else N.t="s",N.v=D;if(N.t=="z"||(h.dense?(v[g]||(v[g]=[]),v[g][y]=N):v[_t({c:y,r:g})]=N),b=_+1,P=f.charCodeAt(b),p.e.c<y&&(p.e.c=y),p.e.r<g&&(p.e.r=g),E==x)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;_<f.length;++_)switch(E=f.charCodeAt(_)){case 34:P===34&&(T=!T);break;case x:case 10:case 13:if(!T&&M())break e;break}return _-b>0&&M(),v["!ref"]=qt(p),v}function o(f,c){return!(c&&c.PRN)||c.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,c):Vg(t(f,c),c)}function s(f,c){var h="",d=c.type=="string"?[0,0,0,0]:o4(f,c);switch(c.type){case"base64":h=ia(f);break;case"binary":h=f;break;case"buffer":c.codepage==65001?h=f.toString("utf8"):c.codepage&&typeof Jl<"u"?h=Jl.utils.decode(c.codepage,f):h=zt&&Buffer.isBuffer(f)?f.toString("binary"):ph(f);break;case"array":h=Kc(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+c.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Cr(h.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?h=Cr(h):c.type=="binary"&&typeof Jl<"u"&&c.codepage&&(h=Jl.utils.decode(c.codepage,Jl.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?GEt.to_sheet(c.type=="string"?h:Cr(h),c):o(h,c)}function l(f,c){return Yu(s(f,c),c)}function u(f){for(var c=[],h=Yr(f["!ref"]),d,v=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var g=[],y=h.s.c;y<=h.e.c;++y){var m=_t({r:p,c:y});if(d=v?(f[p]||[])[y]:f[m],!d||d.v==null){g.push("          ");continue}for(var b=(d.w||(yl(d),d.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(y===0?" ":""))}c.push(g.join(""))}return c.join(`
`)}return{to_workbook:l,to_sheet:s,from_sheet:u}}();function YEt(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=UEt.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return bw.to_workbook(e,t)}}var Wm=function(){function e(S,A,I){if(S){In(S,S.l||0);for(var L=I.Enum||C;S.l<S.length;){var V=S.read_shift(2),Y=L[V]||L[65535],ae=S.read_shift(2),re=S.l+ae,te=Y.f&&Y.f(S,ae,I);if(S.l=re,A(te,Y,V))return}}}function t(S,A){switch(A.type){case"base64":return r(io(ia(S)),A);case"binary":return r(io(S),A);case"buffer":case"array":return r(S,A)}throw"Unsupported type "+A.type}function r(S,A){if(!S)return S;var I=A||{},L=I.dense?[]:{},V="Sheet1",Y="",ae=0,re={},te=[],ge=[],H={s:{r:0,c:0},e:{r:0,c:0}},Ce=I.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)I.Enum=C,e(S,function(be,Ie,Me){switch(Me){case 0:I.vers=be,be>=4096&&(I.qpro=!0);break;case 6:H=be;break;case 204:be&&(Y=be);break;case 222:Y=be;break;case 15:case 51:I.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:Me==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=I.dateNF||Et[14],I.cellDates&&(be[1].t="d",be[1].v=LE(be[1].v))),I.qpro&&be[3]>ae&&(L["!ref"]=qt(H),re[V]=L,te.push(V),L=I.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ae=be[3],V=Y||"Sheet"+(ae+1),Y="");var j=I.dense?(L[be[0].r]||[])[be[0].c]:L[_t(be[0])];if(j){j.t=be[1].t,j.v=be[1].v,be[1].z!=null&&(j.z=be[1].z),be[1].f!=null&&(j.f=be[1].f);break}I.dense?(L[be[0].r]||(L[be[0].r]=[]),L[be[0].r][be[0].c]=be[1]):L[_t(be[0])]=be[1];break}},I);else if(S[2]==26||S[2]==14)I.Enum=O,S[2]==14&&(I.qpro=!0,S.l=0),e(S,function(be,Ie,Me){switch(Me){case 204:V=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>ae&&(L["!ref"]=qt(H),re[V]=L,te.push(V),L=I.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ae=be[3],V="Sheet"+(ae+1)),Ce>0&&be[0].r>=Ce)break;I.dense?(L[be[0].r]||(L[be[0].r]=[]),L[be[0].r][be[0].c]=be[1]):L[_t(be[0])]=be[1],H.e.c<be[0].c&&(H.e.c=be[0].c),H.e.r<be[0].r&&(H.e.r=be[0].r);break;case 27:be[14e3]&&(ge[be[14e3][0]]=be[14e3][1]);break;case 1537:ge[be[0]]=be[1],be[0]==ae&&(V=be[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(L["!ref"]=qt(H),re[Y||V]=L,te.push(Y||V),!ge.length)return{SheetNames:te,Sheets:re};for(var oe={},Oe=[],Ee=0;Ee<ge.length;++Ee)re[te[Ee]]?(Oe.push(ge[Ee]||te[Ee]),oe[ge[Ee]]=re[ge[Ee]]||re[te[Ee]]):(Oe.push(ge[Ee]),oe[ge[Ee]]={"!ref":"A1"});return{SheetNames:Oe,Sheets:oe}}function n(S,A){var I=A||{};if(+I.codepage>=0&&lo(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var L=fN(),V=Yr(S["!ref"]),Y=Array.isArray(S),ae=[];Ya(L,0,a(1030)),Ya(L,6,l(V));for(var re=Math.min(V.e.r,8191),te=V.s.r;te<=re;++te)for(var ge=$n(te),H=V.s.c;H<=V.e.c;++H){te===V.s.r&&(ae[H]=wn(H));var Ce=ae[H]+ge,oe=Y?(S[te]||[])[H]:S[Ce];if(!(!oe||oe.t=="z"))if(oe.t=="n")(oe.v|0)==oe.v&&oe.v>=-32768&&oe.v<=32767?Ya(L,13,d(te,H,oe.v)):Ya(L,14,p(te,H,oe.v));else{var Oe=yl(oe);Ya(L,15,c(te,H,Oe.slice(0,239)))}}return Ya(L,1),L.end()}function i(S,A){var I=A||{};if(+I.codepage>=0&&lo(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var L=fN();Ya(L,0,o(S));for(var V=0,Y=0;V<S.SheetNames.length;++V)(S.Sheets[S.SheetNames[V]]||{})["!ref"]&&Ya(L,27,w(S.SheetNames[V],Y++));var ae=0;for(V=0;V<S.SheetNames.length;++V){var re=S.Sheets[S.SheetNames[V]];if(!(!re||!re["!ref"])){for(var te=Yr(re["!ref"]),ge=Array.isArray(re),H=[],Ce=Math.min(te.e.r,8191),oe=te.s.r;oe<=Ce;++oe)for(var Oe=$n(oe),Ee=te.s.c;Ee<=te.e.c;++Ee){oe===te.s.r&&(H[Ee]=wn(Ee));var be=H[Ee]+Oe,Ie=ge?(re[oe]||[])[Ee]:re[be];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")Ya(L,23,M(oe,Ee,ae,Ie.v));else{var Me=yl(Ie);Ya(L,22,E(oe,Ee,ae,Me.slice(0,239)))}}++ae}}return Ya(L,1),L.end()}function a(S){var A=yn(2);return A.write_shift(2,S),A}function o(S){var A=yn(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var I=0,L=0,V=0,Y=0;Y<S.SheetNames.length;++Y){var ae=S.SheetNames[Y],re=S.Sheets[ae];if(!(!re||!re["!ref"])){++V;var te=Bg(re["!ref"]);I<te.e.r&&(I=te.e.r),L<te.e.c&&(L=te.e.c)}}return I>8191&&(I=8191),A.write_shift(2,I),A.write_shift(1,V),A.write_shift(1,L),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function s(S,A,I){var L={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&I.qpro?(L.s.c=S.read_shift(1),S.l++,L.s.r=S.read_shift(2),L.e.c=S.read_shift(1),S.l++,L.e.r=S.read_shift(2),L):(L.s.c=S.read_shift(2),L.s.r=S.read_shift(2),A==12&&I.qpro&&(S.l+=2),L.e.c=S.read_shift(2),L.e.r=S.read_shift(2),A==12&&I.qpro&&(S.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function l(S){var A=yn(8);return A.write_shift(2,S.s.c),A.write_shift(2,S.s.r),A.write_shift(2,S.e.c),A.write_shift(2,S.e.r),A}function u(S,A,I){var L=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(L[0].c=S.read_shift(1),L[3]=S.read_shift(1),L[0].r=S.read_shift(2),S.l+=2):(L[2]=S.read_shift(1),L[0].c=S.read_shift(2),L[0].r=S.read_shift(2)),L}function f(S,A,I){var L=S.l+A,V=u(S,A,I);if(V[1].t="s",I.vers==20768){S.l++;var Y=S.read_shift(1);return V[1].v=S.read_shift(Y,"utf8"),V}return I.qpro&&S.l++,V[1].v=S.read_shift(L-S.l,"cstr"),V}function c(S,A,I){var L=yn(7+I.length);L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,S),L.write_shift(1,39);for(var V=0;V<L.length;++V){var Y=I.charCodeAt(V);L.write_shift(1,Y>=128?95:Y)}return L.write_shift(1,0),L}function h(S,A,I){var L=u(S,A,I);return L[1].v=S.read_shift(2,"i"),L}function d(S,A,I){var L=yn(7);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,S),L.write_shift(2,I,"i"),L}function v(S,A,I){var L=u(S,A,I);return L[1].v=S.read_shift(8,"f"),L}function p(S,A,I){var L=yn(13);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,S),L.write_shift(8,I,"f"),L}function g(S,A,I){var L=S.l+A,V=u(S,A,I);if(V[1].v=S.read_shift(8,"f"),I.qpro)S.l=L;else{var Y=S.read_shift(2);_(S.slice(S.l,S.l+Y),V),S.l+=Y}return V}function y(S,A,I){var L=A&32768;return A&=-32769,A=(L?S:0)+(A>=8192?A-16384:A),(L?"":"$")+(I?wn(A):$n(A))}var m={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(S,A){In(S,0);for(var I=[],L=0,V="",Y="",ae="",re="";S.l<S.length;){var te=S[S.l++];switch(te){case 0:I.push(S.read_shift(8,"f"));break;case 1:Y=y(A[0].c,S.read_shift(2),!0),V=y(A[0].r,S.read_shift(2),!1),I.push(Y+V);break;case 2:{var ge=y(A[0].c,S.read_shift(2),!0),H=y(A[0].r,S.read_shift(2),!1);Y=y(A[0].c,S.read_shift(2),!0),V=y(A[0].r,S.read_shift(2),!1),I.push(ge+H+":"+Y+V)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(S.read_shift(2));break;case 6:{for(var Ce="";te=S[S.l++];)Ce+=String.fromCharCode(te);I.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:re=I.pop(),ae=I.pop(),I.push(["AND","OR"][te-20]+"("+ae+","+re+")");break;default:if(te<32&&b[te])re=I.pop(),ae=I.pop(),I.push(ae+b[te]+re);else if(m[te]){if(L=m[te][1],L==69&&(L=S[S.l++]),L>I.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+I.join("|")+"|");return}var oe=I.slice(-L);I.length-=L,I.push(m[te][0]+"("+oe.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}I.length==1?A[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function x(S){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=S.read_shift(2),A[3]=S[S.l++],A[0].c=S[S.l++],A}function T(S,A){var I=x(S);return I[1].t="s",I[1].v=S.read_shift(A-4,"cstr"),I}function E(S,A,I,L){var V=yn(6+L.length);V.write_shift(2,S),V.write_shift(1,I),V.write_shift(1,A),V.write_shift(1,39);for(var Y=0;Y<L.length;++Y){var ae=L.charCodeAt(Y);V.write_shift(1,ae>=128?95:ae)}return V.write_shift(1,0),V}function P(S,A){var I=x(S);I[1].v=S.read_shift(2);var L=I[1].v>>1;if(I[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return I[1].v=L,I}function R(S,A){var I=x(S),L=S.read_shift(4),V=S.read_shift(4),Y=S.read_shift(2);if(Y==65535)return L===0&&V===3221225472?(I[1].t="e",I[1].v=15):L===0&&V===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ae=Y&32768;return Y=(Y&32767)-16446,I[1].v=(1-ae*2)*(V*Math.pow(2,Y+32)+L*Math.pow(2,Y)),I}function M(S,A,I,L){var V=yn(14);if(V.write_shift(2,S),V.write_shift(1,I),V.write_shift(1,A),L==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var Y=0,ae=0,re=0,te=0;return L<0&&(Y=1,L=-L),ae=Math.log2(L)|0,L/=Math.pow(2,ae-31),te=L>>>0,te&2147483648||(L/=2,++ae,te=L>>>0),L-=te,te|=2147483648,te>>>=0,L*=Math.pow(2,32),re=L>>>0,V.write_shift(4,re),V.write_shift(4,te),ae+=16383+(Y?32768:0),V.write_shift(2,ae),V}function D(S,A){var I=R(S);return S.l+=A-14,I}function N(S,A){var I=x(S),L=S.read_shift(4);return I[1].v=L>>6,I}function B(S,A){var I=x(S),L=S.read_shift(8,"f");return I[1].v=L,I}function K(S,A){var I=B(S);return S.l+=A-10,I}function Z(S,A){return S[S.l+A-1]==0?S.read_shift(A,"cstr"):""}function ie(S,A){var I=S[S.l++];I>A-1&&(I=A-1);for(var L="";L.length<I;)L+=String.fromCharCode(S[S.l++]);return L}function me(S,A,I){if(!(!I.qpro||A<21)){var L=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var V=S.read_shift(A-21,"cstr");return[L,V]}}function k(S,A){for(var I={},L=S.l+A;S.l<L;){var V=S.read_shift(2);if(V==14e3){for(I[V]=[0,""],I[V][0]=S.read_shift(2);S[S.l];)I[V][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return I}function w(S,A){var I=yn(5+S.length);I.write_shift(2,14e3),I.write_shift(2,A);for(var L=0;L<S.length;++L){var V=S.charCodeAt(L);I[I.l++]=V>127?95:V}return I[I.l++]=0,I}var C={0:{n:"BOF",f:hn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},O={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:k},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function KEt(e){var t={},r=e.match(ei),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=yt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=N3[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var XEt=function(){var e=yw("t"),t=yw("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var s={t:"s",v:er(o[1])},l=a.match(t);return l&&(s.s=KEt(l[1])),s}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(s){return s.v})}}(),qEt=function(){var t=/(\r\n|\n)/g;function r(i,a,o){var s=[];i.u&&s.push("text-decoration: underline;"),i.uval&&s.push("text-underline-style:"+i.uval+";"),i.sz&&s.push("font-size:"+i.sz+"pt;"),i.outline&&s.push("text-effect: outline;"),i.shadow&&s.push("text-shadow: auto;"),a.push('<span style="'+s.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),ZEt=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,JEt=/<(?:\w+:)?r>/,QEt=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Q3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=er(Cr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Cr(e),r&&(n.h=W3(n.t))):e.match(JEt)&&(n.r=Cr(e),n.t=er(Cr((e.replace(QEt,"").match(ZEt)||[]).join("").replace(ei,""))),r&&(n.h=qEt(XEt(n.r)))),n):{t:""}}var eRt=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tRt=/<(?:\w+:)?(?:si|sstItem)>/g,rRt=/<\/(?:\w+:)?(?:si|sstItem)>/;function nRt(e,t){var r=[],n="";if(!e)return r;var i=e.match(eRt);if(i){n=i[2].replace(tRt,"").split(rRt);for(var a=0;a!=n.length;++a){var o=Q3(n[a].trim(),t);o!=null&&(r[r.length]=o)}i=yt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function iRt(e){return[e.read_shift(4),e.read_shift(4)]}function aRt(e,t){var r=[],n=!1;return Ol(e,function(a,o,s){switch(s){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}function Ofe(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ll(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function oRt(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function sRt(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function lRt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(sRt(e));return t}function uRt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function fRt(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function cRt(e){var t=fRt(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Efe(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Rfe(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function hRt(e){var t=ll(e);switch(t.Minor){case 2:return[t.Minor,dRt(e)];case 3:return[t.Minor,vRt()];case 4:return[t.Minor,pRt(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function dRt(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Efe(e,r),i=Rfe(e,e.length-e.l);return{t:"Std",h:n,v:i}}function vRt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pRt(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ei,function(a){var o=yt(a);switch(ls(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(s){n[s]=o[s]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function gRt(e,t){var r={},n=r.EncryptionVersionInfo=ll(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=Efe(e,i),t-=i,r.EncryptionVerifier=Rfe(e,t),r}function yRt(e){var t={},r=t.EncryptionVersionInfo=ll(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function mRt(e){var t=0,r,n=Ofe(e),i=n.length+1,a,o,s,l,u;for(r=Vu(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],s=t&16384?1:0,l=t<<1&32767,u=s|l,t=u^o;return t^52811}var kfe=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,s){return n(o^s)},a=function(o){for(var s=t[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var f=o[u],c=0;c!=7;++c)f&64&&(s^=r[l]),f*=2,--l;return s};return function(o){for(var s=Ofe(o),l=a(s),u=s.length,f=Vu(16),c=0;c!=16;++c)f[c]=0;var h,d,v;for((u&1)===1&&(h=l>>8,f[u]=i(e[0],h),--u,h=l&255,d=s[s.length-1],f[u]=i(d,h));u>0;)--u,h=l>>8,f[u]=i(s[u],h),--u,h=l&255,f[u]=i(s[u],h);for(u=15,v=15-s.length;v>0;)h=l>>8,f[u]=i(e[v],h),--u,--v,h=l&255,f[u]=i(s[u],h),--u,--v;return f}}(),bRt=function(e,t,r,n,i){i||(i=t),n||(n=kfe(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},wRt=function(e){var t=0,r=kfe(e);return function(n){var i=bRt("",n,t,r);return t=i[1],i[0]}};function _Rt(e,t,r,n){var i={key:hn(e),verificationBytes:hn(e)};return r.password&&(i.verifier=mRt(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=wRt(r.password)),i}function SRt(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=yRt(e):n.Data=gRt(e,t),n}function CRt(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?SRt(e,t-2,n):_Rt(e,r.biff>=8?t:t-2,r,n),n}var xRt=function(){function e(i,a){switch(a.type){case"base64":return t(ia(i),a);case"binary":return t(i,a);case"buffer":return t(zt&&Buffer.isBuffer(i)?i.toString("binary"):ph(i),a);case"array":return t(Kc(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},s=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,c){Array.isArray(s)&&(s[c]=[]);for(var h=/\\\w+\b/g,d=0,v,p=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var g=f.slice(d,h.lastIndex-v[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var y={v:g,t:"s"};Array.isArray(s)?s[c][p]=y:s[_t({r:c,c:p})]=y}break}d=h.lastIndex}p>u.e.c&&(u.e.c=p)}),s["!ref"]=qt(u),s}function r(i,a){return Yu(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Yr(i["!ref"]),s,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var c=_t({r:u,c:f});s=l?(i[u]||[])[f]:i[c],!(!s||s.v==null&&(!s.f||s.F))&&(a.push(" "+(s.w||(yl(s),s.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function TRt(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ww(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function ORt(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var s=0,l=0,u=i+a;switch(l=o/(u>1?2-u:u),i){case t:s=((r-n)/o+6)%6;break;case r:s=(n-t)/o+2;break;case n:s=(t-r)/o+4;break}return[s/6,l,u/2]}function ERt(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],s=6*t,l;if(r!==0)switch(s|0){case 0:case 6:l=i*s,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-s),o[0]+=l,o[1]+=i;break;case 2:l=i*(s-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-s),o[1]+=l,o[2]+=i;break;case 4:l=i*(s-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-s),o[2]+=l,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function WT(e,t){if(t===0)return e;var r=ORt(TRt(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ww(ERt(r))}var Afe=6,RRt=15,kRt=1,di=Afe;function UT(e){return Math.floor((e+Math.round(128/di)/256)*di)}function zT(e){return Math.floor((e-5)/di*100+.5)/100}function vN(e){return Math.round((e*di+5)/di*256)/256}function WP(e){return vN(zT(UT(e)))}function e4(e){var t=Math.abs(e-WP(e)),r=di;if(t>.005)for(di=kRt;di<RRt;++di)Math.abs(e-WP(e))<=t&&(t=Math.abs(e-WP(e)),r=di);di=r}function mg(e){e.width?(e.wpx=UT(e.width),e.wch=zT(e.wpx),e.MDW=di):e.wpx?(e.wch=zT(e.wpx),e.width=vN(e.wch),e.MDW=di):typeof e.wch=="number"&&(e.width=vN(e.wch),e.wpx=UT(e.width),e.MDW=di),e.customWidth&&delete e.customWidth}var ARt=96,Pfe=ARt;function Ife(e){return e*96/Pfe}function _w(e){return e*Pfe/96}var PRt={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IRt(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(ei)||[]).forEach(function(o){var s=yt(o);switch(ls(s[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},s.diagonalUp&&(i.diagonalUp=Ir(s.diagonalUp)),s.diagonalDown&&(i.diagonalDown=Ir(s.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in borders")}})}function MRt(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(ei)||[]).forEach(function(o){var s=yt(o);switch(ls(s[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":s.patternType&&(i.patternType=s.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),s.indexed&&(i.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(i.bgColor.theme=parseInt(s.theme,10)),s.tint&&(i.bgColor.tint=parseFloat(s.tint)),s.rgb&&(i.bgColor.rgb=s.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),s.theme&&(i.fgColor.theme=parseInt(s.theme,10)),s.tint&&(i.fgColor.tint=parseFloat(s.tint)),s.rgb!=null&&(i.fgColor.rgb=s.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fills")}})}function DRt(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(ei)||[]).forEach(function(o){var s=yt(o);switch(ls(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=Cr(s.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=s.val?Ir(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?Ir(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?Ir(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?Ir(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?Ir(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?Ir(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?Ir(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(s.val=="1")break;s.codepage=N3[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=Ir(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var l=Ec[i.color.index];i.color.index==81&&(l=Ec[1]),l||(l=Ec[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=WT(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fonts")}})}function $Rt(e,t,r){t.NumberFmt=[];for(var n=Jo(Et),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Et[n[i]];var a=e[0].match(ei);if(a)for(i=0;i<a.length;++i){var o=yt(a[i]);switch(ls(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var s=er(Cr(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=s}Oc(s,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var M1=["numFmtId","fillId","fontId","borderId","xfId"],D1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function NRt(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(ei)||[]).forEach(function(a){var o=yt(a),s=0;switch(ls(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],s=0;s<M1.length;++s)n[M1[s]]&&(n[M1[s]]=parseInt(n[M1[s]],10));for(s=0;s<D1.length;++s)n[D1[s]]&&(n[D1[s]]=Ir(n[D1[s]]));if(t.NumberFmt&&n.numFmtId>392){for(s=392;s>60;--s)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[s]){n.numFmtId=s;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Ir(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var LRt=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,l,u){var f={};if(!s)return f;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var c;return(c=s.match(t))&&$Rt(c,f,u),(c=s.match(i))&&DRt(c,f,l,u),(c=s.match(n))&&MRt(c,f,l,u),(c=s.match(a))&&IRt(c,f,l,u),(c=s.match(r))&&NRt(c,f,u),f}}();function FRt(e,t){var r=e.read_shift(2),n=Yn(e);return[r,n]}function HRt(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=XTt(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var s=e.read_shift(1);s>0&&(n.family=s);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=KTt(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Yn(e),n}var BRt=Zn;function VRt(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var jRt=Zn;function WRt(e,t,r){var n={};n.NumberFmt=[];for(var i in Et)n.NumberFmt[i]=Et[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Ol(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Oc(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=WT(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f),o=!0;break;case 38:a.pop(),o=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var URt=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function zRt(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ei)||[]).forEach(function(i){var a=yt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[URt.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function GRt(){}function YRt(){}var KRt=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,XRt=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,qRt=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ZRt(e,t,r){t.themeElements={};var n;[["clrScheme",KRt,zRt],["fontScheme",XRt,GRt],["fmtScheme",qRt,YRt]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var JRt=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Mfe(e,t){(!e||e.length===0)&&(e=QRt());var r,n={};if(!(r=e.match(JRt)))throw new Error("themeElements not found in theme");return ZRt(r[0],n,t),n.raw=e,n}function QRt(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Uue];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function ekt(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=Wue(a,{type:"array"})}catch{return}var s=Zi(o,"theme/theme/theme1.xml",!0);if(s)return Mfe(s,r)}}function tkt(e){return e.read_shift(4)}function rkt(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=nkt(e,4);break;case 2:t.xclrValue=bfe(e);break;case 3:t.xclrValue=tkt(e);break;case 4:e.l+=4;break}return e.l+=8,t}function nkt(e,t){return Zn(e,t)}function ikt(e,t){return Zn(e,t)}function akt(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=rkt(e);break;case 6:n[1]=ikt(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function okt(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(akt(e,r-e.l));return{ixfe:n,ext:a}}function skt(e,t){t.forEach(function(r){switch(r[0]){}})}function lkt(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Yn(e)}}function ukt(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function fkt(e){return e.l+=4,e.read_shift(4)!=0}function ckt(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,s=2;return Ol(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(c){s==1?n.Cell.push({type:n.Types[c[0]-1].name,index:c[1]}):s==0&&n.Value.push({type:n.Types[c[0]-1].name,index:c[1]})});break;case 337:s=l?1:0;break;case 338:s=2;break;case 35:a.push(f),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function hkt(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(ei,function(s){var l=yt(s);switch(ls(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return s}),n}function dkt(e){var t=[];if(!e)return t;var r=1;return(e.match(ei)||[]).forEach(function(n){var i=yt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function vkt(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=_t(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function pkt(e,t,r){var n=[];return Ol(e,function(a,o,s){switch(s){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+s.toString(16))}}),n}function gkt(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Ol(e,function(s,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function ykt(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Aq(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(o){var s=pi(o.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[o.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[o.ref]=a;var l=Yr(e["!ref"]||"BDWGO1000001:A1");l.s.r>s.r&&(l.s.r=s.r),l.e.r<s.r&&(l.e.r=s.r),l.s.c>s.c&&(l.s.c=s.c),l.e.c<s.c&&(l.e.c=s.c);var u=qt(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:o.author,t:o.t,r:o.r,T:r};o.h&&(f.h=o.h);for(var c=a.c.length-1;c>=0;--c){if(!r&&a.c[c].T)return;r&&!a.c[c].T&&a.c.splice(c,1)}if(r&&n){for(c=0;c<n.length;++c)if(f.a==n[c].id){f.a=n[c].name||f.a;break}}a.c.push(f)})}function mkt(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&r.push(s[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?comment[^>]*>/);if(s){var l=yt(s[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=pi(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var c=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!c&&!!c[1]&&Q3(c[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function bkt(e,t){var r=[],n=!1,i={},a=0;return e.replace(ei,function(s,l){var u=yt(s);switch(ls(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=l+s.length;break;case"</text>":i.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return s}),r}function wkt(e,t){var r=[],n=!1;return e.replace(ei,function(a){var o=yt(a);switch(ls(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function _kt(e){var t={};t.iauthor=e.read_shift(4);var r=yh(e);return t.rfx=r.s,t.ref=_t(r.s),e.l+=16,t}var Skt=Yn;function Ckt(e,t){var r=[],n=[],i={},a=!1;return Ol(e,function(s,l,u){switch(u){case 632:n.push(s);break;case 635:i=s;break;case 637:i.t=s.t,i.h=s.h,i.r=s.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var xkt="application/vnd.ms-office.vbaProject";function Tkt(e){var t=Kt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Kt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Kt.write(t)}function Okt(){return{"!type":"dialog"}}function Ekt(){return{"!type":"dialog"}}function Rkt(){return{"!type":"macro"}}function kkt(){return{"!type":"macro"}}var ev=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,o){var s=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return s?f+=t.c:--f,l?u+=t.r:--u,i+(s?"":"$")+wn(f)+(l?"":"$")+$n(u)}return function(i,a){return t=a,i.replace(e,r)}}(),Dfe=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Akt=function(){return function(t,r){return t.replace(Dfe,function(n,i,a,o,s,l){var u=Y3(o)-(a?0:r.c),f=G3(l)-(s?0:r.r),c=f==0?"":s?f+1:"["+f+"]",h=u==0?"":a?u+1:"["+u+"]";return i+"R"+c+"C"+h})}}();function $fe(e,t){return e.replace(Dfe,function(r,n,i,a,o,s){return n+(i=="$"?i+a:wn(Y3(a)+t.c))+(o=="$"?o+s:$n(G3(s)+t.r))})}function Pkt(e,t,r){var n=Bg(t),i=n.s,a=pi(r),o={r:a.r-i.r,c:a.c-i.c};return $fe(e,o)}function Ikt(e){return e.length!=1}function Pq(e){return e.replace(/_xlfn\./g,"")}function fn(e){e.l+=1}function ju(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function Nfe(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Lfe(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=ju(e,2),s=ju(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Lfe(e){var t=ju(e,2),r=ju(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Mkt(e,t,r){if(r.biff<8)return Lfe(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=ju(e,2),o=ju(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Ffe(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Dkt(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ju(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function Dkt(e){var t=ju(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function $kt(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Nkt(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Lkt(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function Lkt(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function Fkt(e,t,r){var n=(e[e.l++]&96)>>5,i=Nfe(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Hkt(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=Nfe(e,a,r);return[n,i,o]}function Bkt(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Vkt(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function jkt(e,t,r){var n=(e[e.l++]&96)>>5,i=Mkt(e,t-1,r);return[n,i]}function Wkt(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Iq(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Ukt(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function zkt(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Gkt(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ykt(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Kkt(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Hfe(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Xkt(e){return e.read_shift(2),Hfe(e)}function qkt(e){return e.read_shift(2),Hfe(e)}function Zkt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Ffe(e,0,r);return[n,i]}function Jkt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Nkt(e,0,r);return[n,i]}function Qkt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=Ffe(e,0,r);return[n,i,a]}function eAt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[tPt[i],jfe[i],n]}function tAt(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:rAt(e);return[i,(a[0]===0?jfe:ePt)[a[1]]]}function rAt(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function nAt(e,t,r){e.l+=r&&r.biff==2?3:4}function iAt(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function aAt(e){return e.l++,mh[e.read_shift(1)]}function oAt(e){return e.l++,e.read_shift(2)}function sAt(e){return e.l++,e.read_shift(1)!==0}function lAt(e){return e.l++,Wn(e)}function uAt(e,t,r){return e.l++,E_(e,t-1,r)}function fAt(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Zr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=mh[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wn(e);break;case 2:r[1]=bh(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function cAt(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?yh:FE)(e));return i}function hAt(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=fAt(e,r.biff);return o}function dAt(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function vAt(e,t,r){if(r.biff==5)return pAt(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function pAt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function gAt(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function yAt(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function mAt(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function bAt(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var wAt=Zn,_At=Zn,SAt=Zn;function k_(e,t,r){return e.l+=2,[$kt(e)]}function t4(e){return e.l+=6,[]}var CAt=k_,xAt=t4,TAt=t4,OAt=k_;function Bfe(e){return e.l+=2,[hn(e),e.read_shift(2)&1]}var EAt=k_,RAt=Bfe,kAt=t4,AAt=k_,PAt=k_,IAt=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function MAt(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=IAt[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function DAt(e){return e.l+=2,[e.read_shift(4)]}function $At(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function NAt(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function LAt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function FAt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function HAt(e){return e.l+=4,[0,0]}var Mq={1:{n:"PtgExp",f:iAt},2:{n:"PtgTbl",f:SAt},3:{n:"PtgAdd",f:fn},4:{n:"PtgSub",f:fn},5:{n:"PtgMul",f:fn},6:{n:"PtgDiv",f:fn},7:{n:"PtgPower",f:fn},8:{n:"PtgConcat",f:fn},9:{n:"PtgLt",f:fn},10:{n:"PtgLe",f:fn},11:{n:"PtgEq",f:fn},12:{n:"PtgGe",f:fn},13:{n:"PtgGt",f:fn},14:{n:"PtgNe",f:fn},15:{n:"PtgIsect",f:fn},16:{n:"PtgUnion",f:fn},17:{n:"PtgRange",f:fn},18:{n:"PtgUplus",f:fn},19:{n:"PtgUminus",f:fn},20:{n:"PtgPercent",f:fn},21:{n:"PtgParen",f:fn},22:{n:"PtgMissArg",f:fn},23:{n:"PtgStr",f:uAt},26:{n:"PtgSheet",f:$At},27:{n:"PtgEndSheet",f:NAt},28:{n:"PtgErr",f:aAt},29:{n:"PtgBool",f:sAt},30:{n:"PtgInt",f:oAt},31:{n:"PtgNum",f:lAt},32:{n:"PtgArray",f:Wkt},33:{n:"PtgFunc",f:eAt},34:{n:"PtgFuncVar",f:tAt},35:{n:"PtgName",f:dAt},36:{n:"PtgRef",f:Zkt},37:{n:"PtgArea",f:Fkt},38:{n:"PtgMemArea",f:gAt},39:{n:"PtgMemErr",f:wAt},40:{n:"PtgMemNoMem",f:_At},41:{n:"PtgMemFunc",f:yAt},42:{n:"PtgRefErr",f:mAt},43:{n:"PtgAreaErr",f:Bkt},44:{n:"PtgRefN",f:Jkt},45:{n:"PtgAreaN",f:jkt},46:{n:"PtgMemAreaN",f:LAt},47:{n:"PtgMemNoMemN",f:FAt},57:{n:"PtgNameX",f:vAt},58:{n:"PtgRef3d",f:Qkt},59:{n:"PtgArea3d",f:Hkt},60:{n:"PtgRefErr3d",f:bAt},61:{n:"PtgAreaErr3d",f:Vkt},255:{}},BAt={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},VAt={1:{n:"PtgElfLel",f:Bfe},2:{n:"PtgElfRw",f:AAt},3:{n:"PtgElfCol",f:CAt},6:{n:"PtgElfRwV",f:PAt},7:{n:"PtgElfColV",f:OAt},10:{n:"PtgElfRadical",f:EAt},11:{n:"PtgElfRadicalS",f:kAt},13:{n:"PtgElfColS",f:xAt},15:{n:"PtgElfColSV",f:TAt},16:{n:"PtgElfRadicalLel",f:RAt},25:{n:"PtgList",f:MAt},29:{n:"PtgSxName",f:DAt},255:{}},jAt={0:{n:"PtgAttrNoop",f:HAt},1:{n:"PtgAttrSemi",f:Kkt},2:{n:"PtgAttrIf",f:Gkt},4:{n:"PtgAttrChoose",f:Ukt},8:{n:"PtgAttrGoto",f:zkt},16:{n:"PtgAttrSum",f:nAt},32:{n:"PtgAttrBaxcel",f:Iq},33:{n:"PtgAttrBaxcel",f:Iq},64:{n:"PtgAttrSpace",f:Xkt},65:{n:"PtgAttrSpaceSemi",f:qkt},128:{n:"PtgAttrIfError",f:Ykt},255:{}};function A_(e,t,r,n){if(n.biff<8)return Zn(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=hAt(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=cAt(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(Zn(e,t)),a}function P_(e,t,r){for(var n=e.l+t,i,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],i=Mq[a]||Mq[BAt[a]],(a===24||a===25)&&(i=(a===24?VAt:jAt)[e[e.l+1]]),!i||!i.f?Zn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function WAt(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var UAt={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zAt(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Vfe(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Dq(e,t,r){var n=Vfe(e,t,r);return n=="#REF"?n:zAt(n,r)}function Vn(e,t,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],l,u,f,c=0,h=0,d,v="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",y=0,m=e[0].length;y<m;++y){var b=e[0][y];switch(b[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=s.pop(),u=s.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Gr(" ",e[0][p][1][1]);break;case 1:g=Gr("\r",e[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}s.push(u+UAt[b[0]]+l);break;case"PtgIsect":l=s.pop(),u=s.pop(),s.push(u+" "+l);break;case"PtgUnion":l=s.pop(),u=s.pop(),s.push(u+","+l);break;case"PtgRange":l=s.pop(),u=s.pop(),s.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Hm(b[1][1],o,i),s.push(Bm(f,a));break;case"PtgRefN":f=r?Hm(b[1][1],r,i):b[1][1],s.push(Bm(f,a));break;case"PtgRef3d":c=b[1][1],f=Hm(b[1][2],o,i),v=Dq(n,c,i),s.push(v+"!"+Bm(f,a));break;case"PtgFunc":case"PtgFuncVar":var _=b[1][0],x=b[1][1];_||(_=0),_&=127;var T=_==0?[]:s.slice(-_);s.length-=_,x==="User"&&(x=T.shift()),s.push(x+"("+T.join(",")+")");break;case"PtgBool":s.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(b[1]);break;case"PtgNum":s.push(String(b[1]));break;case"PtgStr":s.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(b[1]);break;case"PtgAreaN":d=vq(b[1][1],r?{s:r}:o,i),s.push(VP(d,i));break;case"PtgArea":d=vq(b[1][1],o,i),s.push(VP(d,i));break;case"PtgArea3d":c=b[1][1],d=b[1][2],v=Dq(n,c,i),s.push(v+"!"+VP(d,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],P=E?E.Name:"SH33TJSNAME"+String(h);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),s.push(P);break;case"PtgNameX":var R=b[1][1];h=b[1][2];var M;if(i.biff<=5)R<0&&(R=-R),n[R]&&(M=n[R][h]);else{var D="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][h]&&n[R][h].itab>0&&(D=n.SheetNames[n[R][h].itab-1]+"!"):D=n.SheetNames[h-1]+"!"),n[R]&&n[R][h])D+=n[R][h].Name;else if(n[0]&&n[0][h])D+=n[0][h].Name;else{var N=(Vfe(n,R,i)||"").split(";;");N[h-1]?D=N[h-1]:D+="SH33TJSERRX"}s.push(D);break}M||(M={Name:"SH33TJSERRY"}),s.push(M.Name);break;case"PtgParen":var B="(",K=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:B=Gr(" ",e[0][p][1][1])+B;break;case 3:B=Gr("\r",e[0][p][1][1])+B;break;case 4:K=Gr(" ",e[0][p][1][1])+K;break;case 5:K=Gr("\r",e[0][p][1][1])+K;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}s.push(B+s.pop()+K);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:b[1][1],r:b[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[_t(f)]){var ie=n.sharedf[_t(f)];s.push(Vn(ie,o,Z,n,i))}else{var me=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){s.push(Vn(u[1],o,Z,n,i)),me=!0;break}me||s.push(b[1])}break;case"PtgArray":s.push("{"+WAt(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var k=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&k.indexOf(e[0][y][0])==-1){b=e[0][p];var w=!0;switch(b[1][0]){case 4:w=!1;case 0:g=Gr(" ",b[1][1]);break;case 5:w=!1;case 1:g=Gr("\r",b[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}s.push((w?g:"")+s.pop()+(w?"":g)),p=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function GAt(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Zn(e,t-2)];var s=P_(e,o,r);return t!==o+i&&(a=A_(e,t-o-i,s,r)),e.l=n,[s,a]}function YAt(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],Zn(e,t-2)];var s=P_(e,o,r);return t!==o+i&&(a=A_(e,t-o-i,s,r)),e.l=n,[s,a]}function KAt(e,t,r,n){var i=e.l+t,a=P_(e,n,r),o;return i!==e.l&&(o=A_(e,i-e.l,a,r)),[a,o]}function XAt(e,t,r){var n=e.l+t,i,a=e.read_shift(2),o=P_(e,a,r);return a==65535?[[],Zn(e,t-2)]:(t!==a+2&&(i=A_(e,n-a-2,o,r)),[o,i])}function qAt(e){var t;if(rl(e,e.l+6)!==65535)return[Wn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function UP(e,t,r){var n=e.l+t,i=us(e);r.biff==2&&++e.l;var a=qAt(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var s=YAt(e,n-e.l,r);return{cell:i,val:a[0],formula:s,shared:o>>3&1,tt:a[1]}}function HE(e,t,r){var n=e.read_shift(4),i=P_(e,n,r),a=e.read_shift(4),o=a>0?A_(e,a,i,r):null;return[i,o]}var ZAt=HE,BE=HE,JAt=HE,QAt=HE,ePt={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jfe={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},tPt={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $q(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zP(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Um={},tv={};function zm(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Wfe(e,t,r,n,i,a){try{n.cellNF&&(e.z=Et[t])}catch(s){if(n.WTF)throw s}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Rn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Et[t]==null&&Oc(nTt[t]||"General",t),e.t==="e")e.w=e.w||mh[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gw(e.v);else if(e.t==="d"){var o=wi(e.v);(o|0)===o?e.w=o.toString(10):e.w=gw(o)}else{if(e.v===void 0)return"";e.w=Yc(e.v,tv)}else e.t==="d"?e.w=Ia(t,wi(e.v),tv):e.w=Ia(t,e.v,tv)}catch(s){if(n.WTF)throw s}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=WT(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=WT(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(n.WTF&&a.Fills)throw s}}}function rPt(e,t){var r=Yr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=qt(r))}var nPt=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,iPt=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,aPt=/<(?:\w:)?hyperlink [^>]*>/mg,oPt=/"(\w*:\w*)"/,sPt=/<(?:\w:)?col\b[^>]*[\/]?>/g,lPt=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,uPt=/<(?:\w:)?pageMargins[^>]*\/>/g,Ufe=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,fPt=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,cPt=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function hPt(e,t,r,n,i,a,o){if(!e)return e;n||(n={"!id":{}});var s=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",c=e.match(iPt);c?(u=e.slice(0,c.index),f=e.slice(c.index+c[0].length)):u=f=e;var h=u.match(Ufe);h?r4(h[0],s,i,r):(h=u.match(fPt))&&dPt(h[0],h[1]||"",s,i,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=u.slice(d,d+50).match(oPt);v&&rPt(s,v[1])}var p=u.match(cPt);p&&p[1]&&bPt(p[1],i);var g=[];if(t.cellStyles){var y=u.match(sPt);y&&gPt(g,y)}c&&wPt(c[1],s,t,l,a,o);var m=f.match(lPt);m&&(s["!autofilter"]=yPt(m[0]));var b=[],_=f.match(nPt);if(_)for(d=0;d!=_.length;++d)b[d]=Yr(_[d].slice(_[d].indexOf('"')+1));var x=f.match(aPt);x&&vPt(s,x,n);var T=f.match(uPt);if(T&&(s["!margins"]=pPt(yt(T[0]))),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=qt(l)),t.sheetRows>0&&s["!ref"]){var E=Yr(s["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),s["!fullref"]=s["!ref"],s["!ref"]=qt(E))}return g.length>0&&(s["!cols"]=g),b.length>0&&(s["!merges"]=b),s}function r4(e,t,r,n){var i=yt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=er(Cr(i.codeName)))}function dPt(e,t,r,n,i){r4(e.slice(0,e.indexOf(">")),r,n,i)}function vPt(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=yt(Cr(t[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+er(a.location))):(a.Target="#"+er(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var s=Yr(a.ref),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var f=_t({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function pPt(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function gPt(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=yt(t[n],!0);i.hidden&&(i.hidden=Ir(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,e4(i.width)),mg(i);a<=o;)e[a++]=Dn(i)}}function yPt(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var mPt=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bPt(e,t){t.Views||(t.Views=[{}]),(e.match(mPt)||[]).forEach(function(r,n){var i=yt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Ir(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var wPt=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=yw("v"),o=yw("f");return function(l,u,f,c,h,d){for(var v=0,p="",g=[],y=[],m=0,b=0,_=0,x="",T,E,P=0,R=0,M,D,N=0,B=0,K=Array.isArray(d.CellXf),Z,ie=[],me=[],k=Array.isArray(u),w=[],C={},O=!1,S=!!f.sheetStubs,A=l.split(t),I=0,L=A.length;I!=L;++I){p=A[I].trim();var V=p.length;if(V!==0){var Y=0;e:for(v=0;v<V;++v)switch(p[v]){case">":if(p[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(E=yt(p.slice(Y,v),!0),P=E.r!=null?parseInt(E.r,10):P+1,R=-1,f.sheetRows&&f.sheetRows<P)continue;C={},O=!1,E.ht&&(O=!0,C.hpt=parseFloat(E.ht),C.hpx=_w(C.hpt)),E.hidden=="1"&&(O=!0,C.hidden=!0),E.outlineLevel!=null&&(O=!0,C.level=+E.outlineLevel),O&&(w[P-1]=C)}break;case"<":Y=v;break}if(Y>=v)break;if(E=yt(p.slice(Y,v),!0),P=E.r!=null?parseInt(E.r,10):P+1,R=-1,!(f.sheetRows&&f.sheetRows<P)){c.s.r>P-1&&(c.s.r=P-1),c.e.r<P-1&&(c.e.r=P-1),f&&f.cellStyles&&(C={},O=!1,E.ht&&(O=!0,C.hpt=parseFloat(E.ht),C.hpx=_w(C.hpt)),E.hidden=="1"&&(O=!0,C.hidden=!0),E.outlineLevel!=null&&(O=!0,C.level=+E.outlineLevel),O&&(w[P-1]=C)),g=p.slice(v).split(e);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),v=0;v!=g.length;++v)if(p=g[v].trim(),p.length!==0){if(y=p.match(r),m=v,b=0,_=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(m=0,x=y[1],b=0;b!=x.length&&!((_=x.charCodeAt(b)-64)<1||_>26);++b)m=26*m+_;--m,R=m}else++R;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,E=yt(p.slice(0,b),!0),E.r||(E.r=_t({r:P-1,c:R})),x=p.slice(b),T={t:""},(y=x.match(a))!=null&&y[1]!==""&&(T.v=er(y[1])),f.cellFormula){if((y=x.match(o))!=null&&y[1]!==""){if(T.f=er(Cr(y[1])).replace(/\r\n/g,`
`),f.xlfn||(T.f=Pq(T.f)),y[0].indexOf('t="array"')>-1)T.F=(x.match(i)||[])[1],T.F.indexOf(":")>-1&&ie.push([Yr(T.F),T.F]);else if(y[0].indexOf('t="shared"')>-1){D=yt(y[0]);var re=er(Cr(y[1]));f.xlfn||(re=Pq(re)),me[parseInt(D.si,10)]=[D,re,E.r]}}else(y=x.match(/<f[^>]*\/>/))&&(D=yt(y[0]),me[D.si]&&(T.f=Pkt(me[D.si][1],me[D.si][2],E.r)));var te=pi(E.r);for(b=0;b<ie.length;++b)te.r>=ie[b][0].s.r&&te.r<=ie[b][0].e.r&&te.c>=ie[b][0].s.c&&te.c<=ie[b][0].e.c&&(T.F=ie[b][1])}if(E.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(S)T.t="z";else continue;else T.t=E.t||"n";switch(c.s.c>R&&(c.s.c=R),c.e.c<R&&(c.e.c=R),T.t){case"n":if(T.v==""||T.v==null){if(!S)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!S)continue;T.t="z"}else M=Um[parseInt(T.v,10)],T.v=M.t,T.r=M.r,f.cellHTML&&(T.h=M.h);break;case"str":T.t="s",T.v=T.v!=null?Cr(T.v):"",f.cellHTML&&(T.h=W3(T.v));break;case"inlineStr":y=x.match(n),T.t="s",y!=null&&(M=Q3(y[1]))?(T.v=M.t,f.cellHTML&&(T.h=M.h)):T.v="";break;case"b":T.v=Ir(T.v);break;case"d":f.cellDates?T.v=Rn(T.v,1):(T.v=wi(Rn(T.v,1)),T.t="n");break;case"e":(!f||f.cellText!==!1)&&(T.w=T.v),T.v=cfe[T.v];break}if(N=B=0,Z=null,K&&E.s!==void 0&&(Z=d.CellXf[E.s],Z!=null&&(Z.numFmtId!=null&&(N=Z.numFmtId),f.cellStyles&&Z.fillId!=null&&(B=Z.fillId))),Wfe(T,N,B,f,h,d),f.cellDates&&K&&T.t=="n"&&Hg(Et[N])&&(T.t="d",T.v=LE(T.v)),E.cm&&f.xlmeta){var ge=(f.xlmeta.Cell||[])[+E.cm-1];ge&&ge.type=="XLDAPR"&&(T.D=!0)}if(k){var H=pi(E.r);u[H.r]||(u[H.r]=[]),u[H.r][H.c]=T}else u[E.r]=T}}}}w.length>0&&(u["!rows"]=w)}}();function _Pt(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var SPt=yh;function CPt(){}function xPt(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=GTt(e),r}function TPt(e){var t=Ba(e);return[t]}function OPt(e){var t=gh(e);return[t]}function EPt(e){var t=Ba(e),r=e.read_shift(1);return[t,r,"b"]}function RPt(e){var t=gh(e),r=e.read_shift(1);return[t,r,"b"]}function kPt(e){var t=Ba(e),r=e.read_shift(1);return[t,r,"e"]}function APt(e){var t=gh(e),r=e.read_shift(1);return[t,r,"e"]}function PPt(e){var t=Ba(e),r=e.read_shift(4);return[t,r,"s"]}function IPt(e){var t=gh(e),r=e.read_shift(4);return[t,r,"s"]}function MPt(e){var t=Ba(e),r=Wn(e);return[t,r,"n"]}function zfe(e){var t=gh(e),r=Wn(e);return[t,r,"n"]}function DPt(e){var t=Ba(e),r=q3(e);return[t,r,"n"]}function $Pt(e){var t=gh(e),r=q3(e);return[t,r,"n"]}function NPt(e){var t=Ba(e),r=K3(e);return[t,r,"is"]}function LPt(e){var t=Ba(e),r=Yn(e);return[t,r,"str"]}function FPt(e){var t=gh(e),r=Yn(e);return[t,r,"str"]}function HPt(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var s=BE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}function BPt(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var s=BE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}function VPt(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=Wn(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var s=BE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}function jPt(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=Yn(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var s=BE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}var WPt=yh;function UPt(e,t){var r=e.l+t,n=yh(e),i=X3(e),a=Yn(e),o=Yn(e),s=Yn(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:s};return o&&(l.Tooltip=o),l}function zPt(){}function GPt(e,t,r){var n=e.l+t,i=lfe(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var s=ZAt(e,n-e.l,r);o[1]=s}else e.l=n;return o}function YPt(e,t,r){var n=e.l+t,i=yh(e),a=[i];if(r.cellFormula){var o=QAt(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}var KPt=["left","right","top","bottom","header","footer"];function XPt(e){var t={};return KPt.forEach(function(r){t[r]=Wn(e)}),t}function qPt(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ZPt(){}function JPt(){}function QPt(e,t,r,n,i,a,o){if(!e)return e;var s=t||{};n||(n={"!id":{}});var l=s.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},c=!1,h=!1,d,v,p,g,y,m,b,_,x,T=[];s.biff=12,s["!row"]=0;var E=0,P=!1,R=[],M={},D=s.supbooks||i.supbooks||[[]];if(D.sharedf=M,D.arrayf=R,D.SheetNames=i.SheetNames||i.Sheets.map(function(k){return k.name}),!s.supbooks&&(s.supbooks=D,i.Names))for(var N=0;N<i.Names.length;++N)D[0][N+1]=i.Names[N];var B=[],K=[],Z=!1;GT[16]={n:"BrtShortReal",f:zfe};var ie;if(Ol(e,function(w,C,O){if(!h)switch(O){case 148:u=w;break;case 0:d=w,s.sheetRows&&s.sheetRows<=d.r&&(h=!0),_=$n(g=d.r),s["!row"]=d.r,(w.hidden||w.hpt||w.level!=null)&&(w.hpt&&(w.hpx=_w(w.hpt)),K[w.r]=w);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:w[2]},w[2]){case"n":v.v=w[1];break;case"s":b=Um[w[1]],v.v=b.t,v.r=b.r;break;case"b":v.v=!!w[1];break;case"e":v.v=w[1],s.cellText!==!1&&(v.w=mh[v.v]);break;case"str":v.t="s",v.v=w[1];break;case"is":v.t="s",v.v=w[1].t;break}if((p=o.CellXf[w[0].iStyleRef])&&Wfe(v,p.numFmtId,null,s,a,o),y=w[0].c==-1?y+1:w[0].c,s.dense?(l[g]||(l[g]=[]),l[g][y]=v):l[wn(y)+_]=v,s.cellFormula){for(P=!1,E=0;E<R.length;++E){var S=R[E];d.r>=S[0].s.r&&d.r<=S[0].e.r&&y>=S[0].s.c&&y<=S[0].e.c&&(v.F=qt(S[0]),P=!0)}!P&&w.length>3&&(v.f=w[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>y&&(f.s.c=y),f.e.r<d.r&&(f.e.r=d.r),f.e.c<y&&(f.e.c=y),s.cellDates&&p&&v.t=="n"&&Hg(Et[p.numFmtId])){var A=mc(v.v);A&&(v.t="d",v.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}ie&&(ie.type=="XLDAPR"&&(v.D=!0),ie=void 0);break;case 1:case 12:if(!s.sheetStubs||c)break;v={t:"z",v:void 0},y=w[0].c==-1?y+1:w[0].c,s.dense?(l[g]||(l[g]=[]),l[g][y]=v):l[wn(y)+_]=v,f.s.r>d.r&&(f.s.r=d.r),f.s.c>y&&(f.s.c=y),f.e.r<d.r&&(f.e.r=d.r),f.e.c<y&&(f.e.c=y),ie&&(ie.type=="XLDAPR"&&(v.D=!0),ie=void 0);break;case 176:T.push(w);break;case 49:ie=((s.xlmeta||{}).Cell||[])[w-1];break;case 494:var I=n["!id"][w.relId];for(I?(w.Target=I.Target,w.loc&&(w.Target+="#"+w.loc),w.Rel=I):w.relId==""&&(w.Target="#"+w.loc),g=w.rfx.s.r;g<=w.rfx.e.r;++g)for(y=w.rfx.s.c;y<=w.rfx.e.c;++y)s.dense?(l[g]||(l[g]=[]),l[g][y]||(l[g][y]={t:"z",v:void 0}),l[g][y].l=w):(m=_t({c:y,r:g}),l[m]||(l[m]={t:"z",v:void 0}),l[m].l=w);break;case 426:if(!s.cellFormula)break;R.push(w),x=s.dense?l[g][y]:l[wn(y)+_],x.f=Vn(w[1],f,{r:d.r,c:y},D,s),x.F=qt(w[0]);break;case 427:if(!s.cellFormula)break;M[_t(w[0].s)]=w[1],x=s.dense?l[g][y]:l[wn(y)+_],x.f=Vn(w[1],f,{r:d.r,c:y},D,s);break;case 60:if(!s.cellStyles)break;for(;w.e>=w.s;)B[w.e--]={width:w.w/256,hidden:!!(w.flags&1),level:w.level},Z||(Z=!0,e4(w.w/256)),mg(B[w.e+1]);break;case 161:l["!autofilter"]={ref:qt(w)};break;case 476:l["!margins"]=w;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),w.name&&(i.Sheets[r].CodeName=w.name),(w.above||w.left)&&(l["!outline"]={above:w.above,left:w.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),w.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:c=!0;break;case 36:c=!1;break;case 37:c=!0;break;case 38:c=!1;break;default:if(!C.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+O.toString(16))}}},s),delete s.supbooks,delete s["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=qt(u||f)),s.sheetRows&&l["!ref"]){var me=Yr(l["!ref"]);s.sheetRows<=+me.e.r&&(me.e.r=s.sheetRows-1,me.e.r>f.e.r&&(me.e.r=f.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>f.e.c&&(me.e.c=f.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),l["!fullref"]=l["!ref"],l["!ref"]=qt(me))}return T.length>0&&(l["!merges"]=T),B.length>0&&(l["!cols"]=B),K.length>0&&(l["!rows"]=K),l}function eIt(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=er((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function tIt(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var s=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(c){var h=eIt(c);f.s.r=f.s.c=0,f.e.c=s,u=wn(s),h[0].forEach(function(d,v){o[u+$n(v)]={t:"n",v:d,z:h[1]},l=v}),f.e.r<l&&(f.e.r=l),++s}),s>0&&(o["!ref"]=qt(f)),o}function rIt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,s=e.match(Ufe);return s&&r4(s[0],a,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function nIt(e,t){e.l+=10;var r=Yn(e);return{name:r}}function iIt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ol(e,function(l,u,f){switch(f){case 550:a["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Gfe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aIt=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oIt=[],sIt=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Nq(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Ir(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Lq(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ir(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Yfe(e){Lq(e.WBProps,Gfe),Lq(e.CalcPr,sIt),Nq(e.WBView,aIt),Nq(e.Sheets,oIt),tv.date1904=Ir(e.WBProps.date1904)}var lIt="][*?/\\".split("");function uIt(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return lIt.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var fIt=/<\w+:workbook/;function cIt(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(ei,function(l,u){var f=yt(l);switch(ls(f[0])){case"<?xml":break;case"<workbook":l.match(fIt)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Gfe.forEach(function(c){if(f[c[0]]!=null)switch(c[2]){case"bool":r.WBProps[c[0]]=Ir(f[c[0]]);break;case"int":r.WBProps[c[0]]=parseInt(f[c[0]],10);break;default:r.WBProps[c[0]]=f[c[0]]}}),f.codeName&&(r.WBProps.CodeName=Cr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=er(Cr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Cr(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Ir(f.hidden||"0")&&(a.Hidden=!0),o=u+l.length;break;case"</definedName>":a.Ref=er(Cr(e.slice(o,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),kTt.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Yfe(r),r}function hIt(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=cN(e),r.name=Yn(e),r}function dIt(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Yn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vIt(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function pIt(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=YTt(e),o=JAt(e,0,r),s=X3(e);e.l=n;var l={Name:a,Ptg:o};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}function gIt(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],GT[16]={n:"BrtFRTArchID$",f:vIt},Ol(e,function(l,u,f){switch(f){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Vn(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,l]):o[0]=[f,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Yfe(r),r.Names=a,r.supbooks=o,r}function yIt(e,t,r){return t.slice(-4)===".bin"?gIt(e,r):cIt(e,r)}function mIt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?QPt(e,n,r,i,a,o,s):hPt(e,n,r,i,a,o,s)}function bIt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?iIt(e,n,r,i,a):rIt(e,n,r,i,a)}function wIt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?Rkt():kkt()}function _It(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?Okt():Ekt()}function SIt(e,t,r,n){return t.slice(-4)===".bin"?WRt(e,r,n):LRt(e,r,n)}function CIt(e,t,r){return Mfe(e,r)}function xIt(e,t,r){return t.slice(-4)===".bin"?aRt(e,r):nRt(e,r)}function TIt(e,t,r){return t.slice(-4)===".bin"?Ckt(e,r):mkt(e,r)}function OIt(e,t,r){return t.slice(-4)===".bin"?pkt(e):dkt(e)}function EIt(e,t,r,n){return r.slice(-4)===".bin"?gkt(e,t,r,n):void 0}function RIt(e,t,r){return t.slice(-4)===".bin"?ckt(e,t,r):hkt(e,t,r)}var Kfe=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Xfe=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ga(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(Kfe),a,o,s,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(Xfe),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),n[s]=a[2].slice(1,a[2].length-1));return n}function kIt(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Kfe),i,a,o,s;if(n)for(s=0;s!=n.length;++s)i=n[s].match(Xfe),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Gm;function AIt(e,t){var r=Gm[e]||er(e);return r==="General"?Yc(t):Ia(r,t)}function PIt(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ir(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Rn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[er(t)]=i}function IIt(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||mh[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gw(e.v):e.w=Yc(e.v):e.w=AIt(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Gm[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Hg(n)){var i=mc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function MIt(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=PRt[n.Pattern]||n.Pattern)}e[t.ID]=t}function DIt(e,t,r,n,i,a,o,s,l,u){var f="General",c=n.StyleID,h={};u=u||{};var d=[],v=0;for(c===void 0&&s&&(c=s.StyleID),c===void 0&&o&&(c=o.StyleID);a[c]!==void 0&&(a[c].nf&&(f=a[c].nf),a[c].Interior&&d.push(a[c].Interior),!!a[c].Parent);)c=a[c].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ir(e);break;case"String":n.t="s",n.r=aq(er(e)),n.v=e.indexOf("<")>-1?er(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Rn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=er(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=cfe[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=aq(t||e));break}if(IIt(n,f,u),u.cellFormula!==!1)if(n.Formula){var p=er(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=ev(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ev("RC:RC",i):n.ArrayRange&&(n.F=ev(n.ArrayRange,i),l.push([Yr(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);u.cellStyles&&(d.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function $It(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function GP(e,t){var r=t||{};Nue();var n=nm(U3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Cr(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Dn(r);return o.type="string",bw.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ie){i.indexOf("<"+Ie)>=0&&(a=!0)}),a)return UIt(n,r);Gm={"General Number":"General","General Date":Et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Et[15],"Short Date":Et[14],"Long Time":Et[19],"Medium Time":Et[18],"Short Time":Et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Et[2],Standard:Et[4],Percent:Et[10],Scientific:Et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,l=[],u,f={},c=[],h=r.dense?[]:{},d="",v={},p={},g=Ga('<Data ss:Type="String">'),y=0,m=0,b=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},x={},T={},E="",P=0,R=[],M={},D={},N=0,B=[],K=[],Z={},ie=[],me,k=!1,w=[],C=[],O={},S=0,A=0,I={Sheets:[],WBProps:{date1904:!1}},L={};mw.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var V="";s=mw.exec(n);)switch(s[3]=(V=s[3]).toLowerCase()){case"data":if(V=="data"){if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break}if(l[l.length-1][1])break;s[1]==="/"?DIt(n.slice(y,s.index),E,g,l[l.length-1][0]=="comment"?Z:v,{c:m,r:b},x,ie[m],p,w,r):(E="",g=Ga(s[0]),y=s.index+s[0].length);break;case"cell":if(s[1]==="/")if(K.length>0&&(v.c=K),(!r.sheetRows||r.sheetRows>b)&&v.v!==void 0&&(r.dense?(h[b]||(h[b]=[]),h[b][m]=v):h[wn(m)+$n(b)]=v),v.HRef&&(v.l={Target:er(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(S=m+(parseInt(v.MergeAcross,10)|0),A=b+(parseInt(v.MergeDown,10)|0),R.push({s:{c:m,r:b},e:{c:S,r:A}})),!r.sheetStubs)v.MergeAcross?m=S+1:++m;else if(v.MergeAcross||v.MergeDown){for(var Y=m;Y<=S;++Y)for(var ae=b;ae<=A;++ae)(Y>m||ae>b)&&(r.dense?(h[ae]||(h[ae]=[]),h[ae][Y]={t:"z"}):h[wn(Y)+$n(ae)]={t:"z"});m=S+1}else++m;else v=kIt(s[0]),v.Index&&(m=+v.Index-1),m<_.s.c&&(_.s.c=m),m>_.e.c&&(_.e.c=m),s[0].slice(-2)==="/>"&&++m,K=[];break;case"row":s[1]==="/"||s[0].slice(-2)==="/>"?(b<_.s.r&&(_.s.r=b),b>_.e.r&&(_.e.r=b),s[0].slice(-2)==="/>"&&(p=Ga(s[0]),p.Index&&(b=+p.Index-1)),m=0,++b):(p=Ga(s[0]),p.Index&&(b=+p.Index-1),O={},(p.AutoFitHeight=="0"||p.Height)&&(O.hpx=parseInt(p.Height,10),O.hpt=Ife(O.hpx),C[b]=O),p.Hidden=="1"&&(O.hidden=!0,C[b]=O));break;case"worksheet":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));c.push(d),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=qt(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=qt(_))),R.length&&(h["!merges"]=R),ie.length>0&&(h["!cols"]=ie),C.length>0&&(h["!rows"]=C),f[d]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=m=0,l.push([s[3],!1]),u=Ga(s[0]),d=er(u.Name),h=r.dense?[]:{},R=[],w=[],C=[],L={name:d,Hidden:0},I.Sheets.push(L);break;case"table":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else{if(s[0].slice(-2)=="/>")break;l.push([s[3],!1]),ie=[],k=!1}break;case"style":s[1]==="/"?MIt(x,T,r):T=Ga(s[0]);break;case"numberformat":T.nf=er(Ga(s[0]).Format||"General"),Gm[T.nf]&&(T.nf=Gm[T.nf]);for(var re=0;re!=392&&Et[re]!=T.nf;++re);if(re==392){for(re=57;re!=392;++re)if(Et[re]==null){Oc(T.nf,re);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(me=Ga(s[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!k&&me.wpx>10){k=!0,di=Afe;for(var te=0;te<ie.length;++te)ie[te]&&mg(ie[te])}k&&mg(me),ie[me.Index-1||ie.length]=me;for(var ge=0;ge<+me.Span;++ge)ie[ie.length]=Dn(me);break;case"namedrange":if(s[1]==="/")break;I.Names||(I.Names=[]);var H=yt(s[0]),Ce={Name:H.Name,Ref:ev(H.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(Ce.Sheet=I.Sheets.length-1),I.Names.push(Ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(s[0].slice(-2)==="/>")break;s[1]==="/"?E+=n.slice(P,s.index):P=s.index+s[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=Ga(s[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(s[0].slice(-2)==="/>")break;s[1]==="/"?mOt(M,V,n.slice(N,s.index)):N=s.index+s[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else l.push([s[3],!1]);break;case"comment":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));$It(Z),K.push(Z)}else l.push([s[3],!1]),u=Ga(s[0]),Z={a:u.Author};break;case"autofilter":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else if(s[0].charAt(s[0].length-2)!=="/"){var oe=Ga(s[0]);h["!autofilter"]={ref:ev(oe.Range).replace(/\$/g,"")},l.push([s[3],!0])}break;case"name":break;case"datavalidation":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"null":break;default:if(l.length==0&&s[3]=="document"||l.length==0&&s[3]=="uof")return Wq(n,r);var Oe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Oe=!1}break;case"componentoptions":switch(s[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Oe=!1}break;case"excelworkbook":switch(s[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Oe=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":break;case"height":break;case"width":break;default:Oe=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if(s[0].slice(-2)!=="/>")if(s[1]==="/")switch(n.slice(N,s.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else N=s.index+s[0].length;break;case"header":h["!margins"]||zm(h["!margins"]={},"xlml"),isNaN(+yt(s[0]).Margin)||(h["!margins"].header=+yt(s[0]).Margin);break;case"footer":h["!margins"]||zm(h["!margins"]={},"xlml"),isNaN(+yt(s[0]).Margin)||(h["!margins"].footer=+yt(s[0]).Margin);break;case"pagemargins":var Ee=yt(s[0]);h["!margins"]||zm(h["!margins"]={},"xlml"),isNaN(+Ee.Top)||(h["!margins"].top=+Ee.Top),isNaN(+Ee.Left)||(h["!margins"].left=+Ee.Left),isNaN(+Ee.Right)||(h["!margins"].right=+Ee.Right),isNaN(+Ee.Bottom)||(h["!margins"].bottom=+Ee.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Oe=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Oe=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Oe=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Oe=!1}break;case"querytable":switch(s[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Oe=!1}break;case"datavalidation":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Oe=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Oe=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Oe=!1}break;case"smarttags":break;default:Oe=!1;break}if(Oe||s[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(s[0].slice(-2)==="/>")break;s[1]==="/"?PIt(D,V,B,n.slice(N,s.index)):(B=s,N=s.index+s[0].length);break}if(r.WTF)throw"Unrecognized tag: "+s[3]+"|"+l.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=f),be.SheetNames=c,be.Workbook=I,be.SSF=Dn(Et),be.Props=M,be.Custprops=D,be}function pN(e,t){switch(a4(t=t||{}),t.type||"base64"){case"base64":return GP(ia(e),t);case"binary":case"buffer":case"file":return GP(e,t);case"array":return GP(ph(e),t)}}function NIt(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=qTt(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=ZTt(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var LIt=[60,1084,2066,2165,2175];function FIt(e,t,r,n,i){var a=n,o=[],s=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(s)}o.push(s),r.l+=a;for(var l=rl(r,r.l),u=gN[l],f=0;u!=null&&LIt.indexOf(l)>-1;)a=rl(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),s=r.slice(f,r.l+4+a),o.push(s),r.l+=4+a,u=gN[l=rl(r,r.l)];var c=Ql(o);In(c,0);var h=0;c.lens=[];for(var d=0;d<o.length;++d)c.lens.push(h),h+=o[d].length;if(c.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+c.length+" < "+n;return t.f(c,c.length,i)}function $o(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Et[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||mh[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gw(e.v):e.w=Yc(e.v):e.w=Ia(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Hg(Et[n]||String(n))){var i=mc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function $1(e,t,r){return{v:e,ixfe:t,t:r}}function HIt(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},o={},s=null,l=[],u="",f={},c,h="",d,v,p,g,y={},m=[],b,_,x=[],T=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},R=function(de){return de<8?Ec[de]:de<64&&T[de-8]||Ec[de]},M=function(de,Te,$e){var Fe=Te.XF.data;if(!(!Fe||!Fe.patternType||!$e||!$e.cellStyles)){Te.s={},Te.s.patternType=Fe.patternType;var it;(it=ww(R(Fe.icvFore)))&&(Te.s.fgColor={rgb:it}),(it=ww(R(Fe.icvBack)))&&(Te.s.bgColor={rgb:it})}},D=function(de,Te,$e){if(!(O>1)&&!($e.sheetRows&&de.r>=$e.sheetRows)){if($e.cellStyles&&Te.XF&&Te.XF.data&&M(de,Te,$e),delete Te.ixfe,delete Te.XF,c=de,h=_t(de),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),de.r<o.s.r&&(o.s.r=de.r),de.c<o.s.c&&(o.s.c=de.c),de.r+1>o.e.r&&(o.e.r=de.r+1),de.c+1>o.e.c&&(o.e.c=de.c+1),$e.cellFormula&&Te.f){for(var Fe=0;Fe<m.length;++Fe)if(!(m[Fe][0].s.c>de.c||m[Fe][0].s.r>de.r)&&!(m[Fe][0].e.c<de.c||m[Fe][0].e.r<de.r)){Te.F=qt(m[Fe][0]),(m[Fe][0].s.c!=de.c||m[Fe][0].s.r!=de.r)&&delete Te.f,Te.f&&(Te.f=""+Vn(m[Fe][1],o,de,w,N));break}}$e.dense?(i[de.r]||(i[de.r]=[]),i[de.r][de.c]=Te):i[h]=Te}},N={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:m,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(N.password=t.password);var B,K=[],Z=[],ie=[],me=[],k=!1,w=[];w.SheetNames=N.snames,w.sharedf=N.sharedf,w.arrayf=N.arrayf,w.names=[],w.XTI=[];var C=0,O=0,S=0,A=[],I=[],L;N.codepage=1200,lo(1200);for(var V=!1;e.l<e.length-1;){var Y=e.l,ae=e.read_shift(2);if(ae===0&&C===10)break;var re=e.l===e.length?0:e.read_shift(2),te=gN[ae];if(te&&te.f){if(t.bookSheets&&C===133&&ae!==133)break;if(C=ae,te.r===2||te.r==12){var ge=e.read_shift(2);if(re-=2,!N.enc&&ge!==ae&&((ge&255)<<8|ge>>8)!==ae)throw new Error("rt mismatch: "+ge+"!="+ae);te.r==12&&(e.l+=10,re-=10)}var H={};if(ae===10?H=te.f(e,re,N):H=FIt(ae,te,e,re,N),O==0&&[9,521,1033,2057].indexOf(C)===-1)continue;switch(ae){case 34:r.opts.Date1904=E.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(e.l=0),N.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=H;break;case 66:var Ce=Number(H);switch(Ce){case 21010:Ce=1200;break;case 32768:Ce=1e4;break;case 32769:Ce=1252;break}lo(N.codepage=Ce),V=!0;break;case 317:N.rrtabid=H;break;case 25:N.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:N.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:x.push(H);break;case 430:w.push([H]),w[w.length-1].XTI=[];break;case 35:case 547:w[w.length-1].push(H);break;case 24:case 536:L={Name:H.Name,Ref:Vn(H.rgce,o,null,w,N)},H.itab>0&&(L.Sheet=H.itab-1),w.names.push(L),w[0]||(w[0]=[],w[0].XTI=[]),w[w.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(I[H.itab-1]={ref:qt(H.rgce[0][0][1][2])});break;case 22:N.ExternCount=H;break;case 23:w.length==0&&(w[0]=[],w[0].XTI=[]),w[w.length-1].XTI=w[w.length-1].XTI.concat(H),w.XTI=w.XTI.concat(H);break;case 2196:if(N.biff<8)break;L!=null&&(L.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&N.WTF&&console.error("Password verifier: "+H);break;case 133:a[H.pos]=H,N.snames.push(H.name);break;case 10:{if(--O)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=qt(o),t.sheetRows&&t.sheetRows<=o.e.r){var oe=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=qt(o),o.e.r=oe}o.e.r++,o.e.c++}K.length>0&&(i["!merges"]=K),Z.length>0&&(i["!objects"]=Z),ie.length>0&&(i["!cols"]=ie),me.length>0&&(i["!rows"]=me),E.Sheets.push(P)}u===""?f=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),N.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(N.biff=5,V=!0,lo(N.codepage=28591)),N.biff==8&&H.BIFFVer==0&&H.dt==16&&(N.biff=2),O++)break;if(i=t.dense?[]:{},N.biff<8&&!V&&(V=!0,lo(N.codepage=t.codepage||1252)),N.biff<5||H.BIFFVer==0&&H.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Oe={pos:e.l-re,name:u};a[Oe.pos]=Oe,N.snames.push(u)}else u=(a[Y]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),K=[],Z=[],N.arrayf=m=[],ie=[],me=[],k=!1,P={Hidden:(a[Y]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[H.r]||[])[H.c]:i[_t({c:H.c,r:H.r})])&&++H.c,b={ixfe:H.ixfe,XF:x[H.ixfe]||{},v:H.val,t:"n"},S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 5:case 517:b={ixfe:H.ixfe,XF:x[H.ixfe],v:H.val,t:H.t},S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 638:b={ixfe:H.ixfe,XF:x[H.ixfe],v:H.rknum,t:"n"},S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 189:for(var Ee=H.c;Ee<=H.C;++Ee){var be=H.rkrec[Ee-H.c][0];b={ixfe:be,XF:x[be],v:H.rkrec[Ee-H.c][1],t:"n"},S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:Ee,r:H.r},b,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){s=H;break}if(b=$1(H.val,H.cell.ixfe,H.tt),b.XF=x[b.ixfe],t.cellFormula){var Ie=H.formula;if(Ie&&Ie[0]&&Ie[0][0]&&Ie[0][0][0]=="PtgExp"){var Me=Ie[0][0][1][0],j=Ie[0][0][1][1],U=_t({r:Me,c:j});y[U]?b.f=""+Vn(H.formula,o,H.cell,w,N):b.F=((t.dense?(i[Me]||[])[j]:i[U])||{}).F}else b.f=""+Vn(H.formula,o,H.cell,w,N)}S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D(H.cell,b,t),s=H}break;case 7:case 519:if(s)s.val=H,b=$1(H,s.cell.ixfe,"s"),b.XF=x[b.ixfe],t.cellFormula&&(b.f=""+Vn(s.formula,o,s.cell,w,N)),S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D(s.cell,b,t),s=null;else throw new Error("String record expects Formula");break;case 33:case 545:{m.push(H);var Q=_t(H[0].s);if(d=t.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[Q],t.cellFormula&&d){if(!s||!Q||!d)break;d.f=""+Vn(H[1],o,H[0],w,N),d.F=qt(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!s)break;y[_t(s.cell)]=H[0],d=t.dense?(i[s.cell.r]||[])[s.cell.c]:i[_t(s.cell)],(d||{}).f=""+Vn(H[0],o,c,w,N)}}break;case 253:b=$1(l[H.isst].t,H.ixfe,"s"),l[H.isst].h&&(b.h=l[H.isst].h),b.XF=x[b.ixfe],S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:H.ixfe,XF:x[H.ixfe],t:"z"},S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t));break;case 190:if(t.sheetStubs)for(var fe=H.c;fe<=H.C;++fe){var ee=H.ixfe[fe-H.c];b={ixfe:ee,XF:x[ee],t:"z"},S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:fe,r:H.r},b,t)}break;case 214:case 516:case 4:b=$1(H.val,H.ixfe,"s"),b.XF=x[b.ixfe],S>0&&(b.z=A[b.ixfe>>8&63]),$o(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 0:case 512:O===1&&(o=H);break;case 252:l=H;break;case 1054:if(N.biff==4){A[S++]=H[1];for(var pe=0;pe<S+163&&Et[pe]!=H[1];++pe);pe>=163&&Oc(H[1],S+163)}else Oc(H[1],H[0]);break;case 30:{A[S++]=H;for(var se=0;se<S+163&&Et[se]!=H;++se);se>=163&&Oc(H,S+163)}break;case 229:K=K.concat(H);break;case 93:Z[H.cmo[0]]=N.lastobj=H;break;case 438:N.lastobj.TxO=H;break;case 127:N.lastobj.ImData=H;break;case 440:for(g=H[0].s.r;g<=H[0].e.r;++g)for(p=H[0].s.c;p<=H[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[_t({c:p,r:g})],d&&(d.l=H[1]);break;case 2048:for(g=H[0].s.r;g<=H[0].e.r;++g)for(p=H[0].s.c;p<=H[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[_t({c:p,r:g})],d&&d.l&&(d.l.Tooltip=H[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;d=t.dense?(i[H[0].r]||[])[H[0].c]:i[_t(H[0])];var ue=Z[H[2]];d||(t.dense?(i[H[0].r]||(i[H[0].r]=[]),d=i[H[0].r][H[0].c]={t:"z"}):d=i[_t(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),d.c||(d.c=[]),v={a:H[1],t:ue.TxO.t},d.c.push(v)}break;case 2173:skt(x[H.ixfe],H.ext);break;case 125:{if(!N.cellStyles)break;for(;H.e>=H.s;)ie[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},k||(k=!0,e4(H.w/256)),mg(ie[H.e+1])}break;case 520:{var ce={};H.level!=null&&(me[H.r]=ce,ce.level=H.level),H.hidden&&(me[H.r]=ce,ce.hidden=!0),H.hpt&&(me[H.r]=ce,ce.hpt=H.hpt,ce.hpx=_w(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||zm(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=H;break;case 161:i["!margins"]||zm(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(E.Views[0].RTL=!0);break;case 146:T=H;break;case 2198:B=H;break;case 140:_=H;break;case 442:u?P.CodeName=H||P.name:E.WBProps.CodeName=H||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=re}return r.SheetNames=Jo(a).sort(function(ve,de){return Number(ve)-Number(de)}).map(function(ve){return a[ve].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&I.forEach(function(ve,de){r.Sheets[r.SheetNames[de]]["!autofilter"]=ve}),r.Strings=l,r.SSF=Dn(Et),N.enc&&(r.Encryption=N.enc),B&&(r.Themes=B),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),w.names.length>0&&(E.Names=w.names),r.Workbook=E,r}var Fq={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function BIt(e,t,r){var n=Kt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=_q(n,nOt,Fq.DSI);for(var a in i)t[a]=i[a]}catch(u){if(r.WTF)throw u}var o=Kt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=_q(o,iOt,Fq.SI);for(var l in s)t[l]==null&&(t[l]=s[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(dfe(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function qfe(e,t){t||(t={}),a4(t),xue(),t.codepage&&L3(t.codepage);var r,n;if(e.FullPaths){if(Kt.find(e,"/encryption"))throw new Error("File is password-protected");r=Kt.find(e,"!CompObj"),n=Kt.find(e,"/Workbook")||Kt.find(e,"/Book")}else{switch(t.type){case"base64":e=io(ia(e));break;case"binary":e=io(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}In(e,0),n={content:e}}var i,a;if(r&&NIt(r),t.bookProps&&!t.bookSheets)i={};else{var o=zt?"buffer":"array";if(n&&n.content)i=HIt(n.content,t);else if((a=Kt.find(e,"PerfectOffice_MAIN"))&&a.content)i=Wm.to_workbook(a.content,(t.type=o,t));else if((a=Kt.find(e,"NativeContent_MAIN"))&&a.content)i=Wm.to_workbook(a.content,(t.type=o,t));else throw(a=Kt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Kt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=Tkt(e))}var s={};return e.FullPaths&&BIt(e,s,t),i.Props=i.Custprops=s,t.bookFiles&&(i.cfb=e),i}var GT={0:{f:_Pt},1:{f:TPt},2:{f:DPt},3:{f:kPt},4:{f:EPt},5:{f:MPt},6:{f:LPt},7:{f:PPt},8:{f:jPt},9:{f:VPt},10:{f:HPt},11:{f:BPt},12:{f:OPt},13:{f:$Pt},14:{f:APt},15:{f:RPt},16:{f:zfe},17:{f:FPt},18:{f:IPt},19:{f:K3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pIt},40:{},42:{},43:{f:HRt},44:{f:FRt},45:{f:BRt},46:{f:jRt},47:{f:VRt},48:{},49:{f:WTt},50:{},51:{f:ukt},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Tfe},62:{f:NPt},63:{f:vkt},64:{f:ZPt},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:qPt},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xPt},148:{f:SPt,p:16},151:{f:zPt},152:{},153:{f:dIt},154:{},155:{},156:{f:hIt},157:{},158:{},159:{T:1,f:iRt},160:{T:-1},161:{T:1,f:yh},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:WPt},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lkt},336:{T:-1},337:{f:fkt,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cN},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xfe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:GPt},427:{f:YPt},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:XPt},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CPt},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:UPt},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cN},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Skt},633:{T:1},634:{T:-1},635:{T:1,f:_kt},636:{T:-1},637:{f:zTt},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:nIt},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:JPt},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},gN={6:{f:UP},10:{f:Ul},12:{f:hn},13:{f:hn},14:{f:Zr},15:{f:Zr},16:{f:Wn},17:{f:Zr},18:{f:Zr},19:{f:hn},20:{f:Tq},21:{f:Tq},23:{f:xfe},24:{f:Eq},25:{f:Zr},26:{},27:{},28:{f:bEt},29:{},34:{f:Zr},35:{f:Oq},38:{f:Wn},39:{f:Wn},40:{f:Wn},41:{f:Wn},42:{f:Zr},43:{f:Zr},47:{f:CRt},49:{f:eEt},51:{f:hn},60:{},61:{f:ZOt},64:{f:Zr},65:{f:QOt},66:{f:hn},77:{},80:{},81:{},82:{},85:{f:hn},89:{},90:{},91:{},92:{f:WOt},93:{f:_Et},94:{},95:{f:Zr},96:{},97:{},99:{f:Zr},125:{f:Tfe},128:{f:fEt},129:{f:UOt},130:{f:hn},131:{f:Zr},132:{f:Zr},133:{f:zOt},134:{},140:{f:EEt},141:{f:hn},144:{},146:{f:kEt},151:{},152:{},153:{},154:{},155:{},156:{f:hn},157:{},158:{},160:{f:DEt},161:{f:PEt},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:oEt},190:{f:sEt},193:{f:Ul},197:{},198:{},199:{},200:{},201:{},202:{f:Zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hn},220:{},221:{f:Zr},222:{},224:{f:uEt},225:{f:jOt},226:{f:Ul},227:{},229:{f:wEt},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:GOt},253:{f:tEt},255:{f:YOt},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:mfe},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zr},353:{f:Ul},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:hEt},431:{f:Zr},432:{},433:{},434:{},437:{},438:{f:xEt},439:{f:Zr},440:{f:TEt},441:{},442:{f:R_},443:{},444:{f:hn},445:{},446:{},448:{f:Ul},449:{f:qOt,r:2},450:{f:Ul},512:{f:Cq},513:{f:MEt},515:{f:cEt},516:{f:rEt},517:{f:xq},519:{f:$Et},520:{f:KOt},523:{},545:{f:Rq},549:{f:Sq},566:{},574:{f:JOt},638:{f:aEt},659:{},1048:{},1054:{f:nEt},1084:{},1212:{f:gEt},2048:{f:OEt},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:I1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ul},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AEt,r:12},2173:{f:okt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:pEt,r:12},2197:{},2198:{f:ekt,r:12},2199:{},2200:{},2201:{},2202:{f:yEt,r:12},2203:{f:Ul},2204:{},2205:{},2206:{},2207:{},2211:{f:XOt},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IEt},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:REt},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Cq},1:{},2:{f:HEt},3:{f:FEt},4:{f:LEt},5:{f:xq},7:{f:BEt},8:{},9:{f:I1},11:{},22:{f:hn},30:{f:iEt},31:{},32:{},33:{f:Rq},36:{},37:{f:Sq},50:{f:VEt},62:{},52:{},67:{},68:{f:hn},69:{},86:{},126:{},127:{f:NEt},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:jEt},223:{},234:{},354:{},421:{},518:{f:UP},521:{f:I1},536:{f:Eq},547:{f:Oq},561:{},579:{},1030:{f:UP},1033:{f:I1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ya(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&afe(r)&&e.push(r)}}function Hq(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,s=a&&a.index||e.length,l=hTt(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,c=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<l.length;++o){var p=l[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var y=p.split(/<\/t[dh]>/i);for(s=0;s<y.length;++s){var m=y[s].trim();if(m.match(/<t[dh]/i)){for(var b=m,_=0;b.charAt(0)=="<"&&(_=b.indexOf(">"))>-1;)b=b.slice(_+1);for(var x=0;x<v.length;++x){var T=v[x];T.s.c==f&&T.s.r<u&&u<=T.e.r&&(f=T.e.c+1,x=-1)}var E=yt(m.slice(0,m.indexOf(">")));h=E.colspan?+E.colspan:1,((c=+E.rowspan)>1||h>1)&&v.push({s:{r:u,c:f},e:{r:u+(c||1)-1,c:f+h-1}});var P=E.t||E["data-t"]||"";if(!b.length){f+=h;continue}if(b=Gue(b),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!b.length){f+=h;continue}var R={t:"s",v:b};r.raw||!b.trim().length||P=="s"||(b==="TRUE"?R={t:"b",v:!0}:b==="FALSE"?R={t:"b",v:!1}:isNaN(fo(b))?isNaN(yg(b).getDate())||(R={t:"d",v:Rn(b)},r.cellDates||(R={t:"n",v:wi(R.v)}),R.z=r.dateNF||Et[14]):R={t:"n",v:fo(b)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=R):n[_t({r:u,c:f})]=R,f+=h}}}}return n["!ref"]=qt(d),v.length&&(n["!merges"]=v),n}function VIt(e,t,r,n){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){s=-1;break}s=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(s<0)){var f=_t({r,c:o}),c=n.dense?(e[r]||[])[o]:e[f],h=c&&c.v!=null&&(c.h||W3(c.w||(yl(c),c.w)||""))||"",d={};s>1&&(d.rowspan=s),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":c&&(d["data-t"]=c&&c.t||"z",c.v!=null&&(d["data-v"]=c.v),c.z!=null&&(d["data-z"]=c.z),c.l&&(c.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+c.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+f,a.push(ETt("td",h,d))}}var v="<tr>";return v+a.join("")+"</tr>"}var jIt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',WIt="</body></html>";function UIt(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Yu(Hq(r[0],t),t);var n=s4();return r.forEach(function(i,a){l4(n,Hq(i,t),"Sheet"+(a+1))}),n}function zIt(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function GIt(e,t){var r=t||{},n=r.header!=null?r.header:jIt,i=r.footer!=null?r.footer:WIt,a=[n],o=Bg(e["!ref"]);r.dense=Array.isArray(e),a.push(zIt(e,o,r));for(var s=o.s.r;s<=o.e.r;++s)a.push(VIt(e,o,s,r));return a.push("</table>"+i),a.join("")}function Zfe(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?pi(n.origin):n.origin;i=o.r,a=o.c}var s=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),u={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var f=Bg(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var c=[],h=0,d=e["!rows"]||(e["!rows"]=[]),v=0,p=0,g=0,y=0,m=0,b=0;for(e["!cols"]||(e["!cols"]=[]);v<s.length&&p<l;++v){var _=s[v];if(Bq(_)){if(n.display)continue;d[p]={hidden:!0}}var x=_.children;for(g=y=0;g<x.length;++g){var T=x[g];if(!(n.display&&Bq(T))){var E=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):Gue(T.innerHTML),P=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<c.length;++h){var R=c[h];R.s.c==y+a&&R.s.r<p+i&&p+i<=R.e.r&&(y=R.e.c+1-a,h=-1)}b=+T.getAttribute("colspan")||1,((m=+T.getAttribute("rowspan")||1)>1||b>1)&&c.push({s:{r:p+i,c:y+a},e:{r:p+i+(m||1)-1,c:y+a+(b||1)-1}});var M={t:"s",v:E},D=T.getAttribute("data-t")||T.getAttribute("t")||"";E!=null&&(E.length==0?M.t=D||"z":n.raw||E.trim().length==0||D=="s"||(E==="TRUE"?M={t:"b",v:!0}:E==="FALSE"?M={t:"b",v:!1}:isNaN(fo(E))?isNaN(yg(E).getDate())||(M={t:"d",v:Rn(E)},n.cellDates||(M={t:"n",v:wi(M.v)}),M.z=n.dateNF||Et[14]):M={t:"n",v:fo(E)})),M.z===void 0&&P!=null&&(M.z=P);var N="",B=T.getElementsByTagName("A");if(B&&B.length)for(var K=0;K<B.length&&!(B[K].hasAttribute("href")&&(N=B[K].getAttribute("href"),N.charAt(0)!="#"));++K);N&&N.charAt(0)!="#"&&(M.l={Target:N}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][y+a]=M):e[_t({c:y+a,r:p+i})]=M,u.e.c<y+a&&(u.e.c=y+a),y+=b}}++p}return c.length&&(e["!merges"]=(e["!merges"]||[]).concat(c)),u.e.r=Math.max(u.e.r,p-1+i),e["!ref"]=qt(u),p>=l&&(e["!fullref"]=qt((u.e.r=s.length-v+p-1+i,u))),e}function Jfe(e,t){var r=t||{},n=r.dense?[]:{};return Zfe(n,e,t)}function YIt(e,t){return Yu(Jfe(e,t),t)}function Bq(e){var t="",r=KIt(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function KIt(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function XIt(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=er(t.replace(/<[^>]*>/g,""));return[r]}var Vq={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Qfe(e,t){var r=t||{},n=U3(e),i=[],a,o,s={name:""},l="",u=0,f,c,h={},d=[],v=r.dense?[]:{},p,g,y={value:""},m="",b=0,_=[],x=-1,T=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,R={},M=[],D={},N=0,B=0,K=[],Z=1,ie=1,me=[],k={Names:[]},w={},C=["",""],O=[],S={},A="",I=0,L=!1,V=!1,Y=0;for(mw.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=mw.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?v["!ref"]=qt(E):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(v["!fullref"]=v["!ref"],E.e.r=r.sheetRows-1,v["!ref"]=qt(E)),M.length&&(v["!merges"]=M),K.length&&(v["!rows"]=K),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),h[f.name]=v,V=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=yt(p[0],!1),x=T=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,v=r.dense?[]:{},M=[],K=[],V=!0);break;case"table-row-group":p[1]==="/"?--P:++P;break;case"table-row":case"行":if(p[1]==="/"){x+=Z,Z=1;break}if(c=yt(p[0],!1),c.行号?x=c.行号-1:x==-1&&(x=0),Z=+c["number-rows-repeated"]||1,Z<10)for(Y=0;Y<Z;++Y)P>0&&(K[x+Y]={level:P});T=-1;break;case"covered-table-cell":p[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(v[x]||(v[x]=[]),v[x][T]={t:"z"}):v[_t({r:x,c:T})]={t:"z"}),m="",_=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++T,y=yt(p[0],!1),ie=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=$q(er(y.formula))),(y.数据类型||y["value-type"])=="string"&&(g.t="s",g.v=er(y["string-value"]||""),r.dense?(v[x]||(v[x]=[]),v[x][T]=g):v[_t({r:x,c:T})]=g),T+=ie-1;else if(p[1]!=="/"){++T,m="",b=0,_=[],ie=1;var ae=Z?x+Z-1:x;if(T>E.e.c&&(E.e.c=T),T<E.s.c&&(E.s.c=T),x<E.s.r&&(E.s.r=x),ae>E.e.r&&(E.e.r=ae),y=yt(p[0],!1),O=[],S={},g={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=er(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(N=parseInt(y["number-matrix-rows-spanned"],10)||0,B=parseInt(y["number-matrix-columns-spanned"],10)||0,D={s:{r:x,c:T},e:{r:x+N-1,c:T+B-1}},g.F=qt(D),me.push([D,g.F])),y.formula)g.f=$q(y.formula);else for(Y=0;Y<me.length;++Y)x>=me[Y][0].s.r&&x<=me[Y][0].e.r&&T>=me[Y][0].s.c&&T<=me[Y][0].e.c&&(g.F=me[Y][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(N=parseInt(y["number-rows-spanned"],10)||0,B=parseInt(y["number-columns-spanned"],10)||0,D={s:{r:x,c:T},e:{r:x+N-1,c:T+B-1}},M.push(D)),y["number-columns-repeated"]&&(ie=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Ir(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=Rn(y["date-value"]),r.cellDates||(g.t="n",g.v=wi(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=uTt(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=LE(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(m=er(y["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(L=!1,g.t==="s"&&(g.v=m||"",_.length&&(g.R=_),L=b==0),w.Target&&(g.l=w),O.length>0&&(g.c=O,O=[]),m&&r.cellText!==!1&&(g.w=m),L&&(g.t="z",delete g.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=x))for(var re=0;re<Z;++re){if(ie=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(v[x+re]||(v[x+re]=[]),v[x+re][T]=re==0?g:Dn(g);--ie>0;)v[x+re][T+ie]=Dn(g);else for(v[_t({r:x+re,c:T})]=g;--ie>0;)v[_t({r:x+re,c:T+ie})]=Dn(g);E.e.c<=T&&(E.e.c=T)}ie=parseInt(y["number-columns-repeated"]||"1",10),T+=ie-1,ie=0,g={},m="",_=[]}w={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a;S.t=m,_.length&&(S.R=_),S.a=A,O.push(S)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);A="",I=0,m="",b=0,_=[];break;case"creator":p[1]==="/"?A=n.slice(I,p.index):I=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);m="",b=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(R[s.name]=l,(a=i.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(l="",s=yt(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=yt(p[0],!1),l+=Vq[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=yt(p[0],!1),l+=Vq[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=yt(p[0],!1),C=zP(o["cell-range-address"]);var te={Name:o.name,Ref:C[0]+"!"+C[1]};V&&(te.Sheet=d.length),k.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var ge=XIt(n.slice(b,p.index));m=(m.length>0?m+`
`:"")+ge[0]}else yt(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{C=zP(yt(p[0])["target-range-address"]),h[C[0]]["!autofilter"]={ref:C[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(w=yt(p[0],!1),!w.href)break;w.Target=er(w.href),delete w.href,w.Target.charAt(0)=="#"&&w.Target.indexOf(".")>-1?(C=zP(w.Target.slice(1)),w.Target="#"+C[0]+"!"+C[1]):w.Target.match(/^\.\.[\\\/]/)&&(w.Target=w.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var H={Sheets:h,SheetNames:d,Workbook:k};return r.bookSheets&&delete H.Sheets,H}function jq(e,t){t=t||{},ya(e,"META-INF/manifest.xml")&&cOt(cn(e,"META-INF/manifest.xml"),t);var r=Zi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Qfe(Cr(r),t);return ya(e,"meta.xml")&&(n.Props=hfe(cn(e,"meta.xml"))),n}function Wq(e,t){return Qfe(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function n4(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yN(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Cr(ph(e))}function mN(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Uq(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function qIt(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Sw(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Cn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Sw(e,r),a=i&7;i=Math.floor(i/8);var o=0,s;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);s=e.slice(l,r[0])}break;case 5:o=4,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Sw(e,r),s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var u={data:s,type:a};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function i4(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ZIt(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Sw(e,n),a=zn(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Cn(a[1][0].data),messages:[]};a[2].forEach(function(s){var l=zn(s.data),u=Cn(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(o.merge=Cn(a[3][0].data)>>>0>0),r.push(o)}return r}function JIt(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Sw(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var s=o-59;o=t[r[0]],s>1&&(o|=t[r[0]+1]<<8),s>2&&(o|=t[r[0]+2]<<16),s>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=s}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[mN(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=mN(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function QIt(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(JIt(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return mN(t)}function eMt(e,t,r,n){var i=n4(e),a=i.getUint32(4,!0),o=(n>1?12:8)+Uq(a&(n>1?3470:398))*4,s=-1,l=-1,u=NaN,f=new Date(2001,0,1);a&512&&(s=i.getUint32(o,!0),o+=4),o+=Uq(a&(n>1?12288:4096))*4,a&16&&(l=i.getUint32(o,!0),o+=4),a&32&&(u=i.getFloat64(o,!0),o+=8),a&64&&(f.setTime(f.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var c;switch(e[2]){case 0:break;case 2:c={t:"n",v:u};break;case 3:c={t:"s",v:t[l]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(s>-1)c={t:"s",v:r[s]};else if(l>-1)c={t:"s",v:t[l]};else if(!isNaN(u))c={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return c}function tMt(e,t,r){var n=n4(e),i=n.getUint32(8,!0),a=12,o=-1,s=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=qIt(e,a),a+=16),i&2&&(u=n.getFloat64(a,!0),a+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(s=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var c;switch(e[1]){case 0:break;case 2:c={t:"n",v:l};break;case 3:c={t:"s",v:t[s]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(o>-1)c={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:c={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return c}function rMt(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return eMt(e,t,r,e[0]);case 5:return tMt(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ru(e){var t=zn(e);return Sw(t[1][0].data)}function zq(e,t){var r=zn(t.data),n=Cn(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var s=zn(o.data),l=Cn(s[1][0].data)>>>0;switch(n){case 1:a[l]=yN(s[3][0].data);break;case 8:{var u=e[Ru(s[9][0].data)][0],f=zn(u.data),c=e[Ru(f[1][0].data)][0],h=Cn(c.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=zn(c.data);a[l]=d[3].map(function(v){return yN(v.data)}).join("")}break}}),a}function nMt(e,t){var r,n,i,a,o,s,l,u,f,c,h,d,v,p,g=zn(e),y=Cn(g[1][0].data)>>>0,m=Cn(g[2][0].data)>>>0,b=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Cn(g[8][0].data)>0||!1,_,x;if((a=(i=g[7])==null?void 0:i[0])!=null&&a.data&&t!=0)_=(s=(o=g[7])==null?void 0:o[0])==null?void 0:s.data,x=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((c=(f=g[4])==null?void 0:f[0])!=null&&c.data&&t!=1)_=(d=(h=g[4])==null?void 0:h[0])==null?void 0:d.data,x=(p=(v=g[3])==null?void 0:v[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=b?4:1,E=n4(_),P=[],R=0;R<_.length/2;++R){var M=E.getUint16(R*2,!0);M<65535&&P.push([R,M])}if(P.length!=m)throw"Expected ".concat(m," cells, found ").concat(P.length);var D=[];for(R=0;R<P.length-1;++R)D[P[R][0]]=x.subarray(P[R][1]*T,P[R+1][1]*T);return P.length>=1&&(D[P[P.length-1][0]]=x.subarray(P[P.length-1][1]*T)),{R:y,cells:D}}function iMt(e,t){var r,n=zn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Cn(n[7][0].data)>>>0>0?1:0:-1,a=i4(n[5],function(o){return nMt(o,i)});return{nrows:Cn(n[4][0].data)>>>0,data:a.reduce(function(o,s){return o[s.R]||(o[s.R]=[]),s.cells.forEach(function(l,u){if(o[s.R][u])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(u));o[s.R][u]=l}),o},[])}}function aMt(e,t,r){var n,i=zn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Cn(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Cn(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=qt(a);var o=zn(i[4][0].data),s=zq(e,e[Ru(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?zq(e,e[Ru(o[17][0].data)][0]):[],u=zn(o[3][0].data),f=0;u[1].forEach(function(c){var h=zn(c.data),d=e[Ru(h[2][0].data)][0],v=Cn(d.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var p=iMt(e,d);p.data.forEach(function(g,y){g.forEach(function(m,b){var _=_t({r:f+y,c:b}),x=rMt(m,s,l);x&&(r[_]=x)})}),f+=p.nrows})}function oMt(e,t){var r=zn(t.data),n={"!ref":"A1"},i=e[Ru(r[2][0].data)],a=Cn(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return aMt(e,i[0],n),n}function sMt(e,t){var r,n=zn(t.data),i={name:(r=n[1])!=null&&r[0]?yN(n[1][0].data):"",sheets:[]},a=i4(n[2],Ru);return a.forEach(function(o){e[o].forEach(function(s){var l=Cn(s.meta[1][0].data);l==6e3&&i.sheets.push(oMt(e,s))})}),i}function lMt(e,t){var r=s4(),n=zn(t.data),i=i4(n[1],Ru);if(i.forEach(function(a){e[a].forEach(function(o){var s=Cn(o.meta[1][0].data);if(s==2){var l=sMt(e,o);l.sheets.forEach(function(u,f){l4(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function YP(e){var t,r,n,i,a={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=QIt(l.content)}catch(c){return console.log("?? "+l.content.length+" "+(c.message||c))}var f;try{f=ZIt(u)}catch(c){return console.log("## "+(c.message||c))}f.forEach(function(c){a[c.id]=c.messages,o.push(c.id)})}}),!o.length)throw new Error("File has no messages");var s=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Cn(a[1][0].meta[1][0].data)==1&&a[1][0];if(s||o.forEach(function(l){a[l].forEach(function(u){var f=Cn(u.meta[1][0].data)>>>0;if(f==1)if(!s)s=u;else throw new Error("Document has multiple roots")})}),!s)throw new Error("Cannot find Document root");return lMt(a,s)}function uMt(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function a4(e){uMt([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fMt(e){return Ad.WS.indexOf(e)>-1?"sheet":e==Ad.CS?"chart":e==Ad.DS?"dialog":e==Ad.MS?"macro":e&&e.length?e:"sheet"}function cMt(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,fMt(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function hMt(e,t,r,n,i,a,o,s,l,u,f,c){try{a[n]=Vm(Zi(e,r,!0),t);var h=cn(e,t),d;switch(s){case"sheet":d=mIt(h,t,i,l,a[n],u,f,c);break;case"chart":if(d=bIt(h,t,i,l,a[n],u,f,c),!d||!d["!drawel"])break;var v=am(d["!drawel"].Target,t),p=hN(v),g=ykt(Zi(e,v,!0),Vm(Zi(e,p,!0),v)),y=am(g,v),m=hN(y);d=tIt(Zi(e,y,!0),y,l,Vm(Zi(e,m,!0),y),u,d);break;case"macro":d=wIt(h,t,i,l,a[n],u,f,c);break;case"dialog":d=_It(h,t,i,l,a[n],u,f,c);break;default:throw new Error("Unrecognized sheet type "+s)}o[n]=d;var b=[];a&&a[n]&&Jo(a[n]).forEach(function(_){var x="";if(a[n][_].Type==Ad.CMNT){x=am(a[n][_].Target,t);var T=TIt(cn(e,x,!0),x,l);if(!T||!T.length)return;Aq(d,T,!1)}a[n][_].Type==Ad.TCMNT&&(x=am(a[n][_].Target,t),b=b.concat(bkt(cn(e,x,!0),l)))}),b&&b.length&&Aq(d,b,!0,l.people||[])}catch(_){if(l.WTF)throw _}}function ha(e){return e.charAt(0)=="/"?e.slice(1):e}function dMt(e,t){if(Nue(),t=t||{},a4(t),ya(e,"META-INF/manifest.xml")||ya(e,"objectdata.xml"))return jq(e,t);if(ya(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof YP<"u"){if(e.FileIndex)return YP(e);var r=Kt.utils.cfb_new();return nq(e).forEach(function(K){vTt(r,K,jue(e,K))}),YP(r)}throw new Error("Unsupported NUMBERS file")}if(!ya(e,"[Content_Types].xml"))throw ya(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ya(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=nq(e),i=uOt(Zi(e,"[Content_Types].xml")),a=!1,o,s;if(i.workbooks.length===0&&(s="xl/workbook.xml",cn(e,s,!0)&&i.workbooks.push(s)),i.workbooks.length===0){if(s="xl/workbook.bin",!cn(e,s,!0))throw new Error("Could not find workbook");i.workbooks.push(s),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Um=[],i.sst)try{Um=xIt(cn(e,ha(i.sst)),i.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&i.themes.length&&(l=CIt(Zi(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=SIt(cn(e,ha(i.style)),i.style,l,t))}i.links.map(function(K){try{var Z=Vm(Zi(e,hN(ha(K))),K);return EIt(cn(e,ha(K)),Z,K,t)}catch{}});var f=yIt(cn(e,ha(i.workbooks[0])),i.workbooks[0],t),c={},h="";i.coreprops.length&&(h=cn(e,ha(i.coreprops[0]),!0),h&&(c=hfe(h)),i.extprops.length!==0&&(h=cn(e,ha(i.extprops[0]),!0),h&&vOt(h,c,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Zi(e,ha(i.custprops[0]),!0),h&&(d=gOt(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?o=f.Sheets.map(function(Z){return Z.name}):c.Worksheets&&c.SheetNames.length>0&&(o=c.SheetNames),t.bookProps&&(v.Props=c,v.Custprops=d),t.bookSheets&&typeof o<"u"&&(v.SheetNames=o),t.bookSheets?v.SheetNames:t.bookProps))return v;o={};var p={};t.bookDeps&&i.calcchain&&(p=OIt(cn(e,ha(i.calcchain)),i.calcchain));var g=0,y={},m,b;{var _=f.Sheets;c.Worksheets=_.length,c.SheetNames=[];for(var x=0;x!=_.length;++x)c.SheetNames[x]=_[x].name}var T=a?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");ya(e,P)||(P="xl/_rels/workbook."+T+".rels");var R=Vm(Zi(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=RIt(cn(e,ha(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=wkt(cn(e,ha(i.people[0])),t)),R&&(R=cMt(R,f.Sheets));var M=cn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=c.Worksheets;++g){var D="sheet";if(R&&R[g]?(m="xl/"+R[g][1].replace(/[\/]?xl\//,""),ya(e,m)||(m=R[g][1]),ya(e,m)||(m=P.replace(/_rels\/.*$/,"")+R[g][1]),D=R[g][2]):(m="xl/worksheets/sheet"+(g+1-M)+"."+T,m=m.replace(/sheet0\./,"sheet.")),b=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(c.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var N=!1,B=0;B!=t.sheets.length;++B)typeof t.sheets[B]=="number"&&t.sheets[B]==g&&(N=1),typeof t.sheets[B]=="string"&&t.sheets[B].toLowerCase()==c.SheetNames[g].toLowerCase()&&(N=1);if(!N)continue e}}hMt(e,m,b,c.SheetNames[g],g,y,o,D,t,f,l,u)}return v={Directory:i,Workbook:f,Props:c,Custprops:d,Deps:p,Sheets:o,SheetNames:c.SheetNames,Strings:Um,Styles:u,Themes:l,SSF:Dn(Et)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(K,Z){K=K.replace(/^Root Entry[\/]/,""),v.keys.push(K),v.files[K]=e.FileIndex[Z]}))),t&&t.bookVBA&&(i.vba.length>0?v.vbaraw=cn(e,ha(i.vba[0]),!0):i.defaults&&i.defaults.bin===xkt&&(v.vbaraw=cn(e,"xl/vbaProject.bin",!0))),v}function vMt(e,t){var r=t||{},n="Workbook",i=Kt.find(e,n);try{if(n="/!DataSpaces/Version",i=Kt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(oRt(i.content),n="/!DataSpaces/DataSpaceMap",i=Kt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=lRt(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Kt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=uRt(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Kt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);cRt(i.content)}catch{}if(n="/EncryptionInfo",i=Kt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=hRt(i.content);if(n="/EncryptedPackage",i=Kt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(s[1],i.content,r.password||"",r);if(s[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(s[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function o4(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ia(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function pMt(e,t){return Kt.find(e,"EncryptedPackage")?vMt(e,t):qfe(e,t)}function gMt(e,t){var r,n=e,i=t||{};return i.type||(i.type=zt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Wue(n,i),dMt(r,i)}function ece(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return pN(e.slice(r),t);default:break e}return bw.to_workbook(e,t)}function yMt(e,t){var r="",n=o4(e,t);switch(t.type){case"base64":r=ia(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Kc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Cr(r)),t.type="binary",ece(r,t)}function mMt(e,t){var r=e;return t.type=="base64"&&(r=ia(r)),r=Jl.utils.decode(1200,r.slice(2),"str"),t.type="binary",ece(r,t)}function bMt(e){return e.match(/[^\x00-\x7F]/)?om(e):e}function KP(e,t,r,n){return n?(r.type="string",bw.to_workbook(e,r)):bw.to_workbook(t,r)}function bN(e,t){xue();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return bN(new Uint8Array(e),(r=Dn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),tv={},r.dateNF&&(tv.dateNF=r.dateNF),r.type||(r.type=zt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=zt?"buffer":"binary",n=sTt(e),typeof Uint8Array<"u"&&!zt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=bMt(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return r=Dn(r),r.type="array",bN(F3(n),r)}switch((i=o4(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return pMt(Kt.read(n,r),r);break;case 9:if(i[1]<=8)return qfe(n,r);break;case 60:return pN(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return YEt(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return zEt.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?gMt(n,r):KP(e,n,r,a);case 239:return i[3]===60?pN(n,r):KP(e,n,r,a);case 255:if(i[1]===254)return mMt(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Wm.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Wm.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return kq.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return xRt.to_workbook(n,r);break;case 10:case 13:case 32:return yMt(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return WEt.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?kq.to_workbook(n,r):KP(e,n,r,a)}function wMt(e,t,r,n,i,a,o,s){var l=$n(r),u=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),c=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=o?e[r][d]:e[n[d]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;a[d]!=null&&(h[a[d]]=u);continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[d]!=null){if(p==null)if(v.t=="e"&&p===null)h[a[d]]=null;else if(u!==void 0)h[a[d]]=u;else if(f&&p===null)h[a[d]]=null;else continue;else h[a[d]]=f&&(v.t!=="n"||v.t==="n"&&s.rawNumbers!==!1)?p:yl(v,p,s);p!=null&&(c=!1)}}return{row:h,isempty:c}}function wN(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Yr(f);break;case"number":l=Yr(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var c=$n(l.s.r),h=[],d=[],v=0,p=0,g=Array.isArray(e),y=l.s.r,m=0,b={};g&&!e[y]&&(e[y]=[]);var _=u.skipHidden&&e["!cols"]||[],x=u.skipHidden&&e["!rows"]||[];for(m=l.s.c;m<=l.e.c;++m)if(!(_[m]||{}).hidden)switch(h[m]=wn(m),r=g?e[y][m]:e[h[m]+c],n){case 1:a[m]=m-l.s.c;break;case 2:a[m]=h[m];break;case 3:a[m]=u.header[m-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),s=o=yl(r,null,u),p=b[o]||0,!p)b[o]=1;else{do s=o+"_"+p++;while(b[s]);b[o]=p,b[s]=1}a[m]=s}for(y=l.s.r+i;y<=l.e.r;++y)if(!(x[y]||{}).hidden){var T=wMt(e,l,y,h,n,a,g,u);(T.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[v++]=T.row)}return d.length=v,d}var Gq=/"/g;function _Mt(e,t,r,n,i,a,o,s){for(var l=!0,u=[],f="",c=$n(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=s.dense?(e[r]||[])[h]:e[n[h]+c];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(s.rawNumbers&&d.t=="n"?d.v:yl(d,null,s));for(var v=0,p=0;v!==f.length;++v)if((p=f.charCodeAt(v))===i||p===a||p===34||s.forceQuotes){f='"'+f.replace(Gq,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(Gq,'""')+'"')):f="";u.push(f)}return s.blankrows===!1&&l?null:u.join(o)}function tce(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Yr(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),s=n.RS!==void 0?n.RS:`
`,l=s.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",c=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(h[v]||{}).hidden||(c[v]=wn(v));for(var p=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(f=_Mt(e,i,g,c,o,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((p++?s:"")+f)));return delete n.dense,r.join("")}function SMt(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=tce(e,t);return r}function CMt(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Yr(e["!ref"]),a="",o=[],s,l=[],u=Array.isArray(e);for(s=i.s.c;s<=i.e.c;++s)o[s]=wn(s);for(var f=i.s.r;f<=i.e.r;++f)for(a=$n(f),s=i.s.c;s<=i.e.c;++s)if(t=o[s]+a,r=u?(e[f]||[])[s]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function rce(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},o=0,s=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?pi(n.origin):n.origin;o=l.r,s=l.c}var u,f={s:{c:0,r:0},e:{c:s,r:o+t.length-1+i}};if(a["!ref"]){var c=Yr(a["!ref"]);f.e.c=Math.max(f.e.c,c.e.c),f.e.r=Math.max(f.e.r,c.e.r),o==-1&&(o=c.e.r+1,f.e.r=o+t.length-1+i)}else o==-1&&(o=0,f.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(p,g){Jo(p).forEach(function(y){(d=h.indexOf(y))==-1&&(h[d=h.length]=y);var m=p[y],b="z",_="",x=_t({c:s+d,r:o+g+i});u=Cw(a,x),m&&typeof m=="object"&&!(m instanceof Date)?a[x]=m:(typeof m=="number"?b="n":typeof m=="boolean"?b="b":typeof m=="string"?b="s":m instanceof Date?(b="d",n.cellDates||(b="n",m=wi(m)),_=n.dateNF||Et[14]):m===null&&n.nullError&&(b="e",m=0),u?(u.t=b,u.v=m,delete u.w,delete u.R,_&&(u.z=_)):a[x]=u={t:b,v:m},_&&(u.z=_))})}),f.e.c=Math.max(f.e.c,s+h.length-1);var v=$n(o);if(i)for(d=0;d<h.length;++d)a[wn(d+s)+v]={t:"s",v:h[d]};return a["!ref"]=qt(f),a}function xMt(e,t){return rce(null,e,t)}function Cw(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=pi(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Cw(e,_t(t)):Cw(e,_t({r:t,c:r||0}))}function TMt(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function s4(){return{SheetNames:[],Sheets:{}}}function l4(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(uIt(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function OMt(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=TMt(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function EMt(e,t){return e.z=t,e}function nce(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function RMt(e,t,r){return nce(e,"#"+t,r)}function kMt(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function AMt(e,t,r,n){for(var i=typeof t!="string"?t:Yr(t),a=typeof t=="string"?t:qt(t),o=i.s.r;o<=i.e.r;++o)for(var s=i.s.c;s<=i.e.c;++s){var l=Cw(e,o,s);l.t="n",l.F=a,delete l.v,o==i.s.r&&s==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Yq={encode_col:wn,encode_row:$n,encode_cell:_t,encode_range:qt,decode_col:Y3,decode_row:G3,split_cell:jTt,decode_cell:pi,decode_range:Bg,format_cell:yl,sheet_add_aoa:sfe,sheet_add_json:rce,sheet_add_dom:Zfe,aoa_to_sheet:Vg,json_to_sheet:xMt,table_to_sheet:Jfe,table_to_book:YIt,sheet_to_csv:tce,sheet_to_txt:SMt,sheet_to_json:wN,sheet_to_html:GIt,sheet_to_formulae:CMt,sheet_to_row_object_array:wN,sheet_get_cell:Cw,book_new:s4,book_append_sheet:l4,book_set_sheet_visibility:OMt,cell_set_number_format:EMt,cell_set_hyperlink:nce,cell_set_internal_link:RMt,cell_add_comment:kMt,sheet_set_array_formula:AMt,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const PMt={class:"table-wrapper"},IMt={class:"toolbar"},MMt={class:"left"},DMt={class:"table-box"},$Mt=_i({__name:"dataTable",setup(e){Sue();const t=Mn(null),r=eo(()=>{var l;return((l=n==null?void 0:n.value.config)==null?void 0:l.data)||null}),n=ml(Qo);bd(()=>r.value,()=>{t.value.hotInstance.updateData(Ji.cloneDeep(r.value))},{deep:!0});const i=()=>{VC(()=>{const u=t.value.hotInstance.getSourceData().map(c=>c.filter(h=>h!==null)).filter(c=>c.length);console.log(JSON.stringify(u));const f=Ji.isEqual(u,r.value);if(r.value&&!f&&u.length){const c=Ji.cloneDeep(n==null?void 0:n.value);c.config.data=u,Ta.emit("updateChart",c)}})},a=l=>{try{const u=new FileReader;u.onload=f=>{const c=f.target.result,h=bN(c,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],v=Yq.decode_range(d["!ref"]);var p=[];for(let g=v.s.r;g<=v.e.r;g++){let y=p.length;p.push([]);for(let m=v.s.c;m<=v.e.c;m++){let b=d[Yq.encode_cell({r:g,c:m})];b&&p[y].push(b.v)}}t.value.hotInstance.updateData(p),wce.success("导出成功")},u.readAsBinaryString(l)}catch(u){console.log("err: ",u)}return!1},o=()=>{t.value.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:n==null?void 0:n.value.name})};qc(()=>{r.value&&t.value.hotInstance.updateData(Ji.cloneDeep(r.value))});const s=eo(()=>({language:"zh-CN",licenseKey:"non-commercial-and-evaluation",width:"auto",data:null,startRows:30,startCols:15,minSpareRows:30,minSpareCols:15,colHeaders:!0,rowHeaders:!0,colWidths:100,dropdownMenu:!1,autoWrapRow:!0,fixedRowsTop:0,fixedColumnsLeft:1,fillHandle:!0,manualRowMove:!0,afterChange(){i()},afterCreateCol(){i()},afterCreateRow(){i()},afterRemoveCol(){i()},afterRemoveRow(){i()},contextMenu:{items:{row_above:{name:"上面插入一行"},row_below:{name:"下面插入一行"},col_left:{name:"左侧插入一列"},col_right:{name:"右侧插入一列"},remove_row:{name:"移除本行"},remove_col:{name:"移除本列"},alignment:{name:"对齐方式"},make_read_only:{name:"只读"},copy:{name:"复制"},cut:{name:"剪切"},separator:ct.plugins.ContextMenu.SEPARATOR}}}));return(l,u)=>{const f=Yo("el-button"),c=Yo("el-upload");return Yt(),vr("div",PMt,[$t("div",IMt,[$t("div",MMt,[rn(c,{"before-upload":a},{default:nl(()=>[rn(f,{type:"primary",class:"import-btn"},{default:nl(()=>[Ym("导入数据")]),_:1})]),_:1}),rn(f,{plain:"",type:"primary",onClick:o},{default:nl(()=>[Ym("下载数据")]),_:1})])]),$t("div",DMt,[rn(Tr(u3),{ref_key:"hotTableComponent",ref:t,settings:Tr(s)},null,8,["settings"])])])}}});const NMt=Ma($Mt,[["__scopeId","data-v-bc8ccbf2"]]),ice=e=>(_N("data-v-adddbc27"),e=e(),SN(),e),LMt=ice(()=>$t("i",{class:"iconfont icon-fanhui"},null,-1)),FMt=ice(()=>$t("i",{class:"iconfont icon-fanhui"},null,-1)),HMt={class:"content"},BMt=_i({__name:"widget",props:{title:{type:String,default:"标题"},tooltip:{type:String,default:""},open:{type:Boolean,default:!1}},setup(e){const t=e,r=Mn(!1),n=()=>{r.value=!r.value};return qc(()=>{r.value=t.open}),(i,a)=>{const o=Yo("el-tooltip");return Yt(),vr("div",{class:Xl(["widget",{open:r.value}])},[e.tooltip?(Yt(),bg(o,{key:0,effect:"dark",content:e.tooltip,placement:"left"},{default:nl(()=>[$t("div",{class:"top",onClick:n},[$t("div",null,rv(e.title),1),LMt])]),_:1},8,["content"])):(Yt(),vr("div",{key:1,class:"top",onClick:n},[$t("div",null,rv(e.title),1),FMt])),$t("div",HMt,[qq(i.$slots,"default",{},void 0,!0)])],2)}}});const u4=Ma(BMt,[["__scopeId","data-v-adddbc27"]]),YT=(e,t,r)=>{const n=Ji.cloneDeep(e),{config:i}=n;i[t]=Ji.isObject(r)?Ji.cloneDeep(r):r,console.log("config[key]: ",i[t]),Ta.emit("updateChart",n)},VMt={class:"wrapper"},jMt=_i({__name:"title",setup(e){const t=ml(Qo),r=Mn({}),n=Mn(["#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"]),i=()=>{const{config:o}=t.value;r.value={...o==null?void 0:o.title}},a=()=>{YT(t.value,"title",r.value)};return qc(()=>{i()}),(o,s)=>{const l=Yo("el-checkbox"),u=Yo("el-input"),f=Yo("el-color-picker");return Yt(),bg(Tr(u4),{title:"标题",tooltip:"设置图表标题"},{default:nl(()=>[$t("div",VMt,[rn(l,{modelValue:r.value.show,"onUpdate:modelValue":s[0]||(s[0]=c=>r.value.show=c),label:"",size:"small",onChange:a},null,8,["modelValue"]),rn(u,{modelValue:r.value.value,"onUpdate:modelValue":s[1]||(s[1]=c=>r.value.value=c),size:"small",onInput:a},null,8,["modelValue"]),rn(f,{modelValue:r.value.color,"onUpdate:modelValue":s[2]||(s[2]=c=>r.value.color=c),size:"small",predefine:n.value,onChange:a},null,8,["modelValue","predefine"])])]),_:1})}}});const WMt=Ma(jMt,[["__scopeId","data-v-c87806e1"]]),UMt={class:"wrapper"},zMt=["onClick"],GMt={class:"background-color"},YMt=_i({__name:"theme",setup(e){const t=ml(Qo),r=Mn(["#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgba(255, 69, 0, 0.68)","rgb(255, 120, 0)","#c7158577"]),n=Mn({theme:"",backgroundColor:"#ffffff"}),i=()=>{const{config:l}=t.value;n.value.theme=(l==null?void 0:l.theme)||"westeros",n.value.backgroundColor=(l==null?void 0:l.backgroundColor)||"#ffffff"},a=l=>l.filter((u,f)=>f<6),o=l=>{n.value.theme=l,YT(t.value,"theme",n.value.theme)},s=()=>{YT(t.value,"backgroundColor",n.value.backgroundColor)};return qc(()=>{i()}),(l,u)=>{const f=Yo("el-color-picker");return Yt(),bg(Tr(u4),{title:"主题",tooltip:"设置图表主题"},{default:nl(()=>[$t("div",UMt,[(Yt(!0),vr(Pd,null,Id(Tr(bCe),c=>(Yt(),vr("div",{key:c.value,class:Xl(["theme",{active:c.value===n.value.theme}]),onClick:h=>o(c.value)},[(Yt(!0),vr(Pd,null,Id(a(c.color),h=>(Yt(),vr("div",{key:h,style:_ce({background:h}),class:"color"},null,4))),128))],10,zMt))),128)),$t("div",GMt,[Ym(" 画布颜色 "),rn(f,{modelValue:n.value.backgroundColor,"onUpdate:modelValue":u[0]||(u[0]=c=>n.value.backgroundColor=c),"show-alpha":"",predefine:r.value,onChange:s},null,8,["modelValue","predefine"])])])]),_:1})}}});const KMt=Ma(YMt,[["__scopeId","data-v-b8ad6e19"]]),XMt={class:"wrapper"},qMt=_i({__name:"legend",setup(e){const t=ml(Qo),r=Mn({legend:!0}),n=()=>{const{config:a}=t.value;r.value.legend=a==null?void 0:a.legend},i=()=>{YT(t.value,"legend",r.value.legend)};return qc(()=>{n()}),(a,o)=>{const s=Yo("el-checkbox");return Yt(),bg(Tr(u4),{title:"图例",tooltip:"颜色所代表内容与指标说明"},{default:nl(()=>[$t("div",XMt,[rn(s,{modelValue:r.value.legend,"onUpdate:modelValue":o[0]||(o[0]=l=>r.value.legend=l),label:"图例显示",size:"small",onChange:i},null,8,["modelValue"])])]),_:1})}}});const ZMt=Ma(qMt,[["__scopeId","data-v-970e77c3"]]),JMt={class:"setting"},QMt=_i({__name:"setting",setup(e){return ml(Qo),(t,r)=>(Yt(),vr("div",JMt,[rn(Tr(WMt),{open:!0}),rn(Tr(KMt),{open:!0}),rn(Tr(ZMt),{open:!0})]))}});const e2t=Ma(QMt,[["__scopeId","data-v-518ab403"]]),t2t={class:"setting-block"},r2t={class:"tabs"},n2t=["onClick"],i2t={key:0,class:"data-table"},a2t={class:"chart-setting"},o2t=_i({__name:"settingBlock",setup(e){ml(Qo);const t=[{value:"setting",label:"编辑图表"},{value:"data",label:"编辑数据"}],r=Mn("setting"),n=i=>{r.value=i};return(i,a)=>(Yt(),vr("div",t2t,[$t("div",r2t,[(Yt(),vr(Pd,null,Id(t,o=>$t("div",{key:o.value,class:Xl(["item",{active:r.value===o.value}]),onClick:s=>n(o.value)},rv(o.label),11,n2t)),64))]),r.value==="data"?(Yt(),vr("div",i2t,[rn(Tr(NMt))])):Rc("",!0),BC($t("div",a2t,[rn(Tr(e2t))],512),[[XP,r.value==="setting"]])]))}});const s2t=Ma(o2t,[["__scopeId","data-v-3bc03d2c"]]),l2t=["loading"],u2t={key:1,class:"container"},f2t=_i({__name:"chart",setup(e){const t=cce(),r=Sce(),n=eo(()=>+r.params.id),i=Mn({}),a=Mn(!0),o=async()=>{const l=await t.get(n.value);i.value=l};Xq(Qo,Cce(i)),Ta.on("updateChart",async l=>{l.updatedTime=new Date().getTime(),await t.set(l),await o(),s()});const s=()=>{new BroadcastChannel("chart").postMessage("updateChart")};return qc(async()=>{var l;await o(),a.value=!1,(l=document.querySelector("html"))==null||l.classList.add("dark")}),(l,u)=>(Yt(),vr("div",{class:"chart-wrapper",loading:a.value},[a.value?Rc("",!0):(Yt(),bg(Tr(Nce),{key:0})),a.value?Rc("",!0):(Yt(),vr("div",u2t,[rn(Tr(Xce)),rn(Tr(HCe)),rn(Tr(s2t))])),rn(Tr(Qce))],8,l2t))}});const d2t=Ma(f2t,[["__scopeId","data-v-422f22e1"]]);export{d2t as default};
