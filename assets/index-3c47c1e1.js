import{c as Qi,e as Oa,_ as Sce,g as _ce,P as Cce,d as xce,D as Tce,f as Oce,u as Ece}from"./lodash-0e59a2cd.js";import{B as tI,d as _i,D as Rce,b as Cr,G as aZ,o as tr,H as kce,I as By,r as Mn,c as to,J as jf,l as Jc,g as co,e as Ct,f as Kr,w as ho,h as Km,j as Rr,v as WC,A as Ace,_ as Da,t as Xm,p as EL,k as RL,F as om,i as sm,n as UC,K as rI,L as Lf,y as rv,q as mg,E as Pce,z as Ice,M as GE,N as Mce,O as Dce,P as w4,Q as Nce,R as Lce,S as oZ,T as sZ,U as Fce,u as $ce,V as Hce}from"./index-6d2b136f.js";var MS=function(e){return e&&e.Math==Math&&e},_r=MS(typeof globalThis=="object"&&globalThis)||MS(typeof window=="object"&&window)||MS(typeof self=="object"&&self)||MS(typeof tI=="object"&&tI)||function(){return this}()||Function("return this")(),ns={},Tt=function(e){try{return!!e()}catch{return!0}},Bce=Tt,on=!Bce(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Vce=Tt,Tw=!Vce(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),jce=Tw,DS=Function.prototype.call,gn=jce?DS.bind(DS):function(){return DS.apply(DS,arguments)},Ow={},lZ={}.propertyIsEnumerable,uZ=Object.getOwnPropertyDescriptor,Wce=uZ&&!lZ.call({1:2},1);Ow.f=Wce?function(t){var r=uZ(this,t);return!!r&&r.enumerable}:lZ;var Ew=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},fZ=Tw,cZ=Function.prototype,nI=cZ.call,Uce=fZ&&cZ.bind.bind(nI,nI),Mt=fZ?Uce:function(e){return function(){return nI.apply(e,arguments)}},hZ=Mt,zce=hZ({}.toString),Gce=hZ("".slice),is=function(e){return Gce(zce(e),8,-1)},Yce=Mt,Kce=Tt,Xce=is,YE=Object,qce=Yce("".split),Rw=Kce(function(){return!YE("z").propertyIsEnumerable(0)})?function(e){return Xce(e)=="String"?qce(e,""):YE(e)}:YE,wo=function(e){return e==null},Zce=wo,Jce=TypeError,Hi=function(e){if(Zce(e))throw Jce("Can't call method on "+e);return e},Qce=Rw,ehe=Hi,oa=function(e){return Qce(ehe(e))},iI=typeof document=="object"&&document.all,the=typeof iI>"u"&&iI!==void 0,dZ={all:iI,IS_HTMLDDA:the},vZ=dZ,rhe=vZ.all,Pr=vZ.IS_HTMLDDA?function(e){return typeof e=="function"||e===rhe}:function(e){return typeof e=="function"},S4=Pr,pZ=dZ,nhe=pZ.all,sn=pZ.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:S4(e)||e===nhe}:function(e){return typeof e=="object"?e!==null:S4(e)},KE=_r,ihe=Pr,ahe=function(e){return ihe(e)?e:void 0},ml=function(e,t){return arguments.length<2?ahe(KE[e]):KE[e]&&KE[e][t]},ohe=Mt,ju=ohe({}.isPrototypeOf),Qc=typeof navigator<"u"&&String(navigator.userAgent)||"",gZ=_r,XE=Qc,_4=gZ.process,C4=gZ.Deno,x4=_4&&_4.versions||C4&&C4.version,T4=x4&&x4.v8,ro,zC;T4&&(ro=T4.split("."),zC=ro[0]>0&&ro[0]<4?1:+(ro[0]+ro[1]));!zC&&XE&&(ro=XE.match(/Edge\/(\d+)/),(!ro||ro[1]>=74)&&(ro=XE.match(/Chrome\/(\d+)/),ro&&(zC=+ro[1])));var kw=zC,O4=kw,she=Tt,bg=!!Object.getOwnPropertySymbols&&!she(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&O4&&O4<41}),lhe=bg,yZ=lhe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",uhe=ml,fhe=Pr,che=ju,hhe=yZ,dhe=Object,Aw=hhe?function(e){return typeof e=="symbol"}:function(e){var t=uhe("Symbol");return fhe(t)&&che(t.prototype,dhe(e))},vhe=String,wg=function(e){try{return vhe(e)}catch{return"Object"}},phe=Pr,ghe=wg,yhe=TypeError,eh=function(e){if(phe(e))return e;throw yhe(ghe(e)+" is not a function")},mhe=eh,bhe=wo,th=function(e,t){var r=e[t];return bhe(r)?void 0:mhe(r)},qE=gn,ZE=Pr,JE=sn,whe=TypeError,mZ=function(e,t){var r,n;if(t==="string"&&ZE(r=e.toString)&&!JE(n=qE(r,e))||ZE(r=e.valueOf)&&!JE(n=qE(r,e))||t!=="string"&&ZE(r=e.toString)&&!JE(n=qE(r,e)))return n;throw whe("Can't convert object to primitive value")},Ru={},She={get exports(){return Ru},set exports(e){Ru=e}},_he=!1,E4=_r,Che=Object.defineProperty,kL=function(e,t){try{Che(E4,e,{value:t,configurable:!0,writable:!0})}catch{E4[e]=t}return t},xhe=_r,The=kL,R4="__core-js_shared__",Ohe=xhe[R4]||The(R4,{}),AL=Ohe,k4=AL;(She.exports=function(e,t){return k4[e]||(k4[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Ehe=Hi,Rhe=Object,Bi=function(e){return Rhe(Ehe(e))},khe=Mt,Ahe=Bi,Phe=khe({}.hasOwnProperty),Wr=Object.hasOwn||function(t,r){return Phe(Ahe(t),r)},Ihe=Mt,Mhe=0,Dhe=Math.random(),Nhe=Ihe(1 .toString),QT=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Nhe(++Mhe+Dhe,36)},Lhe=_r,Fhe=Ru,A4=Wr,$he=QT,Hhe=bg,Bhe=yZ,Sd=Lhe.Symbol,QE=Fhe("wks"),Vhe=Bhe?Sd.for||Sd:Sd&&Sd.withoutSetter||$he,Or=function(e){return A4(QE,e)||(QE[e]=Hhe&&A4(Sd,e)?Sd[e]:Vhe("Symbol."+e)),QE[e]},jhe=gn,P4=sn,I4=Aw,Whe=th,Uhe=mZ,zhe=Or,Ghe=TypeError,Yhe=zhe("toPrimitive"),bZ=function(e,t){if(!P4(e)||I4(e))return e;var r=Whe(e,Yhe),n;if(r){if(t===void 0&&(t="default"),n=jhe(r,e,t),!P4(n)||I4(n))return n;throw Ghe("Can't convert object to primitive value")}return t===void 0&&(t="number"),Uhe(e,t)},Khe=bZ,Xhe=Aw,eO=function(e){var t=Khe(e,"string");return Xhe(t)?t:t+""},qhe=_r,M4=sn,aI=qhe.document,Zhe=M4(aI)&&M4(aI.createElement),tO=function(e){return Zhe?aI.createElement(e):{}},Jhe=on,Qhe=Tt,ede=tO,wZ=!Jhe&&!Qhe(function(){return Object.defineProperty(ede("div"),"a",{get:function(){return 7}}).a!=7}),tde=on,rde=gn,nde=Ow,ide=Ew,ade=oa,ode=eO,sde=Wr,lde=wZ,D4=Object.getOwnPropertyDescriptor;ns.f=tde?D4:function(t,r){if(t=ade(t),r=ode(r),lde)try{return D4(t,r)}catch{}if(sde(t,r))return ide(!rde(nde.f,t,r),t[r])};var Ci={},ude=on,fde=Tt,SZ=ude&&fde(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),cde=sn,hde=String,dde=TypeError,qr=function(e){if(cde(e))return e;throw dde(hde(e)+" is not an object")},vde=on,pde=wZ,gde=SZ,NS=qr,N4=eO,yde=TypeError,eR=Object.defineProperty,mde=Object.getOwnPropertyDescriptor,tR="enumerable",rR="configurable",nR="writable";Ci.f=vde?gde?function(t,r,n){if(NS(t),r=N4(r),NS(n),typeof t=="function"&&r==="prototype"&&"value"in n&&nR in n&&!n[nR]){var i=mde(t,r);i&&i[nR]&&(t[r]=n.value,n={configurable:rR in n?n[rR]:i[rR],enumerable:tR in n?n[tR]:i[tR],writable:!1})}return eR(t,r,n)}:eR:function(t,r,n){if(NS(t),r=N4(r),NS(n),pde)try{return eR(t,r,n)}catch{}if("get"in n||"set"in n)throw yde("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var bde=on,wde=Ci,Sde=Ew,rh=bde?function(e,t,r){return wde.f(e,t,Sde(1,r))}:function(e,t,r){return e[t]=r,e},GC={},_de={get exports(){return GC},set exports(e){GC=e}},oI=on,Cde=Wr,_Z=Function.prototype,xde=oI&&Object.getOwnPropertyDescriptor,PL=Cde(_Z,"name"),Tde=PL&&function(){}.name==="something",Ode=PL&&(!oI||oI&&xde(_Z,"name").configurable),Pw={EXISTS:PL,PROPER:Tde,CONFIGURABLE:Ode},Ede=Mt,Rde=Pr,sI=AL,kde=Ede(Function.toString);Rde(sI.inspectSource)||(sI.inspectSource=function(e){return kde(e)});var CZ=sI.inspectSource,Ade=_r,Pde=Pr,L4=Ade.WeakMap,xZ=Pde(L4)&&/native code/.test(String(L4)),Ide=Ru,Mde=QT,F4=Ide("keys"),rO=function(e){return F4[e]||(F4[e]=Mde(e))},Iw={},Dde=xZ,TZ=_r,Nde=sn,Lde=rh,iR=Wr,aR=AL,Fde=rO,$de=Iw,$4="Object already initialized",lI=TZ.TypeError,Hde=TZ.WeakMap,YC,qm,KC,Bde=function(e){return KC(e)?qm(e):YC(e,{})},Vde=function(e){return function(t){var r;if(!Nde(t)||(r=qm(t)).type!==e)throw lI("Incompatible receiver, "+e+" required");return r}};if(Dde||aR.state){var To=aR.state||(aR.state=new Hde);To.get=To.get,To.has=To.has,To.set=To.set,YC=function(e,t){if(To.has(e))throw lI($4);return t.facade=e,To.set(e,t),t},qm=function(e){return To.get(e)||{}},KC=function(e){return To.has(e)}}else{var Ch=Fde("state");$de[Ch]=!0,YC=function(e,t){if(iR(e,Ch))throw lI($4);return t.facade=e,Lde(e,Ch,t),t},qm=function(e){return iR(e,Ch)?e[Ch]:{}},KC=function(e){return iR(e,Ch)}}var bl={set:YC,get:qm,has:KC,enforce:Bde,getterFor:Vde},IL=Mt,jde=Tt,Wde=Pr,LS=Wr,uI=on,Ude=Pw.CONFIGURABLE,zde=CZ,OZ=bl,Gde=OZ.enforce,Yde=OZ.get,H4=String,B1=Object.defineProperty,Kde=IL("".slice),Xde=IL("".replace),qde=IL([].join),Zde=uI&&!jde(function(){return B1(function(){},"length",{value:8}).length!==8}),Jde=String(String).split("String"),Qde=_de.exports=function(e,t,r){Kde(H4(t),0,7)==="Symbol("&&(t="["+Xde(H4(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!LS(e,"name")||Ude&&e.name!==t)&&(uI?B1(e,"name",{value:t,configurable:!0}):e.name=t),Zde&&r&&LS(r,"arity")&&e.length!==r.arity&&B1(e,"length",{value:r.arity});try{r&&LS(r,"constructor")&&r.constructor?uI&&B1(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=Gde(e);return LS(n,"source")||(n.source=qde(Jde,typeof t=="string"?t:"")),e};Function.prototype.toString=Qde(function(){return Wde(this)&&Yde(this).source||zde(this)},"toString");var eve=Pr,tve=Ci,rve=GC,nve=kL,Na=function(e,t,r,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:t;if(eve(r)&&rve(r,a,n),n.global)i?e[t]=r:nve(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:tve.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},nh={},ive=Math.ceil,ave=Math.floor,ove=Math.trunc||function(t){var r=+t;return(r>0?ave:ive)(r)},sve=ove,Wu=function(e){var t=+e;return t!==t||t===0?0:sve(t)},lve=Wu,uve=Math.max,fve=Math.min,Mw=function(e,t){var r=lve(e);return r<0?uve(r+t,0):fve(r,t)},cve=Wu,hve=Math.min,ih=function(e){return e>0?hve(cve(e),9007199254740991):0},dve=ih,La=function(e){return dve(e.length)},vve=oa,pve=Mw,gve=La,B4=function(e){return function(t,r,n){var i=vve(t),a=gve(i),o=pve(n,a),s;if(e&&r!=r){for(;a>o;)if(s=i[o++],s!=s)return!0}else for(;a>o;o++)if((e||o in i)&&i[o]===r)return e||o||0;return!e&&-1}},ML={includes:B4(!0),indexOf:B4(!1)},yve=Mt,oR=Wr,mve=oa,bve=ML.indexOf,wve=Iw,V4=yve([].push),EZ=function(e,t){var r=mve(e),n=0,i=[],a;for(a in r)!oR(wve,a)&&oR(r,a)&&V4(i,a);for(;t.length>n;)oR(r,a=t[n++])&&(~bve(i,a)||V4(i,a));return i},DL=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Sve=EZ,_ve=DL,Cve=_ve.concat("length","prototype");nh.f=Object.getOwnPropertyNames||function(t){return Sve(t,Cve)};var Dw={};Dw.f=Object.getOwnPropertySymbols;var xve=ml,Tve=Mt,Ove=nh,Eve=Dw,Rve=qr,kve=Tve([].concat),RZ=xve("Reflect","ownKeys")||function(t){var r=Ove.f(Rve(t)),n=Eve.f;return n?kve(r,n(t)):r},j4=Wr,Ave=RZ,Pve=ns,Ive=Ci,kZ=function(e,t,r){for(var n=Ave(t),i=Ive.f,a=Pve.f,o=0;o<n.length;o++){var s=n[o];!j4(e,s)&&!(r&&j4(r,s))&&i(e,s,a(t,s))}},Mve=Tt,Dve=Pr,Nve=/#|\.prototype\./,Nw=function(e,t){var r=Fve[Lve(e)];return r==Hve?!0:r==$ve?!1:Dve(t)?Mve(t):!!t},Lve=Nw.normalize=function(e){return String(e).replace(Nve,".").toLowerCase()},Fve=Nw.data={},$ve=Nw.NATIVE="N",Hve=Nw.POLYFILL="P",nO=Nw,sR=_r,Bve=ns.f,Vve=rh,jve=Na,Wve=kL,Uve=kZ,zve=nO,pt=function(e,t){var r=e.target,n=e.global,i=e.stat,a,o,s,l,u,f;if(n?o=sR:i?o=sR[r]||Wve(r,{}):o=(sR[r]||{}).prototype,o)for(s in t){if(u=t[s],e.dontCallGetSet?(f=Bve(o,s),l=f&&f.value):l=o[s],a=zve(n?s:r+(i?".":"#")+s,e.forced),!a&&l!==void 0){if(typeof u==typeof l)continue;Uve(u,l)}(e.sham||l&&l.sham)&&Vve(u,"sham",!0),jve(o,s,u,e)}},Gve=Or,Yve=Gve("toStringTag"),AZ={};AZ[Yve]="z";var NL=String(AZ)==="[object z]",Kve=NL,Xve=Pr,V1=is,qve=Or,Zve=qve("toStringTag"),Jve=Object,Qve=V1(function(){return arguments}())=="Arguments",epe=function(e,t){try{return e[t]}catch{}},iO=Kve?V1:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=epe(t=Jve(e),Zve))=="string"?r:Qve?V1(t):(n=V1(t))=="Object"&&Xve(t.callee)?"Arguments":n},tpe=iO,rpe=String,ln=function(e){if(tpe(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return rpe(e)},LL={},npe=EZ,ipe=DL,Lw=Object.keys||function(t){return npe(t,ipe)},ape=on,ope=SZ,spe=Ci,lpe=qr,upe=oa,fpe=Lw;LL.f=ape&&!ope?Object.defineProperties:function(t,r){lpe(t);for(var n=upe(r),i=fpe(r),a=i.length,o=0,s;a>o;)spe.f(t,s=i[o++],n[s]);return t};var cpe=ml,PZ=cpe("document","documentElement"),hpe=qr,dpe=LL,W4=DL,vpe=Iw,ppe=PZ,gpe=tO,ype=rO,U4=">",z4="<",fI="prototype",cI="script",IZ=ype("IE_PROTO"),lR=function(){},MZ=function(e){return z4+cI+U4+e+z4+"/"+cI+U4},G4=function(e){e.write(MZ("")),e.close();var t=e.parentWindow.Object;return e=null,t},mpe=function(){var e=gpe("iframe"),t="java"+cI+":",r;return e.style.display="none",ppe.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(MZ("document.F=Object")),r.close(),r.F},FS,j1=function(){try{FS=new ActiveXObject("htmlfile")}catch{}j1=typeof document<"u"?document.domain&&FS?G4(FS):mpe():G4(FS);for(var e=W4.length;e--;)delete j1[fI][W4[e]];return j1()};vpe[IZ]=!0;var Sg=Object.create||function(t,r){var n;return t!==null?(lR[fI]=hpe(t),n=new lR,lR[fI]=null,n[IZ]=t):n=j1(),r===void 0?n:dpe.f(n,r)},aO={},bpe=eO,wpe=Ci,Spe=Ew,_g=function(e,t,r){var n=bpe(t);n in e?wpe.f(e,n,Spe(0,r)):e[n]=r},Y4=Mw,_pe=La,Cpe=_g,xpe=Array,Tpe=Math.max,FL=function(e,t,r){for(var n=_pe(e),i=Y4(t,n),a=Y4(r===void 0?n:r,n),o=xpe(Tpe(a-i,0)),s=0;i<a;i++,s++)Cpe(o,s,e[i]);return o.length=s,o},Ope=is,Epe=oa,DZ=nh.f,Rpe=FL,NZ=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],kpe=function(e){try{return DZ(e)}catch{return Rpe(NZ)}};aO.f=function(t){return NZ&&Ope(t)=="Window"?kpe(t):DZ(Epe(t))};var K4=GC,Ape=Ci,Fw=function(e,t,r){return r.get&&K4(r.get,t,{getter:!0}),r.set&&K4(r.set,t,{setter:!0}),Ape.f(e,t,r)},$L={},Ppe=Or;$L.f=Ppe;var Ipe=_r,LZ=Ipe,X4=LZ,Mpe=Wr,Dpe=$L,Npe=Ci.f,HL=function(e){var t=X4.Symbol||(X4.Symbol={});Mpe(t,e)||Npe(t,e,{value:Dpe.f(e)})},Lpe=gn,Fpe=ml,$pe=Or,Hpe=Na,FZ=function(){var e=Fpe("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=$pe("toPrimitive");t&&!t[n]&&Hpe(t,n,function(i){return Lpe(r,this)},{arity:1})},Bpe=Ci.f,Vpe=Wr,jpe=Or,q4=jpe("toStringTag"),oO=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Vpe(e,q4)&&Bpe(e,q4,{configurable:!0,value:t})},Wpe=is,Upe=Mt,$w=function(e){if(Wpe(e)==="Function")return Upe(e)},Z4=$w,zpe=eh,Gpe=Tw,Ype=Z4(Z4.bind),Hw=function(e,t){return zpe(e),t===void 0?e:Gpe?Ype(e,t):function(){return e.apply(t,arguments)}},Kpe=is,Cg=Array.isArray||function(t){return Kpe(t)=="Array"},Xpe=Mt,qpe=Tt,$Z=Pr,Zpe=iO,Jpe=ml,Qpe=CZ,HZ=function(){},ege=[],BZ=Jpe("Reflect","construct"),BL=/^\s*(?:class|function)\b/,tge=Xpe(BL.exec),rge=!BL.exec(HZ),jg=function(t){if(!$Z(t))return!1;try{return BZ(HZ,ege,t),!0}catch{return!1}},VZ=function(t){if(!$Z(t))return!1;switch(Zpe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return rge||!!tge(BL,Qpe(t))}catch{return!0}};VZ.sham=!0;var sO=!BZ||qpe(function(){var e;return jg(jg.call)||!jg(Object)||!jg(function(){e=!0})||e})?VZ:jg,J4=Cg,nge=sO,ige=sn,age=Or,oge=age("species"),Q4=Array,sge=function(e){var t;return J4(e)&&(t=e.constructor,nge(t)&&(t===Q4||J4(t.prototype))?t=void 0:ige(t)&&(t=t[oge],t===null&&(t=void 0))),t===void 0?Q4:t},lge=sge,VL=function(e,t){return new(lge(e))(t===0?0:t)},uge=Hw,fge=Mt,cge=Rw,hge=Bi,dge=La,vge=VL,eV=fge([].push),Rl=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,a=e==6,o=e==7,s=e==5||a;return function(l,u,f,c){for(var h=hge(l),d=cge(h),v=uge(u,f),p=dge(d),g=0,y=c||vge,m=t?y(l,p):r||o?y(l,0):void 0,b,S;p>g;g++)if((s||g in d)&&(b=d[g],S=v(b,g,h),e))if(t)m[g]=S;else if(S)switch(e){case 3:return!0;case 5:return b;case 6:return g;case 2:eV(m,b)}else switch(e){case 4:return!1;case 7:eV(m,b)}return a?-1:n||i?i:m}},ah={forEach:Rl(0),map:Rl(1),filter:Rl(2),some:Rl(3),every:Rl(4),find:Rl(5),findIndex:Rl(6),filterReject:Rl(7)},lO=pt,jL=_r,WL=gn,pge=Mt,nv=on,iv=bg,gge=Tt,En=Wr,yge=ju,hI=qr,uO=oa,UL=eO,mge=ln,dI=Ew,Zm=Sg,jZ=Lw,bge=nh,WZ=aO,wge=Dw,UZ=ns,zZ=Ci,Sge=LL,GZ=Ow,uR=Na,_ge=Fw,zL=Ru,Cge=rO,YZ=Iw,tV=QT,xge=Or,Tge=$L,Oge=HL,Ege=FZ,Rge=oO,KZ=bl,fO=ah.forEach,Ii=Cge("hidden"),cO="Symbol",Jm="prototype",kge=KZ.set,rV=KZ.getterFor(cO),Ra=Object[Jm],wc=jL.Symbol,Vy=wc&&wc[Jm],Age=jL.TypeError,fR=jL.QObject,XZ=UZ.f,Ff=zZ.f,qZ=WZ.f,Pge=GZ.f,ZZ=pge([].push),fl=zL("symbols"),Bw=zL("op-symbols"),Ige=zL("wks"),vI=!fR||!fR[Jm]||!fR[Jm].findChild,pI=nv&&gge(function(){return Zm(Ff({},"a",{get:function(){return Ff(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=XZ(Ra,t);n&&delete Ra[t],Ff(e,t,r),n&&e!==Ra&&Ff(Ra,t,n)}:Ff,cR=function(e,t){var r=fl[e]=Zm(Vy);return kge(r,{type:cO,tag:e,description:t}),nv||(r.description=t),r},hO=function(t,r,n){t===Ra&&hO(Bw,r,n),hI(t);var i=UL(r);return hI(n),En(fl,i)?(n.enumerable?(En(t,Ii)&&t[Ii][i]&&(t[Ii][i]=!1),n=Zm(n,{enumerable:dI(0,!1)})):(En(t,Ii)||Ff(t,Ii,dI(1,{})),t[Ii][i]=!0),pI(t,i,n)):Ff(t,i,n)},GL=function(t,r){hI(t);var n=uO(r),i=jZ(n).concat(eJ(n));return fO(i,function(a){(!nv||WL(gI,n,a))&&hO(t,a,n[a])}),t},Mge=function(t,r){return r===void 0?Zm(t):GL(Zm(t),r)},gI=function(t){var r=UL(t),n=WL(Pge,this,r);return this===Ra&&En(fl,r)&&!En(Bw,r)?!1:n||!En(this,r)||!En(fl,r)||En(this,Ii)&&this[Ii][r]?n:!0},JZ=function(t,r){var n=uO(t),i=UL(r);if(!(n===Ra&&En(fl,i)&&!En(Bw,i))){var a=XZ(n,i);return a&&En(fl,i)&&!(En(n,Ii)&&n[Ii][i])&&(a.enumerable=!0),a}},QZ=function(t){var r=qZ(uO(t)),n=[];return fO(r,function(i){!En(fl,i)&&!En(YZ,i)&&ZZ(n,i)}),n},eJ=function(e){var t=e===Ra,r=qZ(t?Bw:uO(e)),n=[];return fO(r,function(i){En(fl,i)&&(!t||En(Ra,i))&&ZZ(n,fl[i])}),n};iv||(wc=function(){if(yge(Vy,this))throw Age("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:mge(arguments[0]),r=tV(t),n=function(i){this===Ra&&WL(n,Bw,i),En(this,Ii)&&En(this[Ii],r)&&(this[Ii][r]=!1),pI(this,r,dI(1,i))};return nv&&vI&&pI(Ra,r,{configurable:!0,set:n}),cR(r,t)},Vy=wc[Jm],uR(Vy,"toString",function(){return rV(this).tag}),uR(wc,"withoutSetter",function(e){return cR(tV(e),e)}),GZ.f=gI,zZ.f=hO,Sge.f=GL,UZ.f=JZ,bge.f=WZ.f=QZ,wge.f=eJ,Tge.f=function(e){return cR(xge(e),e)},nv&&(_ge(Vy,"description",{configurable:!0,get:function(){return rV(this).description}}),uR(Ra,"propertyIsEnumerable",gI,{unsafe:!0})));lO({global:!0,constructor:!0,wrap:!0,forced:!iv,sham:!iv},{Symbol:wc});fO(jZ(Ige),function(e){Oge(e)});lO({target:cO,stat:!0,forced:!iv},{useSetter:function(){vI=!0},useSimple:function(){vI=!1}});lO({target:"Object",stat:!0,forced:!iv,sham:!nv},{create:Mge,defineProperty:hO,defineProperties:GL,getOwnPropertyDescriptor:JZ});lO({target:"Object",stat:!0,forced:!iv},{getOwnPropertyNames:QZ});Ege();Rge(wc,cO);YZ[Ii]=!0;var Dge=bg,tJ=Dge&&!!Symbol.for&&!!Symbol.keyFor,Nge=pt,Lge=ml,Fge=Wr,$ge=ln,rJ=Ru,Hge=tJ,hR=rJ("string-to-symbol-registry"),Bge=rJ("symbol-to-string-registry");Nge({target:"Symbol",stat:!0,forced:!Hge},{for:function(e){var t=$ge(e);if(Fge(hR,t))return hR[t];var r=Lge("Symbol")(t);return hR[t]=r,Bge[r]=t,r}});var Vge=pt,jge=Wr,Wge=Aw,Uge=wg,zge=Ru,Gge=tJ,nV=zge("symbol-to-string-registry");Vge({target:"Symbol",stat:!0,forced:!Gge},{keyFor:function(t){if(!Wge(t))throw TypeError(Uge(t)+" is not a symbol");if(jge(nV,t))return nV[t]}});var Yge=Tw,nJ=Function.prototype,iV=nJ.apply,aV=nJ.call,oh=typeof Reflect=="object"&&Reflect.apply||(Yge?aV.bind(iV):function(){return aV.apply(iV,arguments)}),Kge=Mt,Vw=Kge([].slice),Xge=Mt,oV=Cg,qge=Pr,sV=is,Zge=ln,lV=Xge([].push),Jge=function(e){if(qge(e))return e;if(oV(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];typeof i=="string"?lV(r,i):(typeof i=="number"||sV(i)=="Number"||sV(i)=="String")&&lV(r,Zge(i))}var a=r.length,o=!0;return function(s,l){if(o)return o=!1,l;if(oV(this))return l;for(var u=0;u<a;u++)if(r[u]===s)return l}}},Qge=pt,iJ=ml,aJ=oh,eye=gn,jw=Mt,oJ=Tt,uV=Pr,fV=Aw,sJ=Vw,tye=Jge,rye=bg,nye=String,lu=iJ("JSON","stringify"),$S=jw(/./.exec),cV=jw("".charAt),iye=jw("".charCodeAt),aye=jw("".replace),oye=jw(1 .toString),sye=/[\uD800-\uDFFF]/g,hV=/^[\uD800-\uDBFF]$/,dV=/^[\uDC00-\uDFFF]$/,vV=!rye||oJ(function(){var e=iJ("Symbol")();return lu([e])!="[null]"||lu({a:e})!="{}"||lu(Object(e))!="{}"}),pV=oJ(function(){return lu("\uDF06\uD834")!=='"\\udf06\\ud834"'||lu("\uDEAD")!=='"\\udead"'}),lye=function(e,t){var r=sJ(arguments),n=tye(t);if(!(!uV(n)&&(e===void 0||fV(e))))return r[1]=function(i,a){if(uV(n)&&(a=eye(n,this,nye(i),a)),!fV(a))return a},aJ(lu,null,r)},uye=function(e,t,r){var n=cV(r,t-1),i=cV(r,t+1);return $S(hV,e)&&!$S(dV,i)||$S(dV,e)&&!$S(hV,n)?"\\u"+oye(iye(e,0),16):e};lu&&Qge({target:"JSON",stat:!0,arity:3,forced:vV||pV},{stringify:function(t,r,n){var i=sJ(arguments),a=aJ(vV?lye:lu,null,i);return pV&&typeof a=="string"?aye(a,sye,uye):a}});var fye=pt,cye=bg,hye=Tt,lJ=Dw,dye=Bi,vye=!cye||hye(function(){lJ.f(1)});fye({target:"Object",stat:!0,forced:vye},{getOwnPropertySymbols:function(t){var r=lJ.f;return r?r(dye(t)):[]}});var pye=pt,gye=on,yye=_r,HS=Mt,mye=Wr,bye=Pr,wye=ju,Sye=ln,_ye=Fw,Cye=kZ,_s=yye.Symbol,Ku=_s&&_s.prototype;if(gye&&bye(_s)&&(!("description"in Ku)||_s().description!==void 0)){var gV={},BS=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:Sye(arguments[0]),r=wye(Ku,this)?new _s(t):t===void 0?_s():_s(t);return t===""&&(gV[r]=!0),r};Cye(BS,_s),BS.prototype=Ku,Ku.constructor=BS;var xye=String(_s("test"))=="Symbol(test)",Tye=HS(Ku.valueOf),Oye=HS(Ku.toString),Eye=/^Symbol\((.*)\)[^)]+$/,Rye=HS("".replace),kye=HS("".slice);_ye(Ku,"description",{configurable:!0,get:function(){var t=Tye(this);if(mye(gV,t))return"";var r=Oye(t),n=xye?kye(r,7,-1):Rye(r,Eye,"$1");return n===""?void 0:n}}),pye({global:!0,constructor:!0,forced:!0},{Symbol:BS})}var Aye=HL;Aye("iterator");var Pye=on,Iye=Pw.EXISTS,uJ=Mt,Mye=Fw,fJ=Function.prototype,Dye=uJ(fJ.toString),cJ=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Nye=uJ(cJ.exec),Lye="name";Pye&&!Iye&&Mye(fJ,Lye,{configurable:!0,get:function(){try{return Nye(cJ,Dye(this))[1]}catch{return""}}});var Fye=Tt,YL=!Fye(function(){return Object.isExtensible(Object.preventExtensions({}))}),kc={},$ye={get exports(){return kc},set exports(e){kc=e}},Hye=Tt,Bye=Hye(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),Vye=Tt,jye=sn,Wye=is,yV=Bye,W1=Object.isExtensible,Uye=Vye(function(){W1(1)}),zye=Uye||yV?function(t){return!jye(t)||yV&&Wye(t)=="ArrayBuffer"?!1:W1?W1(t):!0}:W1,Gye=pt,Yye=Mt,Kye=Iw,Xye=sn,KL=Wr,qye=Ci.f,mV=nh,Zye=aO,XL=zye,Jye=QT,Qye=YL,hJ=!1,cl=Jye("meta"),eme=0,qL=function(e){qye(e,cl,{value:{objectID:"O"+eme++,weakData:{}}})},tme=function(e,t){if(!Xye(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!KL(e,cl)){if(!XL(e))return"F";if(!t)return"E";qL(e)}return e[cl].objectID},rme=function(e,t){if(!KL(e,cl)){if(!XL(e))return!0;if(!t)return!1;qL(e)}return e[cl].weakData},nme=function(e){return Qye&&hJ&&XL(e)&&!KL(e,cl)&&qL(e),e},ime=function(){ame.enable=function(){},hJ=!0;var e=mV.f,t=Yye([].splice),r={};r[cl]=1,e(r).length&&(mV.f=function(n){for(var i=e(n),a=0,o=i.length;a<o;a++)if(i[a]===cl){t(i,a,1);break}return i},Gye({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Zye.f}))},ame=$ye.exports={enable:ime,fastKey:tme,getWeakData:rme,onFreeze:nme};Kye[cl]=!0;var ome=pt,sme=YL,lme=Tt,ume=sn,fme=kc.onFreeze,yI=Object.freeze,cme=lme(function(){yI(1)});ome({target:"Object",stat:!0,forced:cme,sham:!sme},{freeze:function(t){return yI&&ume(t)?yI(fme(t)):t}});var hme=Or,dme=Sg,vme=Ci.f,mI=hme("unscopables"),bI=Array.prototype;bI[mI]==null&&vme(bI,mI,{configurable:!0,value:dme(null)});var Ww=function(e){bI[mI][e]=!0},Uw={},pme=Tt,dJ=!pme(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),gme=Wr,yme=Pr,mme=Bi,bme=rO,wme=dJ,bV=bme("IE_PROTO"),wI=Object,Sme=wI.prototype,dO=wme?wI.getPrototypeOf:function(e){var t=mme(e);if(gme(t,bV))return t[bV];var r=t.constructor;return yme(r)&&t instanceof r?r.prototype:t instanceof wI?Sme:null},_me=Tt,Cme=Pr,xme=sn,wV=dO,Tme=Na,Ome=Or,SI=Ome("iterator"),vJ=!1,Ac,dR,vR;[].keys&&(vR=[].keys(),"next"in vR?(dR=wV(wV(vR)),dR!==Object.prototype&&(Ac=dR)):vJ=!0);var Eme=!xme(Ac)||_me(function(){var e={};return Ac[SI].call(e)!==e});Eme&&(Ac={});Cme(Ac[SI])||Tme(Ac,SI,function(){return this});var pJ={IteratorPrototype:Ac,BUGGY_SAFARI_ITERATORS:vJ},Rme=pJ.IteratorPrototype,kme=Sg,Ame=Ew,Pme=oO,Ime=Uw,Mme=function(){return this},Dme=function(e,t,r,n){var i=t+" Iterator";return e.prototype=kme(Rme,{next:Ame(+!n,r)}),Pme(e,i,!1),Ime[i]=Mme,e},Nme=Mt,Lme=eh,Fme=function(e,t,r){try{return Nme(Lme(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},$me=Pr,Hme=String,Bme=TypeError,Vme=function(e){if(typeof e=="object"||$me(e))return e;throw Bme("Can't set "+Hme(e)+" as a prototype")},jme=Fme,Wme=qr,Ume=Vme,ZL=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=jme(Object.prototype,"__proto__","set"),r(t,[]),e=t instanceof Array}catch{}return function(i,a){return Wme(i),Ume(a),e?r(i,a):i.__proto__=a,i}}():void 0),zme=pt,Gme=gn,gJ=Pw,Yme=Pr,Kme=Dme,SV=dO,_V=ZL,Xme=oO,qme=rh,pR=Na,Zme=Or,Jme=Uw,yJ=pJ,Qme=gJ.PROPER,e0e=gJ.CONFIGURABLE,CV=yJ.IteratorPrototype,VS=yJ.BUGGY_SAFARI_ITERATORS,Wg=Zme("iterator"),xV="keys",Ug="values",TV="entries",t0e=function(){return this},JL=function(e,t,r,n,i,a,o){Kme(r,t,n);var s=function(y){if(y===i&&h)return h;if(!VS&&y in f)return f[y];switch(y){case xV:return function(){return new r(this,y)};case Ug:return function(){return new r(this,y)};case TV:return function(){return new r(this,y)}}return function(){return new r(this)}},l=t+" Iterator",u=!1,f=e.prototype,c=f[Wg]||f["@@iterator"]||i&&f[i],h=!VS&&c||s(i),d=t=="Array"&&f.entries||c,v,p,g;if(d&&(v=SV(d.call(new e)),v!==Object.prototype&&v.next&&(SV(v)!==CV&&(_V?_V(v,CV):Yme(v[Wg])||pR(v,Wg,t0e)),Xme(v,l,!0))),Qme&&i==Ug&&c&&c.name!==Ug&&(e0e?qme(f,"name",Ug):(u=!0,h=function(){return Gme(c,this)})),i)if(p={values:s(Ug),keys:a?h:s(xV),entries:s(TV)},o)for(g in p)(VS||u||!(g in f))&&pR(f,g,p[g]);else zme({target:t,proto:!0,forced:VS||u},p);return f[Wg]!==h&&pR(f,Wg,h,{name:i}),Jme[t]=h,p},QL=function(e,t){return{value:e,done:t}},r0e=oa,eF=Ww,OV=Uw,mJ=bl,n0e=Ci.f,i0e=JL,jS=QL,a0e=on,bJ="Array Iterator",o0e=mJ.set,s0e=mJ.getterFor(bJ),l0e=i0e(Array,"Array",function(e,t){o0e(this,{type:bJ,target:r0e(e),index:0,kind:t})},function(){var e=s0e(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,jS(void 0,!0)):r=="keys"?jS(n,!1):r=="values"?jS(t[n],!1):jS([n,t[n]],!1)},"values"),EV=OV.Arguments=OV.Array;eF("keys");eF("values");eF("entries");if(a0e&&EV.name!=="values")try{n0e(EV,"name",{value:"values"})}catch{}var u0e=NL,f0e=iO,c0e=u0e?{}.toString:function(){return"[object "+f0e(this)+"]"},h0e=NL,d0e=Na,v0e=c0e;h0e||d0e(Object.prototype,"toString",v0e,{unsafe:!0});var p0e=Or,g0e=Uw,y0e=p0e("iterator"),m0e=Array.prototype,wJ=function(e){return e!==void 0&&(g0e.Array===e||m0e[y0e]===e)},b0e=iO,RV=th,w0e=wo,S0e=Uw,_0e=Or,C0e=_0e("iterator"),tF=function(e){if(!w0e(e))return RV(e,C0e)||RV(e,"@@iterator")||S0e[b0e(e)]},x0e=gn,T0e=eh,O0e=qr,E0e=wg,R0e=tF,k0e=TypeError,SJ=function(e,t){var r=arguments.length<2?R0e(e):t;if(T0e(r))return O0e(x0e(r,e));throw k0e(E0e(e)+" is not iterable")},A0e=gn,kV=qr,P0e=th,_J=function(e,t,r){var n,i;kV(e);try{if(n=P0e(e,"return"),!n){if(t==="throw")throw r;return r}n=A0e(n,e)}catch(a){i=!0,n=a}if(t==="throw")throw r;if(i)throw n;return kV(n),r},I0e=Hw,M0e=gn,D0e=qr,N0e=wg,L0e=wJ,F0e=La,AV=ju,$0e=SJ,H0e=tF,PV=_J,B0e=TypeError,U1=function(e,t){this.stopped=e,this.result=t},IV=U1.prototype,rF=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),a=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=I0e(t,n),u,f,c,h,d,v,p,g=function(m){return u&&PV(u,"normal",m),new U1(!0,m)},y=function(m){return i?(D0e(m),s?l(m[0],m[1],g):l(m[0],m[1])):s?l(m,g):l(m)};if(a)u=e.iterator;else if(o)u=e;else{if(f=H0e(e),!f)throw B0e(N0e(e)+" is not iterable");if(L0e(f)){for(c=0,h=F0e(e);h>c;c++)if(d=y(e[c]),d&&AV(IV,d))return d;return new U1(!1)}u=$0e(e,f)}for(v=a?e.next:u.next;!(p=M0e(v,u)).done;){try{d=y(p.value)}catch(m){PV(u,"throw",m)}if(typeof d=="object"&&d&&AV(IV,d))return d}return new U1(!1)},V0e=ju,j0e=TypeError,nF=function(e,t){if(V0e(t,e))return e;throw j0e("Incorrect invocation")},W0e=Or,CJ=W0e("iterator"),xJ=!1;try{var U0e=0,MV={next:function(){return{done:!!U0e++}},return:function(){xJ=!0}};MV[CJ]=function(){return this},Array.from(MV,function(){throw 2})}catch{}var TJ=function(e,t){if(!t&&!xJ)return!1;var r=!1;try{var n={};n[CJ]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},z0e=Pr,G0e=sn,DV=ZL,iF=function(e,t,r){var n,i;return DV&&z0e(n=t.constructor)&&n!==r&&G0e(i=n.prototype)&&i!==r.prototype&&DV(e,i),e},Y0e=pt,K0e=_r,X0e=Mt,NV=nO,q0e=Na,Z0e=kc,J0e=rF,Q0e=nF,ebe=Pr,tbe=wo,gR=sn,yR=Tt,rbe=TJ,nbe=oO,ibe=iF,vO=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,a=n?"set":"add",o=K0e[e],s=o&&o.prototype,l=o,u={},f=function(y){var m=X0e(s[y]);q0e(s,y,y=="add"?function(S){return m(this,S===0?0:S),this}:y=="delete"?function(b){return i&&!gR(b)?!1:m(this,b===0?0:b)}:y=="get"?function(S){return i&&!gR(S)?void 0:m(this,S===0?0:S)}:y=="has"?function(S){return i&&!gR(S)?!1:m(this,S===0?0:S)}:function(S,x){return m(this,S===0?0:S,x),this})},c=NV(e,!ebe(o)||!(i||s.forEach&&!yR(function(){new o().entries().next()})));if(c)l=r.getConstructor(t,e,n,a),Z0e.enable();else if(NV(e,!0)){var h=new l,d=h[a](i?{}:-0,1)!=h,v=yR(function(){h.has(1)}),p=rbe(function(y){new o(y)}),g=!i&&yR(function(){for(var y=new o,m=5;m--;)y[a](m,m);return!y.has(-0)});p||(l=t(function(y,m){Q0e(y,s);var b=ibe(new o,y,l);return tbe(m)||J0e(m,b[a],{that:b,AS_ENTRIES:n}),b}),l.prototype=s,s.constructor=l),(v||g)&&(f("delete"),f("has"),n&&f("get")),(g||d)&&f(a),i&&s.clear&&delete s.clear}return u[e]=l,Y0e({global:!0,constructor:!0,forced:l!=o},u),nbe(l,e),i||r.setStrong(l,e,n),l},abe=Na,aF=function(e,t,r){for(var n in t)abe(e,n,t[n],r);return e},obe=ml,sbe=Fw,lbe=Or,ube=on,LV=lbe("species"),OJ=function(e){var t=obe(e);ube&&t&&!t[LV]&&sbe(t,LV,{configurable:!0,get:function(){return this}})},fbe=Sg,cbe=Fw,FV=aF,hbe=Hw,dbe=nF,vbe=wo,pbe=rF,gbe=JL,WS=QL,ybe=OJ,zg=on,$V=kc.fastKey,EJ=bl,HV=EJ.set,mR=EJ.getterFor,RJ={getConstructor:function(e,t,r,n){var i=e(function(u,f){dbe(u,a),HV(u,{type:t,index:fbe(null),first:void 0,last:void 0,size:0}),zg||(u.size=0),vbe(f)||pbe(f,u[n],{that:u,AS_ENTRIES:r})}),a=i.prototype,o=mR(t),s=function(u,f,c){var h=o(u),d=l(u,f),v,p;return d?d.value=c:(h.last=d={index:p=$V(f,!0),key:f,value:c,previous:v=h.last,next:void 0,removed:!1},h.first||(h.first=d),v&&(v.next=d),zg?h.size++:u.size++,p!=="F"&&(h.index[p]=d)),u},l=function(u,f){var c=o(u),h=$V(f),d;if(h!=="F")return c.index[h];for(d=c.first;d;d=d.next)if(d.key==f)return d};return FV(a,{clear:function(){for(var f=this,c=o(f),h=c.index,d=c.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;c.first=c.last=void 0,zg?c.size=0:f.size=0},delete:function(u){var f=this,c=o(f),h=l(f,u);if(h){var d=h.next,v=h.previous;delete c.index[h.index],h.removed=!0,v&&(v.next=d),d&&(d.previous=v),c.first==h&&(c.first=d),c.last==h&&(c.last=v),zg?c.size--:f.size--}return!!h},forEach:function(f){for(var c=o(this),h=hbe(f,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:c.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(f){return!!l(this,f)}}),FV(a,r?{get:function(f){var c=l(this,f);return c&&c.value},set:function(f,c){return s(this,f===0?0:f,c)}}:{add:function(f){return s(this,f=f===0?0:f,f)}}),zg&&cbe(a,"size",{configurable:!0,get:function(){return o(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=mR(t),a=mR(n);gbe(e,t,function(o,s){HV(this,{type:n,target:o,state:i(o),kind:s,last:void 0})},function(){for(var o=a(this),s=o.kind,l=o.last;l&&l.removed;)l=l.previous;return!o.target||!(o.last=l=l?l.next:o.state.first)?(o.target=void 0,WS(void 0,!0)):s=="keys"?WS(l.key,!1):s=="values"?WS(l.value,!1):WS([l.key,l.value],!1)},r?"entries":"values",!r,!0),ybe(t)}},mbe=vO,bbe=RJ;mbe("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},bbe);var oF=Mt,wbe=Wu,Sbe=ln,_be=Hi,Cbe=oF("".charAt),BV=oF("".charCodeAt),xbe=oF("".slice),VV=function(e){return function(t,r){var n=Sbe(_be(t)),i=wbe(r),a=n.length,o,s;return i<0||i>=a?e?"":void 0:(o=BV(n,i),o<55296||o>56319||i+1===a||(s=BV(n,i+1))<56320||s>57343?e?Cbe(n,i):o:e?xbe(n,i,i+2):(o-55296<<10)+(s-56320)+65536)}},sF={codeAt:VV(!1),charAt:VV(!0)},Tbe=sF.charAt,Obe=ln,kJ=bl,Ebe=JL,jV=QL,AJ="String Iterator",Rbe=kJ.set,kbe=kJ.getterFor(AJ);Ebe(String,"String",function(e){Rbe(this,{type:AJ,string:Obe(e),index:0})},function(){var t=kbe(this),r=t.string,n=t.index,i;return n>=r.length?jV(void 0,!0):(i=Tbe(r,n),t.index+=i.length,jV(i,!1))});var PJ={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Abe=tO,bR=Abe("span").classList,WV=bR&&bR.constructor&&bR.constructor.prototype,IJ=WV===Object.prototype?void 0:WV,UV=_r,MJ=PJ,Pbe=IJ,jy=l0e,wR=rh,DJ=Or,SR=DJ("iterator"),zV=DJ("toStringTag"),_R=jy.values,NJ=function(e,t){if(e){if(e[SR]!==_R)try{wR(e,SR,_R)}catch{e[SR]=_R}if(e[zV]||wR(e,zV,t),MJ[t]){for(var r in jy)if(e[r]!==jy[r])try{wR(e,r,jy[r])}catch{e[r]=jy[r]}}}};for(var CR in MJ)NJ(UV[CR]&&UV[CR].prototype,CR);NJ(Pbe,"DOMTokenList");var Ibe=pt,Mbe=ML.includes,Dbe=Tt,Nbe=Ww,Lbe=Dbe(function(){return!Array(1).includes()});Ibe({target:"Array",proto:!0,forced:Lbe},{includes:function(t){return Mbe(this,t,arguments.length>1?arguments[1]:void 0)}});Nbe("includes");var GV=wg,Fbe=TypeError,LJ=function(e,t){if(!delete e[t])throw Fbe("Cannot delete property "+GV(t)+" of "+GV(e))},YV=FL,$be=Math.floor,_I=function(e,t){var r=e.length,n=$be(r/2);return r<8?Hbe(e,t):Bbe(e,_I(YV(e,0,n),t),_I(YV(e,n),t),t)},Hbe=function(e,t){for(var r=e.length,n=1,i,a;n<r;){for(a=n,i=e[n];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==n++&&(e[a]=i)}return e},Bbe=function(e,t,r,n){for(var i=t.length,a=r.length,o=0,s=0;o<i||s<a;)e[o+s]=o<i&&s<a?n(t[o],r[s])<=0?t[o++]:r[s++]:o<i?t[o++]:r[s++];return e},Vbe=_I,jbe=Tt,xg=function(e,t){var r=[][e];return!!r&&jbe(function(){r.call(null,t||function(){return 1},1)})},Wbe=Qc,KV=Wbe.match(/firefox\/(\d+)/i),Ube=!!KV&&+KV[1],zbe=Qc,Gbe=/MSIE|Trident/.test(zbe),Ybe=Qc,XV=Ybe.match(/AppleWebKit\/(\d+)\./),Kbe=!!XV&&+XV[1],Xbe=pt,FJ=Mt,qbe=eh,Zbe=Bi,qV=La,Jbe=LJ,ZV=ln,lF=Tt,Qbe=Vbe,ewe=xg,JV=Ube,twe=Gbe,QV=kw,ej=Kbe,Ql=[],tj=FJ(Ql.sort),rwe=FJ(Ql.push),nwe=lF(function(){Ql.sort(void 0)}),iwe=lF(function(){Ql.sort(null)}),awe=ewe("sort"),$J=!lF(function(){if(QV)return QV<70;if(!(JV&&JV>3)){if(twe)return!0;if(ej)return ej<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)Ql.push({k:r+i,v:n})}for(Ql.sort(function(a,o){return o.v-a.v}),i=0;i<Ql.length;i++)r=Ql[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),owe=nwe||!iwe||!awe||!$J,swe=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:ZV(t)>ZV(r)?1:-1}};Xbe({target:"Array",proto:!0,forced:owe},{sort:function(t){t!==void 0&&qbe(t);var r=Zbe(this);if($J)return t===void 0?tj(r):tj(r,t);var n=[],i=qV(r),a,o;for(o=0;o<i;o++)o in r&&rwe(n,r[o]);for(Qbe(n,swe(t)),a=qV(n),o=0;o<a;)r[o]=n[o++];for(;o<i;)Jbe(r,o++);return r}});var lwe=on,uwe=Cg,fwe=TypeError,cwe=Object.getOwnPropertyDescriptor,hwe=lwe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),dwe=hwe?function(e,t){if(uwe(e)&&!cwe(e,"length").writable)throw fwe("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},vwe=TypeError,pwe=9007199254740991,HJ=function(e){if(e>pwe)throw vwe("Maximum allowed index exceeded");return e},gwe=Tt,ywe=Or,mwe=kw,bwe=ywe("species"),zw=function(e){return mwe>=51||!gwe(function(){var t=[],r=t.constructor={};return r[bwe]=function(){return{foo:1}},t[e](Boolean).foo!==1})},wwe=pt,Swe=Bi,_we=Mw,Cwe=Wu,xwe=La,Twe=dwe,Owe=HJ,Ewe=VL,Rwe=_g,xR=LJ,kwe=zw,Awe=kwe("splice"),Pwe=Math.max,Iwe=Math.min;wwe({target:"Array",proto:!0,forced:!Awe},{splice:function(t,r){var n=Swe(this),i=xwe(n),a=_we(t,i),o=arguments.length,s,l,u,f,c,h;for(o===0?s=l=0:o===1?(s=0,l=i-a):(s=o-2,l=Iwe(Pwe(Cwe(r),0),i-a)),Owe(i+s-l),u=Ewe(n,l),f=0;f<l;f++)c=a+f,c in n&&Rwe(u,f,n[c]);if(u.length=l,s<l){for(f=a;f<i-l;f++)c=f+l,h=f+s,c in n?n[h]=n[c]:xR(n,h);for(f=i;f>i-l+s;f--)xR(n,f-1)}else if(s>l)for(f=i-l;f>a;f--)c=f+l-1,h=f+s-1,c in n?n[h]=n[c]:xR(n,h);for(f=0;f<s;f++)n[f+a]=arguments[f+2];return Twe(n,i-l+s),u}});var Mwe=sn,Dwe=Math.floor,Nwe=Number.isInteger||function(t){return!Mwe(t)&&isFinite(t)&&Dwe(t)===t},Lwe=pt,Fwe=Nwe;Lwe({target:"Number",stat:!0},{isInteger:Fwe});var $we=Mt,BJ=$we(1 .valueOf),VJ=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,Hwe=Mt,Bwe=Hi,Vwe=ln,CI=VJ,rj=Hwe("".replace),jwe=RegExp("^["+CI+"]+"),Wwe=RegExp("(^|[^"+CI+"])["+CI+"]+$"),TR=function(e){return function(t){var r=Vwe(Bwe(t));return e&1&&(r=rj(r,jwe,"")),e&2&&(r=rj(r,Wwe,"$1")),r}},jJ={start:TR(1),end:TR(2),trim:TR(3)},Uwe=pt,WJ=_he,zwe=on,UJ=_r,zJ=LZ,GJ=Mt,Gwe=nO,nj=Wr,Ywe=iF,Kwe=ju,Xwe=Aw,YJ=bZ,qwe=Tt,Zwe=nh.f,Jwe=ns.f,Qwe=Ci.f,eSe=BJ,tSe=jJ.trim,pO="Number",Id=UJ[pO];zJ[pO];var uF=Id.prototype,rSe=UJ.TypeError,nSe=GJ("".slice),US=GJ("".charCodeAt),iSe=function(e){var t=YJ(e,"number");return typeof t=="bigint"?t:aSe(t)},aSe=function(e){var t=YJ(e,"number"),r,n,i,a,o,s,l,u;if(Xwe(t))throw rSe("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=tSe(t),r=US(t,0),r===43||r===45){if(n=US(t,2),n===88||n===120)return NaN}else if(r===48){switch(US(t,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(o=nSe(t,2),s=o.length,l=0;l<s;l++)if(u=US(o,l),u<48||u>a)return NaN;return parseInt(o,i)}}return+t},fF=Gwe(pO,!Id(" 0o1")||!Id("0b1")||Id("+0x1")),oSe=function(e){return Kwe(uF,e)&&qwe(function(){eSe(e)})},gO=function(t){var r=arguments.length<1?0:Id(iSe(t));return oSe(this)?Ywe(Object(r),this,gO):r};gO.prototype=uF;fF&&!WJ&&(uF.constructor=gO);Uwe({global:!0,constructor:!0,wrap:!0,forced:fF},{Number:gO});var sSe=function(e,t){for(var r=zwe?Zwe(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)nj(t,i=r[n])&&!nj(e,i)&&Qwe(e,i,Jwe(t,i))};(fF||WJ)&&sSe(zJ[pO],Id);var lSe=pt,ij=Cg,uSe=sO,fSe=sn,aj=Mw,cSe=La,hSe=oa,dSe=_g,vSe=Or,pSe=zw,gSe=Vw,ySe=pSe("slice"),mSe=vSe("species"),OR=Array,bSe=Math.max;lSe({target:"Array",proto:!0,forced:!ySe},{slice:function(t,r){var n=hSe(this),i=cSe(n),a=aj(t,i),o=aj(r===void 0?i:r,i),s,l,u;if(ij(n)&&(s=n.constructor,uSe(s)&&(s===OR||ij(s.prototype))?s=void 0:fSe(s)&&(s=s[mSe],s===null&&(s=void 0)),s===OR||s===void 0))return gSe(n,a,o);for(l=new(s===void 0?OR:s)(bSe(o-a,0)),u=0;a<o;a++,u++)a in n&&dSe(l,u,n[a]);return l.length=u,l}});var wSe=pt,SSe=Tt,_Se=Cg,CSe=sn,xSe=Bi,TSe=La,oj=HJ,sj=_g,OSe=VL,ESe=zw,RSe=Or,kSe=kw,KJ=RSe("isConcatSpreadable"),ASe=kSe>=51||!SSe(function(){var e=[];return e[KJ]=!1,e.concat()[0]!==e}),PSe=function(e){if(!CSe(e))return!1;var t=e[KJ];return t!==void 0?!!t:_Se(e)},ISe=!ASe||!ESe("concat");wSe({target:"Array",proto:!0,arity:1,forced:ISe},{concat:function(t){var r=xSe(this),n=OSe(r,0),i=0,a,o,s,l,u;for(a=-1,s=arguments.length;a<s;a++)if(u=a===-1?r:arguments[a],PSe(u))for(l=TSe(u),oj(i+l),o=0;o<l;o++,i++)o in u&&sj(n,i,u[o]);else oj(i+1),sj(n,i++,u);return n.length=i,n}});var MSe=Bi,lj=Mw,DSe=La,NSe=function(t){for(var r=MSe(this),n=DSe(r),i=arguments.length,a=lj(i>1?arguments[1]:void 0,n),o=i>2?arguments[2]:void 0,s=o===void 0?n:lj(o,n);s>a;)r[a++]=t;return r},LSe=pt,FSe=NSe,$Se=Ww;LSe({target:"Array",proto:!0},{fill:FSe});$Se("fill");var HSe=pt,BSe=ah.map,VSe=zw,jSe=VSe("map");HSe({target:"Array",proto:!0,forced:!jSe},{map:function(t){return BSe(this,t,arguments.length>1?arguments[1]:void 0)}});var WSe=qr,XJ=function(){var e=WSe(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},cF=Tt,USe=_r,hF=USe.RegExp,dF=cF(function(){var e=hF("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),zSe=dF||cF(function(){return!hF("a","y").sticky}),GSe=dF||cF(function(){var e=hF("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),vF={BROKEN_CARET:GSe,MISSED_STICKY:zSe,UNSUPPORTED_Y:dF},YSe=Tt,KSe=_r,XSe=KSe.RegExp,qJ=YSe(function(){var e=XSe(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),qSe=Tt,ZSe=_r,JSe=ZSe.RegExp,ZJ=qSe(function(){var e=JSe("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),_d=gn,yO=Mt,QSe=ln,e_e=XJ,t_e=vF,r_e=Ru,n_e=Sg,i_e=bl.get,a_e=qJ,o_e=ZJ,s_e=r_e("native-string-replace",String.prototype.replace),XC=RegExp.prototype.exec,xI=XC,l_e=yO("".charAt),u_e=yO("".indexOf),f_e=yO("".replace),ER=yO("".slice),TI=function(){var e=/a/,t=/b*/g;return _d(XC,e,"a"),_d(XC,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),JJ=t_e.BROKEN_CARET,OI=/()??/.exec("")[1]!==void 0,c_e=TI||OI||JJ||a_e||o_e;c_e&&(xI=function(t){var r=this,n=i_e(r),i=QSe(t),a=n.raw,o,s,l,u,f,c,h;if(a)return a.lastIndex=r.lastIndex,o=_d(xI,a,i),r.lastIndex=a.lastIndex,o;var d=n.groups,v=JJ&&r.sticky,p=_d(e_e,r),g=r.source,y=0,m=i;if(v&&(p=f_e(p,"y",""),u_e(p,"g")===-1&&(p+="g"),m=ER(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&l_e(i,r.lastIndex-1)!==`
`)&&(g="(?: "+g+")",m=" "+m,y++),s=new RegExp("^(?:"+g+")",p)),OI&&(s=new RegExp("^"+g+"$(?!\\s)",p)),TI&&(l=r.lastIndex),u=_d(XC,v?s:r,m),v?u?(u.input=ER(u.input,y),u[0]=ER(u[0],y),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:TI&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),OI&&u&&u.length>1&&_d(s_e,u[0],s,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&d)for(u.groups=c=n_e(null),f=0;f<d.length;f++)h=d[f],c[h[0]]=u[h[1]];return u});var mO=xI,h_e=pt,uj=mO;h_e({target:"RegExp",proto:!0,forced:/./.exec!==uj},{exec:uj});var fj=$w,cj=Na,d_e=mO,hj=Tt,QJ=Or,v_e=rh,p_e=QJ("species"),RR=RegExp.prototype,bO=function(e,t,r,n){var i=QJ(e),a=!hj(function(){var u={};return u[i]=function(){return 7},""[e](u)!=7}),o=a&&!hj(function(){var u=!1,f=/a/;return e==="split"&&(f={},f.constructor={},f.constructor[p_e]=function(){return f},f.flags="",f[i]=/./[i]),f.exec=function(){return u=!0,null},f[i](""),!u});if(!a||!o||r){var s=fj(/./[i]),l=t(i,""[e],function(u,f,c,h,d){var v=fj(u),p=f.exec;return p===d_e||p===RR.exec?a&&!d?{done:!0,value:s(f,c,h)}:{done:!0,value:v(c,f,h)}:{done:!1}});cj(String.prototype,e,l[0]),cj(RR,i,l[1])}n&&v_e(RR[i],"sham",!0)},g_e=sF.charAt,pF=function(e,t,r){return t+(r?g_e(e,t).length:1)},gF=Mt,y_e=Bi,m_e=Math.floor,kR=gF("".charAt),b_e=gF("".replace),AR=gF("".slice),w_e=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,S_e=/\$([$&'`]|\d{1,2})/g,__e=function(e,t,r,n,i,a){var o=r+e.length,s=n.length,l=S_e;return i!==void 0&&(i=y_e(i),l=w_e),b_e(a,l,function(u,f){var c;switch(kR(f,0)){case"$":return"$";case"&":return e;case"`":return AR(t,0,r);case"'":return AR(t,o);case"<":c=i[AR(f,1,-1)];break;default:var h=+f;if(h===0)return u;if(h>s){var d=m_e(h/10);return d===0?u:d<=s?n[d-1]===void 0?kR(f,1):n[d-1]+kR(f,1):u}c=n[h-1]}return c===void 0?"":c})},dj=gn,C_e=qr,x_e=Pr,T_e=is,O_e=mO,E_e=TypeError,wO=function(e,t){var r=e.exec;if(x_e(r)){var n=dj(r,e,t);return n!==null&&C_e(n),n}if(T_e(e)==="RegExp")return dj(O_e,e,t);throw E_e("RegExp#exec called on incompatible receiver")},R_e=oh,vj=gn,SO=Mt,k_e=bO,A_e=Tt,P_e=qr,I_e=Pr,M_e=wo,D_e=Wu,N_e=ih,xh=ln,L_e=Hi,F_e=pF,$_e=th,H_e=__e,B_e=wO,V_e=Or,EI=V_e("replace"),j_e=Math.max,W_e=Math.min,U_e=SO([].concat),PR=SO([].push),pj=SO("".indexOf),gj=SO("".slice),z_e=function(e){return e===void 0?e:String(e)},G_e=function(){return"a".replace(/./,"$0")==="$0"}(),yj=function(){return/./[EI]?/./[EI]("a","$0")==="":!1}(),Y_e=!A_e(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});k_e("replace",function(e,t,r){var n=yj?"$":"$0";return[function(a,o){var s=L_e(this),l=M_e(a)?void 0:$_e(a,EI);return l?vj(l,a,s,o):vj(t,xh(s),a,o)},function(i,a){var o=P_e(this),s=xh(i);if(typeof a=="string"&&pj(a,n)===-1&&pj(a,"$<")===-1){var l=r(t,o,s,a);if(l.done)return l.value}var u=I_e(a);u||(a=xh(a));var f=o.global;if(f){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var d=B_e(o,s);if(d===null||(PR(h,d),!f))break;var v=xh(d[0]);v===""&&(o.lastIndex=F_e(s,N_e(o.lastIndex),c))}for(var p="",g=0,y=0;y<h.length;y++){d=h[y];for(var m=xh(d[0]),b=j_e(W_e(D_e(d.index),s.length),0),S=[],x=1;x<d.length;x++)PR(S,z_e(d[x]));var T=d.groups;if(u){var E=U_e([m],S,b,s);T!==void 0&&PR(E,T);var P=xh(R_e(a,void 0,E))}else P=H_e(m,s,b,S,T,a);b>=g&&(p+=gj(s,g,b)+P,g=b+m.length)}return p+gj(s,g)}]},!Y_e||!G_e||yj);var K_e=qr,X_e=_J,q_e=function(e,t,r,n){try{return n?t(K_e(r)[0],r[1]):t(r)}catch(i){X_e(e,"throw",i)}},Z_e=Hw,J_e=gn,Q_e=Bi,e1e=q_e,t1e=wJ,r1e=sO,n1e=La,mj=_g,i1e=SJ,a1e=tF,bj=Array,o1e=function(t){var r=Q_e(t),n=r1e(this),i=arguments.length,a=i>1?arguments[1]:void 0,o=a!==void 0;o&&(a=Z_e(a,i>2?arguments[2]:void 0));var s=a1e(r),l=0,u,f,c,h,d,v;if(s&&!(this===bj&&t1e(s)))for(h=i1e(r,s),d=h.next,f=n?new this:[];!(c=J_e(d,h)).done;l++)v=o?e1e(h,a,[c.value,l],!0):c.value,mj(f,l,v);else for(u=n1e(r),f=n?new this(u):bj(u);u>l;l++)v=o?a(r[l],l):r[l],mj(f,l,v);return f.length=l,f},s1e=pt,l1e=o1e,u1e=TJ,f1e=!u1e(function(e){Array.from(e)});s1e({target:"Array",stat:!0,forced:f1e},{from:l1e});var c1e=pt,h1e=$w,d1e=ML.indexOf,v1e=xg,RI=h1e([].indexOf),eQ=!!RI&&1/RI([1],1,-0)<0,p1e=eQ||!v1e("indexOf");c1e({target:"Array",proto:!0,forced:p1e},{indexOf:function(t){var r=arguments.length>1?arguments[1]:void 0;return eQ?RI(this,t,r)||0:d1e(this,t,r)}});var g1e=pt,y1e=Mt,m1e=Cg,b1e=y1e([].reverse),wj=[1,2];g1e({target:"Array",proto:!0,forced:String(wj)===String(wj.reverse())},{reverse:function(){return m1e(this)&&(this.length=this.length),b1e(this)}});var w1e=ah.forEach,S1e=xg,_1e=S1e("forEach"),C1e=_1e?[].forEach:function(t){return w1e(this,t,arguments.length>1?arguments[1]:void 0)},Sj=_r,_j=PJ,x1e=IJ,IR=C1e,T1e=rh,tQ=function(e){if(e&&e.forEach!==IR)try{T1e(e,"forEach",IR)}catch{e.forEach=IR}};for(var MR in _j)_j[MR]&&tQ(Sj[MR]&&Sj[MR].prototype);tQ(x1e);var O1e=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",E1e=TypeError,rQ=function(e,t){if(e<t)throw E1e("Not enough arguments");return e},nQ=_r,R1e=oh,k1e=Pr,A1e=O1e,P1e=Qc,I1e=Vw,M1e=rQ,D1e=nQ.Function,N1e=/MSIE .\./.test(P1e)||A1e&&function(){var e=nQ.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),yF=function(e,t){var r=t?2:1;return N1e?function(n,i){var a=M1e(arguments.length,1)>r,o=k1e(n)?n:D1e(n),s=a?I1e(arguments,r):[],l=a?function(){R1e(o,this,s)}:o;return t?e(l,i):e(l)}:e},L1e=pt,iQ=_r,F1e=yF,Cj=F1e(iQ.setInterval,!0);L1e({global:!0,bind:!0,forced:iQ.setInterval!==Cj},{setInterval:Cj});var $1e=pt,aQ=_r,H1e=yF,xj=H1e(aQ.setTimeout,!0);$1e({global:!0,bind:!0,forced:aQ.setTimeout!==xj},{setTimeout:xj});var B1e=Qc,V1e=/(?:ipad|iphone|ipod).*applewebkit/i.test(B1e),j1e=is,oQ=typeof process<"u"&&j1e(process)=="process",ea=_r,W1e=oh,U1e=Hw,Tj=Pr,z1e=Wr,sQ=Tt,Oj=PZ,G1e=Vw,Ej=tO,Y1e=rQ,K1e=V1e,X1e=oQ,kI=ea.setImmediate,AI=ea.clearImmediate,q1e=ea.process,DR=ea.Dispatch,Z1e=ea.Function,Rj=ea.MessageChannel,J1e=ea.String,NR=0,lm={},kj="onreadystatechange",Qm,Xu,LR,FR;sQ(function(){Qm=ea.location});var mF=function(e){if(z1e(lm,e)){var t=lm[e];delete lm[e],t()}},$R=function(e){return function(){mF(e)}},Aj=function(e){mF(e.data)},Pj=function(e){ea.postMessage(J1e(e),Qm.protocol+"//"+Qm.host)};(!kI||!AI)&&(kI=function(t){Y1e(arguments.length,1);var r=Tj(t)?t:Z1e(t),n=G1e(arguments,1);return lm[++NR]=function(){W1e(r,void 0,n)},Xu(NR),NR},AI=function(t){delete lm[t]},X1e?Xu=function(e){q1e.nextTick($R(e))}:DR&&DR.now?Xu=function(e){DR.now($R(e))}:Rj&&!K1e?(LR=new Rj,FR=LR.port2,LR.port1.onmessage=Aj,Xu=U1e(FR.postMessage,FR)):ea.addEventListener&&Tj(ea.postMessage)&&!ea.importScripts&&Qm&&Qm.protocol!=="file:"&&!sQ(Pj)?(Xu=Pj,ea.addEventListener("message",Aj,!1)):kj in Ej("script")?Xu=function(e){Oj.appendChild(Ej("script"))[kj]=function(){Oj.removeChild(this),mF(e)}}:Xu=function(e){setTimeout($R(e),0)});var lQ={set:kI,clear:AI},Q1e=pt,eCe=_r,Ij=lQ.clear;Q1e({global:!0,bind:!0,enumerable:!0,forced:eCe.clearImmediate!==Ij},{clearImmediate:Ij});var tCe=pt,uQ=_r,Mj=lQ.set,rCe=yF,Dj=uQ.setImmediate?rCe(Mj,!1):Mj;tCe({global:!0,bind:!0,enumerable:!0,forced:uQ.setImmediate!==Dj},{setImmediate:Dj});var nCe=vO,iCe=RJ;nCe("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},iCe);var aCe=pt,oCe=Tt,sCe=Bi,fQ=dO,lCe=dJ,uCe=oCe(function(){fQ(1)});aCe({target:"Object",stat:!0,forced:uCe,sham:!lCe},{getPrototypeOf:function(t){return fQ(sCe(t))}});var fCe=sn,cCe=is,hCe=Or,dCe=hCe("match"),bF=function(e){var t;return fCe(e)&&((t=e[dCe])!==void 0?!!t:cCe(e)=="RegExp")},vCe=bF,pCe=TypeError,wF=function(e){if(vCe(e))throw pCe("The method doesn't accept regular expressions");return e},gCe=Or,yCe=gCe("match"),SF=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[yCe]=!1,"/./"[e](t)}catch{}}return!1},mCe=pt,bCe=Mt,wCe=wF,SCe=Hi,Nj=ln,_Ce=SF,CCe=bCe("".indexOf);mCe({target:"String",proto:!0,forced:!_Ce("includes")},{includes:function(t){return!!~CCe(Nj(SCe(this)),Nj(wCe(t)),arguments.length>1?arguments[1]:void 0)}});var xCe=pt,TCe=ah.filter,OCe=zw,ECe=OCe("filter");xCe({target:"Array",proto:!0,forced:!ECe},{filter:function(t){return TCe(this,t,arguments.length>1?arguments[1]:void 0)}});var RCe=gn,kCe=Wr,ACe=ju,PCe=XJ,Lj=RegExp.prototype,cQ=function(e){var t=e.flags;return t===void 0&&!("flags"in Lj)&&!kCe(e,"flags")&&ACe(Lj,e)?RCe(PCe,e):t},ICe=Ci.f,MCe=function(e,t,r){r in e||ICe(e,r,{configurable:!0,get:function(){return t[r]},set:function(n){t[r]=n}})},DCe=on,_F=_r,Gw=Mt,NCe=nO,LCe=iF,FCe=rh,$Ce=nh.f,Fj=ju,HCe=bF,$j=ln,BCe=cQ,hQ=vF,VCe=MCe,jCe=Na,WCe=Tt,UCe=Wr,zCe=bl.enforce,GCe=OJ,YCe=Or,dQ=qJ,vQ=ZJ,KCe=YCe("match"),uu=_F.RegExp,vd=uu.prototype,XCe=_F.SyntaxError,qCe=Gw(vd.exec),qC=Gw("".charAt),Hj=Gw("".replace),Bj=Gw("".indexOf),ZCe=Gw("".slice),JCe=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Sc=/a/g,HR=/a/g,QCe=new uu(Sc)!==Sc,pQ=hQ.MISSED_STICKY,exe=hQ.UNSUPPORTED_Y,txe=DCe&&(!QCe||pQ||dQ||vQ||WCe(function(){return HR[KCe]=!1,uu(Sc)!=Sc||uu(HR)==HR||uu(Sc,"i")!="/a/i"})),rxe=function(e){for(var t=e.length,r=0,n="",i=!1,a;r<=t;r++){if(a=qC(e,r),a==="\\"){n+=a+qC(e,++r);continue}!i&&a==="."?n+="[\\s\\S]":(a==="["?i=!0:a==="]"&&(i=!1),n+=a)}return n},nxe=function(e){for(var t=e.length,r=0,n="",i=[],a={},o=!1,s=!1,l=0,u="",f;r<=t;r++){if(f=qC(e,r),f==="\\")f=f+qC(e,++r);else if(f==="]")o=!1;else if(!o)switch(!0){case f==="[":o=!0;break;case f==="(":qCe(JCe,ZCe(e,r+1))&&(r+=2,s=!0),n+=f,l++;continue;case(f===">"&&s):if(u===""||UCe(a,u))throw new XCe("Invalid capture group name");a[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=f:n+=f}return[n,i]};if(NCe("RegExp",txe)){for(var qu=function(t,r){var n=Fj(vd,this),i=HCe(t),a=r===void 0,o=[],s=t,l,u,f,c,h,d;if(!n&&i&&a&&t.constructor===qu)return t;if((i||Fj(vd,t))&&(t=t.source,a&&(r=BCe(s))),t=t===void 0?"":$j(t),r=r===void 0?"":$j(r),s=t,dQ&&"dotAll"in Sc&&(u=!!r&&Bj(r,"s")>-1,u&&(r=Hj(r,/s/g,""))),l=r,pQ&&"sticky"in Sc&&(f=!!r&&Bj(r,"y")>-1,f&&exe&&(r=Hj(r,/y/g,""))),vQ&&(c=nxe(t),t=c[0],o=c[1]),h=LCe(uu(t,r),n?this:vd,qu),(u||f||o.length)&&(d=zCe(h),u&&(d.dotAll=!0,d.raw=qu(rxe(t),l)),f&&(d.sticky=!0),o.length&&(d.groups=o)),t!==s)try{FCe(h,"source",s===""?"(?:)":s)}catch{}return h},Vj=$Ce(uu),jj=0;Vj.length>jj;)VCe(qu,uu,Vj[jj++]);vd.constructor=qu,qu.prototype=vd,jCe(_F,"RegExp",qu,{constructor:!0})}GCe("RegExp");var ixe=Pw.PROPER,axe=Na,oxe=qr,Wj=ln,sxe=Tt,lxe=cQ,CF="toString",uxe=RegExp.prototype,gQ=uxe[CF],fxe=sxe(function(){return gQ.call({source:"a",flags:"b"})!="/a/b"}),cxe=ixe&&gQ.name!=CF;(fxe||cxe)&&axe(RegExp.prototype,CF,function(){var t=oxe(this),r=Wj(t.source),n=Wj(lxe(t));return"/"+r+"/"+n},{unsafe:!0});var hxe=pt,dxe=Mt,vxe=Rw,pxe=oa,gxe=xg,yxe=dxe([].join),mxe=vxe!=Object,bxe=mxe||!gxe("join",",");hxe({target:"Array",proto:!0,forced:bxe},{join:function(t){return yxe(pxe(this),t===void 0?",":t)}});var wxe=Pw.PROPER,Sxe=Tt,Uj=VJ,zj="âÂá ",_xe=function(e){return Sxe(function(){return!!Uj[e]()||zj[e]()!==zj||wxe&&Uj[e].name!==e})},Cxe=pt,xxe=jJ.trim,Txe=_xe;Cxe({target:"String",proto:!0,forced:Txe("trim")},{trim:function(){return xxe(this)}});function PI(e){return PI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PI(e)}function _O(e){return window.requestAnimationFrame(e)}function yQ(){return!!document.documentElement.classList}function mQ(){return!!document.createTextNode("test").textContent}function bQ(){return!!window.getComputedStyle}function e0(e){window.cancelAnimationFrame(e)}function xF(){return"ontouchstart"in window}var II;function Oxe(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),II=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function TF(){return II===void 0&&Oxe(),II}var Th;function wQ(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Th||((typeof Intl>"u"?"undefined":PI(Intl))==="object"?Th=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?Th=function(n,i){return"".concat(n).localeCompare(i)}:Th=function(n,i){return n===i?0:n>i?-1:1},Th)}var Gg;function SQ(){if(Gg!==void 0)return Gg;try{var e={get passive(){Gg=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{Gg=!1}return Gg}const Exe=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:e0,getComparisonFunction:wQ,hasCaptionProblem:TF,isClassListSupported:yQ,isGetComputedStyleSupported:bQ,isPassiveEventSupported:SQ,isTextContentSupported:mQ,isTouchSupported:xF,requestAnimationFrame:_O},Symbol.toStringTag,{value:"Module"}));var Rxe=HL,kxe=FZ;Rxe("toPrimitive");kxe();var Axe=qr,Pxe=mZ,Ixe=TypeError,Mxe=function(e){if(Axe(this),e==="string"||e==="default")e="string";else if(e!=="number")throw Ixe("Incorrect hint");return Pxe(this,e)},Dxe=Wr,Nxe=Na,Lxe=Mxe,Fxe=Or,Gj=Fxe("toPrimitive"),Yj=Date.prototype;Dxe(Yj,Gj)||Nxe(Yj,Gj,Lxe);var $xe=sO,Hxe=wg,Bxe=TypeError,_Q=function(e){if($xe(e))return e;throw Bxe(Hxe(e)+" is not a constructor")},Kj=qr,Vxe=_Q,jxe=wo,Wxe=Or,Uxe=Wxe("species"),zxe=function(e,t){var r=Kj(e).constructor,n;return r===void 0||jxe(n=Kj(r)[Uxe])?t:Vxe(n)},Gxe=oh,Yg=gn,OF=Mt,Yxe=bO,Kxe=qr,Xxe=wo,qxe=bF,Xj=Hi,Zxe=zxe,Jxe=pF,Qxe=ih,BR=ln,eTe=th,qj=FL,Zj=wO,tTe=mO,rTe=vF,nTe=Tt,Oh=rTe.UNSUPPORTED_Y,Jj=4294967295,iTe=Math.min,CQ=[].push,aTe=OF(/./.exec),Eh=OF(CQ),Kg=OF("".slice),oTe=!nTe(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});Yxe("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var o=BR(Xj(this)),s=a===void 0?Jj:a>>>0;if(s===0)return[];if(i===void 0)return[o];if(!qxe(i))return Yg(t,o,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),f=0,c=new RegExp(i.source,u+"g"),h,d,v;(h=Yg(tTe,c,o))&&(d=c.lastIndex,!(d>f&&(Eh(l,Kg(o,f,h.index)),h.length>1&&h.index<o.length&&Gxe(CQ,l,qj(h,1)),v=h[0].length,f=d,l.length>=s)));)c.lastIndex===h.index&&c.lastIndex++;return f===o.length?(v||!aTe(c,""))&&Eh(l,""):Eh(l,Kg(o,f)),l.length>s?qj(l,0,s):l}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:Yg(t,this,i,a)}:n=t,[function(a,o){var s=Xj(this),l=Xxe(a)?void 0:eTe(a,e);return l?Yg(l,a,s,o):Yg(n,BR(s),a,o)},function(i,a){var o=Kxe(this),s=BR(i),l=r(n,o,s,a,n!==t);if(l.done)return l.value;var u=Zxe(o,RegExp),f=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(Oh?"g":"y"),h=new u(Oh?"^(?:"+o.source+")":o,c),d=a===void 0?Jj:a>>>0;if(d===0)return[];if(s.length===0)return Zj(h,s)===null?[s]:[];for(var v=0,p=0,g=[];p<s.length;){h.lastIndex=Oh?0:p;var y=Zj(h,Oh?Kg(s,p):s),m;if(y===null||(m=iTe(Qxe(h.lastIndex+(Oh?p:0)),s.length))===v)p=Jxe(s,p,f);else{if(Eh(g,Kg(s,v,p)),g.length===d)return g;for(var b=1;b<=y.length-1;b++)if(Eh(g,y[b]),g.length===d)return g;p=v=m}}return Eh(g,Kg(s,v)),g}]},!oTe,Oh);function xQ(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function MI(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function um(e){var t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;for(var r=e.length,n=e[0].length,i=0;i<r;i++)for(var a=0;a<n;a++)t[a]||(t[a]=[]),t[a][i]=e[i][a];return t}function Zr(e,t,r,n){var i=-1,a=e,o=r;Array.isArray(e)||(a=Array.from(e));var s=a.length;for(n&&s&&(i+=1,o=a[i]),i+=1;i<s;)o=t(o,a[i],i,a),i+=1;return o}function ra(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];t(s,r,n)&&(o+=1,a[o]=s),r+=1}return a}function At(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length,a=[],o=-1;r<i;){var s=n[r];o+=1,a[o]=t(s,r,n),r+=1}return a}function ne(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var i=n.length;r<i&&t(n[r],r,n)!==!1;)r+=1;return e}function TQ(e){return Zr(e,function(t,r){return t+r},0)}function sTe(e){return Zr(e,function(t,r){return t>r?t:r},Array.isArray(e)?e[0]:void 0)}function lTe(e){return Zr(e,function(t,r){return t<r?t:r},Array.isArray(e)?e[0]:void 0)}function uTe(e){return e.length?TQ(e)/e.length:0}function OQ(e){return Zr(e,function(t,r){return t.concat(Array.isArray(r)?OQ(r):r)},[])}function EF(e){var t=[];return ne(e,function(r){t.indexOf(r)===-1&&t.push(r)}),t}function DI(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ne(a,function(s){o=o.filter(function(l){return!s.includes(l)})}),o}function fTe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=i;return ne(a,function(s){o=o.filter(function(l){return s.includes(l)})}),o}function cTe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),i=n[0],a=n.slice(1),o=new Set(i);return ne(a,function(s){ne(s,function(l){o.has(l)||o.add(l)})}),Array.from(o)}function NI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}const hTe=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:uTe,arrayEach:ne,arrayFilter:ra,arrayFlatten:OQ,arrayMap:At,arrayMax:sTe,arrayMin:lTe,arrayReduce:Zr,arraySum:TQ,arrayUnique:EF,extendArray:MI,getDifferenceOfArrays:DI,getIntersectionOfArrays:fTe,getUnionOfArrays:cTe,pivot:um,stringToArray:NI,to2dArray:xQ},Symbol.toStringTag,{value:"Module"}));function Qj(e,t,r){return t=dTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dTe(e){var t=vTe(e,"string");return hl(t)==="symbol"?t:String(t)}function vTe(e,t){if(hl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hl(e){return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(e)}function av(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},It(e,function(r,n){n!=="__children"&&(r&&hl(r)==="object"&&!Array.isArray(r)?t[n]=av(r):Array.isArray(r)?r.length&&hl(r[0])==="object"&&!Array.isArray(r[0])?t[n]=[av(r[0])]:t[n]=[]:t[n]=null)})),t}function wl(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function an(e,t,r){var n=Array.isArray(r);return It(t,function(i,a){(n===!1||r.includes(a))&&(e[a]=i)}),e}function Yw(e,t){It(t,function(r,n){t[n]&&hl(t[n])==="object"?(e[n]||(Array.isArray(t[n])?e[n]=[]:Object.prototype.toString.call(t[n])==="[object Date]"?e[n]=t[n]:e[n]={}),Yw(e[n],t[n])):e[n]=t[n]})}function Xn(e){return hl(e)==="object"?JSON.parse(JSON.stringify(e)):e}function pi(e){var t={};return It(e,function(r,n){t[n]=r}),t}function yr(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ne(r,function(i){e.MIXINS.push(i.MIXIN_NAME),It(i,function(a,o){if(e.prototype[o]!==void 0)throw new Error("Mixin conflict. Property '".concat(o,"' already exist and cannot be overwritten."));if(typeof a=="function")e.prototype[o]=a;else{var s=function(f,c){var h="_".concat(f),d=function(p){var g=p;return(Array.isArray(g)||Pt(g))&&(g=Xn(g)),g};return function(){return this[h]===void 0&&(this[h]=d(c)),this[h]}},l=function(f){var c="_".concat(f);return function(h){this[c]=h}};Object.defineProperty(e.prototype,o,{get:s(o,a),set:l(o),configurable:!0})}})}),e}function RF(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Pt(e){return Object.prototype.toString.call(e)==="[object Object]"}function as(e,t,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(e,t,n)}function It(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function EQ(e,t){var r=t.split("."),n=e;return It(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function z1(e,t,r){var n=t.split("."),i=e;n.forEach(function(a,o){o!==n.length-1?(Vr(i,a)||(i[a]={}),i=i[a]):i[a]=r})}function CO(e){if(!Pt(e))return 0;var t=function r(n){var i=0;return Pt(n)?It(n,function(a,o){o!=="__children"&&(i+=r(a))}):i+=1,i};return t(e)}function Pc(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(t={_touched:!1},Qj(t,n,e),Qj(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(o){this._touched=!0,this[n]=o},enumerable:!0,configurable:!0}),i}function Vr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const pTe=Object.freeze(Object.defineProperty({__proto__:null,clone:pi,createObjectPropListener:Pc,deepClone:Xn,deepExtend:Yw,deepObjectSize:CO,defineGetter:as,duckSchema:av,extend:an,getProperty:EQ,hasOwnProperty:Vr,inherit:wl,isObject:Pt,isObjectEqual:RF,mixin:yr,objectEach:It,setProperty:z1},Symbol.toStringTag,{value:"Module"}));var Ai=function(t){var r={value:!1};return r.test=function(n,i){r.value=t(n,i)},r},na={chrome:Ai(function(e,t){return/Chrome/.test(e)&&/Google/.test(t)}),chromeWebKit:Ai(function(e){return/CriOS/.test(e)}),edge:Ai(function(e){return/Edge/.test(e)}),edgeWebKit:Ai(function(e){return/EdgiOS/.test(e)}),firefox:Ai(function(e){return/Firefox/.test(e)}),firefoxWebKit:Ai(function(e){return/FxiOS/.test(e)}),ie:Ai(function(e){return/Trident/.test(e)}),ie9:Ai(function(){return!!document.documentMode}),mobile:Ai(function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}),safari:Ai(function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)})},Tg={mac:Ai(function(e){return/^Mac/.test(e)}),win:Ai(function(e){return/^Win/.test(e)}),linux:Ai(function(e){return/^Linux/.test(e)}),ios:Ai(function(e){return/iPhone|iPad|iPod/i.test(e)})};function RQ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.userAgent,r=t===void 0?navigator.userAgent:t,n=e.vendor,i=n===void 0?navigator.vendor:n;It(na,function(a){var o=a.test;return void o(r,i)})}function kQ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.platform,r=t===void 0?navigator.platform:t;It(Tg,function(n){var i=n.test;return void i(r)})}RQ();kQ();function kF(){return na.chrome.value}function AQ(){return na.chromeWebKit.value}function G1(){return na.firefox.value}function PQ(){return na.firefoxWebKit.value}function IQ(){return na.safari.value}function MQ(){return na.edge.value}function gTe(){return na.edgeWebKit.value}function DQ(){return na.ie.value}function NQ(){return na.ie9.value}function yTe(){return na.ie.value||na.edge.value}function oo(){return na.mobile.value}function AF(){return Tg.ios.value}function PF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Tg.mac.value}function LI(){return Tg.win.value}function ZC(){return Tg.mac.value}function mTe(){return Tg.linux.value}const bTe=Object.freeze(Object.defineProperty({__proto__:null,isChrome:kF,isChromeWebKit:AQ,isEdge:MQ,isEdgeWebKit:gTe,isFirefox:G1,isFirefoxWebKit:PQ,isIE:DQ,isIE9:NQ,isIOS:AF,isIpadOS:PF,isLinuxOS:mTe,isMSBrowser:yTe,isMacOS:ZC,isMobileBrowser:oo,isSafari:IQ,isWindowsOS:LI,setBrowserMeta:RQ,setPlatformMeta:kQ},Symbol.toStringTag,{value:"Module"}));/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function Xl(e){return Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xl(e)}function FI(e,t){return FI=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},FI(e,t)}function wTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Y1(e,t,r){return wTe()?Y1=Reflect.construct:Y1=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&FI(u,o.prototype),u},Y1.apply(null,arguments)}function Xa(e){return STe(e)||_Te(e)||CTe(e)||xTe()}function STe(e){if(Array.isArray(e))return $I(e)}function _Te(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CTe(e,t){if(e){if(typeof e=="string")return $I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $I(e,t)}}function $I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var TTe=Object.hasOwnProperty,eW=Object.setPrototypeOf,OTe=Object.isFrozen,ETe=Object.getPrototypeOf,RTe=Object.getOwnPropertyDescriptor,bi=Object.freeze,po=Object.seal,kTe=Object.create,LQ=typeof Reflect<"u"&&Reflect,JC=LQ.apply,HI=LQ.construct;JC||(JC=function(t,r,n){return t.apply(r,n)});bi||(bi=function(t){return t});po||(po=function(t){return t});HI||(HI=function(t,r){return Y1(t,Xa(r))});var ATe=Pa(Array.prototype.forEach),tW=Pa(Array.prototype.pop),Xg=Pa(Array.prototype.push),K1=Pa(String.prototype.toLowerCase),VR=Pa(String.prototype.toString),PTe=Pa(String.prototype.match),ja=Pa(String.prototype.replace),ITe=Pa(String.prototype.indexOf),MTe=Pa(String.prototype.trim),ri=Pa(RegExp.prototype.test),jR=DTe(TypeError);function Pa(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return JC(e,t,n)}}function DTe(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return HI(e,r)}}function $t(e,t,r){r=r||K1,eW&&eW(e,null);for(var n=t.length;n--;){var i=t[n];if(typeof i=="string"){var a=r(i);a!==i&&(OTe(t)||(t[n]=a),i=a)}e[i]=!0}return e}function Zu(e){var t=kTe(null),r;for(r in e)JC(TTe,e,[r])===!0&&(t[r]=e[r]);return t}function zS(e,t){for(;e!==null;){var r=RTe(e,t);if(r){if(r.get)return Pa(r.get);if(typeof r.value=="function")return Pa(r.value)}e=ETe(e)}function n(i){return console.warn("fallback value for",i),null}return n}var rW=bi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),WR=bi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),UR=bi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),NTe=bi(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),zR=bi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),LTe=bi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nW=bi(["#text"]),iW=bi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),GR=bi(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),aW=bi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),GS=bi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),FTe=po(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$Te=po(/<%[\w\W]*|[\w\W]*%>/gm),HTe=po(/\${[\w\W]*}/gm),BTe=po(/^data-[\-\w.\u00B7-\uFFFF]/),VTe=po(/^aria-[\-\w]+$/),jTe=po(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),WTe=po(/^(?:\w+script|data):/i),UTe=po(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zTe=po(/^html$/i),GTe=function(){return typeof window>"u"?null:window},YTe=function(t,r){if(Xl(t)!=="object"||typeof t.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var a="dompurify"+(n?"#"+n:"");try{return t.createPolicy(a,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}};function FQ(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:GTe(),t=function(W){return FQ(W)};if(t.version="2.4.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var r=e.document,n=e.document,i=e.DocumentFragment,a=e.HTMLTemplateElement,o=e.Node,s=e.Element,l=e.NodeFilter,u=e.NamedNodeMap,f=u===void 0?e.NamedNodeMap||e.MozNamedAttrMap:u,c=e.HTMLFormElement,h=e.DOMParser,d=e.trustedTypes,v=s.prototype,p=zS(v,"cloneNode"),g=zS(v,"nextSibling"),y=zS(v,"childNodes"),m=zS(v,"parentNode");if(typeof a=="function"){var b=n.createElement("template");b.content&&b.content.ownerDocument&&(n=b.content.ownerDocument)}var S=YTe(d,r),x=S?S.createHTML(""):"",T=n,E=T.implementation,P=T.createNodeIterator,R=T.createDocumentFragment,M=T.getElementsByTagName,D=r.importNode,N={};try{N=Zu(n).documentMode?n.documentMode:{}}catch{}var B={};t.isSupported=typeof m=="function"&&E&&typeof E.createHTMLDocument<"u"&&N!==9;var K=FTe,Z=$Te,ie=HTe,me=BTe,k=VTe,w=WTe,C=UTe,O=jTe,_=null,A=$t({},[].concat(Xa(rW),Xa(WR),Xa(UR),Xa(zR),Xa(nW))),I=null,L=$t({},[].concat(Xa(iW),Xa(GR),Xa(aW),Xa(GS))),V=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Y=null,ae=null,re=!0,te=!0,ge=!1,H=!0,Ce=!1,oe=!1,Oe=!1,Ee=!1,be=!1,Ie=!1,Me=!1,j=!0,U=!1,Q="user-content-",fe=!0,ee=!1,pe={},se=null,ue=$t({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ce=null,ve=$t({},["audio","video","img","source","image","track"]),de=null,Te=$t({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Le="http://www.w3.org/1998/Math/MathML",$e="http://www.w3.org/2000/svg",it="http://www.w3.org/1999/xhtml",yt=it,Vt=!1,ut=null,ft=$t({},[Le,$e,it],VR),Et,Ft=["application/xhtml+xml","text/html"],Dt="text/html",wt,dt=null,Ke=n.createElement("form"),Be=function(W){return W instanceof RegExp||W instanceof Function},at=function(W){dt&&dt===W||((!W||Xl(W)!=="object")&&(W={}),W=Zu(W),Et=Ft.indexOf(W.PARSER_MEDIA_TYPE)===-1?Et=Dt:Et=W.PARSER_MEDIA_TYPE,wt=Et==="application/xhtml+xml"?VR:K1,_="ALLOWED_TAGS"in W?$t({},W.ALLOWED_TAGS,wt):A,I="ALLOWED_ATTR"in W?$t({},W.ALLOWED_ATTR,wt):L,ut="ALLOWED_NAMESPACES"in W?$t({},W.ALLOWED_NAMESPACES,VR):ft,de="ADD_URI_SAFE_ATTR"in W?$t(Zu(Te),W.ADD_URI_SAFE_ATTR,wt):Te,ce="ADD_DATA_URI_TAGS"in W?$t(Zu(ve),W.ADD_DATA_URI_TAGS,wt):ve,se="FORBID_CONTENTS"in W?$t({},W.FORBID_CONTENTS,wt):ue,Y="FORBID_TAGS"in W?$t({},W.FORBID_TAGS,wt):{},ae="FORBID_ATTR"in W?$t({},W.FORBID_ATTR,wt):{},pe="USE_PROFILES"in W?W.USE_PROFILES:!1,re=W.ALLOW_ARIA_ATTR!==!1,te=W.ALLOW_DATA_ATTR!==!1,ge=W.ALLOW_UNKNOWN_PROTOCOLS||!1,H=W.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ce=W.SAFE_FOR_TEMPLATES||!1,oe=W.WHOLE_DOCUMENT||!1,be=W.RETURN_DOM||!1,Ie=W.RETURN_DOM_FRAGMENT||!1,Me=W.RETURN_TRUSTED_TYPE||!1,Ee=W.FORCE_BODY||!1,j=W.SANITIZE_DOM!==!1,U=W.SANITIZE_NAMED_PROPS||!1,fe=W.KEEP_CONTENT!==!1,ee=W.IN_PLACE||!1,O=W.ALLOWED_URI_REGEXP||O,yt=W.NAMESPACE||it,V=W.CUSTOM_ELEMENT_HANDLING||{},W.CUSTOM_ELEMENT_HANDLING&&Be(W.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=W.CUSTOM_ELEMENT_HANDLING.tagNameCheck),W.CUSTOM_ELEMENT_HANDLING&&Be(W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),W.CUSTOM_ELEMENT_HANDLING&&typeof W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ce&&(te=!1),Ie&&(be=!0),pe&&(_=$t({},Xa(nW)),I=[],pe.html===!0&&($t(_,rW),$t(I,iW)),pe.svg===!0&&($t(_,WR),$t(I,GR),$t(I,GS)),pe.svgFilters===!0&&($t(_,UR),$t(I,GR),$t(I,GS)),pe.mathMl===!0&&($t(_,zR),$t(I,aW),$t(I,GS))),W.ADD_TAGS&&(_===A&&(_=Zu(_)),$t(_,W.ADD_TAGS,wt)),W.ADD_ATTR&&(I===L&&(I=Zu(I)),$t(I,W.ADD_ATTR,wt)),W.ADD_URI_SAFE_ATTR&&$t(de,W.ADD_URI_SAFE_ATTR,wt),W.FORBID_CONTENTS&&(se===ue&&(se=Zu(se)),$t(se,W.FORBID_CONTENTS,wt)),fe&&(_["#text"]=!0),oe&&$t(_,["html","head","body"]),_.table&&($t(_,["tbody"]),delete Y.tbody),bi&&bi(W),dt=W)},He=$t({},["mi","mo","mn","ms","mtext"]),ot=$t({},["foreignobject","desc","title","annotation-xml"]),We=$t({},["title","style","font","a","script"]),Je=$t({},WR);$t(Je,UR),$t(Je,NTe);var Wt=$t({},zR);$t(Wt,LTe);var Ut=function(W){var ye=m(W);(!ye||!ye.tagName)&&(ye={namespaceURI:yt,tagName:"template"});var _e=K1(W.tagName),Pe=K1(ye.tagName);return ut[W.namespaceURI]?W.namespaceURI===$e?ye.namespaceURI===it?_e==="svg":ye.namespaceURI===Le?_e==="svg"&&(Pe==="annotation-xml"||He[Pe]):!!Je[_e]:W.namespaceURI===Le?ye.namespaceURI===it?_e==="math":ye.namespaceURI===$e?_e==="math"&&ot[Pe]:!!Wt[_e]:W.namespaceURI===it?ye.namespaceURI===$e&&!ot[Pe]||ye.namespaceURI===Le&&!He[Pe]?!1:!Wt[_e]&&(We[_e]||!Je[_e]):!!(Et==="application/xhtml+xml"&&ut[W.namespaceURI]):!1},Jt=function(W){Xg(t.removed,{element:W});try{W.parentNode.removeChild(W)}catch{try{W.outerHTML=x}catch{W.remove()}}},kn=function(W,ye){try{Xg(t.removed,{attribute:ye.getAttributeNode(W),from:ye})}catch{Xg(t.removed,{attribute:null,from:ye})}if(ye.removeAttribute(W),W==="is"&&!I[W])if(be||Ie)try{Jt(ye)}catch{}else try{ye.setAttribute(W,"")}catch{}},dr=function(W){var ye,_e;if(Ee)W="<remove></remove>"+W;else{var Pe=PTe(W,/^[\r\n\t ]+/);_e=Pe&&Pe[0]}Et==="application/xhtml+xml"&&yt===it&&(W='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+W+"</body></html>");var Re=S?S.createHTML(W):W;if(yt===it)try{ye=new h().parseFromString(Re,Et)}catch{}if(!ye||!ye.documentElement){ye=E.createDocument(yt,"template",null);try{ye.documentElement.innerHTML=Vt?x:Re}catch{}}var Fe=ye.body||ye.documentElement;return W&&_e&&Fe.insertBefore(n.createTextNode(_e),Fe.childNodes[0]||null),yt===it?M.call(ye,oe?"html":"body")[0]:oe?ye.documentElement:Fe},F=function(W){return P.call(W.ownerDocument||W,W,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},X=function(W){return W instanceof c&&(typeof W.nodeName!="string"||typeof W.textContent!="string"||typeof W.removeChild!="function"||!(W.attributes instanceof f)||typeof W.removeAttribute!="function"||typeof W.setAttribute!="function"||typeof W.namespaceURI!="string"||typeof W.insertBefore!="function"||typeof W.hasChildNodes!="function")},z=function(W){return Xl(o)==="object"?W instanceof o:W&&Xl(W)==="object"&&typeof W.nodeType=="number"&&typeof W.nodeName=="string"},G=function(W,ye,_e){B[W]&&ATe(B[W],function(Pe){Pe.call(t,ye,_e,dt)})},q=function(W){var ye;if(G("beforeSanitizeElements",W,null),X(W)||ri(/[\u0080-\uFFFF]/,W.nodeName))return Jt(W),!0;var _e=wt(W.nodeName);if(G("uponSanitizeElement",W,{tagName:_e,allowedTags:_}),W.hasChildNodes()&&!z(W.firstElementChild)&&(!z(W.content)||!z(W.content.firstElementChild))&&ri(/<[/\w]/g,W.innerHTML)&&ri(/<[/\w]/g,W.textContent)||_e==="select"&&ri(/<template/i,W.innerHTML))return Jt(W),!0;if(!_[_e]||Y[_e]){if(!Y[_e]&&Se(_e)&&(V.tagNameCheck instanceof RegExp&&ri(V.tagNameCheck,_e)||V.tagNameCheck instanceof Function&&V.tagNameCheck(_e)))return!1;if(fe&&!se[_e]){var Pe=m(W)||W.parentNode,Re=y(W)||W.childNodes;if(Re&&Pe)for(var Fe=Re.length,nt=Fe-1;nt>=0;--nt)Pe.insertBefore(p(Re[nt],!0),g(W))}return Jt(W),!0}return W instanceof s&&!Ut(W)||(_e==="noscript"||_e==="noembed")&&ri(/<\/no(script|embed)/i,W.innerHTML)?(Jt(W),!0):(Ce&&W.nodeType===3&&(ye=W.textContent,ye=ja(ye,K," "),ye=ja(ye,Z," "),ye=ja(ye,ie," "),W.textContent!==ye&&(Xg(t.removed,{element:W.cloneNode()}),W.textContent=ye)),G("afterSanitizeElements",W,null),!1)},J=function(W,ye,_e){if(j&&(ye==="id"||ye==="name")&&(_e in n||_e in Ke))return!1;if(!(te&&!ae[ye]&&ri(me,ye))){if(!(re&&ri(k,ye))){if(!I[ye]||ae[ye]){if(!(Se(W)&&(V.tagNameCheck instanceof RegExp&&ri(V.tagNameCheck,W)||V.tagNameCheck instanceof Function&&V.tagNameCheck(W))&&(V.attributeNameCheck instanceof RegExp&&ri(V.attributeNameCheck,ye)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(ye))||ye==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&ri(V.tagNameCheck,_e)||V.tagNameCheck instanceof Function&&V.tagNameCheck(_e))))return!1}else if(!de[ye]){if(!ri(O,ja(_e,C,""))){if(!((ye==="src"||ye==="xlink:href"||ye==="href")&&W!=="script"&&ITe(_e,"data:")===0&&ce[W])){if(!(ge&&!ri(w,ja(_e,C,"")))){if(_e)return!1}}}}}}return!0},Se=function(W){return W.indexOf("-")>0},xe=function(W){var ye,_e,Pe,Re;G("beforeSanitizeAttributes",W,null);var Fe=W.attributes;if(Fe){var nt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};for(Re=Fe.length;Re--;){ye=Fe[Re];var vr=ye,Rt=vr.name,fn=vr.namespaceURI;if(_e=Rt==="value"?ye.value:MTe(ye.value),Pe=wt(Rt),nt.attrName=Pe,nt.attrValue=_e,nt.keepAttr=!0,nt.forceKeepAttr=void 0,G("uponSanitizeAttribute",W,nt),_e=nt.attrValue,!nt.forceKeepAttr&&(kn(Rt,W),!!nt.keepAttr)){if(!H&&ri(/\/>/i,_e)){kn(Rt,W);continue}Ce&&(_e=ja(_e,K," "),_e=ja(_e,Z," "),_e=ja(_e,ie," "));var El=wt(W.nodeName);if(J(El,Pe,_e)){if(U&&(Pe==="id"||Pe==="name")&&(kn(Rt,W),_e=Q+_e),S&&Xl(d)==="object"&&typeof d.getAttributeType=="function"&&!fn)switch(d.getAttributeType(El,Pe)){case"TrustedHTML":_e=S.createHTML(_e);break;case"TrustedScriptURL":_e=S.createScriptURL(_e);break}try{fn?W.setAttributeNS(fn,Rt,_e):W.setAttribute(Rt,_e),tW(t.removed)}catch{}}}}G("afterSanitizeAttributes",W,null)}},we=function he(W){var ye,_e=F(W);for(G("beforeSanitizeShadowDOM",W,null);ye=_e.nextNode();)G("uponSanitizeShadowNode",ye,null),!q(ye)&&(ye.content instanceof i&&he(ye.content),xe(ye));G("afterSanitizeShadowDOM",W,null)};return t.sanitize=function(he){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye,_e,Pe,Re,Fe;if(Vt=!he,Vt&&(he="<!-->"),typeof he!="string"&&!z(he)){if(typeof he.toString!="function")throw jR("toString is not a function");if(he=he.toString(),typeof he!="string")throw jR("dirty is not a string, aborting")}if(!t.isSupported){if(Xl(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof he=="string")return e.toStaticHTML(he);if(z(he))return e.toStaticHTML(he.outerHTML)}return he}if(Oe||at(W),t.removed=[],typeof he=="string"&&(ee=!1),ee){if(he.nodeName){var nt=wt(he.nodeName);if(!_[nt]||Y[nt])throw jR("root node is forbidden and cannot be sanitized in-place")}}else if(he instanceof o)ye=dr("<!---->"),_e=ye.ownerDocument.importNode(he,!0),_e.nodeType===1&&_e.nodeName==="BODY"||_e.nodeName==="HTML"?ye=_e:ye.appendChild(_e);else{if(!be&&!Ce&&!oe&&he.indexOf("<")===-1)return S&&Me?S.createHTML(he):he;if(ye=dr(he),!ye)return be?null:Me?x:""}ye&&Ee&&Jt(ye.firstChild);for(var vr=F(ee?he:ye);Pe=vr.nextNode();)Pe.nodeType===3&&Pe===Re||q(Pe)||(Pe.content instanceof i&&we(Pe.content),xe(Pe),Re=Pe);if(Re=null,ee)return he;if(be){if(Ie)for(Fe=R.call(ye.ownerDocument);ye.firstChild;)Fe.appendChild(ye.firstChild);else Fe=ye;return(I.shadowroot||I.shadowrootmod)&&(Fe=D.call(r,Fe,!0)),Fe}var Rt=oe?ye.outerHTML:ye.innerHTML;return oe&&_["!doctype"]&&ye.ownerDocument&&ye.ownerDocument.doctype&&ye.ownerDocument.doctype.name&&ri(zTe,ye.ownerDocument.doctype.name)&&(Rt="<!DOCTYPE "+ye.ownerDocument.doctype.name+`>
`+Rt),Ce&&(Rt=ja(Rt,K," "),Rt=ja(Rt,Z," "),Rt=ja(Rt,ie," ")),S&&Me?S.createHTML(Rt):Rt},t.setConfig=function(he){at(he),Oe=!0},t.clearConfig=function(){dt=null,Oe=!1},t.isValidAttribute=function(he,W,ye){dt||at({});var _e=wt(he),Pe=wt(W);return J(_e,Pe,ye)},t.addHook=function(he,W){typeof W=="function"&&(B[he]=B[he]||[],Xg(B[he],W))},t.removeHook=function(he){if(B[he])return tW(B[he])},t.removeHooks=function(he){B[he]&&(B[he]=[])},t.removeAllHooks=function(){B={}},t}var KTe=FQ(),XTe=pt,qTe=sF.codeAt;XTe({target:"String",proto:!0},{codePointAt:function(t){return qTe(this,t)}});var ZTe=Wu,JTe=ln,QTe=Hi,eOe=RangeError,$Q=function(t){var r=JTe(QTe(this)),n="",i=ZTe(t);if(i<0||i==1/0)throw eOe("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},HQ=Mt,tOe=ih,oW=ln,rOe=$Q,nOe=Hi,iOe=HQ(rOe),aOe=HQ("".slice),oOe=Math.ceil,sW=function(e){return function(t,r,n){var i=oW(nOe(t)),a=tOe(r),o=i.length,s=n===void 0?" ":oW(n),l,u;return a<=o||s==""?i:(l=a-o,u=iOe(s,oOe(l/s.length)),u.length>l&&(u=aOe(u,0,l)),e?i+u:u+i)}},sOe={start:sW(!1),end:sW(!0)},lOe=Qc,uOe=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(lOe),fOe=pt,cOe=sOe.start,hOe=uOe;fOe({target:"String",proto:!0,forced:hOe},{padStart:function(t){return cOe(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var BQ;function Ae(){return BQ.apply(null,arguments)}function dOe(e){BQ=e}function go(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function _c(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function rr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function IF(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(rr(e,t))return!1;return!0}function Ri(e){return e===void 0}function dl(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Kw(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function VQ(e,t){var r=[],n,i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function eu(e,t){for(var r in t)rr(t,r)&&(e[r]=t[r]);return rr(t,"toString")&&(e.toString=t.toString),rr(t,"valueOf")&&(e.valueOf=t.valueOf),e}function os(e,t,r,n){return cee(e,t,r,n,!0).utc()}function vOe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Nt(e){return e._pf==null&&(e._pf=vOe()),e._pf}var BI;Array.prototype.some?BI=Array.prototype.some:BI=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function MF(e){if(e._isValid==null){var t=Nt(e),r=BI.call(t.parsedDateParts,function(i){return i!=null}),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n}return e._isValid}function xO(e){var t=os(NaN);return e!=null?eu(Nt(t),e):Nt(t).userInvalidated=!0,t}var lW=Ae.momentProperties=[],YR=!1;function DF(e,t){var r,n,i,a=lW.length;if(Ri(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Ri(t._i)||(e._i=t._i),Ri(t._f)||(e._f=t._f),Ri(t._l)||(e._l=t._l),Ri(t._strict)||(e._strict=t._strict),Ri(t._tzm)||(e._tzm=t._tzm),Ri(t._isUTC)||(e._isUTC=t._isUTC),Ri(t._offset)||(e._offset=t._offset),Ri(t._pf)||(e._pf=Nt(t)),Ri(t._locale)||(e._locale=t._locale),a>0)for(r=0;r<a;r++)n=lW[r],i=t[n],Ri(i)||(e[n]=i);return e}function Xw(e){DF(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),YR===!1&&(YR=!0,Ae.updateOffset(this),YR=!1)}function yo(e){return e instanceof Xw||e!=null&&e._isAMomentObject!=null}function jQ(e){Ae.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Fa(e,t){var r=!0;return eu(function(){if(Ae.deprecationHandler!=null&&Ae.deprecationHandler(null,e),r){var n=[],i,a,o,s=arguments.length;for(a=0;a<s;a++){if(i="",typeof arguments[a]=="object"){i+=`
[`+a+"] ";for(o in arguments[0])rr(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[a];n.push(i)}jQ(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var uW={};function WQ(e,t){Ae.deprecationHandler!=null&&Ae.deprecationHandler(e,t),uW[e]||(jQ(t),uW[e]=!0)}Ae.suppressDeprecationWarnings=!1;Ae.deprecationHandler=null;function ss(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function pOe(e){var t,r;for(r in e)rr(e,r)&&(t=e[r],ss(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function VI(e,t){var r=eu({},e),n;for(n in t)rr(t,n)&&(_c(e[n])&&_c(t[n])?(r[n]={},eu(r[n],e[n]),eu(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)rr(e,n)&&!rr(t,n)&&_c(e[n])&&(r[n]=eu({},r[n]));return r}function NF(e){e!=null&&this.set(e)}var jI;Object.keys?jI=Object.keys:jI=function(e){var t,r=[];for(t in e)rr(e,t)&&r.push(t);return r};var gOe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function yOe(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return ss(n)?n.call(t,r):n}function es(e,t,r){var n=""+Math.abs(e),i=t-n.length,a=e>=0;return(a?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var LF=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,YS=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,KR={},Md={};function lt(e,t,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),e&&(Md[e]=i),t&&(Md[t[0]]=function(){return es(i.apply(this,arguments),t[1],t[2])}),r&&(Md[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function mOe(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function bOe(e){var t=e.match(LF),r,n;for(r=0,n=t.length;r<n;r++)Md[t[r]]?t[r]=Md[t[r]]:t[r]=mOe(t[r]);return function(i){var a="",o;for(o=0;o<n;o++)a+=ss(t[o])?t[o].call(i,e):t[o];return a}}function X1(e,t){return e.isValid()?(t=UQ(t,e.localeData()),KR[t]=KR[t]||bOe(t),KR[t](e)):e.localeData().invalidDate()}function UQ(e,t){var r=5;function n(i){return t.longDateFormat(i)||i}for(YS.lastIndex=0;r>=0&&YS.test(e);)e=e.replace(YS,n),YS.lastIndex=0,r-=1;return e}var wOe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function SOe(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(LF).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var _Oe="Invalid date";function COe(){return this._invalidDate}var xOe="%d",TOe=/\d{1,2}/;function OOe(e){return this._ordinal.replace("%d",e)}var EOe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ROe(e,t,r,n){var i=this._relativeTime[r];return ss(i)?i(e,t,r,n):i.replace(/%d/i,e)}function kOe(e,t){var r=this._relativeTime[e>0?"future":"past"];return ss(r)?r(t):r.replace(/%s/i,t)}var fm={};function Qn(e,t){var r=e.toLowerCase();fm[r]=fm[r+"s"]=fm[t]=e}function $a(e){return typeof e=="string"?fm[e]||fm[e.toLowerCase()]:void 0}function FF(e){var t={},r,n;for(n in e)rr(e,n)&&(r=$a(n),r&&(t[r]=e[n]));return t}var zQ={};function ei(e,t){zQ[e]=t}function AOe(e){var t=[],r;for(r in e)rr(e,r)&&t.push({unit:r,priority:zQ[r]});return t.sort(function(n,i){return n.priority-i.priority}),t}function TO(e){return e%4===0&&e%100!==0||e%400===0}function Sa(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function jt(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Sa(t)),r}function Og(e,t){return function(r){return r!=null?(GQ(this,e,r),Ae.updateOffset(this,t),this):QC(this,e)}}function QC(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function GQ(e,t,r){e.isValid()&&!isNaN(r)&&(t==="FullYear"&&TO(e.year())&&e.month()===1&&e.date()===29?(r=jt(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),PO(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function POe(e){return e=$a(e),ss(this[e])?this[e]():this}function IOe(e,t){if(typeof e=="object"){e=FF(e);var r=AOe(e),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(e=$a(e),ss(this[e]))return this[e](t);return this}var YQ=/\d/,sa=/\d\d/,KQ=/\d{3}/,$F=/\d{4}/,OO=/[+-]?\d{6}/,Ir=/\d\d?/,XQ=/\d\d\d\d?/,qQ=/\d\d\d\d\d\d?/,EO=/\d{1,3}/,HF=/\d{1,4}/,RO=/[+-]?\d{1,6}/,Eg=/\d+/,kO=/[+-]?\d+/,MOe=/Z|[+-]\d\d:?\d\d/gi,AO=/Z|[+-]\d\d(?::?\d\d)?/gi,DOe=/[+-]?\d+(\.\d{1,3})?/,qw=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ex;ex={};function tt(e,t,r){ex[e]=ss(t)?t:function(n,i){return n&&r?r:t}}function NOe(e,t){return rr(ex,e)?ex[e](t._strict,t._locale):new RegExp(LOe(e))}function LOe(e){return Ki(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,i,a){return r||n||i||a}))}function Ki(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var WI={};function mr(e,t){var r,n=t,i;for(typeof e=="string"&&(e=[e]),dl(t)&&(n=function(a,o){o[t]=jt(a)}),i=e.length,r=0;r<i;r++)WI[e[r]]=n}function Zw(e,t){mr(e,function(r,n,i,a){i._w=i._w||{},t(r,i._w,i,a)})}function FOe(e,t,r){t!=null&&rr(WI,e)&&WI[e](t,r._a,r,e)}var Yn=0,ks=1,Uo=2,bn=3,so=4,As=5,Wf=6,$Oe=7,HOe=8;function BOe(e,t){return(e%t+t)%t}var tn;Array.prototype.indexOf?tn=Array.prototype.indexOf:tn=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function PO(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=BOe(t,12);return e+=(t-r)/12,r===1?TO(e)?29:28:31-r%7%2}lt("M",["MM",2],"Mo",function(){return this.month()+1});lt("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});lt("MMMM",0,0,function(e){return this.localeData().months(this,e)});Qn("month","M");ei("month",8);tt("M",Ir);tt("MM",Ir,sa);tt("MMM",function(e,t){return t.monthsShortRegex(e)});tt("MMMM",function(e,t){return t.monthsRegex(e)});mr(["M","MM"],function(e,t){t[ks]=jt(e)-1});mr(["MMM","MMMM"],function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);i!=null?t[ks]=i:Nt(r).invalidMonth=e});var VOe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ZQ="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),JQ=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,jOe=qw,WOe=qw;function UOe(e,t){return e?go(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||JQ).test(t)?"format":"standalone"][e.month()]:go(this._months)?this._months:this._months.standalone}function zOe(e,t){return e?go(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[JQ.test(t)?"format":"standalone"][e.month()]:go(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function GOe(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=os([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return r?t==="MMM"?(i=tn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=tn.call(this._longMonthsParse,o),i!==-1?i:null):t==="MMM"?(i=tn.call(this._shortMonthsParse,o),i!==-1?i:(i=tn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=tn.call(this._longMonthsParse,o),i!==-1?i:(i=tn.call(this._shortMonthsParse,o),i!==-1?i:null))}function YOe(e,t,r){var n,i,a;if(this._monthsParseExact)return GOe.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=os([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function QQ(e,t){var r;if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=jt(t);else if(t=e.localeData().monthsParse(t),!dl(t))return e}return r=Math.min(e.date(),PO(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function eee(e){return e!=null?(QQ(this,e),Ae.updateOffset(this,!0),this):QC(this,"Month")}function KOe(){return PO(this.year(),this.month())}function XOe(e){return this._monthsParseExact?(rr(this,"_monthsRegex")||tee.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(rr(this,"_monthsShortRegex")||(this._monthsShortRegex=jOe),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function qOe(e){return this._monthsParseExact?(rr(this,"_monthsRegex")||tee.call(this),e?this._monthsStrictRegex:this._monthsRegex):(rr(this,"_monthsRegex")||(this._monthsRegex=WOe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function tee(){function e(o,s){return s.length-o.length}var t=[],r=[],n=[],i,a;for(i=0;i<12;i++)a=os([2e3,i]),t.push(this.monthsShort(a,"")),r.push(this.months(a,"")),n.push(this.months(a,"")),n.push(this.monthsShort(a,""));for(t.sort(e),r.sort(e),n.sort(e),i=0;i<12;i++)t[i]=Ki(t[i]),r[i]=Ki(r[i]);for(i=0;i<24;i++)n[i]=Ki(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}lt("Y",0,0,function(){var e=this.year();return e<=9999?es(e,4):"+"+e});lt(0,["YY",2],0,function(){return this.year()%100});lt(0,["YYYY",4],0,"year");lt(0,["YYYYY",5],0,"year");lt(0,["YYYYYY",6,!0],0,"year");Qn("year","y");ei("year",1);tt("Y",kO);tt("YY",Ir,sa);tt("YYYY",HF,$F);tt("YYYYY",RO,OO);tt("YYYYYY",RO,OO);mr(["YYYYY","YYYYYY"],Yn);mr("YYYY",function(e,t){t[Yn]=e.length===2?Ae.parseTwoDigitYear(e):jt(e)});mr("YY",function(e,t){t[Yn]=Ae.parseTwoDigitYear(e)});mr("Y",function(e,t){t[Yn]=parseInt(e,10)});function cm(e){return TO(e)?366:365}Ae.parseTwoDigitYear=function(e){return jt(e)+(jt(e)>68?1900:2e3)};var ree=Og("FullYear",!0);function ZOe(){return TO(this.year())}function JOe(e,t,r,n,i,a,o){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,i,a,o),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,i,a,o),s}function t0(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function tx(e,t,r){var n=7+t-r,i=(7+t0(e,0,n).getUTCDay()-t)%7;return-i+n-1}function nee(e,t,r,n,i){var a=(7+r-n)%7,o=tx(e,n,i),s=1+7*(t-1)+a+o,l,u;return s<=0?(l=e-1,u=cm(l)+s):s>cm(e)?(l=e+1,u=s-cm(e)):(l=e,u=s),{year:l,dayOfYear:u}}function r0(e,t,r){var n=tx(e.year(),t,r),i=Math.floor((e.dayOfYear()-n-1)/7)+1,a,o;return i<1?(o=e.year()-1,a=i+al(o,t,r)):i>al(e.year(),t,r)?(a=i-al(e.year(),t,r),o=e.year()+1):(o=e.year(),a=i),{week:a,year:o}}function al(e,t,r){var n=tx(e,t,r),i=tx(e+1,t,r);return(cm(e)-n+i)/7}lt("w",["ww",2],"wo","week");lt("W",["WW",2],"Wo","isoWeek");Qn("week","w");Qn("isoWeek","W");ei("week",5);ei("isoWeek",5);tt("w",Ir);tt("ww",Ir,sa);tt("W",Ir);tt("WW",Ir,sa);Zw(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=jt(e)});function QOe(e){return r0(e,this._week.dow,this._week.doy).week}var eEe={dow:0,doy:6};function tEe(){return this._week.dow}function rEe(){return this._week.doy}function nEe(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function iEe(e){var t=r0(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}lt("d",0,"do","day");lt("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});lt("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});lt("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});lt("e",0,0,"weekday");lt("E",0,0,"isoWeekday");Qn("day","d");Qn("weekday","e");Qn("isoWeekday","E");ei("day",11);ei("weekday",11);ei("isoWeekday",11);tt("d",Ir);tt("e",Ir);tt("E",Ir);tt("dd",function(e,t){return t.weekdaysMinRegex(e)});tt("ddd",function(e,t){return t.weekdaysShortRegex(e)});tt("dddd",function(e,t){return t.weekdaysRegex(e)});Zw(["dd","ddd","dddd"],function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);i!=null?t.d=i:Nt(r).invalidWeekday=e});Zw(["d","e","E"],function(e,t,r,n){t[n]=jt(e)});function aEe(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function oEe(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function BF(e,t){return e.slice(t,7).concat(e.slice(0,t))}var sEe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),iee="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),lEe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),uEe=qw,fEe=qw,cEe=qw;function hEe(e,t){var r=go(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?BF(r,this._week.dow):e?r[e.day()]:r}function dEe(e){return e===!0?BF(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function vEe(e){return e===!0?BF(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function pEe(e,t,r){var n,i,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=os([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return r?t==="dddd"?(i=tn.call(this._weekdaysParse,o),i!==-1?i:null):t==="ddd"?(i=tn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=tn.call(this._minWeekdaysParse,o),i!==-1?i:null):t==="dddd"?(i=tn.call(this._weekdaysParse,o),i!==-1||(i=tn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,o),i!==-1?i:null)):t==="ddd"?(i=tn.call(this._shortWeekdaysParse,o),i!==-1||(i=tn.call(this._weekdaysParse,o),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=tn.call(this._minWeekdaysParse,o),i!==-1||(i=tn.call(this._weekdaysParse,o),i!==-1)?i:(i=tn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function gEe(e,t,r){var n,i,a;if(this._weekdaysParseExact)return pEe.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=os([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function yEe(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=aEe(e,this.localeData()),this.add(e-t,"d")):t}function mEe(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function bEe(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=oEe(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function wEe(e){return this._weekdaysParseExact?(rr(this,"_weekdaysRegex")||VF.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(rr(this,"_weekdaysRegex")||(this._weekdaysRegex=uEe),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function SEe(e){return this._weekdaysParseExact?(rr(this,"_weekdaysRegex")||VF.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(rr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=fEe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function _Ee(e){return this._weekdaysParseExact?(rr(this,"_weekdaysRegex")||VF.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(rr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=cEe),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function VF(){function e(f,c){return c.length-f.length}var t=[],r=[],n=[],i=[],a,o,s,l,u;for(a=0;a<7;a++)o=os([2e3,1]).day(a),s=Ki(this.weekdaysMin(o,"")),l=Ki(this.weekdaysShort(o,"")),u=Ki(this.weekdays(o,"")),t.push(s),r.push(l),n.push(u),i.push(s),i.push(l),i.push(u);t.sort(e),r.sort(e),n.sort(e),i.sort(e),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function jF(){return this.hours()%12||12}function CEe(){return this.hours()||24}lt("H",["HH",2],0,"hour");lt("h",["hh",2],0,jF);lt("k",["kk",2],0,CEe);lt("hmm",0,0,function(){return""+jF.apply(this)+es(this.minutes(),2)});lt("hmmss",0,0,function(){return""+jF.apply(this)+es(this.minutes(),2)+es(this.seconds(),2)});lt("Hmm",0,0,function(){return""+this.hours()+es(this.minutes(),2)});lt("Hmmss",0,0,function(){return""+this.hours()+es(this.minutes(),2)+es(this.seconds(),2)});function aee(e,t){lt(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}aee("a",!0);aee("A",!1);Qn("hour","h");ei("hour",13);function oee(e,t){return t._meridiemParse}tt("a",oee);tt("A",oee);tt("H",Ir);tt("h",Ir);tt("k",Ir);tt("HH",Ir,sa);tt("hh",Ir,sa);tt("kk",Ir,sa);tt("hmm",XQ);tt("hmmss",qQ);tt("Hmm",XQ);tt("Hmmss",qQ);mr(["H","HH"],bn);mr(["k","kk"],function(e,t,r){var n=jt(e);t[bn]=n===24?0:n});mr(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});mr(["h","hh"],function(e,t,r){t[bn]=jt(e),Nt(r).bigHour=!0});mr("hmm",function(e,t,r){var n=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n)),Nt(r).bigHour=!0});mr("hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n,2)),t[As]=jt(e.substr(i)),Nt(r).bigHour=!0});mr("Hmm",function(e,t,r){var n=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n))});mr("Hmmss",function(e,t,r){var n=e.length-4,i=e.length-2;t[bn]=jt(e.substr(0,n)),t[so]=jt(e.substr(n,2)),t[As]=jt(e.substr(i))});function xEe(e){return(e+"").toLowerCase().charAt(0)==="p"}var TEe=/[ap]\.?m?\.?/i,OEe=Og("Hours",!0);function EEe(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var see={calendar:gOe,longDateFormat:wOe,invalidDate:_Oe,ordinal:xOe,dayOfMonthOrdinalParse:TOe,relativeTime:EOe,months:VOe,monthsShort:ZQ,week:eEe,weekdays:sEe,weekdaysMin:lEe,weekdaysShort:iee,meridiemParse:TEe},Mr={},qg={},n0;function REe(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function fW(e){return e&&e.toLowerCase().replace("_","-")}function kEe(e){for(var t=0,r,n,i,a;t<e.length;){for(a=fW(e[t]).split("-"),r=a.length,n=fW(e[t+1]),n=n?n.split("-"):null;r>0;){if(i=IO(a.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&REe(a,n)>=r-1)break;r--}t++}return n0}function AEe(e){return e.match("^[^/\\\\]*$")!=null}function IO(e){var t=null,r;if(Mr[e]===void 0&&typeof module<"u"&&module&&module.exports&&AEe(e))try{t=n0._abbr,r=require,r("./locale/"+e),fu(t)}catch{Mr[e]=null}return Mr[e]}function fu(e,t){var r;return e&&(Ri(t)?r=Sl(e):r=WF(e,t),r?n0=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),n0._abbr}function WF(e,t){if(t!==null){var r,n=see;if(t.abbr=e,Mr[e]!=null)WQ("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Mr[e]._config;else if(t.parentLocale!=null)if(Mr[t.parentLocale]!=null)n=Mr[t.parentLocale]._config;else if(r=IO(t.parentLocale),r!=null)n=r._config;else return qg[t.parentLocale]||(qg[t.parentLocale]=[]),qg[t.parentLocale].push({name:e,config:t}),null;return Mr[e]=new NF(VI(n,t)),qg[e]&&qg[e].forEach(function(i){WF(i.name,i.config)}),fu(e),Mr[e]}else return delete Mr[e],null}function PEe(e,t){if(t!=null){var r,n,i=see;Mr[e]!=null&&Mr[e].parentLocale!=null?Mr[e].set(VI(Mr[e]._config,t)):(n=IO(e),n!=null&&(i=n._config),t=VI(i,t),n==null&&(t.abbr=e),r=new NF(t),r.parentLocale=Mr[e],Mr[e]=r),fu(e)}else Mr[e]!=null&&(Mr[e].parentLocale!=null?(Mr[e]=Mr[e].parentLocale,e===fu()&&fu(e)):Mr[e]!=null&&delete Mr[e]);return Mr[e]}function Sl(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return n0;if(!go(e)){if(t=IO(e),t)return t;e=[e]}return kEe(e)}function IEe(){return jI(Mr)}function UF(e){var t,r=e._a;return r&&Nt(e).overflow===-2&&(t=r[ks]<0||r[ks]>11?ks:r[Uo]<1||r[Uo]>PO(r[Yn],r[ks])?Uo:r[bn]<0||r[bn]>24||r[bn]===24&&(r[so]!==0||r[As]!==0||r[Wf]!==0)?bn:r[so]<0||r[so]>59?so:r[As]<0||r[As]>59?As:r[Wf]<0||r[Wf]>999?Wf:-1,Nt(e)._overflowDayOfYear&&(t<Yn||t>Uo)&&(t=Uo),Nt(e)._overflowWeeks&&t===-1&&(t=$Oe),Nt(e)._overflowWeekday&&t===-1&&(t=HOe),Nt(e).overflow=t),e}var MEe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,DEe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,NEe=/Z|[+-]\d\d(?::?\d\d)?/,KS=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],XR=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],LEe=/^\/?Date\((-?\d+)/i,FEe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,$Ee={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function lee(e){var t,r,n=e._i,i=MEe.exec(n)||DEe.exec(n),a,o,s,l,u=KS.length,f=XR.length;if(i){for(Nt(e).iso=!0,t=0,r=u;t<r;t++)if(KS[t][1].exec(i[1])){o=KS[t][0],a=KS[t][2]!==!1;break}if(o==null){e._isValid=!1;return}if(i[3]){for(t=0,r=f;t<r;t++)if(XR[t][1].exec(i[3])){s=(i[2]||" ")+XR[t][0];break}if(s==null){e._isValid=!1;return}}if(!a&&s!=null){e._isValid=!1;return}if(i[4])if(NEe.exec(i[4]))l="Z";else{e._isValid=!1;return}e._f=o+(s||"")+(l||""),GF(e)}else e._isValid=!1}function HEe(e,t,r,n,i,a){var o=[BEe(e),ZQ.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return a&&o.push(parseInt(a,10)),o}function BEe(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function VEe(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function jEe(e,t,r){if(e){var n=iee.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(n!==i)return Nt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function WEe(e,t,r){if(e)return $Ee[e];if(t)return 0;var n=parseInt(r,10),i=n%100,a=(n-i)/100;return a*60+i}function uee(e){var t=FEe.exec(VEe(e._i)),r;if(t){if(r=HEe(t[4],t[3],t[2],t[5],t[6],t[7]),!jEe(t[1],r,e))return;e._a=r,e._tzm=WEe(t[8],t[9],t[10]),e._d=t0.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Nt(e).rfc2822=!0}else e._isValid=!1}function UEe(e){var t=LEe.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(lee(e),e._isValid===!1)delete e._isValid;else return;if(uee(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Ae.createFromInputFallback(e)}Ae.createFromInputFallback=Fa("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function pd(e,t,r){return e??t??r}function zEe(e){var t=new Date(Ae.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function zF(e){var t,r,n=[],i,a,o;if(!e._d){for(i=zEe(e),e._w&&e._a[Uo]==null&&e._a[ks]==null&&GEe(e),e._dayOfYear!=null&&(o=pd(e._a[Yn],i[Yn]),(e._dayOfYear>cm(o)||e._dayOfYear===0)&&(Nt(e)._overflowDayOfYear=!0),r=t0(o,0,e._dayOfYear),e._a[ks]=r.getUTCMonth(),e._a[Uo]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=i[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[bn]===24&&e._a[so]===0&&e._a[As]===0&&e._a[Wf]===0&&(e._nextDay=!0,e._a[bn]=0),e._d=(e._useUTC?t0:JOe).apply(null,n),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[bn]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==a&&(Nt(e).weekdayMismatch=!0)}}function GEe(e){var t,r,n,i,a,o,s,l,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(a=1,o=4,r=pd(t.GG,e._a[Yn],r0(Ar(),1,4).year),n=pd(t.W,1),i=pd(t.E,1),(i<1||i>7)&&(l=!0)):(a=e._locale._week.dow,o=e._locale._week.doy,u=r0(Ar(),a,o),r=pd(t.gg,e._a[Yn],u.year),n=pd(t.w,u.week),t.d!=null?(i=t.d,(i<0||i>6)&&(l=!0)):t.e!=null?(i=t.e+a,(t.e<0||t.e>6)&&(l=!0)):i=a),n<1||n>al(r,a,o)?Nt(e)._overflowWeeks=!0:l!=null?Nt(e)._overflowWeekday=!0:(s=nee(r,n,i,a,o),e._a[Yn]=s.year,e._dayOfYear=s.dayOfYear)}Ae.ISO_8601=function(){};Ae.RFC_2822=function(){};function GF(e){if(e._f===Ae.ISO_8601){lee(e);return}if(e._f===Ae.RFC_2822){uee(e);return}e._a=[],Nt(e).empty=!0;var t=""+e._i,r,n,i,a,o,s=t.length,l=0,u,f;for(i=UQ(e._f,e._locale).match(LF)||[],f=i.length,r=0;r<f;r++)a=i[r],n=(t.match(NOe(a,e))||[])[0],n&&(o=t.substr(0,t.indexOf(n)),o.length>0&&Nt(e).unusedInput.push(o),t=t.slice(t.indexOf(n)+n.length),l+=n.length),Md[a]?(n?Nt(e).empty=!1:Nt(e).unusedTokens.push(a),FOe(a,n,e)):e._strict&&!n&&Nt(e).unusedTokens.push(a);Nt(e).charsLeftOver=s-l,t.length>0&&Nt(e).unusedInput.push(t),e._a[bn]<=12&&Nt(e).bigHour===!0&&e._a[bn]>0&&(Nt(e).bigHour=void 0),Nt(e).parsedDateParts=e._a.slice(0),Nt(e).meridiem=e._meridiem,e._a[bn]=YEe(e._locale,e._a[bn],e._meridiem),u=Nt(e).era,u!==null&&(e._a[Yn]=e._locale.erasConvertYear(u,e._a[Yn])),zF(e),UF(e)}function YEe(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function KEe(e){var t,r,n,i,a,o,s=!1,l=e._f.length;if(l===0){Nt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<l;i++)a=0,o=!1,t=DF({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[i],GF(t),MF(t)&&(o=!0),a+=Nt(t).charsLeftOver,a+=Nt(t).unusedTokens.length*10,Nt(t).score=a,s?a<n&&(n=a,r=t):(n==null||a<n||o)&&(n=a,r=t,o&&(s=!0));eu(e,r||t)}function XEe(e){if(!e._d){var t=FF(e._i),r=t.day===void 0?t.date:t.day;e._a=VQ([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),zF(e)}}function qEe(e){var t=new Xw(UF(fee(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function fee(e){var t=e._i,r=e._f;return e._locale=e._locale||Sl(e._l),t===null||r===void 0&&t===""?xO({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),yo(t)?new Xw(UF(t)):(Kw(t)?e._d=t:go(r)?KEe(e):r?GF(e):ZEe(e),MF(e)||(e._d=null),e))}function ZEe(e){var t=e._i;Ri(t)?e._d=new Date(Ae.now()):Kw(t)?e._d=new Date(t.valueOf()):typeof t=="string"?UEe(e):go(t)?(e._a=VQ(t.slice(0),function(r){return parseInt(r,10)}),zF(e)):_c(t)?XEe(e):dl(t)?e._d=new Date(t):Ae.createFromInputFallback(e)}function cee(e,t,r,n,i){var a={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(_c(e)&&IF(e)||go(e)&&e.length===0)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=r,a._i=e,a._f=t,a._strict=n,qEe(a)}function Ar(e,t,r,n){return cee(e,t,r,n,!1)}var JEe=Fa("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ar.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:xO()}),QEe=Fa("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ar.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:xO()});function hee(e,t){var r,n;if(t.length===1&&go(t[0])&&(t=t[0]),!t.length)return Ar();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function eRe(){var e=[].slice.call(arguments,0);return hee("isBefore",e)}function tRe(){var e=[].slice.call(arguments,0);return hee("isAfter",e)}var rRe=function(){return Date.now?Date.now():+new Date},Zg=["year","quarter","month","week","day","hour","minute","second","millisecond"];function nRe(e){var t,r=!1,n,i=Zg.length;for(t in e)if(rr(e,t)&&!(tn.call(Zg,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<i;++n)if(e[Zg[n]]){if(r)return!1;parseFloat(e[Zg[n]])!==jt(e[Zg[n]])&&(r=!0)}return!0}function iRe(){return this._isValid}function aRe(){return So(NaN)}function MO(e){var t=FF(e),r=t.year||0,n=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,f=t.millisecond||0;this._isValid=nRe(t),this._milliseconds=+f+u*1e3+l*6e4+s*1e3*60*60,this._days=+o+a*7,this._months=+i+n*3+r*12,this._data={},this._locale=Sl(),this._bubble()}function q1(e){return e instanceof MO}function UI(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function oRe(e,t,r){var n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0,o;for(o=0;o<n;o++)(r&&e[o]!==t[o]||!r&&jt(e[o])!==jt(t[o]))&&a++;return a+i}function dee(e,t){lt(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+es(~~(r/60),2)+t+es(~~r%60,2)})}dee("Z",":");dee("ZZ","");tt("Z",AO);tt("ZZ",AO);mr(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=YF(AO,e)});var sRe=/([\+\-]|\d\d)/gi;function YF(e,t){var r=(t||"").match(e),n,i,a;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(sRe)||["-",0,0],a=+(i[1]*60)+jt(i[2]),a===0?0:i[0]==="+"?a:-a)}function KF(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(yo(e)||Kw(e)?e.valueOf():Ar(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ae.updateOffset(r,!1),r):Ar(e).local()}function zI(e){return-Math.round(e._d.getTimezoneOffset())}Ae.updateOffset=function(){};function lRe(e,t,r){var n=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=YF(AO,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(i=zI(this)),this._offset=e,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==e&&(!t||this._changeInProgress?gee(this,So(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ae.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:zI(this)}function uRe(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function fRe(e){return this.utcOffset(0,e)}function cRe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(zI(this),"m")),this}function hRe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=YF(MOe,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function dRe(e){return this.isValid()?(e=e?Ar(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function vRe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function pRe(){if(!Ri(this._isDSTShifted))return this._isDSTShifted;var e={},t;return DF(e,this),e=fee(e),e._a?(t=e._isUTC?os(e._a):Ar(e._a),this._isDSTShifted=this.isValid()&&oRe(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function gRe(){return this.isValid()?!this._isUTC:!1}function yRe(){return this.isValid()?this._isUTC:!1}function vee(){return this.isValid()?this._isUTC&&this._offset===0:!1}var mRe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,bRe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function So(e,t){var r=e,n=null,i,a,o;return q1(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:dl(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=mRe.exec(e))?(i=n[1]==="-"?-1:1,r={y:0,d:jt(n[Uo])*i,h:jt(n[bn])*i,m:jt(n[so])*i,s:jt(n[As])*i,ms:jt(UI(n[Wf]*1e3))*i}):(n=bRe.exec(e))?(i=n[1]==="-"?-1:1,r={y:Ju(n[2],i),M:Ju(n[3],i),w:Ju(n[4],i),d:Ju(n[5],i),h:Ju(n[6],i),m:Ju(n[7],i),s:Ju(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=wRe(Ar(r.from),Ar(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),a=new MO(r),q1(e)&&rr(e,"_locale")&&(a._locale=e._locale),q1(e)&&rr(e,"_isValid")&&(a._isValid=e._isValid),a}So.fn=MO.prototype;So.invalid=aRe;function Ju(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function cW(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function wRe(e,t){var r;return e.isValid()&&t.isValid()?(t=KF(t,e),e.isBefore(t)?r=cW(e,t):(r=cW(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function pee(e,t){return function(r,n){var i,a;return n!==null&&!isNaN(+n)&&(WQ(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=r,r=n,n=a),i=So(r,n),gee(this,i,e),this}}function gee(e,t,r,n){var i=t._milliseconds,a=UI(t._days),o=UI(t._months);e.isValid()&&(n=n??!0,o&&QQ(e,QC(e,"Month")+o*r),a&&GQ(e,"Date",QC(e,"Date")+a*r),i&&e._d.setTime(e._d.valueOf()+i*r),n&&Ae.updateOffset(e,a||o))}var SRe=pee(1,"add"),_Re=pee(-1,"subtract");function yee(e){return typeof e=="string"||e instanceof String}function CRe(e){return yo(e)||Kw(e)||yee(e)||dl(e)||TRe(e)||xRe(e)||e===null||e===void 0}function xRe(e){var t=_c(e)&&!IF(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,a,o=n.length;for(i=0;i<o;i+=1)a=n[i],r=r||rr(e,a);return t&&r}function TRe(e){var t=go(e),r=!1;return t&&(r=e.filter(function(n){return!dl(n)&&yee(e)}).length===0),t&&r}function ORe(e){var t=_c(e)&&!IF(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,a;for(i=0;i<n.length;i+=1)a=n[i],r=r||rr(e,a);return t&&r}function ERe(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function RRe(e,t){arguments.length===1&&(arguments[0]?CRe(arguments[0])?(e=arguments[0],t=void 0):ORe(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Ar(),n=KF(r,this).startOf("day"),i=Ae.calendarFormat(this,n)||"sameElse",a=t&&(ss(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,Ar(r)))}function kRe(){return new Xw(this)}function ARe(e,t){var r=yo(e)?e:Ar(e);return this.isValid()&&r.isValid()?(t=$a(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function PRe(e,t){var r=yo(e)?e:Ar(e);return this.isValid()&&r.isValid()?(t=$a(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function IRe(e,t,r,n){var i=yo(e)?e:Ar(e),a=yo(t)?t:Ar(t);return this.isValid()&&i.isValid()&&a.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(a,r):!this.isAfter(a,r))):!1}function MRe(e,t){var r=yo(e)?e:Ar(e),n;return this.isValid()&&r.isValid()?(t=$a(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function DRe(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function NRe(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function LRe(e,t,r){var n,i,a;if(!this.isValid())return NaN;if(n=KF(e,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,t=$a(t),t){case"year":a=Z1(this,n)/12;break;case"month":a=Z1(this,n);break;case"quarter":a=Z1(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return r?a:Sa(a)}function Z1(e,t){if(e.date()<t.date())return-Z1(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),i,a;return t-n<0?(i=e.clone().add(r-1,"months"),a=(t-n)/(n-i)):(i=e.clone().add(r+1,"months"),a=(t-n)/(i-n)),-(r+a)||0}Ae.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ae.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function FRe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function $Re(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?X1(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ss(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",X1(r,"Z")):X1(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function HRe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,i,a;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",a=t+'[")]',this.format(r+n+i+a)}function BRe(e){e||(e=this.isUtc()?Ae.defaultFormatUtc:Ae.defaultFormat);var t=X1(this,e);return this.localeData().postformat(t)}function VRe(e,t){return this.isValid()&&(yo(e)&&e.isValid()||Ar(e).isValid())?So({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function jRe(e){return this.from(Ar(),e)}function WRe(e,t){return this.isValid()&&(yo(e)&&e.isValid()||Ar(e).isValid())?So({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function URe(e){return this.to(Ar(),e)}function mee(e){var t;return e===void 0?this._locale._abbr:(t=Sl(e),t!=null&&(this._locale=t),this)}var bee=Fa("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function wee(){return this._locale}var rx=1e3,Dd=60*rx,nx=60*Dd,See=(365*400+97)*24*nx;function Nd(e,t){return(e%t+t)%t}function _ee(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-See:new Date(e,t,r).valueOf()}function Cee(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-See:Date.UTC(e,t,r)}function zRe(e){var t,r;if(e=$a(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Cee:_ee,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Nd(t+(this._isUTC?0:this.utcOffset()*Dd),nx);break;case"minute":t=this._d.valueOf(),t-=Nd(t,Dd);break;case"second":t=this._d.valueOf(),t-=Nd(t,rx);break}return this._d.setTime(t),Ae.updateOffset(this,!0),this}function GRe(e){var t,r;if(e=$a(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Cee:_ee,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=nx-Nd(t+(this._isUTC?0:this.utcOffset()*Dd),nx)-1;break;case"minute":t=this._d.valueOf(),t+=Dd-Nd(t,Dd)-1;break;case"second":t=this._d.valueOf(),t+=rx-Nd(t,rx)-1;break}return this._d.setTime(t),Ae.updateOffset(this,!0),this}function YRe(){return this._d.valueOf()-(this._offset||0)*6e4}function KRe(){return Math.floor(this.valueOf()/1e3)}function XRe(){return new Date(this.valueOf())}function qRe(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function ZRe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function JRe(){return this.isValid()?this.toISOString():null}function QRe(){return MF(this)}function eke(){return eu({},Nt(this))}function tke(){return Nt(this).overflow}function rke(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}lt("N",0,0,"eraAbbr");lt("NN",0,0,"eraAbbr");lt("NNN",0,0,"eraAbbr");lt("NNNN",0,0,"eraName");lt("NNNNN",0,0,"eraNarrow");lt("y",["y",1],"yo","eraYear");lt("y",["yy",2],0,"eraYear");lt("y",["yyy",3],0,"eraYear");lt("y",["yyyy",4],0,"eraYear");tt("N",XF);tt("NN",XF);tt("NNN",XF);tt("NNNN",dke);tt("NNNNN",vke);mr(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?Nt(r).era=i:Nt(r).invalidEra=e});tt("y",Eg);tt("yy",Eg);tt("yyy",Eg);tt("yyyy",Eg);tt("yo",pke);mr(["y","yy","yyy","yyyy"],Yn);mr(["yo"],function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Yn]=r._locale.eraYearOrdinalParse(e,i):t[Yn]=parseInt(e,10)});function nke(e,t){var r,n,i,a=this._eras||Sl("en")._eras;for(r=0,n=a.length;r<n;++r){switch(typeof a[r].since){case"string":i=Ae(a[r].since).startOf("day"),a[r].since=i.valueOf();break}switch(typeof a[r].until){case"undefined":a[r].until=1/0;break;case"string":i=Ae(a[r].until).startOf("day").valueOf(),a[r].until=i.valueOf();break}}return a}function ike(e,t,r){var n,i,a=this.eras(),o,s,l;for(e=e.toUpperCase(),n=0,i=a.length;n<i;++n)if(o=a[n].name.toUpperCase(),s=a[n].abbr.toUpperCase(),l=a[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return a[n];break;case"NNNN":if(o===e)return a[n];break;case"NNNNN":if(l===e)return a[n];break}else if([o,s,l].indexOf(e)>=0)return a[n]}function ake(e,t){var r=e.since<=e.until?1:-1;return t===void 0?Ae(e.since).year():Ae(e.since).year()+(t-e.offset)*r}function oke(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function ske(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function lke(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function uke(){var e,t,r,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(r=i[e].since<=i[e].until?1:-1,n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until||i[e].until<=n&&n<=i[e].since)return(this.year()-Ae(i[e].since).year())*r+i[e].offset;return this.year()}function fke(e){return rr(this,"_erasNameRegex")||qF.call(this),e?this._erasNameRegex:this._erasRegex}function cke(e){return rr(this,"_erasAbbrRegex")||qF.call(this),e?this._erasAbbrRegex:this._erasRegex}function hke(e){return rr(this,"_erasNarrowRegex")||qF.call(this),e?this._erasNarrowRegex:this._erasRegex}function XF(e,t){return t.erasAbbrRegex(e)}function dke(e,t){return t.erasNameRegex(e)}function vke(e,t){return t.erasNarrowRegex(e)}function pke(e,t){return t._eraYearOrdinalRegex||Eg}function qF(){var e=[],t=[],r=[],n=[],i,a,o=this.eras();for(i=0,a=o.length;i<a;++i)t.push(Ki(o[i].name)),e.push(Ki(o[i].abbr)),r.push(Ki(o[i].narrow)),n.push(Ki(o[i].name)),n.push(Ki(o[i].abbr)),n.push(Ki(o[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}lt(0,["gg",2],0,function(){return this.weekYear()%100});lt(0,["GG",2],0,function(){return this.isoWeekYear()%100});function DO(e,t){lt(0,[e,e.length],0,t)}DO("gggg","weekYear");DO("ggggg","weekYear");DO("GGGG","isoWeekYear");DO("GGGGG","isoWeekYear");Qn("weekYear","gg");Qn("isoWeekYear","GG");ei("weekYear",1);ei("isoWeekYear",1);tt("G",kO);tt("g",kO);tt("GG",Ir,sa);tt("gg",Ir,sa);tt("GGGG",HF,$F);tt("gggg",HF,$F);tt("GGGGG",RO,OO);tt("ggggg",RO,OO);Zw(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=jt(e)});Zw(["gg","GG"],function(e,t,r,n){t[n]=Ae.parseTwoDigitYear(e)});function gke(e){return xee.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function yke(e){return xee.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function mke(){return al(this.year(),1,4)}function bke(){return al(this.isoWeekYear(),1,4)}function wke(){var e=this.localeData()._week;return al(this.year(),e.dow,e.doy)}function Ske(){var e=this.localeData()._week;return al(this.weekYear(),e.dow,e.doy)}function xee(e,t,r,n,i){var a;return e==null?r0(this,n,i).year:(a=al(e,n,i),t>a&&(t=a),_ke.call(this,e,t,r,n,i))}function _ke(e,t,r,n,i){var a=nee(e,t,r,n,i),o=t0(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}lt("Q",0,"Qo","quarter");Qn("quarter","Q");ei("quarter",7);tt("Q",YQ);mr("Q",function(e,t){t[ks]=(jt(e)-1)*3});function Cke(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}lt("D",["DD",2],"Do","date");Qn("date","D");ei("date",9);tt("D",Ir);tt("DD",Ir,sa);tt("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});mr(["D","DD"],Uo);mr("Do",function(e,t){t[Uo]=jt(e.match(Ir)[0])});var Tee=Og("Date",!0);lt("DDD",["DDDD",3],"DDDo","dayOfYear");Qn("dayOfYear","DDD");ei("dayOfYear",4);tt("DDD",EO);tt("DDDD",KQ);mr(["DDD","DDDD"],function(e,t,r){r._dayOfYear=jt(e)});function xke(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}lt("m",["mm",2],0,"minute");Qn("minute","m");ei("minute",14);tt("m",Ir);tt("mm",Ir,sa);mr(["m","mm"],so);var Tke=Og("Minutes",!1);lt("s",["ss",2],0,"second");Qn("second","s");ei("second",15);tt("s",Ir);tt("ss",Ir,sa);mr(["s","ss"],As);var Oke=Og("Seconds",!1);lt("S",0,0,function(){return~~(this.millisecond()/100)});lt(0,["SS",2],0,function(){return~~(this.millisecond()/10)});lt(0,["SSS",3],0,"millisecond");lt(0,["SSSS",4],0,function(){return this.millisecond()*10});lt(0,["SSSSS",5],0,function(){return this.millisecond()*100});lt(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});lt(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});lt(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});lt(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Qn("millisecond","ms");ei("millisecond",16);tt("S",EO,YQ);tt("SS",EO,sa);tt("SSS",EO,KQ);var tu,Oee;for(tu="SSSS";tu.length<=9;tu+="S")tt(tu,Eg);function Eke(e,t){t[Wf]=jt(("0."+e)*1e3)}for(tu="S";tu.length<=9;tu+="S")mr(tu,Eke);Oee=Og("Milliseconds",!1);lt("z",0,0,"zoneAbbr");lt("zz",0,0,"zoneName");function Rke(){return this._isUTC?"UTC":""}function kke(){return this._isUTC?"Coordinated Universal Time":""}var De=Xw.prototype;De.add=SRe;De.calendar=RRe;De.clone=kRe;De.diff=LRe;De.endOf=GRe;De.format=BRe;De.from=VRe;De.fromNow=jRe;De.to=WRe;De.toNow=URe;De.get=POe;De.invalidAt=tke;De.isAfter=ARe;De.isBefore=PRe;De.isBetween=IRe;De.isSame=MRe;De.isSameOrAfter=DRe;De.isSameOrBefore=NRe;De.isValid=QRe;De.lang=bee;De.locale=mee;De.localeData=wee;De.max=QEe;De.min=JEe;De.parsingFlags=eke;De.set=IOe;De.startOf=zRe;De.subtract=_Re;De.toArray=qRe;De.toObject=ZRe;De.toDate=XRe;De.toISOString=$Re;De.inspect=HRe;typeof Symbol<"u"&&Symbol.for!=null&&(De[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});De.toJSON=JRe;De.toString=FRe;De.unix=KRe;De.valueOf=YRe;De.creationData=rke;De.eraName=oke;De.eraNarrow=ske;De.eraAbbr=lke;De.eraYear=uke;De.year=ree;De.isLeapYear=ZOe;De.weekYear=gke;De.isoWeekYear=yke;De.quarter=De.quarters=Cke;De.month=eee;De.daysInMonth=KOe;De.week=De.weeks=nEe;De.isoWeek=De.isoWeeks=iEe;De.weeksInYear=wke;De.weeksInWeekYear=Ske;De.isoWeeksInYear=mke;De.isoWeeksInISOWeekYear=bke;De.date=Tee;De.day=De.days=yEe;De.weekday=mEe;De.isoWeekday=bEe;De.dayOfYear=xke;De.hour=De.hours=OEe;De.minute=De.minutes=Tke;De.second=De.seconds=Oke;De.millisecond=De.milliseconds=Oee;De.utcOffset=lRe;De.utc=fRe;De.local=cRe;De.parseZone=hRe;De.hasAlignedHourOffset=dRe;De.isDST=vRe;De.isLocal=gRe;De.isUtcOffset=yRe;De.isUtc=vee;De.isUTC=vee;De.zoneAbbr=Rke;De.zoneName=kke;De.dates=Fa("dates accessor is deprecated. Use date instead.",Tee);De.months=Fa("months accessor is deprecated. Use month instead",eee);De.years=Fa("years accessor is deprecated. Use year instead",ree);De.zone=Fa("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",uRe);De.isDSTShifted=Fa("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",pRe);function Ake(e){return Ar(e*1e3)}function Pke(){return Ar.apply(null,arguments).parseZone()}function Eee(e){return e}var nr=NF.prototype;nr.calendar=yOe;nr.longDateFormat=SOe;nr.invalidDate=COe;nr.ordinal=OOe;nr.preparse=Eee;nr.postformat=Eee;nr.relativeTime=ROe;nr.pastFuture=kOe;nr.set=pOe;nr.eras=nke;nr.erasParse=ike;nr.erasConvertYear=ake;nr.erasAbbrRegex=cke;nr.erasNameRegex=fke;nr.erasNarrowRegex=hke;nr.months=UOe;nr.monthsShort=zOe;nr.monthsParse=YOe;nr.monthsRegex=qOe;nr.monthsShortRegex=XOe;nr.week=QOe;nr.firstDayOfYear=rEe;nr.firstDayOfWeek=tEe;nr.weekdays=hEe;nr.weekdaysMin=vEe;nr.weekdaysShort=dEe;nr.weekdaysParse=gEe;nr.weekdaysRegex=wEe;nr.weekdaysShortRegex=SEe;nr.weekdaysMinRegex=_Ee;nr.isPM=xEe;nr.meridiem=EEe;function ix(e,t,r,n){var i=Sl(),a=os().set(n,t);return i[r](a,e)}function Ree(e,t,r){if(dl(e)&&(t=e,e=void 0),e=e||"",t!=null)return ix(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=ix(e,n,r,"month");return i}function ZF(e,t,r,n){typeof e=="boolean"?(dl(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,dl(t)&&(r=t,t=void 0),t=t||"");var i=Sl(),a=e?i._week.dow:0,o,s=[];if(r!=null)return ix(t,(r+a)%7,n,"day");for(o=0;o<7;o++)s[o]=ix(t,(o+a)%7,n,"day");return s}function Ike(e,t){return Ree(e,t,"months")}function Mke(e,t){return Ree(e,t,"monthsShort")}function Dke(e,t,r){return ZF(e,t,r,"weekdays")}function Nke(e,t,r){return ZF(e,t,r,"weekdaysShort")}function Lke(e,t,r){return ZF(e,t,r,"weekdaysMin")}fu("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=jt(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});Ae.lang=Fa("moment.lang is deprecated. Use moment.locale instead.",fu);Ae.langData=Fa("moment.langData is deprecated. Use moment.localeData instead.",Sl);var vs=Math.abs;function Fke(){var e=this._data;return this._milliseconds=vs(this._milliseconds),this._days=vs(this._days),this._months=vs(this._months),e.milliseconds=vs(e.milliseconds),e.seconds=vs(e.seconds),e.minutes=vs(e.minutes),e.hours=vs(e.hours),e.months=vs(e.months),e.years=vs(e.years),this}function kee(e,t,r,n){var i=So(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function $ke(e,t){return kee(this,e,t,1)}function Hke(e,t){return kee(this,e,t,-1)}function hW(e){return e<0?Math.floor(e):Math.ceil(e)}function Bke(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,i,a,o,s,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=hW(GI(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,i=Sa(e/1e3),n.seconds=i%60,a=Sa(i/60),n.minutes=a%60,o=Sa(a/60),n.hours=o%24,t+=Sa(o/24),l=Sa(Aee(t)),r+=l,t-=hW(GI(l)),s=Sa(r/12),r%=12,n.days=t,n.months=r,n.years=s,this}function Aee(e){return e*4800/146097}function GI(e){return e*146097/4800}function Vke(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=$a(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+Aee(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(GI(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function jke(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+jt(this._months/12)*31536e6:NaN}function _l(e){return function(){return this.as(e)}}var Wke=_l("ms"),Uke=_l("s"),zke=_l("m"),Gke=_l("h"),Yke=_l("d"),Kke=_l("w"),Xke=_l("M"),qke=_l("Q"),Zke=_l("y");function Jke(){return So(this)}function Qke(e){return e=$a(e),this.isValid()?this[e+"s"]():NaN}function sh(e){return function(){return this.isValid()?this._data[e]:NaN}}var eAe=sh("milliseconds"),tAe=sh("seconds"),rAe=sh("minutes"),nAe=sh("hours"),iAe=sh("days"),aAe=sh("months"),oAe=sh("years");function sAe(){return Sa(this.days()/7)}var Cs=Math.round,Cd={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function lAe(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function uAe(e,t,r,n){var i=So(e).abs(),a=Cs(i.as("s")),o=Cs(i.as("m")),s=Cs(i.as("h")),l=Cs(i.as("d")),u=Cs(i.as("M")),f=Cs(i.as("w")),c=Cs(i.as("y")),h=a<=r.ss&&["s",a]||a<r.s&&["ss",a]||o<=1&&["m"]||o<r.m&&["mm",o]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||c<=1&&["y"]||["yy",c],h[2]=t,h[3]=+e>0,h[4]=n,lAe.apply(null,h)}function fAe(e){return e===void 0?Cs:typeof e=="function"?(Cs=e,!0):!1}function cAe(e,t){return Cd[e]===void 0?!1:t===void 0?Cd[e]:(Cd[e]=t,e==="s"&&(Cd.ss=t-1),!0)}function hAe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Cd,i,a;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Cd,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),i=this.localeData(),a=uAe(this,!r,n,i),r&&(a=i.pastFuture(+this,a)),i.postformat(a)}var qR=Math.abs;function Rh(e){return(e>0)-(e<0)||+e}function NO(){if(!this.isValid())return this.localeData().invalidDate();var e=qR(this._milliseconds)/1e3,t=qR(this._days),r=qR(this._months),n,i,a,o,s=this.asSeconds(),l,u,f,c;return s?(n=Sa(e/60),i=Sa(n/60),e%=60,n%=60,a=Sa(r/12),r%=12,o=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=Rh(this._months)!==Rh(s)?"-":"",f=Rh(this._days)!==Rh(s)?"-":"",c=Rh(this._milliseconds)!==Rh(s)?"-":"",l+"P"+(a?u+a+"Y":"")+(r?u+r+"M":"")+(t?f+t+"D":"")+(i||n||e?"T":"")+(i?c+i+"H":"")+(n?c+n+"M":"")+(e?c+o+"S":"")):"P0D"}var Zt=MO.prototype;Zt.isValid=iRe;Zt.abs=Fke;Zt.add=$ke;Zt.subtract=Hke;Zt.as=Vke;Zt.asMilliseconds=Wke;Zt.asSeconds=Uke;Zt.asMinutes=zke;Zt.asHours=Gke;Zt.asDays=Yke;Zt.asWeeks=Kke;Zt.asMonths=Xke;Zt.asQuarters=qke;Zt.asYears=Zke;Zt.valueOf=jke;Zt._bubble=Bke;Zt.clone=Jke;Zt.get=Qke;Zt.milliseconds=eAe;Zt.seconds=tAe;Zt.minutes=rAe;Zt.hours=nAe;Zt.days=iAe;Zt.weeks=sAe;Zt.months=aAe;Zt.years=oAe;Zt.humanize=hAe;Zt.toISOString=NO;Zt.toString=NO;Zt.toJSON=NO;Zt.locale=mee;Zt.localeData=wee;Zt.toIsoString=Fa("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",NO);Zt.lang=bee;lt("X",0,0,"unix");lt("x",0,0,"valueOf");tt("x",kO);tt("X",DOe);mr("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});mr("x",function(e,t,r){r._d=new Date(jt(e))});//! moment.js
Ae.version="2.29.4";dOe(Ar);Ae.fn=De;Ae.min=eRe;Ae.max=tRe;Ae.now=rRe;Ae.utc=os;Ae.unix=Ake;Ae.months=Ike;Ae.isDate=Kw;Ae.locale=fu;Ae.invalid=xO;Ae.duration=So;Ae.isMoment=yo;Ae.weekdays=Dke;Ae.parseZone=Pke;Ae.localeData=Sl;Ae.isDuration=q1;Ae.monthsShort=Mke;Ae.weekdaysMin=Lke;Ae.defineLocale=WF;Ae.updateLocale=PEe;Ae.locales=IEe;Ae.weekdaysShort=Nke;Ae.normalizeUnits=$a;Ae.relativeTimeRounding=fAe;Ae.relativeTimeThreshold=cAe;Ae.calendarFormat=ERe;Ae.prototype=De;Ae.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const dAe=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"}));function sr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=Zr(e,function(a,o,s){var l=o.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return a+l+u},"");return i.trim()}var dW,vW,pW,gW,yW,mW;function Ld(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function YI(e){return YI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YI(e)}function jr(e){var t;switch(YI(e)){case"string":case"number":t="".concat(e);break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function Xe(e){return typeof e<"u"}function pr(e){return typeof e>"u"}function pn(e){return e===null||e===""||pr(e)}function Pee(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var Wy="length",hm=function(t){return parseInt(t,16)},bW=function(t){return parseInt(t,10)},ax=function(t,r,n){return t.substr(r,n)},dm=function(t){return t.codePointAt(0)-65},KI=function(t){return"".concat(t).replace(/\-/g,"")},vAe=function(t){return hm(ax(KI(t),hm("12"),dm("F")))/(hm(ax(KI(t),dm("B"),~~![][Wy]))||9)},pAe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},wW=!1,SW={invalid:function(){return sr(dW||(dW=Ld([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return sr(vW||(vW=Ld([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return sr(pW||(pW=Ld([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},_W={invalid:function(){return sr(gW||(gW=Ld([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var r=t.keyValidityDate,n=t.hotVersion;return sr(yW||(yW=Ld([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return sr(mW||(mW=Ld([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function Iee(e,t){var r=!pn(e),n=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",a,o="invalid",s="invalid";e=KI(e||"");var l=gAe(e);if(r||n||l)if(l){var u=Ae("28/03/2023","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),c=vAe(e);a=Ae((c+1)*864e5,"x").format("MMMM DD, YYYY"),f>c?(o="expired",s="expired"):(o="valid",s="valid")}else n?(o="non_commercial",s="valid"):(o="invalid",s="invalid");else o="missing",s="missing";if(pAe()&&(o="valid",s="valid"),!wW&&o!=="valid"){var h=SW[o]({keyValidityDate:a,hotVersion:i});h&&console[o==="non_commercial"?"info":"warn"](SW[o]({keyValidityDate:a,hotVersion:i})),wW=!0}if(s!=="valid"&&t.parentNode){var d=_W[s]({keyValidityDate:a,hotVersion:i});if(d){var v=document.createElement("div");v.className="hot-display-license-info",v.innerHTML=_W[s]({keyValidityDate:a,hotVersion:i}),t.parentNode.insertBefore(v,t.nextSibling)}}}function gAe(e){var t=[][Wy],r=t;if(e[Wy]!==dm("Z"))return!1;for(var n="",i="B<H4P+".split(""),a=dm(i.shift());a;a=dm(i.shift()||"A"))--a<""[Wy]?r=r|(bW("".concat(bW(hm(n)+(hm(ax(e,Math.abs(a),2))+[]).padStart(2,"0"))))%97||2)>>1:n=ax(e,a,a?i[Wy]===1?9:8:6);return r===t}const yAe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Iee,isDefined:Xe,isEmpty:pn,isRegExp:Pee,isUndefined:pr,stringify:jr},Symbol.toStringTag,{value:"Module"}));function Ni(e){return e[0].toUpperCase()+e.substr(1)}function mAe(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=r.length;i;){i-=1;var a=jr(r[i]).toLowerCase();e.indexOf(a)===-1&&e.push(a)}return e.length===1}function JF(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function QF(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function e$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):t[n]===void 0?"":t[n]})}function XI(e){return LO("".concat(e),{ALLOWED_TAGS:[]})}function LO(e,t){return KTe.sanitize(e,t)}const bAe=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:mAe,isPercentValue:QF,randomString:JF,sanitize:LO,stripTags:XI,substitute:e$,toUpperCaseFirst:Ni},Symbol.toStringTag,{value:"Module"}));function CW(e){return CAe(e)||_Ae(e)||SAe(e)||wAe()}function wAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SAe(e,t){if(e){if(typeof e=="string")return qI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qI(e,t)}}function _Ae(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function CAe(e){if(Array.isArray(e))return qI(e)}function qI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mee(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=e;i!==null;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Dee(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function i0(e){return Dee(e)&&e.parent}function xAe(e){return!!Object.getPrototypeOf(e.parent)}function cu(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,a=n.DOCUMENT_FRAGMENT_NODE,o=e;o!=null&&o!==r;){var s=o,l=s.nodeType,u=s.nodeName;if(l===i&&(t.includes(u)||t.includes(o)))return o;var f=o,c=f.host;c&&l===a?o=c:o=o.parentNode}return null}function Uy(e,t,r){for(var n=[],i=e;i&&(i=cu(i,t,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var a=n.length;return a?n[a-1]:null}function hu(e,t){var r=e.parentNode,n=[];for(typeof t=="string"?e.defaultView?n=Array.prototype.slice.call(e.querySelectorAll(t),0):n=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function Nee(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function zl(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}var ZI,JI,QI;function XS(e){return!e||!e.length?[]:e.filter(function(t){return!!t})}if(yQ()){var xW=function(t){var r=t.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};ZI=function(t,r){return t.classList===void 0||typeof r!="string"||r===""?!1:t.classList.contains(r)},JI=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=XS(i),i.length>0)if(xW(n)){var a;(a=t.classList).add.apply(a,CW(i))}else for(var o=0;i[o];)t.classList.add(i[o]),o+=1},QI=function(t,r){var n=t.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=XS(i),i.length>0)if(xW(n)){var a;(a=t.classList).remove.apply(a,CW(i))}else for(var o=0;i[o];)t.classList.remove(i[o]),o+=1}}else{var ZR=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};ZI=function(t,r){return t.className!==void 0&&ZR(r).test(t.className)},JI=function(t,r){var n=t.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=XS(i),n==="")n=i.join(" ");else for(var a=0;a<i.length;a++)i[a]&&!ZR(i[a]).test(n)&&(n+=" ".concat(i[a]));t.className=n},QI=function(t,r){var n=0,i=t.className,a=r;for(typeof a=="string"&&(a=a.split(" ")),a=XS(a);a[n];)i=i.replace(ZR(a[n])," ").trim(),n+=1;t.className!==i&&(t.className=i)}}function bt(e,t){return ZI(e,t)}function ke(e,t){JI(e,t)}function St(e,t){QI(e,t)}function t$(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)t$(t[r])}function mo(e){for(var t;t=e.lastChild;)e.removeChild(t)}var Lee=/(<(.*)>|&(.*);)/;function lh(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Lee.test(t)?e.innerHTML=r?LO(t):t:ku(e,t)}function ku(e,t){var r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?mQ?r.textContent=t:r.data=t:(mo(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function ov(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ov(r.host.impl);if(r.host)return ov(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function nn(e){var t=e.ownerDocument,r=t.defaultView,n=t.documentElement,i=e,a,o,s,l;if(TF()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(a=i.offsetLeft,o=i.offsetTop,s=i;(i=i.offsetParent)&&i!==t.body;)a+=i.offsetLeft,o+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(a+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:a,top:o}}function sv(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollY;return t===void 0&&(t=e.document.documentElement.scrollTop),t}function Ic(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.scrollX;return t===void 0&&(t=e.document.documentElement.scrollLeft),t}function a0(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?sv(t):e.scrollTop}function ox(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?Ic(t):e.scrollLeft}function o0(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);for(var n=["auto","scroll"],i=bQ(),a=e.parentNode;a&&a.style&&t.body!==a;){var o=a.style,s=o.overflow,l=o.overflowX,u=o.overflowY;if([s,l,u].includes("scroll"))return a;if(i){var f=r.getComputedStyle(a);if(s=f.overflow,l=f.overflowX,u=f.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return a}if(a.clientHeight<=a.scrollHeight+1&&(n.includes(u)||n.includes(s))||a.clientWidth<=a.scrollWidth+1&&(n.includes(l)||n.includes(s)))return a;a=a.parentNode}return r}function lv(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Au(n,r),a=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(a.includes(o)||a.includes(s)||a.includes(l))return n;n=n.parentNode}return r}function uv(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?"".concat(r.innerWidth,"px"):t==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=e.style[t];if(n!==""&&n!==void 0)return n;var i=Au(e,r);if(i[t]!==""&&i[t]!==void 0)return i[t]}function TAe(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function Au(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function cr(e){return e.offsetWidth}function Nr(e){return TF()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function Ps(e){return e.clientHeight||e.innerHeight}function vm(e){return e.clientWidth||e.innerWidth}function OAe(e,t,r){e.addEventListener(t,r,!1)}function EAe(e,t,r){e.removeEventListener(t,r,!1)}function r$(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function Fee(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();if(r===null)return 0;var n=e.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function $ee(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function eM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Jw(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{var n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}var JR;function RAe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}function Sn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return JR===void 0&&(JR=RAe(e)),JR}function Hee(e){return e.offsetWidth!==e.clientWidth}function Bee(e){return e.offsetHeight!==e.clientHeight}function FO(e,t,r){NQ()?(e.style.top=r,e.style.left=t):IQ()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function kAe(e){var t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:e.style["-webkit-transform"]&&(t=e.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function Qw(e){e.style.transform&&e.style.transform!==""?e.style.transform="":e.style["-webkit-transform"]&&e.style["-webkit-transform"]!==""&&(e.style["-webkit-transform"]="")}function s0(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||e.contentEditable==="true")}function $O(e){return s0(e)&&e.hasAttribute("data-hot-input")===!1}function Vee(e){var t=e.ownerDocument.activeElement;$O(t)||e.select()}function n$(e){return!e.parentNode}function jee(e,t){var r=new IntersectionObserver(function(n,i){n.forEach(function(a){a.isIntersecting&&e.offsetParent!==null&&(t(),i.unobserve(e))})},{root:e.ownerDocument.body});r.observe(e)}const AAe=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Lee,addClass:ke,addEvent:OAe,clearTextSelection:eM,closest:cu,closestDown:Uy,empty:mo,fastInnerHTML:lh,fastInnerText:ku,getCaretPosition:r$,getComputedStyle:Au,getCssTransform:kAe,getFrameElement:Dee,getParent:Mee,getParentWindow:i0,getScrollLeft:ox,getScrollTop:a0,getScrollableElement:o0,getScrollbarWidth:Sn,getSelectionEndPosition:Fee,getSelectionText:$ee,getStyle:uv,getTrimmingContainer:lv,getWindowScrollLeft:Ic,getWindowScrollTop:sv,hasAccessToParentWindow:xAe,hasClass:bt,hasHorizontalScrollbar:Bee,hasVerticalScrollbar:Hee,index:Nee,innerHeight:Ps,innerWidth:vm,isChildOf:hu,isDetached:n$,isInput:s0,isOutsideInput:$O,isVisible:ov,matchesCSSRules:TAe,observeVisibilityChangeOnce:jee,offset:nn,outerHeight:Nr,outerWidth:cr,overlayContainsElement:zl,removeClass:St,removeEvent:EAe,removeTextNodes:t$,resetCssTransform:Qw,selectElementIfAllowed:Vee,setCaretPosition:Jw,setOverlayPosition:FO},Symbol.toStringTag,{value:"Module"}));function br(e){return typeof e=="function"}function Wee(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0,n={lastCallThrottled:!0},i=null;function a(){for(var o=this,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=f,c=!0);var h=t-(f-r);return c?(n.lastCallThrottled=!1,e.apply(this,l)):(i&&clearTimeout(i),i=setTimeout(function(){n.lastCallThrottled=!1,e.apply(o,l),r=0,i=void 0},h)),n}return a}function PAe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=Wee(e,t),i=r;function a(){i=r}function o(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return i?(i-=1,e.apply(this,l)):n.apply(this,l)}return o.clearHits=a,o}function i$(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var a=this,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=e.apply(a,s)},t),n}return i}function IAe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t.slice(1);return function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return Zr(i,function(u,f){return f(u)},n.apply(this,s))}}function a$(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return e.apply(this,r.concat(o))}}function Uee(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function MAe(e){var t=e.length;function r(n){return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var l=n.concat(o.reverse()),u;return l.length>=t?u=e.apply(this,l):u=r(l),u}}return r([])}function sx(e,t,r,n,i,a,o,s){return Xe(s)?e.call(t,r,n,i,a,o,s):Xe(o)?e.call(t,r,n,i,a,o):Xe(a)?e.call(t,r,n,i,a):Xe(i)?e.call(t,r,n,i):Xe(n)?e.call(t,r,n):Xe(r)?e.call(t,r):e.call(t)}const DAe=Object.freeze(Object.defineProperty({__proto__:null,curry:Uee,curryRight:MAe,debounce:i$,fastCall:sx,isFunction:br,partial:a$,pipe:IAe,throttle:Wee,throttleAfterHits:PAe},Symbol.toStringTag,{value:"Module"}));function gr(){if(Xe(console)){var e;(e=console).warn.apply(e,arguments)}}function o$(){if(Xe(console)){var e;(e=console).error.apply(e,arguments)}}var NAe=Mt,TW=aF,qS=kc.getWeakData,LAe=nF,FAe=qr,$Ae=wo,QR=sn,HAe=rF,zee=ah,OW=Wr,Gee=bl,BAe=Gee.set,VAe=Gee.getterFor,jAe=zee.find,WAe=zee.findIndex,UAe=NAe([].splice),zAe=0,ZS=function(e){return e.frozen||(e.frozen=new Yee)},Yee=function(){this.entries=[]},ek=function(e,t){return jAe(e.entries,function(r){return r[0]===t})};Yee.prototype={get:function(e){var t=ek(this,e);if(t)return t[1]},has:function(e){return!!ek(this,e)},set:function(e,t){var r=ek(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=WAe(this.entries,function(r){return r[0]===e});return~t&&UAe(this.entries,t,1),!!~t}};var Kee={getConstructor:function(e,t,r,n){var i=e(function(l,u){LAe(l,a),BAe(l,{type:t,id:zAe++,frozen:void 0}),$Ae(u)||HAe(u,l[n],{that:l,AS_ENTRIES:r})}),a=i.prototype,o=VAe(t),s=function(l,u,f){var c=o(l),h=qS(FAe(u),!0);return h===!0?ZS(c).set(u,f):h[c.id]=f,l};return TW(a,{delete:function(l){var u=o(this);if(!QR(l))return!1;var f=qS(l);return f===!0?ZS(u).delete(l):f&&OW(f,u.id)&&delete f[u.id]},has:function(u){var f=o(this);if(!QR(u))return!1;var c=qS(u);return c===!0?ZS(f).has(u):c&&OW(c,f.id)}}),TW(a,r?{get:function(u){var f=o(this);if(QR(u)){var c=qS(u);return c===!0?ZS(f).get(u):c?c[f.id]:void 0}},set:function(u,f){return s(this,u,f)}}:{add:function(u){return s(this,u,!0)}}),i}},GAe=YL,EW=_r,J1=Mt,RW=aF,YAe=kc,KAe=vO,Xee=Kee,JS=sn,QS=bl.enforce,XAe=Tt,qAe=xZ,eS=Object,ZAe=Array.isArray,e_=eS.isExtensible,qee=eS.isFrozen,JAe=eS.isSealed,Zee=eS.freeze,QAe=eS.seal,kW={},AW={},ePe=!EW.ActiveXObject&&"ActiveXObject"in EW,Jg,Jee=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Qee=KAe("WeakMap",Jee,Xee),gd=Qee.prototype,Q1=J1(gd.set),tPe=function(){return GAe&&XAe(function(){var e=Zee([]);return Q1(new Qee,e,1),!qee(e)})};if(qAe)if(ePe){Jg=Xee.getConstructor(Jee,"WeakMap",!0),YAe.enable();var PW=J1(gd.delete),t_=J1(gd.has),IW=J1(gd.get);RW(gd,{delete:function(e){if(JS(e)&&!e_(e)){var t=QS(this);return t.frozen||(t.frozen=new Jg),PW(this,e)||t.frozen.delete(e)}return PW(this,e)},has:function(t){if(JS(t)&&!e_(t)){var r=QS(this);return r.frozen||(r.frozen=new Jg),t_(this,t)||r.frozen.has(t)}return t_(this,t)},get:function(t){if(JS(t)&&!e_(t)){var r=QS(this);return r.frozen||(r.frozen=new Jg),t_(this,t)?IW(this,t):r.frozen.get(t)}return IW(this,t)},set:function(t,r){if(JS(t)&&!e_(t)){var n=QS(this);n.frozen||(n.frozen=new Jg),t_(this,t)?Q1(this,t,r):n.frozen.set(t,r)}else Q1(this,t,r);return this}})}else tPe()&&RW(gd,{set:function(t,r){var n;return ZAe(t)&&(qee(t)?n=kW:JAe(t)&&(n=AW)),Q1(this,t,r),n==kW&&Zee(t),n==AW&&QAe(t),this}});var et={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:G1()?182:174,AUDIO_MUTE:G1()?181:173,AUDIO_UP:G1()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},rPe=[et.ALT,et.ARROW_DOWN,et.ARROW_LEFT,et.ARROW_RIGHT,et.ARROW_UP,et.AUDIO_DOWN,et.AUDIO_MUTE,et.AUDIO_UP,et.BACKSPACE,et.CAPS_LOCK,et.DELETE,et.END,et.ENTER,et.ESCAPE,et.F1,et.F2,et.F3,et.F4,et.F5,et.F6,et.F7,et.F8,et.F9,et.F10,et.F11,et.F12,et.F13,et.F14,et.F15,et.F16,et.F17,et.F18,et.F19,et.HOME,et.INSERT,et.MEDIA_NEXT,et.MEDIA_PLAY_PAUSE,et.MEDIA_PREV,et.MEDIA_STOP,et.NULL,et.NUM_LOCK,et.PAGE_DOWN,et.PAGE_UP,et.PAUSE,et.SCROLL_LOCK,et.SHIFT,et.TAB];function ete(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function s$(e){return rPe.includes(e)}function nPe(e){var t=[];return ZC()?t.push(et.COMMAND_LEFT,et.COMMAND_RIGHT,et.COMMAND_FIREFOX):t.push(et.CONTROL),t.includes(e)}function tte(e){return[et.CONTROL,et.COMMAND_LEFT,et.COMMAND_RIGHT,et.COMMAND_FIREFOX].includes(e)}function fv(e,t){var r=t.split("|"),n=!1;return ne(r,function(i){if(e===et[i])return n=!0,!1}),n}const iPe=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:et,isCtrlKey:nPe,isCtrlMetaKey:tte,isFunctionKey:s$,isKey:fv,isPrintableChar:ete},Symbol.toStringTag,{value:"Module"}));function bo(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function $f(e){return e.isImmediatePropagationEnabled===!1}function Pu(e){return e.button===2}function HO(e){return e.button===0}const aPe=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:$f,isLeftClick:HO,isRightClick:Pu,stopImmediatePropagation:bo},Symbol.toStringTag,{value:"Module"}));function l0(e){return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l0(e)}var MW;function oPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lPe(n.key),n)}}function sPe(e,t,r){return t&&DW(e.prototype,t),r&&DW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lPe(e){var t=uPe(e,"string");return l0(t)==="symbol"?t:String(t)}function uPe(e,t){if(l0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fPe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var kh=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],cPe=sr(MW||(MW=fPe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),tk=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),rk=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),rte=function(){function e(){oPe(this,e),this.globalBucket=this.createEmptyBucket()}return sPe(e,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return ne(kh,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))ne(n,function(l){return i.add(r,l,a)});else{tk.has(r)&&gr(e$(cPe,{hookName:r,removedInVersion:tk.get(r)})),rk.has(r)&&gr(rk.get(r));var o=this.getBucket(a);if(typeof o[r]>"u"&&(this.register(r),o[r]=[]),n.skip=!1,o[r].indexOf(n)===-1){var s=!1;n.initialHook&&ne(o[r],function(l,u){if(l.initialHook)return o[r][u]=n,s=!0,!1}),s||o[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?ne(n,function(o){return i.once(r,o,a)}):(n.runOnce=!0,this.add(r,n,a))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=this.getBucket(i);return typeof a[r]<"u"&&a[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,a,o,s,l,u){{var f=this.globalBucket[n],c=f?f.length:0,h=0;if(c)for(;h<c;){if(!f[h]||f[h].skip){h+=1;continue}var d=sx(f[h],r,i,a,o,s,l,u);d!==void 0&&(i=d),f[h]&&f[h].runOnce&&this.remove(n,f[h]),h+=1}}{var v=this.getBucket(r)[n],p=v?v.length:0,g=0;if(p)for(;g<p;){if(!v[g]||v[g].skip){g+=1;continue}var y=sx(v[g],r,i,a,o,s,l,u);y!==void 0&&(i=y),v[g]&&v[g].runOnce&&this.remove(n,v[g],r),g+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;It(this.getBucket(r),function(n,i,a){return a[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||kh.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&kh.splice(kh.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return rk.has(r)||tk.has(r)}},{key:"isRegistered",value:function(r){return kh.indexOf(r)>=0}},{key:"getRegistered",value:function(){return kh}}],[{key:"getSingleton",value:function(){return dPe()}}]),e}(),hPe=new rte;function dPe(){return hPe}const Qe=rte;function NW(e){return yPe(e)||gPe(e)||pPe(e)||vPe()}function vPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pPe(e,t){if(e){if(typeof e=="string")return tM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tM(e,t)}}function gPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yPe(e){if(Array.isArray(e))return tM(e)}function tM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var nk=new Map;function Ha(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";nk.has(e)||nk.set(e,new Map);var t=nk.get(e);function r(s,l){t.set(s,l)}function n(s){return t.get(s)}function i(s){return t.has(s)}function a(){return NW(t.keys())}function o(){return NW(t.values())}return{register:r,getItem:n,hasItem:i,getNames:a,getValues:o}}var rM=new WeakMap,tS=Ha("editors"),mPe=tS.register,nte=tS.getItem,ite=tS.hasItem,bPe=tS.getNames;tS.getValues;function wPe(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(n){return n.guid in t||(t[n.guid]=new r(n)),t[n.guid]},Qe.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function ate(e,t){var r;if(typeof e=="function")rM.get(e)||ki(null,e),r=rM.get(e);else if(typeof e=="string")r=nte(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function lx(e){if(typeof e=="function")return e;if(!ite(e))throw Error('No registered editor found under "'.concat(e,'" name'));return nte(e).getConstructor()}function ki(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);var r=new wPe(t);typeof e=="string"&&mPe(e,r),rM.set(t,r)}function u0(e){return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u0(e)}function SPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CPe(n.key),n)}}function _Pe(e,t,r){return t&&LW(e.prototype,t),r&&LW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CPe(e){var t=xPe(e,"string");return u0(t)==="symbol"?t:String(t)}function xPe(e,t){if(u0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(u0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eC=0,TPe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;SPe(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return _Pe(e,[{key:"addEventListener",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,OPe(l))}return typeof o!="boolean"&&!SQ()&&(o=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:o,eventManager:this}),r.addEventListener(n,s,o),eC+=1,function(){a.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===r){if(i&&i!==s.callback||a&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),eC-=1}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),eC-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,a=r;i||(i=r.ownerDocument?r.ownerDocument:r,a=i.defaultView);var o={bubbles:!0,cancelable:n!=="mousemove",view:a,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),e}();function OPe(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),bo(this)},e}const Fr=TPe;function EPe(){return eC}function f0(e){return f0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f0(e)}function RPe(e,t){return IPe(e)||PPe(e,t)||APe(e,t)||kPe()}function kPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function APe(e,t){if(e){if(typeof e=="string")return FW(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FW(e,t)}}function FW(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function IPe(e){if(Array.isArray(e))return e}function MPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NPe(n.key),n)}}function DPe(e,t,r){return t&&$W(e.prototype,t),r&&$W(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NPe(e){var t=LPe(e,"string");return f0(t)==="symbol"?t:String(t)}function LPe(e,t){if(f0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(f0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BO="editorManager.navigation",pm="editorManager.handlingEditor",nM=function(){function e(t,r,n){var i=this;MPe(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new Fr(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var a=this.instance.getShortcutManager();a.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(o){!i.destroyed&&i.instance.isListening()&&i.openEditor("",o)}),this.instance.view._wt.update("onCellDblClick",function(o,s,l){return i.onCellDblClick(o,s,l)})}return DPe(e,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),a=n.getContext("editor"),o={group:pm};a.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],o),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),bo(l)}}],o)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(p){p&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance.runHooks("modifyGetCellCoords",i,a),s=i,l=a;if(Array.isArray(o)){var u=RPe(o,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var f=this.instance.rootDocument.activeElement;if(f&&$O(f)&&f.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(i,a,!0);if(c){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),v=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=ate(h,this.instance),this.activeEditor.prepare(i,a,d,c,v,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var a=this.instance.getSelectedRangeLast().highlight,o=a.row,s=a.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,a=n.col,o=this.instance,s=o.rowIndexMapper,l=o.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(a));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(this.instance.isListening()){var i=r.keyCode;if(this.selection.isSelected()){var a=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!s$(i)&&!tte(i)&&!a&&!this.isEditorOpened()){var o=this.instance.getShortcutManager(),s=o.getContext("editor"),l={runOnlyIf:function(){return Xe(n.instance.getSelected())},group:BO};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),HW=new WeakMap;nM.getInstance=function(e,t,r){var n=HW.get(e);return n||(n=new nM(e,t,r),HW.set(e,n)),n};const FPe=nM;var $Pe=pt,HPe=Bi,ote=Lw,BPe=Tt,VPe=BPe(function(){ote(1)});$Pe({target:"Object",stat:!0,forced:VPe},{keys:function(t){return ote(HPe(t))}});var jPe=gn,WPe=bO,UPe=qr,zPe=wo,GPe=ih,ik=ln,YPe=Hi,KPe=th,XPe=pF,BW=wO;WPe("match",function(e,t,r){return[function(i){var a=YPe(this),o=zPe(i)?void 0:KPe(i,e);return o?jPe(o,i,a):new RegExp(i)[e](ik(a))},function(n){var i=UPe(this),a=ik(n),o=r(t,i,a);if(o.done)return o.value;if(!i.global)return BW(i,a);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,f;(f=BW(i,a))!==null;){var c=ik(f[0]);l[u]=c,c===""&&(i.lastIndex=XPe(a,GPe(i.lastIndex),s)),u++}return u===0?null:l}]});var qPe=oh,ZPe=oa,JPe=Wu,QPe=La,eIe=xg,tIe=Math.min,iM=[].lastIndexOf,ste=!!iM&&1/[1].lastIndexOf(1,-0)<0,rIe=eIe("lastIndexOf"),nIe=ste||!rIe,iIe=nIe?function(t){if(ste)return qPe(iM,this,arguments)||0;var r=ZPe(this),n=QPe(r),i=n-1;for(arguments.length>1&&(i=tIe(i,JPe(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:iM,aIe=pt,VW=iIe;aIe({target:"Array",proto:!0,forced:VW!==[].lastIndexOf},{lastIndexOf:VW});var oIe=eh,sIe=Bi,lIe=Rw,uIe=La,fIe=TypeError,jW=function(e){return function(t,r,n,i){oIe(r);var a=sIe(t),o=lIe(a),s=uIe(a),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in o){i=o[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw fIe("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in o&&(i=r(i,o[l],l,a));return i}},cIe={left:jW(!1),right:jW(!0)},hIe=pt,dIe=cIe.left,vIe=xg,WW=kw,pIe=oQ,gIe=!pIe&&WW>79&&WW<83,yIe=gIe||!vIe("reduce");hIe({target:"Array",proto:!0,forced:yIe},{reduce:function(t){var r=arguments.length;return dIe(this,t,r,r>1?arguments[1]:void 0)}});var mIe=pt,bIe=ah.findIndex,wIe=Ww,aM="findIndex",lte=!0;aM in[]&&Array(1)[aM](function(){lte=!1});mIe({target:"Array",proto:!0,forced:lte},{findIndex:function(t){return bIe(this,t,arguments.length>1?arguments[1]:void 0)}});wIe(aM);function ak(e){return xIe(e)||CIe(e)||_Ie(e)||SIe()}function SIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ie(e,t){if(e){if(typeof e=="string")return oM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oM(e,t)}}function CIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xIe(e){if(Array.isArray(e))return oM(e)}function oM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ute={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},TIe=new RegExp(Object.keys(ute).map(function(e){return"(".concat(e,")")}).join("|"),"gi");function OIe(e){return(e&&e.nodeName||"")==="TABLE"}function sM(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,n),a=i.length,o=a>0?i[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,c=t?1:0,h=0;h<a;h+=1){for(var d=t&&h===0,v=[],p=0;p<o;p+=1){var g=!d&&r&&p===0,y="";if(d)y="<th>".concat(e.getColHeader(p-f),"</th>");else if(g)y="<th>".concat(e.getRowHeader(h-c),"</th>");else{var m=i[h][p],b=e.getCellMeta(h-c,p-f),S=b.hidden,x=b.rowspan,T=b.colspan;if(!S){var E=[];if(x&&E.push('rowspan="'.concat(x,'"')),T&&E.push('colspan="'.concat(T,'"')),pn(m))y="<td ".concat(E.join(" "),"></td>");else{var P=m.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y="<td ".concat(E.join(" "),">").concat(P,"</td>")}}}v.push(y)}var R=["<tr>"].concat(v,["</tr>"]).join("");d?l.splice(1,0,R):u.splice(-1,0,R)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function lM(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var i=e[n],a=i.length,o=[];n===0&&r.push("<tbody>");for(var s=0;s<a;s+=1){var l=i[s],u=pn(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");o.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(o,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function fte(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);var a=e;if(typeof a=="string"){var o=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(_){var A=_.match(/<td\b[^>]*?>/g)[0],I=_.substring(A.length,_.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),L="</td>";return"".concat(A).concat(I).concat(L)});i.insertAdjacentHTML("afterbegin","".concat(o)),a=i.querySelector("table")}if(!(!a||!OIe(a))){var s=i.querySelector('meta[name$="enerator"]'),l=a.querySelector("tbody th")!==null,u=a.querySelector("tr"),f=u?Array.from(u.cells).reduce(function(_,A){return _+A.colSpan},0)-(l?1:0):0,c=a.tFoot&&Array.from(a.tFoot.rows)||[],h=[],d=!1,v=0,p=0;if(a.tHead){var g=Array.from(a.tHead.rows).filter(function(_){var A=_.querySelector("td")!==null;return A&&h.push(_),!A});v=g.length,d=v>0,v>1?r.nestedHeaders=Array.from(g).reduce(function(_,A){var I=Array.from(A.cells).reduce(function(L,V,Y){if(l&&Y===0)return L;var ae=V.colSpan,re=V.innerHTML,te=ae>1?{label:re,colspan:ae}:re;return L.push(te),L},[]);return _.push(I),_},[]):d&&(r.colHeaders=Array.from(g[0].children).reduce(function(_,A,I){return l&&I===0||_.push(A.innerHTML),_},[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);var y=[].concat(h,ak(Array.from(a.tBodies).reduce(function(_,A){return _.push.apply(_,ak(Array.from(A.rows))),_},[])),ak(c));p=y.length;for(var m=new Array(p),b=0;b<p;b++)m[b]=new Array(f);for(var S=[],x=[],T=0;T<p;T++)for(var E=y[T],P=Array.from(E.cells),R=P.length,M=0;M<R;M++){var D=P[M],N=D.nodeName,B=D.innerHTML,K=D.rowSpan,Z=D.colSpan,ie=m[T].findIndex(function(_){return _===void 0});if(N==="TD"){if(K>1||Z>1){for(var me=T;me<T+K;me++)if(me<p)for(var k=ie;k<ie+Z;k++)m[me][k]=null;var w=D.getAttribute("style"),C=w&&w.includes("mso-ignore:colspan");C||S.push({col:ie,row:T,rowspan:K,colspan:Z})}var O="";s&&/excel/gi.test(s.content)?O=B.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):O=B.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),m[T][ie]=O.replace(TIe,function(_){return ute[_]})}else x.push(B)}return S.length&&(r.mergeCells=S),x.length&&(r.rowHeaders=x),m.length&&(r.data=m),r}}const EIe=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:lM,htmlToGridSettings:fte,instanceToHTML:sM},Symbol.toStringTag,{value:"Module"}));function RIe(e){return IIe(e)||PIe(e)||AIe(e)||kIe()}function kIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AIe(e,t){if(e){if(typeof e=="string")return uM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uM(e,t)}}function PIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IIe(e){if(Array.isArray(e))return uM(e)}function uM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fM(e){return fM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fM(e)}function Xi(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=fM(e);if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);var n=Array.from(new Set(["."].concat(RIe(t)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function cte(e){return Xi(e,[","])}function rt(e,t,r){var n=-1;for(typeof t=="function"?(r=t,t=e):n=e-1;++n<=t&&r(n)!==!1;);}function ux(e,t,r){var n=e+1;for(typeof t=="function"&&(r=t,t=0);--n>=t&&r(n)!==!1;);}function l$(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}const MIe=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:Xi,isNumericLike:cte,rangeEach:rt,rangeEachReverse:ux,valueAccordingPercent:l$},Symbol.toStringTag,{value:"Module"}));function DIe(e){return FIe(e)||LIe(e)||hte(e)||NIe()}function NIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FIe(e){if(Array.isArray(e))return cM(e)}function $Ie(e,t){return VIe(e)||BIe(e,t)||hte(e,t)||HIe()}function HIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hte(e,t){if(e){if(typeof e=="string")return cM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cM(e,t)}}function cM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function VIe(e){if(Array.isArray(e))return e}var hM="asc",jIe="desc",UW=new Map([[hM,[-1,1]],[jIe,[1,-1]]]),WIe=function(t){return"The priority '".concat(t,"' is already declared in a map.")},UIe=function(t){return"The priority '".concat(t,"' is not a number.")};function zIe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorPriorityExists,r=e.errorPriorityNaN,n=new Map;t=br(t)?t:WIe,r=br(r)?r:UIe;function i(o,s){if(!Xi(o))throw new Error(r(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function a(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hM,s=UW.get(o)||UW.get(hM),l=$Ie(s,2),u=l[0],f=l[1];return DIe(n).sort(function(c,h){return c[0]<h[0]?u:f}).map(function(c){return c[1]})}return{addItem:i,getItems:a}}var GIe=pt,YIe=ah.find,KIe=Ww,dM="find",dte=!0;dM in[]&&Array(1)[dM](function(){dte=!1});GIe({target:"Array",proto:!0,forced:dte},{find:function(t){return YIe(this,t,arguments.length>1?arguments[1]:void 0)}});KIe(dM);function XIe(e){return JIe(e)||ZIe(e)||vte(e)||qIe()}function qIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JIe(e){if(Array.isArray(e))return vM(e)}function zW(e,t){return tMe(e)||eMe(e,t)||vte(e,t)||QIe()}function QIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vte(e,t){if(e){if(typeof e=="string")return vM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vM(e,t)}}function vM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function tMe(e){if(Array.isArray(e))return e}var rMe=function(t){return"The id '".concat(t,"' is already declared in a map.")};function VO(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorIdExists,r=new Map;t=br(t)?t:rMe;function n(f,c){if(u(f))throw new Error(t(f));r.set(f,c)}function i(f){return r.delete(f)}function a(){r.clear()}function o(f){var c=l().find(function(v){var p=zW(v,2),g=p[0],y=p[1];return f===y?g:!1})||[null],h=zW(c,1),d=h[0];return d}function s(f){return r.get(f)}function l(){return XIe(r)}function u(f){return r.has(f)}return{addItem:n,clear:a,getId:o,getItem:s,getItems:l,hasItem:u,removeItem:i}}function nMe(e){return sMe(e)||oMe(e)||aMe(e)||iMe()}function iMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aMe(e,t){if(e){if(typeof e=="string")return pM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pM(e,t)}}function oMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sMe(e){if(Array.isArray(e))return pM(e)}function pM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lMe=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function uMe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.errorItemExists,r=new Set;t=br(t)?t:lMe;function n(o){if(r.has(o))throw new Error(t(o));r.add(o)}function i(){return nMe(r)}function a(){r.clear()}return{addItem:n,clear:a,getItems:i}}function fMe(e,t){return dMe(e)||hMe(e,t)||pte(e,t)||cMe()}function cMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function dMe(e){if(Array.isArray(e))return e}function GW(e){return gMe(e)||pMe(e)||pte(e)||vMe()}function vMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pte(e,t){if(e){if(typeof e=="string")return gM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gM(e,t)}}function pMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gMe(e){if(Array.isArray(e))return gM(e)}function gM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u$=function(t){return'There is already registered "'.concat(t,'" plugin.')},yMe=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},mMe=function(t){return'The priority "'.concat(t,'" is not a number.')},gte=zIe({errorPriorityExists:yMe,errorPriorityNaN:mMe}),yte=uMe({errorItemExists:u$}),yM=VO({errorIdExists:u$});function f$(){return[].concat(GW(gte.getItems()),GW(yte.getItems()))}function rS(e){var t=Ni(e);return yM.getItem(t)}function bMe(e){return!!rS(e)}function Gt(e,t,r){var n=SMe(e,t,r),i=fMe(n,3);e=i[0],t=i[1],r=i[2],rS(e)===void 0&&wMe(e,t,r)}function wMe(e,t,r){var n=Ni(e);if(yM.hasItem(n))throw new Error(u$(n));r===void 0?yte.addItem(n):gte.addItem(r,n),yM.addItem(n,t)}function SMe(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var nS=Ha("renderers"),_Me=nS.register,CMe=nS.getItem,mte=nS.hasItem,xMe=nS.getNames;nS.getValues;function fx(e){if(typeof e=="function")return e;if(!mte(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return CMe(e)}function Vo(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),_Me(e,t)}var iS=Ha("validators"),TMe=iS.register,OMe=iS.getItem,bte=iS.hasItem,EMe=iS.getNames;iS.getValues;function c$(e){if(typeof e=="function")return e;if(!bte(e))throw Error('No registered validator found under "'.concat(e,'" name'));return OMe(e)}function xd(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),TMe(e,t)}var Hf=1,jn=2;function c0(e){return c0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c0(e)}function RMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AMe(n.key),n)}}function kMe(e,t,r){return t&&YW(e.prototype,t),r&&YW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AMe(e){var t=PMe(e,"string");return c0(t)==="symbol"?t:String(t)}function PMe(e,t){if(c0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ah=new WeakMap,IMe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,f=u===void 0?function(h){return h}:u,c=t.inlineStartOffset;RMe(this,e),Ah.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:a,overrideFn:o,calculationType:s,stretchingColumnWidthFn:f,inlineStartOffset:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return kMe(e,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],a,o=0,s=0,l=Ah.get(this),u=l.calculationType,f=l.overrideFn,c=l.scrollOffset,h=Math.max(l.scrollOffset,0),d=l.totalColumns,v=l.viewportWidth,p=h>0?v+1:v,g=0;g<d;g++)if(a=this._getColumnWidth(g),r<=h&&u!==jn&&(this.startColumn=g,o=a),r>=h&&r+(u===jn?a:0)<=h+p&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=g,o=a),this.endColumn=g),i.push(r),r+=a,s=a,u!==jn&&(this.endColumn=g),r>=h+v){n=!1;break}var y=c+v-p,m=u===jn?0:s,b=u===jn?o:0;if(y<-1*l.inlineStartOffset||c>i.at(-1)+m||-1*l.scrollOffset-l.viewportWidth>-1*b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var S=i[this.endColumn]+a-i[this.startColumn-1];if((S<=v||u!==jn)&&(this.startColumn-=1),S>v)break}u===Hf&&this.startColumn!==null&&f&&f(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=Ah.get(this),a=i.totalColumns,o=0,s=0;s<a;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:o+=l}var f=n-o;if(this.stretch==="all"&&f>0)this.stretchAllRatio=n/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var c=this._getColumnWidth(a-1),h=f+c;this.stretchLastWidth=h>=0?h:c}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,a=Ah.get(this),o=a.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=a.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Ah.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Ah.get(this).columnWidthFn(r);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}();const h$=IMe;function h0(e){return h0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h0(e)}function MMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NMe(n.key),n)}}function DMe(e,t,r){return t&&KW(e.prototype,t),r&&KW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NMe(e){var t=LMe(e,"string");return h0(t)==="symbol"?t:String(t)}function LMe(e,t){if(h0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(h0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XW=new WeakMap,FMe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,i=t.totalItems,a=t.itemSizeFn,o=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;MMe(this,e),XW.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:a,overrideFn:o,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return DMe(e,[{key:"calculate",value:function(){for(var r=XW.get(this),n=r.calculationType,i=r.overrideFn,a=r.rowHeightFn,o=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,f=r.horizontalScrollbarHeight||0,c=0,h=!0,d=[],v,p=0,g=0,y=0;y<l;y++)if(v=a(y),isNaN(v)&&(v=e.DEFAULT_HEIGHT),c<=s&&n!==jn&&(this.startRow=y,p=v),c>=s&&c+(n===jn?v:0)<=s+u-f&&(this.startRow===null&&(this.startRow=y,p=v),this.endRow=y),d.push(c),c+=v,g=v,n!==jn&&(this.endRow=y),c>=s+u-f){h=!1;break}var m=o+u-f,b=n===jn?p:0,S=n===jn?0:g;if(m<b||o>d.at(-1)+S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var x=d[this.endRow]+v-d[this.startRow-1];if((x<=u-f||n!==jn)&&(this.startRow-=1),x>=u-f)break}n===Hf&&this.startRow!==null&&i&&i(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}();const wte=FMe;function d0(e){return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d0(e)}function $Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ste(n.key),n)}}function HMe(e,t,r){return t&&qW(e.prototype,t),r&&qW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BMe(e,t,r){VMe(e,t),t.set(e,r)}function VMe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZW(e,t,r){return t=Ste(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ste(e){var t=jMe(e,"string");return d0(t)==="symbol"?t:String(t)}function jMe(e,t){if(d0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(d0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qg(e,t){var r=_te(e,t,"get");return WMe(e,r)}function WMe(e,t){return t.get?t.get.call(e):t.value}function UMe(e,t,r){var n=_te(e,t,"set");return zMe(e,n,r),r}function _te(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function zMe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Qu=new WeakMap,GMe=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;$Me(this,e),ZW(this,"row",null),ZW(this,"col",null),BMe(this,Qu,{writable:!0,value:!1}),UMe(this,Qu,n),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}return HMe(e,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(Qg(this,Qu)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(Qg(this,Qu)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(Qg(this,Qu)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(Qg(this,Qu)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Qg(this,Qu))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();const cx=GMe;function v0(e){return v0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v0(e)}function YMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cte(n.key),n)}}function KMe(e,t,r){return t&&JW(e.prototype,t),r&&JW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XMe(e,t,r){qMe(e,t),t.set(e,r)}function qMe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ok(e,t,r){return t=Cte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cte(e){var t=ZMe(e,"string");return v0(t)==="symbol"?t:String(t)}function ZMe(e,t){if(v0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(v0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oo(e,t){var r=xte(e,t,"get");return JMe(e,r)}function JMe(e,t){return t.get?t.get.call(e):t.value}function QMe(e,t,r){var n=xte(e,t,"set");return e2e(e,n,r),r}function xte(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function e2e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var la=new WeakMap,t2e=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;YMe(this,e),ok(this,"highlight",null),ok(this,"from",null),ok(this,"to",null),XMe(this,la,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone(),QMe(this,la,i)}return KMe(e,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,a=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return a.row<=n&&o.row>=n&&a.col<=i&&o.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=this.getDirection(),o=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),f=Math.max(i.row,s.row),c=Math.max(i.col,s.col),h=this._createCellCoords(l,u),d=this._createCellCoords(f,c);return this.from=h,this.to=d,this.setDirection(a),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var a=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=a[0],this.to=a[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Oo(this,la)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Oo(this,la)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Oo(this,la)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Oo(this,la)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Oo(this,la)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Oo(this,la)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Oo(this,la)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Oo(this,la)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof cx))return!1;if(n){var i=n.from,a=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,a.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(a.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(a.row,a.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},a=[];return n.top===i.top&&a.push("top"),n.right===i.right&&a.push("right"),n.bottom===i.bottom&&a.push("bottom"),n.left===i.left&&a.push("left"),a}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)!(this.from.row===a&&this.from.col===o)&&!(this.to.row===a&&this.to.col===o)&&i.push(this._createCellCoords(a,o));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],a=r.row;a<=n.row;a++)for(var o=r.col;o<=n.col;o++)r.row===a&&r.col===o?i.push(r):n.row===a&&n.col===o?i.push(n):i.push(this._createCellCoords(a,o));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),a=n.row;a<=i.row;a++)for(var o=n.col;o<=i.col;o++){var s=r(a,o);if(s===!1)return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,Oo(this,la))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new cx(r,n,Oo(this,la))}}]),e}();const d$=t2e;var r2e=pt,n2e=ZL;r2e({target:"Object",stat:!0},{setPrototypeOf:n2e});var Tte=Mt,i2e=eh,a2e=sn,o2e=Wr,QW=Vw,s2e=Tw,Ote=Function,l2e=Tte([].concat),u2e=Tte([].join),sk={},f2e=function(e,t,r){if(!o2e(sk,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";sk[t]=Ote("C,a","return new C("+u2e(n,",")+")")}return sk[t](e,r)},c2e=s2e?Ote.bind:function(t){var r=i2e(this),n=r.prototype,i=QW(arguments,1),a=function(){var s=l2e(i,QW(arguments));return this instanceof a?f2e(r,s.length,s):r.apply(t,s)};return a2e(n)&&(a.prototype=n),a},h2e=pt,d2e=ml,lk=oh,v2e=c2e,e5=_Q,p2e=qr,t5=sn,g2e=Sg,Ete=Tt,v$=d2e("Reflect","construct"),y2e=Object.prototype,m2e=[].push,Rte=Ete(function(){function e(){}return!(v$(function(){},[],e)instanceof e)}),kte=!Ete(function(){v$(function(){})}),r5=Rte||kte;h2e({target:"Reflect",stat:!0,forced:r5,sham:r5},{construct:function(t,r){e5(t),p2e(r);var n=arguments.length<3?t:e5(arguments[2]);if(kte&&!Rte)return v$(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return lk(m2e,i,r),new(lk(v2e,t,i))}var a=n.prototype,o=g2e(t5(a)?a:y2e),s=lk(t,o,r);return t5(s)?s:o}});function p0(e){return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p0(e)}function b2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S2e(n.key),n)}}function w2e(e,t,r){return t&&n5(e.prototype,t),r&&n5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S2e(e){var t=_2e(e,"string");return p0(t)==="symbol"?t:String(t)}function _2e(e,t){if(p0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(p0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ph=new WeakMap,C2e=function(){function e(t,r,n,i,a,o){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;b2e(this,e),this.wtSettings=n,this.domBindings=r,this.wtTable=a,this.selections=o,this.parent=s,this.eventManager=i,this.facadeGetter=t,Ph.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return w2e(e,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(a){return r.onContextMenu(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(a){return r.onMouseOver(a)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(a){return r.onMouseOut(a)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(o){return r.onTouchStart(o)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(o){return r.onTouchEnd(o)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(o){return r.onMouseUp(o)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(o){return r.onMouseDown(o)})};oo()?n():(xF()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=Ph.get(this),i=this.parentCell(r),a=i.coords;if(n.selectedCellBeforeTouchEnd&&a){var o=[a.row,n.selectedCellBeforeTouchEnd.from.row],s=o[0],l=o[1],u=[a.col,n.selectedCellBeforeTouchEnd.from.col],f=u[0],c=u[1];return s===l&&f===c}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,a=Uy(r,["TD","TH"],i);return a?(n.coords=this.wtTable.getCoords(a),n.TD=a):bt(r,"wtBorder")&&bt(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):bt(r,"wtBorder")&&bt(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Ph.get(this),i=this.domBindings.rootDocument.activeElement,a=a$(Mee,r.target),o=r.target;if(!(o===i||a(0)===i||a(1)===i)){var s=this.parentCell(o);bt(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,o):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=Uy(r.target,["TD","TH"],n),a=this.parent||this;i&&i!==a.lastMouseOver&&hu(i,n)&&(a.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=Uy(r.target,["TD","TH"],n),a=Uy(r.relatedTarget,["TD","TH"],n);i&&i!==a&&hu(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=Ph.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(bt(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Ph.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,a=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=Xe(a)&&a.row>=0&&a.col>=0,s=r.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];AF()&&(AQ()||PQ())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,a){var o=this.wtSettings.getSettingPure(r);o&&o(n,i,a,this.facadeGetter())}},{key:"destroy",value:function(){var r=Ph.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}();const Ate=C2e;function g0(e){return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g0(e)}function x2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O2e(n.key),n)}}function T2e(e,t,r){return t&&i5(e.prototype,t),r&&i5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O2e(e){var t=E2e(e,"string");return g0(t)==="symbol"?t:String(t)}function E2e(e,t){if(g0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(g0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R2e=function(){function e(t,r,n){x2e(this,e),this.offset=t,this.total=r,this.countTH=n}return T2e(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const k2e=R2e;function y0(e){return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y0(e)}function A2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I2e(n.key),n)}}function P2e(e,t,r){return t&&a5(e.prototype,t),r&&a5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I2e(e){var t=M2e(e,"string");return y0(t)==="symbol"?t:String(t)}function M2e(e,t){if(y0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(y0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D2e=function(){function e(t,r,n){A2e(this,e),this.offset=t,this.total=r,this.countTH=n}return P2e(e,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),e}();const N2e=D2e;var L2e=0,hx=1,dx=2;function m0(e){return m0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m0(e)}function F2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H2e(n.key),n)}}function $2e(e,t,r){return t&&o5(e.prototype,t),r&&o5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H2e(e){var t=B2e(e,"string");return m0(t)==="symbol"?t:String(t)}function B2e(e,t){if(m0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(m0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s5=function(){function e(){F2e(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return $2e(e,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),e}();function b0(e){return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b0(e)}function V2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W2e(n.key),n)}}function j2e(e,t,r){return t&&l5(e.prototype,t),r&&l5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W2e(e){var t=U2e(e,"string");return b0(t)==="symbol"?t:String(t)}function U2e(e,t){if(b0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(b0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z2e=function(){function e(){V2e(this,e),this.size=new s5,this.workingSpace=L2e,this.sharedSize=null}return j2e(e,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof s5}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=hx,r.workingSpace=dx,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=dx,r.workingSpace=hx,this.sharedSize=r.getViewSize()}}]),e}();function w0(e){return w0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w0(e)}function G2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K2e(n.key),n)}}function Y2e(e,t,r){return t&&u5(e.prototype,t),r&&u5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K2e(e){var t=X2e(e,"string");return w0(t)==="symbol"?t:String(t)}function X2e(e,t){if(w0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(w0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pte=function(){function e(t,r,n){G2e(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new z2e,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Y2e(e,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var a=r.firstElementChild;a;){if(a.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(hx))break;a=a.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),a=n.getViewSize(),o=a.nextSize,s=this.getRenderedChildCount();s<o;){var l=this.nodesPool();!i||i&&n.isPlaceOn(dx)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(hx);s>o;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(dx)&&(i+=n.sharedSize.nextSize);var a=r.childNodes[i];if(a.tagName!==this.childNodeType){var o=this.nodesPool();r.replaceChild(o,a),a=o}this.collectedNodes.push(a),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function cv(e){return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cv(e)}function q2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J2e(n.key),n)}}function Z2e(e,t,r){return t&&f5(e.prototype,t),r&&f5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J2e(e){var t=Q2e(e,"string");return cv(t)==="symbol"?t:String(t)}function Q2e(e,t){if(cv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mM(e,t)}function mM(e,t){return mM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mM(e,t)}function tDe(e){var t=iDe();return function(){var n=vx(e),i;if(t){var a=vx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return rDe(this,i)}}function rDe(e,t){if(t&&(cv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nDe(e)}function nDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vx(e){return vx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vx(e)}var Ite=function(e){eDe(r,e);var t=tDe(r);function r(){return q2e(this,r),t.apply(this,arguments)}return Z2e(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(Pte);function S0(e){return S0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S0(e)}function aDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sDe(n.key),n)}}function oDe(e,t,r){return t&&c5(e.prototype,t),r&&c5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sDe(e){var t=lDe(e,"string");return S0(t)==="symbol"?t:String(t)}function lDe(e,t){if(S0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(S0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uDe=function(){function e(t){aDe(this,e),this.nodeType=t.toUpperCase()}return oDe(e,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function _0(e){return _0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_0(e)}function fDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hDe(n.key),n)}}function cDe(e,t,r){return t&&h5(e.prototype,t),r&&h5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hDe(e){var t=dDe(e,"string");return _0(t)==="symbol"?t:String(t)}function dDe(e,t){if(_0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aS=function(){function e(t,r){fDe(this,e),this.nodesPool=typeof t=="string"?new uDe(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return cDe(e,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function hv(e){return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hv(e)}function vDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gDe(n.key),n)}}function pDe(e,t,r){return t&&d5(e.prototype,t),r&&d5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gDe(e){var t=yDe(e,"string");return hv(t)==="symbol"?t:String(t)}function yDe(e,t){if(hv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bM(e,t)}function bM(e,t){return bM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bM(e,t)}function bDe(e){var t=_De();return function(){var n=px(e),i;if(t){var a=px(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return wDe(this,i)}}function wDe(e,t){if(t&&(hv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SDe(e)}function SDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _De(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function px(e){return px=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},px(e)}var CDe=function(e){mDe(r,e);var t=bDe(r);function r(){var n;return vDe(this,r),n=t.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return pDe(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new Ite(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,f=0;f<a;f++){var c=this.table.renderedRowToSource(f),h=l.getRenderedNode(f);this.sourceRowIndex=c;var d=this.obtainOrderView(h),v=u.obtainOrderView(h);d.appendView(v).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<s;p++){d.render();var g=d.getCurrentNode();g.className="",g.removeAttribute("style"),o[p](c,g,p)}d.end()}}}]),r}(aS);function dv(e){return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dv(e)}function xDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ODe(n.key),n)}}function TDe(e,t,r){return t&&v5(e.prototype,t),r&&v5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ODe(e){var t=EDe(e,"string");return dv(t)==="symbol"?t:String(t)}function EDe(e,t){if(dv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wM(e,t)}function wM(e,t){return wM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wM(e,t)}function kDe(e){var t=IDe();return function(){var n=gx(e),i;if(t){var a=gx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ADe(this,i)}}function ADe(e,t){if(t&&(dv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PDe(e)}function PDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gx(e){return gx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gx(e)}var MDe=function(e){RDe(r,e);var t=kDe(r);function r(n){return xDe(this,r),t.call(this,null,n)}return TDe(r,[{key:"adjust",value:function(){var i=this.table,a=i.columnHeadersCount,o=i.rowHeadersCount,s=this.rootNode.firstChild;if(a){for(var l=this.table.columnsToRender,u=l+o,f=0,c=a;f<c;f++){for(s=this.rootNode.childNodes[f],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>a)for(var d=a;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&mo(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,a=0;a<i;a+=1)for(var o=this.table,s=o.columnHeaderFunctions,l=o.columnsToRender,u=o.rowHeadersCount,f=this.rootNode.childNodes[a],c=-1*u;c<l;c+=1){var h=this.table.renderedColumnToSource(c),d=f.childNodes[c+u];d.className="",d.removeAttribute("style"),s[a](h,d,a)}}}]),r}(aS);function vv(e){return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vv(e)}function DDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LDe(n.key),n)}}function NDe(e,t,r){return t&&p5(e.prototype,t),r&&p5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LDe(e){var t=FDe(e,"string");return vv(t)==="symbol"?t:String(t)}function FDe(e,t){if(vv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $De(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SM(e,t)}function SM(e,t){return SM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SM(e,t)}function HDe(e){var t=jDe();return function(){var n=yx(e),i;if(t){var a=yx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return BDe(this,i)}}function BDe(e,t){if(t&&(vv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VDe(e)}function VDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yx(e){return yx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yx(e)}var WDe=function(e){$De(r,e);var t=HDe(r);function r(n){return DDe(this,r),t.call(this,null,n)}return NDe(r,[{key:"adjust",value:function(){for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=a+o;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,a=i.columnsToRender,o=i.rowHeadersCount,s=0;s<o;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var f=0;f<a;f++){var c=this.table.renderedColumnToSource(f),h=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[f+o].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&ke(d,"rowHeader")}}]),r}(aS);function pv(e){return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pv(e)}var g5;function UDe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function zDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YDe(n.key),n)}}function GDe(e,t,r){return t&&y5(e.prototype,t),r&&y5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YDe(e){var t=KDe(e,"string");return pv(t)==="symbol"?t:String(t)}function KDe(e,t){if(pv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_M(e,t)}function _M(e,t){return _M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_M(e,t)}function qDe(e){var t=QDe();return function(){var n=mx(e),i;if(t){var a=mx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ZDe(this,i)}}function ZDe(e,t){if(t&&(pv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JDe(e)}function JDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mx(e){return mx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mx(e)}var m5=!1,eNe=function(e){XDe(r,e);var t=qDe(r);function r(n){var i;return zDe(this,r),i=t.call(this,"TR",n),i.orderView=new Pte(n,function(a){return i.nodesPool.obtain(a)},i.nodeType),i}return GDe(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!m5&&i>1e3&&(m5=!0,gr(sr(g5||(g5=UDe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var a=0;a<i;a++)this.orderView.render();this.orderView.end()}}]),r}(aS);function gv(e){return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gv(e)}function tNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nNe(n.key),n)}}function rNe(e,t,r){return t&&b5(e.prototype,t),r&&b5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nNe(e){var t=iNe(e,"string");return gv(t)==="symbol"?t:String(t)}function iNe(e,t){if(gv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CM(e,t)}function CM(e,t){return CM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CM(e,t)}function oNe(e){var t=uNe();return function(){var n=bx(e),i;if(t){var a=bx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return sNe(this,i)}}function sNe(e,t){if(t&&(gv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lNe(e)}function lNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bx(e){return bx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bx(e)}var fNe=function(e){aNe(r,e);var t=oNe(r);function r(){var n;return tNe(this,r),n=t.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return rNe(r,[{key:"obtainOrderView",value:function(i){var a=this,o;return this.orderViews.has(i)?o=this.orderViews.get(i):(o=new Ite(i,function(s){return a.nodesPool.obtain(a.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,o)),o}},{key:"render",value:function(){for(var i=this.table,a=i.rowsToRender,o=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<a;u++){var f=this.table.renderedRowToSource(u),c=s.getRenderedNode(u);this.sourceRowIndex=f;var h=this.obtainOrderView(c),d=l.obtainOrderView(c);h.prependView(d).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<o;v++){h.render();var p=h.getCurrentNode(),g=this.table.renderedColumnToSource(v);bt(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),this.table.cellRenderer(f,g,p)}h.end()}}}]),r}(aS);function C0(e){return C0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C0(e)}function cNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dNe(n.key),n)}}function hNe(e,t,r){return t&&w5(e.prototype,t),r&&w5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dNe(e){var t=vNe(e,"string");return C0(t)==="symbol"?t:String(t)}function vNe(e,t){if(C0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(C0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pNe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;cNe(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return hNe(e,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,a=r.colGroup,o=r.rows,s=r.cells;n.setTable(this),i.setTable(this),a.setTable(this),o.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=a,this.rows=o,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var a=n.getRenderedNode(i);if(a.firstChild){var o=this.renderedRowToSource(i),s=this.rowUtils.getHeight(o);s?a.firstChild.style.height="".concat(s-1,"px"):a.firstChild.style.height=""}}}}]),e}();function x0(e){return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x0(e)}function gNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mNe(n.key),n)}}function yNe(e,t,r){return t&&S5(e.prototype,t),r&&S5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mNe(e){var t=bNe(e,"string");return x0(t)==="symbol"?t:String(t)}function bNe(e,t){if(x0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(x0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wNe=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.TABLE,n=t.THEAD,i=t.COLGROUP,a=t.TBODY,o=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;gNe(this,e),this.renderer=new pNe(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new CDe,columnHeaders:new MDe(n),colGroup:new WDe(i),rows:new eNe(a),cells:new fNe}),this.renderer.setAxisUtils(o,s)}return yNe(e,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function T0(e){return T0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T0(e)}function SNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CNe(n.key),n)}}function _Ne(e,t,r){return t&&_5(e.prototype,t),r&&_5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CNe(e){var t=xNe(e,"string");return T0(t)==="symbol"?t:String(t)}function xNe(e,t){if(T0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(T0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TNe=function(){function e(t,r){SNe(this,e),this.dataAccessObject=t,this.wtSettings=r,this.headerWidths=new Map}return _Ne(e,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var a=n.getStretchedColumnWidth(r,i);a&&(i=a)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,a=n.wtViewport,o=n.cloneSource,s=o?o.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?Sn():0,u=r.getSetting("rowHeaderWidth");if(a.columnsRenderCalculator.refreshStretching(a.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var f=r.getSetting("rowHeaders").length,c=r.getSetting("defaultColumnWidth"),h=0;h<f;h++){var d=Array.isArray(u)?u[h]:u;d=d??c,this.headerWidths.set(h,d)}}}]),e}();function O0(e){return O0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O0(e)}function ONe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RNe(n.key),n)}}function ENe(e,t,r){return t&&C5(e.prototype,t),r&&C5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RNe(e){var t=kNe(e,"string");return O0(t)==="symbol"?t:String(t)}function kNe(e,t){if(O0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(O0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ANe=function(){function e(t,r){ONe(this,e),this.dataAccessObject=t,this.wtSettings=r}return ENe(e,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),e}();function E0(e){return E0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E0(e)}function PNe(e){return DNe(e)||MNe(e)||Mte(e)||INe()}function INe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DNe(e){if(Array.isArray(e))return xM(e)}function NNe(e,t){return $Ne(e)||FNe(e,t)||Mte(e,t)||LNe()}function LNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mte(e,t){if(e){if(typeof e=="string")return xM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xM(e,t)}}function xM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function $Ne(e){if(Array.isArray(e))return e}function HNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dte(n.key),n)}}function BNe(e,t,r){return t&&x5(e.prototype,t),r&&x5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eo(e,t,r){return t=Dte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dte(e){var t=VNe(e,"string");return E0(t)==="symbol"?t:String(t)}function VNe(e,t){if(E0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(E0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jNe=function(){function e(t,r,n,i,a){var o=this;HNe(this,e),Eo(this,"wtSettings",null),Eo(this,"domBindings",void 0),Eo(this,"TBODY",null),Eo(this,"THEAD",null),Eo(this,"COLGROUP",null),Eo(this,"hasTableHeight",!0),Eo(this,"hasTableWidth",!0),Eo(this,"isTableVisible",!1),Eo(this,"tableOffset",0),Eo(this,"holderOffset",0),this.domBindings=n,this.isMaster=a==="master",this.name=a,this.dataAccessObject=t,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,t$(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return o._modifyRowHeaderWidth(s)}),this.rowUtils=new ANe(this.dataAccessObject,this.wtSettings),this.columnUtils=new TNe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new wNe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return BNe(e,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!bt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!bt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!bt(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,a=i.wtOverlays,o=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),f=u.length,c=n.getSetting("columnHeaders"),h=c.length,d=!1,v=r;if(this.isMaster&&(this.holderOffset=nn(this.holder),v=o.createRenderCalculators(v),f&&!n.getSetting("fixedColumnsStart"))){var p=a.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,g!==this.correctHeaderWidth&&(v=!1)}if(this.isMaster&&(d=a.updateStateOfRendering()),v)this.isMaster&&o.createVisibleCalculators(),a&&a.refresh(!0);else{this.isMaster?this.tableOffset=nn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var y=s>0?this.getFirstRenderedRow():0,m=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new N2e(y,s,h),this.columnFilter=new k2e(m,l,f);var b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var S={};this.wtSettings.getSetting("beforeDraw",!0,S),b=S.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(u,c),(this.is(zo)||this.is(du))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var x;if(this.isMaster&&(x=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(zo))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var T=cr(this.hider),E=cr(this.TABLE);T!==0&&E!==T&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),x!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(zo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var P=!1;return this.isMaster&&(P=a.topOverlay.resetFixedPosition(),a.bottomOverlay.clone&&(P=a.bottomOverlay.resetFixedPosition()||P),P=a.inlineStartOverlay.resetFixedPosition()||P,a.topInlineStartCornerOverlay&&a.topInlineStartCornerOverlay.resetFixedPosition(),a.bottomInlineStartCornerOverlay&&a.bottomInlineStartCornerOverlay.clone&&a.bottomInlineStartCornerOverlay.resetFixedPosition()),P?(a.refreshAll(),a.adjustElementsSize()):this.refreshSelections(v),d&&a.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,a=this.wtSettings.getSetting("defaultRowHeight"),o,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=Ps(s),(!o&&a<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,a=r.getSetting("columnHeaders"),o=0,s=a.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height="".concat(i[o],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(zo))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),a=0;a<i;a++){var o=this.rowFilter.renderedToSource(a);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,a=n.length;i<a;i++)St(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(i){var a=Array.from(i),o=a.length;if(r){for(var s=[],l=0;l<o;l++){for(var u=a[l].settings,f=u.highlightHeaderClassName,c=u.highlightRowClassName,h=u.highlightColumnClassName,d=a[l].classNames,v=d.length,p=0;p<v;p++)s.includes(d[p])||s.push(d[p]);f&&!s.includes(f)&&s.push(f),c&&!s.includes(c)&&s.push(c),h&&!s.includes(h)&&s.push(h)}var g=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var y=0;y<g.length;y++)s.push(g[y]);for(var m=s.length,b=0;b<m;b++)this.removeClassFromCells(s[b])}for(var S=0;S<o;S++)a[S].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,a=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(a&&Array.isArray(a)){var o=NNe(a,2);n=o[0],i=o[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(a){var o=a.childNodes[i];o&&n.push(o)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return a==null?void 0:a.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,a=0;a<i;a++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=o==null?void 0:o.childNodes[a];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=cu(n,["TD","TH"])),n===null)return null;var i=n.parentNode,a=i.parentNode,o=Nee(i),s=n.cellIndex;if(zl(Nc,n,this.wtRootElement)||zl(Mc,n,this.wtRootElement))a.nodeName==="THEAD"&&(o-=a.childNodes.length);else if(zl(du,n,this.wtRootElement)||zl(zo,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");o=l-a.childNodes.length+o}else a===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o);return zl(Nc,n,this.wtRootElement)||zl(Dc,n,this.wtRootElement)||zl(du,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=Ps(this.TBODY)-1,a,o,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),a=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?o=Ps(u):o=Ps(l)-1,(!a&&this.wtSettings.getSetting("defaultRowHeight")<o||a<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return cr(this.TABLE)}},{key:"getHeight",value:function(){return Nr(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=cr(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=Nr(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return ov(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=br(r)?r():null;return Array.isArray(n)?(n=PNe(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),e}();const Rg=jNe;var WNe="stickyRowsBottom",Nte={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=t-r;return t===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};as(Nte,"MIXIN_NAME",WNe,{writable:!1,enumerable:!1});const Lte=Nte;var UNe="stickyColumnsStart",Fte={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};as(Fte,"MIXIN_NAME",UNe,{writable:!1,enumerable:!1});const p$=Fte;function yv(e){return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yv(e)}function T5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GNe(n.key),n)}}function zNe(e,t,r){return t&&T5(e.prototype,t),r&&T5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GNe(e){var t=YNe(e,"string");return yv(t)==="symbol"?t:String(t)}function YNe(e,t){if(yv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TM(e,t)}function TM(e,t){return TM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TM(e,t)}function qNe(e){var t=QNe();return function(){var n=Sx(e),i;if(t){var a=Sx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ZNe(this,i)}}function ZNe(e,t){if(t&&(yv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JNe(e)}function JNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sx(e){return Sx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sx(e)}var g$=function(e){XNe(r,e);var t=qNe(r);function r(n,i,a,o){return KNe(this,r),t.call(this,n,i,a,o,du)}return zNe(r)}(Rg);yr(g$,Lte);yr(g$,p$);const eLe=g$;var Mc="top",zo="bottom",Dc="inline_start",Nc="top_inline_start_corner",du="bottom_inline_start_corner",tLe=[Mc,zo,Dc,Nc,du],rLe=new Map([[Mc,"ht_clone_".concat(Mc)],[zo,"ht_clone_".concat(zo)],[Dc,"ht_clone_".concat(Dc," ht_clone_left")],[Nc,"ht_clone_".concat(Nc," ht_clone_top_left_corner")],[du,"ht_clone_".concat(du," ht_clone_bottom_left_corner")]]);function R0(e){return R0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R0(e)}function nLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$te(n.key),n)}}function iLe(e,t,r){return t&&O5(e.prototype,t),r&&O5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uk(e,t,r){return t=$te(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $te(e){var t=aLe(e,"string");return R0(t)==="symbol"?t:String(t)}function aLe(e,t){if(R0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(R0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oLe=function(){function e(t){nLe(this,e),uk(this,"dataAccessObject",void 0),uk(this,"lastScrolledColumnPos",-1),uk(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return iLe(e,[{key:"scrollViewport",value:function(r,n,i,a,o){var s=this.scrollViewportHorizontally(r.col,i,o),l=this.scrollViewportVertically(r.row,n,a);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalColumns;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedColumnsStart,d=c.inlineStartOverlay;if(f&&r<h)return!1;var v=!1;return l===-1?v=d.scrollTo(r,f?r>this.lastScrolledColumnPos:n):(f&&(r<l||r>u)||!f)&&(v=d.scrollTo(r,f?r>u:n)),v&&(this.lastScrolledColumnPos=r),v}},{key:"scrollViewportVertically",value:function(r,n,i){var a=this.dataAccessObject,o=a.drawn,s=a.totalRows;if(!o||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),f=n===void 0&&i===void 0,c=this.dataAccessObject,h=c.fixedRowsBottom,d=c.fixedRowsTop,v=c.topOverlay;if(f&&(r<d||r>s-h-1))return!1;var p=!1;return l===-1?p=v.scrollTo(r,f?r>this.lastScrolledRowPos:i):(f&&(r<l||r>u)||!f)&&(p=v.scrollTo(r,f?r>u:i)),p&&(this.lastScrolledRowPos=r),p}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var f=nn(i.wtRootElement),c=Ps(i.hider),h=Ps(l),d=a0(l,l);if(f.top+c-h<=d){var v=a.getColumnHeaderHeight();v+=n.sumCellSizes(0,s);for(var p=o;p>0;p--)if(v+=n.sumCellSizes(p-1,p),f.top+c-v<=d){u=p;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=nn(i.wtRootElement),f=a0(s,s);if(u.top>f){for(var c=Ps(s),h=a.getColumnHeaderHeight(),d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-f>=c){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,a=r.wtViewport,o=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=nn(i.wtRootElement),f=vm(i.hider),c=vm(s),h=Math.abs(ox(s,s));if(u.left+f-c<=h){for(var d=a.getRowHeaderWidth(),v=o;v>0;v--)if(d+=n.sumCellSizes(v-1,v),u.left+f-d<=h){l=v;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,a=r.wtTable,o=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=a.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var f=n.getSetting("rtlMode"),c=null;if(f){var h=a.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,v=d.documentElement.offsetWidth;c=Math.abs(h.right-v)}else{var p=nn(a.wtRootElement);c=p.left}var g=Math.abs(ox(l,l));if(c>g){for(var y=vm(l),m=o.getRowHeaderWidth(),b=1;b<=s;b++)if(m+=i.sumCellSizes(b-1,b),c+m-g>=y){u=b-2;break}}}return u}}]),e}();const sLe=oLe;function k0(e){return k0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k0(e)}function lLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hte(n.key),n)}}function uLe(e,t,r){return t&&E5(e.prototype,t),r&&E5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wa(e,t,r){return t=Hte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hte(e){var t=fLe(e,"string");return k0(t)==="symbol"?t:String(t)}function fLe(e,t){if(k0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(k0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y$=function(){function e(t,r){lLe(this,e),Wa(this,"wtTable",void 0),Wa(this,"wtScroll",void 0),Wa(this,"wtViewport",void 0),Wa(this,"wtOverlays",void 0),Wa(this,"selections",void 0),Wa(this,"wtEvent",void 0),Wa(this,"guid","wt_".concat(JF())),Wa(this,"drawInterrupted",!1),Wa(this,"drawn",!1),Wa(this,"domBindings",void 0),Wa(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new sLe(this.createScrollDao())}return uLe(e,[{key:"eventManager",get:function(){return new Fr(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(a,o){ku(o,r[a])}])}}},{key:"createCellCoords",value:function(r,n){return new cx(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new d$(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),a=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<a&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<a)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,a,o){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function mv(e){return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mv(e)}function R5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bte(n.key),n)}}function cLe(e,t,r){return t&&R5(e.prototype,t),r&&R5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OM(e,t)}function OM(e,t){return OM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OM(e,t)}function vLe(e){var t=gLe();return function(){var n=_x(e),i;if(t){var a=_x(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pLe(this,i)}}function pLe(e,t){if(t&&(mv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tC(e)}function tC(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _x(e){return _x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_x(e)}function k5(e,t,r){return t=Bte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bte(e){var t=yLe(e,"string");return mv(t)==="symbol"?t:String(t)}function yLe(e,t){if(mv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mLe=function(e){dLe(r,e);var t=vLe(r);function r(n,i,a){var o;hLe(this,r),o=t.call(this,n,i),k5(tC(o),"cloneSource",void 0),k5(tC(o),"cloneOverlay",void 0);var s=o.wtSettings.getSetting("facade",tC(o));return o.cloneSource=a.source,o.cloneOverlay=a.overlay,o.wtTable=o.cloneOverlay.createTable(o.getTableDao(),s,o.domBindings,o.wtSettings),o.wtViewport=a.viewport,o.selections=a.selections,o.wtEvent=new Ate(s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections,a.event),o.findOriginalHeaders(),o}return cLe(r)}(y$);function A0(e){return A0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A0(e)}function bLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vte(n.key),n)}}function wLe(e,t,r){return t&&A5(e.prototype,t),r&&A5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SLe(e,t,r){return t=Vte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vte(e){var t=_Le(e,"string");return A0(t)==="symbol"?t:String(t)}function _Le(e,t){if(A0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(A0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oS=function(){function e(t,r,n,i,a){bLe(this,e),SLe(this,"wtSettings",null),as(this,"wot",t,{writable:!1}),this.domBindings=a,this.facadeGetter=r,this.wtSettings=i;var o=this.wot.wtTable,s=o.TABLE,l=o.hider,u=o.spreader,f=o.holder,c=o.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=f,this.wtRootElement=c,this.trimmingContainer=lv(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return wLe(e,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=lv(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=o0(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){gr("The provided element is not a child of the ".concat(this.type," overlay"));return}var a=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,f={start:this.getRelativeStartPosition(u),top:u.offsetTop},c={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return a?h=this.getRelativeCellPositionWithinWindow(s,o,c,f):h=this.getRelativeCellPositionWithinHolder(s,l,o,c,f),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,a){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=a.start;else{var u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Sn())),s=u<=0?-1*u:0}if(r){var f=this.clone.wtTable.TABLE.getBoundingClientRect();l=f.top-o.top}else l=a.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,a,o){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-o.start),n){var f=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();u=c.top*-1+f.top}else r||(u=s.vertical-o.top);return{start:a.start-l,top:a.top-u}}},{key:"makeClone",value:function(){if(tLe.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;o.className="".concat(rLe.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,s.className=r.TABLE.className,o.appendChild(s),l.appendChild(o);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Mc||u==="vertical"&&this.type===Dc?this.mainTableScrollableElement=a:a.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=o0(r.TABLE),new mLe(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,a=n.style,o=r.parentNode.style;ne([i,a,o],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function bv(e){return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bv(e)}function rC(e,t,r){return jte()?rC=Reflect.construct.bind():rC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&Cx(u,o.prototype),u},rC.apply(null,arguments)}function CLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TLe(n.key),n)}}function xLe(e,t,r){return t&&P5(e.prototype,t),r&&P5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TLe(e){var t=OLe(e,"string");return bv(t)==="symbol"?t:String(t)}function OLe(e,t){if(bv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ELe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cx(e,t)}function Cx(e,t){return Cx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Cx(e,t)}function RLe(e){var t=jte();return function(){var n=xx(e),i;if(t){var a=xx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return kLe(this,i)}}function kLe(e,t){if(t&&(bv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ALe(e)}function ALe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xx(e){return xx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xx(e)}var PLe=function(e){ELe(r,e);var t=RLe(r);function r(n,i,a,o,s,l){var u;return CLe(this,r),u=t.call(this,n,i,du,a,o),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return xLe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return rC(eLe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var a=this.clone.wtTable.holder.parentNode;if(a.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();a.style[this.isRtl()?"right":"left"]="".concat(o,"px"),a.style.bottom="".concat(s,"px")}else Qw(a),this.repositionOverlay();var l=Nr(this.clone.wtTable.TABLE),u=cr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),a.style.height="".concat(l,"px"),a.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=Sn(s)),l.style.bottom="".concat(u,"px")}}]),r}(oS),ILe="calculatedColumns",Wte={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};as(Wte,"MIXIN_NAME",ILe,{writable:!1,enumerable:!1});const m$=Wte;function wv(e){return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wv(e)}function I5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DLe(n.key),n)}}function MLe(e,t,r){return t&&I5(e.prototype,t),r&&I5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DLe(e){var t=NLe(e,"string");return wv(t)==="symbol"?t:String(t)}function NLe(e,t){if(wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EM(e,t)}function EM(e,t){return EM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EM(e,t)}function $Le(e){var t=VLe();return function(){var n=Tx(e),i;if(t){var a=Tx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return HLe(this,i)}}function HLe(e,t){if(t&&(wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BLe(e)}function BLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tx(e){return Tx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tx(e)}var b$=function(e){FLe(r,e);var t=$Le(r);function r(n,i,a,o){return LLe(this,r),t.call(this,n,i,a,o,zo)}return MLe(r)}(Rg);yr(b$,Lte);yr(b$,m$);const jLe=b$;function Sv(e){return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sv(e)}function nC(e,t,r){return zte()?nC=Reflect.construct.bind():nC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&Ox(u,o.prototype),u},nC.apply(null,arguments)}function WLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gte(n.key),n)}}function ULe(e,t,r){return t&&M5(e.prototype,t),r&&M5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ox(e,t)}function Ox(e,t){return Ox=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ox(e,t)}function GLe(e){var t=zte();return function(){var n=Ex(e),i;if(t){var a=Ex(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return YLe(this,i)}}function YLe(e,t){if(t&&(Sv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ute(e)}function Ute(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ex(e){return Ex=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ex(e)}function KLe(e,t,r){return t=Gte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gte(e){var t=XLe(e,"string");return Sv(t)==="symbol"?t:String(t)}function XLe(e,t){if(Sv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qLe=function(e){zLe(r,e);var t=GLe(r);function r(n,i,a,o){var s;return WLe(this,r),s=t.call(this,n,i,zo,a,o),KLe(Ute(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return ULe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return nC(jLe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode;a.style.top="";var o=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(o=this.getOverlayOffset(),a.style.bottom="".concat(o,"px")):(o=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;o.hasVerticalScroll()||(u+=o.getWorkspaceHeight()-a.getTotalHeight()),o.hasVerticalScroll()&&o.hasHorizontalScroll()&&(u+=Sn(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a?(a.scrollTo(Ic(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wot,s=o.wtTable,l=o.wtSettings,u=l.getSetting("defaultRowHeight"),f=i,c=0;f<a;){var h=s.getRowHeight(f);c+=h===void 0?u:h,f+=1}return c}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,a=i.wtTable,o=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,f=Sn(l),c=this.clone.wtTable.holder.parentNode,h=c.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var v=o.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(v-=f),v=Math.min(v,a.wtRootElement.scrollWidth),h.width="".concat(v,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var p=Nr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(p=0),h.height="".concat(p,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;a&&l.offsetHeight!==l.clientHeight&&(u=Sn(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return a0(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,f=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-f+s,0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==a,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((o||a===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,f=bt(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(ke(u,"innerBorderBottom"),l=!f):(St(u,"innerBorderBottom"),l=f)}return l}}]),r}(oS),ZLe="calculatedRows",Yte={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};as(Yte,"MIXIN_NAME",ZLe,{writable:!1,enumerable:!1});const Kte=Yte;function _v(e){return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_v(e)}function D5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QLe(n.key),n)}}function JLe(e,t,r){return t&&D5(e.prototype,t),r&&D5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QLe(e){var t=eFe(e,"string");return _v(t)==="symbol"?t:String(t)}function eFe(e,t){if(_v(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RM(e,t)}function RM(e,t){return RM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RM(e,t)}function nFe(e){var t=oFe();return function(){var n=Rx(e),i;if(t){var a=Rx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return iFe(this,i)}}function iFe(e,t){if(t&&(_v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aFe(e)}function aFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rx(e){return Rx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rx(e)}var w$=function(e){rFe(r,e);var t=nFe(r);function r(n,i,a,o){return tFe(this,r),t.call(this,n,i,a,o,Dc)}return JLe(r)}(Rg);yr(w$,Kte);yr(w$,p$);const sFe=w$;function Cv(e){return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cv(e)}function iC(e,t,r){return Xte()?iC=Reflect.construct.bind():iC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&kx(u,o.prototype),u},iC.apply(null,arguments)}function lFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fFe(n.key),n)}}function uFe(e,t,r){return t&&N5(e.prototype,t),r&&N5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fFe(e){var t=cFe(e,"string");return Cv(t)==="symbol"?t:String(t)}function cFe(e,t){if(Cv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kx(e,t)}function kx(e,t){return kx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kx(e,t)}function dFe(e){var t=Xte();return function(){var n=Ax(e),i;if(t){var a=Ax(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return vFe(this,i)}}function vFe(e,t){if(t&&(Cv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pFe(e)}function pFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ax(e){return Ax=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ax(e)}var gFe=function(e){hFe(r,e);var t=dFe(r);function r(n,i,a,o){return lFe(this,r),t.call(this,n,i,Dc,a,o)}return uFe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return iC(sFe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var a=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===a&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),FO(o,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),Qw(o));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===a&&a.scrollX!==i?(a.scrollTo(i,sv(a)),o=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<a;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||o,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=Sn(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),f.height="".concat(h,"px")}else f.height="";this.clone.wtTable.holder.style.height=f.height;var d=cr(this.clone.wtTable.TABLE);f.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,a.style.height=a.parentNode.style.height,a.style.width="".concat(parseInt(a.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),a=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[a]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[a]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,a){var o=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(a){var f=this.wot.wtTable.getColumnWidth(i),c=this.wot.wtViewport.getViewportWidth();f>c&&(a=!1)}return a&&l.offsetWidth!==l.clientWidth&&(u=Sn(this.domBindings.rootDocument)),a?(o+=this.sumCellSizes(0,i+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),o+=u,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),a=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(a=this.wot.wtTable.holderOffset.left),a}},{key:"getScrollPosition",value:function(){return Math.abs(ox(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="horizontal")){this.isRtl()?o=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?St(a,"emptyRows"):ke(a,"emptyRows");var u=!1;if(s&&!o.length)ke(a,"innerBorderLeft innerBorderInlineStart");else if(!s&&o.length){var f=bt(a,"innerBorderInlineStart");i?(ke(a,"innerBorderLeft innerBorderInlineStart"),u=!f):(St(a,"innerBorderLeft innerBorderInlineStart"),u=f)}return u}}]),r}(oS),yFe="stickyRowsTop",qte={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};as(qte,"MIXIN_NAME",yFe,{writable:!1,enumerable:!1});const Zte=qte;function xv(e){return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(e)}function L5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bFe(n.key),n)}}function mFe(e,t,r){return t&&L5(e.prototype,t),r&&L5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bFe(e){var t=wFe(e,"string");return xv(t)==="symbol"?t:String(t)}function wFe(e,t){if(xv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Fe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kM(e,t)}function kM(e,t){return kM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kM(e,t)}function CFe(e){var t=OFe();return function(){var n=Px(e),i;if(t){var a=Px(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return xFe(this,i)}}function xFe(e,t){if(t&&(xv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TFe(e)}function TFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Px(e){return Px=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Px(e)}var S$=function(e){_Fe(r,e);var t=CFe(r);function r(n,i,a,o){return SFe(this,r),t.call(this,n,i,a,o,Nc)}return mFe(r)}(Rg);yr(S$,Zte);yr(S$,p$);const EFe=S$;function Tv(e){return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tv(e)}function aC(e,t,r){return Jte()?aC=Reflect.construct.bind():aC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&Ix(u,o.prototype),u},aC.apply(null,arguments)}function RFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qte(n.key),n)}}function kFe(e,t,r){return t&&F5(e.prototype,t),r&&F5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function AFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ix(e,t)}function Ix(e,t){return Ix=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Ix(e,t)}function PFe(e){var t=Jte();return function(){var n=Mx(e),i;if(t){var a=Mx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return IFe(this,i)}}function IFe(e,t){if(t&&(Tv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AM(e)}function AM(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mx(e){return Mx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mx(e)}function $5(e,t,r){return t=Qte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qte(e){var t=MFe(e,"string");return Tv(t)==="symbol"?t:String(t)}function MFe(e,t){if(Tv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DFe=function(e){AFe(r,e);var t=PFe(r);function r(n,i,a,o,s,l){var u;return RFe(this,r),u=t.call(this,n,i,Nc,a,o),$5(AM(u),"topOverlay",void 0),$5(AM(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return kFe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return aC(EFe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();FO(i,"".concat(a,"px"),"".concat(o,"px"))}else Qw(i);var s=Nr(this.clone.wtTable.TABLE),l=cr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}(oS);function Ov(e){return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ov(e)}function H5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LFe(n.key),n)}}function NFe(e,t,r){return t&&H5(e.prototype,t),r&&H5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LFe(e){var t=FFe(e,"string");return Ov(t)==="symbol"?t:String(t)}function FFe(e,t){if(Ov(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PM(e,t)}function PM(e,t){return PM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PM(e,t)}function BFe(e){var t=WFe();return function(){var n=Dx(e),i;if(t){var a=Dx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return VFe(this,i)}}function VFe(e,t){if(t&&(Ov(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jFe(e)}function jFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dx(e){return Dx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dx(e)}var _$=function(e){HFe(r,e);var t=BFe(r);function r(n,i,a,o){return $Fe(this,r),t.call(this,n,i,a,o,Mc)}return NFe(r)}(Rg);yr(_$,Zte);yr(_$,m$);const UFe=_$;function Ev(e){return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ev(e)}function oC(e,t,r){return tre()?oC=Reflect.construct.bind():oC=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&Nx(u,o.prototype),u},oC.apply(null,arguments)}function zFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rre(n.key),n)}}function GFe(e,t,r){return t&&B5(e.prototype,t),r&&B5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function YFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nx(e,t)}function Nx(e,t){return Nx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Nx(e,t)}function KFe(e){var t=tre();return function(){var n=Lx(e),i;if(t){var a=Lx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return XFe(this,i)}}function XFe(e,t){if(t&&(Ev(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ere(e)}function ere(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lx(e){return Lx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lx(e)}function qFe(e,t,r){return t=rre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rre(e){var t=ZFe(e,"string");return Ev(t)==="symbol"?t:String(t)}function ZFe(e,t){if(Ev(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JFe=function(e){YFe(r,e);var t=KFe(r);function r(n,i,a,o){var s;return zFe(this,r),s=t.call(this,n,i,Mc,a,o),qFe(ere(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return GFe(r,[{key:"createTable",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return oC(UFe,a)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,a=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===a&&(!o||o!=="vertical")){var u=this.wot.wtTable,f=u.hider.getBoundingClientRect(),c=Math.ceil(f.bottom),h=i.offsetHeight;l=c===h,s=this.getOverlayOffset(),FO(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),Qw(i);var d=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(i){var a=this.domBindings.rootWindow,o=!1;return this.mainTableScrollableElement===a&&a.scrollY!==i?(a.scrollTo(Ic(a),i),o=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,o=!0),o}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,a){for(var o=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<a;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?o:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,a=this.domBindings,o=a.rootDocument,s=a.rootWindow,l=Sn(o),u=this.clone.wtTable.holder.parentNode,f=u.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||c==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),f.width="".concat(h,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var d=Nr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),f.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,a=this.clone.wtTable.holder,o=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=o==null?void 0:o.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,a.style.width=a.parentNode.style.width,a.style.height="".concat(parseInt(a.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",a=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?a.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):a.style[i]=""}},{key:"scrollTo",value:function(i,a){var o=this.wot,s=this.wtSettings,l=o.cloneSource?o.cloneSource:o,u=l.wtTable.holder,f=this.getTableParentOffset(),c=0;if(a){var h=this.wot.wtTable.getRowHeight(i),d=this.wot.wtViewport.getViewportHeight();h>d&&(a=!1)}if(a&&u.offsetHeight!==u.clientHeight&&(c=Sn(this.domBindings.rootDocument)),a){var v=s.getSetting("fixedRowsBottom"),p=s.getSetting("totalRows");f+=this.sumCellSizes(0,i+1),f-=o.wtViewport.getViewportHeight()-this.sumCellSizes(p-v,p),f+=1}else f+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return f+=c,this.setScrollPosition(f)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return a0(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),o=0;if(this.trimmingContainer===i&&(!a||a!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>u&&(o=0)}return o}},{key:"adjustHeaderBordersPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?St(o,"emptyColumns"):ke(o,"emptyColumns");var l=!1;if(!a){var u=this.wtSettings.getSetting("fixedRowsTop"),f=this.cachedFixedRowsTop!==u,c=this.wtSettings.getSetting("columnHeaders");if((f||u===0)&&c.length>0){var h=bt(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(ke(o,"innerBorderTop"),l=!h):(St(o,"innerBorderTop"),l=h)}}return l}}]),r}(oS);function P0(e){return P0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P0(e)}function ql(e,t,r){return QFe()?ql=Reflect.construct.bind():ql=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),u=new l;return o&&IM(u,o.prototype),u},ql.apply(null,arguments)}function QFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function IM(e,t){return IM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IM(e,t)}function e$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nre(n.key),n)}}function t$e(e,t,r){return t&&V5(e.prototype,t),r&&V5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ps(e,t,r){return t=nre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nre(e){var t=r$e(e,"string");return P0(t)==="symbol"?t:String(t)}function r$e(e,t){if(P0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(P0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n$e=function(){function e(t,r,n,i,a,o){var s=this;e$e(this,e),ps(this,"wot",null),ps(this,"topOverlay",null),ps(this,"bottomOverlay",null),ps(this,"inlineStartOverlay",null),ps(this,"topInlineStartCornerOverlay",null),ps(this,"bottomInlineStartCornerOverlay",null),ps(this,"browserLineHeight",void 0),ps(this,"wtSettings",null),ps(this,"resizeObserver",new ResizeObserver(function(h){_O(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;var l=this.domBindings,u=l.rootDocument,f=l.rootWindow;this.instance=this.wot,this.eventManager=a,this.scrollbarSize=Sn(u);var c=f.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:o0(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=f.scrollX,this.lastScrollY=f.scrollY}return t$e(e,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,a=n.getComputedStyle(i.body),o=parseInt(a.lineHeight,10),s=parseInt(a.fontSize,10)*1.2;this.browserLineHeight=o||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ql(JFe,r),this.bottomOverlay=ql(qLe,r),this.inlineStartOverlay=ql(gFe,r),this.topInlineStartCornerOverlay=ql(DFe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ql(PLe,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(v){return r.onKeyDown(v)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(o,"scroll",function(v){return r.onTableScroll(v)},{passive:!0}),o!==s&&this.eventManager.addEventListener(s,"scroll",function(v){return r.onTableScroll(v)},{passive:!0});var l=a.devicePixelRatio&&a.devicePixelRatio>1,u=this.scrollableElement===a,f=this.wtSettings.getSetting("preventWheel"),c={passive:u};(f||l||!kF())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(v){return r.onCloneWheel(v,f)},c);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(v){if(v&&v.needFullRender){var p=v.clone.wtTable.holder;r.eventManager.addEventListener(p,"wheel",function(g){return r.onCloneWheel(g,f)},c)}});var d;this.eventManager.addEventListener(a,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,o=r.target;this.keyPressed&&(a!==n&&o!==n&&!r.target.contains(a)||i!==n&&o!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,a=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=r.target,l=o!==i&&s!==i&&!s.contains(o),u=a!==i&&s!==i&&!s.contains(a);if(!(this.keyPressed&&(l||u))){var f=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&f)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=fv(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var a=this.scrollVertically(n),o=this.scrollHorizontally(i);return a||o}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,a=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=a[0],s=a[1];if(this.horizontalScrolling=n.scrollLeft!==o||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=o;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=o)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=o0(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,a=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return a&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),a}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,a=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,a),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var f=i.wtRootElement,c=f.scrollHeight,h=f.scrollWidth,d=i.holder,v=d.scrollHeight,p=d.scrollWidth;this.hasScrollbarRight=c<v,this.hasScrollbarBottom=h<p,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return ne(n,function(a){a&&a.clone&&a.clone.wtTable.TABLE.contains(r)&&(i=a.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];ne(n,function(i){i&&(i.clone.wtTable.TABLE.className=r.className)})}}]),e}();const i$e=n$e;function I0(e){return I0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I0(e)}function a$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ire(n.key),n)}}function o$e(e,t,r){return t&&j5(e.prototype,t),r&&j5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W5(e,t,r){return t=ire(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ire(e){var t=s$e(e,"string");return I0(t)==="symbol"?t:String(t)}function s$e(e,t){if(I0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(I0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l$e=function(){function e(t){var r=this;a$e(this,e),W5(this,"settings",{}),W5(this,"defaults",Object.freeze(this.getDefaults())),It(this.defaults,function(n,i){if(t[i]!==void 0)r.settings[i]=t[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return o$e(e,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,a,o){var s=r.getSetting("data",i,a);ku(o,s??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?It(r,function(a,o){i.settings[o]=a}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,a,o){return typeof this.settings[r]=="function"?this.settings[r](n,i,a,o):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),e}();function Rv(e){return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rv(e)}function u$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c$e(n.key),n)}}function f$e(e,t,r){return t&&U5(e.prototype,t),r&&U5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c$e(e){var t=h$e(e,"string");return Rv(t)==="symbol"?t:String(t)}function h$e(e,t){if(Rv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MM(e,t)}function MM(e,t){return MM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MM(e,t)}function v$e(e){var t=y$e();return function(){var n=Fx(e),i;if(t){var a=Fx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return p$e(this,i)}}function p$e(e,t){if(t&&(Rv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g$e(e)}function g$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fx(e){return Fx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fx(e)}var C$=function(e){d$e(r,e);var t=v$e(r);function r(n,i,a,o){return u$e(this,r),t.call(this,n,i,a,o,"master")}return f$e(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=lv(this.wtRootElement),a=this.domBindings.rootWindow;if(i===a){var o=this.wtSettings.getSetting("preventOverflow");o||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=uv(i,"height",a),u=uv(i,"overflow",a),f=this.holder.style,c=i.scrollWidth,h=i.scrollHeight,d=i.getBoundingClientRect(),v=d.width,p=d.height,g=["auto","hidden","scroll"];if(s&&g.includes(u)){var y=i.cloneNode(!1);y.style.overflow="auto",y.style.position="absolute",i.nextElementSibling?s.insertBefore(y,i.nextElementSibling):s.appendChild(y);var m=parseInt(Au(y,a).height,10);s.removeChild(y),m===0&&(p=0)}p=Math.min(p,h),f.height=l==="auto"?"auto":"".concat(p,"px"),v=Math.min(v,c),f.width="".concat(v,"px"),f.overflow="",this.hasTableHeight=f.height==="auto"?!0:p>0,this.hasTableWidth=v>0}this.isTableVisible=ov(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,a=this.dataAccessObject.wtViewport,o="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!a.hasOversizedColumnHeadersMarked[o]){for(var u=i.getSetting("rowHeaders"),f=u.length,c=this.getRenderedColumnsCount(),h=0;h<l;h++)for(var d=-1*f;d<c;d++)this.markIfOversizedColumnHeader(d);a.hasOversizedColumnHeadersMarked[o]=!0}}}]),r}(Rg);yr(C$,Kte);yr(C$,m$);const m$e=C$;function M0(e){return M0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M0(e)}function b$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S$e(n.key),n)}}function w$e(e,t,r){return t&&z5(e.prototype,t),r&&z5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S$e(e){var t=_$e(e,"string");return M0(t)==="symbol"?t:String(t)}function _$e(e,t){if(M0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(M0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C$e=function(){function e(t,r,n,i,a){var o=this;b$e(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=a,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){o.clientHeight=o.getWorkspaceHeight()})}return w$e(e,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var a=Nr(n);i=a>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,a=n.rootWindow,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),f=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),h=f?c.right-s:c.left,d=s-h,v,p;if(u)return cr(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?v=Math.min(d,s):v=Math.min(this.getContainerFillWidth(),d,s),o===a&&l>0&&this.sumColumnWidths(0,l-1)>v)return i.documentElement.clientWidth;if(o!==a&&(p=uv(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",a),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(v,o.clientWidth);var g=r.getSetting("stretchH");return g==="none"||!g?Math.max(v,cr(this.wtTable.TABLE)):v}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,a=r;a<n;)i+=this.wtTable.getColumnWidth(a),a+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return nn(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Nr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,a=n.length;i<a;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)o?(this.rowHeaderWidth+=cr(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hf,n=this.wtSettings,i=this.wtTable,a,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===Hf?a=1/0:a=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),f=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,a-=s),f&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-f,c),a-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=Sn(this.domBindings.rootDocument),new wte({viewportSize:a,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return i.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:o})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hf,n=this.wtSettings,i=this.wtTable,a=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&o>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=l,a-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(a-=Sn(this.domBindings.rootDocument)),new h$({viewportSize:a,scrollOffset:o,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(f){return i.getColumnWidth(f)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(f,c){return n.getSetting("onBeforeStretchingColumnWidth",f,c)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(jn),a=this.createColumnsCalculator(jn);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(a)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Hf),this.columnsRenderCalculator=this.createColumnsCalculator(Hf)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(jn),this.columnsVisibleCalculator=this.createColumnsCalculator(jn)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.rowsRenderCalculator,s=o.startRow,l=o.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,a=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!a;var o=this.columnsRenderCalculator,s=o.startColumn,l=o.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){It(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),e}();const x$e=C$e;function kv(e){return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(e)}function T$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E$e(n.key),n)}}function O$e(e,t,r){return t&&G5(e.prototype,t),r&&G5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function E$e(e){var t=R$e(e,"string");return kv(t)==="symbol"?t:String(t)}function R$e(e,t){if(kv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DM(e,t)}function DM(e,t){return DM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DM(e,t)}function A$e(e){var t=I$e();return function(){var n=$x(e),i;if(t){var a=$x(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return P$e(this,i)}}function P$e(e,t){if(t&&(kv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NM(e)}function NM(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I$e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $x(e){return $x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$x(e)}var M$e=function(e){k$e(r,e);var t=A$e(r);function r(n,i){var a;T$e(this,r),a=t.call(this,n,new l$e(i));var o=a.wtSettings.getSetting("facade",NM(a));return a.wtTable=new m$e(a.getTableDao(),o,a.domBindings,a.wtSettings),a.wtViewport=new x$e(a.getViewportDao(),a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.selections=a.wtSettings.getSetting("selections"),a.wtEvent=new Ate(o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections),a.wtOverlays=new i$e(NM(a),o,a.domBindings,a.wtSettings,a.eventManager,a.wtTable),a.exportSettingsAsClassNames(),a.findOriginalHeaders(),a}return O$e(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,a={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},o=[],s=[];It(a,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),o.push(l)}),St(this.wtTable.wtRootElement.parentNode,o),ke(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(y$);function D0(e){return D0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D0(e)}function D$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L$e(n.key),n)}}function N$e(e,t,r){return t&&Y5(e.prototype,t),r&&Y5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function L$e(e){var t=F$e(e,"string");return D0(t)==="symbol"?t:String(t)}function F$e(e,t){if(D0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(D0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $$e=function(){function e(t){D$e(this,e),t instanceof y$?this._wot=t:this._initFromSettings(t)}return N$e(e,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new e(n);return function(){return i}},this._wot=new M$e(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wot.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,a,o){return this._wot.wtSettings.getSetting(r,n,i,a,o)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}(),H$e=on,are=Mt,B$e=Lw,V$e=oa,j$e=Ow.f,W$e=are(j$e),U$e=are([].push),K5=function(e){return function(t){for(var r=V$e(t),n=B$e(r),i=n.length,a=0,o=[],s;i>a;)s=n[a++],(!H$e||W$e(r,s))&&U$e(o,e?[s,r[s]]:r[s]);return o}},z$e={entries:K5(!0),values:K5(!1)},G$e=pt,Y$e=z$e.values;G$e({target:"Object",stat:!0},{values:function(t){return Y$e(t)}});function N0(e){return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N0(e)}function fk(e,t){return Z$e(e)||q$e(e,t)||X$e(e,t)||K$e()}function K$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X$e(e,t){if(e){if(typeof e=="string")return X5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X5(e,t)}}function X5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Z$e(e){if(Array.isArray(e))return e}function J$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eHe(n.key),n)}}function Q$e(e,t,r){return t&&q5(e.prototype,t),r&&q5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eHe(e){var t=tHe(e,"string");return N0(t)==="symbol"?t:String(t)}function tHe(e,t){if(N0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(N0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rHe=function(){function e(t,r){J$e(this,e),r&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return Q$e(e,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(f){return r.onMouseEnter(f,r.main.childNodes[l])})},a=0,o=this.main.childNodes.length;a<o;a++)i(a)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),bo(r);var i=this,a=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(a,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(a,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],a=this.main.style;a.position="absolute",a.top=0,a.left=0;for(var o=0;o<5;o++){var s=i[o],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),a=l.style,a.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,a.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),a.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),oo()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,f=u.bordersHolder;f||(f=n.createElement("div"),f.className="htBorders",u.bordersHolder=f,u.spreader.appendChild(f)),f.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,a=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(a,"px"),width:"".concat(a,"px"),"border-radius":"".concat(parseInt(a/1.5,10),"px")};It(o,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};It(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,a,o,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",f=this.selectionHandles.styles,c=f.top,h=f.topHitArea,d=f.bottom,v=f.bottomHitArea,p=parseInt(c.borderWidth,10),g=parseInt(c.width,10),y=parseInt(h.width,10),m=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();c.top="".concat(parseInt(i-g-1,10),"px"),c[u]="".concat(parseInt(a-g-1,10),"px"),h.top="".concat(parseInt(i-y/4*3,10),"px"),h[u]="".concat(parseInt(a-y/4*3,10),"px");var S=Math.min(parseInt(a+o,10),m-g-p*2),x=Math.min(parseInt(a+o-y/4,10),m-y-p*2);d[u]="".concat(S,"px"),v[u]="".concat(x,"px");var T=Math.min(parseInt(i+s,10),b-g-p*2),E=Math.min(parseInt(i+s-y/4,10),b-y-p*2);d.top="".concat(T,"px"),v.top="".concat(E,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",v.display="none"):(d.display="block",v.display="block")):(c.display="none",d.display="none",h.display="none",v.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",h.zIndex="9999"):(c.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,a=n.rootDocument,o=n.rootWindow,s,l,u,f,c,h,d=i.getRenderedRowsCount(),v=0;v<d;v+=1){var p=i.rowFilter.renderedToSource(v);if(p>=r[0]&&p<=r[2]){s=p,c=r[0];break}}for(var g=d-1;g>=0;g-=1){var y=i.rowFilter.renderedToSource(g);if(y>=r[0]&&y<=r[2]){l=y;break}}for(var m=i.getRenderedColumnsCount(),b=0;b<m;b+=1){var S=i.columnFilter.renderedToSource(b);if(S>=r[1]&&S<=r[3]){u=S,h=r[1];break}}for(var x=m-1;x>=0;x-=1){var T=i.columnFilter.renderedToSource(x);if(T>=r[1]&&T<=r[3]){f=T;break}}if(s===void 0||u===void 0){this.disappear();return}var E=i.getCell(this.wot.createCellCoords(s,u)),P=s!==l||u!==f,R=P?i.getCell(this.wot.createCellCoords(l,f)):E,M=nn(E),D=P?nn(R):M,N=nn(i.TABLE),B=cr(i.TABLE),K=M.top,Z=M.left,ie=this.wot.wtSettings.getSetting("rtlMode"),me=0,k=0;if(ie){var w=cr(E),C=o.innerWidth-N.left-B;k=Z+w-D.left,me=o.innerWidth-Z-w-C-1}else k=D.left+cr(R)-Z,me=Z-N.left-1;if(this.isEntireColumnSelected(s,l)){var O=this.getDimensionsFromHeader("columns",u,f,c,N),_=null;if(O){var A=fk(O,3);_=A[0],me=A[1],k=A[2]}_&&(E=_)}var I=K-N.top-1,L=D.top+Nr(R)-K;if(this.isEntireRowSelected(u,f)){var V=this.getDimensionsFromHeader("rows",s,l,h,N),Y=null;if(V){var ae=fk(V,3);Y=ae[0],I=ae[1],L=ae[2]}Y&&(E=Y)}var re=Au(E,o);parseInt(re.borderTopWidth,10)>0&&(I+=1,L=L>0?L-1:0),parseInt(re[ie?"borderRightWidth":"borderLeftWidth"],10)>0&&(me+=1,k=k>0?k-1:0);var te=ie?"right":"left";this.topStyle.top="".concat(I,"px"),this.topStyle[te]="".concat(me,"px"),this.topStyle.width="".concat(k,"px"),this.topStyle.display="block",this.startStyle.top="".concat(I,"px"),this.startStyle[te]="".concat(me,"px"),this.startStyle.height="".concat(L,"px"),this.startStyle.display="block";var ge=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(I+L-ge,"px"),this.bottomStyle[te]="".concat(me,"px"),this.bottomStyle.width="".concat(k,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(I,"px"),this.endStyle[te]="".concat(me+k-ge,"px"),this.endStyle.height="".concat(L+1,"px"),this.endStyle.display="block";var H=this.settings.border.cornerVisible;H=typeof H=="function"?H(this.settings.layerLevel):H;var Ce=this.wot.getSetting("onModifyGetCellCoords",l,f),oe=l,Oe=f;if(Ce&&Array.isArray(Ce)){var Ee=fk(Ce,4);oe=Ee[2],Oe=Ee[3]}if(oo()||!H||this.isPartRange(oe,Oe))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(I+L+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[te]="".concat(me+k+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var be=lv(i.TABLE),Ie=be===o;Ie&&(be=a.documentElement);var Me=parseInt(this.cornerDefaultStyle.width,10)/2,j=parseInt(this.cornerDefaultStyle.height,10)/2;if(f===this.wot.getSetting("totalColumns")-1){var U=Ie?R.getBoundingClientRect().left:R.offsetLeft,Q=!1,fe=0;ie?(fe=U-parseInt(this.cornerDefaultStyle.width,10)/2,Q=fe<0):(fe=U+cr(R)+parseInt(this.cornerDefaultStyle.width,10)/2,Q=fe>=vm(be)),Q&&(this.cornerStyle[te]="".concat(Math.floor(me+k+this.cornerCenterPointOffset-Me),"px"),this.cornerStyle[ie?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var ee=Ie?R.getBoundingClientRect().top:R.offsetTop,pe=ee+Nr(R)+parseInt(this.cornerDefaultStyle.height,10)/2,se=pe>=Ps(be);se&&(this.cornerStyle.top="".concat(Math.floor(I+L+this.cornerCenterPointOffset-j),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}oo()&&this.updateMultipleSelectionHandlesPosition(l,f,I,me,k,L)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,a,o){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,f=null,c=null,h=null,d=null,v=null,p=null,g=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},f=function(){return Nr.apply(void 0,arguments)},c="ht__selection--rows",v="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},f=function(){return cr.apply(void 0,arguments)},c="ht__selection--columns",v="left";break}if(l.classList.contains(c)){var y=this.wot.getSetting("columnHeaders").length;if(p=u(n,y-a),g=u(i,y-a),!p||!g)return!1;var m=nn(p),b=nn(g);return p&&g&&(h=m[v]-o[v]-1,d=b[v]+f(g)-m[v]),[p,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,a=n[r];!a||a.hide?ke(this[r],"hidden"):(bt(this[r],"hidden")&&St(this[r],"hidden"),i.backgroundColor=a.color,(r==="top"||r==="bottom")&&(i.height="".concat(a.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(a.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?ke(this[r],"hidden"):St(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",oo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}();const nHe=rHe;function iHe(e,t){return lHe(e)||sHe(e,t)||oHe(e,t)||aHe()}function aHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oHe(e,t){if(e){if(typeof e=="string")return Z5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z5(e,t)}}function Z5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function lHe(e){if(Array.isArray(e))return e}function Av(e){return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Av(e)}function uHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cHe(n.key),n)}}function fHe(e,t,r){return t&&J5(e.prototype,t),r&&J5(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cHe(e){var t=hHe(e,"string");return Av(t)==="symbol"?t:String(t)}function hHe(e,t){if(Av(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dHe=function(){function e(t,r){uHe(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return fHe(e,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new nHe(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(Av(s)==="object"){var l=a;o&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),ke(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||o===0)return r;var s=o>=0?o:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(bt(a,u)){var f=s+1;l="".concat(r,"-").concat(f)}else l=i(a,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),a=this.getCorners(),o=iHe(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.settings,h=c.highlightHeaderClassName,d=c.highlightColumnClassName,v=c.highlightRowClassName,p=c.highlightOnlyClosestHeader,g=c.selectionType,y=g===void 0||["active-header","header"].includes(g);if(y&&l!==null&&f!==null)for(var m=0,b=0;b<i;b+=1){var S=r.wtTable.columnFilter.renderedToSource(b);if(S>=l&&S<=f){var x=r.wtTable.getColumnHeaders(S),T=x.length-1;p&&x.length>1&&(x=[x[T]]);for(var E=0;E<x.length;E+=1){var P=[],R=x[E];h&&P.push(h),d&&P.push(d),E=p?T:E;var M=r.getSetting("onBeforeHighlightingColumnHeader",S,E,{selectionType:g,columnCursor:m,selectionWidth:f-l+1,classNames:P});M!==S&&(R=r.wtTable.getColumnHeader(M,E)),ke(R,P)}m+=1}}if(s!==null&&u!==null)for(var D=0,N=0;N<n;N+=1){var B=r.wtTable.rowFilter.renderedToSource(N);if(y&&B>=s&&B<=u){var K=r.wtTable.getRowHeaders(B),Z=K.length-1;p&&K.length>1&&(K=[K[Z]]);for(var ie=0;ie<K.length;ie+=1){var me=[],k=K[ie];h&&me.push(h),v&&me.push(v),ie=p?Z:ie;var w=r.getSetting("onBeforeHighlightingRowHeader",B,ie,{selectionType:g,rowCursor:D,selectionHeight:u-s+1,classNames:me});w!==B&&(k=r.wtTable.getRowHeader(w,ie)),ke(k,me)}D+=1}if(l!==null&&f!==null)for(var C=0;C<i;C+=1){var O=r.wtTable.columnFilter.renderedToSource(C);B>=s&&B<=u&&O>=l&&O<=f?this.settings.className&&this.addClassAtCoords(r,B,O,this.settings.className,this.settings.markIntersections):B>=s&&B<=u?v&&this.addClassAtCoords(r,B,O,v):O>=l&&O<=f&&d&&this.addClassAtCoords(r,B,O,d);var _=r.getSetting("onAfterDrawSelection",B,O,this.settings.layerLevel);typeof _=="string"&&this.addClassAtCoords(r,B,O,_)}}r.getSetting("onBeforeDrawBorders",a,this.settings.className),this.settings.border&&this.getBorder(r).appear(a)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),e}();const vHe=dHe;function Q5(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,i=e.coords,a=e.selection,o=e.controller,s=e.cellCoordsFactory,l=a.isSelected()?a.getSelectedRange().current():null,u=a.isSelectedByCorner(),f=a.isSelectedByRowHeader();if(t&&l)i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(i):(u||f)&&i.row>=0&&i.col>=0&&!o.cell?a.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!o.column?a.setRangeEnd(s(l.to.row,i.col)):f&&i.col<0&&!o.row?a.setRangeEnd(s(i.row,l.to.col)):(!u&&!f&&i.col<0||u&&i.col<0)&&!o.row?a.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!f&&i.row<0||f&&i.row<0)&&!o.column&&a.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var c=!a.inInSelection(i),h=r||n&&c;i.row<0&&i.col>=0&&!o.column?h&&a.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?h&&a.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?h&&a.setRangeStart(i):i.col<0&&i.row<0&&a.selectAll(!0,!0)}}function pHe(e){var t=e.isLeftClick,r=e.coords,n=e.selection,i=e.controller,a=e.cellCoordsFactory;if(t){var o=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(a(u-1,r.col)):o&&!i.row?n.setRangeEnd(a(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var gHe=new Map([["mousedown",Q5],["mouseover",pHe],["touchstart",Q5]]);function e8(e,t){var r=t.coords,n=t.selection,i=t.controller,a=t.cellCoordsFactory;gHe.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:a,isShiftKey:e.shiftKey,isLeftClick:HO(e)||e.type==="touchstart",isRightClick:Pu(e)})}var ore=new WeakMap,x$=Symbol("rootInstance");function yHe(e){ore.set(e,!0)}function mHe(e){return e===x$}function LM(e){return ore.has(e)}function L0(e){return L0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L0(e)}function ey(e,t){return SHe(e)||wHe(e,t)||sre(e,t)||bHe()}function bHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function SHe(e){if(Array.isArray(e))return e}function t8(e){return xHe(e)||CHe(e)||sre(e)||_He()}function _He(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sre(e,t){if(e){if(typeof e=="string")return FM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FM(e,t)}}function CHe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xHe(e){if(Array.isArray(e))return FM(e)}function FM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function THe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lre(n.key),n)}}function OHe(e,t,r){return t&&r8(e.prototype,t),r&&r8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n8(e,t,r){EHe(e,t),t.set(e,r)}function EHe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kl(e,t,r){return t=lre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lre(e){var t=RHe(e,"string");return L0(t)==="symbol"?t:String(t)}function RHe(e,t){if(L0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(L0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i8(e,t){var r=ure(e,t,"get");return kHe(e,r)}function kHe(e,t){return t.get?t.get.call(e):t.value}function a8(e,t,r){var n=ure(e,t,"set");return AHe(e,n,r),r}function ure(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function AHe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var ef=new WeakMap,ck=new WeakMap,hk=new WeakMap,PHe=function(){function e(t){THe(this,e),kl(this,"instance",void 0),kl(this,"eventManager",void 0),kl(this,"settings",void 0),kl(this,"THEAD",void 0),kl(this,"TBODY",void 0),kl(this,"_wt",void 0),kl(this,"activeWt",void 0),n8(this,ck,{writable:!0,value:0}),n8(this,hk,{writable:!0,value:0}),kl(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Fr(this.instance),this.settings=this.instance.getSettings(),ef.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return OHe(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,a,o){return this._wt.scrollViewport(r,n,i,a,o)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=ef.get(this),n=this.instance,i=n.rootElement,a=n.rootDocument,o=i.getAttribute("style");o&&i.setAttribute("data-originalstyle",o),ke(i,"handsontable"),r.table=a.createElement("TABLE"),ke(r.table,"htCore"),this.instance.getSettings().tableClassName&&ke(r.table,this.instance.getSettings().tableClassName),this.THEAD=a.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=a.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=ef.get(this),i=this.instance,a=i.rootElement,o=i.rootDocument,s=i.selection,l=o.documentElement;this.eventManager.addEventListener(a,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var f=r.instance.rootWindow;eM(f),u.preventDefault(),f.focus()}}),this.eventManager.addEventListener(a,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(a,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&eM(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&HO(u)&&s.finish(),n.mouseDown=!1,($O(o.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!a.contains(u.target)&&!Pu(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&Pu(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var f=u.target,c=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!a||!r.instance.view)){var v=r.instance.view._wt.wtTable.holder;if(d===v){var p=Sn(o);if(o.elementFromPoint(c+p,h)!==v||o.elementFromPoint(c,h+p)!==v)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===a)return;d=d.parentNode}var g=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(f):r.settings.outsideClickDeselects;g?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||s0(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,a=r.col;return(n=this.instance)._createCellCoords.apply(n,t8(this.translateFromRenderableToVisualIndex(i,a)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,a=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),a===null&&(a=n),[i,a]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),a=r.getNearestNotHiddenIndex(i-1,-1);return a===null?0:r.getRenderableFromVisualIndex(a)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,a){if(isNaN(r)||r<0)return 0;var o=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=a-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=ef.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return LM(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(f,c){var h;return(h=r.instance).getDataAtCell.apply(h,t8(r.translateFromRenderableToVisualIndex(f,c)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var f=[];return r.instance.hasRowHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(c):c;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",f),a8(r,hk,f.length),f},columnHeaders:function(){var f=[];return r.instance.hasColHeaders()&&f.push(function(c,h){var d=c>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(c):c;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",f),a8(r,ck,f.length),f},columnWidth:function(f){var c=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getColWidth(c===null?f:c)},rowHeight:function(f){var c=r.instance.rowIndexMapper.getVisualFromRenderableIndex(f);return r.instance.getRowHeight(c===null?f:c)},cellRenderer:function(f,c,h){var d=r.translateFromRenderableToVisualIndex(f,c),v=ey(d,2),p=v[0],g=v[1],y=r.instance.runHooks("modifyGetCellCoords",p,g),m=p,b=g;if(Array.isArray(y)){var S=ey(y,2);m=S[0],b=S[1]}var x=r.instance.getCellMeta(m,b),T=r.instance.colToProp(b),E=r.instance.getDataAtRowProp(m,T);r.instance.hasHook("beforeValueRender")&&(E=r.instance.runHooks("beforeValueRender",E,x)),r.instance.runHooks("beforeRenderer",h,p,g,T,E,x),r.instance.getCellRenderer(x)(r.instance,h,p,g,T,E,x),r.instance.runHooks("afterRenderer",h,p,g,T,E,x)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",f,v,h,p),!$f(f)&&(e8(f,{coords:v,selection:r.instance.selection,controller:p,cellCoordsFactory:function(y,m){return r.instance._createCellCoords(y,m)}}),r.instance.runHooks("afterOnCellMouseDown",f,v,h),r.activeWt=r._wt)},onCellContextMenu:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",f,v,h),!$f(f)&&(r.instance.runHooks("afterOnCellContextMenu",f,v,h),r.activeWt=r._wt)},onCellMouseOut:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",f,v,h),!$f(f)&&(r.instance.runHooks("afterOnCellMouseOut",f,v,h),r.activeWt=r._wt)},onCellMouseOver:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c),p={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",f,v,h,p),!$f(f)&&(n.mouseDown&&e8(f,{coords:v,selection:r.instance.selection,controller:p,cellCoordsFactory:function(y,m){return r.instance._createCellCoords(y,m)}}),r.instance.runHooks("afterOnCellMouseOver",f,v,h),r.activeWt=r._wt)},onCellMouseUp:function(f,c,h,d){var v=r.translateFromRenderableToVisualCoords(c);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",f,v,h),!($f(f)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",f,v,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",f)},onCellCornerDblClick:function(f){f.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",f)},beforeDraw:function(f,c){return r.beforeRender(f,c)},onDraw:function(f){return r.afterRender(f)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(f,c,h){var d=r.instance.rowIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingRowHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(f,c,h){var d=r.instance.columnIndexMapper,v=d.getVisualFromRenderableIndex(f),p=r.instance.runHooks("beforeHighlightingColumnHeader",v,c,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:function(f,c,h){var d,v=r.translateFromRenderableToVisualIndex(f,c),p=ey(v,2),g=p[0],y=p[1],m=r.instance.selection.getSelectedRange(),b=m.size();if(b>0){var S=(h??0)+1-b,x=m.peekByIndex(S);d=[x.from.row,x.from.col,x.to.row,x.to.col]}return r.instance.runHooks("afterDrawSelection",g,y,d,h)},onBeforeDrawBorders:function(f,c){var h=ey(f,4),d=h[0],v=h[1],p=h[2],g=h[3],y=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(v),r.instance.rowIndexMapper.getVisualFromRenderableIndex(p),r.instance.columnIndexMapper.getVisualFromRenderableIndex(g)];return r.instance.runHooks("beforeDrawBorders",y,c)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(f,c){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.runHooks("beforeStretchingColumnWidth",f,h)},onModifyRowHeaderWidth:function(f){return r.instance.runHooks("modifyRowHeaderWidth",f)},onModifyGetCellCoords:function(f,c,h){var d=r.instance.rowIndexMapper,v=r.instance.columnIndexMapper,p=c>=0?v.getVisualFromRenderableIndex(c):c,g=f>=0?d.getVisualFromRenderableIndex(f):f,y=r.instance.runHooks("modifyGetCellCoords",g,p,h);if(Array.isArray(y)){var m=ey(y,4),b=m[0],S=m[1],x=m[2],T=m[3];return[b>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(b,1)):b,S>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(S,1)):S,x>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(x,-1)):x,T>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(T,-1)):T]}},viewportRowCalculatorOverride:function(f){var c=r.settings.viewportRowRenderingOffset;if(c==="auto"&&r.settings.fixedRowsTop&&(c=10),c>0||c==="auto"){var h=r.countRenderableRows(),d=f.startRow,v=f.endRow;if(typeof c=="number")f.startRow=Math.max(d-c,0),f.endRow=Math.min(v+c,h-1);else if(c==="auto"){var p=Math.ceil(v/h*12);f.startRow=Math.max(d-p,0),f.endRow=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",f)},viewportColumnCalculatorOverride:function(f){var c=r.settings.viewportColumnRenderingOffset;if(c==="auto"&&r.settings.fixedColumnsStart&&(c=10),c>0||c==="auto"){var h=r.countRenderableColumns(),d=f.startColumn,v=f.endColumn;if(typeof c=="number"&&(f.startColumn=Math.max(d-c,0),f.endColumn=Math.min(v+c,h-1)),c==="auto"){var p=Math.ceil(v/h*6);f.startColumn=Math.max(d-p,0),f.endColumn=Math.min(v+p,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",f)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var f=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||f}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new $$e(i),this.activeWt=this._wt;var a=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),s=o.width,l=o.height;this.setLastSize(s,l),this.eventManager.addEventListener(a,"mousedown",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(a,"contextmenu",function(u){u.target===a&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(s0(r))return!0;var n=hu(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return ef.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!bt(i,"relative")){mo(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var a=this.instance,o=a.rootDocument,s=a.getRowHeader,l=o.createElement("div"),u=o.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var o=n.firstChild;bt(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),r,i,a):(mo(n),this.appendColHeader(r,n,i,a))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,a),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,a)}},{key:"updateCellHeader",value:function(r,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(bt(r,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):bt(r,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?lh(r,i(n,a)):(ku(r,String.fromCharCode(160)),ke(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=ef.get(this),a=[r,n];i.lastWidth=a[0],i.lastHeight=a[1]}},{key:"getLastSize",value:function(){var r=ef.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return i8(this,ck)}},{key:"getRowHeadersCount",value:function(){return i8(this,hk)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}();const IHe=PHe;function $M(e){return $M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$M(e)}var fre="ABCDEFGHIJKLMNOPQRSTUVWXYZ",HM=fre.length;function jO(e){for(var t=e+1,r="",n;t>0;)n=(t-1)%HM,r=String.fromCharCode(65+n)+r,t=parseInt((t-n)/HM,10);return r}function MHe(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(HM,n)*(fre.indexOf(e[r])+1);return t-=1,t}function DHe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a=[];for(i=0;i<t;i++)a.push(jO(i)+(n+1));r.push(a)}return r}function NHe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,r=[],n,i;for(n=0;n<e;n++){var a={};for(i=0;i<t;i++)a["prop".concat(i)]=jO(i)+(n+1);r.push(a)}return r}function LHe(e,t){for(var r=[],n,i=0;i<e;i++){n=[];for(var a=0;a<t;a++)n.push("");r.push(n)}return r}function BM(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e,n=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach(function(i,a){Array.isArray(i)?i.forEach(function(o,s){n.push([a+t,s,o])}):Object.keys(i).forEach(function(o){n.push([a+t,o,i[o]])})}),n}function T$(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Pt(e[0])&&(t=CO(e[0]))),t}function cre(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return Array.isArray(t)}))}function hre(e){return!!(Array.isArray(e)&&e.length&&e.every(function(t){return $M(t)==="object"&&!Array.isArray(t)&&t!==null}))}const FHe=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:T$,createEmptySpreadsheetData:LHe,createSpreadsheetData:DHe,createSpreadsheetObjectData:NHe,dataRowToChangesArray:BM,isArrayOfArrays:cre,isArrayOfObjects:hre,spreadsheetColumnIndex:MHe,spreadsheetColumnLabel:jO},Symbol.toStringTag,{value:"Module"}));function F0(e){return F0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F0(e)}function $He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BHe(n.key),n)}}function HHe(e,t,r){return t&&o8(e.prototype,t),r&&o8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BHe(e){var t=VHe(e,"string");return F0(t)==="symbol"?t:String(t)}function VHe(e,t){if(F0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(F0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jHe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];$He(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return HHe(e,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return ne(this.data,function(a,o){var s=n.getAtCell(o,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=a.getAtPhysicalCell(r,d,l)}):rt(n,i,function(h){u[h-n]=a.getAtPhysicalCell(r,h,l)});else if(Pt(l)||br(l))if(o?u=[]:u={},!s||o){var f=0,c=this.countFirstRowKeys()-1;rt(f,c,function(h){var d=a.colToProp(h);if(h>=(n||f)&&h<=(i||c)&&!Number.isInteger(d)){var v=a.getAtPhysicalCell(r,d,l);o?u.push(v):z1(u,d,v)}})}else It(l,function(h,d){z1(u,d,a.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var a=Pc(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),a,"set"),a.isTouched()&&(i=a.value)}Number.isInteger(n)?this.data[r][n]=i:z1(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var a=null;if(i&&(typeof n=="string"?a=EQ(i,n):typeof n=="function"?a=n(i):a=i[n]),this.hot.hasHook("modifySourceData")){var o=Pc(a);this.hot.runHooks("modifySourceData",r,this.colToProp(n),o,"get"),o.isTouched()&&(a=o.value)}return a}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=null,l=null,u=null,f=null;n===null||i===null?(o=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),f=Math.max(n.col,i.col));var c=[];return rt(s,u,function(h){c.push(o?r.getAtRow(h,void 0,void 0,a):r.getAtRow(h,l,f,a))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return T$(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();const WHe=jHe;var s8=Wr,UHe=function(e){return e!==void 0&&(s8(e,"value")||s8(e,"writable"))},zHe=pt,GHe=gn,YHe=sn,KHe=qr,XHe=UHe,qHe=ns,ZHe=dO;function dre(e,t){var r=arguments.length<3?e:arguments[2],n,i;if(KHe(e)===r)return e[t];if(n=qHe.f(e,t),n)return XHe(n)?n.value:n.get===void 0?void 0:GHe(n.get,r);if(YHe(i=ZHe(e)))return dre(i,t,r)}zHe({target:"Reflect",stat:!0},{get:dre});var JHe=pt,QHe=Tt,eBe=oa,vre=ns.f,pre=on,tBe=!pre||QHe(function(){vre(1)});JHe({target:"Object",stat:!0,forced:tBe,sham:!pre},{getOwnPropertyDescriptor:function(t,r){return vre(eBe(t),r)}});var rBe="localHooks",gre={_localHooks:Object.create(null),addLocalHook:function(t,r){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(r),this},runLocalHooks:function(t,r,n,i,a,o,s){if(this._localHooks[t])for(var l=this._localHooks[t].length,u=0;u<l;u++)sx(this._localHooks[t][u],this,r,n,i,a,o,s)},clearLocalHooks:function(){return this._localHooks={},this}};as(gre,"MIXIN_NAME",rBe,{writable:!1,enumerable:!1});const Vi=gre;function $0(e){return $0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$0(e)}function nBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aBe(n.key),n)}}function iBe(e,t,r){return t&&l8(e.prototype,t),r&&l8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aBe(e){var t=oBe(e,"string");return $0(t)==="symbol"?t:String(t)}function oBe(e,t){if($0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uh=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;nBe(this,e),this.indexedValues=[],this.initValueOrFn=t}return iBe(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,br(this.initValueOrFn)?rt(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):rt(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();yr(uh,Vi);function dk(e){return fBe(e)||uBe(e)||lBe(e)||sBe()}function sBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lBe(e,t){if(e){if(typeof e=="string")return VM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VM(e,t)}}function uBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fBe(e){if(Array.isArray(e))return VM(e)}function VM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O$(e,t,r,n){var i=r.length?r[0]:void 0;return[].concat(dk(e.slice(0,i)),dk(r.map(function(a,o){return br(n)?n(a,o):n})),dk(i===void 0?[]:e.slice(i)))}function E$(e,t){return ra(e,function(r,n){return t.includes(n)===!1})}function Pv(e){return Pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pv(e)}function cBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dBe(n.key),n)}}function hBe(e,t,r){return t&&u8(e.prototype,t),r&&u8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dBe(e){var t=vBe(e,"string");return Pv(t)==="symbol"?t:String(t)}function vBe(e,t){if(Pv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gm(){return typeof Reflect<"u"&&Reflect.get?gm=Reflect.get.bind():gm=function(t,r,n){var i=pBe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},gm.apply(this,arguments)}function pBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Lc(e),e!==null););return e}function gBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jM(e,t)}function jM(e,t){return jM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jM(e,t)}function yBe(e){var t=wBe();return function(){var n=Lc(e),i;if(t){var a=Lc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return mBe(this,i)}}function mBe(e,t){if(t&&(Pv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bBe(e)}function bBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lc(e){return Lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lc(e)}var Uu=function(e){gBe(r,e);var t=yBe(r);function r(){return cBe(this,r),t.apply(this,arguments)}return hBe(r,[{key:"insert",value:function(i,a){this.indexedValues=O$(this.indexedValues,i,a,this.initValueOrFn),gm(Lc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=E$(this.indexedValues,i),gm(Lc(r.prototype),"remove",this).call(this,i)}}]),r}(uh);function Iv(e){return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iv(e)}function SBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CBe(n.key),n)}}function _Be(e,t,r){return t&&f8(e.prototype,t),r&&f8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CBe(e){var t=xBe(e,"string");return Iv(t)==="symbol"?t:String(t)}function xBe(e,t){if(Iv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WM(e,t)}function WM(e,t){return WM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WM(e,t)}function OBe(e){var t=kBe();return function(){var n=Hx(e),i;if(t){var a=Hx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return EBe(this,i)}}function EBe(e,t){if(t&&(Iv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RBe(e)}function RBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hx(e){return Hx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hx(e)}var WO=function(e){TBe(r,e);var t=OBe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return SBe(this,r),t.call(this,n)}return _Be(r,[{key:"getHiddenIndexes",value:function(){return Zr(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}(Uu);function vk(e){return MBe(e)||IBe(e)||PBe(e)||ABe()}function ABe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PBe(e,t){if(e){if(typeof e=="string")return UM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UM(e,t)}}function IBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MBe(e){if(Array.isArray(e))return UM(e)}function UM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R$(e,t,r){return[].concat(vk(e.slice(0,t)),vk(r),vk(e.slice(t)))}function H0(e,t){return ra(e,function(r){return t.includes(r)===!1})}function k$(e,t){return At(e,function(r){return r-t.filter(function(n){return n<r}).length})}function A$(e,t){var r=t[0],n=t.length;return At(e,function(i){return i>=r?i+n:i})}function Mv(e){return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mv(e)}function DBe(e){return $Be(e)||FBe(e)||LBe(e)||NBe()}function NBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LBe(e,t){if(e){if(typeof e=="string")return zM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zM(e,t)}}function FBe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Be(e){if(Array.isArray(e))return zM(e)}function zM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mre(n.key),n)}}function BBe(e,t,r){return t&&c8(e.prototype,t),r&&c8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Es(){return typeof Reflect<"u"&&Reflect.get?Es=Reflect.get.bind():Es=function(t,r,n){var i=VBe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Es.apply(this,arguments)}function VBe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=no(e),e!==null););return e}function jBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GM(e,t)}function GM(e,t){return GM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GM(e,t)}function WBe(e){var t=zBe();return function(){var n=no(e),i;if(t){var a=no(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return UBe(this,i)}}function UBe(e,t){if(t&&(Mv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yre(e)}function yre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function no(e){return no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},no(e)}function GBe(e,t,r){return t=mre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mre(e){var t=YBe(e,"string");return Mv(t)==="symbol"?t:String(t)}function YBe(e,t){if(Mv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UO=function(e){jBe(r,e);var t=WBe(r);function r(){var n;HBe(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),GBe(yre(n),"orderOfIndexes",[]),n}return BBe(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return i.indexedValues[a]})}},{key:"setValues",value:function(i){this.orderOfIndexes=DBe(Array(i.length).keys()),Es(no(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=a,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(o,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=H0(this.orderOfIndexes,[i]),br(this.initValueOrFn)?Es(no(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):Es(no(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Es(no(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,a){this.indexedValues=O$(this.indexedValues,i,a,this.initValueOrFn),this.orderOfIndexes=A$(this.orderOfIndexes,a),Es(no(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=E$(this.indexedValues,i),this.orderOfIndexes=H0(this.orderOfIndexes,i),this.orderOfIndexes=k$(this.orderOfIndexes,i),Es(no(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(a){return[a,i.getValueAtIndex(a)]})}}]),r}(uh);function Dv(e){return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(e)}function KBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qBe(n.key),n)}}function XBe(e,t,r){return t&&h8(e.prototype,t),r&&h8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qBe(e){var t=ZBe(e,"string");return Dv(t)==="symbol"?t:String(t)}function ZBe(e,t){if(Dv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YM(e,t)}function YM(e,t){return YM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YM(e,t)}function QBe(e){var t=r3e();return function(){var n=Bx(e),i;if(t){var a=Bx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return e3e(this,i)}}function e3e(e,t){if(t&&(Dv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t3e(e)}function t3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bx(e){return Bx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bx(e)}var sS=function(e){JBe(r,e);var t=QBe(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return KBe(this,r),t.call(this,n)}return XBe(r,[{key:"getTrimmedIndexes",value:function(){return Zr(this.getValues(),function(i,a,o){return a&&i.push(o),i},[])}}]),r}(Uu),d8=new Map([["indexesSequence",{getListWithInsertedItems:R$,getListWithRemovedItems:H0}],["physicallyIndexed",{getListWithInsertedItems:O$,getListWithRemovedItems:E$}]]),bre=function(t){if(d8.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return d8.get(t)};function Nv(e){return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}function n3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a3e(n.key),n)}}function i3e(e,t,r){return t&&v8(e.prototype,t),r&&v8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a3e(e){var t=o3e(e,"string");return Nv(t)==="symbol"?t:String(t)}function o3e(e,t){if(Nv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ym(){return typeof Reflect<"u"&&Reflect.get?ym=Reflect.get.bind():ym=function(t,r,n){var i=s3e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ym.apply(this,arguments)}function s3e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fc(e),e!==null););return e}function l3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KM(e,t)}function KM(e,t){return KM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KM(e,t)}function u3e(e){var t=h3e();return function(){var n=Fc(e),i;if(t){var a=Fc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return f3e(this,i)}}function f3e(e,t){if(t&&(Nv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c3e(e)}function c3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fc(e){return Fc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fc(e)}var wre=function(e){l3e(r,e);var t=u3e(r);function r(){return n3e(this,r),t.call(this,function(n){return n})}return i3e(r,[{key:"insert",value:function(i,a){var o=A$(this.indexedValues,a);this.indexedValues=R$(o,i,a),ym(Fc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=H0(this.indexedValues,i);this.indexedValues=k$(a,i),ym(Fc(r.prototype),"remove",this).call(this,i)}}]),r}(uh),p8=new Map([["hiding",WO],["index",uh],["linkedPhysicalIndexToValue",UO],["physicalIndexToValue",Uu],["trimming",sS]]);function d3e(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!p8.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(p8.get(e))(t)}function B0(e){return B0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B0(e)}function v3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g3e(n.key),n)}}function p3e(e,t,r){return t&&g8(e.prototype,t),r&&g8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function g3e(e){var t=y3e(e,"string");return B0(t)==="symbol"?t:String(t)}function y3e(e,t){if(B0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(B0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XM=0,P$=function(){function e(){v3e(this,e),this.collection=new Map}return p3e(e,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}),XM+=1)}},{key:"unregister",value:function(r){var n=this.collection.get(r);Xe(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n),XM-=1)}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return pr(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),e}();yr(P$,Vi);function m3e(){return XM}function Lv(e){return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(e)}function b3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S3e(n.key),n)}}function w3e(e,t,r){return t&&y8(e.prototype,t),r&&y8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S3e(e){var t=_3e(e,"string");return Lv(t)==="symbol"?t:String(t)}function _3e(e,t){if(Lv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qM(e,t)}function qM(e,t){return qM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qM(e,t)}function x3e(e){var t=E3e();return function(){var n=Vx(e),i;if(t){var a=Vx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return T3e(this,i)}}function T3e(e,t){if(t&&(Lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O3e(e)}function O3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vx(e){return Vx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vx(e)}var m8=function(e){C3e(r,e);var t=x3e(r);function r(n,i){var a;return b3e(this,r),a=t.call(this),a.mergedValuesCache=[],a.aggregationFunction=n,a.fallbackValue=i,a}return w3e(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var a=At(this.get(),function(c){return c.getValues()}),o=[],s=Xe(a[0])&&a[0].length||0,l=0;l<s;l+=1){for(var u=[],f=0;f<this.getLength();f+=1)u.push(a[f][l]);o.push(u)}return At(o,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,a){var o=this.getMergedValues(a)[i];return Xe(o)?o:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(P$);function V0(e){return V0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V0(e)}function R3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A3e(n.key),n)}}function k3e(e,t,r){return t&&b8(e.prototype,t),r&&b8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A3e(e){var t=P3e(e,"string");return V0(t)==="symbol"?t:String(t)}function P3e(e,t){if(V0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(V0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I3e(e,t,r){M3e(e,t),t.set(e,r)}function M3e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D3e(e,t,r){var n=Sre(e,t,"set");return N3e(e,n,r),r}function N3e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function L3e(e,t){var r=Sre(e,t,"get");return F3e(e,r)}function Sre(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function F3e(e,t){return t.get?t.get.call(e):t.value}var pk=new WeakMap,_re=function(){function e(){R3e(this,e),I3e(this,pk,{writable:!0,value:[]})}return k3e(e,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(L3e(this,pk)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){D3e(this,pk,r)}}]),e}();yr(_re,Vi);function w8(e,t){for(var r=[],n=0,i=0;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function j0(e){return j0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j0(e)}function $3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B3e(n.key),n)}}function H3e(e,t,r){return t&&S8(e.prototype,t),r&&S8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B3e(e){var t=V3e(e,"string");return j0(t)==="symbol"?t:String(t)}function V3e(e,t){if(j0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(j0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ty(e,t,r){j3e(e,t),t.set(e,r)}function j3e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(e,t){var r=Cre(e,t,"get");return W3e(e,r)}function W3e(e,t){return t.get?t.get.call(e):t.value}function r_(e,t,r){var n=Cre(e,t,"set");return U3e(e,n,r),r}function Cre(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function U3e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var n_=new WeakMap,ry=new WeakMap,i_=new WeakMap,a_=new WeakMap,o_=new WeakMap,z3e=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.initialIndexValue;$3e(this,e),ty(this,n_,{writable:!0,value:new Set}),ty(this,ry,{writable:!0,value:[]}),ty(this,i_,{writable:!0,value:[]}),ty(this,a_,{writable:!0,value:!1}),ty(this,o_,{writable:!0,value:!1}),r_(this,o_,r??!1)}return H3e(e,[{key:"createObserver",value:function(){var r=this,n=new _re;return ua(this,n_).add(n),n.addLocalHook("unsubscribe",function(){ua(r,n_).delete(n)}),n._writeInitialChanges(w8(ua(this,ry),ua(this,i_))),n}},{key:"emit",value:function(r){var n=ua(this,i_);(!ua(this,a_)||ua(this,ry).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(ua(this,o_)):r_(this,ry,new Array(r.length).fill(ua(this,o_))),ua(this,a_)||(r_(this,a_,!0),n=ua(this,ry)));var i=w8(n,r);ua(this,n_).forEach(function(a){return a._write(i)}),r_(this,i_,r)}}]),e}();function W0(e){return W0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W0(e)}var _8;function gk(e){return X3e(e)||K3e(e)||Y3e(e)||G3e()}function G3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y3e(e,t){if(e){if(typeof e=="string")return ZM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZM(e,t)}}function K3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function X3e(e){if(Array.isArray(e))return ZM(e)}function ZM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q3e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Z3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q3e(n.key),n)}}function J3e(e,t,r){return t&&C8(e.prototype,t),r&&C8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q3e(e){var t=e4e(e,"string");return W0(t)==="symbol"?t:String(t)}function e4e(e,t){if(W0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(W0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x8=new Set(["getFirstNotHiddenIndex"]),JM=function(){function e(){var t=this;Z3e(this,e),this.indexesSequence=new wre,this.trimmingMapsCollection=new m8(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new m8(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new P$,this.hidingChangesObservable=new z3e({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",r,t.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){t.runLocalHooks("change",r,t.variousMapsCollection)})}return J3e(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,d3e(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof sS?this.trimmingMapsCollection.register(r,n):n instanceof WO?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return Xe(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return Xe(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return Xe(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return Xe(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;x8.has("getFirstNotHiddenIndex")&&(x8.delete("getFirstNotHiddenIndex"),gr(sr(_8||(_8=q3e([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var o=this.getPhysicalFromVisualIndex(r);return o===null?i===!0&&a!==r-n?this.getFirstNotHiddenIndex(a,-n,!1,a):null:this.isHidden(o)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,a)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.getPhysicalFromVisualIndex(r);if(a===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=o.findIndex(function(l){return l>r}):s=o.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:o[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=gk(new Array(r).keys()),this.notHiddenIndexesCache=gk(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=gk(Array(this.getNumberOfIndexes()-r).keys()).map(function(a){return a+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isTrimmed(a)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(a){return r.isHidden(a)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var a=At(r,function(c){return i.getPhysicalFromVisualIndex(c)}),o=this.getNotTrimmedIndexesLength(),s=r.length,l=H0(this.getIndexesSequence(),a),u=o-s;if(n+s<o){var f=l.filter(function(c){return i.isTrimmed(c)===!1})[n];u=l.indexOf(f)}this.setIndexesSequence(R$(l,u,a))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],a=Xe(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=At(new Array(n).fill(a),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(o,s),this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),a=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(a,n)}}}]),e}();yr(JM,Vi);var T8;function t4e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function r4e(e,t){return It(t,function(r,n){pr(e[n])&&(e[n]=r)}),e}function xre(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=t.exec(e);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):e}function Tre(e){Xe(e)&&o$(sr(T8||(T8=t4e(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),e))}function n4e(e,t){var r=Array.isArray(e)&&Number.isInteger(t);return r?e[t]:e}var Ore=Ha("phraseFormatters"),i4e=Ore.register,a4e=Ore.getValues;function o4e(e,t){i4e(e,t)}function s4e(){return a4e()}o4e("pluralize",n4e);var Ere="ContextMenu:items",Ot=Ere,I$="".concat(Ot,".noItems"),M$="".concat(Ot,".insertRowAbove"),D$="".concat(Ot,".insertRowBelow"),N$="".concat(Ot,".insertColumnOnTheLeft"),L$="".concat(Ot,".insertColumnOnTheRight"),F$="".concat(Ot,".removeRow"),$$="".concat(Ot,".removeColumn"),H$="".concat(Ot,".undo"),B$="".concat(Ot,".redo"),V$="".concat(Ot,".readOnly"),j$="".concat(Ot,".clearColumn"),W$="".concat(Ot,".copy"),U$="".concat(Ot,".copyWithHeaders"),z$="".concat(Ot,".copyWithGroupHeaders"),G$="".concat(Ot,".copyHeadersOnly"),Y$="".concat(Ot,".cut"),K$="".concat(Ot,".freezeColumn"),X$="".concat(Ot,".unfreezeColumn"),q$="".concat(Ot,".mergeCells"),Z$="".concat(Ot,".unmergeCells"),J$="".concat(Ot,".addComment"),Q$="".concat(Ot,".editComment"),eH="".concat(Ot,".removeComment"),tH="".concat(Ot,".readOnlyComment"),rH="".concat(Ot,".align"),nH="".concat(Ot,".align.left"),iH="".concat(Ot,".align.center"),aH="".concat(Ot,".align.right"),oH="".concat(Ot,".align.justify"),sH="".concat(Ot,".align.top"),lH="".concat(Ot,".align.middle"),uH="".concat(Ot,".align.bottom"),fH="".concat(Ot,".borders"),cH="".concat(Ot,".borders.top"),hH="".concat(Ot,".borders.right"),dH="".concat(Ot,".borders.bottom"),vH="".concat(Ot,".borders.left"),pH="".concat(Ot,".borders.remove"),gH="".concat(Ot,".nestedHeaders.insertChildRow"),yH="".concat(Ot,".nestedHeaders.detachFromParent"),mH="".concat(Ot,".hideColumn"),bH="".concat(Ot,".showColumn"),wH="".concat(Ot,".hideRow"),SH="".concat(Ot,".showRow"),xi="Filters:",Ur="".concat(xi,"conditions"),zO="".concat(Ur,".none"),_H="".concat(Ur,".isEmpty"),CH="".concat(Ur,".isNotEmpty"),xH="".concat(Ur,".isEqualTo"),TH="".concat(Ur,".isNotEqualTo"),OH="".concat(Ur,".beginsWith"),EH="".concat(Ur,".endsWith"),RH="".concat(Ur,".contains"),kH="".concat(Ur,".doesNotContain"),l4e="".concat(Ur,".byValue"),AH="".concat(Ur,".greaterThan"),PH="".concat(Ur,".greaterThanOrEqualTo"),IH="".concat(Ur,".lessThan"),MH="".concat(Ur,".lessThanOrEqualTo"),DH="".concat(Ur,".isBetween"),NH="".concat(Ur,".isNotBetween"),LH="".concat(Ur,".after"),FH="".concat(Ur,".before"),$H="".concat(Ur,".today"),HH="".concat(Ur,".tomorrow"),BH="".concat(Ur,".yesterday"),VH="".concat(xi,"labels.filterByCondition"),jH="".concat(xi,"labels.filterByValue"),WH="".concat(xi,"labels.conjunction"),GO="".concat(xi,"labels.disjunction"),jx="".concat(xi,"values.blankCells"),UH="".concat(xi,"buttons.selectAll"),zH="".concat(xi,"buttons.clear"),GH="".concat(xi,"buttons.ok"),YH="".concat(xi,"buttons.cancel"),KH="".concat(xi,"buttons.placeholder.search"),XH="".concat(xi,"buttons.placeholder.value"),qH="".concat(xi,"buttons.placeholder.secondValue");const u4e=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:J$,CONTEXTMENU_ITEMS_ALIGNMENT:rH,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:uH,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:iH,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:oH,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:nH,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:lH,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:aH,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:sH,CONTEXTMENU_ITEMS_BORDERS:fH,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:dH,CONTEXTMENU_ITEMS_BORDERS_LEFT:vH,CONTEXTMENU_ITEMS_BORDERS_RIGHT:hH,CONTEXTMENU_ITEMS_BORDERS_TOP:cH,CONTEXTMENU_ITEMS_CLEAR_COLUMN:j$,CONTEXTMENU_ITEMS_COPY:W$,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:G$,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:z$,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:U$,CONTEXTMENU_ITEMS_CUT:Y$,CONTEXTMENU_ITEMS_EDIT_COMMENT:Q$,CONTEXTMENU_ITEMS_FREEZE_COLUMN:K$,CONTEXTMENU_ITEMS_HIDE_COLUMN:mH,CONTEXTMENU_ITEMS_HIDE_ROW:wH,CONTEXTMENU_ITEMS_INSERT_LEFT:N$,CONTEXTMENU_ITEMS_INSERT_RIGHT:L$,CONTEXTMENU_ITEMS_MERGE_CELLS:q$,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:yH,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:gH,CONTEXTMENU_ITEMS_NO_ITEMS:I$,CONTEXTMENU_ITEMS_READ_ONLY:V$,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:tH,CONTEXTMENU_ITEMS_REDO:B$,CONTEXTMENU_ITEMS_REMOVE_BORDERS:pH,CONTEXTMENU_ITEMS_REMOVE_COLUMN:$$,CONTEXTMENU_ITEMS_REMOVE_COMMENT:eH,CONTEXTMENU_ITEMS_REMOVE_ROW:F$,CONTEXTMENU_ITEMS_ROW_ABOVE:M$,CONTEXTMENU_ITEMS_ROW_BELOW:D$,CONTEXTMENU_ITEMS_SHOW_COLUMN:bH,CONTEXTMENU_ITEMS_SHOW_ROW:SH,CONTEXTMENU_ITEMS_UNDO:H$,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:X$,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Z$,CONTEXT_MENU_ITEMS_NAMESPACE:Ere,FILTERS_BUTTONS_CANCEL:YH,FILTERS_BUTTONS_CLEAR:zH,FILTERS_BUTTONS_OK:GH,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:KH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:qH,FILTERS_BUTTONS_PLACEHOLDER_VALUE:XH,FILTERS_BUTTONS_SELECT_ALL:UH,FILTERS_CONDITIONS_AFTER:LH,FILTERS_CONDITIONS_BEFORE:FH,FILTERS_CONDITIONS_BEGINS_WITH:OH,FILTERS_CONDITIONS_BETWEEN:DH,FILTERS_CONDITIONS_BY_VALUE:l4e,FILTERS_CONDITIONS_CONTAINS:RH,FILTERS_CONDITIONS_EMPTY:_H,FILTERS_CONDITIONS_ENDS_WITH:EH,FILTERS_CONDITIONS_EQUAL:xH,FILTERS_CONDITIONS_GREATER_THAN:AH,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:PH,FILTERS_CONDITIONS_LESS_THAN:IH,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:MH,FILTERS_CONDITIONS_NAMESPACE:Ur,FILTERS_CONDITIONS_NONE:zO,FILTERS_CONDITIONS_NOT_BETWEEN:NH,FILTERS_CONDITIONS_NOT_CONTAIN:kH,FILTERS_CONDITIONS_NOT_EMPTY:CH,FILTERS_CONDITIONS_NOT_EQUAL:TH,FILTERS_CONDITIONS_TODAY:$H,FILTERS_CONDITIONS_TOMORROW:HH,FILTERS_CONDITIONS_YESTERDAY:BH,FILTERS_DIVS_FILTER_BY_CONDITION:VH,FILTERS_DIVS_FILTER_BY_VALUE:jH,FILTERS_LABELS_CONJUNCTION:WH,FILTERS_LABELS_DISJUNCTION:GO,FILTERS_NAMESPACE:xi,FILTERS_VALUES_BLANK_CELLS:jx},Symbol.toStringTag,{value:"Module"}));function U0(e){return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U0(e)}var Ve;function ze(e,t,r){return t=f4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f4e(e){var t=c4e(e,"string");return U0(t)==="symbol"?t:String(t)}function c4e(e,t){if(U0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(U0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h4e=(Ve={languageCode:"en-US"},ze(Ve,I$,"No available options"),ze(Ve,M$,"Insert row above"),ze(Ve,D$,"Insert row below"),ze(Ve,N$,"Insert column left"),ze(Ve,L$,"Insert column right"),ze(Ve,F$,["Remove row","Remove rows"]),ze(Ve,$$,["Remove column","Remove columns"]),ze(Ve,H$,"Undo"),ze(Ve,B$,"Redo"),ze(Ve,V$,"Read only"),ze(Ve,j$,"Clear column"),ze(Ve,rH,"Alignment"),ze(Ve,nH,"Left"),ze(Ve,iH,"Center"),ze(Ve,aH,"Right"),ze(Ve,oH,"Justify"),ze(Ve,sH,"Top"),ze(Ve,lH,"Middle"),ze(Ve,uH,"Bottom"),ze(Ve,K$,"Freeze column"),ze(Ve,X$,"Unfreeze column"),ze(Ve,fH,"Borders"),ze(Ve,cH,"Top"),ze(Ve,hH,"Right"),ze(Ve,dH,"Bottom"),ze(Ve,vH,"Left"),ze(Ve,pH,"Remove border(s)"),ze(Ve,J$,"Add comment"),ze(Ve,Q$,"Edit comment"),ze(Ve,eH,"Delete comment"),ze(Ve,tH,"Read-only comment"),ze(Ve,q$,"Merge cells"),ze(Ve,Z$,"Unmerge cells"),ze(Ve,W$,"Copy"),ze(Ve,U$,["Copy with header","Copy with headers"]),ze(Ve,z$,["Copy with group header","Copy with group headers"]),ze(Ve,G$,["Copy header only","Copy headers only"]),ze(Ve,Y$,"Cut"),ze(Ve,gH,"Insert child row"),ze(Ve,yH,"Detach from parent"),ze(Ve,mH,["Hide column","Hide columns"]),ze(Ve,bH,["Show column","Show columns"]),ze(Ve,wH,["Hide row","Hide rows"]),ze(Ve,SH,["Show row","Show rows"]),ze(Ve,zO,"None"),ze(Ve,_H,"Is empty"),ze(Ve,CH,"Is not empty"),ze(Ve,xH,"Is equal to"),ze(Ve,TH,"Is not equal to"),ze(Ve,OH,"Begins with"),ze(Ve,EH,"Ends with"),ze(Ve,RH,"Contains"),ze(Ve,kH,"Does not contain"),ze(Ve,AH,"Greater than"),ze(Ve,PH,"Greater than or equal to"),ze(Ve,IH,"Less than"),ze(Ve,MH,"Less than or equal to"),ze(Ve,DH,"Is between"),ze(Ve,NH,"Is not between"),ze(Ve,LH,"After"),ze(Ve,FH,"Before"),ze(Ve,$H,"Today"),ze(Ve,HH,"Tomorrow"),ze(Ve,BH,"Yesterday"),ze(Ve,jx,"Blank cells"),ze(Ve,VH,"Filter by condition"),ze(Ve,jH,"Filter by value"),ze(Ve,WH,"And"),ze(Ve,GO,"Or"),ze(Ve,UH,"Select all"),ze(Ve,zH,"Clear"),ze(Ve,GH,"OK"),ze(Ve,YH,"Cancel"),ze(Ve,KH,"Search"),ze(Ve,XH,"Value"),ze(Ve,qH,"Second value"),Ve);const Rre=h4e;var QM=Rre.languageCode,YO=Ha("languagesDictionaries"),d4e=YO.register,kre=YO.getItem,v4e=YO.hasItem,p4e=YO.getValues;Are(Rre);function Are(e,t){var r=e,n=t;return Pt(e)&&(n=e,r=n.languageCode),g4e(r,n),d4e(r,Xn(n)),Xn(n)}function g4e(e,t){e!==QM&&r4e(t,kre(QM))}function Pre(e){return ZH(e)?Xn(kre(e)):null}function ZH(e){return v4e(e)}function y4e(){return p4e()}function Ire(e,t,r){var n=Pre(e);if(n===null)return null;var i=n[t];if(pr(i))return null;var a=m4e(i,r);return Array.isArray(a)?a[0]:a}function m4e(e,t){var r=e;return ne(s4e(),function(n){r=n(e,t)}),r}function b4e(e){var t=xre(e);return ZH(t)||(t=QM,Tre(e)),t}var w4e=pt,S4e=on,_4e=RZ,C4e=oa,x4e=ns,T4e=_g;w4e({target:"Object",stat:!0,sham:!S4e},{getOwnPropertyDescriptors:function(t){for(var r=C4e(t),n=x4e.f,i=_4e(r),a={},o=0,s,l;i.length>o;)l=n(r,s=i[o++]),l!==void 0&&T4e(a,s,l);return a}});var KO="active-header",XO="area",z0="cell",JH="fill",lS="header",QH="custom-selection";function Fv(e){return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(e)}function O4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dre(n.key),n)}}function E4e(e,t,r){return t&&O8(e.prototype,t),r&&O8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sC(){return typeof Reflect<"u"&&Reflect.get?sC=Reflect.get.bind():sC=function(t,r,n){var i=R4e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},sC.apply(this,arguments)}function R4e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$v(e),e!==null););return e}function k4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e2(e,t)}function e2(e,t){return e2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},e2(e,t)}function A4e(e){var t=I4e();return function(){var n=$v(e),i;if(t){var a=$v(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return P4e(this,i)}}function P4e(e,t){if(t&&(Fv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mre(e)}function Mre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $v(e){return $v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$v(e)}function M4e(e,t,r){return t=Dre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dre(e){var t=D4e(e,"string");return Fv(t)==="symbol"?t:String(t)}function D4e(e,t){if(Fv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N4e=function(e){k4e(r,e);var t=A4e(r);function r(n,i){var a;return O4e(this,r),a=t.call(this,n,null),M4e(Mre(a),"visualCellRange",null),a.visualCellRange=i||null,a.commit(),a}return E4e(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,sC($v(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var a=i.from,o=i.to,s=this.getNearestNotHiddenCoords(a,1),l=this.getNearestNotHiddenCoords(o,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=a,l=o}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,a);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,o);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,a,o){if(a<0)return a;var s=i.getNearestNotHiddenIndex(a,o),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var a=i.getVerticalDirection()==="N-S"?1:-1,o=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),a,o);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,a=i.from,o=i.to,s=a.row===null||o.row===null,l=a.col===null||o.col===null,u=this.settings.createCellCoords(s?null:Math.min(a.row,o.row),l?null:Math.min(a.col,o.col)),f=this.settings.createCellCoords(s?null:Math.max(a.row,o.row),l?null:Math.max(a.col,o.col));return[u.row,u.col,f.row,f.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),a=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,a.row,a.col]}},{key:"createRenderableCellRange",value:function(i,a){var o=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(a);return this.settings.createCellRange(o,o,s)}}]),r}(vHe);const kg=N4e;function G0(e){return G0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G0(e)}var L4e=["activeHeaderClassName"];function E8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function R8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E8(Object(r),!0).forEach(function(n){F4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F4e(e,t,r){return t=$4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $4e(e){var t=H4e(e,"string");return G0(t)==="symbol"?t:String(t)}function H4e(e,t){if(G0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(G0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B4e(e,t){if(e==null)return{};var r=V4e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function V4e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function j4e(e){var t=e.activeHeaderClassName,r=B4e(e,L4e),n=new kg(R8(R8({highlightHeaderClassName:t},r),{},{selectionType:KO}));return n}function Y0(e){return Y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y0(e)}var W4e=["layerLevel","areaCornerVisible"];function k8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function A8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k8(Object(r),!0).forEach(function(n){U4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U4e(e,t,r){return t=z4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z4e(e){var t=G4e(e,"string");return Y0(t)==="symbol"?t:String(t)}function G4e(e,t){if(Y0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Y0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y4e(e,t){if(e==null)return{};var r=K4e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function K4e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function X4e(e){var t=e.layerLevel,r=e.areaCornerVisible,n=Y4e(e,W4e),i=new kg(A8(A8({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:XO}));return i}function K0(e){return K0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K0(e)}var q4e=["cellCornerVisible"];function P8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function I8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P8(Object(r),!0).forEach(function(n){Z4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z4e(e,t,r){return t=J4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J4e(e){var t=Q4e(e,"string");return K0(t)==="symbol"?t:String(t)}function Q4e(e,t){if(K0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(K0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eVe(e,t){if(e==null)return{};var r=tVe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tVe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function rVe(e){var t=e.cellCornerVisible,r=eVe(e,q4e),n=new kg(I8(I8({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r),{},{selectionType:z0}));return n}function X0(e){return X0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X0(e)}var nVe=["border","visualCellRange"];function M8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M8(Object(r),!0).forEach(function(n){iVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iVe(e,t,r){return t=aVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aVe(e){var t=oVe(e,"string");return X0(t)==="symbol"?t:String(t)}function oVe(e,t){if(X0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(X0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sVe(e,t){if(e==null)return{};var r=lVe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lVe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function uVe(e){var t=e.border,r=e.visualCellRange,n=sVe(e,nVe),i=new kg(yk(yk(yk({},t),n),{},{selectionType:QH}),r);return i}var D8=on,fVe=Mt,cVe=gn,hVe=Tt,mk=Lw,dVe=Dw,vVe=Ow,pVe=Bi,gVe=Rw,Ih=Object.assign,N8=Object.defineProperty,yVe=fVe([].concat),mVe=!Ih||hVe(function(){if(D8&&Ih({b:1},Ih(N8({},"a",{enumerable:!0,get:function(){N8(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),Ih({},e)[r]!=7||mk(Ih({},t)).join("")!=n})?function(t,r){for(var n=pVe(t),i=arguments.length,a=1,o=dVe.f,s=vVe.f;i>a;)for(var l=gVe(arguments[a++]),u=o?yVe(mk(l),o(l)):mk(l),f=u.length,c=0,h;f>c;)h=u[c++],(!D8||cVe(s,l,h))&&(n[h]=l[h]);return n}:Ih,bVe=pt,L8=mVe;bVe({target:"Object",stat:!0,arity:2,forced:Object.assign!==L8},{assign:L8});function q0(e){return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(e)}function F8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F8(Object(r),!0).forEach(function(n){wVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wVe(e,t,r){return t=SVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SVe(e){var t=_Ve(e,"string");return q0(t)==="symbol"?t:String(t)}function _Ve(e,t){if(q0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(q0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CVe(e){if(e==null)throw new TypeError("Cannot destructure "+e)}function xVe(e){var t=Object.assign({},(CVe(e),e)),r=new kg($8($8({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:JH}));return r}function Z0(e){return Z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z0(e)}var TVe=["headerClassName","rowClassName","columnClassName"];function H8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function B8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H8(Object(r),!0).forEach(function(n){OVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OVe(e,t,r){return t=EVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EVe(e){var t=RVe(e,"string");return Z0(t)==="symbol"?t:String(t)}function RVe(e,t){if(Z0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Z0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kVe(e,t){if(e==null)return{};var r=AVe(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function AVe(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function PVe(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,i=kVe(e,TVe),a=new kg(B8(B8({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:lS}));return a}function J0(e){return J0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J0(e)}function V8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function IVe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V8(Object(r),!0).forEach(function(n){MVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MVe(e,t,r){return t=DVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DVe(e){var t=NVe(e,"string");return J0(t)==="symbol"?t:String(t)}function NVe(e,t){if(J0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(J0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nre=Ha("highlight/types"),Ag=Nre.register,LVe=Nre.getItem;Ag(KO,j4e);Ag(XO,X4e);Ag(z0,rVe);Ag(QH,uVe);Ag(JH,xVe);Ag(lS,PVe);function Mh(e,t){return LVe(e)(IVe({type:e},t))}function Q0(e){return Q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q0(e)}function Al(e){return BVe(e)||HVe(e)||$Ve(e)||FVe()}function FVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Ve(e,t){if(e){if(typeof e=="string")return t2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t2(e,t)}}function HVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BVe(e){if(Array.isArray(e))return t2(e)}function t2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ny(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j8(Object(r),!0).forEach(function(n){VVe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VVe(e,t,r){return t=Lre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lre(n.key),n)}}function WVe(e,t,r){return t&&W8(e.prototype,t),r&&W8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lre(e){var t=UVe(e,"string");return Q0(t)==="symbol"?t:String(t)}function UVe(e,t){if(Q0(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Q0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zVe=function(e){function t(r){jVe(this,t),this.options=r,this.layerLevel=0,this.cell=Mh(z0,r),this.fill=Mh(JH,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return WVe(t,[{key:"isEnabledFor",value:function(n,i){var a=n;n===z0&&(a="current");var o=this.options.disabledCellSelection(i.row,i.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(a)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=Mh(XO,ny({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return Al(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=Mh(lS,ny({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return Al(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=Mh(KO,ny({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return Al(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Al(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(Mh(QH,ny(ny({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),ne(this.areas.values(),function(n){return void n.clear()}),ne(this.headers.values(),function(n){return void n.clear()}),ne(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:e,value:function(){return[this.cell,this.fill].concat(Al(this.areas.values()),Al(this.headers.values()),Al(this.activeHeaders.values()),Al(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator);const GVe=zVe;function eb(e){return eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eb(e)}function YVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XVe(n.key),n)}}function KVe(e,t,r){return t&&U8(e.prototype,t),r&&U8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XVe(e){var t=qVe(e,"string");return eb(t)==="symbol"?t:String(t)}function qVe(e,t){if(eb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZVe=function(e){function t(r){YVe(this,t),this.ranges=[],this.createCellRange=r}return KVe(t,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,a;return i>=0&&(a=this.ranges[i]),a}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator);const JVe=ZVe;function tb(e){return tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tb(e)}function QVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tje(n.key),n)}}function eje(e,t,r){return t&&z8(e.prototype,t),r&&z8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tje(e){var t=rje(e,"string");return tb(t)==="symbol"?t:String(t)}function rje(e,t){if(tb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fre=function(){function e(t,r){QVe(this,e),this.range=t,this.options=r}return eje(e,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.options.createCellCoords(r,n),o=this.range.current().highlight,s=this.options.visualToRenderableCoords(o),l=s.row,u=s.col,f=o,c=0,h=0;if(this.runLocalHooks("beforeTransformStart",a),l!==null&&u!==null){var d=this.options.countRows(),v=this.options.countCols(),p=this.options.fixedRowsBottom(),g=this.options.minSpareRows(),y=this.options.minSpareCols(),m=this.options.autoWrapRow(),b=this.options.autoWrapCol();l+r>d-1?i&&g>0&&!(p&&l>=d-p-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):b&&(a.row=1-d,a.col=u+a.col===v-1?1-v:1):b&&l+a.row<0&&u+a.col>=0&&(a.row=d-1,a.col=u+a.col===0?v-1:-1),u+a.col>v-1?i&&y>0?(this.runLocalHooks("insertColRequire",v),v=this.options.countCols()):m&&(a.row=l+a.row===d-1?1-d:1,a.col=1-v):m&&u+a.col<0&&l+a.row>=0&&(a.row=l+a.row===0?d-1:-1,a.col=v-1);var S=this.options.createCellCoords(l+a.row,u+a.col);c=0,h=0,S.row<0?(c=-1,S.row=0):S.row>0&&S.row>=d&&(c=1,S.row=d-1),S.col<0?(h=-1,S.col=0):S.col>0&&S.col>=v&&(h=1,S.col=v-1),f=this.options.renderableToVisualCoords(S)}return this.runLocalHooks("afterTransformStart",f,c,h),f}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),a=this.range.current(),o=a.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(a.highlight),f=u.row,c=u.col;if(f!==null&&c!==null){var h=this.options.countRows(),d=this.options.countCols(),v=this.options.visualToRenderableCoords(a.to),p=v.row,g=v.col,y=this.options.createCellCoords(p+i.row,g+i.col);s=0,l=0,y.row<0?(s=-1,y.row=0):y.row>0&&y.row>=h&&(s=1,y.row=h-1),y.col<0?(l=-1,y.col=0):y.col>0&&y.col>=d&&(l=1,y.col=d-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,s,l),o}}]),e}();yr(Fre,Vi);const nje=Fre;function $re(e,t){return sje(e)||oje(e,t)||aje(e,t)||ije()}function ije(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aje(e,t){if(e){if(typeof e=="string")return G8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G8(e,t)}}function G8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sje(e){if(Array.isArray(e))return e}function r2(e){return r2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r2(e)}var qO=0,ZO=1,Hre=2,eB=3,lje=[eB,Hre],uje=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],bk=Symbol("root"),Y8=Symbol("child");function Hv(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bk;if(t!==bk&&t!==Y8)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===bk,i=qO;if(r){var a=e[0];if(e.length===0)i=ZO;else if(n&&a instanceof d$)i=eB;else if(n&&Array.isArray(a))i=Hv(a,Y8);else if(e.length>=2&&e.length<=4){var o=!e.some(function(s,l){return!uje[l].includes(r2(s))});o&&(i=Hre)}}return i}function rb(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.keepDirection,n=r===void 0?!1:r,i=t.propToCol;if(!lje.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(a){var o=e===eB,s=o?a.from.row:a[0],l=o?a.from.col:a[1],u=o?a.to.row:a[2],f=o?a.to.col:a[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof f=="string"&&(f=i(f))),pr(u)&&(u=s),pr(f)&&(f=l),!n){var c=s,h=l,d=u,v=f;s=Math.min(c,d),l=Math.min(h,v),u=Math.max(c,d),f=Math.max(h,v)}return[s,l,u,f]}}function fje(e){var t=Hv(e);if(t===qO||t===ZO)return[];var r=rb(t),n=new Set;ne(e,function(o){var s=r(o),l=$re(s,4),u=l[1],f=l[3],c=Math.max(u,0),h=f-c+1;ne(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=Zr(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function cje(e){var t=Hv(e);if(t===qO||t===ZO)return[];var r=rb(t),n=new Set;ne(e,function(o){var s=r(o),l=$re(s,3),u=l[0],f=l[2],c=Math.max(u,0),h=f-c+1;ne(Array.from(new Array(h),function(d,v){return c+v}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(o,s){return o-s}),a=Zr(i,function(o,s,l,u){return l!==0&&s===u[l-1]+1?o[o.length-1][1]+=1:o.push([s,1]),o},[]);return a}function Pl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof e=="number"&&e>=0&&e<t}function nb(e){return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(e)}var K8;function X8(e,t){return pje(e)||vje(e,t)||dje(e,t)||hje()}function hje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dje(e,t){if(e){if(typeof e=="string")return q8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q8(e,t)}}function q8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function pje(e){if(Array.isArray(e))return e}function gje(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function yje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bje(n.key),n)}}function mje(e,t,r){return t&&Z8(e.prototype,t),r&&Z8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bje(e){var t=wje(e,"string");return nb(t)==="symbol"?t:String(t)}function wje(e,t){if(nb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(nb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bre=function(){function e(t,r){var n=this;yje(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new JVe(function(i,a,o){return n.tableProps.createCellRange(i,a,o)}),this.highlight=new GVe({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(a,o){return n.tableProps.isDisabledCellSelection(a,o)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},createCellRange:function(a,o,s){return n.tableProps.createCellRange(a,o,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new nje(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(a){return n.tableProps.visualToRenderableCoords(a)},renderableToVisualCoords:function(a){return n.tableProps.renderableToVisualCoords(a)},createCellCoords:function(a,o){return n.tableProps.createCellCoords(a,o)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(a))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(a))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(a))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n.runLocalHooks.apply(n,["insertColRequire"].concat(a))})}return mje(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.settings.selectionMode==="multiple",o=pr(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,f=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),f),(!a||a&&!o&&pr(n))&&this.selectedRange.clear(),this.selectedRange.add(f),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(z0,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var a=this.getLayerLevel();a<this.highlight.layerLevel&&(ne(this.highlight.getAreas(),function(p){return void p.clear()}),ne(this.highlight.getHeaders(),function(p){return void p.clear()}),ne(this.highlight.getActiveHeaders(),function(p){return void p.clear()})),this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(o.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(XO,i.highlight)&&(this.isMultiple()||a>=1)&&(o.add(i.from).add(i.to).commit(),a===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(a-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(lS,i.highlight)){var f=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,h=i;if((f||c)&&(h=i.clone()),f&&(h.from.row=-1),c&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===i.getWidth();d&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var v=this.tableProps.countRows()===i.getHeight();v&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=Pc(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),a=this.tableProps.countCols();if(!(!r&&!n&&(i===0||a===0))){var o=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,a-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=Hv(r);if(i===ZO)return!1;if(i===qO)throw new Error(sr(K8||(K8=gje([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var a=rb(i,{propToCol:function(f){return n.tableProps.propToCol(f)},keepDirection:!0}),o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var f=a(u),c=X8(f,4),h=c[0],d=c[1],v=c[2],p=c[3],g=Pl(h,o)&&Pl(d,s)&&Pl(v,o)&&Pl(p,s);return!g});return l&&(this.clear(),ne(r,function(u){var f=a(u),c=X8(f,4),h=c[0],d=c[1],v=c[2],p=c[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(v,p)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=typeof r=="string"?this.tableProps.propToCol(r):r,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=Pl(a,s)&&Pl(o,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,a)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,o)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,a=this.tableProps.countRows(),o=this.tableProps.countCols(),s=Pl(r,a)&&Pl(n,a);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,o-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var a=0;a<this.selectedRange.size();a+=1){this.highlight.useLayerLevel(a);var o=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();o.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),e}();yr(Bre,Vi);const Sje=Bre;var _je=pt,Vre=$w,Cje=ns.f,xje=ih,J8=ln,Tje=wF,Oje=Hi,Eje=SF,Q8=Vre("".startsWith),Rje=Vre("".slice),kje=Math.min,jre=Eje("startsWith"),Aje=!jre&&!!function(){var e=Cje(String.prototype,"startsWith");return e&&!e.writable}();_je({target:"String",proto:!0,forced:!Aje&&!jre},{startsWith:function(t){var r=J8(Oje(this));Tje(t);var n=xje(kje(arguments.length>1?arguments[1]:void 0,r.length)),i=J8(t);return Q8?Q8(r,i,n):Rje(r,n,n+i.length)===i}});var eU=/^(\r\n|\n\r|\r|\n)/,Pje=/^[^\t\r\n]+/,tU=/^\t/;function Ije(e){var t=[[""]];if(e.length===0)return t;for(var r=0,n=0,i;e.length>0&&i!==e.length;)if(i=e.length,e.match(tU))e=e.replace(tU,""),r+=1,t[n][r]="";else if(e.match(eU))e=e.replace(eU,""),r=0,n+=1,t[n]=[""];else{var a="";if(e.startsWith('"')){for(var o=0,s=!0;s;){var l=e.slice(0,1);l==='"'&&(o+=1),a+=l,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&o%2===0)&&(s=!1)}a=a.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(f){return new Array(Math.floor(f.length/2)).fill('"').join("")})}else{var u=e.match(Pje);a=u?u[0]:"",e=e.slice(a.length)}t[n][r]=a}return t}function mm(e){var t,r,n,i,a="",o;for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(a+="	"),o=e[t][n],typeof o=="string"?o.indexOf(`
`)>-1?a+='"'.concat(o.replace(/"/g,'""'),'"'):a+=o:o==null?a+="":a+=o;t!==r-1&&(a+=`
`)}return a}function wk(e){return Lje(e)||Nje(e)||Dje(e)||Mje()}function Mje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dje(e,t){if(e){if(typeof e=="string")return n2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n2(e,t)}}function Nje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lje(e){if(Array.isArray(e))return n2(e)}function n2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bv(e){return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bv(e)}function Fje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hje(n.key),n)}}function $je(e,t,r){return t&&rU(e.prototype,t),r&&rU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hje(e){var t=Bje(e,"string");return Bv(t)==="symbol"?t:String(t)}function Bje(e,t){if(Bv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vje=function(){function e(t,r,n){Fje(this,e),this.instance=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return $je(e,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var a=0,o=0,s=!1;if(typeof n=="function"){var l=CO(r);a=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;a=Math.min(u,n.length)}for(i=0;i<a;i++){var f=s?n(i):n[i];if(Pt(f)){if(typeof f.data<"u"){var c=s?o:i;this.colToPropCache[c]=f.data,this.propToColCache.set(f.data,c)}o+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return T$(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var a=this,o=n,s=i,l;return typeof o>"u"&&(o=0,s=""),Bv(r)==="object"&&!Array.isArray(r)&&It(r,function(u,f){u===null?(l=s+f,a.colToPropCache.push(l),a.propToColCache.set(l,o),o+=1):o=a.recursiveDuckColumns(u,o,"".concat(f,"."))}),o}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&Xe(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(Xe(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?av(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.source,s=a.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),f=u,c=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(f=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,i,o);if(d===!1||f===null)return{delta:0};for(var v=this.tableMeta.maxRows,p=this.getSchema().length,g=[],y=function(){var S=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?S=Xn(n.getSchema()):(S=[],rt(p-1,function(){return S.push(null)})):n.instance.dataType==="function"?S=n.tableMeta.dataSchema(h+c):(S={},Yw(S,n.getSchema())),g.push(S),c+=1};c<i&&u+c<v;)y();this.instance.rowIndexMapper.insertIndexes(h,c),l==="below"&&(f=Math.min(f+1,u)),this.spliceData(f,0,g);var m=this.instance.toVisualRow(f);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(r==null?this.metaManager.createRow(null,c):o!=="auto"&&this.metaManager.createRow(f,i)),this.instance.runHooks("afterCreateRow",m,c,o),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:f}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.source,o=i.mode,s=o===void 0?"start":o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,f=this.instance.countSourceCols(),c=r;(typeof c!="number"||c>=f)&&(c=f);var h=this.instance.runHooks("beforeCreateCol",c,n,a);if(h===!1)return{delta:0};var d=f;c<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(c));var v=this.instance.countSourceRows(),p=this.instance.countCols(),g=0,y=d;s==="end"&&(y=Math.min(y+1,f));for(var m=y;g<n&&p<u;){if(typeof c!="number"||c>=p)if(v>0)for(var b=0;b<v;b+=1)typeof l[b]>"u"&&(l[b]=[]),l[b].push(null);else l.push([null]);else for(var S=0;S<v;S++)l[S].splice(y,0,null);g+=1,y+=1,p+=1}this.instance.columnIndexMapper.insertIndexes(c,g),g>0&&(r==null?this.metaManager.createColumn(null,g):a!=="auto"&&this.metaManager.createColumn(m,n));var x=this.instance.toVisualColumn(m);return this.instance.runHooks("afterCreateCol",x,g,a),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:m}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(o,i),l=this.instance.countSourceRows();o=(l+o)%l;var u=this.instance.runHooks("beforeRemoveRow",o,s.length,s,a);if(u===!1)return!1;var f=s.length;if(this.filterData(o,f,s),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var c=Xe(this.tableMeta.columns)||Xe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=s.slice(0).sort(function(d,v){return v-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",o,f,s,a),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var a=typeof r!="number"?-n:r;a=(this.instance.countCols()+a)%this.instance.countCols();var o=this.visualColumnsToPhysical(a,n),s=o.slice(0).sort(function(m,b){return b-m}),l=this.instance.runHooks("beforeRemoveCol",a,n,o,i);if(l===!1)return!1;for(var u=!0,f=s.length,c=this.dataSource,h=0;h<f;h++)u&&o[0]!==o[h]-h&&(u=!1);if(u)for(var d=0,v=this.instance.countSourceRows();d<v;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(var p=0,g=this.instance.countSourceRows();p<g;p++)for(var y=0;y<f;y++)c[p].splice(s[y],1),p===0&&this.metaManager.removeColumn(s[y],1);return a<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",a,n,o,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var a=this.instance.getDataAtCol(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];MI(u,s);for(var c=0;c<i;)u.push(null),c+=1;return xQ(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(r,n,i){for(var a=this.instance.getSourceDataAtRow(r),o=a.slice(n,n+i),s=a.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),f=3;f<l;f++)u[f-3]=arguments[f];MI(u,s);for(var c=0;c<i;)u.push(null),c+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),o}},{key:"spliceData",value:function(r,n,i){var a=this,o=this.instance.runHooks("beforeDataSplice",r,n,i);if(o!==!1){var s=[].concat(wk(this.dataSource.slice(0,r)),wk(i),wk(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return a.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var a=this.instance.runHooks("filterData",r,n,i);Array.isArray(a)===!1&&(a=this.dataSource.filter(function(o,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,a)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),a=this.dataSource[i],o=this.instance.runHooks("modifyRowData",i);a=isNaN(o)?o:a;var s=null;if(a&&a.hasOwnProperty&&Vr(a,n))s=a[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=a;if(!u)return null;for(var f=0,c=l.length;f<c;f++)if(u=u[l[f]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=Pc(s);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var a=this.instance.toPhysicalRow(r),o=i,s=this.dataSource[a],l=this.instance.runHooks("modifyRowData",a);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=Pc(o);this.instance.runHooks("modifyData",a,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}if(s&&s.hasOwnProperty&&Vr(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){var f=n.split("."),c=s,h=0,d;for(h=0,d=f.length-1;h<d;h++)typeof c[f[h]]>"u"&&(c[f[h]]={}),c=c[f[h]];c[f[h]]=o}else typeof n=="function"?n(this.dataSource.slice(a,a+1)[0],o):s[n]=o}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),a=[],o=(i+r)%i,s=n,l;o<i&&s;)l=this.instance.toPhysicalRow(o),a.push(l),s-=1,o+=1;return a}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),a=[],o=(i+r)%i,s=n;o<i&&s;){var l=this.instance.toPhysicalColumn(o);a.push(l),s-=1,o+=1}return a}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,e.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var a=[],o,s,l,u=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(u===0||f===0)return[];var c=i===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(f-1,0),Math.max(r.col,n.col));for(o=Math.min(r.row,n.row);o<=h;o++){l=[];var v=o>=0?this.instance.toPhysicalRow(o):o;for(s=Math.min(r.col,n.col);s<=d&&v!==null;s++)l.push(c.call(this,o,this.colToProp(s)));v!==null&&a.push(l)}return a}},{key:"getText",value:function(r,n){return mm(this.getRange(r,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return mm(this.getRange(r,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}();const jje=Vje;var uS=Ha("cellTypes"),Wje=uS.register,Uje=uS.getItem,Wre=uS.hasItem,zje=uS.getNames;uS.getValues;function tB(e){if(!Wre(e))throw Error('You declared cell type "'.concat(e,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Uje(e)}function Za(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);var r=t,n=r.editor,i=r.renderer,a=r.validator;n&&ki(e,n),i&&Vo(e,i),a&&xd(e,a),Wje(e,t)}function Gje(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!Vr(t,e)}function JO(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=typeof t.type=="string"?tB(t.type):t.type;if(e._automaticallyAssignedMetaProps&&It(t,function(a,o){return void e._automaticallyAssignedMetaProps.delete(o)}),!!Pt(n)){r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);var i={};It(n,function(a,o){if(Gje(o,r)){var s;i[o]=a,(s=e._automaticallyAssignedMetaProps)===null||s===void 0||s.add(o)}}),an(e,i)}}function Yje(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}wl(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function lC(e){return Number.isInteger(e)&&e>=0}function uC(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function s_(e){return e==null}function i2(e){return i2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i2(e)}const Ure=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,t),pn(i)===!1)return!1;return!0},isEmptyRow:function(t){var r,n,i,a;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(t,r),pn(i)===!1)return i2(i)==="object"?(a=this.getCellMeta(t,r),RF(this.getSchema()[a.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function ib(e){return ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ib(e)}function nU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nU(Object(r),!0).forEach(function(n){Kje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kje(e,t,r){return t=Gre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gre(n.key),n)}}function zre(e,t,r){return t&&aU(e.prototype,t),r&&aU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gre(e){var t=Xje(e,"string");return ib(t)==="symbol"?t:String(t)}function Xje(e,t){if(ib(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ib(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qje(){return zre(function e(){Yre(this,e)})}var Zje=function(){function e(t){Yre(this,e),this.metaCtor=qje(),this.meta=this.metaCtor.prototype,an(this.meta,Ure()),this.meta.instance=t}return zre(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;an(this.meta,r),JO(this.meta,iU(iU({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),e}();function ab(e){return ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ab(e)}function Jje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eWe(n.key),n)}}function Qje(e,t,r){return t&&oU(e.prototype,t),r&&oU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eWe(e){var t=tWe(e,"string");return ab(t)==="symbol"?t:String(t)}function tWe(e,t){if(ab(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ab(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rWe=function(){function e(t){Jje(this,e);var r=t.getMetaConstructor();this.meta=new r}return Qje(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){an(this.meta,r),JO(this.meta,r,r)}}]),e}();function ob(e){return ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ob(e)}function sU(e){return oWe(e)||aWe(e)||iWe(e)||nWe()}function nWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iWe(e,t){if(e){if(typeof e=="string")return a2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a2(e,t)}}function aWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oWe(e){if(Array.isArray(e))return a2(e)}function a2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uWe(n.key),n)}}function lWe(e,t,r){return t&&lU(e.prototype,t),r&&lU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uWe(e){var t=fWe(e,"string");return ob(t)==="symbol"?t:String(t)}function fWe(e,t){if(ob(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ob(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o2=function(e){function t(r){sWe(this,t),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return lWe(t,[{key:"obtain",value:function(n){uC(function(){return lC(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),a;if(i>=0)a=this.data[i],a===void 0&&(a=this.valueFactory(n),this.data[i]=a);else if(a=this.valueFactory(n),this.holes.size>0){var o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=a,this.index[n]=o}else this.data.push(a),this.index[n]=this.data.length-1;return a}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;uC(function(){return lC(n)||s_(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=[],o=this.data.length,s=0;s<i;s++)a.push(o+s),this.data.push(void 0);var l=s_(n)?this.index.length:n;this.index=[].concat(sU(this.index.slice(0,l)),a,sU(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;uC(function(){return lC(n)||s_(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=this.index.splice(s_(n)?this.index.length-i:n,i),o=0;o<a.length;o++){var s=a[o];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return ra(this.data,function(i,a){return!n.holes.has(a)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var a=this._getKeyByStorageIndex(i);a!==-1&&n.push([a,this.data[i]])}var o=0;return{next:function(){if(o<n.length){var l=n[o];return o+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator);function sb(e){return sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sb(e)}function cWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dWe(n.key),n)}}function hWe(e,t,r){return t&&uU(e.prototype,t),r&&uU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dWe(e){var t=vWe(e,"string");return sb(t)==="symbol"?t:String(t)}function vWe(e,t){if(sb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pWe=["data","width"],gWe=function(){function e(t){var r=this;cWe(this,e),this.globalMeta=t,this.metas=new o2(function(){return r._createMeta()})}return hWe(e,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);an(i,n),JO(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return Yje(this.globalMeta.getMetaConstructor(),pWe).prototype}}]),e}();function lb(e){return lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lb(e)}function yWe(e){return SWe(e)||wWe(e)||bWe(e)||mWe()}function mWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bWe(e,t){if(e){if(typeof e=="string")return s2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s2(e,t)}}function wWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SWe(e){if(Array.isArray(e))return s2(e)}function s2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xWe(n.key),n)}}function CWe(e,t,r){return t&&fU(e.prototype,t),r&&fU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xWe(e){var t=TWe(e,"string");return lb(t)==="symbol"?t:String(t)}function TWe(e,t){if(lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OWe=function(){function e(t){var r=this;_We(this,e),this.columnMeta=t,this.metas=new o2(function(){return r._createRow()})}return CWe(e,[{key:"updateMeta",value:function(r,n,i){var a=this.getMeta(r,n);an(a,i),JO(a,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);return i===void 0?a:a[i]}},{key:"setMeta",value:function(r,n,i,a){var o,s=this.metas.obtain(r).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=a}},{key:"removeMeta",value:function(r,n,i){var a=this.metas.obtain(r).obtain(n);delete a[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,yWe(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){uC(function(){return lC(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new o2(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),e}();function ub(e){return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ub(e)}function EWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kWe(n.key),n)}}function RWe(e,t,r){return t&&cU(e.prototype,t),r&&cU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function kWe(e){var t=AWe(e,"string");return ub(t)==="symbol"?t:String(t)}function AWe(e,t){if(ub(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ub(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kre=function(){function e(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];EWe(this,e),this.hot=t,this.globalMeta=new Zje(t),this.tableMeta=new rWe(this.globalMeta),this.columnMeta=new gWe(this.globalMeta),this.cellMeta=new OWe(this.columnMeta),i.forEach(function(a){return new a(r)}),this.globalMeta.updateMeta(n)}return RWe(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var a=i.visualRow,o=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=a,s.visualCol=o,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,a){this.cellMeta.setMeta(r,n,i,a)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();yr(Kre,Vi);function Wx(e){return Wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wx(e)}function hU(e,t,r,n){var i=n.hotInstance,a=n.dataMap,o=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,f=n.firstRun,c=Ni(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":br(h.dataSchema)?i.dataType="function":i.dataType="object",a&&a.destroy(),e=i.runHooks("before".concat(c),e,f,l);var d=new jje(i,e,u);if(t(d),Wx(e)==="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){var v=d.getSchema();e=[];var p,g=0,y=0;for(g=0,y=h.startRows;g<y;g++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)p=Xn(v),e.push(p);else if(i.dataType==="array")p=Xn(v[0]),e.push(p);else{p=[];for(var m=0,b=h.startCols;m<b;m++)p.push(null);e.push(p)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(Wx(e)," given)"));Array.isArray(e[0])&&(i.dataType="array"),h.data=e,d.dataSource=e,o.data=e,o.dataType=i.dataType,o.colToProp=d.colToProp.bind(d),o.propToCol=d.propToCol.bind(d),o.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks("after".concat(c),e,f,l),f||(i.runHooks("afterChange",null,s),i.render())}function fb(e){return fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fb(e)}function PWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MWe(n.key),n)}}function IWe(e,t,r){return t&&dU(e.prototype,t),r&&dU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MWe(e){var t=DWe(e,"string");return fb(t)==="symbol"?t:String(t)}function DWe(e,t){if(fb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NWe=function(){function e(t){var r=this;PWe(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Qe.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return IWe(e,[{key:"extendCellMeta",value:function(r){var n,i=r.row,a=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(a))){var o=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",o,s,r);var f=Vr(r,"type")?r.type:null,c=br(r.cells)?r.cells(i,a,u):null;if(f)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:f}else c={type:f};c&&this.metaManager.updateCellMeta(i,a,c),l.runHooks("afterGetCellMeta",o,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(a)}}}]),e}();function cb(e){return cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cb(e)}function LWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$We(n.key),n)}}function FWe(e,t,r){return t&&vU(e.prototype,t),r&&vU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $We(e){var t=HWe(e,"string");return cb(t)==="symbol"?t:String(t)}function HWe(e,t){if(cb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BWe=function(){function e(t){LWe(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,a){if(!a)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return FWe(e,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var a=n.target,o=n.onChange,s=o===void 0?function(){}:o,l=typeof a=="string",u=l?a:i,f="_".concat(u);r.metaManager.globalMeta.meta[f]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,f,s),l&&r.installPropWatcher(a,f,s)})}},{key:"installPropWatcher",value:function(r,n,i){var a=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!a.usageTracker.has(r);a.usageTracker.add(r),i.call(a,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),e}(),pU=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),l_=function(t){return t.map(function(r){var n=r.toLowerCase();return pU.has(n)?pU.get(n):n}).sort().join("+")},VWe=function(t){return t.split("+")},gU=function(t){return t.toLowerCase()},yU;function jWe(e){return zWe(e)||UWe(e)||Xre(e)||WWe()}function WWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UWe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zWe(e){if(Array.isArray(e))return l2(e)}function GWe(e,t){return XWe(e)||KWe(e,t)||Xre(e,t)||YWe()}function YWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xre(e,t){if(e){if(typeof e=="string")return l2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l2(e,t)}}function l2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KWe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function XWe(e){if(Array.isArray(e))return e}function qWe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ZWe=function(t){var r=VO({errorIdExists:function(f){return'The "'.concat(f,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.keys,h=f.callback,d=f.group,v=f.runOnlyIf,p=v===void 0?function(){return!0}:v,g=f.captureCtrl,y=g===void 0?!1:g,m=f.preventDefault,b=m===void 0?!0:m,S=f.stopPropagation,x=S===void 0?!1:S,T=f.relativeToGroup,E=f.position;if(pr(d))throw new Error("You need to define the shortcut's group.");if(br(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(sr(yU||(yU=qWe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var P={callback:h,group:d,runOnlyIf:p,captureCtrl:y,preventDefault:b,stopPropagation:x};if(Xe(T)){var R=[T,E];P.relativeToGroup=R[0],P.position=R[1]}c.forEach(function(M){var D=l_(M),N=r.hasItem(D);if(N){var B=r.getItem(D),K=B.findIndex(function(Z){return Z.group===T});K!==-1?E==="before"?K-=1:K+=1:K=B.length,B.splice(K,0,P)}else r.addItem(D,[P])})},i=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.forEach(function(h){It(c,function(d,v){Object.prototype.hasOwnProperty.call(h,v)===!1&&(h[v]=c[v])}),n(h)})},a=function(f){var c=l_(f);r.removeItem(c)},o=function(f){var c=r.getItems();c.forEach(function(h){var d=GWe(h,2),v=d[0],p=d[1],g=p.filter(function(y){return y.group!==f});g.length===0?a(VWe(v)):(p.length=0,p.push.apply(p,jWe(g)))})},s=function(f){var c=l_(f),h=r.getItem(c);return Xe(h)?h.slice():[]},l=function(f){var c=l_(f);return r.hasItem(c)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:a,removeShortcutsByGroup:o}};function JWe(){var e=new Set;return{press:function(r){e.add(r)},release:function(r){e.delete(r)},releaseAll:function(){e.clear()},isPressed:function(r){return e.has(r)}}}var QWe=["meta","alt","shift","control"],iy=JWe();function e5e(e,t,r,n,i){var a=function(d){return QWe.includes(d)},o=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,p=[];return d.altKey&&p.push("alt"),v&&(d.ctrlKey||d.metaKey)?p.push("control/meta"):(d.ctrlKey&&p.push("control"),d.metaKey&&p.push("meta")),d.shiftKey&&p.push("shift"),p},s=function(d){if(t(d)!==!1){var v=r(d);if(!(d.keyCode===229||v===!1||$f(d))){var p=gU(d.key),g=[];a(p)?iy.press(p):g=o(d);var y=[p].concat(g),m=i(d,y);!m&&(ZC()&&g.includes("meta")||!ZC()&&g.includes("control"))&&i(d,[p].concat(o(d,!0))),n(d)}}},l=function(d){if(t(d)!==!1){var v=gU(d.key);a(v)!==!1&&iy.release(v)}},u=function(){iy.releaseAll()},f=function(){for(var d=e;d;)d.document.documentElement.addEventListener("keydown",s),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=i0(d)},c=function(){for(var d=e;d;)d.document.documentElement.removeEventListener("keydown",s),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=i0(d)};return{mount:f,unmount:c,isPressed:function(d){return iy.isPressed(d)},releasePressedKeys:function(){return iy.releaseAll()}}}var t5e=function(t){var r=t.ownerWindow,n=t.handleEvent,i=t.beforeKeyDown,a=t.afterKeyDown,o=VO({errorIdExists:function(p){return'The "'.concat(p,'" context name is already registered.')}}),s="grid",l=function(p){var g=ZWe(p);return o.addItem(p,g),g},u=function(){return s},f=function(p){return o.getItem(p)},c=function(p){s=p},h=!1,d=e5e(r,n,i,a,function(v,p){var g=f(u()),y=!1;if(!g.hasShortcut(p))return y;for(var m=g.getShortcuts(p),b=0;b<m.length;b++){var S=m[b],x=S.callback,T=S.runOnlyIf,E=S.preventDefault,P=S.stopPropagation,R=S.captureCtrl;if(T(v)!==!1&&(h=R,y=x(v,p)===!1,h=!1,E&&v.preventDefault(),P&&v.stopPropagation(),y))break}return y});return d.mount(),{addContext:l,getActiveContextName:u,getContext:f,setActiveContextName:c,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},mU,bU;function Ei(e){return Ei=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ei(e)}function wU(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ro(e,t){return i5e(e)||n5e(e,t)||qre(e,t)||r5e()}function r5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function i5e(e){if(Array.isArray(e))return e}function Dh(e){return s5e(e)||o5e(e)||qre(e)||a5e()}function a5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qre(e,t){if(e){if(typeof e=="string")return u2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u2(e,t)}}function o5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function s5e(e){if(Array.isArray(e))return u2(e)}function u2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l5e="gridDefault",Sk=null,u_=new Set;function rB(e,t){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,o=this,s=new Fr(o),l,u,f,c,h=!0;mHe(i)&&yHe(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=t==null?void 0:t.layoutDirection)!==null&&r!==void 0?r:"inherit",v=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=b4e(t.language);var p=new Kre(o,t,[NWe,BWe]),g=p.getTableMeta(),y=p.getGlobalMeta(),m=VO();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),LM(this)&&Iee(t.licenseKey,e),this.guid="ht_".concat(JF()),this.columnIndexMapper=new JM,this.rowIndexMapper=new JM,u=new WHe(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var b=function(C){var O=C.row,_=C.col;return o._createCellCoords(O>=0?o.rowIndexMapper.getRenderableFromVisualIndex(O):O,_>=0?o.columnIndexMapper.getRenderableFromVisualIndex(_):_)},S=function(C){var O=C.row,_=C.col;return o._createCellCoords(O>=0?o.rowIndexMapper.getVisualFromRenderableIndex(O):O,_>=0?o.columnIndexMapper.getVisualFromRenderableIndex(_):_)},x=new Sje(g,{rowIndexMapper:function(){return o.rowIndexMapper},columnIndexMapper:function(){return o.columnIndexMapper},countCols:function(){return o.countCols()},countRows:function(){return o.countRows()},propToCol:function(C){return l.propToCol(C)},isEditorOpened:function(){return o.getActiveEditor()?o.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return o.getShortcutManager()},createCellCoords:function(C,O){return o._createCellCoords(C,O)},createCellRange:function(C,O,_){return o._createCellRange(C,O,_)},visualToRenderableCoords:b,renderableToVisualCoords:S,isDisabledCellSelection:function(C,O){return o.getCellMeta(C,O).disableVisualSelection}});this.selection=x;var T=function(C){var O=C.hiddenIndexesChanged;O&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",T),this.rowIndexMapper.addLocalHook("cacheUpdated",T),this.selection.addLocalHook("beforeSetRangeStart",function(w){n.runHooks("beforeSetRangeStart",w)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(w){n.runHooks("beforeSetRangeStartOnly",w)}),this.selection.addLocalHook("beforeSetRangeEnd",function(w){n.runHooks("beforeSetRangeEnd",w),w.row<0&&(w.row=n.view._wt.wtTable.getFirstVisibleRow()),w.col<0&&(w.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(w){var C=Pc(!1),O=n.selection.getSelectedRange(),_=O.current(),A=_.from,I=_.to,L=O.size()-1;n.runHooks("afterSelection",A.row,A.col,I.row,I.col,C,L),n.runHooks("afterSelectionByProp",A.row,o.colToProp(A.col),I.row,o.colToProp(I.col),C,L);var V=n.selection.isSelectedByAnyHeader(),Y=n.selection.selectedRange.current(),ae=!0;a&&(ae=!1),C.isTouched()&&(ae=!C.value);var re=n.selection.isSelectedByRowHeader(),te=n.selection.isSelectedByColumnHeader();ae!==!1&&(V?re?n.view.scrollViewportVertically(o.rowIndexMapper.getRenderableFromVisualIndex(w.row)):te&&n.view.scrollViewportHorizontally(o.columnIndexMapper.getRenderableFromVisualIndex(w.col)):Y&&!n.selection.isMultiple()?n.view.scrollViewport(b(Y.from)):n.view.scrollViewport(b(w))),re&&te?ke(n.rootElement,["ht__selection--rows","ht__selection--columns"]):re?(St(n.rootElement,"ht__selection--columns"),ke(n.rootElement,"ht__selection--rows")):te?(St(n.rootElement,"ht__selection--rows"),ke(n.rootElement,"ht__selection--columns")):St(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(w){var C=w.length-1,O=w[C],_=O.from,A=O.to;n.runHooks("afterSelectionEnd",_.row,_.col,A.row,A.col,C),n.runHooks("afterSelectionEndByProp",_.row,o.colToProp(_.col),A.row,o.colToProp(A.col),C)}),this.selection.addLocalHook("afterIsMultipleSelection",function(w){var C=n.runHooks("afterIsMultipleSelection",w.value);w.value&&(w.value=C)}),this.selection.addLocalHook("beforeModifyTransformStart",function(w){n.runHooks("modifyTransformStart",w)}),this.selection.addLocalHook("afterModifyTransformStart",function(w,C,O){n.runHooks("afterModifyTransformStart",w,C,O)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(w){n.runHooks("modifyTransformEnd",w)}),this.selection.addLocalHook("afterModifyTransformEnd",function(w,C,O){n.runHooks("afterModifyTransformEnd",w,C,O)}),this.selection.addLocalHook("afterDeselect",function(){c.destroyEditor(),n._refreshBorders(),St(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(w){n.alter("insert_row_above",w,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(w){n.alter("insert_col_start",w,1,"auto")}),f={alter:function(C,O){var _,A,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,L=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0,Y=function(ut){if(ut.length===0)return[];var ft=Dh(ut);ft.sort(function(Ft,Dt){var wt=Ro(Ft,1),dt=wt[0],Ke=Ro(Dt,1),Be=Ke[0];return dt===Be?0:dt>Be?1:-1});var Et=Zr(ft,function(Ft,Dt){var wt=Ro(Dt,2),dt=wt[0],Ke=wt[1],Be=Ft[Ft.length-1],at=Ro(Be,2),He=at[0],ot=at[1],We=He+ot;if(dt<=We){var Je=Math.max(Ke-(We-dt),0);Be[1]+=Je}else Ft.push([dt,Ke]);return Ft},[ft[0]]);return Et};switch(C){case"insert_row":u_.has(C)||(u_.add(C),gr(sr(mU||(mU=wU(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),C)));case"insert_row_below":case"insert_row_above":var ae=o.countSourceRows();if(g.maxRows===ae)return;var re=C==="insert_row_below"?"below":"above";O=(_=O)!==null&&_!==void 0?_:C==="insert_row"||re==="below"?ae:0;var te=l.createRow(O,I,{source:L,mode:re}),ge=te.delta,H=te.startPhysicalIndex;if(ge){var Ce=x.selectedRange.current(),oe=Ce==null?void 0:Ce.from,Oe=oe==null?void 0:oe.row,Ee=o.toVisualRow(H);if(x.isSelectedByCorner())o.selectAll();else if(Xe(Oe)&&Oe>=Ee){var be=Ce.to,Ie=be.row,Me=be.col,j=oe.col;x.isSelectedByRowHeader()&&(j=-1),x.getSelectedRange().pop(),x.setRangeStartOnly(o._createCellCoords(Oe+ge,j),!0),x.setRangeEnd(o._createCellCoords(Ie+ge,Me))}else o._refreshBorders()}break;case"insert_col":u_.has(C)||(u_.add(C),gr(sr(bU||(bU=wU(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),C)));case"insert_col_start":case"insert_col_end":var U=C==="insert_col_end"?"end":"start";O=(A=O)!==null&&A!==void 0?A:C==="insert_col"||U==="end"?o.countSourceCols():0;var Q=l.createCol(O,I,{source:L,mode:U}),fe=Q.delta,ee=Q.startPhysicalIndex;if(fe){if(Array.isArray(g.colHeaders)){var pe=[o.toVisualColumn(ee),0];pe.length+=fe,Array.prototype.splice.apply(g.colHeaders,pe)}var se=x.selectedRange.current(),ue=se==null?void 0:se.from,ce=ue==null?void 0:ue.col,ve=o.toVisualColumn(ee);if(x.isSelectedByCorner())o.selectAll();else if(Xe(ce)&&ce>=ve){var de=se.to,Te=de.row,Le=de.col,$e=ue.row;x.isSelectedByColumnHeader()&&($e=-1),x.getSelectedRange().pop(),x.setRangeStartOnly(o._createCellCoords($e,ce+fe),!0),x.setRangeEnd(o._createCellCoords(Te,Le+fe))}else o._refreshBorders()}break;case"remove_row":var it=function(ut){var ft=0;ne(ut,function(Et){var Ft=Ro(Et,2),Dt=Ft[0],wt=Ft[1],dt=pn(Dt)?o.countRows()-1:Math.max(Dt-ft,0);Number.isInteger(Dt)&&(Dt=Math.max(Dt-ft,0));var Ke=l.removeRow(Dt,wt,L);if(Ke){var Be=o.countRows(),at=g.fixedRowsTop;at>=dt+1&&(g.fixedRowsTop-=Math.min(wt,at-dt));var He=g.fixedRowsBottom;He&&dt>=Be-He&&(g.fixedRowsBottom-=Math.min(wt,He)),ft+=wt}})};Array.isArray(O)?it(Y(O)):it([[O,I]]),f.adjustRowsAndCols(),o._refreshBorders();break;case"remove_col":var yt=function(ut){var ft=0;ne(ut,function(Et){var Ft=Ro(Et,2),Dt=Ft[0],wt=Ft[1],dt=pn(Dt)?o.countCols()-1:Math.max(Dt-ft,0),Ke=o.toPhysicalColumn(dt);Number.isInteger(Dt)&&(Dt=Math.max(Dt-ft,0));var Be=l.removeCol(Dt,wt,L);if(Be){var at=g.fixedColumnsStart;at>=dt+1&&(g.fixedColumnsStart-=Math.min(wt,at-dt)),Array.isArray(g.colHeaders)&&(typeof Ke>"u"&&(Ke=-1),g.colHeaders.splice(Ke,wt)),ft+=wt}})};Array.isArray(O)?yt(Y(O)):yt([[O,I]]),f.adjustRowsAndCols(),o._refreshBorders();break;default:throw new Error('There is no such action "'.concat(C,'"'))}V||f.adjustRowsAndCols()},adjustRowsAndCols:function(){var C=g.minRows,O=g.minSpareRows,_=g.minCols,A=g.minSpareCols;if(o.countRows()===0&&o.countCols()===0&&x.deselect(),C){var I=o.countRows();I<C&&l.createRow(I,C-I,{source:"auto"})}if(O){var L=o.countEmptyRows(!0);if(L<O){var V=O-L,Y=Math.min(V,g.maxRows-o.countSourceRows());l.createRow(o.countRows(),Y,{source:"auto"})}}{var ae;(_||A)&&(ae=o.countEmptyCols(!0));var re=o.countCols();if(_&&!g.columns&&re<_){var te=_-re;ae+=te,l.createCol(re,te,{source:"auto"})}if(A&&!g.columns&&o.dataType==="array"&&ae<A){re=o.countCols();var ge=A-ae,H=Math.min(ge,g.maxCols-re);l.createCol(re,H,{source:"auto"})}}if(x.isSelected()){var Ce=o.countRows(),oe=o.countCols();ne(x.selectedRange,function(Oe){var Ee=!1,be=Oe.from.row,Ie=Oe.from.col,Me=Oe.to.row,j=Oe.to.col;be>Ce-1?(be=Ce-1,Ee=!0,Me>be&&(Me=be)):Me>Ce-1&&(Me=Ce-1,Ee=!0,be>Me&&(be=Me)),Ie>oe-1?(Ie=oe-1,Ee=!0,j>Ie&&(j=Ie)):j>oe-1&&(j=oe-1,Ee=!0,Ie>j&&(Ie=j)),Ee&&o.selectCell(be,Ie,Me,j)})}o.view&&o.view.adjustElementsSize()},populateFromArray:function(C,O,_,A,I,L,V){var Y,ae,re,te,ge=[],H={},Ce=[],oe=C.row,Oe=C.col;if(ae=O.length,ae===0)return!1;var Ee=0,be=0;switch(Pt(_)&&(Ee=_.col-Oe+1,be=_.row-oe+1),I){case"shift_down":var Ie=um(O),Me=Ie.length,j=Math.max(Me,Ee),U=o.getData().slice(oe),Q=um(U).slice(Oe,Oe+j);for(re=0;re<j;re+=1)if(re<Me){for(Y=0,ae=Ie[re].length;Y<be-ae;Y+=1)Ie[re].push(Ie[re][Y%ae]);re<Q.length?Ce.push(Ie[re].concat(Q[re])):Ce.push(Ie[re].concat(new Array(U.length).fill(null)))}else Ce.push(Ie[re%Me].concat(Q[re]));o.populateFromArray(oe,Oe,um(Ce));break;case"shift_right":var fe=O.length,ee=Math.max(fe,be),pe=o.getData().slice(oe).map(function(at){return at.slice(Oe)});for(Y=0;Y<ee;Y+=1)if(Y<fe){for(re=0,te=O[Y].length;re<Ee-te;re+=1)O[Y].push(O[Y][re%te]);if(Y<pe.length)for(var se=0;se<pe[Y].length;se+=1)O[Y].push(pe[Y][se]);else{var ue;(ue=O[Y]).push.apply(ue,Dh(new Array(pe[0].length).fill(null)))}}else O.push(O[Y%ae].slice(0,ee).concat(pe[Y]));o.populateFromArray(oe,Oe,O);break;case"overwrite":default:H.row=C.row,H.col=C.col;var ce={row:_&&C?_.row-C.row+1:1,col:_&&C?_.col-C.col+1:1},ve=0,de=0,Te=!0,Le,$e=function(He){var ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,We=O[He%O.length];return ot!==null?We[ot%We.length]:We},it=O.length,yt=_?_.row-C.row+1:0;for(_?ae=yt:ae=Math.max(it,yt),Y=0;Y<ae&&!(_&&H.row>_.row&&yt>it||!g.allowInsertRow&&H.row>o.countRows()-1||H.row>=g.maxRows);Y++){var Vt=Y-ve,ut=$e(Vt).length,ft=_?_.col-C.col+1:0;if(_?te=ft:te=Math.max(ut,ft),H.col=C.col,Le=o.getCellMeta(H.row,H.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&Le.skipRowOnPaste){ve+=1,H.row+=1,ae+=1;continue}for(de=0,re=0;re<te&&!(_&&H.col>_.col&&ft>ut||!g.allowInsertColumn&&H.col>o.countCols()-1||H.col>=g.maxCols);re++){if(Le=o.getCellMeta(H.row,H.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&Le.skipColumnOnPaste){de+=1,H.col+=1,te+=1;continue}if(Le.readOnly&&A!=="UndoRedo.undo"){H.col+=1;continue}var Et=re-de,Ft=$e(Vt,Et),Dt=o.getDataAtCell(H.row,H.col),wt={row:Vt,col:Et};if(A==="Autofill.fill"){var dt=o.runHooks("beforeAutofillInsidePopulate",wt,L,O,V,{},ce);dt&&(Ft=pr(dt.value)?Ft:dt.value)}if(Ft!==null&&Ei(Ft)==="object")if(Array.isArray(Ft)&&Dt===null&&(Dt=[]),Dt===null||Ei(Dt)!=="object")Te=!1;else{var Ke=av(Array.isArray(Dt)?Dt:Dt[0]||Dt),Be=av(Array.isArray(Ft)?Ft:Ft[0]||Ft);RF(Ke,Be)||Array.isArray(Ke)&&Array.isArray(Be)?Ft=Xn(Ft):Te=!1}else Dt!==null&&Ei(Dt)==="object"&&(Te=!1);Te&&ge.push([H.row,H.col,Ft]),Te=!0,H.col+=1}H.row+=1}o.setDataAtCell(ge,null,null,A||"populateFromArray");break}}};function E(w){var C=xre(w);ZH(C)?(o.runHooks("beforeLanguageChange",C),y.language=C,o.runHooks("afterLanguageChange",C)):Tre(w)}function P(w,C){var O=w==="className"?o.rootElement:o.table;if(h)ke(O,C);else{var _=[],A=[];y[w]&&(_=Array.isArray(y[w])?y[w]:NI(y[w])),C&&(A=Array.isArray(C)?C:NI(C));var I=DI(_,A),L=DI(A,_);I.length&&St(O,I),L.length&&ke(O,L)}y[w]=C}this.init=function(){u.setData(g.data),o.runHooks("beforeInit"),(oo()||PF())&&ke(o.rootElement,"mobile"),this.updateSettings(g,!0),this.view=new IHe(this),c=FPe.getInstance(o,g,x),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&o.rootElement.offsetParent===null&&jee(o.rootElement,function(){o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),Ei(h)==="object"&&(o.runHooks("afterChange",h[0],h[1]),h=!1),o.runHooks("afterInit")};function R(){var w=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,w=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&w===!1&&(w=!0,this.onQueueEmpty(this.valid))}}}function M(w){var C=w.replace(",",".");return isNaN(parseFloat(C))===!1?parseFloat(C):w}function D(w,C,O){if(w.length){var _=o.getActiveEditor(),A=o.runHooks("beforeChange",w,C||"edit"),I=!0;if(A===!1){_&&_.cancelChanges();return}var L=new R;L.onQueueEmpty=function(Ce){_&&I&&_.cancelChanges(),O(Ce)};for(var V=w.length-1;V>=0;V--)if(w[V]===null)w.splice(V,1);else{var Y=Ro(w[V],4),ae=Y[0],re=Y[1],te=Y[3],ge=l.propToCol(re),H=o.getCellMeta(ae,ge);H.type==="numeric"&&typeof te=="string"&&cte(te)&&(w[V][3]=M(te)),o.getCellValidator(H)&&(L.addValidatorToQueue(),o.validateCell(w[V][3],H,function(Ce,oe){return function(Oe){if(typeof Oe!="boolean")throw new Error("Validation error: result is not boolean");if(Oe===!1&&oe.allowInvalid===!1){I=!1,w.splice(Ce,1),oe.valid=!0;var Ee=o.getCell(oe.visualRow,oe.visualCol);Ee!==null&&St(Ee,g.invalidCellClassName)}L.removeValidatorFormQueue()}}(V,H),C))}L.checkIfQueueIsEmpty()}}function N(w,C){var O=w.length-1;if(!(O<0)){for(;O>=0;O--){var _=!1;if(w[O]===null){w.splice(O,1);continue}if(!((w[O][2]===null||w[O][2]===void 0)&&(w[O][3]===null||w[O][3]===void 0))){if(g.allowInsertRow)for(;w[O][0]>o.countRows()-1;){var A=l.createRow(void 0,void 0,{source:C}),I=A.delta;if(I===0){_=!0;break}}if(o.dataType==="array"&&(!g.columns||g.columns.length===0)&&g.allowInsertColumn)for(;l.propToCol(w[O][1])>o.countCols()-1;){var L=l.createCol(void 0,void 0,{source:C}),V=L.delta;if(V===0){_=!0;break}}_||l.set(w[O][0],w[O][1],w[O][3])}}o.forceFullRender=!0,f.adjustRowsAndCols(),o.runHooks("beforeChangeRender",w,C),c.lockEditor(),o._refreshBorders(null),c.unlockEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",w,C||"edit");var Y=o.getActiveEditor();Y&&Xe(Y.refreshValue)&&Y.refreshValue()}}this._createCellCoords=function(w,C){return o.view._wt.createCellCoords(w,C)},this._createCellRange=function(w,C,O){return o.view._wt.createCellRange(w,C,O)},this.validateCell=function(w,C,O,_){var A=o.getCellValidator(C);function I(L){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!V||C.hidden===!0){O(L);return}var Y=C.visualCol,ae=C.visualRow,re=o.getCell(ae,Y,!0);if(re&&re.nodeName!=="TH"){var te=o.rowIndexMapper.getRenderableFromVisualIndex(ae),ge=o.columnIndexMapper.getRenderableFromVisualIndex(Y);o.view._wt.getSetting("cellRenderer",te,ge,re)}O(L)}Pee(A)&&(A=function(L){return function(V,Y){Y(L.test(V))}}(A)),br(A)?(w=o.runHooks("beforeValidate",w,C.visualRow,C.prop,_),o._registerImmediate(function(){A.call(C,w,function(L){o&&(L=o.runHooks("afterValidate",L,w,C.visualRow,C.prop,_),C.valid=L,I(L),o.runHooks("postAfterValidate",L,w,C.visualRow,C.prop,_))})})):o._registerImmediate(function(){C.valid=!0,I(C.valid,!1)})};function B(w,C,O){return Array.isArray(w)?w:[[w,C,O]]}this.setDataAtCell=function(w,C,O,_){var A=B(w,C,O),I=[],L=_,V,Y,ae;for(V=0,Y=A.length;V<Y;V++){if(Ei(A[V])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof A[V][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");A[V][1]>=this.countCols()?ae=A[V][1]:ae=l.colToProp(A[V][1]),I.push([A[V][0],ae,u.getAtCell(this.toPhysicalRow(A[V][0]),A[V][1]),A[V][2]])}!L&&Ei(w)==="object"&&(L=C),o.runHooks("afterSetDataAtCell",I,L),D(I,L,function(){N(I,L)})},this.setDataAtRowProp=function(w,C,O,_){var A=B(w,C,O),I=[],L=_,V,Y;for(V=0,Y=A.length;V<Y;V++)I.push([A[V][0],A[V][1],u.getAtCell(this.toPhysicalRow(A[V][0]),A[V][1]),A[V][2]]);!L&&Ei(w)==="object"&&(L=C),o.runHooks("afterSetDataAtRowProp",I,L),D(I,L,function(){N(I,L)})},this.listen=function(){o&&!o.isListening()&&(Sk=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Sk=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Sk===o.guid},this.destroyEditor=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o._refreshBorders(w,C)},this.populateFromArray=function(w,C,O,_,A,I,L,V,Y){if(!(Ei(O)==="object"&&Ei(O[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var ae=typeof _=="number"?o._createCellCoords(_,A):null;return f.populateFromArray(o._createCellCoords(w,C),O,ae,I,L,V,Y)},this.spliceCol=function(w,C,O){for(var _,A=arguments.length,I=new Array(A>3?A-3:0),L=3;L<A;L++)I[L-3]=arguments[L];return(_=l).spliceCol.apply(_,[w,C,O].concat(I))},this.spliceRow=function(w,C,O){for(var _,A=arguments.length,I=new Array(A>3?A-3:0),L=3;L<A;L++)I[L-3]=arguments[L];return(_=l).spliceRow.apply(_,[w,C,O].concat(I))},this.getSelected=function(){if(x.isSelected())return At(x.getSelectedRange(),function(w){var C=w.from,O=w.to;return[C.row,C.col,O.row,O.col]})},this.getSelectedLast=function(){var w=this.getSelected(),C;return w&&w.length>0&&(C=w[w.length-1]),C},this.getSelectedRange=function(){if(x.isSelected())return Array.from(x.getSelectedRange())},this.getSelectedRangeLast=function(){var w=this.getSelectedRange(),C;return w&&w.length>0&&(C=w[w.length-1]),C},this.emptySelectedCells=function(w){var C=this;if(!(!x.isSelected()||this.countRows()===0||this.countCols()===0)){var O=[];ne(x.getSelectedRange(),function(_){var A=_.getTopStartCorner(),I=_.getBottomEndCorner();rt(A.row,I.row,function(L){rt(A.col,I.col,function(V){C.getCellMeta(L,V).readOnly||O.push([L,V,null])})})}),O.length>0&&this.setDataAtCell(O,w)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var w=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(w,0),!this.isRenderSuspended()&&w===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(w){this.suspendRender();var C=w();return this.resumeRender(),C},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(C,0),(!this.isExecutionSuspended()&&C===this.executionSuspendedCounter||w)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var O=w();return this.resumeExecution(C),O},this.batch=function(w){this.suspendRender(),this.suspendExecution();var C=w();return this.resumeExecution(),this.resumeRender(),C},this.refreshDimensions=function(){if(o.view){var w=o.view.getLastSize(),C=w.width,O=w.height,_=o.rootElement.getBoundingClientRect(),A=_.width,I=_.height,L=A!==C||I!==O,V=o.runHooks("beforeRefreshDimensions",{width:C,height:O},{width:A,height:I},L)===!1;V||((L||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(A,I),o.render()),o.runHooks("afterRefreshDimensions",{width:C,height:O},{width:A,height:I},L))}},this.updateData=function(w,C){var O=this;hU(w,function(_){l=_},function(_){l=_,o.columnIndexMapper.fitToLength(O.getInitialColumnCount()),o.rowIndexMapper.fitToLength(O.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:C,metaManager:p,firstRun:h})},this.loadData=function(w,C){hU(w,function(O){l=O},function(){p.clearCellsCache(),o.initIndexMappers(),f.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:C,metaManager:p,firstRun:h})},this.getInitialColumnCount=function(){var w=g.columns,C=0;if(Array.isArray(w))C=w.length;else if(br(w))if(o.dataType==="array")for(var O=this.countSourceCols(),_=0;_<O;_+=1)w(_)&&(C+=1);else(o.dataType==="object"||o.dataType==="function")&&(C=l.colToPropCache.length);else if(Xe(g.dataSchema)){var A=l.getSchema();C=Array.isArray(A)?A.length:CO(A)}else C=this.countSourceCols();return C},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(w,C,O,_){return pr(w)?l.getAll():l.getRange(o._createCellCoords(w,C),o._createCellCoords(O,_),l.DESTINATION_RENDERER)},this.getCopyableText=function(w,C,O,_){return l.getCopyableText(o._createCellCoords(w,C),o._createCellCoords(O,_))},this.getCopyableData=function(w,C){return l.getCopyable(w,l.colToProp(C))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,O=(h?o.loadData:o.updateData).bind(this),_=!1,A,I;if(Xe(w.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Xe(w.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Xe(w.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(A in w)A==="data"||(A==="language"?E(w.language):A==="className"?P("className",w.className):A==="tableClassName"&&o.table?(P("tableClassName",w.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Qe.getSingleton().isRegistered(A)||Qe.getSingleton().isDeprecated(A)?(br(w[A])||Array.isArray(w[A]))&&(w[A].initialHook=!0,o.addHook(A,w[A])):!C&&Vr(w,A)&&(y[A]=w[A]));w.data===void 0&&g.data===void 0?O(null,"updateSettings"):w.data!==void 0?O(w.data,"updateSettings"):w.columns!==void 0&&(l.createMap(),o.initIndexMappers());var L=o.countCols(),V=g.columns;if(V&&br(V)&&(_=!0),(w.cell!==void 0||w.cells!==void 0||w.columns!==void 0)&&p.clearCache(),L>0)for(A=0,I=0;A<L;A++){if(V){var Y=_?V(A):V[I];Y&&p.updateColumnMeta(I,Y)}I+=1}Xe(w.cell)&&It(w.cell,function(Ce){o.setCellMetaObject(Ce.row,Ce.col,Ce)}),o.runHooks("afterCellMetaReset");var ae=o.rootElement.style.height;ae!==""&&(ae=parseInt(o.rootElement.style.height,10));var re=w.height;if(br(re)&&(re=re()),C){var te=o.rootElement.getAttribute("style");te&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(re===null){var ge=o.rootElement.getAttribute("data-initialstyle");ge&&(ge.indexOf("height")>-1||ge.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",ge):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else re!==void 0&&(o.rootElement.style.height=isNaN(re)?"".concat(re):"".concat(re,"px"),o.rootElement.style.overflow="hidden");if(typeof w.width<"u"){var H=w.width;br(H)&&(H=H()),o.rootElement.style.width=isNaN(H)?"".concat(H):"".concat(H,"px")}C||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",w)),f.adjustRowsAndCols(),o.view&&!h&&(o.forceFullRender=!0,c.lockEditor(),o._refreshBorders(null),o.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!C&&o.view&&(ae===""||re===""||re===void 0)&&ae!==re&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var w=o.getSelectedLast();if(g.getValue){if(br(g.getValue))return g.getValue.call(o);if(w)return o.getData()[w[0][0]][g.getValue]}else if(w)return o.getDataAtCell(w[0],w[1])},this.getSettings=function(){return g},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(w,C,O,_,A){f.alter(w,C,O,_,A)},this.getCell=function(w,C){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=C,A=w;if(C>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(C)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(C)}if(w>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(w)))return null;A=this.rowIndexMapper.getRenderableFromVisualIndex(w)}return A===null||_===null?null:o.view.getCellAtCoords(o._createCellCoords(A,_),O)},this.getCoords=function(w){var C=this.view._wt.wtTable.getCoords(w);if(C===null)return null;var O=C.row,_=C.col,A=O,I=_;return O>=0&&(A=this.rowIndexMapper.getVisualFromRenderableIndex(O)),_>=0&&(I=this.columnIndexMapper.getVisualFromRenderableIndex(_)),o._createCellCoords(A,I)},this.colToProp=function(w){return l.colToProp(w)},this.propToCol=function(w){return l.propToCol(w)},this.toVisualRow=function(w){return n.rowIndexMapper.getVisualFromPhysicalIndex(w)},this.toVisualColumn=function(w){return n.columnIndexMapper.getVisualFromPhysicalIndex(w)},this.toPhysicalRow=function(w){return n.rowIndexMapper.getPhysicalFromVisualIndex(w)},this.toPhysicalColumn=function(w){return n.columnIndexMapper.getPhysicalFromVisualIndex(w)},this.getDataAtCell=function(w,C){return l.get(w,l.colToProp(C))},this.getDataAtRowProp=function(w,C){return l.get(w,C)},this.getDataAtCol=function(w){for(var C=[],O=l.getRange(o._createCellCoords(0,w),o._createCellCoords(g.data.length-1,w),l.DESTINATION_RENDERER),_=0;_<O.length;_+=1)for(var A=0;A<O[_].length;A+=1)C.push(O[_][A]);return C},this.getDataAtProp=function(w){for(var C=[],O=l.getRange(o._createCellCoords(0,l.propToCol(w)),o._createCellCoords(g.data.length-1,l.propToCol(w)),l.DESTINATION_RENDERER),_=0;_<O.length;_+=1)for(var A=0;A<O[_].length;A+=1)C.push(O[_][A]);return C},this.getSourceData=function(w,C,O,_){var A;return w===void 0?A=u.getData():A=u.getByRange(o._createCellCoords(w,C),o._createCellCoords(O,_)),A},this.getSourceDataArray=function(w,C,O,_){var A;return w===void 0?A=u.getData(!0):A=u.getByRange(o._createCellCoords(w,C),o._createCellCoords(O,_),!0),A},this.getSourceDataAtCol=function(w){return u.getAtColumn(w)},this.setSourceDataAtCell=function(w,C,O,_){var A=B(w,C,O),I=this.hasHook("afterSetSourceDataAtCell"),L=[];I&&ne(A,function(Y){var ae=Ro(Y,3),re=ae[0],te=ae[1],ge=ae[2];L.push([re,te,u.getAtCell(re,te),ge])}),ne(A,function(Y){var ae=Ro(Y,3),re=ae[0],te=ae[1],ge=ae[2];u.setAtCell(re,te,ge)}),I&&this.runHooks("afterSetSourceDataAtCell",L,_),this.render();var V=o.getActiveEditor();V&&Xe(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(w){return u.getAtRow(w)},this.getSourceDataAtCell=function(w,C){return u.getAtCell(w,C)},this.getDataAtRow=function(w){var C=l.getRange(o._createCellCoords(w,0),o._createCellCoords(w,this.countCols()-1),l.DESTINATION_RENDERER);return C[0]||[]},this.getDataType=function(w,C,O,_){var A=this,I=w===void 0?[0,0,this.countRows(),this.countCols()]:[w,C,O,_],L=I[0],V=I[1],Y=I[2],ae=I[3],re=null,te=null;Y===void 0&&(Y=L),ae===void 0&&(ae=V);var ge="mixed";return rt(Math.max(Math.min(L,Y),0),Math.max(L,Y),function(H){var Ce=!0;return rt(Math.max(Math.min(V,ae),0),Math.max(V,ae),function(oe){var Oe=A.getCellMeta(H,oe);return te=Oe.type,re?Ce=re===te:re=te,Ce}),ge=Ce?te:"mixed",Ce}),ge},this.removeCellMeta=function(w,C,O){var _=[this.toPhysicalRow(w),this.toPhysicalColumn(C)],A=_[0],I=_[1],L=p.getCellMetaKeyValue(A,I,O),V=o.runHooks("beforeRemoveCellMeta",w,C,O,L);V!==!1&&(p.removeCellMeta(A,I,O),o.runHooks("afterRemoveCellMeta",w,C,O,L)),L=null},this.spliceCellsMeta=function(w){for(var C=this,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length,A=new Array(_>2?_-2:0),I=2;I<_;I++)A[I-2]=arguments[I];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");O>0&&p.removeRow(this.toPhysicalRow(w),O),A.length>0&&ne(A.reverse(),function(L){p.createRow(C.toPhysicalRow(w)),ne(L,function(V,Y){return C.setCellMetaObject(w,Y,V)})}),o.render()},this.setCellMetaObject=function(w,C,O){var _=this;Ei(O)==="object"&&It(O,function(A,I){_.setCellMeta(w,C,I,A)})},this.setCellMeta=function(w,C,O,_){var A=o.runHooks("beforeSetCellMeta",w,C,O,_);if(A!==!1){var I=w,L=C;w<this.countRows()&&(I=this.toPhysicalRow(w)),C<this.countCols()&&(L=this.toPhysicalColumn(C)),p.setCellMeta(I,L,O,_),o.runHooks("afterSetCellMeta",w,C,O,_)}},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(w,C){var O=this.toPhysicalRow(w),_=this.toPhysicalColumn(C);return O===null&&(O=w),_===null&&(_=C),p.getCellMeta(O,_,{visualRow:w,visualColumn:C})},this.getCellMetaAtRow=function(w){return p.getCellsMetaAtRow(w)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||g.columns)},this.getCellRenderer=function(w,C){var O=typeof w=="number"?o.getCellMeta(w,C).renderer:w.renderer;return typeof O=="string"?fx(O):pr(O)?fx("text"):O},this.getCellEditor=function(w,C){var O=typeof w=="number"?o.getCellMeta(w,C).editor:w.editor;return typeof O=="string"?lx(O):pr(O)?lx("text"):O},this.getCellValidator=function(w,C){var O=typeof w=="number"?o.getCellMeta(w,C).validator:w.validator;return typeof O=="string"?c$(O):O},this.validateCells=function(w){this._validateCells(w)},this.validateRows=function(w,C){if(!Array.isArray(w))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(C,w)},this.validateColumns=function(w,C){if(!Array.isArray(w))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(C,void 0,w)},this._validateCells=function(w,C,O){var _=new R;w&&(_.onQueueEmpty=w);for(var A=o.countRows()-1;A>=0;){if(C!==void 0&&C.indexOf(A)===-1){A-=1;continue}for(var I=o.countCols()-1;I>=0;){if(O!==void 0&&O.indexOf(I)===-1){I-=1;continue}_.addValidatorToQueue(),o.validateCell(o.getDataAtCell(A,I),o.getCellMeta(A,I),function(L){if(typeof L!="boolean")throw new Error("Validation error: result is not boolean");L===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),I-=1}A-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(w){var C=g.rowHeaders,O=w;return O!==void 0&&(O=o.runHooks("modifyRowHeader",O)),O===void 0?(C=[],rt(o.countRows()-1,function(_){C.push(o.getRowHeader(_))})):Array.isArray(C)&&C[O]!==void 0?C=C[O]:br(C)?C=C(O):C&&typeof C!="string"&&typeof C!="number"&&(C=O+1),C},this.hasRowHeaders=function(){return!!g.rowHeaders},this.hasColHeaders=function(){if(g.colHeaders!==void 0&&g.colHeaders!==null)return!!g.colHeaders;for(var w=0,C=o.countCols();w<C;w++)if(o.getColHeader(w))return!0;return!1},this.getColHeader=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,O=o.runHooks("modifyColHeader",w);if(O===void 0){for(var _=[],A=o.countCols(),I=0;I<A;I++)_.push(o.getColHeader(I));return _}var L=g.colHeaders,V=function(te){for(var ge=[],H=o.countCols(),Ce=0;Ce<H;Ce++)br(g.columns)&&g.columns(Ce)&&ge.push(Ce);return ge[te]},Y=o.toPhysicalColumn(O),ae=V(Y);return g.colHeaders===!1?L=null:g.columns&&br(g.columns)&&g.columns(ae)&&g.columns(ae).title?L=g.columns(ae).title:g.columns&&g.columns[Y]&&g.columns[Y].title?L=g.columns[Y].title:Array.isArray(g.colHeaders)&&g.colHeaders[Y]!==void 0?L=g.colHeaders[Y]:br(g.colHeaders)?L=g.colHeaders(Y):g.colHeaders&&typeof g.colHeaders!="string"&&typeof g.colHeaders!="number"&&(L=jO(O)),L=o.runHooks("modifyColumnHeaderValue",L,w,C),L},this._getColWidthFromSettings=function(w){var C;if(w>=0){var O=o.getCellMeta(0,w);C=O.width}if((C===void 0||C===g.width)&&(C=g.colWidths),C!=null){switch(Ei(C)){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getColWidth=function(w){var C=o._getColWidthFromSettings(w);return C=o.runHooks("modifyColWidth",C,w),C===void 0&&(C=h$.DEFAULT_WIDTH),C},this._getRowHeightFromSettings=function(w){var C=g.rowHeights;if(C!=null){switch(Ei(C)){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getRowHeight=function(w){var C=o._getRowHeightFromSettings(w);return C=o.runHooks("modifyRowHeight",C,w),C},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var w=g.maxCols,C=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(w,C)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return ux(o.countRows()-1,function(O){if(o.isEmptyRow(O))C+=1;else if(w===!0)return!1}),C},this.countEmptyCols=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return ux(o.countCols()-1,function(O){if(o.isEmptyCol(O))C+=1;else if(w===!0)return!1}),C},this.isEmptyRow=function(w){return g.isEmptyRow.call(o,w)},this.isEmptyCol=function(w){return g.isEmptyCol.call(o,w)},this.selectCell=function(w,C,O,_){var A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return pr(w)||pr(C)?!1:this.selectCells([[w,C,O,_]],A,I)},this.selectCells=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;C===!1&&(a=!0);var _=x.selectCells(w);return _&&O&&o.listen(),a=!1,_},this.selectColumns=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w;return x.selectColumns(w,C)},this.selectRows=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w;return x.selectRows(w,C)},this.deselectCell=function(){x.deselect()},this.selectAll=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,C=w&&this.hasRowHeaders(),O=w&&this.hasColHeaders();a=!0,x.selectAll(C,O),a=!1};var K=function(C,O){return C.getNearestNotHiddenIndex(O,1,!0)};this.scrollViewportTo=function(w,C){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=!O,L=!_,V=w,Y=C;if(A){var ae=Number.isInteger(w),re=Number.isInteger(C),te=ae?K(this.rowIndexMapper,w):void 0,ge=re?K(this.columnIndexMapper,C):void 0;if(te===null||ge===null)return!1;V=ae?o.rowIndexMapper.getRenderableFromVisualIndex(te):void 0,Y=re?o.columnIndexMapper.getRenderableFromVisualIndex(ge):void 0}var H=Number.isInteger(V),Ce=Number.isInteger(Y);return H&&Ce?o.view.scrollViewport(o._createCellCoords(V,Y),I,_,O,L):H&&Ce===!1?o.view.scrollViewportVertically(V,I,O):Ce&&H===!1?o.view.scrollViewportHorizontally(Y,_,L):!1},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),p.clearCache(),LM(o)){var w=this.rootDocument.querySelector(".hot-display-license-info");w&&w.parentNode.removeChild(w)}mo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(function(){o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),m.getItems().forEach(function(C){var O=Ro(C,2),_=O[1];_.destroy()}),m.clear(),o.runHooks("afterDestroy")},!0),Qe.getSingleton().destroy(o),It(o,function(C,O,_){br(C)?_[O]=Z(O):O!=="guid"&&(_[O]=null)}),o.isDestroyed=!0,l&&l.destroy(),o.rowIndexMapper=null,o.columnIndexMapper=null,l=null,f=null,x=null,c=null,o=null};function Z(w){return function(){throw new Error('The "'.concat(w,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(w){var C=Ni(w);return C==="UndoRedo"?this.undoRedo:m.getItem(C)},this.getPluginName=function(w){return w===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:m.getId(w)},this.getInstance=function(){return o},this.addHook=function(w,C){Qe.getSingleton().add(w,C,o)},this.hasHook=function(w){return Qe.getSingleton().has(w,o)||Qe.getSingleton().has(w)},this.addHookOnce=function(w,C){Qe.getSingleton().once(w,C,o)},this.removeHook=function(w,C){Qe.getSingleton().remove(w,C,o)},this.runHooks=function(w,C,O,_,A,I,L){return Qe.getSingleton().run(o,w,C,O,_,A,I,L)},this.getTranslatedPhrase=function(w,C){return Ire(g.language,w,C)},this.toHTML=function(){return sM(n)},this.toTableElement=function(){var w=n.rootDocument.createElement("div");return w.insertAdjacentHTML("afterbegin",sM(n)),w.firstElementChild},this.timeouts=[],this._registerTimeout=function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=w;typeof O=="function"&&(O=setTimeout(O,C)),this.timeouts.push(O)},this._clearTimeouts=function(){ne(this.timeouts,function(w){clearTimeout(w)})},this.immediates=[],this._registerImmediate=function(w){this.immediates.push(setImmediate(w))},this._clearImmediates=function(){ne(this.immediates,function(w){clearImmediate(w)})},this._refreshBorders=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(w),o.view.render(),C&&x.isSelected()&&c.prepareEditor()},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};var ie=t5e({handleEvent:function(C){var O=o.isListening(),_=(C==null?void 0:C.key)!==void 0;return O&&_},beforeKeyDown:function(C){return n.runHooks("beforeKeyDown",C)},afterKeyDown:function(C){n.isDestroyed||o.runHooks("afterDocumentKeyDown",C)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(w){w.ctrlKey===!1&&w.metaKey===!1&&ie.releasePressedKeys()}),this.getShortcutManager=function(){return ie};var me=ie.addContext("grid"),k={runOnlyIf:function(){return Xe(o.getSelected())&&o.countRenderedRows()>0&&o.countRenderedCols()>0},group:l5e};ie.setActiveContextName("grid"),me.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){o.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var C=o.getSelectedRange(),O=C[C.length-1].highlight,_=O.row,A=O.col,I=o.getDataAtCell(_,A),L=new Map,V=0;V<C.length;V++)C[V].forAll(function(Y,ae){if(Y>=0&&ae>=0&&(Y!==_||ae!==A)){var re=o.getCellMeta(Y,ae),te=re.readOnly;te||L.set("".concat(Y,"x").concat(ae),[Y,ae,I])}});o.setDataAtCell(Array.from(L.values()))},runOnlyIf:function(){return o.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){x.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){x.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(0,1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){x.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C=o.getSelectedRangeLast(),O=C.from,_=C.to,A=o.rowIndexMapper.getNearestNotHiddenIndex(0,1);x.setRangeStart(O.clone()),x.setRangeEnd(o._createCellCoords(A,_.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){x.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){x.setRangeStart(o._createCellCoords(o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1),o.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){x.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C=o.getSelectedRangeLast(),O=C.from,_=C.to,A=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1);x.setRangeStart(O.clone()),x.setRangeEnd(o._createCellCoords(A,_.col))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){x.transformStart(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast().highlight.row,_=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Dh(o.isRtl()?[o.countCols()-1,-1]:[0,1]));x.setRangeStart(o._createCellCoords(O,_))}},{keys:[["ArrowLeft","Shift"]],callback:function(){x.transformEnd(0,-1*o.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast(),_=O.from,A=O.to,I=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Dh(o.isRtl()?[o.countCols()-1,-1]:[0,1]));x.setRangeStart(_.clone()),x.setRangeEnd(o._createCellCoords(A.row,I))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){x.transformStart(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast().highlight.row,_=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Dh(o.isRtl()?[0,1]:[o.countCols()-1,-1]));x.setRangeStart(o._createCellCoords(O,_))}},{keys:[["ArrowRight","Shift"]],callback:function(){x.transformEnd(0,o.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var C,O=o.getSelectedRangeLast(),_=O.from,A=O.to,I=(C=o.columnIndexMapper).getNearestNotHiddenIndex.apply(C,Dh(o.isRtl()?[0,1]:[o.countCols()-1,-1]));x.setRangeStart(_.clone()),x.setRangeEnd(o._createCellCoords(A.row,I))},runOnlyIf:function(){return!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var C=parseInt(o.getSettings().fixedColumnsStart,10),O=o.getSelectedRangeLast().highlight.row,_=o.columnIndexMapper.getNearestNotHiddenIndex(C,1);x.setRangeStart(o._createCellCoords(O,_))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){x.setRangeEnd(o._createCellCoords(x.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var C=parseInt(o.getSettings().fixedRowsTop,10),O=parseInt(o.getSettings().fixedColumnsStart,10),_=o.rowIndexMapper.getNearestNotHiddenIndex(C,1),A=o.columnIndexMapper.getNearestNotHiddenIndex(O,1);x.setRangeStart(o._createCellCoords(_,A))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){x.setRangeStart(o._createCellCoords(o.getSelectedRangeLast().highlight.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){x.setRangeEnd(o._createCellCoords(x.selectedRange.current().from.row,o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var C=parseInt(o.getSettings().fixedRowsBottom,10),O=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-C-1,-1),_=o.columnIndexMapper.getNearestNotHiddenIndex(o.countCols()-1,-1);x.setRangeStart(o._createCellCoords(O,_))},runOnlyIf:function(){return o.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){x.transformStart(-o.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var C=o.getSelectedRangeLast(),O=C.to,_=Math.max(O.row-o.countVisibleRows(),0),A=o.rowIndexMapper.getNearestNotHiddenIndex(_,1);if(A!==null){var I=o._createCellCoords(A,O.col),L=O.row-o.view.getFirstFullyVisibleRow(),V=Math.max(I.row-L,0);x.setRangeEnd(I),o.scrollViewportTo(V)}}},{keys:[["PageDown"]],callback:function(){x.transformStart(o.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var C=o.getSelectedRangeLast(),O=C.to,_=Math.min(O.row+o.countVisibleRows(),o.countRows()-1),A=o.rowIndexMapper.getNearestNotHiddenIndex(_,-1);if(A!==null){var I=o._createCellCoords(A,O.col),L=O.row-o.view.getFirstFullyVisibleRow(),V=Math.min(I.row-L,o.countRows()-1);x.setRangeEnd(I),o.scrollViewportTo(V)}}},{keys:[["Tab"]],callback:function(C){var O=typeof g.tabMoves=="function"?g.tabMoves(C):g.tabMoves;x.transformStart(O.row,O.col,!0)}},{keys:[["Shift","Tab"]],callback:function(C){var O=typeof g.tabMoves=="function"?g.tabMoves(C):g.tabMoves;x.transformStart(-O.row,-O.col)}}],k),f$().forEach(function(w){var C=rS(w);m.addItem(w,new C(n))}),Qe.getSingleton().run(o,"construct")}var u5e="hooksRefRegisterer",Zre={_hooksStorage:Object.create(null),addHook:function(t,r){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,r),this._hooksStorage[t].push(r),this},removeHooksByKey:function(t){var r=this;ne(this._hooksStorage[t]||[],function(n){r.hot.removeHook(t,n)})},clearHooks:function(){var t=this;It(this._hooksStorage,function(r,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};as(Zre,"MIXIN_NAME",u5e,{writable:!1,enumerable:!1});const f5e=Zre;function Vv(e){return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function c5e(e,t){return p5e(e)||v5e(e,t)||d5e(e,t)||h5e()}function h5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d5e(e,t){if(e){if(typeof e=="string")return SU(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SU(e,t)}}function SU(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function p5e(e){if(Array.isArray(e))return e}function g5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f2(e,t)}function f2(e,t){return f2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},f2(e,t)}function y5e(e){var t=w5e();return function(){var n=Ux(e),i;if(t){var a=Ux(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return m5e(this,i)}}function m5e(e,t){if(t&&(Vv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b5e(e)}function b5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ux(e){return Ux=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ux(e)}function _U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S5e(n.key),n)}}function xU(e,t,r){return t&&CU(e.prototype,t),r&&CU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S5e(e){var t=_5e(e,"string");return Vv(t)==="symbol"?t:String(t)}function _5e(e,t){if(Vv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C5e="base",xn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),c2="baseEditor",Pg=function(){function e(t){_U(this,e),this.hot=t,this.instance=t,this.state=xn.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return xU(e,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,a,o,s){this.TD=a,this.row=r,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=xn.VIRGIN}},{key:"extend",value:function(){return function(r){g5e(i,r);var n=y5e(i);function i(){return _U(this,i),n.apply(this,arguments)}return xU(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,a,o,s,l;if(n){var u=this.hot.getSelectedLast();a=Math.max(Math.min(u[0],u[2]),0),o=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var f=[this.row,this.col,null,null];a=f[0],o=f[1],s=f[2],l=f[3]}var c=this.hot.runHooks("modifyGetCellCoords",a,o);if(Array.isArray(c)){var h=c5e(c,2);a=h[0],o=h[1]}var d=this.hot.getShortcutManager(),v=d.getContext("editor"),p={runOnlyIf:function(){return Xe(i.hot.getSelected())},group:c2};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],p),this.hot.populateFromArray(a,o,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===xn.VIRGIN){var i=this.hot,a=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(a,o)),this.state=xn.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:jr(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var a=this,o;if(i){var s=this._closeCallback;this._closeCallback=function(c){s&&s(c),i(c),a.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(c2),u.removeShortcutsByGroup(BO),this.state===xn.VIRGIN){this.hot._registerTimeout(function(){a._fireCallbacks(!0)});return}if(this.state===xn.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var f=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof f=="string"?String.prototype.trim.call(f||""):f]]:o=[[f]],this.state=xn.WAITING,this.saveValue(o,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){a.state=xn.FINISHED,a.discardEditor(c)}):(this.state=xn.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=xn.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===xn.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=xn.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=xn.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===xn.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(n){var i=this.hot.view._wt,a=i.wtOverlays,o=i.wtViewport,s=this.hot.rootWindow,l=nn(n),u=cr(n),f=nn(this.hot.rootElement),c=cr(this.hot.rootElement),h=a.topOverlay.holder,d=a.inlineStartOverlay.holder,v=h!==s?h.scrollTop:0,p=d!==s?d.scrollLeft:0,g=s.innerWidth-f.left-c,y=(r=a.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,m=y.wtTable,b=m.name,S=["master","inline_start"].includes(b)?v:0,x=["master","top","bottom"].includes(b)?p:0,T=l.top===f.top?0:1,E=l.top-f.top-T-S,P=0;this.hot.isRtl()?P=s.innerWidth-l.left-u-g-1+x:P=l.left-f.left-1-x,["top","top_inline_start_corner"].includes(b)&&(E+=a.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(P+=Math.abs(a.inlineStartOverlay.getOverlayOffset()));var R=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),D=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),N=this.hot.rowIndexMapper.getRenderableIndexesLength(),B=N-this.hot.view._wt.getSetting("fixedRowsBottom");(R&&M<=0||M===B)&&(E+=1),D<=0&&(P+=1);var K=o.rowsRenderCalculator.startPosition,Z=o.columnsRenderCalculator.startPosition,ie=Math.abs(a.inlineStartOverlay.getScrollPosition()),me=a.topOverlay.getScrollPosition(),k=Sn(this.hot.rootDocument),w=n.offsetTop+K-me,C=0;if(this.hot.isRtl()){var O=n.offsetLeft;O>=0?C=m.getWidth()-n.offsetLeft:C=Math.abs(O),C+=Z-ie-u}else C=n.offsetLeft+Z-ie;var _=Au(this.TD,this.hot.rootWindow),A=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",I=parseInt(_[A],10)>0?0:1,L=parseInt(_.borderTopWidth,10)>0?0:1,V=cr(n)+I,Y=Nr(n)+L,ae=Hee(h)?k:0,re=Bee(d)?k:0,te=this.hot.view.maximumVisibleElementWidth(C)-ae+I,ge=Math.max(this.hot.view.maximumVisibleElementHeight(w)-re+L,23);return{top:E,start:P,height:Y,maxHeight:ge,width:V,maxWidth:te}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return C5e}}]),e}();yr(Pg,f5e);function x5e(){var e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),a=function(d,v,p){d.addEventListener(v,p,!1)},o=function(d,v,p){d.removeEventListener(v,p,!1)},s=function(d){var v,p;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=t.value+d:n.data=t.value+d,i.style.position="absolute",i.style.fontSize=c(t).fontSize,i.style.fontFamily=c(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),v=i.clientWidth+2,r.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>v?t.style.width=e.minWidth+"px":v>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=v+"px",p=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>p?t.style.height=e.minHeight+"px":e.maxHeight<p?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=p+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")e.minHeight=t.clientHeight;else{var v=parseInt(d.minHeight);isNaN(v)||(e.minHeight=v)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")e.maxHeight=t.clientHeight;else{var p=parseInt(d.maxHeight);isNaN(p)||(e.maxHeight=p)}if(d&&d.minWidth)if(d.minWidth=="inherit")e.minWidth=t.clientWidth;else{var g=parseInt(d.minWidth);isNaN(g)||(e.minWidth=g)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")e.maxWidth=t.clientWidth;else{var y=parseInt(d.maxWidth);isNaN(y)||(e.maxWidth=y)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},f=function(d,v,p){t=d,u(v),t.nodeName=="TEXTAREA"&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),p&&(a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)),s()};function c(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,v,p){f(d,v,p)},unObserve:function(){o(t,"change",s),o(t,"cut",l),o(t,"paste",l),o(t,"drop",l),o(t,"keydown",l),o(t,"focus",s),o(t,"compositionstart",l),o(t,"compositionupdate",l),o(t,"compositionend",l)},resize:s}}function TU(e,t){for(var r=r$(t),n=t.value.split(`
`),i=r,a=0,o=0;o<n.length;o++){var s=n[o];o!==0&&(a+=n[o-1].length+1);var l=a+s.length;if(e==="home"?i=a:e==="end"&&(i=l),r<=l)break}Jw(t,i)}function jv(e){return jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jv(e)}function OU(e,t){return R5e(e)||E5e(e,t)||O5e(e,t)||T5e()}function T5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O5e(e,t){if(e){if(typeof e=="string")return EU(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EU(e,t)}}function EU(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function R5e(e){if(Array.isArray(e))return e}function k5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P5e(n.key),n)}}function A5e(e,t,r){return t&&RU(e.prototype,t),r&&RU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P5e(e){var t=I5e(e,"string");return jv(t)==="symbol"?t:String(t)}function I5e(e,t){if(jv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bm(){return typeof Reflect<"u"&&Reflect.get?bm=Reflect.get.bind():bm=function(t,r,n){var i=M5e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},bm.apply(this,arguments)}function M5e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$c(e),e!==null););return e}function D5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h2(e,t)}function h2(e,t){return h2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},h2(e,t)}function N5e(e){var t=F5e();return function(){var n=$c(e),i;if(t){var a=$c(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return L5e(this,i)}}function L5e(e,t){if(t&&(jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jre(e)}function Jre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $c(e){return $c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$c(e)}var $5e="ht_editor_visible",f_="ht_editor_hidden",kU="textEditor",H5e="text",fh=function(e){D5e(r,e);var t=N5e(r);function r(n){var i;return k5e(this,r),i=t.call(this,n),i.eventManager=new Fr(Jre(i)),i.autoResize=x5e(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return A5e(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var a=this.hot.getShortcutManager();a.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(o){return i.onAfterDocumentKeyDown(o)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this.state;if(bm($c(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),!u.readOnly){this.refreshDimensions(!0);var c=u.allowInvalid,h=u.fragmentSelection;c&&(this.TEXTAREA.value=""),f!==xn.FINISHED&&this.hideEditableElement();var d=!h;d&&!oo()&&this.focus()}}},{key:"beginEditing",value:function(i,a){this.state===xn.VIRGIN&&(this.TEXTAREA.value="",bm($c(r.prototype),"beginEditing",this).call(this,i,a))}},{key:"focus",value:function(){this.TEXTAREA.select(),Jw(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,ke(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),ke(this.TEXTAREA_PARENT,"handsontableInputHolder"),bt(this.TEXTAREA_PARENT,this.layerClass)&&St(this.TEXTAREA_PARENT,this.layerClass),ke(this.TEXTAREA_PARENT,f_),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(DQ()||MQ())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",St(this.TEXTAREA_PARENT,this.layerClass),ke(this.TEXTAREA_PARENT,f_)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,a=!1;rt(i.length-1,function(o){var s=i[o];if(bt(s,"handsontableEditor"))return a=!0,!1}),bt(this.TEXTAREA_PARENT,f_)&&St(this.TEXTAREA_PARENT,f_),a?(this.layerClass=$5e,ke(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ke(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),a=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=a,this.setValue(a),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==xn.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var a=this.getEditedCellRect(),o=a.top,s=a.start,l=a.width,u=a.maxWidth,f=a.height,c=a.maxHeight;this.textareaParentStyle.top="".concat(o,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var h=Au(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Au(this.TEXTAREA),v=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),p=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),g=l-v,y=f-p,m=u-v,b=c-p;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,m),minHeight:Math.min(y,b),maxWidth:m,maxHeight:b},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(a){return a.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(a){return a.stopPropagation()}),AF()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={runOnlyIf:function(){return Xe(i.hot.getSelected())},group:kU},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};o.addShortcuts([{keys:[["Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(f){var c=i.hot.getSettings(),h=typeof c.tabMoves=="function"?c.tabMoves(f):c.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(f){return!i.hot.selection.isMultiple()&&!f.altKey},relativeToGroup:pm,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:pm,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:pm,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(f,c){var h=OU(c,1),d=h[0];TU(d,i.TEXTAREA)}},{keys:[["End"]],callback:function(f,c){var h=OU(c,1),d=h[0];TU(d,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(BO),a.removeShortcutsByGroup(kU),a.removeShortcutsByGroup(c2)}},{key:"onAfterDocumentKeyDown",value:function(i){var a=[et.ARROW_UP,et.ARROW_RIGHT,et.ARROW_DOWN,et.ARROW_LEFT];a.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return H5e}}]),r}(Pg),B5e="base";function fS(e,t,r,n,i,a,o){var s=[],l=[];o.className&&ke(t,o.className),o.readOnly&&s.push(o.readOnlyCellClassName),o.valid===!1&&o.invalidCellClassName?s.push(o.invalidCellClassName):l.push(o.invalidCellClassName),o.wordWrap===!1&&o.noWordWrapClassName&&s.push(o.noWordWrapClassName),!a&&o.placeholder&&s.push(o.placeholderCellClassName),St(t,l),ke(t,s)}fS.RENDERER_TYPE=B5e;var V5e="text";function zu(e,t,r,n,i,a,o){fS.apply(this,[e,t,r,n,i,a,o]);var s=a;if(!s&&o.placeholder&&(s=o.placeholder),s=jr(s),o.trimWhitespace&&(s=s.trim()),o.rendererTemplate){mo(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else ku(t,s)}zu.RENDERER_TYPE=V5e;var j5e="text",Qre={CELL_TYPE:j5e,editor:fh,renderer:zu};Za(Qre);ht.editors={BaseEditor:Pg};function ht(e,t){var r=new rB(e,t||{},x$);return r.init(),r}ht.Core=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new rB(e,t,x$)};ht.DefaultSettings=Ure();ht.hooks=Qe.getSingleton();ht.CellCoords=cx;ht.CellRange=d$;ht.packageName="handsontable";ht.buildDate="28/03/2023 12:24:11";ht.version="12.3.3";ht.languages={dictionaryKeys:u4e,getLanguageDictionary:Pre,getLanguagesDictionaries:y4e,registerLanguageDictionary:Are,getTranslatedPhrase:Ire};var Fd=Symbol("unassigned"),W5e="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function zx(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ene(e){var t=ht.hooks.getRegistered(),r={};Object.assign(r,ht.DefaultSettings);for(var n in r)r[n]={default:Fd};for(var i=0;i<t.length;i++)r[t[i]]={default:Fd};return r.settings={default:Fd},e==="HotTable"&&(r.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),r}function tne(e){var t={},r=e.settings;if(r!==Fd)for(var n in r)zx(r,n)&&r[n]!==Fd&&(t[n]=r[n]);for(var i in e)zx(e,i)&&i!=="settings"&&e[i]!==Fd&&(t[i]=e[i]);return t}function AU(e,t){var r=tne(e),n=e.settings?e.settings:r,i=e.settings?r:null,a={};for(var o in n)zx(n,o)&&n[o]!==void 0&&(!(t&&o!=="data")||!PU(t[o],n[o]))&&(a[o]=n[o]);for(var s in i)zx(i,s)&&s!=="id"&&s!=="settings"&&i[s]!==void 0&&(!(t&&s!=="data")||!PU(t[s],i[s]))&&(a[s]=i[s]);return a}function PU(e,t){return JSON.stringify(e)===JSON.stringify(t)}var U5e="12.3.3",nB=_i({name:"HotTable",props:ene("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(t){var r=AU(t,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||r===void 0||(r.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete r.data),Object.keys(r).length?this.hotInstance.updateSettings(r):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(W5e),null)},set hotInstance(t){this.__hotInstance=t}}},methods:{hotInit:function(){var t=AU(this.$props);t.columns=this.columnSettings?this.columnSettings:t.columns,this.hotInstance=Rce(new ht.Core(this.$el,t)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var r=this.hotInstance.getSourceData(),n=[],i=[],a=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),o=this.hotInstance.isColumnModificationAllowed(),s=0;if(r&&r.length!==a&&r.length<a)for(var l=r.length;l<a;l++)n.push(l);if(o){var u;if(s=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),r&&r[0]&&((u=r[0])===null||u===void 0?void 0:u.length)!==s&&r[0].length<s)for(var f=r[0].length;f<s;f++)i.push(f)}this.hotInstance.batch(function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(a-1,r.length-a),o&&r.length!==0&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(s-1,r[0].length-s))})}},getColumnSettings:function(){var t=Array.from(this.columnsCache.values());return t.length?t:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:U5e}),z5e=["id"];function G5e(e,t,r,n,i,a){return tr(),Cr("div",{id:e.id},[aZ(e.$slots,"default")],8,z5e)}nB.render=G5e;nB.__file="src/HotTable.vue";function IU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Y5e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IU(Object(r),!0).forEach(function(n){K5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K5e(e,t,r){return t=q5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X5e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q5e(e){var t=X5e(e,"string");return typeof t=="symbol"?t:String(t)}var Z5e=_i({name:"HotColumn",props:ene("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var t=tne(this.$props),r=Y5e({},t);t.renderer&&(r.renderer=t.renderer),t.editor&&(r.editor=t.editor),this.columnsCache.set(this,r)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});Z5e.__file="src/HotColumn.vue";function Wv(e){return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function J5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e8e(n.key),n)}}function Q5e(e,t,r){return t&&MU(e.prototype,t),r&&MU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e8e(e){var t=t8e(e,"string");return Wv(t)==="symbol"?t:String(t)}function t8e(e,t){if(Wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eo(){return typeof Reflect<"u"&&Reflect.get?eo=Reflect.get.bind():eo=function(t,r,n){var i=r8e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},eo.apply(this,arguments)}function r8e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yi(e),e!==null););return e}function n8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d2(e,t)}function d2(e,t){return d2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},d2(e,t)}function i8e(e){var t=s8e();return function(){var n=Yi(e),i;if(t){var a=Yi(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return a8e(this,i)}}function a8e(e,t){if(t&&(Wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o8e(e)}function o8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yi(e){return Yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yi(e)}var DU="handsontableEditor",l8e="handsontable",iB=function(e){n8e(r,e);var t=i8e(r);function r(){return J5e(this,r),t.apply(this,arguments)}return Q5e(r,[{key:"open",value:function(){eo(Yi(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Jw(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),eo(Yi(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,a,o,s,l,u){eo(Yi(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var f=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,v){var p=this.getSourceData(v.row,v.col);p!==void 0&&f.setValue(p),f.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&an(c,u.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(i,a){var o=this.hot.getSettings().onBeginEditing;o&&o()===!1||eo(Yi(r.prototype),"beginEditing",this).call(this,i,a)}},{key:"createElements",value:function(){eo(Yi(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,a,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}eo(Yi(r.prototype),"finishEditing",this).call(this,i,a,o)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor");eo(Yi(r.prototype),"registerShortcuts",this).call(this);var s={group:DU,relativeToGroup:BO,position:"before"},l=function(f,c){var h=i.htEditor.getInstance();if(f!==void 0&&(f<0||h.flipped&&f>h.countRows()-1?h.deselectCell():h.selectCell(f,0),h.getData().length))return c.preventDefault(),bo(c),i.hot.listen(),i.TEXTAREA.focus(),!1};o.addShortcuts([{keys:[["ArrowUp"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;return!c.getSelectedLast()&&c.flipped?h=c.countRows()-1:c.getSelectedLast()&&(c.flipped?(d=c.getSelectedLast()[0],h=Math.max(0,d-1)):(d=c.getSelectedLast()[0],h=d-1)),l(h,f)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(f){var c=i.htEditor.getInstance(),h,d;if(!c.getSelectedLast()&&!c.flipped)h=0;else if(c.getSelectedLast()){if(c.flipped)h=c.getSelectedLast()[0]+1;else if(!c.flipped){var v=c.countRows()-1;d=c.getSelectedLast()[0],h=Math.min(v,d+1)}}return l(h,f)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){eo(Yi(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(DU)}}],[{key:"EDITOR_TYPE",get:function(){return l8e}}]),r}(fh);function Uv(e){return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uv(e)}function u8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rne(n.key),n)}}function f8e(e,t,r){return t&&NU(e.prototype,t),r&&NU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uf(){return typeof Reflect<"u"&&Reflect.get?Uf=Reflect.get.bind():Uf=function(t,r,n){var i=c8e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Uf.apply(this,arguments)}function c8e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Is(e),e!==null););return e}function h8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v2(e,t)}function v2(e,t){return v2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},v2(e,t)}function d8e(e){var t=p8e();return function(){var n=Is(e),i;if(t){var a=Is(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return v8e(this,i)}}function v8e(e,t){if(t&&(Uv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p2(e)}function p2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Is(e){return Is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Is(e)}function g8e(e,t,r){return t=rne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rne(e){var t=y8e(e,"string");return Uv(t)==="symbol"?t:String(t)}function y8e(e,t){if(Uv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _k=new WeakMap,m8e="autocomplete",aB=function(e){h8e(r,e);var t=d8e(r);function r(n){var i;return u8e(this,r),i=t.call(this,n),g8e(p2(i),"sortByRelevance",function(a,o,s){var l=[],u=[],f=a.length,c=o.length,h,d,v,p;if(f===0){for(v=0;v<c;v++)u.push(v);return u}for(v=0;v<c;v++){if(d=XI(jr(o[v])),s)p=d.indexOf(a);else{var g=this.cellProperties.locale;p=d.toLocaleLowerCase(g).indexOf(a.toLocaleLowerCase(g))}p!==-1&&(h=d.length-p-f,l.push({baseIndex:v,index:p,charsLeft:h,value:d}))}for(l.sort(function(y,m){if(m.index===-1)return-1;if(y.index===-1)return 1;if(y.index<m.index)return-1;if(m.index<y.index)return 1;if(y.index===m.index){if(y.charsLeft<m.charsLeft)return-1;if(y.charsLeft>m.charsLeft)return 1}return 0}),v=0,c=l.length;v<c;v++)u.push(l[v].baseIndex);return u}),i.query=null,i.strippedChoices=[],i.rawChoices=[],_k.set(p2(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return f8e(r,[{key:"getValue",value:function(){var i=this,a=this.rawChoices.find(function(o){var s=i.stripValueIfNeeded(o);return s===i.TEXTAREA.value});return Xe(a)?a:this.TEXTAREA.value}},{key:"createElements",value:function(){Uf(Is(r.prototype),"createElements",this).call(this),ke(this.htContainer,"autocompleteEditor"),ke(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,a=_k.get(this);Uf(Is(r.prototype),"open",this).call(this);var o=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=Sn();l===0&&a.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return i.onBeforeKeyDown(u)}),o.updateSettings({colWidths:s?[cr(this.TEXTAREA)-2]:void 0,width:s?cr(this.TEXTAREA)+l:void 0,renderer:function(f,c,h,d,v,p,g){zu(f,c,h,d,v,p,g);var y=i.cellProperties,m=y.filteringCaseSensitive,b=y.allowHtml,S=y.locale,x=i.query,T=jr(p),E,P;T&&!b&&(E=m===!0?T.indexOf(x):T.toLocaleLowerCase(S).indexOf(x.toLocaleLowerCase(S)),E!==-1&&(P=T.substr(E,x.length),T=T.replace(P,"<strong>".concat(P,"</strong>")))),c.innerHTML=T},autoColumnSize:!0}),a.skipOne&&(a.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Uf(Is(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Uf(Is(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var a=this,o=this.cellProperties.source;this.query=i,typeof o=="function"?o.call(this.cellProperties,i,function(s){a.rawChoices=s,a.updateChoicesList(a.stripValuesIfNeeded(s))}):Array.isArray(o)?(this.rawChoices=o,this.updateChoicesList(this.stripValuesIfNeeded(o))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var a=r$(this.TEXTAREA),o=Fee(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,f=null,c=i;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(f=u[0]);else{for(var d=[],v=0,p=c.length;v<p&&!(s&&h<=v);v++)h?d.push(c[u[v]]):d.push(c[v]);f=0,c=d}this.strippedChoices=c,this.htEditor.loadData(um([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f),this.hot.listen(),Jw(this.TEXTAREA,a,a===o?void 0:o)}},{key:"flipDropdownIfNeeded",value:function(){var i=lv(this.hot.view._wt.wtTable.TABLE),a=i===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(a||!a&&(o||o==="horizontal"))return!1;var s=nn(this.TEXTAREA),l=Nr(this.TEXTAREA),u=this.getDropdownHeight(),f=i.scrollTop,c=Nr(this.hot.view._wt.wtTable.THEAD),h=nn(i),d=s.top-h.top-c+f,v=i.scrollHeight-d-c-l,p=u>v&&d>v;return p?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(p?d:v,u),p}},{key:"limitDropdownIfNeeded",value:function(i,a){if(a>i){var o=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=l,s+=1;while(o<i);u=o-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+a-u,"px")),this.setDropdownHeight(o-l)}}},{key:"flipDropdown",value:function(i){var a=this.htEditor.rootElement.style;a.position="absolute",a.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+Sn(this.hot.rootDocument)+2,a=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:a?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,a=this.cellProperties.visibleRows;return this.strippedChoices.length>=a?a*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var a=this.cellProperties.allowHtml,o=At(i,function(l){return jr(l)}),s=At(o,function(l){return a?l:XI(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var a=this.htEditor.getSelectedRangeLast(),o={row:a?a.from.row:-1},s=!1;return i===et.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(s=!0),i===et.ARROW_UP&&o.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var a=this,o=_k.get(this);if(o.skipOne=!1,ete(i.keyCode)||i.keyCode===et.BACKSPACE||i.keyCode===et.DELETE||i.keyCode===et.INSERT){var s=10;if(i.keyCode===et.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){a.queryChoices(a.TEXTAREA.value),o.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return m8e}}]),r}(iB);function zv(e){return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zv(e)}function b8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S8e(n.key),n)}}function w8e(e,t,r){return t&&LU(e.prototype,t),r&&LU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S8e(e){var t=_8e(e,"string");return zv(t)==="symbol"?t:String(t)}function _8e(e,t){if(zv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g2(e,t)}function g2(e,t){return g2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},g2(e,t)}function x8e(e){var t=E8e();return function(){var n=Gx(e),i;if(t){var a=Gx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return T8e(this,i)}}function T8e(e,t){if(t&&(zv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O8e(e)}function O8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gx(e){return Gx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gx(e)}var R8e="checkbox",nne=function(e){C8e(r,e);var t=x8e(r);function r(){return b8e(this,r),t.apply(this,arguments)}return w8e(r,[{key:"beginEditing",value:function(i,a){if(a&&a.type==="mouseup"){var o=this.TD.querySelector('input[type="checkbox"]');bt(o,"htBadValue")||o.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return R8e}}]),r}(Pg),y2={},k8e={get exports(){return y2},set exports(e){y2=e}};const A8e=kce(dAe);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(e,t){(function(r,n){var i;{try{i=A8e}catch{}e.exports=n(i)}})(tI,function(r){var n=typeof r=="function",i=!!window.addEventListener,a=window.document,o=window.setTimeout,s=function(k,w,C,O){i?k.addEventListener(w,C,!!O):k.attachEvent("on"+w,C)},l=function(k,w,C,O){i?k.removeEventListener(w,C,!!O):k.detachEvent("on"+w,C)},u=function(k){return k.trim?k.trim():k.replace(/^\s+|\s+$/g,"")},f=function(k,w){return(" "+k.className+" ").indexOf(" "+w+" ")!==-1},c=function(k,w){f(k,w)||(k.className=k.className===""?w:k.className+" "+w)},h=function(k,w){k.className=u((" "+k.className+" ").replace(" "+w+" "," "))},d=function(k){return/Array/.test(Object.prototype.toString.call(k))},v=function(k){return/Date/.test(Object.prototype.toString.call(k))&&!isNaN(k.getTime())},p=function(k){var w=k.getDay();return w===0||w===6},g=function(k){return k%4===0&&k%100!==0||k%400===0},y=function(k,w){return[31,g(k)?29:28,31,30,31,30,31,31,30,31,30,31][w]},m=function(k){v(k)&&k.setHours(0,0,0,0)},b=function(k,w){return k.getTime()===w.getTime()},S=function(k,w,C){var O,_;for(O in w)_=k[O]!==void 0,_&&typeof w[O]=="object"&&w[O]!==null&&w[O].nodeName===void 0?v(w[O])?C&&(k[O]=new Date(w[O].getTime())):d(w[O])?C&&(k[O]=w[O].slice(0)):k[O]=S({},w[O],C):(C||!_)&&(k[O]=w[O]);return k},x=function(k,w,C){var O;a.createEvent?(O=a.createEvent("HTMLEvents"),O.initEvent(w,!0,!1),O=S(O,C),k.dispatchEvent(O)):a.createEventObject&&(O=a.createEventObject(),O=S(O,C),k.fireEvent("on"+w,O))},T=function(k){return k.month<0&&(k.year-=Math.ceil(Math.abs(k.month)/12),k.month+=12),k.month>11&&(k.year+=Math.floor(Math.abs(k.month)/12),k.month-=12),k},E={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},P=function(k,w,C){for(w+=k.firstDay;w>=7;)w-=7;return C?k.i18n.weekdaysShort[w]:k.i18n.weekdays[w]},R=function(k){var w=[],C="false";if(k.isEmpty)if(k.showDaysInNextAndPreviousMonths)w.push("is-outside-current-month"),k.enableSelectionDaysInNextAndPreviousMonths||w.push("is-selection-disabled");else return'<td class="is-empty"></td>';return k.isDisabled&&w.push("is-disabled"),k.isToday&&w.push("is-today"),k.isSelected&&(w.push("is-selected"),C="true"),k.hasEvent&&w.push("has-event"),k.isInRange&&w.push("is-inrange"),k.isStartRange&&w.push("is-startrange"),k.isEndRange&&w.push("is-endrange"),'<td data-day="'+k.day+'" class="'+w.join(" ")+'" aria-selected="'+C+'"><button class="pika-button pika-day" type="button" data-pika-year="'+k.year+'" data-pika-month="'+k.month+'" data-pika-day="'+k.day+'">'+k.day+"</button></td>"},M=function(k,w){k.setHours(0,0,0,0);var C=k.getDate(),O=k.getDay(),_=w,A=_-1,I=7,L=function(te){return(te+I-1)%I};k.setDate(C+A-L(O));var V=new Date(k.getFullYear(),0,_),Y=24*60*60*1e3,ae=(k.getTime()-V.getTime())/Y,re=1+Math.round((ae-A+L(V.getDay()))/I);return re},D=function(k,w,C,O){var _=new Date(C,w,k),A=n?r(_).isoWeek():M(_,O);return'<td class="pika-week">'+A+"</td>"},N=function(k,w,C,O){return'<tr class="pika-row'+(C?" pick-whole-week":"")+(O?" is-selected":"")+'">'+(w?k.reverse():k).join("")+"</tr>"},B=function(k){return"<tbody>"+k.join("")+"</tbody>"},K=function(k){var w,C=[];for(k.showWeekNumber&&C.push("<th></th>"),w=0;w<7;w++)C.push('<th scope="col"><abbr title="'+P(k,w)+'">'+P(k,w,!0)+"</abbr></th>");return"<thead><tr>"+(k.isRTL?C.reverse():C).join("")+"</tr></thead>"},Z=function(k,w,C,O,_,A){var I,L,V,Y=k._o,ae=C===Y.minYear,re=C===Y.maxYear,te='<div id="'+A+'" class="pika-title" role="heading" aria-live="assertive">',ge,H,Ce=!0,oe=!0;for(V=[],I=0;I<12;I++)V.push('<option value="'+(C===_?I-w:12+I-w)+'"'+(I===O?' selected="selected"':"")+(ae&&I<Y.minMonth||re&&I>Y.maxMonth?' disabled="disabled"':"")+">"+Y.i18n.months[I]+"</option>");for(ge='<div class="pika-label">'+Y.i18n.months[O]+'<select class="pika-select pika-select-month" tabindex="-1">'+V.join("")+"</select></div>",d(Y.yearRange)?(I=Y.yearRange[0],L=Y.yearRange[1]+1):(I=C-Y.yearRange,L=1+C+Y.yearRange),V=[];I<L&&I<=Y.maxYear;I++)I>=Y.minYear&&V.push('<option value="'+I+'"'+(I===C?' selected="selected"':"")+">"+I+"</option>");return H='<div class="pika-label">'+C+Y.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+V.join("")+"</select></div>",Y.showMonthAfterYear?te+=H+ge:te+=ge+H,ae&&(O===0||Y.minMonth>=O)&&(Ce=!1),re&&(O===11||Y.maxMonth<=O)&&(oe=!1),w===0&&(te+='<button class="pika-prev'+(Ce?"":" is-disabled")+'" type="button">'+Y.i18n.previousMonth+"</button>"),w===k._o.numberOfMonths-1&&(te+='<button class="pika-next'+(oe?"":" is-disabled")+'" type="button">'+Y.i18n.nextMonth+"</button>"),te+="</div>"},ie=function(k,w,C){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+C+'">'+K(k)+B(w)+"</table>"},me=function(k){var w=this,C=w.config(k);w._onMouseDown=function(_){if(w._v){_=_||window.event;var A=_.target||_.srcElement;if(A)if(f(A,"is-disabled")||(f(A,"pika-button")&&!f(A,"is-empty")&&!f(A.parentNode,"is-disabled")?(w.setDate(new Date(A.getAttribute("data-pika-year"),A.getAttribute("data-pika-month"),A.getAttribute("data-pika-day"))),C.bound&&o(function(){w.hide(),C.blurFieldOnSelect&&C.field&&C.field.blur()},100)):f(A,"pika-prev")?w.prevMonth():f(A,"pika-next")&&w.nextMonth()),f(A,"pika-select"))w._c=!0;else if(_.preventDefault)_.preventDefault();else return _.returnValue=!1,!1}},w._onChange=function(_){_=_||window.event;var A=_.target||_.srcElement;A&&(f(A,"pika-select-month")?w.gotoMonth(A.value):f(A,"pika-select-year")&&w.gotoYear(A.value))},w._onKeyChange=function(_){if(_=_||window.event,w.isVisible())switch(_.keyCode){case 13:case 27:C.field&&C.field.blur();break;case 37:w.adjustDate("subtract",1);break;case 38:w.adjustDate("subtract",7);break;case 39:w.adjustDate("add",1);break;case 40:w.adjustDate("add",7);break;case 8:case 46:w.setDate(null);break}},w._parseFieldValue=function(){if(C.parse)return C.parse(C.field.value,C.format);if(n){var _=r(C.field.value,C.format,C.formatStrict);return _&&_.isValid()?_.toDate():null}else return new Date(Date.parse(C.field.value))},w._onInputChange=function(_){var A;_.firedBy!==w&&(A=w._parseFieldValue(),v(A)&&w.setDate(A),w._v||w.show())},w._onInputFocus=function(){w.show()},w._onInputClick=function(){w.show()},w._onInputBlur=function(){var _=a.activeElement;do if(f(_,"pika-single"))return;while(_=_.parentNode);w._c||(w._b=o(function(){w.hide()},50)),w._c=!1},w._onClick=function(_){_=_||window.event;var A=_.target||_.srcElement,I=A;if(A){!i&&f(A,"pika-select")&&(A.onchange||(A.setAttribute("onchange","return;"),s(A,"change",w._onChange)));do if(f(I,"pika-single")||I===C.trigger)return;while(I=I.parentNode);w._v&&A!==C.trigger&&I!==C.trigger&&w.hide()}},w.el=a.createElement("div"),w.el.className="pika-single"+(C.isRTL?" is-rtl":"")+(C.theme?" "+C.theme:""),s(w.el,"mousedown",w._onMouseDown,!0),s(w.el,"touchend",w._onMouseDown,!0),s(w.el,"change",w._onChange),C.keyboardInput&&s(a,"keydown",w._onKeyChange),C.field&&(C.container?C.container.appendChild(w.el):C.bound?a.body.appendChild(w.el):C.field.parentNode.insertBefore(w.el,C.field.nextSibling),s(C.field,"change",w._onInputChange),C.defaultDate||(C.defaultDate=w._parseFieldValue(),C.setDefaultDate=!0));var O=C.defaultDate;v(O)?C.setDefaultDate?w.setDate(O,!0):w.gotoDate(O):w.gotoDate(new Date),C.bound?(this.hide(),w.el.className+=" is-bound",s(C.trigger,"click",w._onInputClick),s(C.trigger,"focus",w._onInputFocus),s(C.trigger,"blur",w._onInputBlur)):this.show()};return me.prototype={config:function(k){this._o||(this._o=S({},E,!0));var w=S(this._o,k,!0);w.isRTL=!!w.isRTL,w.field=w.field&&w.field.nodeName?w.field:null,w.theme=typeof w.theme=="string"&&w.theme?w.theme:null,w.bound=!!(w.bound!==void 0?w.field&&w.bound:w.field),w.trigger=w.trigger&&w.trigger.nodeName?w.trigger:w.field,w.disableWeekends=!!w.disableWeekends,w.disableDayFn=typeof w.disableDayFn=="function"?w.disableDayFn:null;var C=parseInt(w.numberOfMonths,10)||1;if(w.numberOfMonths=C>4?4:C,v(w.minDate)||(w.minDate=!1),v(w.maxDate)||(w.maxDate=!1),w.minDate&&w.maxDate&&w.maxDate<w.minDate&&(w.maxDate=w.minDate=!1),w.minDate&&this.setMinDate(w.minDate),w.maxDate&&this.setMaxDate(w.maxDate),d(w.yearRange)){var O=new Date().getFullYear()-10;w.yearRange[0]=parseInt(w.yearRange[0],10)||O,w.yearRange[1]=parseInt(w.yearRange[1],10)||O}else w.yearRange=Math.abs(parseInt(w.yearRange,10))||E.yearRange,w.yearRange>100&&(w.yearRange=100);return w},toString:function(k){return k=k||this._o.format,v(this._d)?this._o.toString?this._o.toString(this._d,k):n?r(this._d).format(k):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(k,w){n&&r.isMoment(k)&&this.setDate(k.toDate(),w)},getDate:function(){return v(this._d)?new Date(this._d.getTime()):null},setDate:function(k,w){if(!k)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof k=="string"&&(k=new Date(Date.parse(k))),!!v(k)){var C=this._o.minDate,O=this._o.maxDate;v(C)&&k<C?k=C:v(O)&&k>O&&(k=O),this._d=new Date(k.getTime()),m(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!w&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(k){var w=!0;if(v(k)){if(this.calendars){var C=new Date(this.calendars[0].year,this.calendars[0].month,1),O=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),_=k.getTime();O.setMonth(O.getMonth()+1),O.setDate(O.getDate()-1),w=_<C.getTime()||O.getTime()<_}w&&(this.calendars=[{month:k.getMonth(),year:k.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(k,w){var C=this.getDate()||new Date,O=parseInt(w)*24*60*60*1e3,_;k==="add"?_=new Date(C.valueOf()+O):k==="subtract"&&(_=new Date(C.valueOf()-O)),this.setDate(_)},adjustCalendars:function(){this.calendars[0]=T(this.calendars[0]);for(var k=1;k<this._o.numberOfMonths;k++)this.calendars[k]=T({month:this.calendars[0].month+k,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(k){isNaN(k)||(this.calendars[0].month=parseInt(k,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(k){isNaN(k)||(this.calendars[0].year=parseInt(k,10),this.adjustCalendars())},setMinDate:function(k){k instanceof Date?(m(k),this._o.minDate=k,this._o.minYear=k.getFullYear(),this._o.minMonth=k.getMonth()):(this._o.minDate=E.minDate,this._o.minYear=E.minYear,this._o.minMonth=E.minMonth,this._o.startRange=E.startRange),this.draw()},setMaxDate:function(k){k instanceof Date?(m(k),this._o.maxDate=k,this._o.maxYear=k.getFullYear(),this._o.maxMonth=k.getMonth()):(this._o.maxDate=E.maxDate,this._o.maxYear=E.maxYear,this._o.maxMonth=E.maxMonth,this._o.endRange=E.endRange),this.draw()},setStartRange:function(k){this._o.startRange=k},setEndRange:function(k){this._o.endRange=k},draw:function(k){if(!(!this._v&&!k)){var w=this._o,C=w.minYear,O=w.maxYear,_=w.minMonth,A=w.maxMonth,I="",L;this._y<=C&&(this._y=C,!isNaN(_)&&this._m<_&&(this._m=_)),this._y>=O&&(this._y=O,!isNaN(A)&&this._m>A&&(this._m=A));for(var V=0;V<w.numberOfMonths;V++)L="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),I+='<div class="pika-lendar">'+Z(this,V,this.calendars[V].year,this.calendars[V].month,this.calendars[0].year,L)+this.render(this.calendars[V].year,this.calendars[V].month,L)+"</div>";this.el.innerHTML=I,w.bound&&w.field.type!=="hidden"&&o(function(){w.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),w.bound&&w.field.setAttribute("aria-label",w.ariaLabel)}},adjustPosition:function(){var k,w,C,O,_,A,I,L,V,Y,ae,re;if(!this._o.container){if(this.el.style.position="absolute",k=this._o.trigger,w=k,C=this.el.offsetWidth,O=this.el.offsetHeight,_=window.innerWidth||a.documentElement.clientWidth,A=window.innerHeight||a.documentElement.clientHeight,I=window.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop,ae=!0,re=!0,typeof k.getBoundingClientRect=="function")Y=k.getBoundingClientRect(),L=Y.left+window.pageXOffset,V=Y.bottom+window.pageYOffset;else for(L=w.offsetLeft,V=w.offsetTop+w.offsetHeight;w=w.offsetParent;)L+=w.offsetLeft,V+=w.offsetTop;(this._o.reposition&&L+C>_||this._o.position.indexOf("right")>-1&&L-C+k.offsetWidth>0)&&(L=L-C+k.offsetWidth,ae=!1),(this._o.reposition&&V+O>A+I||this._o.position.indexOf("top")>-1&&V-O-k.offsetHeight>0)&&(V=V-O-k.offsetHeight,re=!1),this.el.style.left=L+"px",this.el.style.top=V+"px",c(this.el,ae?"left-aligned":"right-aligned"),c(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,ae?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function(k,w,C){var O=this._o,_=new Date,A=y(k,w),I=new Date(k,w,1).getDay(),L=[],V=[];m(_),O.firstDay>0&&(I-=O.firstDay,I<0&&(I+=7));for(var Y=w===0?11:w-1,ae=w===11?0:w+1,re=w===0?k-1:k,te=w===11?k+1:k,ge=y(re,Y),H=A+I,Ce=H;Ce>7;)Ce-=7;H+=7-Ce;for(var oe=!1,Oe=0,Ee=0;Oe<H;Oe++){var be=new Date(k,w,1+(Oe-I)),Ie=v(this._d)?b(be,this._d):!1,Me=b(be,_),j=O.events.indexOf(be.toDateString())!==-1,U=Oe<I||Oe>=A+I,Q=1+(Oe-I),fe=w,ee=k,pe=O.startRange&&b(O.startRange,be),se=O.endRange&&b(O.endRange,be),ue=O.startRange&&O.endRange&&O.startRange<be&&be<O.endRange,ce=O.minDate&&be<O.minDate||O.maxDate&&be>O.maxDate||O.disableWeekends&&p(be)||O.disableDayFn&&O.disableDayFn(be);U&&(Oe<I?(Q=ge+Q,fe=Y,ee=re):(Q=Q-A,fe=ae,ee=te));var ve={day:Q,month:fe,year:ee,hasEvent:j,isSelected:Ie,isToday:Me,isDisabled:ce,isEmpty:U,isStartRange:pe,isEndRange:se,isInRange:ue,showDaysInNextAndPreviousMonths:O.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:O.enableSelectionDaysInNextAndPreviousMonths};O.pickWholeWeek&&Ie&&(oe=!0),V.push(R(ve)),++Ee===7&&(O.showWeekNumber&&V.unshift(D(Oe-I,w,k,O.firstWeekOfYearMinDays)),L.push(N(V,O.isRTL,O.pickWholeWeek,oe)),V=[],Ee=0,oe=!1)}return ie(O,L,C)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(a,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var k=this._v;k!==!1&&(this._o.bound&&l(a,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,k!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var k=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),k.keyboardInput&&l(a,"keydown",this._onKeyChange),k.field&&(l(k.field,"change",this._onInputChange),k.bound&&(l(k.trigger,"click",this._onInputClick),l(k.trigger,"focus",this._onInputFocus),l(k.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},me})})(k8e);const FU=y2;function Gv(e){return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gv(e)}function P8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M8e(n.key),n)}}function I8e(e,t,r){return t&&$U(e.prototype,t),r&&$U(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M8e(e){var t=D8e(e,"string");return Gv(t)==="symbol"?t:String(t)}function D8e(e,t){if(Gv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rs(){return typeof Reflect<"u"&&Reflect.get?Rs=Reflect.get.bind():Rs=function(t,r,n){var i=N8e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Rs.apply(this,arguments)}function N8e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=io(e),e!==null););return e}function L8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m2(e,t)}function m2(e,t){return m2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},m2(e,t)}function F8e(e){var t=B8e();return function(){var n=io(e),i;if(t){var a=io(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return $8e(this,i)}}function $8e(e,t){if(t&&(Gv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H8e(e)}function H8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function io(e){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},io(e)}var ine="date",HU="dateEditor",ane=function(e){L8e(r,e);var t=F8e(r);function r(n){var i;return P8e(this,r),i=t.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return I8e(r,[{key:"init",value:function(){var i=this;if(typeof Ae!="function")throw new Error("You need to include moment.js to your project.");if(typeof FU!="function")throw new Error("You need to include Pikaday to your project.");Rs(io(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){Rs(io(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ke(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new Fr(this);i.addEventListener(this.datePicker,"mousedown",function(a){return a.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,a,o,s,l,u){Rs(io(r.prototype),"prepare",this).call(this,i,a,o,s,l,u)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=this.hot.getShortcutManager(),o=a.getContext("editor");Rs(io(r.prototype),"open",this).call(this),this.showDatepicker(i),o.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:HU})}},{key:"close",value:function(){var i,a=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){a.instance._refreshBorders()});var o=this.hot.getShortcutManager(),s=o.getContext("editor");s.removeShortcutsByGroup(HU),Rs(io(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var o=this.originalValue;o!==void 0&&this.setValue(o)}Rs(io(r.prototype),"finishEditing",this).call(this,i,a)}},{key:"showDatepicker",value:function(i){var a=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?s$(i.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new FU(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+a.top+Nr(this.TD),"px");var f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f=a.right-cr(this.datePicker):f=a.left,this.datePickerStyle.left="".concat(f,"px"),this.originalValue?(u=this.originalValue,Ae(u,o,!0).isValid()&&this.$datePicker.setMoment(Ae(u,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,Ae(u,o,!0).isValid()&&this.$datePicker.setMoment(Ae(u,o),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,a=this.TEXTAREA,o={};this.cellProperties&&this.cellProperties.datePickerConfig&&Yw(o,this.cellProperties.datePickerConfig);var s=o.onSelect,l=o.onClose;return o.field=a,o.trigger=a,o.container=this.datePicker,o.bound=!1,o.format=o.format||this.defaultDateFormat,o.reposition=o.reposition||!1,o.isRTL=!1,o.onSelect=function(u){var f=u;isNaN(f.getTime())||(f=Ae(f).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(f),i.hideDatepicker(),s&&s()},o.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},o}}],[{key:"EDITOR_TYPE",get:function(){return ine}}]),r}(fh);function Yv(e){return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yv(e)}function V8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W8e(n.key),n)}}function j8e(e,t,r){return t&&BU(e.prototype,t),r&&BU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W8e(e){var t=U8e(e,"string");return Yv(t)==="symbol"?t:String(t)}function U8e(e,t){if(Yv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fC(){return typeof Reflect<"u"&&Reflect.get?fC=Reflect.get.bind():fC=function(t,r,n){var i=z8e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},fC.apply(this,arguments)}function z8e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Kv(e),e!==null););return e}function G8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b2(e,t)}function b2(e,t){return b2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},b2(e,t)}function Y8e(e){var t=q8e();return function(){var n=Kv(e),i;if(t){var a=Kv(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return K8e(this,i)}}function K8e(e,t){if(t&&(Yv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return X8e(e)}function X8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kv(e){return Kv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kv(e)}var Z8e="dropdown",oB=function(e){G8e(r,e);var t=Y8e(r);function r(){return V8e(this,r),t.apply(this,arguments)}return j8e(r,[{key:"prepare",value:function(i,a,o,s,l,u){fC(Kv(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Z8e}}]),r}(aB);Qe.getSingleton().add("beforeValidate",function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===oB&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Xv(e){return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(e)}function J8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eUe(n.key),n)}}function Q8e(e,t,r){return t&&VU(e.prototype,t),r&&VU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eUe(e){var t=tUe(e,"string");return Xv(t)==="symbol"?t:String(t)}function tUe(e,t){if(Xv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w2(e,t)}function w2(e,t){return w2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},w2(e,t)}function nUe(e){var t=oUe();return function(){var n=Yx(e),i;if(t){var a=Yx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return iUe(this,i)}}function iUe(e,t){if(t&&(Xv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aUe(e)}function aUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yx(e){return Yx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yx(e)}var sUe="numeric",one=function(e){rUe(r,e);var t=nUe(r);function r(){return J8e(this,r),t.apply(this,arguments)}return Q8e(r,null,[{key:"EDITOR_TYPE",get:function(){return sUe}}]),r}(fh);function qv(e){return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(e)}function lUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fUe(n.key),n)}}function uUe(e,t,r){return t&&jU(e.prototype,t),r&&jU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fUe(e){var t=cUe(e,"string");return qv(t)==="symbol"?t:String(t)}function cUe(e,t){if(qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cC(){return typeof Reflect<"u"&&Reflect.get?cC=Reflect.get.bind():cC=function(t,r,n){var i=hUe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},cC.apply(this,arguments)}function hUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zv(e),e!==null););return e}function dUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S2(e,t)}function S2(e,t){return S2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},S2(e,t)}function vUe(e){var t=yUe();return function(){var n=Zv(e),i;if(t){var a=Zv(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pUe(this,i)}}function pUe(e,t){if(t&&(qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gUe(e)}function gUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zv(e){return Zv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zv(e)}var mUe="password",sne=function(e){dUe(r,e);var t=vUe(r);function r(){return lUe(this,r),t.apply(this,arguments)}return uUe(r,[{key:"createElements",value:function(){cC(Zv(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,mo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return mUe}}]),r}(fh);function Hc(e){return Hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hc(e)}function bUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SUe(n.key),n)}}function wUe(e,t,r){return t&&WU(e.prototype,t),r&&WU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SUe(e){var t=_Ue(e,"string");return Hc(t)==="symbol"?t:String(t)}function _Ue(e,t){if(Hc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hC(){return typeof Reflect<"u"&&Reflect.get?hC=Reflect.get.bind():hC=function(t,r,n){var i=CUe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},hC.apply(this,arguments)}function CUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Jv(e),e!==null););return e}function xUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_2(e,t)}function _2(e,t){return _2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_2(e,t)}function TUe(e){var t=RUe();return function(){var n=Jv(e),i;if(t){var a=Jv(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return OUe(this,i)}}function OUe(e,t){if(t&&(Hc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EUe(e)}function EUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jv(e){return Jv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jv(e)}var Ck="ht_editor_visible",UU="selectEditor",kUe="select",AUe=function(e){xUe(r,e);var t=TUe(r);function r(){return bUe(this,r),t.apply(this,arguments)}return wUe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),ke(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",bt(this.select,Ck)&&St(this.select,Ck),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,a,o,s,l,u){var f=this;hC(Jv(r.prototype),"prepare",this).call(this,i,a,o,s,l,u);var c=this.cellProperties.selectOptions,h;typeof c=="function"?h=this.prepareOptions(c(this.row,this.col,this.prop)):h=this.prepareOptions(c),mo(this.select),It(h,function(d,v){var p=f.hot.rootDocument.createElement("OPTION");p.value=v,lh(p,d),f.select.appendChild(p)})}},{key:"prepareOptions",value:function(i){var a={};if(Array.isArray(i))for(var o=0,s=i.length;o<s;o++)a[i[o]]=i[o];else Hc(i)==="object"&&(a=i);return a}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===xn.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),a=i.top,o=i.start,s=i.width,l=i.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(a,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(o,"px"),u.margin="0px",ke(this.select,Ck)}}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("editor"),s={group:UU};this.isInFullEditMode()!==!1&&o.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=i.select.selectedIndex-1;u>=0&&(i.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=i.select.selectedIndex+1;u<=i.select.length-1&&(i.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(UU)}}],[{key:"EDITOR_TYPE",get:function(){return kUe}}]),r}(Pg);function Qv(e){return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}function PUe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MUe(n.key),n)}}function IUe(e,t,r){return t&&zU(e.prototype,t),r&&zU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MUe(e){var t=DUe(e,"string");return Qv(t)==="symbol"?t:String(t)}function DUe(e,t){if(Qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dC(){return typeof Reflect<"u"&&Reflect.get?dC=Reflect.get.bind():dC=function(t,r,n){var i=NUe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},dC.apply(this,arguments)}function NUe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=ep(e),e!==null););return e}function LUe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C2(e,t)}function C2(e,t){return C2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},C2(e,t)}function FUe(e){var t=BUe();return function(){var n=ep(e),i;if(t){var a=ep(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return $Ue(this,i)}}function $Ue(e,t){if(t&&(Qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HUe(e)}function HUe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ep(e){return ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ep(e)}var VUe="time",lne=function(e){LUe(r,e);var t=FUe(r);function r(){return PUe(this,r),t.apply(this,arguments)}return IUe(r,[{key:"prepare",value:function(i,a,o,s,l,u){dC(ep(r.prototype),"prepare",this).call(this,i,a,o,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return VUe}}]),r}(fh);function jUe(){ki(Pg),ki(aB),ki(nne),ki(ane),ki(oB),ki(iB),ki(one),ki(sne),ki(AUe),ki(fh),ki(lne)}var WUe="html";function sB(e,t,r,n,i,a,o){fS.apply(this,[e,t,r,n,i,a,o]),lh(t,a??"",!1)}sB.RENDERER_TYPE=WUe;var UUe="autocomplete";function Ig(e,t,r,n,i,a,o){var s=e.rootDocument,l=o.allowHtml?sB:zu,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,r,n,i,a,o]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),ke(t,"htAutocomplete"),!e.acArrowListener){var f=new Fr(e);e.acArrowListener=function(c){bt(c.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},f.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){f.destroy()})}}Ig.RENDERER_TYPE=UUe;var GU=new WeakMap,YU=new WeakMap,zUe="htBadValue",tp="data-row",rp="data-col",GUe="checkboxRenderer",une="checkbox";Qe.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){var n=t.label,i=t.type,a=t.row,o=t.column,s=t.prop;if(i===une){if(n){var l=n.value,u=n.property,f=r;if(l)f=typeof l=="function"?l(a,o,s,r):l;else if(u){var c=this.getDataAtRowProp(a,u);f=c!==null?c:r}e=f}return e}});function lB(e,t,r,n,i,a,o){var s=e.rootDocument;fS.apply(this,[e,t,r,n,i,a,o]),YUe(e);var l=KUe(s),u=o.label,f=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),mo(t),a===o.checkedTemplate||jr(a).toLocaleLowerCase(o.locale)===jr(o.checkedTemplate).toLocaleLowerCase(o.locale)?l.checked=!0:a===o.uncheckedTemplate||jr(a).toLocaleLowerCase(o.locale)===jr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?l.checked=!1:pn(a)?ke(l,"noValue"):(l.style.display="none",ke(l,zUe),f=!0),l.setAttribute(tp,r),l.setAttribute(rp,n),!f&&u){var c="";if(u.value)c=typeof u.value=="function"?u.value.call(this,r,n,i,a):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);c=h!==null?h:""}var d=XUe(s,c,u.separated!==!0);u.position==="before"?u.separated?(t.appendChild(d),t.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(t.appendChild(l),t.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&t.appendChild(l),f&&t.appendChild(s.createTextNode("#bad-value#")),GU.has(e)||(GU.set(e,!0),v());function v(){var y=e.getShortcutManager(),m=y.getContext("grid"),b={group:GUe};m.addShortcuts([{keys:[["space"]],callback:function(){return p(),!g()}},{keys:[["enter"]],callback:function(){return p(),!g()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return p(!0),!g()},relativeToGroup:pm,position:"before"}],b)}function p(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=e.getSelectedRange();if(m)for(var b=0;b<m.length;b++){for(var S=m[b].getTopStartCorner(),x=S.row,T=S.col,E=m[b].getBottomEndCorner(),P=E.row,R=E.col,M=[],D=x;D<=P;D+=1)for(var N=T;N<=R;N+=1){var B=e.getCellMeta(D,N);if(B.type!=="checkbox")return;if(B.readOnly!==!0){typeof B.checkedTemplate>"u"&&(B.checkedTemplate=!0),typeof B.uncheckedTemplate>"u"&&(B.uncheckedTemplate=!1);var K=e.getDataAtCell(D,N);y===!1?[B.checkedTemplate,B.checkedTemplate.toString()].includes(K)?M.push([D,N,B.uncheckedTemplate]):[B.uncheckedTemplate,B.uncheckedTemplate.toString(),null,void 0].includes(K)&&M.push([D,N,B.checkedTemplate]):M.push([D,N,B.uncheckedTemplate])}}M.length>0&&e.setDataAtCell(M)}}function g(){var y=e.getSelectedRange();if(y){for(var m=0;m<y.length;m++)for(var b=y[m].getTopStartCorner(),S=y[m].getBottomEndCorner(),x=b.row;x<=S.row;x++)for(var T=b.col;T<=S.col;T++){var E=e.getCellMeta(x,T);if(E.type!=="checkbox")return!1;var P=e.getCell(x,T);if(P==null)return!0;var R=P.querySelectorAll("input[type=checkbox]");if(R.length>0&&!E.readOnly)return!0}return!1}}}lB.RENDERER_TYPE=une;function YUe(e){var t=YU.get(e);if(!t){var r=e.rootElement;t=new Fr(e),t.addEventListener(r,"click",function(n){return ZUe(n,e)}),t.addEventListener(r,"mouseup",function(n){return qUe(n,e)}),t.addEventListener(r,"change",function(n){return JUe(n,e)}),YU.set(e,t)}return t}function KUe(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function XUe(e,t,r){var n=e.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}function qUe(e,t){var r=e.target;uB(r)&&(!r.hasAttribute(tp)||!r.hasAttribute(rp)||setTimeout(t.listen,10))}function ZUe(e,t){var r=e.target;if(uB(r)&&!(!r.hasAttribute(tp)||!r.hasAttribute(rp))){var n=parseInt(r.getAttribute(tp),10),i=parseInt(r.getAttribute(rp),10),a=t.getCellMeta(n,i);a.readOnly&&e.preventDefault()}}function JUe(e,t){var r=e.target;if(uB(r)&&!(!r.hasAttribute(tp)||!r.hasAttribute(rp))){var n=parseInt(r.getAttribute(tp),10),i=parseInt(r.getAttribute(rp),10),a=t.getCellMeta(n,i);if(!a.readOnly){var o=null;e.target.checked?o=a.uncheckedTemplate===void 0?!0:a.checkedTemplate:o=a.uncheckedTemplate===void 0?!1:a.uncheckedTemplate,t.setDataAtCell(n,i,o)}}}function uB(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}function c_(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var x2={},QUe={get exports(){return x2},set exports(e){x2=e}};(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,a){function o(u,f){if(!i[u]){if(!n[u]){var c=typeof c_=="function"&&c_;if(!f&&c)return c(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(v){return o(n[u][1][v]||v)},d,d.exports,r,n,i,a)}return i[u].exports}for(var s=typeof c_=="function"&&c_,l=0;l<a.length;l++)o(a[l]);return o}({1:[function(r,n,i){(function(a){var o,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,f="[BigNumber Error] ",c=f+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,v=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],g=1e7,y=1e9;function m(R){var M=0|R;return 0<R||R===M?M:M-1}function b(R){for(var M,D,N=1,B=R.length,K=R[0]+"";N<B;){for(M=R[N++]+"",D=d-M.length;D--;M="0"+M);K+=M}for(B=K.length;K.charCodeAt(--B)===48;);return K.slice(0,B+1||1)}function S(R,M){var D,N,B=R.c,K=M.c,Z=R.s,ie=M.s,me=R.e,k=M.e;if(!Z||!ie)return null;if(D=B&&!B[0],N=K&&!K[0],D||N)return D?N?0:-ie:Z;if(Z!=ie)return Z;if(D=Z<0,N=me==k,!B||!K)return N?0:!B^D?1:-1;if(!N)return k<me^D?1:-1;for(ie=(me=B.length)<(k=K.length)?me:k,Z=0;Z<ie;Z++)if(B[Z]!=K[Z])return B[Z]>K[Z]^D?1:-1;return me==k?0:k<me^D?1:-1}function x(R,M,D,N){if(R<M||D<R||R!==(R<0?l(R):u(R)))throw Error(f+(N||"Argument")+(typeof R=="number"?R<M||D<R?" out of range: ":" not an integer: ":" not a primitive number: ")+String(R))}function T(R){var M=R.c.length-1;return m(R.e/d)==M&&R.c[M]%2!=0}function E(R,M){return(1<R.length?R.charAt(0)+"."+R.slice(1):R)+(M<0?"e":"e+")+M}function P(R,M,D){var N,B;if(M<0){for(B=D+".";++M;B+=D);R=B+R}else if(++M>(N=R.length)){for(B=D,M-=N;--M;B+=D);R+=B}else M<N&&(R=R.slice(0,M)+"."+R.slice(M));return R}(o=function R(M){var D,N,B,K,Z,ie,me,k,w,C,O=oe.prototype={constructor:oe,toString:null,valueOf:null},_=new oe(1),A=20,I=4,L=-7,V=21,Y=-1e7,ae=1e7,re=!1,te=1,ge=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Ce="0123456789abcdefghijklmnopqrstuvwxyz";function oe(j,U){var Q,fe,ee,pe,se,ue,ce,ve,de=this;if(!(de instanceof oe))return new oe(j,U);if(U==null){if(j instanceof oe)return de.s=j.s,de.e=j.e,void(de.c=(j=j.c)?j.slice():j);if((ue=typeof j=="number")&&0*j==0){if(de.s=1/j<0?(j=-j,-1):1,j===~~j){for(pe=0,se=j;10<=se;se/=10,pe++);return de.e=pe,void(de.c=[j])}ve=String(j)}else{if(ve=String(j),!s.test(ve))return B(de,ve,ue);de.s=ve.charCodeAt(0)==45?(ve=ve.slice(1),-1):1}-1<(pe=ve.indexOf("."))&&(ve=ve.replace(".","")),0<(se=ve.search(/e/i))?(pe<0&&(pe=se),pe+=+ve.slice(se+1),ve=ve.substring(0,se)):pe<0&&(pe=ve.length)}else{if(x(U,2,Ce.length,"Base"),ve=String(j),U==10)return Ie(de=new oe(j instanceof oe?j:ve),A+de.e+1,I);if(ue=typeof j=="number"){if(0*j!=0)return B(de,ve,ue,U);if(de.s=1/j<0?(ve=ve.slice(1),-1):1,oe.DEBUG&&15<ve.replace(/^0\.0*|\./,"").length)throw Error(c+j);ue=!1}else de.s=ve.charCodeAt(0)===45?(ve=ve.slice(1),-1):1;for(Q=Ce.slice(0,U),pe=se=0,ce=ve.length;se<ce;se++)if(Q.indexOf(fe=ve.charAt(se))<0){if(fe=="."){if(pe<se){pe=ce;continue}}else if(!ee&&(ve==ve.toUpperCase()&&(ve=ve.toLowerCase())||ve==ve.toLowerCase()&&(ve=ve.toUpperCase()))){ee=!0,se=-1,pe=0;continue}return B(de,String(j),ue,U)}-1<(pe=(ve=N(ve,U,10,de.s)).indexOf("."))?ve=ve.replace(".",""):pe=ve.length}for(se=0;ve.charCodeAt(se)===48;se++);for(ce=ve.length;ve.charCodeAt(--ce)===48;);if(ve=ve.slice(se,++ce)){if(ce-=se,ue&&oe.DEBUG&&15<ce&&(v<j||j!==u(j)))throw Error(c+de.s*j);if(ae<(pe=pe-se-1))de.c=de.e=null;else if(pe<Y)de.c=[de.e=0];else{if(de.e=pe,de.c=[],se=(pe+1)%d,pe<0&&(se+=d),se<ce){for(se&&de.c.push(+ve.slice(0,se)),ce-=d;se<ce;)de.c.push(+ve.slice(se,se+=d));ve=ve.slice(se),se=d-ve.length}else se-=ce;for(;se--;ve+="0");de.c.push(+ve)}}else de.c=[de.e=0]}function Oe(j,U,Q,fe){var ee,pe,se,ue,ce;if(Q==null?Q=I:x(Q,0,8),!j.c)return j.toString();if(ee=j.c[0],se=j.e,U==null)ce=b(j.c),ce=fe==1||fe==2&&(se<=L||V<=se)?E(ce,se):P(ce,se,"0");else if(pe=(j=Ie(new oe(j),U,Q)).e,ue=(ce=b(j.c)).length,fe==1||fe==2&&(U<=pe||pe<=L)){for(;ue<U;ce+="0",ue++);ce=E(ce,pe)}else if(U-=se,ce=P(ce,pe,"0"),ue<pe+1){if(0<--U)for(ce+=".";U--;ce+="0");}else if(0<(U+=pe-ue))for(pe+1==ue&&(ce+=".");U--;ce+="0");return j.s<0&&ee?"-"+ce:ce}function Ee(j,U){for(var Q,fe=1,ee=new oe(j[0]);fe<j.length;fe++){if(!(Q=new oe(j[fe])).s){ee=Q;break}U.call(ee,Q)&&(ee=Q)}return ee}function be(j,U,Q){for(var fe=1,ee=U.length;!U[--ee];U.pop());for(ee=U[0];10<=ee;ee/=10,fe++);return(Q=fe+Q*d-1)>ae?j.c=j.e=null:j.c=Q<Y?[j.e=0]:(j.e=Q,U),j}function Ie(j,U,Q,fe){var ee,pe,se,ue,ce,ve,de,Te=j.c,Le=p;if(Te){e:{for(ee=1,ue=Te[0];10<=ue;ue/=10,ee++);if((pe=U-ee)<0)pe+=d,se=U,de=(ce=Te[ve=0])/Le[ee-se-1]%10|0;else if((ve=l((pe+1)/d))>=Te.length){if(!fe)break e;for(;Te.length<=ve;Te.push(0));ce=de=0,se=(pe%=d)-d+(ee=1)}else{for(ce=ue=Te[ve],ee=1;10<=ue;ue/=10,ee++);de=(se=(pe%=d)-d+ee)<0?0:ce/Le[ee-se-1]%10|0}if(fe=fe||U<0||Te[ve+1]!=null||(se<0?ce:ce%Le[ee-se-1]),fe=Q<4?(de||fe)&&(Q==0||Q==(j.s<0?3:2)):5<de||de==5&&(Q==4||fe||Q==6&&(0<pe?0<se?ce/Le[ee-se]:0:Te[ve-1])%10&1||Q==(j.s<0?8:7)),U<1||!Te[0])return Te.length=0,fe?(U-=j.e+1,Te[0]=Le[(d-U%d)%d],j.e=-U||0):Te[0]=j.e=0,j;if(pe==0?(Te.length=ve,ue=1,ve--):(Te.length=ve+1,ue=Le[d-pe],Te[ve]=0<se?u(ce/Le[ee-se]%Le[se])*ue:0),fe)for(;;){if(ve==0){for(pe=1,se=Te[0];10<=se;se/=10,pe++);for(se=Te[0]+=ue,ue=1;10<=se;se/=10,ue++);pe!=ue&&(j.e++,Te[0]==h&&(Te[0]=1));break}if(Te[ve]+=ue,Te[ve]!=h)break;Te[ve--]=0,ue=1}for(pe=Te.length;Te[--pe]===0;Te.pop());}j.e>ae?j.c=j.e=null:j.e<Y&&(j.c=[j.e=0])}return j}function Me(j){var U,Q=j.e;return Q===null?j.toString():(U=b(j.c),U=Q<=L||V<=Q?E(U,Q):P(U,Q,"0"),j.s<0?"-"+U:U)}return oe.clone=R,oe.ROUND_UP=0,oe.ROUND_DOWN=1,oe.ROUND_CEIL=2,oe.ROUND_FLOOR=3,oe.ROUND_HALF_UP=4,oe.ROUND_HALF_DOWN=5,oe.ROUND_HALF_EVEN=6,oe.ROUND_HALF_CEIL=7,oe.ROUND_HALF_FLOOR=8,oe.EUCLID=9,oe.config=oe.set=function(j){var U,Q;if(j!=null){if(typeof j!="object")throw Error(f+"Object expected: "+j);if(j.hasOwnProperty(U="DECIMAL_PLACES")&&(x(Q=j[U],0,y,U),A=Q),j.hasOwnProperty(U="ROUNDING_MODE")&&(x(Q=j[U],0,8,U),I=Q),j.hasOwnProperty(U="EXPONENTIAL_AT")&&((Q=j[U])&&Q.pop?(x(Q[0],-y,0,U),x(Q[1],0,y,U),L=Q[0],V=Q[1]):(x(Q,-y,y,U),L=-(V=Q<0?-Q:Q))),j.hasOwnProperty(U="RANGE"))if((Q=j[U])&&Q.pop)x(Q[0],-y,-1,U),x(Q[1],1,y,U),Y=Q[0],ae=Q[1];else{if(x(Q,-y,y,U),!Q)throw Error(f+U+" cannot be zero: "+Q);Y=-(ae=Q<0?-Q:Q)}if(j.hasOwnProperty(U="CRYPTO")){if((Q=j[U])!==!!Q)throw Error(f+U+" not true or false: "+Q);if(Q){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!Q,Error(f+"crypto unavailable");re=Q}else re=Q}if(j.hasOwnProperty(U="MODULO_MODE")&&(x(Q=j[U],0,9,U),te=Q),j.hasOwnProperty(U="POW_PRECISION")&&(x(Q=j[U],0,y,U),ge=Q),j.hasOwnProperty(U="FORMAT")){if(typeof(Q=j[U])!="object")throw Error(f+U+" not an object: "+Q);H=Q}if(j.hasOwnProperty(U="ALPHABET")){if(typeof(Q=j[U])!="string"||/^.$|[+-.\s]|(.).*\1/.test(Q))throw Error(f+U+" invalid: "+Q);Ce=Q}}return{DECIMAL_PLACES:A,ROUNDING_MODE:I,EXPONENTIAL_AT:[L,V],RANGE:[Y,ae],CRYPTO:re,MODULO_MODE:te,POW_PRECISION:ge,FORMAT:H,ALPHABET:Ce}},oe.isBigNumber=function(j){return j instanceof oe||j&&j._isBigNumber===!0||!1},oe.maximum=oe.max=function(){return Ee(arguments,O.lt)},oe.minimum=oe.min=function(){return Ee(arguments,O.gt)},oe.random=(K=9007199254740992,Z=Math.random()*K&2097151?function(){return u(Math.random()*K)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(j){var U,Q,fe,ee,pe,se=0,ue=[],ce=new oe(_);if(j==null?j=A:x(j,0,y),ee=l(j/d),re)if(crypto.getRandomValues){for(U=crypto.getRandomValues(new Uint32Array(ee*=2));se<ee;)9e15<=(pe=131072*U[se]+(U[se+1]>>>11))?(Q=crypto.getRandomValues(new Uint32Array(2)),U[se]=Q[0],U[se+1]=Q[1]):(ue.push(pe%1e14),se+=2);se=ee/2}else{if(!crypto.randomBytes)throw re=!1,Error(f+"crypto unavailable");for(U=crypto.randomBytes(ee*=7);se<ee;)9e15<=(pe=281474976710656*(31&U[se])+1099511627776*U[se+1]+4294967296*U[se+2]+16777216*U[se+3]+(U[se+4]<<16)+(U[se+5]<<8)+U[se+6])?crypto.randomBytes(7).copy(U,se):(ue.push(pe%1e14),se+=7);se=ee/7}if(!re)for(;se<ee;)(pe=Z())<9e15&&(ue[se++]=pe%1e14);for(ee=ue[--se],j%=d,ee&&j&&(pe=p[d-j],ue[se]=u(ee/pe)*pe);ue[se]===0;ue.pop(),se--);if(se<0)ue=[fe=0];else{for(fe=-1;ue[0]===0;ue.splice(0,1),fe-=d);for(se=1,pe=ue[0];10<=pe;pe/=10,se++);se<d&&(fe-=d-se)}return ce.e=fe,ce.c=ue,ce}),oe.sum=function(){for(var j=1,U=arguments,Q=new oe(U[0]);j<U.length;)Q=Q.plus(U[j++]);return Q},N=function(){var j="0123456789";function U(Q,fe,ee,pe){for(var se,ue,ce=[0],ve=0,de=Q.length;ve<de;){for(ue=ce.length;ue--;ce[ue]*=fe);for(ce[0]+=pe.indexOf(Q.charAt(ve++)),se=0;se<ce.length;se++)ce[se]>ee-1&&(ce[se+1]==null&&(ce[se+1]=0),ce[se+1]+=ce[se]/ee|0,ce[se]%=ee)}return ce.reverse()}return function(Q,fe,ee,pe,se){var ue,ce,ve,de,Te,Le,$e,it,yt=Q.indexOf("."),Vt=A,ut=I;for(0<=yt&&(de=ge,ge=0,Q=Q.replace(".",""),Le=(it=new oe(fe)).pow(Q.length-yt),ge=de,it.c=U(P(b(Le.c),Le.e,"0"),10,ee,j),it.e=it.c.length),ve=de=($e=U(Q,fe,ee,se?(ue=Ce,j):(ue=j,Ce))).length;$e[--de]==0;$e.pop());if(!$e[0])return ue.charAt(0);if(yt<0?--ve:(Le.c=$e,Le.e=ve,Le.s=pe,$e=(Le=D(Le,it,Vt,ut,ee)).c,Te=Le.r,ve=Le.e),yt=$e[ce=ve+Vt+1],de=ee/2,Te=Te||ce<0||$e[ce+1]!=null,Te=ut<4?(yt!=null||Te)&&(ut==0||ut==(Le.s<0?3:2)):de<yt||yt==de&&(ut==4||Te||ut==6&&1&$e[ce-1]||ut==(Le.s<0?8:7)),ce<1||!$e[0])Q=Te?P(ue.charAt(1),-Vt,ue.charAt(0)):ue.charAt(0);else{if($e.length=ce,Te)for(--ee;++$e[--ce]>ee;)$e[ce]=0,ce||(++ve,$e=[1].concat($e));for(de=$e.length;!$e[--de];);for(yt=0,Q="";yt<=de;Q+=ue.charAt($e[yt++]));Q=P(Q,ve,ue.charAt(0))}return Q}}(),D=function(){function j(fe,ee,pe){var se,ue,ce,ve,de=0,Te=fe.length,Le=ee%g,$e=ee/g|0;for(fe=fe.slice();Te--;)de=((ue=Le*(ce=fe[Te]%g)+(se=$e*ce+(ve=fe[Te]/g|0)*Le)%g*g+de)/pe|0)+(se/g|0)+$e*ve,fe[Te]=ue%pe;return de&&(fe=[de].concat(fe)),fe}function U(fe,ee,pe,se){var ue,ce;if(pe!=se)ce=se<pe?1:-1;else for(ue=ce=0;ue<pe;ue++)if(fe[ue]!=ee[ue]){ce=fe[ue]>ee[ue]?1:-1;break}return ce}function Q(fe,ee,pe,se){for(var ue=0;pe--;)fe[pe]-=ue,ue=fe[pe]<ee[pe]?1:0,fe[pe]=ue*se+fe[pe]-ee[pe];for(;!fe[0]&&1<fe.length;fe.splice(0,1));}return function(fe,ee,pe,se,ue){var ce,ve,de,Te,Le,$e,it,yt,Vt,ut,ft,Et,Ft,Dt,wt,dt,Ke,Be=fe.s==ee.s?1:-1,at=fe.c,He=ee.c;if(!(at&&at[0]&&He&&He[0]))return new oe(fe.s&&ee.s&&(at?!He||at[0]!=He[0]:He)?at&&at[0]==0||!He?0*Be:Be/0:NaN);for(Vt=(yt=new oe(Be)).c=[],Be=pe+(ve=fe.e-ee.e)+1,ue||(ue=h,ve=m(fe.e/d)-m(ee.e/d),Be=Be/d|0),de=0;He[de]==(at[de]||0);de++);if(He[de]>(at[de]||0)&&ve--,Be<0)Vt.push(1),Te=!0;else{for(Dt=at.length,dt=He.length,Be+=2,1<(Le=u(ue/(He[de=0]+1)))&&(He=j(He,Le,ue),at=j(at,Le,ue),dt=He.length,Dt=at.length),Ft=dt,ft=(ut=at.slice(0,dt)).length;ft<dt;ut[ft++]=0);Ke=He.slice(),Ke=[0].concat(Ke),wt=He[0],He[1]>=ue/2&&wt++;do{if(Le=0,(ce=U(He,ut,dt,ft))<0){if(Et=ut[0],dt!=ft&&(Et=Et*ue+(ut[1]||0)),1<(Le=u(Et/wt)))for(ue<=Le&&(Le=ue-1),it=($e=j(He,Le,ue)).length,ft=ut.length;U($e,ut,it,ft)==1;)Le--,Q($e,dt<it?Ke:He,it,ue),it=$e.length,ce=1;else Le==0&&(ce=Le=1),it=($e=He.slice()).length;if(it<ft&&($e=[0].concat($e)),Q(ut,$e,ft,ue),ft=ut.length,ce==-1)for(;U(He,ut,dt,ft)<1;)Le++,Q(ut,dt<ft?Ke:He,ft,ue),ft=ut.length}else ce===0&&(Le++,ut=[0]);Vt[de++]=Le,ut[0]?ut[ft++]=at[Ft]||0:(ut=[at[Ft]],ft=1)}while((Ft++<Dt||ut[0]!=null)&&Be--);Te=ut[0]!=null,Vt[0]||Vt.splice(0,1)}if(ue==h){for(de=1,Be=Vt[0];10<=Be;Be/=10,de++);Ie(yt,pe+(yt.e=de+ve*d-1)+1,se,Te)}else yt.e=ve,yt.r=+Te;return yt}}(),ie=/^(-?)0([xbo])(?=\w[\w.]*$)/i,me=/^([^.]+)\.$/,k=/^\.([^.]+)$/,w=/^-?(Infinity|NaN)$/,C=/^\s*\+(?=[\w.])|^\s+|\s+$/g,B=function(j,U,Q,fe){var ee,pe=Q?U:U.replace(C,"");if(w.test(pe))j.s=isNaN(pe)?null:pe<0?-1:1,j.c=j.e=null;else{if(!Q&&(pe=pe.replace(ie,function(se,ue,ce){return ee=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,fe&&fe!=ee?se:ue}),fe&&(ee=fe,pe=pe.replace(me,"$1").replace(k,"0.$1")),U!=pe))return new oe(pe,ee);if(oe.DEBUG)throw Error(f+"Not a"+(fe?" base "+fe:"")+" number: "+U);j.c=j.e=j.s=null}},O.absoluteValue=O.abs=function(){var j=new oe(this);return j.s<0&&(j.s=1),j},O.comparedTo=function(j,U){return S(this,new oe(j,U))},O.decimalPlaces=O.dp=function(j,U){var Q,fe,ee;if(j!=null)return x(j,0,y),U==null?U=I:x(U,0,8),Ie(new oe(this),j+this.e+1,U);if(!(Q=this.c))return null;if(fe=((ee=Q.length-1)-m(this.e/d))*d,ee=Q[ee])for(;ee%10==0;ee/=10,fe--);return fe<0&&(fe=0),fe},O.dividedBy=O.div=function(j,U){return D(this,new oe(j,U),A,I)},O.dividedToIntegerBy=O.idiv=function(j,U){return D(this,new oe(j,U),0,1)},O.exponentiatedBy=O.pow=function(j,U){var Q,fe,ee,pe,se,ue,ce,ve,de=this;if((j=new oe(j)).c&&!j.isInteger())throw Error(f+"Exponent not an integer: "+Me(j));if(U!=null&&(U=new oe(U)),se=14<j.e,!de.c||!de.c[0]||de.c[0]==1&&!de.e&&de.c.length==1||!j.c||!j.c[0])return ve=new oe(Math.pow(+Me(de),se?2-T(j):+Me(j))),U?ve.mod(U):ve;if(ue=j.s<0,U){if(U.c?!U.c[0]:!U.s)return new oe(NaN);(fe=!ue&&de.isInteger()&&U.isInteger())&&(de=de.mod(U))}else{if(9<j.e&&(0<de.e||de.e<-1||(de.e==0?1<de.c[0]||se&&24e7<=de.c[1]:de.c[0]<8e13||se&&de.c[0]<=9999975e7)))return pe=de.s<0&&T(j)?-0:0,-1<de.e&&(pe=1/pe),new oe(ue?1/pe:pe);ge&&(pe=l(ge/d+2))}for(ce=se?(Q=new oe(.5),ue&&(j.s=1),T(j)):(ee=Math.abs(+Me(j)))%2,ve=new oe(_);;){if(ce){if(!(ve=ve.times(de)).c)break;pe?ve.c.length>pe&&(ve.c.length=pe):fe&&(ve=ve.mod(U))}if(ee){if((ee=u(ee/2))===0)break;ce=ee%2}else if(Ie(j=j.times(Q),j.e+1,1),14<j.e)ce=T(j);else{if((ee=+Me(j))==0)break;ce=ee%2}de=de.times(de),pe?de.c&&de.c.length>pe&&(de.c.length=pe):fe&&(de=de.mod(U))}return fe?ve:(ue&&(ve=_.div(ve)),U?ve.mod(U):pe?Ie(ve,ge,I,void 0):ve)},O.integerValue=function(j){var U=new oe(this);return j==null?j=I:x(j,0,8),Ie(U,U.e+1,j)},O.isEqualTo=O.eq=function(j,U){return S(this,new oe(j,U))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(j,U){return 0<S(this,new oe(j,U))},O.isGreaterThanOrEqualTo=O.gte=function(j,U){return(U=S(this,new oe(j,U)))===1||U===0},O.isInteger=function(){return!!this.c&&m(this.e/d)>this.c.length-2},O.isLessThan=O.lt=function(j,U){return S(this,new oe(j,U))<0},O.isLessThanOrEqualTo=O.lte=function(j,U){return(U=S(this,new oe(j,U)))===-1||U===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return 0<this.s},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(j,U){var Q,fe,ee,pe,se=this,ue=se.s;if(U=(j=new oe(j,U)).s,!ue||!U)return new oe(NaN);if(ue!=U)return j.s=-U,se.plus(j);var ce=se.e/d,ve=j.e/d,de=se.c,Te=j.c;if(!ce||!ve){if(!de||!Te)return de?(j.s=-U,j):new oe(Te?se:NaN);if(!de[0]||!Te[0])return Te[0]?(j.s=-U,j):new oe(de[0]?se:I==3?-0:0)}if(ce=m(ce),ve=m(ve),de=de.slice(),ue=ce-ve){for((ee=(pe=ue<0)?(ue=-ue,de):(ve=ce,Te)).reverse(),U=ue;U--;ee.push(0));ee.reverse()}else for(fe=(pe=(ue=de.length)<(U=Te.length))?ue:U,ue=U=0;U<fe;U++)if(de[U]!=Te[U]){pe=de[U]<Te[U];break}if(pe&&(ee=de,de=Te,Te=ee,j.s=-j.s),0<(U=(fe=Te.length)-(Q=de.length)))for(;U--;de[Q++]=0);for(U=h-1;ue<fe;){if(de[--fe]<Te[fe]){for(Q=fe;Q&&!de[--Q];de[Q]=U);--de[Q],de[fe]+=h}de[fe]-=Te[fe]}for(;de[0]==0;de.splice(0,1),--ve);return de[0]?be(j,de,ve):(j.s=I==3?-1:1,j.c=[j.e=0],j)},O.modulo=O.mod=function(j,U){var Q,fe,ee=this;return j=new oe(j,U),!ee.c||!j.s||j.c&&!j.c[0]?new oe(NaN):!j.c||ee.c&&!ee.c[0]?new oe(ee):(te==9?(fe=j.s,j.s=1,Q=D(ee,j,0,3),j.s=fe,Q.s*=fe):Q=D(ee,j,0,te),(j=ee.minus(Q.times(j))).c[0]||te!=1||(j.s=ee.s),j)},O.multipliedBy=O.times=function(j,U){var Q,fe,ee,pe,se,ue,ce,ve,de,Te,Le,$e,it,yt,Vt,ut=this,ft=ut.c,Et=(j=new oe(j,U)).c;if(!(ft&&Et&&ft[0]&&Et[0]))return!ut.s||!j.s||ft&&!ft[0]&&!Et||Et&&!Et[0]&&!ft?j.c=j.e=j.s=null:(j.s*=ut.s,ft&&Et?(j.c=[0],j.e=0):j.c=j.e=null),j;for(fe=m(ut.e/d)+m(j.e/d),j.s*=ut.s,(ce=ft.length)<(Te=Et.length)&&(it=ft,ft=Et,Et=it,ee=ce,ce=Te,Te=ee),ee=ce+Te,it=[];ee--;it.push(0));for(yt=h,Vt=g,ee=Te;0<=--ee;){for(Q=0,Le=Et[ee]%Vt,$e=Et[ee]/Vt|0,pe=ee+(se=ce);ee<pe;)Q=((ve=Le*(ve=ft[--se]%Vt)+(ue=$e*ve+(de=ft[se]/Vt|0)*Le)%Vt*Vt+it[pe]+Q)/yt|0)+(ue/Vt|0)+$e*de,it[pe--]=ve%yt;it[pe]=Q}return Q?++fe:it.splice(0,1),be(j,it,fe)},O.negated=function(){var j=new oe(this);return j.s=-j.s||null,j},O.plus=function(j,U){var Q,fe=this,ee=fe.s;if(U=(j=new oe(j,U)).s,!ee||!U)return new oe(NaN);if(ee!=U)return j.s=-U,fe.minus(j);var pe=fe.e/d,se=j.e/d,ue=fe.c,ce=j.c;if(!pe||!se){if(!ue||!ce)return new oe(ee/0);if(!ue[0]||!ce[0])return ce[0]?j:new oe(ue[0]?fe:0*ee)}if(pe=m(pe),se=m(se),ue=ue.slice(),ee=pe-se){for((Q=0<ee?(se=pe,ce):(ee=-ee,ue)).reverse();ee--;Q.push(0));Q.reverse()}for((ee=ue.length)-(U=ce.length)<0&&(Q=ce,ce=ue,ue=Q,U=ee),ee=0;U;)ee=(ue[--U]=ue[U]+ce[U]+ee)/h|0,ue[U]=h===ue[U]?0:ue[U]%h;return ee&&(ue=[ee].concat(ue),++se),be(j,ue,se)},O.precision=O.sd=function(j,U){var Q,fe,ee;if(j!=null&&j!==!!j)return x(j,1,y),U==null?U=I:x(U,0,8),Ie(new oe(this),j,U);if(!(Q=this.c))return null;if(fe=(ee=Q.length-1)*d+1,ee=Q[ee]){for(;ee%10==0;ee/=10,fe--);for(ee=Q[0];10<=ee;ee/=10,fe++);}return j&&this.e+1>fe&&(fe=this.e+1),fe},O.shiftedBy=function(j){return x(j,-v,v),this.times("1e"+j)},O.squareRoot=O.sqrt=function(){var j,U,Q,fe,ee,pe=this,se=pe.c,ue=pe.s,ce=pe.e,ve=A+4,de=new oe("0.5");if(ue!==1||!se||!se[0])return new oe(!ue||ue<0&&(!se||se[0])?NaN:se?pe:1/0);if((Q=(ue=Math.sqrt(+Me(pe)))==0||ue==1/0?(((U=b(se)).length+ce)%2==0&&(U+="0"),ue=Math.sqrt(+U),ce=m((ce+1)/2)-(ce<0||ce%2),new oe(U=ue==1/0?"1e"+ce:(U=ue.toExponential()).slice(0,U.indexOf("e")+1)+ce)):new oe(ue+"")).c[0]){for((ue=(ce=Q.e)+ve)<3&&(ue=0);;)if(ee=Q,Q=de.times(ee.plus(D(pe,ee,ve,1))),b(ee.c).slice(0,ue)===(U=b(Q.c)).slice(0,ue)){if(Q.e<ce&&--ue,(U=U.slice(ue-3,ue+1))!="9999"&&(fe||U!="4999")){+U&&(+U.slice(1)||U.charAt(0)!="5")||(Ie(Q,Q.e+A+2,1),j=!Q.times(Q).eq(pe));break}if(!fe&&(Ie(ee,ee.e+A+2,0),ee.times(ee).eq(pe))){Q=ee;break}ve+=4,ue+=4,fe=1}}return Ie(Q,Q.e+A+1,I,j)},O.toExponential=function(j,U){return j!=null&&(x(j,0,y),j++),Oe(this,j,U,1)},O.toFixed=function(j,U){return j!=null&&(x(j,0,y),j=j+this.e+1),Oe(this,j,U)},O.toFormat=function(j,U,Q){var fe;if(Q==null)j!=null&&U&&typeof U=="object"?(Q=U,U=null):j&&typeof j=="object"?(Q=j,j=U=null):Q=H;else if(typeof Q!="object")throw Error(f+"Argument not an object: "+Q);if(fe=this.toFixed(j,U),this.c){var ee,pe=fe.split("."),se=+Q.groupSize,ue=+Q.secondaryGroupSize,ce=Q.groupSeparator||"",ve=pe[0],de=pe[1],Te=this.s<0,Le=Te?ve.slice(1):ve,$e=Le.length;if(ue&&(ee=se,se=ue,$e-=ue=ee),0<se&&0<$e){for(ee=$e%se||se,ve=Le.substr(0,ee);ee<$e;ee+=se)ve+=ce+Le.substr(ee,se);0<ue&&(ve+=ce+Le.slice(ee)),Te&&(ve="-"+ve)}fe=de?ve+(Q.decimalSeparator||"")+((ue=+Q.fractionGroupSize)?de.replace(new RegExp("\\d{"+ue+"}\\B","g"),"$&"+(Q.fractionGroupSeparator||"")):de):ve}return(Q.prefix||"")+fe+(Q.suffix||"")},O.toFraction=function(j){var U,Q,fe,ee,pe,se,ue,ce,ve,de,Te,Le,$e=this,it=$e.c;if(j!=null&&(!(ue=new oe(j)).isInteger()&&(ue.c||ue.s!==1)||ue.lt(_)))throw Error(f+"Argument "+(ue.isInteger()?"out of range: ":"not an integer: ")+Me(ue));if(!it)return new oe($e);for(U=new oe(_),ve=Q=new oe(_),fe=ce=new oe(_),Le=b(it),pe=U.e=Le.length-$e.e-1,U.c[0]=p[(se=pe%d)<0?d+se:se],j=!j||0<ue.comparedTo(U)?0<pe?U:ve:ue,se=ae,ae=1/0,ue=new oe(Le),ce.c[0]=0;de=D(ue,U,0,1),(ee=Q.plus(de.times(fe))).comparedTo(j)!=1;)Q=fe,fe=ee,ve=ce.plus(de.times(ee=ve)),ce=ee,U=ue.minus(de.times(ee=U)),ue=ee;return ee=D(j.minus(Q),fe,0,1),ce=ce.plus(ee.times(ve)),Q=Q.plus(ee.times(fe)),ce.s=ve.s=$e.s,Te=D(ve,fe,pe*=2,I).minus($e).abs().comparedTo(D(ce,Q,pe,I).minus($e).abs())<1?[ve,fe]:[ce,Q],ae=se,Te},O.toNumber=function(){return+Me(this)},O.toPrecision=function(j,U){return j!=null&&x(j,1,y),Oe(this,j,U,2)},O.toString=function(j){var U,Q=this,fe=Q.s,ee=Q.e;return ee===null?fe?(U="Infinity",fe<0&&(U="-"+U)):U="NaN":(U=j==null?ee<=L||V<=ee?E(b(Q.c),ee):P(b(Q.c),ee,"0"):j===10?P(b((Q=Ie(new oe(Q),A+ee+1,I)).c),Q.e,"0"):(x(j,2,Ce.length,"Base"),N(P(b(Q.c),ee,"0"),10,j,fe,!0)),fe<0&&Q.c[0]&&(U="-"+U)),U},O.valueOf=O.toJSON=function(){return Me(this)},O._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(O[Symbol.toStringTag]="BigNumber",O[Symbol.for("nodejs.util.inspect.custom")]=O.valueOf),M!=null&&oe.set(M),oe}()).default=o.BigNumber=o,n!==void 0&&n.exports?n.exports=o:(a||(a=typeof self<"u"&&self?self:window),a.BigNumber=o)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(a){var o=a%10;return~~(a%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function a(m,b){return function(S){if(Array.isArray(S))return S}(m)||function(S,x){var T=[],E=!0,P=!1,R=void 0;try{for(var M,D=S[Symbol.iterator]();!(E=(M=D.next()).done)&&(T.push(M.value),!x||T.length!==x);E=!0);}catch(N){P=!0,R=N}finally{try{E||D.return==null||D.return()}finally{if(P)throw R}}return T}(m,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(m){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},S=2<arguments.length?arguments[2]:void 0;if(typeof b=="string"&&(b=l.parseFormat(b)),!s.validateFormat(b))return"ERROR: invalid format";var x=b.prefix||"",T=b.postfix||"",E=function(P,R,M){switch(R.output){case"currency":return R=y(R,o.currentCurrencyDefaultFormat()),function(Ce,oe,Oe){var Ee=Oe.currentCurrency(),be=Object.assign({},c,oe),Ie=void 0,Me="",j=!!be.totalLength||!!be.forceAverage||be.average,U=oe.currencyPosition||Ee.position,Q=oe.currencySymbol||Ee.symbol;be.spaceSeparated&&(Me=" "),U==="infix"&&(Ie=Me+Q+Me);var fe=g({instance:Ce,providedFormat:oe,state:Oe,decimalSeparator:Ie});return U==="prefix"&&(fe=Ce._value<0&&be.negative==="sign"?"-".concat(Me).concat(Q).concat(fe.slice(1)):Q+Me+fe),U&&U!=="postfix"||(fe=fe+(Me=j?"":Me)+Q),fe}(P,R,o);case"percent":return R=y(R,o.currentPercentageDefaultFormat()),function(Ce,oe,Oe,Ee){var be=oe.prefixSymbol,Ie=g({instance:Ee(100*Ce._value),providedFormat:oe,state:Oe}),Me=Object.assign({},c,oe);return be?"%".concat(Me.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(Me.spaceSeparated?" ":"","%")}(P,R,o,M);case"byte":return R=y(R,o.currentByteDefaultFormat()),_=P,I=o,L=M,V=(A=R).base||"binary",Y=f[V],ae=d(_._value,Y.suffixes,Y.scale),re=ae.value,te=ae.suffix,ge=g({instance:L(re),providedFormat:A,state:I,defaults:I.currentByteDefaultFormat()}),H=I.currentAbbreviations(),"".concat(ge).concat(H.spaced?" ":"").concat(te);case"time":return R=y(R,o.currentTimeDefaultFormat()),k=P,w=Math.floor(k._value/60/60),C=Math.floor((k._value-60*w*60)/60),O=Math.round(k._value-60*w*60-60*C),"".concat(w,":").concat(C<10?"0":"").concat(C,":").concat(O<10?"0":"").concat(O);case"ordinal":return R=y(R,o.currentOrdinalDefaultFormat()),D=P,N=R,K=(B=o).currentOrdinal(),Z=Object.assign({},c,N),ie=g({instance:D,providedFormat:N,state:B}),me=K(D._value),"".concat(ie).concat(Z.spaceSeparated?" ":"").concat(me);case"number":default:return g({instance:P,providedFormat:R,numbro:M})}var D,N,B,K,Z,ie,me,k,w,C,O,_,A,I,L,V,Y,ae,re,te,ge,H}(m,b,S);return E=(E=x+E)+T}function d(m,b,S){var x=b[0],T=Math.abs(m);if(S<=T){for(var E=1;E<b.length;++E){var P=Math.pow(S,E),R=Math.pow(S,E+1);if(P<=T&&T<R){x=b[E],m/=P;break}}x===b[0]&&(m/=Math.pow(S,b.length-1),x=b[b.length-1])}return{value:m,suffix:x}}function v(m){for(var b="",S=0;S<m;S++)b+="0";return b}function p(m,b){return m.toString().indexOf("e")!==-1?function(S,x){var T=S.toString(),E=a(T.split("e"),2),P=E[0],R=E[1],M=a(P.split("."),2),D=M[0],N=M[1],B=N===void 0?"":N;if(0<+R)T=D+B+v(R-B.length);else{var K=".";K=+D<0?"-0".concat(K):"0".concat(K);var Z=(v(-R-1)+Math.abs(D)+B).substr(0,x);Z.length<x&&(Z+=v(x-Z.length)),T=K+Z}return 0<+R&&0<x&&(T+=".".concat(v(x))),T}(m,b):(Math.round(+"".concat(m,"e+").concat(b))/Math.pow(10,b)).toFixed(b)}function g(m){var b=m.instance,S=m.providedFormat,x=m.state,T=x===void 0?o:x,E=m.decimalSeparator,P=m.defaults,R=P===void 0?T.currentDefaults():P,M=b._value;if(M===0&&T.hasZeroFormat())return T.getZeroFormat();if(!isFinite(M))return M.toString();var D,N,B,K,Z,ie,me,k,w=Object.assign({},c,R,S),C=w.totalLength,O=C?0:w.characteristic,_=w.optionalCharacteristic,A=w.forceAverage,I=!!C||!!A||w.average,L=C?-1:I&&S.mantissa===void 0?0:w.mantissa,V=!C&&(S.optionalMantissa===void 0?L===-1:w.optionalMantissa),Y=w.trimMantissa,ae=w.thousandSeparated,re=w.spaceSeparated,te=w.negative,ge=w.forceSign,H=w.exponential,Ce="";if(I){var oe=function(j){var U=j.value,Q=j.forceAverage,fe=j.abbreviations,ee=j.spaceSeparated,pe=ee!==void 0&&ee,se=j.totalLength,ue=se===void 0?0:se,ce="",ve=Math.abs(U),de=-1;if(ve>=Math.pow(10,12)&&!Q||Q==="trillion"?(ce=fe.trillion,U/=Math.pow(10,12)):ve<Math.pow(10,12)&&ve>=Math.pow(10,9)&&!Q||Q==="billion"?(ce=fe.billion,U/=Math.pow(10,9)):ve<Math.pow(10,9)&&ve>=Math.pow(10,6)&&!Q||Q==="million"?(ce=fe.million,U/=Math.pow(10,6)):(ve<Math.pow(10,6)&&ve>=Math.pow(10,3)&&!Q||Q==="thousand")&&(ce=fe.thousand,U/=Math.pow(10,3)),ce&&(ce=(pe?" ":"")+ce),ue){var Te=U.toString().split(".")[0];de=Math.max(ue-Te.length,0)}return{value:U,abbreviation:ce,mantissaPrecision:de}}({value:M,forceAverage:A,abbreviations:T.currentAbbreviations(),spaceSeparated:re,totalLength:C});M=oe.value,Ce+=oe.abbreviation,C&&(L=oe.mantissaPrecision)}if(H){var Oe=(N=(D={value:M,characteristicPrecision:O}).value,B=D.characteristicPrecision,K=B===void 0?0:B,Z=a(N.toExponential().split("e"),2),ie=Z[0],me=Z[1],k=+ie,K&&1<K&&(k*=Math.pow(10,K-1),me=0<=(me=+me-(K-1))?"+".concat(me):me),{value:k,abbreviation:"e".concat(me)});M=Oe.value,Ce=Oe.abbreviation+Ce}var Ee,be,Ie,Me=function(j,U,Q,fe,ee){if(fe===-1)return j;var pe=p(U,fe),se=a(pe.toString().split("."),2),ue=se[0],ce=se[1],ve=ce===void 0?"":ce;if(ve.match(/^0+$/)&&(Q||ee))return ue;var de=ve.match(/0+$/);return ee&&de?"".concat(ue,".").concat(ve.toString().slice(0,de.index)):pe.toString()}(M.toString(),M,V,L,Y);return Me=function(j,U,Q,fe,ee){var pe=fe.currentDelimiters(),se=pe.thousands;ee=ee||pe.decimal;var ue=pe.thousandsSize||3,ce=j.toString(),ve=ce.split(".")[0],de=ce.split(".")[1];return Q&&(U<0&&(ve=ve.slice(1)),function(Te,Le){for(var $e=[],it=0,yt=Te;0<yt;yt--)it===Le&&($e.unshift(yt),it=0),it++;return $e}(ve.length,ue).forEach(function(Te,Le){ve=ve.slice(0,Te+Le)+se+ve.slice(Te+Le)}),U<0&&(ve="-".concat(ve))),ce=de?ve+ee+de:ve}(Me=function(j,U,Q,fe){var ee=j,pe=a(ee.toString().split("."),2),se=pe[0],ue=pe[1];if(se.match(/^-?0$/)&&Q)return ue?"".concat(se.replace("0",""),".").concat(ue):se.replace("0","");if(se.length<fe)for(var ce=fe-se.length,ve=0;ve<ce;ve++)ee="0".concat(ee);return ee.toString()}(Me,0,_,O),M,ae,T,E),(I||H)&&(Me=Me+Ce),(ge||M<0)&&(Ee=Me,Ie=te,Me=(be=M)===0?Ee:+Ee==0?Ee.replace("-",""):0<be?"+".concat(Ee):Ie==="sign"?Ee:"(".concat(Ee.replace("-",""),")")),Me}function y(m,b){if(!m)return b;var S=Object.keys(m);return S.length===1&&S[0]==="output"?b:m}n.exports=function(m){return{format:function(){for(var b=arguments.length,S=new Array(b),x=0;x<b;x++)S[x]=arguments[x];return h.apply(void 0,S.concat([m]))},getByteUnit:function(){for(var b=arguments.length,S=new Array(b),x=0;x<b;x++)S[x]=arguments[x];return function(T){var E=f.general;return d(T._value,E.suffixes,E.scale).suffix}.apply(void 0,S.concat([m]))},getBinaryByteUnit:function(){for(var b=arguments.length,S=new Array(b),x=0;x<b;x++)S[x]=arguments[x];return function(T){var E=f.binary;return d(T._value,E.suffixes,E.scale).suffix}.apply(void 0,S.concat([m]))},getDecimalByteUnit:function(){for(var b=arguments.length,S=new Array(b),x=0;x<b;x++)S[x]=arguments[x];return function(T){var E=f.decimal;return d(T._value,E.suffixes,E.scale).suffix}.apply(void 0,S.concat([m]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var a=r("./en-US"),o=r("./validating"),s=r("./parsing"),l={},u=void 0,f={},c=null,h={};function d(p){u=p}function v(){return f[u]}l.languages=function(){return Object.assign({},f)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return v().currency},l.currentAbbreviations=function(){return v().abbreviations},l.currentDelimiters=function(){return v().delimiters},l.currentOrdinal=function(){return v().ordinal},l.currentDefaults=function(){return Object.assign({},v().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),v().timeFormat)},l.setDefaults=function(p){p=s.parseFormat(p),o.validateFormat(p)&&(h=p)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(p){return c=typeof p=="string"?p:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(p){if(p){if(f[p])return f[p];throw new Error('Unknown tag "'.concat(p,'"'))}return v()},l.registerLanguage=function(p){var g=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(p))throw new Error("Invalid language data");f[p.languageTag]=p,g&&d(p.languageTag)},l.setLanguage=function(p){var g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.languageTag;if(!f[p]){var y=p.split("-")[0],m=Object.keys(f).find(function(b){return b.split("-")[0]===y});return f[m]?void d(m):void d(g)}d(p)},l.registerLanguage(a),u=a.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(a){return{loadLanguagesInNode:function(o){return s=a,void o.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,i){var a=r("bignumber.js");function o(s,l,u){var f=new a(s._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new a(c),s._value=f.minus(c).toNumber(),s}n.exports=function(s){return{add:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.plus(v).toNumber(),f;var f,c,h,d,v},subtract:function(l,u){return o(l,u,s)},multiply:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.times(v).toNumber(),f;var f,c,h,d,v},divide:function(l,u){return c=u,h=s,d=new a((f=l)._value),v=c,h.isNumbro(c)&&(v=c._value),v=new a(v),f._value=d.dividedBy(v).toNumber(),f;var f,c,h,d,v},set:function(l,u){return f=l,h=c=u,s.isNumbro(c)&&(h=c._value),f._value=h,f;var f,c,h},difference:function(l,u){return f=u,o(h=(c=s)(l._value),f,c),Math.abs(h._value);var f,c,h}}}},{"bignumber.js":1}],7:[function(r,n,i){function a(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}var o=r("./globalState"),s=r("./validating"),l=r("./loading")(p),u=r("./unformatting"),f=r("./formatting")(p),c=r("./manipulating")(p),h=r("./parsing"),d=function(){function g(b){(function(S,x){if(!(S instanceof x))throw new TypeError("Cannot call a class as a function")})(this,g),this._value=b}var y,m;return y=g,(m=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,b)}},{key:"formatCurrency",value:function(b){return typeof b=="string"&&(b=h.parseFormat(b)),(b=f.formatOrDefault(b,o.currentCurrencyDefaultFormat())).output="currency",f.format(this,b)}},{key:"formatTime",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return b.output="time",f.format(this,b)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(b){return c.difference(this,b)}},{key:"add",value:function(b){return c.add(this,b)}},{key:"subtract",value:function(b){return c.subtract(this,b)}},{key:"multiply",value:function(b){return c.multiply(this,b)}},{key:"divide",value:function(b){return c.divide(this,b)}},{key:"set",value:function(b){return c.set(this,v(b))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&a(y.prototype,m),g}();function v(g){var y=g;return p.isNumbro(g)?y=g._value:typeof g=="string"?y=p.unformat(g):isNaN(g)&&(y=NaN),y}function p(g){return new d(v(g))}p.version="2.1.2",p.isNumbro=function(g){return g instanceof d},p.language=o.currentLanguage,p.registerLanguage=o.registerLanguage,p.setLanguage=o.setLanguage,p.languages=o.languages,p.languageData=o.languageData,p.zeroFormat=o.setZeroFormat,p.defaultFormat=o.currentDefaults,p.setDefaults=o.setDefaults,p.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,p.validate=s.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,n.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(a){var o,s,l,u,f,c,h,d,v,p,g,y,m,b,S,x,T,E,P,R,M=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof a!="string"?a:(s=M,a=(l=(o=a).match(/^{([^}]*)}/))?(s.prefix=l[1],o.slice(l[0].length)):o,f=M,function(D,N){if(D.indexOf("$")===-1){if(D.indexOf("%")===-1)return D.indexOf("bd")!==-1?(N.output="byte",N.base="general"):D.indexOf("b")!==-1?(N.output="byte",N.base="binary"):D.indexOf("d")!==-1?(N.output="byte",N.base="decimal"):D.indexOf(":")===-1?D.indexOf("o")!==-1&&(N.output="ordinal"):N.output="time";N.output="percent"}else N.output="currency"}(a=(c=(u=a).match(/{([^}]*)}$/))?(f.postfix=c[1],u.slice(0,-c[0].length)):u,M),h=M,(d=a.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),v=M,(p=a.split(".")[0].match(/0+/))&&(v.characteristic=p[0].length),function(D,N){if(D.indexOf(".")!==-1){var B=D.split(".")[0];N.optionalCharacteristic=B.indexOf("0")===-1}}(a,M),g=M,a.indexOf("a")!==-1&&(g.average=!0),m=M,(y=a).indexOf("K")!==-1?m.forceAverage="thousand":y.indexOf("M")!==-1?m.forceAverage="million":y.indexOf("B")!==-1?m.forceAverage="billion":y.indexOf("T")!==-1&&(m.forceAverage="trillion"),function(D,N){var B=D.split(".")[1];if(B){var K=B.match(/0+/);K&&(N.mantissa=K[0].length)}}(a,M),S=M,(b=a).match(/\[\.]/)?S.optionalMantissa=!0:b.match(/\./)&&(S.optionalMantissa=!1),x=M,a.indexOf(",")!==-1&&(x.thousandSeparated=!0),T=M,a.indexOf(" ")!==-1&&(T.spaceSeparated=!0),P=M,(E=a).match(/^\+?\([^)]*\)$/)&&(P.negative="parenthesis"),E.match(/^\+?-/)&&(P.negative="sign"),R=M,a.match(/^\+/)&&(R.forceSign=!0),M)}}},{}],9:[function(r,n,i){var a=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,v=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function p(g,y){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=3<arguments.length?arguments[3]:void 0,S=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,T=6<arguments.length?arguments[6]:void 0;if(!isNaN(+g))return+g;var E="",P=g.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(P!==g)return-1*p(P,y,m,b,S,x,T);for(var R=0;R<a.length;R++){var M=a[R];if((E=g.replace(M.key,""))!==g)return p(E,y,m,b,S,x,T)*M.factor}if((E=g.replace("%",""))!==g)return p(E,y,m,b,S,x,T)/100;var D=parseFloat(g);if(!isNaN(D)){var N=b(D);if(N&&N!=="."&&(E=g.replace(new RegExp("".concat(o(N),"$")),""))!==g)return p(E,y,m,b,S,x,T);var B={};Object.keys(x).forEach(function(C){B[x[C]]=C});for(var K=Object.keys(B).sort().reverse(),Z=K.length,ie=0;ie<Z;ie++){var me=K[ie],k=B[me];if((E=g.replace(me,""))!==g){var w=void 0;switch(k){case"thousand":w=Math.pow(10,3);break;case"million":w=Math.pow(10,6);break;case"billion":w=Math.pow(10,9);break;case"trillion":w=Math.pow(10,12)}return p(E,y,m,b,S,x,T)*w}}}}(function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",m=p.replace(y,"");return m=(m=m.replace(new RegExp("([0-9])".concat(o(g.thousands),"([0-9])"),"g"),"$1$2")).replace(g.decimal,".")}(l,u,f),u,f,c,h,d,v)}n.exports={unformat:function(l,u){var f,c,h,d=r("./globalState"),v=d.currentDelimiters(),p=d.currentCurrency().symbol,g=d.currentOrdinal(),y=d.getZeroFormat(),m=d.currentAbbreviations(),b=void 0;if(typeof l=="string")b=function(S,x){if(!S.indexOf(":")||x.thousands===":")return!1;var T=S.split(":");if(T.length!==3)return!1;var E=+T[0],P=+T[1],R=+T[2];return!isNaN(E)&&!isNaN(P)&&!isNaN(R)}(l,v)?(f=l.split(":"),c=+f[0],h=+f[1],+f[2]+60*h+3600*c):s(l,v,p,g,y,m,u);else{if(typeof l!="number")return;b=l}if(b!==void 0)return b}}},{"./globalState":4}],10:[function(r,n,i){function a(v){return function(p){if(Array.isArray(p)){for(var g=0,y=new Array(p.length);g<p.length;g++)y[g]=p[g];return y}}(v)||function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(v)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(v,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(v){return v.output==="byte"}},characteristic:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(v){return 0<=v},message:"value must be positive"},{restriction:function(v,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(v){return 0<=v},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(v,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(v){return v.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(v){return!!s.unformat(v)}function h(v,p,g){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],m=Object.keys(v).map(function(b){if(!p[b])return console.error("".concat(g," Invalid key: ").concat(b)),!1;var S=v[b],x=p[b];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!h(S,u,"[Validate ".concat(b,"]"),!0))return!1}else if(o(S)!==x.type)return console.error("".concat(g," ").concat(b,' type mismatched: "').concat(x.type,'" expected, "').concat(o(S),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var T=x.restrictions.length,E=0;E<T;E++){var P=x.restrictions[E],R=P.restriction,M=P.message;if(!R(S,v))return console.error("".concat(g," ").concat(b," invalid value: ").concat(M)),!1}return x.restriction&&!x.restriction(S,v)?(console.error("".concat(g," ").concat(b," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(S)===-1?(console.error("".concat(g," ").concat(b," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(S,'" provided')),!1):!(x.children&&!h(S,x.children,"[Validate ".concat(b,"]")))});return y||m.push.apply(m,a(Object.keys(p).map(function(b){var S=p[b];if(typeof S=="string"&&(S={type:S}),S.mandatory){var x=S.mandatory;if(typeof x=="function"&&(x=x(v)),x&&v[b]===void 0)return console.error("".concat(g,' Missing mandatory key "').concat(b,'"')),!1}return!0}))),m.reduce(function(b,S){return b&&S},!0)}function d(v){return h(v,u,"[Validate format]")}n.exports={validate:function(v,p){var g=c(v),y=d(p);return g&&y},validateFormat:d,validateInput:c,validateLanguage:function(v){return h(v,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(QUe);const tf=x2;var e6e="numeric";function fB(e,t,r,n,i,a,o){var s=a;if(Xi(s)){var l=o.numericFormat,u=l&&l.culture||"-",f=l&&l.pattern,c=o.className||"",h=c.length?c.split(" "):[];if(typeof u<"u"&&!tf.languages()[u]){var d=u.replace("-",""),v=tf.allLanguages?tf.allLanguages[u]:tf[d];v&&tf.registerLanguage(v)}tf.setLanguage(u),s=tf(s).format(f||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),o.className=h.join(" "),t.dir="ltr"}zu(e,t,r,n,i,s,o)}fB.RENDERER_TYPE=e6e;var t6e="password";function cB(e,t,r,n,i,a,o){zu.apply(this,[e,t,r,n,i,a,o]);var s=o.hashLength||t.innerHTML.length,l=o.hashSymbol||"*",u="";rt(s-1,function(){u+=l}),lh(t,u)}cB.RENDERER_TYPE=t6e;var r6e="time";function hB(e,t,r,n,i,a,o){zu.apply(this,[e,t,r,n,i,a,o]),t.dir="ltr"}hB.RENDERER_TYPE=r6e;function n6e(){Vo(Ig),Vo(fS),Vo(lB),Vo(sB),Vo(fB),Vo(cB),Vo(zu),Vo(hB)}var i6e="autocomplete";function QO(e,t){var r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,KU(r,t)):KU(r,t)(this.source):t(!0)}QO.VALIDATOR_TYPE=i6e;function KU(e,t){var r=e;return function(n){for(var i=!1,a=0,o=n.length;a<o;a++)if(r===n[a]){i=!0;break}t(i)}}var a6e=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},o6e=gn,s6e=bO,l6e=qr,u6e=wo,f6e=Hi,XU=a6e,qU=ln,c6e=th,h6e=wO;s6e("search",function(e,t,r){return[function(i){var a=f6e(this),o=u6e(i)?void 0:c6e(i,e);return o?o6e(o,i,a):new RegExp(i)[e](qU(a))},function(n){var i=l6e(this),a=qU(n),o=r(t,i,a);if(o.done)return o.value;var s=i.lastIndex;XU(s,0)||(i.lastIndex=0);var l=h6e(i,a);return XU(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function fne(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}const d6e=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:fne},Symbol.toStringTag,{value:"Module"}));var v6e="date";function dB(e,t){var r=ate(ine,this.instance),n=e,i=!0;n==null&&(n="");var a=Ae(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=Ae(new Date(n)).isValid()||a;if(this.allowEmpty&&n===""&&(o=!0,a=!0),o||(i=!1),!o&&a&&(i=!0),o&&!a)if(this.correctFormat===!0){var s=p6e(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;t(i)}dB.VALIDATOR_TYPE=v6e;function p6e(e,t){var r=Ae(fne(e)),n=Ae(e,t),i=e.search(/[A-z]/g)>-1,a;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?a=r:a=n,a.format(t)}var g6e="numeric";function vB(e,t){var r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:Xi(e))}vB.VALIDATOR_TYPE=g6e;var y6e=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],m6e="time";function pB(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,i=e;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var a=/^\d{1,2}$/.test(i);a&&(i+=":00");var o=Ae(i,y6e,!0).isValid()?Ae(i):Ae(i,r),s=o.isValid(),l=Ae(i,r,!0).isValid()&&!a;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=o.format(r),f=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,c,u,"timeValidator"),n=!0}else n=!1;t(n)}pB.VALIDATOR_TYPE=m6e;function b6e(){xd(QO),xd(dB),xd(vB),xd(pB)}var w6e="autocomplete",S6e={CELL_TYPE:w6e,editor:aB,renderer:Ig,validator:QO},_6e="checkbox",C6e={CELL_TYPE:_6e,editor:nne,renderer:lB},x6e="date",T6e={CELL_TYPE:x6e,editor:ane,renderer:Ig,validator:dB},O6e="dropdown",E6e={CELL_TYPE:O6e,editor:oB,renderer:Ig,validator:QO},R6e="handsontable",k6e={CELL_TYPE:R6e,editor:iB,renderer:Ig},A6e="numeric",P6e={CELL_TYPE:A6e,editor:one,renderer:fB,validator:vB,dataType:"number"},I6e="password",M6e={CELL_TYPE:I6e,editor:sne,renderer:cB,copyable:!1},D6e="time",N6e={CELL_TYPE:D6e,editor:lne,renderer:hB,validator:pB};function L6e(){Za(S6e),Za(C6e),Za(T6e),Za(E6e),Za(k6e),Za(P6e),Za(M6e),Za(Qre),Za(N6e)}var F6e=vO,$6e=Kee;F6e("WeakSet",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},$6e);function hb(e){return hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hb(e)}function H6e(e,t){return W6e(e)||j6e(e,t)||V6e(e,t)||B6e()}function B6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V6e(e,t){if(e){if(typeof e=="string")return ZU(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZU(e,t)}}function ZU(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function W6e(e){if(Array.isArray(e))return e}function U6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G6e(n.key),n)}}function z6e(e,t,r){return t&&JU(e.prototype,t),r&&JU(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function G6e(e){var t=Y6e(e,"string");return hb(t)==="symbol"?t:String(t)}function Y6e(e,t){if(hb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K6e(e,t){X6e(e,t),t.add(e)}function X6e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function q6e(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var QU=new Map([["plugin",bMe],["cell-type",Wre],["editor",ite],["renderer",mte],["validator",bte]]),Z6e="base",rf=new WeakMap,xk=[],ko=null,e6=new WeakSet,er=function(){function e(t){var r=this;U6e(this,e),K6e(this,e6),as(this,"hot",t,{writable:!1}),rf.set(this,{hooks:{}}),ko=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return z6e(e,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var a=[];if(i.forEach(function(u){var f=u.split(":"),c=H6e(f,2),h=c[0],d=c[1];if(!QU.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));QU.get(h)(d)||a.push(" - ".concat(d," (").concat(h,")"))}),a.length>0){var o=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(a.join(`
`),`
`)].join("");xk.push(o)}}ko||(ko=f$()),ko.indexOf("UndoRedo")>=0&&ko.splice(ko.indexOf("UndoRedo"),1),ko.indexOf(this.pluginName)>=0&&ko.splice(ko.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=ko.length===0;if(s){if(xk.length>0){var l=["".concat(xk.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){rf.get(this).hooks[r]=rf.get(this).hooks[r]||[];var i=rf.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),rf.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;ne(rf.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=rf.get(this).hooks;It(n,function(i,a){return r.removeHooks(a)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){ne(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=q6e(this,e6,J6e).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),It(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return Z6e}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function J6e(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(var r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}function db(e){return db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},db(e)}function Q6e(e,t){return nze(e)||rze(e,t)||tze(e,t)||eze()}function eze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tze(e,t){if(e){if(typeof e=="string")return t6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t6(e,t)}}function t6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function nze(e){if(Array.isArray(e))return e}function ize(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oze(n.key),n)}}function aze(e,t,r){return t&&r6(e.prototype,t),r&&r6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oze(e){var t=sze(e,"string");return db(t)==="symbol"?t:String(t)}function sze(e,t){if(db(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(db(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lze=function(){function e(t){ize(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return aze(e,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),ne(this.rows,function(n){r(n.row,Nr(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),ne(this.columns,function(n){var i=n.table.getBoundingClientRect(),a=i.width;r(n.col,Math.ceil(a))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){ne(i.strings,function(a){n.appendChild(r.createColElement(a.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment(),o=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,o),a.appendChild(o)),this.samples.forEach(function(s){ne(s.strings,function(l){var u=l.col,f=n.hot.getCellMeta(r,u);f.col=u,f.row=r;var c=n.hot.getCellRenderer(f),h=i.createElement("td");h.setAttribute("ghost-table",1),c(n.hot,h,r,u,n.hot.colToProp(u),l.value,f),a.appendChild(h)})}),a}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),a=[];if(this.hot.hasRowHeaders()){var o=n.createElement("th");a.push([-1,o]),i.appendChild(o)}this.samples.forEach(function(s){ne(s.strings,function(l){var u=l.col,f=n.createElement("th");a.push([u,f]),i.appendChild(f)})}),this.table.tHead.appendChild(i),ne(a,function(s){var l=Q6e(s,2),u=l[0],f=l[1];r.hot.view.appendColHeader(u,f)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,a=i.createDocumentFragment();return this.samples.forEach(function(o){ne(o.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var f=n.hot.getCellRenderer(u),c=i.createElement("td"),h=i.createElement("tr");c.setAttribute("ghost-table",1),f(n.hot,c,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(c),a.appendChild(h)})}),a}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),f=n.createElement("th");return this.isVertical()&&a.appendChild(l),this.isHorizontal()&&(u.appendChild(f),o.appendChild(u),a.style.tableLayout="auto",a.style.width="auto"),a.appendChild(o),this.isVertical()&&s.appendChild(u),a.appendChild(s),ke(a,r),i.appendChild(a),{fragment:i,table:a,tHead:o,tBody:s,colGroup:l,tr:u,th:f}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),a=n.createElement("div"),o="htGhostTable htAutoSize ".concat(r.trim());return ke(a,o),i.appendChild(a),{fragment:i,container:a}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),e}();const gB=lze;function vb(e){return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vb(e)}function uze(e,t,r){return t=cne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cne(n.key),n)}}function cze(e,t,r){return t&&n6(e.prototype,t),r&&n6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cne(e){var t=hze(e,"string");return vb(t)==="symbol"?t:String(t)}function hze(e,t){if(vb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dze=function(){function e(t){fze(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return cze(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var a=this,o=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return rt(l,u,function(f){var c=a.generateSample(r,n,f);o.set(f,c)}),o}},{key:"generateSample",value:function(r,n,i){var a=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var o=new Map,s=r==="row"?"col":"row",l=[];return rt(n.from,n.to,function(u){var f=r==="row"?a.dataFactory(i,u):a.dataFactory(u,i),c=f.value,h=f.bundleSeed,d=typeof h=="string"&&h.length>0,v;d?v=h:Pt(c)?v="".concat(Object.keys(c).length):Array.isArray(c)?v="".concat(c.length):v="".concat(jr(c).length),o.has(v)||o.set(v,{needed:a.getSampleCount(),strings:[]});var p=o.get(v);if(p.needed){var g=l.indexOf(c)>-1;(!g||a.allowDuplicates||d)&&(p.strings.push(uze({value:c},s,u)),l.push(c),p.needed-=1)}}),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),e}();const hne=dze;function np(e){return np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},np(e)}function i6(e,t){return yze(e)||gze(e,t)||pze(e,t)||vze()}function vze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pze(e,t){if(e){if(typeof e=="string")return a6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a6(e,t)}}function a6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function yze(e){if(Array.isArray(e))return e}function mze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wze(n.key),n)}}function bze(e,t,r){return t&&o6(e.prototype,t),r&&o6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wze(e){var t=Sze(e,"string");return np(t)==="symbol"?t:String(t)}function Sze(e,t){if(np(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(np(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zf(){return typeof Reflect<"u"&&Reflect.get?zf=Reflect.get.bind():zf=function(t,r,n){var i=_ze(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},zf.apply(this,arguments)}function _ze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ms(e),e!==null););return e}function Cze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T2(e,t)}function T2(e,t){return T2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},T2(e,t)}function xze(e){var t=Oze();return function(){var n=Ms(e),i;if(t){var a=Ms(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Tze(this,i)}}function Tze(e,t){if(t&&(np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dne(e)}function dne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ms(e){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ms(e)}Qe.getSingleton().register("modifyAutoColumnSizeSeed");var ay="autoColumnSize",Eze=10,Tk=new WeakMap,Rze="autoColumnSize",kze=function(e){Cze(r,e);var t=xze(r);function r(n){var i;return mze(this,r),i=t.call(this,n),Tk.set(dne(i),{cachedColumnHeaders:[]}),i.ghostTable=new gB(i.hot),i.samplesGenerator=new hne(function(a,o){var s=i.hot.getCellMeta(a,o),l="";s.spanned||(l=i.hot.getDataAtCell(a,o));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new Uu,i.hot.columnIndexMapper.registerMap(Rze,i.columnWidthsMap),i.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),i}return bze(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[ay]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[ay];a&&a.useHeaders!==null&&a.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",a.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("afterFormulasValuesUpdate",function(o){return i.onAfterFormulasValuesUpdate(o)}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyColWidth",function(o,s){return i.getColumnWidth(s,o)}),this.addHook("afterInit",function(){return i.onAfterInit()}),zf(Ms(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),zf(Ms(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;zf(Ms(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(i){var a=this.hot.renderCall,o=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();o===-1||s===-1||this.calculateColumnsWidth({from:o,to:s},void 0,a)}}},{key:"calculateColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;rt(l.from,l.to,function(f){var c=i.hot.toPhysicalColumn(f);if(c===null&&(c=f),s||i.columnWidthsMap.getValueAtIndex(c)===null&&!i.hot._getColWidthFromSettings(c)){var h=i.samplesGenerator.generateColumnSamples(f,u);ne(h,function(d){var v=i6(d,2),p=v[0],g=v[1];return i.ghostTable.addColumn(p,g)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(f,c){var h=i.hot.toPhysicalColumn(f);i.columnWidthsMap.setValueAtIndex(h,c)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){e0(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=_O(c):(e0(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateColumnsWidth({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[ay],a=i&&Vr(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&Vr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[ay],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countCols()-1;return Pt(i)&&(a=i.syncLimit,QF(a)?a=l$(o,a):a>>=0),Math.min(a,o)}},{key:"getColumnWidth",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=a;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),o&&typeof s=="number"&&(s=Math.max(s,h$.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getFirstVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getFirstRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var a=i.wtTable.getLastVisibleColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}if(i.wtViewport.columnsRenderCalculator){var o=i.wtTable.getLastRenderedColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),a=Tk.get(this),o=a.cachedColumnHeaders,s=Zr(i,function(l,u,f){var c=o.length;return(c-1<f||o[f]!==u)&&l.push(f),c-1<f?o.push(u):o[f]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];a.length?this.hot.batchExecution(function(){ne(a,function(o){i.columnWidthsMap.setValueAtIndex(o,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!ra(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var a=this,o=At(i,function(s){var l=i6(s,2),u=l[1];return a.hot.toPhysicalColumn(a.hot.propToCol(u))});this.clearCache(Array.from(new Set(o)))}},{key:"onBeforeColumnResize",value:function(i,a,o){var s=i;return o&&(this.calculateColumnsWidth(a,void 0,!0),s=this.getColumnWidth(a,void 0,!1)),s}},{key:"onAfterInit",value:function(){Tk.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var a=ra(i,function(s){var l;return Xe((l=s.address)===null||l===void 0?void 0:l.col)}),o=At(a,function(s){return s.address.col});this.clearCache(Array.from(new Set(o)))}},{key:"destroy",value:function(){this.ghostTable.clean(),zf(Ms(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ay}},{key:"PLUGIN_PRIORITY",get:function(){return Eze}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(er),Gf={horizontal:"horizontal",vertical:"vertical"};function Aze(e,t,r,n){var i=r.length,a=r?r[0].length:0,o=[],s=t.row-e.row,l=t.col-e.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],f=0;f<l;f++){var c=parseInt(r[0][f],10),h=parseInt(r[i-1][f],10),d=(n==="down"?h-c:c-h)/(i-1)||0;u.push(d)}o.push(u)}if(["right","left"].indexOf(n)!==-1)for(var v=0;v<s;v++){var p=parseInt(r[v][0],10),g=parseInt(r[v][a-1],10),y=(n==="right"?g-p:p-g)/(a-1)||0;o.push([y])}return o}function Pze(e,t,r){var n,i,a;return t[0]===e[0]&&t[1]<e[1]?(a="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(a="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(a="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(a="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:a,startOfDragCoords:n,endOfDragCoords:i}}function Ize(e){var t={};return e===!0?(t.directions=Object.keys(Gf),t.autoInsertRow=!0):Pt(e)?(Xe(e.autoInsertRow)?e.direction===Gf.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Xe(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Gf)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function ip(e){return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}function Mze(e){return Lze(e)||Nze(e)||vne(e)||Dze()}function Dze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lze(e){if(Array.isArray(e))return O2(e)}function Fze(e,t){return Bze(e)||Hze(e,t)||vne(e,t)||$ze()}function $ze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vne(e,t){if(e){if(typeof e=="string")return O2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O2(e,t)}}function O2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Bze(e){if(Array.isArray(e))return e}function Vze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wze(n.key),n)}}function jze(e,t,r){return t&&s6(e.prototype,t),r&&s6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wze(e){var t=Uze(e,"string");return ip(t)==="symbol"?t:String(t)}function Uze(e,t){if(ip(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ip(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yf(){return typeof Reflect<"u"&&Reflect.get?Yf=Reflect.get.bind():Yf=function(t,r,n){var i=zze(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Yf.apply(this,arguments)}function zze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ds(e),e!==null););return e}function Gze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E2(e,t)}function E2(e,t){return E2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},E2(e,t)}function Yze(e){var t=Xze();return function(){var n=Ds(e),i;if(t){var a=Ds(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Kze(this,i)}}function Kze(e,t){if(t&&(ip(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pne(e)}function pne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ds(e){return Ds=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ds(e)}Qe.getSingleton().register("modifyAutofillRange");Qe.getSingleton().register("beforeAutofill");Qe.getSingleton().register("afterAutofill");var l6="autofill",qze=20,Zze=["fillHandle"],Jze="insert_row_below",Qze=200,eGe=function(e){Gze(r,e);var t=Yze(r);function r(n){var i;return Vze(this,r),i=t.call(this,n),i.eventManager=new Fr(pne(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return jze(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(a){return i.onAfterCellCornerMouseDown(a)}),this.addHook("afterOnCellCornerDblClick",function(a){return i.onCellCornerDblClick(a)}),this.addHook("beforeOnCellMouseOver",function(a,o){return i.onBeforeCellMouseOver(o)}),Yf(Ds(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Yf(Ds(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Yf(Ds(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,a=this.hot.getSelectedRangeLast(),o=a.getTopStartCorner(),s=o.row,l=o.col,u=a.getBottomEndCorner(),f=u.row,c=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:f,endCol:c}]),d=[],v=[],p=[];return ne(h,function(g){for(var y=g.startRow;y<=g.endRow;y+=1)d.indexOf(y)===-1&&d.push(y);for(var m=g.startCol;m<=g.endCol;m+=1)v.indexOf(m)===-1&&v.push(m)}),ne(d,function(g){var y=[];ne(v,function(m){y.push(i.hot.getCopyableData(g,m))}),p.push(y)}),p}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var a=this.hot.selection.highlight.getFill().getVisualCorners(),o=Fze(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),d=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var v=[h.row,h.col,d.row,d.col],p=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,s),Math.min(h.col,l),Math.max(d.row,u),Math.max(d.col,f)],v),g=Pze(v,p,function(k,w){return i.hot._createCellCoords(k,w)}),y=g.directionOfDrag,m=g.startOfDragCoords,b=g.endOfDragCoords;if(m&&m.row>-1&&m.col>-1){var S=this.getSelectionData(),x=c.clone(),T=this.hot._createCellRange(m,m,b),E=this.hot.runHooks("beforeAutofill",S,x,T,y);if(E===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var P=Aze(m,b,S,y),R=E,M=E;if(["up","left"].indexOf(y)>-1&&!(M.length===1&&M[0].length===0))if(R=[],y==="up")for(var D=b.row-m.row+1,N=D%M.length,B=0;B<D;B++)R.push(M[(B+(M.length-N))%M.length]);else for(var K=b.col-m.col+1,Z=K%M[0].length,ie=0;ie<M.length;ie++){R.push([]);for(var me=0;me<K;me++)R[ie].push(M[ie][(me+(M[ie].length-Z))%M[ie].length])}this.hot.populateFromArray(m.row,m.col,R,b.row,b.col,"".concat(this.pluginName,".fill"),null,y,P),this.setSelection(p),this.hot.runHooks("afterAutofill",R,x,T,y),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var a=this.hot.getSelectedRangeLast(),o=a.getBottomEndCorner(),s=i;if(this.directions.includes(Gf.vertical)&&this.directions.includes(Gf.horizontal)){var l=a.getTopStartCorner();(o.col<=i.col||l.col>=i.col)&&(s=this.hot._createCellCoords(o.row,i.col)),(o.row<i.row||l.row>i.row)&&(s=this.hot._createCellCoords(i.row,o.col))}else if(this.directions.includes(Gf.vertical))s=this.hot._createCellCoords(i.row,o.col);else if(this.directions.includes(Gf.horizontal))s=this.hot._createCellCoords(o.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var a=this.getCoordsOfDragAndDropBorders(i);a&&this.redrawBorders(a)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(Jze,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},Qze)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),a=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();i[2]<o-1&&a[2]===o-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var a=this.hot.getData(),o=this.hot.countRows(),s,l=i[2]+1;l<o;l++){for(var u=i[1];u<=i[3];u++){var f=a[l][u];if(f)return-1}var c=a[l][i[1]-1],h=a[l][i[3]+1];(c||h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,a){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(a,i[3])).commit()}},{key:"setSelection",value:function(i){var a;(a=this.hot).selectCell.apply(a,Mze(At(i,function(o){return Math.max(o,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),a=this.getIndexOfLastAdjacentFilledInRow(i);return a===-1||a===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,a),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var a=this.hot.rootDocument.documentElement,o=nn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||a.scrollTop)+Nr(this.hot.table),s=nn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||a.scrollLeft)+cr(this.hot.table);return i.clientY>o&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var a=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&a?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=Ize(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){Yf(Ds(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return l6}},{key:"PLUGIN_PRIORITY",get:function(){return qze}},{key:"SETTING_KEYS",get:function(){return[l6].concat(Zze)}}]),r}(er);function ap(e){return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function tGe(e,t){return aGe(e)||iGe(e,t)||nGe(e,t)||rGe()}function rGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nGe(e,t){if(e){if(typeof e=="string")return u6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u6(e,t)}}function u6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iGe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function aGe(e){if(Array.isArray(e))return e}function oGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lGe(n.key),n)}}function sGe(e,t,r){return t&&f6(e.prototype,t),r&&f6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lGe(e){var t=uGe(e,"string");return ap(t)==="symbol"?t:String(t)}function uGe(e,t){if(ap(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ap(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $d(){return typeof Reflect<"u"&&Reflect.get?$d=Reflect.get.bind():$d=function(t,r,n){var i=fGe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},$d.apply(this,arguments)}function fGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=vu(e),e!==null););return e}function cGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R2(e,t)}function R2(e,t){return R2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},R2(e,t)}function hGe(e){var t=pGe();return function(){var n=vu(e),i;if(t){var a=vu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dGe(this,i)}}function dGe(e,t){if(t&&(ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vGe(e)}function vGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vu(e)}var h_="autoRowSize",gGe=40,yGe="autoRowSize",mGe=function(e){cGe(r,e);var t=hGe(r);function r(n){var i;return oGe(this,r),i=t.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new gB(i.hot),i.samplesGenerator=new hne(function(a,o){var s;return a>=0?s=i.hot.getDataAtCell(a,o):a===-1&&(s=i.hot.getColHeader(o)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new Uu,i.hot.rowIndexMapper.registerMap(yGe,i.rowHeightsMap),i.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)}),i}return sGe(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[h_];return i===!0||Pt(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyRowHeight",function(a,o){return i.getRowHeight(o,a)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),$d(vu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,$d(vu(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(a,o,s){return i.onBeforeRowResize(a,o,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof a=="number"?{from:a,to:a}:a,u=typeof o=="number"?{from:o,to:o}:o;if(this.hot.getColHeader(0)!==null){var f=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(f.get(-1))}rt(l.from,l.to,function(c){if(s||i.rowHeightsMap.getValueAtIndex(c)===null){var h=i.samplesGenerator.generateRowSamples(c,u);ne(h,function(d){var v=tGe(d,2),p=v[0],g=v[1];return i.ghostTable.addRow(p,g)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(c,h){c<0?i.headerHeight=h:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(c),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},o=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function c(){if(!i.hot){e0(l),i.inProgress=!1;return}i.calculateRowsHeight({from:o,to:Math.min(o+r.CALCULATION_STEP,s)},a),o=o+r.CALCULATION_STEP+1,o<s?l=_O(c):(e0(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},f=this.getSyncCalculationLimit();this.firstCalculation&&f>=0&&(this.calculateRowsHeight({from:0,to:f},a),this.firstCalculation=!1,o=f+1),o<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[h_],a=i&&Vr(i,"samplingRatio")?i.samplingRatio:void 0,o=i&&Vr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;a&&!isNaN(a)&&this.samplesGenerator.setSampleCount(parseInt(a,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}},{key:"recalculateAllRowsHeight",value:function(){ov(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[h_],a=r.SYNC_CALCULATION_LIMIT,o=this.hot.countRows()-1;return Pt(i)&&(a=i.syncLimit,QF(a)?a=l$(o,a):a>>=0),Math.min(a,o)}},{key:"getRowHeight",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,o=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=a;return o!==null&&o>(a||0)&&(s=o),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var a=this,o=typeof i=="number"?{from:i,to:i}:i,s=o.from,l=o.to;this.hot.batchExecution(function(){rt(Math.min(s,l),Math.max(s,l),function(u){a.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!ra(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,a=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(o===-1||s===-1)){if(this.calculateRowsHeight({from:o,to:s},void 0,i),a){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-a,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,a){this.clearCacheByRange({from:i,to:a}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,a,o){var s=i;return o&&(this.calculateRowsHeight(a,void 0,!0),s=this.getRowHeight(a)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var a=null;i.length===1?a=i[0][0]:i.length>1&&(a={from:i[0][0],to:i[i.length-1][0]}),a!==null&&this.clearCacheByRange(a)}},{key:"destroy",value:function(){this.ghostTable.clean(),$d(vu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return h_}},{key:"PLUGIN_PRIORITY",get:function(){return gGe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(er);function op(e){return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},op(e)}function bGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SGe(n.key),n)}}function wGe(e,t,r){return t&&c6(e.prototype,t),r&&c6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SGe(e){var t=_Ge(e,"string");return op(t)==="symbol"?t:String(t)}function _Ge(e,t){if(op(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(op(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wm(){return typeof Reflect<"u"&&Reflect.get?wm=Reflect.get.bind():wm=function(t,r,n){var i=CGe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},wm.apply(this,arguments)}function CGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Bc(e),e!==null););return e}function xGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k2(e,t)}function k2(e,t){return k2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},k2(e,t)}function TGe(e){var t=RGe();return function(){var n=Bc(e),i;if(t){var a=Bc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return OGe(this,i)}}function OGe(e,t){if(t&&(op(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EGe(e)}function EGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bc(e){return Bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bc(e)}var gne=bre("physicallyIndexed"),kGe=gne.getListWithInsertedItems,AGe=gne.getListWithRemovedItems,PGe=function(e){xGe(r,e);var t=TGe(r);function r(){return bGe(this,r),t.call(this,function(n){return n})}return wGe(r,[{key:"insert",value:function(i,a){var o=A$(this.indexedValues,a);this.indexedValues=kGe(o,i,a,this.initValueOrFn),wm(Bc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){var a=AGe(this.indexedValues,i);this.indexedValues=k$(a,i),wm(Bc(r.prototype),"remove",this).call(this,i)}}]),r}(uh);const IGe=PGe;function sp(e){return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}function MGe(e){return FGe(e)||LGe(e)||NGe(e)||DGe()}function DGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NGe(e,t){if(e){if(typeof e=="string")return A2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A2(e,t)}}function LGe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FGe(e){if(Array.isArray(e))return A2(e)}function A2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BGe(n.key),n)}}function HGe(e,t,r){return t&&h6(e.prototype,t),r&&h6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BGe(e){var t=VGe(e,"string");return sp(t)==="symbol"?t:String(t)}function VGe(e,t){if(sp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sm(){return typeof Reflect<"u"&&Reflect.get?Sm=Reflect.get.bind():Sm=function(t,r,n){var i=jGe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Sm.apply(this,arguments)}function jGe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vc(e),e!==null););return e}function WGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P2(e,t)}function P2(e,t){return P2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},P2(e,t)}function UGe(e){var t=YGe();return function(){var n=Vc(e),i;if(t){var a=Vc(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zGe(this,i)}}function zGe(e,t){if(t&&(sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GGe(e)}function GGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vc(e){return Vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vc(e)}var yne=bre("physicallyIndexed"),KGe=yne.getListWithInsertedItems,XGe=yne.getListWithRemovedItems,qGe=function(e){WGe(r,e);var t=UGe(r);function r(){return $Ge(this,r),t.call(this,function(n){return n})}return HGe(r,[{key:"insert",value:function(i,a){var o=this;this.indexedValues=KGe(this.indexedValues,i,a,function(s,l){return o.getNextValue(l)}),Sm(Vc(r.prototype),"insert",this).call(this,i,a)}},{key:"remove",value:function(i){this.indexedValues=XGe(this.indexedValues,i),Sm(Vc(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,MGe(this.getValues()))+1+i}}]),r}(uh);const ZGe=qGe;function lp(e){return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}function JGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,e7e(n.key),n)}}function QGe(e,t,r){return t&&d6(e.prototype,t),r&&d6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function e7e(e){var t=t7e(e,"string");return lp(t)==="symbol"?t:String(t)}function t7e(e,t){if(lp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hd(){return typeof Reflect<"u"&&Reflect.get?Hd=Reflect.get.bind():Hd=function(t,r,n){var i=r7e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Hd.apply(this,arguments)}function r7e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=pu(e),e!==null););return e}function n7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I2(e,t)}function I2(e,t){return I2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},I2(e,t)}function i7e(e){var t=s7e();return function(){var n=pu(e),i;if(t){var a=pu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return a7e(this,i)}}function a7e(e,t){if(t&&(lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o7e(e)}function o7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pu(e){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pu(e)}var Ok="bindRowsWithHeaders",l7e=210,u7e="loose",f7e=new Map([["loose",IGe],["strict",ZGe]]),c7e=function(e){n7e(r,e);var t=i7e(r);function r(n){var i;return JGe(this,r),i=t.call(this,n),i.headerIndexes=null,i}return QGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ok]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[Ok];typeof a!="string"&&(a=u7e);var o=f7e.get(a);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new o),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),Hd(pu(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Hd(pu(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){Hd(pu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ok}},{key:"PLUGIN_PRIORITY",get:function(){return l7e}}]),r}(er);function up(e){return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(e)}function v6(e){return p7e(e)||v7e(e)||d7e(e)||h7e()}function h7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d7e(e,t){if(e){if(typeof e=="string")return M2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M2(e,t)}}function v7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function p7e(e){if(Array.isArray(e))return M2(e)}function M2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mne(n.key),n)}}function y7e(e,t,r){return t&&p6(e.prototype,t),r&&p6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kf(){return typeof Reflect<"u"&&Reflect.get?Kf=Reflect.get.bind():Kf=function(t,r,n){var i=m7e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Kf.apply(this,arguments)}function m7e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ns(e),e!==null););return e}function b7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D2(e,t)}function D2(e,t){return D2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},D2(e,t)}function w7e(e){var t=_7e();return function(){var n=Ns(e),i;if(t){var a=Ns(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return S7e(this,i)}}function S7e(e,t){if(t&&(up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yd(e)}function yd(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ns(e){return Ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ns(e)}function C7e(e,t,r){x7e(e,t),t.set(e,r)}function x7e(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ek(e,t,r){return t=mne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mne(e){var t=T7e(e,"string");return up(t)==="symbol"?t:String(t)}function T7e(e,t){if(up(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g6(e,t){var r=bne(e,t,"get");return O7e(e,r)}function O7e(e,t){return t.get?t.get.call(e):t.value}function Rk(e,t,r){var n=bne(e,t,"set");return E7e(e,n,r),r}function bne(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function E7e(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var kk="collapsibleColumns",R7e=290,k7e=["nestedHeaders"],Nh="collapsibleIndicator",y6=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Lh=new WeakMap,A7e=function(e){b7e(r,e);var t=w7e(r);function r(){var n;g7e(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),Ek(yd(n),"nestedHeadersPlugin",null),Ek(yd(n),"eventManager",new Fr(yd(n))),Ek(yd(n),"headerStateManager",null),C7e(yd(n),Lh,{writable:!0,value:null}),n}return y7e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[kk]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;o||gr("You need to configure the Nested Headers plugin in order to use collapsible headers."),Rk(this,Lh,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return i.onBeforeOnCellMouseDown(s,l,u)}),Kf(Ns(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),a=i.collapsibleColumns;typeof a=="boolean"?this.headerStateManager.mapState(function(o){return{collapsible:o.origColspan>1}}):Array.isArray(a)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(a))}Kf(Ns(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Rk(this,Lh,null),this.nestedHeadersPlugin=null,this.clearButtons(),Kf(Ns(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,a=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(f){f&&f.parentNode.removeChild(f)};rt(0,i-1,function(u){var f=a.childNodes[u],c=o.childNodes[u],h=s?s.childNodes[u]:null;rt(0,f.childNodes.length-1,function(d){var v=f.childNodes[d].querySelector(".".concat(Nh));l(v),c&&c.childNodes[d]&&(v=c.childNodes[d].querySelector(".".concat(Nh)),l(v)),s&&h&&h.childNodes[d]&&(v=h.childNodes[d].querySelector(".".concat(Nh)),l(v))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var a=this,o=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,f=s.headerLevel,c=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&i==="expand"||!h&&i==="collapse"))return{row:a.headerStateManager.levelToRowCoords(f),col:c}});this.toggleCollapsibleSection(o,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,a){var o=this;if(!y6.has(a))throw new Error("Unsupported action is passed (".concat(a,")."));if(Array.isArray(i)){var s=ra(i,function(g){var y=g.row;return y<0}),l=s.length>0;ne(s,function(g){var y,m=g.row,b=g.col,S=(y=o.headerStateManager.getHeaderSettings(m,b))!==null&&y!==void 0?y:{},x=S.collapsible,T=S.isCollapsed;if(!x||T&&a==="collapse"||!T&&a==="expand")return l=!1,!1});var u=[],f=[];l&&ne(s,function(g){var y=g.row,m=g.col,b=o.headerStateManager.triggerNodeModification(a,y,m),S=b.colspanCompensation,x=b.affectedColumns,T=b.rollbackModification;S>0&&(f.push.apply(f,v6(x)),u.push(T))});var c=this.getCollapsedColumns(),h=[];a==="collapse"?h=EF([].concat(v6(c),f)):a==="expand"&&(h=ra(c,function(g){return!f.includes(g)}));var d=y6.get(a),v=this.hot.runHooks(d.beforeHook,c,h,l);if(v===!1){ne(u,function(g){g()});return}this.hot.batchExecution(function(){ne(f,function(g){g6(o,Lh).setValueAtIndex(o.hot.toPhysicalColumn(g),d.hideColumn)})},!0);var p=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(d.afterHook,c,h,l,p),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return g6(this,Lh).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,a,o){var s,l=(s=this.headerStateManager.getHeaderSettings(o,i))!==null&&s!==void 0?s:{},u=l.collapsible,f=l.origColspan,c=l.isCollapsed,h=u&&f>1&&i>=this.hot.getSettings().fixedColumnsStart,d=a.querySelector(".".concat(Nh));if(h)d||(d=this.hot.rootDocument.createElement("div"),ke(d,Nh),a.querySelector("div:first-child").appendChild(d)),St(d,["collapsed","expanded"]),c?(ke(d,"collapsed"),ku(d,"+")):(ke(d,"expanded"),ku(d,"-"));else{var v;(v=d)===null||v===void 0||v.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,a){bt(i.target,Nh)&&(bt(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"collapse")):bt(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([a],"expand")),bo(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){Rk(this,Lh,null),Kf(Ns(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return kk}},{key:"PLUGIN_PRIORITY",get:function(){return R7e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[kk].concat(k7e)}}]),r}(er);function pb(e){return pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pb(e)}function m6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function P7e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m6(Object(r),!0).forEach(function(n){I7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I7e(e,t,r){return t=wne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b6(e,t){return L7e(e)||N7e(e,t)||D7e(e,t)||M7e()}function M7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D7e(e,t){if(e){if(typeof e=="string")return w6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w6(e,t)}}function w6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function L7e(e){if(Array.isArray(e))return e}function F7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wne(n.key),n)}}function $7e(e,t,r){return t&&S6(e.prototype,t),r&&S6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wne(e){var t=H7e(e,"string");return pb(t)==="symbol"?t:String(t)}function H7e(e,t){if(pb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B7e=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],V7e=!1,j7e=!0,W7e=!0,U7e=function(){function e(t,r){F7e(this,e),this.hot=t,this.sortingStates=new UO,this.sortEmptyCells=V7e,this.indicator=j7e,this.headerAction=W7e,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return $7e(e,[{key:"updateAllColumnsProperties",value:function(r){var n=this;Pt(r)&&It(r,function(i,a){B7e.includes(a)&&(n[a]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=b6(n,1),a=i[0];return a===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return Pt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var a=b6(i,2),o=a[0],s=a[1];return P7e({column:r.hot.toVisualColumn(o)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(Xe(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),e}(),Kx="asc",Xx="desc",z7e="colHeader";function G7e(e){if(Pt(e)===!1)return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[Kx,Xx].includes(r)}function Y7e(e){if(e.some(function(r){return G7e(r)===!1}))return!1;var t=e.map(function(r){var n=r.column;return n});return new Set(t).size===t.length}function _6(e){if(e!==Xx)return e===Kx?Xx:Kx}function C6(e){var t=e.querySelector(".".concat(z7e));return t}function x6(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(t.parentNode)-r.length;return n===-1}function N2(e,t,r){return e===-1&&t>=0&&Pu(r)===!1}var K7e="ascending",X7e="descending",Sne="indicatorDisabled",_ne="columnSorting",Cne="sortAction",xne=new Map([[Kx,K7e],[Xx,X7e]]);function q7e(e,t,r,n){var i=[_ne];if(n&&i.push(Cne),r===!1)return i.push(Sne),i;var a=e.getSortOrderOfColumn(t);return Xe(a)&&i.push(xne.get(a)),i}function Z7e(){return Array.from(xne.values()).concat(Cne,Sne,_ne)}function Tne(e,t,r){var n=t.locale;return function(i,a){var o=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof a=="string"&&(a=a.toLocaleLowerCase(n)),i===a?Zo:pn(i)?pn(a)?Zo:o&&e==="asc"?Hr:Br:pn(a)?o&&e==="asc"?Br:Hr:isNaN(i)&&!isNaN(a)?e==="asc"?Br:Hr:!isNaN(i)&&isNaN(a)||(isNaN(i)||isNaN(a)||(i=parseFloat(i),a=parseFloat(a)),i<a)?e==="asc"?Hr:Br:i>a?e==="asc"?Br:Hr:Zo}}var One="default";function J7e(e,t,r){return function(n,i){var a=parseFloat(n),o=parseFloat(i),s=r.sortEmptyCells;if(a===o||isNaN(a)&&isNaN(o))return Zo;if(s){if(pn(n))return e==="asc"?Hr:Br;if(pn(i))return e==="asc"?Br:Hr}return isNaN(a)?Br:isNaN(o)?Hr:a<o?e==="asc"?Hr:Br:a>o?e==="asc"?Br:Hr:Zo}}var Q7e="numeric";function e9e(e,t,r){var n=t.checkedTemplate,i=t.uncheckedTemplate,a=r.sortEmptyCells;return function(o,s){var l=pn(o),u=pn(s),f=l?i:o,c=u?i:s,h=f===i||f===n,d=c===i||c===n;if(a===!1){if(l&&u===!1)return Br;if(l===!1&&u)return Hr}return h===!1&&d?e==="asc"?Hr:Br:h&&d===!1?e==="asc"?Br:Hr:h===!1&&d===!1?Tne(e,t,r)(o,s):f===i&&c===n?e==="asc"?Hr:Br:f===n&&c===i?e==="asc"?Br:Hr:Zo}}var t9e="checkbox";function r9e(e,t,r){return function(n,i){var a=r.sortEmptyCells;if(n===i)return Zo;if(pn(n))return pn(i)?Zo:a&&e==="asc"?Hr:Br;if(pn(i))return a&&e==="asc"?Br:Hr;var o=t.dateFormat,s=Ae(n,o),l=Ae(i,o);return s.isValid()?l.isValid()?l.isAfter(s)?e==="asc"?Hr:Br:l.isBefore(s)?e==="asc"?Br:Hr:Zo:Hr:Br}}var n9e="date",yB=Ha("sorting.compareFunctionFactory"),eE=yB.register,T6=yB.getItem,i9e=yB.hasItem,Ene=Ha("sorting.mainSortComparator"),Rne=Ene.register,a9e=Ene.getItem;function kne(e){return i9e(e)?T6(e):T6(One)}eE(Q7e,J7e);eE(t9e,e9e);eE(n9e,r9e);eE(One,Tne);var Zo=0,Hr=-1,Br=1;function o9e(e,t){for(var r=a9e(t),n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];e.sort(r.apply(void 0,i))}function O6(e){return f9e(e)||u9e(e)||l9e(e)||s9e()}function s9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l9e(e,t){if(e){if(typeof e=="string")return E6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E6(e,t)}}function E6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function f9e(e){if(Array.isArray(e))return e}function c9e(e,t){return function(r,n){var i=O6(r),a=i.slice(1),o=O6(n),s=o.slice(1);return function(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.columnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:kne(c.type),g=p(f,c,v)(h,d);return g}(0)}}function fp(e){return fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fp(e)}var h9e=["column"],d9e=["column"];function Fh(e){return y9e(e)||g9e(e)||p9e(e)||v9e()}function v9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p9e(e,t){if(e){if(typeof e=="string")return L2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L2(e,t)}}function g9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function y9e(e){if(Array.isArray(e))return L2(e)}function L2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function k6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R6(Object(r),!0).forEach(function(n){m9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m9e(e,t,r){return t=Ane(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A6(e,t){if(e==null)return{};var r=b9e(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function b9e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function w9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ane(n.key),n)}}function S9e(e,t,r){return t&&P6(e.prototype,t),r&&P6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ane(e){var t=_9e(e,"string");return fp(t)==="symbol"?t:String(t)}function _9e(e,t){if(fp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xf(){return typeof Reflect<"u"&&Reflect.get?Xf=Reflect.get.bind():Xf=function(t,r,n){var i=C9e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Xf.apply(this,arguments)}function C9e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ls(e),e!==null););return e}function x9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F2(e,t)}function F2(e,t){return F2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},F2(e,t)}function T9e(e){var t=R9e();return function(){var n=Ls(e),i;if(t){var a=Ls(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return O9e(this,i)}}function O9e(e,t){if(t&&(fp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E9e(e)}function E9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ls(e){return Ls=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ls(e)}var $2="columnSorting",k9e=50,I6="append",A9e="replace";Rne($2,c9e);Qe.getSingleton().register("beforeColumnSort");Qe.getSingleton().register("afterColumnSort");var Pne=function(e){x9e(r,e);var t=T9e(r);function r(n){var i;return w9e(this,r),i=t.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=$2,i.indexesSequenceCache=null,i}return S9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new U7e(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Uu(function(a){var o=i.hot.toVisualColumn(a);return o===null&&(o=a),i.getMergedPluginSettings(o)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(a,o){return i.onAfterOnCellMouseDown(a,o)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),Xf(Ls(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,a=function(s,l){var u=C6(l);x6(s,l)===!1||u===null||i.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",a)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Xf(Ls(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var a=this.getSortConfig(),o=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(o),l=this.hot.runHooks("beforeColumnSort",a,o,s);l!==!1&&(a.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new wre),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",a,s?o:a,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return Xe(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var a=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(a)&&this.columnStatesManager.setSortStates(a)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var a=this.hot.countCols();return Y7e(i)&&i.every(function(o){var s=o.column;return s<=a&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var a=this,o=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var f=u.column,c=A6(u,h9e);return k6({column:a.hot.toPhysicalColumn(f)},c)};o.initialConfig=At(i,s),this.hot.runHooks("persistentStateSave","columnSorting",o)}},{key:"getAllSavedSortSettings",value:function(){var i=this,a={};this.hot.runHooks("persistentStateLoad","columnSorting",a);var o=a.value,s=function(u){var f=u.column,c=A6(u,d9e);return k6({column:i.hot.toVisualColumn(f)},c)};return Xe(o)&&Array.isArray(o.initialConfig)&&(o.initialConfig=At(o.initialConfig,s)),o}},{key:"getColumnNextConfig",value:function(i){var a=this.columnStatesManager.getSortOrderOfColumn(i);if(Xe(a)){var o=_6(a);return Xe(o)?{column:i,sortOrder:o}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:_6()}}},{key:"getNextSortConfig",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:I6,o=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=o!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(i);if(s){if(pr(u))return[].concat(Fh(l.slice(0,o)),Fh(l.slice(o+1)));if(a===I6)return[].concat(Fh(l.slice(0,o)),Fh(l.slice(o+1)),[u]);if(a===A9e)return[].concat(Fh(l.slice(0,o)),[u],Fh(l.slice(o+1)))}return Xe(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(i){if(Pt(i)){var a=i[this.pluginKey];if(Pt(a))return a}return{}}},{key:"getMergedPluginSettings",value:function(i){var a=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns[i])):br(l.columns)?Object.assign(o,a,this.getPluginColumnConfig(l.columns(i))):Object.assign(o,a)}},{key:"getFirstCellSettings",value:function(i){var a=this.hot.getCellMeta(0,i),o=Object.create(a);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),o}},{key:"getNumberOfRowsToSort",value:function(i){var a=this.hot.getSettings();return a.maxRows<=i?a.maxRows:i-a.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var a=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var o=[],s=this.hot.countRows(),l=function(g){return At(i,function(y){return a.hot.getDataAtCell(g,y.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)o.push([this.hot.toPhysicalRow(u)].concat(l(u)));var f=At(o,function(p){return p[0]});o9e(o,this.pluginKey,At(i,function(p){return p.sortOrder}),At(i,function(p){return a.getFirstCellSettings(p.column)}));for(var c=o.length;c<s;c+=1)o.push([c].concat(l(c)));var h=At(o,function(p){return p[0]}),d=new Map(At(f,function(p,g){return[p,h[g]]})),v=At(this.hot.rowIndexMapper.getIndexesSequence(),function(p){return d.has(p)?d.get(p):p});this.hot.rowIndexMapper.setIndexesSequence(v)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(Pt(i))this.sortBySettings(i);else{var a=this.hot.getSettings()[this.pluginKey];this.sortBySettings(a)}}},{key:"sortBySettings",value:function(i){if(Pt(i)){this.columnStatesManager.updateAllColumnsProperties(i);var a=i.initialConfig;(Array.isArray(a)||Pt(a))&&this.sort(a)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,a){var o=C6(a);if(!(x6(i,a)===!1||o===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(o,this.columnStatesManager,i,l,u)}}},{key:"updateHeaderClasses",value:function(i){if(St(i,Z7e()),this.enabled!==!1){for(var a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];ke(i,q7e.apply(void 0,o))}}},{key:"onUpdateSettings",value:function(i){Xf(Ls(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Xe(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,a){var o=this.getFirstCellSettings(a)[this.pluginKey],s=o.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){N2(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){N2(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(a.col)),this.sort(this.getColumnNextConfig(a.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Xf(Ls(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $2}},{key:"PLUGIN_PRIORITY",get:function(){return k9e}}]),r}(er),P9e=pt,mB=Mt,I9e=Wu,M9e=BJ,D9e=$Q,M6=Tt,N9e=RangeError,Ine=String,Mne=Math.floor,H2=mB(D9e),D6=mB("".slice),oy=mB(1 .toFixed),Td=function(e,t,r){return t===0?r:t%2===1?Td(e,t-1,r*e):Td(e*e,t/2,r)},L9e=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},$h=function(e,t,r){for(var n=-1,i=r;++n<6;)i+=t*e[n],e[n]=i%1e7,i=Mne(i/1e7)},Ak=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=Mne(n/t),n=n%t*1e7},N6=function(e){for(var t=6,r="";--t>=0;)if(r!==""||t===0||e[t]!==0){var n=Ine(e[t]);r=r===""?n:r+H2("0",7-n.length)+n}return r},F9e=M6(function(){return oy(8e-5,3)!=="0.000"||oy(.9,0)!=="1"||oy(1.255,2)!=="1.25"||oy(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!M6(function(){oy({})});P9e({target:"Number",proto:!0,forced:F9e},{toFixed:function(t){var r=M9e(this),n=I9e(t),i=[0,0,0,0,0,0],a="",o="0",s,l,u,f;if(n<0||n>20)throw N9e("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return Ine(r);if(r<0&&(a="-",r=-r),r>1e-21)if(s=L9e(r*Td(2,69,1))-69,l=s<0?r*Td(2,-s,1):r/Td(2,s,1),l*=4503599627370496,s=52-s,s>0){for($h(i,0,l),u=n;u>=7;)$h(i,1e7,0),u-=7;for($h(i,Td(10,u,1),0),u=s-1;u>=23;)Ak(i,1<<23),u-=23;Ak(i,1<<u),$h(i,1,1),Ak(i,2),o=N6(i)}else $h(i,0,l),$h(i,1<<-s,0),o=N6(i)+H2("0",n);return n>0?(f=o.length,o=a+(f<=n?"0."+H2("0",n-f)+o:D6(o,0,f-n)+"."+D6(o,f-n))):o=a+o,o}});function gb(e){return gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gb(e)}function $9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B9e(n.key),n)}}function H9e(e,t,r){return t&&L6(e.prototype,t),r&&L6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function B9e(e){var t=V9e(e,"string");return gb(t)==="symbol"?t:String(t)}function V9e(e,t){if(gb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j9e=function(){function e(t,r){$9e(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return H9e(e,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],a=r;if(!a&&typeof this.settings=="function"){this.settingsType="function";return}return a||(a=this.settings),ne(a,function(o){var s={};n.assignSetting(o,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(o,s,"reversedRowCoords",!1),n.assignSetting(o,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(o,s,"sourceColumn",o.destinationColumn),n.assignSetting(o,s,"type","sum"),n.assignSetting(o,s,"forceNumeric",!1),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"suppressDataTypeErrors",!0),n.assignSetting(o,s,"customFunction",null),n.assignSetting(o,s,"readOnly",!0),n.assignSetting(o,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(r,n,i,a){if(i==="ranges"&&r[i]===void 0){n[i]=a;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(a instanceof Error)throw a;n[i]=a}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var a=r.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();ne(o,function(s){a==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=i:r==="remove_row"&&(s.alterRowOffset=-1*i)),a==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=i:r==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,a,o){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function p(){return s.hot.removeHook("beforeViewRender",p),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var f=r.indexOf("row")>-1?"row":"col",c=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,v=n;ne(h,function(p){f==="row"&&p.destinationRow>=v&&(p.alterRowOffset=c*i),f==="col"&&p.destinationColumn>=v&&(p.alterColumnOffset=c*i)}),this.resetAllEndpoints(h,!d),d?ne(h,function(p){s.extendEndpointRanges(p,v,a[0],a.length),s.recreatePhysicalRanges(p),s.clearOffsetInformation(p)}):ne(h,function(p){s.shiftEndpointCoordinates(p,v)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,a){ne(r.ranges,function(o){o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=a:i<o[0]&&(o[0]-=a):i>=o[0]&&i<=o[1]&&(o[1]-=a,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,a=[],o=[];ne(i,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));o.push(l)}),ne(o,function(s){var l=[];ne(s,function(u,f){f===0?l.push(u):s[f]!==s[f-1]+1&&(l.push(s[f-1]),a.push(l),l=[],l.push(u)),f===s.length-1&&(l.push(u),a.push(l))})}),r.ranges=a}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,ne(r.ranges,function(i){ne(i,function(a,o){a>=n&&(i[o]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=n.some(function(o){var s=o.alterRowOffset||0,l=o.alterColumnOffset||0;return o.destinationRow+s>=r.hot.countRows()||o.destinationColumn+l>=r.hot.countCols()});a||(this.cellsToSetCache=[],ne(n,function(o){r.resetEndpointValue(o,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],ne(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],ne(r,function(a,o,s){"".concat(a[2]||"")!=="".concat(a[3])&&ne(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[o][1])===l.sourceColumn&&i.indexOf(u)===-1&&i.push(u)})}),ne(i,function(a){n.refreshEndpoint(n.getEndpoint(a))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,a=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?a:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var o=this.hot.toVisualRow(r.destinationRow);if(o!==null){var s=this.hot.getCellMeta(o,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(a,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([a,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){gr("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();const W9e=j9e;function Pk(e){return e==null||isNaN(e)}function cp(e){return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}var F6;function U9e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function z9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y9e(n.key),n)}}function G9e(e,t,r){return t&&$6(e.prototype,t),r&&$6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y9e(e){var t=K9e(e,"string");return cp(t)==="symbol"?t:String(t)}function K9e(e,t){if(cp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vC(){return typeof Reflect<"u"&&Reflect.get?vC=Reflect.get.bind():vC=function(t,r,n){var i=X9e(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},vC.apply(this,arguments)}function X9e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=hp(e),e!==null););return e}function q9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B2(e,t)}function B2(e,t){return B2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},B2(e,t)}function Z9e(e){var t=eYe();return function(){var n=hp(e),i;if(t){var a=hp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return J9e(this,i)}}function J9e(e,t){if(t&&(cp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q9e(e)}function Q9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hp(e){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hp(e)}var Ik="columnSummary",tYe=220,rYe=function(e){q9e(r,e);var t=Z9e(r);function r(n){var i;return z9e(this,r),i=t.call(this,n),i.endpoints=null,i}return G9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ik]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[Ik],this.endpoints=new W9e(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",a,o,null,s)}),this.addHook("beforeCreateCol",function(a,o,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",a,o,null,s)}),this.addHook("beforeRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupBeforeStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",a,o,null,s)}),this.addHook("afterCreateCol",function(a,o,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",a,o,null,s)}),this.addHook("afterRemoveRow",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var a,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=i.endpoints).resetSetupAfterStructureAlteration.apply(a,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),vC(hp(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var a=this,o=0;return It(i.ranges,function(s){o+=a.getPartialSum(s,i.sourceColumn)}),o}},{key:"getPartialSum",value:function(i,a){var o=0,s=i[1]||i[0],l=null,u=0;do{if(l=this.getCellValue(s,a),l=Pk(l)?null:l,l!==null){var f=("".concat(l).split(".")[1]||[]).length||1;f>u&&(u=f)}o+=l||0,s-=1}while(s>=i[0]);return Math.round(o*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(i,a){var o=this,s=null;return It(i.ranges,function(l){var u=o.getPartialMinMax(l,i.sourceColumn,a);if(s===null&&u!==null&&(s=u),u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,a,o){var s=null,l=i[1]||i[0],u;do{if(u=this.getCellValue(l,a),u=Pk(u)?null:u,s===null)s=u;else if(u!==null)switch(o){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,a){var o,s=0,l=i[1]||i[0];do o=this.getCellValue(l,a),o=Pk(o)?null:o,o===null&&(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var a=this,o=0,s=i.ranges;return It(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,f=a.countEmpty(l,i.sourceColumn);o+=u,o-=f}),o}},{key:"calculateAverage",value:function(i){var a=this.calculateSum(i),o=this.countEntries(i);return a/o}},{key:"getCellValue",value:function(i,a){var o=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(a),l=this.hot.getSourceDataAtCell(i,a),u="";if(o!==null&&s!==null&&(u=this.hot.getCellMeta(o,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(sr(F6||(F6=U9e(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,a));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,a){i&&a!=="ColumnSummary.reset"&&a!=="ColumnSummary.set"&&a!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,a){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",a,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return Ik}},{key:"PLUGIN_PRIORITY",get:function(){return tYe}}]),r}(er);function yb(e){return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yb(e)}function nYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aYe(n.key),n)}}function iYe(e,t,r){return t&&H6(e.prototype,t),r&&H6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aYe(e){var t=oYe(e,"string");return yb(t)==="symbol"?t:String(t)}function oYe(e,t){if(yb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sYe=function(){function e(t,r){nYe(this,e),this.rootDocument=t,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return iYe(e,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:cr(this.getInputElement()),height:Nr(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ke(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ke(r,e.CLASS_EDITOR),ke(n,e.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),e}();const lYe=sYe;var Lt="---------";function uYe(){return{name:Lt}}function fYe(e){return At(e,function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}})}function d_(e){return bt(e,"htSeparator")}function cYe(e){return bt(e,"htSubmenu")}function v_(e){return bt(e,"htDisabled")}function p_(e){return bt(e,"htSelectionDisabled")}function ch(e){var t=e.getSelected();return!t||t[0]<0?null:t}function hYe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function dYe(e,t){if(e.indexOf(t)!==-1)return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function nf(e,t){var r={};return ne(e,function(n){n.forAll(function(i,a){i>=0&&a>=0&&(r[i]||(r[i]=[]),r[i][a]=t(i,a))})}),r}function Gl(e,t,r,n,i){ne(e,function(a){a.forAll(function(o,s){o>=0&&s>=0&&vYe(o,s,t,r,n,i)})})}function vYe(e,t,r,n,i,a){var o=i(e,t),s=n;o.className&&(r==="vertical"?s=hYe(o.className,n):s=dYe(o.className,n)),a(e,t,"className",s)}function Wo(e,t){var r=!1;return Array.isArray(e)&&ne(e,function(n){return n.forAll(function(i,a){if(i>=0&&a>=0&&t(i,a))return r=!0,!1}),r}),r}function xs(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function pYe(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function Dne(e,t){for(var r=e.slice(0),n=0;n<r.length&&r[n].name===t;)r.shift();return r}function gYe(e,t){var r=e.slice(0);return r.reverse(),r=Dne(r,t),r.reverse(),r}function yYe(e){var t=[];return ne(e,function(r,n){n>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function mYe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lt,r=e.slice(0);return r=Dne(r,t),r=gYe(r,t),r=yYe(r),r}function mb(e){return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mb(e)}function bYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SYe(n.key),n)}}function wYe(e,t,r){return t&&B6(e.prototype,t),r&&B6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function SYe(e){var t=_Ye(e,"string");return mb(t)==="symbol"?t:String(t)}function _Ye(e,t){if(mb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CYe=250,xYe=250,Nne=function(){function e(t){bYe(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return wYe(e,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},xYe)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:CYe;this.showDebounced=i$(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();yr(Nne,Vi);const TYe=Nne;function dp(e){return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dp(e)}function Mk(e,t,r){return t=Lne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lne(n.key),n)}}function EYe(e,t,r){return t&&V6(e.prototype,t),r&&V6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lne(e){var t=RYe(e,"string");return dp(t)==="symbol"?t:String(t)}function RYe(e,t){if(dp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qf(){return typeof Reflect<"u"&&Reflect.get?qf=Reflect.get.bind():qf=function(t,r,n){var i=kYe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},qf.apply(this,arguments)}function kYe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Fs(e),e!==null););return e}function AYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V2(e,t)}function V2(e,t){return V2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},V2(e,t)}function PYe(e){var t=MYe();return function(){var n=Fs(e),i;if(t){var a=Fs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return IYe(this,i)}}function IYe(e,t){if(t&&(dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fne(e)}function Fne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fs(e){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fs(e)}var Dk="comments",DYe=60,g_=new WeakMap,Ao="comment",Hh="value",j6="style",y_="readOnly",NYe=function(e){AYe(r,e);var t=PYe(r);function r(n){var i;return OYe(this,r),i=t.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,g_.set(Fne(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return EYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Dk]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new lYe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Fr(this)),this.displaySwitch||(this.displaySwitch=new TYe(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(a){return i.addToContextMenu(a)}),this.addHook("afterRenderer",function(a,o,s,l,u,f){return i.onAfterRenderer(a,f)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(a,o){return i.showAtCell(a,o)}),this.registerListeners(),qf(Fs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),qf(Fs(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){qf(Fs(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,a=this.hot.rootDocument;this.eventManager.addEventListener(a,"mouseover",function(o){return i.onMouseOver(o)}),this.eventManager.addEventListener(a,"mousedown",function(o){return i.onMouseDown(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(o){return i.onEditorMouseDown(o)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(o){return i.onEditorMouseUp(o)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var a=cu(i.target,"TD","TBODY");return!!(a&&bt(a,"htCommentCell")&&cu(a,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.editor.getValue(),o="";i!=null?o=i:a!=null&&(o=a);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,Mk({},Hh,o)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,a,o){this.setRange({from:this.hot._createCellCoords(i,a)}),this.setComment(o)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ao),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,a)}),this.removeComment(o)}},{key:"getComment",value:function(){var i=this.range.from.row,a=this.range.from.col;return this.getCommentMeta(i,a,Hh)}},{key:"getCommentAtCell",value:function(i,a){return this.getCommentMeta(i,a,Hh)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,a=i.row,o=i.col;if(a<0||a>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[Ao]?s[Ao][Hh]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,a){return this.setRange({from:this.hot._createCellCoords(i,a)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,a,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!o&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,f=this.range.from,c=f.row,h=f.col,d=l.getRenderableFromVisualIndex(c),v=u.getRenderableFromVisualIndex(h),p=d===null;this.editor.setPosition(0,0),d===null&&(d=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,-1))),v===null&&(v=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var g=d===null,y=v===null;d=(i=d)!==null&&i!==void 0?i:0,v=(a=v)!==null&&a!==void 0?a:0;var m=this.hot,b=m.rootWindow,S=m.view._wt,x=S.wtTable,T=S.getCell({row:d,col:v},!0),E=this.getCommentMeta(c,h,j6);E?this.editor.setSize(E.width,E.height):this.editor.resetSize();var P=y?0:x.getStretchedColumnWidth(v),R=p&&!g?Nr(T):0,M=T.getBoundingClientRect(),D=M.left,N=M.top,B=M.width,K=M.height,Z=this.editor.getSize(),ie=Z.width,me=Z.height,k=this.hot.rootWindow,w=k.innerWidth,C=k.innerHeight,O=this.hot.rootDocument.documentElement,_=D+b.scrollX+P,A=N+b.scrollY+R;this.hot.isRtl()&&(_-=ie+P),this.hot.isLtr()&&D+B+ie>w?_=D+b.scrollX-ie-1:this.hot.isRtl()&&_<-(O.scrollWidth-O.clientWidth)&&(_=D+b.scrollX+P+1),N+me>C&&(A-=me-K+1),this.editor.setPosition(_,A),this.editor.setReadOnlyState(this.getCommentMeta(c,h,y_))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var a=!1,o=i.getTopStartCorner();return this.getCommentMeta(o.row,o.col,Hh)&&(a=!0),a}},{key:"updateCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a)[Ao],l;s?(l=Xn(s),Yw(l,o)):l=o,this.hot.setCellMeta(i,a,Ao,l)}},{key:"getCommentMeta",value:function(i,a,o){var s=this.hot.getCellMeta(i,a);if(s[Ao])return s[Ao][o]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var a=cu(i.target,"TD","TBODY"),o=null;a&&(o=this.hot.getCoords(a)),(!a||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var a=g_.get(this),o=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||bt(i.target,"wtBorder")||a.cellBelowCursor===i.target||!this.editor))if(a.cellBelowCursor=o.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var s=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(s)}else hu(i.target,o)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,a){a[Ao]&&a[Ao][Hh]&&ke(i,a.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var a=g_.get(this);a.tempEditorDimensions={width:cr(i.target),height:Nr(i.target)}}},{key:"onEditorMouseUp",value:function(i){var a=g_.get(this),o=cr(i.target),s=Nr(i.target);(o!==a.tempEditorDimensions.width+1||s!==a.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Mk({},j6,{width:o,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){o>=0&&s>=0&&i.removeCommentAtCell(o,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,a=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,a.forAll(function(o,s){if(o>=0&&s>=0){var l=!!i.getCommentMeta(o,s,y_);i.updateCommentMeta(o,s,Mk({},y_,!l))}})}},{key:"addToContextMenu",value:function(i){var a=this,o=function(){return a.hot.rowIndexMapper.getRenderableIndexesLength()>0&&a.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return a.checkSelectionCommentsConsistency()?a.hot.getTranslatedPhrase(Q$):a.hot.getTranslatedPhrase(J$)},callback:function(){return a.onContextMenuAddComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(eH)},callback:function(){return a.onContextMenuRemoveComment()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(tH),f=Wo(this.getSelectedRangeLast(),function(c,h){var d=l.getCellMeta(c,h)[Ao];if(d&&(d=d[y_]),d)return!0});return f&&(u=xs(u)),u},callback:function(){return a.onContextMenuMakeReadOnly()},disabled:function(){return o()?!(a.hot.getSelectedLast()&&!a.hot.selection.isSelectedByCorner())||!a.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[Dk];if(Pt(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),qf(Fs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Dk}},{key:"PLUGIN_PRIORITY",get:function(){return DYe}}]),r}(er);function bb(e){return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bb(e)}function LYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ye(n.key),n)}}function FYe(e,t,r){return t&&W6(e.prototype,t),r&&W6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ye(e){var t=HYe(e,"string");return bb(t)==="symbol"?t:String(t)}function HYe(e,t){if(bb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BYe=function(){function e(t){LYe(this,e),this.hot=t,this.commands={},this.commonCallback=null}return FYe(e,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,f=this.commands[l];if(!f)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&f.submenu&&(f=VYe(u,f.submenu.items)),f.disabled!==!0&&!(typeof f.disabled=="function"&&f.disabled.call(this.hot)===!0)&&!Vr(f,"submenu")){var c=[];typeof f.callback=="function"&&c.push(f.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),a.unshift(s.join(":")),ne(c,function(h){return h.apply(n.hot,a)})}}}]),e}();function VYe(e,t){var r;return ne(t,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===e)return r=n,!1}),r}const $ne=BYe;var ba="alignment";function jYe(){return{key:ba,name:function(){return this.getTranslatedPhrase(rH)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(ba,":left"),name:function(){var t=this,r=this.getTranslatedPhrase(nH),n=Wo(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htLeft")!==-1)return!0});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=nf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htLeft";this.runHooks("beforeCellAlignment",n,r,i,a),Gl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":center"),name:function(){var t=this,r=this.getTranslatedPhrase(iH),n=Wo(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htCenter")!==-1)return!0});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=nf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htCenter";this.runHooks("beforeCellAlignment",n,r,i,a),Gl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":right"),name:function(){var t=this,r=this.getTranslatedPhrase(aH),n=Wo(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htRight")!==-1)return!0});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=nf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htRight";this.runHooks("beforeCellAlignment",n,r,i,a),Gl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":justify"),name:function(){var t=this,r=this.getTranslatedPhrase(oH),n=Wo(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htJustify")!==-1)return!0});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=nf(r,function(o,s){return t.getCellMeta(o,s).className}),i="horizontal",a="htJustify";this.runHooks("beforeCellAlignment",n,r,i,a),Gl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{name:Lt},{key:"".concat(ba,":top"),name:function(){var t=this,r=this.getTranslatedPhrase(sH),n=Wo(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htTop")!==-1)return!0});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=nf(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htTop";this.runHooks("beforeCellAlignment",n,r,i,a),Gl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":middle"),name:function(){var t=this,r=this.getTranslatedPhrase(lH),n=Wo(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htMiddle")!==-1)return!0});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=nf(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,a),Gl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ba,":bottom"),name:function(){var t=this,r=this.getTranslatedPhrase(uH),n=Wo(this.getSelectedRange(),function(i,a){var o=t.getCellMeta(i,a).className;if(o&&o.indexOf("htBottom")!==-1)return!0});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=nf(r,function(o,s){return t.getCellMeta(o,s).className}),i="vertical",a="htBottom";this.runHooks("beforeCellAlignment",n,r,i,a),Gl(r,i,a,function(o,s){return t.getCellMeta(o,s)},function(o,s,l,u){return t.setCellMeta(o,s,l,u)}),this.render()},disabled:!1}]}}}var tE="clear_column";function WYe(){return{key:tE,name:function(){return this.getTranslatedPhrase(j$)},callback:function(t,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var t=ch(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var cS="col_left";function UYe(){return{key:cS,name:function(){return this.getTranslatedPhrase(N$)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ch(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var hS="col_right";function zYe(){return{key:hS,name:function(){return this.getTranslatedPhrase(L$)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ch(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var dS="make_read_only";function GYe(){return{key:dS,name:function(){var t=this,r=this.getTranslatedPhrase(V$),n=Wo(this.getSelectedRange(),function(i,a){return t.getCellMeta(i,a).readOnly});return n&&(r=xs(r)),r},callback:function(){var t=this,r=this.getSelectedRange(),n=Wo(r,function(i,a){return t.getCellMeta(i,a).readOnly});ne(r,function(i){i.forAll(function(a,o){a>=0&&o>=0&&t.setCellMeta(a,o,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var rE="redo";function YYe(){return{key:rE,name:function(){return this.getTranslatedPhrase(B$)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function KYe(e,t){return JYe(e)||ZYe(e,t)||qYe(e,t)||XYe()}function XYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qYe(e,t){if(e){if(typeof e=="string")return U6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U6(e,t)}}function U6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZYe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function JYe(e){if(Array.isArray(e))return e}var vS="remove_col";function QYe(){return{key:vS,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=KYe(t[0],4),i=n[1],a=n[3];i-a!==0&&(r=1)}return this.getTranslatedPhrase($$,r)},callback:function(){this.alter("remove_col",fje(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=ch(this);if(!t)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function eKe(e,t){return iKe(e)||nKe(e,t)||rKe(e,t)||tKe()}function tKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rKe(e,t){if(e){if(typeof e=="string")return z6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z6(e,t)}}function z6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nKe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function iKe(e){if(Array.isArray(e))return e}var nE="remove_row";function aKe(){return{key:nE,name:function(){var t=this.getSelected(),r=0;if(t)if(t.length>1)r=1;else{var n=eKe(t[0],3),i=n[0],a=n[2];i-a!==0&&(r=1)}return this.getTranslatedPhrase(F$,r)},callback:function(){this.alter("remove_row",cje(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=ch(this);if(!t)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var iE="row_above";function oKe(){return{key:iE,name:function(){return this.getTranslatedPhrase(M$)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=ch(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var aE="row_below";function sKe(){return{key:aE,name:function(){return this.getTranslatedPhrase(D$)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=ch(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var wb="no_items";function lKe(){return{key:wb,name:function(){return this.getTranslatedPhrase(I$)},disabled:!0,isCommand:!1}}var oE="undo";function uKe(){return{key:oE,name:function(){return this.getTranslatedPhrase(H$)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Sb(e){return Sb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sb(e)}var ni;function ji(e,t,r){return t=fKe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fKe(e){var t=cKe(e,"string");return Sb(t)==="symbol"?t:String(t)}function cKe(e,t){if(Sb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hKe=[iE,aE,cS,hS,tE,nE,vS,oE,rE,dS,ba,Lt,wb],dKe=(ni={},ji(ni,Lt,uYe),ji(ni,wb,lKe),ji(ni,iE,oKe),ji(ni,aE,sKe),ji(ni,cS,UYe),ji(ni,hS,zYe),ji(ni,tE,WYe),ji(ni,nE,aKe),ji(ni,vS,QYe),ji(ni,oE,uKe),ji(ni,rE,YYe),ji(ni,dS,GYe),ji(ni,ba,jYe),ni);function Hne(){var e={};return It(dKe,function(t,r){e[r]=t()}),e}function _b(e){return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_b(e)}function vKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gKe(n.key),n)}}function pKe(e,t,r){return t&&G6(e.prototype,t),r&&G6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gKe(e){var t=yKe(e,"string");return _b(t)==="symbol"?t:String(t)}function yKe(e,t){if(_b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mKe=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;vKe(this,e),this.hot=t,this.predefinedItems=Hne(),this.defaultOrderPattern=r}return pKe(e,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,It(r,function(a,o){var s="";a.name===Lt?(i[Lt]=a,s=Lt):isNaN(parseInt(o,10))?(a.key=a.key===void 0?o:a.key,i[o]=a,s=a.key):(i[a.key]=a,s=a.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return bKe(r,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function bKe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=e;return i&&i.items?i=i.items:Array.isArray(i)||(i=t),Pt(i)?It(i,function(a,o){var s=r[typeof a=="string"?a:o];s||(s=a),Pt(a)?an(s,a):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=o),n.push(s)}):ne(i,function(a,o){var s=r[a];!s&&hKe.indexOf(a)>=0||(s||(s={name:a,key:"".concat(o)}),Pt(a)&&an(s,a),s.key===void 0&&(s.key=o),n.push(s))}),n}const Bne=mKe;function Cb(e){return Cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(e)}function wKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Ke(n.key),n)}}function SKe(e,t,r){return t&&Y6(e.prototype,t),r&&Y6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ke(e){var t=CKe(e,"string");return Cb(t)==="symbol"?t:String(t)}function CKe(e,t){if(Cb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xKe=function(){function e(t,r){wKe(this,e);var n=sv(r),i=Ic(r),a,o,s,l,u,f;this.rootWindow=r,this.type=this.getSourceType(t),this.type==="literal"?(a=parseInt(t.top,10),s=parseInt(t.left,10),u=t.height||0,f=t.width||0,o=a,l=s,a+=n,s+=i):this.type==="event"&&(a=parseInt(t.pageY,10),s=parseInt(t.pageX,10),u=t.target.clientHeight,f=t.target.clientWidth,o=a-n,l=s-i),this.top=a,this.topRelative=o,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=f}return SKe(e,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),e}();const TKe=xKe;function xb(e){return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xb(e)}function K6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function X6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K6(Object(r),!0).forEach(function(n){OKe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OKe(e,t,r){return t=Vne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vne(n.key),n)}}function RKe(e,t,r){return t&&q6(e.prototype,t),r&&q6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vne(e){var t=kKe(e,"string");return xb(t)==="symbol"?t:String(t)}function kKe(e,t){if(xb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z6=215,jne="menu",AKe=jne,Wne=function(){function e(t,r){EKe(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Z6,container:this.hot.rootDocument.documentElement},this.eventManager=new Fr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return RKe(e,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=i0(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=i$(function(d){return r.openSubMenu(d)},300),i=this.options.minWidth||Z6,a=!1,o=ra(this.menuItems,function(d){return d.key===wb&&(a=!0),pYe(d,r.hot)});if(o.length<1&&!a)o.push(Hne()[wb]);else if(o.length===0)return;o=mYe(o,Lt);var s=!1,l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(v){return Xe(v)&&v<i?i:v},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(v,p,g,y,m,b){return r.menuItemRenderer(v,p,g,y,m,b)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(v,p){r.isAllSubMenusClosed()?n(p.row):r.openSubMenu(p.row)},rowHeights:function(v){return o[v].name===Lt?1:23},afterOnCellContextMenu:function(v){v.preventDefault(),LI()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(v){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(v))},afterOnCellMouseUp:function(v){(!LI()||!Pu(v))&&s&&r.hasSelectedItem()&&(oo()||PF()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new rB(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),f=u.addContext(AKe),c={group:jne},h=X6(X6({},c),{},{runOnlyIf:function(v){return s0(v.target)===!1||r.container.contains(v.target)===!1}});u.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectNextCell(v[0],v[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.selectPrevCell(v[0],v[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var v=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,v){var p=r.openSubMenu(v[0]);p&&p.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(v){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(p[0]).submenu||(r.executeCommand(v),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var v=r.hotMenu.getSelectedLast();r.keyEvent=!0,v?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!cYe(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),a=new e(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return a.setMenuItems(i.submenu.items),a.open(),a.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=a,a}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;ne(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),a=i?fYe(i):[];this.runLocalHooks("executeCommand",n.key,a,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,a,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,a=r.disabled,o=r.submenu,s=a===!0||typeof a=="function"&&a.call(this.hot)===!0;return n===!1||i===Lt||s===!0||o}},{key:"setPosition",value:function(r){var n=new TKe(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.right;n+=r.cellWidth+a-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),a=i.left;n-=r.left-a}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);d_(r)||v_(r)||p_(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);d_(n)||v_(n)||p_(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,a=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;a&&(d_(a)||v_(a)||p_(a)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,a=i>=0?this.hotMenu.getCell(i,n):null;a&&(d_(a)||v_(a)||p_(a)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,a,o,s){var l=this,u=r.getSourceDataAtRow(i),f=this.hot.rootDocument.createElement("div"),c=function(y){return Vr(y,"submenu")},h=function(y){return new RegExp(Lt,"i").test(y.name)},d=function(y){return y.disabled===!0||typeof y.disabled=="function"&&y.disabled.call(l.hot)===!0},v=function(y){return y.disableSelection},p=s;typeof p=="function"&&(p=p.call(this.hot)),mo(n),ke(f,"htItemWrapper"),n.appendChild(f),h(u)?ke(n,"htSeparator"):typeof u.renderer=="function"?(ke(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,f,i,a,o,p))):lh(f,p),d(u)?(ke(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):v(u)?(ke(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):c(u)?(ke(n,"htSubmenu"),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)})):(St(n,["htSubmenu","htDisabled"]),v(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,a,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,a;return i&&(br(i)&&(i=i.call(this.hot),i===null||pr(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),a=n.querySelector(".".concat(this.options.className,".").concat(i))),a||(a=n.createElement("div"),ke(a,"htMenu ".concat(this.options.className)),i&&ke(a,i),this.options.container.appendChild(a)),a}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,a=r.holder.style,o=parseInt(i.width,10),s=Zr(n,function(l,u){return l+(u.name===Lt?1:26)},0);a.width="".concat(o+3,"px"),a.height="".concat(s+3,"px"),i.height=a.height}},{key:"onAfterSelection",value:function(r,n,i,a,o){this.keyEvent===!1&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(r){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!hu(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!hu(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){this.isOpened()&&bt(r.target,"htCore")&&hu(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),e}();yr(Wne,Vi);const bB=Wne;function vp(e){return vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vp(e)}function PKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MKe(n.key),n)}}function IKe(e,t,r){return t&&J6(e.prototype,t),r&&J6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MKe(e){var t=DKe(e,"string");return vp(t)==="symbol"?t:String(t)}function DKe(e,t){if(vp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zf(){return typeof Reflect<"u"&&Reflect.get?Zf=Reflect.get.bind():Zf=function(t,r,n){var i=NKe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Zf.apply(this,arguments)}function NKe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=$s(e),e!==null););return e}function LKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j2(e,t)}function j2(e,t){return j2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},j2(e,t)}function FKe(e){var t=HKe();return function(){var n=$s(e),i;if(t){var a=$s(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return $Ke(this,i)}}function $Ke(e,t){if(t&&(vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Une(e)}function Une(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $s(e){return $s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$s(e)}var m_="contextMenu",BKe=70;Qe.getSingleton().register("afterContextMenuDefaultOptions");Qe.getSingleton().register("beforeContextMenuShow");Qe.getSingleton().register("afterContextMenuShow");Qe.getSingleton().register("afterContextMenuHide");Qe.getSingleton().register("afterContextMenuExecute");var zne=function(e){LKe(r,e);var t=FKe(r);function r(n){var i;return PKe(this,r),i=t.call(this,n),i.eventManager=new Fr(Une(i)),i.commandExecutor=new $ne(i.hot),i.itemsFactory=null,i.menu=null,i}return IKe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[m_]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[m_];typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),this.menu=new bB(this.hot,{className:"htContextMenu",keepInViewport:!0,container:a.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var o,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(o=i.executeCommand).call.apply(o,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(o){return i.onAfterOnCellContextMenu(o)}),Zf($s(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Zf($s(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Zf($s(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u-sv(i.view),o=f-Ic(i.view)}else a=-1*sv(this.menu.hotMenu.rootWindow),o=-1*Ic(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+a,left:parseInt(i.pageX,10)+o})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var a;this.itemsFactory===null&&this.prepareMenuItems();for(var o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new Bne(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[m_],o={items:this.itemsFactory.getItems(a)};this.hot.runHooks("afterContextMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);var s=this.itemsFactory.getItems(a);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),ne(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var a=this.hot.getSettings(),o=a.rowHeaders,s=a.colHeaders;function l(f){return f.nodeName==="TD"||f.parentNode.nodeName==="TD"}var u=i.target;this.close(),!bt(u,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(o||s)&&!l(u)&&!(bt(u,"current")&&bt(u,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Zf($s(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return m_}},{key:"PLUGIN_PRIORITY",get:function(){return BKe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[iE,aE,Lt,cS,hS,Lt,nE,vS,Lt,oE,rE,Lt,dS,Lt,ba]}}]),r}(er);zne.SEPARATOR={name:Lt};function VKe(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(W$)},callback:function(){e.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function jKe(e){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(G$,n)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function WKe(e){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(z$,n)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function UKe(e){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(U$,n)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function zKe(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(Y$)},callback:function(){e.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Tb(e){return Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tb(e)}function GKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KKe(n.key),n)}}function YKe(e,t,r){return t&&Q6(e.prototype,t),r&&Q6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KKe(e){var t=XKe(e,"string");return Tb(t)==="symbol"?t:String(t)}function XKe(e,t){if(Tb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qKe=function(){function e(){GKe(this,e),this.data={}}return YKe(e,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),e}();function Ob(e){return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ob(e)}function ez(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JKe(n.key),n)}}function ZKe(e,t,r){return t&&ez(e.prototype,t),r&&ez(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JKe(e){var t=QKe(e,"string");return Ob(t)==="symbol"?t:String(t)}function QKe(e,t){if(Ob(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ob(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var tXe=ZKe(function e(){eXe(this,e),this.clipboardData=new qKe});function Eb(e){return Eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eb(e)}function rXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iXe(n.key),n)}}function nXe(e,t,r){return t&&tz(e.prototype,t),r&&tz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function iXe(e){var t=aXe(e,"string");return Eb(t)==="symbol"?t:String(t)}function aXe(e,t){if(Eb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Eb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wB=function(){function e(t){rXe(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Fr(this),this.listenersCount=new WeakSet,this.container=t}return nXe(e,[{key:"useSecondaryElement",value:function(){var r=lXe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),rz(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),rz(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",oo()||Vee(this.mainElement)}}]),e}();yr(wB,Vi);var qx=new WeakMap;function oXe(e){var t=new wB(e),r=qx.get(e);return r=isNaN(r)?0:r,qx.set(e,r+1),t}function sXe(e){e.eventManager.clear()}var Nk=function(t,r){return function(n){return r.runLocalHooks(t,n)}};function rz(e,t,r){e.addEventListener(t,"copy",Nk("copy",r)),e.addEventListener(t,"cut",Nk("cut",r)),e.addEventListener(t,"paste",Nk("paste",r))}var Zx=new WeakMap;function lXe(e){var t=Zx.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=e.defaultView?e:e.ownerDocument,n=r.createElement("textarea");return Zx.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}function nz(e){if(e instanceof wB){var t=qx.get(e.container);if(t=isNaN(t)?0:t,t>0&&(t-=1),sXe(e),t<=0){t=0;var r=Zx.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Zx.delete(e.container)),e.mainElement=null}qx.set(e.container,t)}}function Rb(e){return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(e)}function uXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cXe(n.key),n)}}function fXe(e,t,r){return t&&iz(e.prototype,t),r&&iz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cXe(e){var t=hXe(e,"string");return Rb(t)==="symbol"?t:String(t)}function hXe(e,t){if(Rb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function az(e,t){Gne(e,t),t.add(e)}function Bh(e,t,r){Gne(e,t),t.set(e,r)}function Gne(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b_(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function si(e,t){var r=Yne(e,t,"get");return dXe(e,r)}function dXe(e,t){return t.get?t.get.call(e):t.value}function Vh(e,t,r){var n=Yne(e,t,"set");return vXe(e,n,r),r}function Yne(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function vXe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Il=new WeakMap,Lk=new WeakMap,sy=new WeakMap,W2=new WeakMap,U2=new WeakMap,ly=new WeakMap,w_=new WeakSet,oz=new WeakSet,pXe=function(){function e(t){var r=t.countRows,n=t.countColumns,i=t.rowsLimit,a=t.columnsLimit,o=t.countColumnHeaders;uXe(this,e),az(this,oz),az(this,w_),Bh(this,Il,{writable:!0,value:void 0}),Bh(this,Lk,{writable:!0,value:void 0}),Bh(this,sy,{writable:!0,value:void 0}),Bh(this,W2,{writable:!0,value:void 0}),Bh(this,U2,{writable:!0,value:void 0}),Bh(this,ly,{writable:!0,value:void 0}),Vh(this,Lk,r),Vh(this,sy,n),Vh(this,W2,i),Vh(this,U2,a),Vh(this,ly,o)}return fXe(e,[{key:"setSelectedRange",value:function(r){Vh(this,Il,r)}},{key:"getCellsRange",value:function(){if(si(this,Lk).call(this)===0||si(this,sy).call(this)===0)return null;var r=si(this,Il).getTopStartCorner(),n=r.row,i=r.col,a=si(this,Il).getBottomEndCorner(),o=a.row,s=a.col,l=b_(this,oz,gXe).call(this,n,o),u=b_(this,w_,Fk).call(this,i,s),f=o!==l||s!==u;return{isRangeTrimmed:f,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(si(this,sy).call(this)===0||si(this,ly).call(this)===0)return null;var r=si(this,Il).getTopStartCorner(),n=r.col,i=si(this,Il).getBottomEndCorner(),a=i.col,o=b_(this,w_,Fk).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:o}}},{key:"getAllColumnHeadersRange",value:function(){if(si(this,sy).call(this)===0||si(this,ly).call(this)===0)return null;var r=si(this,Il).getTopStartCorner(),n=r.col,i=si(this,Il).getBottomEndCorner(),a=i.col,o=b_(this,w_,Fk).call(this,n,a),s=a!==o;return{isRangeTrimmed:s,startRow:-si(this,ly).call(this),startCol:n,endRow:-1,endCol:o}}}]),e}();function Fk(e,t){return Math.min(t,Math.max(e+si(this,U2).call(this)-1,e))}function gXe(e,t){return Math.min(t,Math.max(e+si(this,W2).call(this)-1,e))}function Kne(e){var t=[],r=[];return ne(e,function(n){var i=Math.min(n.startRow,n.endRow),a=Math.max(n.startRow,n.endRow);rt(i,a,function(l){t.indexOf(l)===-1&&t.push(l)});var o=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);rt(o,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:t,columns:r}}function yXe(e,t){return SXe(e)||wXe(e,t)||bXe(e,t)||mXe()}function mXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bXe(e,t){if(e){if(typeof e=="string")return sz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sz(e,t)}}function sz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wXe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function SXe(e){if(Array.isArray(e))return e}function jc(e){return jc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jc(e)}function _Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qne(n.key),n)}}function CXe(e,t,r){return t&&lz(e.prototype,t),r&&lz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jf(){return typeof Reflect<"u"&&Reflect.get?Jf=Reflect.get.bind():Jf=function(t,r,n){var i=xXe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Jf.apply(this,arguments)}function xXe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hs(e),e!==null););return e}function TXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z2(e,t)}function z2(e,t){return z2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},z2(e,t)}function OXe(e){var t=RXe();return function(){var n=Hs(e),i;if(t){var a=Hs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return EXe(this,i)}}function EXe(e,t){if(t&&(jc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ai(e)}function ai(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hs(e){return Hs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hs(e)}function kXe(e,t){Xne(e,t),t.add(e)}function af(e,t,r){Xne(e,t),t.set(e,r)}function Xne(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jh(e,t,r){return t=qne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qne(e){var t=AXe(e,"string");return jc(t)==="symbol"?t:String(t)}function AXe(e,t){if(jc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PXe(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function Wi(e,t){var r=Zne(e,t,"get");return IXe(e,r)}function IXe(e,t){return t.get?t.get.call(e):t.value}function gs(e,t,r){var n=Zne(e,t,"set");return MXe(e,n,r),r}function Zne(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function MXe(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Qe.getSingleton().register("afterCopyLimit");Qe.getSingleton().register("modifyCopyableRange");Qe.getSingleton().register("beforeCut");Qe.getSingleton().register("afterCut");Qe.getSingleton().register("beforePaste");Qe.getSingleton().register("afterPaste");Qe.getSingleton().register("beforeCopy");Qe.getSingleton().register("afterCopy");var S_="copyPaste",DXe=80,NXe=["fragmentSelection"],uz=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),$k=new WeakMap,Hk=new WeakMap,Bk=new WeakMap,Wh=new WeakMap,__=new WeakMap,C_=new WeakMap,Uh=new WeakMap,fz=new WeakSet,LXe=function(e){TXe(r,e);var t=OXe(r);function r(){var n;_Xe(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),kXe(ai(n),fz),jh(ai(n),"columnsLimit",1/0),jh(ai(n),"rowsLimit",1/0),jh(ai(n),"pasteMode","overwrite"),jh(ai(n),"uiContainer",n.hot.rootDocument.body),af(ai(n),$k,{writable:!0,value:!1}),af(ai(n),Hk,{writable:!0,value:!1}),af(ai(n),Bk,{writable:!0,value:!1}),af(ai(n),Wh,{writable:!0,value:"cells-only"}),af(ai(n),__,{writable:!0,value:!1}),af(ai(n),C_,{writable:!0,value:!1}),af(ai(n),Uh,{writable:!0,value:new pXe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),jh(ai(n),"copyableRanges",[]),jh(ai(n),"focusableElement",void 0),n}return CXe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[S_]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a[S_];if(jc(o)==="object"){var s,l;this.pasteMode=(s=o.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(o.rowsLimit)?this.rowsLimit:o.rowsLimit,this.columnsLimit=isNaN(o.columnsLimit)?this.columnsLimit:o.columnsLimit,gs(this,$k,!!o.copyColumnHeaders),gs(this,Hk,!!o.copyColumnGroupHeaders),gs(this,Bk,!!o.copyColumnHeadersOnly),this.uiContainer=(l=o.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=oXe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),Jf(Hs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),Jf(Hs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&nz(this.focusableElement),Jf(Hs(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";gs(this,Wh,i),gs(this,__,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){gs(this,C_,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return mm(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var a=this,o=[],s=Kne(i),l=s.rows,u=s.columns;return ne(l,function(f){var c=[];ne(u,function(h){f<0?c.push(a.hot.getColHeader(h,f)):c.push(a.hot.getCopyableData(f,h))}),o.push(c)}),o}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!a)){var o=new tXe;i&&o.clipboardData.setData("text/plain",i),a&&o.clipboardData.setData("text/html",a),this.getOrCreateFocusableElement(),this.onPaste(o)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(i){Wi(this,Uh).setSelectedRange(i);var a=new Map([["headers",null],["cells",null]]);Wi(this,Wh)==="column-headers-only"?a.set("headers",Wi(this,Uh).getMostBottomColumnHeadersRange()):(Wi(this,Wh)==="with-column-headers"?a.set("headers",Wi(this,Uh).getMostBottomColumnHeadersRange()):Wi(this,Wh)==="with-column-group-headers"&&a.set("headers",Wi(this,Uh).getAllColumnHeadersRange()),a.set("cells",Wi(this,Uh).getCellsRange())),this.copyableRanges=Array.from(a.values()).filter(function(c){return c!==null}).map(function(c){var h=c.startRow,d=c.startCol,v=c.endRow,p=c.endCol;return{startRow:h,startCol:d,endRow:v,endCol:p}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var o=a.get("cells");if(o!==null&&o.isRangeTrimmed){var s=o.startRow,l=o.startCol,u=o.endRow,f=o.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,f-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,a=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;a?this.focusableElement.setFocusableElement(a):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){for(var o=i.length,s=i[0].length,l=[],u=a.getTopStartCorner(),f=u.row,c=u.col,h=a.getBottomEndCorner(),d=h.row,v=h.col,p=f,g=c,y=f,m=c;l.length<o||p<=d;){var b=this.hot.getCellMeta(p,c),S=b.skipRowOnPaste,x=b.visualRow;if(p=x+1,S!==!0){y=x,g=c;for(var T=[],E=l.length%o;T.length<s||g<=v;){var P=this.hot.getCellMeta(f,g),R=P.skipColumnOnPaste,M=P.visualCol;if(g=M+1,R!==!0){m=M;var D=T.length%s;T.push(i[E][D])}}l.push(T)}}return this.hot.populateFromArray(f,c,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[f,c,y,m]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!Wi(this,__)||this.isEditorOpened())){this.setCopyableText(),gs(this,__,!1);var a=this.getRangedData(this.copyableRanges),o=PXe(this,fz,FXe).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges,o);if(s){var l=mm(a);if(i&&i.clipboardData){var u=lM(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[uz,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",a,this.copyableRanges,o)}gs(this,Wh,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!Wi(this,C_)||this.isEditorOpened())){this.setCopyableText(),gs(this,C_,!1);var a=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(o){var s=mm(a);if(i&&i.clipboardData){var l=lM(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[uz,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var a;if(i&&typeof i.clipboardData<"u"){var o=LO(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){var s=fte(o,this.hot.rootDocument);a=s.data}else a=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(a=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof a=="string"&&(a=Ije(a)),!(a&&a.length===0)&&this.hot.runHooks("beforePaste",a,this.copyableRanges)!==!1){var l=this.populateValues(a),u=yXe(l,4),f=u[0],c=u[1],h=u[2],d=u[3];this.hot.selectCell(f,c,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",a,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},VKe(this)),Wi(this,$k)&&i.items.push(UKe(this)),Wi(this,Hk)&&i.items.push(WKe(this)),Wi(this,Bk)&&i.items.push(jKe(this)),i.items.push(zKe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&$ee())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,a=this.hot.getActiveEditor();!a||i!==this.focusableElement.getFocusableElement()&&i!==a.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(nz(this.focusableElement),this.focusableElement=null),Jf(Hs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return S_}},{key:"SETTING_KEYS",get:function(){return[S_].concat(NXe)}},{key:"PLUGIN_PRIORITY",get:function(){return DXe}}]),r}(er);function FXe(e){for(var t=Kne(e),r=t.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Jne(e,t){return"border_row".concat(e,"col").concat(t)}function zy(){return{width:1,color:"#000"}}function Bs(){return{hide:!0}}function $Xe(){return{width:1,color:"#000",cornerVisible:!1}}function Vk(e){if(Xe(e.start)||Xe(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(Xe(e.end)||Xe(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function uy(e){return Xe(e.start)&&(e.left=e.start),Xe(e.end)&&(e.right=e.end),e}function jk(e,t){return{id:Jne(e,t),border:$Xe(),row:e,col:t,top:Bs(),bottom:Bs(),start:Bs(),end:Bs()}}function HXe(e,t){return Vr(t,"border")&&t.border&&(e.border=t.border),Vr(t,"top")&&Xe(t.top)&&(t.top?(Pt(t.top)||(t.top=zy()),e.top=t.top):(t.top=Bs(),e.top=t.top)),Vr(t,"bottom")&&Xe(t.bottom)&&(t.bottom?(Pt(t.bottom)||(t.bottom=zy()),e.bottom=t.bottom):(t.bottom=Bs(),e.bottom=t.bottom)),Vr(t,"start")&&Xe(t.start)&&(t.start?(Pt(t.start)||(t.start=zy()),e.start=t.start):(t.start=Bs(),e.start=t.start)),Vr(t,"end")&&Xe(t.end)&&(t.end?(Pt(t.end)||(t.end=zy()),e.end=t.end):(t.end=Bs(),e.end=t.end)),e}function vl(e,t){var r=!1;return ne(e.getSelectedRange(),function(n){n.forAll(function(i,a){if(!(i<0||a<0)){var o=e.getCellMeta(i,a).borders;if(o)if(t){if(!Vr(o[t],"hide")||o[t].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function sE(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function BXe(e){return e.some(function(t){return Xe(t.left)||Xe(t.right)})}function VXe(e){return e.some(function(t){return Xe(t.start)||Xe(t.end)})}var jXe=new Map([["left","start"],["right","end"]]);function WXe(e){var t;return(t=jXe.get(e))!==null&&t!==void 0?t:e}function UXe(e){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(dH),n=vl(this,"bottom");return n&&(r=sE(r)),r},callback:function(r,n){var i=vl(this,"bottom");e.prepareBorder(n,"bottom",i)}}}function zXe(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(vH),i=vl(this,t);return i&&(n=sE(n)),n},callback:function(n,i){var a=vl(this,t);e.prepareBorder(i,t,a)}}}function GXe(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(pH)},callback:function(r,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!vl(this)}}}function YXe(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(hH),i=vl(this,t);return i&&(n=sE(n)),n},callback:function(n,i){var a=vl(this,t);e.prepareBorder(i,t,a)}}}function KXe(e){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(cH),n=vl(this,"top");return n&&(r=sE(r)),r},callback:function(r,n){var i=vl(this,"top");e.prepareBorder(n,"top",i)}}}function pp(e){return pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(e)}function cz(e,t){return JXe(e)||ZXe(e,t)||qXe(e,t)||XXe()}function XXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qXe(e,t){if(e){if(typeof e=="string")return hz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hz(e,t)}}function hz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZXe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function JXe(e){if(Array.isArray(e))return e}function QXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eie(n.key),n)}}function eqe(e,t,r){return t&&dz(e.prototype,t),r&&dz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qf(){return typeof Reflect<"u"&&Reflect.get?Qf=Reflect.get.bind():Qf=function(t,r,n){var i=tqe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Qf.apply(this,arguments)}function tqe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vs(e),e!==null););return e}function rqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G2(e,t)}function G2(e,t){return G2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},G2(e,t)}function nqe(e){var t=aqe();return function(){var n=Vs(e),i;if(t){var a=Vs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return iqe(this,i)}}function iqe(e,t){if(t&&(pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qne(e)}function Qne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vs(e){return Vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vs(e)}function oqe(e,t,r){return t=eie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eie(e){var t=sqe(e,"string");return pp(t)==="symbol"?t:String(t)}function sqe(e,t){if(pp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x_="customBorders",lqe=90,uqe=function(e){rqe(r,e);var t=nqe(r);function r(){var n;QXe(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),oqe(Qne(n),"savedBorders",[]),n}return eqe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[x_]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.onAfterContextMenuDefaultOptions(a)}),this.addHook("init",function(){return i.onAfterInit()}),Qf(Vs(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Qf(Vs(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Qf(Vs(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,a){var o=this,s=["top","bottom","start","end"],l=null;a&&(this.checkSettingsCohesion([a]),s=Object.keys(a),l=Vk(a));var u=Hv(i),f=rb(u);ne(i,function(c){for(var h=f(c),d=cz(h,4),v=d[0],p=d[1],g=d[2],y=d[3],m=function(x){for(var T=function(R){ne(s,function(M){o.prepareBorderFromCustomAdded(x,R,l,WXe(M))})},E=p;E<=y;E+=1)T(E)},b=v;b<=g;b+=1)m(b)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var a=this;if(!Array.isArray(i))return this.savedBorders;var o=Hv(i),s=rb(o),l=[];return ne(i,function(u){for(var f=s(u),c=cz(f,4),h=c[0],d=c[1],v=c[2],p=c[3],g=function(b){for(var S=function(E){ne(a.savedBorders,function(P){P.row===b&&P.col===E&&l.push(uy(P))})},x=d;x<=p;x+=1)S(x)},y=h;y<=v;y+=1)g(y)}),l}},{key:"clearBorders",value:function(i){var a=this;i?this.setBorders(i):(ne(this.savedBorders,function(o){a.clearBordersFromSelectionSettings(o.id),a.clearNullCellRange(),a.hot.removeCellMeta(o.row,o.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,a){var o=this.checkSavedBorders(i);o||this.savedBorders.push(i);var s=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),l=this.checkCustomSelections(i,s,a);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,a,o,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(i>=l||a>=u)){var f=jk(i,a);o&&(f=HXe(f,o),ne(this.hot.selection.highlight.customSelections,function(c){if(f.id===c.settings.id)return Object.assign(c.settings,o),f.id=c.settings.id,f.top=c.settings.top,f.bottom=c.settings.bottom,f.start=c.settings.start,f.end=c.settings.end,!1})),this.hot.setCellMeta(i,a,"borders",uy(f)),this.insertBorderIntoSettings(f,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,a){var o=this,s=Math.min(i.to.row,this.hot.countRows()-1),l=Math.min(i.to.col,this.hot.countCols()-1);rt(i.from.row,s,function(u){rt(i.from.col,l,function(f){var c=jk(u,f),h=0;u===i.from.row&&Vr(a,"top")&&(h+=1,c.top=a.top),u===i.to.row&&Vr(a,"bottom")&&(h+=1,c.bottom=a.bottom),f===i.from.col&&Vr(a,"start")&&(h+=1,c.start=a.start),f===i.to.col&&Vr(a,"end")&&(h+=1,c.end=a.end),h>0&&(o.hot.setCellMeta(u,f,"borders",uy(c)),o.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(i,a){var o=Jne(i,a);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(i,a,"borders")}},{key:"setBorder",value:function(i,a,o,s){var l=this.hot.getCellMeta(i,a).borders;if(!l||l.border===void 0?l=jk(i,a):l=Vk(l),s){l[o]=Bs();var u=this.countHide(l);if(u===4)this.removeAllBorders(i,a);else{var f=this.checkCustomSelectionsFromContextMenu(l,o,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",uy(l))}}else{l[o]=zy();var c=this.checkCustomSelectionsFromContextMenu(l,o,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,a,"borders",uy(l))}}},{key:"prepareBorder",value:function(i,a,o){var s=this;ne(i,function(l){var u=l.start,f=l.end;if(u.row===f.row&&u.col===f.col)a==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,a,o);else switch(a){case"noBorders":rt(u.col,f.col,function(c){rt(u.row,f.row,function(h){s.removeAllBorders(h,c)})});break;case"top":rt(u.col,f.col,function(c){s.setBorder(u.row,c,a,o)});break;case"bottom":rt(u.col,f.col,function(c){s.setBorder(f.row,c,a,o)});break;case"start":rt(u.row,f.row,function(c){s.setBorder(c,u.col,a,o)});break;case"end":rt(u.row,f.row,function(c){s.setBorder(c,f.col,a,o)});break}})}},{key:"createCustomBorders",value:function(i){var a=this;ne(i,function(o){var s=Vk(o);o.range?a.prepareBorderFromCustomAddedRange(o.range,s):a.prepareBorderFromCustomAdded(o.row,o.col,s)})}},{key:"countHide",value:function(i){var a=i.top,o=i.bottom,s=i.start,l=i.end,u=[a,o,s,l];return Zr(u,function(f,c){var h=f;return c&&c.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var a=At(this.hot.selection.highlight.customSelections,function(o){return o.settings.id}).indexOf(i);a>-1&&this.hot.selection.highlight.customSelections[a].clear()}},{key:"clearNullCellRange",value:function(){var i=this;ne(this.hot.selection.highlight.customSelections,function(a,o){if(a.cellRange===null)return i.hot.selection.highlight.customSelections[o].destroy(),i.hot.selection.highlight.customSelections.splice(o,1),!1})}},{key:"hideBorders",value:function(){var i=this;ne(this.savedBorders,function(a){i.clearBordersFromSelectionSettings(a.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var a=At(this.savedBorders,function(o){return o.id}).indexOf(i);a>-1&&this.savedBorders.splice(a,1)}},{key:"checkSavedBorders",value:function(i){var a=this,o=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),o=!0):ne(this.savedBorders,function(l,u){if(i.id===l.id)return a.savedBorders[u]=i,o=!0,!1}),o}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,a,o){var s=!1;return ne(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return It(l.instanceBorders,function(u){u.toggleHiddenClass(a,o)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,a,o){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):ne(this.hot.selection.highlight.customSelections,function(u){if(i.id===u.settings.id)return u.visualCellRange=a,u.commit(),o&&It(u.instanceBorders,function(f){f.changeBorderStyle(o,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[x_];if(Array.isArray(i)){var a=Xn(i);this.checkSettingsCohesion(a),a.length||(this.savedBorders=a),this.createCustomBorders(a)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var a=BXe(i),o=VXe(i);if(a&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&a)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){this.hot.getSettings()[x_]&&i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(fH)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[KXe(this),YXe(this),UXe(this),zXe(this),GXe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Qf(Vs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return x_}},{key:"PLUGIN_PRIORITY",get:function(){return lqe}}]),r}(er);function gp(e){return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}function fqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hqe(n.key),n)}}function cqe(e,t,r){return t&&vz(e.prototype,t),r&&vz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hqe(e){var t=dqe(e,"string");return gp(t)==="symbol"?t:String(t)}function dqe(e,t){if(gp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ec(){return typeof Reflect<"u"&&Reflect.get?ec=Reflect.get.bind():ec=function(t,r,n){var i=vqe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ec.apply(this,arguments)}function vqe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=js(e),e!==null););return e}function pqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y2(e,t)}function Y2(e,t){return Y2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Y2(e,t)}function gqe(e){var t=mqe();return function(){var n=js(e),i;if(t){var a=js(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return yqe(this,i)}}function yqe(e,t){if(t&&(gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tie(e)}function tie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function js(e){return js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},js(e)}var pz="dragToScroll",bqe=100,wqe=function(e){pqe(r,e);var t=gqe(r);function r(n){var i;return fqe(this,r),i=t.call(this,n),i.eventManager=new Fr(tie(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return cqe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[pz]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(a){return i.setupListening(a)}),this.addHook("afterOnCellCornerMouseDown",function(a){return i.setupListening(a)}),this.registerEvents(),ec(js(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ec(js(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),ec(js(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,a){var o=0,s=0;a<this.boundaries.top?s=a-this.boundaries.top:a>this.boundaries.bottom&&(s=a-this.boundaries.bottom),i<this.boundaries.left?o=i-this.boundaries.left:i>this.boundaries.right&&(o=i-this.boundaries.right),this.callback(o,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,a=this.hot.rootWindow,o=a;o;)this.eventManager.addEventListener(o.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(o.document,"mousemove",function(s){return i.onMouseMove(s)}),o=i0(o)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!Pu(i)){var a=this.hot.view._wt.wtTable.holder;a!==this.hot.rootWindow&&(this.setBoundaries(a.getBoundingClientRect()),this.setCallback(function(o,s){o<0?a.scrollLeft-=50:o>0&&(a.scrollLeft+=50),s<0?a.scrollTop-=20:s>0&&(a.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){this.isListening()&&this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){ec(js(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pz}},{key:"PLUGIN_PRIORITY",get:function(){return bqe}}]),r}(er);function yp(e){return yp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yp(e)}function Sqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cqe(n.key),n)}}function _qe(e,t,r){return t&&gz(e.prototype,t),r&&gz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cqe(e){var t=xqe(e,"string");return yp(t)==="symbol"?t:String(t)}function xqe(e,t){if(yp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tc(){return typeof Reflect<"u"&&Reflect.get?tc=Reflect.get.bind():tc=function(t,r,n){var i=Tqe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},tc.apply(this,arguments)}function Tqe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ws(e),e!==null););return e}function Oqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K2(e,t)}function K2(e,t){return K2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},K2(e,t)}function Eqe(e){var t=kqe();return function(){var n=Ws(e),i;if(t){var a=Ws(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Rqe(this,i)}}function Rqe(e,t){if(t&&(yp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rie(e)}function rie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ws(e){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ws(e)}Qe.getSingleton().register("afterDropdownMenuDefaultOptions");Qe.getSingleton().register("beforeDropdownMenuShow");Qe.getSingleton().register("afterDropdownMenuShow");Qe.getSingleton().register("afterDropdownMenuHide");Qe.getSingleton().register("afterDropdownMenuExecute");var Wk="dropdownMenu",Aqe=230,Uk="changeType",nie=function(e){Oqe(r,e);var t=Eqe(r);function r(n){var i;return Sqe(this,r),i=t.call(this,n),i.eventManager=new Fr(rie(i)),i.commandExecutor=new $ne(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return _qe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Wk]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new Bne(this.hot,r.DEFAULT_ITEMS);var a=this.hot.getSettings()[Wk],o={items:this.itemsFactory.getItems(a)};this.registerEvents(),typeof a.callback=="function"&&this.commandExecutor.setCommonCallback(a.callback),tc(Ws(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",o),i.itemsFactory.setPredefinedItems(o.items);var s=i.itemsFactory.getItems(a);i.menu&&i.menu.destroy(),i.menu=new bB(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:a.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(l=i.executeCommand).call.apply(l,[i].concat(f))}),ne(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),tc(Ws(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),tc(Ws(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(a){return i.onTableClick(a)})}},{key:"open",value:function(i){this.menu&&(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=this.commandExecutor).execute.apply(a,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),bt(i.target,Uk)&&!this.menu.isOpened()){var a=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,f=l.left;a=u,o=f}var c=i.target.getBoundingClientRect();this.open({left:c.left+o,top:c.top+i.target.offsetHeight+3+a,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(i,a){var o=a.parentNode;if(o){var s=o.parentNode.childNodes,l=Array.prototype.indexOf.call(s,o);if(!(i<0||l!==s.length-1)){var u=a.querySelector(".".concat(Uk));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var f=this.hot.rootDocument.createElement("button");f.className=Uk,f.type="button",f.onclick=function(){return!1},a.firstChild.insertBefore(f,a.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),tc(Ws(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Wk}},{key:"PLUGIN_PRIORITY",get:function(){return Aqe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[cS,hS,Lt,vS,Lt,tE,Lt,dS,Lt,ba]}}]),r}(er);nie.SEPARATOR={name:Lt};function kb(e){return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kb(e)}function Pqe(e,t){return Nqe(e)||Dqe(e,t)||Mqe(e,t)||Iqe()}function Iqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mqe(e,t){if(e){if(typeof e=="string")return yz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yz(e,t)}}function yz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Nqe(e){if(Array.isArray(e))return e}function Lqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$qe(n.key),n)}}function Fqe(e,t,r){return t&&mz(e.prototype,t),r&&mz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $qe(e){var t=Hqe(e,"string");return kb(t)==="symbol"?t:String(t)}function Hqe(e,t){if(kb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bqe=function(){function e(t){Lqe(this,e),this.hot=t,this.options={}}return Fqe(e,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,a=n.startCol,o=n.endRow,s=n.endCol,l=this.options,u=[];return rt(i,o,function(f){var c=[];!l.exportHiddenRows&&r._isHiddenRow(f)||(rt(a,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||c.push(r.hot.getDataAtCell(f,h))}),u.push(c))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),a=i.startRow,o=i.endRow,s=this.hot.getRowHeader();rt(a,o,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),a=i.startCol,o=i.endCol,s=this.hot.getColHeader();rt(a,o,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=Pqe(this.options.range,4),a=i[0],o=a===void 0?0:a,s=i[1],l=s===void 0?0:s,u=i[2],f=u===void 0?n:u,c=i[3],h=c===void 0?r:c;return o=Math.max(o,0),l=Math.max(l,0),f=Math.min(f,n),h=Math.min(h,r),{startRow:o,startCol:l,endRow:f,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),e}();const Vqe=Bqe;function Ab(e){return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(e)}function jqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uqe(n.key),n)}}function Wqe(e,t,r){return t&&bz(e.prototype,t),r&&bz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Uqe(e){var t=zqe(e,"string");return Ab(t)==="symbol"?t:String(t)}function zqe(e,t){if(Ab(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ab(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gqe=function(){function e(t,r){jqe(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return Wqe(e,[{key:"_mergeOptions",value:function(r){var n=pi(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=an(pi(e.DEFAULT_OPTIONS),n),n=an(n,r),n.filename=e$(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}();const Yqe=Gqe;function mp(e){return mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mp(e)}function Kqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qqe(n.key),n)}}function Xqe(e,t,r){return t&&wz(e.prototype,t),r&&wz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qqe(e){var t=Zqe(e,"string");return mp(t)==="symbol"?t:String(t)}function Zqe(e,t){if(mp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(mp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X2(e,t)}function X2(e,t){return X2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},X2(e,t)}function Qqe(e){var t=rZe();return function(){var n=Jx(e),i;if(t){var a=Jx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return eZe(this,i)}}function eZe(e,t){if(t&&(mp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tZe(e)}function tZe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jx(e){return Jx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jx(e)}var nZe=String.fromCharCode(13),iZe=String.fromCharCode(34),aZe=String.fromCharCode(10),oZe=function(e){Jqe(r,e);var t=Qqe(r);function r(){return Kqe(this,r),t.apply(this,arguments)}return Xqe(r,[{key:"export",value:function(){var i=this,a=this.options,o=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),f=u.length>0,c=a.bom?String.fromCharCode(65279):"";return l&&(s=At(s,function(h){return i._escapeCell(h,!0)}),f&&(c+=a.columnDelimiter),c+=s.join(a.columnDelimiter),c+=a.rowDelimiter),ne(o,function(h,d){d>0&&(c+=a.rowDelimiter),f&&(c+=i._escapeCell(u[d])+a.columnDelimiter),c+=h.map(function(v){return i._escapeCell(v)}).join(a.columnDelimiter)}),c}},{key:"_escapeCell",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=jr(i);return o!==""&&(a||o.indexOf(nZe)>=0||o.indexOf(iZe)>=0||o.indexOf(aZe)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o='"'.concat(o,'"')),o}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(Yqe);const sZe=oZe;function Pb(e){return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pb(e)}function lZe(e,t,r){return t=uZe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uZe(e){var t=fZe(e,"string");return Pb(t)==="symbol"?t:String(t)}function fZe(e,t){if(Pb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cZe="csv",q2=lZe({},cZe,sZe);function hZe(e,t,r){return typeof q2[e]=="function"?new q2[e](t,r):null}function bp(e){return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function dZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pZe(n.key),n)}}function vZe(e,t,r){return t&&Sz(e.prototype,t),r&&Sz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pZe(e){var t=gZe(e,"string");return bp(t)==="symbol"?t:String(t)}function gZe(e,t){if(bp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yZe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z2(e,t)}function Z2(e,t){return Z2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Z2(e,t)}function mZe(e){var t=SZe();return function(){var n=Qx(e),i;if(t){var a=Qx(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return bZe(this,i)}}function bZe(e,t){if(t&&(bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wZe(e)}function wZe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qx(e){return Qx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qx(e)}var _Ze="exportFile",CZe=240,xZe=function(e){yZe(r,e);var t=mZe(r);function r(){return dZe(this,r),t.apply(this,arguments)}return vZe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,a).export()}},{key:"exportAsBlob",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,a))}},{key:"downloadFile",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.hot,s=o.rootDocument,l=o.rootWindow,u=this._createTypeFormatter(i,a),f=this._createBlob(u),c=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var v=c.createObjectURL(f);h.style.display="none",h.setAttribute("href",v),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){c.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,d)}},{key:"_createTypeFormatter",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!q2[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return hZe(i,new Vqe(this.hot),a)}},{key:"_createBlob",value:function(i){var a=null;return typeof Blob<"u"&&(a=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),a}}],[{key:"PLUGIN_KEY",get:function(){return _Ze}},{key:"PLUGIN_PRIORITY",get:function(){return CZe}}]),r}(er);function Ib(e){return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ib(e)}function TZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EZe(n.key),n)}}function OZe(e,t,r){return t&&_z(e.prototype,t),r&&_z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EZe(e){var t=RZe(e,"string");return Ib(t)==="symbol"?t:String(t)}function RZe(e,t){if(Ib(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ib(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iie=function(){function e(t,r){var n=r.id,i=r.stateless,a=i===void 0?!0:i;TZe(this,e),this.hot=t,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=a?null:this.hot.columnIndexMapper.registerMap(this.stateId,new UO)}return OZe(e,[{key:"reset",value:function(){ne(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),ne(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),e}();yr(iie,Vi);const lE=iie;var Mb={};function Iu(e,t){if(!Mb[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=Mb[e],n=r.condition,i=r.descriptor,a=t;return i.inputValuesDecorator&&(a=i.inputValuesDecorator(a)),function(o){return n.apply(o.meta.instance,[].concat([o],[a]))}}function rc(e){if(!Mb[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Mb[e].descriptor}function un(e,t,r){r.key=e,Mb[e]={condition:t,descriptor:r}}var Tn="none";function kZe(){return!0}un(Tn,kZe,{name:zO,inputsCount:0,showOperators:!1});var _m="empty";function AZe(e){return pn(e.value)}un(_m,AZe,{name:_H,inputsCount:0,showOperators:!0});var pC="not_empty";function PZe(e,t){return!Iu(_m,t)(e)}un(pC,PZe,{name:CH,inputsCount:0,showOperators:!0});function IZe(e,t){return LZe(e)||NZe(e,t)||DZe(e,t)||MZe()}function MZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DZe(e,t){if(e){if(typeof e=="string")return Cz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cz(e,t)}}function Cz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function LZe(e){if(Array.isArray(e))return e}var Cm="eq";function FZe(e,t){var r=IZe(t,1),n=r[0];return jr(e.value).toLocaleLowerCase(e.meta.locale)===jr(n)}un(Cm,FZe,{name:xH,inputsCount:1,showOperators:!0});var gC="neq";function $Ze(e,t){return!Iu(Cm,t)(e)}un(gC,$Ze,{name:TH,inputsCount:1,showOperators:!0});function HZe(e,t){return WZe(e)||jZe(e,t)||VZe(e,t)||BZe()}function BZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VZe(e,t){if(e){if(typeof e=="string")return xz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xz(e,t)}}function xz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function WZe(e){if(Array.isArray(e))return e}var aie="gt";function UZe(e,t){var r=HZe(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>i}un(aie,UZe,{name:AH,inputsCount:1,showOperators:!0});function zZe(e,t){return XZe(e)||KZe(e,t)||YZe(e,t)||GZe()}function GZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YZe(e,t){if(e){if(typeof e=="string")return Tz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tz(e,t)}}function Tz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KZe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function XZe(e){if(Array.isArray(e))return e}var oie="gte";function qZe(e,t){var r=zZe(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>=i}un(oie,qZe,{name:PH,inputsCount:1,showOperators:!0});function ZZe(e,t){return tJe(e)||eJe(e,t)||QZe(e,t)||JZe()}function JZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QZe(e,t){if(e){if(typeof e=="string")return Oz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oz(e,t)}}function Oz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function tJe(e){if(Array.isArray(e))return e}var sie="lt";function rJe(e,t){var r=ZZe(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<i}un(sie,rJe,{name:IH,inputsCount:1,showOperators:!0});function nJe(e,t){return sJe(e)||oJe(e,t)||aJe(e,t)||iJe()}function iJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aJe(e,t){if(e){if(typeof e=="string")return Ez(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ez(e,t)}}function Ez(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function sJe(e){if(Array.isArray(e))return e}var lie="lte";function lJe(e,t){var r=nJe(t,1),n=r[0],i=n;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<=i}un(lie,lJe,{name:MH,inputsCount:1,showOperators:!0});function uJe(e,t){return dJe(e)||hJe(e,t)||cJe(e,t)||fJe()}function fJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cJe(e,t){if(e){if(typeof e=="string")return Rz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rz(e,t)}}function Rz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function dJe(e){if(Array.isArray(e))return e}var SB="date_after";function vJe(e,t){var r=uJe(t,1),n=r[0],i=Ae(e.value,e.meta.dateFormat),a=Ae(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)>=0}un(SB,vJe,{name:LH,inputsCount:1,showOperators:!0});function pJe(e,t){return bJe(e)||mJe(e,t)||yJe(e,t)||gJe()}function gJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yJe(e,t){if(e){if(typeof e=="string")return kz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kz(e,t)}}function kz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function bJe(e){if(Array.isArray(e))return e}var _B="date_before";function wJe(e,t){var r=pJe(t,1),n=r[0],i=Ae(e.value,e.meta.dateFormat),a=Ae(n,e.meta.dateFormat);return!i.isValid()||!a.isValid()?!1:i.diff(a)<=0}un(_B,wJe,{name:FH,inputsCount:1,showOperators:!0});function SJe(e,t){return TJe(e)||xJe(e,t)||CJe(e,t)||_Je()}function _Je(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CJe(e,t){if(e){if(typeof e=="string")return Az(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Az(e,t)}}function Az(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function TJe(e){if(Array.isArray(e))return e}var eT="between";function OJe(e,t){var r=SJe(t,2),n=r[0],i=r[1],a=n,o=i;if(e.meta.type==="numeric"){var s=parseFloat(a,10),l=parseFloat(o,10);a=Math.min(s,l),o=Math.max(s,l)}else if(e.meta.type==="date"){var u=Iu(_B,[o]),f=Iu(SB,[a]);return u(e)&&f(e)}return e.value>=a&&e.value<=o}un(eT,OJe,{name:DH,inputsCount:2,showOperators:!0});var uie="not_between";function EJe(e,t){return!Iu(eT,t)(e)}un(uie,EJe,{name:NH,inputsCount:2,showOperators:!0});function RJe(e,t){return IJe(e)||PJe(e,t)||AJe(e,t)||kJe()}function kJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AJe(e,t){if(e){if(typeof e=="string")return Pz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pz(e,t)}}function Pz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function IJe(e){if(Array.isArray(e))return e}var fie="begins_with";function MJe(e,t){var r=RJe(t,1),n=r[0];return jr(e.value).toLocaleLowerCase(e.meta.locale).startsWith(jr(n))}un(fie,MJe,{name:OH,inputsCount:1,showOperators:!0});var DJe=pt,cie=$w,NJe=ns.f,LJe=ih,Iz=ln,FJe=wF,$Je=Hi,HJe=SF,Mz=cie("".endsWith),BJe=cie("".slice),VJe=Math.min,hie=HJe("endsWith"),jJe=!hie&&!!function(){var e=NJe(String.prototype,"endsWith");return e&&!e.writable}();DJe({target:"String",proto:!0,forced:!jJe&&!hie},{endsWith:function(t){var r=Iz($Je(this));FJe(t);var n=arguments.length>1?arguments[1]:void 0,i=r.length,a=n===void 0?i:VJe(LJe(n),i),o=Iz(t);return Mz?Mz(r,o,a):BJe(r,a-o.length,a)===o}});function WJe(e,t){return YJe(e)||GJe(e,t)||zJe(e,t)||UJe()}function UJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zJe(e,t){if(e){if(typeof e=="string")return Dz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dz(e,t)}}function Dz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function YJe(e){if(Array.isArray(e))return e}var die="ends_with";function KJe(e,t){var r=WJe(t,1),n=r[0];return jr(e.value).toLocaleLowerCase(e.meta.locale).endsWith(jr(n))}un(die,KJe,{name:EH,inputsCount:1,showOperators:!0});function XJe(e,t){return QJe(e)||JJe(e,t)||ZJe(e,t)||qJe()}function qJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZJe(e,t){if(e){if(typeof e=="string")return Nz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nz(e,t)}}function Nz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JJe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function QJe(e){if(Array.isArray(e))return e}var CB="contains";function eQe(e,t){var r=XJe(t,1),n=r[0];return jr(e.value).toLocaleLowerCase(e.meta.locale).indexOf(jr(n))>=0}un(CB,eQe,{name:RH,inputsCount:1,showOperators:!0});var vie="not_contains";function tQe(e,t){return!Iu(CB,t)(e)}un(vie,tQe,{name:kH,inputsCount:1,showOperators:!0});var pie="date_tomorrow";function rQe(e){var t=Ae(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ae().subtract(-1,"days").startOf("day"),"d"):!1}un(pie,rQe,{name:HH,inputsCount:0});var gie="date_today";function nQe(e){var t=Ae(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ae().startOf("day"),"d"):!1}un(gie,nQe,{name:$H,inputsCount:0});var yie="date_yesterday";function iQe(e){var t=Ae(e.value,e.meta.dateFormat);return t.isValid()?t.isSame(Ae().subtract(1,"days").startOf("day"),"d"):!1}un(yie,iQe,{name:BH,inputsCount:0});wQ();function aQe(e,t){var r=e;return r===""&&(r="(".concat(t,")")),r}var J2=new Set([1]).has(1),oQe=J2&&typeof Array.from=="function";function pS(e){var t=e;return J2&&(t=new Set(t)),function(r){var n;return J2?n=t.has(r):n=!!~t.indexOf(r),n}}function mie(e){return e??""}function Q2(e){var t=e;return oQe?t=Array.from(new Set(t)):t=EF(t),t=t.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),t}function Lz(e,t,r,n){var i=[],a=e===t,o;return a||(o=pS(t)),ne(e,function(s){var l=!1;(a||o(s))&&(l=!0);var u={checked:l,value:s,visualValue:aQe(s,r)};n&&n(u),i.push(u)}),i}function bie(e,t){return fQe(e)||uQe(e,t)||lQe(e,t)||sQe()}function sQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lQe(e,t){if(e){if(typeof e=="string")return Fz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fz(e,t)}}function Fz(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uQe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function fQe(e){if(Array.isArray(e))return e}var nc="by_value";function cQe(e,t){var r=bie(t,1),n=r[0];return n(e.value)}un(nc,cQe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var r=bie(t,1),n=r[0];return[pS(n)]},showOperators:!1});var Db={};function hQe(e){if(!Db[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=Db[e].func;return function(r,n){return t(r,n)}}function dQe(e){return Db[e].name}function xB(e,t,r){Db[e]={name:t,func:r}}var gu="conjunction",vQe=WH;function pQe(e,t){return e.every(function(r){return r.func(t)})}xB(gu,vQe,pQe);var tT="disjunction",gQe=GO;function yQe(e,t){return e.some(function(r){return r.func(t)})}xB(tT,gQe,yQe);var TB="disjunctionWithExtraCondition",mQe=GO;function bQe(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(function(r){return r.func(t)})&&e[e.length-1].func(t)}xB(TB,mQe,bQe);function Nb(e){return Nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nb(e)}var fy;function zk(e,t,r){return t=wQe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wQe(e){var t=SQe(e,"string");return Nb(t)==="symbol"?t:String(t)}function SQe(e,t){if(Nb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _Qe="numeric",wie="text",CQe="date",$z=(fy={},zk(fy,_Qe,[Tn,Lt,_m,pC,Lt,Cm,gC,Lt,aie,oie,sie,lie,eT,uie]),zk(fy,wie,[Tn,Lt,_m,pC,Lt,Cm,gC,Lt,fie,die,Lt,CB,vie]),zk(fy,CQe,[Tn,Lt,_m,pC,Lt,Cm,gC,Lt,_B,SB,eT,Lt,pie,gie,yie]),fy);function xQe(e){var t=[],r=e;return $z[r]||(r=wie),ne($z[r],function(n){var i;n===Lt?i={name:Lt}:i=pi(rc(n)),t.push(i)}),t}function Lb(e){return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function TQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EQe(n.key),n)}}function OQe(e,t,r){return t&&Hz(e.prototype,t),r&&Hz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EQe(e){var t=RQe(e,"string");return Lb(t)==="symbol"?t:String(t)}function RQe(e,t){if(Lb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gk="built",Yk="building",Bz=["click","input","keydown","keypress","keyup","focus","blur","change"],Sie=function(){function e(t,r){TQe(this,e),this.hot=t,this.eventManager=new Fr(this),this.options=an(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return OQe(e,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===Yk?this._element:this.buildState===Gk?(this.update(),this._element):(this.buildState=Yk,this.build(),this.buildState=Gk,this._element)}},{key:"isBuilt",value:function(){return this.buildState===Gk}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(xi)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(o,s){r.eventManager.addEventListener(o,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=Yk),this.options.className&&ke(this._element,this.options.className),this.options.children.length)ne(this.options.children,function(a){return r._element.appendChild(a.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);It(this.options,function(a,o){i[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(i[o]=r.translateIfPossible(a))}),this._element.appendChild(i),ne(Bz,function(a){return n(i,a)})}else ne(Bz,function(a){return n(r._element,a)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return pi({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),e}();yr(Sie,Vi);const yu=Sie;function wp(e){return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function kQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PQe(n.key),n)}}function AQe(e,t,r){return t&&Vz(e.prototype,t),r&&Vz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PQe(e){var t=IQe(e,"string");return wp(t)==="symbol"?t:String(t)}function IQe(e,t){if(wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yC(){return typeof Reflect<"u"&&Reflect.get?yC=Reflect.get.bind():yC=function(t,r,n){var i=MQe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},yC.apply(this,arguments)}function MQe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Sp(e),e!==null););return e}function DQe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eD(e,t)}function eD(e,t){return eD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eD(e,t)}function NQe(e){var t=FQe();return function(){var n=Sp(e),i;if(t){var a=Sp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return LQe(this,i)}}function LQe(e,t){if(t&&(wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _ie(e)}function _ie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sp(e){return Sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sp(e)}var T_=new WeakMap,$Qe=function(e){DQe(r,e);var t=NQe(r);function r(n,i){var a;return kQe(this,r),a=t.call(this,n,an(r.DEFAULTS,i)),T_.set(_ie(a),{}),a.registerHooks(),a}return AQe(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(a){return i.onKeyup(a)})}},{key:"build",value:function(){yC(Sp(r.prototype),"build",this).call(this);var i=T_.get(this),a=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,ke(this._element,"htUIInput"),ke(a,"htUIInputIcon"),this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=T_.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&T_.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return pi({placeholder:"",type:"text",tagName:"input"})}}]),r}(yu);const Bd=$Qe;function _p(e){return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function HQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VQe(n.key),n)}}function BQe(e,t,r){return t&&jz(e.prototype,t),r&&jz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VQe(e){var t=jQe(e,"string");return _p(t)==="symbol"?t:String(t)}function jQe(e,t){if(_p(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_p(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vd(){return typeof Reflect<"u"&&Reflect.get?Vd=Reflect.get.bind():Vd=function(t,r,n){var i=WQe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Vd.apply(this,arguments)}function WQe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=mu(e),e!==null););return e}function UQe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tD(e,t)}function tD(e,t){return tD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tD(e,t)}function zQe(e){var t=YQe();return function(){var n=mu(e),i;if(t){var a=mu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return GQe(this,i)}}function GQe(e,t){if(t&&(_p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cie(e)}function Cie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(e){return mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mu(e)}var O_=new WeakMap,KQe=function(e){UQe(r,e);var t=zQe(r);function r(n,i){var a;return HQe(this,r),a=t.call(this,n,an(r.DEFAULTS,i)),O_.set(Cie(a),{}),a.menu=null,a.items=[],a.registerHooks(),a}return BQe(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var a=this;return ne(i,function(o){o.name=a.translateIfPossible(o.name)}),i}},{key:"build",value:function(){var i=this;Vd(mu(r.prototype),"build",this).call(this),this.menu=new bB(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var a=new yu(this.hot,{className:"htUISelectCaption"}),o=new yu(this.hot,{className:"htUISelectDropdown"}),s=O_.get(this);s.caption=a,s.captionElement=a.element,s.dropdown=o,ne([a,o],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(zO),O_.get(this).captionElement.textContent=i,Vd(mu(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==Lt&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=O_.get(this),a=i.caption,o=i.dropdown;a&&a.destroy(),o&&o.destroy(),Vd(mu(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return pi({className:"htUISelect",wrapIt:!1})}}]),r}(yu);const Wz=KQe;function Cp(e){return Cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cp(e)}function XQe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZQe(n.key),n)}}function qQe(e,t,r){return t&&Uz(e.prototype,t),r&&Uz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZQe(e){var t=JQe(e,"string");return Cp(t)==="symbol"?t:String(t)}function JQe(e,t){if(Cp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mC(){return typeof Reflect<"u"&&Reflect.get?mC=Reflect.get.bind():mC=function(t,r,n){var i=QQe(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},mC.apply(this,arguments)}function QQe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xp(e),e!==null););return e}function eet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rD(e,t)}function rD(e,t){return rD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rD(e,t)}function tet(e){var t=iet();return function(){var n=xp(e),i;if(t){var a=xp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ret(this,i)}}function ret(e,t){if(t&&(Cp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return net(e)}function net(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xp(e){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xp(e)}var aet=function(e){eet(r,e);var t=tet(r);function r(n,i){var a;return XQe(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.addSeparator=i.addSeparator,a.elements.push(new Wz(a.hot,{menuContainer:i.menuContainer})),a.elements.push(new Bd(a.hot,{placeholder:XH})),a.elements.push(new Bd(a.hot,{placeholder:qH})),a.registerHooks(),a}return qQe(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(a){return i.onConditionSelect(a)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),ne(this.getInputElements(),function(a){a.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})})}},{key:"setState",value:function(i){var a=this;if(this.reset(),!!i){var o=pi(i.command);o.name.startsWith(Ur)&&(o.name=this.hot.getTranslatedPhrase(o.name)),this.getSelectElement().setValue(o),ne(i.args,function(s,l){if(l>o.inputsCount-1)return!1;var u=a.getInputElement(l);u.setValue(s),u[o.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||rc(Tn),a=[];return ne(this.getInputElements(),function(o,s){i.inputsCount>s&&a.push(o.getValue())}),{command:i,args:a}}},{key:"updateState",value:function(i,a){var o=rc(i?i.name:Tn);this.state.setValueAtIndex(a,{command:o,args:i?i.args:[]}),i||ne(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof Wz})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof Bd})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){ke(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&ke(s.parentNode,"border");var h=i.hot.rootDocument.createElement("div");return ke(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),a=[rc(Tn)];if(i!==null){var o=i.visualIndex;a=xQe(this.hot.getDataType(0,o,this.hot.countRows(),o))}ne(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(a),mC(xp(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(a[0])}},{key:"onConditionSelect",value:function(i){ne(this.getInputElements(),function(a,o){a[i.inputsCount>o?"show":"hide"](),o===0&&setTimeout(function(){return a.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){fv(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),bo(i)):fv(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),bo(i))}}]),r}(lE);const Kk=aet;function Tp(e){return Tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tp(e)}function oet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uet(n.key),n)}}function set(e,t,r){return t&&zz(e.prototype,t),r&&zz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function uet(e){var t=fet(e,"string");return Tp(t)==="symbol"?t:String(t)}function fet(e,t){if(Tp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bC(){return typeof Reflect<"u"&&Reflect.get?bC=Reflect.get.bind():bC=function(t,r,n){var i=cet(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},bC.apply(this,arguments)}function cet(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Op(e),e!==null););return e}function het(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nD(e,t)}function nD(e,t){return nD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nD(e,t)}function det(e){var t=pet();return function(){var n=Op(e),i;if(t){var a=Op(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return vet(this,i)}}function vet(e,t){if(t&&(Tp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xie(e)}function xie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Op(e){return Op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Op(e)}var E_=new WeakMap,get=function(e){het(r,e);var t=det(r);function r(n,i){var a;return oet(this,r),a=t.call(this,n,an(r.DEFAULTS,i)),E_.set(xie(a),{}),a}return set(r,[{key:"build",value:function(){bC(Op(r.prototype),"build",this).call(this);var i=E_.get(this);i.input=this._element.firstChild;var a=this.hot.rootDocument.createElement("label");a.textContent=this.translateIfPossible(this.options.label.textContent),a.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=a,this._element.appendChild(a),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var i=E_.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&E_.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return pi({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(yu);const Gz=get;function Ep(e){return Ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ep(e)}var Yz;function yet(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function met(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wet(n.key),n)}}function bet(e,t,r){return t&&Kz(e.prototype,t),r&&Kz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wet(e){var t=_et(e,"string");return Ep(t)==="symbol"?t:String(t)}function _et(e,t){if(Ep(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ep(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iD(e,t)}function iD(e,t){return iD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iD(e,t)}function xet(e){var t=Eet();return function(){var n=rT(e),i;if(t){var a=rT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Tet(this,i)}}function Tet(e,t){if(t&&(Ep(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oet(e)}function Oet(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rT(e){return rT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rT(e)}var Xz=0,Ret=function(e){Cet(r,e);var t=xet(r);function r(n,i){var a;return met(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.buildOperatorsElement(),a}return bet(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return ke(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,a=[gu,tT];ne(a,function(o){var s=new Gz(i.hot,{name:"operator",label:{htmlFor:o,textContent:dQe(o)},value:o,checked:o===a[Xz],id:o});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(sr(Yz||(Yz=yet(["Radio button with index "," doesn't exist."])),i));ne(this.elements,function(a,o){a.setChecked(o===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(a){return a instanceof Gz&&a.isChecked()});return i?i.getValue():gu}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&ne(this.elements,function(a){a.setChecked(a.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gu,a=arguments.length>1?arguments[1]:void 0,o=i;o===TB&&(o=tT),this.state.setValueAtIndex(a,o)}},{key:"reset",value:function(){this.setChecked(Xz)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(lE);const ket=Ret;var Aet=Mt,Pet=Hi,qz=ln,Iet=/"/g,Met=Aet("".replace),Det=function(e,t,r,n){var i=qz(Pet(e)),a="<"+t;return r!==""&&(a+=" "+r+'="'+Met(qz(n),Iet,"&quot;")+'"'),a+">"+i+"</"+t+">"},Net=Tt,Let=function(e){return Net(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})},Fet=pt,$et=Det,Het=Let;Fet({target:"String",proto:!0,forced:Het("link")},{link:function(t){return $et(this,"a","href",t)}});function Rp(e){return Rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rp(e)}function Bet(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jet(n.key),n)}}function Vet(e,t,r){return t&&Zz(e.prototype,t),r&&Zz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jet(e){var t=Wet(e,"string");return Rp(t)==="symbol"?t:String(t)}function Wet(e,t){if(Rp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wC(){return typeof Reflect<"u"&&Reflect.get?wC=Reflect.get.bind():wC=function(t,r,n){var i=Uet(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},wC.apply(this,arguments)}function Uet(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=kp(e),e!==null););return e}function zet(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aD(e,t)}function aD(e,t){return aD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aD(e,t)}function Get(e){var t=Ket();return function(){var n=kp(e),i;if(t){var a=kp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Yet(this,i)}}function Yet(e,t){if(t&&(Rp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tie(e)}function Tie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ket(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kp(e){return kp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kp(e)}var Xk=new WeakMap,Xet=function(e){zet(r,e);var t=Get(r);function r(n,i){var a;return Bet(this,r),a=t.call(this,n,an(r.DEFAULTS,i)),Xk.set(Tie(a),{}),a}return Vet(r,[{key:"build",value:function(){wC(kp(r.prototype),"build",this).call(this);var i=Xk.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(Xk.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return pi({href:"#",tagName:"a"})}}]),r}(yu);const Jz=Xet;function Ap(e){return Ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ap(e)}function Qz(e){return Qet(e)||Jet(e)||Zet(e)||qet()}function qet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zet(e,t){if(e){if(typeof e=="string")return oD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oD(e,t)}}function Jet(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qet(e){if(Array.isArray(e))return oD(e)}function oD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ett(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rtt(n.key),n)}}function ttt(e,t,r){return t&&eG(e.prototype,t),r&&eG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rtt(e){var t=ntt(e,"string");return Ap(t)==="symbol"?t:String(t)}function ntt(e,t){if(Ap(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ap(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jd(){return typeof Reflect<"u"&&Reflect.get?jd=Reflect.get.bind():jd=function(t,r,n){var i=itt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},jd.apply(this,arguments)}function itt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=bu(e),e!==null););return e}function att(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sD(e,t)}function sD(e,t){return sD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sD(e,t)}function ott(e){var t=ltt();return function(){var n=bu(e),i;if(t){var a=bu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return stt(this,i)}}function stt(e,t){if(t&&(Ap(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oie(e)}function Oie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ltt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(e){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bu(e)}var utt=new WeakMap,ftt="multipleSelect.itemBox",ctt=function(e){att(r,e);var t=ott(r);function r(n,i){var a;return ett(this,r),a=t.call(this,n,an(r.DEFAULTS,i)),utt.set(Oie(a),{}),a.searchInput=new Bd(a.hot,{placeholder:KH,className:"htUIMultipleSelectSearch"}),a.selectAllUI=new Jz(a.hot,{textContent:UH,className:"htUISelectAll"}),a.clearAllUI=new Jz(a.hot,{textContent:zH,className:"htUIClearAll"}),a.items=[],a.itemsBox=null,a.registerHooks(),a}return ttt(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)}),this.searchInput.addLocalHook("input",function(a){return i.onInput(a)}),this.selectAllUI.addLocalHook("click",function(a){return i.onSelectAllClick(a)}),this.clearAllUI.addLocalHook("click",function(a){return i.onClearAllClick(a)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return Qz(this.items)}},{key:"getValue",value:function(){return dtt(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;jd(bu(r.prototype),"build",this).call(this);var a=this.hot.rootDocument,o=a.createElement("div"),s=new yu(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(o);var l=function(f){if(i._element){i.itemsBox&&i.itemsBox.destroy(),ke(f,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(f,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(v,p,g,y,m,b){v.title=b.instance.getDataAtRowProp(p,b.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-Sn(a)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var c=i.itemsBox.getShortcutManager(),h=c.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(v){i.runLocalHooks("keydown",v,i)},group:ftt})}};l(o),setTimeout(function(){return l(o)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(htt(this.items,this.options.value)),jd(bu(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,jd(bu(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var a=this,o=i.target.value.toLocaleLowerCase(this.getLocale()),s;o===""?s=Qz(this.items):s=ra(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(a.getLocale()).indexOf(o)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var a=a$(fv,i.keyCode);a("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(bo(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var a=[];i.preventDefault(),ne(this.itemsBox.getSourceData(),function(o,s){o.checked=!0,a.push(BM(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}},{key:"onClearAllClick",value:function(i){var a=[];i.preventDefault(),ne(this.itemsBox.getSourceData(),function(o,s){o.checked=!1,a.push(BM(o,s)[0])}),this.itemsBox.setSourceDataAtCell(a)}}],[{key:"DEFAULTS",get:function(){return pi({className:"htUIMultipleSelect",value:[]})}}]),r}(yu);const tG=ctt;function htt(e,t){var r=pS(t);return At(e,function(n){return n.checked=r(n.value),n})}function dtt(e){var t=[];return ne(e,function(r){r.checked&&t.push(r.value)}),t}function Pp(e){return Pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pp(e)}function vtt(e,t){return mtt(e)||ytt(e,t)||gtt(e,t)||ptt()}function ptt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gtt(e,t){if(e){if(typeof e=="string")return rG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rG(e,t)}}function rG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ytt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function mtt(e){if(Array.isArray(e))return e}function btt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Stt(n.key),n)}}function wtt(e,t,r){return t&&nG(e.prototype,t),r&&nG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Stt(e){var t=_tt(e,"string");return Pp(t)==="symbol"?t:String(t)}function _tt(e,t){if(Pp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SC(){return typeof Reflect<"u"&&Reflect.get?SC=Reflect.get.bind():SC=function(t,r,n){var i=Ctt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},SC.apply(this,arguments)}function Ctt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ip(e),e!==null););return e}function xtt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lD(e,t)}function lD(e,t){return lD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lD(e,t)}function Ttt(e){var t=Rtt();return function(){var n=Ip(e),i;if(t){var a=Ip(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ott(this,i)}}function Ott(e,t){if(t&&(Pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ett(e)}function Ett(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ip(e)}var ktt=function(e){xtt(r,e);var t=Ttt(r);function r(n,i){var a;return btt(this,r),a=t.call(this,n,{id:i.id,stateless:!1}),a.name=i.name,a.elements.push(new tG(a.hot)),a.registerHooks(),a}return wtt(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===nc){var a=this.getMultipleSelectElement();a.setItems(i.itemsSnapshot),a.setValue(i.args[0]),a.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),a=i.getItems();return{command:{key:i.isSelectedAllValues()||!a.length?Tn:nc},args:[i.getValue()],itemsSnapshot:a}}},{key:"updateState",value:function(i){var a=this,o=function(l,u,f,c,h){var d=ra(u,function(T){return T.name===nc}),v=vtt(d,1),p=v[0],g={},y=a.hot.getTranslatedPhrase(jx);if(p){var m=Q2(At(c(l,h),function(T){return T.value}));f&&(p.args[0]=f);var b=[],S=Lz(m,p.args[0],y,function(T){T.checked&&b.push(T.value)}),x=i.editedConditionStack.column;g.locale=a.hot.getCellMeta(0,x).locale,g.args=[b],g.command=rc(nc),g.itemsSnapshot=S}else g.args=[],g.command=rc(Tn);a.state.setValueAtIndex(l,g)};o(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&o(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof tG})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s,l,u,f,c){ke(s.parentNode,"htFiltersMenuValue");var h=i.hot.rootDocument.createElement("div");return ke(h,"htFiltersMenuLabel"),h.textContent=c,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(jx),a=Q2(this._getColumnVisibleValues()),o=Lz(a,a,i);this.getMultipleSelectElement().setItems(o),SC(Ip(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(a);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){fv(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),bo(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:At(this.hot.getDataAtCol(i.visualIndex),function(a){return mie(a)})}}]),r}(lE);const Att=ktt;function Mp(e){return Mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mp(e)}function Ptt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mtt(n.key),n)}}function Itt(e,t,r){return t&&iG(e.prototype,t),r&&iG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mtt(e){var t=Dtt(e,"string");return Mp(t)==="symbol"?t:String(t)}function Dtt(e,t){if(Mp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ntt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uD(e,t)}function uD(e,t){return uD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uD(e,t)}function Ltt(e){var t=Htt();return function(){var n=nT(e),i;if(t){var a=nT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ftt(this,i)}}function Ftt(e,t){if(t&&(Mp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $tt(e)}function $tt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Htt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nT(e){return nT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nT(e)}var Btt=function(e){Ntt(r,e);var t=Ltt(r);function r(n,i){var a;return Ptt(this,r),a=t.call(this,n,{id:i.id,stateless:!0}),a.name=i.name,a.elements.push(new Bd(a.hot,{type:"button",value:GH,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),a.elements.push(new Bd(a.hot,{type:"button",value:YH,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),a.registerHooks(),a}return Itt(r,[{key:"registerHooks",value:function(){var i=this;ne(this.elements,function(a){a.addLocalHook("click",function(o,s){return i.onButtonClick(o,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(o,s){return ke(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||ne(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,a){a.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(lE);const Vtt=Btt;function Fb(e){return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fb(e)}var aG,oG;function sG(e,t){return ztt(e)||Utt(e,t)||Wtt(e,t)||jtt()}function jtt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wtt(e,t){if(e){if(typeof e=="string")return lG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lG(e,t)}}function lG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Utt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ztt(e){if(Array.isArray(e))return e}function uG(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Gtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ktt(n.key),n)}}function Ytt(e,t,r){return t&&fG(e.prototype,t),r&&fG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ktt(e){var t=Xtt(e,"string");return Fb(t)==="symbol"?t:String(t)}function Xtt(e,t){if(Fb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cG="ConditionCollection.filteringStates",Eie=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Gtt(this,e),this.hot=t,this.isMapRegistrable=r,this.filteringStates=new UO,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(cG,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return Ytt(e,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,a=this.filteringStates.getValueAtIndex(n),o=(i=a==null?void 0:a.conditions)!==null&&i!==void 0?i:[],s=a==null?void 0:a.operation;return this.isMatchInConditions(o,r,s)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gu;return r.length?hQe(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gu,a=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,r).locale,s=At(n.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(o):c}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==i)throw Error(sr(aG||(aG=uG(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(pr(Db[i]))throw new Error(sr(oG||(oG=uG(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var f=this.getConditions(r);f.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:l,args:s,func:Iu(l,s)}]},a):f.push({name:l,args:s,func:Iu(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=sG(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Zr(this.filteringStates.getEntries(),function(r,n){var i=sG(n,2),a=i[0],o=i[1],s=o.operation,l=o.conditions;return r.push({column:a,operation:s,conditions:At(l,function(u){var f=u.name,c=u.args;return{name:f,args:c}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),ne(r,function(i){ne(i.conditions,function(a){return n.addCondition(i.column,a)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(a){return a.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(cG),this.filteringStates=null,this.clearLocalHooks()}}]),e}();yr(Eie,Vi);const Rie=Eie;function $b(e){return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function qtt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jtt(n.key),n)}}function Ztt(e,t,r){return t&&hG(e.prototype,t),r&&hG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jtt(e){var t=Qtt(e,"string");return $b(t)==="symbol"?t:String(t)}function Qtt(e,t){if($b(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($b(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ert=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};qtt(this,e),this.conditionCollection=t,this.columnDataFactory=r}return Ztt(e,[{key:"filter",value:function(){var r=this,n=[];return ne(this.conditionCollection.getFilteredColumns(),function(i,a){var o=r.columnDataFactory(i);a&&(o=r._getIntersectData(o,n)),n=r.filterByColumn(i,o)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[];return ne(i,function(o){o!==void 0&&n.conditionCollection.isMatch(o,r)&&a.push(o)}),a}},{key:"_getIntersectData",value:function(r,n){var i=[];return ne(n,function(a){var o=a.meta.visualRow;r[o]!==void 0&&(i[o]=r[o])}),i}}]),e}();const kie=ert;function Hb(e){return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(e)}function trt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nrt(n.key),n)}}function rrt(e,t,r){return t&&dG(e.prototype,t),r&&dG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nrt(e){var t=irt(e,"string");return Hb(t)==="symbol"?t:String(t)}function irt(e,t){if(Hb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aie=function(){function e(t,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};trt(this,e),this.hot=t,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(a){return n._onConditionBeforeModify(a)}),this.conditionCollection.addLocalHook("afterRemove",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("afterAdd",function(a){return n.updateStatesAtColumn(a)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return rrt(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,ne(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var a=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(r);o===-1&&(o=this.latestEditedColumnPosition);var s=a.slice(0,o),l=a.slice(o);l.length&&l[0].column===r&&l.shift();var u=Uee(function(c,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=new Rie(i.hot,!1),p=[].concat(c,d);v.importAllConditions(p);var g=i.columnDataFactory(h),y;v.isEmpty()?y=g:y=new kie(v,function(b){return i.columnDataFactory(b)}).filter(),y=At(y,function(b){return b.meta.visualRow});var m=pS(y);return v.destroy(),ra(g,function(b){return m(b.meta.visualRow)})})(s),f=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:f},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;ne(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),It(this,function(n,i){r[i]=null})}}]),e}();yr(Aie,Vi);const art=Aie;function Dp(e){return Dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(e)}var vG;function ort(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function srt(e,t){return crt(e)||frt(e,t)||urt(e,t)||lrt()}function lrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function urt(e,t){if(e){if(typeof e=="string")return pG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pG(e,t)}}function pG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function frt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function crt(e){if(Array.isArray(e))return e}function hrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vrt(n.key),n)}}function drt(e,t,r){return t&&gG(e.prototype,t),r&&gG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vrt(e){var t=prt(e,"string");return Dp(t)==="symbol"?t:String(t)}function prt(e,t){if(Dp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wd(){return typeof Reflect<"u"&&Reflect.get?Wd=Reflect.get.bind():Wd=function(t,r,n){var i=grt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Wd.apply(this,arguments)}function grt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=wu(e),e!==null););return e}function yrt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fD(e,t)}function fD(e,t){return fD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fD(e,t)}function mrt(e){var t=wrt();return function(){var n=wu(e),i;if(t){var a=wu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return brt(this,i)}}function brt(e,t){if(t&&(Dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pie(e)}function Pie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wu(e){return wu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wu(e)}var yG="filters",Srt=250,_rt=function(e){yrt(r,e);var t=mrt(r);function r(n){var i;return hrt(this,r),i=t.call(this,n),i.eventManager=new Fr(Pie(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(a,o){return i.onAfterGetColHeader(a,o)}),i}return drt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[yG]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new sS),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var a=this.hot.getSettings().dropdownMenu,o=a&&a.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(v){return i.onComponentChange(d,v)}),d},l=function(){return"".concat(i.hot.getTranslatedPhrase(VH),":")},u=function(){return"".concat(i.hot.getTranslatedPhrase(jH),":")};if(!this.components.get("filter_by_condition")){var f=new Kk(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:o});f.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(f))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ket(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new Kk(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:o});c.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new Att(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new Vtt(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Rie(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new art(this.hot,this.conditionCollection,function(h){return i.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return i.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return i.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return i.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return i.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Wd(wu(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var a;(a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(o,s){o.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}Wd(wu(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,a,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:gu,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:a},args:o},s)}},{key:"removeConditions",value:function(i){var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var a=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(a)}}},{key:"filter",value:function(){var i=this,a=this._createDataFilter(),o=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(o){var f=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=At(a.filter(),function(h){return h.meta.visualRow});var c=pS(s);rt(i.hot.countSourceRows()-1,function(h){c(h)||f.push(h)}),ne(f,function(h){i.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return a?{visualIndex:a.col,physicalIndex:this.hot.toPhysicalColumn(a.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var a=this,o=this.hot.toVisualColumn(i),s=[];return ne(this.hot.getSourceDataAtCol(o),function(l,u){var f,c=a.hot.getCellMeta(u,o),h=c.row,d=c.col,v=c.visualCol,p=c.visualRow,g=c.type,y=c.instance,m=c.dateFormat,b=c.locale,S=(f=a.hot.getDataAtCell(a.hot.toVisualRow(u),o))!==null&&f!==void 0?f:l;s.push({meta:{row:h,col:d,visualCol:v,visualRow:p,type:g,instance:y,dateFormat:m,locale:b},value:mie(S)})}),s}},{key:"onAfterChange",value:function(i){var a=this;i&&ne(i,function(o){var s=srt(o,2),l=s[1],u=a.hot.propToCol(l);a.conditionCollection.hasConditions(u)&&a.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(i){var a=this.hot.getDataAtCol(i),o=Q2(a);this.conditionUpdateObserver.updateStatesAtColumn(i,o)}},{key:"restoreComponents",value:function(i){var a,o=(a=this.getSelectedColumn())===null||a===void 0?void 0:a.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(o)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:Lt}),this.components.forEach(function(a){i.items.push(a.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,a,o,s){var l=i;return l===tT&&a.command.key!==Tn&&o.command.key!==Tn&&s.command.key!==Tn?l=TB:s.command.key!==Tn&&(a.command.key===Tn||o.command.key===Tn)&&(l=gu),l}},{key:"onActionBarSubmit",value:function(i){var a;if(i==="accept"){var o=this.getSelectedColumn();if(o===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=o.physicalIndex,u=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,f,c);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(l);d===-1&&(d=void 0),this.conditionCollection.removeConditions(l),u.command.key!==Tn&&(this.conditionCollection.addCondition(l,u,h,d),f.command.key!==Tn&&this.conditionCollection.addCondition(l,f,h,d)),c.command.key!==Tn&&this.conditionCollection.addCondition(l,c,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(v){return v.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(a=this.dropdownMenuPlugin)===null||a===void 0||a.close()}},{key:"onComponentChange",value:function(i,a){this.updateDependentComponentsVisibility(),i.constructor===Kk&&!a.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),a=i.getState(),o=a.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];o.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,a){var o=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(o)?ke(a,"htFiltersActive"):St(a,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new kie(a,function(o){return i.getDataMapAtColumn(o)})}},{key:"updateComponents",value:function(i){var a;if((a=this.dropdownMenuPlugin)!==null&&a!==void 0&&a.enabled){var o=i.editedConditionStack,s=o.conditions,l=o.column,u=s.filter(function(h){return h.name===nc}),f=s.filter(function(h){return h.name!==nc});if(u.length>=2||f.length>=3)gr(sr(vG||(vG=ort([`The filter conditions have been applied properly, but couldnât be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldnât be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(f[0],l),this.components.get("filter_by_condition2").updateState(f[1],l),this.components.get("filter_operators").updateState(c,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var a=this.dropdownMenuPlugin.menu,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return ne(s,function(u){ne(a.menuItems,function(f,c){f.key===u.getMenuItemDescriptor().key&&i.push(c)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var a=this.dropdownMenuPlugin.menu,o=a.hotMenu,s=o.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];var c=this.getIndexesOfComponents.apply(this,u);i?s.showRows(c):s.hideRows(c),o.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!1].concat(a))}},{key:"showComponents",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.changeComponentsVisibility.apply(this,[!0].concat(a))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(a,o){a!==null&&(a.destroy(),i.components.set(o,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),Wd(wu(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yG}},{key:"PLUGIN_PRIORITY",get:function(){return Srt}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(er);function Bb(e){return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(e)}function mG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mG(Object(r),!0).forEach(function(n){Crt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Crt(e,t,r){return t=xrt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xrt(e){var t=Trt(e,"string");return Bb(t)==="symbol"?t:String(t)}function Trt(e,t){if(Bb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Iie="internal-use-in-handsontable",Ort={licenseKey:Iie,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Mie(e){var t,r;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[ui])===null||t===void 0||(r=t.language)===null||r===void 0?void 0:r.langCode}}function Die(e){return Object.keys(e).reduce(function(t,r){return r!=="hyperformula"&&(t[r]=e[r]),t},{})}function Ert(e){var t,r=e[ui],n=Die(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Mie(e);return xm(xm(xm({},Ort),n),i)}function Rrt(e){var t,r=e[ui],n=Die(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),i=Mie(e);return xm(xm({},n),i)}function cD(e){return cD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cD(e)}function uE(){var e="engine_relationship",t=Ha(ui);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function OB(){var e="shared_engine_usage",t=Ha(ui);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function krt(e){var t=e.getSettings(),r=t[ui],n=r==null?void 0:r.engine;if(r===!0||pr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return Art((i=n.hyperformula)!==null&&i!==void 0?i:n,t,e)}else if(cD(n)==="object"&&pr(n.hyperformula)){var a=uE(),o=OB().get(n);return a.has(n)||a.set(n,[]),a.get(n).push(e),o&&o.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Iie}),n}return null}function Art(e,t,r){var n=t[ui],i=Ert(t),a=uE(),o=OB();Prt(e,n.functions),Irt(e,n.language);var s=e.buildEmpty(i);return a.set(s,[r]),o.set(s,[r.guid]),Mrt(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function bG(e){var t,r=uE(),n=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function wG(e,t){if(e){var r=uE(),n=r.get(e),i=OB(),a=i.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),n.length===0&&r.delete(e)),a&&a.includes(t.guid)&&(a.splice(a.indexOf(t.guid),1),a.length===0&&(i.delete(e),e.destroy()))}}function Prt(e,t){t&&t.forEach(function(r){var n=r.name,i=r.plugin,a=r.translations;try{e.registerFunction(n,i,a)}catch(o){gr(o.message)}})}function Irt(e,t){if(t){var r=t.langCode;try{e.registerLanguage(r,t)}catch(n){gr(n.message)}}}function Mrt(e,t){t&&(e.suspendEvaluation(),t.forEach(function(r){var n=r.name,i=r.expression,a=r.scope,o=r.options;try{e.addNamedExpression(n,i,a,o)}catch(s){gr(s.message)}}),e.resumeEvaluation())}function Drt(e,t){return(pr(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}function Nie(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function Nrt(e){return Nie(e)?e.substr(1):e}function Lrt(e){return Hrt(e)||$rt(e)||Lie(e)||Frt()}function Frt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $rt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Hrt(e){if(Array.isArray(e))return hD(e)}function SG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _G(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SG(Object(r),!0).forEach(function(n){_C(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mu(e){return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(e)}function zh(e,t){return jrt(e)||Vrt(e,t)||Lie(e,t)||Brt()}function Brt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lie(e,t){if(e){if(typeof e=="string")return hD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(e,t)}}function hD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vrt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function jrt(e){if(Array.isArray(e))return e}function Wrt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fie(n.key),n)}}function Urt(e,t,r){return t&&CG(e.prototype,t),r&&CG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ic(){return typeof Reflect<"u"&&Reflect.get?ic=Reflect.get.bind():ic=function(t,r,n){var i=zrt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ic.apply(this,arguments)}function zrt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Us(e),e!==null););return e}function Grt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dD(e,t)}function dD(e,t){return dD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dD(e,t)}function Yrt(e){var t=Xrt();return function(){var n=Us(e),i;if(t){var a=Us(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Krt(this,i)}}function Krt(e,t){if(t&&(Mu(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Df(e)}function Df(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Us(e){return Us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Us(e)}function _C(e,t,r){return t=Fie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fie(e){var t=qrt(e,"string");return Mu(t)==="symbol"?t:String(t)}function qrt(e,t){if(Mu(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qk(e,t,r){Zrt(e,t),t.set(e,r)}function Zrt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gh(e,t,r){var n=$ie(e,t,"set");return Jrt(e,n,r),r}function Jrt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function Yh(e,t){var r=$ie(e,t,"get");return Qrt(e,r)}function $ie(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Qrt(e,t){return t.get?t.get.call(e):t.value}var ui="formulas",ent=260,xG="row_move";Qe.getSingleton().register("afterNamedExpressionAdded");Qe.getSingleton().register("afterNamedExpressionRemoved");Qe.getSingleton().register("afterSheetAdded");Qe.getSingleton().register("afterSheetRemoved");Qe.getSingleton().register("afterSheetRenamed");Qe.getSingleton().register("afterFormulasValuesUpdate");var Kh=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},of=new WeakMap,Zk=new WeakMap,cy=new WeakMap,tnt=function(e){Grt(r,e);var t=Yrt(r);function r(){var n;Wrt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),qk(Df(n),of,{writable:!0,value:!1}),qk(Df(n),Zk,{writable:!0,value:!1}),qk(Df(n),cy,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),_C(Df(n),"staticRegister",Ha("formulas")),_C(Df(n),"engine",null),_C(Df(n),"sheetName",null),n}return Urt(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ui]}},{key:"enablePlugin",value:function(){var i,a=this;if(!this.enabled){if(this.engine=(i=krt(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){gr("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var o=this.addSheet(this.sheetName,this.hot.getSourceDataArray());o!==!1&&(this.sheetName=o)}this.addHook("beforeLoadData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterLoadData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("beforeUpdateData",function(){return a.onBeforeLoadData.apply(a,arguments)}),this.addHook("afterUpdateData",function(){return a.onAfterLoadData.apply(a,arguments)}),this.addHook("modifyData",function(){return a.onModifyData.apply(a,arguments)}),this.addHook("modifySourceData",function(){return a.onModifySourceData.apply(a,arguments)}),this.addHook("beforeValidate",function(){return a.onBeforeValidate.apply(a,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return a.onAfterSetSourceDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtCell",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return a.onAfterSetDataAtCell.apply(a,arguments)}),this.addHook("beforeCreateRow",function(){return a.onBeforeCreateRow.apply(a,arguments)}),this.addHook("beforeCreateCol",function(){return a.onBeforeCreateCol.apply(a,arguments)}),this.addHook("afterCreateRow",function(){return a.onAfterCreateRow.apply(a,arguments)}),this.addHook("afterCreateCol",function(){return a.onAfterCreateCol.apply(a,arguments)}),this.addHook("beforeRemoveRow",function(){return a.onBeforeRemoveRow.apply(a,arguments)}),this.addHook("beforeRemoveCol",function(){return a.onBeforeRemoveCol.apply(a,arguments)}),this.addHook("afterRemoveRow",function(){return a.onAfterRemoveRow.apply(a,arguments)}),this.addHook("afterRemoveCol",function(){return a.onAfterRemoveCol.apply(a,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==xG&&a.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==xG&&a.engine.redo()}),this.addHook("afterDetachChild",function(){return a.onAfterDetachChild.apply(a,arguments)}),this.addHook("beforeAutofill",function(){return a.onBeforeAutofill.apply(a,arguments)}),Yh(this,cy).forEach(function(s){var l=zh(s,2),u=l[0],f=l[1];return a.engine.on(u,f)}),ic(Us(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;Yh(this,cy).forEach(function(a){var o=zh(a,2),s=o[0],l=o[1];return i.engine.off(s,l)}),wG(this.engine,this.hot),this.engine=null,ic(Us(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(Rrt(this.hot.getSettings()));var a=this.hot.getSettings()[ui];if(Xe(a)&&Xe(a.sheetName)&&a.sheetName!==this.sheetName&&this.switchSheet(a.sheetName),!i.data&&this.sheetName===null){var o=this.hot.getSettings()[ui].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}ic(Us(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;Yh(this,cy).forEach(function(a){var o,s=zh(a,2),l=s[0],u=s[1];return(o=i.engine)===null||o===void 0?void 0:o.off(l,u)}),Gh(this,cy,null),wG(this.engine,this.hot),this.engine=null,ic(Us(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,a,o,s,l){return!l&&i>=o?s+(i-o):a}},{key:"toPhysicalRowPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),a)}},{key:"toPhysicalColumnPosition",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),a)}},{key:"addSheet",value:function(i,a){if(Xe(a)&&!cre(a))return gr("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return gr("Sheet with the provided name already exists."),!1;try{var o=this.engine.addSheet(i??void 0);return a&&this.engine.setSheetContent(this.engine.getSheetId(o),a),o}catch(s){return gr(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){o$("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var a=this.engine.getSheetSerialized(this.sheetId);a.length>0&&this.hot.loadData(a,"".concat(Ni(ui),".switchSheet"))}},{key:"getCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s!==null&&l!==null?this.engine.getCellType({sheet:o,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(a);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:o,row:s,col:l})}},{key:"renderDependentSheets",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var u,f=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;f!==void 0&&(s.has(f)||s.add(f))}),bG(this.engine).forEach(function(l,u){if((o||u!==a.sheetId)&&s.has(u)){var f;l.render(),(f=l.view)===null||f===void 0||f.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(f){var c,h=(c=f==null?void 0:f.address)!==null&&c!==void 0?c:{},d=h.row,v=h.col,p=h.sheet;return Xe(p)?"".concat(p,":").concat(d,"x").concat(v):""},l=new Set(o.map(function(u){return s(u)}));i.forEach(function(u){var f,c,h=(f=u.address)!==null&&f!==void 0?f:{},d=h.row,v=h.col,p=Xe(d)?a.hot.toVisualRow(d):null,g=Xe(v)?a.hot.toVisualColumn(v):null;if(!(p===null||g===null)){var y=u==null||(c=u.address)===null||c===void 0?void 0:c.sheet,m=s(u);if(y!==void 0&&!l.has(m)){var b=bG(a.engine).get(y);if(!b)return;b.validateCell(b.getDataAtCell(p,g),b.getCellMeta(p,g),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,a,o){var s={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(a),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){gr("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,o)}},{key:"onBeforeValidate",value:function(i,a,o){var s=this.hot.propToCol(o);if(this.isFormulaCellType(a,s)){var l={row:this.hot.toPhysicalRow(a),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return Mu(u)==="object"&&u!==null?u.value:u}return i}},{key:"onBeforeAutofill",value:function(i,a,o){var s=this,l=function(h){return _G(_G({},h),{},{sheet:s.sheetId})},u={start:l(a.getTopStartCorner()),end:l(a.getBottomEndCorner())},f={start:l(o.getTopStartCorner()),end:l(o.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(f)===!1?!1:this.engine.getFillRangeData(u,f)}},{key:"onBeforeLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";o.includes(Ni(ui))||Gh(this,Zk,pr(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!o.includes(Ni(ui)))if(this.sheetName=Drt(this.engine,this.hot.getSettings()[ui].sheetName),Yh(this,Zk))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){Gh(this,of,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),Gh(this,of,!1)}}}},{key:"onModifyData",value:function(i,a,o,s){if(!(s!=="get"||Yh(this,of)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.isFormulaCellType(l,a);if(!u){var f=this.getCellType(l,a);if(f!=="ARRAY"){Nie(o.value)&&(o.value=Nrt(o.value));return}}var c={row:i,col:this.toPhysicalColumnPosition(a),sheet:this.sheetId},h=this.engine.getCellValue(c),d=Mu(h)==="object"&&h!==null?h.value:h;o.value=d}}},{key:"onModifySourceData",value:function(i,a,o,s){if(!(s!=="get"||Yh(this,of)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.hot.propToCol(a),f=this.isFormulaCellType(l,u);if(!f){var c=this.getCellType(l,u);if(c!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:i,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};o.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(i,a){var o=this;if(!Kh(a)){var s=[],l=[],u=this.engine.batch(function(){i.forEach(function(f){var c=zh(f,4),h=c[0],d=c[1],v=c[3],p=o.hot.propToCol(d),g=o.hot.toPhysicalRow(h),y=o.hot.toPhysicalColumn(p),m={row:g,col:y,sheet:o.sheetId};g!==null&&y!==null?o.syncChangeWithEngine(h,p,v):s.push([h,p,v]),l.push({address:m})})});s.length&&this.hot.addHookOnce("afterChange",function(){var f=o.engine.batch(function(){s.forEach(function(c){var h=zh(c,3),d=h[0],v=h[1],p=h[2];o.syncChangeWithEngine(d,v,p)})});o.renderDependentSheets(f,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,a){var o=this;if(!Kh(a)){var s=[],l=[];i.forEach(function(u){var f=zh(u,4),c=f[0],h=f[1],d=f[3],v=o.hot.propToCol(h);if(Xi(v)){var p={row:c,col:o.toPhysicalColumnPosition(v),sheet:o.sheetId};if(!o.engine.isItPossibleToSetCellContents(p)){gr("Not possible to set source cell data at ".concat(JSON.stringify(p)));return}l.push({address:p}),s.push.apply(s,Lrt(o.engine.setCellContents(p,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),a]))return!1}},{key:"onBeforeCreateCol",value:function(i,a){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]))return!1}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,a,o){var s=this,l=o.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,a,o){if(!Kh(o)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,a,o){if(!Kh(o)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),a]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(!Kh(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeRows(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterRemoveCol",value:function(i,a,o,s){var l=this;if(!Kh(s)){var u=o.sort().reverse(),f=this.engine.batch(function(){u.forEach(function(c){l.engine.removeColumns(l.sheetId,[c,1])})});this.renderDependentSheets(f)}}},{key:"onAfterDetachChild",value:function(i,a,o){var s,l=this;Gh(this,of,!0);var u=this.hot.getSourceDataArray(o,0,o+(((s=a.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());Gh(this,of,!1),u.forEach(function(f,c){f.forEach(function(h,d){l.engine.setCellContents({col:d,row:o+c,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,a){this.hot.runHooks("afterNamedExpressionAdded",i,a)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,a){this.hot.runHooks("afterNamedExpressionRemoved",i,a)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,a){this.hot.runHooks("afterSheetRenamed",i,a)}},{key:"onEngineSheetRemoved",value:function(i,a){this.hot.runHooks("afterSheetRemoved",i,a)}}],[{key:"PLUGIN_KEY",get:function(){return ui}},{key:"PLUGIN_PRIORITY",get:function(){return ent}}]),r}(er);function rnt(e,t){return ont(e)||ant(e,t)||int(e,t)||nnt()}function nnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function int(e,t){if(e){if(typeof e=="string")return TG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TG(e,t)}}function TG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ant(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function ont(e){if(Array.isArray(e))return e}function snt(e){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=rnt(r,4),a=i[1],o=i[3];a-o!==0&&(n=1)}return this.getTranslatedPhrase(mH,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.col,i.col),0),o=Math.max(n.col,i.col),s=[],l=a;l<=o;l+=1)s.push(l);e.hideColumns(s);var u=s[s.length-1],f=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectColumns(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function R_(e){return cnt(e)||fnt(e)||unt(e)||lnt()}function lnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function unt(e,t){if(e){if(typeof e=="string")return vD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vD(e,t)}}function fnt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cnt(e){if(Array.isArray(e))return vD(e)}function vD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hnt(e){var t=[];return{key:"hidden_columns_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(bH,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countCols();s||this.selectColumns(a,o)}},disabled:!1,hidden:function(){var n=this,i=At(e.getHiddenColumns(),function(m){return n.toPhysicalColumn(m)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().col,s=a.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var p=c.slice(o,s+1);h.push.apply(h,R_(p.filter(function(m){return i.includes(m)})))}}else if(u===0&&u<o)h.push.apply(h,R_(c.slice(0,o)));else if(u===null)h.push.apply(h,R_(c.slice(0,this.countCols())));else{var g=this.countCols()-1,y=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));f===y&&g>s&&h.push.apply(h,R_(c.slice(s+1)))}return ne(h,function(m){t.push(n.toVisualColumn(m))}),t.length===0}}}function Np(e){return Np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(e)}function dnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pnt(n.key),n)}}function vnt(e,t,r){return t&&OG(e.prototype,t),r&&OG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pnt(e){var t=gnt(e,"string");return Np(t)==="symbol"?t:String(t)}function gnt(e,t){if(Np(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Np(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ac(){return typeof Reflect<"u"&&Reflect.get?ac=Reflect.get.bind():ac=function(t,r,n){var i=ynt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},ac.apply(this,arguments)}function ynt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zs(e),e!==null););return e}function mnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pD(e,t)}function pD(e,t){return pD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pD(e,t)}function bnt(e){var t=Snt();return function(){var n=zs(e),i;if(t){var a=zs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return wnt(this,i)}}function wnt(e,t){if(t&&(Np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gD(e)}function gD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Snt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zs(e){return zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zs(e)}function EG(e,t,r){_nt(e,t),t.set(e,r)}function _nt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ui(e,t){var r=Hie(e,t,"get");return Cnt(e,r)}function Cnt(e,t){return t.get?t.get.call(e):t.value}function hy(e,t,r){var n=Hie(e,t,"set");return xnt(e,n,r),r}function Hie(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function xnt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Qe.getSingleton().register("beforeHideColumns");Qe.getSingleton().register("afterHideColumns");Qe.getSingleton().register("beforeUnhideColumns");Qe.getSingleton().register("afterUnhideColumns");var Jk="hiddenColumns",Tnt=310,Po=new WeakMap,Io=new WeakMap,Ont=function(e){mnt(r,e);var t=bnt(r);function r(){var n;dnt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),EG(gD(n),Po,{writable:!0,value:{}}),EG(gD(n),Io,{writable:!0,value:null}),n}return vnt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Jk]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[Jk];Pt(a)&&(hy(this,Po,a),pr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),hy(this,Io,new WO),Ui(this,Io).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Ui(this,Io)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyColWidth",function(o,s){return i.onModifyColWidth(o,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),ac(zs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ac(zs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),hy(this,Po,{}),ac(zs(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o,u=Ui(this,Io).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalColumn(d)});ne(c,function(d){u[d]=!1}),l=Zr(u,function(d,v,p){return v&&d.push(a.hot.toVisualColumn(p)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",o,l,s&&f);h!==!1&&(s&&f&&Ui(this,Io).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",o,l,s&&f,s&&l.length<o.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showColumns(a)}},{key:"hideColumns",value:function(i){var a=this,o=this.getHiddenColumns(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideColumns",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ne(i,function(f){Ui(a,Io).setValueAtIndex(a.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",o,l,s,s&&l.length>o.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideColumns(a)}},{key:"getHiddenColumns",value:function(){var i=this;return At(Ui(this,Io).getHiddenIndexes(),function(a){return i.hot.toVisualColumn(a)})}},{key:"isHidden",value:function(i){return Ui(this,Io).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ne(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,a){if(this.isHidden(a))return 0;if(Ui(this,Po).indicators&&(this.isHidden(a+1)||this.isHidden(a-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(Ui(this,Po).copyPasteEnabled===!1&&this.isHidden(a)&&(o.skipColumnOnPaste=!0),this.isHidden(a-1))o.className=o.className||"",o.className.indexOf("afterHiddenColumn")===-1&&(o.className+=" afterHiddenColumn");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(Ui(this,Po).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ne(i,function(l){var u=!0,f=0;rt(l.startCol,l.endCol,function(c){a.isHidden(c)?(u||s(l.startRow,l.endRow,f,c-1),u=!0):(u&&(f=c),c===l.endCol&&s(l.startRow,l.endRow,f,c),u=!1)})}),o}},{key:"onAfterGetColHeader",value:function(i,a){if(!(!Ui(this,Po).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&o.push("beforeHiddenColumn"),ke(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:Lt},snt(this),hnt(this))}},{key:"onMapInit",value:function(){Array.isArray(Ui(this,Po).columns)&&this.hideColumns(Ui(this,Po).columns)}},{key:"destroy",value:function(){hy(this,Po,null),hy(this,Io,null),ac(zs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Jk}},{key:"PLUGIN_PRIORITY",get:function(){return Tnt}}]),r}(er);function Ent(e,t){return Pnt(e)||Ant(e,t)||knt(e,t)||Rnt()}function Rnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function knt(e,t){if(e){if(typeof e=="string")return RG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RG(e,t)}}function RG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ant(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Pnt(e){if(Array.isArray(e))return e}function Int(e){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=Ent(r,3),a=i[0],o=i[2];a-o!==0&&(n=1)}return this.getTranslatedPhrase(wH,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,a=Math.max(Math.min(n.row,i.row),0),o=Math.max(n.row,i.row),s=[],l=a;l<=o;l+=1)s.push(l);e.hideRows(s);var u=s[s.length-1],f=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(f)&&f>=0?this.selectRows(f):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function k_(e){return Lnt(e)||Nnt(e)||Dnt(e)||Mnt()}function Mnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dnt(e,t){if(e){if(typeof e=="string")return yD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yD(e,t)}}function Nnt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lnt(e){if(Array.isArray(e))return yD(e)}function yD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fnt(e){var t=[];return{key:"hidden_rows_show",name:function(){var n=t.length>1?1:0;return this.getTranslatedPhrase(SH,n)},callback:function(){var n,i;if(t.length!==0){var a=t[0],o=t[t.length-1];a=(n=this.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0);var s=o-a+1===this.countRows();s||this.selectRows(a,o)}},disabled:!1,hidden:function(){var n=this,i=At(e.getHiddenRows(),function(m){return n.toPhysicalRow(m)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;var a=this.getSelectedRangeLast(),o=a.getTopStartCorner().row,s=a.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(o),f=l.getRenderableFromVisualIndex(s),c=l.getNotTrimmedIndexes(),h=[];if(o!==s){var d=s-o+1,v=f-u+1;if(d>v){var p=c.slice(o,s+1);h.push.apply(h,k_(p.filter(function(m){return i.includes(m)})))}}else if(u===0&&u<o)h.push.apply(h,k_(c.slice(0,o)));else if(u===null)h.push.apply(h,k_(c.slice(0,this.countRows())));else{var g=this.countRows()-1,y=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));f===y&&g>s&&h.push.apply(h,k_(c.slice(s+1)))}return ne(h,function(m){t.push(n.toVisualRow(m))}),t.length===0}}}function Lp(e){return Lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lp(e)}function $nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bnt(n.key),n)}}function Hnt(e,t,r){return t&&kG(e.prototype,t),r&&kG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bnt(e){var t=Vnt(e,"string");return Lp(t)==="symbol"?t:String(t)}function Vnt(e,t){if(Lp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oc(){return typeof Reflect<"u"&&Reflect.get?oc=Reflect.get.bind():oc=function(t,r,n){var i=jnt(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},oc.apply(this,arguments)}function jnt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Gs(e),e!==null););return e}function Wnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mD(e,t)}function mD(e,t){return mD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mD(e,t)}function Unt(e){var t=Gnt();return function(){var n=Gs(e),i;if(t){var a=Gs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return znt(this,i)}}function znt(e,t){if(t&&(Lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bD(e)}function bD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gs(e){return Gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gs(e)}function AG(e,t,r){Ynt(e,t),t.set(e,r)}function Ynt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fa(e,t){var r=Bie(e,t,"get");return Knt(e,r)}function Knt(e,t){return t.get?t.get.call(e):t.value}function dy(e,t,r){var n=Bie(e,t,"set");return Xnt(e,n,r),r}function Bie(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Xnt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}Qe.getSingleton().register("beforeHideRows");Qe.getSingleton().register("afterHideRows");Qe.getSingleton().register("beforeUnhideRows");Qe.getSingleton().register("afterUnhideRows");var Qk="hiddenRows",qnt=320,ys=new WeakMap,Mo=new WeakMap,Znt=function(e){Wnt(r,e);var t=Unt(r);function r(){var n;$nt(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),AG(bD(n),ys,{writable:!0,value:{}}),AG(bD(n),Mo,{writable:!0,value:null}),n}return Hnt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Qk]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[Qk];Pt(a)&&(dy(this,ys,a),pr(a.copyPasteEnabled)&&(a.copyPasteEnabled=!0)),dy(this,Mo,new WO),fa(this,Mo).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,fa(this,Mo)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(o,s,l){return i.onAfterGetCellMeta(o,s,l)}),this.addHook("modifyRowHeight",function(o,s){return i.onModifyRowHeight(o,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(o){return i.onModifyCopyableRange(o)}),oc(Gs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),oc(Gs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),dy(this,ys,{}),oc(Gs(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o,u=fa(this,Mo).getValues().slice(),f=i.length>0;if(s&&f){var c=i.map(function(d){return a.hot.toPhysicalRow(d)});ne(c,function(d){u[d]=!1}),l=Zr(u,function(d,v,p){return v&&d.push(a.hot.toVisualRow(p)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",o,l,s&&f);h!==!1&&(s&&f&&fa(this,Mo).setValues(u),this.hot.runHooks("afterUnhideRows",o,l,s&&f,s&&l.length<o.length))}},{key:"showRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.showRows(a)}},{key:"hideRows",value:function(i){var a=this,o=this.getHiddenRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeHideRows",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ne(i,function(f){fa(a,Mo).setValueAtIndex(a.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",o,l,s,s&&l.length>o.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.hideRows(a)}},{key:"getHiddenRows",value:function(){var i=this;return At(fa(this,Mo).getHiddenIndexes(),function(a){return i.hot.toVisualRow(a)})}},{key:"isHidden",value:function(i){return fa(this,Mo).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var a=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a}):!1}},{key:"resetCellsMeta",value:function(){ne(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,a){return this.isHidden(a)?0:i}},{key:"onAfterGetCellMeta",value:function(i,a,o){if(fa(this,ys).copyPasteEnabled===!1&&this.isHidden(i)&&(o.skipRowOnPaste=!0),this.isHidden(i-1))o.className=o.className||"",o.className.indexOf("afterHiddenRow")===-1&&(o.className+=" afterHiddenRow");else if(o.className){var s=o.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),o.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var a=this;if(fa(this,ys).copyPasteEnabled)return i;var o=[],s=function(u,f,c,h){o.push({startRow:u,endRow:f,startCol:c,endCol:h})};return ne(i,function(l){var u=!0,f=0;rt(l.startRow,l.endRow,function(c){a.isHidden(c)?(u||s(f,c-1,l.startCol,l.endCol),u=!0):(u&&(f=c),c===l.endRow&&s(f,c,l.startCol,l.endCol),u=!1)})}),o}},{key:"onAfterGetRowHeader",value:function(i,a){if(!(!fa(this,ys).indicators||i<0)){var o=[];i>=1&&this.isHidden(i-1)&&o.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&o.push("beforeHiddenRow"),ke(a,o)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:Lt},Int(this),Fnt(this))}},{key:"onMapInit",value:function(){Array.isArray(fa(this,ys).rows)&&this.hideRows(fa(this,ys).rows)}},{key:"destroy",value:function(){dy(this,ys,null),dy(this,Mo,null),oc(Gs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Qk}},{key:"PLUGIN_PRIORITY",get:function(){return qnt}}]),r}(er);function Jnt(e,t){return rit(e)||tit(e,t)||eit(e,t)||Qnt()}function Qnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eit(e,t){if(e){if(typeof e=="string")return PG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PG(e,t)}}function PG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function rit(e){if(Array.isArray(e))return e}function nit(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(K$)},callback:function(r,n){var i=Jnt(n,1),a=i[0].start.col;e.freezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function iit(e,t){return lit(e)||sit(e,t)||oit(e,t)||ait()}function ait(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oit(e,t){if(e){if(typeof e=="string")return IG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IG(e,t)}}function IG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function lit(e){if(Array.isArray(e))return e}function uit(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(X$)},callback:function(r,n){var i=iit(n,1),a=i[0].start.col;e.unfreezeColumn(a),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Fp(e){return Fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fp(e)}function fit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hit(n.key),n)}}function cit(e,t,r){return t&&MG(e.prototype,t),r&&MG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hit(e){var t=dit(e,"string");return Fp(t)==="symbol"?t:String(t)}function dit(e,t){if(Fp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ud(){return typeof Reflect<"u"&&Reflect.get?Ud=Reflect.get.bind():Ud=function(t,r,n){var i=vit(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Ud.apply(this,arguments)}function vit(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Su(e),e!==null););return e}function pit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wD(e,t)}function wD(e,t){return wD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wD(e,t)}function git(e){var t=mit();return function(){var n=Su(e),i;if(t){var a=Su(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return yit(this,i)}}function yit(e,t){if(t&&(Fp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vie(e)}function Vie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Su(e){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Su(e)}Qe.getSingleton().register("beforeColumnFreeze");Qe.getSingleton().register("afterColumnFreeze");Qe.getSingleton().register("beforeColumnUnfreeze");Qe.getSingleton().register("afterColumnUnfreeze");var DG="manualColumnFreeze",bit=110,vy=new WeakMap,wit=function(e){pit(r,e);var t=git(r);function r(n){var i;return fit(this,r),i=t.call(this,n),vy.set(Vie(i),{afterFirstUse:!1}),i}return cit(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DG]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(a){return i.addContextMenuEntry(a)}),this.addHook("beforeColumnMove",function(a,o){return i.onBeforeColumnMove(a,o)}),Ud(Su(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=vy.get(this);i.afterFirstUse=!1,Ud(Su(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ud(Su(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var a=vy.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart<this.hot.countCols()&&i>o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",i,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart),o._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,s))}},{key:"unfreezeColumn",value:function(i){var a=vy.get(this),o=this.hot.getSettings(),s=o.fixedColumnsStart>0&&i<=o.fixedColumnsStart-1;a.afterFirstUse||(a.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",i,s);l!==!1&&(s&&(o._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,o.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,s))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},nit(this),uit(this))}},{key:"onBeforeColumnMove",value:function(i,a){var o=vy.get(this);if(o.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(a<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return DG}},{key:"PLUGIN_PRIORITY",get:function(){return bit}}]),r}(er);function Vb(e){return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(e)}function Sit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cit(n.key),n)}}function _it(e,t,r){return t&&NG(e.prototype,t),r&&NG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cit(e){var t=xit(e,"string");return Vb(t)==="symbol"?t:String(t)}function xit(e,t){if(Vb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eA=0,LG=1,FG=2,Xh="px",Tit=function(){function e(t){Sit(this,e),this.hot=t,this._element=null,this.state=eA,this.inlineProperty=t.isRtl()?"right":"left"}return _it(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=FG}},{key:"build",value:function(){this.state===eA&&(this._element=this.hot.rootDocument.createElement("div"),this.state=LG)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=eA}},{key:"isAppended",value:function(){return this.state===FG}},{key:"isBuilt",value:function(){return this.state>=LG}},{key:"setPosition",value:function(r,n){Xi(r)&&(this._element.style.top=r+Xh),Xi(n)&&(this._element.style[this.inlineProperty]=n+Xh)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Xi(r)&&(this._element.style.width=r+Xh),Xi(n)&&(this._element.style.height=n+Xh)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Xi(r)&&(this._element.style.marginTop=r+Xh),Xi(n)&&(this._element.style["margin".concat(Ni(this.inlineProperty))]=n+Xh)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(Ni(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),e}();const jie=Tit;function $p(e){return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$p(e)}function Oit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rit(n.key),n)}}function Eit(e,t,r){return t&&$G(e.prototype,t),r&&$G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rit(e){var t=kit(e,"string");return $p(t)==="symbol"?t:String(t)}function kit(e,t){if($p(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($p(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CC(){return typeof Reflect<"u"&&Reflect.get?CC=Reflect.get.bind():CC=function(t,r,n){var i=Ait(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},CC.apply(this,arguments)}function Ait(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Hp(e),e!==null););return e}function Pit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SD(e,t)}function SD(e,t){return SD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SD(e,t)}function Iit(e){var t=Nit();return function(){var n=Hp(e),i;if(t){var a=Hp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Mit(this,i)}}function Mit(e,t){if(t&&($p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dit(e)}function Dit(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hp(e){return Hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hp(e)}var Lit="ht__manualColumnMove--backlight",Fit=function(e){Pit(r,e);var t=Iit(r);function r(){return Oit(this,r),t.apply(this,arguments)}return Eit(r,[{key:"build",value:function(){CC(Hp(r.prototype),"build",this).call(this),ke(this._element,Lit)}}]),r}(jie);const $it=Fit;function Bp(e){return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bp(e)}function Hit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vit(n.key),n)}}function Bit(e,t,r){return t&&HG(e.prototype,t),r&&HG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vit(e){var t=jit(e,"string");return Bp(t)==="symbol"?t:String(t)}function jit(e,t){if(Bp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xC(){return typeof Reflect<"u"&&Reflect.get?xC=Reflect.get.bind():xC=function(t,r,n){var i=Wit(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},xC.apply(this,arguments)}function Wit(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Vp(e),e!==null););return e}function Uit(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_D(e,t)}function _D(e,t){return _D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_D(e,t)}function zit(e){var t=Kit();return function(){var n=Vp(e),i;if(t){var a=Vp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Git(this,i)}}function Git(e,t){if(t&&(Bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yit(e)}function Yit(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kit(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vp(e){return Vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vp(e)}var Xit="ht__manualColumnMove--guideline",qit=function(e){Uit(r,e);var t=zit(r);function r(){return Hit(this,r),t.apply(this,arguments)}return Bit(r,[{key:"build",value:function(){xC(Vp(r.prototype),"build",this).call(this),ke(this._element,Xit)}}]),r}(jie);const Zit=qit;function jp(e){return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(e)}function Jit(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eat(n.key),n)}}function Qit(e,t,r){return t&&BG(e.prototype,t),r&&BG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eat(e){var t=tat(e,"string");return jp(t)==="symbol"?t:String(t)}function tat(e,t){if(jp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sc(){return typeof Reflect<"u"&&Reflect.get?sc=Reflect.get.bind():sc=function(t,r,n){var i=rat(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},sc.apply(this,arguments)}function rat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ys(e),e!==null););return e}function nat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CD(e,t)}function CD(e,t){return CD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CD(e,t)}function iat(e){var t=oat();return function(){var n=Ys(e),i;if(t){var a=Ys(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return aat(this,i)}}function aat(e,t){if(t&&(jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xD(e)}function xD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ys(e){return Ys=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ys(e)}Qe.getSingleton().register("beforeColumnMove");Qe.getSingleton().register("afterColumnMove");var tA="manualColumnMove",sat=120,Ml=new WeakMap,VG="ht__manualColumnMove",A_="show-ui",rA="on-moving--columns",nA="after-selection--columns",lat=function(e){nat(r,e);var t=iat(r);function r(n){var i;return Jit(this,r),i=t.call(this,n),Ml.set(xD(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new Fr(xD(i)),i.backlight=new $it(n),i.guideline=new Zit(n),i}return Qit(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tA]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),ke(this.hot.rootElement,VG),sc(Ys(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),sc(Ys(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){St(this.hot.rootElement,VG),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),sc(Ys(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,a){return this.moveColumns([i],a)}},{key:"moveColumns",value:function(i,a){var o=Ml.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeColumnMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,a);var f=l&&this.isColumnOrderChanged(i,a);return this.hot.runHooks("afterColumnMove",i,a,s,l,f),f}}},{key:"dragColumn",value:function(i,a){return this.dragColumns([i],a)}},{key:"dragColumns",value:function(i,a){var o=this.countFinalIndex(i,a),s=Ml.get(this);return s.cachedDropIndex=a,this.moveColumns(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isColumnOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=Zr(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getColumnsWidth",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=0,l=i;l<=a;l+=1){var u=o.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[tA];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveColumns(a,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,a){var o=[];return rt(i,a,function(s){o.push(s)}),o}},{key:"refreshPositions",value:function(){var i=Ml.get(this),a=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&a>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(a-1,-1));var o=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),f=o.hider.offsetWidth,c=o.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,v=0,p=0;if(this.hot.isRtl()){var g=this.hot.rootWindow,y=cr(this.hot.rootElement),m=g.innerWidth-i.rootElementOffset-y;p=g.innerWidth-i.target.eventPageX-m-(s.scrollX===void 0?l:0)}else p=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=v,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=a>0?a-1:a;else if(i.target.TD.offsetWidth/2+u<=p){var b=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=b+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var S=p,x=u;p+d+h>=f?S=f-d-h:p+h<c+v&&(S=c+v+Math.abs(h)),u>=f-1?x=f-1:x===0?x=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(x-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,S),this.guideline.setPosition(null,x)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeLast(),c=Ml.get(this),h=bt(i.target,"sortAction");if(!f||!u||c.pressed||i.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,St(this.hot.rootElement,[rA,A_]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var p=f.from,g=f.to,y=Math.min(p.col,g.col),m=Math.max(p.col,g.col);if(a.row<0&&a.col>=y&&a.col<=m){s.column=!0,c.pressed=!0,c.target.eventPageX=i.pageX,c.target.eventOffsetX=i.offsetX,c.hoveredColumn=a.col,c.target.TD=o,c.target.col=a.col,c.columnsToMove=this.prepareColumnsToMoving(y,m),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=nn(this.hot.rootElement).left;var b=c.hasRowHeaders?-1:0,S=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,x=a.col<c.fixedColumnsStart,T=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),E=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),P=this.getColumnsWidth(y,a.col-1)+E,R=this.getColumnsWidth(b,y-1)+(x?T:0)+P;this.backlight.setPosition(S,R),this.backlight.setSize(this.getColumnsWidth(y,m),l.hider.offsetHeight-S),this.backlight.setOffset(null,-P),ke(this.hot.rootElement,rA)}else St(this.hot.rootElement,nA),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=Ml.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(o)})}a.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=Ml.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(a.col)>-1?St(this.hot.rootElement,A_):ke(this.hot.rootElement,A_),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=a.col,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=Ml.get(this),a=i.target.col,o=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,St(this.hot.rootElement,[rA,A_,nA]),this.hot.selection.isSelectedByColumnHeader()&&ke(this.hot.rootElement,nA),!(o<1||a===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,a);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualColumn(l),c=f+o-1;this.hot.selectColumns(f,c)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,a=i.getColumnHeaderHeight(0)+1,o=i.holder.scrollTop,s=a+o;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),sc(Ys(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tA}},{key:"PLUGIN_PRIORITY",get:function(){return sat}}]),r}(er);function Wp(e){return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(e)}function uat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cat(n.key),n)}}function fat(e,t,r){return t&&jG(e.prototype,t),r&&jG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cat(e){var t=hat(e,"string");return Wp(t)==="symbol"?t:String(t)}function hat(e,t){if(Wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lc(){return typeof Reflect<"u"&&Reflect.get?lc=Reflect.get.bind():lc=function(t,r,n){var i=dat(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},lc.apply(this,arguments)}function dat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Ks(e),e!==null););return e}function vat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TD(e,t)}function TD(e,t){return TD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TD(e,t)}function pat(e){var t=yat();return function(){var n=Ks(e),i;if(t){var a=Ks(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return gat(this,i)}}function gat(e,t){if(t&&(Wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OD(e)}function OD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ks(e){return Ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ks(e)}var P_="manualColumnResize",mat=130,WG="manualColumnWidths",iA=new WeakMap,bat=function(e){vat(r,e);var t=pat(r);function r(n){var i;uat(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new Fr(OD(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,iA.set(OD(i),{config:void 0}),ke(i.handle,"manualColumnResizer"),ke(i.guide,"manualColumnResizerGuide"),i}return fat(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[P_]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new Uu,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(a,o){return i.onModifyColWidth(a,o)}),this.addHook("beforeStretchingColumnWidth",function(a,o){return i.onBeforeStretchingColumnWidth(a,o)}),this.addHook("beforeColumnResize",function(a,o,s){return i.onBeforeColumnResize(a,o,s)}),this.bindEvents(),lc(Ks(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),lc(Ks(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=iA.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),lc(Ks(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",WG,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",WG,i),i.value}},{key:"setManualSize",value:function(i,a){var o=Math.max(a,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,o),o}},{key:"clearManualSize",value:function(i){var a=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(a,null)}},{key:"onMapInit",value:function(){var i=this,a=iA.get(this),o=this.hot.getSettings()[P_],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(o)?(this.hot.batchExecution(function(){o.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0),a.config=o):o===!0&&Array.isArray(a.config)&&this.hot.batchExecution(function(){a.config.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var a=this;if(i.parentNode){this.currentTH=i;var o=this.hot.view._wt,s=o.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=Nr(this.currentTH),f=this.currentTH.getBoundingClientRect(),c=l<o.getSetting("fixedColumnsStart"),h;c&&(h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=o.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var v=this.hot.getSelectedRange();ne(v,function(p){var g=p.getTopStartCorner().col,y=p.getBottomEndCorner().col;rt(g,y,function(m){a.selectedCols.includes(m)||a.selectedCols.push(m)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(f.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(Nr(this.handle),10),a=parseInt(this.handle.style.top,10)+i,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ke(this.handle,"active"),ke(this.guide,"active"),this.guide.style.top="".concat(a,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){St(this.handle,"active"),St(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!cu(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!n$(i.target)&&this.checkIfColumnHeader(i.target)){var a=this.getClosestTHParent(i.target);if(!a)return;var o=a.getAttribute("colspan");a&&(o===null||o==="1")&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeColumnResize",i.newSize,u,!0);c!==void 0&&(i.newSize=c),i.hot.getSettings().stretchH==="all"?i.clearManualSize(u):i.setManualSize(u,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(ne(this.selectedCols,function(l){o(l)}),a()):ne(this.selectedCols,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;bt(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var a=this;if(this.pressed){var o=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+o,ne(this.selectedCols,function(s){a.newSize=a.setManualSize(s,a.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeColumnResize",i.newSize,u,!1),f&&a(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(ne(this.selectedCols,function(l){o(l)}),a()):ne(this.selectedCols,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootWindow,s=a.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(o,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalColumn(a),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[P_]&&l&&(o=l)}return o}},{key:"onBeforeStretchingColumnWidth",value:function(i,a){var o=this.columnWidthsMap.getValueAtIndex(a);return o===null&&(o=i),o}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){lc(Ks(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return P_}},{key:"PLUGIN_PRIORITY",get:function(){return mat}}]),r}(er);function jb(e){return jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jb(e)}function wat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_at(n.key),n)}}function Sat(e,t,r){return t&&UG(e.prototype,t),r&&UG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _at(e){var t=Cat(e,"string");return jb(t)==="symbol"?t:String(t)}function Cat(e,t){if(jb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aA=0,zG=1,GG=2,qh="px",xat=function(){function e(t){wat(this,e),this.hot=t,this._element=null,this.state=aA}return Sat(e,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=GG}},{key:"build",value:function(){this.state===aA&&(this._element=this.hot.rootDocument.createElement("div"),this.state=zG)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=aA}},{key:"isAppended",value:function(){return this.state===GG}},{key:"isBuilt",value:function(){return this.state>=zG}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+qh),n!==void 0&&(this._element.style.left=n+qh)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+qh),n&&(this._element.style.height=n+qh)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+qh),n&&(this._element.style.marginLeft=n+qh)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();const Wie=xat;function Up(e){return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Up(e)}function Tat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eat(n.key),n)}}function Oat(e,t,r){return t&&YG(e.prototype,t),r&&YG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Eat(e){var t=Rat(e,"string");return Up(t)==="symbol"?t:String(t)}function Rat(e,t){if(Up(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TC(){return typeof Reflect<"u"&&Reflect.get?TC=Reflect.get.bind():TC=function(t,r,n){var i=kat(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},TC.apply(this,arguments)}function kat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=zp(e),e!==null););return e}function Aat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ED(e,t)}function ED(e,t){return ED=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ED(e,t)}function Pat(e){var t=Dat();return function(){var n=zp(e),i;if(t){var a=zp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Iat(this,i)}}function Iat(e,t){if(t&&(Up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mat(e)}function Mat(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zp(e){return zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zp(e)}var Nat="ht__manualRowMove--backlight",Lat=function(e){Aat(r,e);var t=Pat(r);function r(){return Tat(this,r),t.apply(this,arguments)}return Oat(r,[{key:"build",value:function(){TC(zp(r.prototype),"build",this).call(this),ke(this._element,Nat)}}]),r}(Wie);const Fat=Lat;function Gp(e){return Gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gp(e)}function $at(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bat(n.key),n)}}function Hat(e,t,r){return t&&KG(e.prototype,t),r&&KG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bat(e){var t=Vat(e,"string");return Gp(t)==="symbol"?t:String(t)}function Vat(e,t){if(Gp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OC(){return typeof Reflect<"u"&&Reflect.get?OC=Reflect.get.bind():OC=function(t,r,n){var i=jat(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},OC.apply(this,arguments)}function jat(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Yp(e),e!==null););return e}function Wat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RD(e,t)}function RD(e,t){return RD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RD(e,t)}function Uat(e){var t=Yat();return function(){var n=Yp(e),i;if(t){var a=Yp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zat(this,i)}}function zat(e,t){if(t&&(Gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gat(e)}function Gat(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yp(e){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yp(e)}var Kat="ht__manualRowMove--guideline",Xat=function(e){Wat(r,e);var t=Uat(r);function r(){return $at(this,r),t.apply(this,arguments)}return Hat(r,[{key:"build",value:function(){OC(Yp(r.prototype),"build",this).call(this),ke(this._element,Kat)}}]),r}(Wie);const qat=Xat;function Kp(e){return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kp(e)}function Zat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qat(n.key),n)}}function Jat(e,t,r){return t&&XG(e.prototype,t),r&&XG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qat(e){var t=eot(e,"string");return Kp(t)==="symbol"?t:String(t)}function eot(e,t){if(Kp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uc(){return typeof Reflect<"u"&&Reflect.get?uc=Reflect.get.bind():uc=function(t,r,n){var i=tot(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},uc.apply(this,arguments)}function tot(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Xs(e),e!==null););return e}function rot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kD(e,t)}function kD(e,t){return kD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kD(e,t)}function not(e){var t=aot();return function(){var n=Xs(e),i;if(t){var a=Xs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return iot(this,i)}}function iot(e,t){if(t&&(Kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AD(e)}function AD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aot(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xs(e){return Xs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xs(e)}Qe.getSingleton().register("beforeRowMove");Qe.getSingleton().register("afterRowMove");var oA="manualRowMove",oot=140,Dl=new WeakMap,qG="ht__manualRowMove",I_="show-ui",sA="on-moving--rows",lA="after-selection--rows",sot=function(e){rot(r,e);var t=not(r);function r(n){var i;return Zat(this,r),i=t.call(this,n),Dl.set(AD(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new Fr(AD(i)),i.backlight=new Fat(n),i.guideline=new qat(n),i}return Jat(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[oA]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),ke(this.hot.rootElement,qG),uc(Xs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),uc(Xs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){St(this.hot.rootElement,qG),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),uc(Xs(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,a){return this.moveRows([i],a)}},{key:"moveRows",value:function(i,a){var o=Dl.get(this),s=o.cachedDropIndex,l=this.isMovePossible(i,a),u=this.hot.runHooks("beforeRowMove",i,a,s,l);if(o.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,a);var f=l&&this.isRowOrderChanged(i,a);return this.hot.runHooks("afterRowMove",i,a,s,l,f),f}}},{key:"dragRow",value:function(i,a){return this.dragRows([i],a)}},{key:"dragRows",value:function(i,a){var o=this.countFinalIndex(i,a),s=Dl.get(this);return s.cachedDropIndex=a,this.moveRows(i,o)}},{key:"isMovePossible",value:function(i,a){var o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+a>o,l=a<0,u=i.some(function(c){return c<0}),f=i.some(function(c){return c>=o});return!(s||l||u||f)}},{key:"isRowOrderChanged",value:function(i,a){return i.some(function(o,s){return o-s!==a})}},{key:"countFinalIndex",value:function(i,a){var o=Zr(i,function(s,l){return l<a&&(s+=1),s},0);return a-o}},{key:"getRowsHeight",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=0,l=i;l<=a;l++){var u=o.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[oA];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var a=this.persistentStateLoad();a.length&&this.moveRows(a,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),a=[];if(!i)return a;var o=i.from,s=i.to,l=Math.min(o.row,s.row),u=Math.max(o.row,s.row);return rt(l,u,function(f){a.push(f)}),a}},{key:"refreshPositions",value:function(){var i=Dl.get(this),a=i.target.coords,o=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(a.row)&&o>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1)),this.isFixedRowBottom(a.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,f=i.target.TD,c=nn(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,a.row-1),d=i.target.eventPageY-c.top+u.holder.scrollTop,v=u.hider.offsetHeight,p=u.TBODY.offsetTop,g=this.backlight.getOffset().top,y=this.backlight.getSize().height;this.isFixedRowTop(a.row)&&(h+=u.holder.scrollTop),a.row<0?i.target.row=o>0?o-1:o:f.offsetHeight/2+h<=d?(i.target.row=a.row+1,h+=a.row===0?f.offsetHeight-1:f.offsetHeight):i.target.row=a.row;var m=d,b=h;d+y+g>=v?m=v-y-g:d+g<p&&(m=p+Math.abs(g)),h>=v-1&&(b=v-1),this.backlight.setPosition(m),this.guideline.setPosition(b)}},{key:"registerEvents",value:function(){var i=this,a=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(a,"mousemove",function(o){return i.onMouseMove(o)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this.hot.view._wt,u=l.wtTable,f=l.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Dl.get(this);if(!h||!c||d.pressed||i.button!==0){d.pressed=!1,d.rowsToMove.length=0,St(this.hot.rootElement,[sA,I_]);return}var v=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();v&&p&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var g=h.from,y=h.to,m=Math.min(g.row,y.row),b=Math.max(g.row,y.row);if(a.col<0&&a.row>=m&&a.row<=b){s.row=!0,d.pressed=!0,d.target.eventPageY=i.pageY,d.target.coords=a,d.target.TD=o,d.rowsToMove=this.prepareRowsToMoving();var S=u.holder.scrollLeft+f.getRowHeaderWidth();this.backlight.setPosition(null,S),this.backlight.setSize(u.hider.offsetWidth-S,this.getRowsHeight(m,b)),this.backlight.setOffset((this.getRowsHeight(m,a.row-1)+i.offsetY)*-1,null),ke(this.hot.rootElement,sA),this.refreshPositions()}else St(this.hot.rootElement,lA),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var a=Dl.get(this);if(a.pressed){if(i.target===this.backlight.element){var o=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,o)})}a.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l=this.hot.getSelectedRangeLast(),u=Dl.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(a.row)>-1?St(this.hot.rootElement,I_):ke(this.hot.rootElement,I_),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=a,u.target.TD=o)}},{key:"onMouseUp",value:function(){var i=Dl.get(this),a=i.target.row,o=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,St(this.hot.rootElement,[sA,I_,lA]),this.hot.selection.isSelectedByRowHeader()&&ke(this.hot.rootElement,lA),!(o<1||a===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(i.rowsToMove,a);if(i.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var f=this.hot.toVisualRow(l),c=f+o-1;this.hot.selectRows(f,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=i.holder.scrollLeft,s=a+o;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),uc(Xs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return oA}},{key:"PLUGIN_PRIORITY",get:function(){return oot}}]),r}(er);function Xp(e){return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(e)}function lot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fot(n.key),n)}}function uot(e,t,r){return t&&ZG(e.prototype,t),r&&ZG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fot(e){var t=cot(e,"string");return Xp(t)==="symbol"?t:String(t)}function cot(e,t){if(Xp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fc(){return typeof Reflect<"u"&&Reflect.get?fc=Reflect.get.bind():fc=function(t,r,n){var i=hot(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},fc.apply(this,arguments)}function hot(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=qs(e),e!==null););return e}function dot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PD(e,t)}function PD(e,t){return PD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PD(e,t)}function vot(e){var t=got();return function(){var n=qs(e),i;if(t){var a=qs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pot(this,i)}}function pot(e,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ID(e)}function ID(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function got(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qs(e){return qs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qs(e)}var M_="manualRowResize",yot=30,JG="manualRowHeights",uA=new WeakMap,mot=function(e){dot(r,e);var t=vot(r);function r(n){var i;lot(this,r),i=t.call(this,n);var a=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=a.createElement("DIV"),i.guide=a.createElement("DIV"),i.eventManager=new Fr(ID(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,uA.set(ID(i),{config:void 0}),ke(i.handle,"manualRowResizer"),ke(i.guide,"manualRowResizerGuide"),i}return uot(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[M_]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new Uu,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(a,o){return i.onModifyRowHeight(a,o)}),this.bindEvents(),fc(qs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fc(qs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=uA.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),fc(qs(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",JG,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",JG,i),i.value}},{key:"setManualSize",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=Math.max(a,wte.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(o,s),s}},{key:"setupHandlePosition",value:function(i){var a=this;this.currentTH=i;var o=this.hot.view,s=o._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var f=cr(this.currentTH),c=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=o.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),v;h?v=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(v=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),v||(v=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){var g=this.hot.getSelectedRange();ne(g,function(y){var m=y.getTopStartCorner().row,b=y.getBottomStartCorner().row;rt(m,b,function(S){a.selectedRows.includes(S)||a.selectedRows.push(S)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=v.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(v.start,"px"),this.handle.style.width="".concat(f,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(cr(this.handle),10),a=parseInt(this.handle.style[this.inlineDir],10)+i,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ke(this.handle,"active"),ke(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(a,"px"),this.guide.style.width="".concat(o-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){St(this.handle,"active"),St(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var a,o,s=cu(i,["TH"],this.hot.rootElement);return s&&((a=i.parentNode)===null||a===void 0||(o=a.parentNode)===null||o===void 0?void 0:o.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var a=this.hot.view._wt.wtTable.getRowHeight(i);return a!==void 0&&this.newSize<a?a:this.newSize}},{key:"onMouseOver",value:function(i){if(!n$(i.target)&&this.checkIfRowHeader(i.target)){var a=this.getClosestTHParent(i.target);a&&(this.pressed||this.setupHandlePosition(a))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){var c=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!0);c!==void 0&&(i.newSize=c),i.setManualSize(u,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!0),f&&a()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(ne(this.selectedRows,function(l){o(l)}),a()):ne(this.selectedRows,function(l){o(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var a=this;bt(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return a.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var a=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),ne(this.selectedRows,function(o){a.newSize=a.setManualSize(o,a.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,a=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},o=function(u,f){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!1),f&&a(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(ne(this.selectedRows,function(l){o(l)}),a()):ne(this.selectedRows,function(l){o(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,a=this.hot,o=a.rootElement,s=a.rootWindow;this.eventManager.addEventListener(o,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(o,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,a){var o=i;if(this.enabled){var s=this.hot.toPhysicalRow(a),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[M_]&&l&&(o=l)}return o}},{key:"onMapInit",value:function(){var i=this,a=uA.get(this),o=this.hot.getSettings()[M_],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(o)?(o.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}),a.config=o):o===!0&&Array.isArray(a.config)&&a.config.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){fc(qs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return M_}},{key:"PLUGIN_PRIORITY",get:function(){return yot}}]),r}(er);function Wb(e){return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(e)}var QG,e7,t7,r7;function D_(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function bot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sot(n.key),n)}}function wot(e,t,r){return t&&n7(e.prototype,t),r&&n7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sot(e){var t=_ot(e,"string");return Wb(t)==="symbol"?t:String(t)}function _ot(e,t){if(Wb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cot=function(){function e(t,r,n,i,a,o){bot(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=a,this.cellRangeFactory=o}return wot(e,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],a=n+Math.abs(r[0]||r[1])-1,o=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,a),u=Math.max(n,a),f=this[s],c=this[s]+this[o]-1;if(f>=n&&(this[s]+=i),i>0)n<=c&&n>f&&(this[o]+=i);else if(i<0){if(l<=f&&u>=c)return this.removed=!0,!1;if(f>=l&&f<=u){var h=u-f+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(f<=l&&c>=u)this[o]+=i;else if(f<=l&&c>=l&&c<u){var v=c-l+1;this[o]-=v}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return sr(QG||(QG=D_(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return sr(e7||(e7=D_(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return sr(t7||(t7=D_(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return sr(r7||(r7=D_(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),e}();const jo=Cot;function MD(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function Ub(e){return Ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ub(e)}var i7;function xot(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function a7(e){return Rot(e)||Eot(e)||Oot(e)||Tot()}function Tot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oot(e,t){if(e){if(typeof e=="string")return DD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DD(e,t)}}function Eot(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rot(e){if(Array.isArray(e))return DD(e)}function DD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pot(n.key),n)}}function Aot(e,t,r){return t&&o7(e.prototype,t),r&&o7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pot(e){var t=Iot(e,"string");return Ub(t)==="symbol"?t:String(t)}function Iot(e,t){if(Ub(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ub(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mot=function(){function e(t){kot(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return Aot(e,[{key:"get",value:function(r,n){var i=this.mergedCells,a=!1;return ne(i,function(o){return o.row<=r&&o.row+o.rowspan-1>=r&&o.col<=n&&o.col+o.colspan-1>=n?(a=o,!1):!0}),a}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return ne(n,function(a){return a.row<=r.from.row&&a.row+a.rowspan-1>=r.to.row&&a.col<=r.from.col&&a.col+a.colspan-1>=r.to.col?(i=a,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCells,o=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return ne(a,function(f){var c=n.hot._createCellCoords(f.row,f.col),h=n.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=n.hot._createCellRange(c,c,h);i?s.overlaps(d)&&o.push(f):s.includesRange(d)&&o.push(f)}),o.length?o:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,a=r.col,o=r.rowspan,s=r.colspan,l=new jo(i,a,o,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(i,a),f=this.isOverlapping(l);return!u&&!f?(this.hot&&l.normalize(this.hot),n.push(l),l):(gr(e.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,a=this.get(r,n),o=a?this.mergedCells.indexOf(a):-1;return a&&o!==-1?(i.splice(o,1),a):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],a=[];ne(n,function(o){var s=r.hot.getCell(o.row,o.col);s&&i.push([s,r.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,ne(i,function(o,s){rt(0,o.rowspan-1,function(l){rt(0,o.colspan-1,function(u){if(u!==0||l!==0){var f=r.hot.getCell(o.row+l,o.col+u);f&&a.push([f,null,null,null])}})}),i[s][1]=null}),ne(i,function(o){MD.apply(void 0,a7(o))}),ne(a,function(o){MD.apply(void 0,a7(o))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),a=!1;return ne(this.mergedCells,function(o){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(o.row,o.col),n.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1));return s.overlaps(i)?(a=!0,!1):!0}),a}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var a=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(a,o)}},{key:"shiftCollections",value:function(r,n,i){var a=this,o=[0,0];switch(r){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break}ne(this.mergedCells,function(s){s.shift(o,n)}),ux(this.mergedCells.length-1,0,function(s){var l=a.mergedCells[s];l&&l.removed&&a.mergedCells.splice(a.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return sr(i7||(i7=xot(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),e}();const Dot=Mot;function zb(e){return zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zb(e)}function sf(e,t){return $ot(e)||Fot(e,t)||Lot(e,t)||Not()}function Not(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lot(e,t){if(e){if(typeof e=="string")return s7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s7(e,t)}}function s7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fot(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function $ot(e){if(Array.isArray(e))return e}function Hot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vot(n.key),n)}}function Bot(e,t,r){return t&&l7(e.prototype,t),r&&l7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vot(e){var t=jot(e,"string");return zb(t)==="symbol"?t:String(t)}function jot(e,t){if(zb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wot=function(){function e(t){Hot(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return Bot(e,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,a){var o=n.slice(0),s=this.getAutofillSize(r,n,i),l=sf(r,4),u=l[0],f=l[1],c=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,v=d?c-u+1:h-f+1,p=Math.floor(s/v)*v,g=s-p,y=this.getFarthestCollection(r,n,i,a);if(y){if(i==="down"){var m=y.row+y.rowspan-u-g,b=o[2]+m;b>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?m:0}else if(i==="right"){var S=y.col+y.colspan-f-g,x=o[3]+S;x>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?S:0}else if(i==="up"){var T=c-g-y.row+1,E=o[0]+T;E<0?o[0]+=g:o[0]-=g?T:0}else if(i==="left"){var P=h-g-y.col+1,R=o[1]+P;R<0?o[1]+=g:o[1]-=g?P:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:a,fillSize:s,dragArea:o,cycleLength:v}),o}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),an(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var a=sf(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=sf(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return o-c;case"down":return d-l;case"left":return s-h;case"right":return v-u;default:return null}}},{key:"getDragArea",value:function(r,n,i){var a=sf(r,4),o=a[0],s=a[1],l=a[2],u=a[3],f=sf(n,4),c=f[0],h=f[1],d=f[2],v=f[3];switch(i){case"up":return[c,h,o-1,u];case"down":return[l+1,s,d,u];case"left":return[c,h,l,s-1];case"right":return[o,u+1,d,v];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,a){var o=sf(r,4),s=o[0],l=o[1],u=o[2],f=o[3],c=["up","down"].indexOf(i)>-1,h=c?u:f,d=c?s:l,v=this.getAutofillSize(r,n,i),p=c?u-s+1:f-l+1,g=Math.floor(v/p)*p,y=v-g,m=null,b=null,S=null;switch(i){case"up":m="includesVertically",S=h-y+1;break;case"left":m="includesHorizontally",S=h-y+1;break;case"down":m="includesVertically",S=d+y-1;break;case"right":m="includesHorizontally",S=d+y-1;break}return ne(a,function(x){x[m](S)&&x.isFarther(b,i)&&(b=x)}),b}},{key:"recreateAfterDataPopulation",value:function(r){if(this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,a=this.currentFillData.dragDirection,o=function(h,d){switch(a){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var f=0;f<i.length;f+=1){if(l=i[f],s=u*this.currentFillData.cycleLength,o(l,s))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}f===i.length-1&&(u+=1)}while(o(l,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},a={min:null,max:null};return ne(r,function(o){var s=o[0],l=n.plugin.hot.propToCol(o[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(a.min===null||l<a.min)&&(a.min=l),(a.max===null||l>a.max)&&(a.max=l)}),{from:{row:i.min,column:a.min},to:{row:i.max,column:a.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var a=this.getDragArea(r,n,i),o=sf(a,4),s=o[0],l=o[1],u=o[2],f=o[3],c=this.plugin.hot._createCellCoords(s,l),h=this.plugin.hot._createCellCoords(u,f),d=this.plugin.hot._createCellRange(c,c,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),e}();const Uot=Wot;function Gb(e){return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(e)}function zot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yot(n.key),n)}}function Got(e,t,r){return t&&u7(e.prototype,t),r&&u7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yot(e){var t=Kot(e,"string");return Gb(t)==="symbol"?t:String(t)}function Kot(e,t){if(Gb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xot=function(){function e(t){zot(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return Got(e,[{key:"snapDelta",value:function(r,n,i){var a=n.to,o=a.row+r.row,s=a.col+r.col;r.row?this.jumpOverMergedCell(r,i,o):r.col&&this.jumpOverMergedCell(r,i,s)}},{key:"jumpOverMergedCell",value:function(r,n,i){var a=r.row||r.col,o=null,s=null,l=null;r.row?(o=n.includesVertically(i),s=n.row,l=n.getLastRow()):r.col&&(o=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),a!==0&&(a>0?o&&i!==s&&(a+=l-i+1):o&&i!==l&&(a-=i-s+1),r.row?r.row=a:r.col&&(r.col=a))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,a){var o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(a!==void 0){var f=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(f){var c=this.plugin.mergedCellsCollection.get(r,n);if(c){var h=c.getLastRow(),d=c.getLastColumn(),v=o<=c.row&&s<=c.col&&l>=h&&u>=d;if(v)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(a);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var a=0;a<r.rowspan;a+=1)for(var o=0;o<r.colspan;o+=1)i.push(this.hot._createCellCoords(r.row+a,r.col+o));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),e}();const qot=Xot;function Zot(e){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=e.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(Z$)}return this.getTranslatedPhrase(q$)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=jo.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function qp(e){return qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qp(e)}function Jot(e,t){return tst(e)||est(e,t)||Uie(e,t)||Qot()}function Qot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function est(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function tst(e){if(Array.isArray(e))return e}function rst(e){return ast(e)||ist(e)||Uie(e)||nst()}function nst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uie(e,t){if(e){if(typeof e=="string")return ND(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ND(e,t)}}function ist(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ast(e){if(Array.isArray(e))return ND(e)}function ND(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ost(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lst(n.key),n)}}function sst(e,t,r){return t&&f7(e.prototype,t),r&&f7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lst(e){var t=ust(e,"string");return qp(t)==="symbol"?t:String(t)}function ust(e,t){if(qp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zd(){return typeof Reflect<"u"&&Reflect.get?zd=Reflect.get.bind():zd=function(t,r,n){var i=fst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},zd.apply(this,arguments)}function fst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_u(e),e!==null););return e}function cst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LD(e,t)}function LD(e,t){return LD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LD(e,t)}function hst(e){var t=vst();return function(){var n=_u(e),i;if(t){var a=_u(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return dst(this,i)}}function dst(e,t){if(t&&(qp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zie(e)}function zie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _u(e){return _u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_u(e)}Qe.getSingleton().register("beforeMergeCells");Qe.getSingleton().register("afterMergeCells");Qe.getSingleton().register("beforeUnmergeCells");Qe.getSingleton().register("afterUnmergeCells");var Gy="mergeCells",pst=150,c7=new WeakMap,h7=Gy,gst=function(e){cst(r,e);var t=hst(r);function r(n){var i;return ost(this,r),i=t.call(this,n),c7.set(zie(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return sst(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gy]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new Dot(this),this.autofillCalculations=new Uot(this),this.selectionCalculations=new qot(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(a,o){if(o==="MergeCells")return!1}),this.registerShortcuts(),zd(_u(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),zd(_u(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[Gy];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),zd(_u(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(kF()){var a=[],o=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,f=l+1;f<l+u;f++)o.push(f)}),o=rst(new Set(o)),o.forEach(function(s){var l=i.hot.rowIndexMapper.getRenderableFromVisualIndex(s);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var f=u.getRow(l);f&&(f.style.background=uv(f,"backgroundColor").replace(")",", 0.99)"),a.push(f))})}),this.hot._registerTimeout(function(){a.forEach(function(s){s.style.background=uv(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var a=!0;return i?(jo.containsNegativeValues(i)?(gr(jo.NEGATIVE_VALUES_WARNING(i)),a=!1):jo.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(gr(jo.IS_OUT_OF_BOUNDS_WARNING(i)),a=!1):jo.isSingleCell(i)?(gr(jo.IS_SINGLE_CELL(i)),a=!1):jo.containsZeroSpan(i)&&(gr(jo.ZERO_SPAN_WARNING(i)),a=!1),a):!1}},{key:"generateFromSettings",value:function(i){var a=this;if(Array.isArray(i)){var o=[];if(ne(i,function(s){if(a.validateSetting(s)){var l=a.hot._createCellCoords(s.row,s.col),u=a.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),f=a.hot._createCellRange(l,l,u);a.mergeRange(f,!0,!0),rt(s.row,s.row+s.rowspan-1,function(c){rt(s.col,s.col+s.colspan-1,function(h){c===s.row&&h===s.col||o.push([c,h,null])})})}}),o.length===0)return;this.hot.setDataAtCell(o)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return a?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.toggleMerge(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var a=i.from,o=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(i){var a=i.from,o=i.to;this.unmergeRange(i,!0),this.hot.selectCell(a.row,a.col,o.row,o.col,!1)}}},{key:"mergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopStartCorner(),u=i.getBottomEndCorner(),f={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},c=[],h=null;if(!this.canMergeRange(f,o))return!1;this.hot.runHooks("beforeMergeCells",i,o),rt(0,f.rowspan-1,function(v){rt(0,f.colspan-1,function(p){var g=null;c[v]||(c[v]=[]),v===0&&p===0?g=a.hot.getSourceDataAtCell(a.hot.toPhysicalRow(f.row),a.hot.toPhysicalColumn(f.col)):a.hot.setCellMeta(f.row+v,f.col+p,"hidden",!0),c[v][p]=g})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0);var d=this.mergedCellsCollection.add(f);return d?(s?h=[f.row,f.col,c]:this.hot.populateFromArray(f.row,f.col,c,void 0,void 0,this.pluginName),o||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,f,o),h):!0}},{key:"unmergeRange",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);s&&(this.hot.runHooks("beforeUnmergeCells",i,o),ne(s,function(l){a.mergedCellsCollection.remove(l.row,l.col),rt(0,l.rowspan-1,function(u){rt(0,l.colspan-1,function(f){a.hot.removeCellMeta(l.row+u,l.col+f,"hidden")})}),a.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,o),this.hot.render())}},{key:"toggleMerge",value:function(i){var a=this.mergedCellsCollection.get(i.from.row,i.from.col),o=a.row===i.from.row&&a.col===i.from.col&&a.row+a.rowspan-1===i.to.row&&a.col+a.colspan-1===i.to.col;o?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(i,a,o,s){var l=this.hot._createCellCoords(i,a),u=this.hot._createCellCoords(o,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Gy]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,a=this.hot.getShortcutManager(),o=a.getContext("grid");o.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(l){return!l.altKey},group:h7})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),a=i.getContext("grid");a.removeShortcutsByGroup(h7)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var a=this.mergedCellsCollection.mergedCells,o=this.hot.getSelectedRangeLast(),s=0;s<a.length;s+=1)if(o.from.row===a[s].row&&o.from.col===a[s].col&&o.to.row===a[s].row+a[s].rowspan-1&&o.to.col===a[s].col+a[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var a=c7.get(this),o=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,u=this.hot._createCellCoords(o.highlight.row,o.highlight.col),f=this.mergedCellsCollection.get(u.row,u.col);if(a.lastDesiredCoords||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),f){var c=this.hot._createCellCoords(f.row,f.col),h=this.hot._createCellCoords(f.row+f.rowspan-1,f.col+f.colspan-1),d=this.hot._createCellRange(c,c,h);d.includes(a.lastDesiredCoords)||(a.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=a.lastDesiredCoords.row?a.lastDesiredCoords.row-u.row:s.row,s.col=a.lastDesiredCoords.col?a.lastDesiredCoords.col-u.col:s.col,i.row>0?s.row=f.row+f.rowspan-1-u.row+i.row:i.row<0&&(s.row=u.row-f.row+i.row),i.col>0?s.col=f.col+f.colspan-1-u.col+i.col:i.col<0&&(s.col=u.col-f.col+i.col)}l=this.hot._createCellCoords(o.highlight.row+s.row,o.highlight.col+s.col);var v=this.mergedCellsCollection.get(l.row,l.col);if(v){var p=this.mergedCellsCollection.getFirstRenderableCoords(v.row,v.col);a.lastDesiredCoords=l,s={row:p.row-u.row,col:p.col-u.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var a=this,o=this.hot.getSelectedRangeLast(),s=pi(i),l=this.selectionCalculations.getUpdatedSelectionRange(o,i),u=pi(s),f=this.mergedCellsCollection.getWithinRange(l,!0);do u=pi(s),this.selectionCalculations.getUpdatedSelectionRange(o,s),ne(f,function(c){a.selectionCalculations.snapDelta(s,o,c)});while(s.row!==u.row||s.col!==u.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,a){if(!(i<0||a<0)){var o=this.mergedCellsCollection.get(i,a);if(o){var s=o.row,l=o.col,u=o.colspan,f=o.rowspan;return[s,l,s+f-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},Zot(this))}},{key:"onAfterRenderer",value:function(i,a,o){var s=this.mergedCellsCollection.get(a,o),l=Pt(s)?pi(s):void 0;if(Pt(l)){var u=this.hot,f=u.rowIndexMapper,c=u.columnIndexMapper,h=l.row,d=l.col,v=l.colspan,p=l.rowspan,g=this.translateMergedCellToRenderable(h,p,d,v),y=Jot(g,2),m=y[0],b=y[1],S=f.getRenderableFromVisualIndex(a),x=c.getRenderableFromVisualIndex(o),T=m-S+1,E=b-x+1;l.row=f.getNearestNotHiddenIndex(l.row,1),l.col=c.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,T),l.colspan=Math.min(l.colspan,E)}MD(i,l,a,o)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var a=this.mergedCellsCollection.get(i.row,i.col),o=[a.row,a.col];i.row=o[0],i.col=o[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var a=this.hot.getSelectedRangeLast();a.highlight=this.hot._createCellCoords(a.highlight.row,a.highlight.col),a.to=i;var o=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{o=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();a.expandByRange(u)&&(i.row=a.to.row,i.col=a.to.col,o=!0)}}while(o)}},{key:"onAfterGetCellMeta",value:function(i,a,o){var s=this.mergedCellsCollection.get(i,a);s&&(s.row!==i||s.col!==a?o.copyable=!1:(o.rowspan=s.rowspan,o.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var a=this.hot.countCols();this.modifyViewportRowStart(i,a),this.modifyViewportRowEnd(i,a)}},{key:"modifyViewportRowStart",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.startRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(Pt(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.row,1));if(f<i.startRow){i.startRow=f,this.modifyViewportRowStart(i,a);return}}}}},{key:"modifyViewportRowEnd",value:function(i,a){for(var o=this.hot.rowIndexMapper,s=o.getVisualFromRenderableIndex(i.endRow),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(s,l);if(Pt(u)){var f=u.row+u.rowspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endRow){i.endRow=c,this.modifyViewportRowEnd(i,a);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var a=this.hot.countRows();this.modifyViewportColumnStart(i,a),this.modifyViewportColumnEnd(i,a)}},{key:"modifyViewportColumnStart",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.startColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(Pt(u)){var f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(u.col,1));if(f<i.startColumn){i.startColumn=f,this.modifyViewportColumnStart(i,a);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,a){for(var o=this.hot.columnIndexMapper,s=o.getVisualFromRenderableIndex(i.endColumn),l=0;l<a;l+=1){var u=this.mergedCellsCollection.get(l,s);if(Pt(u)){var f=u.col+u.colspan-1,c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(f,-1));if(c>i.endColumn){i.endColumn=c,this.modifyViewportColumnEnd(i,a);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,a,o,s){var l=this.hot,u=l.rowIndexMapper,f=l.columnIndexMapper,c,h;a===0?c=u.getNearestNotHiddenIndex(i,1):c=u.getNearestNotHiddenIndex(i+a-1,-1),s===0?h=f.getNearestNotHiddenIndex(o,1):h=f.getNearestNotHiddenIndex(o+s-1,-1);var d=i>=0?u.getRenderableFromVisualIndex(c):i,v=o>=0?f.getRenderableFromVisualIndex(h):o;return[d,v]}},{key:"onModifyAutofillRange",value:function(i,a){this.autofillCalculations.correctSelectionAreaSize(a);var o=this.autofillCalculations.getDirection(a,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(a,s,o))return s=a,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:a[0],col:a[1]},to:{row:a[2],col:a[3]}});return l&&(s=this.autofillCalculations.snapDragArea(a,s,o,l)),s}},{key:"onAfterCreateCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("right",i,a)}},{key:"onAfterRemoveCol",value:function(i,a){this.mergedCellsCollection.shiftCollections("left",i,a)}},{key:"onAfterCreateRow",value:function(i,a,o){o!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,a)}},{key:"onAfterRemoveRow",value:function(i,a){this.mergedCellsCollection.shiftCollections("up",i,a)}},{key:"onAfterChange",value:function(i,a){a==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,a){if(a&&a==="area"){var o=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(o);ne(s,function(l){o.getBottomEndCorner().row===l.getLastRow()&&o.getBottomEndCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,a,o){if(this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(s){var l=a>0,u=a<0,f=o<0,c=o>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,v=s.col+s.colspan-1===this.hot.countCols()-1,p=s.col===0;(l&&h||u&&d||c&&v||f&&p)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,a,o,s){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(i,a,o,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Gy}},{key:"PLUGIN_PRIORITY",get:function(){return pst}}]),r}(er);function d7(e){return wst(e)||bst(e)||mst(e)||yst()}function yst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mst(e,t){if(e){if(typeof e=="string")return v7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v7(e,t)}}function v7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bst(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wst(e){if(Array.isArray(e))return e}function Sst(e,t){return function(r,n){var i=d7(r),a=i.slice(1),o=d7(n),s=o.slice(1);return function l(u){var f=e[u],c=t[u],h=a[u],d=s[u],v=c.multiColumnSorting,p=v.compareFunctionFactory?v.compareFunctionFactory:kne(c.type),g=p(f,c,v)(h,d);if(g===Zo){var y=u+1;if(typeof t[y]<"u")return l(y)}return g}(0)}}var p7;function _st(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function g7(){gr(sr(p7||(p7=_st(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Gie="sort";function Cst(e,t,r){var n=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(Gie,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function xst(e){var t=e.className.split(" "),r=new RegExp("^".concat(Gie,"-[0-9]{1,2}$"));return t.filter(function(n){return r.test(n)})}function Zp(e){return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zp(e)}function Tst(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Est(n.key),n)}}function Ost(e,t,r){return t&&y7(e.prototype,t),r&&y7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Est(e){var t=Rst(e,"string");return Zp(t)==="symbol"?t:String(t)}function Rst(e,t){if(Zp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gi(){return typeof Reflect<"u"&&Reflect.get?Gi=Reflect.get.bind():Gi=function(t,r,n){var i=kst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Gi.apply(this,arguments)}function kst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=li(e),e!==null););return e}function Ast(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FD(e,t)}function FD(e,t){return FD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FD(e,t)}function Pst(e){var t=Dst();return function(){var n=li(e),i;if(t){var a=li(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ist(this,i)}}function Ist(e,t){if(t&&(Zp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mst(e)}function Mst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function li(e){return li=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},li(e)}var $D="multiColumnSorting",Nst=170,Lst="append",m7="columnSorting";Rne($D,Sst);var Fst=function(e){Ast(r,e);var t=Pst(r);function r(n){var i;return Tst(this,r),i=t.call(this,n),i.pluginKey=$D,i}return Ost(r,[{key:"isEnabled",value:function(){return Gi(li(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[m7]&&g7(),Gi(li(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Gi(li(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){Gi(li(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){Gi(li(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Gi(li(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return Gi(li(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){Gi(li(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var a,o=arguments.length,s=new Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];(a=Gi(li(r.prototype),"updateHeaderClasses",this)).call.apply(a,[this,i].concat(s)),St(i,xst(i)),this.enabled!==!1&&ke(i,Cst.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[m7]&&g7(),Gi(li(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,a){N2(a.row,a.col,i)!==!1&&this.wasClickableHeaderClicked(i,a.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(a.col),this.sort(this.getNextSortConfig(a.col,Lst))):this.sort(this.getColumnNextConfig(a.col)))}}],[{key:"PLUGIN_KEY",get:function(){return $D}},{key:"PLUGIN_PRIORITY",get:function(){return Nst}}]),r}(Pne);function Jp(e){return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}function $st(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bst(n.key),n)}}function Hst(e,t,r){return t&&b7(e.prototype,t),r&&b7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bst(e){var t=Vst(e,"string");return Jp(t)==="symbol"?t:String(t)}function Vst(e,t){if(Jp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EC(){return typeof Reflect<"u"&&Reflect.get?EC=Reflect.get.bind():EC=function(t,r,n){var i=jst(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},EC.apply(this,arguments)}function jst(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qp(e),e!==null););return e}function Wst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HD(e,t)}function HD(e,t){return HD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},HD(e,t)}function Ust(e){var t=Yst();return function(){var n=Qp(e),i;if(t){var a=Qp(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return zst(this,i)}}function zst(e,t){if(t&&(Jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gst(e)}function Gst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yst(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qp(e)}var Kst="multipleSelectionHandles",Xst=160,qst=function(e){Wst(r,e);var t=Ust(r);function r(n){var i;return $st(this,r),i=t.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return Hst(r,[{key:"isEnabled",value:function(){return oo()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Fr(this)),this.registerListeners(),EC(Qp(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,a=this,o=this.hot.rootElement;function s(l){if(a.dragged.length===1)return a.dragged.splice(0,a.dragged.length),!0;var u=a.dragged.indexOf(l);if(u===-1)return!1;u===0?a.dragged=a.dragged.slice(0,1):u===1&&(a.dragged=a.dragged.slice(-1))}this.eventManager.addEventListener(o,"touchstart",function(l){var u;if(bt(l.target,"topSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("top"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(bt(l.target,"bottomSelectionHandle-HitArea"))return u=a.hot.getSelectedRangeLast(),a.dragged.push("bottom"),a.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchend",function(l){if(bt(l.target,"topSelectionHandle-HitArea"))return s.call(a,"top"),a.touchStartRange=void 0,l.preventDefault(),!1;if(bt(l.target,"bottomSelectionHandle-HitArea"))return s.call(a,"bottom"),a.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(o,"touchmove",function(l){var u=i.hot.rootDocument,f,c,h,d,v,p;if(a.dragged.length!==0){var g=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!g||g===a.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(f=a.hot.getCoords(g),f.col===-1&&(f.col=0),c=a.hot.getSelectedRangeLast(),h=c.getWidth(),d=c.getHeight(),v=c.getDirection(),h===1&&d===1&&a.hot.selection.setRangeEnd(f),p=a.getCurrentRangeCoords(c,f,a.touchStartRange.direction,v,a.dragged[0]),p.start!==null&&a.hot.selection.setRangeStart(p.start),a.hot.selection.setRangeEnd(p.end),a.lastSetCell=g),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,a,o,s,l){var u=i.getTopStartCorner(),f=i.getBottomEndCorner(),c=i.getBottomStartCorner(),h=i.getTopEndCorner(),d={start:null,end:null};switch(o){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?d={start:this.hot._createCellCoords(a.row,i.highlight.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,u.col)};break;case"SE-NW":l==="bottom"&&(d={start:this.hot._createCellCoords(f.row,a.col),end:this.hot._createCellCoords(a.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?d={start:a,end:c}:d.end=a;break;case"NW-SE":l==="top"?d={start:a,end:f}:d.end=a;break;case"SE-NW":l==="top"?d={start:a,end:u}:d.end=a;break;case"SW-NE":l==="top"?d={start:a,end:h}:d.end=a;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(c.row,a.col)}:d={start:this.hot._createCellCoords(u.row,a.col),end:this.hot._createCellCoords(a.row,f.col)};break;case"SW-NE":l==="top"?d={start:this.hot._createCellCoords(i.highlight.row,a.col),end:this.hot._createCellCoords(a.row,f.col)}:d={start:this.hot._createCellCoords(a.row,u.col),end:this.hot._createCellCoords(u.row,a.col)};break;case"SE-NW":l==="bottom"?d={start:this.hot._createCellCoords(a.row,h.col),end:this.hot._createCellCoords(u.row,a.col)}:l==="top"&&(d={start:c,end:a});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(d.end=a);break;case"SE-NW":l==="top"?d.end=a:d={start:a,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return Kst}},{key:"PLUGIN_PRIORITY",get:function(){return Xst}}]),r}(er);function BD(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.label,r=t===void 0?"":t,n=e.colspan,i=n===void 0?1:n,a=e.origColspan,o=a===void 0?1:a,s=e.collapsible,l=s===void 0?!1:s,u=e.crossHiddenColumns,f=u===void 0?[]:u,c=e.isCollapsed,h=c===void 0?!1:c,d=e.isHidden,v=d===void 0?!1:d,p=e.isRoot,g=p===void 0?!1:p,y=e.isPlaceholder,m=y===void 0?!1:y;return{label:r,colspan:i,origColspan:o,collapsible:l,isCollapsed:h,crossHiddenColumns:f,isHidden:v,isRoot:g,isPlaceholder:m}}function Yie(){return{label:"",isPlaceholder:!0}}function w7(e){return elt(e)||Qst(e)||Jst(e)||Zst()}function Zst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jst(e,t){if(e){if(typeof e=="string")return VD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VD(e,t)}}function Qst(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function elt(e){if(Array.isArray(e))return VD(e)}function VD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tlt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(t===0)return r;ne(e,function(i){var a=[],o=0;r.push(a),ne(i,function(s){var l=BD();if(Pt(s)){var u=s.label,f=s.colspan;l.label=jr(u),typeof f=="number"&&f>1&&(l.colspan=f,l.origColspan=f)}else l.label=jr(s);o+=l.origColspan;var c=!1;if(o>=t&&(l.colspan=l.origColspan-(o-t),l.origColspan=l.colspan,c=!0),a.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)a.push(Yie());return!c})});var n=Math.max.apply(Math,w7(At(r,function(i){return i.length})));return ne(r,function(i){if(i.length<n){var a=At(new Array(n-i.length),function(){return BD()});i.splice.apply(i,[i.length,0].concat(w7(a)))}}),r}function Yb(e){return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yb(e)}var rlt=["row","col"];function S7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nlt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S7(Object(r),!0).forEach(function(n){ilt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ilt(e,t,r){return t=Kie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function alt(e,t){if(e==null)return{};var r=olt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function olt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function slt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kie(n.key),n)}}function llt(e,t,r){return t&&_7(e.prototype,t),r&&_7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kie(e){var t=ult(e,"string");return Yb(t)==="symbol"?t:String(t)}function ult(e,t){if(Yb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fA(e,t,r){flt(e,t),t.set(e,r)}function flt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ua(e,t){var r=Xie(e,t,"get");return clt(e,r)}function clt(e,t){return t.get?t.get.call(e):t.value}function py(e,t,r){var n=Xie(e,t,"set");return hlt(e,n,r),r}function Xie(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function hlt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var C7=["label","collapsible"],ms=new WeakMap,lf=new WeakMap,cA=new WeakMap,dlt=function(){function e(){slt(this,e),fA(this,ms,{writable:!0,value:[]}),fA(this,lf,{writable:!0,value:0}),fA(this,cA,{writable:!0,value:1/0})}return llt(e,[{key:"setColumnsLimit",value:function(r){py(this,cA,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];py(this,ms,tlt(r,Ua(this,cA))),py(this,lf,Ua(this,ms).length)}},{key:"getData",value:function(){return Ua(this,ms)}},{key:"mergeWith",value:function(r){var n=this;ne(r,function(i){var a=i.row,o=i.col,s=alt(i,rlt),l=n.getHeaderSettings(a,o);l!==null&&an(l,s,C7)})}},{key:"map",value:function(r){ne(Ua(this,ms),function(n){ne(n,function(i){var a=r(nlt({},i));Pt(a)&&an(i,a,C7)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=Ua(this,lf)||r<0)return null;var a=Ua(this,ms)[r];return n>=a.length?null:(i=a[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=[];if(r>=Ua(this,lf)||r<0)return a;for(var o=Ua(this,ms)[r],s=0,l=n;l<o.length;l++){var u=o[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,a.push(u),u.colspan>1&&(l+=u.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return a}},{key:"getLayersCount",value:function(){return Ua(this,lf)}},{key:"getColumnsCount",value:function(){return Ua(this,lf)>0?Ua(this,ms)[0].length:0}},{key:"clear",value:function(){py(this,ms,[]),py(this,lf,0)}}]),e}();function Kb(e){return Kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kb(e)}function x7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function T7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x7(Object(r),!0).forEach(function(n){RC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qie(n.key),n)}}function plt(e,t,r){return t&&O7(e.prototype,t),r&&O7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function RC(e,t,r){return t=qie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qie(e){var t=glt(e,"string");return Kb(t)==="symbol"?t:String(t)}function glt(e,t){if(Kb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ylt(e){return Slt(e)||wlt(e)||blt(e)||mlt()}function mlt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function blt(e,t){if(e){if(typeof e=="string")return jD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jD(e,t)}}function wlt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Slt(e){if(Array.isArray(e))return jD(e)}function jD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _lt="DF-pre-order";function Zie(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=Zie.call(this.childs[n],e,t)}return r}var Clt="DF-post-order";function Jie(e,t){for(var r=0;r<this.childs.length;r++){var n=Jie.call(this.childs[r],e,t);if(n===!1)return!1}return e.call(t,this)}var Qie="BF";function xlt(e,t){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,ylt(i.childs)),e.call(t,i)!==!1&&n()}}n()}var Tlt=Qie,E7=new Map([[_lt,Zie],[Clt,Jie],[Qie,xlt]]),R7=function(){function e(t){vlt(this,e),RC(this,"data",{}),RC(this,"parent",null),RC(this,"childs",[]),this.data=t}return plt(e,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new e(T7({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=T7({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tlt;if(!E7.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));E7.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function a(o){var s=r.call(n,o);s!==!1&&o.parent!==null&&a(o.parent)};i(this)}}]),e}();function Xb(e){return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function A7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){Olt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Olt(e,t,r){return t=eae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Elt(e,t){return Plt(e)||Alt(e,t)||klt(e,t)||Rlt()}function Rlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function klt(e,t){if(e){if(typeof e=="string")return P7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P7(e,t)}}function P7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Alt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Plt(e){if(Array.isArray(e))return e}function Ilt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eae(n.key),n)}}function Mlt(e,t,r){return t&&I7(e.prototype,t),r&&I7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eae(e){var t=Dlt(e,"string");return Xb(t)==="symbol"?t:String(t)}function Dlt(e,t){if(Xb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hA(e,t,r){Nlt(e,t),t.set(e,r)}function Nlt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ii(e,t){var r=tae(e,t,"get");return Llt(e,r)}function Llt(e,t){return t.get?t.get.call(e):t.value}function Flt(e,t,r){var n=tae(e,t,"set");return $lt(e,n,r),r}function tae(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function $lt(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}var Zh=new WeakMap,uf=new WeakMap,Jh=new WeakMap,Hlt=function(){function e(t){Ilt(this,e),hA(this,Zh,{writable:!0,value:new Map}),hA(this,uf,{writable:!0,value:new Map}),hA(this,Jh,{writable:!0,value:null}),Flt(this,Jh,t)}return Mlt(e,[{key:"getRoots",value:function(){return Array.from(ii(this,Zh).values())}},{key:"getRootByColumn",value:function(r){var n;return ii(this,uf).has(r)&&(n=ii(this,Zh).get(ii(this,uf).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(i){var a=n-ii(this,uf).get(n),o=0,s;return i.walkDown(function(l){var u=l.data,f=u.origColspan,c=u.headerLevel;if(r===c){if(a>=o&&a<=o+f-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;o+=f}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;ii(this,uf).clear(),ne(ii(this,Zh),function(i){for(var a=Elt(i,2),o=a[1].data.colspan,s=n;s<n+o;s++)ii(r,uf).set(s,n);n+=o})}},{key:"buildTree",value:function(){this.clear();for(var r=ii(this,Jh).getColumnsCount(),n=0;n<r;){var i=ii(this,Jh).getHeaderSettings(0,n),a=new R7;ii(this,Zh).set(n,a),this.buildLeaves(a,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var a=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=ii(this,Jh).getHeadersSettings(i,n,o);i+=1,ne(s,function(l){var u=A7(A7({},l),{},{headerLevel:i-1,columnIndex:n}),f;i===1?(r.data=u,f=r):(f=new R7(u),r.addChild(f)),i<ii(a,Jh).getLayersCount()&&a.buildLeaves(f,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){ii(this,Zh).clear(),ii(this,uf).clear()}}]),e}();function rae(e,t){e.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(t(n.columnIndex),i.length===0))for(var a=1;a<n.colspan;a++)t(n.columnIndex+a)})}function iT(e,t){var r=e.childs;if(r.length!==0)return r[0].data[t]}function aT(e){return iT(e,"origColspan")===e.data.origColspan}function EB(e){var t=e.data,r=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=aT(e);if(n)return EB(r[0]);t.isCollapsed=!1;var i=r.slice(1),a=new Set,o=0;if(i.length>0)ne(i,function(c){c.replaceTreeWith(c.data.clonedTree),c.data.clonedTree=null;var h=c.data;o+=h.colspan,rae(c,function(d){a.add(d)})});else{var s=t.colspan,l=t.origColspan,u=t.columnIndex;o=l-s;for(var f=1;f<l;f++)a.add(u+f)}return e.walkUp(function(c){var h=c.data;h.colspan+=o,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):aT(c)&&(h.isCollapsed=iT(c,"isCollapsed"))}),{rollbackModification:function(){return RB(e)},affectedColumns:Array.from(a),colspanCompensation:o}}function RB(e){var t,r=e.data,n=e.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=aT(e);if(i)return RB(n[0]);r.isCollapsed=!0;var a=n.slice(1),o=new Set;if(a.length>0)ne(a,function(h){rae(h,function(d){o.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var v=d.data;v.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var f=l+u;o.add(f)}var c=r.colspan-((t=iT(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(function(h){var d=h.data;d.colspan-=c,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):aT(h)&&(d.isCollapsed=iT(h,"isCollapsed"))}),{rollbackModification:function(){return EB(e)},affectedColumns:Array.from(o),colspanCompensation:c}}var M7;function Blt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Vlt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(sr(M7||(M7=Blt([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(!r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.push(t),a.colspan>1?a.colspan-=1:a.isHidden=!0})}}var D7;function jlt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Wlt(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(sr(D7||(D7=jlt([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=e.data.crossHiddenColumns;if(r.includes(t)){var n=!1;e.walkUp(function(i){var a=i.data.collapsible;if(a)return n=!0,!1}),!n&&e.walkUp(function(i){var a=i.data;a.crossHiddenColumns.splice(a.crossHiddenColumns.indexOf(t),1),!a.isHidden&&a.colspan<a.origColspan&&(a.colspan+=1),a.isHidden=!1})}}var N7=new Map([["collapse",RB],["expand",EB],["hide-column",Vlt],["show-column",Wlt]]);function Ult(e,t,r){if(!N7.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return N7.get(e)(t,r)}var zlt=["crossHiddenColumns"];function Glt(e,t){if(e==null)return{};var r=Ylt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ylt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function N_(e){var t=[];return ne(e,function(r){r.walkDown(function(n){for(var i=n.data,a=i.origColspan,o=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,u=Xlt(t,s),f=!1,c=o;c<o+a;c++){var h=l.includes(c);if(h||f)u.push(Yie());else{var d=Klt(i);d.isRoot=!0,u.push(d),f=!0}}})}),t}function Klt(e){var t=BD(e);t.crossHiddenColumns;var r=Glt(t,zlt);return r}function Xlt(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function qb(e){return qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qb(e)}var qlt=["row"];function L7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function F7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L7(Object(r),!0).forEach(function(n){Zlt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zlt(e,t,r){return t=nae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jlt(e,t){if(e==null)return{};var r=Qlt(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Qlt(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function eut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nae(n.key),n)}}function tut(e,t,r){return t&&$7(e.prototype,t),r&&$7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nae(e){var t=rut(e,"string");return qb(t)==="symbol"?t:String(t)}function rut(e,t){if(qb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dA(e,t,r){nut(e,t),t.set(e,r)}function nut(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gy(e,t,r){var n=iae(e,t,"set");return iut(e,n,r),r}function iut(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function zr(e,t){var r=iae(e,t,"get");return aut(e,r)}function iae(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function aut(e,t){return t.get?t.get.call(e):t.value}var Do=new WeakMap,zi=new WeakMap,ff=new WeakMap,out=function(){function e(){eut(this,e),dA(this,Do,{writable:!0,value:new dlt}),dA(this,zi,{writable:!0,value:new Hlt(zr(this,Do))}),dA(this,ff,{writable:!0,value:[[]]})}return tut(e,[{key:"setState",value:function(r){zr(this,Do).setData(r);var n=!1;try{zr(this,zi).buildTree()}catch{zr(this,zi).clear(),zr(this,Do).clear(),n=!0}return gy(this,ff,N_(zr(this,zi).getRoots())),n}},{key:"setColumnsLimit",value:function(r){zr(this,Do).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=At(r,function(a){var o=a.row,s=Jlt(a,qlt);return F7({row:o<0?n.rowCoordsToLevel(o):o},s)});zr(this,Do).mergeWith(i),zr(this,zi).buildTree(),gy(this,ff,N_(zr(this,zi).getRoots()))}},{key:"mapState",value:function(r){zr(this,Do).map(r),zr(this,zi).buildTree(),gy(this,ff,N_(zr(this,zi).getRoots()))}},{key:"mapNodes",value:function(r){return Zr(zr(this,zi).getRoots(),function(n,i){return i.walkDown(function(a){var o=r(a.data);o!==void 0&&n.push(o)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var a=zr(this,zi).getNode(n,i),o;return a&&(o=Ult(r,a,i),gy(this,ff,N_(zr(this,zi).getRoots()))),o}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,a;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(a=zr(this,ff)[r])===null||a===void 0?void 0:a[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=zr(this,zi).getNode(r,n);return i?F7({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,a=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},o=a.isRoot;if(o)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},f=u.isRoot;if(f)break;s-=1}return s}},{key:"getLayersCount",value:function(){return zr(this,Do).getLayersCount()}},{key:"getColumnsCount",value:function(){return zr(this,Do).getColumnsCount()}},{key:"clear",value:function(){gy(this,ff,[]),zr(this,Do).clear(),zr(this,zi).clear()}}]),e}();function Zb(e){return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(e)}function sut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aae(n.key),n)}}function lut(e,t,r){return t&&H7(e.prototype,t),r&&H7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yy(e,t,r){return t=aae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aae(e){var t=uut(e,"string");return Zb(t)==="symbol"?t:String(t)}function uut(e,t){if(Zb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fut=function(){function e(t,r){sut(this,e),yy(this,"hot",void 0),yy(this,"nestedHeaderSettingsGetter",void 0),yy(this,"layersCount",0),yy(this,"container",void 0),yy(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return lut(e,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(a);this.widthsMap.setValueAtIndex(o,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,a=n.columnIndexMapper,o=i.createDocumentFragment(),s=i.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=a.getRenderableIndexesLength(),f=0;f<this.layersCount;f++){for(var c=i.createElement("tr"),h=0;h<u;h++){var d=a.getVisualFromRenderableIndex(h);d===null&&(d=h);var v=i.createElement("th"),p=this.nestedHeaderSettingsGetter(f,d);if(p&&(!p.isPlaceholder||p.isHidden)){var g=p.label;l&&(g+='<button class="changeType"></button>'),lh(v,g),v.colSpan=p.colspan,c.appendChild(v)}}s.appendChild(c)}o.appendChild(s),r.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),e}();const cut=fut;function eg(e){return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(e)}var B7,V7;function j7(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function hut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oae(n.key),n)}}function dut(e,t,r){return t&&W7(e.prototype,t),r&&W7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cc(){return typeof Reflect<"u"&&Reflect.get?cc=Reflect.get.bind():cc=function(t,r,n){var i=vut(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},cc.apply(this,arguments)}function vut(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Zs(e),e!==null););return e}function put(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WD(e,t)}function WD(e,t){return WD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WD(e,t)}function gut(e){var t=mut();return function(){var n=Zs(e),i;if(t){var a=Zs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return yut(this,i)}}function yut(e,t){if(t&&(eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yy(e)}function Yy(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zs(e){return Zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zs(e)}function U7(e,t,r){return t=oae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oae(e){var t=but(e,"string");return eg(t)==="symbol"?t:String(t)}function but(e,t){if(eg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function z7(e,t,r){wut(e,t),t.set(e,r)}function wut(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L_(e,t,r){var n=sae(e,t,"set");return Sut(e,n,r),r}function Sut(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}function $r(e,t){var r=sae(e,t,"get");return _ut(e,r)}function sae(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function _ut(e,t){return t.get?t.get.call(e):t.value}var G7="nestedHeaders",Cut=280,Qr=new WeakMap,Nl=new WeakMap,xut=function(e){put(r,e);var t=gut(r);function r(){var n;hut(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a)),z7(Yy(n),Qr,{writable:!0,value:new out}),z7(Yy(n),Nl,{writable:!0,value:null}),U7(Yy(n),"ghostTable",new cut(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),U7(Yy(n),"detectedOverlappedHeaders",!1),n}return dut(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[G7]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings(),o=a.nestedHeaders;(!Array.isArray(o)||!Array.isArray(o[0]))&&gr(sr(B7||(B7=j7([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),cc(Zs(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(this.hot.view){var a=this.hot.getSettings(),o=a.nestedHeaders;$r(this,Qr).setColumnsLimit(this.hot.countCols()),Array.isArray(o)&&(this.detectedOverlappedHeaders=$r(this,Qr).setState(o)),this.detectedOverlappedHeaders&&gr(sr(V7||(V7=j7([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";$r(i,Qr).triggerColumnModification(u,l)}),!$r(this,Nl)&&this.enabled&&L_(this,Nl,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,f=l.index,c=l.newValue;if(u==="replace"){var h=c===!0?"hide-column":"show-column";$r(i,Qr).triggerColumnModification(h,f)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),cc(Zs(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),$r(this,Qr).clear(),$r(this,Nl).unsubscribe(),L_(this,Nl,null),this.ghostTable.clear(),cc(Zs(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return $r(this,Qr)}},{key:"getLayersCount",value:function(){return $r(this,Qr).getLayersCount()}},{key:"getHeaderSettings",value:function(i,a){return $r(this,Qr).getHeaderSettings(i,a)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var i=this.hot.view._wt,a=i.getSetting("columnHeaders").length,o=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<a;u++){var f=o.childNodes[u];if(!f)break;for(var c=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,v=f.childNodes.length;d<v;d++)f.childNodes[d].removeAttribute("colspan"),St(f.childNodes[d],"hiddenHeader"),c&&c.childNodes[d]&&(c.childNodes[d].removeAttribute("colspan"),St(c.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),St(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var a=this,o=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,f=a.hot,c=f.columnIndexMapper,h=f.view,d=c.getVisualFromRenderableIndex(s);d===null&&(d=s),l.removeAttribute("colspan"),St(l,"hiddenHeader");var v=(u=$r(a,Qr).getHeaderSettings(i,d))!==null&&u!==void 0?u:{label:""},p=v.colspan,g=v.isHidden,y=v.isPlaceholder;if(y||g)ke(l,"hiddenHeader");else if(p>1){var m,b,S=h._wt.wtOverlays,x=(m=S.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(l),T=(b=S.inlineStartOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(l),E=x||T?Math.min(p,o-s):p;E>1&&l.setAttribute("colspan",E)}a.hot.view.appendColHeader(d,l,function(){return a.getColumnHeaderValue.apply(a,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,a){var o,s=(o=$r(this,Qr).getHeaderSettings(a,i))!==null&&o!==void 0?o:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(i,a)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,a,o){var s=$r(this,Qr).getHeaderTreeNodeData(a,i);if(!s)return i;var l=o.classNames,u=o.columnCursor,f=o.selectionType,c=o.selectionWidth,h=$r(this,Qr).getHeaderSettings(a,i),d=h.isRoot,v=h.colspan;if(f===lS){if(!d)return s.columnIndex}else f===KO&&(v>c-u||!d)&&(l.length=0);return i}},{key:"onBeforeCopy",value:function(i,a,o){var s=o.columnHeadersCount;if(s!==0)for(var l=0;l<a.length;l++){var u=a[l],f=u.startRow,c=u.startCol,h=u.endRow,d=u.endCol,v=h-f+1,p=c-d+1;if(f>=0||p===1)break;for(var g=c;g<=d;g++)for(var y=f;y<=h;y++){var m,b=v+y,S=g-c;if(S!==0){var x=(m=$r(this,Qr).getHeaderTreeNodeData(y,g))===null||m===void 0?void 0:m.isRoot;x===!1&&(i[b][S]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o,s){var l=this._getHeaderTreeNodeDataByCoords(a);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,a){var o=this._getHeaderTreeNodeDataByCoords(a);if(o){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],f=o.columnIndex,c=o.origColspan,h=!s.inInSelection(a);i.shiftKey&&l?a.col<l.from.col?u.push(l.getTopEndCorner().col,f,a.row):a.col>l.from.col?u.push(l.getTopStartCorner().col,f+c-1,a.row):u.push(f,f+c-1,a.row):(HO(i)||Pu(i)&&h)&&u.push(f,f+c-1,a.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(i,a,o,s){var l;if(this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(a);if(u){var f=u.columnIndex,c=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),v=h.getBottomEndCorner(),p=h.from;s.column=!0,s.cell=!0;var g=[];a.col<p.col?g.push(v.col,f):a.col>p.col?g.push(d.col,f+c-1):g.push(f,f+c-1),(l=this.hot).selectColumns.apply(l,g)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var a=0;a<$r(this,Qr).getLayersCount();a++)i.push(this.headerRendererFactory(a))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var a=$r(this,Qr).getLayersCount(),o=i.startColumn,s=!!a,l=0;l<a;l++){var u=$r(this,Qr).findLeftMostColumnIndex(l,i.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),Xi(f)&&f<i.startColumn){o=f;break}}i.startColumn=s?$r(this,Qr).getHeaderTreeNodeData(0,o).columnIndex:o}},{key:"onModifyColWidth",value:function(i,a){var o=this.ghostTable.getWidth(a);return i>o?i:o}},{key:"onModifyColumnHeaderValue",value:function(i,a,o){var s,l=(s=$r(this,Qr).getHeaderTreeNodeData(o,a))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,a){a||this.updatePlugin()}},{key:"destroy",value:function(){L_(this,Qr,null),$r(this,Nl)!==null&&($r(this,Nl).unsubscribe(),L_(this,Nl,null)),cc(Zs(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return $r(this,Qr).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return G7}},{key:"PLUGIN_PRIORITY",get:function(){return Cut}}]),r}(er);function Y7(e){return Rut(e)||Eut(e)||Out(e)||Tut()}function Tut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Out(e,t){if(e){if(typeof e=="string")return UD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UD(e,t)}}function Eut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rut(e){if(Array.isArray(e))return UD(e)}function UD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tg(e){return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tg(e)}function kut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Put(n.key),n)}}function Aut(e,t,r){return t&&K7(e.prototype,t),r&&K7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Put(e){var t=Iut(e,"string");return tg(t)==="symbol"?t:String(t)}function Iut(e,t){if(tg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mut=function(){function e(t,r){kut(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return Aut(e,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rt(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var a=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&ne(r.__children,function(o){a.cacheNode(o,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,a){var o=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:u,end:!0}:a!=null&&u===a?{result:l,end:!0}:(l+=1,u.__children&&ne(u.__children,function(f){if(o.parentReference.set(f,s?null:u),l=o.readTreeNodes(f,l,i,a),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return It(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,a=r;return isNaN(a)||(a=this.getDataObject(a)),!a||!a.__children?0:(ne(a.__children,function(o){i+=1,o.__children&&(i+=n.countChildren(o))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||tg(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var a=null;r&&(a=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",a+this.countChildren(r)+1,1);var o=r;r||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var a=i,o;if(a||(a=this.mockNode()),this.hot.runHooks("beforeAddChild",r,a,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,a),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),o=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);a=this.getDataObject(o),this.hot.runHooks("afterAddChild",r,a,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),a=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(a,o+1,null);break;case"above":this.addChildAtIndex(a,o,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=null,o=[];Array.isArray(r)?(rt(r[0],r[2],function(y){var m=n.translateTrimmedRow(y);o.push(n.getDataObject(m))}),rt(0,o.length-2,function(y){n.detachFromParent(o[y],!1)}),a=o[o.length-1]):a=r;var s=this.getRowIndex(a),l=this.countChildren(a),u=this.getRowIndexWithinParent(a),f=this.getRowParent(a),c=this.getRowParent(f),h=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",f,a),u!=null){var v=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,v,this.plugin.pluginName),f.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,v,this.plugin.pluginName),c){d=h+this.countChildren(c);var p=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",g+1,l+1,this.plugin.pluginName),c.__children.push(a)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(a)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",f,a,this.getRowIndex(a)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var a=this,o=[];ne(i,function(s){o.push(a.getDataObject(s))}),ne(o,function(s){var l=a.getRowIndexWithinParent(s),u=a.getRowParent(s);u===null?a.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var a=this.getDataObject(r-1),o=null,s=r;if(a&&a.__children&&a.__children.length===0?(o=a,s=0):r<this.countAllRows()&&(o=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),o)if(i){var l;(l=o.__children).splice.apply(l,[s,n].concat(Y7(i)))}else o.__children.splice(s,n);else if(i){var u;(u=this.data).splice.apply(u,[s,n].concat(Y7(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,a){var o=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),f=r>n,c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);var h=o||i||a?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,u[0]),s.__children.splice(l+(f&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),e}();const Dut=Mut;function Jb(e){return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(e)}function X7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lut(n.key),n)}}function Nut(e,t,r){return t&&X7(e.prototype,t),r&&X7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lut(e){var t=Fut(e,"string");return Jb(t)==="symbol"?t:String(t)}function Fut(e,t){if(Jb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Hut=Nut(function e(t,r){$ut(this,e),this.hot=r,this.plugin=t});const kB=Hut;function rg(e){return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(e)}function But(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jut(n.key),n)}}function Vut(e,t,r){return t&&q7(e.prototype,t),r&&q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jut(e){var t=Wut(e,"string");return rg(t)==="symbol"?t:String(t)}function Wut(e,t){if(rg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zD(e,t)}function zD(e,t){return zD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zD(e,t)}function zut(e){var t=Kut();return function(){var n=oT(e),i;if(t){var a=oT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Gut(this,i)}}function Gut(e,t){if(t&&(rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yut(e)}function Yut(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oT(e){return oT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oT(e)}var Xut=function(e){Uut(r,e);var t=zut(r);function r(n,i){var a;return But(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsingUI=a.plugin.collapsingUI,a.rowHeaderWidthCache=null,a}return Vut(r,[{key:"appendLevelIndicators",value:function(i,a){var o=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(o),l=this.dataManager.getDataObject(o),u=a.getElementsByTagName("DIV")[0],f=u.querySelector("span.rowHeader"),c=u.querySelectorAll('[class^="ht_nesting"]');if(ne(c,function(p){p&&u.removeChild(p)}),ke(a,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=f.cloneNode(!0);u.innerHTML="",rt(0,s-1,function(){var p=h.createElement("SPAN");ke(p,r.CSS_CLASSES.emptyIndicator),u.appendChild(p)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var v=this.hot.rootDocument.createElement("DIV");ke(a,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?ke(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):ke(v,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(v)}}},{key:"updateRowHeaderWidth",value:function(i){var a=i;a||(a=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*a+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(kB);const lae=Xut;function ng(e){return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ng(e)}function Z7(e){return Qut(e)||Jut(e)||Zut(e)||qut()}function qut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zut(e,t){if(e){if(typeof e=="string")return GD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GD(e,t)}}function Jut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qut(e){if(Array.isArray(e))return GD(e)}function GD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rft(n.key),n)}}function tft(e,t,r){return t&&J7(e.prototype,t),r&&J7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rft(e){var t=nft(e,"string");return ng(t)==="symbol"?t:String(t)}function nft(e,t){if(ng(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ng(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ift(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YD(e,t)}function YD(e,t){return YD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YD(e,t)}function aft(e){var t=lft();return function(){var n=sT(e),i;if(t){var a=sT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return oft(this,i)}}function oft(e,t){if(t&&(ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sft(e)}function sft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sT(e){return sT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sT(e)}var uft=function(e){ift(r,e);var t=aft(r);function r(n,i){var a;return eft(this,r),a=t.call(this,n,i),a.dataManager=a.plugin.dataManager,a.collapsedRows=[],a.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;a.lastCollapsedRows=a.collapsedRows.slice(0),a.expandMultipleChildren(a.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),ne(a.lastCollapsedRows,function(f,c){f>=s&&f<l&&(a.lastCollapsedRows[c]=f+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;a.collapseMultipleChildren(a.lastCollapsedRows,s),a.lastCollapsedRows=void 0},trimStash:function(s,l){rt(s,s+l-1,function(u){var f=a.lastCollapsedRows.indexOf(u);f>-1&&a.lastCollapsedRows.splice(f,1)})}},a}return tft(r,[{key:"collapseChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(i),f=i),this.dataManager.hasChildren(u)&&ne(u.__children,function(h){l.push(a.dataManager.getRowIndex(h))}),c=this.collapseRows(l,!0,!1),s&&this.trimRows(c),o&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),c}},{key:"collapseMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ne(i,function(u){l.push.apply(l,Z7(a.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),o&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],a)}},{key:"collapseRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ne(i,function(u){l.push(u),o&&a.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ne(l.__children,function(u){var f=a.dataManager.getRowIndex(u);o.push(f),a.collapseChildRows(f,o)})}s&&this.trimRows(o)}},{key:"expandRow",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],a)}},{key:"expandRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ne(i,function(u){l.push(u),o&&a.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ne(l.__children,function(u){if(!a.isAnyParentCollapsed(u)){var f=a.dataManager.getRowIndex(u);o.push(f),a.expandChildRows(f,o)}})}s&&this.untrimRows(o)}},{key:"expandChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,f=null,c=null;return isNaN(i)?(u=i,f=this.dataManager.getRowIndex(i)):(u=this.dataManager.getDataObject(i),f=i),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(u)&&ne(u.__children,function(h){var d=a.dataManager.getRowIndex(h);l.push(d)}),c=this.expandRows(l,!0,!1),s&&this.untrimRows(c),o&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ne(i,function(u){l.push.apply(l,Z7(a.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),o&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ne(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.collapseMultipleChildren(o),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,a=this.dataManager.getData(),o=[];ne(a,function(s){i.dataManager.hasChildren(s)&&o.push(s)}),this.expandMultipleChildren(o),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ne(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"untrimRows",value:function(i){var a=this;this.hot.batchExecution(function(){ne(i,function(o){a.plugin.collapsedRowsMap.setValueAtIndex(o,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var a=this,o=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return o===null&&(o={__children:this.dataManager.data}),this.dataManager.hasChildren(o)&&ne(o.__children,function(l){var u=a.dataManager.getRowIndex(l);if(!a.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var a=i;a!==null;){a=this.dataManager.getRowParent(a);var o=this.dataManager.getRowIndex(a);if(this.collapsedRows.indexOf(o)>-1)return!0}return!1}},{key:"toggleState",value:function(i,a){if(!(a.col>=0)){var o=this.translateTrimmedRow(a.row);bt(i.target,lae.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),bo(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(kB);const fft=uft;function ig(e){return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}function cft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dft(n.key),n)}}function hft(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dft(e){var t=vft(e,"string");return ig(t)==="symbol"?t:String(t)}function vft(e,t){if(ig(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ig(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KD(e,t)}function KD(e,t){return KD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KD(e,t)}function gft(e){var t=mft();return function(){var n=lT(e),i;if(t){var a=lT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return yft(this,i)}}function yft(e,t){if(t&&(ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uae(e)}function uae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lT(e){return lT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lT(e)}var e9=new WeakMap,bft=function(e){pft(r,e);var t=gft(r);function r(n,i){var a;return cft(this,r),a=t.call(this,n,i),e9.set(uae(a),{row_above:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];a.dataManager.addSibling(u.start.row,"below")}}),a.dataManager=a.plugin.dataManager,a}return hft(r,[{key:"appendOptions",value:function(i){var a=this,o=[{key:"add_child",name:function(){return this.getTranslatedPhrase(gH)},callback:function(){var l=a.dataManager.translateTrimmedRow(a.hot.getSelectedLast()[0]),u=a.dataManager.getDataObject(l);a.dataManager.addChild(u)},disabled:function(){var l=a.hot.getSelectedLast();return!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(yH)},callback:function(){a.dataManager.detachFromParent(a.hot.getSelectedLast())},disabled:function(){var l=a.hot.getSelectedLast(),u=a.dataManager.translateTrimmedRow(l[0]),f=a.dataManager.getRowParent(u);return!f||!l||l[0]<0||a.hot.selection.isSelectedByColumnHeader()||a.hot.countRows()>=a.hot.getSettings().maxRows}},{name:"---------"}];return rt(0,i.items.length-1,function(s){if(s===0)return ne(o,function(l,u){i.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var a=e9.get(this);return rt(0,i.items.length-1,function(o){var s=a[i.items[o].key];s!=null&&(i.items[o].callback=s)}),i}}]),r}(kB);const wft=bft;function Qb(e){return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}var t9;function r9(e){return xft(e)||Cft(e)||_ft(e)||Sft()}function Sft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _ft(e,t){if(e){if(typeof e=="string")return XD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XD(e,t)}}function Cft(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xft(e){if(Array.isArray(e))return XD(e)}function XD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tft(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Oft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rft(n.key),n)}}function Eft(e,t,r){return t&&n9(e.prototype,t),r&&n9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rft(e){var t=kft(e,"string");return Qb(t)==="symbol"?t:String(t)}function kft(e,t){if(Qb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aft=function(){function e(t){Oft(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return Eft(e,[{key:"onBeforeRowMove",value:function(r,n,i,a){var o=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:a});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),f=!0,c=r.map(function(g){if(!f)return!1;var y=o.dataManager.translateTrimmedRow(g);return f=o.shouldAllowMoving(y,u),y}),h=c.indexOf(u)===-1;if(!f||!h)return!1;var d=this.getBaseParent(c),v=this.getTargetParent(l,u),p=d===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,u,p),this.moveRows(c,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(c,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,a,a&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,a=r.dropIndex,o=r.movePossible,s=!1;return pr(a)&&(gr(sr(t9||(t9=Tft([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,a,o,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,r9(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var a=this,o=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(s){a.dataManager.moveRow(s,n,a.movedToCollapsed,o)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,a,o=[],s=Math.max.apply(Math,r9(r))<n;r.forEach(function(l){o.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(a=this.hot).spliceCellsMeta.apply(a,[n-(s?o.length:0),0].concat(o))}},{key:"selectCells",value:function(r,n){var i=r.length,a=0,o=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[i-1]<n?u=this.dataManager.translateTrimmedRow(n-i):u=this.dataManager.translateTrimmedRow(n);var f=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),c=this.dataManager.getRowIndex(f);a=this.dataManager.untranslateTrimmedRow(c),o=a}else r[i-1]<n?(o=n-1,a=o-i+1):(a=n,o=a+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(a,0)),s.setRangeEnd(this.hot._createCellCoords(o,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,a){return i-a!==n})}}]),e}();function ag(e){return ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ag(e)}function Pft(e){return Nft(e)||Dft(e)||Mft(e)||Ift()}function Ift(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mft(e,t){if(e){if(typeof e=="string")return qD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qD(e,t)}}function Dft(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nft(e){if(Array.isArray(e))return qD(e)}function qD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$ft(n.key),n)}}function Fft(e,t,r){return t&&i9(e.prototype,t),r&&i9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ft(e){var t=Hft(e,"string");return ag(t)==="symbol"?t:String(t)}function Hft(e,t){if(ag(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ag(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hc(){return typeof Reflect<"u"&&Reflect.get?hc=Reflect.get.bind():hc=function(t,r,n){var i=Bft(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},hc.apply(this,arguments)}function Bft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Js(e),e!==null););return e}function Vft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZD(e,t)}function ZD(e,t){return ZD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ZD(e,t)}function jft(e){var t=Uft();return function(){var n=Js(e),i;if(t){var a=Js(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Wft(this,i)}}function Wft(e,t){if(t&&(ag(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fae(e)}function fae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Js(e){return Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Js(e)}var vA="nestedRows",zft=300,bs=new WeakMap,Gft="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",Yft=function(e){Vft(r,e);var t=jft(r);function r(n){var i;return Lft(this,r),i=t.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,bs.set(fae(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return Fft(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vA]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new sS),this.dataManager=new Dut(this,this.hot),this.collapsingUI=new fft(this,this.hot),this.headersUI=new lae(this,this.hot),this.contextMenuUI=new wft(this,this.hot),this.rowMoveController=new Aft(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(a){return i.onBeforeLoadData(a)}),this.addHook("beforeUpdateData",function(a){return i.onBeforeLoadData(a)}),hc(Js(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),hc(Js(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),hc(Js(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,a,o,s){return this.rowMoveController.onBeforeRowMove(i,a,o,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=bs.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=bs.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,a,o){this.collapsingUI.toggleState(i,a,o)}},{key:"onModifyRowData",value:function(i){var a=bs.get(this);if(!a.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=bs.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,a,o){var s=bs.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,a,o),!1)}},{key:"onFilterData",value:function(i,a,o){var s=bs.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],a),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*a),this.dataManager.filterData(i,a,o),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,a){this.headersUI.appendLevelIndicators(i,a)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,a,o,s){var l=this;if(s!==this.pluginName){var u=bs.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,a,o){var s=this,l=Array.from(o.reduce(function(u,f){if(s.dataManager.isParent(f)){var c=s.dataManager.getDataObject(f).__children;return u.add(f),Array.isArray(c)&&c.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(f)},new Set));o.length=0,o.push.apply(o,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,a){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(a)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,a,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,Pft(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,a){var o=bs.get(this);o.skipRender&&(a.skipRender=!0)}},{key:"destroy",value:function(){hc(Js(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!hre(i)){o$(Gft),this.hot.getSettings()[vA]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return vA}},{key:"PLUGIN_PRIORITY",get:function(){return zft}}]),r}(er);function ew(e){return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(e)}function Kft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qft(n.key),n)}}function Xft(e,t,r){return t&&a9(e.prototype,t),r&&a9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qft(e){var t=Zft(e,"string");return ew(t)==="symbol"?t:String(t)}function Zft(e,t){if(ew(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ew(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jft=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Kft(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return Xft(e,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,a=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return a===null?void 0:JSON.parse(a)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;ne(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();const Qft=Jft;function og(e){return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(e)}function ect(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rct(n.key),n)}}function tct(e,t,r){return t&&o9(e.prototype,t),r&&o9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rct(e){var t=nct(e,"string");return og(t)==="symbol"?t:String(t)}function nct(e,t){if(og(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(og(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dc(){return typeof Reflect<"u"&&Reflect.get?dc=Reflect.get.bind():dc=function(t,r,n){var i=ict(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},dc.apply(this,arguments)}function ict(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Qs(e),e!==null););return e}function act(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JD(e,t)}function JD(e,t){return JD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JD(e,t)}function oct(e){var t=uct();return function(){var n=Qs(e),i;if(t){var a=Qs(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return sct(this,i)}}function sct(e,t){if(t&&(og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lct(e)}function lct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qs(e){return Qs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qs(e)}Qe.getSingleton().register("persistentStateSave");Qe.getSingleton().register("persistentStateLoad");Qe.getSingleton().register("persistentStateReset");var s9="persistentState",fct=0,cct=function(e){act(r,e);var t=oct(r);function r(n){var i;return ect(this,r),i=t.call(this,n),i.storage=void 0,i}return tct(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[s9]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new Qft(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(a,o){return i.saveValue(a,o)}),this.addHook("persistentStateLoad",function(a,o){return i.loadValue(a,o)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),dc(Qs(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,dc(Qs(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),dc(Qs(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,a){a.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,a){this.storage.saveValue(i,a)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){dc(Qs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return s9}},{key:"PLUGIN_PRIORITY",get:function(){return fct}}]),r}(er);function sg(e){return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sg(e)}function hct(e){return gct(e)||pct(e)||vct(e)||dct()}function dct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vct(e,t){if(e){if(typeof e=="string")return QD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QD(e,t)}}function pct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gct(e){if(Array.isArray(e))return QD(e)}function QD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bct(n.key),n)}}function mct(e,t,r){return t&&l9(e.prototype,t),r&&l9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bct(e){var t=wct(e,"string");return sg(t)==="symbol"?t:String(t)}function wct(e,t){if(sg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vc(){return typeof Reflect<"u"&&Reflect.get?vc=Reflect.get.bind():vc=function(t,r,n){var i=Sct(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},vc.apply(this,arguments)}function Sct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=el(e),e!==null););return e}function _ct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eN(e,t)}function eN(e,t){return eN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eN(e,t)}function Cct(e){var t=Oct();return function(){var n=el(e),i;if(t){var a=el(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return xct(this,i)}}function xct(e,t){if(t&&(sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tct(e)}function Tct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function el(e){return el=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},el(e)}var pA="search",Ect=190,Rct="htSearchResult",kct=function(t,r,n,i,a){t.getCellMeta(r,n).isSearchResult=a},Act=function(t,r,n){return pr(t)||t===null||!t.toLocaleLowerCase||t.length===0||pr(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},Pct=function(e){_ct(r,e);var t=Cct(r);function r(n){var i;return yct(this,r),i=t.call(this,n),i.callback=kct,i.queryMethod=Act,i.searchResultClass=Rct,i}return mct(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[pA]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var a=this.hot.getSettings()[pA];this.updatePluginSettings(a),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),vc(el(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,a=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",a),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",a)}),vc(el(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),vc(el(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),f=[],c=this.hot;return rt(0,l-1,function(h){rt(0,u-1,function(d){var v=a.hot.getDataAtCell(h,d),p=a.hot.getCellMeta(h,d),g=p.search.callback||o,y=p.search.queryMethod||s,m=y(i,v,p);if(m){var b={row:h,col:d,data:v};f.push(b)}g&&g(c,h,d,v,m)})}),f}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){Pt(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,a,o,s,l,u){var f=u.className||[],c=[];if(typeof f=="string")c=f.split(" ");else{var h;(h=c).push.apply(h,hct(f))}this.isEnabled()&&u.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),u.className=c.join(" ")}},{key:"destroy",value:function(){vc(el(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return pA}},{key:"PLUGIN_PRIORITY",get:function(){return Ect}}]),r}(er);function lg(e){return lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lg(e)}function Ict(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dct(n.key),n)}}function Mct(e,t,r){return t&&u9(e.prototype,t),r&&u9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dct(e){var t=Nct(e,"string");return lg(t)==="symbol"?t:String(t)}function Nct(e,t){if(lg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gd(){return typeof Reflect<"u"&&Reflect.get?Gd=Reflect.get.bind():Gd=function(t,r,n){var i=Lct(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},Gd.apply(this,arguments)}function Lct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=Cu(e),e!==null););return e}function Fct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tN(e,t)}function tN(e,t){return tN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tN(e,t)}function $ct(e){var t=Vct();return function(){var n=Cu(e),i;if(t){var a=Cu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Hct(this,i)}}function Hct(e,t){if(t&&(lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bct(e)}function Bct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cu(e)}var jct="touchScroll",Wct=200,Uct=function(e){Fct(r,e);var t=$ct(r);function r(n){var i;return Ict(this,r),i=t.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return Mct(r,[{key:"isEnabled",value:function(){return xF()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),Gd(Cu(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Gd(Cu(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Gd(Cu(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,a=i.topOverlay,o=i.bottomOverlay,s=i.inlineStartOverlay,l=i.topInlineStartCornerOverlay,u=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(a),o.clone&&this.scrollbars.push(o),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,ne(this.clones,function(i){ke(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,ne(this.clones,function(a){St(a,"hide-tween"),ke(a,"show-tween")}),this.hot._registerTimeout(function(){ne(i.clones,function(a){St(a,"show-tween")})},400),ne(this.scrollbars,function(a){a.refresh(),a.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return jct}},{key:"PLUGIN_PRIORITY",get:function(){return Wct}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(er);function ug(e){return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}function zct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yct(n.key),n)}}function Gct(e,t,r){return t&&f9(e.prototype,t),r&&f9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yct(e){var t=Kct(e,"string");return ug(t)==="symbol"?t:String(t)}function Kct(e,t){if(ug(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pc(){return typeof Reflect<"u"&&Reflect.get?pc=Reflect.get.bind():pc=function(t,r,n){var i=Xct(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:n):a.value}},pc.apply(this,arguments)}function Xct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=tl(e),e!==null););return e}function qct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rN(e,t)}function rN(e,t){return rN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rN(e,t)}function Zct(e){var t=eht();return function(){var n=tl(e),i;if(t){var a=tl(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Jct(this,i)}}function Jct(e,t){if(t&&(ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qct(e)}function Qct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tl(e){return tl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tl(e)}var F_="trimRows",tht=330,rht=function(e){qct(r,e);var t=Zct(r);function r(n){var i;return zct(this,r),i=t.call(this,n),i.trimmedRowsMap=null,i}return Gct(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[F_]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new sS),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),pc(tl(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,a=this.hot.getSettings()[F_];Array.isArray(a)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),ne(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),pc(tl(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),pc(tl(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var a=this,o=this.getTrimmedRows(),s=this.isValidConfig(i),l=o;s&&(l=Array.from(new Set(o.concat(i))));var u=this.hot.runHooks("beforeTrimRow",o,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ne(i,function(f){a.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",o,l,s,s&&l.length>o.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.trimRows(a)}},{key:"untrimRows",value:function(i){var a=this.getTrimmedRows(),o=this.isValidConfig(i),s=a,l=this.trimmedRowsMap.getValues().slice(),u=i.length>0;o&&u&&(ne(i,function(c){l[c]=!1}),s=Zr(l,function(c,h,d){return h&&c.push(d),c},[]));var f=this.hot.runHooks("beforeUntrimRow",a,s,o&&u);f!==!1&&(o&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",a,s,o&&u,o&&s.length<a.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];this.untrimRows(a)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var a=this.hot.countSourceRows();return i.every(function(o){return Number.isInteger(o)&&o>=0&&o<a})}},{key:"onMapInit",value:function(){var i=this,a=this.hot.getSettings()[F_];Array.isArray(a)&&this.hot.batchExecution(function(){ne(a,function(o){i.trimmedRowsMap.setValueAtIndex(o,!0)})},!0)}},{key:"destroy",value:function(){pc(tl(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return F_}},{key:"PLUGIN_PRIORITY",get:function(){return tht}}]),r}(er);function fg(e){return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fg(e)}function cae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nht(n.key),n)}}function hae(e,t,r){return t&&c9(e.prototype,t),r&&c9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nht(e){var t=iht(e,"string");return fg(t)==="symbol"?t:String(t)}function iht(e,t){if(fg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nN(e,t)}function nN(e,t){return nN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nN(e,t)}function vae(e){var t=sht();return function(){var n=uT(e),i;if(t){var a=uT(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return aht(this,i)}}function aht(e,t){if(t&&(fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oht(e)}function oht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sht(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uT(e){return uT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uT(e)}function lht(e){return cht(e)||fht(e)||gae(e)||uht()}function uht(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fht(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cht(e){if(Array.isArray(e))return iN(e)}function pae(e,t){return vht(e)||dht(e,t)||gae(e,t)||hht()}function hht(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gae(e,t){if(e){if(typeof e=="string")return iN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iN(e,t)}}function iN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dht(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(f){u=!0,i=f}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function vht(e){if(Array.isArray(e))return e}var yae="undoRedo",pht="undoRedo";function qe(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,n){var i=this,a=r&&r.length;if(a){var o=r.find(function(l){var u=pae(l,4),f=u[2],c=u[3];return f!==c});if(o){var s=function(){var u=r.reduce(function(c,h){return c.push(lht(h)),c},[]);ne(u,function(c){c[1]=e.propToCol(c[1])});var f=a>1?i.getSelected():[[u[0][0],u[0][1]]];return new qe.ChangeAction(u,f)};t.done(s,n)}}}),e.addHook("afterCreateRow",function(r,n,i){t.done(function(){return new qe.CreateRowAction(r,n)},i)}),e.addHook("beforeRemoveRow",function(r,n,i,a){var o=function(){var l=e.toPhysicalRow(r),u=Xn(t.instance.getSourceData(l,0,l+n-1,t.instance.countSourceCols()-1));return new qe.RemoveRowAction(l,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence())};t.done(o,a)}),e.addHook("afterCreateCol",function(r,n,i){t.done(function(){return new qe.CreateColumnAction(r,n)},i)}),e.addHook("beforeRemoveCol",function(r,n,i,a){var o=function(){var l=t.instance.getSourceDataArray(),u=(t.instance.countCols()+r)%t.instance.countCols(),f=[],c=[],h=[];rt(l.length-1,function(p){var g=[],y=l[p];rt(u,u+(n-1),function(m){g.push(y[e.toPhysicalColumn(m)])}),f.push(g)}),rt(n-1,function(p){h.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&rt(n-1,function(p){c.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)});var d=e.columnIndexMapper.getIndexesSequence(),v=e.rowIndexMapper.getIndexesSequence();return new qe.RemoveColumnAction(u,h,f,c,d,v,e.getSettings().fixedColumnsStart)};t.done(o,a)}),e.addHook("beforeCellAlignment",function(r,n,i,a){t.done(function(){return new qe.CellAlignmentAction(r,n,i,a)})}),e.addHook("beforeFilter",function(r){t.done(function(){return new qe.FiltersAction(r)})}),e.addHook("beforeRowMove",function(r,n){r!==!1&&t.done(function(){return new qe.RowMoveAction(r,n)})}),e.addHook("beforeMergeCells",function(r,n){n||t.done(function(){return new qe.MergeCellsAction(e,r)})}),e.addHook("afterUnmergeCells",function(r,n){n||t.done(function(){return new qe.UnmergeCellsAction(e,r)})}),e.addHook("afterInit",function(){t.init()})}qe.prototype.done=function(e,t){if(!this.ignoreNewActions){var r=t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,t);if(i!==!1){var a=e(),o=this.undoneActions.slice();this.doneActions.push(a),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())}}}};qe.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var r=Xn(t),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",a),t.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};qe.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var r=Xn(t),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,a=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",a),t.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",a,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};qe.prototype.isUndoAvailable=function(){return this.doneActions.length>0};qe.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};qe.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};qe.prototype.isEnabled=function(){return this.enabled};qe.prototype.enable=function(){if(!this.isEnabled()){var e=this.instance;this.enabled=!0,mht(e),this.registerShortcuts(),e.addHook("afterChange",mae)}};qe.prototype.disable=function(){if(this.isEnabled()){var e=this.instance;this.enabled=!1,bht(e),this.unregisterShortcuts(),e.removeHook("afterChange",mae)}};qe.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};qe.Action=function(){};qe.Action.prototype.undo=function(){};qe.Action.prototype.redo=function(){};qe.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"};wl(qe.ChangeAction,qe.Action);qe.ChangeAction.prototype.undo=function(e,t){for(var r=Xn(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0),a=0,o=r.length;a<o;a++)r[a].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=pae(r[s],2),f=u[0],c=u[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&c+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(c+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)};qe.ChangeAction.prototype.redo=function(e,t){for(var r=Xn(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)};qe.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"};wl(qe.CreateRowAction,qe.Action);qe.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};qe.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};qe.RemoveRowAction=function(e,t,r,n,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};wl(qe.RemoveRowAction,qe.Action);qe.RemoveRowAction.prototype.undo=function(e,t){var r=this,n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(a,o){Object.keys(a).forEach(function(s){var l=parseInt(s,10);i.push([r.index+o,isNaN(l)?s:l,a[s]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};qe.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};qe.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"};wl(qe.CreateColumnAction,qe.Action);qe.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};qe.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};qe.RemoveColumnAction=function(e,t,r,n,i,a,o){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=a.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o};wl(qe.RemoveColumnAction,qe.Action);qe.RemoveColumnAction.prototype.undo=function(e,t){var r=this,n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),a=function(h,d,v){return v[r.indexes.indexOf(i[d])]},o=this.data.length,s=[],l=0;l<o;l++)s.push(At(this.data[l],a));var u=At(this.headers,a),f=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),ne(e.getSourceDataArray(),function(c,h){ne(i,function(d,v){c[d]=s[h][v],f.push([h,d,c[d]])})}),e.setSourceDataAtCell(f,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&ne(u,function(c,h){e.getSettings().colHeaders[i[h]]=c}),e.batchExecution(function(){e.rowIndexMapper.setIndexesSequence(r.rowPositions),e.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()};qe.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};qe.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n};qe.CellAlignmentAction.prototype.undo=function(e,t){var r=this;ne(this.range,function(n){n.forAll(function(i,a){i>=0&&a>=0&&e.setCellMeta(i,a,"className",r.stateBefore[i][a]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()};qe.CellAlignmentAction.prototype.redo=function(e,t){Gl(this.range,this.type,this.alignment,function(r,n){return e.getCellMeta(r,n)},function(r,n,i,a){return e.setCellMeta(r,n,i,a)}),e.addHookOnce("afterViewRender",t),e.render()};qe.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"};wl(qe.FiltersAction,qe.Action);qe.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};qe.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var ght=function(e){dae(r,e);var t=vae(r);function r(n,i){var a;cae(this,r),a=t.call(this),a.cellRange=i;var o=a.cellRange.getTopStartCorner(),s=a.cellRange.getBottomEndCorner();return a.rangeData=n.getData(o.row,o.col,s.row,s.col),a}return hae(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange)}}]),r}(qe.Action);qe.MergeCellsAction=ght;var yht=function(e){dae(r,e);var t=vae(r);function r(n,i){var a;return cae(this,r),a=t.call(this),a.cellRange=i,a}return hae(r,[{key:"undo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,a){var o=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",a),o.unmergeRange(this.cellRange,!0),i.render()}}]),r}(qe.Action);qe.UnmergeCellsAction=yht;qe.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"};wl(qe.RowMoveAction,qe.Action);qe.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),i=[].concat(this.rows),a=i.filter(function(f){return f>r.finalIndex}),o=i.filter(function(f){return f<=r.finalIndex}),s=a.sort(function(f,c){return c-f}).concat(o.sort(function(f,c){return f-c}));e.addHookOnce("afterViewRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};qe.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};qe.prototype.init=function(){var e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};qe.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager(),r=t.getContext("grid"),n=function(o){return!o.altKey},i={runOnlyIf:n,group:yae};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],i)};qe.prototype.unregisterShortcuts=function(){var e=this.instance.getShortcutManager(),t=e.getContext("grid");t.removeShortcutsByGroup(yae)};function mae(e,t){var r=this;if(t==="loadData")return r.undoRedo.clear()}function mht(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function bht(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var gS=Qe.getSingleton();gS.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()});gS.register("beforeUndo");gS.register("afterUndo");gS.register("beforeRedo");gS.register("afterRedo");qe.PLUGIN_KEY=pht;qe.SETTING_KEYS=!0;function wht(){Gt(kze),Gt(eGe),Gt(mGe),Gt(c7e),Gt(A7e),Gt(Pne),Gt(rYe),Gt(NYe),Gt(zne),Gt(LXe),Gt(uqe),Gt(wqe),Gt(nie),Gt(xZe),Gt(_rt),Gt(tnt),Gt(Ont),Gt(Znt),Gt(wit),Gt(lat),Gt(bat),Gt(sot),Gt(mot),Gt(gst),Gt(Fst),Gt(qst),Gt(xut),Gt(Yft),Gt(cct),Gt(Pct),Gt(Uct),Gt(rht),Gt(qe)}function bae(){jUe(),n6e(),b6e(),L6e(),wht()}var Sht=pt,_ht=Tt,Cht=aO.f,xht=_ht(function(){return!Object.getOwnPropertyNames(1)});Sht({target:"Object",stat:!0,forced:xht},{getOwnPropertyNames:Cht});function Tht(e){var t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){var n=this.first(),i=n.data("handsontable");if(typeof r!="string"){var a=r||{};return i?i.updateSettings(a):(i=new e.Core(n[0],a),n.data("handsontable",i),i.init()),n}var o;if(i)if(typeof i[r]<"u"){for(var s,l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];o=(s=i[r]).call.apply(s,[i].concat(u)),r==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(r));return o})}var gA,yA,mA,bA,wA;bae();Tht(ht);ht.__GhostTable=gB;ht._getListenersCounter=EPe;ht._getRegisteredMapsCounter=m3e;ht.EventManager=Fr;var Oht=[hTe,bTe,FHe,d6e,Exe,DAe,yAe,MIe,pTe,bAe,iPe,EIe],Eht=[AAe,aPe];ht.helper={};ht.dom={};ne(Oht,function(e){ne(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(ht.helper[t]=e[t])})});ne(Eht,function(e){ne(Object.getOwnPropertyNames(e),function(t){t.charAt(0)!=="_"&&(ht.dom[t]=e[t])})});ht.cellTypes=(gA=ht.cellTypes)!==null&&gA!==void 0?gA:{};ne(zje(),function(e){ht.cellTypes[e]=tB(e)});ht.cellTypes.registerCellType=Za;ht.cellTypes.getCellType=tB;ht.editors=(yA=ht.editors)!==null&&yA!==void 0?yA:{};ne(bPe(),function(e){ht.editors["".concat(Ni(e),"Editor")]=lx(e)});ht.editors.registerEditor=ki;ht.editors.getEditor=lx;ht.renderers=(mA=ht.renderers)!==null&&mA!==void 0?mA:{};ne(xMe(),function(e){var t=fx(e);e==="base"&&(ht.renderers.cellDecorator=t),ht.renderers["".concat(Ni(e),"Renderer")]=t});ht.renderers.registerRenderer=Vo;ht.renderers.getRenderer=fx;ht.validators=(bA=ht.validators)!==null&&bA!==void 0?bA:{};ne(EMe(),function(e){ht.validators["".concat(Ni(e),"Validator")]=c$(e)});ht.validators.registerValidator=xd;ht.validators.getValidator=c$;ht.plugins=(wA=ht.plugins)!==null&&wA!==void 0?wA:{};ne(f$(),function(e){ht.plugins[e]=rS(e)});ht.plugins["".concat(Ni(er.PLUGIN_KEY),"Plugin")]=er;ht.plugins.registerPlugin=Gt;ht.plugins.getPlugin=rS;function tw(e){return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}var Ue;function Ge(e,t,r){return t=Rht(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rht(e){var t=kht(e,"string");return tw(t)==="symbol"?t:String(t)}function kht(e,t){if(tw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(tw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ye=ht.languages.dictionaryKeys,Aht=(Ue={languageCode:"zh-CN"},Ge(Ue,Ye.CONTEXTMENU_ITEMS_ROW_ABOVE,"ä¸æ¹æå¥è¡"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ROW_BELOW,"ä¸æ¹æå¥è¡"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_INSERT_LEFT,"å·¦æ¹æå¥å"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_INSERT_RIGHT,"å³æ¹æå¥å"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_REMOVE_ROW,["ç§»é¤è¯¥è¡","ç§»é¤å¤è¡"]),Ge(Ue,Ye.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["ç§»é¤è¯¥å","ç§»é¤å¤å"]),Ge(Ue,Ye.CONTEXTMENU_ITEMS_UNDO,"æ¤é"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_REDO,"æ¢å¤"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_READ_ONLY,"åªè¯»"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"æ¸ç©ºè¯¥å"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT,"å¯¹é½"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"å·¦å¯¹é½"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"æ°´å¹³å±ä¸­"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"å³å¯¹é½"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"ä¸¤ç«¯å¯¹é½"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"é¡¶ç«¯å¯¹é½"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"åç´å±ä¸­"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"åºç«¯å¯¹é½"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"å»ç»è¯¥å"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"åæ¶å»ç»"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_BORDERS,"è¾¹æ¡"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_BORDERS_TOP,"ä¸"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"å³"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"ä¸"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_BORDERS_LEFT,"å·¦"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"ç§»é¤è¾¹æ¡"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_ADD_COMMENT,"æå¥æ¹æ³¨"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_EDIT_COMMENT,"ç¼è¾æ¹æ³¨"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"å é¤æ¹æ³¨"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"åªè¯»æ¹æ³¨"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_MERGE_CELLS,"åå¹¶"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"åæ¶åå¹¶"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_COPY,"å¤å¶"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,"å¸¦æ é¢çå¤å¶"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,"å¸¦æ é¢ç»çå¤å¶"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,"ä»å¤å¶æ é¢"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_CUT,"åªå"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"æå¥å­è¡"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"ä¸æ¯è¡åç¦»"),Ge(Ue,Ye.CONTEXTMENU_ITEMS_HIDE_COLUMN,["éèè¯¥å","éèå¤å"]),Ge(Ue,Ye.CONTEXTMENU_ITEMS_SHOW_COLUMN,["æ¾ç¤ºè¯¥å","æ¾ç¤ºå¤å"]),Ge(Ue,Ye.CONTEXTMENU_ITEMS_HIDE_ROW,["éèè¯¥è¡","éèå¤è¡"]),Ge(Ue,Ye.CONTEXTMENU_ITEMS_SHOW_ROW,["æ¾ç¤ºè¯¥è¡","æ¾ç¤ºå¤è¡"]),Ge(Ue,Ye.FILTERS_CONDITIONS_NONE,"æ "),Ge(Ue,Ye.FILTERS_CONDITIONS_EMPTY,"ä¸ºç©º"),Ge(Ue,Ye.FILTERS_CONDITIONS_NOT_EMPTY,"ä¸ä¸ºç©º"),Ge(Ue,Ye.FILTERS_CONDITIONS_EQUAL,"ç­äº"),Ge(Ue,Ye.FILTERS_CONDITIONS_NOT_EQUAL,"ä¸ç­äº"),Ge(Ue,Ye.FILTERS_CONDITIONS_BEGINS_WITH,"å¼å¤´æ¯"),Ge(Ue,Ye.FILTERS_CONDITIONS_ENDS_WITH,"ç»å°¾æ¯"),Ge(Ue,Ye.FILTERS_CONDITIONS_CONTAINS,"åå«"),Ge(Ue,Ye.FILTERS_CONDITIONS_NOT_CONTAIN,"ä¸åå«"),Ge(Ue,Ye.FILTERS_CONDITIONS_GREATER_THAN,"å¤§äº"),Ge(Ue,Ye.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"å¤§äºæç­äº"),Ge(Ue,Ye.FILTERS_CONDITIONS_LESS_THAN,"å°äº"),Ge(Ue,Ye.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"å°äºæç­äº"),Ge(Ue,Ye.FILTERS_CONDITIONS_BETWEEN,"å¨æ­¤èå´"),Ge(Ue,Ye.FILTERS_CONDITIONS_NOT_BETWEEN,"ä¸å¨æ­¤èå´"),Ge(Ue,Ye.FILTERS_CONDITIONS_AFTER,"ä¹å"),Ge(Ue,Ye.FILTERS_CONDITIONS_BEFORE,"ä¹å"),Ge(Ue,Ye.FILTERS_CONDITIONS_TODAY,"ä»å¤©"),Ge(Ue,Ye.FILTERS_CONDITIONS_TOMORROW,"æå¤©"),Ge(Ue,Ye.FILTERS_CONDITIONS_YESTERDAY,"æ¨å¤©"),Ge(Ue,Ye.FILTERS_VALUES_BLANK_CELLS,"ç©ºç½ååæ ¼"),Ge(Ue,Ye.FILTERS_DIVS_FILTER_BY_CONDITION,"ææ¡ä»¶è¿æ»¤"),Ge(Ue,Ye.FILTERS_DIVS_FILTER_BY_VALUE,"æå¼è¿æ»¤"),Ge(Ue,Ye.FILTERS_LABELS_CONJUNCTION,"ä¸"),Ge(Ue,Ye.FILTERS_LABELS_DISJUNCTION,"æ"),Ge(Ue,Ye.FILTERS_BUTTONS_SELECT_ALL,"å¨é"),Ge(Ue,Ye.FILTERS_BUTTONS_CLEAR,"æ¸é¤"),Ge(Ue,Ye.FILTERS_BUTTONS_OK,"ç¡®è®¤"),Ge(Ue,Ye.FILTERS_BUTTONS_CANCEL,"åæ¶"),Ge(Ue,Ye.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"æç´¢"),Ge(Ue,Ye.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"å¼"),Ge(Ue,Ye.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"ç¬¬äºå¼"),Ue);ht.languages.registerLanguageDictionary(Aht);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var wae=1252,Pht=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],AB={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},PB=function(e){Pht.indexOf(e)!=-1&&(wae=AB[0]=e)};function Iht(){PB(1252)}var lo=function(e){PB(e)};function Sae(){lo(1200),Iht()}function h9(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Mht(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function _ae(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ky=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Mht(e.slice(2)):t==254&&r==255?_ae(e.slice(2)):t==65279?e.slice(1):e},$_=function(t){return String.fromCharCode(t)},d9=function(t){return String.fromCharCode(t)},Zl,ru="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function v9(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),s=(n&15)<<2|i>>6,l=i&63,isNaN(n)?s=l=64:isNaN(i)&&(l=64),t+=ru.charAt(a)+ru.charAt(o)+ru.charAt(s)+ru.charAt(l);return t}function ia(e){var t="",r=0,n=0,i=0,a=0,o=0,s=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=ru.indexOf(e.charAt(u++)),o=ru.indexOf(e.charAt(u++)),r=a<<2|o>>4,t+=String.fromCharCode(r),s=ru.indexOf(e.charAt(u++)),n=(o&15)<<4|s>>2,s!==64&&(t+=String.fromCharCode(n)),l=ru.indexOf(e.charAt(u++)),i=(s&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var zt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),hh=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Du(e){return zt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function p9(e){return zt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ao=function(t){return zt?hh(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function dh(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function IB(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return IB(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Jl=zt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:hh(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Dht(e){for(var t=[],r=0,n=e.length+250,i=Du(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var s=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|s>>6&15|(o&3)<<4,i[r++]=128|s&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Du(65535),n=65530)}return t.push(i.slice(0,r)),Jl(t)}var yi=/\u0000/g,Xy=/[\u0001-\u0006]/g;function Yd(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function uo(e,t){var r=""+e;return r.length>=t?r:Yr("0",t-r.length)+r}function MB(e,t){var r=""+e;return r.length>=t?r:Yr(" ",t-r.length)+r}function fT(e,t){var r=""+e;return r.length>=t?r:r+Yr(" ",t-r.length)}function Nht(e,t){var r=""+Math.round(e);return r.length>=t?r:Yr("0",t-r.length)+r}function Lht(e,t){var r=""+e;return r.length>=t?r:Yr("0",t-r.length)+r}var g9=Math.pow(2,32);function Qh(e,t){if(e>g9||e<-g9)return Nht(e,t);var r=Math.round(e);return Lht(r,t)}function cT(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var y9=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],SA=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Fht(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "',e}var kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "'},m9={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$ht={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function hT(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,o=1,s=0,l=1,u=0,f=0,c=Math.floor(i);u<t&&(c=Math.floor(i),s=c*o+a,f=c*u+l,!(i-c<5e-8));)i=1/(i-c),a=o,o=s,l=u,u=f;if(f>t&&(u>t?(f=l,s=a):(f=u,s=o)),!r)return[0,n*s,f];var h=Math.floor(n*s/f);return[h,n*s-h*f,f]}function gc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],s={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,++i==86400&&(s.T=i=0,++n,++s.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=Uht(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=a,s}var Cae=new Date(1899,11,31,0,0,0),Hht=Cae.getTime(),Bht=new Date(1900,2,1,0,0,0);function xae(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Bht&&(r+=24*60*60*1e3),(r-(Hht+(e.getTimezoneOffset()-Cae.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function DB(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Vht(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jht(e){var t=e<0?12:11,r=DB(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Wht(e){var t=DB(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function rw(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jht(e):t===10?r=e.toFixed(10).substr(0,12):r=Wht(e),DB(Vht(r.toUpperCase()))}function Wc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):rw(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ia(14,xae(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Uht(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function zht(e,t,r,n){var i="",a=0,o=0,s=r.y,l,u=0;switch(e){case 98:s=r.y+543;case 121:switch(t.length){case 1:case 2:l=s%100,u=2;break;default:l=s%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return SA[r.m-1][1];case 5:return SA[r.m-1][0];default:return SA[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return y9[r.q][0];default:return y9[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?uo(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=uo(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=s,u=1;break}var f=u>0?uo(l,u):"";return f}function nu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Tae=/%/g;function Ght(e,t,r){var n=t.replace(Tae,""),i=t.length-n.length;return ol(e,n,r*Math.pow(10,2*i))+Yr("%",i)}function Yht(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ol(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Oae(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Oae(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Eae=/# (\?+)( ?)\/( ?)(\d+)/;function Kht(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),o=i-a*n,s=n;return r+(a===0?"":""+a)+" "+(o===0?Yr(" ",e[1].length+1+e[4].length):MB(o,e[1].length)+e[2]+"/"+e[3]+uo(s,e[4].length))}function Xht(e,t,r){return r+(t===0?"":""+t)+Yr(" ",e[1].length+2+e[4].length)}var Rae=/^#*0*\.([0#]+)/,kae=/\).*[0#]/,Aae=/\(###\) ###\\?-####/;function fi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function b9(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function w9(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qht(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Zht(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function va(e,t,r){if(e.charCodeAt(0)===40&&!t.match(kae)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?va("n",n,r):"("+va("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Yht(e,t,r);if(t.indexOf("%")!==-1)return Ght(e,t,r);if(t.indexOf("E")!==-1)return Oae(t,r);if(t.charCodeAt(0)===36)return"$"+va(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Qh(l,t.length);if(t.match(/^[#?]+$/))return i=Qh(r,0),i==="0"&&(i=""),i.length>t.length?i:fi(t.substr(0,t.length-i.length))+i;if(a=t.match(Eae))return Kht(a,l,u);if(t.match(/^#+0+$/))return u+Qh(l,t.length-t.indexOf("0"));if(a=t.match(Rae))return i=b9(r,a[1].length).replace(/^([^\.]+)$/,"$1."+fi(a[1])).replace(/\.$/,"."+fi(a[1])).replace(/\.(\d*)$/,function(v,p){return"."+p+Yr("0",fi(a[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+b9(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+nu(Qh(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+va(e,t,-r):nu(""+(Math.floor(r)+qht(r,a[1].length)))+"."+uo(w9(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return va(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Yd(va(e,t.replace(/[\\-]/g,""),r)),o=0,Yd(Yd(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(Aae))return i=va(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=hT(l,Math.pow(10,o)-1,!1),i=""+u,f=ol("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=fT(s[2],o),f.length<a[4].length&&(f=fi(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=hT(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?MB(s[1],o)+a[2]+"/"+a[3]+fT(s[2],o):Yr(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Qh(r,0),t.length<=i.length?i:fi(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return fi(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=w9(r,a[1].length),r<0?"-"+va(e,t,-r):nu(Zht(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?uo(0,3-v.length):"")+v})+"."+uo(o,a[1].length);switch(t){case"###,##0.00":return va(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=nu(Qh(l,0));return d!=="0"?u+d:"";case"###,###.00":return va(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return va(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Jht(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ol(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Qht(e,t,r){var n=t.replace(Tae,""),i=t.length-n.length;return ol(e,n,r*Math.pow(10,2*i))+Yr("%",i)}function Pae(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Pae(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Bo(e,t,r){if(e.charCodeAt(0)===40&&!t.match(kae)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bo("n",n,r):"("+Bo("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Jht(e,t,r);if(t.indexOf("%")!==-1)return Qht(e,t,r);if(t.indexOf("E")!==-1)return Pae(t,r);if(t.charCodeAt(0)===36)return"$"+Bo(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,s,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+uo(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:fi(t.substr(0,t.length-i.length))+i;if(a=t.match(Eae))return Xht(a,l,u);if(t.match(/^#+0+$/))return u+uo(l,t.length-t.indexOf("0"));if(a=t.match(Rae))return i=(""+r).replace(/^([^\.]+)$/,"$1."+fi(a[1])).replace(/\.$/,"."+fi(a[1])),i=i.replace(/\.(\d*)$/,function(v,p){return"."+p+Yr("0",fi(a[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+nu(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bo(e,t,-r):nu(""+r)+"."+Yr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Bo(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Yd(Bo(e,t.replace(/[\\-]/g,""),r)),o=0,Yd(Yd(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(t.match(Aae))return i=Bo(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),s=hT(l,Math.pow(10,o)-1,!1),i=""+u,f=ol("n",a[1],s[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=fT(s[2],o),f.length<a[4].length&&(f=fi(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),s=hT(l,Math.pow(10,o)-1,!0),u+(s[0]||(s[1]?"":"0"))+" "+(s[1]?MB(s[1],o)+a[2]+"/"+a[3]+fT(s[2],o):Yr(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:fi(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var c=t.indexOf(".")-o,h=t.length-i.length-c;return fi(t.substr(0,c)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Bo(e,t,-r):nu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?uo(0,3-v.length):"")+v})+"."+uo(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=nu(""+l);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return Bo(e,t.slice(0,t.lastIndexOf(".")),r)+fi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ol(e,t,r){return(r|0)===r?Bo(e,t,r):va(e,t,r)}function edt(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Iae=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mg(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":cT(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸å/ä¸å")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Iae))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function tdt(e,t,r,n){for(var i=[],a="",o=0,s="",l="t",u,f,c,h="H";o<e.length;)switch(s=e.charAt(o)){case"G":if(!cT(e,o))throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(c=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(c);i[i.length]={t:"t",v:a},++o;break;case"\\":var d=e.charAt(++o),v=d==="("||d===")"?d:"t";i[i.length]={t:v,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=gc(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=s,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=gc(t,r),u==null))return"";for(a=s;++o<e.length&&e.charAt(o).toLowerCase()===s;)a+=s;s==="m"&&l.toLowerCase()==="h"&&(s="M"),s==="h"&&(s=h),i[i.length]={t:s,v:a},l=s;break;case"A":case"a":case"ä¸":var p={t:s,v:s};if(u==null&&(u=gc(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="ä¸å/ä¸å"?(u!=null&&(p.v=u.H>=12?"ä¸å":"ä¸å"),p.t="T",o+=5,h="h"):(p.t="t",++o),u==null&&p.t==="T")return"";i[i.length]=p,l=s;break;case"[":for(a=s;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Iae)){if(u==null&&(u=gc(t,r),u==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mg(e)||(i[i.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=s;++o<e.length&&(s=e.charAt(o))==="0";)a+=s;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=s;++o<e.length&&"0#?.,E+-%".indexOf(s=e.charAt(o))>-1;)a+=s;i[i.length]={t:"n",v:a};break;case"?":for(a=s;e.charAt(++o)===s;)a+=s;i[i.length]={t:s,v:a},l=s;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":s,v:s},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=s;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:s,v:s},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=â¬acfijklopqrtuvwxzP".indexOf(s)===-1)throw new Error("unrecognized character "+s+" in "+e);i[i.length]={t:"t",v:s},++o;break}var g=0,y=0,m;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,l="h",g<1&&(g=1);break;case"s":(m=i[o].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[o].v.match(/[Hh]/)&&(g=1),g<2&&i[o].v.match(/[Mm]/)&&(g=2),g<3&&i[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",S;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=zht(i[o].t.charCodeAt(0),i[o].v,u,y),i[o].t="t";break;case"n":case"?":for(S=o+1;i[S]!=null&&((s=i[S].t)==="?"||s==="D"||(s===" "||s==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[o].t==="("&&(s===" "||s==="n"||s===")")||s==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[o].v+=i[S].v,i[S]={v:"",t:";"},++S;b+=i[o].v,o=S-1;break;case"G":i[o].t="t",i[o].v=Wc(t,r);break}var x="",T,E;if(b.length>0){b.charCodeAt(0)==40?(T=t<0&&b.charCodeAt(0)===45?-t:t,E=ol("n",b,T)):(T=t<0&&n>1?-t:t,E=ol("n",b,T),T<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),S=E.length-1;var P=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){P=o;break}var R=i.length;if(P===i.length&&E.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(S>=i[o].v.length-1?(S-=i[o].v.length,i[o].v=E.substr(S+1,i[o].v.length)):S<0?i[o].v="":(i[o].v=E.substr(0,S+1),S=-1),i[o].t="t",R=o);S>=0&&R<i.length&&(i[R].v=E.substr(0,S+1)+i[R].v)}else if(P!==i.length&&E.indexOf("E")===-1){for(S=E.indexOf(".")-1,o=P;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(f=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")-1:i[o].v.length-1,x=i[o].v.substr(f+1);f>=0;--f)S>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#")&&(x=E.charAt(S--)+x);i[o].v=x,i[o].t="t",R=o}for(S>=0&&R<i.length&&(i[R].v=E.substr(0,S+1)+i[R].v),S=E.indexOf(".")+1,o=P;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==P)){for(f=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")+1:0,x=i[o].v.substr(0,f);f<i[o].v.length;++f)S<E.length&&(x+=E.charAt(S++));i[o].v=x,i[o].t="t",R=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(T=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=ol(i[o].t,i[o].v,T),i[o].t="t");var M="";for(o=0;o!==i.length;++o)i[o]!=null&&(M+=i[o].v);return M}var S9=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function _9(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function rdt(e,t){var r=edt(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(S9),s=r[1].match(S9);return _9(t,o)?[n,r[0]]:_9(t,s)?[n,r[1]]:[n,r[o!=null&&s!=null?2:1]]}return[n,a]}function Ia(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:kt)[e],n==null&&(n=r.table&&r.table[m9[e]]||kt[m9[e]]),n==null&&(n=$ht[e]||"General");break}if(cT(n,0))return Wc(t,r);t instanceof Date&&(t=xae(t,r.date1904));var i=rdt(n,t);if(cT(i[1]))return Wc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return tdt(i[1],t,r,i[0])}function Cc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(kt[r]==null){t<0&&(t=r);continue}if(kt[r]==e){t=r;break}}t<0&&(t=391)}return kt[t]=e,t}function Mae(){kt=Fht()}var ndt={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Dae=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function idt(e){var t=typeof e=="number"?kt[e]:e;return t=t.replace(Dae,"(\\d+)"),new RegExp("^"+t+"$")}function adt(e,t,r){var n=-1,i=-1,a=-1,o=-1,s=-1,l=-1;(t.match(Dae)||[]).forEach(function(c,h){var d=parseInt(r[h+1],10);switch(c.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?s=d:i=d;break}}),l>=0&&s==-1&&i>=0&&(s=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&s==-1&&l==-1?u:n==-1&&i==-1&&a==-1?f:u+"T"+f}var odt=function(){var e={};e.version="1.2.0";function t(){for(var E=0,P=new Array(256),R=0;R!=256;++R)E=R,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,P[R]=E;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(E){var P=0,R=0,M=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)D[M]=E[M];for(M=0;M!=256;++M)for(R=E[M],P=256+M;P<4096;P+=256)R=D[P]=R>>>8^E[R&255];var N=[];for(M=1;M!=16;++M)N[M-1]=typeof Int32Array<"u"?D.subarray(M*256,M*256+256):D.slice(M*256,M*256+256);return N}var i=n(r),a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],f=i[5],c=i[6],h=i[7],d=i[8],v=i[9],p=i[10],g=i[11],y=i[12],m=i[13],b=i[14];function S(E,P){for(var R=P^-1,M=0,D=E.length;M<D;)R=R>>>8^r[(R^E.charCodeAt(M++))&255];return~R}function x(E,P){for(var R=P^-1,M=E.length-15,D=0;D<M;)R=b[E[D++]^R&255]^m[E[D++]^R>>8&255]^y[E[D++]^R>>16&255]^g[E[D++]^R>>>24]^p[E[D++]]^v[E[D++]]^d[E[D++]]^h[E[D++]]^c[E[D++]]^f[E[D++]]^u[E[D++]]^l[E[D++]]^s[E[D++]]^o[E[D++]]^a[E[D++]]^r[E[D++]];for(M+=15;D<M;)R=R>>>8^r[(R^E[D++])&255];return~R}function T(E,P){for(var R=P^-1,M=0,D=E.length,N=0,B=0;M<D;)N=E.charCodeAt(M++),N<128?R=R>>>8^r[(R^N)&255]:N<2048?(R=R>>>8^r[(R^(192|N>>6&31))&255],R=R>>>8^r[(R^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,B=E.charCodeAt(M++)&1023,R=R>>>8^r[(R^(240|N>>8&7))&255],R=R>>>8^r[(R^(128|N>>2&63))&255],R=R>>>8^r[(R^(128|B>>6&15|(N&3)<<4))&255],R=R>>>8^r[(R^(128|B&63))&255]):(R=R>>>8^r[(R^(224|N>>12&15))&255],R=R>>>8^r[(R^(128|N>>6&63))&255],R=R>>>8^r[(R^(128|N&63))&255]);return~R}return e.table=r,e.bstr=S,e.buf=x,e.str=T,e}(),Yt=function(){var t={};t.version="1.2.1";function r(F,X){for(var z=F.split("/"),G=X.split("/"),q=0,J=0,Se=Math.min(z.length,G.length);q<Se;++q){if(J=z[q].length-G[q].length)return J;if(z[q]!=G[q])return z[q]<G[q]?-1:1}return z.length-G.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var X=F.lastIndexOf("/");return X===-1?F:F.slice(0,X+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var X=F.lastIndexOf("/");return X===-1?F:F.slice(X+1)}function a(F,X){typeof X=="string"&&(X=new Date(X));var z=X.getHours();z=z<<6|X.getMinutes(),z=z<<5|X.getSeconds()>>>1,F.write_shift(2,z);var G=X.getFullYear()-1980;G=G<<4|X.getMonth()+1,G=G<<5|X.getDate(),F.write_shift(2,G)}function o(F){var X=F.read_shift(2)&65535,z=F.read_shift(2)&65535,G=new Date,q=z&31;z>>>=5;var J=z&15;z>>>=4,G.setMilliseconds(0),G.setFullYear(z+1980),G.setMonth(J-1),G.setDate(q);var Se=X&31;X>>>=5;var xe=X&63;return X>>>=6,G.setHours(X),G.setMinutes(xe),G.setSeconds(Se<<1),G}function s(F){In(F,0);for(var X={},z=0;F.l<=F.length-4;){var G=F.read_shift(2),q=F.read_shift(2),J=F.l+q,Se={};switch(G){case 21589:z=F.read_shift(1),z&1&&(Se.mtime=F.read_shift(4)),q>5&&(z&2&&(Se.atime=F.read_shift(4)),z&4&&(Se.ctime=F.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}F.l=J,X[G]=Se}return X}var l;function u(){return l||(l={})}function f(F,X){if(F[0]==80&&F[1]==75)return Ft(F,X);if((F[0]|32)==109&&(F[1]|32)==105)return We(F,X);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var z=3,G=512,q=0,J=0,Se=0,xe=0,we=0,he=[],W=F.slice(0,512);In(W,0);var ye=c(W);switch(z=ye[0],z){case 3:G=512;break;case 4:G=4096;break;case 0:if(ye[1]==0)return Ft(F,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}G!==512&&(W=F.slice(0,G),In(W,28));var _e=F.slice(0,G);h(W,z);var Pe=W.read_shift(4,"i");if(z===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);W.l+=4,Se=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),xe=W.read_shift(4,"i"),q=W.read_shift(4,"i"),we=W.read_shift(4,"i"),J=W.read_shift(4,"i");for(var Re=-1,Fe=0;Fe<109&&(Re=W.read_shift(4,"i"),!(Re<0));++Fe)he[Fe]=Re;var nt=d(F,G);g(we,J,nt,G,he);var vr=m(nt,Se,he,G);vr[Se].name="!Directory",q>0&&xe!==B&&(vr[xe].name="!MiniFAT"),vr[he[0]].name="!FAT",vr.fat_addrs=he,vr.ssz=G;var Rt={},fn=[],El=[],_h=[];b(Se,vr,nt,fn,q,Rt,El,xe),v(El,_h,fn),fn.shift();var Vg={FileIndex:El,FullPaths:_h};return X&&X.raw&&(Vg.raw={header:_e,sectors:nt}),Vg}function c(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(K,"Header Signature: "),F.l+=16;var X=F.read_shift(2,"u");return[F.read_shift(2,"u"),X]}function h(F,X){var z=9;switch(F.l+=2,z=F.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function d(F,X){for(var z=Math.ceil(F.length/X)-1,G=[],q=1;q<z;++q)G[q-1]=F.slice(q*X,(q+1)*X);return G[z-1]=F.slice(z*X),G}function v(F,X,z){for(var G=0,q=0,J=0,Se=0,xe=0,we=z.length,he=[],W=[];G<we;++G)he[G]=W[G]=G,X[G]=z[G];for(;xe<W.length;++xe)G=W[xe],q=F[G].L,J=F[G].R,Se=F[G].C,he[G]===G&&(q!==-1&&he[q]!==q&&(he[G]=he[q]),J!==-1&&he[J]!==J&&(he[G]=he[J])),Se!==-1&&(he[Se]=G),q!==-1&&G!=he[G]&&(he[q]=he[G],W.lastIndexOf(q)<xe&&W.push(q)),J!==-1&&G!=he[G]&&(he[J]=he[G],W.lastIndexOf(J)<xe&&W.push(J));for(G=1;G<we;++G)he[G]===G&&(J!==-1&&he[J]!==J?he[G]=he[J]:q!==-1&&he[q]!==q&&(he[G]=he[q]));for(G=1;G<we;++G)if(F[G].type!==0){if(xe=G,xe!=he[xe])do xe=he[xe],X[G]=X[xe]+"/"+X[G];while(xe!==0&&he[xe]!==-1&&xe!=he[xe]);he[G]=-1}for(X[0]+="/",G=1;G<we;++G)F[G].type!==2&&(X[G]+="/")}function p(F,X,z){for(var G=F.start,q=F.size,J=[],Se=G;z&&q>0&&Se>=0;)J.push(X.slice(Se*N,Se*N+N)),q-=N,Se=Bf(z,Se*4);return J.length===0?yn(0):Jl(J).slice(0,F.size)}function g(F,X,z,G,q){var J=B;if(F===B){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var Se=z[F],xe=(G>>>2)-1;if(!Se)return;for(var we=0;we<xe&&(J=Bf(Se,we*4))!==B;++we)q.push(J);g(Bf(Se,G-4),X-1,z,G,q)}}function y(F,X,z,G,q){var J=[],Se=[];q||(q=[]);var xe=G-1,we=0,he=0;for(we=X;we>=0;){q[we]=!0,J[J.length]=we,Se.push(F[we]);var W=z[Math.floor(we*4/G)];if(he=we*4&xe,G<4+he)throw new Error("FAT boundary crossed: "+we+" 4 "+G);if(!F[W])break;we=Bf(F[W],he)}return{nodes:J,data:I9([Se])}}function m(F,X,z,G){var q=F.length,J=[],Se=[],xe=[],we=[],he=G-1,W=0,ye=0,_e=0,Pe=0;for(W=0;W<q;++W)if(xe=[],_e=W+X,_e>=q&&(_e-=q),!Se[_e]){we=[];var Re=[];for(ye=_e;ye>=0;){Re[ye]=!0,Se[ye]=!0,xe[xe.length]=ye,we.push(F[ye]);var Fe=z[Math.floor(ye*4/G)];if(Pe=ye*4&he,G<4+Pe)throw new Error("FAT boundary crossed: "+ye+" 4 "+G);if(!F[Fe]||(ye=Bf(F[Fe],Pe),Re[ye]))break}J[_e]={nodes:xe,data:I9([we])}}return J}function b(F,X,z,G,q,J,Se,xe){for(var we=0,he=G.length?2:0,W=X[F].data,ye=0,_e=0,Pe;ye<W.length;ye+=128){var Re=W.slice(ye,ye+128);In(Re,64),_e=Re.read_shift(2),Pe=HB(Re,0,_e-he),G.push(Pe);var Fe={name:Pe,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},nt=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);nt!==0&&(Fe.ct=S(Re,Re.l-8));var vr=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);vr!==0&&(Fe.mt=S(Re,Re.l-8)),Fe.start=Re.read_shift(4,"i"),Fe.size=Re.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=B,Fe.name=""),Fe.type===5?(we=Fe.start,q>0&&we!==B&&(X[we].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",X[Fe.start]===void 0&&(X[Fe.start]=y(z,Fe.start,X.fat_addrs,X.ssz)),X[Fe.start].name=Fe.name,Fe.content=X[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:we!==B&&Fe.start!==B&&X[we]&&(Fe.content=p(Fe,X[we].data,(X[xe]||{}).data))),Fe.content&&In(Fe.content,0),J[Pe]=Fe,Se.push(Fe)}}function S(F,X){return new Date((qi(F,X+4)/1e7*Math.pow(2,32)+qi(F,X)/1e7-11644473600)*1e3)}function x(F,X){return u(),f(l.readFileSync(F),X)}function T(F,X){var z=X&&X.type;switch(z||zt&&Buffer.isBuffer(F)&&(z="buffer"),z||"base64"){case"file":return x(F,X);case"base64":return f(ao(ia(F)),X);case"binary":return f(ao(F),X)}return f(F,X)}function E(F,X){var z=X||{},G=z.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=G+"/",F.FileIndex[0]={name:G,type:5}),z.CLSID&&(F.FileIndex[0].clsid=z.CLSID),P(F)}function P(F){var X="Sh33tJ5";if(!Yt.find(F,"/"+X)){var z=yn(4);z[0]=55,z[1]=z[3]=50,z[2]=54,F.FileIndex.push({name:X,type:2,content:z,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+X),R(F)}}function R(F,X){E(F);for(var z=!1,G=!1,q=F.FullPaths.length-1;q>=0;--q){var J=F.FileIndex[q];switch(J.type){case 0:G?z=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(J.R*J.L*J.C)&&(z=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!X)){var Se=new Date(1987,1,19),xe=0,we=Object.create?Object.create(null):{},he=[];for(q=0;q<F.FullPaths.length;++q)we[F.FullPaths[q]]=!0,F.FileIndex[q].type!==0&&he.push([F.FullPaths[q],F.FileIndex[q]]);for(q=0;q<he.length;++q){var W=n(he[q][0]);G=we[W],G||(he.push([W,{name:i(W).replace("/",""),type:1,clsid:ie,ct:Se,mt:Se,content:null}]),we[W]=!0)}for(he.sort(function(Pe,Re){return r(Pe[0],Re[0])}),F.FullPaths=[],F.FileIndex=[],q=0;q<he.length;++q)F.FullPaths[q]=he[q][0],F.FileIndex[q]=he[q][1];for(q=0;q<he.length;++q){var ye=F.FileIndex[q],_e=F.FullPaths[q];if(ye.name=i(_e).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||ie,q===0)ye.C=he.length>1?1:-1,ye.size=0,ye.type=5;else if(_e.slice(-1)=="/"){for(xe=q+1;xe<he.length&&n(F.FullPaths[xe])!=_e;++xe);for(ye.C=xe>=he.length?-1:xe,xe=q+1;xe<he.length&&n(F.FullPaths[xe])!=n(_e);++xe);ye.R=xe>=he.length?-1:xe,ye.type=1}else n(F.FullPaths[q+1]||"")==n(_e)&&(ye.R=q+1),ye.type=2}}}function M(F,X){var z=X||{};if(z.fileType=="mad")return Je(F,z);switch(R(F),z.fileType){case"zip":return wt(F,z)}var G=function(Pe){for(var Re=0,Fe=0,nt=0;nt<Pe.FileIndex.length;++nt){var vr=Pe.FileIndex[nt];if(vr.content){var Rt=vr.content.length;Rt>0&&(Rt<4096?Re+=Rt+63>>6:Fe+=Rt+511>>9)}}for(var fn=Pe.FullPaths.length+3>>2,El=Re+7>>3,_h=Re+127>>7,Vg=El+Fe+fn+_h,Yu=Vg+127>>7,zE=Yu<=109?0:Math.ceil((Yu-109)/127);Vg+Yu+zE+127>>7>Yu;)zE=++Yu<=109?0:Math.ceil((Yu-109)/127);var ds=[1,zE,Yu,_h,fn,Fe,Re,0];return Pe.FileIndex[0].size=Re<<6,ds[7]=(Pe.FileIndex[0].start=ds[0]+ds[1]+ds[2]+ds[3]+ds[4]+ds[5])+(ds[6]+7>>3),ds}(F),q=yn(G[7]<<9),J=0,Se=0;{for(J=0;J<8;++J)q.write_shift(1,Z[J]);for(J=0;J<8;++J)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),J=0;J<3;++J)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,G[2]),q.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),q.write_shift(4,0),q.write_shift(4,1<<12),q.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:B),q.write_shift(4,G[3]),q.write_shift(-4,G[1]?G[0]-1:B),q.write_shift(4,G[1]),J=0;J<109;++J)q.write_shift(-4,J<G[2]?G[1]+J:-1)}if(G[1])for(Se=0;Se<G[1];++Se){for(;J<236+Se*127;++J)q.write_shift(-4,J<G[2]?G[1]+J:-1);q.write_shift(-4,Se===G[1]-1?B:Se+1)}var xe=function(Pe){for(Se+=Pe;J<Se-1;++J)q.write_shift(-4,J+1);Pe&&(++J,q.write_shift(-4,B))};for(Se=J=0,Se+=G[1];J<Se;++J)q.write_shift(-4,me.DIFSECT);for(Se+=G[2];J<Se;++J)q.write_shift(-4,me.FATSECT);xe(G[3]),xe(G[4]);for(var we=0,he=0,W=F.FileIndex[0];we<F.FileIndex.length;++we)W=F.FileIndex[we],W.content&&(he=W.content.length,!(he<4096)&&(W.start=Se,xe(he+511>>9)));for(xe(G[6]+7>>3);q.l&511;)q.write_shift(-4,me.ENDOFCHAIN);for(Se=J=0,we=0;we<F.FileIndex.length;++we)W=F.FileIndex[we],W.content&&(he=W.content.length,!(!he||he>=4096)&&(W.start=Se,xe(he+63>>6)));for(;q.l&511;)q.write_shift(-4,me.ENDOFCHAIN);for(J=0;J<G[4]<<2;++J){var ye=F.FullPaths[J];if(!ye||ye.length===0){for(we=0;we<17;++we)q.write_shift(4,0);for(we=0;we<3;++we)q.write_shift(4,-1);for(we=0;we<12;++we)q.write_shift(4,0);continue}W=F.FileIndex[J],J===0&&(W.start=W.size?W.start-1:B);var _e=J===0&&z.root||W.name;if(he=2*(_e.length+1),q.write_shift(64,_e,"utf16le"),q.write_shift(2,he),q.write_shift(1,W.type),q.write_shift(1,W.color),q.write_shift(-4,W.L),q.write_shift(-4,W.R),q.write_shift(-4,W.C),W.clsid)q.write_shift(16,W.clsid,"hex");else for(we=0;we<4;++we)q.write_shift(4,0);q.write_shift(4,W.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,W.start),q.write_shift(4,W.size),q.write_shift(4,0)}for(J=1;J<F.FileIndex.length;++J)if(W=F.FileIndex[J],W.size>=4096)if(q.l=W.start+1<<9,zt&&Buffer.isBuffer(W.content))W.content.copy(q,q.l,0,W.size),q.l+=W.size+511&-512;else{for(we=0;we<W.size;++we)q.write_shift(1,W.content[we]);for(;we&511;++we)q.write_shift(1,0)}for(J=1;J<F.FileIndex.length;++J)if(W=F.FileIndex[J],W.size>0&&W.size<4096)if(zt&&Buffer.isBuffer(W.content))W.content.copy(q,q.l,0,W.size),q.l+=W.size+63&-64;else{for(we=0;we<W.size;++we)q.write_shift(1,W.content[we]);for(;we&63;++we)q.write_shift(1,0)}if(zt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function D(F,X){var z=F.FullPaths.map(function(we){return we.toUpperCase()}),G=z.map(function(we){var he=we.split("/");return he[he.length-(we.slice(-1)=="/"?2:1)]}),q=!1;X.charCodeAt(0)===47?(q=!0,X=z[0].slice(0,-1)+X):q=X.indexOf("/")!==-1;var J=X.toUpperCase(),Se=q===!0?z.indexOf(J):G.indexOf(J);if(Se!==-1)return F.FileIndex[Se];var xe=!J.match(Xy);for(J=J.replace(yi,""),xe&&(J=J.replace(Xy,"!")),Se=0;Se<z.length;++Se)if((xe?z[Se].replace(Xy,"!"):z[Se]).replace(yi,"")==J||(xe?G[Se].replace(Xy,"!"):G[Se]).replace(yi,"")==J)return F.FileIndex[Se];return null}var N=64,B=-2,K="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function k(F,X,z){u();var G=M(F,z);l.writeFileSync(X,G)}function w(F){for(var X=new Array(F.length),z=0;z<F.length;++z)X[z]=String.fromCharCode(F[z]);return X.join("")}function C(F,X){var z=M(F,X);switch(X&&X.type||"buffer"){case"file":return u(),l.writeFileSync(X.filename,z),z;case"binary":return typeof z=="string"?z:w(z);case"base64":return v9(typeof z=="string"?z:w(z));case"buffer":if(zt)return Buffer.isBuffer(z)?z:hh(z);case"array":return typeof z=="string"?ao(z):z}return z}var O;function _(F){try{var X=F.InflateRaw,z=new X;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)O=F;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function A(F,X){if(!O)return ft(F,X);var z=O.InflateRaw,G=new z,q=G._processChunk(F.slice(F.l),G._finishFlushFlag);return F.l+=G.bytesRead,q}function I(F){return O?O.deflateRawSync(F):de(F)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(F){var X=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(X>>16|X>>8|X)&255}for(var re=typeof Uint8Array<"u",te=re?new Uint8Array(1<<8):[],ge=0;ge<1<<8;++ge)te[ge]=ae(ge);function H(F,X){var z=te[F&255];return X<=8?z>>>8-X:(z=z<<8|te[F>>8&255],X<=16?z>>>16-X:(z=z<<8|te[F>>16&255],z>>>24-X))}function Ce(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=6?0:F[G+1]<<8))>>>z&3}function oe(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=5?0:F[G+1]<<8))>>>z&7}function Oe(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=4?0:F[G+1]<<8))>>>z&15}function Ee(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=3?0:F[G+1]<<8))>>>z&31}function be(F,X){var z=X&7,G=X>>>3;return(F[G]|(z<=1?0:F[G+1]<<8))>>>z&127}function Ie(F,X,z){var G=X&7,q=X>>>3,J=(1<<z)-1,Se=F[q]>>>G;return z<8-G||(Se|=F[q+1]<<8-G,z<16-G)||(Se|=F[q+2]<<16-G,z<24-G)||(Se|=F[q+3]<<24-G),Se&J}function Me(F,X,z){var G=X&7,q=X>>>3;return G<=5?F[q]|=(z&7)<<G:(F[q]|=z<<G&255,F[q+1]=(z&7)>>8-G),X+3}function j(F,X,z){var G=X&7,q=X>>>3;return z=(z&1)<<G,F[q]|=z,X+1}function U(F,X,z){var G=X&7,q=X>>>3;return z<<=G,F[q]|=z&255,z>>>=8,F[q+1]=z,X+8}function Q(F,X,z){var G=X&7,q=X>>>3;return z<<=G,F[q]|=z&255,z>>>=8,F[q+1]=z&255,F[q+2]=z>>>8,X+16}function fe(F,X){var z=F.length,G=2*z>X?2*z:X+5,q=0;if(z>=X)return F;if(zt){var J=p9(G);if(F.copy)F.copy(J);else for(;q<F.length;++q)J[q]=F[q];return J}else if(re){var Se=new Uint8Array(G);if(Se.set)Se.set(F);else for(;q<z;++q)Se[q]=F[q];return Se}return F.length=G,F}function ee(F){for(var X=new Array(F),z=0;z<F;++z)X[z]=0;return X}function pe(F,X,z){var G=1,q=0,J=0,Se=0,xe=0,we=F.length,he=re?new Uint16Array(32):ee(32);for(J=0;J<32;++J)he[J]=0;for(J=we;J<z;++J)F[J]=0;we=F.length;var W=re?new Uint16Array(we):ee(we);for(J=0;J<we;++J)he[q=F[J]]++,G<q&&(G=q),W[J]=0;for(he[0]=0,J=1;J<=G;++J)he[J+16]=xe=xe+he[J-1]<<1;for(J=0;J<we;++J)xe=F[J],xe!=0&&(W[J]=he[xe+16]++);var ye=0;for(J=0;J<we;++J)if(ye=F[J],ye!=0)for(xe=H(W[J],G)>>G-ye,Se=(1<<G+4-ye)-1;Se>=0;--Se)X[xe|Se<<ye]=ye&15|J<<4;return G}var se=re?new Uint16Array(512):ee(512),ue=re?new Uint16Array(32):ee(32);if(!re){for(var ce=0;ce<512;++ce)se[ce]=0;for(ce=0;ce<32;++ce)ue[ce]=0}(function(){for(var F=[],X=0;X<32;X++)F.push(5);pe(F,ue,32);var z=[];for(X=0;X<=143;X++)z.push(8);for(;X<=255;X++)z.push(9);for(;X<=279;X++)z.push(7);for(;X<=287;X++)z.push(8);pe(z,se,288)})();var ve=function(){for(var X=re?new Uint8Array(32768):[],z=0,G=0;z<Y.length-1;++z)for(;G<Y[z+1];++G)X[G]=z;for(;G<32768;++G)X[G]=29;var q=re?new Uint8Array(259):[];for(z=0,G=0;z<V.length-1;++z)for(;G<V[z+1];++G)q[G]=z;function J(xe,we){for(var he=0;he<xe.length;){var W=Math.min(65535,xe.length-he),ye=he+W==xe.length;for(we.write_shift(1,+ye),we.write_shift(2,W),we.write_shift(2,~W&65535);W-- >0;)we[we.l++]=xe[he++]}return we.l}function Se(xe,we){for(var he=0,W=0,ye=re?new Uint16Array(32768):[];W<xe.length;){var _e=Math.min(65535,xe.length-W);if(_e<10){for(he=Me(we,he,+(W+_e==xe.length)),he&7&&(he+=8-(he&7)),we.l=he/8|0,we.write_shift(2,_e),we.write_shift(2,~_e&65535);_e-- >0;)we[we.l++]=xe[W++];he=we.l*8;continue}he=Me(we,he,+(W+_e==xe.length)+2);for(var Pe=0;_e-- >0;){var Re=xe[W];Pe=(Pe<<5^Re)&32767;var Fe=-1,nt=0;if((Fe=ye[Pe])&&(Fe|=W&-32768,Fe>W&&(Fe-=32768),Fe<W))for(;xe[Fe+nt]==xe[W+nt]&&nt<250;)++nt;if(nt>2){Re=q[nt],Re<=22?he=U(we,he,te[Re+1]>>1)-1:(U(we,he,3),he+=5,U(we,he,te[Re-23]>>5),he+=3);var vr=Re<8?0:Re-4>>2;vr>0&&(Q(we,he,nt-V[Re]),he+=vr),Re=X[W-Fe],he=U(we,he,te[Re]>>3),he-=3;var Rt=Re<4?0:Re-2>>1;Rt>0&&(Q(we,he,W-Fe-Y[Re]),he+=Rt);for(var fn=0;fn<nt;++fn)ye[Pe]=W&32767,Pe=(Pe<<5^xe[W])&32767,++W;_e-=nt-1}else Re<=143?Re=Re+48:he=j(we,he,1),he=U(we,he,te[Re]),ye[Pe]=W&32767,++W}he=U(we,he,0)-1}return we.l=(he+7)/8|0,we.l}return function(we,he){return we.length<8?J(we,he):Se(we,he)}}();function de(F){var X=yn(50+Math.floor(F.length*1.1)),z=ve(F,X);return X.slice(0,z)}var Te=re?new Uint16Array(32768):ee(32768),Le=re?new Uint16Array(32768):ee(32768),$e=re?new Uint16Array(128):ee(128),it=1,yt=1;function Vt(F,X){var z=Ee(F,X)+257;X+=5;var G=Ee(F,X)+1;X+=5;var q=Oe(F,X)+4;X+=4;for(var J=0,Se=re?new Uint8Array(19):ee(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,he=re?new Uint8Array(8):ee(8),W=re?new Uint8Array(8):ee(8),ye=Se.length,_e=0;_e<q;++_e)Se[L[_e]]=J=oe(F,X),we<J&&(we=J),he[J]++,X+=3;var Pe=0;for(he[0]=0,_e=1;_e<=we;++_e)W[_e]=Pe=Pe+he[_e-1]<<1;for(_e=0;_e<ye;++_e)(Pe=Se[_e])!=0&&(xe[_e]=W[Pe]++);var Re=0;for(_e=0;_e<ye;++_e)if(Re=Se[_e],Re!=0){Pe=te[xe[_e]]>>8-Re;for(var Fe=(1<<7-Re)-1;Fe>=0;--Fe)$e[Pe|Fe<<Re]=Re&7|_e<<3}var nt=[];for(we=1;nt.length<z+G;)switch(Pe=$e[be(F,X)],X+=Pe&7,Pe>>>=3){case 16:for(J=3+Ce(F,X),X+=2,Pe=nt[nt.length-1];J-- >0;)nt.push(Pe);break;case 17:for(J=3+oe(F,X),X+=3;J-- >0;)nt.push(0);break;case 18:for(J=11+be(F,X),X+=7;J-- >0;)nt.push(0);break;default:nt.push(Pe),we<Pe&&(we=Pe);break}var vr=nt.slice(0,z),Rt=nt.slice(z);for(_e=z;_e<286;++_e)vr[_e]=0;for(_e=G;_e<30;++_e)Rt[_e]=0;return it=pe(vr,Te,286),yt=pe(Rt,Le,30),X}function ut(F,X){if(F[0]==3&&!(F[1]&3))return[Du(X),2];for(var z=0,G=0,q=p9(X||1<<18),J=0,Se=q.length>>>0,xe=0,we=0;!(G&1);){if(G=oe(F,z),z+=3,G>>>1)G>>1==1?(xe=9,we=5):(z=Vt(F,z),xe=it,we=yt);else{z&7&&(z+=8-(z&7));var he=F[z>>>3]|F[(z>>>3)+1]<<8;if(z+=32,he>0)for(!X&&Se<J+he&&(q=fe(q,J+he),Se=q.length);he-- >0;)q[J++]=F[z>>>3],z+=8;continue}for(;;){!X&&Se<J+32767&&(q=fe(q,J+32767),Se=q.length);var W=Ie(F,z,xe),ye=G>>>1==1?se[W]:Te[W];if(z+=ye&15,ye>>>=4,!(ye>>>8&255))q[J++]=ye;else{if(ye==256)break;ye-=257;var _e=ye<8?0:ye-4>>2;_e>5&&(_e=0);var Pe=J+V[ye];_e>0&&(Pe+=Ie(F,z,_e),z+=_e),W=Ie(F,z,we),ye=G>>>1==1?ue[W]:Le[W],z+=ye&15,ye>>>=4;var Re=ye<4?0:ye-2>>1,Fe=Y[ye];for(Re>0&&(Fe+=Ie(F,z,Re),z+=Re),!X&&Se<Pe&&(q=fe(q,Pe+100),Se=q.length);J<Pe;)q[J]=q[J-Fe],++J}}}return X?[q,z+7>>>3]:[q.slice(0,J),z+7>>>3]}function ft(F,X){var z=F.slice(F.l||0),G=ut(z,X);return F.l+=G[1],G[0]}function Et(F,X){if(F)typeof console<"u"&&console.error(X);else throw new Error(X)}function Ft(F,X){var z=F;In(z,0);var G=[],q=[],J={FileIndex:G,FullPaths:q};E(J,{root:X.root});for(var Se=z.length-4;(z[Se]!=80||z[Se+1]!=75||z[Se+2]!=5||z[Se+3]!=6)&&Se>=0;)--Se;z.l=Se+4,z.l+=4;var xe=z.read_shift(2);z.l+=6;var we=z.read_shift(4);for(z.l=we,Se=0;Se<xe;++Se){z.l+=20;var he=z.read_shift(4),W=z.read_shift(4),ye=z.read_shift(2),_e=z.read_shift(2),Pe=z.read_shift(2);z.l+=8;var Re=z.read_shift(4),Fe=s(z.slice(z.l+ye,z.l+ye+_e));z.l+=ye+_e+Pe;var nt=z.l;z.l=Re+4,Dt(z,he,W,J,Fe),z.l=nt}return J}function Dt(F,X,z,G,q){F.l+=2;var J=F.read_shift(2),Se=F.read_shift(2),xe=o(F);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var we=F.read_shift(4),he=F.read_shift(4),W=F.read_shift(4),ye=F.read_shift(2),_e=F.read_shift(2),Pe="",Re=0;Re<ye;++Re)Pe+=String.fromCharCode(F[F.l++]);if(_e){var Fe=s(F.slice(F.l,F.l+_e));(Fe[21589]||{}).mt&&(xe=Fe[21589].mt),((q||{})[21589]||{}).mt&&(xe=q[21589].mt)}F.l+=_e;var nt=F.slice(F.l,F.l+he);switch(Se){case 8:nt=A(F,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var vr=!1;J&8&&(we=F.read_shift(4),we==134695760&&(we=F.read_shift(4),vr=!0),he=F.read_shift(4),W=F.read_shift(4)),he!=X&&Et(vr,"Bad compressed size: "+X+" != "+he),W!=z&&Et(vr,"Bad uncompressed size: "+z+" != "+W),Ut(G,Pe,nt,{unsafe:!0,mt:xe})}function wt(F,X){var z=X||{},G=[],q=[],J=yn(1),Se=z.compression?8:0,xe=0,we=0,he=0,W=0,ye=0,_e=F.FullPaths[0],Pe=_e,Re=F.FileIndex[0],Fe=[],nt=0;for(we=1;we<F.FullPaths.length;++we)if(Pe=F.FullPaths[we].slice(_e.length),Re=F.FileIndex[we],!(!Re.size||!Re.content||Pe=="Sh33tJ5")){var vr=W,Rt=yn(Pe.length);for(he=0;he<Pe.length;++he)Rt.write_shift(1,Pe.charCodeAt(he)&127);Rt=Rt.slice(0,Rt.l),Fe[ye]=odt.buf(Re.content,0);var fn=Re.content;Se==8&&(fn=I(fn)),J=yn(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,xe),J.write_shift(2,Se),Re.mt?a(J,Re.mt):J.write_shift(4,0),J.write_shift(-4,Fe[ye]),J.write_shift(4,fn.length),J.write_shift(4,Re.content.length),J.write_shift(2,Rt.length),J.write_shift(2,0),W+=J.length,G.push(J),W+=Rt.length,G.push(Rt),W+=fn.length,G.push(fn),J=yn(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,xe),J.write_shift(2,Se),J.write_shift(4,0),J.write_shift(-4,Fe[ye]),J.write_shift(4,fn.length),J.write_shift(4,Re.content.length),J.write_shift(2,Rt.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,vr),nt+=J.l,q.push(J),nt+=Rt.length,q.push(Rt),++ye}return J=yn(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,ye),J.write_shift(2,ye),J.write_shift(4,nt),J.write_shift(4,W),J.write_shift(2,0),Jl([Jl(G),Jl(q),J])}var dt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ke(F,X){if(F.ctype)return F.ctype;var z=F.name||"",G=z.match(/\.([^\.]+)$/);return G&&dt[G[1]]||X&&(G=(z=X).match(/[\.\\]([^\.\\])+$/),G&&dt[G[1]])?dt[G[1]]:"application/octet-stream"}function Be(F){for(var X=v9(F),z=[],G=0;G<X.length;G+=76)z.push(X.slice(G,G+76));return z.join(`\r
`)+`\r
`}function at(F){var X=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var W=he.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],G=X.split(`\r
`),q=0;q<G.length;++q){var J=G[q];if(J.length==0){z.push("");continue}for(var Se=0;Se<J.length;){var xe=76,we=J.slice(Se,Se+xe);we.charAt(xe-1)=="="?xe--:we.charAt(xe-2)=="="?xe-=2:we.charAt(xe-3)=="="&&(xe-=3),we=J.slice(Se,Se+xe),Se+=xe,Se<J.length&&(we+="="),z.push(we)}}return z.join(`\r
`)}function He(F){for(var X=[],z=0;z<F.length;++z){for(var G=F[z];z<=F.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+F[++z];X.push(G)}for(var q=0;q<X.length;++q)X[q]=X[q].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return ao(X.join(`\r
`))}function ot(F,X,z){for(var G="",q="",J="",Se,xe=0;xe<10;++xe){var we=X[xe];if(!we||we.match(/^\s*$/))break;var he=we.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":G=he[2].trim();break;case"content-type":J=he[2].trim();break;case"content-transfer-encoding":q=he[2].trim();break}}switch(++xe,q.toLowerCase()){case"base64":Se=ao(ia(X.slice(xe).join("")));break;case"quoted-printable":Se=He(X.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var W=Ut(F,G.slice(z.length),Se,{unsafe:!0});J&&(W.ctype=J)}function We(F,X){if(w(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=X&&X.root||"",G=(zt&&Buffer.isBuffer(F)?F.toString("binary"):w(F)).split(`\r
`),q=0,J="";for(q=0;q<G.length;++q)if(J=G[q],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),z||(z=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),J.slice(0,z.length)!=z););var Se=(G[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var xe="--"+(Se[1]||""),we=[],he=[],W={FileIndex:we,FullPaths:he};E(W);var ye,_e=0;for(q=0;q<G.length;++q){var Pe=G[q];Pe!==xe&&Pe!==xe+"--"||(_e++&&ot(W,G.slice(ye,q),z),ye=q)}return W}function Je(F,X){var z=X||{},G=z.boundary||"SheetJS";G="------="+G;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],J=F.FullPaths[0],Se=J,xe=F.FileIndex[0],we=1;we<F.FullPaths.length;++we)if(Se=F.FullPaths[we].slice(J.length),xe=F.FileIndex[we],!(!xe.size||!xe.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var he=xe.content,W=zt&&Buffer.isBuffer(he)?he.toString("binary"):w(he),ye=0,_e=Math.min(1024,W.length),Pe=0,Re=0;Re<=_e;++Re)(Pe=W.charCodeAt(Re))>=32&&Pe<128&&++ye;var Fe=ye>=_e*4/5;q.push(G),q.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+Se),q.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),q.push("Content-Type: "+Ke(xe,Se)),q.push(""),q.push(Fe?at(W):Be(W))}return q.push(G+`--\r
`),q.join(`\r
`)}function Wt(F){var X={};return E(X,F),X}function Ut(F,X,z,G){var q=G&&G.unsafe;q||E(F);var J=!q&&Yt.find(F,X);if(!J){var Se=F.FullPaths[0];X.slice(0,Se.length)==Se?Se=X:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+X).replace("//","/")),J={name:i(X),type:2},F.FileIndex.push(J),F.FullPaths.push(Se),q||Yt.utils.cfb_gc(F)}return J.content=z,J.size=z?z.length:0,G&&(G.CLSID&&(J.clsid=G.CLSID),G.mt&&(J.mt=G.mt),G.ct&&(J.ct=G.ct)),J}function Jt(F,X){E(F);var z=Yt.find(F,X);if(z){for(var G=0;G<F.FileIndex.length;++G)if(F.FileIndex[G]==z)return F.FileIndex.splice(G,1),F.FullPaths.splice(G,1),!0}return!1}function kn(F,X,z){E(F);var G=Yt.find(F,X);if(G){for(var q=0;q<F.FileIndex.length;++q)if(F.FileIndex[q]==G)return F.FileIndex[q].name=i(z),F.FullPaths[q]=z,!0}return!1}function dr(F){R(F,!0)}return t.find=D,t.read=T,t.parse=f,t.write=C,t.writeFile=k,t.utils={cfb_new:Wt,cfb_add:Ut,cfb_del:Jt,cfb_mov:kn,cfb_gc:dr,ReadShift:Tm,CheckField:noe,prep_blob:In,bconcat:Jl,use_zlib:_,_deflateRaw:de,_inflateRaw:ft,consts:me},t}();function sdt(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ts(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function NB(e){for(var t=[],r=ts(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var dT=new Date(1899,11,30,0,0,0);function wi(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=dT.getTime()+(e.getTimezoneOffset()-dT.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Nae=new Date,ldt=dT.getTime()+(Nae.getTimezoneOffset()-dT.getTimezoneOffset())*6e4,C9=Nae.getTimezoneOffset();function fE(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ldt),t.getTimezoneOffset()!==C9&&t.setTime(t.getTime()+(t.getTimezoneOffset()-C9)*6e4),t}function udt(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var x9=new Date("2017-02-19T19:06:09.000Z"),Lae=isNaN(x9.getFullYear())?new Date("2/19/17"):x9,fdt=Lae.getFullYear()==2017;function Rn(e,t){var r=new Date(e);if(fdt)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Lae.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Uc(e,t){if(zt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Zy(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Zy(_ae(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Zy(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Zy(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"â¬":"Â","â":"Â",Æ:"Â","â":"Â","â¦":"Â","â ":"Â","â¡":"Â","Ë":"Â","â°":"Â",Å :"Â","â¹":"Â",Å:"Â",Å½:"Â","â":"Â","â":"Â","â":"Â","â":"Â","â¢":"Â","â":"Â","â":"Â","Ë":"Â","â¢":"Â",Å¡:"Â","âº":"Â",Å:"Â",Å¾:"Â",Å¸:"Â"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â¬âÆââ¦â â¡Ëâ°Å â¹ÅÅ½âââââ¢ââËâ¢Å¡âºÅÅ¾Å¸]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Dn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Dn(e[r]));return t}function Yr(e,t){for(var r="";r.length<t;)r+=e;return r}function vo(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var cdt=["january","february","march","april","may","june","july","august","september","october","november","december"];function cg(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&cdt.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var hdt=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],s=1;s<a.length;++s)o.push(i),o.push(a[s]);return o}}();function Fae(e){return e?e.content&&e.type?Uc(e.content,!0):e.data?Ky(e.data):e.asNodeBuffer&&zt?Ky(e.asNodeBuffer().toString("binary")):e.asBinary?Ky(e.asBinary()):e._data&&e._data.getContent?Ky(Uc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function $ae(e){if(!e)return null;if(e.data)return h9(e.data);if(e.asNodeBuffer&&zt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?h9(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ddt(e){return e&&e.name.slice(-4)===".bin"?$ae(e):Fae(e)}function ga(e,t){for(var r=e.FullPaths||ts(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function LB(e,t){var r=ga(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function hn(e,t,r){if(!r)return ddt(LB(e,t));if(!t)return null;try{return hn(e,t)}catch{return null}}function Zi(e,t,r){if(!r)return Fae(LB(e,t));if(!t)return null;try{return Zi(e,t)}catch{return null}}function Hae(e,t,r){if(!r)return $ae(LB(e,t));if(!t)return null;try{return Hae(e,t)}catch{return null}}function T9(e){for(var t=e.FullPaths||ts(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vdt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return zt?n=hh(r):n=Dht(r),Yt.utils.cfb_add(e,t,n)}Yt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Bae(e,t){switch(t.type){case"base64":return Yt.read(e,{type:"base64"});case"binary":return Yt.read(e,{type:"binary"});case"buffer":case"array":return Yt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function qy(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Vae=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,pdt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,O9=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,gdt=/<[^>]*>/g,ti=Vae.match(O9)?O9:gdt,ydt=/<\w*:/,mdt=/<(\/?)\w+:/;function mt(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(pdt),s=0,l="",u=0,f="",c="",h=1;if(o)for(u=0;u!=o.length;++u){for(c=o[u],a=0;a!=c.length&&c.charCodeAt(a)!==61;++a);for(f=c.slice(0,a).trim();c.charCodeAt(a+1)==32;)++a;for(h=(i=c.charCodeAt(a+1))==34||i==39?1:0,l=c.slice(a+1+h,c.length-h),s=0;s!=f.length&&f.charCodeAt(s)!==58;++s);if(s===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,r||(n[f.toLowerCase()]=l);else{var d=(s===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(s+1);if(n[d]&&f.slice(s-3,s)=="ext")continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function ls(e){return e.replace(mdt,"<$1")}var jae={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},bdt=NB(jae),Qt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(s,l){return jae[s]||String.fromCharCode(parseInt(l,s.indexOf("x")>-1?16:10))||s}).replace(t,function(s,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),wdt=/[&<>'"]/g,Sdt=/[\u0000-\u001f]/g;function FB(e){var t=e+"";return t.replace(wdt,function(r){return bdt[r]}).replace(/\n/g,"<br/>").replace(Sdt,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var E9=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Dr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _A(e){for(var t="",r=0,n=0,i=0,a=0,o=0,s=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),s=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(s&1023))}return t}function R9(e){var t=Du(2*e.length),r,n,i=1,a=0,o=0,s;for(n=0;n<e.length;n+=i)i=1,(s=e.charCodeAt(n))<128?r=s:s<224?(r=(s&31)*64+(e.charCodeAt(n+1)&63),i=2):s<240?(r=(s&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(s&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function k9(e){return hh(e,"binary").toString("utf8")}var H_="foo bar bazÃ¢ÂÂÃ°ÂÂÂ£",Tr=zt&&(k9(H_)==_A(H_)&&k9||R9(H_)==_A(H_)&&R9)||_A,Zy=zt?function(e){return hh(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},nw=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Wae=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),_dt=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Cdt=/<\/?(?:vt:)?variant>/g,xdt=/<(?:vt:)([^>]*)>([\s\S]*)</;function A9(e,t){var r=mt(e),n=e.match(_dt(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(Cdt,"").match(xdt);o&&i.push({v:Tr(o[2]),t:o[1]})}),i}var Tdt=/(^\s|\s$|\n)/;function Odt(e){return ts(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Edt(e,t,r){return"<"+e+(r!=null?Odt(r):"")+(t!=null?(t.match(Tdt)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function $B(e){if(zt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Tr(dh(IB(e)));throw new Error("Bad input format: expected Buffer or string")}var iw=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Rdt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},kdt=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Adt(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Pdt(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=n?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var s=0;s<=5;++s,a/=256)e[r+s]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var P9=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},I9=zt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:hh(t)})):P9(e)}:P9,M9=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(rl(e,i)));return n.join("").replace(yi,"")},HB=zt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(yi,""):M9(e,t,r)}:M9,D9=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Uae=zt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):D9(e,t,r)}:D9,N9=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(md(e,i)));return n.join("")},yS=zt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):N9(t,r,n)}:N9,zae=function(e,t){var r=qi(e,t);return r>0?yS(e,t+4,t+4+r-1):""},Gae=zae,Yae=function(e,t){var r=qi(e,t);return r>0?yS(e,t+4,t+4+r-1):""},Kae=Yae,Xae=function(e,t){var r=2*qi(e,t);return r>0?yS(e,t+4,t+4+r-1):""},qae=Xae,Zae=function(t,r){var n=qi(t,r);return n>0?HB(t,r+4,r+4+n):""},Jae=Zae,Qae=function(e,t){var r=qi(e,t);return r>0?yS(e,t+4,t+4+r):""},eoe=Qae,toe=function(e,t){return Adt(e,t)},vT=toe,roe=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};zt&&(Gae=function(t,r){if(!Buffer.isBuffer(t))return zae(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Kae=function(t,r){if(!Buffer.isBuffer(t))return Yae(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},qae=function(t,r){if(!Buffer.isBuffer(t))return Xae(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Jae=function(t,r){if(!Buffer.isBuffer(t))return Zae(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},eoe=function(t,r){if(!Buffer.isBuffer(t))return Qae(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},vT=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):toe(t,r)},roe=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var md=function(e,t){return e[t]},rl=function(e,t){return e[t+1]*(1<<8)+e[t]},Idt=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},qi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Bf=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Mdt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Tm(e,t){var r="",n,i,a=[],o,s,l,u;switch(t){case"dbcs":if(u=this.l,zt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(rl(this,u)),u+=2;e*=2;break;case"utf8":r=yS(this,this.l,this.l+e);break;case"utf16le":e*=2,r=HB(this,this.l,this.l+e);break;case"wstr":return Tm.call(this,e,"dbcs");case"lpstr-ansi":r=Gae(this,this.l),e=4+qi(this,this.l);break;case"lpstr-cp":r=Kae(this,this.l),e=4+qi(this,this.l);break;case"lpwstr":r=qae(this,this.l),e=4+2*qi(this,this.l);break;case"lpp4":e=4+qi(this,this.l),r=Jae(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qi(this,this.l),r=eoe(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=md(this,this.l+e++))!==0;)a.push($_(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=rl(this,this.l+e))!==0;)a.push($_(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=md(this,u),this.l=u+1,s=Tm.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push($_(rl(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=md(this,u),this.l=u+1,s=Tm.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),a.join("")+s;a.push($_(md(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=md(this,this.l),this.l++,n;case 2:return n=(t==="i"?Idt:rl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Bf:Mdt)(this,this.l),this.l+=4,n):(i=qi(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=vT(this,this.l):i=vT([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=Uae(this,this.l,e);break}}return this.l+=e,r}var Ddt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ndt=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ldt=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Fdt(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Ldt(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Ddt(this,t,this.l);break;case 8:if(n=8,r==="f"){Pdt(this,t,this.l);break}case 16:break;case-4:n=4,Ndt(this,t,this.l);break}return this.l+=n,this}function noe(e,t){var r=Uae(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function In(e,t){e.l=t,e.read_shift=Tm,e.chk=noe,e.write_shift=Fdt}function qn(e,t){e.l+=t}function yn(e){var t=Du(e);return In(t,0),t}function Cl(e,t,r){if(e){var n,i,a;In(e,e.l||0);for(var o=e.length,s=0,l=0;e.l<o;){s=e.read_shift(1),s&128&&(s=(s&127)+((e.read_shift(1)&127)<<7));var u=wT[s]||wT[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;l=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=l,t(f,u,s))return}}}function aN(){var e=[],t=zt?256:2048,r=function(u){var f=yn(u);return In(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Jl(e)},s=function(u){i(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:s,end:o,_bufs:e}}function Om(e,t,r){var n=Dn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function L9(e,t,r){var n=Dn(e);return n.s=Om(n.s,t.s,r),n.e=Om(n.e,t.s,r),n}function Em(e,t){if(e.cRel&&e.c<0)for(e=Dn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Dn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=_t(e);return!e.cRel&&e.cRel!=null&&(r=Bdt(r)),!e.rRel&&e.rRel!=null&&(r=$dt(r)),r}function CA(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+wn(e.s.c)+":"+(e.e.cRel?"":"$")+wn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nn(e.s.r)+":"+(e.e.rRel?"":"$")+Nn(e.e.r):Em(e.s,t.biff)+":"+Em(e.e,t.biff)}function BB(e){return parseInt(Hdt(e),10)-1}function Nn(e){return""+(e+1)}function $dt(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Hdt(e){return e.replace(/\$(\d+)$/,"$1")}function VB(e){for(var t=Vdt(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function wn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Bdt(e){return e.replace(/^([A-Z])/,"$$$1")}function Vdt(e){return e.replace(/^\$([A-Z])/,"$1")}function jdt(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gi(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function _t(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Dg(e){var t=e.indexOf(":");return t==-1?{s:gi(e),e:gi(e)}:{s:gi(e.slice(0,t)),e:gi(e.slice(t+1))}}function Kt(e,t){return typeof t>"u"||typeof t=="number"?Kt(e.s,e.e):(typeof e!="string"&&(e=_t(e)),typeof t!="string"&&(t=_t(t)),e==t?e:e+":"+t)}function Xr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function F9(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ia(e.z,r?wi(t):t)}catch{}try{return e.w=Ia((e.XF||{}).numFmtId||(r?14:0),r?wi(t):t)}catch{return""+t}}function pl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?gh[e.v]||e.v:t==null?F9(e,e.v):F9(e,t))}function Gu(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function ioe(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),o=0,s=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?gi(n.origin):n.origin;o=l.r,s=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Xr(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(u.e.r=o=f.e.r+1)}for(var c=0;c!=t.length;++c)if(t[c]){if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[c].length;++h)if(!(typeof t[c][h]>"u")){var d={v:t[c][h]},v=o+c,p=s+h;if(u.s.r>v&&(u.s.r=v),u.s.c>p&&(u.s.c=p),u.e.r<v&&(u.e.r=v),u.e.c<p&&(u.e.c=p),t[c][h]&&typeof t[c][h]=="object"&&!Array.isArray(t[c][h])&&!(t[c][h]instanceof Date))d=t[c][h];else if(Array.isArray(d.v)&&(d.f=t[c][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||kt[14],n.cellDates?(d.t="d",d.w=Ia(d.z,wi(d.v))):(d.t="n",d.v=wi(d.v),d.w=Ia(d.z,d.v))):d.t="s";if(i)a[v]||(a[v]=[]),a[v][p]&&a[v][p].z&&(d.z=a[v][p].z),a[v][p]=d;else{var g=_t({c:p,r:v});a[g]&&a[g].z&&(d.z=a[g].z),a[g]=d}}}return u.s.c<1e7&&(a["!ref"]=Kt(u)),a}function Ng(e,t){return ioe(null,e,t)}function Wdt(e){return e.read_shift(4,"i")}function Kn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Udt(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function jB(e,t){var r=e.l,n=e.read_shift(1),i=Kn(e),a=[],o={t:i,h:i};if(n&1){for(var s=e.read_shift(4),l=0;l!=s;++l)a.push(Udt(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var zdt=jB;function Ba(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vh(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Gdt=Kn;function WB(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var Ydt=Kn,oN=WB;function UB(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?vT([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Bf(t,0)>>2;return r?i/100:i}function aoe(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ph=aoe;function Un(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Kdt(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=xc[i];u&&(t.rgb=ow(u));break;case 2:t.rgb=ow([o,s,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Xdt(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function ooe(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function qdt(e){return ooe(e,1)}function Zdt(e){return ooe(e,2)}var zB=2,Pi=3,B_=11,$9=12,pT=19,V_=64,Jdt=65,Qdt=71,evt=4108,tvt=4126,On=80,soe=81,rvt=[On,soe],nvt={1:{n:"CodePage",t:zB},2:{n:"Category",t:On},3:{n:"PresentationFormat",t:On},4:{n:"ByteCount",t:Pi},5:{n:"LineCount",t:Pi},6:{n:"ParagraphCount",t:Pi},7:{n:"SlideCount",t:Pi},8:{n:"NoteCount",t:Pi},9:{n:"HiddenCount",t:Pi},10:{n:"MultimediaClipCount",t:Pi},11:{n:"ScaleCrop",t:B_},12:{n:"HeadingPairs",t:evt},13:{n:"TitlesOfParts",t:tvt},14:{n:"Manager",t:On},15:{n:"Company",t:On},16:{n:"LinksUpToDate",t:B_},17:{n:"CharacterCount",t:Pi},19:{n:"SharedDoc",t:B_},22:{n:"HyperlinksChanged",t:B_},23:{n:"AppVersion",t:Pi,p:"version"},24:{n:"DigSig",t:Jdt},26:{n:"ContentType",t:On},27:{n:"ContentStatus",t:On},28:{n:"Language",t:On},29:{n:"Version",t:On},255:{},2147483648:{n:"Locale",t:pT},2147483651:{n:"Behavior",t:pT},1919054434:{}},ivt={1:{n:"CodePage",t:zB},2:{n:"Title",t:On},3:{n:"Subject",t:On},4:{n:"Author",t:On},5:{n:"Keywords",t:On},6:{n:"Comments",t:On},7:{n:"Template",t:On},8:{n:"LastAuthor",t:On},9:{n:"RevNumber",t:On},10:{n:"EditTime",t:V_},11:{n:"LastPrinted",t:V_},12:{n:"CreatedDate",t:V_},13:{n:"ModifiedDate",t:V_},14:{n:"PageCount",t:Pi},15:{n:"WordCount",t:Pi},16:{n:"CharCount",t:Pi},17:{n:"Thumbnail",t:Qdt},18:{n:"Application",t:On},19:{n:"DocSecurity",t:Pi},255:{},2147483648:{n:"Locale",t:pT},2147483651:{n:"Behavior",t:pT},1919054434:{}},H9={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},avt=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ovt(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var svt=ovt([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xc=Dn(svt),gh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},loe={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},B9={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function lvt(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function uvt(e){var t=lvt();if(!e||!e.match)return t;var r={};if((e.match(ti)||[]).forEach(function(n){var i=mt(n);switch(i[0].replace(ydt,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[B9[i.ContentType]]!==void 0&&t[B9[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Rdt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Od={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sN(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Rm(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ti)||[]).forEach(function(i){var a=mt(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var s=a.TargetMode==="External"?a.Target:qy(a.Target,t);r[s]=o,n[a.Id]=o}}),r["!id"]=n,r}var fvt="application/vnd.oasis.opendocument.spreadsheet";function cvt(e,t){for(var r=$B(e),n,i;n=iw.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=mt(n[0],!1),i.path=="/"&&i.type!==fvt)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var km=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],hvt=function(){for(var e=new Array(km.length),t=0;t<km.length;++t){var r=km[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function uoe(e){var t={};e=Tr(e);for(var r=0;r<km.length;++r){var n=km[r],i=e.match(hvt[r]);i!=null&&i.length>0&&(t[n[1]]=Qt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Rn(t[n[1]]))}return t}var dvt=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function foe(e,t,r,n){var i=[];if(typeof e=="string")i=A9(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(f){return{v:f}}));var o=typeof t=="string"?A9(t,n).map(function(f){return f.v}):t,s=0,l=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"å·¥ä½è¡¨":case"ÐÐ¸ÑÑÑ":case"Ø£ÙØ±Ø§Ù Ø§ÙØ¹ÙÙ":case"ã¯ã¼ã¯ã·ã¼ã":case"××××× ××ª ×¢××××":case"ArbeitsblÃ¤tter":case"ÃalÄ±Åma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"ååä»ãä¸è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=l,r.DefinedNames=o.slice(s,s+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(s,s+l);break}s+=l}}function vvt(e,t,r){var n={};return t||(t={}),e=Tr(e),dvt.forEach(function(i){var a=(e.match(nw(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Qt(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&foe(n.HeadingPairs,n.TitlesOfParts,t,r),t}var pvt=/<[^>]+>[^<]*/g;function gvt(e,t){var r={},n="",i=e.match(pvt);if(i)for(var a=0;a!=i.length;++a){var o=i[a],s=mt(o);switch(s[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Qt(s.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Qt(f);break;case"bool":r[n]=Dr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Rn(f);break;case"cy":case"error":r[n]=Qt(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var yvt={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},xA;function mvt(e,t,r){xA||(xA=NB(yvt)),t=xA[t]||t,e[t]=r}function GB(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function coe(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function hoe(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function doe(e,t,r){return t===31?hoe(e):coe(e,t,r)}function lN(e,t,r){return doe(e,t,r===!1?0:4)}function bvt(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return doe(e,t,0)}function wvt(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(yi,""),e.l-i&2&&(e.l+=2)}return r}function Svt(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(yi,"");return r}function _vt(e){var t=e.l,r=gT(e,soe);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=gT(e,Pi);return[r,n]}function Cvt(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(_vt(e));return r}function V9(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(yi,"").replace(Xy,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function voe(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function xvt(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function gT(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==$9&&n!==t&&rvt.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===$9?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return coe(e,n,4).replace(yi,"");case 31:return hoe(e);case 64:return GB(e);case 65:return voe(e);case 71:return xvt(e);case 80:return lN(e,n,!a.raw).replace(yi,"");case 81:return bvt(e,n).replace(yi,"");case 4108:return Cvt(e);case 4126:case 4127:return n==4127?wvt(e):Svt(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function j9(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,s=0,l=-1,u={};for(o=0;o!=i;++o){var f=e.read_shift(4),c=e.read_shift(4);a[o]=[f,c+r]}a.sort(function(m,b){return m[1]-b[1]});var h={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var d=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],d=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(d=!1,e.l=a[o][1]),d)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var v=t[a[o][0]];if(h[v.n]=gT(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:lo(s=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(a[o][0]===1){if(s=h.CodePage=gT(e,zB),lo(s),l!==-1){var p=e.l;e.l=a[l][1],u=V9(e,s),e.l=p}}else if(a[o][0]===0){if(s===0){l=o,e.l=a[o+1][1];continue}u=V9(e,s)}else{var g=u[a[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=voe(e);break;case 30:e.l+=4,y=lN(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=lN(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=en(e,4);break;case 64:e.l+=4,y=Rn(GB(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+n,h}function W9(e,t,r){var n=e.content;if(!n)return{};In(n,0);var i,a,o,s,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Yt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),s=n.read_shift(4),i===1&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var c=j9(n,t),h={SystemIdentifier:u};for(var d in c)h[d]=c[d];if(h.FMTID=a,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=j9(n,null)}catch{}for(d in v)h[d]=v[d];return h.FMTID=[a,o],h}function Ll(e,t){return e.read_shift(t),null}function Tvt(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function en(e,t){return e.read_shift(t)===1}function dn(e){return e.read_shift(2,"u")}function poe(e,t){return Tvt(e,t,dn)}function Ovt(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function mS(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function Evt(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,s,l={};i&&(o=e.read_shift(2)),n&&(s=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=s),l.t=f,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function zc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function bS(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):zc(e,n,r)}function yh(e,t,r){if(r.biff>5)return bS(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Rvt(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function kvt(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(yi,"");return n&&(e.l+=24),i}function Avt(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(yi,"");return r+o}function Pvt(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kvt(e);case"0303000000000000c000000000000046":return Avt(e);default:throw new Error("Unsupported Moniker "+r)}}function j_(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(yi,""):"";return r}function Ivt(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,s,l,u="",f,c;i&16&&(a=j_(e,r-e.l)),i&128&&(o=j_(e,r-e.l)),(i&257)===257&&(s=j_(e,r-e.l)),(i&257)===1&&(l=Pvt(e,r-e.l)),i&8&&(u=j_(e,r-e.l)),i&32&&(f=e.read_shift(16)),i&64&&(c=GB(e)),e.l=r;var h=o||s||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return f&&(d.guid=f),c&&(d.time=c),a&&(d.Tooltip=a),d}function goe(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function yoe(e,t){var r=goe(e);return r[3]=0,r}function us(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Mvt(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Dvt(e,t,r){return t===0?"":yh(e,t,r)}function Nvt(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function moe(e){var t=e.read_shift(2),r=UB(e);return[t,r]}function Lvt(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=mS(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function cE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function boe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var Fvt=boe;function woe(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function $vt(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Hvt(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ln(e){e.l+=2,e.l+=e.read_shift(2)}var Bvt={0:Ln,4:Ln,5:Ln,6:Ln,7:Hvt,8:Ln,9:Ln,10:Ln,11:Ln,12:Ln,13:$vt,14:Ln,15:Ln,16:Ln,17:Ln,18:Ln,19:Ln,20:Ln,21:woe};function Vvt(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(Bvt[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function W_(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function jvt(e,t){return t===0||e.read_shift(2),1200}function Wvt(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=yh(e,0,r);return e.read_shift(t+n-e.l),i}function Uvt(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function zvt(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=mS(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function Gvt(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<r;++o)a.push(Evt(e));return a.Count=n,a.Unique=i,a}function Yvt(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Kvt(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Xvt(e){var t=Mvt(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function qvt(e){return e.read_shift(2),e.read_shift(4)}function U9(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function Zvt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:s,Selected:l,TabRatio:u}}function Jvt(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Qvt(){}function ept(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=mS(e,0,r),n}function tpt(e){var t=us(e);return t.isst=e.read_shift(4),t}function rpt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=us(e);r.biff==2&&e.l++;var a=bS(e,n-e.l,r);return i.val=a,i}function npt(e,t,r){var n=e.read_shift(2),i=yh(e,0,r);return[n,i]}var ipt=yh;function z9(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),s=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:s},e:{r:o,c:l}}}function apt(e){var t=e.read_shift(2),r=e.read_shift(2),n=moe(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function opt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(moe(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function spt(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function lpt(e,t,r,n){var i={},a=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(2);return i.patternType=avt[s>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=s&127,i.icvBottom=s>>7&127,i.icvDiag=s>>14&127,i.dgDiag=s>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function upt(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=lpt(e,t,n.fStyle,r),n}function fpt(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function G9(e,t,r){var n=us(e);(r.biff==2||t==9)&&++e.l;var i=Ovt(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function cpt(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=us(e),i=Un(e);return n.val=i,n}var Y9=Dvt;function hpt(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=zc(e,a),s=[];n>e.l;)s.push(bS(e));return[a,i,o,s]}function K9(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Lvt(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var dpt=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function X9(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=zc(e,o,r);i&32&&(u=dpt[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var c=n==e.l||s===0||!(f>0)?[]:Kmt(e,f,r,s);return{chKey:a,Name:u,itab:l,rgce:c}}function Soe(e,t,r){if(r.biff<8)return vpt(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(Nvt(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function vpt(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=mS(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function ppt(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=zc(e,n,r),o=zc(e,i,r);return[a,o]}function gpt(e,t,r){var n=boe(e);e.l++;var i=e.read_shift(1);return t-=8,[Xmt(e,t,r),i,n]}function q9(e,t,r){var n=Fvt(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Gmt(e,t,r)]}function ypt(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function mpt(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),s=yh(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},s,o,a]}}function bpt(e,t,r){return mpt(e,t,r)}function wpt(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(cE(e));return r}function Spt(e,t,r){if(r&&r.biff<8)return Cpt(e,t,r);var n=woe(e),i=Vvt(e,t-22,n[1]);return{cmo:n,ft:i}}var _pt={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Cpt(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((_pt[n]||qn)(e,t,r)),{cmo:[i,n,a],ft:o}}function xpt(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=Rvt(e,6,r);var s=e.read_shift(2);e.read_shift(2),dn(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],c=zc(e,e.lens[u+1]-e.lens[u]-1);if(i+=c,i.length>=(f?s:2*s))break}if(i.length!==s&&i.length!==s*2)throw new Error("cchText: "+s+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Tpt(e,t){var r=cE(e);e.l+=16;var n=Ivt(e,t-24);return[r,n]}function Opt(e,t){e.read_shift(2);var r=cE(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(yi,""),[r,n]}function Ept(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=H9[r]||r,r=e.read_shift(2),t[1]=H9[r]||r,t}function Rpt(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(yoe(e));return r}function kpt(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(yoe(e));return r}function Apt(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function _oe(e,t,r){if(!r.cellStyles)return qn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:a,w:o,ixfe:s,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Ppt(e,t){var r={};return t<32||(e.l+=16,r.header=Un(e),r.footer=Un(e),e.l+=2),r}function Ipt(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var Mpt=us,Dpt=poe,Npt=bS;function Lpt(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function Fpt(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=us(e);++e.l;var i=yh(e,t-7,r);return n.t="str",n.val=i,n}function $pt(e){var t=us(e);++e.l;var r=Un(e);return t.t="n",t.val=r,t}function Hpt(e){var t=us(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Bpt(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Vpt(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function jpt(e,t,r){var n=e.l+t,i=us(e),a=e.read_shift(2),o=zc(e,a,r);return e.l=n,i.t="str",i.val=o,i}var Wpt=[2,3,48,49,131,139,140,245],Z9=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=NB({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(s,l){var u=[],f=Du(1);switch(l.type){case"base64":f=ao(ia(s));break;case"binary":f=ao(s);break;case"buffer":case"array":f=s;break}In(f,0);var c=f.read_shift(1),h=!!(c&136),d=!1,v=!1;switch(c){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+c.toString(16))}var p=0,g=521;c==2&&(p=f.read_shift(2)),f.l+=3,c!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),c!=2&&(g=f.read_shift(2));var y=f.read_shift(2),m=l.codepage||1252;c!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(m=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var b=[],S={},x=Math.min(f.length,c==2?521:g-10-(d?264:0)),T=v?32:11;f.l<x&&f[f.l]!=13;)switch(S={},S.name=Zl.utils.decode(m,f.slice(f.l,f.l+T)).replace(/[\u0000\r\n].*$/g,""),f.l+=T,S.type=String.fromCharCode(f.read_shift(1)),c!=2&&!v&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),c==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&b.push(S),c!=2&&(f.l+=v?13:14),S.type){case"B":(!d||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var E=0,P=0;for(u[0]=[],P=0;P!=b.length;++P)u[0][P]=b[P].name;for(;p-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++E]=[],P=0,P=0;P!=b.length;++P){var R=f.slice(f.l,f.l+b[P].len);f.l+=b[P].len,In(R,0);var M=Zl.utils.decode(m,R);switch(b[P].type){case"C":M.trim().length&&(u[E][P]=M.replace(/\s+$/,""));break;case"D":M.length===8?u[E][P]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):u[E][P]=M;break;case"F":u[E][P]=parseFloat(M.trim());break;case"+":case"I":u[E][P]=v?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":u[E][P]=!0;break;case"N":case"F":u[E][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+c.toString(16));u[E][P]="##MEMO##"+(v?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(u[E][P]=+M||0);break;case"@":u[E][P]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":u[E][P]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":u[E][P]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][P]=-R.read_shift(-8,"f");break;case"B":if(d&&b[P].len==8){u[E][P]=R.read_shift(8,"f");break}case"G":case"P":R.l+=b[P].len;break;case"0":if(b[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[P].type)}}}if(c!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(s,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ng(r(s,u),u);return f["!cols"]=u.DBF.map(function(c){return{wch:c.len,DBF:c}}),delete u.DBF,f}function i(s,l){try{return Gu(n(s,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(s,l){var u=l||{};if(+u.codepage>=0&&lo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=aN(),c=pN(s,{header:1,raw:!0,cellDates:!0}),h=c[0],d=c.slice(1),v=s["!cols"]||[],p=0,g=0,y=0,m=1;for(p=0;p<h.length;++p){if(((v[p]||{}).DBF||{}).name){h[p]=v[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var b=Xr(s["!ref"]),S=[],x=[],T=[];for(p=0;p<=b.e.c-b.s.c;++p){var E="",P="",R=0,M=[];for(g=0;g<d.length;++g)d[g][p]!=null&&M.push(d[g][p]);if(M.length==0||h[p]==null){S[p]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=M[g]instanceof Date?"D":"C";break;default:P="C"}R=Math.max(R,String(M[g]).length),E=E&&E!=P?"C":P}R>250&&(R=250),P=((v[p]||{}).DBF||{}).type,P=="C"&&v[p].DBF.len>R&&(R=v[p].DBF.len),E=="B"&&P=="N"&&(E="N",T[p]=v[p].DBF.dec,R=v[p].DBF.len),x[p]=E=="C"||P=="N"?R:a[E]||0,m+=x[p],S[p]=E}var D=f.next(32);for(D.write_shift(4,318902576),D.write_shift(4,d.length),D.write_shift(2,296+32*y),D.write_shift(2,m),p=0;p<4;++p)D.write_shift(4,0);for(D.write_shift(4,0|(+t[wae]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var N=f.next(32),B=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,B,"sbcs"),N.write_shift(1,S[p]=="?"?"C":S[p],"sbcs"),N.write_shift(4,g),N.write_shift(1,x[p]||a[S[p]]||0),N.write_shift(1,T[p]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),g+=x[p]||a[S[p]]||0}var K=f.next(264);for(K.write_shift(4,13),p=0;p<65;++p)K.write_shift(4,0);for(p=0;p<d.length;++p){var Z=f.next(m);for(Z.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(S[g]){case"L":Z.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":Z.write_shift(8,d[p][g]||0,"f");break;case"N":var ie="0";for(typeof d[p][g]=="number"&&(ie=d[p][g].toFixed(T[g]||0)),y=0;y<x[g]-ie.length;++y)Z.write_shift(1,32);Z.write_shift(1,ie,"sbcs");break;case"D":d[p][g]?(Z.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var me=String(d[p][g]!=null?d[p][g]:"").slice(0,x[g]);for(Z.write_shift(1,me,"sbcs"),y=0;y<x[g]-me.length;++y)Z.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),Upt=function(){var e={AA:"Ã",BA:"Ã",CA:"Ã",DA:195,HA:"Ã",JA:197,AE:"Ã",BE:"Ã",CE:"Ã",HE:"Ã",AI:"Ã",BI:"Ã",CI:"Ã",HI:"Ã",AO:"Ã",BO:"Ã",CO:"Ã",DO:213,HO:"Ã",AU:"Ã",BU:"Ã",CU:"Ã",HU:"Ã",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã",Kc:"Ã§",q:"Ã¦",z:"Å",a:"Ã",j:"Å",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ts(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var v=e[d];return typeof v=="number"?d9(v):v},n=function(h,d,v){var p=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?h:d9(p)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return a(ia(h),d);case"binary":return a(h,d);case"buffer":return a(zt&&Buffer.isBuffer(h)?h.toString("binary"):dh(h),d);case"array":return a(Uc(h),d)}throw new Error("Unrecognized type "+d.type)}function a(h,d){var v=h.split(/[\n\r]+/),p=-1,g=-1,y=0,m=0,b=[],S=[],x=null,T={},E=[],P=[],R=[],M=0,D;for(+d.codepage>=0&&lo(+d.codepage);y!==v.length;++y){M=0;var N=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),B=N.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),K=B[0],Z;if(N.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&S.push(N.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,me=!1,k=!1,w=!1,C=-1,O=-1;for(m=1;m<B.length;++m)switch(B[m].charAt(0)){case"A":break;case"X":g=parseInt(B[m].slice(1))-1,me=!0;break;case"Y":for(p=parseInt(B[m].slice(1))-1,me||(g=0),D=b.length;D<=p;++D)b[D]=[];break;case"K":Z=B[m].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(vo(Z))?isNaN(cg(Z).getDate())||(Z=Rn(Z)):(Z=vo(Z),x!==null&&Mg(x)&&(Z=fE(Z))),ie=!0;break;case"E":w=!0;var _=Kd(B[m].slice(1),{r:p,c:g});b[p][g]=[b[p][g],_];break;case"S":k=!0,b[p][g]=[b[p][g],"S5S"];break;case"G":break;case"R":C=parseInt(B[m].slice(1))-1;break;case"C":O=parseInt(B[m].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}if(ie&&(b[p][g]&&b[p][g].length==2?b[p][g][0]=Z:b[p][g]=Z,x=null),k){if(w)throw new Error("SYLK shared formula cannot have own formula");var A=C>-1&&b[C][O];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");b[p][g][1]=Ioe(A[1],{r:p-C,c:g-O})}break;case"F":var I=0;for(m=1;m<B.length;++m)switch(B[m].charAt(0)){case"X":g=parseInt(B[m].slice(1))-1,++I;break;case"Y":for(p=parseInt(B[m].slice(1))-1,D=b.length;D<=p;++D)b[D]=[];break;case"M":M=parseInt(B[m].slice(1))/20;break;case"F":break;case"G":break;case"P":x=S[parseInt(B[m].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=B[m].slice(1).split(" "),D=parseInt(R[0],10);D<=parseInt(R[1],10);++D)M=parseInt(R[2],10),P[D-1]=M===0?{hidden:!0}:{wch:M},hg(P[D-1]);break;case"C":g=parseInt(B[m].slice(1))-1,P[g]||(P[g]={});break;case"R":p=parseInt(B[m].slice(1))-1,E[p]||(E[p]={}),M>0?(E[p].hpt=M,E[p].hpx=sw(M)):M===0&&(E[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}I<1&&(x=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}}return E.length>0&&(T["!rows"]=E),P.length>0&&(T["!cols"]=P),d&&d.sheetRows&&(b=b.slice(0,d.sheetRows)),[b,T]}function o(h,d){var v=i(h,d),p=v[0],g=v[1],y=Ng(p,d);return ts(g).forEach(function(m){y[m]=g[m]}),y}function s(h,d){return Gu(o(h,d),d)}function l(h,d,v,p){var g="C;Y"+(v+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Ayt(h.f,{r:v,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,d){d.forEach(function(v,p){var g="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=mT(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=bT(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function f(h,d){d.forEach(function(v,p){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*koe(v.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function c(h,d){var v=["ID;PWXL;N;E"],p=[],g=Xr(h["!ref"]),y,m=Array.isArray(h),b=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&u(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var x=g.s.c;x<=g.e.c;++x){var T=_t({r:S,c:x});y=m?(h[S]||[])[x]:h[T],!(!y||y.v==null&&(!y.f||y.F))&&p.push(l(y,h,S,x))}return v.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:s,to_sheet:o,from_sheet:c}}(),zpt=function(){function e(a,o){switch(o.type){case"base64":return t(ia(a),o);case"binary":return t(a,o);case"buffer":return t(zt&&Buffer.isBuffer(a)?a.toString("binary"):dh(a),o);case"array":return t(Uc(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var s=a.split(`
`),l=-1,u=-1,f=0,c=[];f!==s.length;++f){if(s[f].trim()==="BOT"){c[++l]=[],u=0;continue}if(!(l<0)){var h=s[f].trim().split(","),d=h[0],v=h[1];++f;for(var p=s[f]||"";(p.match(/["]/g)||[]).length&1&&f<s.length-1;)p+=`
`+s[++f];switch(p=p.trim(),+d){case-1:if(p==="BOT"){c[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?c[l][u]=!0:p==="FALSE"?c[l][u]=!1:isNaN(vo(v))?isNaN(cg(v).getDate())?c[l][u]=v:c[l][u]=Rn(v):c[l][u]=vo(v),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),c[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(c=c.slice(0,o.sheetRows)),c}function r(a,o){return Ng(e(a,o),o)}function n(a,o){return Gu(r(a,o),o)}var i=function(){var a=function(l,u,f,c,h){l.push(u),l.push(f+","+c),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,u,f,c){l.push(u+","+f),l.push(u==1?'"'+c.replace(/"/g,'""')+'"':c)};return function(l){var u=[],f=Xr(l["!ref"]),c,h=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){o(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var p=_t({r:d,c:v});if(c=h?(l[d]||[])[v]:l[p],!c){o(u,1,0,"");continue}switch(c.t){case"n":var g=c.w;!g&&c.v!=null&&(g=c.v),g==null?c.f&&!c.F?o(u,1,0,"="+c.f):o(u,1,0,""):o(u,0,g,"V");break;case"b":o(u,0,c.v?1:0,c.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(c.v)?c.v:'="'+c.v+'"');break;case"d":c.w||(c.w=Ia(c.z||kt[14],wi(Rn(c.v)))),o(u,0,c.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var y=`\r
`,m=u.join(y);return m}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Gpt=function(){function e(c){return c.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(c){return c.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(c,h){for(var d=c.split(`
`),v=-1,p=-1,g=0,y=[];g!==d.length;++g){var m=d[g].trim().split(":");if(m[0]==="cell"){var b=gi(m[1]);if(y.length<=b.r)for(v=y.length;v<=b.r;++v)y[v]||(y[v]=[]);switch(v=b.r,p=b.c,m[2]){case"t":y[v][p]=e(m[3]);break;case"v":y[v][p]=+m[3];break;case"vtf":var S=m[m.length-1];case"vtc":switch(m[3]){case"nl":y[v][p]=!!+m[4];break;default:y[v][p]=+m[4];break}m[2]=="vtf"&&(y[v][p]=[y[v][p],S])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(c,h){return Ng(r(c,h),h)}function i(c,h){return Gu(n(c,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(c){if(!c||!c["!ref"])return"";for(var h=[],d=[],v,p="",g=Dg(c["!ref"]),y=Array.isArray(c),m=g.s.r;m<=g.e.r;++m)for(var b=g.s.c;b<=g.e.c;++b)if(p=_t({r:m,c:b}),v=y?(c[m]||[])[b]:c[p],!(!v||v.v==null||v.t==="z")){switch(d=["cell",p,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var S=wi(Rn(v.v));d[2]="vtc",d[3]="nd",d[4]=""+S,d[5]=v.w||Ia(v.z||kt[14],S);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(c){return[a,o,s,o,u(c),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),aw=function(){function e(f,c,h,d,v){v.raw?c[h][d]=f:f===""||(f==="TRUE"?c[h][d]=!0:f==="FALSE"?c[h][d]=!1:isNaN(vo(f))?isNaN(cg(f).getDate())?c[h][d]=f:c[h][d]=Rn(f):c[h][d]=vo(f))}function t(f,c){var h=c||{},d=[];if(!f||f.length===0)return d;for(var v=f.split(/[\r\n]/),p=v.length-1;p>=0&&v[p].length===0;)--p;for(var g=10,y=0,m=0;m<=p;++m)y=v[m].indexOf(" "),y==-1?y=v[m].length:y++,g=Math.max(g,y);for(m=0;m<=p;++m){d[m]=[];var b=0;for(e(v[m].slice(0,g).trim(),d,m,b,h),b=1;b<=(v[m].length-g)/10+1;++b)e(v[m].slice(g+(b-1)*10,g+b*10).trim(),d,m,b,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var c={},h=!1,d=0,v=0;d<f.length;++d)(v=f.charCodeAt(d))==34?h=!h:!h&&v in r&&(c[v]=(c[v]||0)+1);v=[];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d]);if(!v.length){c=n;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&v.push([c[d],d])}return v.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[v.pop()[1]]||44}function a(f,c){var h=c||{},d="",v=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=i(f.slice(0,1024)):h&&h.FS?d=h.FS:d=i(f.slice(0,1024));var g=0,y=0,m=0,b=0,S=0,x=d.charCodeAt(0),T=!1,E=0,P=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var R=h.dateNF!=null?idt(h.dateNF):null;function M(){var D=f.slice(b,S),N={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)N.t="z";else if(h.raw)N.t="s",N.v=D;else if(D.trim().length===0)N.t="s",N.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(N.t="s",N.v=D.slice(2,-1).replace(/""/g,'"')):Iyt(D)?(N.t="n",N.f=D.slice(1)):(N.t="s",N.v=D);else if(D=="TRUE")N.t="b",N.v=!0;else if(D=="FALSE")N.t="b",N.v=!1;else if(!isNaN(m=vo(D)))N.t="n",h.cellText!==!1&&(N.w=D),N.v=m;else if(!isNaN(cg(D).getDate())||R&&D.match(R)){N.z=h.dateNF||kt[14];var B=0;R&&D.match(R)&&(D=adt(D,h.dateNF,D.match(R)||[]),B=1),h.cellDates?(N.t="d",N.v=Rn(D,B)):(N.t="n",N.v=wi(Rn(D,B))),h.cellText!==!1&&(N.w=Ia(N.z,N.v instanceof Date?wi(N.v):N.v)),h.cellNF||delete N.z}else N.t="s",N.v=D;if(N.t=="z"||(h.dense?(v[g]||(v[g]=[]),v[g][y]=N):v[_t({c:y,r:g})]=N),b=S+1,P=f.charCodeAt(b),p.e.c<y&&(p.e.c=y),p.e.r<g&&(p.e.r=g),E==x)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;S<f.length;++S)switch(E=f.charCodeAt(S)){case 34:P===34&&(T=!T);break;case x:case 10:case 13:if(!T&&M())break e;break}return S-b>0&&M(),v["!ref"]=Kt(p),v}function o(f,c){return!(c&&c.PRN)||c.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,c):Ng(t(f,c),c)}function s(f,c){var h="",d=c.type=="string"?[0,0,0,0]:e3(f,c);switch(c.type){case"base64":h=ia(f);break;case"binary":h=f;break;case"buffer":c.codepage==65001?h=f.toString("utf8"):c.codepage&&typeof Zl<"u"?h=Zl.utils.decode(c.codepage,f):h=zt&&Buffer.isBuffer(f)?f.toString("binary"):dh(f);break;case"array":h=Uc(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+c.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Tr(h.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?h=Tr(h):c.type=="binary"&&typeof Zl<"u"&&c.codepage&&(h=Zl.utils.decode(c.codepage,Zl.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Gpt.to_sheet(c.type=="string"?h:Tr(h),c):o(h,c)}function l(f,c){return Gu(s(f,c),c)}function u(f){for(var c=[],h=Xr(f["!ref"]),d,v=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var g=[],y=h.s.c;y<=h.e.c;++y){var m=_t({r:p,c:y});if(d=v?(f[p]||[])[y]:f[m],!d||d.v==null){g.push("          ");continue}for(var b=(d.w||(pl(d),d.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(y===0?" ":""))}c.push(g.join(""))}return c.join(`
`)}return{to_workbook:l,to_sheet:s,from_sheet:u}}();function Ypt(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=Upt.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return aw.to_workbook(e,t)}}var Am=function(){function e(_,A,I){if(_){In(_,_.l||0);for(var L=I.Enum||C;_.l<_.length;){var V=_.read_shift(2),Y=L[V]||L[65535],ae=_.read_shift(2),re=_.l+ae,te=Y.f&&Y.f(_,ae,I);if(_.l=re,A(te,Y,V))return}}}function t(_,A){switch(A.type){case"base64":return r(ao(ia(_)),A);case"binary":return r(ao(_),A);case"buffer":case"array":return r(_,A)}throw"Unsupported type "+A.type}function r(_,A){if(!_)return _;var I=A||{},L=I.dense?[]:{},V="Sheet1",Y="",ae=0,re={},te=[],ge=[],H={s:{r:0,c:0},e:{r:0,c:0}},Ce=I.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)I.Enum=C,e(_,function(be,Ie,Me){switch(Me){case 0:I.vers=be,be>=4096&&(I.qpro=!0);break;case 6:H=be;break;case 204:be&&(Y=be);break;case 222:Y=be;break;case 15:case 51:I.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:Me==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=I.dateNF||kt[14],I.cellDates&&(be[1].t="d",be[1].v=fE(be[1].v))),I.qpro&&be[3]>ae&&(L["!ref"]=Kt(H),re[V]=L,te.push(V),L=I.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ae=be[3],V=Y||"Sheet"+(ae+1),Y="");var j=I.dense?(L[be[0].r]||[])[be[0].c]:L[_t(be[0])];if(j){j.t=be[1].t,j.v=be[1].v,be[1].z!=null&&(j.z=be[1].z),be[1].f!=null&&(j.f=be[1].f);break}I.dense?(L[be[0].r]||(L[be[0].r]=[]),L[be[0].r][be[0].c]=be[1]):L[_t(be[0])]=be[1];break}},I);else if(_[2]==26||_[2]==14)I.Enum=O,_[2]==14&&(I.qpro=!0,_.l=0),e(_,function(be,Ie,Me){switch(Me){case 204:V=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>ae&&(L["!ref"]=Kt(H),re[V]=L,te.push(V),L=I.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ae=be[3],V="Sheet"+(ae+1)),Ce>0&&be[0].r>=Ce)break;I.dense?(L[be[0].r]||(L[be[0].r]=[]),L[be[0].r][be[0].c]=be[1]):L[_t(be[0])]=be[1],H.e.c<be[0].c&&(H.e.c=be[0].c),H.e.r<be[0].r&&(H.e.r=be[0].r);break;case 27:be[14e3]&&(ge[be[14e3][0]]=be[14e3][1]);break;case 1537:ge[be[0]]=be[1],be[0]==ae&&(V=be[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(L["!ref"]=Kt(H),re[Y||V]=L,te.push(Y||V),!ge.length)return{SheetNames:te,Sheets:re};for(var oe={},Oe=[],Ee=0;Ee<ge.length;++Ee)re[te[Ee]]?(Oe.push(ge[Ee]||te[Ee]),oe[ge[Ee]]=re[ge[Ee]]||re[te[Ee]]):(Oe.push(ge[Ee]),oe[ge[Ee]]={"!ref":"A1"});return{SheetNames:Oe,Sheets:oe}}function n(_,A){var I=A||{};if(+I.codepage>=0&&lo(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var L=aN(),V=Xr(_["!ref"]),Y=Array.isArray(_),ae=[];Ga(L,0,a(1030)),Ga(L,6,l(V));for(var re=Math.min(V.e.r,8191),te=V.s.r;te<=re;++te)for(var ge=Nn(te),H=V.s.c;H<=V.e.c;++H){te===V.s.r&&(ae[H]=wn(H));var Ce=ae[H]+ge,oe=Y?(_[te]||[])[H]:_[Ce];if(!(!oe||oe.t=="z"))if(oe.t=="n")(oe.v|0)==oe.v&&oe.v>=-32768&&oe.v<=32767?Ga(L,13,d(te,H,oe.v)):Ga(L,14,p(te,H,oe.v));else{var Oe=pl(oe);Ga(L,15,c(te,H,Oe.slice(0,239)))}}return Ga(L,1),L.end()}function i(_,A){var I=A||{};if(+I.codepage>=0&&lo(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var L=aN();Ga(L,0,o(_));for(var V=0,Y=0;V<_.SheetNames.length;++V)(_.Sheets[_.SheetNames[V]]||{})["!ref"]&&Ga(L,27,w(_.SheetNames[V],Y++));var ae=0;for(V=0;V<_.SheetNames.length;++V){var re=_.Sheets[_.SheetNames[V]];if(!(!re||!re["!ref"])){for(var te=Xr(re["!ref"]),ge=Array.isArray(re),H=[],Ce=Math.min(te.e.r,8191),oe=te.s.r;oe<=Ce;++oe)for(var Oe=Nn(oe),Ee=te.s.c;Ee<=te.e.c;++Ee){oe===te.s.r&&(H[Ee]=wn(Ee));var be=H[Ee]+Oe,Ie=ge?(re[oe]||[])[Ee]:re[be];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")Ga(L,23,M(oe,Ee,ae,Ie.v));else{var Me=pl(Ie);Ga(L,22,E(oe,Ee,ae,Me.slice(0,239)))}}++ae}}return Ga(L,1),L.end()}function a(_){var A=yn(2);return A.write_shift(2,_),A}function o(_){var A=yn(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var I=0,L=0,V=0,Y=0;Y<_.SheetNames.length;++Y){var ae=_.SheetNames[Y],re=_.Sheets[ae];if(!(!re||!re["!ref"])){++V;var te=Dg(re["!ref"]);I<te.e.r&&(I=te.e.r),L<te.e.c&&(L=te.e.c)}}return I>8191&&(I=8191),A.write_shift(2,I),A.write_shift(1,V),A.write_shift(1,L),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function s(_,A,I){var L={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&I.qpro?(L.s.c=_.read_shift(1),_.l++,L.s.r=_.read_shift(2),L.e.c=_.read_shift(1),_.l++,L.e.r=_.read_shift(2),L):(L.s.c=_.read_shift(2),L.s.r=_.read_shift(2),A==12&&I.qpro&&(_.l+=2),L.e.c=_.read_shift(2),L.e.r=_.read_shift(2),A==12&&I.qpro&&(_.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function l(_){var A=yn(8);return A.write_shift(2,_.s.c),A.write_shift(2,_.s.r),A.write_shift(2,_.e.c),A.write_shift(2,_.e.r),A}function u(_,A,I){var L=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(L[0].c=_.read_shift(1),L[3]=_.read_shift(1),L[0].r=_.read_shift(2),_.l+=2):(L[2]=_.read_shift(1),L[0].c=_.read_shift(2),L[0].r=_.read_shift(2)),L}function f(_,A,I){var L=_.l+A,V=u(_,A,I);if(V[1].t="s",I.vers==20768){_.l++;var Y=_.read_shift(1);return V[1].v=_.read_shift(Y,"utf8"),V}return I.qpro&&_.l++,V[1].v=_.read_shift(L-_.l,"cstr"),V}function c(_,A,I){var L=yn(7+I.length);L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,_),L.write_shift(1,39);for(var V=0;V<L.length;++V){var Y=I.charCodeAt(V);L.write_shift(1,Y>=128?95:Y)}return L.write_shift(1,0),L}function h(_,A,I){var L=u(_,A,I);return L[1].v=_.read_shift(2,"i"),L}function d(_,A,I){var L=yn(7);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,_),L.write_shift(2,I,"i"),L}function v(_,A,I){var L=u(_,A,I);return L[1].v=_.read_shift(8,"f"),L}function p(_,A,I){var L=yn(13);return L.write_shift(1,255),L.write_shift(2,A),L.write_shift(2,_),L.write_shift(8,I,"f"),L}function g(_,A,I){var L=_.l+A,V=u(_,A,I);if(V[1].v=_.read_shift(8,"f"),I.qpro)_.l=L;else{var Y=_.read_shift(2);S(_.slice(_.l,_.l+Y),V),_.l+=Y}return V}function y(_,A,I){var L=A&32768;return A&=-32769,A=(L?_:0)+(A>=8192?A-16384:A),(L?"":"$")+(I?wn(A):Nn(A))}var m={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(_,A){In(_,0);for(var I=[],L=0,V="",Y="",ae="",re="";_.l<_.length;){var te=_[_.l++];switch(te){case 0:I.push(_.read_shift(8,"f"));break;case 1:Y=y(A[0].c,_.read_shift(2),!0),V=y(A[0].r,_.read_shift(2),!1),I.push(Y+V);break;case 2:{var ge=y(A[0].c,_.read_shift(2),!0),H=y(A[0].r,_.read_shift(2),!1);Y=y(A[0].c,_.read_shift(2),!0),V=y(A[0].r,_.read_shift(2),!1),I.push(ge+H+":"+Y+V)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(_.read_shift(2));break;case 6:{for(var Ce="";te=_[_.l++];)Ce+=String.fromCharCode(te);I.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:re=I.pop(),ae=I.pop(),I.push(["AND","OR"][te-20]+"("+ae+","+re+")");break;default:if(te<32&&b[te])re=I.pop(),ae=I.pop(),I.push(ae+b[te]+re);else if(m[te]){if(L=m[te][1],L==69&&(L=_[_.l++]),L>I.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+I.join("|")+"|");return}var oe=I.slice(-L);I.length-=L,I.push(m[te][0]+"("+oe.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}I.length==1?A[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function x(_){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=_.read_shift(2),A[3]=_[_.l++],A[0].c=_[_.l++],A}function T(_,A){var I=x(_);return I[1].t="s",I[1].v=_.read_shift(A-4,"cstr"),I}function E(_,A,I,L){var V=yn(6+L.length);V.write_shift(2,_),V.write_shift(1,I),V.write_shift(1,A),V.write_shift(1,39);for(var Y=0;Y<L.length;++Y){var ae=L.charCodeAt(Y);V.write_shift(1,ae>=128?95:ae)}return V.write_shift(1,0),V}function P(_,A){var I=x(_);I[1].v=_.read_shift(2);var L=I[1].v>>1;if(I[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return I[1].v=L,I}function R(_,A){var I=x(_),L=_.read_shift(4),V=_.read_shift(4),Y=_.read_shift(2);if(Y==65535)return L===0&&V===3221225472?(I[1].t="e",I[1].v=15):L===0&&V===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ae=Y&32768;return Y=(Y&32767)-16446,I[1].v=(1-ae*2)*(V*Math.pow(2,Y+32)+L*Math.pow(2,Y)),I}function M(_,A,I,L){var V=yn(14);if(V.write_shift(2,_),V.write_shift(1,I),V.write_shift(1,A),L==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var Y=0,ae=0,re=0,te=0;return L<0&&(Y=1,L=-L),ae=Math.log2(L)|0,L/=Math.pow(2,ae-31),te=L>>>0,te&2147483648||(L/=2,++ae,te=L>>>0),L-=te,te|=2147483648,te>>>=0,L*=Math.pow(2,32),re=L>>>0,V.write_shift(4,re),V.write_shift(4,te),ae+=16383+(Y?32768:0),V.write_shift(2,ae),V}function D(_,A){var I=R(_);return _.l+=A-14,I}function N(_,A){var I=x(_),L=_.read_shift(4);return I[1].v=L>>6,I}function B(_,A){var I=x(_),L=_.read_shift(8,"f");return I[1].v=L,I}function K(_,A){var I=B(_);return _.l+=A-10,I}function Z(_,A){return _[_.l+A-1]==0?_.read_shift(A,"cstr"):""}function ie(_,A){var I=_[_.l++];I>A-1&&(I=A-1);for(var L="";L.length<I;)L+=String.fromCharCode(_[_.l++]);return L}function me(_,A,I){if(!(!I.qpro||A<21)){var L=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var V=_.read_shift(A-21,"cstr");return[L,V]}}function k(_,A){for(var I={},L=_.l+A;_.l<L;){var V=_.read_shift(2);if(V==14e3){for(I[V]=[0,""],I[V][0]=_.read_shift(2);_[_.l];)I[V][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return I}function w(_,A){var I=yn(5+_.length);I.write_shift(2,14e3),I.write_shift(2,A);for(var L=0;L<_.length;++L){var V=_.charCodeAt(L);I[I.l++]=V>127?95:V}return I[I.l++]=0,I}var C={0:{n:"BOF",f:dn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:s},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},O={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:k},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function Kpt(e){var t={},r=e.match(ti),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=mt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=AB[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var Xpt=function(){var e=nw("t"),t=nw("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var s={t:"s",v:Qt(o[1])},l=a.match(t);return l&&(s.s=Kpt(l[1])),s}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(s){return s.v})}}(),qpt=function(){var t=/(\r\n|\n)/g;function r(i,a,o){var s=[];i.u&&s.push("text-decoration: underline;"),i.uval&&s.push("text-underline-style:"+i.uval+";"),i.sz&&s.push("font-size:"+i.sz+"pt;"),i.outline&&s.push("text-effect: outline;"),i.shadow&&s.push("text-shadow: auto;"),a.push('<span style="'+s.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Zpt=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Jpt=/<(?:\w+:)?r>/,Qpt=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function YB(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Qt(Tr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Tr(e),r&&(n.h=FB(n.t))):e.match(Jpt)&&(n.r=Tr(e),n.t=Qt(Tr((e.replace(Qpt,"").match(Zpt)||[]).join("").replace(ti,""))),r&&(n.h=qpt(Xpt(n.r)))),n):{t:""}}var egt=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tgt=/<(?:\w+:)?(?:si|sstItem)>/g,rgt=/<\/(?:\w+:)?(?:si|sstItem)>/;function ngt(e,t){var r=[],n="";if(!e)return r;var i=e.match(egt);if(i){n=i[2].replace(tgt,"").split(rgt);for(var a=0;a!=n.length;++a){var o=YB(n[a].trim(),t);o!=null&&(r[r.length]=o)}i=mt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function igt(e){return[e.read_shift(4),e.read_shift(4)]}function agt(e,t){var r=[],n=!1;return Cl(e,function(a,o,s){switch(s){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}function Coe(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function sl(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function ogt(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=sl(e,4),t.U=sl(e,4),t.W=sl(e,4),t}function sgt(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function lgt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(sgt(e));return t}function ugt(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function fgt(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=sl(e,4),t.U=sl(e,4),t.W=sl(e,4),t}function cgt(e){var t=fgt(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function xoe(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Toe(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function hgt(e){var t=sl(e);switch(t.Minor){case 2:return[t.Minor,dgt(e)];case 3:return[t.Minor,vgt()];case 4:return[t.Minor,pgt(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function dgt(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=xoe(e,r),i=Toe(e,e.length-e.l);return{t:"Std",h:n,v:i}}function vgt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pgt(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ti,function(a){var o=mt(a);switch(ls(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(s){n[s]=o[s]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function ggt(e,t){var r={},n=r.EncryptionVersionInfo=sl(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=xoe(e,i),t-=i,r.EncryptionVerifier=Toe(e,t),r}function ygt(e){var t={},r=t.EncryptionVersionInfo=sl(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function mgt(e){var t=0,r,n=Coe(e),i=n.length+1,a,o,s,l,u;for(r=Du(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],s=t&16384?1:0,l=t<<1&32767,u=s|l,t=u^o;return t^52811}var Ooe=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,s){return n(o^s)},a=function(o){for(var s=t[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var f=o[u],c=0;c!=7;++c)f&64&&(s^=r[l]),f*=2,--l;return s};return function(o){for(var s=Coe(o),l=a(s),u=s.length,f=Du(16),c=0;c!=16;++c)f[c]=0;var h,d,v;for((u&1)===1&&(h=l>>8,f[u]=i(e[0],h),--u,h=l&255,d=s[s.length-1],f[u]=i(d,h));u>0;)--u,h=l>>8,f[u]=i(s[u],h),--u,h=l&255,f[u]=i(s[u],h);for(u=15,v=15-s.length;v>0;)h=l>>8,f[u]=i(e[v],h),--u,--v,h=l&255,f[u]=i(s[u],h),--u,--v;return f}}(),bgt=function(e,t,r,n,i){i||(i=t),n||(n=Ooe(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},wgt=function(e){var t=0,r=Ooe(e);return function(n){var i=bgt("",n,t,r);return t=i[1],i[0]}};function Sgt(e,t,r,n){var i={key:dn(e),verificationBytes:dn(e)};return r.password&&(i.verifier=mgt(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=wgt(r.password)),i}function _gt(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=ygt(e):n.Data=ggt(e,t),n}function Cgt(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?_gt(e,t-2,n):Sgt(e,r.biff>=8?t:t-2,r,n),n}var xgt=function(){function e(i,a){switch(a.type){case"base64":return t(ia(i),a);case"binary":return t(i,a);case"buffer":return t(zt&&Buffer.isBuffer(i)?i.toString("binary"):dh(i),a);case"array":return t(Uc(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},s=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,c){Array.isArray(s)&&(s[c]=[]);for(var h=/\\\w+\b/g,d=0,v,p=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var g=f.slice(d,h.lastIndex-v[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var y={v:g,t:"s"};Array.isArray(s)?s[c][p]=y:s[_t({r:c,c:p})]=y}break}d=h.lastIndex}p>u.e.c&&(u.e.c=p)}),s["!ref"]=Kt(u),s}function r(i,a){return Gu(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Xr(i["!ref"]),s,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var c=_t({r:u,c:f});s=l?(i[u]||[])[f]:i[c],!(!s||s.v==null&&(!s.f||s.F))&&(a.push(" "+(s.w||(pl(s),s.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Tgt(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ow(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Ogt(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var s=0,l=0,u=i+a;switch(l=o/(u>1?2-u:u),i){case t:s=((r-n)/o+6)%6;break;case r:s=(n-t)/o+2;break;case n:s=(t-r)/o+4;break}return[s/6,l,u/2]}function Egt(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],s=6*t,l;if(r!==0)switch(s|0){case 0:case 6:l=i*s,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-s),o[0]+=l,o[1]+=i;break;case 2:l=i*(s-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-s),o[1]+=l,o[2]+=i;break;case 4:l=i*(s-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-s),o[2]+=l,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function yT(e,t){if(t===0)return e;var r=Ogt(Tgt(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ow(Egt(r))}var Eoe=6,Rgt=15,kgt=1,vi=Eoe;function mT(e){return Math.floor((e+Math.round(128/vi)/256)*vi)}function bT(e){return Math.floor((e-5)/vi*100+.5)/100}function uN(e){return Math.round((e*vi+5)/vi*256)/256}function TA(e){return uN(bT(mT(e)))}function KB(e){var t=Math.abs(e-TA(e)),r=vi;if(t>.005)for(vi=kgt;vi<Rgt;++vi)Math.abs(e-TA(e))<=t&&(t=Math.abs(e-TA(e)),r=vi);vi=r}function hg(e){e.width?(e.wpx=mT(e.width),e.wch=bT(e.wpx),e.MDW=vi):e.wpx?(e.wch=bT(e.wpx),e.width=uN(e.wch),e.MDW=vi):typeof e.wch=="number"&&(e.width=uN(e.wch),e.wpx=mT(e.width),e.MDW=vi),e.customWidth&&delete e.customWidth}var Agt=96,Roe=Agt;function koe(e){return e*96/Roe}function sw(e){return e*Roe/96}var Pgt={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Igt(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(ti)||[]).forEach(function(o){var s=mt(o);switch(ls(s[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},s.diagonalUp&&(i.diagonalUp=Dr(s.diagonalUp)),s.diagonalDown&&(i.diagonalDown=Dr(s.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in borders")}})}function Mgt(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(ti)||[]).forEach(function(o){var s=mt(o);switch(ls(s[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":s.patternType&&(i.patternType=s.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),s.indexed&&(i.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(i.bgColor.theme=parseInt(s.theme,10)),s.tint&&(i.bgColor.tint=parseFloat(s.tint)),s.rgb&&(i.bgColor.rgb=s.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),s.theme&&(i.fgColor.theme=parseInt(s.theme,10)),s.tint&&(i.fgColor.tint=parseFloat(s.tint)),s.rgb!=null&&(i.fgColor.rgb=s.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fills")}})}function Dgt(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(ti)||[]).forEach(function(o){var s=mt(o);switch(ls(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=Tr(s.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=s.val?Dr(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?Dr(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?Dr(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?Dr(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?Dr(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?Dr(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?Dr(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(s.val=="1")break;s.codepage=AB[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=Dr(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var l=xc[i.color.index];i.color.index==81&&(l=xc[1]),l||(l=xc[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=yT(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fonts")}})}function Ngt(e,t,r){t.NumberFmt=[];for(var n=ts(kt),i=0;i<n.length;++i)t.NumberFmt[n[i]]=kt[n[i]];var a=e[0].match(ti);if(a)for(i=0;i<a.length;++i){var o=mt(a[i]);switch(ls(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var s=Qt(Tr(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=s}Cc(s,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var U_=["numFmtId","fillId","fontId","borderId","xfId"],z_=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Lgt(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(ti)||[]).forEach(function(a){var o=mt(a),s=0;switch(ls(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],s=0;s<U_.length;++s)n[U_[s]]&&(n[U_[s]]=parseInt(n[U_[s]],10));for(s=0;s<z_.length;++s)n[z_[s]]&&(n[z_[s]]=Dr(n[z_[s]]));if(t.NumberFmt&&n.numFmtId>392){for(s=392;s>60;--s)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[s]){n.numFmtId=s;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Dr(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var Fgt=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,l,u){var f={};if(!s)return f;s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var c;return(c=s.match(t))&&Ngt(c,f,u),(c=s.match(i))&&Dgt(c,f,l,u),(c=s.match(n))&&Mgt(c,f,l,u),(c=s.match(a))&&Igt(c,f,l,u),(c=s.match(r))&&Lgt(c,f,u),f}}();function $gt(e,t){var r=e.read_shift(2),n=Kn(e);return[r,n]}function Hgt(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Xdt(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var s=e.read_shift(1);s>0&&(n.family=s);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Kdt(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Kn(e),n}var Bgt=qn;function Vgt(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var jgt=qn;function Wgt(e,t,r){var n={};n.NumberFmt=[];for(var i in kt)n.NumberFmt[i]=kt[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Cl(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Cc(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=yT(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f),o=!0;break;case 38:a.pop(),o=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var Ugt=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function zgt(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ti)||[]).forEach(function(i){var a=mt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[Ugt.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Ggt(){}function Ygt(){}var Kgt=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Xgt=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,qgt=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Zgt(e,t,r){t.themeElements={};var n;[["clrScheme",Kgt,zgt],["fontScheme",Xgt,Ggt],["fmtScheme",qgt,Ygt]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Jgt=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Aoe(e,t){(!e||e.length===0)&&(e=Qgt());var r,n={};if(!(r=e.match(Jgt)))throw new Error("themeElements not found in theme");return Zgt(r[0],n,t),n.raw=e,n}function Qgt(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Vae];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function eyt(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=Bae(a,{type:"array"})}catch{return}var s=Zi(o,"theme/theme/theme1.xml",!0);if(s)return Aoe(s,r)}}function tyt(e){return e.read_shift(4)}function ryt(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=nyt(e,4);break;case 2:t.xclrValue=goe(e);break;case 3:t.xclrValue=tyt(e);break;case 4:e.l+=4;break}return e.l+=8,t}function nyt(e,t){return qn(e,t)}function iyt(e,t){return qn(e,t)}function ayt(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=ryt(e);break;case 6:n[1]=iyt(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function oyt(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(ayt(e,r-e.l));return{ixfe:n,ext:a}}function syt(e,t){t.forEach(function(r){switch(r[0]){}})}function lyt(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Kn(e)}}function uyt(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function fyt(e){return e.l+=4,e.read_shift(4)!=0}function cyt(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,s=2;return Cl(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(c){s==1?n.Cell.push({type:n.Types[c[0]-1].name,index:c[1]}):s==0&&n.Value.push({type:n.Types[c[0]-1].name,index:c[1]})});break;case 337:s=l?1:0;break;case 338:s=2;break;case 35:a.push(f),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function hyt(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(ti,function(s){var l=mt(s);switch(ls(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return s}),n}function dyt(e){var t=[];if(!e)return t;var r=1;return(e.match(ti)||[]).forEach(function(n){var i=mt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function vyt(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=_t(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function pyt(e,t,r){var n=[];return Cl(e,function(a,o,s){switch(s){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+s.toString(16))}}),n}function gyt(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Cl(e,function(s,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function yyt(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function J9(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(o){var s=gi(o.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[o.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[o.ref]=a;var l=Xr(e["!ref"]||"BDWGO1000001:A1");l.s.r>s.r&&(l.s.r=s.r),l.e.r<s.r&&(l.e.r=s.r),l.s.c>s.c&&(l.s.c=s.c),l.e.c<s.c&&(l.e.c=s.c);var u=Kt(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:o.author,t:o.t,r:o.r,T:r};o.h&&(f.h=o.h);for(var c=a.c.length-1;c>=0;--c){if(!r&&a.c[c].T)return;r&&!a.c[c].T&&a.c.splice(c,1)}if(r&&n){for(c=0;c<n.length;++c)if(f.a==n[c].id){f.a=n[c].name||f.a;break}}a.c.push(f)})}function myt(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&r.push(s[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var s=o.match(/<(?:\w+:)?comment[^>]*>/);if(s){var l=mt(s[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=gi(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var c=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!c&&!!c[1]&&YB(c[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function byt(e,t){var r=[],n=!1,i={},a=0;return e.replace(ti,function(s,l){var u=mt(s);switch(ls(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=l+s.length;break;case"</text>":i.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return s}),r}function wyt(e,t){var r=[],n=!1;return e.replace(ti,function(a){var o=mt(a);switch(ls(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function Syt(e){var t={};t.iauthor=e.read_shift(4);var r=ph(e);return t.rfx=r.s,t.ref=_t(r.s),e.l+=16,t}var _yt=Kn;function Cyt(e,t){var r=[],n=[],i={},a=!1;return Cl(e,function(s,l,u){switch(u){case 632:n.push(s);break;case 635:i=s;break;case 637:i.t=s.t,i.h=s.h,i.r=s.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var xyt="application/vnd.ms-office.vbaProject";function Tyt(e){var t=Yt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Yt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Yt.write(t)}function Oyt(){return{"!type":"dialog"}}function Eyt(){return{"!type":"dialog"}}function Ryt(){return{"!type":"macro"}}function kyt(){return{"!type":"macro"}}var Kd=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,o){var s=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),o.length==0?s=!0:o.charAt(0)=="["&&(s=!0,o=o.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return s?f+=t.c:--f,l?u+=t.r:--u,i+(s?"":"$")+wn(f)+(l?"":"$")+Nn(u)}return function(i,a){return t=a,i.replace(e,r)}}(),Poe=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ayt=function(){return function(t,r){return t.replace(Poe,function(n,i,a,o,s,l){var u=VB(o)-(a?0:r.c),f=BB(l)-(s?0:r.r),c=f==0?"":s?f+1:"["+f+"]",h=u==0?"":a?u+1:"["+u+"]";return i+"R"+c+"C"+h})}}();function Ioe(e,t){return e.replace(Poe,function(r,n,i,a,o,s){return n+(i=="$"?i+a:wn(VB(a)+t.c))+(o=="$"?o+s:Nn(BB(s)+t.r))})}function Pyt(e,t,r){var n=Dg(t),i=n.s,a=gi(r),o={r:a.r-i.r,c:a.c-i.c};return Ioe(e,o)}function Iyt(e){return e.length!=1}function Q9(e){return e.replace(/_xlfn\./g,"")}function cn(e){e.l+=1}function Nu(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function Moe(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Doe(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=Nu(e,2),s=Nu(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Doe(e){var t=Nu(e,2),r=Nu(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Myt(e,t,r){if(r.biff<8)return Doe(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Nu(e,2),o=Nu(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Noe(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Dyt(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Nu(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function Dyt(e){var t=Nu(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Nyt(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Lyt(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Fyt(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,s=(a&32768)>>15;if(a&=16383,s==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:s}}function Fyt(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function $yt(e,t,r){var n=(e[e.l++]&96)>>5,i=Moe(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Hyt(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=Moe(e,a,r);return[n,i,o]}function Byt(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Vyt(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function jyt(e,t,r){var n=(e[e.l++]&96)>>5,i=Myt(e,t-1,r);return[n,i]}function Wyt(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function eY(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Uyt(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function zyt(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Gyt(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Yyt(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Kyt(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Loe(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Xyt(e){return e.read_shift(2),Loe(e)}function qyt(e){return e.read_shift(2),Loe(e)}function Zyt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Noe(e,0,r);return[n,i]}function Jyt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Lyt(e,0,r);return[n,i]}function Qyt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=Noe(e,0,r);return[n,i,a]}function emt(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[t0t[i],Hoe[i],n]}function tmt(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:rmt(e);return[i,(a[0]===0?Hoe:e0t)[a[1]]]}function rmt(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function nmt(e,t,r){e.l+=r&&r.biff==2?3:4}function imt(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function amt(e){return e.l++,gh[e.read_shift(1)]}function omt(e){return e.l++,e.read_shift(2)}function smt(e){return e.l++,e.read_shift(1)!==0}function lmt(e){return e.l++,Un(e)}function umt(e,t,r){return e.l++,mS(e,t-1,r)}function fmt(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=en(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=gh[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Un(e);break;case 2:r[1]=yh(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function cmt(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?ph:cE)(e));return i}function hmt(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var s=0;s!=i;++s)o[a][s]=fmt(e,r.biff);return o}function dmt(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function vmt(e,t,r){if(r.biff==5)return pmt(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function pmt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function gmt(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function ymt(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function mmt(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function bmt(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var wmt=qn,Smt=qn,_mt=qn;function wS(e,t,r){return e.l+=2,[Nyt(e)]}function XB(e){return e.l+=6,[]}var Cmt=wS,xmt=XB,Tmt=XB,Omt=wS;function Foe(e){return e.l+=2,[dn(e),e.read_shift(2)&1]}var Emt=wS,Rmt=Foe,kmt=XB,Amt=wS,Pmt=wS,Imt=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Mmt(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=Imt[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function Dmt(e){return e.l+=2,[e.read_shift(4)]}function Nmt(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Lmt(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Fmt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function $mt(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Hmt(e){return e.l+=4,[0,0]}var tY={1:{n:"PtgExp",f:imt},2:{n:"PtgTbl",f:_mt},3:{n:"PtgAdd",f:cn},4:{n:"PtgSub",f:cn},5:{n:"PtgMul",f:cn},6:{n:"PtgDiv",f:cn},7:{n:"PtgPower",f:cn},8:{n:"PtgConcat",f:cn},9:{n:"PtgLt",f:cn},10:{n:"PtgLe",f:cn},11:{n:"PtgEq",f:cn},12:{n:"PtgGe",f:cn},13:{n:"PtgGt",f:cn},14:{n:"PtgNe",f:cn},15:{n:"PtgIsect",f:cn},16:{n:"PtgUnion",f:cn},17:{n:"PtgRange",f:cn},18:{n:"PtgUplus",f:cn},19:{n:"PtgUminus",f:cn},20:{n:"PtgPercent",f:cn},21:{n:"PtgParen",f:cn},22:{n:"PtgMissArg",f:cn},23:{n:"PtgStr",f:umt},26:{n:"PtgSheet",f:Nmt},27:{n:"PtgEndSheet",f:Lmt},28:{n:"PtgErr",f:amt},29:{n:"PtgBool",f:smt},30:{n:"PtgInt",f:omt},31:{n:"PtgNum",f:lmt},32:{n:"PtgArray",f:Wyt},33:{n:"PtgFunc",f:emt},34:{n:"PtgFuncVar",f:tmt},35:{n:"PtgName",f:dmt},36:{n:"PtgRef",f:Zyt},37:{n:"PtgArea",f:$yt},38:{n:"PtgMemArea",f:gmt},39:{n:"PtgMemErr",f:wmt},40:{n:"PtgMemNoMem",f:Smt},41:{n:"PtgMemFunc",f:ymt},42:{n:"PtgRefErr",f:mmt},43:{n:"PtgAreaErr",f:Byt},44:{n:"PtgRefN",f:Jyt},45:{n:"PtgAreaN",f:jyt},46:{n:"PtgMemAreaN",f:Fmt},47:{n:"PtgMemNoMemN",f:$mt},57:{n:"PtgNameX",f:vmt},58:{n:"PtgRef3d",f:Qyt},59:{n:"PtgArea3d",f:Hyt},60:{n:"PtgRefErr3d",f:bmt},61:{n:"PtgAreaErr3d",f:Vyt},255:{}},Bmt={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Vmt={1:{n:"PtgElfLel",f:Foe},2:{n:"PtgElfRw",f:Amt},3:{n:"PtgElfCol",f:Cmt},6:{n:"PtgElfRwV",f:Pmt},7:{n:"PtgElfColV",f:Omt},10:{n:"PtgElfRadical",f:Emt},11:{n:"PtgElfRadicalS",f:kmt},13:{n:"PtgElfColS",f:xmt},15:{n:"PtgElfColSV",f:Tmt},16:{n:"PtgElfRadicalLel",f:Rmt},25:{n:"PtgList",f:Mmt},29:{n:"PtgSxName",f:Dmt},255:{}},jmt={0:{n:"PtgAttrNoop",f:Hmt},1:{n:"PtgAttrSemi",f:Kyt},2:{n:"PtgAttrIf",f:Gyt},4:{n:"PtgAttrChoose",f:Uyt},8:{n:"PtgAttrGoto",f:zyt},16:{n:"PtgAttrSum",f:nmt},32:{n:"PtgAttrBaxcel",f:eY},33:{n:"PtgAttrBaxcel",f:eY},64:{n:"PtgAttrSpace",f:Xyt},65:{n:"PtgAttrSpaceSemi",f:qyt},128:{n:"PtgAttrIfError",f:Yyt},255:{}};function SS(e,t,r,n){if(n.biff<8)return qn(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=hmt(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=cmt(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(qn(e,t)),a}function _S(e,t,r){for(var n=e.l+t,i,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],i=tY[a]||tY[Bmt[a]],(a===24||a===25)&&(i=(a===24?Vmt:jmt)[e[e.l+1]]),!i||!i.f?qn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function Wmt(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Umt={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zmt(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function $oe(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function rY(e,t,r){var n=$oe(e,t,r);return n=="#REF"?n:zmt(n,r)}function Vn(e,t,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},s=[],l,u,f,c=0,h=0,d,v="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",y=0,m=e[0].length;y<m;++y){var b=e[0][y];switch(b[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=s.pop(),u=s.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Yr(" ",e[0][p][1][1]);break;case 1:g=Yr("\r",e[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}s.push(u+Umt[b[0]]+l);break;case"PtgIsect":l=s.pop(),u=s.pop(),s.push(u+" "+l);break;case"PtgUnion":l=s.pop(),u=s.pop(),s.push(u+","+l);break;case"PtgRange":l=s.pop(),u=s.pop(),s.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Om(b[1][1],o,i),s.push(Em(f,a));break;case"PtgRefN":f=r?Om(b[1][1],r,i):b[1][1],s.push(Em(f,a));break;case"PtgRef3d":c=b[1][1],f=Om(b[1][2],o,i),v=rY(n,c,i),s.push(v+"!"+Em(f,a));break;case"PtgFunc":case"PtgFuncVar":var S=b[1][0],x=b[1][1];S||(S=0),S&=127;var T=S==0?[]:s.slice(-S);s.length-=S,x==="User"&&(x=T.shift()),s.push(x+"("+T.join(",")+")");break;case"PtgBool":s.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":s.push(b[1]);break;case"PtgNum":s.push(String(b[1]));break;case"PtgStr":s.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":s.push(b[1]);break;case"PtgAreaN":d=L9(b[1][1],r?{s:r}:o,i),s.push(CA(d,i));break;case"PtgArea":d=L9(b[1][1],o,i),s.push(CA(d,i));break;case"PtgArea3d":c=b[1][1],d=b[1][2],v=rY(n,c,i),s.push(v+"!"+CA(d,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],P=E?E.Name:"SH33TJSNAME"+String(h);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),s.push(P);break;case"PtgNameX":var R=b[1][1];h=b[1][2];var M;if(i.biff<=5)R<0&&(R=-R),n[R]&&(M=n[R][h]);else{var D="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][h]&&n[R][h].itab>0&&(D=n.SheetNames[n[R][h].itab-1]+"!"):D=n.SheetNames[h-1]+"!"),n[R]&&n[R][h])D+=n[R][h].Name;else if(n[0]&&n[0][h])D+=n[0][h].Name;else{var N=($oe(n,R,i)||"").split(";;");N[h-1]?D=N[h-1]:D+="SH33TJSERRX"}s.push(D);break}M||(M={Name:"SH33TJSERRY"}),s.push(M.Name);break;case"PtgParen":var B="(",K=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:B=Yr(" ",e[0][p][1][1])+B;break;case 3:B=Yr("\r",e[0][p][1][1])+B;break;case 4:K=Yr(" ",e[0][p][1][1])+K;break;case 5:K=Yr("\r",e[0][p][1][1])+K;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}s.push(B+s.pop()+K);break;case"PtgRefErr":s.push("#REF!");break;case"PtgRefErr3d":s.push("#REF!");break;case"PtgExp":f={c:b[1][1],r:b[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[_t(f)]){var ie=n.sharedf[_t(f)];s.push(Vn(ie,o,Z,n,i))}else{var me=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){s.push(Vn(u[1],o,Z,n,i)),me=!0;break}me||s.push(b[1])}break;case"PtgArray":s.push("{"+Wmt(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":s.push("");break;case"PtgAreaErr":s.push("#REF!");break;case"PtgAreaErr3d":s.push("#REF!");break;case"PtgList":s.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var k=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&k.indexOf(e[0][y][0])==-1){b=e[0][p];var w=!0;switch(b[1][0]){case 4:w=!1;case 0:g=Yr(" ",b[1][1]);break;case 5:w=!1;case 1:g=Yr("\r",b[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}s.push((w?g:"")+s.pop()+(w?"":g)),p=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function Gmt(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],qn(e,t-2)];var s=_S(e,o,r);return t!==o+i&&(a=SS(e,t-o-i,s,r)),e.l=n,[s,a]}function Ymt(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],qn(e,t-2)];var s=_S(e,o,r);return t!==o+i&&(a=SS(e,t-o-i,s,r)),e.l=n,[s,a]}function Kmt(e,t,r,n){var i=e.l+t,a=_S(e,n,r),o;return i!==e.l&&(o=SS(e,i-e.l,a,r)),[a,o]}function Xmt(e,t,r){var n=e.l+t,i,a=e.read_shift(2),o=_S(e,a,r);return a==65535?[[],qn(e,t-2)]:(t!==a+2&&(i=SS(e,n-a-2,o,r)),[o,i])}function qmt(e){var t;if(rl(e,e.l+6)!==65535)return[Un(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function OA(e,t,r){var n=e.l+t,i=us(e);r.biff==2&&++e.l;var a=qmt(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var s=Ymt(e,n-e.l,r);return{cell:i,val:a[0],formula:s,shared:o>>3&1,tt:a[1]}}function hE(e,t,r){var n=e.read_shift(4),i=_S(e,n,r),a=e.read_shift(4),o=a>0?SS(e,a,i,r):null;return[i,o]}var Zmt=hE,dE=hE,Jmt=hE,Qmt=hE,e0t={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Hoe={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t0t={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function nY(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function EA(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Pm={},Xd={};function Im(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Boe(e,t,r,n,i,a){try{n.cellNF&&(e.z=kt[t])}catch(s){if(n.WTF)throw s}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Rn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(kt[t]==null&&Cc(ndt[t]||"General",t),e.t==="e")e.w=e.w||gh[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rw(e.v);else if(e.t==="d"){var o=wi(e.v);(o|0)===o?e.w=o.toString(10):e.w=rw(o)}else{if(e.v===void 0)return"";e.w=Wc(e.v,Xd)}else e.t==="d"?e.w=Ia(t,wi(e.v),Xd):e.w=Ia(t,e.v,Xd)}catch(s){if(n.WTF)throw s}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=yT(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=yT(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(n.WTF&&a.Fills)throw s}}}function r0t(e,t){var r=Xr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Kt(r))}var n0t=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,i0t=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,a0t=/<(?:\w:)?hyperlink [^>]*>/mg,o0t=/"(\w*:\w*)"/,s0t=/<(?:\w:)?col\b[^>]*[\/]?>/g,l0t=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,u0t=/<(?:\w:)?pageMargins[^>]*\/>/g,Voe=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,f0t=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,c0t=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function h0t(e,t,r,n,i,a,o){if(!e)return e;n||(n={"!id":{}});var s=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",c=e.match(i0t);c?(u=e.slice(0,c.index),f=e.slice(c.index+c[0].length)):u=f=e;var h=u.match(Voe);h?qB(h[0],s,i,r):(h=u.match(f0t))&&d0t(h[0],h[1]||"",s,i,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var v=u.slice(d,d+50).match(o0t);v&&r0t(s,v[1])}var p=u.match(c0t);p&&p[1]&&b0t(p[1],i);var g=[];if(t.cellStyles){var y=u.match(s0t);y&&g0t(g,y)}c&&w0t(c[1],s,t,l,a,o);var m=f.match(l0t);m&&(s["!autofilter"]=y0t(m[0]));var b=[],S=f.match(n0t);if(S)for(d=0;d!=S.length;++d)b[d]=Xr(S[d].slice(S[d].indexOf('"')+1));var x=f.match(a0t);x&&v0t(s,x,n);var T=f.match(u0t);if(T&&(s["!margins"]=p0t(mt(T[0]))),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=Kt(l)),t.sheetRows>0&&s["!ref"]){var E=Xr(s["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),s["!fullref"]=s["!ref"],s["!ref"]=Kt(E))}return g.length>0&&(s["!cols"]=g),b.length>0&&(s["!merges"]=b),s}function qB(e,t,r,n){var i=mt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Qt(Tr(i.codeName)))}function d0t(e,t,r,n,i){qB(e.slice(0,e.indexOf(">")),r,n,i)}function v0t(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=mt(Tr(t[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+Qt(a.location))):(a.Target="#"+Qt(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var s=Xr(a.ref),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u){var f=_t({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function p0t(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function g0t(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=mt(t[n],!0);i.hidden&&(i.hidden=Dr(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,KB(i.width)),hg(i);a<=o;)e[a++]=Dn(i)}}function y0t(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var m0t=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function b0t(e,t){t.Views||(t.Views=[{}]),(e.match(m0t)||[]).forEach(function(r,n){var i=mt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Dr(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var w0t=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=nw("v"),o=nw("f");return function(l,u,f,c,h,d){for(var v=0,p="",g=[],y=[],m=0,b=0,S=0,x="",T,E,P=0,R=0,M,D,N=0,B=0,K=Array.isArray(d.CellXf),Z,ie=[],me=[],k=Array.isArray(u),w=[],C={},O=!1,_=!!f.sheetStubs,A=l.split(t),I=0,L=A.length;I!=L;++I){p=A[I].trim();var V=p.length;if(V!==0){var Y=0;e:for(v=0;v<V;++v)switch(p[v]){case">":if(p[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(E=mt(p.slice(Y,v),!0),P=E.r!=null?parseInt(E.r,10):P+1,R=-1,f.sheetRows&&f.sheetRows<P)continue;C={},O=!1,E.ht&&(O=!0,C.hpt=parseFloat(E.ht),C.hpx=sw(C.hpt)),E.hidden=="1"&&(O=!0,C.hidden=!0),E.outlineLevel!=null&&(O=!0,C.level=+E.outlineLevel),O&&(w[P-1]=C)}break;case"<":Y=v;break}if(Y>=v)break;if(E=mt(p.slice(Y,v),!0),P=E.r!=null?parseInt(E.r,10):P+1,R=-1,!(f.sheetRows&&f.sheetRows<P)){c.s.r>P-1&&(c.s.r=P-1),c.e.r<P-1&&(c.e.r=P-1),f&&f.cellStyles&&(C={},O=!1,E.ht&&(O=!0,C.hpt=parseFloat(E.ht),C.hpx=sw(C.hpt)),E.hidden=="1"&&(O=!0,C.hidden=!0),E.outlineLevel!=null&&(O=!0,C.level=+E.outlineLevel),O&&(w[P-1]=C)),g=p.slice(v).split(e);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),v=0;v!=g.length;++v)if(p=g[v].trim(),p.length!==0){if(y=p.match(r),m=v,b=0,S=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(m=0,x=y[1],b=0;b!=x.length&&!((S=x.charCodeAt(b)-64)<1||S>26);++b)m=26*m+S;--m,R=m}else++R;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,E=mt(p.slice(0,b),!0),E.r||(E.r=_t({r:P-1,c:R})),x=p.slice(b),T={t:""},(y=x.match(a))!=null&&y[1]!==""&&(T.v=Qt(y[1])),f.cellFormula){if((y=x.match(o))!=null&&y[1]!==""){if(T.f=Qt(Tr(y[1])).replace(/\r\n/g,`
`),f.xlfn||(T.f=Q9(T.f)),y[0].indexOf('t="array"')>-1)T.F=(x.match(i)||[])[1],T.F.indexOf(":")>-1&&ie.push([Xr(T.F),T.F]);else if(y[0].indexOf('t="shared"')>-1){D=mt(y[0]);var re=Qt(Tr(y[1]));f.xlfn||(re=Q9(re)),me[parseInt(D.si,10)]=[D,re,E.r]}}else(y=x.match(/<f[^>]*\/>/))&&(D=mt(y[0]),me[D.si]&&(T.f=Pyt(me[D.si][1],me[D.si][2],E.r)));var te=gi(E.r);for(b=0;b<ie.length;++b)te.r>=ie[b][0].s.r&&te.r<=ie[b][0].e.r&&te.c>=ie[b][0].s.c&&te.c<=ie[b][0].e.c&&(T.F=ie[b][1])}if(E.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(_)T.t="z";else continue;else T.t=E.t||"n";switch(c.s.c>R&&(c.s.c=R),c.e.c<R&&(c.e.c=R),T.t){case"n":if(T.v==""||T.v==null){if(!_)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!_)continue;T.t="z"}else M=Pm[parseInt(T.v,10)],T.v=M.t,T.r=M.r,f.cellHTML&&(T.h=M.h);break;case"str":T.t="s",T.v=T.v!=null?Tr(T.v):"",f.cellHTML&&(T.h=FB(T.v));break;case"inlineStr":y=x.match(n),T.t="s",y!=null&&(M=YB(y[1]))?(T.v=M.t,f.cellHTML&&(T.h=M.h)):T.v="";break;case"b":T.v=Dr(T.v);break;case"d":f.cellDates?T.v=Rn(T.v,1):(T.v=wi(Rn(T.v,1)),T.t="n");break;case"e":(!f||f.cellText!==!1)&&(T.w=T.v),T.v=loe[T.v];break}if(N=B=0,Z=null,K&&E.s!==void 0&&(Z=d.CellXf[E.s],Z!=null&&(Z.numFmtId!=null&&(N=Z.numFmtId),f.cellStyles&&Z.fillId!=null&&(B=Z.fillId))),Boe(T,N,B,f,h,d),f.cellDates&&K&&T.t=="n"&&Mg(kt[N])&&(T.t="d",T.v=fE(T.v)),E.cm&&f.xlmeta){var ge=(f.xlmeta.Cell||[])[+E.cm-1];ge&&ge.type=="XLDAPR"&&(T.D=!0)}if(k){var H=gi(E.r);u[H.r]||(u[H.r]=[]),u[H.r][H.c]=T}else u[E.r]=T}}}}w.length>0&&(u["!rows"]=w)}}();function S0t(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var _0t=ph;function C0t(){}function x0t(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Gdt(e),r}function T0t(e){var t=Ba(e);return[t]}function O0t(e){var t=vh(e);return[t]}function E0t(e){var t=Ba(e),r=e.read_shift(1);return[t,r,"b"]}function R0t(e){var t=vh(e),r=e.read_shift(1);return[t,r,"b"]}function k0t(e){var t=Ba(e),r=e.read_shift(1);return[t,r,"e"]}function A0t(e){var t=vh(e),r=e.read_shift(1);return[t,r,"e"]}function P0t(e){var t=Ba(e),r=e.read_shift(4);return[t,r,"s"]}function I0t(e){var t=vh(e),r=e.read_shift(4);return[t,r,"s"]}function M0t(e){var t=Ba(e),r=Un(e);return[t,r,"n"]}function joe(e){var t=vh(e),r=Un(e);return[t,r,"n"]}function D0t(e){var t=Ba(e),r=UB(e);return[t,r,"n"]}function N0t(e){var t=vh(e),r=UB(e);return[t,r,"n"]}function L0t(e){var t=Ba(e),r=jB(e);return[t,r,"is"]}function F0t(e){var t=Ba(e),r=Kn(e);return[t,r,"str"]}function $0t(e){var t=vh(e),r=Kn(e);return[t,r,"str"]}function H0t(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var s=dE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}function B0t(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var s=dE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}function V0t(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=Un(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var s=dE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}function j0t(e,t,r){var n=e.l+t,i=Ba(e);i.r=r["!row"];var a=Kn(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var s=dE(e,n-e.l,r);o[3]=Vn(s,null,i,r.supbooks,r)}else e.l=n;return o}var W0t=ph;function U0t(e,t){var r=e.l+t,n=ph(e),i=WB(e),a=Kn(e),o=Kn(e),s=Kn(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:s};return o&&(l.Tooltip=o),l}function z0t(){}function G0t(e,t,r){var n=e.l+t,i=aoe(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var s=Zmt(e,n-e.l,r);o[1]=s}else e.l=n;return o}function Y0t(e,t,r){var n=e.l+t,i=ph(e),a=[i];if(r.cellFormula){var o=Qmt(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}var K0t=["left","right","top","bottom","header","footer"];function X0t(e){var t={};return K0t.forEach(function(r){t[r]=Un(e)}),t}function q0t(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Z0t(){}function J0t(){}function Q0t(e,t,r,n,i,a,o){if(!e)return e;var s=t||{};n||(n={"!id":{}});var l=s.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},c=!1,h=!1,d,v,p,g,y,m,b,S,x,T=[];s.biff=12,s["!row"]=0;var E=0,P=!1,R=[],M={},D=s.supbooks||i.supbooks||[[]];if(D.sharedf=M,D.arrayf=R,D.SheetNames=i.SheetNames||i.Sheets.map(function(k){return k.name}),!s.supbooks&&(s.supbooks=D,i.Names))for(var N=0;N<i.Names.length;++N)D[0][N+1]=i.Names[N];var B=[],K=[],Z=!1;wT[16]={n:"BrtShortReal",f:joe};var ie;if(Cl(e,function(w,C,O){if(!h)switch(O){case 148:u=w;break;case 0:d=w,s.sheetRows&&s.sheetRows<=d.r&&(h=!0),S=Nn(g=d.r),s["!row"]=d.r,(w.hidden||w.hpt||w.level!=null)&&(w.hpt&&(w.hpx=sw(w.hpt)),K[w.r]=w);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:w[2]},w[2]){case"n":v.v=w[1];break;case"s":b=Pm[w[1]],v.v=b.t,v.r=b.r;break;case"b":v.v=!!w[1];break;case"e":v.v=w[1],s.cellText!==!1&&(v.w=gh[v.v]);break;case"str":v.t="s",v.v=w[1];break;case"is":v.t="s",v.v=w[1].t;break}if((p=o.CellXf[w[0].iStyleRef])&&Boe(v,p.numFmtId,null,s,a,o),y=w[0].c==-1?y+1:w[0].c,s.dense?(l[g]||(l[g]=[]),l[g][y]=v):l[wn(y)+S]=v,s.cellFormula){for(P=!1,E=0;E<R.length;++E){var _=R[E];d.r>=_[0].s.r&&d.r<=_[0].e.r&&y>=_[0].s.c&&y<=_[0].e.c&&(v.F=Kt(_[0]),P=!0)}!P&&w.length>3&&(v.f=w[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>y&&(f.s.c=y),f.e.r<d.r&&(f.e.r=d.r),f.e.c<y&&(f.e.c=y),s.cellDates&&p&&v.t=="n"&&Mg(kt[p.numFmtId])){var A=gc(v.v);A&&(v.t="d",v.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}ie&&(ie.type=="XLDAPR"&&(v.D=!0),ie=void 0);break;case 1:case 12:if(!s.sheetStubs||c)break;v={t:"z",v:void 0},y=w[0].c==-1?y+1:w[0].c,s.dense?(l[g]||(l[g]=[]),l[g][y]=v):l[wn(y)+S]=v,f.s.r>d.r&&(f.s.r=d.r),f.s.c>y&&(f.s.c=y),f.e.r<d.r&&(f.e.r=d.r),f.e.c<y&&(f.e.c=y),ie&&(ie.type=="XLDAPR"&&(v.D=!0),ie=void 0);break;case 176:T.push(w);break;case 49:ie=((s.xlmeta||{}).Cell||[])[w-1];break;case 494:var I=n["!id"][w.relId];for(I?(w.Target=I.Target,w.loc&&(w.Target+="#"+w.loc),w.Rel=I):w.relId==""&&(w.Target="#"+w.loc),g=w.rfx.s.r;g<=w.rfx.e.r;++g)for(y=w.rfx.s.c;y<=w.rfx.e.c;++y)s.dense?(l[g]||(l[g]=[]),l[g][y]||(l[g][y]={t:"z",v:void 0}),l[g][y].l=w):(m=_t({c:y,r:g}),l[m]||(l[m]={t:"z",v:void 0}),l[m].l=w);break;case 426:if(!s.cellFormula)break;R.push(w),x=s.dense?l[g][y]:l[wn(y)+S],x.f=Vn(w[1],f,{r:d.r,c:y},D,s),x.F=Kt(w[0]);break;case 427:if(!s.cellFormula)break;M[_t(w[0].s)]=w[1],x=s.dense?l[g][y]:l[wn(y)+S],x.f=Vn(w[1],f,{r:d.r,c:y},D,s);break;case 60:if(!s.cellStyles)break;for(;w.e>=w.s;)B[w.e--]={width:w.w/256,hidden:!!(w.flags&1),level:w.level},Z||(Z=!0,KB(w.w/256)),hg(B[w.e+1]);break;case 161:l["!autofilter"]={ref:Kt(w)};break;case 476:l["!margins"]=w;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),w.name&&(i.Sheets[r].CodeName=w.name),(w.above||w.left)&&(l["!outline"]={above:w.above,left:w.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),w.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:c=!0;break;case 36:c=!1;break;case 37:c=!0;break;case 38:c=!1;break;default:if(!C.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+O.toString(16))}}},s),delete s.supbooks,delete s["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=Kt(u||f)),s.sheetRows&&l["!ref"]){var me=Xr(l["!ref"]);s.sheetRows<=+me.e.r&&(me.e.r=s.sheetRows-1,me.e.r>f.e.r&&(me.e.r=f.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>f.e.c&&(me.e.c=f.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Kt(me))}return T.length>0&&(l["!merges"]=T),B.length>0&&(l["!cols"]=B),K.length>0&&(l["!rows"]=K),l}function ebt(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Qt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function tbt(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var s=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(c){var h=ebt(c);f.s.r=f.s.c=0,f.e.c=s,u=wn(s),h[0].forEach(function(d,v){o[u+Nn(v)]={t:"n",v:d,z:h[1]},l=v}),f.e.r<l&&(f.e.r=l),++s}),s>0&&(o["!ref"]=Kt(f)),o}function rbt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,s=e.match(Voe);return s&&qB(s[0],a,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function nbt(e,t){e.l+=10;var r=Kn(e);return{name:r}}function ibt(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Cl(e,function(l,u,f){switch(f){case 550:a["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Woe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],abt=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],obt=[],sbt=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function iY(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Dr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function aY(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Dr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Uoe(e){aY(e.WBProps,Woe),aY(e.CalcPr,sbt),iY(e.WBView,abt),iY(e.Sheets,obt),Xd.date1904=Dr(e.WBProps.date1904)}var lbt="][*?/\\".split("");function ubt(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return lbt.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var fbt=/<\w+:workbook/;function cbt(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(ti,function(l,u){var f=mt(l);switch(ls(f[0])){case"<?xml":break;case"<workbook":l.match(fbt)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Woe.forEach(function(c){if(f[c[0]]!=null)switch(c[2]){case"bool":r.WBProps[c[0]]=Dr(f[c[0]]);break;case"int":r.WBProps[c[0]]=parseInt(f[c[0]],10);break;default:r.WBProps[c[0]]=f[c[0]]}}),f.codeName&&(r.WBProps.CodeName=Tr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Qt(Tr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Tr(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Dr(f.hidden||"0")&&(a.Hidden=!0),o=u+l.length;break;case"</definedName>":a.Ref=Qt(Tr(e.slice(o,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),kdt.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Uoe(r),r}function hbt(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=oN(e),r.name=Kn(e),r}function dbt(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Kn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vbt(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function pbt(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=Ydt(e),o=Jmt(e,0,r),s=WB(e);e.l=n;var l={Name:a,Ptg:o};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}function gbt(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],wT[16]={n:"BrtFRTArchID$",f:vbt},Cl(e,function(l,u,f){switch(f){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Vn(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,l]):o[0]=[f,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Uoe(r),r.Names=a,r.supbooks=o,r}function ybt(e,t,r){return t.slice(-4)===".bin"?gbt(e,r):cbt(e,r)}function mbt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?Q0t(e,n,r,i,a,o,s):h0t(e,n,r,i,a,o,s)}function bbt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?ibt(e,n,r,i,a):rbt(e,n,r,i,a)}function wbt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?Ryt():kyt()}function Sbt(e,t,r,n,i,a,o,s){return t.slice(-4)===".bin"?Oyt():Eyt()}function _bt(e,t,r,n){return t.slice(-4)===".bin"?Wgt(e,r,n):Fgt(e,r,n)}function Cbt(e,t,r){return Aoe(e,r)}function xbt(e,t,r){return t.slice(-4)===".bin"?agt(e,r):ngt(e,r)}function Tbt(e,t,r){return t.slice(-4)===".bin"?Cyt(e,r):myt(e,r)}function Obt(e,t,r){return t.slice(-4)===".bin"?pyt(e):dyt(e)}function Ebt(e,t,r,n){return r.slice(-4)===".bin"?gyt(e,t,r,n):void 0}function Rbt(e,t,r){return t.slice(-4)===".bin"?cyt(e,t,r):hyt(e,t,r)}var zoe=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Goe=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function za(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(zoe),a,o,s,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(Goe),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),n[s]=a[2].slice(1,a[2].length-1));return n}function kbt(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(zoe),i,a,o,s;if(n)for(s=0;s!=n.length;++s)i=n[s].match(Goe),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Mm;function Abt(e,t){var r=Mm[e]||Qt(e);return r==="General"?Wc(t):Ia(r,t)}function Pbt(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Dr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Rn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Qt(t)]=i}function Ibt(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||gh[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rw(e.v):e.w=Wc(e.v):e.w=Abt(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Mm[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Mg(n)){var i=gc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function Mbt(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Pgt[n.Pattern]||n.Pattern)}e[t.ID]=t}function Dbt(e,t,r,n,i,a,o,s,l,u){var f="General",c=n.StyleID,h={};u=u||{};var d=[],v=0;for(c===void 0&&s&&(c=s.StyleID),c===void 0&&o&&(c=o.StyleID);a[c]!==void 0&&(a[c].nf&&(f=a[c].nf),a[c].Interior&&d.push(a[c].Interior),!!a[c].Parent);)c=a[c].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Dr(e);break;case"String":n.t="s",n.r=E9(Qt(e)),n.v=e.indexOf("<")>-1?Qt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Rn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Qt(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=loe[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=E9(t||e));break}if(Ibt(n,f,u),u.cellFormula!==!1)if(n.Formula){var p=Qt(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Kd(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Kd("RC:RC",i):n.ArrayRange&&(n.F=Kd(n.ArrayRange,i),l.push([Xr(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);u.cellStyles&&(d.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Nbt(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function RA(e,t){var r=t||{};Mae();var n=Ky($B(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Tr(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Dn(r);return o.type="string",aw.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ie){i.indexOf("<"+Ie)>=0&&(a=!0)}),a)return Ubt(n,r);Mm={"General Number":"General","General Date":kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kt[15],"Short Date":kt[14],"Long Time":kt[19],"Medium Time":kt[18],"Short Time":kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kt[2],Standard:kt[4],Percent:kt[10],Scientific:kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,l=[],u,f={},c=[],h=r.dense?[]:{},d="",v={},p={},g=za('<Data ss:Type="String">'),y=0,m=0,b=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},x={},T={},E="",P=0,R=[],M={},D={},N=0,B=[],K=[],Z={},ie=[],me,k=!1,w=[],C=[],O={},_=0,A=0,I={Sheets:[],WBProps:{date1904:!1}},L={};iw.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var V="";s=iw.exec(n);)switch(s[3]=(V=s[3]).toLowerCase()){case"data":if(V=="data"){if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break}if(l[l.length-1][1])break;s[1]==="/"?Dbt(n.slice(y,s.index),E,g,l[l.length-1][0]=="comment"?Z:v,{c:m,r:b},x,ie[m],p,w,r):(E="",g=za(s[0]),y=s.index+s[0].length);break;case"cell":if(s[1]==="/")if(K.length>0&&(v.c=K),(!r.sheetRows||r.sheetRows>b)&&v.v!==void 0&&(r.dense?(h[b]||(h[b]=[]),h[b][m]=v):h[wn(m)+Nn(b)]=v),v.HRef&&(v.l={Target:Qt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(_=m+(parseInt(v.MergeAcross,10)|0),A=b+(parseInt(v.MergeDown,10)|0),R.push({s:{c:m,r:b},e:{c:_,r:A}})),!r.sheetStubs)v.MergeAcross?m=_+1:++m;else if(v.MergeAcross||v.MergeDown){for(var Y=m;Y<=_;++Y)for(var ae=b;ae<=A;++ae)(Y>m||ae>b)&&(r.dense?(h[ae]||(h[ae]=[]),h[ae][Y]={t:"z"}):h[wn(Y)+Nn(ae)]={t:"z"});m=_+1}else++m;else v=kbt(s[0]),v.Index&&(m=+v.Index-1),m<S.s.c&&(S.s.c=m),m>S.e.c&&(S.e.c=m),s[0].slice(-2)==="/>"&&++m,K=[];break;case"row":s[1]==="/"||s[0].slice(-2)==="/>"?(b<S.s.r&&(S.s.r=b),b>S.e.r&&(S.e.r=b),s[0].slice(-2)==="/>"&&(p=za(s[0]),p.Index&&(b=+p.Index-1)),m=0,++b):(p=za(s[0]),p.Index&&(b=+p.Index-1),O={},(p.AutoFitHeight=="0"||p.Height)&&(O.hpx=parseInt(p.Height,10),O.hpt=koe(O.hpx),C[b]=O),p.Hidden=="1"&&(O.hidden=!0,C[b]=O));break;case"worksheet":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));c.push(d),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=Kt(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=Kt(S))),R.length&&(h["!merges"]=R),ie.length>0&&(h["!cols"]=ie),C.length>0&&(h["!rows"]=C),f[d]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=m=0,l.push([s[3],!1]),u=za(s[0]),d=Qt(u.Name),h=r.dense?[]:{},R=[],w=[],C=[],L={name:d,Hidden:0},I.Sheets.push(L);break;case"table":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else{if(s[0].slice(-2)=="/>")break;l.push([s[3],!1]),ie=[],k=!1}break;case"style":s[1]==="/"?Mbt(x,T,r):T=za(s[0]);break;case"numberformat":T.nf=Qt(za(s[0]).Format||"General"),Mm[T.nf]&&(T.nf=Mm[T.nf]);for(var re=0;re!=392&&kt[re]!=T.nf;++re);if(re==392){for(re=57;re!=392;++re)if(kt[re]==null){Cc(T.nf,re);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(me=za(s[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!k&&me.wpx>10){k=!0,vi=Eoe;for(var te=0;te<ie.length;++te)ie[te]&&hg(ie[te])}k&&hg(me),ie[me.Index-1||ie.length]=me;for(var ge=0;ge<+me.Span;++ge)ie[ie.length]=Dn(me);break;case"namedrange":if(s[1]==="/")break;I.Names||(I.Names=[]);var H=mt(s[0]),Ce={Name:H.Name,Ref:Kd(H.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(Ce.Sheet=I.Sheets.length-1),I.Names.push(Ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(s[0].slice(-2)==="/>")break;s[1]==="/"?E+=n.slice(P,s.index):P=s.index+s[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=za(s[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(s[0].slice(-2)==="/>")break;s[1]==="/"?mvt(M,V,n.slice(N,s.index)):N=s.index+s[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else l.push([s[3],!1]);break;case"comment":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"));Nbt(Z),K.push(Z)}else l.push([s[3],!1]),u=za(s[0]),Z={a:u.Author};break;case"autofilter":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else if(s[0].charAt(s[0].length-2)!=="/"){var oe=za(s[0]);h["!autofilter"]={ref:Kd(oe.Range).replace(/\$/g,"")},l.push([s[3],!0])}break;case"name":break;case"datavalidation":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(s[1]==="/"){if((u=l.pop())[0]!==s[3])throw new Error("Bad state: "+u.join("|"))}else s[0].charAt(s[0].length-2)!=="/"&&l.push([s[3],!0]);break;case"null":break;default:if(l.length==0&&s[3]=="document"||l.length==0&&s[3]=="uof")return cY(n,r);var Oe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Oe=!1}break;case"componentoptions":switch(s[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Oe=!1}break;case"excelworkbook":switch(s[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Oe=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":break;case"height":break;case"width":break;default:Oe=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if(s[0].slice(-2)!=="/>")if(s[1]==="/")switch(n.slice(N,s.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else N=s.index+s[0].length;break;case"header":h["!margins"]||Im(h["!margins"]={},"xlml"),isNaN(+mt(s[0]).Margin)||(h["!margins"].header=+mt(s[0]).Margin);break;case"footer":h["!margins"]||Im(h["!margins"]={},"xlml"),isNaN(+mt(s[0]).Margin)||(h["!margins"].footer=+mt(s[0]).Margin);break;case"pagemargins":var Ee=mt(s[0]);h["!margins"]||Im(h["!margins"]={},"xlml"),isNaN(+Ee.Top)||(h["!margins"].top=+Ee.Top),isNaN(+Ee.Left)||(h["!margins"].left=+Ee.Left),isNaN(+Ee.Right)||(h["!margins"].right=+Ee.Right),isNaN(+Ee.Bottom)||(h["!margins"].bottom=+Ee.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Oe=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Oe=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Oe=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Oe=!1}break;case"querytable":switch(s[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Oe=!1}break;case"datavalidation":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Oe=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Oe=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Oe=!1}break;case"smarttags":break;default:Oe=!1;break}if(Oe||s[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(s[0].slice(-2)==="/>")break;s[1]==="/"?Pbt(D,V,B,n.slice(N,s.index)):(B=s,N=s.index+s[0].length);break}if(r.WTF)throw"Unrecognized tag: "+s[3]+"|"+l.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=f),be.SheetNames=c,be.Workbook=I,be.SSF=Dn(kt),be.Props=M,be.Custprops=D,be}function fN(e,t){switch(QB(t=t||{}),t.type||"base64"){case"base64":return RA(ia(e),t);case"binary":case"buffer":case"file":return RA(e,t);case"array":return RA(dh(e),t)}}function Lbt(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=qdt(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Zdt(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Fbt=[60,1084,2066,2165,2175];function $bt(e,t,r,n,i){var a=n,o=[],s=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(s)}o.push(s),r.l+=a;for(var l=rl(r,r.l),u=cN[l],f=0;u!=null&&Fbt.indexOf(l)>-1;)a=rl(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),s=r.slice(f,r.l+4+a),o.push(s),r.l+=4+a,u=cN[l=rl(r,r.l)];var c=Jl(o);In(c,0);var h=0;c.lens=[];for(var d=0;d<o.length;++d)c.lens.push(h),h+=o[d].length;if(c.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+c.length+" < "+n;return t.f(c,c.length,i)}function No(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=kt[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||gh[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rw(e.v):e.w=Wc(e.v):e.w=Ia(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Mg(kt[n]||String(n))){var i=gc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function G_(e,t,r){return{v:e,ixfe:t,t:r}}function Hbt(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},o={},s=null,l=[],u="",f={},c,h="",d,v,p,g,y={},m=[],b,S,x=[],T=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},R=function(de){return de<8?xc[de]:de<64&&T[de-8]||xc[de]},M=function(de,Te,Le){var $e=Te.XF.data;if(!(!$e||!$e.patternType||!Le||!Le.cellStyles)){Te.s={},Te.s.patternType=$e.patternType;var it;(it=ow(R($e.icvFore)))&&(Te.s.fgColor={rgb:it}),(it=ow(R($e.icvBack)))&&(Te.s.bgColor={rgb:it})}},D=function(de,Te,Le){if(!(O>1)&&!(Le.sheetRows&&de.r>=Le.sheetRows)){if(Le.cellStyles&&Te.XF&&Te.XF.data&&M(de,Te,Le),delete Te.ixfe,delete Te.XF,c=de,h=_t(de),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),de.r<o.s.r&&(o.s.r=de.r),de.c<o.s.c&&(o.s.c=de.c),de.r+1>o.e.r&&(o.e.r=de.r+1),de.c+1>o.e.c&&(o.e.c=de.c+1),Le.cellFormula&&Te.f){for(var $e=0;$e<m.length;++$e)if(!(m[$e][0].s.c>de.c||m[$e][0].s.r>de.r)&&!(m[$e][0].e.c<de.c||m[$e][0].e.r<de.r)){Te.F=Kt(m[$e][0]),(m[$e][0].s.c!=de.c||m[$e][0].s.r!=de.r)&&delete Te.f,Te.f&&(Te.f=""+Vn(m[$e][1],o,de,w,N));break}}Le.dense?(i[de.r]||(i[de.r]=[]),i[de.r][de.c]=Te):i[h]=Te}},N={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:m,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(N.password=t.password);var B,K=[],Z=[],ie=[],me=[],k=!1,w=[];w.SheetNames=N.snames,w.sharedf=N.sharedf,w.arrayf=N.arrayf,w.names=[],w.XTI=[];var C=0,O=0,_=0,A=[],I=[],L;N.codepage=1200,lo(1200);for(var V=!1;e.l<e.length-1;){var Y=e.l,ae=e.read_shift(2);if(ae===0&&C===10)break;var re=e.l===e.length?0:e.read_shift(2),te=cN[ae];if(te&&te.f){if(t.bookSheets&&C===133&&ae!==133)break;if(C=ae,te.r===2||te.r==12){var ge=e.read_shift(2);if(re-=2,!N.enc&&ge!==ae&&((ge&255)<<8|ge>>8)!==ae)throw new Error("rt mismatch: "+ge+"!="+ae);te.r==12&&(e.l+=10,re-=10)}var H={};if(ae===10?H=te.f(e,re,N):H=$bt(ae,te,e,re,N),O==0&&[9,521,1033,2057].indexOf(C)===-1)continue;switch(ae){case 34:r.opts.Date1904=E.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(e.l=0),N.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=H;break;case 66:var Ce=Number(H);switch(Ce){case 21010:Ce=1200;break;case 32768:Ce=1e4;break;case 32769:Ce=1252;break}lo(N.codepage=Ce),V=!0;break;case 317:N.rrtabid=H;break;case 25:N.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:N.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:x.push(H);break;case 430:w.push([H]),w[w.length-1].XTI=[];break;case 35:case 547:w[w.length-1].push(H);break;case 24:case 536:L={Name:H.Name,Ref:Vn(H.rgce,o,null,w,N)},H.itab>0&&(L.Sheet=H.itab-1),w.names.push(L),w[0]||(w[0]=[],w[0].XTI=[]),w[w.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(I[H.itab-1]={ref:Kt(H.rgce[0][0][1][2])});break;case 22:N.ExternCount=H;break;case 23:w.length==0&&(w[0]=[],w[0].XTI=[]),w[w.length-1].XTI=w[w.length-1].XTI.concat(H),w.XTI=w.XTI.concat(H);break;case 2196:if(N.biff<8)break;L!=null&&(L.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&N.WTF&&console.error("Password verifier: "+H);break;case 133:a[H.pos]=H,N.snames.push(H.name);break;case 10:{if(--O)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=Kt(o),t.sheetRows&&t.sheetRows<=o.e.r){var oe=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Kt(o),o.e.r=oe}o.e.r++,o.e.c++}K.length>0&&(i["!merges"]=K),Z.length>0&&(i["!objects"]=Z),ie.length>0&&(i["!cols"]=ie),me.length>0&&(i["!rows"]=me),E.Sheets.push(P)}u===""?f=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),N.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(N.biff=5,V=!0,lo(N.codepage=28591)),N.biff==8&&H.BIFFVer==0&&H.dt==16&&(N.biff=2),O++)break;if(i=t.dense?[]:{},N.biff<8&&!V&&(V=!0,lo(N.codepage=t.codepage||1252)),N.biff<5||H.BIFFVer==0&&H.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Oe={pos:e.l-re,name:u};a[Oe.pos]=Oe,N.snames.push(u)}else u=(a[Y]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),K=[],Z=[],N.arrayf=m=[],ie=[],me=[],k=!1,P={Hidden:(a[Y]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[H.r]||[])[H.c]:i[_t({c:H.c,r:H.r})])&&++H.c,b={ixfe:H.ixfe,XF:x[H.ixfe]||{},v:H.val,t:"n"},_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 5:case 517:b={ixfe:H.ixfe,XF:x[H.ixfe],v:H.val,t:H.t},_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 638:b={ixfe:H.ixfe,XF:x[H.ixfe],v:H.rknum,t:"n"},_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 189:for(var Ee=H.c;Ee<=H.C;++Ee){var be=H.rkrec[Ee-H.c][0];b={ixfe:be,XF:x[be],v:H.rkrec[Ee-H.c][1],t:"n"},_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:Ee,r:H.r},b,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){s=H;break}if(b=G_(H.val,H.cell.ixfe,H.tt),b.XF=x[b.ixfe],t.cellFormula){var Ie=H.formula;if(Ie&&Ie[0]&&Ie[0][0]&&Ie[0][0][0]=="PtgExp"){var Me=Ie[0][0][1][0],j=Ie[0][0][1][1],U=_t({r:Me,c:j});y[U]?b.f=""+Vn(H.formula,o,H.cell,w,N):b.F=((t.dense?(i[Me]||[])[j]:i[U])||{}).F}else b.f=""+Vn(H.formula,o,H.cell,w,N)}_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D(H.cell,b,t),s=H}break;case 7:case 519:if(s)s.val=H,b=G_(H,s.cell.ixfe,"s"),b.XF=x[b.ixfe],t.cellFormula&&(b.f=""+Vn(s.formula,o,s.cell,w,N)),_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D(s.cell,b,t),s=null;else throw new Error("String record expects Formula");break;case 33:case 545:{m.push(H);var Q=_t(H[0].s);if(d=t.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[Q],t.cellFormula&&d){if(!s||!Q||!d)break;d.f=""+Vn(H[1],o,H[0],w,N),d.F=Kt(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!s)break;y[_t(s.cell)]=H[0],d=t.dense?(i[s.cell.r]||[])[s.cell.c]:i[_t(s.cell)],(d||{}).f=""+Vn(H[0],o,c,w,N)}}break;case 253:b=G_(l[H.isst].t,H.ixfe,"s"),l[H.isst].h&&(b.h=l[H.isst].h),b.XF=x[b.ixfe],_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:H.ixfe,XF:x[H.ixfe],t:"z"},_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t));break;case 190:if(t.sheetStubs)for(var fe=H.c;fe<=H.C;++fe){var ee=H.ixfe[fe-H.c];b={ixfe:ee,XF:x[ee],t:"z"},_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:fe,r:H.r},b,t)}break;case 214:case 516:case 4:b=G_(H.val,H.ixfe,"s"),b.XF=x[b.ixfe],_>0&&(b.z=A[b.ixfe>>8&63]),No(b,t,r.opts.Date1904),D({c:H.c,r:H.r},b,t);break;case 0:case 512:O===1&&(o=H);break;case 252:l=H;break;case 1054:if(N.biff==4){A[_++]=H[1];for(var pe=0;pe<_+163&&kt[pe]!=H[1];++pe);pe>=163&&Cc(H[1],_+163)}else Cc(H[1],H[0]);break;case 30:{A[_++]=H;for(var se=0;se<_+163&&kt[se]!=H;++se);se>=163&&Cc(H,_+163)}break;case 229:K=K.concat(H);break;case 93:Z[H.cmo[0]]=N.lastobj=H;break;case 438:N.lastobj.TxO=H;break;case 127:N.lastobj.ImData=H;break;case 440:for(g=H[0].s.r;g<=H[0].e.r;++g)for(p=H[0].s.c;p<=H[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[_t({c:p,r:g})],d&&(d.l=H[1]);break;case 2048:for(g=H[0].s.r;g<=H[0].e.r;++g)for(p=H[0].s.c;p<=H[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[_t({c:p,r:g})],d&&d.l&&(d.l.Tooltip=H[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;d=t.dense?(i[H[0].r]||[])[H[0].c]:i[_t(H[0])];var ue=Z[H[2]];d||(t.dense?(i[H[0].r]||(i[H[0].r]=[]),d=i[H[0].r][H[0].c]={t:"z"}):d=i[_t(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),d.c||(d.c=[]),v={a:H[1],t:ue.TxO.t},d.c.push(v)}break;case 2173:syt(x[H.ixfe],H.ext);break;case 125:{if(!N.cellStyles)break;for(;H.e>=H.s;)ie[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},k||(k=!0,KB(H.w/256)),hg(ie[H.e+1])}break;case 520:{var ce={};H.level!=null&&(me[H.r]=ce,ce.level=H.level),H.hidden&&(me[H.r]=ce,ce.hidden=!0),H.hpt&&(me[H.r]=ce,ce.hpt=H.hpt,ce.hpx=sw(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Im(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=H;break;case 161:i["!margins"]||Im(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(E.Views[0].RTL=!0);break;case 146:T=H;break;case 2198:B=H;break;case 140:S=H;break;case 442:u?P.CodeName=H||P.name:E.WBProps.CodeName=H||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=re}return r.SheetNames=ts(a).sort(function(ve,de){return Number(ve)-Number(de)}).map(function(ve){return a[ve].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&I.forEach(function(ve,de){r.Sheets[r.SheetNames[de]]["!autofilter"]=ve}),r.Strings=l,r.SSF=Dn(kt),N.enc&&(r.Encryption=N.enc),B&&(r.Themes=B),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),w.names.length>0&&(E.Names=w.names),r.Workbook=E,r}var oY={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Bbt(e,t,r){var n=Yt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=W9(n,nvt,oY.DSI);for(var a in i)t[a]=i[a]}catch(u){if(r.WTF)throw u}var o=Yt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=W9(o,ivt,oY.SI);for(var l in s)t[l]==null&&(t[l]=s[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(foe(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Yoe(e,t){t||(t={}),QB(t),Sae(),t.codepage&&PB(t.codepage);var r,n;if(e.FullPaths){if(Yt.find(e,"/encryption"))throw new Error("File is password-protected");r=Yt.find(e,"!CompObj"),n=Yt.find(e,"/Workbook")||Yt.find(e,"/Book")}else{switch(t.type){case"base64":e=ao(ia(e));break;case"binary":e=ao(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}In(e,0),n={content:e}}var i,a;if(r&&Lbt(r),t.bookProps&&!t.bookSheets)i={};else{var o=zt?"buffer":"array";if(n&&n.content)i=Hbt(n.content,t);else if((a=Yt.find(e,"PerfectOffice_MAIN"))&&a.content)i=Am.to_workbook(a.content,(t.type=o,t));else if((a=Yt.find(e,"NativeContent_MAIN"))&&a.content)i=Am.to_workbook(a.content,(t.type=o,t));else throw(a=Yt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Yt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=Tyt(e))}var s={};return e.FullPaths&&Bbt(e,s,t),i.Props=i.Custprops=s,t.bookFiles&&(i.cfb=e),i}var wT={0:{f:S0t},1:{f:T0t},2:{f:D0t},3:{f:k0t},4:{f:E0t},5:{f:M0t},6:{f:F0t},7:{f:P0t},8:{f:j0t},9:{f:V0t},10:{f:H0t},11:{f:B0t},12:{f:O0t},13:{f:N0t},14:{f:A0t},15:{f:R0t},16:{f:joe},17:{f:$0t},18:{f:I0t},19:{f:jB},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pbt},40:{},42:{},43:{f:Hgt},44:{f:$gt},45:{f:Bgt},46:{f:jgt},47:{f:Vgt},48:{},49:{f:Wdt},50:{},51:{f:uyt},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:_oe},62:{f:L0t},63:{f:vyt},64:{f:Z0t},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:q0t},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:x0t},148:{f:_0t,p:16},151:{f:z0t},152:{},153:{f:dbt},154:{},155:{},156:{f:hbt},157:{},158:{},159:{T:1,f:igt},160:{T:-1},161:{T:1,f:ph},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:W0t},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lyt},336:{T:-1},337:{f:fyt,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:oN},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Soe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:G0t},427:{f:Y0t},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:X0t},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:C0t},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:U0t},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:oN},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:_yt},633:{T:1},634:{T:-1},635:{T:1,f:Syt},636:{T:-1},637:{f:zdt},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:nbt},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:J0t},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},cN={6:{f:OA},10:{f:Ll},12:{f:dn},13:{f:dn},14:{f:en},15:{f:en},16:{f:Un},17:{f:en},18:{f:en},19:{f:dn},20:{f:Y9},21:{f:Y9},23:{f:Soe},24:{f:X9},25:{f:en},26:{},27:{},28:{f:bpt},29:{},34:{f:en},35:{f:K9},38:{f:Un},39:{f:Un},40:{f:Un},41:{f:Un},42:{f:en},43:{f:en},47:{f:Cgt},49:{f:ept},51:{f:dn},60:{},61:{f:Zvt},64:{f:en},65:{f:Qvt},66:{f:dn},77:{},80:{},81:{},82:{},85:{f:dn},89:{},90:{},91:{},92:{f:Wvt},93:{f:Spt},94:{},95:{f:en},96:{},97:{},99:{f:en},125:{f:_oe},128:{f:fpt},129:{f:Uvt},130:{f:dn},131:{f:en},132:{f:en},133:{f:zvt},134:{},140:{f:Ept},141:{f:dn},144:{},146:{f:kpt},151:{},152:{},153:{},154:{},155:{},156:{f:dn},157:{},158:{},160:{f:Dpt},161:{f:Ppt},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:opt},190:{f:spt},193:{f:Ll},197:{},198:{},199:{},200:{},201:{},202:{f:en},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:dn},220:{},221:{f:en},222:{},224:{f:upt},225:{f:jvt},226:{f:Ll},227:{},229:{f:wpt},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Gvt},253:{f:tpt},255:{f:Yvt},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:poe},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:en},353:{f:Ll},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:hpt},431:{f:en},432:{},433:{},434:{},437:{},438:{f:xpt},439:{f:en},440:{f:Tpt},441:{},442:{f:bS},443:{},444:{f:dn},445:{},446:{},448:{f:Ll},449:{f:qvt,r:2},450:{f:Ll},512:{f:z9},513:{f:Mpt},515:{f:cpt},516:{f:rpt},517:{f:G9},519:{f:Npt},520:{f:Kvt},523:{},545:{f:q9},549:{f:U9},566:{},574:{f:Jvt},638:{f:apt},659:{},1048:{},1054:{f:npt},1084:{},1212:{f:gpt},2048:{f:Opt},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:W_},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ll},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Apt,r:12},2173:{f:oyt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:en,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ppt,r:12},2197:{},2198:{f:eyt,r:12},2199:{},2200:{},2201:{},2202:{f:ypt,r:12},2203:{f:Ll},2204:{},2205:{},2206:{},2207:{},2211:{f:Xvt},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:dn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Ipt},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Rpt},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:z9},1:{},2:{f:Hpt},3:{f:$pt},4:{f:Fpt},5:{f:G9},7:{f:Bpt},8:{},9:{f:W_},11:{},22:{f:dn},30:{f:ipt},31:{},32:{},33:{f:q9},36:{},37:{f:U9},50:{f:Vpt},62:{},52:{},67:{},68:{f:dn},69:{},86:{},126:{},127:{f:Lpt},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:jpt},223:{},234:{},354:{},421:{},518:{f:OA},521:{f:W_},536:{f:X9},547:{f:K9},561:{},579:{},1030:{f:OA},1033:{f:W_},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ga(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&roe(r)&&e.push(r)}}function sY(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,s=a&&a.index||e.length,l=hdt(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,c=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(o=0;o<l.length;++o){var p=l[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var y=p.split(/<\/t[dh]>/i);for(s=0;s<y.length;++s){var m=y[s].trim();if(m.match(/<t[dh]/i)){for(var b=m,S=0;b.charAt(0)=="<"&&(S=b.indexOf(">"))>-1;)b=b.slice(S+1);for(var x=0;x<v.length;++x){var T=v[x];T.s.c==f&&T.s.r<u&&u<=T.e.r&&(f=T.e.c+1,x=-1)}var E=mt(m.slice(0,m.indexOf(">")));h=E.colspan?+E.colspan:1,((c=+E.rowspan)>1||h>1)&&v.push({s:{r:u,c:f},e:{r:u+(c||1)-1,c:f+h-1}});var P=E.t||E["data-t"]||"";if(!b.length){f+=h;continue}if(b=Wae(b),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!b.length){f+=h;continue}var R={t:"s",v:b};r.raw||!b.trim().length||P=="s"||(b==="TRUE"?R={t:"b",v:!0}:b==="FALSE"?R={t:"b",v:!1}:isNaN(vo(b))?isNaN(cg(b).getDate())||(R={t:"d",v:Rn(b)},r.cellDates||(R={t:"n",v:wi(R.v)}),R.z=r.dateNF||kt[14]):R={t:"n",v:vo(b)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=R):n[_t({r:u,c:f})]=R,f+=h}}}}return n["!ref"]=Kt(d),v.length&&(n["!merges"]=v),n}function Vbt(e,t,r,n){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){s=-1;break}s=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(s<0)){var f=_t({r,c:o}),c=n.dense?(e[r]||[])[o]:e[f],h=c&&c.v!=null&&(c.h||FB(c.w||(pl(c),c.w)||""))||"",d={};s>1&&(d.rowspan=s),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":c&&(d["data-t"]=c&&c.t||"z",c.v!=null&&(d["data-v"]=c.v),c.z!=null&&(d["data-z"]=c.z),c.l&&(c.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+c.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+f,a.push(Edt("td",h,d))}}var v="<tr>";return v+a.join("")+"</tr>"}var jbt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Wbt="</body></html>";function Ubt(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Gu(sY(r[0],t),t);var n=t3();return r.forEach(function(i,a){r3(n,sY(i,t),"Sheet"+(a+1))}),n}function zbt(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Gbt(e,t){var r=t||{},n=r.header!=null?r.header:jbt,i=r.footer!=null?r.footer:Wbt,a=[n],o=Dg(e["!ref"]);r.dense=Array.isArray(e),a.push(zbt(e,o,r));for(var s=o.s.r;s<=o.e.r;++s)a.push(Vbt(e,o,s,r));return a.push("</table>"+i),a.join("")}function Koe(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?gi(n.origin):n.origin;i=o.r,a=o.c}var s=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),u={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var f=Dg(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var c=[],h=0,d=e["!rows"]||(e["!rows"]=[]),v=0,p=0,g=0,y=0,m=0,b=0;for(e["!cols"]||(e["!cols"]=[]);v<s.length&&p<l;++v){var S=s[v];if(lY(S)){if(n.display)continue;d[p]={hidden:!0}}var x=S.children;for(g=y=0;g<x.length;++g){var T=x[g];if(!(n.display&&lY(T))){var E=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):Wae(T.innerHTML),P=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<c.length;++h){var R=c[h];R.s.c==y+a&&R.s.r<p+i&&p+i<=R.e.r&&(y=R.e.c+1-a,h=-1)}b=+T.getAttribute("colspan")||1,((m=+T.getAttribute("rowspan")||1)>1||b>1)&&c.push({s:{r:p+i,c:y+a},e:{r:p+i+(m||1)-1,c:y+a+(b||1)-1}});var M={t:"s",v:E},D=T.getAttribute("data-t")||T.getAttribute("t")||"";E!=null&&(E.length==0?M.t=D||"z":n.raw||E.trim().length==0||D=="s"||(E==="TRUE"?M={t:"b",v:!0}:E==="FALSE"?M={t:"b",v:!1}:isNaN(vo(E))?isNaN(cg(E).getDate())||(M={t:"d",v:Rn(E)},n.cellDates||(M={t:"n",v:wi(M.v)}),M.z=n.dateNF||kt[14]):M={t:"n",v:vo(E)})),M.z===void 0&&P!=null&&(M.z=P);var N="",B=T.getElementsByTagName("A");if(B&&B.length)for(var K=0;K<B.length&&!(B[K].hasAttribute("href")&&(N=B[K].getAttribute("href"),N.charAt(0)!="#"));++K);N&&N.charAt(0)!="#"&&(M.l={Target:N}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][y+a]=M):e[_t({c:y+a,r:p+i})]=M,u.e.c<y+a&&(u.e.c=y+a),y+=b}}++p}return c.length&&(e["!merges"]=(e["!merges"]||[]).concat(c)),u.e.r=Math.max(u.e.r,p-1+i),e["!ref"]=Kt(u),p>=l&&(e["!fullref"]=Kt((u.e.r=s.length-v+p-1+i,u))),e}function Xoe(e,t){var r=t||{},n=r.dense?[]:{};return Koe(n,e,t)}function Ybt(e,t){return Gu(Xoe(e,t),t)}function lY(e){var t="",r=Kbt(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Kbt(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Xbt(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Qt(t.replace(/<[^>]*>/g,""));return[r]}var uY={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qoe(e,t){var r=t||{},n=$B(e),i=[],a,o,s={name:""},l="",u=0,f,c,h={},d=[],v=r.dense?[]:{},p,g,y={value:""},m="",b=0,S=[],x=-1,T=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,R={},M=[],D={},N=0,B=0,K=[],Z=1,ie=1,me=[],k={Names:[]},w={},C=["",""],O=[],_={},A="",I=0,L=!1,V=!1,Y=0;for(iw.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=iw.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"å·¥ä½è¡¨":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?v["!ref"]=Kt(E):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(v["!fullref"]=v["!ref"],E.e.r=r.sheetRows-1,v["!ref"]=Kt(E)),M.length&&(v["!merges"]=M),K.length&&(v["!rows"]=K),f.name=f.åç§°||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),h[f.name]=v,V=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=mt(p[0],!1),x=T=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,v=r.dense?[]:{},M=[],K=[],V=!0);break;case"table-row-group":p[1]==="/"?--P:++P;break;case"table-row":case"è¡":if(p[1]==="/"){x+=Z,Z=1;break}if(c=mt(p[0],!1),c.è¡å·?x=c.è¡å·-1:x==-1&&(x=0),Z=+c["number-rows-repeated"]||1,Z<10)for(Y=0;Y<Z;++Y)P>0&&(K[x+Y]={level:P});T=-1;break;case"covered-table-cell":p[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(v[x]||(v[x]=[]),v[x][T]={t:"z"}):v[_t({r:x,c:T})]={t:"z"}),m="",S=[];break;case"table-cell":case"æ°æ®":if(p[0].charAt(p[0].length-2)==="/")++T,y=mt(p[0],!1),ie=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=nY(Qt(y.formula))),(y.æ°æ®ç±»å||y["value-type"])=="string"&&(g.t="s",g.v=Qt(y["string-value"]||""),r.dense?(v[x]||(v[x]=[]),v[x][T]=g):v[_t({r:x,c:T})]=g),T+=ie-1;else if(p[1]!=="/"){++T,m="",b=0,S=[],ie=1;var ae=Z?x+Z-1:x;if(T>E.e.c&&(E.e.c=T),T<E.s.c&&(E.s.c=T),x<E.s.r&&(E.s.r=x),ae>E.e.r&&(E.e.r=ae),y=mt(p[0],!1),O=[],_={},g={t:y.æ°æ®ç±»å||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Qt(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(N=parseInt(y["number-matrix-rows-spanned"],10)||0,B=parseInt(y["number-matrix-columns-spanned"],10)||0,D={s:{r:x,c:T},e:{r:x+N-1,c:T+B-1}},g.F=Kt(D),me.push([D,g.F])),y.formula)g.f=nY(y.formula);else for(Y=0;Y<me.length;++Y)x>=me[Y][0].s.r&&x<=me[Y][0].e.r&&T>=me[Y][0].s.c&&T<=me[Y][0].e.c&&(g.F=me[Y][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(N=parseInt(y["number-rows-spanned"],10)||0,B=parseInt(y["number-columns-spanned"],10)||0,D={s:{r:x,c:T},e:{r:x+N-1,c:T+B-1}},M.push(D)),y["number-columns-repeated"]&&(ie=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Dr(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=Rn(y["date-value"]),r.cellDates||(g.t="n",g.v=wi(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=udt(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=fE(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.æ°æ®æ°å¼);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(m=Qt(y["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(L=!1,g.t==="s"&&(g.v=m||"",S.length&&(g.R=S),L=b==0),w.Target&&(g.l=w),O.length>0&&(g.c=O,O=[]),m&&r.cellText!==!1&&(g.w=m),L&&(g.t="z",delete g.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=x))for(var re=0;re<Z;++re){if(ie=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(v[x+re]||(v[x+re]=[]),v[x+re][T]=re==0?g:Dn(g);--ie>0;)v[x+re][T+ie]=Dn(g);else for(v[_t({r:x+re,c:T})]=g;--ie>0;)v[_t({r:x+re,c:T+ie})]=Dn(g);E.e.c<=T&&(E.e.c=T)}ie=parseInt(y["number-columns-repeated"]||"1",10),T+=ie-1,ie=0,g={},m="",S=[]}w={};break;case"document":case"document-content":case"çµå­è¡¨æ ¼ææ¡£":case"spreadsheet":case"ä¸»ä½":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a;_.t=m,S.length&&(_.R=S),_.a=A,O.push(_)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);A="",I=0,m="",b=0,S=[];break;case"creator":p[1]==="/"?A=n.slice(I,p.index):I=p.index+p[0].length;break;case"meta":case"åæ°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);m="",b=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(R[s.name]=l,(a=i.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(l="",s=mt(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=mt(p[0],!1),l+=uY[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=mt(p[0],!1),l+=uY[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=mt(p[0],!1),C=EA(o["cell-range-address"]);var te={Name:o.name,Ref:C[0]+"!"+C[1]};V&&(te.Sheet=d.length),k.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"çµå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"ææ¬ä¸²":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var ge=Xbt(n.slice(b,p.index));m=(m.length>0?m+`
`:"")+ge[0]}else mt(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{C=EA(mt(p[0])["target-range-address"]),h[C[0]]["!autofilter"]={ref:C[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ é¢":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(w=mt(p[0],!1),!w.href)break;w.Target=Qt(w.href),delete w.href,w.Target.charAt(0)=="#"&&w.Target.indexOf(".")>-1?(C=EA(w.Target.slice(1)),w.Target="#"+C[0]+"!"+C[1]):w.Target.match(/^\.\.[\\\/]/)&&(w.Target=w.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­:":break;default:if(r.WTF)throw new Error(p)}}var H={Sheets:h,SheetNames:d,Workbook:k};return r.bookSheets&&delete H.Sheets,H}function fY(e,t){t=t||{},ga(e,"META-INF/manifest.xml")&&cvt(hn(e,"META-INF/manifest.xml"),t);var r=Zi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=qoe(Tr(r),t);return ga(e,"meta.xml")&&(n.Props=uoe(hn(e,"meta.xml"))),n}function cY(e,t){return qoe(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ZB(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function hN(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Tr(dh(e))}function dN(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function hY(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function qbt(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function lw(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function _n(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=lw(e,r),a=i&7;i=Math.floor(i/8);var o=0,s;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);s=e.slice(l,r[0])}break;case 5:o=4,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=lw(e,r),s=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var u={data:s,type:a};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function JB(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Zbt(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=lw(e,n),a=zn(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:_n(a[1][0].data),messages:[]};a[2].forEach(function(s){var l=zn(s.data),u=_n(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(o.merge=_n(a[3][0].data)>>>0>0),r.push(o)}return r}function Jbt(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=lw(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var s=o-59;o=t[r[0]],s>1&&(o|=t[r[0]+1]<<8),s>2&&(o|=t[r[0]+2]<<16),s>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=s}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[dN(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=dN(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Qbt(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Jbt(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return dN(t)}function ewt(e,t,r,n){var i=ZB(e),a=i.getUint32(4,!0),o=(n>1?12:8)+hY(a&(n>1?3470:398))*4,s=-1,l=-1,u=NaN,f=new Date(2001,0,1);a&512&&(s=i.getUint32(o,!0),o+=4),o+=hY(a&(n>1?12288:4096))*4,a&16&&(l=i.getUint32(o,!0),o+=4),a&32&&(u=i.getFloat64(o,!0),o+=8),a&64&&(f.setTime(f.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var c;switch(e[2]){case 0:break;case 2:c={t:"n",v:u};break;case 3:c={t:"s",v:t[l]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(s>-1)c={t:"s",v:r[s]};else if(l>-1)c={t:"s",v:t[l]};else if(!isNaN(u))c={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return c}function twt(e,t,r){var n=ZB(e),i=n.getUint32(8,!0),a=12,o=-1,s=-1,l=NaN,u=NaN,f=new Date(2001,0,1);i&1&&(l=qbt(e,a),a+=16),i&2&&(u=n.getFloat64(a,!0),a+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(s=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var c;switch(e[1]){case 0:break;case 2:c={t:"n",v:l};break;case 3:c={t:"s",v:t[s]};break;case 5:c={t:"d",v:f};break;case 6:c={t:"b",v:u>0};break;case 7:c={t:"n",v:u/86400};break;case 8:c={t:"e",v:0};break;case 9:if(o>-1)c={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:c={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return c}function rwt(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return ewt(e,t,r,e[0]);case 5:return twt(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function xu(e){var t=zn(e);return lw(t[1][0].data)}function dY(e,t){var r=zn(t.data),n=_n(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var s=zn(o.data),l=_n(s[1][0].data)>>>0;switch(n){case 1:a[l]=hN(s[3][0].data);break;case 8:{var u=e[xu(s[9][0].data)][0],f=zn(u.data),c=e[xu(f[1][0].data)][0],h=_n(c.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=zn(c.data);a[l]=d[3].map(function(v){return hN(v.data)}).join("")}break}}),a}function nwt(e,t){var r,n,i,a,o,s,l,u,f,c,h,d,v,p,g=zn(e),y=_n(g[1][0].data)>>>0,m=_n(g[2][0].data)>>>0,b=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&_n(g[8][0].data)>0||!1,S,x;if((a=(i=g[7])==null?void 0:i[0])!=null&&a.data&&t!=0)S=(s=(o=g[7])==null?void 0:o[0])==null?void 0:s.data,x=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((c=(f=g[4])==null?void 0:f[0])!=null&&c.data&&t!=1)S=(d=(h=g[4])==null?void 0:h[0])==null?void 0:d.data,x=(p=(v=g[3])==null?void 0:v[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=b?4:1,E=ZB(S),P=[],R=0;R<S.length/2;++R){var M=E.getUint16(R*2,!0);M<65535&&P.push([R,M])}if(P.length!=m)throw"Expected ".concat(m," cells, found ").concat(P.length);var D=[];for(R=0;R<P.length-1;++R)D[P[R][0]]=x.subarray(P[R][1]*T,P[R+1][1]*T);return P.length>=1&&(D[P[P.length-1][0]]=x.subarray(P[P.length-1][1]*T)),{R:y,cells:D}}function iwt(e,t){var r,n=zn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?_n(n[7][0].data)>>>0>0?1:0:-1,a=JB(n[5],function(o){return nwt(o,i)});return{nrows:_n(n[4][0].data)>>>0,data:a.reduce(function(o,s){return o[s.R]||(o[s.R]=[]),s.cells.forEach(function(l,u){if(o[s.R][u])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(u));o[s.R][u]=l}),o},[])}}function awt(e,t,r){var n,i=zn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(_n(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(_n(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Kt(a);var o=zn(i[4][0].data),s=dY(e,e[xu(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?dY(e,e[xu(o[17][0].data)][0]):[],u=zn(o[3][0].data),f=0;u[1].forEach(function(c){var h=zn(c.data),d=e[xu(h[2][0].data)][0],v=_n(d.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var p=iwt(e,d);p.data.forEach(function(g,y){g.forEach(function(m,b){var S=_t({r:f+y,c:b}),x=rwt(m,s,l);x&&(r[S]=x)})}),f+=p.nrows})}function owt(e,t){var r=zn(t.data),n={"!ref":"A1"},i=e[xu(r[2][0].data)],a=_n(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return awt(e,i[0],n),n}function swt(e,t){var r,n=zn(t.data),i={name:(r=n[1])!=null&&r[0]?hN(n[1][0].data):"",sheets:[]},a=JB(n[2],xu);return a.forEach(function(o){e[o].forEach(function(s){var l=_n(s.meta[1][0].data);l==6e3&&i.sheets.push(owt(e,s))})}),i}function lwt(e,t){var r=t3(),n=zn(t.data),i=JB(n[1],xu);if(i.forEach(function(a){e[a].forEach(function(o){var s=_n(o.meta[1][0].data);if(s==2){var l=swt(e,o);l.sheets.forEach(function(u,f){r3(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function kA(e){var t,r,n,i,a={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Qbt(l.content)}catch(c){return console.log("?? "+l.content.length+" "+(c.message||c))}var f;try{f=Zbt(u)}catch(c){return console.log("## "+(c.message||c))}f.forEach(function(c){a[c.id]=c.messages,o.push(c.id)})}}),!o.length)throw new Error("File has no messages");var s=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&_n(a[1][0].meta[1][0].data)==1&&a[1][0];if(s||o.forEach(function(l){a[l].forEach(function(u){var f=_n(u.meta[1][0].data)>>>0;if(f==1)if(!s)s=u;else throw new Error("Document has multiple roots")})}),!s)throw new Error("Cannot find Document root");return lwt(a,s)}function uwt(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function QB(e){uwt([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fwt(e){return Od.WS.indexOf(e)>-1?"sheet":e==Od.CS?"chart":e==Od.DS?"dialog":e==Od.MS?"macro":e&&e.length?e:"sheet"}function cwt(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,fwt(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function hwt(e,t,r,n,i,a,o,s,l,u,f,c){try{a[n]=Rm(Zi(e,r,!0),t);var h=hn(e,t),d;switch(s){case"sheet":d=mbt(h,t,i,l,a[n],u,f,c);break;case"chart":if(d=bbt(h,t,i,l,a[n],u,f,c),!d||!d["!drawel"])break;var v=qy(d["!drawel"].Target,t),p=sN(v),g=yyt(Zi(e,v,!0),Rm(Zi(e,p,!0),v)),y=qy(g,v),m=sN(y);d=tbt(Zi(e,y,!0),y,l,Rm(Zi(e,m,!0),y),u,d);break;case"macro":d=wbt(h,t,i,l,a[n],u,f,c);break;case"dialog":d=Sbt(h,t,i,l,a[n],u,f,c);break;default:throw new Error("Unrecognized sheet type "+s)}o[n]=d;var b=[];a&&a[n]&&ts(a[n]).forEach(function(S){var x="";if(a[n][S].Type==Od.CMNT){x=qy(a[n][S].Target,t);var T=Tbt(hn(e,x,!0),x,l);if(!T||!T.length)return;J9(d,T,!1)}a[n][S].Type==Od.TCMNT&&(x=qy(a[n][S].Target,t),b=b.concat(byt(hn(e,x,!0),l)))}),b&&b.length&&J9(d,b,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function ca(e){return e.charAt(0)=="/"?e.slice(1):e}function dwt(e,t){if(Mae(),t=t||{},QB(t),ga(e,"META-INF/manifest.xml")||ga(e,"objectdata.xml"))return fY(e,t);if(ga(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof kA<"u"){if(e.FileIndex)return kA(e);var r=Yt.utils.cfb_new();return T9(e).forEach(function(K){vdt(r,K,Hae(e,K))}),kA(r)}throw new Error("Unsupported NUMBERS file")}if(!ga(e,"[Content_Types].xml"))throw ga(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ga(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=T9(e),i=uvt(Zi(e,"[Content_Types].xml")),a=!1,o,s;if(i.workbooks.length===0&&(s="xl/workbook.xml",hn(e,s,!0)&&i.workbooks.push(s)),i.workbooks.length===0){if(s="xl/workbook.bin",!hn(e,s,!0))throw new Error("Could not find workbook");i.workbooks.push(s),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Pm=[],i.sst)try{Pm=xbt(hn(e,ca(i.sst)),i.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&i.themes.length&&(l=Cbt(Zi(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=_bt(hn(e,ca(i.style)),i.style,l,t))}i.links.map(function(K){try{var Z=Rm(Zi(e,sN(ca(K))),K);return Ebt(hn(e,ca(K)),Z,K,t)}catch{}});var f=ybt(hn(e,ca(i.workbooks[0])),i.workbooks[0],t),c={},h="";i.coreprops.length&&(h=hn(e,ca(i.coreprops[0]),!0),h&&(c=uoe(h)),i.extprops.length!==0&&(h=hn(e,ca(i.extprops[0]),!0),h&&vvt(h,c,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Zi(e,ca(i.custprops[0]),!0),h&&(d=gvt(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?o=f.Sheets.map(function(Z){return Z.name}):c.Worksheets&&c.SheetNames.length>0&&(o=c.SheetNames),t.bookProps&&(v.Props=c,v.Custprops=d),t.bookSheets&&typeof o<"u"&&(v.SheetNames=o),t.bookSheets?v.SheetNames:t.bookProps))return v;o={};var p={};t.bookDeps&&i.calcchain&&(p=Obt(hn(e,ca(i.calcchain)),i.calcchain));var g=0,y={},m,b;{var S=f.Sheets;c.Worksheets=S.length,c.SheetNames=[];for(var x=0;x!=S.length;++x)c.SheetNames[x]=S[x].name}var T=a?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");ga(e,P)||(P="xl/_rels/workbook."+T+".rels");var R=Rm(Zi(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Rbt(hn(e,ca(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=wyt(hn(e,ca(i.people[0])),t)),R&&(R=cwt(R,f.Sheets));var M=hn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=c.Worksheets;++g){var D="sheet";if(R&&R[g]?(m="xl/"+R[g][1].replace(/[\/]?xl\//,""),ga(e,m)||(m=R[g][1]),ga(e,m)||(m=P.replace(/_rels\/.*$/,"")+R[g][1]),D=R[g][2]):(m="xl/worksheets/sheet"+(g+1-M)+"."+T,m=m.replace(/sheet0\./,"sheet.")),b=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(c.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var N=!1,B=0;B!=t.sheets.length;++B)typeof t.sheets[B]=="number"&&t.sheets[B]==g&&(N=1),typeof t.sheets[B]=="string"&&t.sheets[B].toLowerCase()==c.SheetNames[g].toLowerCase()&&(N=1);if(!N)continue e}}hwt(e,m,b,c.SheetNames[g],g,y,o,D,t,f,l,u)}return v={Directory:i,Workbook:f,Props:c,Custprops:d,Deps:p,Sheets:o,SheetNames:c.SheetNames,Strings:Pm,Styles:u,Themes:l,SSF:Dn(kt)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(K,Z){K=K.replace(/^Root Entry[\/]/,""),v.keys.push(K),v.files[K]=e.FileIndex[Z]}))),t&&t.bookVBA&&(i.vba.length>0?v.vbaraw=hn(e,ca(i.vba[0]),!0):i.defaults&&i.defaults.bin===xyt&&(v.vbaraw=hn(e,"xl/vbaProject.bin",!0))),v}function vwt(e,t){var r=t||{},n="Workbook",i=Yt.find(e,n);try{if(n="/!DataSpaces/Version",i=Yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ogt(i.content),n="/!DataSpaces/DataSpaceMap",i=Yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=lgt(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ugt(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);cgt(i.content)}catch{}if(n="/EncryptionInfo",i=Yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=hgt(i.content);if(n="/EncryptedPackage",i=Yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(s[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(s[1],i.content,r.password||"",r);if(s[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(s[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function e3(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ia(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function pwt(e,t){return Yt.find(e,"EncryptedPackage")?vwt(e,t):Yoe(e,t)}function gwt(e,t){var r,n=e,i=t||{};return i.type||(i.type=zt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Bae(n,i),dwt(r,i)}function Zoe(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return fN(e.slice(r),t);default:break e}return aw.to_workbook(e,t)}function ywt(e,t){var r="",n=e3(e,t);switch(t.type){case"base64":r=ia(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Uc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Tr(r)),t.type="binary",Zoe(r,t)}function mwt(e,t){var r=e;return t.type=="base64"&&(r=ia(r)),r=Zl.utils.decode(1200,r.slice(2),"str"),t.type="binary",Zoe(r,t)}function bwt(e){return e.match(/[^\x00-\x7F]/)?Zy(e):e}function AA(e,t,r,n){return n?(r.type="string",aw.to_workbook(e,r)):aw.to_workbook(t,r)}function vN(e,t){Sae();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return vN(new Uint8Array(e),(r=Dn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xd={},r.dateNF&&(Xd.dateNF=r.dateNF),r.type||(r.type=zt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=zt?"buffer":"binary",n=sdt(e),typeof Uint8Array<"u"&&!zt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=bwt(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return r=Dn(r),r.type="array",vN(IB(n),r)}switch((i=e3(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return pwt(Yt.read(n,r),r);break;case 9:if(i[1]<=8)return Yoe(n,r);break;case 60:return fN(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Ypt(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return zpt.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?gwt(n,r):AA(e,n,r,a);case 239:return i[3]===60?fN(n,r):AA(e,n,r,a);case 255:if(i[1]===254)return mwt(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Am.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Am.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Z9.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return xgt.to_workbook(n,r);break;case 10:case 13:case 32:return ywt(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Wpt.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Z9.to_workbook(n,r):AA(e,n,r,a)}function wwt(e,t,r,n,i,a,o,s){var l=Nn(r),u=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),c=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=o?e[r][d]:e[n[d]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;a[d]!=null&&(h[a[d]]=u);continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[d]!=null){if(p==null)if(v.t=="e"&&p===null)h[a[d]]=null;else if(u!==void 0)h[a[d]]=u;else if(f&&p===null)h[a[d]]=null;else continue;else h[a[d]]=f&&(v.t!=="n"||v.t==="n"&&s.rawNumbers!==!1)?p:pl(v,p,s);p!=null&&(c=!1)}}return{row:h,isempty:c}}function pN(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Xr(f);break;case"number":l=Xr(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var c=Nn(l.s.r),h=[],d=[],v=0,p=0,g=Array.isArray(e),y=l.s.r,m=0,b={};g&&!e[y]&&(e[y]=[]);var S=u.skipHidden&&e["!cols"]||[],x=u.skipHidden&&e["!rows"]||[];for(m=l.s.c;m<=l.e.c;++m)if(!(S[m]||{}).hidden)switch(h[m]=wn(m),r=g?e[y][m]:e[h[m]+c],n){case 1:a[m]=m-l.s.c;break;case 2:a[m]=h[m];break;case 3:a[m]=u.header[m-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),s=o=pl(r,null,u),p=b[o]||0,!p)b[o]=1;else{do s=o+"_"+p++;while(b[s]);b[o]=p,b[s]=1}a[m]=s}for(y=l.s.r+i;y<=l.e.r;++y)if(!(x[y]||{}).hidden){var T=wwt(e,l,y,h,n,a,g,u);(T.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[v++]=T.row)}return d.length=v,d}var vY=/"/g;function Swt(e,t,r,n,i,a,o,s){for(var l=!0,u=[],f="",c=Nn(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=s.dense?(e[r]||[])[h]:e[n[h]+c];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(s.rawNumbers&&d.t=="n"?d.v:pl(d,null,s));for(var v=0,p=0;v!==f.length;++v)if((p=f.charCodeAt(v))===i||p===a||p===34||s.forceQuotes){f='"'+f.replace(vY,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(vY,'""')+'"')):f="";u.push(f)}return s.blankrows===!1&&l?null:u.join(o)}function Joe(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Xr(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),s=n.RS!==void 0?n.RS:`
`,l=s.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",c=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(h[v]||{}).hidden||(c[v]=wn(v));for(var p=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(f=Swt(e,i,g,c,o,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((p++?s:"")+f)));return delete n.dense,r.join("")}function _wt(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Joe(e,t);return r}function Cwt(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Xr(e["!ref"]),a="",o=[],s,l=[],u=Array.isArray(e);for(s=i.s.c;s<=i.e.c;++s)o[s]=wn(s);for(var f=i.s.r;f<=i.e.r;++f)for(a=Nn(f),s=i.s.c;s<=i.e.c;++s)if(t=o[s]+a,r=u?(e[f]||[])[s]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function Qoe(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},o=0,s=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?gi(n.origin):n.origin;o=l.r,s=l.c}var u,f={s:{c:0,r:0},e:{c:s,r:o+t.length-1+i}};if(a["!ref"]){var c=Xr(a["!ref"]);f.e.c=Math.max(f.e.c,c.e.c),f.e.r=Math.max(f.e.r,c.e.r),o==-1&&(o=c.e.r+1,f.e.r=o+t.length-1+i)}else o==-1&&(o=0,f.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(p,g){ts(p).forEach(function(y){(d=h.indexOf(y))==-1&&(h[d=h.length]=y);var m=p[y],b="z",S="",x=_t({c:s+d,r:o+g+i});u=uw(a,x),m&&typeof m=="object"&&!(m instanceof Date)?a[x]=m:(typeof m=="number"?b="n":typeof m=="boolean"?b="b":typeof m=="string"?b="s":m instanceof Date?(b="d",n.cellDates||(b="n",m=wi(m)),S=n.dateNF||kt[14]):m===null&&n.nullError&&(b="e",m=0),u?(u.t=b,u.v=m,delete u.w,delete u.R,S&&(u.z=S)):a[x]=u={t:b,v:m},S&&(u.z=S))})}),f.e.c=Math.max(f.e.c,s+h.length-1);var v=Nn(o);if(i)for(d=0;d<h.length;++d)a[wn(d+s)+v]={t:"s",v:h[d]};return a["!ref"]=Kt(f),a}function xwt(e,t){return Qoe(null,e,t)}function uw(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=gi(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?uw(e,_t(t)):uw(e,_t({r:t,c:r||0}))}function Twt(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function t3(){return{SheetNames:[],Sheets:{}}}function r3(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(ubt(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Owt(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Twt(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Ewt(e,t){return e.z=t,e}function ese(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Rwt(e,t,r){return ese(e,"#"+t,r)}function kwt(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Awt(e,t,r,n){for(var i=typeof t!="string"?t:Xr(t),a=typeof t=="string"?t:Kt(t),o=i.s.r;o<=i.e.r;++o)for(var s=i.s.c;s<=i.e.c;++s){var l=uw(e,o,s);l.t="n",l.F=a,delete l.v,o==i.s.r&&s==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var pY={encode_col:wn,encode_row:Nn,encode_cell:_t,encode_range:Kt,decode_col:VB,decode_row:BB,split_cell:jdt,decode_cell:gi,decode_range:Dg,format_cell:pl,sheet_add_aoa:ioe,sheet_add_json:Qoe,sheet_add_dom:Koe,aoa_to_sheet:Ng,json_to_sheet:xwt,table_to_sheet:Xoe,table_to_book:Ybt,sheet_to_csv:Joe,sheet_to_txt:_wt,sheet_to_json:pN,sheet_to_html:Gbt,sheet_to_formulae:Cwt,sheet_to_row_object_array:pN,sheet_get_cell:uw,book_new:t3,book_append_sheet:r3,book_set_sheet_visibility:Owt,cell_set_number_format:Ewt,cell_set_hyperlink:ese,cell_set_internal_link:Rwt,cell_add_comment:kwt,sheet_set_array_formula:Awt,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const fs=Symbol("CHART");function xl(e,t){const r=By(e,t);if(!r)throw new Error(`Could not resolve ${e.description}`);return r}const Pwt={class:"table-wrapper"},Iwt={class:"toolbar"},Mwt={class:"left"},Dwt={class:"table-box"},Nwt=_i({__name:"dataTable",setup(e){bae();const t=Mn(null),r=to(()=>{var l;return((l=n==null?void 0:n.value.config)==null?void 0:l.data)||null}),n=xl(fs);jf(()=>r.value,()=>{t.value.hotInstance.updateData(Qi.cloneDeep(r.value))},{deep:!0});const i=()=>{WC(()=>{const u=t.value.hotInstance.getSourceData().map(c=>c.filter(h=>h!==null)).filter(c=>c.length);console.log(JSON.stringify(u));const f=Qi.isEqual(u,r.value);if(r.value&&!f&&u.length){const c=Qi.cloneDeep(n==null?void 0:n.value);c.config.data=u,Oa.emit("updateChart",c)}})},a=l=>{try{const u=new FileReader;u.onload=f=>{const c=f.target.result,h=vN(c,{type:"binary"}),d=h.Sheets[h.SheetNames[0]],v=pY.decode_range(d["!ref"]);var p=[];for(let g=v.s.r;g<=v.e.r;g++){let y=p.length;p.push([]);for(let m=v.s.c;m<=v.e.c;m++){let b=d[pY.encode_cell({r:g,c:m})];b&&p[y].push(b.v)}}t.value.hotInstance.updateData(p),Ace.success("å¯¼åºæå")},u.readAsBinaryString(l)}catch(u){console.log("err: ",u)}return!1},o=()=>{t.value.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:n==null?void 0:n.value.name})};Jc(()=>{r.value&&t.value.hotInstance.updateData(Qi.cloneDeep(r.value))});const s=to(()=>({language:"zh-CN",licenseKey:"non-commercial-and-evaluation",width:"auto",data:null,startRows:30,startCols:15,minSpareRows:30,minSpareCols:15,colHeaders:!0,rowHeaders:!0,colWidths:100,dropdownMenu:!1,autoWrapRow:!0,fixedRowsTop:0,fixedColumnsLeft:1,fillHandle:!0,manualRowMove:!0,afterChange(){i()},afterCreateCol(){i()},afterCreateRow(){i()},afterRemoveCol(){i()},afterRemoveRow(){i()},contextMenu:{items:{row_above:{name:"ä¸é¢æå¥ä¸è¡"},row_below:{name:"ä¸é¢æå¥ä¸è¡"},col_left:{name:"å·¦ä¾§æå¥ä¸å"},col_right:{name:"å³ä¾§æå¥ä¸å"},remove_row:{name:"ç§»é¤æ¬è¡"},remove_col:{name:"ç§»é¤æ¬å"},alignment:{name:"å¯¹é½æ¹å¼"},make_read_only:{name:"åªè¯»"},copy:{name:"å¤å¶"},cut:{name:"åªå"},separator:ht.plugins.ContextMenu.SEPARATOR}}}));return(l,u)=>{const f=co("el-button"),c=co("el-upload");return tr(),Cr("div",Pwt,[Ct("div",Iwt,[Ct("div",Mwt,[Kr(c,{"before-upload":a},{default:ho(()=>[Kr(f,{type:"primary",class:"import-btn"},{default:ho(()=>[Km("å¯¼å¥æ°æ®")]),_:1})]),_:1}),Kr(f,{plain:"",type:"primary",onClick:o},{default:ho(()=>[Km("ä¸è½½æ°æ®")]),_:1})])]),Ct("div",Dwt,[Kr(Rr(nB),{ref_key:"hotTableComponent",ref:t,settings:Rr(s)},null,8,["settings"])])])}}});const Lwt=Da(Nwt,[["__scopeId","data-v-bc8ccbf2"]]),n3=e=>(EL("data-v-7ee68518"),e=e(),RL(),e),Fwt={class:"topbar"},$wt={class:"left"},Hwt={class:"logo",title:"charts"},Bwt=n3(()=>Ct("img",{src:Sce,alt:"charts"},null,-1)),Vwt={class:"center"},jwt={class:"name-box"},Wwt={class:"name"},Uwt={class:"right"},zwt={class:"operation"},Gwt={class:"data-table-wrapper"},Ywt=n3(()=>Ct("div",{class:"item"},[Ct("div",null,[Ct("i",{class:"iconfont icon-weibiaoti520"}),Ct("div",{class:"text"},"ç¼è¾æ°æ®")])],-1)),Kwt=n3(()=>Ct("div",null,[Ct("i",{class:"iconfont icon-xiazai"}),Ct("div",{class:"text"},"ä¸è½½")],-1)),Xwt=[Kwt],qwt=_i({__name:"topbar",setup(e){const t=xl(fs),r=n=>{Oa.emit("handleChart",n)};return(n,i)=>{const a=co("router-link"),o=co("el-popover");return tr(),Cr("div",Fwt,[Ct("div",$wt,[Ct("h1",Hwt,[Kr(a,{tag:"a",to:{name:"home"}},{default:ho(()=>[Bwt,Km(" Charts ")]),_:1})])]),Ct("div",Vwt,[Ct("div",jwt,[Ct("div",Wwt,Xm(Rr(t).name)+" ",1)])]),Ct("div",Uwt,[Ct("div",zwt,[Kr(o,{placement:"bottom",width:700,trigger:"click",content:""},{reference:ho(()=>[Ywt]),default:ho(()=>[Ct("div",Gwt,[Kr(Rr(Lwt))])]),_:1}),Ct("div",{class:"item",onClick:i[0]||(i[0]=s=>r("download"))},Xwt)])])])}}});const Zwt=Da(qwt,[["__scopeId","data-v-7ee68518"]]),tse=e=>(EL("data-v-c30cc333"),e=e(),RL(),e),Jwt={class:"chart-list"},Qwt=["onClick"],eSt=tse(()=>Ct("i",{class:"icon-sanjiaoyou iconfont"},null,-1)),tSt={key:0,class:"chart-wrapper"},rSt=["onClick"],nSt={class:"preview"},iSt={class:"name-box"},aSt={class:"chart-nav"},oSt=["onClick"],sSt=tse(()=>Ct("i",{class:"iconfont icon-shouqi"},null,-1)),lSt={key:0,class:"text"},uSt=_i({__name:"typeBlock",setup(e){const t=xl(fs),r=Mn(_ce().map(o=>({...o,open:!0}))),n=o=>{o.open=!o.open},i=Mn(!1),a=o=>{Pce.confirm("åæ¢å¾è¡¨ç±»åå°ä¼æ¿æ¢åå¾è¡¨çæ°æ®ï¼ä½ ç¡®å®è¦åæ¢åï¼","æç¤º",{confirmButtonText:"ç¡®å®",cancelButtonText:"åæ¶",type:"warning"}).then(()=>{Oa.emit("chartClear");const s=Qi.cloneDeep(t==null?void 0:t.value),l=Tce[o.value];s.config.data=l,s.type=o.value,Oa.emit("updateChart",s)})};return(o,s)=>{const l=co("el-tooltip");return tr(),Cr("div",{class:Lf(["type-block",{expand:i.value}])},[Ct("div",Jwt,[(tr(!0),Cr(om,null,sm(r.value,u=>UC((tr(),Cr("div",{key:u.value},[Ct("div",{class:Lf(["tab",{open:u.open}]),onClick:f=>n(u)},[eSt,Km(" "+Xm(u.label),1)],10,Qwt),u.open?(tr(),Cr("div",tSt,[(tr(!0),Cr(om,null,sm(u.children,f=>(tr(),Cr("div",{key:f.value,class:Lf([{active:f.value===Rr(t).type},"chart-block"]),onClick:c=>a(f)},[Ct("div",nSt,[Kr(Rr(Cce),{chart:f},null,8,["chart"])]),Ct("div",iSt,Xm(f.label),1)],10,rSt))),128))])):rv("",!0)])),[[rI,i.value]])),128)),UC(Ct("div",aSt,[(tr(!0),Cr(om,null,sm(Rr(xce),u=>(tr(),mg(l,{key:u.value,content:u.label,placement:"right"},{default:ho(()=>[Ct("div",{class:Lf({active:u.value===Rr(t).type}),onClick:f=>a(u)},[Ct("i",{class:Lf(["iconfont",[u.icon]])},null,2)],10,oSt)]),_:2},1032,["content"]))),128))],512),[[rI,!i.value]])]),Ct("div",{class:"bottom",onClick:s[0]||(s[0]=u=>i.value=!i.value)},[Ct("div",null,[sSt,i.value?(tr(),Cr("span",lSt,"æ¶èµ·")):rv("",!0)])])],2)}}});const fSt=Da(uSt,[["__scopeId","data-v-c30cc333"]]),cSt={key:0,class:"download-loading"},hSt={class:"wrapper","element-loading-background":"transparent","element-loading-text":"ä¸è½½ä¸­, è¯·ç¨å..."},dSt=_i({__name:"loading",setup(e){const t=Mn(!1);return Oa.on("chartLoading",r=>{t.value=r}),(r,n)=>{const i=Ice("loading");return t.value?(tr(),Cr("div",cSt,[UC(Ct("div",hSt,null,512),[[i,!0]])])):rv("",!0)}}});const vSt=Da(dSt,[["__scopeId","data-v-39f8190a"]]),pSt={color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],backgroundColor:"transparent",textStyle:{},title:{textStyle:{color:"#516b91"},subtextStyle:{color:"#93b7e3"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"6",symbol:"circle",smooth:!0},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"circle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#edafda",color0:"transparent",borderColor:"#d680bc",borderColor0:"#8fd3e8",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:"6",symbol:"circle",smooth:!0,color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},geo:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#8fd3e8",width:1},itemStyle:{color:"#8fd3e8",borderWidth:1},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},checkpointStyle:{color:"#8fd3e8",borderColor:"#8a7ca8"},label:{color:"#8fd3e8"},emphasis:{itemStyle:{color:"#8fd3e8"},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},label:{color:"#8fd3e8"}}},visualMap:{color:["#516b91","#59c4e6","#a5e7f0"]},dataZoom:{backgroundColor:"rgba(0,0,0,0)",dataBackgroundColor:"rgba(255,255,255,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gN=function(e,t){return gN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},gN(e,t)};function je(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");gN(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var gSt=function(){function e(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return e}(),ySt=function(){function e(){this.browser=new gSt,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return e}(),Nf=new ySt;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(Nf.wxa=!0,Nf.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?Nf.worker=!0:typeof navigator>"u"?(Nf.node=!0,Nf.svgSupported=!0):mSt(navigator.userAgent,Nf);function mSt(e,t){var r=t.browser,n=e.match(/Firefox\/([\d.]+)/),i=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),a=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);n&&(r.firefox=!0,r.version=n[1]),i&&(r.ie=!0,r.version=i[1]),a&&(r.edge=!0,r.version=a[1],r.newEdge=+a[1].split(".")[0]>18),o&&(r.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,t.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),t.domSupported=typeof document<"u";var s=document.documentElement.style;t.transform3dSupported=(r.ie&&"transition"in s||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||r.ie&&+r.version>=9}const Ht=Nf;var i3=12,bSt="sans-serif",Gc=i3+"px "+bSt,wSt=20,SSt=100,_St="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function CSt(e){var t={};if(typeof JSON>"u")return t;for(var r=0;r<e.length;r++){var n=String.fromCharCode(r+32),i=(e.charCodeAt(r)-wSt)/SSt;t[n]=i}return t}var xSt=CSt(_St),Lg={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var e,t;return function(r,n){if(!e){var i=Lg.createCanvas();e=i&&i.getContext("2d")}if(e)return t!==n&&(t=e.font=n||Gc),e.measureText(r);r=r||"",n=n||Gc;var a=/(\d+)px/.exec(n),o=a&&+a[1]||i3,s=0;if(n.indexOf("mono")>=0)s=o*r.length;else for(var l=0;l<r.length;l++){var u=xSt[r[l]];s+=u==null?o:u*o}return{width:s}}}(),loadImage:function(e,t,r){var n=new Image;return n.onload=t,n.onerror=r,n.src=e,n}},rse=Lu(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),nse=Lu(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),CS=Object.prototype.toString,vE=Array.prototype,TSt=vE.forEach,OSt=vE.filter,a3=vE.slice,ESt=vE.map,gY=function(){}.constructor,Y_=gY?gY.prototype:null,o3="__proto__",RSt=2311;function ise(){return RSt++}function s3(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];typeof console<"u"&&console.error.apply(console,e)}function Xt(e){if(e==null||typeof e!="object")return e;var t=e,r=CS.call(e);if(r==="[object Array]"){if(!Nm(e)){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=Xt(e[n])}}else if(nse[r]){if(!Nm(e)){var a=e.constructor;if(a.from)t=a.from(e);else{t=new a(e.length);for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}}}else if(!rse[r]&&!Nm(e)&&!ST(e)){t={};for(var o in e)e.hasOwnProperty(o)&&o!==o3&&(t[o]=Xt(e[o]))}return t}function lr(e,t,r){if(!vt(t)||!vt(e))return r?Xt(t):e;for(var n in t)if(t.hasOwnProperty(n)&&n!==o3){var i=e[n],a=t[n];vt(a)&&vt(i)&&!Ze(a)&&!Ze(i)&&!ST(a)&&!ST(i)&&!yY(a)&&!yY(i)&&!Nm(a)&&!Nm(i)?lr(i,a,r):(r||!(n in e))&&(e[n]=Xt(t[n]))}return e}function Ne(e,t){if(Object.assign)Object.assign(e,t);else for(var r in t)t.hasOwnProperty(r)&&r!==o3&&(e[r]=t[r]);return e}function fr(e,t,r){for(var n=Lr(t),i=0;i<n.length;i++){var a=n[i];(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}return e}function ar(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return-1}function kSt(e,t){var r=e.prototype;function n(){}n.prototype=t.prototype,e.prototype=new n;for(var i in r)r.hasOwnProperty(i)&&(e.prototype[i]=r[i]);e.prototype.constructor=e,e.superClass=t}function _o(e,t,r){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var a=n[i];a!=="constructor"&&(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}else fr(e,t,r)}function Fi(e){return!e||typeof e=="string"?!1:typeof e.length=="number"}function le(e,t,r){if(e&&t)if(e.forEach&&e.forEach===TSt)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(r,e[a],a,e)}function ct(e,t,r){if(!e)return[];if(!t)return l3(e);if(e.map&&e.map===ESt)return e.map(t,r);for(var n=[],i=0,a=e.length;i<a;i++)n.push(t.call(r,e[i],i,e));return n}function Lu(e,t,r,n){if(e&&t){for(var i=0,a=e.length;i<a;i++)r=t.call(n,r,e[i],i,e);return r}}function Wn(e,t,r){if(!e)return[];if(!t)return l3(e);if(e.filter&&e.filter===OSt)return e.filter(t,r);for(var n=[],i=0,a=e.length;i<a;i++)t.call(r,e[i],i,e)&&n.push(e[i]);return n}function Lr(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}function ASt(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){return e.apply(t,r.concat(a3.call(arguments)))}}var kr=Y_&&gt(Y_.bind)?Y_.call.bind(Y_.bind):ASt;function wr(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){return e.apply(this,t.concat(a3.call(arguments)))}}function Ze(e){return Array.isArray?Array.isArray(e):CS.call(e)==="[object Array]"}function gt(e){return typeof e=="function"}function st(e){return typeof e=="string"}function yN(e){return CS.call(e)==="[object String]"}function Sr(e){return typeof e=="number"}function vt(e){var t=typeof e;return t==="function"||!!e&&t==="object"}function yY(e){return!!rse[CS.call(e)]}function aa(e){return!!nse[CS.call(e)]}function ST(e){return typeof e=="object"&&typeof e.nodeType=="number"&&typeof e.ownerDocument=="object"}function pE(e){return e.colorStops!=null}function PSt(e){return e.image!=null}function _T(e){return e!==e}function fw(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e.length;r<n;r++)if(e[r]!=null)return e[r]}function qt(e,t){return e??t}function Dm(e,t,r){return e??t??r}function l3(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return a3.apply(e,t)}function ase(e){if(typeof e=="number")return[e,e,e,e];var t=e.length;return t===2?[e[0],e[1],e[0],e[1]]:t===3?[e[0],e[1],e[2],e[1]]:e}function gl(e,t){if(!e)throw new Error(t)}function Ko(e){return e==null?null:typeof e.trim=="function"?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var ose="__ec_primitive__";function mN(e){e[ose]=!0}function Nm(e){return e[ose]}var ISt=function(){function e(){this.data={}}return e.prototype.delete=function(t){var r=this.has(t);return r&&delete this.data[t],r},e.prototype.has=function(t){return this.data.hasOwnProperty(t)},e.prototype.get=function(t){return this.data[t]},e.prototype.set=function(t,r){return this.data[t]=r,this},e.prototype.keys=function(){return Lr(this.data)},e.prototype.forEach=function(t){var r=this.data;for(var n in r)r.hasOwnProperty(n)&&t(r[n],n)},e}(),sse=typeof Map=="function";function MSt(){return sse?new Map:new ISt}var DSt=function(){function e(t){var r=Ze(t);this.data=MSt();var n=this;t instanceof e?t.each(i):t&&le(t,i);function i(a,o){r?n.set(a,o):n.set(o,a)}}return e.prototype.hasKey=function(t){return this.data.has(t)},e.prototype.get=function(t){return this.data.get(t)},e.prototype.set=function(t,r){return this.data.set(t,r),r},e.prototype.each=function(t,r){this.data.forEach(function(n,i){t.call(r,n,i)})},e.prototype.keys=function(){var t=this.data.keys();return sse?Array.from(t):t},e.prototype.removeKey=function(t){this.data.delete(t)},e}();function Bt(e){return new DSt(e)}function NSt(e,t){for(var r=new e.constructor(e.length+t.length),n=0;n<e.length;n++)r[n]=e[n];for(var i=e.length,n=0;n<t.length;n++)r[n+i]=t[n];return r}function gE(e,t){var r;if(Object.create)r=Object.create(e);else{var n=function(){};n.prototype=e,r=new n}return t&&Ne(r,t),r}function lse(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function dg(e,t){return e.hasOwnProperty(t)}function Li(){}var LSt=180/Math.PI;function Fg(e,t){return e==null&&(e=0),t==null&&(t=0),[e,t]}function FSt(e){return[e[0],e[1]]}function mY(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function $St(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function HSt(e){return Math.sqrt(BSt(e))}function BSt(e){return e[0]*e[0]+e[1]*e[1]}function PA(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function VSt(e,t){var r=HSt(t);return r===0?(e[0]=0,e[1]=0):(e[0]=t[0]/r,e[1]=t[1]/r),e}function bN(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var wN=bN;function jSt(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var qd=jSt;function IA(e,t,r,n){return e[0]=t[0]+n*(r[0]-t[0]),e[1]=t[1]+n*(r[1]-t[1]),e}function ka(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function Ed(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Rd(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}var ed=function(){function e(t,r){this.target=t,this.topTarget=r&&r.topTarget}return e}(),WSt=function(){function e(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(t){for(var r=t.target;r&&!r.draggable;)r=r.parent||r.__hostTarget;r&&(this._draggingTarget=r,r.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new ed(r,t),"dragstart",t.event))},e.prototype._drag=function(t){var r=this._draggingTarget;if(r){var n=t.offsetX,i=t.offsetY,a=n-this._x,o=i-this._y;this._x=n,this._y=i,r.drift(a,o,t),this.handler.dispatchToElement(new ed(r,t),"drag",t.event);var s=this.handler.findHover(n,i,r).target,l=this._dropTarget;this._dropTarget=s,r!==s&&(l&&s!==l&&this.handler.dispatchToElement(new ed(l,t),"dragleave",t.event),s&&s!==l&&this.handler.dispatchToElement(new ed(s,t),"dragenter",t.event))}},e.prototype._dragEnd=function(t){var r=this._draggingTarget;r&&(r.dragging=!1),this.handler.dispatchToElement(new ed(r,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new ed(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},e}();const USt=WSt;var zSt=function(){function e(t){t&&(this._$eventProcessor=t)}return e.prototype.on=function(t,r,n,i){this._$handlers||(this._$handlers={});var a=this._$handlers;if(typeof r=="function"&&(i=n,n=r,r=null),!n||!t)return this;var o=this._$eventProcessor;r!=null&&o&&o.normalizeQuery&&(r=o.normalizeQuery(r)),a[t]||(a[t]=[]);for(var s=0;s<a[t].length;s++)if(a[t][s].h===n)return this;var l={h:n,query:r,ctx:i||this,callAtLast:n.zrEventfulCallAtLast},u=a[t].length-1,f=a[t][u];return f&&f.callAtLast?a[t].splice(u,0,l):a[t].push(l),this},e.prototype.isSilent=function(t){var r=this._$handlers;return!r||!r[t]||!r[t].length},e.prototype.off=function(t,r){var n=this._$handlers;if(!n)return this;if(!t)return this._$handlers={},this;if(r){if(n[t]){for(var i=[],a=0,o=n[t].length;a<o;a++)n[t][a].h!==r&&i.push(n[t][a]);n[t]=i}n[t]&&n[t].length===0&&delete n[t]}else delete n[t];return this},e.prototype.trigger=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=i.length,l=0;l<s;l++){var u=i[l];if(!(a&&a.filter&&u.query!=null&&!a.filter(t,u.query)))switch(o){case 0:u.h.call(u.ctx);break;case 1:u.h.call(u.ctx,r[0]);break;case 2:u.h.call(u.ctx,r[0],r[1]);break;default:u.h.apply(u.ctx,r);break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e.prototype.triggerWithContext=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=r[o-1],l=i.length,u=0;u<l;u++){var f=i[u];if(!(a&&a.filter&&f.query!=null&&!a.filter(t,f.query)))switch(o){case 0:f.h.call(s);break;case 1:f.h.call(s,r[0]);break;case 2:f.h.call(s,r[0],r[1]);break;default:f.h.apply(s,r.slice(1,o-1));break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e}();const cs=zSt;var GSt=Math.log(2);function SN(e,t,r,n,i,a){var o=n+"-"+i,s=e.length;if(a.hasOwnProperty(o))return a[o];if(t===1){var l=Math.round(Math.log((1<<s)-1&~i)/GSt);return e[r][l]}for(var u=n|1<<r,f=r+1;n&1<<f;)f++;for(var c=0,h=0,d=0;h<s;h++){var v=1<<h;v&i||(c+=(d%2?-1:1)*e[r][h]*SN(e,t-1,f,u,i|v,a),d++)}return a[o]=c,c}function bY(e,t){var r=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],n={},i=SN(r,8,0,0,0,n);if(i!==0){for(var a=[],o=0;o<8;o++)for(var s=0;s<8;s++)a[s]==null&&(a[s]=0),a[s]+=((o+s)%2?-1:1)*SN(r,7,o===0?1:0,1<<o,1<<s,n)/i*t[o];return function(l,u,f){var c=u*a[6]+f*a[7]+1;l[0]=(u*a[0]+f*a[1]+a[2])/c,l[1]=(u*a[3]+f*a[4]+a[5])/c}}}var wY="___zrEVENTSAVED",MA=[];function YSt(e,t,r,n,i){return _N(MA,t,n,i,!0)&&_N(e,r,MA[0],MA[1])}function _N(e,t,r,n,i){if(t.getBoundingClientRect&&Ht.domSupported&&!use(t)){var a=t[wY]||(t[wY]={}),o=KSt(t,a),s=XSt(o,a,i);if(s)return s(e,r,n),!0}return!1}function KSt(e,t){var r=t.markers;if(r)return r;r=t.markers=[];for(var n=["left","right"],i=["top","bottom"],a=0;a<4;a++){var o=document.createElement("div"),s=o.style,l=a%2,u=(a>>1)%2;s.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[l]+":0",i[u]+":0",n[1-l]+":auto",i[1-u]+":auto",""].join("!important;"),e.appendChild(o),r.push(o)}return r}function XSt(e,t,r){for(var n=r?"invTrans":"trans",i=t[n],a=t.srcCoords,o=[],s=[],l=!0,u=0;u<4;u++){var f=e[u].getBoundingClientRect(),c=2*u,h=f.left,d=f.top;o.push(h,d),l=l&&a&&h===a[c]&&d===a[c+1],s.push(e[u].offsetLeft,e[u].offsetTop)}return l&&i?i:(t.srcCoords=o,t[n]=r?bY(s,o):bY(o,s))}function use(e){return e.nodeName.toUpperCase()==="CANVAS"}var qSt=/([&<>"'])/g,ZSt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function _a(e){return e==null?"":(e+"").replace(qSt,function(t,r){return ZSt[r]})}var JSt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,DA=[],QSt=Ht.browser.firefox&&+Ht.browser.version.split(".")[0]<39;function CN(e,t,r,n){return r=r||{},n?SY(e,t,r):QSt&&t.layerX!=null&&t.layerX!==t.offsetX?(r.zrX=t.layerX,r.zrY=t.layerY):t.offsetX!=null?(r.zrX=t.offsetX,r.zrY=t.offsetY):SY(e,t,r),r}function SY(e,t,r){if(Ht.domSupported&&e.getBoundingClientRect){var n=t.clientX,i=t.clientY;if(use(e)){var a=e.getBoundingClientRect();r.zrX=n-a.left,r.zrY=i-a.top;return}else if(_N(DA,e,n,i)){r.zrX=DA[0],r.zrY=DA[1];return}}r.zrX=r.zrY=0}function u3(e){return e||window.event}function ya(e,t,r){if(t=u3(t),t.zrX!=null)return t;var n=t.type,i=n&&n.indexOf("touch")>=0;if(i){var o=n!=="touchend"?t.targetTouches[0]:t.changedTouches[0];o&&CN(e,o,t,r)}else{CN(e,t,t,r);var a=e_t(t);t.zrDelta=a?a/120:-(t.detail||0)/3}var s=t.button;return t.which==null&&s!==void 0&&JSt.test(t.type)&&(t.which=s&1?1:s&2?3:s&4?2:0),t}function e_t(e){var t=e.wheelDelta;if(t)return t;var r=e.deltaX,n=e.deltaY;if(r==null||n==null)return t;var i=Math.abs(n!==0?n:r),a=n>0?-1:n<0?1:r>0?-1:1;return 3*i*a}function t_t(e,t,r,n){e.addEventListener(t,r,n)}function r_t(e,t,r,n){e.removeEventListener(t,r,n)}var fse=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0},n_t=function(){function e(){this._track=[]}return e.prototype.recognize=function(t,r,n){return this._doTrack(t,r,n),this._recognize(t)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(t,r,n){var i=t.touches;if(i){for(var a={points:[],touches:[],target:r,event:t},o=0,s=i.length;o<s;o++){var l=i[o],u=CN(n,l,{});a.points.push([u.zrX,u.zrY]),a.touches.push(l)}this._track.push(a)}},e.prototype._recognize=function(t){for(var r in NA)if(NA.hasOwnProperty(r)){var n=NA[r](this._track,t);if(n)return n}},e}();function _Y(e){var t=e[1][0]-e[0][0],r=e[1][1]-e[0][1];return Math.sqrt(t*t+r*r)}function i_t(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}var NA={pinch:function(e,t){var r=e.length;if(r){var n=(e[r-1]||{}).points,i=(e[r-2]||{}).points||n;if(i&&i.length>1&&n&&n.length>1){var a=_Y(n)/_Y(i);!isFinite(a)&&(a=1),t.pinchScale=a;var o=i_t(n);return t.pinchX=o[0],t.pinchY=o[1],{type:"pinch",target:e[0].target,event:t}}}}};function cw(){return[1,0,0,1,0,0]}function f3(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function a_t(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Zd(e,t,r){var n=t[0]*r[0]+t[2]*r[1],i=t[1]*r[0]+t[3]*r[1],a=t[0]*r[2]+t[2]*r[3],o=t[1]*r[2]+t[3]*r[3],s=t[0]*r[4]+t[2]*r[5]+t[4],l=t[1]*r[4]+t[3]*r[5]+t[5];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e}function xN(e,t,r){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+r[0],e[5]=t[5]+r[1],e}function c3(e,t,r){var n=t[0],i=t[2],a=t[4],o=t[1],s=t[3],l=t[5],u=Math.sin(r),f=Math.cos(r);return e[0]=n*f+o*u,e[1]=-n*u+o*f,e[2]=i*f+s*u,e[3]=-i*u+f*s,e[4]=f*a+u*l,e[5]=f*l-u*a,e}function o_t(e,t,r){var n=r[0],i=r[1];return e[0]=t[0]*n,e[1]=t[1]*i,e[2]=t[2]*n,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*i,e}function h3(e,t){var r=t[0],n=t[2],i=t[4],a=t[1],o=t[3],s=t[5],l=r*o-a*n;return l?(l=1/l,e[0]=o*l,e[1]=-a*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*s-o*i)*l,e[5]=(a*i-r*s)*l,e):null}var s_t=function(){function e(t,r){this.x=t||0,this.y=r||0}return e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(t,r){return this.x=t,this.y=r,this},e.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.scaleAndAdd=function(t,r){this.x+=t.x*r,this.y+=t.y*r},e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},e.prototype.distance=function(t){var r=this.x-t.x,n=this.y-t.y;return Math.sqrt(r*r+n*n)},e.prototype.distanceSquare=function(t){var r=this.x-t.x,n=this.y-t.y;return r*r+n*n},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(t){if(t){var r=this.x,n=this.y;return this.x=t[0]*r+t[2]*n+t[4],this.y=t[1]*r+t[3]*n+t[5],this}},e.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},e.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},e.set=function(t,r,n){t.x=r,t.y=n},e.copy=function(t,r){t.x=r.x,t.y=r.y},e.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.lenSquare=function(t){return t.x*t.x+t.y*t.y},e.dot=function(t,r){return t.x*r.x+t.y*r.y},e.add=function(t,r,n){t.x=r.x+n.x,t.y=r.y+n.y},e.sub=function(t,r,n){t.x=r.x-n.x,t.y=r.y-n.y},e.scale=function(t,r,n){t.x=r.x*n,t.y=r.y*n},e.scaleAndAdd=function(t,r,n,i){t.x=r.x+n.x*i,t.y=r.y+n.y*i},e.lerp=function(t,r,n,i){var a=1-i;t.x=a*r.x+i*n.x,t.y=a*r.y+i*n.y},e}();const xt=s_t;var K_=Math.min,X_=Math.max,cf=new xt,hf=new xt,df=new xt,vf=new xt,my=new xt,by=new xt,l_t=function(){function e(t,r,n,i){n<0&&(t=t+n,n=-n),i<0&&(r=r+i,i=-i),this.x=t,this.y=r,this.width=n,this.height=i}return e.prototype.union=function(t){var r=K_(t.x,this.x),n=K_(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=X_(t.x+t.width,this.x+this.width)-r:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=X_(t.y+t.height,this.y+this.height)-n:this.height=t.height,this.x=r,this.y=n},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(t){var r=this,n=t.width/r.width,i=t.height/r.height,a=cw();return xN(a,a,[-r.x,-r.y]),o_t(a,a,[n,i]),xN(a,a,[t.x,t.y]),a},e.prototype.intersect=function(t,r){if(!t)return!1;t instanceof e||(t=e.create(t));var n=this,i=n.x,a=n.x+n.width,o=n.y,s=n.y+n.height,l=t.x,u=t.x+t.width,f=t.y,c=t.y+t.height,h=!(a<l||u<i||s<f||c<o);if(r){var d=1/0,v=0,p=Math.abs(a-l),g=Math.abs(u-i),y=Math.abs(s-f),m=Math.abs(c-o),b=Math.min(p,g),S=Math.min(y,m);a<l||u<i?b>v&&(v=b,p<g?xt.set(by,-p,0):xt.set(by,g,0)):b<d&&(d=b,p<g?xt.set(my,p,0):xt.set(my,-g,0)),s<f||c<o?S>v&&(v=S,y<m?xt.set(by,0,-y):xt.set(by,0,m)):b<d&&(d=b,y<m?xt.set(my,0,y):xt.set(my,0,-m))}return r&&xt.copy(r,h?my:by),h},e.prototype.contain=function(t,r){var n=this;return t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return this.width===0||this.height===0},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(t,r){t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height},e.applyTransform=function(t,r,n){if(!n){t!==r&&e.copy(t,r);return}if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var i=n[0],a=n[3],o=n[4],s=n[5];t.x=r.x*i+o,t.y=r.y*a+s,t.width=r.width*i,t.height=r.height*a,t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height);return}cf.x=df.x=r.x,cf.y=vf.y=r.y,hf.x=vf.x=r.x+r.width,hf.y=df.y=r.y+r.height,cf.transform(n),vf.transform(n),hf.transform(n),df.transform(n),t.x=K_(cf.x,hf.x,df.x,vf.x),t.y=K_(cf.y,hf.y,df.y,vf.y);var l=X_(cf.x,hf.x,df.x,vf.x),u=X_(cf.y,hf.y,df.y,vf.y);t.width=l-t.x,t.height=u-t.y},e}();const ur=l_t;var cse="silent";function u_t(e,t,r){return{type:e,event:r,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:f_t}}function f_t(){fse(this.event)}var c_t=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.handler=null,r}return t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(cs),wy=function(){function e(t,r){this.x=t,this.y=r}return e}(),h_t=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],LA=new ur(0,0,0,0),hse=function(e){je(t,e);function t(r,n,i,a,o){var s=e.call(this)||this;return s._hovered=new wy(0,0),s.storage=r,s.painter=n,s.painterRoot=a,s._pointerSize=o,i=i||new c_t,s.proxy=null,s.setHandlerProxy(i),s._draggingMgr=new USt(s),s}return t.prototype.setHandlerProxy=function(r){this.proxy&&this.proxy.dispose(),r&&(le(h_t,function(n){r.on&&r.on(n,this[n],this)},this),r.handler=this),this.proxy=r},t.prototype.mousemove=function(r){var n=r.zrX,i=r.zrY,a=dse(this,n,i),o=this._hovered,s=o.target;s&&!s.__zr&&(o=this.findHover(o.x,o.y),s=o.target);var l=this._hovered=a?new wy(n,i):this.findHover(n,i),u=l.target,f=this.proxy;f.setCursor&&f.setCursor(u?u.cursor:"default"),s&&u!==s&&this.dispatchToElement(o,"mouseout",r),this.dispatchToElement(l,"mousemove",r),u&&u!==s&&this.dispatchToElement(l,"mouseover",r)},t.prototype.mouseout=function(r){var n=r.zrEventControl;n!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",r),n!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:r})},t.prototype.resize=function(){this._hovered=new wy(0,0)},t.prototype.dispatch=function(r,n){var i=this[r];i&&i.call(this,n)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(r){var n=this.proxy;n.setCursor&&n.setCursor(r)},t.prototype.dispatchToElement=function(r,n,i){r=r||{};var a=r.target;if(!(a&&a.silent)){for(var o="on"+n,s=u_t(n,r,i);a&&(a[o]&&(s.cancelBubble=!!a[o].call(a,s)),a.trigger(n,s),a=a.__hostTarget?a.__hostTarget:a.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(n,s),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[o]=="function"&&l[o].call(l,s),l.trigger&&l.trigger(n,s)}))}},t.prototype.findHover=function(r,n,i){var a=this.storage.getDisplayList(),o=new wy(r,n);if(CY(a,o,r,n,i),this._pointerSize&&!o.target){for(var s=[],l=this._pointerSize,u=l/2,f=new ur(r-u,n-u,l,l),c=a.length-1;c>=0;c--){var h=a[c];h!==i&&!h.ignore&&!h.ignoreCoarsePointer&&(!h.parent||!h.parent.ignoreCoarsePointer)&&(LA.copy(h.getBoundingRect()),h.transform&&LA.applyTransform(h.transform),LA.intersect(f)&&s.push(h))}if(s.length)for(var d=4,v=Math.PI/12,p=Math.PI*2,g=0;g<u;g+=d)for(var y=0;y<p;y+=v){var m=r+g*Math.cos(y),b=n+g*Math.sin(y);if(CY(s,o,m,b,i),o.target)return o}}return o},t.prototype.processGesture=function(r,n){this._gestureMgr||(this._gestureMgr=new n_t);var i=this._gestureMgr;n==="start"&&i.clear();var a=i.recognize(r,this.findHover(r.zrX,r.zrY,null).target,this.proxy.dom);if(n==="end"&&i.clear(),a){var o=a.type;r.gestureEvent=o;var s=new wy;s.target=a.target,this.dispatchToElement(s,o,a.event)}},t}(cs);le(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){hse.prototype[e]=function(t){var r=t.zrX,n=t.zrY,i=dse(this,r,n),a,o;if((e!=="mouseup"||!i)&&(a=this.findHover(r,n),o=a.target),e==="mousedown")this._downEl=o,this._downPoint=[t.zrX,t.zrY],this._upEl=o;else if(e==="mouseup")this._upEl=o;else if(e==="click"){if(this._downEl!==this._upEl||!this._downPoint||wN(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,e,t)}});function d_t(e,t,r){if(e[e.rectHover?"rectContain":"contain"](t,r)){for(var n=e,i=void 0,a=!1;n;){if(n.ignoreClip&&(a=!0),!a){var o=n.getClipPath();if(o&&!o.contain(t,r))return!1;n.silent&&(i=!0)}var s=n.__hostTarget;n=s||n.parent}return i?cse:!0}return!1}function CY(e,t,r,n,i){for(var a=e.length-1;a>=0;a--){var o=e[a],s=void 0;if(o!==i&&!o.ignore&&(s=d_t(o,r,n))&&(!t.topTarget&&(t.topTarget=o),s!==cse)){t.target=o;break}}}function dse(e,t,r){var n=e.painter;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}const v_t=hse;var vse=32,Sy=7;function p_t(e){for(var t=0;e>=vse;)t|=e&1,e>>=1;return e+t}function xY(e,t,r,n){var i=t+1;if(i===r)return 1;if(n(e[i++],e[t])<0){for(;i<r&&n(e[i],e[i-1])<0;)i++;g_t(e,t,i)}else for(;i<r&&n(e[i],e[i-1])>=0;)i++;return i-t}function g_t(e,t,r){for(r--;t<r;){var n=e[t];e[t++]=e[r],e[r--]=n}}function TY(e,t,r,n,i){for(n===t&&n++;n<r;n++){for(var a=e[n],o=t,s=n,l;o<s;)l=o+s>>>1,i(a,e[l])<0?s=l:o=l+1;var u=n-o;switch(u){case 3:e[o+3]=e[o+2];case 2:e[o+2]=e[o+1];case 1:e[o+1]=e[o];break;default:for(;u>0;)e[o+u]=e[o+u-1],u--}e[o]=a}}function FA(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])>0){for(s=n-i;l<s&&a(e,t[r+i+l])>0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}else{for(s=i+1;l<s&&a(e,t[r+i-l])<=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])>0?o=f+1:l=f}return l}function $A(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])<0){for(s=i+1;l<s&&a(e,t[r+i-l])<0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}else{for(s=n-i;l<s&&a(e,t[r+i+l])>=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}for(o++;o<l;){var f=o+(l-o>>>1);a(e,t[r+f])<0?l=f:o=f+1}return l}function y_t(e,t){var r=Sy,n,i,a=0;e.length;var o=[];n=[],i=[];function s(d,v){n[a]=d,i[a]=v,a+=1}function l(){for(;a>1;){var d=a-2;if(d>=1&&i[d-1]<=i[d]+i[d+1]||d>=2&&i[d-2]<=i[d]+i[d-1])i[d-1]<i[d+1]&&d--;else if(i[d]>i[d+1])break;f(d)}}function u(){for(;a>1;){var d=a-2;d>0&&i[d-1]<i[d+1]&&d--,f(d)}}function f(d){var v=n[d],p=i[d],g=n[d+1],y=i[d+1];i[d]=p+y,d===a-3&&(n[d+1]=n[d+2],i[d+1]=i[d+2]),a--;var m=$A(e[g],e,v,p,0,t);v+=m,p-=m,p!==0&&(y=FA(e[v+p-1],e,g,y,y-1,t),y!==0&&(p<=y?c(v,p,g,y):h(v,p,g,y)))}function c(d,v,p,g){var y=0;for(y=0;y<v;y++)o[y]=e[d+y];var m=0,b=p,S=d;if(e[S++]=e[b++],--g===0){for(y=0;y<v;y++)e[S+y]=o[m+y];return}if(v===1){for(y=0;y<g;y++)e[S+y]=e[b+y];e[S+g]=o[m];return}for(var x=r,T,E,P;;){T=0,E=0,P=!1;do if(t(e[b],o[m])<0){if(e[S++]=e[b++],E++,T=0,--g===0){P=!0;break}}else if(e[S++]=o[m++],T++,E=0,--v===1){P=!0;break}while((T|E)<x);if(P)break;do{if(T=$A(e[b],o,m,v,0,t),T!==0){for(y=0;y<T;y++)e[S+y]=o[m+y];if(S+=T,m+=T,v-=T,v<=1){P=!0;break}}if(e[S++]=e[b++],--g===0){P=!0;break}if(E=FA(o[m],e,b,g,0,t),E!==0){for(y=0;y<E;y++)e[S+y]=e[b+y];if(S+=E,b+=E,g-=E,g===0){P=!0;break}}if(e[S++]=o[m++],--v===1){P=!0;break}x--}while(T>=Sy||E>=Sy);if(P)break;x<0&&(x=0),x+=2}if(r=x,r<1&&(r=1),v===1){for(y=0;y<g;y++)e[S+y]=e[b+y];e[S+g]=o[m]}else{if(v===0)throw new Error;for(y=0;y<v;y++)e[S+y]=o[m+y]}}function h(d,v,p,g){var y=0;for(y=0;y<g;y++)o[y]=e[p+y];var m=d+v-1,b=g-1,S=p+g-1,x=0,T=0;if(e[S--]=e[m--],--v===0){for(x=S-(g-1),y=0;y<g;y++)e[x+y]=o[y];return}if(g===1){for(S-=v,m-=v,T=S+1,x=m+1,y=v-1;y>=0;y--)e[T+y]=e[x+y];e[S]=o[b];return}for(var E=r;;){var P=0,R=0,M=!1;do if(t(o[b],e[m])<0){if(e[S--]=e[m--],P++,R=0,--v===0){M=!0;break}}else if(e[S--]=o[b--],R++,P=0,--g===1){M=!0;break}while((P|R)<E);if(M)break;do{if(P=v-$A(o[b],e,d,v,v-1,t),P!==0){for(S-=P,m-=P,v-=P,T=S+1,x=m+1,y=P-1;y>=0;y--)e[T+y]=e[x+y];if(v===0){M=!0;break}}if(e[S--]=o[b--],--g===1){M=!0;break}if(R=g-FA(e[m],o,0,g,g-1,t),R!==0){for(S-=R,b-=R,g-=R,T=S+1,x=b+1,y=0;y<R;y++)e[T+y]=o[x+y];if(g<=1){M=!0;break}}if(e[S--]=e[m--],--v===0){M=!0;break}E--}while(P>=Sy||R>=Sy);if(M)break;E<0&&(E=0),E+=2}if(r=E,r<1&&(r=1),g===1){for(S-=v,m-=v,T=S+1,x=m+1,y=v-1;y>=0;y--)e[T+y]=e[x+y];e[S]=o[b]}else{if(g===0)throw new Error;for(x=S-(g-1),y=0;y<g;y++)e[x+y]=o[y]}}return{mergeRuns:l,forceMergeRuns:u,pushRun:s}}function kC(e,t,r,n){r||(r=0),n||(n=e.length);var i=n-r;if(!(i<2)){var a=0;if(i<vse){a=xY(e,r,n,t),TY(e,r,n,r+a,t);return}var o=y_t(e,t),s=p_t(i);do{if(a=xY(e,r,n,t),a<s){var l=i;l>s&&(l=s),TY(e,r,r+l,r+a,t),a=l}o.pushRun(r,a),o.mergeRuns(),i-=a,r+=a}while(i!==0);o.forceMergeRuns()}}var Ji=1,Jy=2,bd=4,OY=!1;function HA(){OY||(OY=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function EY(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var m_t=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=EY}return e.prototype.traverse=function(t,r){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,r)},e.prototype.getDisplayList=function(t,r){r=r||!1;var n=this._displayList;return(t||!n.length)&&this.updateDisplayList(r),n},e.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var r=this._roots,n=this._displayList,i=0,a=r.length;i<a;i++)this._updateAndAddDisplayable(r[i],null,t);n.length=this._displayListLen,kC(n,EY)},e.prototype._updateAndAddDisplayable=function(t,r,n){if(!(t.ignore&&!n)){t.beforeUpdate(),t.update(),t.afterUpdate();var i=t.getClipPath();if(t.ignoreClip)r=null;else if(i){r?r=r.slice():r=[];for(var a=i,o=t;a;)a.parent=o,a.updateTransform(),r.push(a),o=a,a=a.getClipPath()}if(t.childrenRef){for(var s=t.childrenRef(),l=0;l<s.length;l++){var u=s[l];t.__dirty&&(u.__dirty|=Ji),this._updateAndAddDisplayable(u,r,n)}t.__dirty=0}else{var f=t;r&&r.length?f.__clipPaths=r:f.__clipPaths&&f.__clipPaths.length>0&&(f.__clipPaths=[]),isNaN(f.z)&&(HA(),f.z=0),isNaN(f.z2)&&(HA(),f.z2=0),isNaN(f.zlevel)&&(HA(),f.zlevel=0),this._displayList[this._displayListLen++]=f}var c=t.getDecalElement&&t.getDecalElement();c&&this._updateAndAddDisplayable(c,r,n);var h=t.getTextGuideLine();h&&this._updateAndAddDisplayable(h,r,n);var d=t.getTextContent();d&&this._updateAndAddDisplayable(d,r,n)}},e.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},e.prototype.delRoot=function(t){if(t instanceof Array){for(var r=0,n=t.length;r<n;r++)this.delRoot(t[r]);return}var i=ar(this._roots,t);i>=0&&this._roots.splice(i,1)},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}();const b_t=m_t;var pse;pse=Ht.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};const TN=pse;var AC={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return .5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},exponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)))},elasticOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},elasticInOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)):r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-AC.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?AC.bounceIn(e*2)*.5:AC.bounceOut(e*2-1)*.5+.5}};const gse=AC;var q_=Math.pow,Tu=Math.sqrt,CT=1e-8,yse=1e-4,RY=Tu(3),Z_=1/3,Go=Fg(),Ca=Fg(),Jd=Fg();function iu(e){return e>-CT&&e<CT}function mse(e){return e>CT||e<-CT}function mn(e,t,r,n,i){var a=1-i;return a*a*(a*e+3*i*t)+i*i*(i*n+3*a*r)}function kY(e,t,r,n,i){var a=1-i;return 3*(((t-e)*a+2*(r-t)*i)*a+(n-r)*i*i)}function xT(e,t,r,n,i,a){var o=n+3*(t-r)-e,s=3*(r-t*2+e),l=3*(t-e),u=e-i,f=s*s-3*o*l,c=s*l-9*o*u,h=l*l-3*s*u,d=0;if(iu(f)&&iu(c))if(iu(s))a[0]=0;else{var v=-l/s;v>=0&&v<=1&&(a[d++]=v)}else{var p=c*c-4*f*h;if(iu(p)){var g=c/f,v=-s/o+g,y=-g/2;v>=0&&v<=1&&(a[d++]=v),y>=0&&y<=1&&(a[d++]=y)}else if(p>0){var m=Tu(p),b=f*s+1.5*o*(-c+m),S=f*s+1.5*o*(-c-m);b<0?b=-q_(-b,Z_):b=q_(b,Z_),S<0?S=-q_(-S,Z_):S=q_(S,Z_);var v=(-s-(b+S))/(3*o);v>=0&&v<=1&&(a[d++]=v)}else{var x=(2*f*s-3*o*c)/(2*Tu(f*f*f)),T=Math.acos(x)/3,E=Tu(f),P=Math.cos(T),v=(-s-2*E*P)/(3*o),y=(-s+E*(P+RY*Math.sin(T)))/(3*o),R=(-s+E*(P-RY*Math.sin(T)))/(3*o);v>=0&&v<=1&&(a[d++]=v),y>=0&&y<=1&&(a[d++]=y),R>=0&&R<=1&&(a[d++]=R)}}return d}function bse(e,t,r,n,i){var a=6*r-12*t+6*e,o=9*t+3*n-3*e-9*r,s=3*t-3*e,l=0;if(iu(o)){if(mse(a)){var u=-s/a;u>=0&&u<=1&&(i[l++]=u)}}else{var f=a*a-4*o*s;if(iu(f))i[0]=-a/(2*o);else if(f>0){var c=Tu(f),u=(-a+c)/(2*o),h=(-a-c)/(2*o);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function TT(e,t,r,n,i,a){var o=(t-e)*i+e,s=(r-t)*i+t,l=(n-r)*i+r,u=(s-o)*i+o,f=(l-s)*i+s,c=(f-u)*i+u;a[0]=e,a[1]=o,a[2]=u,a[3]=c,a[4]=c,a[5]=f,a[6]=l,a[7]=n}function w_t(e,t,r,n,i,a,o,s,l,u,f){var c,h=.005,d=1/0,v,p,g,y;Go[0]=l,Go[1]=u;for(var m=0;m<1;m+=.05)Ca[0]=mn(e,r,i,o,m),Ca[1]=mn(t,n,a,s,m),g=qd(Go,Ca),g<d&&(c=m,d=g);d=1/0;for(var b=0;b<32&&!(h<yse);b++)v=c-h,p=c+h,Ca[0]=mn(e,r,i,o,v),Ca[1]=mn(t,n,a,s,v),g=qd(Ca,Go),v>=0&&g<d?(c=v,d=g):(Jd[0]=mn(e,r,i,o,p),Jd[1]=mn(t,n,a,s,p),y=qd(Jd,Go),p<=1&&y<d?(c=p,d=y):h*=.5);return f&&(f[0]=mn(e,r,i,o,c),f[1]=mn(t,n,a,s,c)),Tu(d)}function S_t(e,t,r,n,i,a,o,s,l){for(var u=e,f=t,c=0,h=1/l,d=1;d<=l;d++){var v=d*h,p=mn(e,r,i,o,v),g=mn(t,n,a,s,v),y=p-u,m=g-f;c+=Math.sqrt(y*y+m*m),u=p,f=g}return c}function Hn(e,t,r,n){var i=1-n;return i*(i*e+2*n*t)+n*n*r}function AY(e,t,r,n){return 2*((1-n)*(t-e)+n*(r-t))}function __t(e,t,r,n,i){var a=e-2*t+r,o=2*(t-e),s=e-n,l=0;if(iu(a)){if(mse(o)){var u=-s/o;u>=0&&u<=1&&(i[l++]=u)}}else{var f=o*o-4*a*s;if(iu(f)){var u=-o/(2*a);u>=0&&u<=1&&(i[l++]=u)}else if(f>0){var c=Tu(f),u=(-o+c)/(2*a),h=(-o-c)/(2*a);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function wse(e,t,r){var n=e+r-2*t;return n===0?.5:(e-t)/n}function OT(e,t,r,n,i){var a=(t-e)*n+e,o=(r-t)*n+t,s=(o-a)*n+a;i[0]=e,i[1]=a,i[2]=s,i[3]=s,i[4]=o,i[5]=r}function C_t(e,t,r,n,i,a,o,s,l){var u,f=.005,c=1/0;Go[0]=o,Go[1]=s;for(var h=0;h<1;h+=.05){Ca[0]=Hn(e,r,i,h),Ca[1]=Hn(t,n,a,h);var d=qd(Go,Ca);d<c&&(u=h,c=d)}c=1/0;for(var v=0;v<32&&!(f<yse);v++){var p=u-f,g=u+f;Ca[0]=Hn(e,r,i,p),Ca[1]=Hn(t,n,a,p);var d=qd(Ca,Go);if(p>=0&&d<c)u=p,c=d;else{Jd[0]=Hn(e,r,i,g),Jd[1]=Hn(t,n,a,g);var y=qd(Jd,Go);g<=1&&y<c?(u=g,c=y):f*=.5}}return l&&(l[0]=Hn(e,r,i,u),l[1]=Hn(t,n,a,u)),Tu(c)}function x_t(e,t,r,n,i,a,o){for(var s=e,l=t,u=0,f=1/o,c=1;c<=o;c++){var h=c*f,d=Hn(e,r,i,h),v=Hn(t,n,a,h),p=d-s,g=v-l;u+=Math.sqrt(p*p+g*g),s=d,l=v}return u}var T_t=/cubic-bezier\(([0-9,\.e ]+)\)/;function Sse(e){var t=e&&T_t.exec(e);if(t){var r=t[1].split(","),n=+Ko(r[0]),i=+Ko(r[1]),a=+Ko(r[2]),o=+Ko(r[3]);if(isNaN(n+i+a+o))return;var s=[];return function(l){return l<=0?0:l>=1?1:xT(0,n,a,1,l,s)&&mn(0,i,o,1,s[0])}}}var O_t=function(){function e(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||Li,this.ondestroy=t.ondestroy||Li,this.onrestart=t.onrestart||Li,t.easing&&this.setEasing(t.easing)}return e.prototype.step=function(t,r){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=r;return}var n=this._life,i=t-this._startTime-this._pausedTime,a=i/n;a<0&&(a=0),a=Math.min(a,1);var o=this.easingFunc,s=o?o(a):a;if(this.onframe(s),a===1)if(this.loop){var l=i%n;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(t){this.easing=t,this.easingFunc=gt(t)?t:gse[t]||Sse(t)},e}();const E_t=O_t;var _se=function(){function e(t){this.value=t}return e}(),R_t=function(){function e(){this._len=0}return e.prototype.insert=function(t){var r=new _se(t);return this.insertEntry(r),r},e.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},e.prototype.remove=function(t){var r=t.prev,n=t.next;r?r.next=n:this.head=n,n?n.prev=r:this.tail=r,t.next=t.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),k_t=function(){function e(t){this._list=new R_t,this._maxSize=10,this._map={},this._maxSize=t}return e.prototype.put=function(t,r){var n=this._list,i=this._map,a=null;if(i[t]==null){var o=n.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var l=n.head;n.remove(l),delete i[l.key],a=l.value,this._lastRemovedEntry=l}s?s.value=r:s=new _se(r),s.key=t,n.insertEntry(s),i[t]=s}return a},e.prototype.get=function(t){var r=this._map[t],n=this._list;if(r!=null)return r!==n.tail&&(n.remove(r),n.insertEntry(r)),r.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}();const xS=k_t;var PY={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ou(e){return e=Math.round(e),e<0?0:e>255?255:e}function ON(e){return e<0?0:e>1?1:e}function BA(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?Ou(parseFloat(t)/100*255):Ou(parseInt(t,10))}function Lm(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?ON(parseFloat(t)/100):ON(parseFloat(t))}function VA(e,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?e+(t-e)*r*6:r*2<1?t:r*3<2?e+(t-e)*(2/3-r)*6:e}function J_(e,t,r){return e+(t-e)*r}function pa(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function EN(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var Cse=new xS(20),Q_=null;function td(e,t){Q_&&EN(Q_,t),Q_=Cse.put(e,Q_||t.slice())}function ll(e,t){if(e){t=t||[];var r=Cse.get(e);if(r)return EN(t,r);e=e+"";var n=e.replace(/ /g,"").toLowerCase();if(n in PY)return EN(t,PY[n]),td(e,t),t;var i=n.length;if(n.charAt(0)==="#"){if(i===4||i===5){var a=parseInt(n.slice(1,4),16);if(!(a>=0&&a<=4095)){pa(t,0,0,0,1);return}return pa(t,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,i===5?parseInt(n.slice(4),16)/15:1),td(e,t),t}else if(i===7||i===9){var a=parseInt(n.slice(1,7),16);if(!(a>=0&&a<=16777215)){pa(t,0,0,0,1);return}return pa(t,(a&16711680)>>16,(a&65280)>>8,a&255,i===9?parseInt(n.slice(7),16)/255:1),td(e,t),t}return}var o=n.indexOf("("),s=n.indexOf(")");if(o!==-1&&s+1===i){var l=n.substr(0,o),u=n.substr(o+1,s-(o+1)).split(","),f=1;switch(l){case"rgba":if(u.length!==4)return u.length===3?pa(t,+u[0],+u[1],+u[2],1):pa(t,0,0,0,1);f=Lm(u.pop());case"rgb":if(u.length>=3)return pa(t,BA(u[0]),BA(u[1]),BA(u[2]),u.length===3?f:Lm(u[3])),td(e,t),t;pa(t,0,0,0,1);return;case"hsla":if(u.length!==4){pa(t,0,0,0,1);return}return u[3]=Lm(u[3]),IY(u,t),td(e,t),t;case"hsl":if(u.length!==3){pa(t,0,0,0,1);return}return IY(u,t),td(e,t),t;default:return}}pa(t,0,0,0,1)}}function IY(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=Lm(e[1]),i=Lm(e[2]),a=i<=.5?i*(n+1):i+n-i*n,o=i*2-a;return t=t||[],pa(t,Ou(VA(o,a,r+1/3)*255),Ou(VA(o,a,r)*255),Ou(VA(o,a,r-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function MY(e,t){var r=ll(e);if(r){for(var n=0;n<3;n++)t<0?r[n]=r[n]*(1-t)|0:r[n]=(255-r[n])*t+r[n]|0,r[n]>255?r[n]=255:r[n]<0&&(r[n]=0);return yE(r,r.length===4?"rgba":"rgb")}}function A_t(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=ll(t[i]),s=ll(t[a]),l=n-i,u=yE([Ou(J_(o[0],s[0],l)),Ou(J_(o[1],s[1],l)),Ou(J_(o[2],s[2],l)),ON(J_(o[3],s[3],l))],"rgba");return r?{color:u,leftIndex:i,rightIndex:a,value:n}:u}}function yE(e,t){if(!(!e||!e.length)){var r=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+e[3]),t+"("+r+")"}}function ET(e,t){var r=ll(e);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*t:0}function P_t(e){return e.type==="linear"}function I_t(e){return e.type==="radial"}(function(){return Ht.hasGlobalWindow&&gt(window.btoa)?function(e){return window.btoa(unescape(encodeURIComponent(e)))}:typeof Buffer<"u"?function(e){return Buffer.from(e).toString("base64")}:function(e){return null}})();var RN=Array.prototype.slice;function Ts(e,t,r){return(t-e)*r+e}function jA(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=Ts(t[a],r[a],n);return e}function M_t(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=Ts(t[o][s],r[o][s],n)}return e}function e1(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=t[a]+r[a]*n;return e}function DY(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=t[o][s]+r[o][s]*n}return e}function D_t(e,t){for(var r=e.length,n=t.length,i=r>n?t:e,a=Math.min(r,n),o=i[a-1]||{color:[0,0,0,0],offset:0},s=a;s<Math.max(r,n);s++)i.push({offset:o.offset,color:o.color.slice()})}function N_t(e,t,r){var n=e,i=t;if(!(!n.push||!i.push)){var a=n.length,o=i.length;if(a!==o){var s=a>o;if(s)n.length=o;else for(var l=a;l<o;l++)n.push(r===1?i[l]:RN.call(i[l]))}for(var u=n[0]&&n[0].length,l=0;l<n.length;l++)if(r===1)isNaN(n[l])&&(n[l]=i[l]);else for(var f=0;f<u;f++)isNaN(n[l][f])&&(n[l][f]=i[l][f])}}function PC(e){if(Fi(e)){var t=e.length;if(Fi(e[0])){for(var r=[],n=0;n<t;n++)r.push(RN.call(e[n]));return r}return RN.call(e)}return e}function IC(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=e[3]==null?1:e[3],"rgba("+e.join(",")+")"}function L_t(e){return Fi(e&&e[0])?2:1}var t1=0,MC=1,xse=2,Qy=3,kN=4,AN=5,NY=6;function LY(e){return e===kN||e===AN}function r1(e){return e===MC||e===xse}var _y=[0,0,0,0],F_t=function(){function e(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(t,r,n){this._needsSort=!0;var i=this.keyframes,a=i.length,o=!1,s=NY,l=r;if(Fi(r)){var u=L_t(r);s=u,(u===1&&!Sr(r[0])||u===2&&!Sr(r[0][0]))&&(o=!0)}else if(Sr(r)&&!_T(r))s=t1;else if(st(r))if(!isNaN(+r))s=t1;else{var f=ll(r);f&&(l=f,s=Qy)}else if(pE(r)){var c=Ne({},l);c.colorStops=ct(r.colorStops,function(d){return{offset:d.offset,color:ll(d.color)}}),P_t(r)?s=kN:I_t(r)&&(s=AN),l=c}a===0?this.valType=s:(s!==this.valType||s===NY)&&(o=!0),this.discrete=this.discrete||o;var h={time:t,value:l,rawValue:r,percent:0};return n&&(h.easing=n,h.easingFunc=gt(n)?n:gse[n]||Sse(n)),i.push(h),h},e.prototype.prepare=function(t,r){var n=this.keyframes;this._needsSort&&n.sort(function(p,g){return p.time-g.time});for(var i=this.valType,a=n.length,o=n[a-1],s=this.discrete,l=r1(i),u=LY(i),f=0;f<a;f++){var c=n[f],h=c.value,d=o.value;c.percent=c.time/t,s||(l&&f!==a-1?N_t(h,d,i):u&&D_t(h.colorStops,d.colorStops))}if(!s&&i!==AN&&r&&this.needsAnimate()&&r.needsAnimate()&&i===r.valType&&!r._finished){this._additiveTrack=r;for(var v=n[0].value,f=0;f<a;f++)i===t1?n[f].additiveValue=n[f].value-v:i===Qy?n[f].additiveValue=e1([],n[f].value,v,-1):r1(i)&&(n[f].additiveValue=i===MC?e1([],n[f].value,v,-1):DY([],n[f].value,v,-1))}},e.prototype.step=function(t,r){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var n=this._additiveTrack!=null,i=n?"additiveValue":"value",a=this.valType,o=this.keyframes,s=o.length,l=this.propName,u=a===Qy,f,c=this._lastFr,h=Math.min,d,v;if(s===1)d=v=o[0];else{if(r<0)f=0;else if(r<this._lastFrP){var p=h(c+1,s-1);for(f=p;f>=0&&!(o[f].percent<=r);f--);f=h(f,s-2)}else{for(f=c;f<s&&!(o[f].percent>r);f++);f=h(f-1,s-2)}v=o[f+1],d=o[f]}if(d&&v){this._lastFr=f,this._lastFrP=r;var g=v.percent-d.percent,y=g===0?1:h((r-d.percent)/g,1);v.easingFunc&&(y=v.easingFunc(y));var m=n?this._additiveValue:u?_y:t[l];if((r1(a)||u)&&!m&&(m=this._additiveValue=[]),this.discrete)t[l]=y<1?d.rawValue:v.rawValue;else if(r1(a))a===MC?jA(m,d[i],v[i],y):M_t(m,d[i],v[i],y);else if(LY(a)){var b=d[i],S=v[i],x=a===kN;t[l]={type:x?"linear":"radial",x:Ts(b.x,S.x,y),y:Ts(b.y,S.y,y),colorStops:ct(b.colorStops,function(E,P){var R=S.colorStops[P];return{offset:Ts(E.offset,R.offset,y),color:IC(jA([],E.color,R.color,y))}}),global:S.global},x?(t[l].x2=Ts(b.x2,S.x2,y),t[l].y2=Ts(b.y2,S.y2,y)):t[l].r=Ts(b.r,S.r,y)}else if(u)jA(m,d[i],v[i],y),n||(t[l]=IC(m));else{var T=Ts(d[i],v[i],y);n?this._additiveValue=T:t[l]=T}n&&this._addToTarget(t)}}},e.prototype._addToTarget=function(t){var r=this.valType,n=this.propName,i=this._additiveValue;r===t1?t[n]=t[n]+i:r===Qy?(ll(t[n],_y),e1(_y,_y,i,1),t[n]=IC(_y)):r===MC?e1(t[n],t[n],i,1):r===xse&&DY(t[n],t[n],i,1)},e}(),$_t=function(){function e(t,r,n,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=r,r&&i){s3("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=n}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(t){this._target=t},e.prototype.when=function(t,r,n){return this.whenWithKeys(t,r,Lr(r),n)},e.prototype.whenWithKeys=function(t,r,n,i){for(var a=this._tracks,o=0;o<n.length;o++){var s=n[o],l=a[s];if(!l){l=a[s]=new F_t(s);var u=void 0,f=this._getAdditiveTrack(s);if(f){var c=f.keyframes,h=c[c.length-1];u=h&&h.value,f.valType===Qy&&u&&(u=IC(u))}else u=this._target[s];if(u==null)continue;t>0&&l.addKeyframe(0,PC(u),i),this._trackKeys.push(s)}l.addKeyframe(t,PC(r[s]),i)}return this._maxTime=Math.max(this._maxTime,t),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var r=t.length,n=0;n<r;n++)t[n].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,r=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,r)for(var n=0;n<r.length;n++)r[n].call(this)},e.prototype._setTracksFinished=function(){for(var t=this._tracks,r=this._trackKeys,n=0;n<r.length;n++)t[r[n]].setFinished()},e.prototype._getAdditiveTrack=function(t){var r,n=this._additiveAnimators;if(n)for(var i=0;i<n.length;i++){var a=n[i].getTrack(t);a&&(r=a)}return r},e.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var r=this,n=[],i=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var o=this._trackKeys[a],s=this._tracks[o],l=this._getAdditiveTrack(o),u=s.keyframes,f=u.length;if(s.prepare(i,l),s.needsAnimate())if(!this._allowDiscrete&&s.discrete){var c=u[f-1];c&&(r._target[s.propName]=c.rawValue),s.setFinished()}else n.push(s)}if(n.length||this._force){var h=new E_t({life:i,loop:this._loop,delay:this._delay||0,onframe:function(d){r._started=2;var v=r._additiveAnimators;if(v){for(var p=!1,g=0;g<v.length;g++)if(v[g]._clip){p=!0;break}p||(r._additiveAnimators=null)}for(var g=0;g<n.length;g++)n[g].step(r._target,d);var y=r._onframeCbs;if(y)for(var g=0;g<y.length;g++)y[g](r._target,d)},ondestroy:function(){r._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),t&&h.setEasing(t)}else this._doneCallback();return this}},e.prototype.stop=function(t){if(this._clip){var r=this._clip;t&&r.onframe(1),this._abortedCallback()}},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},e.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},e.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(t){return this._tracks[t]},e.prototype.getTracks=function(){var t=this;return ct(this._trackKeys,function(r){return t._tracks[r]})},e.prototype.stopTracks=function(t,r){if(!t.length||!this._clip)return!0;for(var n=this._tracks,i=this._trackKeys,a=0;a<t.length;a++){var o=n[t[a]];o&&!o.isFinished()&&(r?o.step(this._target,1):this._started===1&&o.step(this._target,0),o.setFinished())}for(var s=!0,a=0;a<i.length;a++)if(!n[i[a]].isFinished()){s=!1;break}return s&&this._abortedCallback(),s},e.prototype.saveTo=function(t,r,n){if(t){r=r||this._trackKeys;for(var i=0;i<r.length;i++){var a=r[i],o=this._tracks[a];if(!(!o||o.isFinished())){var s=o.keyframes,l=s[n?0:s.length-1];l&&(t[a]=PC(l.rawValue))}}}},e.prototype.__changeFinalValue=function(t,r){r=r||Lr(t);for(var n=0;n<r.length;n++){var i=r[n],a=this._tracks[i];if(a){var o=a.keyframes;if(o.length>1){var s=o.pop();a.addKeyframe(s.time,t[i]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},e}();const d3=$_t;function kd(){return new Date().getTime()}var H_t=function(e){je(t,e);function t(r){var n=e.call(this)||this;return n._running=!1,n._time=0,n._pausedTime=0,n._pauseStart=0,n._paused=!1,r=r||{},n.stage=r.stage||{},n}return t.prototype.addClip=function(r){r.animation&&this.removeClip(r),this._head?(this._tail.next=r,r.prev=this._tail,r.next=null,this._tail=r):this._head=this._tail=r,r.animation=this},t.prototype.addAnimator=function(r){r.animation=this;var n=r.getClip();n&&this.addClip(n)},t.prototype.removeClip=function(r){if(r.animation){var n=r.prev,i=r.next;n?n.next=i:this._head=i,i?i.prev=n:this._tail=n,r.next=r.prev=r.animation=null}},t.prototype.removeAnimator=function(r){var n=r.getClip();n&&this.removeClip(n),r.animation=null},t.prototype.update=function(r){for(var n=kd()-this._pausedTime,i=n-this._time,a=this._head;a;){var o=a.next,s=a.step(n,i);s&&(a.ondestroy(),this.removeClip(a)),a=o}this._time=n,r||(this.trigger("frame",i),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var r=this;this._running=!0;function n(){r._running&&(TN(n),!r._paused&&r.update())}TN(n)},t.prototype.start=function(){this._running||(this._time=kd(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=kd(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=kd()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var r=this._head;r;){var n=r.next;r.prev=r.next=r.animation=null,r=n}this._head=this._tail=null},t.prototype.isFinished=function(){return this._head==null},t.prototype.animate=function(r,n){n=n||{},this.start();var i=new d3(r,n.loop);return this.addAnimator(i),i},t}(cs);const B_t=H_t;var V_t=300,WA=Ht.domSupported,UA=function(){var e=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t=["touchstart","touchend","touchmove"],r={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},n=ct(e,function(i){var a=i.replace("mouse","pointer");return r.hasOwnProperty(a)?a:i});return{mouse:e,touch:t,pointer:n}}(),FY={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},$Y=!1;function PN(e){var t=e.pointerType;return t==="pen"||t==="touch"}function j_t(e){e.touching=!0,e.touchTimer!=null&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout(function(){e.touching=!1,e.touchTimer=null},700)}function zA(e){e&&(e.zrByTouch=!0)}function W_t(e,t){return ya(e.dom,new U_t(e,t),!0)}function Tse(e,t){for(var r=t,n=!1;r&&r.nodeType!==9&&!(n=r.domBelongToZr||r!==t&&r===e.painterRoot);)r=r.parentNode;return n}var U_t=function(){function e(t,r){this.stopPropagation=Li,this.stopImmediatePropagation=Li,this.preventDefault=Li,this.type=r.type,this.target=this.currentTarget=t.dom,this.pointerType=r.pointerType,this.clientX=r.clientX,this.clientY=r.clientY}return e}(),Ja={mousedown:function(e){e=ya(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=ya(this.dom,e);var t=this.__mayPointerCapture;t&&(e.zrX!==t[0]||e.zrY!==t[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=ya(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){e=ya(this.dom,e);var t=e.toElement||e.relatedTarget;Tse(this,t)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){$Y=!0,e=ya(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){$Y||(e=ya(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){e=ya(this.dom,e),zA(e),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),Ja.mousemove.call(this,e),Ja.mousedown.call(this,e)},touchmove:function(e){e=ya(this.dom,e),zA(e),this.handler.processGesture(e,"change"),Ja.mousemove.call(this,e)},touchend:function(e){e=ya(this.dom,e),zA(e),this.handler.processGesture(e,"end"),Ja.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<V_t&&Ja.click.call(this,e)},pointerdown:function(e){Ja.mousedown.call(this,e)},pointermove:function(e){PN(e)||Ja.mousemove.call(this,e)},pointerup:function(e){Ja.mouseup.call(this,e)},pointerout:function(e){PN(e)||Ja.mouseout.call(this,e)}};le(["click","dblclick","contextmenu"],function(e){Ja[e]=function(t){t=ya(this.dom,t),this.trigger(e,t)}});var IN={pointermove:function(e){PN(e)||IN.mousemove.call(this,e)},pointerup:function(e){IN.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function z_t(e,t){var r=t.domHandlers;Ht.pointerEventsSupported?le(UA.pointer,function(n){DC(t,n,function(i){r[n].call(e,i)})}):(Ht.touchEventsSupported&&le(UA.touch,function(n){DC(t,n,function(i){r[n].call(e,i),j_t(t)})}),le(UA.mouse,function(n){DC(t,n,function(i){i=u3(i),t.touching||r[n].call(e,i)})}))}function G_t(e,t){Ht.pointerEventsSupported?le(FY.pointer,r):Ht.touchEventsSupported||le(FY.mouse,r);function r(n){function i(a){a=u3(a),Tse(e,a.target)||(a=W_t(e,a),t.domHandlers[n].call(e,a))}DC(t,n,i,{capture:!0})}}function DC(e,t,r,n){e.mounted[t]=r,e.listenerOpts[t]=n,t_t(e.domTarget,t,r,n)}function GA(e){var t=e.mounted;for(var r in t)t.hasOwnProperty(r)&&r_t(e.domTarget,r,t[r],e.listenerOpts[r]);e.mounted={}}var HY=function(){function e(t,r){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=r}return e}(),Y_t=function(e){je(t,e);function t(r,n){var i=e.call(this)||this;return i.__pointerCapturing=!1,i.dom=r,i.painterRoot=n,i._localHandlerScope=new HY(r,Ja),WA&&(i._globalHandlerScope=new HY(document,IN)),z_t(i,i._localHandlerScope),i}return t.prototype.dispose=function(){GA(this._localHandlerScope),WA&&GA(this._globalHandlerScope)},t.prototype.setCursor=function(r){this.dom.style&&(this.dom.style.cursor=r||"default")},t.prototype.__togglePointerCapture=function(r){if(this.__mayPointerCapture=null,WA&&+this.__pointerCapturing^+r){this.__pointerCapturing=r;var n=this._globalHandlerScope;r?G_t(this,n):GA(n)}},t}(cs);const K_t=Y_t;var Ose=1;Ht.hasGlobalWindow&&(Ose=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var RT=Ose,MN=.4,DN="#333",NN="#ccc",X_t="#eee",BY=f3,VY=5e-5;function pf(e){return e>VY||e<-VY}var gf=[],rd=[],YA=cw(),KA=Math.abs,v3=function(){function e(){}return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},e.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},e.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},e.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},e.prototype.needLocalTransform=function(){return pf(this.rotation)||pf(this.x)||pf(this.y)||pf(this.scaleX-1)||pf(this.scaleY-1)||pf(this.skewX)||pf(this.skewY)},e.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,r=this.needLocalTransform(),n=this.transform;if(!(r||t)){n&&BY(n);return}n=n||cw(),r?this.getLocalTransform(n):BY(n),t&&(r?Zd(n,t,n):a_t(n,t)),this.transform=n,this._resolveGlobalScaleRatio(n)},e.prototype._resolveGlobalScaleRatio=function(t){var r=this.globalScaleRatio;if(r!=null&&r!==1){this.getGlobalScale(gf);var n=gf[0]<0?-1:1,i=gf[1]<0?-1:1,a=((gf[0]-n)*r+n)/gf[0]||0,o=((gf[1]-i)*r+i)/gf[1]||0;t[0]*=a,t[1]*=a,t[2]*=o,t[3]*=o}this.invTransform=this.invTransform||cw(),h3(this.invTransform,t)},e.prototype.getComputedTransform=function(){for(var t=this,r=[];t;)r.push(t),t=t.parent;for(;t=r.pop();)t.updateTransform();return this.transform},e.prototype.setLocalTransform=function(t){if(t){var r=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],i=Math.atan2(t[1],t[0]),a=Math.PI/2+i-Math.atan2(t[3],t[2]);n=Math.sqrt(n)*Math.cos(a),r=Math.sqrt(r),this.skewX=a,this.skewY=0,this.rotation=-i,this.x=+t[4],this.y=+t[5],this.scaleX=r,this.scaleY=n,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,r=this.transform;t&&t.transform&&(Zd(rd,t.invTransform,r),r=rd);var n=this.originX,i=this.originY;(n||i)&&(YA[4]=n,YA[5]=i,Zd(rd,r,YA),rd[4]-=n,rd[5]-=i,r=rd),this.setLocalTransform(r)}},e.prototype.getGlobalScale=function(t){var r=this.transform;return t=t||[],r?(t[0]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),t[1]=Math.sqrt(r[2]*r[2]+r[3]*r[3]),r[0]<0&&(t[0]=-t[0]),r[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},e.prototype.transformCoordToLocal=function(t,r){var n=[t,r],i=this.invTransform;return i&&ka(n,n,i),n},e.prototype.transformCoordToGlobal=function(t,r){var n=[t,r],i=this.transform;return i&&ka(n,n,i),n},e.prototype.getLineScale=function(){var t=this.transform;return t&&KA(t[0]-1)>1e-10&&KA(t[3]-1)>1e-10?Math.sqrt(KA(t[0]*t[3]-t[2]*t[1])):1},e.prototype.copyTransform=function(t){q_t(this,t)},e.getLocalTransform=function(t,r){r=r||[];var n=t.originX||0,i=t.originY||0,a=t.scaleX,o=t.scaleY,s=t.anchorX,l=t.anchorY,u=t.rotation||0,f=t.x,c=t.y,h=t.skewX?Math.tan(t.skewX):0,d=t.skewY?Math.tan(-t.skewY):0;if(n||i||s||l){var v=n+s,p=i+l;r[4]=-v*a-h*p*o,r[5]=-p*o-d*v*a}else r[4]=r[5]=0;return r[0]=a,r[3]=o,r[1]=d*a,r[2]=h*o,u&&c3(r,r,u),r[4]+=n+f,r[5]+=i+c,r},e.initDefaultProps=function(){var t=e.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),e}(),hw=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function q_t(e,t){for(var r=0;r<hw.length;r++){var n=hw[r];e[n]=t[n]}}var jY={};function ta(e,t){t=t||Gc;var r=jY[t];r||(r=jY[t]=new xS(500));var n=r.get(e);return n==null&&(n=Lg.measureText(e,t).width,r.put(e,n)),n}function WY(e,t,r,n){var i=ta(e,t),a=g3(t),o=em(0,i,r),s=wd(0,a,n),l=new ur(o,s,i,a);return l}function p3(e,t,r,n){var i=((e||"")+"").split(`
`),a=i.length;if(a===1)return WY(i[0],t,r,n);for(var o=new ur(0,0,0,0),s=0;s<i.length;s++){var l=WY(i[s],t,r,n);s===0?o.copy(l):o.union(l)}return o}function em(e,t,r){return r==="right"?e-=t:r==="center"&&(e-=t/2),e}function wd(e,t,r){return r==="middle"?e-=t/2:r==="bottom"&&(e-=t),e}function g3(e){return ta("å½",e)}function Fu(e,t){return typeof e=="string"?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function kT(e,t,r){var n=t.position||"inside",i=t.distance!=null?t.distance:5,a=r.height,o=r.width,s=a/2,l=r.x,u=r.y,f="left",c="top";if(n instanceof Array)l+=Fu(n[0],r.width),u+=Fu(n[1],r.height),f=null,c=null;else switch(n){case"left":l-=i,u+=s,f="right",c="middle";break;case"right":l+=i+o,u+=s,c="middle";break;case"top":l+=o/2,u-=i,f="center",c="bottom";break;case"bottom":l+=o/2,u+=a+i,f="center";break;case"inside":l+=o/2,u+=s,f="center",c="middle";break;case"insideLeft":l+=i,u+=s,c="middle";break;case"insideRight":l+=o-i,u+=s,f="right",c="middle";break;case"insideTop":l+=o/2,u+=i,f="center";break;case"insideBottom":l+=o/2,u+=a-i,f="center",c="bottom";break;case"insideTopLeft":l+=i,u+=i;break;case"insideTopRight":l+=o-i,u+=i,f="right";break;case"insideBottomLeft":l+=i,u+=a-i,c="bottom";break;case"insideBottomRight":l+=o-i,u+=a-i,f="right",c="bottom";break}return e=e||{},e.x=l,e.y=u,e.align=f,e.verticalAlign=c,e}var XA="__zr_normal__",qA=hw.concat(["ignore"]),Z_t=Lu(hw,function(e,t){return e[t]=!0,e},{ignore:!1}),nd={},J_t=new ur(0,0,0,0),y3=function(){function e(t){this.id=ise(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return e.prototype._init=function(t){this.attr(t)},e.prototype.drift=function(t,r,n){switch(this.draggable){case"horizontal":r=0;break;case"vertical":t=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=r,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(t){var r=this._textContent;if(r&&(!r.ignore||t)){this.textConfig||(this.textConfig={});var n=this.textConfig,i=n.local,a=r.innerTransformable,o=void 0,s=void 0,l=!1;a.parent=i?this:null;var u=!1;if(a.copyTransform(r),n.position!=null){var f=J_t;n.layoutRect?f.copy(n.layoutRect):f.copy(this.getBoundingRect()),i||f.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(nd,n,f):kT(nd,n,f),a.x=nd.x,a.y=nd.y,o=nd.align,s=nd.verticalAlign;var c=n.origin;if(c&&n.rotation!=null){var h=void 0,d=void 0;c==="center"?(h=f.width*.5,d=f.height*.5):(h=Fu(c[0],f.width),d=Fu(c[1],f.height)),u=!0,a.originX=-a.x+h+(i?0:f.x),a.originY=-a.y+d+(i?0:f.y)}}n.rotation!=null&&(a.rotation=n.rotation);var v=n.offset;v&&(a.x+=v[0],a.y+=v[1],u||(a.originX=-v[0],a.originY=-v[1]));var p=n.inside==null?typeof n.position=="string"&&n.position.indexOf("inside")>=0:n.inside,g=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),y=void 0,m=void 0,b=void 0;p&&this.canBeInsideText()?(y=n.insideFill,m=n.insideStroke,(y==null||y==="auto")&&(y=this.getInsideTextFill()),(m==null||m==="auto")&&(m=this.getInsideTextStroke(y),b=!0)):(y=n.outsideFill,m=n.outsideStroke,(y==null||y==="auto")&&(y=this.getOutsideFill()),(m==null||m==="auto")&&(m=this.getOutsideStroke(y),b=!0)),y=y||"#000",(y!==g.fill||m!==g.stroke||b!==g.autoStroke||o!==g.align||s!==g.verticalAlign)&&(l=!0,g.fill=y,g.stroke=m,g.autoStroke=b,g.align=o,g.verticalAlign=s,r.setDefaultTextStyle(g)),r.__dirty|=Ji,l&&r.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(t){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?NN:DN},e.prototype.getOutsideStroke=function(t){var r=this.__zr&&this.__zr.getBackgroundColor(),n=typeof r=="string"&&ll(r);n||(n=[255,255,255,1]);for(var i=n[3],a=this.__zr.isDarkMode(),o=0;o<3;o++)n[o]=n[o]*i+(a?0:255)*(1-i);return n[3]=1,yE(n,"rgba")},e.prototype.traverse=function(t,r){},e.prototype.attrKV=function(t,r){t==="textConfig"?this.setTextConfig(r):t==="textContent"?this.setTextContent(r):t==="clipPath"?this.setClipPath(r):t==="extra"?(this.extra=this.extra||{},Ne(this.extra,r)):this[t]=r},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(t,r){if(typeof t=="string")this.attrKV(t,r);else if(vt(t))for(var n=t,i=Lr(n),a=0;a<i.length;a++){var o=i[a];this.attrKV(o,t[o])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var r=this._normalState,n=0;n<this.animators.length;n++){var i=this.animators[n],a=i.__fromStateTransition;if(!(i.getLoop()||a&&a!==XA)){var o=i.targetName,s=o?r[o]:r;i.saveTo(s)}}},e.prototype._innerSaveToNormal=function(t){var r=this._normalState;r||(r=this._normalState={}),t.textConfig&&!r.textConfig&&(r.textConfig=this.textConfig),this._savePrimaryToNormal(t,r,qA)},e.prototype._savePrimaryToNormal=function(t,r,n){for(var i=0;i<n.length;i++){var a=n[i];t[a]!=null&&!(a in r)&&(r[a]=this[a])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(t){return this.states[t]},e.prototype.ensureState=function(t){var r=this.states;return r[t]||(r[t]={}),r[t]},e.prototype.clearStates=function(t){this.useState(XA,!1,t)},e.prototype.useState=function(t,r,n,i){var a=t===XA,o=this.hasState();if(!(!o&&a)){var s=this.currentStates,l=this.stateTransition;if(!(ar(s,t)>=0&&(r||s.length===1))){var u;if(this.stateProxy&&!a&&(u=this.stateProxy(t)),u||(u=this.states&&this.states[t]),!u&&!a){s3("State "+t+" not exists.");return}a||this.saveCurrentToNormalState(u);var f=!!(u&&u.hoverLayer||i);f&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,u,this._normalState,r,!n&&!this.__inHover&&l&&l.duration>0,l);var c=this._textContent,h=this._textGuide;return c&&c.useState(t,r,n,f),h&&h.useState(t,r,n,f),a?(this.currentStates=[],this._normalState={}):r?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!f&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Ji),u}}},e.prototype.useStates=function(t,r,n){if(!t.length)this.clearStates();else{var i=[],a=this.currentStates,o=t.length,s=o===a.length;if(s){for(var l=0;l<o;l++)if(t[l]!==a[l]){s=!1;break}}if(s)return;for(var l=0;l<o;l++){var u=t[l],f=void 0;this.stateProxy&&(f=this.stateProxy(u,t)),f||(f=this.states[u]),f&&i.push(f)}var c=i[o-1],h=!!(c&&c.hoverLayer||n);h&&this._toggleHoverLayerFlag(!0);var d=this._mergeStates(i),v=this.stateTransition;this.saveCurrentToNormalState(d),this._applyStateObj(t.join(","),d,this._normalState,!1,!r&&!this.__inHover&&v&&v.duration>0,v);var p=this._textContent,g=this._textGuide;p&&p.useStates(t,r,h),g&&g.useStates(t,r,h),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Ji)}},e.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var r=this.animators[t];r.targetName&&r.changeTarget(this[r.targetName])}},e.prototype.removeState=function(t){var r=ar(this.currentStates,t);if(r>=0){var n=this.currentStates.slice();n.splice(r,1),this.useStates(n)}},e.prototype.replaceState=function(t,r,n){var i=this.currentStates.slice(),a=ar(i,t),o=ar(i,r)>=0;a>=0?o?i.splice(a,1):i[a]=r:n&&!o&&i.push(r),this.useStates(i)},e.prototype.toggleState=function(t,r){r?this.useState(t,!0):this.removeState(t)},e.prototype._mergeStates=function(t){for(var r={},n,i=0;i<t.length;i++){var a=t[i];Ne(r,a),a.textConfig&&(n=n||{},Ne(n,a.textConfig))}return n&&(r.textConfig=n),r},e.prototype._applyStateObj=function(t,r,n,i,a,o){var s=!(r&&i);r&&r.textConfig?(this.textConfig=Ne({},i?this.textConfig:n.textConfig),Ne(this.textConfig,r.textConfig)):s&&n.textConfig&&(this.textConfig=n.textConfig);for(var l={},u=!1,f=0;f<qA.length;f++){var c=qA[f],h=a&&Z_t[c];r&&r[c]!=null?h?(u=!0,l[c]=r[c]):this[c]=r[c]:s&&n[c]!=null&&(h?(u=!0,l[c]=n[c]):this[c]=n[c])}if(!a)for(var f=0;f<this.animators.length;f++){var d=this.animators[f],v=d.targetName;d.getLoop()||d.__changeFinalValue(v?(r||n)[v]:r||n)}u&&this._transitionState(t,l,o)},e.prototype._attachComponent=function(t){if(!(t.__zr&&!t.__hostTarget)&&t!==this){var r=this.__zr;r&&t.addSelfToZr(r),t.__zr=r,t.__hostTarget=this}},e.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},e.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(t){var r=this._textContent;r!==t&&(r&&r!==t&&this.removeTextContent(),t.innerTransformable=new v3,this._attachComponent(t),this._textContent=t,this.markRedraw())},e.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),Ne(this.textConfig,t),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=Ji;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var r=this._textContent,n=this._textGuide;r&&(r.__inHover=t),n&&(n.__inHover=t)},e.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.addAnimator(r[n]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.removeAnimator(r[n]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},e.prototype.animate=function(t,r,n){var i=t?this[t]:this,a=new d3(i,r,n);return t&&(a.targetName=t),this.addAnimator(a,t),a},e.prototype.addAnimator=function(t,r){var n=this.__zr,i=this;t.during(function(){i.updateDuringAnimation(r)}).done(function(){var a=i.animators,o=ar(a,t);o>=0&&a.splice(o,1)}),this.animators.push(t),n&&n.animation.addAnimator(t),n&&n.wakeUp()},e.prototype.updateDuringAnimation=function(t){this.markRedraw()},e.prototype.stopAnimation=function(t,r){for(var n=this.animators,i=n.length,a=[],o=0;o<i;o++){var s=n[o];!t||t===s.scope?s.stop(r):a.push(s)}return this.animators=a,this},e.prototype.animateTo=function(t,r,n){ZA(this,t,r,n)},e.prototype.animateFrom=function(t,r,n){ZA(this,t,r,n,!0)},e.prototype._transitionState=function(t,r,n,i){for(var a=ZA(this,r,n,i),o=0;o<a.length;o++)a[o].__fromStateTransition=t},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=Ji;function r(n,i,a,o){Object.defineProperty(t,n,{get:function(){if(!this[i]){var l=this[i]=[];s(this,l)}return this[i]},set:function(l){this[a]=l[0],this[o]=l[1],this[i]=l,s(this,l)}});function s(l,u){Object.defineProperty(u,0,{get:function(){return l[a]},set:function(f){l[a]=f}}),Object.defineProperty(u,1,{get:function(){return l[o]},set:function(f){l[o]=f}})}}Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),e}();_o(y3,cs);_o(y3,v3);function ZA(e,t,r,n,i){r=r||{};var a=[];Ese(e,"",e,t,r,n,a,i);var o=a.length,s=!1,l=r.done,u=r.aborted,f=function(){s=!0,o--,o<=0&&(s?l&&l():u&&u())},c=function(){o--,o<=0&&(s?l&&l():u&&u())};o||l&&l(),a.length>0&&r.during&&a[0].during(function(v,p){r.during(p)});for(var h=0;h<a.length;h++){var d=a[h];f&&d.done(f),c&&d.aborted(c),r.force&&d.duration(r.duration),d.start(r.easing)}return a}function JA(e,t,r){for(var n=0;n<r;n++)e[n]=t[n]}function Q_t(e){return Fi(e[0])}function e1t(e,t,r){if(Fi(t[r]))if(Fi(e[r])||(e[r]=[]),aa(t[r])){var n=t[r].length;e[r].length!==n&&(e[r]=new t[r].constructor(n),JA(e[r],t[r],n))}else{var i=t[r],a=e[r],o=i.length;if(Q_t(i))for(var s=i[0].length,l=0;l<o;l++)a[l]?JA(a[l],i[l],s):a[l]=Array.prototype.slice.call(i[l]);else JA(a,i,o);a.length=i.length}else e[r]=t[r]}function t1t(e,t){return e===t||Fi(e)&&Fi(t)&&r1t(e,t)}function r1t(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Ese(e,t,r,n,i,a,o,s){for(var l=Lr(n),u=i.duration,f=i.delay,c=i.additive,h=i.setToFinal,d=!vt(a),v=e.animators,p=[],g=0;g<l.length;g++){var y=l[g],m=n[y];if(m!=null&&r[y]!=null&&(d||a[y]))if(vt(m)&&!Fi(m)&&!pE(m)){if(t){s||(r[y]=m,e.updateDuringAnimation(t));continue}Ese(e,y,r[y],m,i,a&&a[y],o,s)}else p.push(y);else s||(r[y]=m,e.updateDuringAnimation(t),p.push(y))}var b=p.length;if(!c&&b)for(var S=0;S<v.length;S++){var x=v[S];if(x.targetName===t){var T=x.stopTracks(p);if(T){var E=ar(v,x);v.splice(E,1)}}}if(i.force||(p=Wn(p,function(D){return!t1t(n[D],r[D])}),b=p.length),b>0||i.force&&!o.length){var P=void 0,R=void 0,M=void 0;if(s){R={},h&&(P={});for(var S=0;S<b;S++){var y=p[S];R[y]=r[y],h?P[y]=n[y]:r[y]=n[y]}}else if(h){M={};for(var S=0;S<b;S++){var y=p[S];M[y]=PC(r[y]),e1t(r,n,y)}}var x=new d3(r,!1,!1,c?Wn(v,function(N){return N.targetName===t}):null);x.targetName=t,i.scope&&(x.scope=i.scope),h&&P&&x.whenWithKeys(0,P,p),M&&x.whenWithKeys(0,M,p),x.whenWithKeys(u??500,s?R:n,p).delay(f||0),e.addAnimator(x,t),o.push(x)}}const Rse=y3;var kse=function(e){je(t,e);function t(r){var n=e.call(this)||this;return n.isGroup=!0,n._children=[],n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(r){return this._children[r]},t.prototype.childOfName=function(r){for(var n=this._children,i=0;i<n.length;i++)if(n[i].name===r)return n[i]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(r){return r&&r!==this&&r.parent!==this&&(this._children.push(r),this._doAdd(r)),this},t.prototype.addBefore=function(r,n){if(r&&r!==this&&r.parent!==this&&n&&n.parent===this){var i=this._children,a=i.indexOf(n);a>=0&&(i.splice(a,0,r),this._doAdd(r))}return this},t.prototype.replace=function(r,n){var i=ar(this._children,r);return i>=0&&this.replaceAt(n,i),this},t.prototype.replaceAt=function(r,n){var i=this._children,a=i[n];if(r&&r!==this&&r.parent!==this&&r!==a){i[n]=r,a.parent=null;var o=this.__zr;o&&a.removeSelfFromZr(o),this._doAdd(r)}return this},t.prototype._doAdd=function(r){r.parent&&r.parent.remove(r),r.parent=this;var n=this.__zr;n&&n!==r.__zr&&r.addSelfToZr(n),n&&n.refresh()},t.prototype.remove=function(r){var n=this.__zr,i=this._children,a=ar(i,r);return a<0?this:(i.splice(a,1),r.parent=null,n&&r.removeSelfFromZr(n),n&&n.refresh(),this)},t.prototype.removeAll=function(){for(var r=this._children,n=this.__zr,i=0;i<r.length;i++){var a=r[i];n&&a.removeSelfFromZr(n),a.parent=null}return r.length=0,this},t.prototype.eachChild=function(r,n){for(var i=this._children,a=0;a<i.length;a++){var o=i[a];r.call(n,o,a)}return this},t.prototype.traverse=function(r,n){for(var i=0;i<this._children.length;i++){var a=this._children[i],o=r.call(n,a);a.isGroup&&!o&&a.traverse(r,n)}return this},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.addSelfToZr(r)}},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.removeSelfFromZr(r)}},t.prototype.getBoundingRect=function(r){for(var n=new ur(0,0,0,0),i=r||this._children,a=[],o=null,s=0;s<i.length;s++){var l=i[s];if(!(l.ignore||l.invisible)){var u=l.getBoundingRect(),f=l.getLocalTransform(a);f?(ur.applyTransform(n,u,f),o=o||n.clone(),o.union(n)):(o=o||u.clone(),o.union(u))}}return o||n},t}(Rse);kse.prototype.type="group";const Zn=kse;/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var NC={},Ase={};function n1t(e){delete Ase[e]}function i1t(e){if(!e)return!1;if(typeof e=="string")return ET(e,1)<MN;if(e.colorStops){for(var t=e.colorStops,r=0,n=t.length,i=0;i<n;i++)r+=ET(t[i].color,1);return r/=n,r<MN}return!1}var a1t=function(){function e(t,r,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=r,this.id=t;var a=new b_t,o=n.renderer||"canvas";NC[o]||(o=Lr(NC)[0]),n.useDirtyRect=n.useDirtyRect==null?!1:n.useDirtyRect;var s=new NC[o](r,a,n,t),l=n.ssr||s.ssrOnly;this.storage=a,this.painter=s;var u=!Ht.node&&!Ht.worker&&!l?new K_t(s.getViewportRoot(),s.root):null,f=n.useCoarsePointer,c=f==null||f==="auto"?Ht.touchEventsSupported:!!f,h=44,d;c&&(d=qt(n.pointerSize,h)),this.handler=new v_t(a,s,u,s.root,d),this.animation=new B_t({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return e.prototype.add=function(t){t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},e.prototype.remove=function(t){t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(t,r){this.painter.configLayer&&this.painter.configLayer(t,r),this.refresh()},e.prototype.setBackgroundColor=function(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=i1t(t)},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(t){this._darkMode=t},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(t){t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},e.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},e.prototype.flush=function(){this._flush(!1)},e.prototype._flush=function(t){var r,n=kd();this._needsRefresh&&(r=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var i=kd();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},e.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover()},e.prototype.resize=function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},e.prototype.clearAnimation=function(){this.animation.clear()},e.prototype.getWidth=function(){return this.painter.getWidth()},e.prototype.getHeight=function(){return this.painter.getHeight()},e.prototype.setCursorStyle=function(t){this.handler.setCursorStyle(t)},e.prototype.findHover=function(t,r){return this.handler.findHover(t,r)},e.prototype.on=function(t,r,n){return this.handler.on(t,r,n),this},e.prototype.off=function(t,r){this.handler.off(t,r)},e.prototype.trigger=function(t,r){this.handler.trigger(t,r)},e.prototype.clear=function(){for(var t=this.storage.getRoots(),r=0;r<t.length;r++)t[r]instanceof Zn&&t[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},e.prototype.dispose=function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,n1t(this.id)},e}();function UY(e,t){var r=new a1t(ise(),e,t);return Ase[r.id]=r,r}function o1t(e,t){NC[e]=t}var zY=1e-4,Pse=20;function s1t(e){return e.replace(/^\s+|\s+$/g,"")}function LN(e,t,r,n){var i=t[0],a=t[1],o=r[0],s=r[1],l=a-i,u=s-o;if(l===0)return u===0?o:(o+s)/2;if(n)if(l>0){if(e<=i)return o;if(e>=a)return s}else{if(e>=i)return o;if(e<=a)return s}else{if(e===i)return o;if(e===a)return s}return(e-i)/l*u+o}function xr(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%";break}return st(e)?s1t(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):e==null?NaN:+e}function vn(e,t,r){return t==null&&(t=10),t=Math.min(Math.max(0,t),Pse),e=(+e).toFixed(t),r?e:+e}function Xo(e){if(e=+e,isNaN(e))return 0;if(e>1e-14){for(var t=1,r=0;r<15;r++,t*=10)if(Math.round(e*t)/t===e)return r}return l1t(e)}function l1t(e){var t=e.toString().toLowerCase(),r=t.indexOf("e"),n=r>0?+t.slice(r+1):0,i=r>0?r:t.length,a=t.indexOf("."),o=a<0?0:i-1-a;return Math.max(0,o-n)}function u1t(e,t){var r=Math.log,n=Math.LN10,i=Math.floor(r(e[1]-e[0])/n),a=Math.round(r(Math.abs(t[1]-t[0]))/n),o=Math.min(Math.max(-i+a,0),20);return isFinite(o)?o:20}function f1t(e,t){var r=Lu(e,function(d,v){return d+(isNaN(v)?0:v)},0);if(r===0)return[];for(var n=Math.pow(10,t),i=ct(e,function(d){return(isNaN(d)?0:d)/r*n*100}),a=n*100,o=ct(i,function(d){return Math.floor(d)}),s=Lu(o,function(d,v){return d+v},0),l=ct(i,function(d,v){return d-o[v]});s<a;){for(var u=Number.NEGATIVE_INFINITY,f=null,c=0,h=l.length;c<h;++c)l[c]>u&&(u=l[c],f=c);++o[f],l[f]=0,++s}return ct(o,function(d){return d/n})}function c1t(e,t){var r=Math.max(Xo(e),Xo(t)),n=e+t;return r>Pse?n:vn(n,r)}function Ise(e){var t=Math.PI*2;return(e%t+t)%t}function AT(e){return e>-zY&&e<zY}var h1t=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function yl(e){if(e instanceof Date)return e;if(st(e)){var t=h1t.exec(e);if(!t)return new Date(NaN);if(t[8]){var r=+t[4]||0;return t[8].toUpperCase()!=="Z"&&(r-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,r,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}else return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}else if(e==null)return new Date(NaN);return new Date(Math.round(e))}function d1t(e){return Math.pow(10,m3(e))}function m3(e){if(e===0)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return e/Math.pow(10,t)>=10&&t++,t}function Mse(e,t){var r=m3(e),n=Math.pow(10,r),i=e/n,a;return t?i<1.5?a=1:i<2.5?a=2:i<4?a=3:i<7?a=5:a=10:i<1?a=1:i<2?a=2:i<3?a=3:i<5?a=5:a=10,e=a*n,r>=-20?+e.toFixed(r<0?-r:0):e}function PT(e){var t=parseFloat(e);return t==e&&(t!==0||!st(e)||e.indexOf("x")<=0)?t:NaN}function v1t(e){return!isNaN(PT(e))}function Dse(){return Math.round(Math.random()*9)}function Nse(e,t){return t===0?e:Nse(t,e%t)}function GY(e,t){return e==null?t:t==null?e:e*t/Nse(e,t)}function Mi(e){throw new Error(e)}function YY(e,t,r){return(t-e)*r+e}var Lse="series\0",p1t="\0_ec_\0";function mi(e){return e instanceof Array?e:e==null?[]:[e]}function IT(e,t,r){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var n=0,i=r.length;n<i;n++){var a=r[n];!e.emphasis[t].hasOwnProperty(a)&&e[t].hasOwnProperty(a)&&(e.emphasis[t][a]=e[t][a])}}}var KY=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function TS(e){return vt(e)&&!Ze(e)&&!(e instanceof Date)?e.value:e}function g1t(e){return vt(e)&&!(e instanceof Array)}function y1t(e,t,r){var n=r==="normalMerge",i=r==="replaceMerge",a=r==="replaceAll";e=e||[],t=(t||[]).slice();var o=Bt();le(t,function(l,u){if(!vt(l)){t[u]=null;return}});var s=m1t(e,o,r);return(n||i)&&b1t(s,e,o,t),n&&w1t(s,t),n||i?S1t(s,t,i):a&&_1t(s,t),C1t(s),s}function m1t(e,t,r){var n=[];if(r==="replaceAll")return n;for(var i=0;i<e.length;i++){var a=e[i];a&&a.id!=null&&t.set(a.id,i),n.push({existing:r==="replaceMerge"||dw(a)?null:a,newOption:null,keyInfo:null,brandNew:null})}return n}function b1t(e,t,r,n){le(n,function(i,a){if(!(!i||i.id==null)){var o=Fm(i.id),s=r.get(o);if(s!=null){var l=e[s];gl(!l.newOption,'Duplicated option on id "'+o+'".'),l.newOption=i,l.existing=t[s],n[a]=null}}})}function w1t(e,t){le(t,function(r,n){if(!(!r||r.name==null))for(var i=0;i<e.length;i++){var a=e[i].existing;if(!e[i].newOption&&a&&(a.id==null||r.id==null)&&!dw(r)&&!dw(a)&&Fse("name",a,r)){e[i].newOption=r,t[n]=null;return}}})}function S1t(e,t,r){le(t,function(n){if(n){for(var i,a=0;(i=e[a])&&(i.newOption||dw(i.existing)||i.existing&&n.id!=null&&!Fse("id",n,i.existing));)a++;i?(i.newOption=n,i.brandNew=r):e.push({newOption:n,brandNew:r,existing:null,keyInfo:null}),a++}})}function _1t(e,t){le(t,function(r){e.push({newOption:r,brandNew:!0,existing:null,keyInfo:null})})}function C1t(e){var t=Bt();le(e,function(r){var n=r.existing;n&&t.set(n.id,r)}),le(e,function(r){var n=r.newOption;gl(!n||n.id==null||!t.get(n.id)||t.get(n.id)===r,"id duplicates: "+(n&&n.id)),n&&n.id!=null&&t.set(n.id,r),!r.keyInfo&&(r.keyInfo={})}),le(e,function(r,n){var i=r.existing,a=r.newOption,o=r.keyInfo;if(vt(a)){if(o.name=a.name!=null?Fm(a.name):i?i.name:Lse+n,i)o.id=Fm(i.id);else if(a.id!=null)o.id=Fm(a.id);else{var s=0;do o.id="\0"+o.name+"\0"+s++;while(t.get(o.id))}t.set(o.id,r)}})}function Fse(e,t,r){var n=Jo(t[e],null),i=Jo(r[e],null);return n!=null&&i!=null&&n===i}function Fm(e){return Jo(e,"")}function Jo(e,t){return e==null?t:st(e)?e:Sr(e)||yN(e)?e+"":t}function b3(e){var t=e.name;return!!(t&&t.indexOf(Lse))}function dw(e){return e&&e.id!=null&&Fm(e.id).indexOf(p1t)===0}function x1t(e,t,r){le(e,function(n){var i=n.newOption;vt(i)&&(n.keyInfo.mainType=t,n.keyInfo.subType=T1t(t,i,n.existing,r))})}function T1t(e,t,r,n){var i=t.type?t.type:r?r.subType:n.determineSubType(e,t);return i}function Yc(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return Ze(t.dataIndex)?ct(t.dataIndex,function(r){return e.indexOfRawIndex(r)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return Ze(t.name)?ct(t.name,function(r){return e.indexOfName(r)}):e.indexOfName(t.name)}function Jr(){var e="__ec_inner_"+O1t++;return function(t){return t[e]||(t[e]={})}}var O1t=Dse();function QA(e,t,r){var n=w3(t,r),i=n.mainTypeSpecified,a=n.queryOptionMap,o=n.others,s=o,l=r?r.defaultMainType:null;return!i&&l&&a.set(l,{}),a.each(function(u,f){var c=OS(e,f,u,{useDefault:l===f,enableAll:r&&r.enableAll!=null?r.enableAll:!0,enableNone:r&&r.enableNone!=null?r.enableNone:!0});s[f+"Models"]=c.models,s[f+"Model"]=c.models[0]}),s}function w3(e,t){var r;if(st(e)){var n={};n[e+"Index"]=0,r=n}else r=e;var i=Bt(),a={},o=!1;return le(r,function(s,l){if(l==="dataIndex"||l==="dataIndexInside"){a[l]=s;return}var u=l.match(/^(\w+)(Index|Id|Name)$/)||[],f=u[1],c=(u[2]||"").toLowerCase();if(!(!f||!c||t&&t.includeMainTypes&&ar(t.includeMainTypes,f)<0)){o=o||!!f;var h=i.get(f)||i.set(f,{});h[c]=s}}),{mainTypeSpecified:o,queryOptionMap:i,others:a}}var fo={useDefault:!0,enableAll:!1,enableNone:!1};function OS(e,t,r,n){n=n||fo;var i=r.index,a=r.id,o=r.name,s={models:null,specified:i!=null||a!=null||o!=null};if(!s.specified){var l=void 0;return s.models=n.useDefault&&(l=e.getComponent(t))?[l]:[],s}return i==="none"||i===!1?(gl(n.enableNone,'`"none"` or `false` is not a valid value on index option.'),s.models=[],s):(i==="all"&&(gl(n.enableAll,'`"all"` is not a valid value on index option.'),i=a=o=null),s.models=e.queryComponents({mainType:t,index:i,id:a,name:o}),s)}function $se(e,t,r){e.setAttribute?e.setAttribute(t,r):e[t]=r}function E1t(e,t){return e.getAttribute?e.getAttribute(t):e[t]}function R1t(e){return e==="auto"?Ht.domSupported?"html":"richText":e||"html"}function k1t(e,t,r,n,i){var a=t==null||t==="auto";if(n==null)return n;if(Sr(n)){var o=YY(r||0,n,i);return vn(o,a?Math.max(Xo(r||0),Xo(n)):t)}else{if(st(n))return i<1?r:n;for(var s=[],l=r,u=n,f=Math.max(l?l.length:0,u.length),c=0;c<f;++c){var h=e.getDimensionInfo(c);if(h&&h.type==="ordinal")s[c]=(i<1&&l?l:u)[c];else{var d=l&&l[c]?l[c]:0,v=u[c],o=YY(d,v,i);s[c]=vn(o,a?Math.max(Xo(d),Xo(v)):t)}}return s}}var A1t=".",yf="___EC__COMPONENT__CONTAINER___",Hse="___EC__EXTENDED_CLASS___";function qo(e){var t={main:"",sub:""};if(e){var r=e.split(A1t);t.main=r[0]||"",t.sub=r[1]||""}return t}function P1t(e){gl(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function I1t(e){return!!(e&&e[Hse])}function S3(e,t){e.$constructor=e,e.extend=function(r){var n=this,i;return M1t(n)?i=function(a){je(o,a);function o(){return a.apply(this,arguments)||this}return o}(n):(i=function(){(r.$constructor||n).apply(this,arguments)},kSt(i,this)),Ne(i.prototype,r),i[Hse]=!0,i.extend=this.extend,i.superCall=L1t,i.superApply=F1t,i.superClass=n,i}}function M1t(e){return gt(e)&&/^class\s/.test(Function.prototype.toString.call(e))}function Bse(e,t){e.extend=t.extend}var D1t=Math.round(Math.random()*10);function N1t(e){var t=["__\0is_clz",D1t++].join("_");e.prototype[t]=!0,e.isInstance=function(r){return!!(r&&r[t])}}function L1t(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.superClass.prototype[t].apply(e,r)}function F1t(e,t,r){return this.superClass.prototype[t].apply(e,r)}function mE(e){var t={};e.registerClass=function(n){var i=n.type||n.prototype.type;if(i){P1t(i),n.prototype.type=i;var a=qo(i);if(!a.sub)t[a.main]=n;else if(a.sub!==yf){var o=r(a);o[a.sub]=n}}return n},e.getClass=function(n,i,a){var o=t[n];if(o&&o[yf]&&(o=i?o[i]:null),a&&!o)throw new Error(i?"Component "+n+"."+(i||"")+" is used but not imported.":n+".type should be specified.");return o},e.getClassesByMainType=function(n){var i=qo(n),a=[],o=t[i.main];return o&&o[yf]?le(o,function(s,l){l!==yf&&a.push(s)}):a.push(o),a},e.hasClass=function(n){var i=qo(n);return!!t[i.main]},e.getAllClassMainTypes=function(){var n=[];return le(t,function(i,a){n.push(a)}),n},e.hasSubTypes=function(n){var i=qo(n),a=t[i.main];return a&&a[yf]};function r(n){var i=t[n.main];return(!i||!i[yf])&&(i=t[n.main]={},i[yf]=!0),i}}function vw(e,t){for(var r=0;r<e.length;r++)e[r][1]||(e[r][1]=e[r][0]);return t=t||!1,function(n,i,a){for(var o={},s=0;s<e.length;s++){var l=e[s][1];if(!(i&&ar(i,l)>=0||a&&ar(a,l)<0)){var u=n.getShallow(l,t);u!=null&&(o[e[s][0]]=u)}}return o}}var $1t=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],H1t=vw($1t),B1t=function(){function e(){}return e.prototype.getAreaStyle=function(t,r){return H1t(this,t,r)},e}(),FN=new xS(50);function V1t(e){if(typeof e=="string"){var t=FN.get(e);return t&&t.image}else return e}function Vse(e,t,r,n,i){if(e)if(typeof e=="string"){if(t&&t.__zrImageSrc===e||!r)return t;var a=FN.get(e),o={hostEl:r,cb:n,cbPayload:i};return a?(t=a.image,!bE(t)&&a.pending.push(o)):(t=Lg.loadImage(e,XY,XY),t.__zrImageSrc=e,FN.put(e,t.__cachedImgObj={image:t,pending:[o]})),t}else return e;else return t}function XY(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var r=e.pending[t],n=r.cb;n&&n(this,r.cbPayload),r.hostEl.dirty()}e.pending.length=0}function bE(e){return e&&e.width&&e.height}var eP=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function j1t(e,t,r,n,i){if(!t)return"";var a=(e+"").split(`
`);i=jse(t,r,n,i);for(var o=0,s=a.length;o<s;o++)a[o]=Wse(a[o],i);return a.join(`
`)}function jse(e,t,r,n){n=n||{};var i=Ne({},n);i.font=t,r=qt(r,"..."),i.maxIterations=qt(n.maxIterations,2);var a=i.minChar=qt(n.minChar,0);i.cnCharWidth=ta("å½",t);var o=i.ascCharWidth=ta("a",t);i.placeholder=qt(n.placeholder,"");for(var s=e=Math.max(0,e-1),l=0;l<a&&s>=o;l++)s-=o;var u=ta(r,t);return u>s&&(r="",u=0),s=e-u,i.ellipsis=r,i.ellipsisWidth=u,i.contentWidth=s,i.containerWidth=e,i}function Wse(e,t){var r=t.containerWidth,n=t.font,i=t.contentWidth;if(!r)return"";var a=ta(e,n);if(a<=r)return e;for(var o=0;;o++){if(a<=i||o>=t.maxIterations){e+=t.ellipsis;break}var s=o===0?W1t(e,i,t.ascCharWidth,t.cnCharWidth):a>0?Math.floor(e.length*i/a):0;e=e.substr(0,s),a=ta(e,n)}return e===""&&(e=t.placeholder),e}function W1t(e,t,r,n){for(var i=0,a=0,o=e.length;a<o&&i<t;a++){var s=e.charCodeAt(a);i+=0<=s&&s<=127?r:n}return a}function U1t(e,t){e!=null&&(e+="");var r=t.overflow,n=t.padding,i=t.font,a=r==="truncate",o=g3(i),s=qt(t.lineHeight,o),l=!!t.backgroundColor,u=t.lineOverflow==="truncate",f=t.width,c;f!=null&&(r==="break"||r==="breakAll")?c=e?Use(e,t.font,f,r==="breakAll",0).lines:[]:c=e?e.split(`
`):[];var h=c.length*s,d=qt(t.height,h);if(h>d&&u){var v=Math.floor(d/s);c=c.slice(0,v)}if(e&&a&&f!=null)for(var p=jse(f,i,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),g=0;g<c.length;g++)c[g]=Wse(c[g],p);for(var y=d,m=0,g=0;g<c.length;g++)m=Math.max(ta(c[g],i),m);f==null&&(f=m);var b=m;return n&&(y+=n[0]+n[2],b+=n[1]+n[3],f+=n[1]+n[3]),l&&(b=f),{lines:c,height:d,outerWidth:b,outerHeight:y,lineHeight:s,calculatedLineHeight:o,contentWidth:m,contentHeight:h,width:f}}var z1t=function(){function e(){}return e}(),qY=function(){function e(t){this.tokens=[],t&&(this.tokens=t)}return e}(),G1t=function(){function e(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return e}();function Y1t(e,t){var r=new G1t;if(e!=null&&(e+=""),!e)return r;for(var n=t.width,i=t.height,a=t.overflow,o=(a==="break"||a==="breakAll")&&n!=null?{width:n,accumWidth:0,breakAll:a==="breakAll"}:null,s=eP.lastIndex=0,l;(l=eP.exec(e))!=null;){var u=l.index;u>s&&tP(r,e.substring(s,u),t,o),tP(r,l[2],t,o,l[1]),s=eP.lastIndex}s<e.length&&tP(r,e.substring(s,e.length),t,o);var f=[],c=0,h=0,d=t.padding,v=a==="truncate",p=t.lineOverflow==="truncate";function g(k,w,C){k.width=w,k.lineHeight=C,c+=C,h=Math.max(h,w)}e:for(var y=0;y<r.lines.length;y++){for(var m=r.lines[y],b=0,S=0,x=0;x<m.tokens.length;x++){var T=m.tokens[x],E=T.styleName&&t.rich[T.styleName]||{},P=T.textPadding=E.padding,R=P?P[1]+P[3]:0,M=T.font=E.font||t.font;T.contentHeight=g3(M);var D=qt(E.height,T.contentHeight);if(T.innerHeight=D,P&&(D+=P[0]+P[2]),T.height=D,T.lineHeight=Dm(E.lineHeight,t.lineHeight,D),T.align=E&&E.align||t.align,T.verticalAlign=E&&E.verticalAlign||"middle",p&&i!=null&&c+T.lineHeight>i){x>0?(m.tokens=m.tokens.slice(0,x),g(m,S,b),r.lines=r.lines.slice(0,y+1)):r.lines=r.lines.slice(0,y);break e}var N=E.width,B=N==null||N==="auto";if(typeof N=="string"&&N.charAt(N.length-1)==="%")T.percentWidth=N,f.push(T),T.contentWidth=ta(T.text,M);else{if(B){var K=E.backgroundColor,Z=K&&K.image;Z&&(Z=V1t(Z),bE(Z)&&(T.width=Math.max(T.width,Z.width*D/Z.height)))}var ie=v&&n!=null?n-S:null;ie!=null&&ie<T.width?!B||ie<R?(T.text="",T.width=T.contentWidth=0):(T.text=j1t(T.text,ie-R,M,t.ellipsis,{minChar:t.truncateMinChar}),T.width=T.contentWidth=ta(T.text,M)):T.contentWidth=ta(T.text,M)}T.width+=R,S+=T.width,E&&(b=Math.max(b,T.lineHeight))}g(m,S,b)}r.outerWidth=r.width=qt(n,h),r.outerHeight=r.height=qt(i,c),r.contentHeight=c,r.contentWidth=h,d&&(r.outerWidth+=d[1]+d[3],r.outerHeight+=d[0]+d[2]);for(var y=0;y<f.length;y++){var T=f[y],me=T.percentWidth;T.width=parseInt(me,10)/100*r.width}return r}function tP(e,t,r,n,i){var a=t==="",o=i&&r.rich[i]||{},s=e.lines,l=o.font||r.font,u=!1,f,c;if(n){var h=o.padding,d=h?h[1]+h[3]:0;if(o.width!=null&&o.width!=="auto"){var v=Fu(o.width,n.width)+d;s.length>0&&v+n.accumWidth>n.width&&(f=t.split(`
`),u=!0),n.accumWidth=v}else{var p=Use(t,l,n.width,n.breakAll,n.accumWidth);n.accumWidth=p.accumWidth+d,c=p.linesWidths,f=p.lines}}else f=t.split(`
`);for(var g=0;g<f.length;g++){var y=f[g],m=new z1t;if(m.styleName=i,m.text=y,m.isLineHolder=!y&&!a,typeof o.width=="number"?m.width=o.width:m.width=c?c[g]:ta(y,l),!g&&!u){var b=(s[s.length-1]||(s[0]=new qY)).tokens,S=b.length;S===1&&b[0].isLineHolder?b[0]=m:(y||!S||a)&&b.push(m)}else s.push(new qY([m]))}}function K1t(e){var t=e.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var X1t=Lu(",&?/;] ".split(""),function(e,t){return e[t]=!0,e},{});function q1t(e){return K1t(e)?!!X1t[e]:!0}function Use(e,t,r,n,i){for(var a=[],o=[],s="",l="",u=0,f=0,c=0;c<e.length;c++){var h=e.charAt(c);if(h===`
`){l&&(s+=l,f+=u),a.push(s),o.push(f),s="",l="",u=0,f=0;continue}var d=ta(h,t),v=n?!1:!q1t(h);if(a.length?f+d>r:i+f+d>r){f?(s||l)&&(v?(s||(s=l,l="",u=0,f=u),a.push(s),o.push(f-u),l+=h,u+=d,s="",f=u):(l&&(s+=l,l="",u=0),a.push(s),o.push(f),s=h,f=d)):v?(a.push(l),o.push(u),l=h,u=d):(a.push(h),o.push(d));continue}f+=d,v?(l+=h,u+=d):(l&&(s+=l,l="",u=0),s+=h)}return!a.length&&!s&&(s=e,l="",u=0),l&&(s+=l),s&&(a.push(s),o.push(f)),a.length===1&&(f+=i),{accumWidth:f,lines:a,linesWidths:o}}var $N="__zr_style_"+Math.round(Math.random()*10),Tc={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},wE={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};Tc[$N]=!0;var ZY=["z","z2","invisible"],Z1t=["invisible"],J1t=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype._init=function(r){for(var n=Lr(r),i=0;i<n.length;i++){var a=n[i];a==="style"?this.useStyle(r[a]):e.prototype.attrKV.call(this,a,r[a])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(r,n,i,a){var o=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&Q1t(this,r,n)||o&&!o[0]&&!o[3])return!1;if(i&&this.__clipPaths){for(var s=0;s<this.__clipPaths.length;++s)if(this.__clipPaths[s].isZeroArea())return!1}if(a&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},t.prototype.contain=function(r,n){return this.rectContain(r,n)},t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.rectContain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();return a.contain(i[0],i[1])},t.prototype.getPaintRect=function(){var r=this._paintRect;if(!this._paintRect||this.__dirty){var n=this.transform,i=this.getBoundingRect(),a=this.style,o=a.shadowBlur||0,s=a.shadowOffsetX||0,l=a.shadowOffsetY||0;r=this._paintRect||(this._paintRect=new ur(0,0,0,0)),n?ur.applyTransform(r,i,n):r.copy(i),(o||s||l)&&(r.width+=o*2+Math.abs(s),r.height+=o*2+Math.abs(l),r.x=Math.min(r.x,r.x+s-o),r.y=Math.min(r.y,r.y+l-o));var u=this.dirtyRectTolerance;r.isZero()||(r.x=Math.floor(r.x-u),r.y=Math.floor(r.y-u),r.width=Math.ceil(r.width+1+u*2),r.height=Math.ceil(r.height+1+u*2))}return r},t.prototype.setPrevPaintRect=function(r){r?(this._prevPaintRect=this._prevPaintRect||new ur(0,0,0,0),this._prevPaintRect.copy(r)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(r){return this.animate("style",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(r,n){r!=="style"?e.prototype.attrKV.call(this,r,n):this.style?this.setStyle(n):this.useStyle(n)},t.prototype.setStyle=function(r,n){return typeof r=="string"?this.style[r]=n:Ne(this.style,r),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(r){r||this.markRedraw(),this.__dirty|=Jy,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&Jy)},t.prototype.styleUpdated=function(){this.__dirty&=~Jy},t.prototype.createStyle=function(r){return gE(Tc,r)},t.prototype.useStyle=function(r){r[$N]||(r=this.createStyle(r)),this.__inHover?this.__hoverStyle=r:this.style=r,this.dirtyStyle()},t.prototype.isStyleObject=function(r){return r[$N]},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(r,n,ZY)},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.style?o?a?u=n.style:(u=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(u,n.style)):(u=this._mergeStyle(this.createStyle(),a?this.style:i.style),this._mergeStyle(u,n.style)):l&&(u=i.style),u)if(o){var f=this.style;if(this.style=this.createStyle(l?{}:f),l)for(var c=Lr(f),h=0;h<c.length;h++){var d=c[h];d in u&&(u[d]=u[d],this.style[d]=f[d])}for(var v=Lr(u),h=0;h<v.length;h++){var d=v[h];this.style[d]=this.style[d]}this._transitionState(r,{style:u},s,this.getAnimationStyleProps())}else this.useStyle(u);for(var p=this.__inHover?Z1t:ZY,h=0;h<p.length;h++){var d=p[h];n&&n[d]!=null?this[d]=n[d]:l&&i[d]!=null&&(this[d]=i[d])}},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.style&&(i=i||{},this._mergeStyle(i,o.style))}return i&&(n.style=i),n},t.prototype._mergeStyle=function(r,n){return Ne(r,n),r},t.prototype.getAnimationStyleProps=function(){return wE},t.initDefaultProps=function(){var r=t.prototype;r.type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,r.__dirty=Ji|Jy}(),t}(Rse),rP=new ur(0,0,0,0),nP=new ur(0,0,0,0);function Q1t(e,t,r){return rP.copy(e.getBoundingRect()),e.transform&&rP.applyTransform(e.transform),nP.width=t,nP.height=r,!rP.intersect(nP)}const ES=J1t;var xa=Math.min,Ta=Math.max,iP=Math.sin,aP=Math.cos,mf=Math.PI*2,n1=Fg(),i1=Fg(),a1=Fg();function JY(e,t,r,n,i,a){i[0]=xa(e,r),i[1]=xa(t,n),a[0]=Ta(e,r),a[1]=Ta(t,n)}var QY=[],eK=[];function eCt(e,t,r,n,i,a,o,s,l,u){var f=bse,c=mn,h=f(e,r,i,o,QY);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<h;d++){var v=c(e,r,i,o,QY[d]);l[0]=xa(v,l[0]),u[0]=Ta(v,u[0])}h=f(t,n,a,s,eK);for(var d=0;d<h;d++){var p=c(t,n,a,s,eK[d]);l[1]=xa(p,l[1]),u[1]=Ta(p,u[1])}l[0]=xa(e,l[0]),u[0]=Ta(e,u[0]),l[0]=xa(o,l[0]),u[0]=Ta(o,u[0]),l[1]=xa(t,l[1]),u[1]=Ta(t,u[1]),l[1]=xa(s,l[1]),u[1]=Ta(s,u[1])}function tCt(e,t,r,n,i,a,o,s){var l=wse,u=Hn,f=Ta(xa(l(e,r,i),1),0),c=Ta(xa(l(t,n,a),1),0),h=u(e,r,i,f),d=u(t,n,a,c);o[0]=xa(e,i,h),o[1]=xa(t,a,d),s[0]=Ta(e,i,h),s[1]=Ta(t,a,d)}function rCt(e,t,r,n,i,a,o,s,l){var u=Ed,f=Rd,c=Math.abs(i-a);if(c%mf<1e-4&&c>1e-4){s[0]=e-r,s[1]=t-n,l[0]=e+r,l[1]=t+n;return}if(n1[0]=aP(i)*r+e,n1[1]=iP(i)*n+t,i1[0]=aP(a)*r+e,i1[1]=iP(a)*n+t,u(s,n1,i1),f(l,n1,i1),i=i%mf,i<0&&(i=i+mf),a=a%mf,a<0&&(a=a+mf),i>a&&!o?a+=mf:i<a&&o&&(i+=mf),o){var h=a;a=i,i=h}for(var d=0;d<a;d+=Math.PI/2)d>i&&(a1[0]=aP(d)*r+e,a1[1]=iP(d)*n+t,u(s,a1,s),f(l,a1,l))}var ir={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},bf=[],wf=[],Lo=[],Fl=[],Fo=[],$o=[],oP=Math.min,sP=Math.max,Sf=Math.cos,_f=Math.sin,ws=Math.abs,HN=Math.PI,Yl=HN*2,lP=typeof Float32Array<"u",Cy=[];function uP(e){var t=Math.round(e/HN*1e8)/1e8;return t%2*HN}function nCt(e,t){var r=uP(e[0]);r<0&&(r+=Yl);var n=r-e[0],i=e[1];i+=n,!t&&i-r>=Yl?i=r+Yl:t&&r-i>=Yl?i=r-Yl:!t&&r>i?i=r+(Yl-uP(r-i)):t&&r<i&&(i=r-(Yl-uP(i-r))),e[0]=r,e[1]=i}var iCt=function(){function e(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(t,r,n){n=n||0,n>0&&(this._ux=ws(n/RT/t)||0,this._uy=ws(n/RT/r)||0)},e.prototype.setDPR=function(t){this.dpr=t},e.prototype.setContext=function(t){this._ctx=t},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(t,r){return this._drawPendingPt(),this.addData(ir.M,t,r),this._ctx&&this._ctx.moveTo(t,r),this._x0=t,this._y0=r,this._xi=t,this._yi=r,this},e.prototype.lineTo=function(t,r){var n=ws(t-this._xi),i=ws(r-this._yi),a=n>this._ux||i>this._uy;if(this.addData(ir.L,t,r),this._ctx&&a&&this._ctx.lineTo(t,r),a)this._xi=t,this._yi=r,this._pendingPtDist=0;else{var o=n*n+i*i;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=r,this._pendingPtDist=o)}return this},e.prototype.bezierCurveTo=function(t,r,n,i,a,o){return this._drawPendingPt(),this.addData(ir.C,t,r,n,i,a,o),this._ctx&&this._ctx.bezierCurveTo(t,r,n,i,a,o),this._xi=a,this._yi=o,this},e.prototype.quadraticCurveTo=function(t,r,n,i){return this._drawPendingPt(),this.addData(ir.Q,t,r,n,i),this._ctx&&this._ctx.quadraticCurveTo(t,r,n,i),this._xi=n,this._yi=i,this},e.prototype.arc=function(t,r,n,i,a,o){this._drawPendingPt(),Cy[0]=i,Cy[1]=a,nCt(Cy,o),i=Cy[0],a=Cy[1];var s=a-i;return this.addData(ir.A,t,r,n,n,i,s,0,o?0:1),this._ctx&&this._ctx.arc(t,r,n,i,a,o),this._xi=Sf(a)*n+t,this._yi=_f(a)*n+r,this},e.prototype.arcTo=function(t,r,n,i,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,r,n,i,a),this},e.prototype.rect=function(t,r,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,r,n,i),this.addData(ir.R,t,r,n,i),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(ir.Z);var t=this._ctx,r=this._x0,n=this._y0;return t&&t.closePath(),this._xi=r,this._yi=n,this},e.prototype.fill=function(t){t&&t.fill(),this.toStatic()},e.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(t){var r=t.length;!(this.data&&this.data.length===r)&&lP&&(this.data=new Float32Array(r));for(var n=0;n<r;n++)this.data[n]=t[n];this._len=r},e.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var r=t.length,n=0,i=this._len,a=0;a<r;a++)n+=t[a].len();lP&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(var a=0;a<r;a++)for(var o=t[a].data,s=0;s<o.length;s++)this.data[i++]=o[s];this._len=i},e.prototype.addData=function(t,r,n,i,a,o,s,l,u){if(this._saveData){var f=this.data;this._len+arguments.length>f.length&&(this._expandData(),f=this.data);for(var c=0;c<arguments.length;c++)f[this._len++]=arguments[c]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],r=0;r<this._len;r++)t[r]=this.data[r];this.data=t}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,lP&&this._len>11&&(this.data=new Float32Array(t)))}},e.prototype.getBoundingRect=function(){Lo[0]=Lo[1]=Fo[0]=Fo[1]=Number.MAX_VALUE,Fl[0]=Fl[1]=$o[0]=$o[1]=-Number.MAX_VALUE;var t=this.data,r=0,n=0,i=0,a=0,o;for(o=0;o<this._len;){var s=t[o++],l=o===1;switch(l&&(r=t[o],n=t[o+1],i=r,a=n),s){case ir.M:r=i=t[o++],n=a=t[o++],Fo[0]=i,Fo[1]=a,$o[0]=i,$o[1]=a;break;case ir.L:JY(r,n,t[o],t[o+1],Fo,$o),r=t[o++],n=t[o++];break;case ir.C:eCt(r,n,t[o++],t[o++],t[o++],t[o++],t[o],t[o+1],Fo,$o),r=t[o++],n=t[o++];break;case ir.Q:tCt(r,n,t[o++],t[o++],t[o],t[o+1],Fo,$o),r=t[o++],n=t[o++];break;case ir.A:var u=t[o++],f=t[o++],c=t[o++],h=t[o++],d=t[o++],v=t[o++]+d;o+=1;var p=!t[o++];l&&(i=Sf(d)*c+u,a=_f(d)*h+f),rCt(u,f,c,h,d,v,p,Fo,$o),r=Sf(v)*c+u,n=_f(v)*h+f;break;case ir.R:i=r=t[o++],a=n=t[o++];var g=t[o++],y=t[o++];JY(i,a,i+g,a+y,Fo,$o);break;case ir.Z:r=i,n=a;break}Ed(Lo,Lo,Fo),Rd(Fl,Fl,$o)}return o===0&&(Lo[0]=Lo[1]=Fl[0]=Fl[1]=0),new ur(Lo[0],Lo[1],Fl[0]-Lo[0],Fl[1]-Lo[1])},e.prototype._calculateLength=function(){var t=this.data,r=this._len,n=this._ux,i=this._uy,a=0,o=0,s=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var u=this._pathSegLen,f=0,c=0,h=0;h<r;){var d=t[h++],v=h===1;v&&(a=t[h],o=t[h+1],s=a,l=o);var p=-1;switch(d){case ir.M:a=s=t[h++],o=l=t[h++];break;case ir.L:{var g=t[h++],y=t[h++],m=g-a,b=y-o;(ws(m)>n||ws(b)>i||h===r-1)&&(p=Math.sqrt(m*m+b*b),a=g,o=y);break}case ir.C:{var S=t[h++],x=t[h++],g=t[h++],y=t[h++],T=t[h++],E=t[h++];p=S_t(a,o,S,x,g,y,T,E,10),a=T,o=E;break}case ir.Q:{var S=t[h++],x=t[h++],g=t[h++],y=t[h++];p=x_t(a,o,S,x,g,y,10),a=g,o=y;break}case ir.A:var P=t[h++],R=t[h++],M=t[h++],D=t[h++],N=t[h++],B=t[h++],K=B+N;h+=1,t[h++],v&&(s=Sf(N)*M+P,l=_f(N)*D+R),p=sP(M,D)*oP(Yl,Math.abs(B)),a=Sf(K)*M+P,o=_f(K)*D+R;break;case ir.R:{s=a=t[h++],l=o=t[h++];var Z=t[h++],ie=t[h++];p=Z*2+ie*2;break}case ir.Z:{var m=s-a,b=l-o;p=Math.sqrt(m*m+b*b),a=s,o=l;break}}p>=0&&(u[c++]=p,f+=p)}return this._pathLen=f,f},e.prototype.rebuildPath=function(t,r){var n=this.data,i=this._ux,a=this._uy,o=this._len,s,l,u,f,c,h,d=r<1,v,p,g=0,y=0,m,b=0,S,x;if(!(d&&(this._pathSegLen||this._calculateLength(),v=this._pathSegLen,p=this._pathLen,m=r*p,!m)))e:for(var T=0;T<o;){var E=n[T++],P=T===1;switch(P&&(u=n[T],f=n[T+1],s=u,l=f),E!==ir.L&&b>0&&(t.lineTo(S,x),b=0),E){case ir.M:s=u=n[T++],l=f=n[T++],t.moveTo(u,f);break;case ir.L:{c=n[T++],h=n[T++];var R=ws(c-u),M=ws(h-f);if(R>i||M>a){if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;t.lineTo(u*(1-N)+c*N,f*(1-N)+h*N);break e}g+=D}t.lineTo(c,h),u=c,f=h,b=0}else{var B=R*R+M*M;B>b&&(S=c,x=h,b=B)}break}case ir.C:{var K=n[T++],Z=n[T++],ie=n[T++],me=n[T++],k=n[T++],w=n[T++];if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;TT(u,K,ie,k,N,bf),TT(f,Z,me,w,N,wf),t.bezierCurveTo(bf[1],wf[1],bf[2],wf[2],bf[3],wf[3]);break e}g+=D}t.bezierCurveTo(K,Z,ie,me,k,w),u=k,f=w;break}case ir.Q:{var K=n[T++],Z=n[T++],ie=n[T++],me=n[T++];if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;OT(u,K,ie,N,bf),OT(f,Z,me,N,wf),t.quadraticCurveTo(bf[1],wf[1],bf[2],wf[2]);break e}g+=D}t.quadraticCurveTo(K,Z,ie,me),u=ie,f=me;break}case ir.A:var C=n[T++],O=n[T++],_=n[T++],A=n[T++],I=n[T++],L=n[T++],V=n[T++],Y=!n[T++],ae=_>A?_:A,re=ws(_-A)>.001,te=I+L,ge=!1;if(d){var D=v[y++];g+D>m&&(te=I+L*(m-g)/D,ge=!0),g+=D}if(re&&t.ellipse?t.ellipse(C,O,_,A,V,I,te,Y):t.arc(C,O,ae,I,te,Y),ge)break e;P&&(s=Sf(I)*_+C,l=_f(I)*A+O),u=Sf(te)*_+C,f=_f(te)*A+O;break;case ir.R:s=u=n[T],l=f=n[T+1],c=n[T++],h=n[T++];var H=n[T++],Ce=n[T++];if(d){var D=v[y++];if(g+D>m){var oe=m-g;t.moveTo(c,h),t.lineTo(c+oP(oe,H),h),oe-=H,oe>0&&t.lineTo(c+H,h+oP(oe,Ce)),oe-=Ce,oe>0&&t.lineTo(c+sP(H-oe,0),h+Ce),oe-=H,oe>0&&t.lineTo(c,h+sP(Ce-oe,0));break e}g+=D}t.rect(c,h,H,Ce);break;case ir.Z:if(d){var D=v[y++];if(g+D>m){var N=(m-g)/D;t.lineTo(u*(1-N)+s*N,f*(1-N)+l*N);break e}g+=D}t.closePath(),u=s,f=l}}},e.prototype.clone=function(){var t=new e,r=this.data;return t.data=r.slice?r.slice():Array.prototype.slice.call(r),t._len=this._len,t},e.CMD=ir,e.initDefaultProps=function(){var t=e.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),e}();const $u=iCt;function id(e,t,r,n,i,a,o){if(i===0)return!1;var s=i,l=0,u=e;if(o>t+s&&o>n+s||o<t-s&&o<n-s||a>e+s&&a>r+s||a<e-s&&a<r-s)return!1;if(e!==r)l=(t-n)/(e-r),u=(e*n-r*t)/(e-r);else return Math.abs(a-e)<=s/2;var f=l*a-o+u,c=f*f/(l*l+1);return c<=s/2*s/2}function aCt(e,t,r,n,i,a,o,s,l,u,f){if(l===0)return!1;var c=l;if(f>t+c&&f>n+c&&f>a+c&&f>s+c||f<t-c&&f<n-c&&f<a-c&&f<s-c||u>e+c&&u>r+c&&u>i+c&&u>o+c||u<e-c&&u<r-c&&u<i-c&&u<o-c)return!1;var h=w_t(e,t,r,n,i,a,o,s,u,f,null);return h<=c/2}function oCt(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;if(l>t+u&&l>n+u&&l>a+u||l<t-u&&l<n-u&&l<a-u||s>e+u&&s>r+u&&s>i+u||s<e-u&&s<r-u&&s<i-u)return!1;var f=C_t(e,t,r,n,i,a,s,l,null);return f<=u/2}var tK=Math.PI*2;function o1(e){return e%=tK,e<0&&(e+=tK),e}var xy=Math.PI*2;function sCt(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;s-=e,l-=t;var f=Math.sqrt(s*s+l*l);if(f-u>r||f+u<r)return!1;if(Math.abs(n-i)%xy<1e-4)return!0;if(a){var c=n;n=o1(i),i=o1(c)}else n=o1(n),i=o1(i);n>i&&(i+=xy);var h=Math.atan2(l,s);return h<0&&(h+=xy),h>=n&&h<=i||h+xy>=n&&h+xy<=i}function Cf(e,t,r,n,i,a){if(a>t&&a>n||a<t&&a<n||n===t)return 0;var o=(a-t)/(n-t),s=n<t?1:-1;(o===1||o===0)&&(s=n<t?.5:-.5);var l=o*(r-e)+e;return l===i?1/0:l>i?s:0}var $l=$u.CMD,xf=Math.PI*2,lCt=1e-4;function uCt(e,t){return Math.abs(e-t)<lCt}var ci=[-1,-1,-1],wa=[-1,-1];function fCt(){var e=wa[0];wa[0]=wa[1],wa[1]=e}function cCt(e,t,r,n,i,a,o,s,l,u){if(u>t&&u>n&&u>a&&u>s||u<t&&u<n&&u<a&&u<s)return 0;var f=xT(t,n,a,s,u,ci);if(f===0)return 0;for(var c=0,h=-1,d=void 0,v=void 0,p=0;p<f;p++){var g=ci[p],y=g===0||g===1?.5:1,m=mn(e,r,i,o,g);m<l||(h<0&&(h=bse(t,n,a,s,wa),wa[1]<wa[0]&&h>1&&fCt(),d=mn(t,n,a,s,wa[0]),h>1&&(v=mn(t,n,a,s,wa[1]))),h===2?g<wa[0]?c+=d<t?y:-y:g<wa[1]?c+=v<d?y:-y:c+=s<v?y:-y:g<wa[0]?c+=d<t?y:-y:c+=s<d?y:-y)}return c}function hCt(e,t,r,n,i,a,o,s){if(s>t&&s>n&&s>a||s<t&&s<n&&s<a)return 0;var l=__t(t,n,a,s,ci);if(l===0)return 0;var u=wse(t,n,a);if(u>=0&&u<=1){for(var f=0,c=Hn(t,n,a,u),h=0;h<l;h++){var d=ci[h]===0||ci[h]===1?.5:1,v=Hn(e,r,i,ci[h]);v<o||(ci[h]<u?f+=c<t?d:-d:f+=a<c?d:-d)}return f}else{var d=ci[0]===0||ci[0]===1?.5:1,v=Hn(e,r,i,ci[0]);return v<o?0:a<t?d:-d}}function dCt(e,t,r,n,i,a,o,s){if(s-=t,s>r||s<-r)return 0;var l=Math.sqrt(r*r-s*s);ci[0]=-l,ci[1]=l;var u=Math.abs(n-i);if(u<1e-4)return 0;if(u>=xf-1e-4){n=0,i=xf;var f=a?1:-1;return o>=ci[0]+e&&o<=ci[1]+e?f:0}if(n>i){var c=n;n=i,i=c}n<0&&(n+=xf,i+=xf);for(var h=0,d=0;d<2;d++){var v=ci[d];if(v+e>o){var p=Math.atan2(s,v),f=a?1:-1;p<0&&(p=xf+p),(p>=n&&p<=i||p+xf>=n&&p+xf<=i)&&(p>Math.PI/2&&p<Math.PI*1.5&&(f=-f),h+=f)}}return h}function zse(e,t,r,n,i){for(var a=e.data,o=e.len(),s=0,l=0,u=0,f=0,c=0,h,d,v=0;v<o;){var p=a[v++],g=v===1;switch(p===$l.M&&v>1&&(r||(s+=Cf(l,u,f,c,n,i))),g&&(l=a[v],u=a[v+1],f=l,c=u),p){case $l.M:f=a[v++],c=a[v++],l=f,u=c;break;case $l.L:if(r){if(id(l,u,a[v],a[v+1],t,n,i))return!0}else s+=Cf(l,u,a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case $l.C:if(r){if(aCt(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=cCt(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case $l.Q:if(r){if(oCt(l,u,a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=hCt(l,u,a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case $l.A:var y=a[v++],m=a[v++],b=a[v++],S=a[v++],x=a[v++],T=a[v++];v+=1;var E=!!(1-a[v++]);h=Math.cos(x)*b+y,d=Math.sin(x)*S+m,g?(f=h,c=d):s+=Cf(l,u,h,d,n,i);var P=(n-y)*S/b+y;if(r){if(sCt(y,m,S,x,x+T,E,t,P,i))return!0}else s+=dCt(y,m,S,x,x+T,E,P,i);l=Math.cos(x+T)*b+y,u=Math.sin(x+T)*S+m;break;case $l.R:f=l=a[v++],c=u=a[v++];var R=a[v++],M=a[v++];if(h=f+R,d=c+M,r){if(id(f,c,h,c,t,n,i)||id(h,c,h,d,t,n,i)||id(h,d,f,d,t,n,i)||id(f,d,f,c,t,n,i))return!0}else s+=Cf(h,c,h,d,n,i),s+=Cf(f,d,f,c,n,i);break;case $l.Z:if(r){if(id(l,u,f,c,t,n,i))return!0}else s+=Cf(l,u,f,c,n,i);l=f,u=c;break}}return!r&&!uCt(u,c)&&(s+=Cf(l,u,f,c,n,i)||0),s!==0}function vCt(e,t,r){return zse(e,0,!1,t,r)}function pCt(e,t,r,n){return zse(e,t,!0,r,n)}var Gse=fr({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},Tc),gCt={style:fr({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},wE.style)},fP=hw.concat(["invisible","culling","z","z2","zlevel","parent"]),yCt=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.update=function(){var r=this;e.prototype.update.call(this);var n=this.style;if(n.decal){var i=this._decalEl=this._decalEl||new t;i.buildPath===t.prototype.buildPath&&(i.buildPath=function(l){r.buildPath(l,r.shape)}),i.silent=!0;var a=i.style;for(var o in n)a[o]!==n[o]&&(a[o]=n[o]);a.fill=n.fill?n.decal:null,a.decal=null,a.shadowColor=null,n.strokeFirst&&(a.stroke=null);for(var s=0;s<fP.length;++s)i[fP[s]]=this[fP[s]];i.__dirty|=Ji}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(r){var n=Lr(r);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var a=0;a<n.length;a++){var o=n[a],s=r[o];o==="style"?this.style?Ne(this.style,s):this.useStyle(s):o==="shape"?Ne(this.shape,s):e.prototype.attrKV.call(this,o,s)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var r=this.style.fill;if(r!=="none"){if(st(r)){var n=ET(r,0);return n>.5?DN:n>.2?X_t:NN}else if(r)return NN}return DN},t.prototype.getInsideTextStroke=function(r){var n=this.style.fill;if(st(n)){var i=this.__zr,a=!!(i&&i.isDarkMode()),o=ET(r,0)<MN;if(a===o)return n}},t.prototype.buildPath=function(r,n,i){},t.prototype.pathUpdated=function(){this.__dirty&=~bd},t.prototype.getUpdatedPathProxy=function(r){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,r),this.path},t.prototype.createPathProxy=function(){this.path=new $u(!1)},t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return!(n==null||n==="none"||!(r.lineWidth>0))},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.getBoundingRect=function(){var r=this._rect,n=this.style,i=!r;if(i){var a=!1;this.path||(a=!0,this.createPathProxy());var o=this.path;(a||this.__dirty&bd)&&(o.beginPath(),this.buildPath(o,this.shape,!1),this.pathUpdated()),r=o.getBoundingRect()}if(this._rect=r,this.hasStroke()&&this.path&&this.path.len()>0){var s=this._rectStroke||(this._rectStroke=r.clone());if(this.__dirty||i){s.copy(r);var l=n.strokeNoScale?this.getLineScale():1,u=n.lineWidth;if(!this.hasFill()){var f=this.strokeContainThreshold;u=Math.max(u,f??4)}l>1e-10&&(s.width+=u/l,s.height+=u/l,s.x-=u/l/2,s.y-=u/l/2)}return s}return r},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect(),o=this.style;if(r=i[0],n=i[1],a.contain(r,n)){var s=this.path;if(this.hasStroke()){var l=o.lineWidth,u=o.strokeNoScale?this.getLineScale():1;if(u>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),pCt(s,l/u,r,n)))return!0}if(this.hasFill())return vCt(s,r,n)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=bd,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(r){return this.animate("shape",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():r==="shape"?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(r,n){r==="shape"?this.setShape(n):e.prototype.attrKV.call(this,r,n)},t.prototype.setShape=function(r,n){var i=this.shape;return i||(i=this.shape={}),typeof r=="string"?i[r]=n:Ne(i,r),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&bd)},t.prototype.createStyle=function(r){return gE(Gse,r)},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.shape&&!n.shape&&(n.shape=Ne({},this.shape))},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.shape?o?a?u=n.shape:(u=Ne({},i.shape),Ne(u,n.shape)):(u=Ne({},a?this.shape:i.shape),Ne(u,n.shape)):l&&(u=i.shape),u)if(o){this.shape=Ne({},this.shape);for(var f={},c=Lr(u),h=0;h<c.length;h++){var d=c[h];typeof u[d]=="object"?this.shape[d]=u[d]:f[d]=u[d]}this._transitionState(r,{shape:f},s)}else this.shape=u,this.dirtyShape()},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.shape&&(i=i||{},this._mergeStyle(i,o.shape))}return i&&(n.shape=i),n},t.prototype.getAnimationStyleProps=function(){return gCt},t.prototype.isZeroArea=function(){return!1},t.extend=function(r){var n=function(a){je(o,a);function o(s){var l=a.call(this,s)||this;return r.init&&r.init.call(l,s),l}return o.prototype.getDefaultStyle=function(){return Xt(r.style)},o.prototype.getDefaultShape=function(){return Xt(r.shape)},o}(t);for(var i in r)typeof r[i]=="function"&&(n.prototype[i]=r[i]);return n},t.initDefaultProps=function(){var r=t.prototype;r.type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,r.__dirty=Ji|Jy|bd}(),t}(ES);const hr=yCt;var mCt=fr({strokeFirst:!0,font:Gc,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Gse),Yse=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return n!=null&&n!=="none"&&r.lineWidth>0},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.createStyle=function(r){return gE(mCt,r)},t.prototype.setBoundingRect=function(r){this._rect=r},t.prototype.getBoundingRect=function(){var r=this.style;if(!this._rect){var n=r.text;n!=null?n+="":n="";var i=p3(n,r.font,r.textAlign,r.textBaseline);if(i.x+=r.x||0,i.y+=r.y||0,this.hasStroke()){var a=r.lineWidth;i.x-=a/2,i.y-=a/2,i.width+=a,i.height+=a}this._rect=i}return this._rect},t.initDefaultProps=function(){var r=t.prototype;r.dirtyRectTolerance=10}(),t}(ES);Yse.prototype.type="tspan";const BN=Yse;var bCt=fr({x:0,y:0},Tc),wCt={style:fr({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},wE.style)};function SCt(e){return!!(e&&typeof e!="string"&&e.width&&e.height)}var Kse=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.createStyle=function(r){return gE(bCt,r)},t.prototype._getSize=function(r){var n=this.style,i=n[r];if(i!=null)return i;var a=SCt(n.image)?n.image:this.__image;if(!a)return 0;var o=r==="width"?"height":"width",s=n[o];return s==null?a[r]:a[r]/a[o]*s},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return wCt},t.prototype.getBoundingRect=function(){var r=this.style;return this._rect||(this._rect=new ur(r.x||0,r.y||0,this.getWidth(),this.getHeight())),this._rect},t}(ES);Kse.prototype.type="image";const mh=Kse;function _Ct(e,t){var r=t.x,n=t.y,i=t.width,a=t.height,o=t.r,s,l,u,f;i<0&&(r=r+i,i=-i),a<0&&(n=n+a,a=-a),typeof o=="number"?s=l=u=f=o:o instanceof Array?o.length===1?s=l=u=f=o[0]:o.length===2?(s=u=o[0],l=f=o[1]):o.length===3?(s=o[0],l=f=o[1],u=o[2]):(s=o[0],l=o[1],u=o[2],f=o[3]):s=l=u=f=0;var c;s+l>i&&(c=s+l,s*=i/c,l*=i/c),u+f>i&&(c=u+f,u*=i/c,f*=i/c),l+u>a&&(c=l+u,l*=a/c,u*=a/c),s+f>a&&(c=s+f,s*=a/c,f*=a/c),e.moveTo(r+s,n),e.lineTo(r+i-l,n),l!==0&&e.arc(r+i-l,n+l,l,-Math.PI/2,0),e.lineTo(r+i,n+a-u),u!==0&&e.arc(r+i-u,n+a-u,u,0,Math.PI/2),e.lineTo(r+f,n+a),f!==0&&e.arc(r+f,n+a-f,f,Math.PI/2,Math.PI),e.lineTo(r,n+s),s!==0&&e.arc(r+s,n+s,s,Math.PI,Math.PI*1.5)}var Ad=Math.round;function Xse(e,t,r){if(t){var n=t.x1,i=t.x2,a=t.y1,o=t.y2;e.x1=n,e.x2=i,e.y1=a,e.y2=o;var s=r&&r.lineWidth;return s&&(Ad(n*2)===Ad(i*2)&&(e.x1=e.x2=yc(n,s,!0)),Ad(a*2)===Ad(o*2)&&(e.y1=e.y2=yc(a,s,!0))),e}}function qse(e,t,r){if(t){var n=t.x,i=t.y,a=t.width,o=t.height;e.x=n,e.y=i,e.width=a,e.height=o;var s=r&&r.lineWidth;return s&&(e.x=yc(n,s,!0),e.y=yc(i,s,!0),e.width=Math.max(yc(n+a,s,!1)-e.x,a===0?0:1),e.height=Math.max(yc(i+o,s,!1)-e.y,o===0?0:1)),e}}function yc(e,t,r){if(!t)return e;var n=Ad(e*2);return(n+Ad(t))%2===0?n/2:(n+(r?1:-1))/2}var CCt=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0}return e}(),xCt={},Zse=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new CCt},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=qse(xCt,n,this.style);i=l.x,a=l.y,o=l.width,s=l.height,l.r=n.r,n=l}else i=n.x,a=n.y,o=n.width,s=n.height;n.r?_Ct(r,n):r.rect(i,a,o,s)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(hr);Zse.prototype.type="rect";const Cn=Zse;var rK={fill:"#000"},nK=2,TCt={style:fr({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},wE.style)},Jse=function(e){je(t,e);function t(r){var n=e.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=rK,n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var r=0;r<this._children.length;r++){var n=this._children[r];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},t.prototype.updateTransform=function(){var r=this.innerTransformable;r?(r.updateTransform(),r.transform&&(this.transform=r.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(r){var n=this.innerTransformable;return n?n.getLocalTransform(r):e.prototype.getLocalTransform.call(this,r)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,ACt(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=r},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var r=new ur(0,0,0,0),n=this._children,i=[],a=null,o=0;o<n.length;o++){var s=n[o],l=s.getBoundingRect(),u=s.getLocalTransform(i);u?(r.copy(l),r.applyTransform(u),a=a||r.clone(),a.union(r)):(a=a||l.clone(),a.union(l))}this._rect=a||r}return this._rect},t.prototype.setDefaultTextStyle=function(r){this._defaultStyle=r||rK},t.prototype.setTextContent=function(r){},t.prototype._mergeStyle=function(r,n){if(!n)return r;var i=n.rich,a=r.rich||i&&{};return Ne(r,n),i&&a?(this._mergeRich(a,i),r.rich=a):a&&(r.rich=a),r},t.prototype._mergeRich=function(r,n){for(var i=Lr(n),a=0;a<i.length;a++){var o=i[a];r[o]=r[o]||{},Ne(r[o],n[o])}},t.prototype.getAnimationStyleProps=function(){return TCt},t.prototype._getOrCreateChild=function(r){var n=this._children[this._childCursor];return(!n||!(n instanceof r))&&(n=new r),this._children[this._childCursor++]=n,n.__zr=this.__zr,n.parent=this,n},t.prototype._updatePlainTexts=function(){var r=this.style,n=r.font||Gc,i=r.padding,a=fK(r),o=U1t(a,r),s=cP(r),l=!!r.backgroundColor,u=o.outerHeight,f=o.outerWidth,c=o.contentWidth,h=o.lines,d=o.lineHeight,v=this._defaultStyle,p=r.x||0,g=r.y||0,y=r.align||v.align||"left",m=r.verticalAlign||v.verticalAlign||"top",b=p,S=wd(g,o.contentHeight,m);if(s||i){var x=em(p,f,y),T=wd(g,u,m);s&&this._renderBackground(r,r,x,T,f,u)}S+=d/2,i&&(b=uK(p,y,i),m==="top"?S+=i[0]:m==="bottom"&&(S-=i[2]));for(var E=0,P=!1,R=lK("fill"in r?r.fill:(P=!0,v.fill)),M=sK("stroke"in r?r.stroke:!l&&(!v.autoStroke||P)?(E=nK,v.stroke):null),D=r.textShadowBlur>0,N=r.width!=null&&(r.overflow==="truncate"||r.overflow==="break"||r.overflow==="breakAll"),B=o.calculatedLineHeight,K=0;K<h.length;K++){var Z=this._getOrCreateChild(BN),ie=Z.createStyle();Z.useStyle(ie),ie.text=h[K],ie.x=b,ie.y=S,y&&(ie.textAlign=y),ie.textBaseline="middle",ie.opacity=r.opacity,ie.strokeFirst=!0,D&&(ie.shadowBlur=r.textShadowBlur||0,ie.shadowColor=r.textShadowColor||"transparent",ie.shadowOffsetX=r.textShadowOffsetX||0,ie.shadowOffsetY=r.textShadowOffsetY||0),ie.stroke=M,ie.fill=R,M&&(ie.lineWidth=r.lineWidth||E,ie.lineDash=r.lineDash,ie.lineDashOffset=r.lineDashOffset||0),ie.font=n,aK(ie,r),S+=d,N&&Z.setBoundingRect(new ur(em(ie.x,r.width,ie.textAlign),wd(ie.y,B,ie.textBaseline),c,B))}},t.prototype._updateRichTexts=function(){var r=this.style,n=fK(r),i=Y1t(n,r),a=i.width,o=i.outerWidth,s=i.outerHeight,l=r.padding,u=r.x||0,f=r.y||0,c=this._defaultStyle,h=r.align||c.align,d=r.verticalAlign||c.verticalAlign,v=em(u,o,h),p=wd(f,s,d),g=v,y=p;l&&(g+=l[3],y+=l[0]);var m=g+a;cP(r)&&this._renderBackground(r,r,v,p,o,s);for(var b=!!r.backgroundColor,S=0;S<i.lines.length;S++){for(var x=i.lines[S],T=x.tokens,E=T.length,P=x.lineHeight,R=x.width,M=0,D=g,N=m,B=E-1,K=void 0;M<E&&(K=T[M],!K.align||K.align==="left");)this._placeToken(K,r,P,y,D,"left",b),R-=K.width,D+=K.width,M++;for(;B>=0&&(K=T[B],K.align==="right");)this._placeToken(K,r,P,y,N,"right",b),R-=K.width,N-=K.width,B--;for(D+=(a-(D-g)-(m-N)-R)/2;M<=B;)K=T[M],this._placeToken(K,r,P,y,D+K.width/2,"center",b),D+=K.width,M++;y+=P}},t.prototype._placeToken=function(r,n,i,a,o,s,l){var u=n.rich[r.styleName]||{};u.text=r.text;var f=r.verticalAlign,c=a+i/2;f==="top"?c=a+r.height/2:f==="bottom"&&(c=a+i-r.height/2);var h=!r.isLineHolder&&cP(u);h&&this._renderBackground(u,n,s==="right"?o-r.width:s==="center"?o-r.width/2:o,c-r.height/2,r.width,r.height);var d=!!u.backgroundColor,v=r.textPadding;v&&(o=uK(o,s,v),c-=r.height/2-v[0]-r.innerHeight/2);var p=this._getOrCreateChild(BN),g=p.createStyle();p.useStyle(g);var y=this._defaultStyle,m=!1,b=0,S=lK("fill"in u?u.fill:"fill"in n?n.fill:(m=!0,y.fill)),x=sK("stroke"in u?u.stroke:"stroke"in n?n.stroke:!d&&!l&&(!y.autoStroke||m)?(b=nK,y.stroke):null),T=u.textShadowBlur>0||n.textShadowBlur>0;g.text=r.text,g.x=o,g.y=c,T&&(g.shadowBlur=u.textShadowBlur||n.textShadowBlur||0,g.shadowColor=u.textShadowColor||n.textShadowColor||"transparent",g.shadowOffsetX=u.textShadowOffsetX||n.textShadowOffsetX||0,g.shadowOffsetY=u.textShadowOffsetY||n.textShadowOffsetY||0),g.textAlign=s,g.textBaseline="middle",g.font=r.font||Gc,g.opacity=Dm(u.opacity,n.opacity,1),aK(g,u),x&&(g.lineWidth=Dm(u.lineWidth,n.lineWidth,b),g.lineDash=qt(u.lineDash,n.lineDash),g.lineDashOffset=n.lineDashOffset||0,g.stroke=x),S&&(g.fill=S);var E=r.contentWidth,P=r.contentHeight;p.setBoundingRect(new ur(em(g.x,E,g.textAlign),wd(g.y,P,g.textBaseline),E,P))},t.prototype._renderBackground=function(r,n,i,a,o,s){var l=r.backgroundColor,u=r.borderWidth,f=r.borderColor,c=l&&l.image,h=l&&!c,d=r.borderRadius,v=this,p,g;if(h||r.lineHeight||u&&f){p=this._getOrCreateChild(Cn),p.useStyle(p.createStyle()),p.style.fill=null;var y=p.shape;y.x=i,y.y=a,y.width=o,y.height=s,y.r=d,p.dirtyShape()}if(h){var m=p.style;m.fill=l||null,m.fillOpacity=qt(r.fillOpacity,1)}else if(c){g=this._getOrCreateChild(mh),g.onload=function(){v.dirtyStyle()};var b=g.style;b.image=l.image,b.x=i,b.y=a,b.width=o,b.height=s}if(u&&f){var m=p.style;m.lineWidth=u,m.stroke=f,m.strokeOpacity=qt(r.strokeOpacity,1),m.lineDash=r.borderDash,m.lineDashOffset=r.borderDashOffset||0,p.strokeContainThreshold=0,p.hasFill()&&p.hasStroke()&&(m.strokeFirst=!0,m.lineWidth*=2)}var S=(p||g).style;S.shadowBlur=r.shadowBlur||0,S.shadowColor=r.shadowColor||"transparent",S.shadowOffsetX=r.shadowOffsetX||0,S.shadowOffsetY=r.shadowOffsetY||0,S.opacity=Dm(r.opacity,n.opacity,1)},t.makeFont=function(r){var n="";return kCt(r)&&(n=[r.fontStyle,r.fontWeight,RCt(r.fontSize),r.fontFamily||"sans-serif"].join(" ")),n&&Ko(n)||r.textFont||r.font},t}(ES),OCt={left:!0,right:1,center:1},ECt={top:1,bottom:1,middle:1},iK=["fontStyle","fontWeight","fontSize","fontFamily"];function RCt(e){return typeof e=="string"&&(e.indexOf("px")!==-1||e.indexOf("rem")!==-1||e.indexOf("em")!==-1)?e:isNaN(+e)?i3+"px":e+"px"}function aK(e,t){for(var r=0;r<iK.length;r++){var n=iK[r],i=t[n];i!=null&&(e[n]=i)}}function kCt(e){return e.fontSize!=null||e.fontFamily||e.fontWeight}function ACt(e){return oK(e),le(e.rich,oK),e}function oK(e){if(e){e.font=Jse.makeFont(e);var t=e.align;t==="middle"&&(t="center"),e.align=t==null||OCt[t]?t:"left";var r=e.verticalAlign;r==="center"&&(r="middle"),e.verticalAlign=r==null||ECt[r]?r:"top";var n=e.padding;n&&(e.padding=ase(e.padding))}}function sK(e,t){return e==null||t<=0||e==="transparent"||e==="none"?null:e.image||e.colorStops?"#000":e}function lK(e){return e==null||e==="none"?null:e.image||e.colorStops?"#000":e}function uK(e,t,r){return t==="right"?e-r[1]:t==="center"?e+r[3]/2-r[1]/2:e+r[3]}function fK(e){var t=e.text;return t!=null&&(t+=""),t}function cP(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}const Jn=Jse;var or=Jr(),PCt=function(e,t,r,n){if(n){var i=or(n);i.dataIndex=r,i.dataType=t,i.seriesIndex=e,n.type==="group"&&n.traverse(function(a){var o=or(a);o.seriesIndex=e,o.dataIndex=r,o.dataType=t})}},cK=1,hK={},Qse=Jr(),_3=Jr(),C3=0,SE=1,_E=2,Ma=["emphasis","blur","select"],MT=["normal","emphasis","blur","select"],ICt=10,MCt=9,Oc="highlight",LC="downplay",$m="select",FC="unselect",Hm="toggleSelect";function ad(e){return e!=null&&e!=="none"}var dK=new xS(100);function vK(e){if(st(e)){var t=dK.get(e);return t||(t=MY(e,-.1),dK.put(e,t)),t}else if(pE(e)){var r=Ne({},e);return r.colorStops=ct(e.colorStops,function(n){return{offset:n.offset,color:MY(n.color,-.1)}}),r}return e}function CE(e,t,r){e.onHoverStateChange&&(e.hoverState||0)!==r&&e.onHoverStateChange(t),e.hoverState=r}function ele(e){CE(e,"emphasis",_E)}function tle(e){e.hoverState===_E&&CE(e,"normal",C3)}function x3(e){CE(e,"blur",SE)}function rle(e){e.hoverState===SE&&CE(e,"normal",C3)}function DCt(e){e.selected=!0}function NCt(e){e.selected=!1}function pK(e,t,r){t(e,r)}function Tl(e,t,r){pK(e,t,r),e.isGroup&&e.traverse(function(n){pK(n,t,r)})}function gK(e,t){switch(t){case"emphasis":e.hoverState=_E;break;case"normal":e.hoverState=C3;break;case"blur":e.hoverState=SE;break;case"select":e.selected=!0}}function LCt(e,t,r,n){for(var i=e.style,a={},o=0;o<t.length;o++){var s=t[o],l=i[s];a[s]=l??(n&&n[s])}for(var o=0;o<e.animators.length;o++){var u=e.animators[o];u.__fromStateTransition&&u.__fromStateTransition.indexOf(r)<0&&u.targetName==="style"&&u.saveTo(a,t)}return a}function FCt(e,t,r,n){var i=r&&ar(r,"select")>=0,a=!1;if(e instanceof hr){var o=Qse(e),s=i&&o.selectFill||o.normalFill,l=i&&o.selectStroke||o.normalStroke;if(ad(s)||ad(l)){n=n||{};var u=n.style||{};u.fill==="inherit"?(a=!0,n=Ne({},n),u=Ne({},u),u.fill=s):!ad(u.fill)&&ad(s)?(a=!0,n=Ne({},n),u=Ne({},u),u.fill=vK(s)):!ad(u.stroke)&&ad(l)&&(a||(n=Ne({},n),u=Ne({},u)),u.stroke=vK(l)),n.style=u}}if(n&&n.z2==null){a||(n=Ne({},n));var f=e.z2EmphasisLift;n.z2=e.z2+(f??ICt)}return n}function $Ct(e,t,r){if(r&&r.z2==null){r=Ne({},r);var n=e.z2SelectLift;r.z2=e.z2+(n??MCt)}return r}function HCt(e,t,r){var n=ar(e.currentStates,t)>=0,i=e.style.opacity,a=n?null:LCt(e,["opacity"],t,{opacity:1});r=r||{};var o=r.style||{};return o.opacity==null&&(r=Ne({},r),o=Ne({opacity:n?i:a.opacity*.1},o),r.style=o),r}function hP(e,t){var r=this.states[e];if(this.style){if(e==="emphasis")return FCt(this,e,t,r);if(e==="blur")return HCt(this,e,r);if(e==="select")return $Ct(this,e,r)}return r}function BCt(e){e.stateProxy=hP;var t=e.getTextContent(),r=e.getTextGuideLine();t&&(t.stateProxy=hP),r&&(r.stateProxy=hP)}function yK(e,t){!ole(e,t)&&!e.__highByOuter&&Tl(e,ele)}function mK(e,t){!ole(e,t)&&!e.__highByOuter&&Tl(e,tle)}function DT(e,t){e.__highByOuter|=1<<(t||0),Tl(e,ele)}function NT(e,t){!(e.__highByOuter&=~(1<<(t||0)))&&Tl(e,tle)}function nle(e){Tl(e,x3)}function T3(e){Tl(e,rle)}function ile(e){Tl(e,DCt)}function ale(e){Tl(e,NCt)}function ole(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function sle(e){var t=e.getModel(),r=[],n=[];t.eachComponent(function(i,a){var o=_3(a),s=i==="series",l=s?e.getViewOfSeriesModel(a):e.getViewOfComponentModel(a);!s&&n.push(l),o.isBlured&&(l.group.traverse(function(u){rle(u)}),s&&r.push(a)),o.isBlured=!1}),le(n,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(r,!1,t)})}function VN(e,t,r,n){var i=n.getModel();r=r||"coordinateSystem";function a(u,f){for(var c=0;c<f.length;c++){var h=u.getItemGraphicEl(f[c]);h&&T3(h)}}if(e!=null&&!(!t||t==="none")){var o=i.getSeriesByIndex(e),s=o.coordinateSystem;s&&s.master&&(s=s.master);var l=[];i.eachSeries(function(u){var f=o===u,c=u.coordinateSystem;c&&c.master&&(c=c.master);var h=c&&s?c===s:f;if(!(r==="series"&&!f||r==="coordinateSystem"&&!h||t==="series"&&f)){var d=n.getViewOfSeriesModel(u);if(d.group.traverse(function(g){x3(g)}),Fi(t))a(u.getData(),t);else if(vt(t))for(var v=Lr(t),p=0;p<v.length;p++)a(u.getData(v[p]),t[v[p]]);l.push(u),_3(u).isBlured=!0}}),i.eachComponent(function(u,f){if(u!=="series"){var c=n.getViewOfComponentModel(f);c&&c.toggleBlurSeries&&c.toggleBlurSeries(l,!0,i)}})}}function jN(e,t,r){if(!(e==null||t==null)){var n=r.getModel().getComponent(e,t);if(n){_3(n).isBlured=!0;var i=r.getViewOfComponentModel(n);!i||!i.focusBlurEnabled||i.group.traverse(function(a){x3(a)})}}}function VCt(e,t,r){var n=e.seriesIndex,i=e.getData(t.dataType);if(i){var a=Yc(i,t);a=(Ze(a)?a[0]:a)||0;var o=i.getItemGraphicEl(a);if(!o)for(var s=i.count(),l=0;!o&&l<s;)o=i.getItemGraphicEl(l++);if(o){var u=or(o);VN(n,u.focus,u.blurScope,r)}else{var f=e.get(["emphasis","focus"]),c=e.get(["emphasis","blurScope"]);f!=null&&VN(n,f,c,r)}}}function O3(e,t,r,n){var i={focusSelf:!1,dispatchers:null};if(e==null||e==="series"||t==null||r==null)return i;var a=n.getModel().getComponent(e,t);if(!a)return i;var o=n.getViewOfComponentModel(a);if(!o||!o.findHighDownDispatchers)return i;for(var s=o.findHighDownDispatchers(r),l,u=0;u<s.length;u++)if(or(s[u]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:s}}function jCt(e,t,r){var n=or(e),i=O3(n.componentMainType,n.componentIndex,n.componentHighDownName,r),a=i.dispatchers,o=i.focusSelf;a?(o&&jN(n.componentMainType,n.componentIndex,r),le(a,function(s){return yK(s,t)})):(VN(n.seriesIndex,n.focus,n.blurScope,r),n.focus==="self"&&jN(n.componentMainType,n.componentIndex,r),yK(e,t))}function WCt(e,t,r){sle(r);var n=or(e),i=O3(n.componentMainType,n.componentIndex,n.componentHighDownName,r).dispatchers;i?le(i,function(a){return mK(a,t)}):mK(e,t)}function UCt(e,t,r){if(zN(t)){var n=t.dataType,i=e.getData(n),a=Yc(i,t);Ze(a)||(a=[a]),e[t.type===Hm?"toggleSelect":t.type===$m?"select":"unselect"](a,n)}}function bK(e){var t=e.getAllData();le(t,function(r){var n=r.data,i=r.type;n.eachItemGraphicEl(function(a,o){e.isSelected(o,i)?ile(a):ale(a)})})}function zCt(e){var t=[];return e.eachSeries(function(r){var n=r.getAllData();le(n,function(i){i.data;var a=i.type,o=r.getSelectedDataIndices();if(o.length>0){var s={dataIndex:o,seriesIndex:r.seriesIndex};a!=null&&(s.dataType=a),t.push(s)}})}),t}function WN(e,t,r){lle(e,!0),Tl(e,BCt),YCt(e,t,r)}function GCt(e){lle(e,!1)}function pw(e,t,r,n){n?GCt(e):WN(e,t,r)}function YCt(e,t,r){var n=or(e);t!=null?(n.focus=t,n.blurScope=r):n.focus&&(n.focus=null)}var wK=["emphasis","blur","select"],KCt={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function LT(e,t,r,n){r=r||"itemStyle";for(var i=0;i<wK.length;i++){var a=wK[i],o=t.getModel([a,r]),s=e.ensureState(a);s.style=n?n(o):o[KCt[r]]()}}function lle(e,t){var r=t===!1,n=e;e.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=e.highDownSilentOnTouch),(!r||n.__highDownDispatcher)&&(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!r)}function UN(e){return!!(e&&e.__highDownDispatcher)}function XCt(e){var t=hK[e];return t==null&&cK<=32&&(t=hK[e]=cK++),t}function zN(e){var t=e.type;return t===$m||t===FC||t===Hm}function SK(e){var t=e.type;return t===Oc||t===LC}function qCt(e){var t=Qse(e);t.normalFill=e.style.fill,t.normalStroke=e.style.stroke;var r=e.states.select||{};t.selectFill=r.style&&r.style.fill||null,t.selectStroke=r.style&&r.style.stroke||null}var od=$u.CMD,ZCt=[[],[],[]],_K=Math.sqrt,JCt=Math.atan2;function QCt(e,t){if(t){var r=e.data,n=e.len(),i,a,o,s,l,u,f=od.M,c=od.C,h=od.L,d=od.R,v=od.A,p=od.Q;for(o=0,s=0;o<n;){switch(i=r[o++],s=o,a=0,i){case f:a=1;break;case h:a=1;break;case c:a=3;break;case p:a=2;break;case v:var g=t[4],y=t[5],m=_K(t[0]*t[0]+t[1]*t[1]),b=_K(t[2]*t[2]+t[3]*t[3]),S=JCt(-t[1]/b,t[0]/m);r[o]*=m,r[o++]+=g,r[o]*=b,r[o++]+=y,r[o++]*=m,r[o++]*=b,r[o++]+=S,r[o++]+=S,o+=2,s=o;break;case d:u[0]=r[o++],u[1]=r[o++],ka(u,u,t),r[s++]=u[0],r[s++]=u[1],u[0]+=r[o++],u[1]+=r[o++],ka(u,u,t),r[s++]=u[0],r[s++]=u[1]}for(l=0;l<a;l++){var x=ZCt[l];x[0]=r[o++],x[1]=r[o++],ka(x,x,t),r[s++]=x[0],r[s++]=x[1]}}e.increaseVersion()}}var dP=Math.sqrt,s1=Math.sin,l1=Math.cos,Ty=Math.PI;function CK(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function GN(e,t){return(e[0]*t[0]+e[1]*t[1])/(CK(e)*CK(t))}function xK(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(GN(e,t))}function TK(e,t,r,n,i,a,o,s,l,u,f){var c=l*(Ty/180),h=l1(c)*(e-r)/2+s1(c)*(t-n)/2,d=-1*s1(c)*(e-r)/2+l1(c)*(t-n)/2,v=h*h/(o*o)+d*d/(s*s);v>1&&(o*=dP(v),s*=dP(v));var p=(i===a?-1:1)*dP((o*o*(s*s)-o*o*(d*d)-s*s*(h*h))/(o*o*(d*d)+s*s*(h*h)))||0,g=p*o*d/s,y=p*-s*h/o,m=(e+r)/2+l1(c)*g-s1(c)*y,b=(t+n)/2+s1(c)*g+l1(c)*y,S=xK([1,0],[(h-g)/o,(d-y)/s]),x=[(h-g)/o,(d-y)/s],T=[(-1*h-g)/o,(-1*d-y)/s],E=xK(x,T);if(GN(x,T)<=-1&&(E=Ty),GN(x,T)>=1&&(E=0),E<0){var P=Math.round(E/Ty*1e6)/1e6;E=Ty*2+P%2*Ty}f.addData(u,m,b,o,s,S,E,c,a)}var ext=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,txt=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function rxt(e){var t=new $u;if(!e)return t;var r=0,n=0,i=r,a=n,o,s=$u.CMD,l=e.match(ext);if(!l)return t;for(var u=0;u<l.length;u++){for(var f=l[u],c=f.charAt(0),h=void 0,d=f.match(txt)||[],v=d.length,p=0;p<v;p++)d[p]=parseFloat(d[p]);for(var g=0;g<v;){var y=void 0,m=void 0,b=void 0,S=void 0,x=void 0,T=void 0,E=void 0,P=r,R=n,M=void 0,D=void 0;switch(c){case"l":r+=d[g++],n+=d[g++],h=s.L,t.addData(h,r,n);break;case"L":r=d[g++],n=d[g++],h=s.L,t.addData(h,r,n);break;case"m":r+=d[g++],n+=d[g++],h=s.M,t.addData(h,r,n),i=r,a=n,c="l";break;case"M":r=d[g++],n=d[g++],h=s.M,t.addData(h,r,n),i=r,a=n,c="L";break;case"h":r+=d[g++],h=s.L,t.addData(h,r,n);break;case"H":r=d[g++],h=s.L,t.addData(h,r,n);break;case"v":n+=d[g++],h=s.L,t.addData(h,r,n);break;case"V":n=d[g++],h=s.L,t.addData(h,r,n);break;case"C":h=s.C,t.addData(h,d[g++],d[g++],d[g++],d[g++],d[g++],d[g++]),r=d[g-2],n=d[g-1];break;case"c":h=s.C,t.addData(h,d[g++]+r,d[g++]+n,d[g++]+r,d[g++]+n,d[g++]+r,d[g++]+n),r+=d[g-2],n+=d[g-1];break;case"S":y=r,m=n,M=t.len(),D=t.data,o===s.C&&(y+=r-D[M-4],m+=n-D[M-3]),h=s.C,P=d[g++],R=d[g++],r=d[g++],n=d[g++],t.addData(h,y,m,P,R,r,n);break;case"s":y=r,m=n,M=t.len(),D=t.data,o===s.C&&(y+=r-D[M-4],m+=n-D[M-3]),h=s.C,P=r+d[g++],R=n+d[g++],r+=d[g++],n+=d[g++],t.addData(h,y,m,P,R,r,n);break;case"Q":P=d[g++],R=d[g++],r=d[g++],n=d[g++],h=s.Q,t.addData(h,P,R,r,n);break;case"q":P=d[g++]+r,R=d[g++]+n,r+=d[g++],n+=d[g++],h=s.Q,t.addData(h,P,R,r,n);break;case"T":y=r,m=n,M=t.len(),D=t.data,o===s.Q&&(y+=r-D[M-4],m+=n-D[M-3]),r=d[g++],n=d[g++],h=s.Q,t.addData(h,y,m,r,n);break;case"t":y=r,m=n,M=t.len(),D=t.data,o===s.Q&&(y+=r-D[M-4],m+=n-D[M-3]),r+=d[g++],n+=d[g++],h=s.Q,t.addData(h,y,m,r,n);break;case"A":b=d[g++],S=d[g++],x=d[g++],T=d[g++],E=d[g++],P=r,R=n,r=d[g++],n=d[g++],h=s.A,TK(P,R,r,n,T,E,b,S,x,h,t);break;case"a":b=d[g++],S=d[g++],x=d[g++],T=d[g++],E=d[g++],P=r,R=n,r+=d[g++],n+=d[g++],h=s.A,TK(P,R,r,n,T,E,b,S,x,h,t);break}}(c==="z"||c==="Z")&&(h=s.Z,t.addData(h),r=i,n=a),o=h}return t.toStatic(),t}var ule=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.applyTransform=function(r){},t}(hr);function fle(e){return e.setData!=null}function cle(e,t){var r=rxt(e),n=Ne({},t);return n.buildPath=function(i){if(fle(i)){i.setData(r.data);var a=i.getContext();a&&i.rebuildPath(a,1)}else{var a=i;r.rebuildPath(a,1)}},n.applyTransform=function(i){QCt(r,i),this.dirtyShape()},n}function nxt(e,t){return new ule(cle(e,t))}function ixt(e,t){var r=cle(e,t),n=function(i){je(a,i);function a(o){var s=i.call(this,o)||this;return s.applyTransform=r.applyTransform,s.buildPath=r.buildPath,s}return a}(ule);return n}function axt(e,t){for(var r=[],n=e.length,i=0;i<n;i++){var a=e[i];r.push(a.getUpdatedPathProxy(!0))}var o=new hr(t);return o.createPathProxy(),o.buildPath=function(s){if(fle(s)){s.appendPath(r);var l=s.getContext();l&&s.rebuildPath(l,1)}},o}var oxt=function(){function e(){this.cx=0,this.cy=0,this.r=0}return e}(),hle=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new oxt},t.prototype.buildPath=function(r,n){r.moveTo(n.cx+n.r,n.cy),r.arc(n.cx,n.cy,n.r,0,Math.PI*2)},t}(hr);hle.prototype.type="circle";const E3=hle;var sxt=function(){function e(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return e}(),dle=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new sxt},t.prototype.buildPath=function(r,n){var i=.5522848,a=n.cx,o=n.cy,s=n.rx,l=n.ry,u=s*i,f=l*i;r.moveTo(a-s,o),r.bezierCurveTo(a-s,o-f,a-u,o-l,a,o-l),r.bezierCurveTo(a+u,o-l,a+s,o-f,a+s,o),r.bezierCurveTo(a+s,o+f,a+u,o+l,a,o+l),r.bezierCurveTo(a-u,o+l,a-s,o+f,a-s,o),r.closePath()},t}(hr);dle.prototype.type="ellipse";const vle=dle;var ple=Math.PI,vP=ple*2,Tf=Math.sin,sd=Math.cos,lxt=Math.acos,Fn=Math.atan2,OK=Math.abs,Bm=Math.sqrt,tm=Math.max,Ho=Math.min,qa=1e-4;function uxt(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=c*l-f*u;if(!(h*h<qa))return h=(f*(t-a)-c*(e-i))/h,[e+h*l,t+h*u]}function u1(e,t,r,n,i,a,o){var s=e-r,l=t-n,u=(o?a:-a)/Bm(s*s+l*l),f=u*l,c=-u*s,h=e+f,d=t+c,v=r+f,p=n+c,g=(h+v)/2,y=(d+p)/2,m=v-h,b=p-d,S=m*m+b*b,x=i-a,T=h*p-v*d,E=(b<0?-1:1)*Bm(tm(0,x*x*S-T*T)),P=(T*b-m*E)/S,R=(-T*m-b*E)/S,M=(T*b+m*E)/S,D=(-T*m+b*E)/S,N=P-g,B=R-y,K=M-g,Z=D-y;return N*N+B*B>K*K+Z*Z&&(P=M,R=D),{cx:P,cy:R,x0:-f,y0:-c,x1:P*(i/x-1),y1:R*(i/x-1)}}function fxt(e){var t;if(Ze(e)){var r=e.length;if(!r)return e;r===1?t=[e[0],e[0],0,0]:r===2?t=[e[0],e[0],e[1],e[1]]:r===3?t=e.concat(e[2]):t=e}else t=[e,e,e,e];return t}function cxt(e,t){var r,n=tm(t.r,0),i=tm(t.r0||0,0),a=n>0,o=i>0;if(!(!a&&!o)){if(a||(n=i,i=0),i>n){var s=n;n=i,i=s}var l=t.startAngle,u=t.endAngle;if(!(isNaN(l)||isNaN(u))){var f=t.cx,c=t.cy,h=!!t.clockwise,d=OK(u-l),v=d>vP&&d%vP;if(v>qa&&(d=v),!(n>qa))e.moveTo(f,c);else if(d>vP-qa)e.moveTo(f+n*sd(l),c+n*Tf(l)),e.arc(f,c,n,l,u,!h),i>qa&&(e.moveTo(f+i*sd(u),c+i*Tf(u)),e.arc(f,c,i,u,l,h));else{var p=void 0,g=void 0,y=void 0,m=void 0,b=void 0,S=void 0,x=void 0,T=void 0,E=void 0,P=void 0,R=void 0,M=void 0,D=void 0,N=void 0,B=void 0,K=void 0,Z=n*sd(l),ie=n*Tf(l),me=i*sd(u),k=i*Tf(u),w=d>qa;if(w){var C=t.cornerRadius;C&&(r=fxt(C),p=r[0],g=r[1],y=r[2],m=r[3]);var O=OK(n-i)/2;if(b=Ho(O,y),S=Ho(O,m),x=Ho(O,p),T=Ho(O,g),R=E=tm(b,S),M=P=tm(x,T),(E>qa||P>qa)&&(D=n*sd(u),N=n*Tf(u),B=i*sd(l),K=i*Tf(l),d<ple)){var _=uxt(Z,ie,B,K,D,N,me,k);if(_){var A=Z-_[0],I=ie-_[1],L=D-_[0],V=N-_[1],Y=1/Tf(lxt((A*L+I*V)/(Bm(A*A+I*I)*Bm(L*L+V*V)))/2),ae=Bm(_[0]*_[0]+_[1]*_[1]);R=Ho(E,(n-ae)/(Y+1)),M=Ho(P,(i-ae)/(Y-1))}}}if(!w)e.moveTo(f+Z,c+ie);else if(R>qa){var re=Ho(y,R),te=Ho(m,R),ge=u1(B,K,Z,ie,n,re,h),H=u1(D,N,me,k,n,te,h);e.moveTo(f+ge.cx+ge.x0,c+ge.cy+ge.y0),R<E&&re===te?e.arc(f+ge.cx,c+ge.cy,R,Fn(ge.y0,ge.x0),Fn(H.y0,H.x0),!h):(re>0&&e.arc(f+ge.cx,c+ge.cy,re,Fn(ge.y0,ge.x0),Fn(ge.y1,ge.x1),!h),e.arc(f,c,n,Fn(ge.cy+ge.y1,ge.cx+ge.x1),Fn(H.cy+H.y1,H.cx+H.x1),!h),te>0&&e.arc(f+H.cx,c+H.cy,te,Fn(H.y1,H.x1),Fn(H.y0,H.x0),!h))}else e.moveTo(f+Z,c+ie),e.arc(f,c,n,l,u,!h);if(!(i>qa)||!w)e.lineTo(f+me,c+k);else if(M>qa){var re=Ho(p,M),te=Ho(g,M),ge=u1(me,k,D,N,i,-te,h),H=u1(Z,ie,B,K,i,-re,h);e.lineTo(f+ge.cx+ge.x0,c+ge.cy+ge.y0),M<P&&re===te?e.arc(f+ge.cx,c+ge.cy,M,Fn(ge.y0,ge.x0),Fn(H.y0,H.x0),!h):(te>0&&e.arc(f+ge.cx,c+ge.cy,te,Fn(ge.y0,ge.x0),Fn(ge.y1,ge.x1),!h),e.arc(f,c,i,Fn(ge.cy+ge.y1,ge.cx+ge.x1),Fn(H.cy+H.y1,H.cx+H.x1),h),re>0&&e.arc(f+H.cx,c+H.cy,re,Fn(H.y1,H.x1),Fn(H.y0,H.x0),!h))}else e.lineTo(f+me,c+k),e.arc(f,c,i,u,l,h)}e.closePath()}}}var hxt=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return e}(),gle=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new hxt},t.prototype.buildPath=function(r,n){cxt(r,n)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(hr);gle.prototype.type="sector";const bh=gle;var dxt=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return e}(),yle=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new dxt},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.PI*2;r.moveTo(i+n.r,a),r.arc(i,a,n.r,0,o,!1),r.moveTo(i+n.r0,a),r.arc(i,a,n.r0,0,o,!0)},t}(hr);yle.prototype.type="ring";const mle=yle;function vxt(e,t,r,n){var i=[],a=[],o=[],s=[],l,u,f,c;if(n){f=[1/0,1/0],c=[-1/0,-1/0];for(var h=0,d=e.length;h<d;h++)Ed(f,f,e[h]),Rd(c,c,e[h]);Ed(f,f,n[0]),Rd(c,c,n[1])}for(var h=0,d=e.length;h<d;h++){var v=e[h];if(r)l=e[h?h-1:d-1],u=e[(h+1)%d];else if(h===0||h===d-1){i.push(FSt(e[h]));continue}else l=e[h-1],u=e[h+1];$St(a,u,l),PA(a,a,t);var p=bN(v,l),g=bN(v,u),y=p+g;y!==0&&(p/=y,g/=y),PA(o,a,-p),PA(s,a,g);var m=mY([],v,o),b=mY([],v,s);n&&(Rd(m,m,f),Ed(m,m,c),Rd(b,b,f),Ed(b,b,c)),i.push(m),i.push(b)}return r&&i.push(i.shift()),i}function ble(e,t,r){var n=t.smooth,i=t.points;if(i&&i.length>=2){if(n){var a=vxt(i,n,r,t.smoothConstraint);e.moveTo(i[0][0],i[0][1]);for(var o=i.length,s=0;s<(r?o:o-1);s++){var l=a[s*2],u=a[s*2+1],f=i[(s+1)%o];e.bezierCurveTo(l[0],l[1],u[0],u[1],f[0],f[1])}}else{e.moveTo(i[0][0],i[0][1]);for(var s=1,c=i.length;s<c;s++)e.lineTo(i[s][0],i[s][1])}r&&e.closePath()}}var pxt=function(){function e(){this.points=null,this.smooth=0,this.smoothConstraint=null}return e}(),wle=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new pxt},t.prototype.buildPath=function(r,n){ble(r,n,!0)},t}(hr);wle.prototype.type="polygon";const Sle=wle;var gxt=function(){function e(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return e}(),_le=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new gxt},t.prototype.buildPath=function(r,n){ble(r,n,!1)},t}(hr);_le.prototype.type="polyline";const xE=_le;var yxt={},mxt=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return e}(),Cle=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new mxt},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=Xse(yxt,n,this.style);i=l.x1,a=l.y1,o=l.x2,s=l.y2}else i=n.x1,a=n.y1,o=n.x2,s=n.y2;var u=n.percent;u!==0&&(r.moveTo(i,a),u<1&&(o=i*(1-u)+o*u,s=a*(1-u)+s*u),r.lineTo(o,s))},t.prototype.pointAt=function(r){var n=this.shape;return[n.x1*(1-r)+n.x2*r,n.y1*(1-r)+n.y2*r]},t}(hr);Cle.prototype.type="line";const Kc=Cle;var Ti=[],bxt=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return e}();function EK(e,t,r){var n=e.cpx2,i=e.cpy2;return n!=null||i!=null?[(r?kY:mn)(e.x1,e.cpx1,e.cpx2,e.x2,t),(r?kY:mn)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(r?AY:Hn)(e.x1,e.cpx1,e.x2,t),(r?AY:Hn)(e.y1,e.cpy1,e.y2,t)]}var xle=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new bxt},t.prototype.buildPath=function(r,n){var i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.cpx1,u=n.cpy1,f=n.cpx2,c=n.cpy2,h=n.percent;h!==0&&(r.moveTo(i,a),f==null||c==null?(h<1&&(OT(i,l,o,h,Ti),l=Ti[1],o=Ti[2],OT(a,u,s,h,Ti),u=Ti[1],s=Ti[2]),r.quadraticCurveTo(l,u,o,s)):(h<1&&(TT(i,l,f,o,h,Ti),l=Ti[1],f=Ti[2],o=Ti[3],TT(a,u,c,s,h,Ti),u=Ti[1],c=Ti[2],s=Ti[3]),r.bezierCurveTo(l,u,f,c,o,s)))},t.prototype.pointAt=function(r){return EK(this.shape,r,!1)},t.prototype.tangentAt=function(r){var n=EK(this.shape,r,!0);return VSt(n,n)},t}(hr);xle.prototype.type="bezier-curve";const Tle=xle;var wxt=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),Ole=function(e){je(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new wxt},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r,0),s=n.startAngle,l=n.endAngle,u=n.clockwise,f=Math.cos(s),c=Math.sin(s);r.moveTo(f*o+i,c*o+a),r.arc(i,a,o,s,l,!u)},t}(hr);Ole.prototype.type="arc";const R3=Ole;var Sxt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="compound",r}return t.prototype._updatePathDirty=function(){for(var r=this.shape.paths,n=this.shapeChanged(),i=0;i<r.length;i++)n=n||r[i].shapeChanged();n&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var r=this.shape.paths||[],n=this.getGlobalScale(),i=0;i<r.length;i++)r[i].path||r[i].createPathProxy(),r[i].path.setScale(n[0],n[1],r[i].segmentIgnoreThreshold)},t.prototype.buildPath=function(r,n){for(var i=n.paths||[],a=0;a<i.length;a++)i[a].buildPath(r,i[a].shape,!0)},t.prototype.afterBrush=function(){for(var r=this.shape.paths||[],n=0;n<r.length;n++)r[n].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),hr.prototype.getBoundingRect.call(this)},t}(hr);const _xt=Sxt;var Cxt=function(){function e(t){this.colorStops=t||[]}return e.prototype.addColorStop=function(t,r){this.colorStops.push({offset:t,color:r})},e}();const Ele=Cxt;var xxt=function(e){je(t,e);function t(r,n,i,a,o,s){var l=e.call(this,o)||this;return l.x=r??0,l.y=n??0,l.x2=i??1,l.y2=a??0,l.type="linear",l.global=s||!1,l}return t}(Ele);const Rle=xxt;var Txt=function(e){je(t,e);function t(r,n,i,a,o){var s=e.call(this,a)||this;return s.x=r??.5,s.y=n??.5,s.r=i??.5,s.type="radial",s.global=o||!1,s}return t}(Ele);const Oxt=Txt;var Of=[0,0],Ef=[0,0],f1=new xt,c1=new xt,Ext=function(){function e(t,r){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new xt;for(var n=0;n<2;n++)this._axes[n]=new xt;t&&this.fromBoundingRect(t,r)}return e.prototype.fromBoundingRect=function(t,r){var n=this._corners,i=this._axes,a=t.x,o=t.y,s=a+t.width,l=o+t.height;if(n[0].set(a,o),n[1].set(s,o),n[2].set(s,l),n[3].set(a,l),r)for(var u=0;u<4;u++)n[u].transform(r);xt.sub(i[0],n[1],n[0]),xt.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(var u=0;u<2;u++)this._origin[u]=i[u].dot(n[0])},e.prototype.intersect=function(t,r){var n=!0,i=!r;return f1.set(1/0,1/0),c1.set(0,0),!this._intersectCheckOneSide(this,t,f1,c1,i,1)&&(n=!1,i)||!this._intersectCheckOneSide(t,this,f1,c1,i,-1)&&(n=!1,i)||i||xt.copy(r,n?f1:c1),n},e.prototype._intersectCheckOneSide=function(t,r,n,i,a,o){for(var s=!0,l=0;l<2;l++){var u=this._axes[l];if(this._getProjMinMaxOnAxis(l,t._corners,Of),this._getProjMinMaxOnAxis(l,r._corners,Ef),Of[1]<Ef[0]||Of[0]>Ef[1]){if(s=!1,a)return s;var f=Math.abs(Ef[0]-Of[1]),c=Math.abs(Of[0]-Ef[1]);Math.min(f,c)>i.len()&&(f<c?xt.scale(i,u,-f*o):xt.scale(i,u,c*o))}else if(n){var f=Math.abs(Ef[0]-Of[1]),c=Math.abs(Of[0]-Ef[1]);Math.min(f,c)<n.len()&&(f<c?xt.scale(n,u,f*o):xt.scale(n,u,-c*o))}}return s},e.prototype._getProjMinMaxOnAxis=function(t,r,n){for(var i=this._axes[t],a=this._origin,o=r[0].dot(i)+a[t],s=o,l=o,u=1;u<r.length;u++){var f=r[u].dot(i)+a[t];s=Math.min(f,s),l=Math.max(f,l)}n[0]=s,n[1]=l},e}();const FT=Ext;var Rxt=[],kxt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.notClear=!0,r.incremental=!0,r._displayables=[],r._temporaryDisplayables=[],r._cursor=0,r}return t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(r,n){n?this._temporaryDisplayables.push(r):this._displayables.push(r),this.markRedraw()},t.prototype.addDisplayables=function(r,n){n=n||!1;for(var i=0;i<r.length;i++)this.addDisplayable(r[i],n)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(r){for(var n=this._cursor;n<this._displayables.length;n++)r&&r(this._displayables[n]);for(var n=0;n<this._temporaryDisplayables.length;n++)r&&r(this._temporaryDisplayables[n])},t.prototype.update=function(){this.updateTransform();for(var r=this._cursor;r<this._displayables.length;r++){var n=this._displayables[r];n.parent=this,n.update(),n.parent=null}for(var r=0;r<this._temporaryDisplayables.length;r++){var n=this._temporaryDisplayables[r];n.parent=this,n.update(),n.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var r=new ur(1/0,1/0,-1/0,-1/0),n=0;n<this._displayables.length;n++){var i=this._displayables[n],a=i.getBoundingRect().clone();i.needLocalTransform()&&a.applyTransform(i.getLocalTransform(Rxt)),r.union(a)}this._rect=r}return this._rect},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(a.contain(i[0],i[1]))for(var o=0;o<this._displayables.length;o++){var s=this._displayables[o];if(s.contain(r,n))return!0}return!1},t}(ES);const Axt=kxt;var Pxt=Jr();function Ixt(e,t,r,n,i){var a;if(t&&t.ecModel){var o=t.ecModel.getUpdatePayload();a=o&&o.animation}var s=t&&t.isAnimationEnabled(),l=e==="update";if(s){var u=void 0,f=void 0,c=void 0;n?(u=qt(n.duration,200),f=qt(n.easing,"cubicOut"),c=0):(u=t.getShallow(l?"animationDurationUpdate":"animationDuration"),f=t.getShallow(l?"animationEasingUpdate":"animationEasing"),c=t.getShallow(l?"animationDelayUpdate":"animationDelay")),a&&(a.duration!=null&&(u=a.duration),a.easing!=null&&(f=a.easing),a.delay!=null&&(c=a.delay)),gt(c)&&(c=c(r,i)),gt(u)&&(u=u(r));var h={duration:u||0,delay:c,easing:f};return h}else return null}function k3(e,t,r,n,i,a,o){var s=!1,l;gt(i)?(o=a,a=i,i=null):vt(i)&&(a=i.cb,o=i.during,s=i.isFrom,l=i.removeOpt,i=i.dataIndex);var u=e==="leave";u||t.stopAnimation("leave");var f=Ixt(e,n,i,u?l||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(t,i):null);if(f&&f.duration>0){var c=f.duration,h=f.delay,d=f.easing,v={duration:c,delay:h||0,easing:d,done:a,force:!!a||!!o,setToFinal:!u,scope:e,during:o};s?t.animateFrom(r,v):t.animateTo(r,v)}else t.stopAnimation(),!s&&t.attr(r),o&&o(1),a&&a()}function Si(e,t,r,n,i,a){k3("update",e,t,r,n,i,a)}function Aa(e,t,r,n,i,a){k3("enter",e,t,r,n,i,a)}function Vm(e){if(!e.__zr)return!0;for(var t=0;t<e.animators.length;t++){var r=e.animators[t];if(r.scope==="leave")return!0}return!1}function $T(e,t,r,n,i,a){Vm(e)||k3("leave",e,t,r,n,i,a)}function RK(e,t,r,n){e.removeTextContent(),e.removeTextGuideLine(),$T(e,{style:{opacity:0}},t,r,n)}function HT(e,t,r){function n(){e.parent&&e.parent.remove(e)}e.isGroup?e.traverse(function(i){i.isGroup||RK(i,t,r,n)}):RK(e,t,r,n)}function A3(e){Pxt(e).oldStyle=e.style}var BT=Math.max,VT=Math.min,YN={};function Mxt(e){return hr.extend(e)}var Dxt=ixt;function Nxt(e,t){return Dxt(e,t)}function Co(e,t){YN[e]=t}function Lxt(e){if(YN.hasOwnProperty(e))return YN[e]}function P3(e,t,r,n){var i=nxt(e,t);return r&&(n==="center"&&(r=Ale(r,i.getBoundingRect())),Ple(i,r)),i}function kle(e,t,r){var n=new mh({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(i){if(r==="center"){var a={width:i.width,height:i.height};n.setStyle(Ale(t,a))}}});return n}function Ale(e,t){var r=t.width/t.height,n=e.height*r,i;n<=e.width?i=e.height:(n=e.width,i=n/r);var a=e.x+e.width/2,o=e.y+e.height/2;return{x:a-n/2,y:o-i/2,width:n,height:i}}var Fxt=axt;function Ple(e,t){if(e.applyTransform){var r=e.getBoundingRect(),n=r.calculateTransform(t);e.applyTransform(n)}}function gw(e,t){return Xse(e,e,{lineWidth:t}),e}function $xt(e){return qse(e.shape,e.shape,e.style),e}var Hxt=yc;function Bxt(e,t){for(var r=f3([]);e&&e!==t;)Zd(r,e.getLocalTransform(),r),e=e.parent;return r}function I3(e,t,r){return t&&!Fi(t)&&(t=v3.getLocalTransform(t)),r&&(t=h3([],t)),ka([],e,t)}function Vxt(e,t,r){var n=t[4]===0||t[5]===0||t[0]===0?1:Math.abs(2*t[4]/t[0]),i=t[4]===0||t[5]===0||t[2]===0?1:Math.abs(2*t[4]/t[2]),a=[e==="left"?-n:e==="right"?n:0,e==="top"?-i:e==="bottom"?i:0];return a=I3(a,t,r),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function kK(e){return!e.isGroup}function jxt(e){return e.shape!=null}function Ile(e,t,r){if(!e||!t)return;function n(o){var s={};return o.traverse(function(l){kK(l)&&l.anid&&(s[l.anid]=l)}),s}function i(o){var s={x:o.x,y:o.y,rotation:o.rotation};return jxt(o)&&(s.shape=Ne({},o.shape)),s}var a=n(e);t.traverse(function(o){if(kK(o)&&o.anid){var s=a[o.anid];if(s){var l=i(o);o.attr(i(s)),Si(o,l,r,or(o).dataIndex)}}})}function Wxt(e,t){return ct(e,function(r){var n=r[0];n=BT(n,t.x),n=VT(n,t.x+t.width);var i=r[1];return i=BT(i,t.y),i=VT(i,t.y+t.height),[n,i]})}function Uxt(e,t){var r=BT(e.x,t.x),n=VT(e.x+e.width,t.x+t.width),i=BT(e.y,t.y),a=VT(e.y+e.height,t.y+t.height);if(n>=r&&a>=i)return{x:r,y:i,width:n-r,height:a-i}}function M3(e,t,r){var n=Ne({rectHover:!0},t),i=n.style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},e)return e.indexOf("image://")===0?(i.image=e.slice(8),fr(i,r),new mh(n)):P3(e.replace("path://",""),n,r,"center")}function zxt(e,t,r,n,i){for(var a=0,o=i[i.length-1];a<i.length;a++){var s=i[a];if(Mle(e,t,r,n,s[0],s[1],o[0],o[1]))return!0;o=s}}function Mle(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,f=o-i,c=s-a,h=pP(f,c,l,u);if(Gxt(h))return!1;var d=e-i,v=t-a,p=pP(d,v,l,u)/h;if(p<0||p>1)return!1;var g=pP(d,v,f,c)/h;return!(g<0||g>1)}function pP(e,t,r,n){return e*n-r*t}function Gxt(e){return e<=1e-6&&e>=-1e-6}function D3(e){var t=e.itemTooltipOption,r=e.componentModel,n=e.itemName,i=st(t)?{formatter:t}:t,a=r.mainType,o=r.componentIndex,s={componentType:a,name:n,$vars:["name"]};s[a+"Index"]=o;var l=e.formatterParamsExtra;l&&le(Lr(l),function(f){dg(s,f)||(s[f]=l[f],s.$vars.push(f))});var u=or(e.el);u.componentMainType=a,u.componentIndex=o,u.tooltipConfig={name:n,option:fr({content:n,formatterParams:s},i)}}function AK(e,t){var r;e.isGroup&&(r=t(e)),r||e.traverse(t)}function TE(e,t){if(e)if(Ze(e))for(var r=0;r<e.length;r++)AK(e[r],t);else AK(e,t)}Co("circle",E3);Co("ellipse",vle);Co("sector",bh);Co("ring",mle);Co("polygon",Sle);Co("polyline",xE);Co("rect",Cn);Co("line",Kc);Co("bezierCurve",Tle);Co("arc",R3);const Yxt=Object.freeze(Object.defineProperty({__proto__:null,Arc:R3,BezierCurve:Tle,BoundingRect:ur,Circle:E3,CompoundPath:_xt,Ellipse:vle,Group:Zn,Image:mh,IncrementalDisplayable:Axt,Line:Kc,LinearGradient:Rle,OrientedBoundingRect:FT,Path:hr,Point:xt,Polygon:Sle,Polyline:xE,RadialGradient:Oxt,Rect:Cn,Ring:mle,Sector:bh,Text:Jn,applyTransform:I3,clipPointsByRect:Wxt,clipRectByRect:Uxt,createIcon:M3,extendPath:Nxt,extendShape:Mxt,getShapeClass:Lxt,getTransform:Bxt,groupTransition:Ile,initProps:Aa,isElementRemoved:Vm,lineLineIntersect:Mle,linePolygonIntersect:zxt,makeImage:kle,makePath:P3,mergePath:Fxt,registerShape:Co,removeElement:$T,removeElementWithFadeOut:HT,resizePath:Ple,setTooltipConfig:D3,subPixelOptimize:Hxt,subPixelOptimizeLine:gw,subPixelOptimizeRect:$xt,transformDirection:Vxt,traverseElements:TE,updateProps:Si},Symbol.toStringTag,{value:"Module"}));var OE={};function Kxt(e,t){for(var r=0;r<Ma.length;r++){var n=Ma[r],i=t[n],a=e.ensureState(n);a.style=a.style||{},a.style.text=i}var o=e.currentStates.slice();e.clearStates(!0),e.setStyle({text:t.normal}),e.useStates(o,!0)}function PK(e,t,r){var n=e.labelFetcher,i=e.labelDataIndex,a=e.labelDimIndex,o=t.normal,s;n&&(s=n.getFormattedLabel(i,"normal",null,a,o&&o.get("formatter"),r!=null?{interpolatedValue:r}:null)),s==null&&(s=gt(e.defaultText)?e.defaultText(i,e,r):e.defaultText);for(var l={normal:s},u=0;u<Ma.length;u++){var f=Ma[u],c=t[f];l[f]=qt(n?n.getFormattedLabel(i,f,null,a,c&&c.get("formatter")):null,s)}return l}function RS(e,t,r,n){r=r||OE;for(var i=e instanceof Jn,a=!1,o=0;o<MT.length;o++){var s=t[MT[o]];if(s&&s.getShallow("show")){a=!0;break}}var l=i?e:e.getTextContent();if(a){i||(l||(l=new Jn,e.setTextContent(l)),e.stateProxy&&(l.stateProxy=e.stateProxy));var u=PK(r,t),f=t.normal,c=!!f.getShallow("show"),h=Hu(f,n&&n.normal,r,!1,!i);h.text=u.normal,i||e.setTextConfig(IK(f,r,!1));for(var o=0;o<Ma.length;o++){var d=Ma[o],s=t[d];if(s){var v=l.ensureState(d),p=!!qt(s.getShallow("show"),c);if(p!==c&&(v.ignore=!p),v.style=Hu(s,n&&n[d],r,!0,!i),v.style.text=u[d],!i){var g=e.ensureState(d);g.textConfig=IK(s,r,!0)}}}l.silent=!!f.getShallow("silent"),l.style.x!=null&&(h.x=l.style.x),l.style.y!=null&&(h.y=l.style.y),l.ignore=!c,l.useStyle(h),l.dirty(),r.enableTextSetter&&(EE(l).setLabelText=function(y){var m=PK(r,t,y);Kxt(l,m)})}else l&&(l.ignore=!0);e.dirty()}function kS(e,t){t=t||"label";for(var r={normal:e.getModel(t)},n=0;n<Ma.length;n++){var i=Ma[n];r[i]=e.getModel([i,t])}return r}function Hu(e,t,r,n,i){var a={};return Xxt(a,e,r,n,i),t&&Ne(a,t),a}function IK(e,t,r){t=t||{};var n={},i,a=e.getShallow("rotate"),o=qt(e.getShallow("distance"),r?null:5),s=e.getShallow("offset");return i=e.getShallow("position")||(r?null:"inside"),i==="outside"&&(i=t.defaultOutsidePosition||"top"),i!=null&&(n.position=i),s!=null&&(n.offset=s),a!=null&&(a*=Math.PI/180,n.rotation=a),o!=null&&(n.distance=o),n.outsideFill=e.get("color")==="inherit"?t.inheritColor||null:"auto",n}function Xxt(e,t,r,n,i){r=r||OE;var a=t.ecModel,o=a&&a.option.textStyle,s=qxt(t),l;if(s){l={};for(var u in s)if(s.hasOwnProperty(u)){var f=t.getModel(["rich",u]);LK(l[u]={},f,o,r,n,i,!1,!0)}}l&&(e.rich=l);var c=t.get("overflow");c&&(e.overflow=c);var h=t.get("minMargin");h!=null&&(e.margin=h),LK(e,t,o,r,n,i,!0,!1)}function qxt(e){for(var t;e&&e!==e.ecModel;){var r=(e.option||OE).rich;if(r){t=t||{};for(var n=Lr(r),i=0;i<n.length;i++){var a=n[i];t[a]=1}}e=e.parentModel}return t}var MK=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],DK=["align","lineHeight","width","height","tag","verticalAlign"],NK=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function LK(e,t,r,n,i,a,o,s){r=!i&&r||OE;var l=n&&n.inheritColor,u=t.getShallow("color"),f=t.getShallow("textBorderColor"),c=qt(t.getShallow("opacity"),r.opacity);(u==="inherit"||u==="auto")&&(l?u=l:u=null),(f==="inherit"||f==="auto")&&(l?f=l:f=null),a||(u=u||r.color,f=f||r.textBorderColor),u!=null&&(e.fill=u),f!=null&&(e.stroke=f);var h=qt(t.getShallow("textBorderWidth"),r.textBorderWidth);h!=null&&(e.lineWidth=h);var d=qt(t.getShallow("textBorderType"),r.textBorderType);d!=null&&(e.lineDash=d);var v=qt(t.getShallow("textBorderDashOffset"),r.textBorderDashOffset);v!=null&&(e.lineDashOffset=v),!i&&c==null&&!s&&(c=n&&n.defaultOpacity),c!=null&&(e.opacity=c),!i&&!a&&e.fill==null&&n.inheritColor&&(e.fill=n.inheritColor);for(var p=0;p<MK.length;p++){var g=MK[p],y=qt(t.getShallow(g),r[g]);y!=null&&(e[g]=y)}for(var p=0;p<DK.length;p++){var g=DK[p],y=t.getShallow(g);y!=null&&(e[g]=y)}if(e.verticalAlign==null){var m=t.getShallow("baseline");m!=null&&(e.verticalAlign=m)}if(!o||!n.disableBox){for(var p=0;p<NK.length;p++){var g=NK[p],y=t.getShallow(g);y!=null&&(e[g]=y)}var b=t.getShallow("borderType");b!=null&&(e.borderDash=b),(e.backgroundColor==="auto"||e.backgroundColor==="inherit")&&l&&(e.backgroundColor=l),(e.borderColor==="auto"||e.borderColor==="inherit")&&l&&(e.borderColor=l)}}function Zxt(e,t){var r=t&&t.getModel("textStyle");return Ko([e.fontStyle||r&&r.getShallow("fontStyle")||"",e.fontWeight||r&&r.getShallow("fontWeight")||"",(e.fontSize||r&&r.getShallow("fontSize")||12)+"px",e.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}var EE=Jr();function Jxt(e,t,r,n){if(e){var i=EE(e);i.prevValue=i.value,i.value=r;var a=t.normal;i.valueAnimation=a.get("valueAnimation"),i.valueAnimation&&(i.precision=a.get("precision"),i.defaultInterpolatedText=n,i.statesModels=t)}}var Qxt=["textStyle","color"],gP=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],yP=new Jn,eTt=function(){function e(){}return e.prototype.getTextColor=function(t){var r=this.ecModel;return this.getShallow("color")||(!t&&r?r.get(Qxt):null)},e.prototype.getFont=function(){return Zxt({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},e.prototype.getTextRect=function(t){for(var r={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<gP.length;n++)r[gP[n]]=this.getShallow(gP[n]);return yP.useStyle(r),yP.update(),yP.getBoundingRect()},e}();const tTt=eTt;var Dle=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],rTt=vw(Dle),nTt=function(){function e(){}return e.prototype.getLineStyle=function(t){return rTt(this,t)},e}(),Nle=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],iTt=vw(Nle),aTt=function(){function e(){}return e.prototype.getItemStyle=function(t,r){return iTt(this,t,r)},e}(),wh=function(){function e(t,r,n){this.parentModel=r,this.ecModel=n,this.option=t}return e.prototype.init=function(t,r,n){},e.prototype.mergeOption=function(t,r){lr(this.option,t,!0)},e.prototype.get=function(t,r){return t==null?this.option:this._doGet(this.parsePath(t),!r&&this.parentModel)},e.prototype.getShallow=function(t,r){var n=this.option,i=n==null?n:n[t];if(i==null&&!r){var a=this.parentModel;a&&(i=a.getShallow(t))}return i},e.prototype.getModel=function(t,r){var n=t!=null,i=n?this.parsePath(t):null,a=n?this._doGet(i):this.option;return r=r||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new e(a,r,this.ecModel)},e.prototype.isEmpty=function(){return this.option==null},e.prototype.restoreData=function(){},e.prototype.clone=function(){var t=this.constructor;return new t(Xt(this.option))},e.prototype.parsePath=function(t){return typeof t=="string"?t.split("."):t},e.prototype.resolveParentPath=function(t){return t},e.prototype.isAnimationEnabled=function(){if(!Ht.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},e.prototype._doGet=function(t,r){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&!(t[i]&&(n=n&&typeof n=="object"?n[t[i]]:null,n==null));i++);return n==null&&r&&(n=r._doGet(this.resolveParentPath(t),r.parentModel)),n},e}();S3(wh);N1t(wh);_o(wh,nTt);_o(wh,aTt);_o(wh,B1t);_o(wh,tTt);const Gn=wh;var oTt=Math.round(Math.random()*10);function RE(e){return[e||"",oTt++].join("_")}function sTt(e){var t={};e.registerSubTypeDefaulter=function(r,n){var i=qo(r);t[i.main]=n},e.determineSubType=function(r,n){var i=n.type;if(!i){var a=qo(r).main;e.hasSubTypes(r)&&t[a]&&(i=t[a](n))}return i}}function lTt(e,t){e.topologicalTravel=function(a,o,s,l){if(!a.length)return;var u=r(o),f=u.graph,c=u.noEntryList,h={};for(le(a,function(m){h[m]=!0});c.length;){var d=c.pop(),v=f[d],p=!!h[d];p&&(s.call(l,d,v.originalDeps.slice()),delete h[d]),le(v.successor,p?y:g)}le(h,function(){var m="";throw new Error(m)});function g(m){f[m].entryCount--,f[m].entryCount===0&&c.push(m)}function y(m){h[m]=!0,g(m)}};function r(a){var o={},s=[];return le(a,function(l){var u=n(o,l),f=u.originalDeps=t(l),c=i(f,a);u.entryCount=c.length,u.entryCount===0&&s.push(l),le(c,function(h){ar(u.predecessor,h)<0&&u.predecessor.push(h);var d=n(o,h);ar(d.successor,h)<0&&d.successor.push(l)})}),{graph:o,noEntryList:s}}function n(a,o){return a[o]||(a[o]={predecessor:[],successor:[]}),a[o]}function i(a,o){var s=[];return le(a,function(l){ar(o,l)>=0&&s.push(l)}),s}}function Lle(e,t){return lr(lr({},e,!0),t,!0)}const uTt={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},fTt={time:{month:["ä¸æ","äºæ","ä¸æ","åæ","äºæ","å­æ","ä¸æ","å«æ","ä¹æ","åæ","åä¸æ","åäºæ"],monthAbbr:["1æ","2æ","3æ","4æ","5æ","6æ","7æ","8æ","9æ","10æ","11æ","12æ"],dayOfWeek:["æææ¥","ææä¸","ææäº","ææä¸","ææå","ææäº","ææå­"],dayOfWeekAbbr:["æ¥","ä¸","äº","ä¸","å","äº","å­"]},legend:{selector:{all:"å¨é",inverse:"åé"}},toolbox:{brush:{title:{rect:"ç©å½¢éæ©",polygon:"åé",lineX:"æ¨ªåéæ©",lineY:"çºµåéæ©",keep:"ä¿æéæ©",clear:"æ¸é¤éæ©"}},dataView:{title:"æ°æ®è§å¾",lang:["æ°æ®è§å¾","å³é­","å·æ°"]},dataZoom:{title:{zoom:"åºåç¼©æ¾",back:"åºåç¼©æ¾è¿å"}},magicType:{title:{line:"åæ¢ä¸ºæçº¿å¾",bar:"åæ¢ä¸ºæ±ç¶å¾",stack:"åæ¢ä¸ºå å ",tiled:"åæ¢ä¸ºå¹³éº"}},restore:{title:"è¿å"},saveAsImage:{title:"ä¿å­ä¸ºå¾ç",lang:["å³é®å¦å­ä¸ºå¾ç"]}},series:{typeNames:{pie:"é¥¼å¾",bar:"æ±ç¶å¾",line:"æçº¿å¾",scatter:"æ£ç¹å¾",effectScatter:"æ¶æ¼ªæ£ç¹å¾",radar:"é·è¾¾å¾",tree:"æ å¾",treemap:"ç©å½¢æ å¾",boxplot:"ç®±åå¾",candlestick:"Kçº¿å¾",k:"Kçº¿å¾",heatmap:"ç­åå¾",map:"å°å¾",parallel:"å¹³è¡åæ å¾",lines:"çº¿å¾",graph:"å³ç³»å¾",sankey:"æ¡åºå¾",funnel:"æ¼æå¾",gauge:"ä»ªè¡¨çå¾",pictorialBar:"è±¡å½¢æ±å¾",themeRiver:"ä¸»é¢æ²³æµå¾",sunburst:"æ­æ¥å¾"}},aria:{general:{withTitle:"è¿æ¯ä¸ä¸ªå³äºâ{title}âçå¾è¡¨ã",withoutTitle:"è¿æ¯ä¸ä¸ªå¾è¡¨ï¼"},series:{single:{prefix:"",withName:"å¾è¡¨ç±»åæ¯{seriesType}ï¼è¡¨ç¤º{seriesName}ã",withoutName:"å¾è¡¨ç±»åæ¯{seriesType}ã"},multiple:{prefix:"å®ç±{seriesCount}ä¸ªå¾è¡¨ç³»åç»æã",withName:"ç¬¬{seriesId}ä¸ªç³»åæ¯ä¸ä¸ªè¡¨ç¤º{seriesName}ç{seriesType}ï¼",withoutName:"ç¬¬{seriesId}ä¸ªç³»åæ¯ä¸ä¸ª{seriesType}ï¼",separator:{middle:"ï¼",end:"ã"}}},data:{allData:"å¶æ°æ®æ¯ââ",partialData:"å¶ä¸­ï¼å{displayCnt}é¡¹æ¯ââ",withName:"{name}çæ°æ®æ¯{value}",withoutName:"{value}",separator:{middle:"ï¼",end:""}}}};var jT="ZH",N3="EN",yw=N3,$C={},L3={},Fle=Ht.domSupported?function(){var e=(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase();return e.indexOf(jT)>-1?jT:yw}():yw;function $le(e,t){e=e.toUpperCase(),L3[e]=new Gn(t),$C[e]=t}function cTt(e){if(st(e)){var t=$C[e.toUpperCase()]||{};return e===jT||e===N3?Xt(t):lr(Xt(t),Xt($C[yw]),!1)}else return lr(Xt(e),Xt($C[yw]),!1)}function hTt(e){return L3[e]}function dTt(){return L3[yw]}$le(N3,uTt);$le(jT,fTt);var F3=1e3,$3=F3*60,jm=$3*60,Ea=jm*24,FK=Ea*365,rm={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},h1="{yyyy}-{MM}-{dd}",$K={year:"{yyyy}",month:"{yyyy}-{MM}",day:h1,hour:h1+" "+rm.hour,minute:h1+" "+rm.minute,second:h1+" "+rm.second,millisecond:rm.none},mP=["year","month","day","hour","minute","second","millisecond"],Hle=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function Rf(e,t){return e+="","0000".substr(0,t-e.length)+e}function Qd(e){switch(e){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return e}}function vTt(e){return e===Qd(e)}function pTt(e){switch(e){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function kE(e,t,r,n){var i=yl(e),a=i[H3(r)](),o=i[ev(r)]()+1,s=Math.floor((o-1)/3)+1,l=i[AE(r)](),u=i["get"+(r?"UTC":"")+"Day"](),f=i[mw(r)](),c=(f-1)%12+1,h=i[PE(r)](),d=i[IE(r)](),v=i[ME(r)](),p=n instanceof Gn?n:hTt(n||Fle)||dTt(),g=p.getModel("time"),y=g.get("month"),m=g.get("monthAbbr"),b=g.get("dayOfWeek"),S=g.get("dayOfWeekAbbr");return(t||"").replace(/{yyyy}/g,a+"").replace(/{yy}/g,a%100+"").replace(/{Q}/g,s+"").replace(/{MMMM}/g,y[o-1]).replace(/{MMM}/g,m[o-1]).replace(/{MM}/g,Rf(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,Rf(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,b[u]).replace(/{ee}/g,S[u]).replace(/{e}/g,u+"").replace(/{HH}/g,Rf(f,2)).replace(/{H}/g,f+"").replace(/{hh}/g,Rf(c+"",2)).replace(/{h}/g,c+"").replace(/{mm}/g,Rf(h,2)).replace(/{m}/g,h+"").replace(/{ss}/g,Rf(d,2)).replace(/{s}/g,d+"").replace(/{SSS}/g,Rf(v,3)).replace(/{S}/g,v+"")}function gTt(e,t,r,n,i){var a=null;if(st(r))a=r;else if(gt(r))a=r(e.value,t,{level:e.level});else{var o=Ne({},rm);if(e.level>0)for(var s=0;s<mP.length;++s)o[mP[s]]="{primary|"+o[mP[s]]+"}";var l=r?r.inherit===!1?r:fr(r,o):o,u=Ble(e.value,i);if(l[u])a=l[u];else if(l.inherit){for(var f=Hle.indexOf(u),s=f-1;s>=0;--s)if(l[u]){a=l[u];break}a=a||o.none}if(Ze(a)){var c=e.level==null?0:e.level>=0?e.level:a.length+e.level;c=Math.min(c,a.length-1),a=a[c]}}return kE(new Date(e.value),a,i,n)}function Ble(e,t){var r=yl(e),n=r[ev(t)]()+1,i=r[AE(t)](),a=r[mw(t)](),o=r[PE(t)](),s=r[IE(t)](),l=r[ME(t)](),u=l===0,f=u&&s===0,c=f&&o===0,h=c&&a===0,d=h&&i===1,v=d&&n===1;return v?"year":d?"month":h?"day":c?"hour":f?"minute":u?"second":"millisecond"}function HK(e,t,r){var n=Sr(e)?yl(e):e;switch(t=t||Ble(e,r),t){case"year":return n[H3(r)]();case"half-year":return n[ev(r)]()>=6?1:0;case"quarter":return Math.floor((n[ev(r)]()+1)/4);case"month":return n[ev(r)]();case"day":return n[AE(r)]();case"half-day":return n[mw(r)]()/24;case"hour":return n[mw(r)]();case"minute":return n[PE(r)]();case"second":return n[IE(r)]();case"millisecond":return n[ME(r)]()}}function H3(e){return e?"getUTCFullYear":"getFullYear"}function ev(e){return e?"getUTCMonth":"getMonth"}function AE(e){return e?"getUTCDate":"getDate"}function mw(e){return e?"getUTCHours":"getHours"}function PE(e){return e?"getUTCMinutes":"getMinutes"}function IE(e){return e?"getUTCSeconds":"getSeconds"}function ME(e){return e?"getUTCMilliseconds":"getMilliseconds"}function yTt(e){return e?"setUTCFullYear":"setFullYear"}function Vle(e){return e?"setUTCMonth":"setMonth"}function jle(e){return e?"setUTCDate":"setDate"}function Wle(e){return e?"setUTCHours":"setHours"}function Ule(e){return e?"setUTCMinutes":"setMinutes"}function zle(e){return e?"setUTCSeconds":"setSeconds"}function Gle(e){return e?"setUTCMilliseconds":"setMilliseconds"}function Yle(e){if(!v1t(e))return st(e)?e:"-";var t=(e+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function Kle(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(r,n){return n.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var DE=ase;function KN(e,t,r){var n="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(f){return f&&Ko(f)?f:"-"}function a(f){return!!(f!=null&&!isNaN(f)&&isFinite(f))}var o=t==="time",s=e instanceof Date;if(o||s){var l=o?yl(e):e;if(isNaN(+l)){if(s)return"-"}else return kE(l,n,r)}if(t==="ordinal")return yN(e)?i(e):Sr(e)&&a(e)?e+"":"-";var u=PT(e);return a(u)?Yle(u):yN(e)?i(e):typeof e=="boolean"?e+"":"-"}var BK=["a","b","c","d","e","f","g"],bP=function(e,t){return"{"+e+(t??"")+"}"};function Xle(e,t,r){Ze(t)||(t=[t]);var n=t.length;if(!n)return"";for(var i=t[0].$vars||[],a=0;a<i.length;a++){var o=BK[a];e=e.replace(bP(o),bP(o,0))}for(var s=0;s<n;s++)for(var l=0;l<i.length;l++){var u=t[s][i[l]];e=e.replace(bP(BK[l],s),r?_a(u):u)}return e}function mTt(e,t){var r=st(e)?{color:e,extraCssText:t}:e||{},n=r.color,i=r.type;t=r.extraCssText;var a=r.renderMode||"html";if(!n)return"";if(a==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+_a(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+_a(n)+";"+(t||"")+'"></span>';var o=r.markerId||"markerX";return{renderMode:a,content:"{"+o+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}}function Xc(e,t){return t=t||"transparent",st(e)?e:vt(e)&&e.colorStops&&(e.colorStops[0]||{}).color||t}function VK(e,t){if(t==="_blank"||t==="blank"){var r=window.open();r.opener=null,r.location.href=e}else window.open(e,t)}var HC=le,bTt=["left","right","top","bottom","width","height"],d1=[["width","left","right"],["height","top","bottom"]];function B3(e,t,r,n,i){var a=0,o=0;n==null&&(n=1/0),i==null&&(i=1/0);var s=0;t.eachChild(function(l,u){var f=l.getBoundingRect(),c=t.childAt(u+1),h=c&&c.getBoundingRect(),d,v;if(e==="horizontal"){var p=f.width+(h?-h.x+f.x:0);d=a+p,d>n||l.newline?(a=0,d=p,o+=s+r,s=f.height):s=Math.max(s,f.height)}else{var g=f.height+(h?-h.y+f.y:0);v=o+g,v>i||l.newline?(a+=s+r,o=0,v=g,s=f.width):s=Math.max(s,f.width)}l.newline||(l.x=a,l.y=o,l.markRedraw(),e==="horizontal"?a=d+r:o=v+r)})}var Wm=B3;wr(B3,"vertical");wr(B3,"horizontal");function vg(e,t,r){r=DE(r||0);var n=t.width,i=t.height,a=xr(e.left,n),o=xr(e.top,i),s=xr(e.right,n),l=xr(e.bottom,i),u=xr(e.width,n),f=xr(e.height,i),c=r[2]+r[0],h=r[1]+r[3],d=e.aspect;switch(isNaN(u)&&(u=n-s-h-a),isNaN(f)&&(f=i-l-c-o),d!=null&&(isNaN(u)&&isNaN(f)&&(d>n/i?u=n*.8:f=i*.8),isNaN(u)&&(u=d*f),isNaN(f)&&(f=u/d)),isNaN(a)&&(a=n-s-u-h),isNaN(o)&&(o=i-l-f-c),e.left||e.right){case"center":a=n/2-u/2-r[3];break;case"right":a=n-u-h;break}switch(e.top||e.bottom){case"middle":case"center":o=i/2-f/2-r[0];break;case"bottom":o=i-f-c;break}a=a||0,o=o||0,isNaN(u)&&(u=n-h-a-(s||0)),isNaN(f)&&(f=i-c-o-(l||0));var v=new ur(a+r[3],o+r[0],u,f);return v.margin=r,v}function bw(e){var t=e.layoutMode||e.constructor.layoutMode;return vt(t)?t:t?{type:t}:null}function pg(e,t,r){var n=r&&r.ignoreSize;!Ze(n)&&(n=[n,n]);var i=o(d1[0],0),a=o(d1[1],1);u(d1[0],e,i),u(d1[1],e,a);function o(f,c){var h={},d=0,v={},p=0,g=2;if(HC(f,function(b){v[b]=e[b]}),HC(f,function(b){s(t,b)&&(h[b]=v[b]=t[b]),l(h,b)&&d++,l(v,b)&&p++}),n[c])return l(t,f[1])?v[f[2]]=null:l(t,f[2])&&(v[f[1]]=null),v;if(p===g||!d)return v;if(d>=g)return h;for(var y=0;y<f.length;y++){var m=f[y];if(!s(h,m)&&s(e,m)){h[m]=e[m];break}}return h}function s(f,c){return f.hasOwnProperty(c)}function l(f,c){return f[c]!=null&&f[c]!=="auto"}function u(f,c,h){HC(f,function(d){c[d]=h[d]})}}function NE(e){return wTt({},e)}function wTt(e,t){return t&&e&&HC(bTt,function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e}var STt=Jr(),$g=function(e){je(t,e);function t(r,n,i){var a=e.call(this,r,n,i)||this;return a.uid=RE("ec_cpt_model"),a}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=bw(this),a=i?NE(r):{},o=n.getTheme();lr(r,o.get(this.mainType)),lr(r,this.getDefaultOption()),i&&pg(r,a,i)},t.prototype.mergeOption=function(r,n){lr(this.option,r,!0);var i=bw(this);i&&pg(this.option,r,i)},t.prototype.optionUpdated=function(r,n){},t.prototype.getDefaultOption=function(){var r=this.constructor;if(!I1t(r))return r.defaultOption;var n=STt(this);if(!n.defaultOption){for(var i=[],a=r;a;){var o=a.prototype.defaultOption;o&&i.push(o),a=a.superClass}for(var s={},l=i.length-1;l>=0;l--)s=lr(s,i[l],!0);n.defaultOption=s}return n.defaultOption},t.prototype.getReferringComponents=function(r,n){var i=r+"Index",a=r+"Id";return OS(this.ecModel,r,{index:this.get(i,!0),id:this.get(a,!0)},n)},t.prototype.getBoxLayoutParams=function(){var r=this;return{left:r.get("left"),top:r.get("top"),right:r.get("right"),bottom:r.get("bottom"),width:r.get("width"),height:r.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(r){this.option.zlevel=r},t.protoInitialize=function(){var r=t.prototype;r.type="component",r.id="",r.name="",r.mainType="",r.subType="",r.componentIndex=0}(),t}(Gn);Bse($g,Gn);mE($g);sTt($g);lTt($g,_Tt);function _Tt(e){var t=[];return le($g.getClassesByMainType(e),function(r){t=t.concat(r.dependencies||r.prototype.dependencies||[])}),t=ct(t,function(r){return qo(r).main}),e!=="dataset"&&ar(t,"dataset")<=0&&t.unshift("dataset"),t}const Er=$g;var qle="";typeof navigator<"u"&&(qle=navigator.platform||"");var ld="rgba(0, 0, 0, 0.2)";const CTt={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:ld,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:ld,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:ld,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:ld,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:ld,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:ld,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:qle.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var Zle=Bt(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),Va="original",$i="arrayRows",xo="objectRows",hs="keyedColumns",Eu="typedArray",Jle="unknown",ul="column",Hg="row",An={Must:1,Might:2,Not:3},Qle=Jr();function xTt(e){Qle(e).datasetMap=Bt()}function TTt(e,t,r){var n={},i=V3(t);if(!i||!e)return n;var a=[],o=[],s=t.ecModel,l=Qle(s).datasetMap,u=i.uid+"_"+r.seriesLayoutBy,f,c;e=e.slice(),le(e,function(p,g){var y=vt(p)?p:e[g]={name:p};y.type==="ordinal"&&f==null&&(f=g,c=v(y)),n[y.name]=[]});var h=l.get(u)||l.set(u,{categoryWayDim:c,valueWayDim:0});le(e,function(p,g){var y=p.name,m=v(p);if(f==null){var b=h.valueWayDim;d(n[y],b,m),d(o,b,m),h.valueWayDim+=m}else if(f===g)d(n[y],0,m),d(a,0,m);else{var b=h.categoryWayDim;d(n[y],b,m),d(o,b,m),h.categoryWayDim+=m}});function d(p,g,y){for(var m=0;m<y;m++)p.push(g+m)}function v(p){var g=p.dimsDef;return g?g.length:1}return a.length&&(n.itemName=a),o.length&&(n.seriesName=o),n}function OTt(e,t,r){var n={},i=V3(e);if(!i)return n;var a=t.sourceFormat,o=t.dimensionsDefine,s;(a===xo||a===hs)&&le(o,function(f,c){(vt(f)?f.name:f)==="name"&&(s=c)});var l=function(){for(var f={},c={},h=[],d=0,v=Math.min(5,r);d<v;d++){var p=tue(t.data,a,t.seriesLayoutBy,o,t.startIndex,d);h.push(p);var g=p===An.Not;if(g&&f.v==null&&d!==s&&(f.v=d),(f.n==null||f.n===f.v||!g&&h[f.n]===An.Not)&&(f.n=d),y(f)&&h[f.n]!==An.Not)return f;g||(p===An.Might&&c.v==null&&d!==s&&(c.v=d),(c.n==null||c.n===c.v)&&(c.n=d))}function y(m){return m.v!=null&&m.n!=null}return y(f)?f:y(c)?c:null}();if(l){n.value=[l.v];var u=s??l.n;n.itemName=[u],n.seriesName=[u]}return n}function V3(e){var t=e.get("data",!0);if(!t)return OS(e.ecModel,"dataset",{index:e.get("datasetIndex",!0),id:e.get("datasetId",!0)},fo).models[0]}function ETt(e){return!e.get("transform",!0)&&!e.get("fromTransformResult",!0)?[]:OS(e.ecModel,"dataset",{index:e.get("fromDatasetIndex",!0),id:e.get("fromDatasetId",!0)},fo).models}function eue(e,t){return tue(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function tue(e,t,r,n,i,a){var o,s=5;if(aa(e))return An.Not;var l,u;if(n){var f=n[a];vt(f)?(l=f.name,u=f.type):st(f)&&(l=f)}if(u!=null)return u==="ordinal"?An.Must:An.Not;if(t===$i){var c=e;if(r===Hg){for(var h=c[a],d=0;d<(h||[]).length&&d<s;d++)if((o=S(h[i+d]))!=null)return o}else for(var d=0;d<c.length&&d<s;d++){var v=c[i+d];if(v&&(o=S(v[a]))!=null)return o}}else if(t===xo){var p=e;if(!l)return An.Not;for(var d=0;d<p.length&&d<s;d++){var g=p[d];if(g&&(o=S(g[l]))!=null)return o}}else if(t===hs){var y=e;if(!l)return An.Not;var h=y[l];if(!h||aa(h))return An.Not;for(var d=0;d<h.length&&d<s;d++)if((o=S(h[d]))!=null)return o}else if(t===Va)for(var m=e,d=0;d<m.length&&d<s;d++){var g=m[d],b=TS(g);if(!Ze(b))return An.Not;if((o=S(b[a]))!=null)return o}function S(x){var T=st(x);if(x!=null&&isFinite(x)&&x!=="")return T?An.Might:An.Not;if(T&&x!=="-")return An.Must}return An.Not}var RTt=Bt();function kTt(e,t,r){var n=RTt.get(t);if(!n)return r;var i=n(e);return i?r.concat(i):r}var jK=Jr();Jr();var j3=function(){function e(){}return e.prototype.getColorFromPalette=function(t,r,n){var i=mi(this.get("color",!0)),a=this.get("colorLayer",!0);return PTt(this,jK,i,a,t,r,n)},e.prototype.clearColorPalette=function(){ITt(this,jK)},e}();function ATt(e,t){for(var r=e.length,n=0;n<r;n++)if(e[n].length>t)return e[n];return e[r-1]}function PTt(e,t,r,n,i,a,o){a=a||e;var s=t(a),l=s.paletteIdx||0,u=s.paletteNameMap=s.paletteNameMap||{};if(u.hasOwnProperty(i))return u[i];var f=o==null||!n?r:ATt(n,o);if(f=f||r,!(!f||!f.length)){var c=f[l];return i&&(u[i]=c),s.paletteIdx=(l+1)%f.length,c}}function ITt(e,t){t(e).paletteIdx=0,t(e).paletteNameMap={}}var v1,Oy,WK,UK="\0_ec_inner",MTt=1,rue=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r,n,i,a,o,s){a=a||{},this.option=null,this._theme=new Gn(a),this._locale=new Gn(o),this._optionManager=s},t.prototype.setOption=function(r,n,i){var a=YK(n);this._optionManager.setOption(r,i,a),this._resetOption(null,a)},t.prototype.resetOption=function(r,n){return this._resetOption(r,YK(n))},t.prototype._resetOption=function(r,n){var i=!1,a=this._optionManager;if(!r||r==="recreate"){var o=a.mountOption(r==="recreate");!this.option||r==="recreate"?WK(this,o):(this.restoreData(),this._mergeOption(o,n)),i=!0}if((r==="timeline"||r==="media")&&this.restoreData(),!r||r==="recreate"||r==="timeline"){var s=a.getTimelineOption(this);s&&(i=!0,this._mergeOption(s,n))}if(!r||r==="recreate"||r==="media"){var l=a.getMediaOption(this);l.length&&le(l,function(u){i=!0,this._mergeOption(u,n)},this)}return i},t.prototype.mergeOption=function(r){this._mergeOption(r,null)},t.prototype._mergeOption=function(r,n){var i=this.option,a=this._componentsMap,o=this._componentsCount,s=[],l=Bt(),u=n&&n.replaceMergeMainTypeMap;xTt(this),le(r,function(c,h){c!=null&&(Er.hasClass(h)?h&&(s.push(h),l.set(h,!0)):i[h]=i[h]==null?Xt(c):lr(i[h],c,!0))}),u&&u.each(function(c,h){Er.hasClass(h)&&!l.get(h)&&(s.push(h),l.set(h,!0))}),Er.topologicalTravel(s,Er.getAllClassMainTypes(),f,this);function f(c){var h=kTt(this,c,mi(r[c])),d=a.get(c),v=d?u&&u.get(c)?"replaceMerge":"normalMerge":"replaceAll",p=y1t(d,h,v);x1t(p,c,Er),i[c]=null,a.set(c,null),o.set(c,0);var g=[],y=[],m=0,b;le(p,function(S,x){var T=S.existing,E=S.newOption;if(!E)T&&(T.mergeOption({},this),T.optionUpdated({},!1));else{var P=c==="series",R=Er.getClass(c,S.keyInfo.subType,!P);if(!R)return;if(c==="tooltip"){if(b)return;b=!0}if(T&&T.constructor===R)T.name=S.keyInfo.name,T.mergeOption(E,this),T.optionUpdated(E,!1);else{var M=Ne({componentIndex:x},S.keyInfo);T=new R(E,this,this,M),Ne(T,M),S.brandNew&&(T.__requireNewView=!0),T.init(E,this,this),T.optionUpdated(null,!0)}}T?(g.push(T.option),y.push(T),m++):(g.push(void 0),y.push(void 0))},this),i[c]=g,a.set(c,y),o.set(c,m),c==="series"&&v1(this)}this._seriesIndices||v1(this)},t.prototype.getOption=function(){var r=Xt(this.option);return le(r,function(n,i){if(Er.hasClass(i)){for(var a=mi(n),o=a.length,s=!1,l=o-1;l>=0;l--)a[l]&&!dw(a[l])?s=!0:(a[l]=null,!s&&o--);a.length=o,r[i]=a}}),delete r[UK],r},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(r){this._payload=r},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(r,n){var i=this._componentsMap.get(r);if(i){var a=i[n||0];if(a)return a;if(n==null){for(var o=0;o<i.length;o++)if(i[o])return i[o]}}},t.prototype.queryComponents=function(r){var n=r.mainType;if(!n)return[];var i=r.index,a=r.id,o=r.name,s=this._componentsMap.get(n);if(!s||!s.length)return[];var l;return i!=null?(l=[],le(mi(i),function(u){s[u]&&l.push(s[u])})):a!=null?l=zK("id",a,s):o!=null?l=zK("name",o,s):l=Wn(s,function(u){return!!u}),GK(l,r)},t.prototype.findComponents=function(r){var n=r.query,i=r.mainType,a=s(n),o=a?this.queryComponents(a):Wn(this._componentsMap.get(i),function(u){return!!u});return l(GK(o,r));function s(u){var f=i+"Index",c=i+"Id",h=i+"Name";return u&&(u[f]!=null||u[c]!=null||u[h]!=null)?{mainType:i,index:u[f],id:u[c],name:u[h]}:null}function l(u){return r.filter?Wn(u,r.filter):u}},t.prototype.eachComponent=function(r,n,i){var a=this._componentsMap;if(gt(r)){var o=n,s=r;a.each(function(c,h){for(var d=0;c&&d<c.length;d++){var v=c[d];v&&s.call(o,h,v,v.componentIndex)}})}else for(var l=st(r)?a.get(r):vt(r)?this.findComponents(r):null,u=0;l&&u<l.length;u++){var f=l[u];f&&n.call(i,f,f.componentIndex)}},t.prototype.getSeriesByName=function(r){var n=Jo(r,null);return Wn(this._componentsMap.get("series"),function(i){return!!i&&n!=null&&i.name===n})},t.prototype.getSeriesByIndex=function(r){return this._componentsMap.get("series")[r]},t.prototype.getSeriesByType=function(r){return Wn(this._componentsMap.get("series"),function(n){return!!n&&n.subType===r})},t.prototype.getSeries=function(){return Wn(this._componentsMap.get("series"),function(r){return!!r})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(r,n){Oy(this),le(this._seriesIndices,function(i){var a=this._componentsMap.get("series")[i];r.call(n,a,i)},this)},t.prototype.eachRawSeries=function(r,n){le(this._componentsMap.get("series"),function(i){i&&r.call(n,i,i.componentIndex)})},t.prototype.eachSeriesByType=function(r,n,i){Oy(this),le(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];o.subType===r&&n.call(i,o,a)},this)},t.prototype.eachRawSeriesByType=function(r,n,i){return le(this.getSeriesByType(r),n,i)},t.prototype.isSeriesFiltered=function(r){return Oy(this),this._seriesIndicesMap.get(r.componentIndex)==null},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(r,n){Oy(this);var i=[];le(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];r.call(n,o,a)&&i.push(a)},this),this._seriesIndices=i,this._seriesIndicesMap=Bt(i)},t.prototype.restoreData=function(r){v1(this);var n=this._componentsMap,i=[];n.each(function(a,o){Er.hasClass(o)&&i.push(o)}),Er.topologicalTravel(i,Er.getAllClassMainTypes(),function(a){le(n.get(a),function(o){o&&(a!=="series"||!DTt(o,r))&&o.restoreData()})})},t.internalField=function(){v1=function(r){var n=r._seriesIndices=[];le(r._componentsMap.get("series"),function(i){i&&n.push(i.componentIndex)}),r._seriesIndicesMap=Bt(n)},Oy=function(r){},WK=function(r,n){r.option={},r.option[UK]=MTt,r._componentsMap=Bt({series:[]}),r._componentsCount=Bt();var i=n.aria;vt(i)&&i.enabled==null&&(i.enabled=!0),NTt(n,r._theme.option),lr(n,CTt,!1),r._mergeOption(n,null)}}(),t}(Gn);function DTt(e,t){if(t){var r=t.seriesIndex,n=t.seriesId,i=t.seriesName;return r!=null&&e.componentIndex!==r||n!=null&&e.id!==n||i!=null&&e.name!==i}}function NTt(e,t){var r=e.color&&!e.colorLayer;le(t,function(n,i){i==="colorLayer"&&r||Er.hasClass(i)||(typeof n=="object"?e[i]=e[i]?lr(e[i],n,!1):Xt(n):e[i]==null&&(e[i]=n))})}function zK(e,t,r){if(Ze(t)){var n=Bt();return le(t,function(a){if(a!=null){var o=Jo(a,null);o!=null&&n.set(a,!0)}}),Wn(r,function(a){return a&&n.get(a[e])})}else{var i=Jo(t,null);return Wn(r,function(a){return a&&i!=null&&a[e]===i})}}function GK(e,t){return t.hasOwnProperty("subType")?Wn(e,function(r){return r&&r.subType===t.subType}):e}function YK(e){var t=Bt();return e&&le(mi(e.replaceMerge),function(r){t.set(r,!0)}),{replaceMergeMainTypeMap:t}}_o(rue,j3);const nue=rue;var LTt=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],FTt=function(){function e(t){le(LTt,function(r){this[r]=kr(t[r],t)},this)}return e}();const iue=FTt;var wP={},$Tt=function(){function e(){this._coordinateSystems=[]}return e.prototype.create=function(t,r){var n=[];le(wP,function(i,a){var o=i.create(t,r);n=n.concat(o||[])}),this._coordinateSystems=n},e.prototype.update=function(t,r){le(this._coordinateSystems,function(n){n.update&&n.update(t,r)})},e.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},e.register=function(t,r){wP[t]=r},e.get=function(t){return wP[t]},e}();const W3=$Tt;var HTt=/^(min|max)?(.+)$/,BTt=function(){function e(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return e.prototype.setOption=function(t,r,n){t&&(le(mi(t.series),function(o){o&&o.data&&aa(o.data)&&mN(o.data)}),le(mi(t.dataset),function(o){o&&o.source&&aa(o.source)&&mN(o.source)})),t=Xt(t);var i=this._optionBackup,a=VTt(t,r,!i);this._newBaseOption=a.baseOption,i?(a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},e.prototype.mountOption=function(t){var r=this._optionBackup;return this._timelineOptions=r.timelineOptions,this._mediaList=r.mediaList,this._mediaDefault=r.mediaDefault,this._currentMediaIndices=[],Xt(t?r.baseOption:this._newBaseOption)},e.prototype.getTimelineOption=function(t){var r,n=this._timelineOptions;if(n.length){var i=t.getComponent("timeline");i&&(r=Xt(n[i.getCurrentIndex()]))}return r},e.prototype.getMediaOption=function(t){var r=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,a=this._mediaDefault,o=[],s=[];if(!i.length&&!a)return s;for(var l=0,u=i.length;l<u;l++)jTt(i[l].query,r,n)&&o.push(l);return!o.length&&a&&(o=[-1]),o.length&&!UTt(o,this._currentMediaIndices)&&(s=ct(o,function(f){return Xt(f===-1?a.option:i[f].option)})),this._currentMediaIndices=o,s},e}();function VTt(e,t,r){var n=[],i,a,o=e.baseOption,s=e.timeline,l=e.options,u=e.media,f=!!e.media,c=!!(l||s||o&&o.timeline);o?(a=o,a.timeline||(a.timeline=s)):((c||f)&&(e.options=e.media=null),a=e),f&&Ze(u)&&le(u,function(d){d&&d.option&&(d.query?n.push(d):i||(i=d))}),h(a),le(l,function(d){return h(d)}),le(n,function(d){return h(d.option)});function h(d){le(t,function(v){v(d,r)})}return{baseOption:a,timelineOptions:l||[],mediaDefault:i,mediaList:n}}function jTt(e,t,r){var n={width:t,height:r,aspectratio:t/r},i=!0;return le(e,function(a,o){var s=o.match(HTt);if(!(!s||!s[1]||!s[2])){var l=s[1],u=s[2].toLowerCase();WTt(n[u],a,l)||(i=!1)}}),i}function WTt(e,t,r){return r==="min"?e>=t:r==="max"?e<=t:e===t}function UTt(e,t){return e.join(",")===t.join(",")}const zTt=BTt;var Ya=le,ww=vt,KK=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function SP(e){var t=e&&e.itemStyle;if(t)for(var r=0,n=KK.length;r<n;r++){var i=KK[r],a=t.normal,o=t.emphasis;a&&a[i]&&(e[i]=e[i]||{},e[i].normal?lr(e[i].normal,a[i]):e[i].normal=a[i],a[i]=null),o&&o[i]&&(e[i]=e[i]||{},e[i].emphasis?lr(e[i].emphasis,o[i]):e[i].emphasis=o[i],o[i]=null)}}function Bn(e,t,r){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,i=e[t].emphasis;n&&(r?(e[t].normal=e[t].emphasis=null,fr(e[t],n)):e[t]=n),i&&(e.emphasis=e.emphasis||{},e.emphasis[t]=i,i.focus&&(e.emphasis.focus=i.focus),i.blurScope&&(e.emphasis.blurScope=i.blurScope))}}function nm(e){Bn(e,"itemStyle"),Bn(e,"lineStyle"),Bn(e,"areaStyle"),Bn(e,"label"),Bn(e,"labelLine"),Bn(e,"upperLabel"),Bn(e,"edgeLabel")}function rn(e,t){var r=ww(e)&&e[t],n=ww(r)&&r.textStyle;if(n)for(var i=0,a=KY.length;i<a;i++){var o=KY[i];n.hasOwnProperty(o)&&(r[o]=n[o])}}function ma(e){e&&(nm(e),rn(e,"label"),e.emphasis&&rn(e.emphasis,"label"))}function GTt(e){if(ww(e)){SP(e),nm(e),rn(e,"label"),rn(e,"upperLabel"),rn(e,"edgeLabel"),e.emphasis&&(rn(e.emphasis,"label"),rn(e.emphasis,"upperLabel"),rn(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(SP(t),ma(t));var r=e.markLine;r&&(SP(r),ma(r));var n=e.markArea;n&&ma(n);var i=e.data;if(e.type==="graph"){i=i||e.nodes;var a=e.links||e.edges;if(a&&!aa(a))for(var o=0;o<a.length;o++)ma(a[o]);le(e.categories,function(u){nm(u)})}if(i&&!aa(i))for(var o=0;o<i.length;o++)ma(i[o]);if(t=e.markPoint,t&&t.data)for(var s=t.data,o=0;o<s.length;o++)ma(s[o]);if(r=e.markLine,r&&r.data)for(var l=r.data,o=0;o<l.length;o++)Ze(l[o])?(ma(l[o][0]),ma(l[o][1])):ma(l[o]);e.type==="gauge"?(rn(e,"axisLabel"),rn(e,"title"),rn(e,"detail")):e.type==="treemap"?(Bn(e.breadcrumb,"itemStyle"),le(e.levels,function(u){nm(u)})):e.type==="tree"&&nm(e.leaves)}}function Ss(e){return Ze(e)?e:e?[e]:[]}function XK(e){return(Ze(e)?e[0]:e)||{}}function YTt(e,t){Ya(Ss(e.series),function(n){ww(n)&&GTt(n)});var r=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&r.push("valueAxis","categoryAxis","logAxis","timeAxis"),Ya(r,function(n){Ya(Ss(e[n]),function(i){i&&(rn(i,"axisLabel"),rn(i.axisPointer,"label"))})}),Ya(Ss(e.parallel),function(n){var i=n&&n.parallelAxisDefault;rn(i,"axisLabel"),rn(i&&i.axisPointer,"label")}),Ya(Ss(e.calendar),function(n){Bn(n,"itemStyle"),rn(n,"dayLabel"),rn(n,"monthLabel"),rn(n,"yearLabel")}),Ya(Ss(e.radar),function(n){rn(n,"name"),n.name&&n.axisName==null&&(n.axisName=n.name,delete n.name),n.nameGap!=null&&n.axisNameGap==null&&(n.axisNameGap=n.nameGap,delete n.nameGap)}),Ya(Ss(e.geo),function(n){ww(n)&&(ma(n),Ya(Ss(n.regions),function(i){ma(i)}))}),Ya(Ss(e.timeline),function(n){ma(n),Bn(n,"label"),Bn(n,"itemStyle"),Bn(n,"controlStyle",!0);var i=n.data;Ze(i)&&le(i,function(a){vt(a)&&(Bn(a,"label"),Bn(a,"itemStyle"))})}),Ya(Ss(e.toolbox),function(n){Bn(n,"iconStyle"),Ya(n.feature,function(i){Bn(i,"iconStyle")})}),rn(XK(e.axisPointer),"label"),rn(XK(e.tooltip).axisPointer,"label")}function KTt(e,t){for(var r=t.split(","),n=e,i=0;i<r.length&&(n=n&&n[r[i]],n!=null);i++);return n}function XTt(e,t,r,n){for(var i=t.split(","),a=e,o,s=0;s<i.length-1;s++)o=i[s],a[o]==null&&(a[o]={}),a=a[o];(n||a[i[s]]==null)&&(a[i[s]]=r)}function qK(e){e&&le(qTt,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var qTt=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],ZTt=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],_P=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function Ey(e){var t=e&&e.itemStyle;if(t)for(var r=0;r<_P.length;r++){var n=_P[r][1],i=_P[r][0];t[n]!=null&&(t[i]=t[n])}}function ZK(e){e&&e.alignTo==="edge"&&e.margin!=null&&e.edgeDistance==null&&(e.edgeDistance=e.margin)}function JK(e){e&&e.downplay&&!e.blur&&(e.blur=e.downplay)}function JTt(e){e&&e.focusNodeAdjacency!=null&&(e.emphasis=e.emphasis||{},e.emphasis.focus==null&&(e.emphasis.focus="adjacency"))}function aue(e,t){if(e)for(var r=0;r<e.length;r++)t(e[r]),e[r]&&aue(e[r].children,t)}function oue(e,t){YTt(e,t),e.series=mi(e.series),le(e.series,function(r){if(vt(r)){var n=r.type;if(n==="line")r.clipOverflow!=null&&(r.clip=r.clipOverflow);else if(n==="pie"||n==="gauge"){r.clockWise!=null&&(r.clockwise=r.clockWise),ZK(r.label);var i=r.data;if(i&&!aa(i))for(var a=0;a<i.length;a++)ZK(i[a]);r.hoverOffset!=null&&(r.emphasis=r.emphasis||{},(r.emphasis.scaleSize=null)&&(r.emphasis.scaleSize=r.hoverOffset))}else if(n==="gauge"){var o=KTt(r,"pointer.color");o!=null&&XTt(r,"itemStyle.color",o)}else if(n==="bar"){Ey(r),Ey(r.backgroundStyle),Ey(r.emphasis);var i=r.data;if(i&&!aa(i))for(var a=0;a<i.length;a++)typeof i[a]=="object"&&(Ey(i[a]),Ey(i[a]&&i[a].emphasis))}else if(n==="sunburst"){var s=r.highlightPolicy;s&&(r.emphasis=r.emphasis||{},r.emphasis.focus||(r.emphasis.focus=s)),JK(r),aue(r.data,JK)}else n==="graph"||n==="sankey"?JTt(r):n==="map"&&(r.mapType&&!r.map&&(r.map=r.mapType),r.mapLocation&&fr(r,r.mapLocation));r.hoverAnimation!=null&&(r.emphasis=r.emphasis||{},r.emphasis&&r.emphasis.scale==null&&(r.emphasis.scale=r.hoverAnimation)),qK(r)}}),e.dataRange&&(e.visualMap=e.dataRange),le(ZTt,function(r){var n=e[r];n&&(Ze(n)||(n=[n]),le(n,function(i){qK(i)}))})}function QTt(e){var t=Bt();e.eachSeries(function(r){var n=r.get("stack");if(n){var i=t.get(n)||t.set(n,[]),a=r.getData(),o={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:r};if(!o.stackedDimension||!(o.isStackedByIndex||o.stackedByDimension))return;i.length&&a.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(o)}}),t.each(eOt)}function eOt(e){le(e,function(t,r){var n=[],i=[NaN,NaN],a=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";o.modify(a,function(u,f,c){var h=o.get(t.stackedDimension,c);if(isNaN(h))return i;var d,v;s?v=o.getRawIndex(c):d=o.get(t.stackedByDimension,c);for(var p=NaN,g=r-1;g>=0;g--){var y=e[g];if(s||(v=y.data.rawIndexOf(y.stackedByDimension,d)),v>=0){var m=y.data.getByRawIndex(y.stackResultDimension,v);if(l==="all"||l==="positive"&&m>0||l==="negative"&&m<0||l==="samesign"&&h>=0&&m>0||l==="samesign"&&h<=0&&m<0){h=c1t(h,m),p=m;break}}}return n[0]=h,n[1]=p,n})})}var LE=function(){function e(t){this.data=t.data||(t.sourceFormat===hs?{}:[]),this.sourceFormat=t.sourceFormat||Jle,this.seriesLayoutBy=t.seriesLayoutBy||ul,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var r=this.dimensionsDefine=t.dimensionsDefine;if(r)for(var n=0;n<r.length;n++){var i=r[n];i.type==null&&eue(this,n)===An.Must&&(i.type="ordinal")}}return e}();function U3(e){return e instanceof LE}function XN(e,t,r){r=r||sue(e);var n=t.seriesLayoutBy,i=rOt(e,r,n,t.sourceHeader,t.dimensions),a=new LE({data:e,sourceFormat:r,seriesLayoutBy:n,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:Xt(t)});return a}function z3(e){return new LE({data:e,sourceFormat:aa(e)?Eu:Va})}function tOt(e){return new LE({data:e.data,sourceFormat:e.sourceFormat,seriesLayoutBy:e.seriesLayoutBy,dimensionsDefine:Xt(e.dimensionsDefine),startIndex:e.startIndex,dimensionsDetectedCount:e.dimensionsDetectedCount})}function sue(e){var t=Jle;if(aa(e))t=Eu;else if(Ze(e)){e.length===0&&(t=$i);for(var r=0,n=e.length;r<n;r++){var i=e[r];if(i!=null){if(Ze(i)){t=$i;break}else if(vt(i)){t=xo;break}}}}else if(vt(e)){for(var a in e)if(dg(e,a)&&Fi(e[a])){t=hs;break}}return t}function rOt(e,t,r,n,i){var a,o;if(!e)return{dimensionsDefine:QK(i),startIndex:o,dimensionsDetectedCount:a};if(t===$i){var s=e;n==="auto"||n==null?eX(function(u){u!=null&&u!=="-"&&(st(u)?o==null&&(o=1):o=0)},r,s,10):o=Sr(n)?n:n?1:0,!i&&o===1&&(i=[],eX(function(u,f){i[f]=u!=null?u+"":""},r,s,1/0)),a=i?i.length:r===Hg?s.length:s[0]?s[0].length:null}else if(t===xo)i||(i=nOt(e));else if(t===hs)i||(i=[],le(e,function(u,f){i.push(f)}));else if(t===Va){var l=TS(e[0]);a=Ze(l)&&l.length||1}return{startIndex:o,dimensionsDefine:QK(i),dimensionsDetectedCount:a}}function nOt(e){for(var t=0,r;t<e.length&&!(r=e[t++]););if(r)return Lr(r)}function QK(e){if(e){var t=Bt();return ct(e,function(r,n){r=vt(r)?r:{name:r};var i={name:r.name,displayName:r.displayName,type:r.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var a=t.get(i.name);return a?i.name+="-"+a.count++:t.set(i.name,{count:1}),i})}}function eX(e,t,r,n){if(t===Hg)for(var i=0;i<r.length&&i<n;i++)e(r[i]?r[i][0]:null,i);else for(var a=r[0]||[],i=0;i<a.length&&i<n;i++)e(a[i],i)}function lue(e){var t=e.sourceFormat;return t===xo||t===hs}var kf,Af,Pf,tX,rX,uue=function(){function e(t,r){var n=U3(t)?t:z3(t);this._source=n;var i=this._data=n.data;n.sourceFormat===Eu&&(this._offset=0,this._dimSize=r,this._data=i),rX(this,i,n)}return e.prototype.getSource=function(){return this._source},e.prototype.count=function(){return 0},e.prototype.getItem=function(t,r){},e.prototype.appendData=function(t){},e.prototype.clean=function(){},e.protoInitialize=function(){var t=e.prototype;t.pure=!1,t.persistent=!0}(),e.internalField=function(){var t;rX=function(o,s,l){var u=l.sourceFormat,f=l.seriesLayoutBy,c=l.startIndex,h=l.dimensionsDefine,d=tX[G3(u,f)];if(Ne(o,d),u===Eu)o.getItem=r,o.count=i,o.fillStorage=n;else{var v=fue(u,f);o.getItem=kr(v,null,s,c,h);var p=cue(u,f);o.count=kr(p,null,s,c,h)}};var r=function(o,s){o=o-this._offset,s=s||[];for(var l=this._data,u=this._dimSize,f=u*o,c=0;c<u;c++)s[c]=l[f+c];return s},n=function(o,s,l,u){for(var f=this._data,c=this._dimSize,h=0;h<c;h++){for(var d=u[h],v=d[0]==null?1/0:d[0],p=d[1]==null?-1/0:d[1],g=s-o,y=l[h],m=0;m<g;m++){var b=f[m*c+h];y[o+m]=b,b<v&&(v=b),b>p&&(p=b)}d[0]=v,d[1]=p}},i=function(){return this._data?this._data.length/this._dimSize:0};tX=(t={},t[$i+"_"+ul]={pure:!0,appendData:a},t[$i+"_"+Hg]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[xo]={pure:!0,appendData:a},t[hs]={pure:!0,appendData:function(o){var s=this._data;le(o,function(l,u){for(var f=s[u]||(s[u]=[]),c=0;c<(l||[]).length;c++)f.push(l[c])})}},t[Va]={appendData:a},t[Eu]={persistent:!1,pure:!0,appendData:function(o){this._data=o},clean:function(){this._offset+=this.count(),this._data=null}},t);function a(o){for(var s=0;s<o.length;s++)this._data.push(o[s])}}(),e}(),nX=function(e,t,r,n){return e[n]},iOt=(kf={},kf[$i+"_"+ul]=function(e,t,r,n){return e[n+t]},kf[$i+"_"+Hg]=function(e,t,r,n,i){n+=t;for(var a=i||[],o=e,s=0;s<o.length;s++){var l=o[s];a[s]=l?l[n]:null}return a},kf[xo]=nX,kf[hs]=function(e,t,r,n,i){for(var a=i||[],o=0;o<r.length;o++){var s=r[o].name,l=e[s];a[o]=l?l[n]:null}return a},kf[Va]=nX,kf);function fue(e,t){var r=iOt[G3(e,t)];return r}var iX=function(e,t,r){return e.length},aOt=(Af={},Af[$i+"_"+ul]=function(e,t,r){return Math.max(0,e.length-t)},Af[$i+"_"+Hg]=function(e,t,r){var n=e[0];return n?Math.max(0,n.length-t):0},Af[xo]=iX,Af[hs]=function(e,t,r){var n=r[0].name,i=e[n];return i?i.length:0},Af[Va]=iX,Af);function cue(e,t){var r=aOt[G3(e,t)];return r}var CP=function(e,t,r){return e[t]},oOt=(Pf={},Pf[$i]=CP,Pf[xo]=function(e,t,r){return e[r]},Pf[hs]=CP,Pf[Va]=function(e,t,r){var n=TS(e);return n instanceof Array?n[t]:n},Pf[Eu]=CP,Pf);function hue(e){var t=oOt[e];return t}function G3(e,t){return e===$i?e+"_"+t:e}function gg(e,t,r){if(e){var n=e.getRawDataItem(t);if(n!=null){var i=e.getStore(),a=i.getSource().sourceFormat;if(r!=null){var o=e.getDimensionIndex(r),s=i.getDimensionProperty(o);return hue(a)(n,o,s)}else{var l=n;return a===Va&&(l=TS(n)),l}}}}var sOt=/\{@(.+?)\}/g,due=function(){function e(){}return e.prototype.getDataParams=function(t,r){var n=this.getData(r),i=this.getRawValue(t,r),a=n.getRawIndex(t),o=n.getName(t),s=n.getRawDataItem(t),l=n.getItemVisual(t,"style"),u=l&&l[n.getItemVisual(t,"drawType")||"fill"],f=l&&l.stroke,c=this.mainType,h=c==="series",d=n.userOutput&&n.userOutput.get();return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:h?this.subType:null,seriesIndex:this.seriesIndex,seriesId:h?this.id:null,seriesName:h?this.name:null,name:o,dataIndex:a,data:s,dataType:r,value:i,color:u,borderColor:f,dimensionNames:d?d.fullDimensions:null,encode:d?d.encode:null,$vars:["seriesName","name","value"]}},e.prototype.getFormattedLabel=function(t,r,n,i,a,o){r=r||"normal";var s=this.getData(n),l=this.getDataParams(t,n);if(o&&(l.value=o.interpolatedValue),i!=null&&Ze(l.value)&&(l.value=l.value[i]),!a){var u=s.getItemModel(t);a=u.get(r==="normal"?["label","formatter"]:[r,"label","formatter"])}if(gt(a))return l.status=r,l.dimensionIndex=i,a(l);if(st(a)){var f=Xle(a,l);return f.replace(sOt,function(c,h){var d=h.length,v=h;v.charAt(0)==="["&&v.charAt(d-1)==="]"&&(v=+v.slice(1,d-1));var p=gg(s,t,v);if(o&&Ze(o.interpolatedValue)){var g=s.getDimensionIndex(v);g>=0&&(p=o.interpolatedValue[g])}return p!=null?p+"":""})}},e.prototype.getRawValue=function(t,r){return gg(this.getData(r),t)},e.prototype.formatTooltip=function(t,r,n){},e}();function aX(e){var t,r;return vt(e)?e.type&&(r=e):t=e,{text:t,frag:r}}function Um(e){return new lOt(e)}var lOt=function(){function e(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return e.prototype.perform=function(t){var r=this._upstream,n=t&&t.skip;if(this._dirty&&r){var i=this.context;i.data=i.outputData=r.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var a;this._plan&&!n&&(a=this._plan(this.context));var o=f(this._modBy),s=this._modDataCount||0,l=f(t&&t.modBy),u=t&&t.modDataCount||0;(o!==l||s!==u)&&(a="reset");function f(m){return!(m>=1)&&(m=1),m}var c;(this._dirty||a==="reset")&&(this._dirty=!1,c=this._doReset(n)),this._modBy=l,this._modDataCount=u;var h=t&&t.step;if(r?this._dueEnd=r._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var d=this._dueIndex,v=Math.min(h!=null?this._dueIndex+h:1/0,this._dueEnd);if(!n&&(c||d<v)){var p=this._progress;if(Ze(p))for(var g=0;g<p.length;g++)this._doProgress(p[g],d,v,l,u);else this._doProgress(p,d,v,l,u)}this._dueIndex=v;var y=this._settedOutputEnd!=null?this._settedOutputEnd:v;this._outputDueEnd=y}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},e.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},e.prototype._doProgress=function(t,r,n,i,a){oX.reset(r,n,i,a),this._callingProgress=t,this._callingProgress({start:r,end:n,count:n-r,next:oX.next},this.context)},e.prototype._doReset=function(t){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var r,n;!t&&this._reset&&(r=this._reset(this.context),r&&r.progress&&(n=r.forceFirstProgress,r=r.progress),Ze(r)&&!r.length&&(r=null)),this._progress=r,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),n},e.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},e.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},e.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},e.prototype.getUpstream=function(){return this._upstream},e.prototype.getDownstream=function(){return this._downstream},e.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},e}(),oX=function(){var e,t,r,n,i,a={reset:function(l,u,f,c){t=l,e=u,r=f,n=c,i=Math.ceil(n/r),a.next=r>1&&n>0?s:o}};return a;function o(){return t<e?t++:null}function s(){var l=t%i*r+Math.ceil(t/i),u=t>=e?null:l<n?l:t;return t++,u}}();function tv(e,t){var r=t&&t.type;return r==="ordinal"?e:(r==="time"&&!Sr(e)&&e!=null&&e!=="-"&&(e=+yl(e)),e==null||e===""?NaN:+e)}Bt({number:function(e){return parseFloat(e)},time:function(e){return+yl(e)},trim:function(e){return st(e)?Ko(e):e}});var uOt=function(){function e(t,r){var n=t==="desc";this._resultLT=n?1:-1,r==null&&(r=n?"min":"max"),this._incomparable=r==="min"?-1/0:1/0}return e.prototype.evaluate=function(t,r){var n=Sr(t)?t:PT(t),i=Sr(r)?r:PT(r),a=isNaN(n),o=isNaN(i);if(a&&(n=this._incomparable),o&&(i=this._incomparable),a&&o){var s=st(t),l=st(r);s&&(n=l?t:0),l&&(i=s?r:0)}return n<i?this._resultLT:n>i?-this._resultLT:0},e}(),fOt=function(){function e(){}return e.prototype.getRawData=function(){throw new Error("not supported")},e.prototype.getRawDataItem=function(t){throw new Error("not supported")},e.prototype.cloneRawData=function(){},e.prototype.getDimensionInfo=function(t){},e.prototype.cloneAllDimensionInfo=function(){},e.prototype.count=function(){},e.prototype.retrieveValue=function(t,r){},e.prototype.retrieveValueFromItem=function(t,r){},e.prototype.convertValue=function(t,r){return tv(t,r)},e}();function cOt(e,t){var r=new fOt,n=e.data,i=r.sourceFormat=e.sourceFormat,a=e.startIndex,o="";e.seriesLayoutBy!==ul&&Mi(o);var s=[],l={},u=e.dimensionsDefine;if(u)le(u,function(p,g){var y=p.name,m={index:g,name:y,displayName:p.displayName};if(s.push(m),y!=null){var b="";dg(l,y)&&Mi(b),l[y]=m}});else for(var f=0;f<e.dimensionsDetectedCount;f++)s.push({index:f});var c=fue(i,ul);t.__isBuiltIn&&(r.getRawDataItem=function(p){return c(n,a,s,p)},r.getRawData=kr(hOt,null,e)),r.cloneRawData=kr(dOt,null,e);var h=cue(i,ul);r.count=kr(h,null,n,a,s);var d=hue(i);r.retrieveValue=function(p,g){var y=c(n,a,s,p);return v(y,g)};var v=r.retrieveValueFromItem=function(p,g){if(p!=null){var y=s[g];if(y)return d(p,g,y.name)}};return r.getDimensionInfo=kr(vOt,null,s,l),r.cloneAllDimensionInfo=kr(pOt,null,s),r}function hOt(e){var t=e.sourceFormat;if(!Y3(t)){var r="";Mi(r)}return e.data}function dOt(e){var t=e.sourceFormat,r=e.data;if(!Y3(t)){var n="";Mi(n)}if(t===$i){for(var i=[],a=0,o=r.length;a<o;a++)i.push(r[a].slice());return i}else if(t===xo){for(var i=[],a=0,o=r.length;a<o;a++)i.push(Ne({},r[a]));return i}}function vOt(e,t,r){if(r!=null){if(Sr(r)||!isNaN(r)&&!dg(t,r))return e[r];if(dg(t,r))return t[r]}}function pOt(e){return Xt(e)}var vue=Bt();function gOt(e){e=Xt(e);var t=e.type,r="";t||Mi(r);var n=t.split(":");n.length!==2&&Mi(r);var i=!1;n[0]==="echarts"&&(t=n[1],i=!0),e.__isBuiltIn=i,vue.set(t,e)}function yOt(e,t,r){var n=mi(e),i=n.length,a="";i||Mi(a);for(var o=0,s=i;o<s;o++){var l=n[o];t=mOt(l,t),o!==s-1&&(t.length=Math.max(t.length,1))}return t}function mOt(e,t,r,n){var i="";t.length||Mi(i),vt(e)||Mi(i);var a=e.type,o=vue.get(a);o||Mi(i);var s=ct(t,function(u){return cOt(u,o)}),l=mi(o.transform({upstream:s[0],upstreamList:s,config:Xt(e.config)}));return ct(l,function(u,f){var c="";vt(u)||Mi(c),u.data||Mi(c);var h=sue(u.data);Y3(h)||Mi(c);var d,v=t[0];if(v&&f===0&&!u.dimensions){var p=v.startIndex;p&&(u.data=v.data.slice(0,p).concat(u.data)),d={seriesLayoutBy:ul,sourceHeader:p,dimensions:v.metaRawOption.dimensions}}else d={seriesLayoutBy:ul,sourceHeader:0,dimensions:u.dimensions};return XN(u.data,d,null)})}function Y3(e){return e===$i||e===xo}var FE="undefined",bOt=typeof Uint32Array===FE?Array:Uint32Array,wOt=typeof Uint16Array===FE?Array:Uint16Array,pue=typeof Int32Array===FE?Array:Int32Array,sX=typeof Float64Array===FE?Array:Float64Array,gue={float:sX,int:pue,ordinal:Array,number:Array,time:sX},xP;function Ry(e){return e>65535?bOt:wOt}function ud(){return[1/0,-1/0]}function SOt(e){var t=e.constructor;return t===Array?e.slice():new t(e)}function lX(e,t,r,n,i){var a=gue[r||"float"];if(i){var o=e[t],s=o&&o.length;if(s!==n){for(var l=new a(n),u=0;u<s;u++)l[u]=o[u];e[t]=l}}else e[t]=new a(n)}var qN=function(){function e(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=Bt()}return e.prototype.initData=function(t,r,n){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=t.getSource(),a=this.defaultDimValueGetter=xP[i.sourceFormat];this._dimValueGetter=n||a,this._rawExtent=[],lue(i),this._dimensions=ct(r,function(o){return{type:o.type,property:o.property}}),this._initDataFromProvider(0,t.count())},e.prototype.getProvider=function(){return this._provider},e.prototype.getSource=function(){return this._provider.getSource()},e.prototype.ensureCalculationDimension=function(t,r){var n=this._calcDimNameToIdx,i=this._dimensions,a=n.get(t);if(a!=null){if(i[a].type===r)return a}else a=i.length;return i[a]={type:r},n.set(t,a),this._chunks[a]=new gue[r||"float"](this._rawCount),this._rawExtent[a]=ud(),a},e.prototype.collectOrdinalMeta=function(t,r){var n=this._chunks[t],i=this._dimensions[t],a=this._rawExtent,o=i.ordinalOffset||0,s=n.length;o===0&&(a[t]=ud());for(var l=a[t],u=o;u<s;u++){var f=n[u]=r.parseAndCollect(n[u]);isNaN(f)||(l[0]=Math.min(f,l[0]),l[1]=Math.max(f,l[1]))}i.ordinalMeta=r,i.ordinalOffset=s,i.type="ordinal"},e.prototype.getOrdinalMeta=function(t){var r=this._dimensions[t],n=r.ordinalMeta;return n},e.prototype.getDimensionProperty=function(t){var r=this._dimensions[t];return r&&r.property},e.prototype.appendData=function(t){var r=this._provider,n=this.count();r.appendData(t);var i=r.count();return r.persistent||(i+=n),n<i&&this._initDataFromProvider(n,i,!0),[n,i]},e.prototype.appendValues=function(t,r){for(var n=this._chunks,i=this._dimensions,a=i.length,o=this._rawExtent,s=this.count(),l=s+Math.max(t.length,r||0),u=0;u<a;u++){var f=i[u];lX(n,u,f.type,l,!0)}for(var c=[],h=s;h<l;h++)for(var d=h-s,v=0;v<a;v++){var f=i[v],p=xP.arrayRows.call(this,t[d]||c,f.property,d,v);n[v][h]=p;var g=o[v];p<g[0]&&(g[0]=p),p>g[1]&&(g[1]=p)}return this._rawCount=this._count=l,{start:s,end:l}},e.prototype._initDataFromProvider=function(t,r,n){for(var i=this._provider,a=this._chunks,o=this._dimensions,s=o.length,l=this._rawExtent,u=ct(o,function(m){return m.property}),f=0;f<s;f++){var c=o[f];l[f]||(l[f]=ud()),lX(a,f,c.type,r,n)}if(i.fillStorage)i.fillStorage(t,r,a,l);else for(var h=[],d=t;d<r;d++){h=i.getItem(d,h);for(var v=0;v<s;v++){var p=a[v],g=this._dimValueGetter(h,u[v],d,v);p[d]=g;var y=l[v];g<y[0]&&(y[0]=g),g>y[1]&&(y[1]=g)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=r,this._extent=[]},e.prototype.count=function(){return this._count},e.prototype.get=function(t,r){if(!(r>=0&&r<this._count))return NaN;var n=this._chunks[t];return n?n[this.getRawIndex(r)]:NaN},e.prototype.getValues=function(t,r){var n=[],i=[];if(r==null){r=t,t=[];for(var a=0;a<this._dimensions.length;a++)i.push(a)}else i=t;for(var a=0,o=i.length;a<o;a++)n.push(this.get(i[a],r));return n},e.prototype.getByRawIndex=function(t,r){if(!(r>=0&&r<this._rawCount))return NaN;var n=this._chunks[t];return n?n[r]:NaN},e.prototype.getSum=function(t){var r=this._chunks[t],n=0;if(r)for(var i=0,a=this.count();i<a;i++){var o=this.get(t,i);isNaN(o)||(n+=o)}return n},e.prototype.getMedian=function(t){var r=[];this.each([t],function(a){isNaN(a)||r.push(a)});var n=r.sort(function(a,o){return a-o}),i=this.count();return i===0?0:i%2===1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},e.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var r=this._indices,n=r[t];if(n!=null&&n<this._count&&n===t)return t;for(var i=0,a=this._count-1;i<=a;){var o=(i+a)/2|0;if(r[o]<t)i=o+1;else if(r[o]>t)a=o-1;else return o}return-1},e.prototype.indicesOfNearest=function(t,r,n){var i=this._chunks,a=i[t],o=[];if(!a)return o;n==null&&(n=1/0);for(var s=1/0,l=-1,u=0,f=0,c=this.count();f<c;f++){var h=this.getRawIndex(f),d=r-a[h],v=Math.abs(d);v<=n&&((v<s||v===s&&d>=0&&l<0)&&(s=v,l=d,u=0),d===l&&(o[u++]=f))}return o.length=u,o},e.prototype.getIndices=function(){var t,r=this._indices;if(r){var n=r.constructor,i=this._count;if(n===Array){t=new n(i);for(var a=0;a<i;a++)t[a]=r[a]}else t=new n(r.buffer,0,i)}else{var n=Ry(this._rawCount);t=new n(this.count());for(var a=0;a<t.length;a++)t[a]=a}return t},e.prototype.filter=function(t,r){if(!this._count)return this;for(var n=this.clone(),i=n.count(),a=Ry(n._rawCount),o=new a(i),s=[],l=t.length,u=0,f=t[0],c=n._chunks,h=0;h<i;h++){var d=void 0,v=n.getRawIndex(h);if(l===0)d=r(h);else if(l===1){var p=c[f][v];d=r(p,h)}else{for(var g=0;g<l;g++)s[g]=c[t[g]][v];s[g]=h,d=r.apply(null,s)}d&&(o[u++]=v)}return u<i&&(n._indices=o),n._count=u,n._extent=[],n._updateGetRawIdx(),n},e.prototype.selectRange=function(t){var r=this.clone(),n=r._count;if(!n)return this;var i=Lr(t),a=i.length;if(!a)return this;var o=r.count(),s=Ry(r._rawCount),l=new s(o),u=0,f=i[0],c=t[f][0],h=t[f][1],d=r._chunks,v=!1;if(!r._indices){var p=0;if(a===1){for(var g=d[i[0]],y=0;y<n;y++){var m=g[y];(m>=c&&m<=h||isNaN(m))&&(l[u++]=p),p++}v=!0}else if(a===2){for(var g=d[i[0]],b=d[i[1]],S=t[i[1]][0],x=t[i[1]][1],y=0;y<n;y++){var m=g[y],T=b[y];(m>=c&&m<=h||isNaN(m))&&(T>=S&&T<=x||isNaN(T))&&(l[u++]=p),p++}v=!0}}if(!v)if(a===1)for(var y=0;y<o;y++){var E=r.getRawIndex(y),m=d[i[0]][E];(m>=c&&m<=h||isNaN(m))&&(l[u++]=E)}else for(var y=0;y<o;y++){for(var P=!0,E=r.getRawIndex(y),R=0;R<a;R++){var M=i[R],m=d[M][E];(m<t[M][0]||m>t[M][1])&&(P=!1)}P&&(l[u++]=r.getRawIndex(y))}return u<o&&(r._indices=l),r._count=u,r._extent=[],r._updateGetRawIdx(),r},e.prototype.map=function(t,r){var n=this.clone(t);return this._updateDims(n,t,r),n},e.prototype.modify=function(t,r){this._updateDims(this,t,r)},e.prototype._updateDims=function(t,r,n){for(var i=t._chunks,a=[],o=r.length,s=t.count(),l=[],u=t._rawExtent,f=0;f<r.length;f++)u[r[f]]=ud();for(var c=0;c<s;c++){for(var h=t.getRawIndex(c),d=0;d<o;d++)l[d]=i[r[d]][h];l[o]=c;var v=n&&n.apply(null,l);if(v!=null){typeof v!="object"&&(a[0]=v,v=a);for(var f=0;f<v.length;f++){var p=r[f],g=v[f],y=u[p],m=i[p];m&&(m[h]=g),g<y[0]&&(y[0]=g),g>y[1]&&(y[1]=g)}}}},e.prototype.lttbDownSample=function(t,r){var n=this.clone([t],!0),i=n._chunks,a=i[t],o=this.count(),s=0,l=Math.floor(1/r),u=this.getRawIndex(0),f,c,h,d=new(Ry(this._rawCount))(Math.min((Math.ceil(o/l)+2)*2,o));d[s++]=u;for(var v=1;v<o-1;v+=l){for(var p=Math.min(v+l,o-1),g=Math.min(v+l*2,o),y=(g+p)/2,m=0,b=p;b<g;b++){var S=this.getRawIndex(b),x=a[S];isNaN(x)||(m+=x)}m/=g-p;var T=v,E=Math.min(v+l,o),P=v-1,R=a[u];f=-1,h=T;for(var M=-1,D=0,b=T;b<E;b++){var S=this.getRawIndex(b),x=a[S];if(isNaN(x)){D++,M<0&&(M=S);continue}c=Math.abs((P-y)*(x-R)-(P-b)*(m-R)),c>f&&(f=c,h=S)}D>0&&D<E-T&&(d[s++]=Math.min(M,h),h=Math.max(M,h)),d[s++]=h,u=h}return d[s++]=this.getRawIndex(o-1),n._count=s,n._indices=d,n.getRawIndex=this._getRawIdx,n},e.prototype.downSample=function(t,r,n,i){for(var a=this.clone([t],!0),o=a._chunks,s=[],l=Math.floor(1/r),u=o[t],f=this.count(),c=a._rawExtent[t]=ud(),h=new(Ry(this._rawCount))(Math.ceil(f/l)),d=0,v=0;v<f;v+=l){l>f-v&&(l=f-v,s.length=l);for(var p=0;p<l;p++){var g=this.getRawIndex(v+p);s[p]=u[g]}var y=n(s),m=this.getRawIndex(Math.min(v+i(s,y)||0,f-1));u[m]=y,y<c[0]&&(c[0]=y),y>c[1]&&(c[1]=y),h[d++]=m}return a._count=d,a._indices=h,a._updateGetRawIdx(),a},e.prototype.each=function(t,r){if(this._count)for(var n=t.length,i=this._chunks,a=0,o=this.count();a<o;a++){var s=this.getRawIndex(a);switch(n){case 0:r(a);break;case 1:r(i[t[0]][s],a);break;case 2:r(i[t[0]][s],i[t[1]][s],a);break;default:for(var l=0,u=[];l<n;l++)u[l]=i[t[l]][s];u[l]=a,r.apply(null,u)}}},e.prototype.getDataExtent=function(t){var r=this._chunks[t],n=ud();if(!r)return n;var i=this.count(),a=!this._indices,o;if(a)return this._rawExtent[t].slice();if(o=this._extent[t],o)return o.slice();o=n;for(var s=o[0],l=o[1],u=0;u<i;u++){var f=this.getRawIndex(u),c=r[f];c<s&&(s=c),c>l&&(l=c)}return o=[s,l],this._extent[t]=o,o},e.prototype.getRawDataItem=function(t){var r=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(r);for(var n=[],i=this._chunks,a=0;a<i.length;a++)n.push(i[a][r]);return n},e.prototype.clone=function(t,r){var n=new e,i=this._chunks,a=t&&Lu(t,function(s,l){return s[l]=!0,s},{});if(a)for(var o=0;o<i.length;o++)n._chunks[o]=a[o]?SOt(i[o]):i[o];else n._chunks=i;return this._copyCommonProps(n),r||(n._indices=this._cloneIndices()),n._updateGetRawIdx(),n},e.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=Xt(this._extent),t._rawExtent=Xt(this._rawExtent)},e.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,r=void 0;if(t===Array){var n=this._indices.length;r=new t(n);for(var i=0;i<n;i++)r[i]=this._indices[i]}else r=new t(this._indices);return r}return null},e.prototype._getRawIdxIdentity=function(t){return t},e.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},e.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},e.internalField=function(){function t(r,n,i,a){return tv(r[a],this._dimensions[a])}xP={arrayRows:t,objectRows:function(r,n,i,a){return tv(r[n],this._dimensions[a])},keyedColumns:t,original:function(r,n,i,a){var o=r&&(r.value==null?r:r.value);return tv(o instanceof Array?o[a]:o,this._dimensions[a])},typedArray:function(r,n,i,a){return r[a]}}}(),e}(),_Ot=function(){function e(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return e.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},e.prototype._setLocalSource=function(t,r){this._sourceList=t,this._upstreamSignList=r,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},e.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},e.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},e.prototype._createSource=function(){this._setLocalSource([],[]);var t=this._sourceHost,r=this._getUpstreamSourceManagers(),n=!!r.length,i,a;if(p1(t)){var o=t,s=void 0,l=void 0,u=void 0;if(n){var f=r[0];f.prepareSource(),u=f.getSource(),s=u.data,l=u.sourceFormat,a=[f._getVersionSign()]}else s=o.get("data",!0),l=aa(s)?Eu:Va,a=[];var c=this._getSourceMetaRawOption()||{},h=u&&u.metaRawOption||{},d=qt(c.seriesLayoutBy,h.seriesLayoutBy)||null,v=qt(c.sourceHeader,h.sourceHeader),p=qt(c.dimensions,h.dimensions),g=d!==h.seriesLayoutBy||!!v!=!!h.sourceHeader||p;i=g?[XN(s,{seriesLayoutBy:d,sourceHeader:v,dimensions:p},l)]:[]}else{var y=t;if(n){var m=this._applyTransform(r);i=m.sourceList,a=m.upstreamSignList}else{var b=y.get("source",!0);i=[XN(b,this._getSourceMetaRawOption(),null)],a=[]}}this._setLocalSource(i,a)},e.prototype._applyTransform=function(t){var r=this._sourceHost,n=r.get("transform",!0),i=r.get("fromTransformResult",!0);if(i!=null){var a="";t.length!==1&&uX(a)}var o,s=[],l=[];return le(t,function(u){u.prepareSource();var f=u.getSource(i||0),c="";i!=null&&!f&&uX(c),s.push(f),l.push(u._getVersionSign())}),n?o=yOt(n,s,{datasetIndex:r.componentIndex}):i!=null&&(o=[tOt(s[0])]),{sourceList:o,upstreamSignList:l}},e.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),r=0;r<t.length;r++){var n=t[r];if(n._isDirty()||this._upstreamSignList[r]!==n._getVersionSign())return!0}},e.prototype.getSource=function(t){t=t||0;var r=this._sourceList[t];if(!r){var n=this._getUpstreamSourceManagers();return n[0]&&n[0].getSource(t)}return r},e.prototype.getSharedDataStore=function(t){var r=t.makeStoreSchema();return this._innerGetDataStore(r.dimensions,t.source,r.hash)},e.prototype._innerGetDataStore=function(t,r,n){var i=0,a=this._storeList,o=a[i];o||(o=a[i]={});var s=o[n];if(!s){var l=this._getUpstreamSourceManagers()[0];p1(this._sourceHost)&&l?s=l._innerGetDataStore(t,r,n):(s=new qN,s.initData(new uue(r,t.length),t)),o[n]=s}return s},e.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(p1(t)){var r=V3(t);return r?[r.getSourceManager()]:[]}else return ct(ETt(t),function(n){return n.getSourceManager()})},e.prototype._getSourceMetaRawOption=function(){var t=this._sourceHost,r,n,i;if(p1(t))r=t.get("seriesLayoutBy",!0),n=t.get("sourceHeader",!0),i=t.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=t;r=a.get("seriesLayoutBy",!0),n=a.get("sourceHeader",!0),i=a.get("dimensions",!0)}return{seriesLayoutBy:r,sourceHeader:n,dimensions:i}},e}();function p1(e){return e.mainType==="series"}function uX(e){throw new Error(e)}var yue="line-height:1";function mue(e,t){var r=e.color||"#6e7079",n=e.fontSize||12,i=e.fontWeight||"400",a=e.color||"#464646",o=e.fontSize||14,s=e.fontWeight||"900";return t==="html"?{nameStyle:"font-size:"+_a(n+"")+"px;color:"+_a(r)+";font-weight:"+_a(i+""),valueStyle:"font-size:"+_a(o+"")+"px;color:"+_a(a)+";font-weight:"+_a(s+"")}:{nameStyle:{fontSize:n,fill:r,fontWeight:i},valueStyle:{fontSize:o,fill:a,fontWeight:s}}}var COt=[0,10,20,30],xOt=["",`
`,`

`,`


`];function qc(e,t){return t.type=e,t}function ZN(e){return e.type==="section"}function bue(e){return ZN(e)?TOt:OOt}function wue(e){if(ZN(e)){var t=0,r=e.blocks.length,n=r>1||r>0&&!e.noHeader;return le(e.blocks,function(i){var a=wue(i);a>=t&&(t=a+ +(n&&(!a||ZN(i)&&!i.noHeader)))}),t}return 0}function TOt(e,t,r,n){var i=t.noHeader,a=EOt(wue(t)),o=[],s=t.blocks||[];gl(!s||Ze(s)),s=s||[];var l=e.orderMode;if(t.sortBlocks&&l){s=s.slice();var u={valueAsc:"asc",valueDesc:"desc"};if(dg(u,l)){var f=new uOt(u[l],null);s.sort(function(v,p){return f.evaluate(v.sortParam,p.sortParam)})}else l==="seriesDesc"&&s.reverse()}le(s,function(v,p){var g=t.valueFormatter,y=bue(v)(g?Ne(Ne({},e),{valueFormatter:g}):e,v,p>0?a.html:0,n);y!=null&&o.push(y)});var c=e.renderMode==="richText"?o.join(a.richText):JN(o.join(""),i?r:a.html);if(i)return c;var h=KN(t.header,"ordinal",e.useUTC),d=mue(n,e.renderMode).nameStyle;return e.renderMode==="richText"?Sue(e,h,d)+a.richText+c:JN('<div style="'+d+";"+yue+';">'+_a(h)+"</div>"+c,r)}function OOt(e,t,r,n){var i=e.renderMode,a=t.noName,o=t.noValue,s=!t.markerType,l=t.name,u=e.useUTC,f=t.valueFormatter||e.valueFormatter||function(S){return S=Ze(S)?S:[S],ct(S,function(x,T){return KN(x,Ze(d)?d[T]:d,u)})};if(!(a&&o)){var c=s?"":e.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",i),h=a?"":KN(l,"ordinal",u),d=t.valueType,v=o?[]:f(t.value),p=!s||!a,g=!s&&a,y=mue(n,i),m=y.nameStyle,b=y.valueStyle;return i==="richText"?(s?"":c)+(a?"":Sue(e,h,m))+(o?"":AOt(e,v,p,g,b)):JN((s?"":c)+(a?"":ROt(h,!s,m))+(o?"":kOt(v,p,g,b)),r)}}function fX(e,t,r,n,i,a){if(e){var o=bue(e),s={useUTC:i,renderMode:r,orderMode:n,markupStyleCreator:t,valueFormatter:e.valueFormatter};return o(s,e,0,a)}}function EOt(e){return{html:COt[e],richText:xOt[e]}}function JN(e,t){var r='<div style="clear:both"></div>',n="margin: "+t+"px 0 0";return'<div style="'+n+";"+yue+';">'+e+r+"</div>"}function ROt(e,t,r){var n=t?"margin-left:2px":"";return'<span style="'+r+";"+n+'">'+_a(e)+"</span>"}function kOt(e,t,r,n){var i=r?"10px":"20px",a=t?"float:right;margin-left:"+i:"";return e=Ze(e)?e:[e],'<span style="'+a+";"+n+'">'+ct(e,function(o){return _a(o)}).join("&nbsp;&nbsp;")+"</span>"}function Sue(e,t,r){return e.markupStyleCreator.wrapRichTextStyle(t,r)}function AOt(e,t,r,n,i){var a=[i],o=n?10:20;return r&&a.push({padding:[0,0,0,o],align:"right"}),e.markupStyleCreator.wrapRichTextStyle(Ze(t)?t.join("  "):t,a)}function POt(e,t){var r=e.getData().getItemVisual(t,"style"),n=r[e.visualDrawType];return Xc(n)}function _ue(e,t){var r=e.get("padding");return r??(t==="richText"?[8,10]:10)}var TP=function(){function e(){this.richTextStyles={},this._nextStyleNameId=Dse()}return e.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},e.prototype.makeTooltipMarker=function(t,r,n){var i=n==="richText"?this._generateStyleName():null,a=mTt({color:r,type:t,renderMode:n,markerId:i});return st(a)?a:(this.richTextStyles[i]=a.style,a.content)},e.prototype.wrapRichTextStyle=function(t,r){var n={};Ze(r)?le(r,function(a){return Ne(n,a)}):Ne(n,r);var i=this._generateStyleName();return this.richTextStyles[i]=n,"{"+i+"|"+t+"}"},e}();function IOt(e){var t=e.series,r=e.dataIndex,n=e.multipleSeries,i=t.getData(),a=i.mapDimensionsAll("defaultedTooltip"),o=a.length,s=t.getRawValue(r),l=Ze(s),u=POt(t,r),f,c,h,d;if(o>1||l&&!o){var v=MOt(s,t,r,a,u);f=v.inlineValues,c=v.inlineValueTypes,h=v.blocks,d=v.inlineValues[0]}else if(o){var p=i.getDimensionInfo(a[0]);d=f=gg(i,r,a[0]),c=p.type}else d=f=l?s[0]:s;var g=b3(t),y=g&&t.name||"",m=i.getName(r),b=n?y:m;return qc("section",{header:y,noHeader:n||!g,sortParam:d,blocks:[qc("nameValue",{markerType:"item",markerColor:u,name:b,noName:!Ko(b),value:f,valueType:c})].concat(h||[])})}function MOt(e,t,r,n,i){var a=t.getData(),o=Lu(e,function(c,h,d){var v=a.getDimensionInfo(d);return c=c||v&&v.tooltip!==!1&&v.displayName!=null},!1),s=[],l=[],u=[];n.length?le(n,function(c){f(gg(a,r,c),c)}):le(e,f);function f(c,h){var d=a.getDimensionInfo(h);!d||d.otherDims.tooltip===!1||(o?u.push(qc("nameValue",{markerType:"subItem",markerColor:i,name:d.displayName,value:c,valueType:d.type})):(s.push(c),l.push(d.type)))}return{inlineValues:s,inlineValueTypes:l,blocks:u}}var Hl=Jr();function g1(e,t){return e.getName(t)||e.getId(t)}var DOt="__universalTransitionEnabled",$E=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._selectedDataIndicesMap={},r}return t.prototype.init=function(r,n,i){this.seriesIndex=this.componentIndex,this.dataTask=Um({count:LOt,reset:FOt}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(r,i);var a=Hl(this).sourceManager=new _Ot(this);a.prepareSource();var o=this.getInitialData(r,i);hX(o,this),this.dataTask.context.data=o,Hl(this).dataBeforeProcessed=o,cX(this),this._initSelectedMapFromData(o)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=bw(this),a=i?NE(r):{},o=this.subType;Er.hasClass(o)&&(o+="Series"),lr(r,n.getTheme().get(this.subType)),lr(r,this.getDefaultOption()),IT(r,"label",["show"]),this.fillDataTextStyle(r.data),i&&pg(r,a,i)},t.prototype.mergeOption=function(r,n){r=lr(this.option,r,!0),this.fillDataTextStyle(r.data);var i=bw(this);i&&pg(this.option,r,i);var a=Hl(this).sourceManager;a.dirty(),a.prepareSource();var o=this.getInitialData(r,n);hX(o,this),this.dataTask.dirty(),this.dataTask.context.data=o,Hl(this).dataBeforeProcessed=o,cX(this),this._initSelectedMapFromData(o)},t.prototype.fillDataTextStyle=function(r){if(r&&!aa(r))for(var n=["show"],i=0;i<r.length;i++)r[i]&&r[i].label&&IT(r[i],"label",n)},t.prototype.getInitialData=function(r,n){},t.prototype.appendData=function(r){var n=this.getRawData();n.appendData(r.data)},t.prototype.getData=function(r){var n=QN(this);if(n){var i=n.context.data;return r==null?i:i.getLinkedData(r)}else return Hl(this).data},t.prototype.getAllData=function(){var r=this.getData();return r&&r.getLinkedDataAll?r.getLinkedDataAll():[{data:r}]},t.prototype.setData=function(r){var n=QN(this);if(n){var i=n.context;i.outputData=r,n!==this.dataTask&&(i.data=r)}Hl(this).data=r},t.prototype.getEncode=function(){var r=this.get("encode",!0);if(r)return Bt(r)},t.prototype.getSourceManager=function(){return Hl(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return Hl(this).dataBeforeProcessed},t.prototype.getColorBy=function(){var r=this.get("colorBy");return r||"series"},t.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},t.prototype.getBaseAxis=function(){var r=this.coordinateSystem;return r&&r.getBaseAxis&&r.getBaseAxis()},t.prototype.formatTooltip=function(r,n,i){return IOt({series:this,dataIndex:r,multipleSeries:n})},t.prototype.isAnimationEnabled=function(){var r=this.ecModel;if(Ht.node&&!(r&&r.ssr))return!1;var n=this.getShallow("animation");return n&&this.getData().count()>this.getShallow("animationThreshold")&&(n=!1),!!n},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(r,n,i){var a=this.ecModel,o=j3.prototype.getColorFromPalette.call(this,r,n,i);return o||(o=a.getColorFromPalette(r,n,i)),o},t.prototype.coordDimToDataDim=function(r){return this.getRawData().mapDimensionsAll(r)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(r,n){this._innerSelect(this.getData(n),r)},t.prototype.unselect=function(r,n){var i=this.option.selectedMap;if(i){var a=this.option.selectedMode,o=this.getData(n);if(a==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var s=0;s<r.length;s++){var l=r[s],u=g1(o,l);i[u]=!1,this._selectedDataIndicesMap[u]=-1}}},t.prototype.toggleSelect=function(r,n){for(var i=[],a=0;a<r.length;a++)i[0]=r[a],this.isSelected(r[a],n)?this.unselect(i,n):this.select(i,n)},t.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var r=this._selectedDataIndicesMap,n=Lr(r),i=[],a=0;a<n.length;a++){var o=r[n[a]];o>=0&&i.push(o)}return i},t.prototype.isSelected=function(r,n){var i=this.option.selectedMap;if(!i)return!1;var a=this.getData(n);return(i==="all"||i[g1(a,r)])&&!a.getItemModel(r).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[DOt])return!0;var r=this.option.universalTransition;return r?r===!0?!0:r&&r.enabled:!1},t.prototype._innerSelect=function(r,n){var i,a,o=this.option,s=o.selectedMode,l=n.length;if(!(!s||!l)){if(s==="series")o.selectedMap="all";else if(s==="multiple"){vt(o.selectedMap)||(o.selectedMap={});for(var u=o.selectedMap,f=0;f<l;f++){var c=n[f],h=g1(r,c);u[h]=!0,this._selectedDataIndicesMap[h]=r.getRawIndex(c)}}else if(s==="single"||s===!0){var d=n[l-1],h=g1(r,d);o.selectedMap=(i={},i[h]=!0,i),this._selectedDataIndicesMap=(a={},a[h]=r.getRawIndex(d),a)}}},t.prototype._initSelectedMapFromData=function(r){if(!this.option.selectedMap){var n=[];r.hasItemOption&&r.each(function(i){var a=r.getRawDataItem(i);a&&a.selected&&n.push(i)}),n.length>0&&this._innerSelect(r,n)}},t.registerClass=function(r){return Er.registerClass(r)},t.protoInitialize=function(){var r=t.prototype;r.type="series.__base__",r.seriesIndex=0,r.ignoreStyleOnData=!1,r.hasSymbolVisual=!1,r.defaultSymbol="circle",r.visualStyleAccessPath="itemStyle",r.visualDrawType="fill"}(),t}(Er);_o($E,due);_o($E,j3);Bse($E,Er);function cX(e){var t=e.name;b3(e)||(e.name=NOt(e)||t)}function NOt(e){var t=e.getRawData(),r=t.mapDimensionsAll("seriesName"),n=[];return le(r,function(i){var a=t.getDimensionInfo(i);a.displayName&&n.push(a.displayName)}),n.join(" ")}function LOt(e){return e.model.getRawData().count()}function FOt(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),$Ot}function $Ot(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function hX(e,t){le(NSt(e.CHANGABLE_METHODS,e.DOWNSAMPLE_METHODS),function(r){e.wrapMethod(r,wr(HOt,t))})}function HOt(e,t){var r=QN(e);return r&&r.setOutputEnd((t||this).count()),t}function QN(e){var t=(e.ecModel||{}).scheduler,r=t&&t.getPipeline(e.uid);if(r){var n=r.currentTask;if(n){var i=n.agentStubMap;i&&(n=i.get(e.uid))}return n}}const Bu=$E;var K3=function(){function e(){this.group=new Zn,this.uid=RE("viewComponent")}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){},e.prototype.updateLayout=function(t,r,n,i){},e.prototype.updateVisual=function(t,r,n,i){},e.prototype.toggleBlurSeries=function(t,r,n){},e.prototype.eachRendered=function(t){var r=this.group;r&&r.traverse(t)},e}();S3(K3);mE(K3);const rs=K3;function X3(){var e=Jr();return function(t){var r=e(t),n=t.pipelineContext,i=!!r.large,a=!!r.progressiveRender,o=r.large=!!(n&&n.large),s=r.progressiveRender=!!(n&&n.progressiveRender);return(i!==o||a!==s)&&"reset"}}var Cue=Jr(),BOt=X3(),q3=function(){function e(){this.group=new Zn,this.uid=RE("viewChart"),this.renderTask=Um({plan:VOt,reset:jOt}),this.renderTask.context={view:this}}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.highlight=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&vX(a,i,"emphasis")},e.prototype.downplay=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&vX(a,i,"normal")},e.prototype.remove=function(t,r){this.group.removeAll()},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateLayout=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateVisual=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.eachRendered=function(t){TE(this.group,t)},e.markUpdateMethod=function(t,r){Cue(t).updateMethod=r},e.protoInitialize=function(){var t=e.prototype;t.type="chart"}(),e}();function dX(e,t,r){e&&UN(e)&&(t==="emphasis"?DT:NT)(e,r)}function vX(e,t,r){var n=Yc(e,t),i=t&&t.highlightKey!=null?XCt(t.highlightKey):null;n!=null?le(mi(n),function(a){dX(e.getItemGraphicEl(a),r,i)}):e.eachItemGraphicEl(function(a){dX(a,r,i)})}S3(q3);mE(q3);function VOt(e){return BOt(e.model)}function jOt(e){var t=e.model,r=e.ecModel,n=e.api,i=e.payload,a=t.pipelineContext.progressiveRender,o=e.view,s=i&&Cue(i).updateMethod,l=a?"incrementalPrepareRender":s&&o[s]?s:"render";return l!=="render"&&o[l](t,r,n,i),WOt[l]}var WOt={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}};const Qo=q3;var WT="\0__throttleOriginMethod",pX="\0__throttleRate",gX="\0__throttleType";function HE(e,t,r){var n,i=0,a=0,o=null,s,l,u,f;t=t||0;function c(){a=new Date().getTime(),o=null,e.apply(l,u||[])}var h=function(){for(var d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];n=new Date().getTime(),l=this,u=d;var p=f||t,g=f||r;f=null,s=n-(g?i:a)-p,clearTimeout(o),g?o=setTimeout(c,p):s>=0?c():o=setTimeout(c,-s),i=n};return h.clear=function(){o&&(clearTimeout(o),o=null)},h.debounceNextCall=function(d){f=d},h}function xue(e,t,r,n){var i=e[t];if(i){var a=i[WT]||i,o=i[gX],s=i[pX];if(s!==r||o!==n){if(r==null||!n)return e[t]=a;i=e[t]=HE(a,r,n==="debounce"),i[WT]=a,i[gX]=n,i[pX]=r}return i}}function eL(e,t){var r=e[t];r&&r[WT]&&(r.clear&&r.clear(),e[t]=r[WT])}var yX=Jr(),mX={itemStyle:vw(Nle,!0),lineStyle:vw(Dle,!0)},UOt={lineStyle:"stroke",itemStyle:"fill"};function Tue(e,t){var r=e.visualStyleMapper||mX[t];return r||(console.warn("Unknown style type '"+t+"'."),mX.itemStyle)}function Oue(e,t){var r=e.visualDrawType||UOt[t];return r||(console.warn("Unknown style type '"+t+"'."),"fill")}var zOt={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=e.getModel(n),a=Tue(e,n),o=a(i),s=i.getShallow("decal");s&&(r.setVisual("decal",s),s.dirty=!0);var l=Oue(e,n),u=o[l],f=gt(u)?u:null,c=o.fill==="auto"||o.stroke==="auto";if(!o[l]||f||c){var h=e.getColorFromPalette(e.name,null,t.getSeriesCount());o[l]||(o[l]=h,r.setVisual("colorFromPalette",!0)),o.fill=o.fill==="auto"||gt(o.fill)?h:o.fill,o.stroke=o.stroke==="auto"||gt(o.stroke)?h:o.stroke}if(r.setVisual("style",o),r.setVisual("drawType",l),!t.isSeriesFiltered(e)&&f)return r.setVisual("colorFromPalette",!1),{dataEach:function(d,v){var p=e.getDataParams(v),g=Ne({},o);g[l]=f(p),d.setItemVisual(v,"style",g)}}}},ky=new Gn,GOt={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!(e.ignoreStyleOnData||t.isSeriesFiltered(e))){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=Tue(e,n),a=r.getVisual("drawType");return{dataEach:r.hasItemOption?function(o,s){var l=o.getRawDataItem(s);if(l&&l[n]){ky.option=l[n];var u=i(ky),f=o.ensureUniqueItemVisual(s,"style");Ne(f,u),ky.option.decal&&(o.setItemVisual(s,"decal",ky.option.decal),ky.option.decal.dirty=!0),a in u&&o.setItemVisual(s,"colorFromPalette",!1)}}:null}}}},YOt={performRawSeries:!0,overallReset:function(e){var t=Bt();e.eachSeries(function(r){var n=r.getColorBy();if(!r.isColorBySeries()){var i=r.type+"-"+n,a=t.get(i);a||(a={},t.set(i,a)),yX(r).scope=a}}),e.eachSeries(function(r){if(!(r.isColorBySeries()||e.isSeriesFiltered(r))){var n=r.getRawData(),i={},a=r.getData(),o=yX(r).scope,s=r.visualStyleAccessPath||"itemStyle",l=Oue(r,s);a.each(function(u){var f=a.getRawIndex(u);i[f]=u}),n.each(function(u){var f=i[u],c=a.getItemVisual(f,"colorFromPalette");if(c){var h=a.ensureUniqueItemVisual(f,"style"),d=n.getName(u)||u+"",v=n.count();h[l]=r.getColorFromPalette(d,o,v)}})}})}},y1=Math.PI;function KOt(e,t){t=t||{},fr(t,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var r=new Zn,n=new Cn({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});r.add(n);var i=new Jn({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),a=new Cn({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});r.add(a);var o;return t.showSpinner&&(o=new R3({shape:{startAngle:-y1/2,endAngle:-y1/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001}),o.animateShape(!0).when(1e3,{endAngle:y1*3/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:y1*3/2}).delay(300).start("circularInOut"),r.add(o)),r.resize=function(){var s=i.getBoundingRect().width,l=t.showSpinner?t.spinnerRadius:0,u=(e.getWidth()-l*2-(t.showSpinner&&s?10:0)-s)/2-(t.showSpinner&&s?0:5+s/2)+(t.showSpinner?0:s/2)+(s?0:l),f=e.getHeight()/2;t.showSpinner&&o.setShape({cx:u,cy:f}),a.setShape({x:u-l,y:f-l,width:l*2,height:l*2}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},r.resize(),r}var XOt=function(){function e(t,r,n,i){this._stageTaskMap=Bt(),this.ecInstance=t,this.api=r,n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=n.concat(i)}return e.prototype.restoreData=function(t,r){t.restoreData(r),this._stageTaskMap.each(function(n){var i=n.overallTask;i&&i.dirty()})},e.prototype.getPerformArgs=function(t,r){if(t.__pipeline){var n=this._pipelineMap.get(t.__pipeline.id),i=n.context,a=!r&&n.progressiveEnabled&&(!i||i.progressiveRender)&&t.__idxInPipeline>n.blockIndex,o=a?n.step:null,s=i&&i.modDataCount,l=s!=null?Math.ceil(s/o):null;return{step:o,modBy:l,modDataCount:s}}},e.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},e.prototype.updateStreamModes=function(t,r){var n=this._pipelineMap.get(t.uid),i=t.getData(),a=i.count(),o=n.progressiveEnabled&&r.incrementalPrepareRender&&a>=n.threshold,s=t.get("large")&&a>=t.get("largeThreshold"),l=t.get("progressiveChunkMode")==="mod"?a:null;t.pipelineContext=n.context={progressiveRender:o,modDataCount:l,large:s}},e.prototype.restorePipelines=function(t){var r=this,n=r._pipelineMap=Bt();t.eachSeries(function(i){var a=i.getProgressive(),o=i.uid;n.set(o,{id:o,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:a&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(a||700),count:0}),r._pipe(i,i.dataTask)})},e.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,r=this.api.getModel(),n=this.api;le(this._allHandlers,function(i){var a=t.get(i.uid)||t.set(i.uid,{}),o="";gl(!(i.reset&&i.overallReset),o),i.reset&&this._createSeriesStageTask(i,a,r,n),i.overallReset&&this._createOverallStageTask(i,a,r,n)},this)},e.prototype.prepareView=function(t,r,n,i){var a=t.renderTask,o=a.context;o.model=r,o.ecModel=n,o.api=i,a.__block=!t.incrementalPrepareRender,this._pipe(r,a)},e.prototype.performDataProcessorTasks=function(t,r){this._performStageTasks(this._dataProcessorHandlers,t,r,{block:!0})},e.prototype.performVisualTasks=function(t,r,n){this._performStageTasks(this._visualHandlers,t,r,n)},e.prototype._performStageTasks=function(t,r,n,i){i=i||{};var a=!1,o=this;le(t,function(l,u){if(!(i.visualType&&i.visualType!==l.visualType)){var f=o._stageTaskMap.get(l.uid),c=f.seriesTaskMap,h=f.overallTask;if(h){var d,v=h.agentStubMap;v.each(function(g){s(i,g)&&(g.dirty(),d=!0)}),d&&h.dirty(),o.updatePayload(h,n);var p=o.getPerformArgs(h,i.block);v.each(function(g){g.perform(p)}),h.perform(p)&&(a=!0)}else c&&c.each(function(g,y){s(i,g)&&g.dirty();var m=o.getPerformArgs(g,i.block);m.skip=!l.performRawSeries&&r.isSeriesFiltered(g.context.model),o.updatePayload(g,n),g.perform(m)&&(a=!0)})}});function s(l,u){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(u.__pipeline.id))}this.unfinished=a||this.unfinished},e.prototype.performSeriesTasks=function(t){var r;t.eachSeries(function(n){r=n.dataTask.perform()||r}),this.unfinished=r||this.unfinished},e.prototype.plan=function(){this._pipelineMap.each(function(t){var r=t.tail;do{if(r.__block){t.blockIndex=r.__idxInPipeline;break}r=r.getUpstream()}while(r)})},e.prototype.updatePayload=function(t,r){r!=="remain"&&(t.context.payload=r)},e.prototype._createSeriesStageTask=function(t,r,n,i){var a=this,o=r.seriesTaskMap,s=r.seriesTaskMap=Bt(),l=t.seriesType,u=t.getTargetSeries;t.createOnAllSeries?n.eachRawSeries(f):l?n.eachRawSeriesByType(l,f):u&&u(n,i).each(f);function f(c){var h=c.uid,d=s.set(h,o&&o.get(h)||Um({plan:eEt,reset:tEt,count:nEt}));d.context={model:c,ecModel:n,api:i,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:a},a._pipe(c,d)}},e.prototype._createOverallStageTask=function(t,r,n,i){var a=this,o=r.overallTask=r.overallTask||Um({reset:qOt});o.context={ecModel:n,api:i,overallReset:t.overallReset,scheduler:a};var s=o.agentStubMap,l=o.agentStubMap=Bt(),u=t.seriesType,f=t.getTargetSeries,c=!0,h=!1,d="";gl(!t.createOnAllSeries,d),u?n.eachRawSeriesByType(u,v):f?f(n,i).each(v):(c=!1,le(n.getSeries(),v));function v(p){var g=p.uid,y=l.set(g,s&&s.get(g)||(h=!0,Um({reset:ZOt,onDirty:QOt})));y.context={model:p,overallProgress:c},y.agent=o,y.__block=c,a._pipe(p,y)}h&&o.dirty()},e.prototype._pipe=function(t,r){var n=t.uid,i=this._pipelineMap.get(n);!i.head&&(i.head=r),i.tail&&i.tail.pipe(r),i.tail=r,r.__idxInPipeline=i.count++,r.__pipeline=i},e.wrapStageHandler=function(t,r){return gt(t)&&(t={overallReset:t,seriesType:iEt(t)}),t.uid=RE("stageHandler"),r&&(t.visualType=r),t},e}();function qOt(e){e.overallReset(e.ecModel,e.api,e.payload)}function ZOt(e){return e.overallProgress&&JOt}function JOt(){this.agent.dirty(),this.getDownstream().dirty()}function QOt(){this.agent&&this.agent.dirty()}function eEt(e){return e.plan?e.plan(e.model,e.ecModel,e.api,e.payload):null}function tEt(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=mi(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?ct(t,function(r,n){return Eue(n)}):rEt}var rEt=Eue(0);function Eue(e){return function(t,r){var n=r.data,i=r.resetDefines[e];if(i&&i.dataEach)for(var a=t.start;a<t.end;a++)i.dataEach(n,a);else i&&i.progress&&i.progress(t,n)}}function nEt(e){return e.data.count()}function iEt(e){UT=null;try{e(Sw,Rue)}catch{}return UT}var Sw={},Rue={},UT;kue(Sw,nue);kue(Rue,iue);Sw.eachSeriesByType=Sw.eachRawSeriesByType=function(e){UT=e};Sw.eachComponent=function(e){e.mainType==="series"&&e.subType&&(UT=e.subType)};function kue(e,t){for(var r in t.prototype)e[r]=Li}const Aue=XOt;var bX=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const aEt={color:bX,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],bX]};var oi="#B9B8CE",wX="#100C2A",m1=function(){return{axisLine:{lineStyle:{color:oi}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},SX=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],Pue={darkMode:!0,color:SX,backgroundColor:wX,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:oi}},textStyle:{color:oi},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:oi}},dataZoom:{borderColor:"#71708A",textStyle:{color:oi},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:oi}},timeline:{lineStyle:{color:oi},label:{color:oi},controlStyle:{color:oi,borderColor:oi}},calendar:{itemStyle:{color:wX},dayLabel:{color:oi},monthLabel:{color:oi},yearLabel:{color:oi}},timeAxis:m1(),logAxis:m1(),valueAxis:m1(),categoryAxis:m1(),line:{symbol:"circle"},graph:{color:SX},gauge:{title:{color:oi},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:oi},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};Pue.categoryAxis.splitLine.show=!1;const oEt=Pue;var sEt=function(){function e(){}return e.prototype.normalizeQuery=function(t){var r={},n={},i={};if(st(t)){var a=qo(t);r.mainType=a.main||null,r.subType=a.sub||null}else{var o=["Index","Name","Id"],s={name:1,dataIndex:1,dataType:1};le(t,function(l,u){for(var f=!1,c=0;c<o.length;c++){var h=o[c],d=u.lastIndexOf(h);if(d>0&&d===u.length-h.length){var v=u.slice(0,d);v!=="data"&&(r.mainType=v,r[h.toLowerCase()]=l,f=!0)}}s.hasOwnProperty(u)&&(n[u]=l,f=!0),f||(i[u]=l)})}return{cptQuery:r,dataQuery:n,otherQuery:i}},e.prototype.filter=function(t,r){var n=this.eventInfo;if(!n)return!0;var i=n.targetEl,a=n.packedEvent,o=n.model,s=n.view;if(!o||!s)return!0;var l=r.cptQuery,u=r.dataQuery;return f(l,o,"mainType")&&f(l,o,"subType")&&f(l,o,"index","componentIndex")&&f(l,o,"name")&&f(l,o,"id")&&f(u,a,"name")&&f(u,a,"dataIndex")&&f(u,a,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,r.otherQuery,i,a));function f(c,h,d,v){return c[d]==null||h[v||d]===c[d]}},e.prototype.afterTrigger=function(){this.eventInfo=null},e}(),tL=["symbol","symbolSize","symbolRotate","symbolOffset"],_X=tL.concat(["symbolKeepAspect"]),lEt={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData();if(e.legendIcon&&r.setVisual("legendIcon",e.legendIcon),!e.hasSymbolVisual)return;for(var n={},i={},a=!1,o=0;o<tL.length;o++){var s=tL[o],l=e.get(s);gt(l)?(a=!0,i[s]=l):n[s]=l}if(n.symbol=n.symbol||e.defaultSymbol,r.setVisual(Ne({legendIcon:e.legendIcon||n.symbol,symbolKeepAspect:e.get("symbolKeepAspect")},n)),t.isSeriesFiltered(e))return;var u=Lr(i);function f(c,h){for(var d=e.getRawValue(h),v=e.getDataParams(h),p=0;p<u.length;p++){var g=u[p];c.setItemVisual(h,g,i[g](d,v))}}return{dataEach:a?f:null}}},uEt={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!e.hasSymbolVisual||t.isSeriesFiltered(e))return;var r=e.getData();function n(i,a){for(var o=i.getItemModel(a),s=0;s<_X.length;s++){var l=_X[s],u=o.getShallow(l,!0);u!=null&&i.setItemVisual(a,l,u)}}return{dataEach:r.hasItemOption?n:null}}};function fEt(e,t,r){switch(r){case"color":var n=e.getItemVisual(t,"style");return n[e.getVisual("drawType")];case"opacity":return e.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getItemVisual(t,r)}}function Iue(e,t){switch(t){case"color":var r=e.getVisual("style");return r[e.getVisual("drawType")];case"opacity":return e.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getVisual(t)}}function cEt(e,t){function r(n,i){var a=[];return n.eachComponent({mainType:"series",subType:e,query:i},function(o){a.push(o.seriesIndex)}),a}le([[e+"ToggleSelect","toggleSelect"],[e+"Select","select"],[e+"UnSelect","unselect"]],function(n){t(n[0],function(i,a,o){i=Ne({},i),o.dispatchAction(Ne(i,{type:n[1],seriesIndex:r(a,i)}))})})}function fd(e,t,r,n,i){var a=e+t;r.isSilent(a)||n.eachComponent({mainType:"series",subType:"pie"},function(o){for(var s=o.seriesIndex,l=o.option.selectedMap,u=i.selected,f=0;f<u.length;f++)if(u[f].seriesIndex===s){var c=o.getData(),h=Yc(c,i.fromActionPayload);r.trigger(a,{type:a,seriesId:o.id,name:Ze(h)?c.getName(h[0]):c.getName(h),selected:st(l)?l:Ne({},l)})}})}function hEt(e,t,r){e.on("selectchanged",function(n){var i=r.getModel();n.isFromClick?(fd("map","selectchanged",t,i,n),fd("pie","selectchanged",t,i,n)):n.fromAction==="select"?(fd("map","selected",t,i,n),fd("pie","selected",t,i,n)):n.fromAction==="unselect"&&(fd("map","unselected",t,i,n),fd("pie","unselected",t,i,n))})}function im(e,t,r){for(var n;e&&!(t(e)&&(n=e,r));)e=e.__hostTarget||e.parent;return n}var dEt=Math.round(Math.random()*9),vEt=typeof Object.defineProperty=="function",pEt=function(){function e(){this._id="__ec_inner_"+dEt++}return e.prototype.get=function(t){return this._guard(t)[this._id]},e.prototype.set=function(t,r){var n=this._guard(t);return vEt?Object.defineProperty(n,this._id,{value:r,enumerable:!1,configurable:!0}):n[this._id]=r,this},e.prototype.delete=function(t){return this.has(t)?(delete this._guard(t)[this._id],!0):!1},e.prototype.has=function(t){return!!this._guard(t)[this._id]},e.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},e}();const gEt=pEt;var yEt=hr.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n+a),e.lineTo(r-i,n+a),e.closePath()}}),mEt=hr.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n),e.lineTo(r,n+a),e.lineTo(r-i,n),e.closePath()}}),bEt=hr.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.x,n=t.y,i=t.width/5*3,a=Math.max(i,t.height),o=i/2,s=o*o/(a-o),l=n-a+o+s,u=Math.asin(s/o),f=Math.cos(u)*o,c=Math.sin(u),h=Math.cos(u),d=o*.6,v=o*.7;e.moveTo(r-f,l+s),e.arc(r,l,o,Math.PI-u,Math.PI*2+u),e.bezierCurveTo(r+f-c*d,l+s+h*d,r,n-v,r,n),e.bezierCurveTo(r,n-v,r-f+c*d,l+s+h*d,r-f,l+s),e.closePath()}}),wEt=hr.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.height,n=t.width,i=t.x,a=t.y,o=n/3*2;e.moveTo(i,a),e.lineTo(i+o,a+r),e.lineTo(i,a+r/4*3),e.lineTo(i-o,a+r),e.lineTo(i,a),e.closePath()}}),SEt={line:Kc,rect:Cn,roundRect:Cn,square:Cn,circle:E3,diamond:mEt,pin:bEt,arrow:wEt,triangle:yEt},_Et={line:function(e,t,r,n,i){i.x1=e,i.y1=t+n/2,i.x2=e+r,i.y2=t+n/2},rect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n},roundRect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n,i.r=Math.min(r,n)/4},square:function(e,t,r,n,i){var a=Math.min(r,n);i.x=e,i.y=t,i.width=a,i.height=a},circle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.r=Math.min(r,n)/2},diamond:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n},pin:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},arrow:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},triangle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n}},rL={};le(SEt,function(e,t){rL[t]=new e});var CEt=hr.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,r){var n=kT(e,t,r),i=this.shape;return i&&i.symbolType==="pin"&&t.position==="inside"&&(n.y=r.y+r.height*.4),n},buildPath:function(e,t,r){var n=t.symbolType;if(n!=="none"){var i=rL[n];i||(n="rect",i=rL[n]),_Et[n](t.x,t.y,t.width,t.height,i.shape),i.buildPath(e,i.shape,r)}}});function xEt(e,t){if(this.type!=="image"){var r=this.style;this.__isEmptyBrush?(r.stroke=e,r.fill=t||"#fff",r.lineWidth=2):this.shape.symbolType==="line"?r.stroke=e:r.fill=e,this.markRedraw()}}function yg(e,t,r,n,i,a,o){var s=e.indexOf("empty")===0;s&&(e=e.substr(5,1).toLowerCase()+e.substr(6));var l;return e.indexOf("image://")===0?l=kle(e.slice(8),new ur(t,r,n,i),o?"center":"cover"):e.indexOf("path://")===0?l=P3(e.slice(7),{},new ur(t,r,n,i),o?"center":"cover"):l=new CEt({shape:{symbolType:e,x:t,y:r,width:n,height:i}}),l.__isEmptyBrush=s,l.setColor=xEt,a&&l.setColor(a),l}function TEt(e){return Ze(e)||(e=[+e,+e]),[e[0]||0,e[1]||0]}function Mue(e,t){if(e!=null)return Ze(e)||(e=[e,e]),[xr(e[0],t[0])||0,xr(qt(e[1],e[0]),t[1])||0]}function mc(e){return isFinite(e)}function OEt(e,t,r){var n=t.x==null?0:t.x,i=t.x2==null?1:t.x2,a=t.y==null?0:t.y,o=t.y2==null?0:t.y2;t.global||(n=n*r.width+r.x,i=i*r.width+r.x,a=a*r.height+r.y,o=o*r.height+r.y),n=mc(n)?n:0,i=mc(i)?i:1,a=mc(a)?a:0,o=mc(o)?o:0;var s=e.createLinearGradient(n,a,i,o);return s}function EEt(e,t,r){var n=r.width,i=r.height,a=Math.min(n,i),o=t.x==null?.5:t.x,s=t.y==null?.5:t.y,l=t.r==null?.5:t.r;t.global||(o=o*n+r.x,s=s*i+r.y,l=l*a),o=mc(o)?o:.5,s=mc(s)?s:.5,l=l>=0&&mc(l)?l:.5;var u=e.createRadialGradient(o,s,0,o,s,l);return u}function nL(e,t,r){for(var n=t.type==="radial"?EEt(e,t,r):OEt(e,t,r),i=t.colorStops,a=0;a<i.length;a++)n.addColorStop(i[a].offset,i[a].color);return n}function REt(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!0;return!1}function b1(e){return parseInt(e,10)}function w1(e,t,r){var n=["width","height"][t],i=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(r[n]!=null&&r[n]!=="auto")return parseFloat(r[n]);var s=document.defaultView.getComputedStyle(e);return(e[i]||b1(s[n])||b1(e.style[n]))-(b1(s[a])||0)-(b1(s[o])||0)|0}function kEt(e,t){return!e||e==="solid"||!(t>0)?null:e==="dashed"?[4*t,2*t]:e==="dotted"?[t]:Sr(e)?[e]:Ze(e)?e:null}function Due(e){var t=e.style,r=t.lineDash&&t.lineWidth>0&&kEt(t.lineDash,t.lineWidth),n=t.lineDashOffset;if(r){var i=t.strokeNoScale&&e.getLineScale?e.getLineScale():1;i&&i!==1&&(r=ct(r,function(a){return a/i}),n/=i)}return[r,n]}var AEt=new $u(!0);function zT(e){var t=e.stroke;return!(t==null||t==="none"||!(e.lineWidth>0))}function CX(e){return typeof e=="string"&&e!=="none"}function GT(e){var t=e.fill;return t!=null&&t!=="none"}function xX(e,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=r}else e.fill()}function TX(e,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=r}else e.stroke()}function iL(e,t,r){var n=Vse(t.image,t.__image,r);if(bE(n)){var i=e.createPattern(n,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var a=new DOMMatrix;a.translateSelf(t.x||0,t.y||0),a.rotateSelf(0,0,(t.rotation||0)*LSt),a.scaleSelf(t.scaleX||1,t.scaleY||1),i.setTransform(a)}return i}}function PEt(e,t,r,n){var i,a=zT(r),o=GT(r),s=r.strokePercent,l=s<1,u=!t.path;(!t.silent||l)&&u&&t.createPathProxy();var f=t.path||AEt,c=t.__dirty;if(!n){var h=r.fill,d=r.stroke,v=o&&!!h.colorStops,p=a&&!!d.colorStops,g=o&&!!h.image,y=a&&!!d.image,m=void 0,b=void 0,S=void 0,x=void 0,T=void 0;(v||p)&&(T=t.getBoundingRect()),v&&(m=c?nL(e,h,T):t.__canvasFillGradient,t.__canvasFillGradient=m),p&&(b=c?nL(e,d,T):t.__canvasStrokeGradient,t.__canvasStrokeGradient=b),g&&(S=c||!t.__canvasFillPattern?iL(e,h,t):t.__canvasFillPattern,t.__canvasFillPattern=S),y&&(x=c||!t.__canvasStrokePattern?iL(e,d,t):t.__canvasStrokePattern,t.__canvasStrokePattern=S),v?e.fillStyle=m:g&&(S?e.fillStyle=S:o=!1),p?e.strokeStyle=b:y&&(x?e.strokeStyle=x:a=!1)}var E=t.getGlobalScale();f.setScale(E[0],E[1],t.segmentIgnoreThreshold);var P,R;e.setLineDash&&r.lineDash&&(i=Due(t),P=i[0],R=i[1]);var M=!0;(u||c&bd)&&(f.setDPR(e.dpr),l?f.setContext(null):(f.setContext(e),M=!1),f.reset(),t.buildPath(f,t.shape,n),f.toStatic(),t.pathUpdated()),M&&f.rebuildPath(e,l?s:1),P&&(e.setLineDash(P),e.lineDashOffset=R),n||(r.strokeFirst?(a&&TX(e,r),o&&xX(e,r)):(o&&xX(e,r),a&&TX(e,r))),P&&e.setLineDash([])}function IEt(e,t,r){var n=t.__image=Vse(r.image,t.__image,t,t.onload);if(!(!n||!bE(n))){var i=r.x||0,a=r.y||0,o=t.getWidth(),s=t.getHeight(),l=n.width/n.height;if(o==null&&s!=null?o=s*l:s==null&&o!=null?s=o/l:o==null&&s==null&&(o=n.width,s=n.height),r.sWidth&&r.sHeight){var u=r.sx||0,f=r.sy||0;e.drawImage(n,u,f,r.sWidth,r.sHeight,i,a,o,s)}else if(r.sx&&r.sy){var u=r.sx,f=r.sy,c=o-u,h=s-f;e.drawImage(n,u,f,c,h,i,a,o,s)}else e.drawImage(n,i,a,o,s)}}function MEt(e,t,r){var n,i=r.text;if(i!=null&&(i+=""),i){e.font=r.font||Gc,e.textAlign=r.textAlign,e.textBaseline=r.textBaseline;var a=void 0,o=void 0;e.setLineDash&&r.lineDash&&(n=Due(t),a=n[0],o=n[1]),a&&(e.setLineDash(a),e.lineDashOffset=o),r.strokeFirst?(zT(r)&&e.strokeText(i,r.x,r.y),GT(r)&&e.fillText(i,r.x,r.y)):(GT(r)&&e.fillText(i,r.x,r.y),zT(r)&&e.strokeText(i,r.x,r.y)),a&&e.setLineDash([])}}var OX=["shadowBlur","shadowOffsetX","shadowOffsetY"],EX=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function Nue(e,t,r,n,i){var a=!1;if(!n&&(r=r||{},t===r))return!1;if(n||t.opacity!==r.opacity){Di(e,i),a=!0;var o=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(o)?Tc.opacity:o}(n||t.blend!==r.blend)&&(a||(Di(e,i),a=!0),e.globalCompositeOperation=t.blend||Tc.blend);for(var s=0;s<OX.length;s++){var l=OX[s];(n||t[l]!==r[l])&&(a||(Di(e,i),a=!0),e[l]=e.dpr*(t[l]||0))}return(n||t.shadowColor!==r.shadowColor)&&(a||(Di(e,i),a=!0),e.shadowColor=t.shadowColor||Tc.shadowColor),a}function RX(e,t,r,n,i){var a=_w(t,i.inHover),o=n?null:r&&_w(r,i.inHover)||{};if(a===o)return!1;var s=Nue(e,a,o,n,i);if((n||a.fill!==o.fill)&&(s||(Di(e,i),s=!0),CX(a.fill)&&(e.fillStyle=a.fill)),(n||a.stroke!==o.stroke)&&(s||(Di(e,i),s=!0),CX(a.stroke)&&(e.strokeStyle=a.stroke)),(n||a.opacity!==o.opacity)&&(s||(Di(e,i),s=!0),e.globalAlpha=a.opacity==null?1:a.opacity),t.hasStroke()){var l=a.lineWidth,u=l/(a.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==u&&(s||(Di(e,i),s=!0),e.lineWidth=u)}for(var f=0;f<EX.length;f++){var c=EX[f],h=c[0];(n||a[h]!==o[h])&&(s||(Di(e,i),s=!0),e[h]=a[h]||c[1])}return s}function DEt(e,t,r,n,i){return Nue(e,_w(t,i.inHover),r&&_w(r,i.inHover),n,i)}function Lue(e,t){var r=t.transform,n=e.dpr||1;r?e.setTransform(n*r[0],n*r[1],n*r[2],n*r[3],n*r[4],n*r[5]):e.setTransform(n,0,0,n,0,0)}function NEt(e,t,r){for(var n=!1,i=0;i<e.length;i++){var a=e[i];n=n||a.isZeroArea(),Lue(t,a),t.beginPath(),a.buildPath(t,a.shape),t.clip()}r.allClipped=n}function LEt(e,t){return e&&t?e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]:!(!e&&!t)}var kX=1,AX=2,PX=3,IX=4;function FEt(e){var t=GT(e),r=zT(e);return!(e.lineDash||!(+t^+r)||t&&typeof e.fill!="string"||r&&typeof e.stroke!="string"||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}function Di(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function _w(e,t){return t&&e.__hoverStyle||e.style}function Fue(e,t){bc(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function bc(e,t,r,n){var i=t.transform;if(!t.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1)){t.__dirty&=~Ji,t.__isRendered=!1;return}var a=t.__clipPaths,o=r.prevElClipPaths,s=!1,l=!1;if((!o||REt(a,o))&&(o&&o.length&&(Di(e,r),e.restore(),l=s=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),a&&a.length&&(Di(e,r),e.save(),NEt(a,e,r),s=!0),r.prevElClipPaths=a),r.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var u=r.prevEl;u||(l=s=!0);var f=t instanceof hr&&t.autoBatch&&FEt(t.style);s||LEt(i,u.transform)?(Di(e,r),Lue(e,t)):f||Di(e,r);var c=_w(t,r.inHover);t instanceof hr?(r.lastDrawType!==kX&&(l=!0,r.lastDrawType=kX),RX(e,t,u,l,r),(!f||!r.batchFill&&!r.batchStroke)&&e.beginPath(),PEt(e,t,c,f),f&&(r.batchFill=c.fill||"",r.batchStroke=c.stroke||"")):t instanceof BN?(r.lastDrawType!==PX&&(l=!0,r.lastDrawType=PX),RX(e,t,u,l,r),MEt(e,t,c)):t instanceof mh?(r.lastDrawType!==AX&&(l=!0,r.lastDrawType=AX),DEt(e,t,u,l,r),IEt(e,t,c)):t.getTemporalDisplayables&&(r.lastDrawType!==IX&&(l=!0,r.lastDrawType=IX),$Et(e,t,r)),f&&n&&Di(e,r),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),r.prevEl=t,t.__dirty=0,t.__isRendered=!0}function $Et(e,t,r){var n=t.getDisplayables(),i=t.getTemporalDisplayables();e.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover},o,s;for(o=t.getCursor(),s=n.length;o<s;o++){var l=n[o];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),bc(e,l,a,o===s-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}for(var u=0,f=i.length;u<f;u++){var l=i[u];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),bc(e,l,a,u===f-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}var OP=new gEt,MX=new xS(100),DX=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function aL(e,t){if(e==="none")return null;var r=t.getDevicePixelRatio(),n=t.getZr(),i=n.painter.type==="svg";e.dirty&&OP.delete(e);var a=OP.get(e);if(a)return a;var o=fr(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});o.backgroundColor==="none"&&(o.backgroundColor=null);var s={repeat:"repeat"};return l(s),s.rotation=o.rotation,s.scaleX=s.scaleY=i?1:1/r,OP.set(e,s),e.dirty=!1,s;function l(u){for(var f=[r],c=!0,h=0;h<DX.length;++h){var d=o[DX[h]];if(d!=null&&!Ze(d)&&!st(d)&&!Sr(d)&&typeof d!="boolean"){c=!1;break}f.push(d)}var v;if(c){v=f.join(",")+(i?"-svg":"");var p=MX.get(v);p&&(i?u.svgElement=p:u.image=p)}var g=Hue(o.dashArrayX),y=HEt(o.dashArrayY),m=$ue(o.symbol),b=BEt(g),S=Bue(y),x=!i&&Lg.createCanvas(),T=i&&{tag:"g",attrs:{},key:"dcl",children:[]},E=R(),P;x&&(x.width=E.width*r,x.height=E.height*r,P=x.getContext("2d")),M(),c&&MX.put(v,x||T),u.image=x,u.svgElement=T,u.svgWidth=E.width,u.svgHeight=E.height;function R(){for(var D=1,N=0,B=b.length;N<B;++N)D=GY(D,b[N]);for(var K=1,N=0,B=m.length;N<B;++N)K=GY(K,m[N].length);D*=K;var Z=S*b.length*m.length;return{width:Math.max(1,Math.min(D,o.maxTileWidth)),height:Math.max(1,Math.min(Z,o.maxTileHeight))}}function M(){P&&(P.clearRect(0,0,x.width,x.height),o.backgroundColor&&(P.fillStyle=o.backgroundColor,P.fillRect(0,0,x.width,x.height)));for(var D=0,N=0;N<y.length;++N)D+=y[N];if(D<=0)return;for(var B=-S,K=0,Z=0,ie=0;B<E.height;){if(K%2===0){for(var me=Z/2%m.length,k=0,w=0,C=0;k<E.width*2;){for(var O=0,N=0;N<g[ie].length;++N)O+=g[ie][N];if(O<=0)break;if(w%2===0){var _=(1-o.symbolSize)*.5,A=k+g[ie][w]*_,I=B+y[K]*_,L=g[ie][w]*o.symbolSize,V=y[K]*o.symbolSize,Y=C/2%m[me].length;ae(A,I,L,V,m[me][Y])}k+=g[ie][w],++C,++w,w===g[ie].length&&(w=0)}++ie,ie===g.length&&(ie=0)}B+=y[K],++Z,++K,K===y.length&&(K=0)}function ae(re,te,ge,H,Ce){var oe=i?1:r,Oe=yg(Ce,re*oe,te*oe,ge*oe,H*oe,o.color,o.symbolKeepAspect);if(i){var Ee=n.painter.renderOneToVNode(Oe);Ee&&T.children.push(Ee)}else Fue(P,Oe)}}}}function $ue(e){if(!e||e.length===0)return[["rect"]];if(st(e))return[[e]];for(var t=!0,r=0;r<e.length;++r)if(!st(e[r])){t=!1;break}if(t)return $ue([e]);for(var n=[],r=0;r<e.length;++r)st(e[r])?n.push([e[r]]):n.push(e[r]);return n}function Hue(e){if(!e||e.length===0)return[[0,0]];if(Sr(e)){var t=Math.ceil(e);return[[t,t]]}for(var r=!0,n=0;n<e.length;++n)if(!Sr(e[n])){r=!1;break}if(r)return Hue([e]);for(var i=[],n=0;n<e.length;++n)if(Sr(e[n])){var t=Math.ceil(e[n]);i.push([t,t])}else{var t=ct(e[n],function(s){return Math.ceil(s)});t.length%2===1?i.push(t.concat(t)):i.push(t)}return i}function HEt(e){if(!e||typeof e=="object"&&e.length===0)return[0,0];if(Sr(e)){var t=Math.ceil(e);return[t,t]}var r=ct(e,function(n){return Math.ceil(n)});return e.length%2?r.concat(r):r}function BEt(e){return ct(e,function(t){return Bue(t)})}function Bue(e){for(var t=0,r=0;r<e.length;++r)t+=e[r];return e.length%2===1?t*2:t}function VEt(e,t){e.eachRawSeries(function(r){if(!e.isSeriesFiltered(r)){var n=r.getData();n.hasItemVisual()&&n.each(function(o){var s=n.getItemVisual(o,"decal");if(s){var l=n.ensureUniqueItemVisual(o,"style");l.decal=aL(s,t)}});var i=n.getVisual("decal");if(i){var a=n.getVisual("style");a.decal=aL(i,t)}}})}var jEt=new cs;const Qa=jEt;var Vue={};function WEt(e,t){Vue[e]=t}function UEt(e){return Vue[e]}var zEt=1,GEt=800,YEt=900,KEt=1e3,XEt=2e3,qEt=5e3,jue=1e3,ZEt=1100,Z3=2e3,Wue=3e3,JEt=4e3,BE=4500,QEt=4600,eRt=5e3,tRt=6e3,Uue=7e3,rRt={PROCESSOR:{FILTER:KEt,SERIES_FILTER:GEt,STATISTIC:qEt},VISUAL:{LAYOUT:jue,PROGRESSIVE_LAYOUT:ZEt,GLOBAL:Z3,CHART:Wue,POST_CHART_LAYOUT:QEt,COMPONENT:JEt,BRUSH:eRt,CHART_ITEM:BE,ARIA:tRt,DECAL:Uue}},$n="__flagInMainProcess",Oi="__pendingUpdate",EP="__needsUpdateStatus",NX=/^[a-zA-Z0-9_]+$/,RP="__connectUpdateStatus",LX=0,nRt=1,iRt=2;function zue(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.isDisposed()){this.id;return}return Yue(this,e,t)}}function Gue(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Yue(this,e,t)}}function Yue(e,t,r){return r[0]=r[0]&&r[0].toLowerCase(),cs.prototype[t].apply(e,r)}var Kue=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(cs),Xue=Kue.prototype;Xue.on=Gue("on");Xue.off=Gue("off");var cd,kP,S1,Bl,AP,PP,IP,Ay,Py,FX,$X,MP,HX,_1,BX,que,ha,VX,Zue=function(e){je(t,e);function t(r,n,i){var a=e.call(this,new sEt)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],i=i||{},st(n)&&(n=Jue[n]),a._dom=r;var o="canvas",s="auto",l=!1,u=a._zr=UY(r,{renderer:i.renderer||o,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:qt(i.useDirtyRect,l),useCoarsePointer:qt(i.useCoarsePointer,s),pointerSize:i.pointerSize});a._ssr=i.ssr,a._throttledZrFlush=HE(kr(u.flush,u),17),n=Xt(n),n&&oue(n,!0),a._theme=n,a._locale=cTt(i.locale||Fle),a._coordSysMgr=new W3;var f=a._api=BX(a);function c(h,d){return h.__prio-d.__prio}return kC(KT,c),kC(oL,c),a._scheduler=new Aue(a,f,oL,KT),a._messageCenter=new Kue,a._initEvents(),a.resize=kr(a.resize,a),u.animation.on("frame",a._onframe,a),FX(u,a),$X(u,a),mN(a),a}return t.prototype._onframe=function(){if(!this._disposed){VX(this);var r=this._scheduler;if(this[Oi]){var n=this[Oi].silent;this[$n]=!0;try{cd(this),Bl.update.call(this,null,this[Oi].updateParams)}catch(l){throw this[$n]=!1,this[Oi]=null,l}this._zr.flush(),this[$n]=!1,this[Oi]=null,Ay.call(this,n),Py.call(this,n)}else if(r.unfinished){var i=zEt,a=this._model,o=this._api;r.unfinished=!1;do{var s=+new Date;r.performSeriesTasks(a),r.performDataProcessorTasks(a),PP(this,a),r.performVisualTasks(a),_1(this,this._model,o,"remain",{}),i-=+new Date-s}while(i>0&&r.unfinished);r.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(r,n,i){if(!this[$n]){if(this._disposed){this.id;return}var a,o,s;if(vt(n)&&(i=n.lazyUpdate,a=n.silent,o=n.replaceMerge,s=n.transition,n=n.notMerge),this[$n]=!0,!this._model||n){var l=new zTt(this._api),u=this._theme,f=this._model=new nue;f.scheduler=this._scheduler,f.ssr=this._ssr,f.init(null,null,null,u,this._locale,l)}this._model.setOption(r,{replaceMerge:o},sL);var c={seriesTransition:s,optionChanged:!0};if(i)this[Oi]={silent:a,updateParams:c},this[$n]=!1,this.getZr().wakeUp();else{try{cd(this),Bl.update.call(this,null,c)}catch(h){throw this[Oi]=null,this[$n]=!1,h}this._ssr||this._zr.flush(),this[Oi]=null,this[$n]=!1,Ay.call(this,a),Py.call(this,a)}}},t.prototype.setTheme=function(){},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||Ht.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(r){return this.renderToCanvas(r)},t.prototype.renderToCanvas=function(r){r=r||{};var n=this._zr.painter;return n.getRenderedCanvas({backgroundColor:r.backgroundColor||this._model.get("backgroundColor"),pixelRatio:r.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(r){r=r||{};var n=this._zr.painter;return n.renderToString({useViewBox:r.useViewBox})},t.prototype.getSvgDataURL=function(){if(Ht.svgSupported){var r=this._zr,n=r.storage.getDisplayList();return le(n,function(i){i.stopAnimation(null,!0)}),r.painter.toDataURL()}},t.prototype.getDataURL=function(r){if(this._disposed){this.id;return}r=r||{};var n=r.excludeComponents,i=this._model,a=[],o=this;le(n,function(l){i.eachComponent({mainType:l},function(u){var f=o._componentsMap[u.__viewId];f.group.ignore||(a.push(f),f.group.ignore=!0)})});var s=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(r).toDataURL("image/"+(r&&r.type||"png"));return le(a,function(l){l.group.ignore=!1}),s},t.prototype.getConnectedDataURL=function(r){if(this._disposed){this.id;return}var n=r.type==="svg",i=this.group,a=Math.min,o=Math.max,s=1/0;if(jX[i]){var l=s,u=s,f=-s,c=-s,h=[],d=r&&r.pixelRatio||this.getDevicePixelRatio();le(Gm,function(b,S){if(b.group===i){var x=n?b.getZr().painter.getSvgDom().innerHTML:b.renderToCanvas(Xt(r)),T=b.getDom().getBoundingClientRect();l=a(T.left,l),u=a(T.top,u),f=o(T.right,f),c=o(T.bottom,c),h.push({dom:x,left:T.left,top:T.top})}}),l*=d,u*=d,f*=d,c*=d;var v=f-l,p=c-u,g=Lg.createCanvas(),y=UY(g,{renderer:n?"svg":"canvas"});if(y.resize({width:v,height:p}),n){var m="";return le(h,function(b){var S=b.left-l,x=b.top-u;m+='<g transform="translate('+S+","+x+')">'+b.dom+"</g>"}),y.painter.getSvgRoot().innerHTML=m,r.connectedBackgroundColor&&y.painter.setBackgroundColor(r.connectedBackgroundColor),y.refreshImmediately(),y.painter.toDataURL()}else return r.connectedBackgroundColor&&y.add(new Cn({shape:{x:0,y:0,width:v,height:p},style:{fill:r.connectedBackgroundColor}})),le(h,function(b){var S=new mh({style:{x:b.left*d-l,y:b.top*d-u,image:b.dom}});y.add(S)}),y.refreshImmediately(),g.toDataURL("image/"+(r&&r.type||"png"))}else return this.getDataURL(r)},t.prototype.convertToPixel=function(r,n){return AP(this,"convertToPixel",r,n)},t.prototype.convertFromPixel=function(r,n){return AP(this,"convertFromPixel",r,n)},t.prototype.containPixel=function(r,n){if(this._disposed){this.id;return}var i=this._model,a,o=QA(i,r);return le(o,function(s,l){l.indexOf("Models")>=0&&le(s,function(u){var f=u.coordinateSystem;if(f&&f.containPoint)a=a||!!f.containPoint(n);else if(l==="seriesModels"){var c=this._chartsMap[u.__viewId];c&&c.containPoint&&(a=a||c.containPoint(n,u))}},this)},this),!!a},t.prototype.getVisual=function(r,n){var i=this._model,a=QA(i,r,{defaultMainType:"series"}),o=a.seriesModel,s=o.getData(),l=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?s.indexOfRawIndex(a.dataIndex):null;return l!=null?fEt(s,l,n):Iue(s,n)},t.prototype.getViewOfComponentModel=function(r){return this._componentsMap[r.__viewId]},t.prototype.getViewOfSeriesModel=function(r){return this._chartsMap[r.__viewId]},t.prototype._initEvents=function(){var r=this;le(aRt,function(n){var i=function(a){var o=r.getModel(),s=a.target,l,u=n==="globalout";if(u?l={}:s&&im(s,function(v){var p=or(v);if(p&&p.dataIndex!=null){var g=p.dataModel||o.getSeriesByIndex(p.seriesIndex);return l=g&&g.getDataParams(p.dataIndex,p.dataType)||{},!0}else if(p.eventData)return l=Ne({},p.eventData),!0},!0),l){var f=l.componentType,c=l.componentIndex;(f==="markLine"||f==="markPoint"||f==="markArea")&&(f="series",c=l.seriesIndex);var h=f&&c!=null&&o.getComponent(f,c),d=h&&r[h.mainType==="series"?"_chartsMap":"_componentsMap"][h.__viewId];l.event=a,l.type=n,r._$eventProcessor.eventInfo={targetEl:s,packedEvent:l,model:h,view:d},r.trigger(n,l)}};i.zrEventfulCallAtLast=!0,r._zr.on(n,i,r)}),le(zm,function(n,i){r._messageCenter.on(i,function(a){this.trigger(i,a)},r)}),le(["selectchanged"],function(n){r._messageCenter.on(n,function(i){this.trigger(n,i)},r)}),hEt(this._messageCenter,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var r=this.getDom();r&&$se(this.getDom(),Q3,"");var n=this,i=n._api,a=n._model;le(n._componentsViews,function(o){o.dispose(a,i)}),le(n._chartsViews,function(o){o.dispose(a,i)}),n._zr.dispose(),n._dom=n._model=n._chartsMap=n._componentsMap=n._chartsViews=n._componentsViews=n._scheduler=n._api=n._zr=n._throttledZrFlush=n._theme=n._coordSysMgr=n._messageCenter=null,delete Gm[n.id]},t.prototype.resize=function(r){if(!this[$n]){if(this._disposed){this.id;return}this._zr.resize(r);var n=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!n){var i=n.resetOption("media"),a=r&&r.silent;this[Oi]&&(a==null&&(a=this[Oi].silent),i=!0,this[Oi]=null),this[$n]=!0;try{i&&cd(this),Bl.update.call(this,{type:"resize",animation:Ne({duration:0},r&&r.animation)})}catch(o){throw this[$n]=!1,o}this[$n]=!1,Ay.call(this,a),Py.call(this,a)}}},t.prototype.showLoading=function(r,n){if(this._disposed){this.id;return}if(vt(r)&&(n=r,r=""),r=r||"default",this.hideLoading(),!!lL[r]){var i=lL[r](this._api,n),a=this._zr;this._loadingFX=i,a.add(i)}},t.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},t.prototype.makeActionFromEvent=function(r){var n=Ne({},r);return n.type=zm[r.type],n},t.prototype.dispatchAction=function(r,n){if(this._disposed){this.id;return}if(vt(n)||(n={silent:!!n}),!!YT[r.type]&&this._model){if(this[$n]){this._pendingActions.push(r);return}var i=n.silent;IP.call(this,r,i);var a=n.flush;a?this._zr.flush():a!==!1&&Ht.browser.weChat&&this._throttledZrFlush(),Ay.call(this,i),Py.call(this,i)}},t.prototype.updateLabelLayout=function(){Qa.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(r){if(this._disposed){this.id;return}var n=r.seriesIndex,i=this.getModel(),a=i.getSeriesByIndex(n);a.appendData(r),this._scheduler.unfinished=!0,this.getZr().wakeUp()},t.internalField=function(){cd=function(c){var h=c._scheduler;h.restorePipelines(c._model),h.prepareStageTasks(),kP(c,!0),kP(c,!1),h.plan()},kP=function(c,h){for(var d=c._model,v=c._scheduler,p=h?c._componentsViews:c._chartsViews,g=h?c._componentsMap:c._chartsMap,y=c._zr,m=c._api,b=0;b<p.length;b++)p[b].__alive=!1;h?d.eachComponent(function(T,E){T!=="series"&&S(E)}):d.eachSeries(S);function S(T){var E=T.__requireNewView;T.__requireNewView=!1;var P="_ec_"+T.id+"_"+T.type,R=!E&&g[P];if(!R){var M=qo(T.type),D=h?rs.getClass(M.main,M.sub):Qo.getClass(M.sub);R=new D,R.init(d,m),g[P]=R,p.push(R),y.add(R.group)}T.__viewId=R.__id=P,R.__alive=!0,R.__model=T,R.group.__ecComponentInfo={mainType:T.mainType,index:T.componentIndex},!h&&v.prepareView(R,T,d,m)}for(var b=0;b<p.length;){var x=p[b];x.__alive?b++:(!h&&x.renderTask.dispose(),y.remove(x.group),x.dispose(d,m),p.splice(b,1),g[x.__id]===x&&delete g[x.__id],x.__id=x.group.__ecComponentInfo=null)}},S1=function(c,h,d,v,p){var g=c._model;if(g.setUpdatePayload(d),!v){le([].concat(c._componentsViews).concat(c._chartsViews),x);return}var y={};y[v+"Id"]=d[v+"Id"],y[v+"Index"]=d[v+"Index"],y[v+"Name"]=d[v+"Name"];var m={mainType:v,query:y};p&&(m.subType=p);var b=d.excludeSeriesId,S;b!=null&&(S=Bt(),le(mi(b),function(T){var E=Jo(T,null);E!=null&&S.set(E,!0)})),g&&g.eachComponent(m,function(T){var E=S&&S.get(T.id)!=null;if(!E)if(SK(d))if(T instanceof Bu)d.type===Oc&&!d.notBlur&&!T.get(["emphasis","disabled"])&&VCt(T,d,c._api);else{var P=O3(T.mainType,T.componentIndex,d.name,c._api),R=P.focusSelf,M=P.dispatchers;d.type===Oc&&R&&!d.notBlur&&jN(T.mainType,T.componentIndex,c._api),M&&le(M,function(D){d.type===Oc?DT(D):NT(D)})}else zN(d)&&T instanceof Bu&&(UCt(T,d,c._api),bK(T),ha(c))},c),g&&g.eachComponent(m,function(T){var E=S&&S.get(T.id)!=null;E||x(c[v==="series"?"_chartsMap":"_componentsMap"][T.__viewId])},c);function x(T){T&&T.__alive&&T[h]&&T[h](T.__model,g,c._api,d)}},Bl={prepareAndUpdate:function(c){cd(this),Bl.update.call(this,c,{optionChanged:c.newOption!=null})},update:function(c,h){var d=this._model,v=this._api,p=this._zr,g=this._coordSysMgr,y=this._scheduler;if(d){d.setUpdatePayload(c),y.restoreData(d,c),y.performSeriesTasks(d),g.create(d,v),y.performDataProcessorTasks(d,c),PP(this,d),g.update(d,v),r(d),y.performVisualTasks(d,c),MP(this,d,v,c,h);var m=d.get("backgroundColor")||"transparent",b=d.get("darkMode");p.setBackgroundColor(m),b!=null&&b!=="auto"&&p.setDarkMode(b),Qa.trigger("afterupdate",d,v)}},updateTransform:function(c){var h=this,d=this._model,v=this._api;if(d){d.setUpdatePayload(c);var p=[];d.eachComponent(function(y,m){if(y!=="series"){var b=h.getViewOfComponentModel(m);if(b&&b.__alive)if(b.updateTransform){var S=b.updateTransform(m,d,v,c);S&&S.update&&p.push(b)}else p.push(b)}});var g=Bt();d.eachSeries(function(y){var m=h._chartsMap[y.__viewId];if(m.updateTransform){var b=m.updateTransform(y,d,v,c);b&&b.update&&g.set(y.uid,1)}else g.set(y.uid,1)}),r(d),this._scheduler.performVisualTasks(d,c,{setDirty:!0,dirtyMap:g}),_1(this,d,v,c,{},g),Qa.trigger("afterupdate",d,v)}},updateView:function(c){var h=this._model;h&&(h.setUpdatePayload(c),Qo.markUpdateMethod(c,"updateView"),r(h),this._scheduler.performVisualTasks(h,c,{setDirty:!0}),MP(this,h,this._api,c,{}),Qa.trigger("afterupdate",h,this._api))},updateVisual:function(c){var h=this,d=this._model;d&&(d.setUpdatePayload(c),d.eachSeries(function(v){v.getData().clearAllVisual()}),Qo.markUpdateMethod(c,"updateVisual"),r(d),this._scheduler.performVisualTasks(d,c,{visualType:"visual",setDirty:!0}),d.eachComponent(function(v,p){if(v!=="series"){var g=h.getViewOfComponentModel(p);g&&g.__alive&&g.updateVisual(p,d,h._api,c)}}),d.eachSeries(function(v){var p=h._chartsMap[v.__viewId];p.updateVisual(v,d,h._api,c)}),Qa.trigger("afterupdate",d,this._api))},updateLayout:function(c){Bl.update.call(this,c)}},AP=function(c,h,d,v){if(c._disposed){c.id;return}for(var p=c._model,g=c._coordSysMgr.getCoordinateSystems(),y,m=QA(p,d),b=0;b<g.length;b++){var S=g[b];if(S[h]&&(y=S[h](p,m,v))!=null)return y}},PP=function(c,h){var d=c._chartsMap,v=c._scheduler;h.eachSeries(function(p){v.updateStreamModes(p,d[p.__viewId])})},IP=function(c,h){var d=this,v=this.getModel(),p=c.type,g=c.escapeConnect,y=YT[p],m=y.actionInfo,b=(m.update||"update").split(":"),S=b.pop(),x=b[0]!=null&&qo(b[0]);this[$n]=!0;var T=[c],E=!1;c.batch&&(E=!0,T=ct(c.batch,function(K){return K=fr(Ne({},K),c),K.batch=null,K}));var P=[],R,M=zN(c),D=SK(c);if(D&&sle(this._api),le(T,function(K){if(R=y.action(K,d._model,d._api),R=R||Ne({},K),R.type=m.event||R.type,P.push(R),D){var Z=w3(c),ie=Z.queryOptionMap,me=Z.mainTypeSpecified,k=me?ie.keys()[0]:"series";S1(d,S,K,k),ha(d)}else M?(S1(d,S,K,"series"),ha(d)):x&&S1(d,S,K,x.main,x.sub)}),S!=="none"&&!D&&!M&&!x)try{this[Oi]?(cd(this),Bl.update.call(this,c),this[Oi]=null):Bl[S].call(this,c)}catch(K){throw this[$n]=!1,K}if(E?R={type:m.event||p,escapeConnect:g,batch:P}:R=P[0],this[$n]=!1,!h){var N=this._messageCenter;if(N.trigger(R.type,R),M){var B={type:"selectchanged",escapeConnect:g,selected:zCt(v),isFromClick:c.isFromClick||!1,fromAction:c.type,fromActionPayload:c};N.trigger(B.type,B)}}},Ay=function(c){for(var h=this._pendingActions;h.length;){var d=h.shift();IP.call(this,d,c)}},Py=function(c){!c&&this.trigger("updated")},FX=function(c,h){c.on("rendered",function(d){h.trigger("rendered",d),c.animation.isFinished()&&!h[Oi]&&!h._scheduler.unfinished&&!h._pendingActions.length&&h.trigger("finished")})},$X=function(c,h){c.on("mouseover",function(d){var v=d.target,p=im(v,UN);p&&(jCt(p,d,h._api),ha(h))}).on("mouseout",function(d){var v=d.target,p=im(v,UN);p&&(WCt(p,d,h._api),ha(h))}).on("click",function(d){var v=d.target,p=im(v,function(m){return or(m).dataIndex!=null},!0);if(p){var g=p.selected?"unselect":"select",y=or(p);h._api.dispatchAction({type:g,dataType:y.dataType,dataIndexInside:y.dataIndex,seriesIndex:y.seriesIndex,isFromClick:!0})}})};function r(c){c.clearColorPalette(),c.eachSeries(function(h){h.clearColorPalette()})}function n(c){var h=[],d=[],v=!1;if(c.eachComponent(function(m,b){var S=b.get("zlevel")||0,x=b.get("z")||0,T=b.getZLevelKey();v=v||!!T,(m==="series"?d:h).push({zlevel:S,z:x,idx:b.componentIndex,type:m,key:T})}),v){var p=h.concat(d),g,y;kC(p,function(m,b){return m.zlevel===b.zlevel?m.z-b.z:m.zlevel-b.zlevel}),le(p,function(m){var b=c.getComponent(m.type,m.idx),S=m.zlevel,x=m.key;g!=null&&(S=Math.max(g,S)),x?(S===g&&x!==y&&S++,y=x):y&&(S===g&&S++,y=""),g=S,b.setZLevel(S)})}}MP=function(c,h,d,v,p){n(h),HX(c,h,d,v,p),le(c._chartsViews,function(g){g.__alive=!1}),_1(c,h,d,v,p),le(c._chartsViews,function(g){g.__alive||g.remove(h,d)})},HX=function(c,h,d,v,p,g){le(g||c._componentsViews,function(y){var m=y.__model;u(m,y),y.render(m,h,d,v),s(m,y),f(m,y)})},_1=function(c,h,d,v,p,g){var y=c._scheduler;p=Ne(p||{},{updatedSeries:h.getSeries()}),Qa.trigger("series:beforeupdate",h,d,p);var m=!1;h.eachSeries(function(b){var S=c._chartsMap[b.__viewId];S.__alive=!0;var x=S.renderTask;y.updatePayload(x,v),u(b,S),g&&g.get(b.uid)&&x.dirty(),x.perform(y.getPerformArgs(x))&&(m=!0),S.group.silent=!!b.get("silent"),o(b,S),bK(b)}),y.unfinished=m||y.unfinished,Qa.trigger("series:layoutlabels",h,d,p),Qa.trigger("series:transition",h,d,p),h.eachSeries(function(b){var S=c._chartsMap[b.__viewId];s(b,S),f(b,S)}),a(c,h),Qa.trigger("series:afterupdate",h,d,p)},ha=function(c){c[EP]=!0,c.getZr().wakeUp()},VX=function(c){c[EP]&&(c.getZr().storage.traverse(function(h){Vm(h)||i(h)}),c[EP]=!1)};function i(c){for(var h=[],d=c.currentStates,v=0;v<d.length;v++){var p=d[v];p==="emphasis"||p==="blur"||p==="select"||h.push(p)}c.selected&&c.states.select&&h.push("select"),c.hoverState===_E&&c.states.emphasis?h.push("emphasis"):c.hoverState===SE&&c.states.blur&&h.push("blur"),c.useStates(h)}function a(c,h){var d=c._zr,v=d.storage,p=0;v.traverse(function(g){g.isGroup||p++}),p>h.get("hoverLayerThreshold")&&!Ht.node&&!Ht.worker&&h.eachSeries(function(g){if(!g.preventUsingHoverLayer){var y=c._chartsMap[g.__viewId];y.__alive&&y.eachRendered(function(m){m.states.emphasis&&(m.states.emphasis.hoverLayer=!0)})}})}function o(c,h){var d=c.get("blendMode")||null;h.eachRendered(function(v){v.isGroup||(v.style.blend=d)})}function s(c,h){if(!c.preventAutoZ){var d=c.get("z")||0,v=c.get("zlevel")||0;h.eachRendered(function(p){return l(p,d,v,-1/0),!0})}}function l(c,h,d,v){var p=c.getTextContent(),g=c.getTextGuideLine(),y=c.isGroup;if(y)for(var m=c.childrenRef(),b=0;b<m.length;b++)v=Math.max(l(m[b],h,d,v),v);else c.z=h,c.zlevel=d,v=Math.max(c.z2,v);if(p&&(p.z=h,p.zlevel=d,isFinite(v)&&(p.z2=v+2)),g){var S=c.textGuideLineConfig;g.z=h,g.zlevel=d,isFinite(v)&&(g.z2=v+(S&&S.showAbove?1:-1))}return v}function u(c,h){h.eachRendered(function(d){if(!Vm(d)){var v=d.getTextContent(),p=d.getTextGuideLine();d.stateTransition&&(d.stateTransition=null),v&&v.stateTransition&&(v.stateTransition=null),p&&p.stateTransition&&(p.stateTransition=null),d.hasState()?(d.prevStates=d.currentStates,d.clearStates()):d.prevStates&&(d.prevStates=null)}})}function f(c,h){var d=c.getModel("stateAnimation"),v=c.isAnimationEnabled(),p=d.get("duration"),g=p>0?{duration:p,delay:d.get("delay"),easing:d.get("easing")}:null;h.eachRendered(function(y){if(y.states&&y.states.emphasis){if(Vm(y))return;if(y instanceof hr&&qCt(y),y.__dirty){var m=y.prevStates;m&&y.useStates(m)}if(v){y.stateTransition=g;var b=y.getTextContent(),S=y.getTextGuideLine();b&&(b.stateTransition=g),S&&(S.stateTransition=g)}y.__dirty&&i(y)}})}BX=function(c){return new(function(h){je(d,h);function d(){return h!==null&&h.apply(this,arguments)||this}return d.prototype.getCoordinateSystems=function(){return c._coordSysMgr.getCoordinateSystems()},d.prototype.getComponentByElement=function(v){for(;v;){var p=v.__ecComponentInfo;if(p!=null)return c._model.getComponent(p.mainType,p.index);v=v.parent}},d.prototype.enterEmphasis=function(v,p){DT(v,p),ha(c)},d.prototype.leaveEmphasis=function(v,p){NT(v,p),ha(c)},d.prototype.enterBlur=function(v){nle(v),ha(c)},d.prototype.leaveBlur=function(v){T3(v),ha(c)},d.prototype.enterSelect=function(v){ile(v),ha(c)},d.prototype.leaveSelect=function(v){ale(v),ha(c)},d.prototype.getModel=function(){return c.getModel()},d.prototype.getViewOfComponentModel=function(v){return c.getViewOfComponentModel(v)},d.prototype.getViewOfSeriesModel=function(v){return c.getViewOfSeriesModel(v)},d}(iue))(c)},que=function(c){function h(d,v){for(var p=0;p<d.length;p++){var g=d[p];g[RP]=v}}le(zm,function(d,v){c._messageCenter.on(v,function(p){if(jX[c.group]&&c[RP]!==LX){if(p&&p.escapeConnect)return;var g=c.makeActionFromEvent(p),y=[];le(Gm,function(m){m!==c&&m.group===c.group&&y.push(m)}),h(y,LX),le(y,function(m){m[RP]!==nRt&&m.dispatchAction(g)}),h(y,iRt)}})})}}(),t}(cs),J3=Zue.prototype;J3.on=zue("on");J3.off=zue("off");J3.one=function(e,t,r){var n=this;function i(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];t&&t.apply&&t.apply(this,a),n.off(e,i)}this.on.call(this,e,i,r)};var aRt=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var YT={},zm={},oL=[],sL=[],KT=[],Jue={},lL={},Gm={},jX={},oRt=+new Date-0,Q3="_echarts_instance_";function sRt(e,t,r){var n=!(r&&r.ssr);if(n){var i=lRt(e);if(i)return i}var a=new Zue(e,t,r);return a.id="ec_"+oRt++,Gm[a.id]=a,n&&$se(e,Q3,a.id),que(a),Qa.trigger("afterinit",a),a}function lRt(e){return Gm[E1t(e,Q3)]}function e4(e,t){Jue[e]=t}function Que(e){ar(sL,e)<0&&sL.push(e)}function efe(e,t){r4(oL,e,t,XEt)}function uRt(e){t4("afterinit",e)}function fRt(e){t4("afterupdate",e)}function t4(e,t){Qa.on(e,t)}function Bg(e,t,r){gt(t)&&(r=t,t="");var n=vt(e)?e.type:[e,e={event:t}][0];e.event=(e.event||n).toLowerCase(),t=e.event,!zm[t]&&(gl(NX.test(n)&&NX.test(t)),YT[n]||(YT[n]={action:r,actionInfo:e}),zm[t]=n)}function cRt(e,t){W3.register(e,t)}function hRt(e,t){r4(KT,e,t,jue,"layout")}function Sh(e,t){r4(KT,e,t,Wue,"visual")}var WX=[];function r4(e,t,r,n,i){if((gt(t)||vt(t))&&(r=t,t=n),!(ar(WX,r)>=0)){WX.push(r);var a=Aue.wrapStageHandler(r,i);a.__prio=t,a.__raw=r,e.push(a)}}function tfe(e,t){lL[e]=t}function dRt(e,t,r){var n=UEt("registerMap");n&&n(e,t,r)}var vRt=gOt;Sh(Z3,zOt);Sh(BE,GOt);Sh(BE,YOt);Sh(Z3,lEt);Sh(BE,uEt);Sh(Uue,VEt);Que(oue);efe(YEt,QTt);tfe("default",KOt);Bg({type:Oc,event:Oc,update:Oc},Li);Bg({type:LC,event:LC,update:LC},Li);Bg({type:$m,event:$m,update:$m},Li);Bg({type:FC,event:FC,update:FC},Li);Bg({type:Hm,event:Hm,update:Hm},Li);e4("light",aEt);e4("dark",oEt);function Iy(e){return e==null?0:e.length||1}function UX(e){return e}var pRt=function(){function e(t,r,n,i,a,o){this._old=t,this._new=r,this._oldKeyGetter=n||UX,this._newKeyGetter=i||UX,this.context=a,this._diffModeMultiple=o==="multiple"}return e.prototype.add=function(t){return this._add=t,this},e.prototype.update=function(t){return this._update=t,this},e.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},e.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},e.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},e.prototype.remove=function(t){return this._remove=t,this},e.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},e.prototype._executeOneToOne=function(){var t=this._old,r=this._new,n={},i=new Array(t.length),a=new Array(r.length);this._initIndexMap(t,null,i,"_oldKeyGetter"),this._initIndexMap(r,n,a,"_newKeyGetter");for(var o=0;o<t.length;o++){var s=i[o],l=n[s],u=Iy(l);if(u>1){var f=l.shift();l.length===1&&(n[s]=l[0]),this._update&&this._update(f,o)}else u===1?(n[s]=null,this._update&&this._update(l,o)):this._remove&&this._remove(o)}this._performRestAdd(a,n)},e.prototype._executeMultiple=function(){var t=this._old,r=this._new,n={},i={},a=[],o=[];this._initIndexMap(t,n,a,"_oldKeyGetter"),this._initIndexMap(r,i,o,"_newKeyGetter");for(var s=0;s<a.length;s++){var l=a[s],u=n[l],f=i[l],c=Iy(u),h=Iy(f);if(c>1&&h===1)this._updateManyToOne&&this._updateManyToOne(f,u),i[l]=null;else if(c===1&&h>1)this._updateOneToMany&&this._updateOneToMany(f,u),i[l]=null;else if(c===1&&h===1)this._update&&this._update(f,u),i[l]=null;else if(c>1&&h>1)this._updateManyToMany&&this._updateManyToMany(f,u),i[l]=null;else if(c>1)for(var d=0;d<c;d++)this._remove&&this._remove(u[d]);else this._remove&&this._remove(u)}this._performRestAdd(o,i)},e.prototype._performRestAdd=function(t,r){for(var n=0;n<t.length;n++){var i=t[n],a=r[i],o=Iy(a);if(o>1)for(var s=0;s<o;s++)this._add&&this._add(a[s]);else o===1&&this._add&&this._add(a);r[i]=null}},e.prototype._initIndexMap=function(t,r,n,i){for(var a=this._diffModeMultiple,o=0;o<t.length;o++){var s="_ec_"+this[i](t[o],o);if(a||(n[o]=s),!!r){var l=r[s],u=Iy(l);u===0?(r[s]=o,a&&n.push(s)):u===1?r[s]=[l,o]:l.push(o)}}},e}();const gRt=pRt;var yRt=function(){function e(t,r){this._encode=t,this._schema=r}return e.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},e.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},e}();function mRt(e,t){var r={},n=r.encode={},i=Bt(),a=[],o=[],s={};le(e.dimensions,function(h){var d=e.getDimensionInfo(h),v=d.coordDim;if(v){var p=d.coordDimIndex;DP(n,v)[p]=h,d.isExtraCoord||(i.set(v,1),wRt(d.type)&&(a[0]=h),DP(s,v)[p]=e.getDimensionIndex(d.name)),d.defaultTooltip&&o.push(h)}Zle.each(function(g,y){var m=DP(n,y),b=d.otherDims[y];b!=null&&b!==!1&&(m[b]=d.name)})});var l=[],u={};i.each(function(h,d){var v=n[d];u[d]=v[0],l=l.concat(v)}),r.dataDimsOnCoord=l,r.dataDimIndicesOnCoord=ct(l,function(h){return e.getDimensionInfo(h).storeDimIndex}),r.encodeFirstDimNotExtra=u;var f=n.label;f&&f.length&&(a=f.slice());var c=n.tooltip;return c&&c.length?o=c.slice():o.length||(o=a.slice()),n.defaultedLabel=a,n.defaultedTooltip=o,r.userOutput=new yRt(s,t),r}function DP(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}function bRt(e){return e==="category"?"ordinal":e==="time"?"time":"float"}function wRt(e){return!(e==="ordinal"||e==="time")}var SRt=function(){function e(t){this.otherDims={},t!=null&&Ne(this,t)}return e}();const BC=SRt;var _Rt=Jr(),CRt={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},rfe=function(){function e(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return e.prototype.isDimensionOmitted=function(){return this._dimOmitted},e.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=afe(this.source)))},e.prototype.getSourceDimensionIndex=function(t){return qt(this._dimNameMap.get(t),-1)},e.prototype.getSourceDimension=function(t){var r=this.source.dimensionsDefine;if(r)return r[t]},e.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,r=lue(this.source),n=!ofe(t),i="",a=[],o=0,s=0;o<t;o++){var l=void 0,u=void 0,f=void 0,c=this.dimensions[s];if(c&&c.storeDimIndex===o)l=r?c.name:null,u=c.type,f=c.ordinalMeta,s++;else{var h=this.getSourceDimension(o);h&&(l=r?h.name:null,u=h.type)}a.push({property:l,type:u,ordinalMeta:f}),r&&l!=null&&(!c||!c.isCalculationCoord)&&(i+=n?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),i+="$",i+=CRt[u]||"f",f&&(i+=f.uid),i+="$"}var d=this.source,v=[d.seriesLayoutBy,d.startIndex,i].join("$$");return{dimensions:a,hash:v}},e.prototype.makeOutputDimensionNames=function(){for(var t=[],r=0,n=0;r<this._fullDimCount;r++){var i=void 0,a=this.dimensions[n];if(a&&a.storeDimIndex===r)a.isCalculationCoord||(i=a.name),n++;else{var o=this.getSourceDimension(r);o&&(i=o.name)}t.push(i)}return t},e.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},e}();function nfe(e){return e instanceof rfe}function ife(e){for(var t=Bt(),r=0;r<(e||[]).length;r++){var n=e[r],i=vt(n)?n.name:n;i!=null&&t.get(i)==null&&t.set(i,r)}return t}function afe(e){var t=_Rt(e);return t.dimNameMap||(t.dimNameMap=ife(e.dimensionsDefine))}function ofe(e){return e>30}var My=vt,Vl=ct,xRt=typeof Int32Array>"u"?Array:Int32Array,TRt="e\0\0",zX=-1,ORt=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],ERt=["_approximateExtent"],GX,C1,Dy,Ny,NP,x1,LP,RRt=function(){function e(t,r){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var n,i=!1;nfe(t)?(n=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(i=!0,n=t),n=n||["x","y"];for(var a={},o=[],s={},l=!1,u={},f=0;f<n.length;f++){var c=n[f],h=st(c)?new BC({name:c}):c instanceof BC?c:new BC(c),d=h.name;h.type=h.type||"float",h.coordDim||(h.coordDim=d,h.coordDimIndex=0);var v=h.otherDims=h.otherDims||{};o.push(d),a[d]=h,u[d]!=null&&(l=!0),h.createInvertedIndices&&(s[d]=[]),v.itemName===0&&(this._nameDimIdx=f),v.itemId===0&&(this._idDimIdx=f),i&&(h.storeDimIndex=f)}if(this.dimensions=o,this._dimInfos=a,this._initGetDimensionInfo(l),this.hostModel=r,this._invertedIndicesMap=s,this._dimOmitted){var p=this._dimIdxToName=Bt();le(o,function(g){p.set(a[g].storeDimIndex,g)})}}return e.prototype.getDimension=function(t){var r=this._recognizeDimIndex(t);if(r==null)return t;if(r=t,!this._dimOmitted)return this.dimensions[r];var n=this._dimIdxToName.get(r);if(n!=null)return n;var i=this._schema.getSourceDimension(r);if(i)return i.name},e.prototype.getDimensionIndex=function(t){var r=this._recognizeDimIndex(t);if(r!=null)return r;if(t==null)return-1;var n=this._getDimInfo(t);return n?n.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},e.prototype._recognizeDimIndex=function(t){if(Sr(t)||t!=null&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},e.prototype._getStoreDimIndex=function(t){var r=this.getDimensionIndex(t);return r},e.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},e.prototype._initGetDimensionInfo=function(t){var r=this._dimInfos;this._getDimInfo=t?function(n){return r.hasOwnProperty(n)?r[n]:void 0}:function(n){return r[n]}},e.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},e.prototype.mapDimension=function(t,r){var n=this._dimSummary;if(r==null)return n.encodeFirstDimNotExtra[t];var i=n.encode[t];return i?i[r]:null},e.prototype.mapDimensionsAll=function(t){var r=this._dimSummary,n=r.encode[t];return(n||[]).slice()},e.prototype.getStore=function(){return this._store},e.prototype.initData=function(t,r,n){var i=this,a;if(t instanceof qN&&(a=t),!a){var o=this.dimensions,s=U3(t)||Fi(t)?new uue(t,o.length):t;a=new qN;var l=Vl(o,function(u){return{type:i._dimInfos[u].type,property:u}});a.initData(s,l,n)}this._store=a,this._nameList=(r||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,a.count()),this._dimSummary=mRt(this,this._schema),this.userOutput=this._dimSummary.userOutput},e.prototype.appendData=function(t){var r=this._store.appendData(t);this._doInit(r[0],r[1])},e.prototype.appendValues=function(t,r){var n=this._store.appendValues(t,r.length),i=n.start,a=n.end,o=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),r)for(var s=i;s<a;s++){var l=s-i;this._nameList[s]=r[l],o&&LP(this,s)}},e.prototype._updateOrdinalMeta=function(){for(var t=this._store,r=this.dimensions,n=0;n<r.length;n++){var i=this._dimInfos[r[n]];i.ordinalMeta&&t.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},e.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return this._idDimIdx==null&&t.getSource().sourceFormat!==Eu&&!t.fillStorage},e.prototype._doInit=function(t,r){if(!(t>=r)){var n=this._store,i=n.getProvider();this._updateOrdinalMeta();var a=this._nameList,o=this._idList,s=i.getSource().sourceFormat,l=s===Va;if(l&&!i.pure)for(var u=[],f=t;f<r;f++){var c=i.getItem(f,u);if(!this.hasItemOption&&g1t(c)&&(this.hasItemOption=!0),c){var h=c.name;a[f]==null&&h!=null&&(a[f]=Jo(h,null));var d=c.id;o[f]==null&&d!=null&&(o[f]=Jo(d,null))}}if(this._shouldMakeIdFromName())for(var f=t;f<r;f++)LP(this,f);GX(this)}},e.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.setApproximateExtent=function(t,r){r=this.getDimension(r),this._approximateExtent[r]=t.slice()},e.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},e.prototype.setCalculationInfo=function(t,r){My(t)?Ne(this._calculationInfo,t):this._calculationInfo[t]=r},e.prototype.getName=function(t){var r=this.getRawIndex(t),n=this._nameList[r];return n==null&&this._nameDimIdx!=null&&(n=Dy(this,this._nameDimIdx,r)),n==null&&(n=""),n},e.prototype._getCategory=function(t,r){var n=this._store.get(t,r),i=this._store.getOrdinalMeta(t);return i?i.categories[n]:n},e.prototype.getId=function(t){return C1(this,this.getRawIndex(t))},e.prototype.count=function(){return this._store.count()},e.prototype.get=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.get(i.storeDimIndex,r)},e.prototype.getByRawIndex=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.getByRawIndex(i.storeDimIndex,r)},e.prototype.getIndices=function(){return this._store.getIndices()},e.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},e.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},e.prototype.getValues=function(t,r){var n=this,i=this._store;return Ze(t)?i.getValues(Vl(t,function(a){return n._getStoreDimIndex(a)}),r):i.getValues(t)},e.prototype.hasValue=function(t){for(var r=this._dimSummary.dataDimIndicesOnCoord,n=0,i=r.length;n<i;n++)if(isNaN(this._store.get(r[n],t)))return!1;return!0},e.prototype.indexOfName=function(t){for(var r=0,n=this._store.count();r<n;r++)if(this.getName(r)===t)return r;return-1},e.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},e.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},e.prototype.rawIndexOf=function(t,r){var n=t&&this._invertedIndicesMap[t],i=n[r];return i==null||isNaN(i)?zX:i},e.prototype.indicesOfNearest=function(t,r,n){return this._store.indicesOfNearest(this._getStoreDimIndex(t),r,n)},e.prototype.each=function(t,r,n){gt(t)&&(n=r,r=t,t=[]);var i=n||this,a=Vl(Ny(t),this._getStoreDimIndex,this);this._store.each(a,i?kr(r,i):r)},e.prototype.filterSelf=function(t,r,n){gt(t)&&(n=r,r=t,t=[]);var i=n||this,a=Vl(Ny(t),this._getStoreDimIndex,this);return this._store=this._store.filter(a,i?kr(r,i):r),this},e.prototype.selectRange=function(t){var r=this,n={},i=Lr(t);return le(i,function(a){var o=r._getStoreDimIndex(a);n[o]=t[a]}),this._store=this._store.selectRange(n),this},e.prototype.mapArray=function(t,r,n){gt(t)&&(n=r,r=t,t=[]),n=n||this;var i=[];return this.each(t,function(){i.push(r&&r.apply(this,arguments))},n),i},e.prototype.map=function(t,r,n,i){var a=n||i||this,o=Vl(Ny(t),this._getStoreDimIndex,this),s=x1(this);return s._store=this._store.map(o,a?kr(r,a):r),s},e.prototype.modify=function(t,r,n,i){var a=n||i||this,o=Vl(Ny(t),this._getStoreDimIndex,this);this._store.modify(o,a?kr(r,a):r)},e.prototype.downSample=function(t,r,n,i){var a=x1(this);return a._store=this._store.downSample(this._getStoreDimIndex(t),r,n,i),a},e.prototype.lttbDownSample=function(t,r){var n=x1(this);return n._store=this._store.lttbDownSample(this._getStoreDimIndex(t),r),n},e.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},e.prototype.getItemModel=function(t){var r=this.hostModel,n=this.getRawDataItem(t);return new Gn(n,r,r&&r.ecModel)},e.prototype.diff=function(t){var r=this;return new gRt(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(n){return C1(t,n)},function(n){return C1(r,n)})},e.prototype.getVisual=function(t){var r=this._visual;return r&&r[t]},e.prototype.setVisual=function(t,r){this._visual=this._visual||{},My(t)?Ne(this._visual,t):this._visual[t]=r},e.prototype.getItemVisual=function(t,r){var n=this._itemVisuals[t],i=n&&n[r];return i??this.getVisual(r)},e.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},e.prototype.ensureUniqueItemVisual=function(t,r){var n=this._itemVisuals,i=n[t];i||(i=n[t]={});var a=i[r];return a==null&&(a=this.getVisual(r),Ze(a)?a=a.slice():My(a)&&(a=Ne({},a)),i[r]=a),a},e.prototype.setItemVisual=function(t,r,n){var i=this._itemVisuals[t]||{};this._itemVisuals[t]=i,My(r)?Ne(i,r):i[r]=n},e.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},e.prototype.setLayout=function(t,r){My(t)?Ne(this._layout,t):this._layout[t]=r},e.prototype.getLayout=function(t){return this._layout[t]},e.prototype.getItemLayout=function(t){return this._itemLayouts[t]},e.prototype.setItemLayout=function(t,r,n){this._itemLayouts[t]=n?Ne(this._itemLayouts[t]||{},r):r},e.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},e.prototype.setItemGraphicEl=function(t,r){var n=this.hostModel&&this.hostModel.seriesIndex;PCt(n,this.dataType,t,r),this._graphicEls[t]=r},e.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},e.prototype.eachItemGraphicEl=function(t,r){le(this._graphicEls,function(n,i){n&&t&&t.call(r,n,i)})},e.prototype.cloneShallow=function(t){return t||(t=new e(this._schema?this._schema:Vl(this.dimensions,this._getDimInfo,this),this.hostModel)),NP(t,this),t._store=this._store,t},e.prototype.wrapMethod=function(t,r){var n=this[t];gt(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var i=n.apply(this,arguments);return r.apply(this,[i].concat(l3(arguments)))})},e.internalField=function(){GX=function(t){var r=t._invertedIndicesMap;le(r,function(n,i){var a=t._dimInfos[i],o=a.ordinalMeta,s=t._store;if(o){n=r[i]=new xRt(o.categories.length);for(var l=0;l<n.length;l++)n[l]=zX;for(var l=0;l<s.count();l++)n[s.get(a.storeDimIndex,l)]=l}})},Dy=function(t,r,n){return Jo(t._getCategory(r,n),null)},C1=function(t,r){var n=t._idList[r];return n==null&&t._idDimIdx!=null&&(n=Dy(t,t._idDimIdx,r)),n==null&&(n=TRt+r),n},Ny=function(t){return Ze(t)||(t=t!=null?[t]:[]),t},x1=function(t){var r=new e(t._schema?t._schema:Vl(t.dimensions,t._getDimInfo,t),t.hostModel);return NP(r,t),r},NP=function(t,r){le(ORt.concat(r.__wrappedMethods||[]),function(n){r.hasOwnProperty(n)&&(t[n]=r[n])}),t.__wrappedMethods=r.__wrappedMethods,le(ERt,function(n){t[n]=Xt(r[n])}),t._calculationInfo=Ne({},r._calculationInfo)},LP=function(t,r){var n=t._nameList,i=t._idList,a=t._nameDimIdx,o=t._idDimIdx,s=n[r],l=i[r];if(s==null&&a!=null&&(n[r]=s=Dy(t,a,r)),l==null&&o!=null&&(i[r]=l=Dy(t,o,r)),l==null&&s!=null){var u=t._nameRepeatCount,f=u[s]=(u[s]||0)+1;l=s,f>1&&(l+="__ec__"+f),i[r]=l}}}(),e}();const n4=RRt;function sfe(e,t){U3(e)||(e=z3(e)),t=t||{};var r=t.coordDimensions||[],n=t.dimensionsDefine||e.dimensionsDefine||[],i=Bt(),a=[],o=ARt(e,r,n,t.dimensionsCount),s=t.canOmitUnusedDimensions&&ofe(o),l=n===e.dimensionsDefine,u=l?afe(e):ife(n),f=t.encodeDefine;!f&&t.encodeDefaulter&&(f=t.encodeDefaulter(e,o));for(var c=Bt(f),h=new pue(o),d=0;d<h.length;d++)h[d]=-1;function v(R){var M=h[R];if(M<0){var D=n[R],N=vt(D)?D:{name:D},B=new BC,K=N.name;K!=null&&u.get(K)!=null&&(B.name=B.displayName=K),N.type!=null&&(B.type=N.type),N.displayName!=null&&(B.displayName=N.displayName);var Z=a.length;return h[R]=Z,B.storeDimIndex=R,a.push(B),B}return a[M]}if(!s)for(var d=0;d<o;d++)v(d);c.each(function(R,M){var D=mi(R).slice();if(D.length===1&&!st(D[0])&&D[0]<0){c.set(M,!1);return}var N=c.set(M,[]);le(D,function(B,K){var Z=st(B)?u.get(B):B;Z!=null&&Z<o&&(N[K]=Z,g(v(Z),M,K))})});var p=0;le(r,function(R){var M,D,N,B;if(st(R))M=R,B={};else{B=R,M=B.name;var K=B.ordinalMeta;B.ordinalMeta=null,B=Ne({},B),B.ordinalMeta=K,D=B.dimsDef,N=B.otherDims,B.name=B.coordDim=B.coordDimIndex=B.dimsDef=B.otherDims=null}var Z=c.get(M);if(Z!==!1){if(Z=mi(Z),!Z.length)for(var ie=0;ie<(D&&D.length||1);ie++){for(;p<o&&v(p).coordDim!=null;)p++;p<o&&Z.push(p++)}le(Z,function(me,k){var w=v(me);if(l&&B.type!=null&&(w.type=B.type),g(fr(w,B),M,k),w.name==null&&D){var C=D[k];!vt(C)&&(C={name:C}),w.name=w.displayName=C.name,w.defaultTooltip=C.defaultTooltip}N&&fr(w.otherDims,N)})}});function g(R,M,D){Zle.get(M)!=null?R.otherDims[M]=D:(R.coordDim=M,R.coordDimIndex=D,i.set(M,!0))}var y=t.generateCoord,m=t.generateCoordCount,b=m!=null;m=y?m||1:0;var S=y||"value";function x(R){R.name==null&&(R.name=R.coordDim)}if(s)le(a,function(R){x(R)}),a.sort(function(R,M){return R.storeDimIndex-M.storeDimIndex});else for(var T=0;T<o;T++){var E=v(T),P=E.coordDim;P==null&&(E.coordDim=PRt(S,i,b),E.coordDimIndex=0,(!y||m<=0)&&(E.isExtraCoord=!0),m--),x(E),E.type==null&&(eue(e,T)===An.Must||E.isExtraCoord&&(E.otherDims.itemName!=null||E.otherDims.seriesName!=null))&&(E.type="ordinal")}return kRt(a),new rfe({source:e,dimensions:a,fullDimensionCount:o,dimensionOmitted:s})}function kRt(e){for(var t=Bt(),r=0;r<e.length;r++){var n=e[r],i=n.name,a=t.get(i)||0;a>0&&(n.name=i+(a-1)),a++,t.set(i,a)}}function ARt(e,t,r,n){var i=Math.max(e.dimensionsDetectedCount||1,t.length,r.length,n||0);return le(t,function(a){var o;vt(a)&&(o=a.dimsDef)&&(i=Math.max(i,o.length))}),i}function PRt(e,t,r){if(r||t.hasKey(e)){for(var n=0;t.hasKey(e+n);)n++;e+=n}return t.set(e,!0),e}var IRt=function(){function e(t){this.coordSysDims=[],this.axisMap=Bt(),this.categoryAxisMap=Bt(),this.coordSysName=t}return e}();function MRt(e){var t=e.get("coordinateSystem"),r=new IRt(t),n=DRt[t];if(n)return n(e,r,r.axisMap,r.categoryAxisMap),r}var DRt={cartesian2d:function(e,t,r,n){var i=e.getReferringComponents("xAxis",fo).models[0],a=e.getReferringComponents("yAxis",fo).models[0];t.coordSysDims=["x","y"],r.set("x",i),r.set("y",a),hd(i)&&(n.set("x",i),t.firstCategoryDimIndex=0),hd(a)&&(n.set("y",a),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},singleAxis:function(e,t,r,n){var i=e.getReferringComponents("singleAxis",fo).models[0];t.coordSysDims=["single"],r.set("single",i),hd(i)&&(n.set("single",i),t.firstCategoryDimIndex=0)},polar:function(e,t,r,n){var i=e.getReferringComponents("polar",fo).models[0],a=i.findAxisModel("radiusAxis"),o=i.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],r.set("radius",a),r.set("angle",o),hd(a)&&(n.set("radius",a),t.firstCategoryDimIndex=0),hd(o)&&(n.set("angle",o),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},geo:function(e,t,r,n){t.coordSysDims=["lng","lat"]},parallel:function(e,t,r,n){var i=e.ecModel,a=i.getComponent("parallel",e.get("parallelIndex")),o=t.coordSysDims=a.dimensions.slice();le(a.parallelAxisIndex,function(s,l){var u=i.getComponent("parallelAxis",s),f=o[l];r.set(f,u),hd(u)&&(n.set(f,u),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=l))})}};function hd(e){return e.get("type")==="category"}function NRt(e,t,r){r=r||{};var n=r.byIndex,i=r.stackedCoordDimension,a,o,s;LRt(t)?a=t:(o=t.schema,a=o.dimensions,s=t.store);var l=!!(e&&e.get("stack")),u,f,c,h;if(le(a,function(m,b){st(m)&&(a[b]=m={name:m}),l&&!m.isExtraCoord&&(!n&&!u&&m.ordinalMeta&&(u=m),!f&&m.type!=="ordinal"&&m.type!=="time"&&(!i||i===m.coordDim)&&(f=m))}),f&&!n&&!u&&(n=!0),f){c="__\0ecstackresult_"+e.id,h="__\0ecstackedover_"+e.id,u&&(u.createInvertedIndices=!0);var d=f.coordDim,v=f.type,p=0;le(a,function(m){m.coordDim===d&&p++});var g={name:c,coordDim:d,coordDimIndex:p,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length},y={name:h,coordDim:h,coordDimIndex:p+1,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length+1};o?(s&&(g.storeDimIndex=s.ensureCalculationDimension(h,v),y.storeDimIndex=s.ensureCalculationDimension(c,v)),o.appendCalculationDimension(g),o.appendCalculationDimension(y)):(a.push(g),a.push(y))}return{stackedDimension:f&&f.name,stackedByDimension:u&&u.name,isStackedByIndex:n,stackedOverDimension:h,stackResultDimension:c}}function LRt(e){return!nfe(e.schema)}function Zc(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function FRt(e,t){return Zc(e,t)?e.getCalculationInfo("stackResultDimension"):t}function $Rt(e,t){var r=e.get("coordinateSystem"),n=W3.get(r),i;return t&&t.coordSysDims&&(i=ct(t.coordSysDims,function(a){var o={name:a},s=t.axisMap.get(a);if(s){var l=s.get("type");o.type=bRt(l)}return o})),i||(i=n&&(n.getDimensionsInfo?n.getDimensionsInfo():n.dimensions.slice())||["x","y"]),i}function HRt(e,t,r){var n,i;return r&&le(e,function(a,o){var s=a.coordDim,l=r.categoryAxisMap.get(s);l&&(n==null&&(n=o),a.ordinalMeta=l.getOrdinalMeta(),t&&(a.createInvertedIndices=!0)),a.otherDims.itemName!=null&&(i=!0)}),!i&&n!=null&&(e[n].otherDims.itemName=0),n}function i4(e,t,r){r=r||{};var n=t.getSourceManager(),i,a=!1;e?(a=!0,i=z3(e)):(i=n.getSource(),a=i.sourceFormat===Va);var o=MRt(t),s=$Rt(t,o),l=r.useEncodeDefaulter,u=gt(l)?l:l?wr(TTt,s,t):null,f={coordDimensions:s,generateCoord:r.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!a},c=sfe(i,f),h=HRt(c.dimensions,r.createInvertedIndices,o),d=a?null:n.getSharedDataStore(c),v=NRt(t,{schema:c,store:d}),p=new n4(c,t);p.setCalculationInfo(v);var g=h!=null&&BRt(i)?function(y,m,b,S){return S===h?b:this.defaultDimValueGetter(y,m,b,S)}:null;return p.hasItemOption=!1,p.initData(a?i:d,null,g),p}function BRt(e){if(e.sourceFormat===Va){var t=VRt(e.data||[]);return!Ze(TS(t))}}function VRt(e){for(var t=0;t<e.length&&e[t]==null;)t++;return e[t]}var lfe=function(){function e(t){this._setting=t||{},this._extent=[1/0,-1/0]}return e.prototype.getSetting=function(t){return this._setting[t]},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1])},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.setExtent=function(t,r){var n=this._extent;isNaN(t)||(n[0]=t),isNaN(r)||(n[1]=r)},e.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},e.prototype.isBlank=function(){return this._isBlank},e.prototype.setBlank=function(t){this._isBlank=t},e}();mE(lfe);const Ol=lfe;var jRt=0,WRt=function(){function e(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++jRt}return e.createByAxisModel=function(t){var r=t.option,n=r.data,i=n&&ct(n,URt);return new e({categories:i,needCollect:!i,deduplication:r.dedplication!==!1})},e.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},e.prototype.parseAndCollect=function(t){var r,n=this._needCollect;if(!st(t)&&!n)return t;if(n&&!this._deduplication)return r=this.categories.length,this.categories[r]=t,r;var i=this._getOrCreateMap();return r=i.get(t),r==null&&(n?(r=this.categories.length,this.categories[r]=t,i.set(t,r)):r=NaN),r},e.prototype._getOrCreateMap=function(){return this._map||(this._map=Bt(this.categories))},e}();function URt(e){return vt(e)&&e.value!=null?e.value:e+""}const uL=WRt;function fL(e){return e.type==="interval"||e.type==="log"}function zRt(e,t,r,n){var i={},a=e[1]-e[0],o=i.interval=Mse(a/t,!0);r!=null&&o<r&&(o=i.interval=r),n!=null&&o>n&&(o=i.interval=n);var s=i.intervalPrecision=ufe(o),l=i.niceTickExtent=[vn(Math.ceil(e[0]/o)*o,s),vn(Math.floor(e[1]/o)*o,s)];return GRt(l,e),i}function FP(e){var t=Math.pow(10,m3(e)),r=e/t;return r?r===2?r=3:r===3?r=5:r*=2:r=1,vn(r*t)}function ufe(e){return Xo(e)+2}function YX(e,t,r){e[t]=Math.max(Math.min(e[t],r[1]),r[0])}function GRt(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),YX(e,0,t),YX(e,1,t),e[0]>e[1]&&(e[0]=e[1])}function VE(e,t){return e>=t[0]&&e<=t[1]}function jE(e,t){return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])}function WE(e,t){return e*(t[1]-t[0])+t[0]}var ffe=function(e){je(t,e);function t(r){var n=e.call(this,r)||this;n.type="ordinal";var i=n.getSetting("ordinalMeta");return i||(i=new uL({})),Ze(i)&&(i=new uL({categories:ct(i,function(a){return vt(a)?a.value:a})})),n._ordinalMeta=i,n._extent=n.getSetting("extent")||[0,i.categories.length-1],n}return t.prototype.parse=function(r){return r==null?NaN:st(r)?this._ordinalMeta.getOrdinal(r):Math.round(r)},t.prototype.contain=function(r){return r=this.parse(r),VE(r,this._extent)&&this._ordinalMeta.categories[r]!=null},t.prototype.normalize=function(r){return r=this._getTickNumber(this.parse(r)),jE(r,this._extent)},t.prototype.scale=function(r){return r=Math.round(WE(r,this._extent)),this.getRawOrdinalNumber(r)},t.prototype.getTicks=function(){for(var r=[],n=this._extent,i=n[0];i<=n[1];)r.push({value:i}),i++;return r},t.prototype.getMinorTicks=function(r){},t.prototype.setSortInfo=function(r){if(r==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var n=r.ordinalNumbers,i=this._ordinalNumbersByTick=[],a=this._ticksByOrdinalNumber=[],o=0,s=this._ordinalMeta.categories.length,l=Math.min(s,n.length);o<l;++o){var u=n[o];i[o]=u,a[u]=o}for(var f=0;o<s;++o){for(;a[f]!=null;)f++;i.push(f),a[f]=o}},t.prototype._getTickNumber=function(r){var n=this._ticksByOrdinalNumber;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getRawOrdinalNumber=function(r){var n=this._ordinalNumbersByTick;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getLabel=function(r){if(!this.isBlank()){var n=this.getRawOrdinalNumber(r.value),i=this._ordinalMeta.categories[n];return i==null?"":i+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.isInExtentRange=function(r){return r=this._getTickNumber(r),this._extent[0]<=r&&this._extent[1]>=r},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(Ol);Ol.registerClass(ffe);const cfe=ffe;var If=vn,hfe=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="interval",r._interval=0,r._intervalPrecision=2,r}return t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return VE(r,this._extent)},t.prototype.normalize=function(r){return jE(r,this._extent)},t.prototype.scale=function(r){return WE(r,this._extent)},t.prototype.setExtent=function(r,n){var i=this._extent;isNaN(r)||(i[0]=parseFloat(r)),isNaN(n)||(i[1]=parseFloat(n))},t.prototype.unionExtent=function(r){var n=this._extent;r[0]<n[0]&&(n[0]=r[0]),r[1]>n[1]&&(n[1]=r[1]),this.setExtent(n[0],n[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(r){this._interval=r,this._niceExtent=this._extent.slice(),this._intervalPrecision=ufe(r)},t.prototype.getTicks=function(r){var n=this._interval,i=this._extent,a=this._niceExtent,o=this._intervalPrecision,s=[];if(!n)return s;var l=1e4;i[0]<a[0]&&(r?s.push({value:If(a[0]-n,o)}):s.push({value:i[0]}));for(var u=a[0];u<=a[1]&&(s.push({value:u}),u=If(u+n,o),u!==s[s.length-1].value);)if(s.length>l)return[];var f=s.length?s[s.length-1].value:a[1];return i[1]>f&&(r?s.push({value:If(f+n,o)}):s.push({value:i[1]})),s},t.prototype.getMinorTicks=function(r){for(var n=this.getTicks(!0),i=[],a=this.getExtent(),o=1;o<n.length;o++){for(var s=n[o],l=n[o-1],u=0,f=[],c=s.value-l.value,h=c/r;u<r-1;){var d=If(l.value+(u+1)*h);d>a[0]&&d<a[1]&&f.push(d),u++}i.push(f)}return i},t.prototype.getLabel=function(r,n){if(r==null)return"";var i=n&&n.precision;i==null?i=Xo(r.value)||0:i==="auto"&&(i=this._intervalPrecision);var a=If(r.value,i,!0);return Yle(a)},t.prototype.calcNiceTicks=function(r,n,i){r=r||5;var a=this._extent,o=a[1]-a[0];if(isFinite(o)){o<0&&(o=-o,a.reverse());var s=zRt(a,r,n,i);this._intervalPrecision=s.intervalPrecision,this._interval=s.interval,this._niceExtent=s.niceTickExtent}},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1])if(n[0]!==0){var i=Math.abs(n[0]);r.fixMax||(n[1]+=i/2),n[0]-=i/2}else n[1]=1;var a=n[1]-n[0];isFinite(a)||(n[0]=0,n[1]=1),this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval);var o=this._interval;r.fixMin||(n[0]=If(Math.floor(n[0]/o)*o)),r.fixMax||(n[1]=If(Math.ceil(n[1]/o)*o))},t.prototype.setNiceExtent=function(r,n){this._niceExtent=[r,n]},t.type="interval",t}(Ol);Ol.registerClass(hfe);const AS=hfe;var dfe=typeof Float32Array<"u",YRt=dfe?Float32Array:Array;function nl(e){return Ze(e)?dfe?new Float32Array(e):e:new YRt(e)}var KRt="__ec_stack_";function a4(e){return e.get("stack")||KRt+e.seriesIndex}function o4(e){return e.dim+e.index}function vfe(e,t){var r=[];return t.eachSeriesByType(e,function(n){gfe(n)&&r.push(n)}),r}function XRt(e){var t={};le(e,function(l){var u=l.coordinateSystem,f=u.getBaseAxis();if(!(f.type!=="time"&&f.type!=="value"))for(var c=l.getData(),h=f.dim+"_"+f.index,d=c.getDimensionIndex(c.mapDimension(f.dim)),v=c.getStore(),p=0,g=v.count();p<g;++p){var y=v.get(d,p);t[h]?t[h].push(y):t[h]=[y]}});var r={};for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(i){i.sort(function(l,u){return l-u});for(var a=null,o=1;o<i.length;++o){var s=i[o]-i[o-1];s>0&&(a=a===null?s:Math.min(a,s))}r[n]=a}}return r}function pfe(e){var t=XRt(e),r=[];return le(e,function(n){var i=n.coordinateSystem,a=i.getBaseAxis(),o=a.getExtent(),s;if(a.type==="category")s=a.getBandWidth();else if(a.type==="value"||a.type==="time"){var l=a.dim+"_"+a.index,u=t[l],f=Math.abs(o[1]-o[0]),c=a.scale.getExtent(),h=Math.abs(c[1]-c[0]);s=u?f/h*u:f}else{var d=n.getData();s=Math.abs(o[1]-o[0])/d.count()}var v=xr(n.get("barWidth"),s),p=xr(n.get("barMaxWidth"),s),g=xr(n.get("barMinWidth")||(yfe(n)?.5:1),s),y=n.get("barGap"),m=n.get("barCategoryGap");r.push({bandWidth:s,barWidth:v,barMaxWidth:p,barMinWidth:g,barGap:y,barCategoryGap:m,axisKey:o4(a),stackId:a4(n)})}),qRt(r)}function qRt(e){var t={};le(e,function(n,i){var a=n.axisKey,o=n.bandWidth,s=t[a]||{bandWidth:o,remainedWidth:o,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=s.stacks;t[a]=s;var u=n.stackId;l[u]||s.autoWidthCount++,l[u]=l[u]||{width:0,maxWidth:0};var f=n.barWidth;f&&!l[u].width&&(l[u].width=f,f=Math.min(s.remainedWidth,f),s.remainedWidth-=f);var c=n.barMaxWidth;c&&(l[u].maxWidth=c);var h=n.barMinWidth;h&&(l[u].minWidth=h);var d=n.barGap;d!=null&&(s.gap=d);var v=n.barCategoryGap;v!=null&&(s.categoryGap=v)});var r={};return le(t,function(n,i){r[i]={};var a=n.stacks,o=n.bandWidth,s=n.categoryGap;if(s==null){var l=Lr(a).length;s=Math.max(35-l*4,15)+"%"}var u=xr(s,o),f=xr(n.gap,1),c=n.remainedWidth,h=n.autoWidthCount,d=(c-u)/(h+(h-1)*f);d=Math.max(d,0),le(a,function(y){var m=y.maxWidth,b=y.minWidth;if(y.width){var S=y.width;m&&(S=Math.min(S,m)),b&&(S=Math.max(S,b)),y.width=S,c-=S+f*S,h--}else{var S=d;m&&m<S&&(S=Math.min(m,c)),b&&b>S&&(S=b),S!==d&&(y.width=S,c-=S+f*S,h--)}}),d=(c-u)/(h+(h-1)*f),d=Math.max(d,0);var v=0,p;le(a,function(y,m){y.width||(y.width=d),p=y,v+=y.width*(1+f)}),p&&(v-=p.width*f);var g=-v/2;le(a,function(y,m){r[i][m]=r[i][m]||{bandWidth:o,offset:g,width:y.width},g+=y.width*(1+f)})}),r}function ZRt(e,t,r){if(e&&t){var n=e[o4(t)];return n!=null&&r!=null?n[a4(r)]:n}}function JRt(e,t){var r=vfe(e,t),n=pfe(r);le(r,function(i){var a=i.getData(),o=i.coordinateSystem,s=o.getBaseAxis(),l=a4(i),u=n[o4(s)][l],f=u.offset,c=u.width;a.setLayout({bandWidth:u.bandWidth,offset:f,size:c})})}function QRt(e){return{seriesType:e,plan:X3(),reset:function(t){if(gfe(t)){var r=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),a=n.getOtherAxis(i),o=r.getDimensionIndex(r.mapDimension(a.dim)),s=r.getDimensionIndex(r.mapDimension(i.dim)),l=t.get("showBackground",!0),u=r.mapDimension(a.dim),f=r.getCalculationInfo("stackResultDimension"),c=Zc(r,u)&&!!r.getCalculationInfo("stackedOnSeries"),h=a.isHorizontal(),d=ekt(i,a),v=yfe(t),p=t.get("barMinHeight")||0,g=f&&r.getDimensionIndex(f),y=r.getLayout("size"),m=r.getLayout("offset");return{progress:function(b,S){for(var x=b.count,T=v&&nl(x*3),E=v&&l&&nl(x*3),P=v&&nl(x),R=n.master.getRect(),M=h?R.width:R.height,D,N=S.getStore(),B=0;(D=b.next())!=null;){var K=N.get(c?g:o,D),Z=N.get(s,D),ie=d,me=void 0;c&&(me=+K-N.get(o,D));var k=void 0,w=void 0,C=void 0,O=void 0;if(h){var _=n.dataToPoint([K,Z]);if(c){var A=n.dataToPoint([me,Z]);ie=A[0]}k=ie,w=_[1]+m,C=_[0]-ie,O=y,Math.abs(C)<p&&(C=(C<0?-1:1)*p)}else{var _=n.dataToPoint([Z,K]);if(c){var A=n.dataToPoint([Z,me]);ie=A[1]}k=_[0]+m,w=ie,C=y,O=_[1]-ie,Math.abs(O)<p&&(O=(O<=0?-1:1)*p)}v?(T[B]=k,T[B+1]=w,T[B+2]=h?C:O,E&&(E[B]=h?R.x:k,E[B+1]=h?w:R.y,E[B+2]=M),P[D]=D):S.setItemLayout(D,{x:k,y:w,width:C,height:O}),B+=3}v&&S.setLayout({largePoints:T,largeDataIndices:P,largeBackgroundPoints:E,valueAxisHorizontal:h})}}}}}}function gfe(e){return e.coordinateSystem&&e.coordinateSystem.type==="cartesian2d"}function yfe(e){return e.pipelineContext&&e.pipelineContext.large}function ekt(e,t){return t.toGlobalCoord(t.dataToCoord(t.type==="log"?1:0))}var tkt=function(e,t,r,n){for(;r<n;){var i=r+n>>>1;e[i][1]<t?r=i+1:n=i}return r},mfe=function(e){je(t,e);function t(r){var n=e.call(this,r)||this;return n.type="time",n}return t.prototype.getLabel=function(r){var n=this.getSetting("useUTC");return kE(r.value,$K[pTt(Qd(this._minLevelUnit))]||$K.second,n,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(r,n,i){var a=this.getSetting("useUTC"),o=this.getSetting("locale");return gTt(r,n,i,o,a)},t.prototype.getTicks=function(){var r=this._interval,n=this._extent,i=[];if(!r)return i;i.push({value:n[0],level:0});var a=this.getSetting("useUTC"),o=lkt(this._minLevelUnit,this._approxInterval,a,n);return i=i.concat(o),i.push({value:n[1],level:0}),i},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1]&&(n[0]-=Ea,n[1]+=Ea),n[1]===-1/0&&n[0]===1/0){var i=new Date;n[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),n[0]=n[1]-Ea}this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval)},t.prototype.calcNiceTicks=function(r,n,i){r=r||10;var a=this._extent,o=a[1]-a[0];this._approxInterval=o/r,n!=null&&this._approxInterval<n&&(this._approxInterval=n),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var s=T1.length,l=Math.min(tkt(T1,this._approxInterval,0,s),s-1);this._interval=T1[l][1],this._minLevelUnit=T1[Math.max(l-1,0)][0]},t.prototype.parse=function(r){return Sr(r)?r:+yl(r)},t.prototype.contain=function(r){return VE(this.parse(r),this._extent)},t.prototype.normalize=function(r){return jE(this.parse(r),this._extent)},t.prototype.scale=function(r){return WE(r,this._extent)},t.type="time",t}(AS),T1=[["second",F3],["minute",$3],["hour",jm],["quarter-day",jm*6],["half-day",jm*12],["day",Ea*1.2],["half-week",Ea*3.5],["week",Ea*7],["month",Ea*31],["quarter",Ea*95],["half-year",FK/2],["year",FK]];function rkt(e,t,r,n){var i=yl(t),a=yl(r),o=function(v){return HK(i,v,n)===HK(a,v,n)},s=function(){return o("year")},l=function(){return s()&&o("month")},u=function(){return l()&&o("day")},f=function(){return u()&&o("hour")},c=function(){return f()&&o("minute")},h=function(){return c()&&o("second")},d=function(){return h()&&o("millisecond")};switch(e){case"year":return s();case"month":return l();case"day":return u();case"hour":return f();case"minute":return c();case"second":return h();case"millisecond":return d()}}function nkt(e,t){return e/=Ea,e>16?16:e>7.5?7:e>3.5?4:e>1.5?2:1}function ikt(e){var t=30*Ea;return e/=t,e>6?6:e>3?3:e>2?2:1}function akt(e){return e/=jm,e>12?12:e>6?6:e>3.5?4:e>2?2:1}function KX(e,t){return e/=t?$3:F3,e>30?30:e>20?20:e>15?15:e>10?10:e>5?5:e>2?2:1}function okt(e){return Mse(e,!0)}function skt(e,t,r){var n=new Date(e);switch(Qd(t)){case"year":case"month":n[Vle(r)](0);case"day":n[jle(r)](1);case"hour":n[Wle(r)](0);case"minute":n[Ule(r)](0);case"second":n[zle(r)](0),n[Gle(r)](0)}return n.getTime()}function lkt(e,t,r,n){var i=1e4,a=Hle,o=0;function s(M,D,N,B,K,Z,ie){for(var me=new Date(D),k=D,w=me[B]();k<N&&k<=n[1];)ie.push({value:k}),w+=M,me[K](w),k=me.getTime();ie.push({value:k,notAdd:!0})}function l(M,D,N){var B=[],K=!D.length;if(!rkt(Qd(M),n[0],n[1],r)){K&&(D=[{value:skt(new Date(n[0]),M,r)},{value:n[1]}]);for(var Z=0;Z<D.length-1;Z++){var ie=D[Z].value,me=D[Z+1].value;if(ie!==me){var k=void 0,w=void 0,C=void 0,O=!1;switch(M){case"year":k=Math.max(1,Math.round(t/Ea/365)),w=H3(r),C=yTt(r);break;case"half-year":case"quarter":case"month":k=ikt(t),w=ev(r),C=Vle(r);break;case"week":case"half-week":case"day":k=nkt(t),w=AE(r),C=jle(r),O=!0;break;case"half-day":case"quarter-day":case"hour":k=akt(t),w=mw(r),C=Wle(r);break;case"minute":k=KX(t,!0),w=PE(r),C=Ule(r);break;case"second":k=KX(t,!1),w=IE(r),C=zle(r);break;case"millisecond":k=okt(t),w=ME(r),C=Gle(r);break}s(k,ie,me,w,C,O,B),M==="year"&&N.length>1&&Z===0&&N.unshift({value:N[0].value-k})}}for(var Z=0;Z<B.length;Z++)N.push(B[Z]);return B}}for(var u=[],f=[],c=0,h=0,d=0;d<a.length&&o++<i;++d){var v=Qd(a[d]);if(vTt(a[d])){l(a[d],u[u.length-1]||[],f);var p=a[d+1]?Qd(a[d+1]):null;if(v!==p){if(f.length){h=c,f.sort(function(M,D){return M.value-D.value});for(var g=[],y=0;y<f.length;++y){var m=f[y].value;(y===0||f[y-1].value!==m)&&(g.push(f[y]),m>=n[0]&&m<=n[1]&&c++)}var b=(n[1]-n[0])/t;if(c>b*1.5&&h>b/1.5||(u.push(g),c>b||e===a[d]))break}f=[]}}}for(var S=Wn(ct(u,function(M){return Wn(M,function(D){return D.value>=n[0]&&D.value<=n[1]&&!D.notAdd})}),function(M){return M.length>0}),x=[],T=S.length-1,d=0;d<S.length;++d)for(var E=S[d],P=0;P<E.length;++P)x.push({value:E[P].value,level:T-d});x.sort(function(M,D){return M.value-D.value});for(var R=[],d=0;d<x.length;++d)(d===0||x[d].value!==x[d-1].value)&&R.push(x[d]);return R}Ol.registerClass(mfe);const ukt=mfe;var XX=Ol.prototype,Ym=AS.prototype,fkt=vn,ckt=Math.floor,hkt=Math.ceil,O1=Math.pow,Ka=Math.log,s4=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="log",r.base=10,r._originalScale=new AS,r._interval=0,r}return t.prototype.getTicks=function(r){var n=this._originalScale,i=this._extent,a=n.getExtent(),o=Ym.getTicks.call(this,r);return ct(o,function(s){var l=s.value,u=vn(O1(this.base,l));return u=l===i[0]&&this._fixMin?E1(u,a[0]):u,u=l===i[1]&&this._fixMax?E1(u,a[1]):u,{value:u}},this)},t.prototype.setExtent=function(r,n){var i=Ka(this.base);r=Ka(Math.max(0,r))/i,n=Ka(Math.max(0,n))/i,Ym.setExtent.call(this,r,n)},t.prototype.getExtent=function(){var r=this.base,n=XX.getExtent.call(this);n[0]=O1(r,n[0]),n[1]=O1(r,n[1]);var i=this._originalScale,a=i.getExtent();return this._fixMin&&(n[0]=E1(n[0],a[0])),this._fixMax&&(n[1]=E1(n[1],a[1])),n},t.prototype.unionExtent=function(r){this._originalScale.unionExtent(r);var n=this.base;r[0]=Ka(r[0])/Ka(n),r[1]=Ka(r[1])/Ka(n),XX.unionExtent.call(this,r)},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.calcNiceTicks=function(r){r=r||10;var n=this._extent,i=n[1]-n[0];if(!(i===1/0||i<=0)){var a=d1t(i),o=r/i*a;for(o<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var s=[vn(hkt(n[0]/a)*a),vn(ckt(n[1]/a)*a)];this._interval=a,this._niceExtent=s}},t.prototype.calcNiceExtent=function(r){Ym.calcNiceExtent.call(this,r),this._fixMin=r.fixMin,this._fixMax=r.fixMax},t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return r=Ka(r)/Ka(this.base),VE(r,this._extent)},t.prototype.normalize=function(r){return r=Ka(r)/Ka(this.base),jE(r,this._extent)},t.prototype.scale=function(r){return r=WE(r,this._extent),O1(this.base,r)},t.type="log",t}(Ol),bfe=s4.prototype;bfe.getMinorTicks=Ym.getMinorTicks;bfe.getLabel=Ym.getLabel;function E1(e,t){return fkt(e,Xo(t))}Ol.registerClass(s4);const dkt=s4;var vkt=function(){function e(t,r,n){this._prepareParams(t,r,n)}return e.prototype._prepareParams=function(t,r,n){n[1]<n[0]&&(n=[NaN,NaN]),this._dataMin=n[0],this._dataMax=n[1];var i=this._isOrdinal=t.type==="ordinal";this._needCrossZero=t.type==="interval"&&r.getNeedCrossZero&&r.getNeedCrossZero();var a=this._modelMinRaw=r.get("min",!0);gt(a)?this._modelMinNum=R1(t,a({min:n[0],max:n[1]})):a!=="dataMin"&&(this._modelMinNum=R1(t,a));var o=this._modelMaxRaw=r.get("max",!0);if(gt(o)?this._modelMaxNum=R1(t,o({min:n[0],max:n[1]})):o!=="dataMax"&&(this._modelMaxNum=R1(t,o)),i)this._axisDataLen=r.getCategories().length;else{var s=r.get("boundaryGap"),l=Ze(s)?s:[s||0,s||0];typeof l[0]=="boolean"||typeof l[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[Fu(l[0],1),Fu(l[1],1)]}},e.prototype.calculate=function(){var t=this._isOrdinal,r=this._dataMin,n=this._dataMax,i=this._axisDataLen,a=this._boundaryGapInner,o=t?null:n-r||Math.abs(r),s=this._modelMinRaw==="dataMin"?r:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?n:this._modelMaxNum,u=s!=null,f=l!=null;s==null&&(s=t?i?0:NaN:r-a[0]*o),l==null&&(l=t?i?i-1:NaN:n+a[1]*o),(s==null||!isFinite(s))&&(s=NaN),(l==null||!isFinite(l))&&(l=NaN);var c=_T(s)||_T(l)||t&&!i;this._needCrossZero&&(s>0&&l>0&&!u&&(s=0),s<0&&l<0&&!f&&(l=0));var h=this._determinedMin,d=this._determinedMax;return h!=null&&(s=h,u=!0),d!=null&&(l=d,f=!0),{min:s,max:l,minFixed:u,maxFixed:f,isBlank:c}},e.prototype.modifyDataMinMax=function(t,r){this[gkt[t]]=r},e.prototype.setDeterminedMinMax=function(t,r){var n=pkt[t];this[n]=r},e.prototype.freeze=function(){this.frozen=!0},e}(),pkt={min:"_determinedMin",max:"_determinedMax"},gkt={min:"_dataMin",max:"_dataMax"};function ykt(e,t,r){var n=e.rawExtentInfo;return n||(n=new vkt(e,t,r),e.rawExtentInfo=n,n)}function R1(e,t){return t==null?null:_T(t)?NaN:e.parse(t)}function wfe(e,t){var r=e.type,n=ykt(e,t,e.getExtent()).calculate();e.setBlank(n.isBlank);var i=n.min,a=n.max,o=t.ecModel;if(o&&r==="time"){var s=vfe("bar",o),l=!1;if(le(s,function(c){l=l||c.getBaseAxis()===t.axis}),l){var u=pfe(s),f=mkt(i,a,t,u);i=f.min,a=f.max}}return{extent:[i,a],fixMin:n.minFixed,fixMax:n.maxFixed}}function mkt(e,t,r,n){var i=r.axis.getExtent(),a=i[1]-i[0],o=ZRt(n,r.axis);if(o===void 0)return{min:e,max:t};var s=1/0;le(o,function(d){s=Math.min(d.offset,s)});var l=-1/0;le(o,function(d){l=Math.max(d.offset+d.width,l)}),s=Math.abs(s),l=Math.abs(l);var u=s+l,f=t-e,c=1-(s+l)/a,h=f/c-f;return t+=h*(l/u),e-=h*(s/u),{min:e,max:t}}function qX(e,t){var r=t,n=wfe(e,r),i=n.extent,a=r.get("splitNumber");e instanceof dkt&&(e.base=r.get("logBase"));var o=e.type,s=r.get("interval"),l=o==="interval"||o==="time";e.setExtent(i[0],i[1]),e.calcNiceExtent({splitNumber:a,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:l?r.get("minInterval"):null,maxInterval:l?r.get("maxInterval"):null}),s!=null&&e.setInterval&&e.setInterval(s)}function bkt(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new cfe({ordinalMeta:e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),extent:[1/0,-1/0]});case"time":return new ukt({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new(Ol.getClass(t)||AS)}}function wkt(e){var t=e.scale.getExtent(),r=t[0],n=t[1];return!(r>0&&n>0||r<0&&n<0)}function PS(e){var t=e.getLabelModel().get("formatter"),r=e.type==="category"?e.scale.getExtent()[0]:null;return e.scale.type==="time"?function(n){return function(i,a){return e.scale.getFormattedLabel(i,a,n)}}(t):st(t)?function(n){return function(i){var a=e.scale.getLabel(i),o=n.replace("{value}",a??"");return o}}(t):gt(t)?function(n){return function(i,a){return r!=null&&(a=i.value-r),n(l4(e,i),a,i.level!=null?{level:i.level}:null)}}(t):function(n){return e.scale.getLabel(n)}}function l4(e,t){return e.type==="category"?e.scale.getLabel(t):t.value}function Skt(e){var t=e.model,r=e.scale;if(!(!t.get(["axisLabel","show"])||r.isBlank())){var n,i,a=r.getExtent();r instanceof cfe?i=r.count():(n=r.getTicks(),i=n.length);var o=e.getLabelModel(),s=PS(e),l,u=1;i>40&&(u=Math.ceil(i/40));for(var f=0;f<i;f+=u){var c=n?n[f]:{value:a[0]+f},h=s(c,f),d=o.getTextRect(h),v=_kt(d,o.get("rotate")||0);l?l.union(v):l=v}return l}}function _kt(e,t){var r=t*Math.PI/180,n=e.width,i=e.height,a=n*Math.abs(Math.cos(r))+Math.abs(i*Math.sin(r)),o=n*Math.abs(Math.sin(r))+Math.abs(i*Math.cos(r)),s=new ur(e.x,e.y,a,o);return s}function u4(e){var t=e.get("interval");return t??"auto"}function Sfe(e){return e.type==="category"&&u4(e.getLabelModel())===0}function Ckt(e,t){var r={};return le(e.mapDimensionsAll(t),function(n){r[FRt(e,n)]=!0}),Lr(r)}var xkt=function(){function e(){}return e.prototype.getNeedCrossZero=function(){var t=this.option;return!t.scale},e.prototype.getCoordSysModel=function(){},e}(),ZX=[],Tkt={registerPreprocessor:Que,registerProcessor:efe,registerPostInit:uRt,registerPostUpdate:fRt,registerUpdateLifecycle:t4,registerAction:Bg,registerCoordinateSystem:cRt,registerLayout:hRt,registerVisual:Sh,registerTransform:vRt,registerLoading:tfe,registerMap:dRt,registerImpl:WEt,PRIORITY:rRt,ComponentModel:Er,ComponentView:rs,SeriesModel:Bu,ChartView:Qo,registerComponentModel:function(e){Er.registerClass(e)},registerComponentView:function(e){rs.registerClass(e)},registerSeriesModel:function(e){Bu.registerClass(e)},registerChartView:function(e){Qo.registerClass(e)},registerSubTypeDefaulter:function(e,t){Er.registerSubTypeDefaulter(e,t)},registerPainter:function(e,t){o1t(e,t)}};function Vu(e){if(Ze(e)){le(e,function(t){Vu(t)});return}ar(ZX,e)>=0||(ZX.push(e),gt(e)&&(e={install:e}),e.install(Tkt))}var Cw=Jr();function Okt(e){return e.type==="category"?Rkt(e):Akt(e)}function Ekt(e,t){return e.type==="category"?kkt(e,t):{ticks:ct(e.scale.getTicks(),function(r){return r.value})}}function Rkt(e){var t=e.getLabelModel(),r=_fe(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r}function _fe(e,t){var r=Cfe(e,"labels"),n=u4(t),i=xfe(r,n);if(i)return i;var a,o;return gt(n)?a=Efe(e,n):(o=n==="auto"?Pkt(e):n,a=Ofe(e,o)),Tfe(r,n,{labels:a,labelCategoryInterval:o})}function kkt(e,t){var r=Cfe(e,"ticks"),n=u4(t),i=xfe(r,n);if(i)return i;var a,o;if((!t.get("show")||e.scale.isBlank())&&(a=[]),gt(n))a=Efe(e,n,!0);else if(n==="auto"){var s=_fe(e,e.getLabelModel());o=s.labelCategoryInterval,a=ct(s.labels,function(l){return l.tickValue})}else o=n,a=Ofe(e,o,!0);return Tfe(r,n,{ticks:a,tickCategoryInterval:o})}function Akt(e){var t=e.scale.getTicks(),r=PS(e);return{labels:ct(t,function(n,i){return{level:n.level,formattedLabel:r(n,i),rawLabel:e.scale.getLabel(n),tickValue:n.value}})}}function Cfe(e,t){return Cw(e)[t]||(Cw(e)[t]=[])}function xfe(e,t){for(var r=0;r<e.length;r++)if(e[r].key===t)return e[r].value}function Tfe(e,t,r){return e.push({key:t,value:r}),r}function Pkt(e){var t=Cw(e).autoInterval;return t??(Cw(e).autoInterval=e.calculateCategoryInterval())}function Ikt(e){var t=Mkt(e),r=PS(e),n=(t.axisRotate-t.labelRotate)/180*Math.PI,i=e.scale,a=i.getExtent(),o=i.count();if(a[1]-a[0]<1)return 0;var s=1;o>40&&(s=Math.max(1,Math.floor(o/40)));for(var l=a[0],u=e.dataToCoord(l+1)-e.dataToCoord(l),f=Math.abs(u*Math.cos(n)),c=Math.abs(u*Math.sin(n)),h=0,d=0;l<=a[1];l+=s){var v=0,p=0,g=p3(r({value:l}),t.font,"center","top");v=g.width*1.3,p=g.height*1.3,h=Math.max(h,v,7),d=Math.max(d,p,7)}var y=h/f,m=d/c;isNaN(y)&&(y=1/0),isNaN(m)&&(m=1/0);var b=Math.max(0,Math.floor(Math.min(y,m))),S=Cw(e.model),x=e.getExtent(),T=S.lastAutoInterval,E=S.lastTickCount;return T!=null&&E!=null&&Math.abs(T-b)<=1&&Math.abs(E-o)<=1&&T>b&&S.axisExtent0===x[0]&&S.axisExtent1===x[1]?b=T:(S.lastTickCount=o,S.lastAutoInterval=b,S.axisExtent0=x[0],S.axisExtent1=x[1]),b}function Mkt(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function Ofe(e,t,r){var n=PS(e),i=e.scale,a=i.getExtent(),o=e.getLabelModel(),s=[],l=Math.max((t||0)+1,1),u=a[0],f=i.count();u!==0&&l>1&&f/l>2&&(u=Math.round(Math.ceil(u/l)*l));var c=Sfe(e),h=o.get("showMinLabel")||c,d=o.get("showMaxLabel")||c;h&&u!==a[0]&&p(a[0]);for(var v=u;v<=a[1];v+=l)p(v);d&&v-l!==a[1]&&p(a[1]);function p(g){var y={value:g};s.push(r?g:{formattedLabel:n(y),rawLabel:i.getLabel(y),tickValue:g})}return s}function Efe(e,t,r){var n=e.scale,i=PS(e),a=[];return le(n.getTicks(),function(o){var s=n.getLabel(o),l=o.value;t(o.value,s)&&a.push(r?l:{formattedLabel:i(o),rawLabel:s,tickValue:l})}),a}var JX=[0,1],Dkt=function(){function e(t,r,n){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=r,this._extent=n||[0,0]}return e.prototype.contain=function(t){var r=this._extent,n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return t>=n&&t<=i},e.prototype.containData=function(t){return this.scale.contain(t)},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.getPixelPrecision=function(t){return u1t(t||this.scale.getExtent(),this._extent)},e.prototype.setExtent=function(t,r){var n=this._extent;n[0]=t,n[1]=r},e.prototype.dataToCoord=function(t,r){var n=this._extent,i=this.scale;return t=i.normalize(t),this.onBand&&i.type==="ordinal"&&(n=n.slice(),QX(n,i.count())),LN(t,JX,n,r)},e.prototype.coordToData=function(t,r){var n=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(n=n.slice(),QX(n,i.count()));var a=LN(t,n,JX,r);return this.scale.scale(a)},e.prototype.pointToData=function(t,r){},e.prototype.getTicksCoords=function(t){t=t||{};var r=t.tickModel||this.getTickModel(),n=Ekt(this,r),i=n.ticks,a=ct(i,function(s){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(s):s),tickValue:s}},this),o=r.get("alignWithLabel");return Nkt(this,a,o,t.clamp),a},e.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var t=this.model.getModel("minorTick"),r=t.get("splitNumber");r>0&&r<100||(r=5);var n=this.scale.getMinorTicks(r),i=ct(n,function(a){return ct(a,function(o){return{coord:this.dataToCoord(o),tickValue:o}},this)},this);return i},e.prototype.getViewLabels=function(){return Okt(this).labels},e.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},e.prototype.getTickModel=function(){return this.model.getModel("axisTick")},e.prototype.getBandWidth=function(){var t=this._extent,r=this.scale.getExtent(),n=r[1]-r[0]+(this.onBand?1:0);n===0&&(n=1);var i=Math.abs(t[1]-t[0]);return Math.abs(i)/n},e.prototype.calculateCategoryInterval=function(){return Ikt(this)},e}();function QX(e,t){var r=e[1]-e[0],n=t,i=r/n/2;e[0]+=i,e[1]-=i}function Nkt(e,t,r,n){var i=t.length;if(!e.onBand||r||!i)return;var a=e.getExtent(),o,s;if(i===1)t[0].coord=a[0],o=t[1]={coord:a[0]};else{var l=t[i-1].tickValue-t[0].tickValue,u=(t[i-1].coord-t[0].coord)/l;le(t,function(d){d.coord-=u/2});var f=e.scale.getExtent();s=1+f[1]-t[i-1].tickValue,o={coord:t[i-1].coord+u*s},t.push(o)}var c=a[0]>a[1];h(t[0].coord,a[0])&&(n?t[0].coord=a[0]:t.shift()),n&&h(a[0],t[0].coord)&&t.unshift({coord:a[0]}),h(a[1],o.coord)&&(n?o.coord=a[1]:t.pop()),n&&h(o.coord,a[1])&&t.push({coord:a[1]});function h(d,v){return d=vn(d),v=vn(v),c?d>v:d<v}}const Lkt=Dkt;$u.CMD;function Rfe(e,t,r,n,i,a,o,s){var l=i-e,u=a-t,f=r-e,c=n-t,h=Math.sqrt(f*f+c*c);f/=h,c/=h;var d=l*f+u*c,v=d/h;s&&(v=Math.min(Math.max(v,0),1)),v*=h;var p=o[0]=e+v*f,g=o[1]=t+v*c;return Math.sqrt((p-i)*(p-i)+(g-a)*(g-a))}var au=new xt,Gr=new xt,Pn=new xt,ou=new xt,Yo=new xt,XT=[],hi=new xt;function Fkt(e,t){if(t<=180&&t>0){t=t/180*Math.PI,au.fromArray(e[0]),Gr.fromArray(e[1]),Pn.fromArray(e[2]),xt.sub(ou,au,Gr),xt.sub(Yo,Pn,Gr);var r=ou.len(),n=Yo.len();if(!(r<.001||n<.001)){ou.scale(1/r),Yo.scale(1/n);var i=ou.dot(Yo),a=Math.cos(t);if(a<i){var o=Rfe(Gr.x,Gr.y,Pn.x,Pn.y,au.x,au.y,XT,!1);hi.fromArray(XT),hi.scaleAndAdd(Yo,o/Math.tan(Math.PI-t));var s=Pn.x!==Gr.x?(hi.x-Gr.x)/(Pn.x-Gr.x):(hi.y-Gr.y)/(Pn.y-Gr.y);if(isNaN(s))return;s<0?xt.copy(hi,Gr):s>1&&xt.copy(hi,Pn),hi.toArray(e[1])}}}}function $kt(e,t,r){if(r<=180&&r>0){r=r/180*Math.PI,au.fromArray(e[0]),Gr.fromArray(e[1]),Pn.fromArray(e[2]),xt.sub(ou,Gr,au),xt.sub(Yo,Pn,Gr);var n=ou.len(),i=Yo.len();if(!(n<.001||i<.001)){ou.scale(1/n),Yo.scale(1/i);var a=ou.dot(t),o=Math.cos(r);if(a<o){var s=Rfe(Gr.x,Gr.y,Pn.x,Pn.y,au.x,au.y,XT,!1);hi.fromArray(XT);var l=Math.PI/2,u=Math.acos(Yo.dot(t)),f=l+u-r;if(f>=l)xt.copy(hi,Pn);else{hi.scaleAndAdd(Yo,s/Math.tan(Math.PI/2-f));var c=Pn.x!==Gr.x?(hi.x-Gr.x)/(Pn.x-Gr.x):(hi.y-Gr.y)/(Pn.y-Gr.y);if(isNaN(c))return;c<0?xt.copy(hi,Gr):c>1&&xt.copy(hi,Pn)}hi.toArray(e[1])}}}}function eq(e,t,r,n){var i=r==="normal",a=i?e:e.ensureState(r);a.ignore=t;var o=n.get("smooth");o&&o===!0&&(o=.3),a.shape=a.shape||{},o>0&&(a.shape.smooth=o);var s=n.getModel("lineStyle").getLineStyle();i?e.useStyle(s):a.style=s}function Hkt(e,t){var r=t.smooth,n=t.points;if(n)if(e.moveTo(n[0][0],n[0][1]),r>0&&n.length>=3){var i=wN(n[0],n[1]),a=wN(n[1],n[2]);if(!i||!a){e.lineTo(n[1][0],n[1][1]),e.lineTo(n[2][0],n[2][1]);return}var o=Math.min(i,a)*r,s=IA([],n[1],n[0],o/i),l=IA([],n[1],n[2],o/a),u=IA([],s,l,.5);e.bezierCurveTo(s[0],s[1],s[0],s[1],u[0],u[1]),e.bezierCurveTo(l[0],l[1],l[0],l[1],n[2][0],n[2][1])}else for(var f=1;f<n.length;f++)e.lineTo(n[f][0],n[f][1])}function Bkt(e,t,r){var n=e.getTextGuideLine(),i=e.getTextContent();if(!i){n&&e.removeTextGuideLine();return}for(var a=t.normal,o=a.get("show"),s=i.ignore,l=0;l<MT.length;l++){var u=MT[l],f=t[u],c=u==="normal";if(f){var h=f.get("show"),d=c?s:qt(i.states[u]&&i.states[u].ignore,s);if(d||!qt(h,o)){var v=c?n:n&&n.states[u];v&&(v.ignore=!0);continue}n||(n=new xE,e.setTextGuideLine(n),!c&&(s||!o)&&eq(n,!0,"normal",t.normal),e.stateProxy&&(n.stateProxy=e.stateProxy)),eq(n,!1,u,f)}}if(n){fr(n.style,r),n.style.fill=null;var p=a.get("showAbove"),g=e.textGuideLineConfig=e.textGuideLineConfig||{};g.showAbove=p||!1,n.buildPath=Hkt}}function Vkt(e,t){t=t||"labelLine";for(var r={normal:e.getModel(t)},n=0;n<Ma.length;n++){var i=Ma[n];r[i]=e.getModel([i,t])}return r}function jkt(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(!n.defaultAttr.ignore){var i=n.label,a=i.getComputedTransform(),o=i.getBoundingRect(),s=!a||a[1]<1e-5&&a[2]<1e-5,l=i.style.margin||0,u=o.clone();u.applyTransform(a),u.x-=l/2,u.y-=l/2,u.width+=l,u.height+=l;var f=s?new FT(o,a):null;t.push({label:i,labelLine:n.labelLine,rect:u,localRect:o,obb:f,priority:n.priority,defaultAttr:n.defaultAttr,layoutOption:n.computedLayoutOption,axisAligned:s,transform:a})}}return t}function Wkt(e,t,r,n,i,a){var o=e.length;if(o<2)return;e.sort(function(P,R){return P.rect[t]-R.rect[t]});for(var s=0,l,u=!1,f=0,c=0;c<o;c++){var h=e[c],d=h.rect;l=d[t]-s,l<0&&(d[t]-=l,h.label[t]-=l,u=!0);var v=Math.max(-l,0);f+=v,s=d[t]+d[r]}f>0&&a&&x(-f/o,0,o);var p=e[0],g=e[o-1],y,m;b(),y<0&&T(-y,.8),m<0&&T(m,.8),b(),S(y,m,1),S(m,y,-1),b(),y<0&&E(-y),m<0&&E(m);function b(){y=p.rect[t]-n,m=i-g.rect[t]-g.rect[r]}function S(P,R,M){if(P<0){var D=Math.min(R,-P);if(D>0){x(D*M,0,o);var N=D+P;N<0&&T(-N*M,1)}else T(-P*M,1)}}function x(P,R,M){P!==0&&(u=!0);for(var D=R;D<M;D++){var N=e[D],B=N.rect;B[t]+=P,N.label[t]+=P}}function T(P,R){for(var M=[],D=0,N=1;N<o;N++){var B=e[N-1].rect,K=Math.max(e[N].rect[t]-B[t]-B[r],0);M.push(K),D+=K}if(D){var Z=Math.min(Math.abs(P)/D,R);if(P>0)for(var N=0;N<o-1;N++){var ie=M[N]*Z;x(ie,0,N+1)}else for(var N=o-1;N>0;N--){var ie=M[N-1]*Z;x(-ie,N,o)}}}function E(P){var R=P<0?-1:1;P=Math.abs(P);for(var M=Math.ceil(P/(o-1)),D=0;D<o-1;D++)if(R>0?x(M,0,D+1):x(-M,o-D-1,o),P-=M,P<=0)return}return u}function Ukt(e,t,r,n){return Wkt(e,"y","height",t,r,n)}function zkt(e){var t=[];e.sort(function(p,g){return g.priority-p.priority});var r=new ur(0,0,0,0);function n(p){if(!p.ignore){var g=p.ensureState("emphasis");g.ignore==null&&(g.ignore=!1)}p.ignore=!0}for(var i=0;i<e.length;i++){var a=e[i],o=a.axisAligned,s=a.localRect,l=a.transform,u=a.label,f=a.labelLine;r.copy(a.rect),r.width-=.1,r.height-=.1,r.x+=.05,r.y+=.05;for(var c=a.obb,h=!1,d=0;d<t.length;d++){var v=t[d];if(r.intersect(v.rect)){if(o&&v.axisAligned){h=!0;break}if(v.obb||(v.obb=new FT(v.localRect,v.transform)),c||(c=new FT(s,l)),c.intersect(v.obb)){h=!0;break}}}h?(n(u),f&&n(f)):(u.attr("ignore",a.defaultAttr.ignore),f&&f.attr("ignore",a.defaultAttr.labelGuideIgnore),t.push(a))}}function tq(e,t,r){var n=Lg.createCanvas(),i=t.getWidth(),a=t.getHeight(),o=n.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=i+"px",o.height=a+"px",n.setAttribute("data-zr-dom-id",e)),n.width=i*r,n.height=a*r,n}var Gkt=function(e){je(t,e);function t(r,n,i){var a=e.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var o;i=i||RT,typeof r=="string"?o=tq(r,n,i):vt(r)&&(o=r,r=o.id),a.id=r,a.dom=o;var s=o.style;return s&&(lse(o),o.onselectstart=function(){return!1},s.padding="0",s.margin="0",s.borderWidth="0"),a.painter=n,a.dpr=i,a}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var r=this.dpr;this.domBack=tq("back-"+this.id,this.painter,r),this.ctxBack=this.domBack.getContext("2d"),r!==1&&this.ctxBack.scale(r,r)},t.prototype.createRepaintRects=function(r,n,i,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var o=[],s=this.maxRepaintRectCount,l=!1,u=new ur(0,0,0,0);function f(m){if(!(!m.isFinite()||m.isZero()))if(o.length===0){var b=new ur(0,0,0,0);b.copy(m),o.push(b)}else{for(var S=!1,x=1/0,T=0,E=0;E<o.length;++E){var P=o[E];if(P.intersect(m)){var R=new ur(0,0,0,0);R.copy(P),R.union(m),o[E]=R,S=!0;break}else if(l){u.copy(m),u.union(P);var M=m.width*m.height,D=P.width*P.height,N=u.width*u.height,B=N-M-D;B<x&&(x=B,T=E)}}if(l&&(o[T].union(m),S=!0),!S){var b=new ur(0,0,0,0);b.copy(m),o.push(b)}l||(l=o.length>=s)}}for(var c=this.__startIndex;c<this.__endIndex;++c){var h=r[c];if(h){var d=h.shouldBePainted(i,a,!0,!0),v=h.__isRendered&&(h.__dirty&Ji||!d)?h.getPrevPaintRect():null;v&&f(v);var p=d&&(h.__dirty&Ji||!h.__isRendered)?h.getPaintRect():null;p&&f(p)}}for(var c=this.__prevStartIndex;c<this.__prevEndIndex;++c){var h=n[c],d=h.shouldBePainted(i,a,!0,!0);if(h&&(!d||!h.__zr)&&h.__isRendered){var v=h.getPrevPaintRect();v&&f(v)}}var g;do{g=!1;for(var c=0;c<o.length;){if(o[c].isZero()){o.splice(c,1);continue}for(var y=c+1;y<o.length;)o[c].intersect(o[y])?(g=!0,o[c].union(o[y]),o.splice(y,1)):y++;c++}}while(g);return this._paintRects=o,o},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(r,n){var i=this.dpr,a=this.dom,o=a.style,s=this.domBack;o&&(o.width=r+"px",o.height=n+"px"),a.width=r*i,a.height=n*i,s&&(s.width=r*i,s.height=n*i,i!==1&&this.ctxBack.scale(i,i))},t.prototype.clear=function(r,n,i){var a=this.dom,o=this.ctx,s=a.width,l=a.height;n=n||this.clearColor;var u=this.motionBlur&&!r,f=this.lastFrameAlpha,c=this.dpr,h=this;u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,s/c,l/c));var d=this.domBack;function v(p,g,y,m){if(o.clearRect(p,g,y,m),n&&n!=="transparent"){var b=void 0;if(pE(n)){var S=n.global||n.__width===y&&n.__height===m;b=S&&n.__canvasGradient||nL(o,n,{x:0,y:0,width:y,height:m}),n.__canvasGradient=b,n.__width=y,n.__height=m}else PSt(n)&&(n.scaleX=n.scaleX||c,n.scaleY=n.scaleY||c,b=iL(o,n,{dirty:function(){h.setUnpainted(),h.__painter.refresh()}}));o.save(),o.fillStyle=b||n,o.fillRect(p,g,y,m),o.restore()}u&&(o.save(),o.globalAlpha=f,o.drawImage(d,p,g,y,m),o.restore())}!i||u?v(0,0,s,l):i.length&&le(i,function(p){v(p.x*c,p.y*c,p.width*c,p.height*c)})},t}(cs);const $P=Gkt;var rq=1e5,Mf=314159,k1=.01,Ykt=.001;function Kkt(e){return e?e.__builtin__?!0:!(typeof e.resize!="function"||typeof e.refresh!="function"):!1}function Xkt(e,t){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var qkt=function(){function e(t,r,n,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=n=Ne({},n||{}),this.dpr=n.devicePixelRatio||RT,this._singleCanvas=a,this.root=t;var o=t.style;o&&(lse(t),t.innerHTML=""),this.storage=r;var s=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(a){var f=t,c=f.width,h=f.height;n.width!=null&&(c=n.width),n.height!=null&&(h=n.height),this.dpr=n.devicePixelRatio||1,f.width=c*this.dpr,f.height=h*this.dpr,this._width=c,this._height=h;var d=new $P(f,this,this.dpr);d.__builtin__=!0,d.initContext(),l[Mf]=d,d.zlevel=Mf,s.push(Mf),this._domRoot=t}else{this._width=w1(t,0,n),this._height=w1(t,1,n);var u=this._domRoot=Xkt(this._width,this._height);t.appendChild(u)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.refresh=function(t){var r=this.storage.getDisplayList(!0),n=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(r,n,t,this._redrawId);for(var a=0;a<i.length;a++){var o=i[a],s=this._layers[o];if(!s.__builtin__&&s.refresh){var l=a===0?this._backgroundColor:null;s.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=r.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(t){var r=t.length,n=this._hoverlayer;if(n&&n.clear(),!!r){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,o=0;o<r;o++){var s=t[o];s.__inHover&&(n||(n=this._hoverlayer=this.getLayer(rq)),a||(a=n.ctx,a.save()),bc(a,s,i,o===r-1))}a&&a.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(rq)},e.prototype.paintOne=function(t,r){Fue(t,r)},e.prototype._paintList=function(t,r,n,i){if(this._redrawId===i){n=n||!1,this._updateLayerStatus(t);var a=this._doPaintList(t,r,n),o=a.finished,s=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),s&&this._paintHoverList(t),o)this.eachLayer(function(u){u.afterBrush&&u.afterBrush()});else{var l=this;TN(function(){l._paintList(t,r,n,i)})}}},e.prototype._compositeManually=function(){var t=this.getLayer(Mf).ctx,r=this._domRoot.width,n=this._domRoot.height;t.clearRect(0,0,r,n),this.eachBuiltinLayer(function(i){i.virtual&&t.drawImage(i.dom,0,0,r,n)})},e.prototype._doPaintList=function(t,r,n){for(var i=this,a=[],o=this._opts.useDirtyRect,s=0;s<this._zlevelList.length;s++){var l=this._zlevelList[s],u=this._layers[l];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||n)&&a.push(u)}for(var f=!0,c=!1,h=function(p){var g=a[p],y=g.ctx,m=o&&g.createRepaintRects(t,r,d._width,d._height),b=n?g.__startIndex:g.__drawIndex,S=!n&&g.incremental&&Date.now,x=S&&Date.now(),T=g.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(g.__startIndex===g.__endIndex)g.clear(!1,T,m);else if(b===g.__startIndex){var E=t[b];(!E.incremental||!E.notClear||n)&&g.clear(!1,T,m)}b===-1&&(console.error("For some unknown reason. drawIndex is -1"),b=g.__startIndex);var P,R=function(B){var K={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(P=b;P<g.__endIndex;P++){var Z=t[P];if(Z.__inHover&&(c=!0),i._doPaintEl(Z,g,o,B,K,P===g.__endIndex-1),S){var ie=Date.now()-x;if(ie>15)break}}K.prevElClipPaths&&y.restore()};if(m)if(m.length===0)P=g.__endIndex;else for(var M=d.dpr,D=0;D<m.length;++D){var N=m[D];y.save(),y.beginPath(),y.rect(N.x*M,N.y*M,N.width*M,N.height*M),y.clip(),R(N),y.restore()}else y.save(),R(),y.restore();g.__drawIndex=P,g.__drawIndex<g.__endIndex&&(f=!1)},d=this,v=0;v<a.length;v++)h(v);return Ht.wxa&&le(this._layers,function(p){p&&p.ctx&&p.ctx.draw&&p.ctx.draw()}),{finished:f,needsRefreshHover:c}},e.prototype._doPaintEl=function(t,r,n,i,a,o){var s=r.ctx;if(n){var l=t.getPaintRect();(!i||l&&l.intersect(i))&&(bc(s,t,a,o),t.setPrevPaintRect(l))}else bc(s,t,a,o)},e.prototype.getLayer=function(t,r){this._singleCanvas&&!this._needsManuallyCompositing&&(t=Mf);var n=this._layers[t];return n||(n=new $P("zr_"+t,this,this.dpr),n.zlevel=t,n.__builtin__=!0,this._layerConfig[t]?lr(n,this._layerConfig[t],!0):this._layerConfig[t-k1]&&lr(n,this._layerConfig[t-k1],!0),r&&(n.virtual=r),this.insertLayer(t,n),n.initContext()),n},e.prototype.insertLayer=function(t,r){var n=this._layers,i=this._zlevelList,a=i.length,o=this._domRoot,s=null,l=-1;if(!n[t]&&Kkt(r)){if(a>0&&t>i[0]){for(l=0;l<a-1&&!(i[l]<t&&i[l+1]>t);l++);s=n[i[l]]}if(i.splice(l+1,0,t),n[t]=r,!r.virtual)if(s){var u=s.dom;u.nextSibling?o.insertBefore(r.dom,u.nextSibling):o.appendChild(r.dom)}else o.firstChild?o.insertBefore(r.dom,o.firstChild):o.appendChild(r.dom);r.__painter=this}},e.prototype.eachLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i];t.call(r,this._layers[a],a)}},e.prototype.eachBuiltinLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__&&t.call(r,o,a)}},e.prototype.eachOtherLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__||t.call(r,o,a)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(c,h){c.__dirty=c.__used=!1});function r(c){a&&(a.__endIndex!==c&&(a.__dirty=!0),a.__endIndex=c)}if(this._singleCanvas)for(var n=1;n<t.length;n++){var i=t[n];if(i.zlevel!==t[n-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var a=null,o=0,s,l;for(l=0;l<t.length;l++){var i=t[l],u=i.zlevel,f=void 0;s!==u&&(s=u,o=0),i.incremental?(f=this.getLayer(u+Ykt,this._needsManuallyCompositing),f.incremental=!0,o=1):f=this.getLayer(u+(o>0?k1:0),this._needsManuallyCompositing),f.__builtin__||s3("ZLevel "+u+" has been used by unkown layer "+f.id),f!==a&&(f.__used=!0,f.__startIndex!==l&&(f.__dirty=!0),f.__startIndex=l,f.incremental?f.__drawIndex=-1:f.__drawIndex=l,r(l),a=f),i.__dirty&Ji&&!i.__inHover&&(f.__dirty=!0,f.incremental&&f.__drawIndex<0&&(f.__drawIndex=l))}r(l),this.eachBuiltinLayer(function(c,h){!c.__used&&c.getElementCount()>0&&(c.__dirty=!0,c.__startIndex=c.__endIndex=c.__drawIndex=0),c.__dirty&&c.__drawIndex<0&&(c.__drawIndex=c.__startIndex)})},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(t){t.clear()},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t,le(this._layers,function(r){r.setUnpainted()})},e.prototype.configLayer=function(t,r){if(r){var n=this._layerConfig;n[t]?lr(n[t],r,!0):n[t]=r;for(var i=0;i<this._zlevelList.length;i++){var a=this._zlevelList[i];if(a===t||a===t+k1){var o=this._layers[a];lr(o,n[t],!0)}}}},e.prototype.delLayer=function(t){var r=this._layers,n=this._zlevelList,i=r[t];i&&(i.dom.parentNode.removeChild(i.dom),delete r[t],n.splice(ar(n,t),1))},e.prototype.resize=function(t,r){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var i=this._opts,a=this.root;if(t!=null&&(i.width=t),r!=null&&(i.height=r),t=w1(a,0,i),r=w1(a,1,i),n.style.display="",this._width!==t||r!==this._height){n.style.width=t+"px",n.style.height=r+"px";for(var o in this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(t,r);this.refresh(!0)}this._width=t,this._height=r}else{if(t==null||r==null)return;this._width=t,this._height=r,this.getLayer(Mf).resize(t,r)}return this},e.prototype.clearLayer=function(t){var r=this._layers[t];r&&r.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[Mf].dom;var r=new $P("image",this,t.pixelRatio||this.dpr);r.initContext(),r.clear(!1,t.backgroundColor||this._backgroundColor);var n=r.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var i=r.dom.width,a=r.dom.height;this.eachLayer(function(c){c.__builtin__?n.drawImage(c.dom,0,0,i,a):c.renderToCanvas&&(n.save(),c.renderToCanvas(n),n.restore())})}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},s=this.storage.getDisplayList(!0),l=0,u=s.length;l<u;l++){var f=s[l];bc(n,f,o,l===u-1)}return r.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();const Zkt=qkt;function Jkt(e){e.registerPainter("canvas",Zkt)}var Qkt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r){return i4(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(r){var n=new Zn,i=yg("line",0,r.itemHeight/2,r.itemWidth,0,r.lineStyle.stroke,!1);n.add(i),i.setStyle(r.lineStyle);var a=this.getData().getVisual("symbol"),o=this.getData().getVisual("symbolRotate"),s=a==="none"?"circle":a,l=r.itemHeight*.8,u=yg(s,(r.itemWidth-l)/2,(r.itemHeight-l)/2,l,l,r.itemStyle.fill);n.add(u),u.setStyle(r.itemStyle);var f=r.iconRotate==="inherit"?o:r.iconRotate||0;return u.rotation=f*Math.PI/180,u.setOrigin([r.itemWidth/2,r.itemHeight/2]),s.indexOf("empty")>-1&&(u.style.stroke=u.style.fill,u.style.fill="#fff",u.style.lineWidth=2),n},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(Bu);const eAt=Qkt;function f4(e,t){var r=e.mapDimensionsAll("defaultedLabel"),n=r.length;if(n===1){var i=gg(e,t,r[0]);return i!=null?i+"":null}else if(n){for(var a=[],o=0;o<r.length;o++)a.push(gg(e,t,r[o]));return a.join(" ")}}function kfe(e,t){var r=e.mapDimensionsAll("defaultedLabel");if(!Ze(t))return t+"";for(var n=[],i=0;i<r.length;i++){var a=e.getDimensionIndex(r[i]);a>=0&&n.push(t[a])}return n.join(" ")}var tAt=function(e){je(t,e);function t(r,n,i,a){var o=e.call(this)||this;return o.updateData(r,n,i,a),o}return t.prototype._createSymbol=function(r,n,i,a,o){this.removeAll();var s=yg(r,-1,-1,2,2,null,o);s.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),s.drift=rAt,this._symbolType=r,this.add(s)},t.prototype.stopSymbolAnimation=function(r){this.childAt(0).stopAnimation(null,r)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){DT(this.childAt(0))},t.prototype.downplay=function(){NT(this.childAt(0))},t.prototype.setZ=function(r,n){var i=this.childAt(0);i.zlevel=r,i.z=n},t.prototype.setDraggable=function(r,n){var i=this.childAt(0);i.draggable=r,i.cursor=!n&&r?"move":i.cursor},t.prototype.updateData=function(r,n,i,a){this.silent=!1;var o=r.getItemVisual(n,"symbol")||"circle",s=r.hostModel,l=t.getSymbolSize(r,n),u=o!==this._symbolType,f=a&&a.disableAnimation;if(u){var c=r.getItemVisual(n,"symbolKeepAspect");this._createSymbol(o,r,n,l,c)}else{var h=this.childAt(0);h.silent=!1;var d={scaleX:l[0]/2,scaleY:l[1]/2};f?h.attr(d):Si(h,d,s,n),A3(h)}if(this._updateCommon(r,n,l,i,a),u){var h=this.childAt(0);if(!f){var d={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:h.style.opacity}};h.scaleX=h.scaleY=0,h.style.opacity=0,Aa(h,d,s,n)}}f&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(r,n,i,a,o){var s=this.childAt(0),l=r.hostModel,u,f,c,h,d,v,p,g,y;if(a&&(u=a.emphasisItemStyle,f=a.blurItemStyle,c=a.selectItemStyle,h=a.focus,d=a.blurScope,p=a.labelStatesModels,g=a.hoverScale,y=a.cursorStyle,v=a.emphasisDisabled),!a||r.hasItemOption){var m=a&&a.itemModel?a.itemModel:r.getItemModel(n),b=m.getModel("emphasis");u=b.getModel("itemStyle").getItemStyle(),c=m.getModel(["select","itemStyle"]).getItemStyle(),f=m.getModel(["blur","itemStyle"]).getItemStyle(),h=b.get("focus"),d=b.get("blurScope"),v=b.get("disabled"),p=kS(m),g=b.getShallow("scale"),y=m.getShallow("cursor")}var S=r.getItemVisual(n,"symbolRotate");s.attr("rotation",(S||0)*Math.PI/180||0);var x=Mue(r.getItemVisual(n,"symbolOffset"),i);x&&(s.x=x[0],s.y=x[1]),y&&s.attr("cursor",y);var T=r.getItemVisual(n,"style"),E=T.fill;if(s instanceof mh){var P=s.style;s.useStyle(Ne({image:P.image,x:P.x,y:P.y,width:P.width,height:P.height},T))}else s.__isEmptyBrush?s.useStyle(Ne({},T)):s.useStyle(T),s.style.decal=null,s.setColor(E,o&&o.symbolInnerColor),s.style.strokeNoScale=!0;var R=r.getItemVisual(n,"liftZ"),M=this._z2;R!=null?M==null&&(this._z2=s.z2,s.z2+=R):M!=null&&(s.z2=M,this._z2=null);var D=o&&o.useNameLabel;RS(s,p,{labelFetcher:l,labelDataIndex:n,defaultText:N,inheritColor:E,defaultOpacity:T.opacity});function N(Z){return D?r.getName(Z):f4(r,Z)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var B=s.ensureState("emphasis");B.style=u,s.ensureState("select").style=c,s.ensureState("blur").style=f;var K=g==null||g===!0?Math.max(1.1,3/this._sizeY):isFinite(g)&&g>0?+g:1;B.scaleX=this._sizeX*K,B.scaleY=this._sizeY*K,this.setSymbolScale(1),pw(this,h,d,v)},t.prototype.setSymbolScale=function(r){this.scaleX=this.scaleY=r},t.prototype.fadeOut=function(r,n,i){var a=this.childAt(0),o=or(this).dataIndex,s=i&&i.animation;if(this.silent=a.silent=!0,i&&i.fadeLabel){var l=a.getTextContent();l&&$T(l,{style:{opacity:0}},n,{dataIndex:o,removeOpt:s,cb:function(){a.removeTextContent()}})}else a.removeTextContent();$T(a,{style:{opacity:0},scaleX:0,scaleY:0},n,{dataIndex:o,cb:r,removeOpt:s})},t.getSymbolSize=function(r,n){return TEt(r.getItemVisual(n,"symbolSize"))},t}(Zn);function rAt(e,t){this.parent.drift(e,t)}const c4=tAt;function HP(e,t,r,n){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(n.isIgnore&&n.isIgnore(r))&&!(n.clipShape&&!n.clipShape.contain(t[0],t[1]))&&e.getItemVisual(r,"symbol")!=="none"}function nq(e){return e!=null&&!vt(e)&&(e={isIgnore:e}),e||{}}function iq(e){var t=e.hostModel,r=t.getModel("emphasis");return{emphasisItemStyle:r.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:r.get("focus"),blurScope:r.get("blurScope"),emphasisDisabled:r.get("disabled"),hoverScale:r.get("scale"),labelStatesModels:kS(t),cursorStyle:t.get("cursor")}}var nAt=function(){function e(t){this.group=new Zn,this._SymbolCtor=t||c4}return e.prototype.updateData=function(t,r){this._progressiveEls=null,r=nq(r);var n=this.group,i=t.hostModel,a=this._data,o=this._SymbolCtor,s=r.disableAnimation,l=iq(t),u={disableAnimation:s},f=r.getSymbolPoint||function(c){return t.getItemLayout(c)};a||n.removeAll(),t.diff(a).add(function(c){var h=f(c);if(HP(t,h,c,r)){var d=new o(t,c,l,u);d.setPosition(h),t.setItemGraphicEl(c,d),n.add(d)}}).update(function(c,h){var d=a.getItemGraphicEl(h),v=f(c);if(!HP(t,v,c,r)){n.remove(d);return}var p=t.getItemVisual(c,"symbol")||"circle",g=d&&d.getSymbolType&&d.getSymbolType();if(!d||g&&g!==p)n.remove(d),d=new o(t,c,l,u),d.setPosition(v);else{d.updateData(t,c,l,u);var y={x:v[0],y:v[1]};s?d.attr(y):Si(d,y,i)}n.add(d),t.setItemGraphicEl(c,d)}).remove(function(c){var h=a.getItemGraphicEl(c);h&&h.fadeOut(function(){n.remove(h)},i)}).execute(),this._getSymbolPoint=f,this._data=t},e.prototype.updateLayout=function(){var t=this,r=this._data;r&&r.eachItemGraphicEl(function(n,i){var a=t._getSymbolPoint(i);n.setPosition(a),n.markRedraw()})},e.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=iq(t),this._data=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(t,r,n){this._progressiveEls=[],n=nq(n);function i(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var a=t.start;a<t.end;a++){var o=r.getItemLayout(a);if(HP(r,o,a,n)){var s=new this._SymbolCtor(r,a,this._seriesScope);s.traverse(i),s.setPosition(o),this.group.add(s),r.setItemGraphicEl(a,s),this._progressiveEls.push(s)}}},e.prototype.eachRendered=function(t){TE(this._progressiveEls||this.group,t)},e.prototype.remove=function(t){var r=this.group,n=this._data;n&&t?n.eachItemGraphicEl(function(i){i.fadeOut(function(){r.remove(i)},n.hostModel)}):r.removeAll()},e}();const Afe=nAt;function Pfe(e,t,r){var n=e.getBaseAxis(),i=e.getOtherAxis(n),a=iAt(i,r),o=n.dim,s=i.dim,l=t.mapDimension(s),u=t.mapDimension(o),f=s==="x"||s==="radius"?1:0,c=ct(e.dimensions,function(v){return t.mapDimension(v)}),h=!1,d=t.getCalculationInfo("stackResultDimension");return Zc(t,c[0])&&(h=!0,c[0]=d),Zc(t,c[1])&&(h=!0,c[1]=d),{dataDimsForPoint:c,valueStart:a,valueAxisDim:s,baseAxisDim:o,stacked:!!h,valueDim:l,baseDim:u,baseDataOffset:f,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function iAt(e,t){var r=0,n=e.scale.getExtent();return t==="start"?r=n[0]:t==="end"?r=n[1]:Sr(t)&&!isNaN(t)?r=t:n[0]>0?r=n[0]:n[1]<0&&(r=n[1]),r}function Ife(e,t,r,n){var i=NaN;e.stacked&&(i=r.get(r.getCalculationInfo("stackedOverDimension"),n)),isNaN(i)&&(i=e.valueStart);var a=e.baseDataOffset,o=[];return o[a]=r.get(e.baseDim,n),o[1-a]=i,t.dataToPoint(o)}function aAt(e,t){var r=[];return t.diff(e).add(function(n){r.push({cmd:"+",idx:n})}).update(function(n,i){r.push({cmd:"=",idx:i,idx1:n})}).remove(function(n){r.push({cmd:"-",idx:n})}).execute(),r}function oAt(e,t,r,n,i,a,o,s){for(var l=aAt(e,t),u=[],f=[],c=[],h=[],d=[],v=[],p=[],g=Pfe(i,t,o),y=e.getLayout("points")||[],m=t.getLayout("points")||[],b=0;b<l.length;b++){var S=l[b],x=!0,T=void 0,E=void 0;switch(S.cmd){case"=":T=S.idx*2,E=S.idx1*2;var P=y[T],R=y[T+1],M=m[E],D=m[E+1];(isNaN(P)||isNaN(R))&&(P=M,R=D),u.push(P,R),f.push(M,D),c.push(r[T],r[T+1]),h.push(n[E],n[E+1]),p.push(t.getRawIndex(S.idx1));break;case"+":var N=S.idx,B=g.dataDimsForPoint,K=i.dataToPoint([t.get(B[0],N),t.get(B[1],N)]);E=N*2,u.push(K[0],K[1]),f.push(m[E],m[E+1]);var Z=Ife(g,i,t,N);c.push(Z[0],Z[1]),h.push(n[E],n[E+1]),p.push(t.getRawIndex(N));break;case"-":x=!1}x&&(d.push(S),v.push(v.length))}v.sort(function(L,V){return p[L]-p[V]});for(var ie=u.length,me=nl(ie),k=nl(ie),w=nl(ie),C=nl(ie),O=[],b=0;b<v.length;b++){var _=v[b],A=b*2,I=_*2;me[A]=u[I],me[A+1]=u[I+1],k[A]=f[I],k[A+1]=f[I+1],w[A]=c[I],w[A+1]=c[I+1],C[A]=h[I],C[A+1]=h[I+1],O[b]=d[_]}return{current:me,next:k,stackedOnCurrent:w,stackedOnNext:C,status:O}}var jl=Math.min,Wl=Math.max;function Ec(e,t){return isNaN(e)||isNaN(t)}function cL(e,t,r,n,i,a,o,s,l){for(var u,f,c,h,d,v,p=r,g=0;g<n;g++){var y=t[p*2],m=t[p*2+1];if(p>=i||p<0)break;if(Ec(y,m)){if(l){p+=a;continue}break}if(p===r)e[a>0?"moveTo":"lineTo"](y,m),c=y,h=m;else{var b=y-u,S=m-f;if(b*b+S*S<.5){p+=a;continue}if(o>0){for(var x=p+a,T=t[x*2],E=t[x*2+1];T===y&&E===m&&g<n;)g++,x+=a,p+=a,T=t[x*2],E=t[x*2+1],y=t[p*2],m=t[p*2+1],b=y-u,S=m-f;var P=g+1;if(l)for(;Ec(T,E)&&P<n;)P++,x+=a,T=t[x*2],E=t[x*2+1];var R=.5,M=0,D=0,N=void 0,B=void 0;if(P>=n||Ec(T,E))d=y,v=m;else{M=T-u,D=E-f;var K=y-u,Z=T-y,ie=m-f,me=E-m,k=void 0,w=void 0;if(s==="x"){k=Math.abs(K),w=Math.abs(Z);var C=M>0?1:-1;d=y-C*k*o,v=m,N=y+C*w*o,B=m}else if(s==="y"){k=Math.abs(ie),w=Math.abs(me);var O=D>0?1:-1;d=y,v=m-O*k*o,N=y,B=m+O*w*o}else k=Math.sqrt(K*K+ie*ie),w=Math.sqrt(Z*Z+me*me),R=w/(w+k),d=y-M*o*(1-R),v=m-D*o*(1-R),N=y+M*o*R,B=m+D*o*R,N=jl(N,Wl(T,y)),B=jl(B,Wl(E,m)),N=Wl(N,jl(T,y)),B=Wl(B,jl(E,m)),M=N-y,D=B-m,d=y-M*k/w,v=m-D*k/w,d=jl(d,Wl(u,y)),v=jl(v,Wl(f,m)),d=Wl(d,jl(u,y)),v=Wl(v,jl(f,m)),M=y-d,D=m-v,N=y+M*w/k,B=m+D*w/k}e.bezierCurveTo(c,h,d,v,y,m),c=N,h=B}else e.lineTo(y,m)}u=y,f=m,p+=a}return g}var Mfe=function(){function e(){this.smooth=0,this.smoothConstraint=!0}return e}(),sAt=function(e){je(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polyline",n}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Mfe},t.prototype.buildPath=function(r,n){var i=n.points,a=0,o=i.length/2;if(n.connectNulls){for(;o>0&&Ec(i[o*2-2],i[o*2-1]);o--);for(;a<o&&Ec(i[a*2],i[a*2+1]);a++);}for(;a<o;)a+=cL(r,i,a,o,o,1,n.smooth,n.smoothMonotone,n.connectNulls)+1},t.prototype.getPointOn=function(r,n){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,a=i.data,o=$u.CMD,s,l,u=n==="x",f=[],c=0;c<a.length;){var h=a[c++],d=void 0,v=void 0,p=void 0,g=void 0,y=void 0,m=void 0,b=void 0;switch(h){case o.M:s=a[c++],l=a[c++];break;case o.L:if(d=a[c++],v=a[c++],b=u?(r-s)/(d-s):(r-l)/(v-l),b<=1&&b>=0){var S=u?(v-l)*b+l:(d-s)*b+s;return u?[r,S]:[S,r]}s=d,l=v;break;case o.C:d=a[c++],v=a[c++],p=a[c++],g=a[c++],y=a[c++],m=a[c++];var x=u?xT(s,d,p,y,r,f):xT(l,v,g,m,r,f);if(x>0)for(var T=0;T<x;T++){var E=f[T];if(E<=1&&E>=0){var S=u?mn(l,v,g,m,E):mn(s,d,p,y,E);return u?[r,S]:[S,r]}}s=y,l=m;break}}},t}(hr),lAt=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Mfe),uAt=function(e){je(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polygon",n}return t.prototype.getDefaultShape=function(){return new lAt},t.prototype.buildPath=function(r,n){var i=n.points,a=n.stackedOnPoints,o=0,s=i.length/2,l=n.smoothMonotone;if(n.connectNulls){for(;s>0&&Ec(i[s*2-2],i[s*2-1]);s--);for(;o<s&&Ec(i[o*2],i[o*2+1]);o++);}for(;o<s;){var u=cL(r,i,o,s,s,1,n.smooth,l,n.connectNulls);cL(r,a,o+u-1,u,s,-1,n.stackedOnSmooth,l,n.connectNulls),o+=u+1,r.closePath()}},t}(hr);function Dfe(e,t,r,n,i){var a=e.getArea(),o=a.x,s=a.y,l=a.width,u=a.height,f=r.get(["lineStyle","width"])||2;o-=f/2,s-=f/2,l+=f,u+=f,o=Math.floor(o),l=Math.round(l);var c=new Cn({shape:{x:o,y:s,width:l,height:u}});if(t){var h=e.getBaseAxis(),d=h.isHorizontal(),v=h.inverse;d?(v&&(c.shape.x+=l),c.shape.width=0):(v||(c.shape.y+=u),c.shape.height=0);var p=gt(i)?function(g){i(g,c)}:null;Aa(c,{shape:{width:l,height:u,x:o,y:s}},r,null,n,p)}return c}function Nfe(e,t,r){var n=e.getArea(),i=vn(n.r0,1),a=vn(n.r,1),o=new bh({shape:{cx:vn(e.cx,1),cy:vn(e.cy,1),r0:i,r:a,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});if(t){var s=e.getBaseAxis().dim==="angle";s?o.shape.endAngle=n.startAngle:o.shape.r=i,Aa(o,{shape:{endAngle:n.endAngle,r:a}},r)}return o}function fAt(e,t,r,n,i){if(e){if(e.type==="polar")return Nfe(e,t,r);if(e.type==="cartesian2d")return Dfe(e,t,r,n,i)}else return null;return null}function h4(e,t){return e.type===t}function aq(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return;return!0}}function oq(e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,a=0;a<e.length;){var o=e[a++],s=e[a++];isNaN(o)||(t=Math.min(o,t),n=Math.max(o,n)),isNaN(s)||(r=Math.min(s,r),i=Math.max(s,i))}return[[t,r],[n,i]]}function sq(e,t){var r=oq(e),n=r[0],i=r[1],a=oq(t),o=a[0],s=a[1];return Math.max(Math.abs(n[0]-o[0]),Math.abs(n[1]-o[1]),Math.abs(i[0]-s[0]),Math.abs(i[1]-s[1]))}function lq(e){return Sr(e)?e:e?.5:0}function cAt(e,t,r){if(!r.valueDim)return[];for(var n=t.count(),i=nl(n*2),a=0;a<n;a++){var o=Ife(r,e,t,a);i[a*2]=o[0],i[a*2+1]=o[1]}return i}function Ul(e,t,r,n){var i=t.getBaseAxis(),a=i.dim==="x"||i.dim==="radius"?0:1,o=[],s=0,l=[],u=[],f=[],c=[];if(n){for(s=0;s<e.length;s+=2)!isNaN(e[s])&&!isNaN(e[s+1])&&c.push(e[s],e[s+1]);e=c}for(s=0;s<e.length-2;s+=2)switch(f[0]=e[s+2],f[1]=e[s+3],u[0]=e[s],u[1]=e[s+1],o.push(u[0],u[1]),r){case"end":l[a]=f[a],l[1-a]=u[1-a],o.push(l[0],l[1]);break;case"middle":var h=(u[a]+f[a])/2,d=[];l[a]=d[a]=h,l[1-a]=u[1-a],d[1-a]=f[1-a],o.push(l[0],l[1]),o.push(d[0],d[1]);break;default:l[a]=u[a],l[1-a]=f[1-a],o.push(l[0],l[1])}return o.push(e[s++],e[s++]),o}function hAt(e,t){var r=[],n=e.length,i,a;function o(f,c,h){var d=f.coord,v=(h-d)/(c.coord-d),p=A_t(v,[f.color,c.color]);return{coord:h,color:p}}for(var s=0;s<n;s++){var l=e[s],u=l.coord;if(u<0)i=l;else if(u>t){a?r.push(o(a,l,t)):i&&r.push(o(i,l,0),o(i,l,t));break}else i&&(r.push(o(i,l,0)),i=null),r.push(l),a=l}return r}function dAt(e,t,r){var n=e.getVisual("visualMeta");if(!(!n||!n.length||!e.count())&&t.type==="cartesian2d"){for(var i,a,o=n.length-1;o>=0;o--){var s=e.getDimensionInfo(n[o].dimension);if(i=s&&s.coordDim,i==="x"||i==="y"){a=n[o];break}}if(a){var l=t.getAxis(i),u=ct(a.stops,function(b){return{coord:l.toGlobalCoord(l.dataToCoord(b.value)),color:b.color}}),f=u.length,c=a.outerColors.slice();f&&u[0].coord>u[f-1].coord&&(u.reverse(),c.reverse());var h=hAt(u,i==="x"?r.getWidth():r.getHeight()),d=h.length;if(!d&&f)return u[0].coord<0?c[1]?c[1]:u[f-1].color:c[0]?c[0]:u[0].color;var v=10,p=h[0].coord-v,g=h[d-1].coord+v,y=g-p;if(y<.001)return"transparent";le(h,function(b){b.offset=(b.coord-p)/y}),h.push({offset:d?h[d-1].offset:.5,color:c[1]||"transparent"}),h.unshift({offset:d?h[0].offset:.5,color:c[0]||"transparent"});var m=new Rle(0,0,0,0,h,!0);return m[i]=p,m[i+"2"]=g,m}}}function vAt(e,t,r){var n=e.get("showAllSymbol"),i=n==="auto";if(!(n&&!i)){var a=r.getAxesByScale("ordinal")[0];if(a&&!(i&&pAt(a,t))){var o=t.mapDimension(a.dim),s={};return le(a.getViewLabels(),function(l){var u=a.scale.getRawOrdinalNumber(l.tickValue);s[u]=1}),function(l){return!s.hasOwnProperty(t.get(o,l))}}}}function pAt(e,t){var r=e.getExtent(),n=Math.abs(r[1]-r[0])/e.scale.count();isNaN(n)&&(n=0);for(var i=t.count(),a=Math.max(1,Math.round(i/5)),o=0;o<i;o+=a)if(c4.getSymbolSize(t,o)[e.isHorizontal()?1:0]*1.5>n)return!1;return!0}function gAt(e,t){return isNaN(e)||isNaN(t)}function yAt(e){for(var t=e.length/2;t>0&&gAt(e[t*2-2],e[t*2-1]);t--);return t-1}function uq(e,t){return[e[t*2],e[t*2+1]]}function mAt(e,t,r){for(var n=e.length/2,i=r==="x"?0:1,a,o,s=0,l=-1,u=0;u<n;u++)if(o=e[u*2+i],!(isNaN(o)||isNaN(e[u*2+1-i]))){if(u===0){a=o;continue}if(a<=t&&o>=t||a>=t&&o<=t){l=u;break}s=u,a=o}return{range:[s,l],t:(t-a)/(o-a)}}function Lfe(e){if(e.get(["endLabel","show"]))return!0;for(var t=0;t<Ma.length;t++)if(e.get([Ma[t],"endLabel","show"]))return!0;return!1}function BP(e,t,r,n){if(h4(t,"cartesian2d")){var i=n.getModel("endLabel"),a=i.get("valueAnimation"),o=n.getData(),s={lastFrameIndex:0},l=Lfe(n)?function(d,v){e._endLabelOnDuring(d,v,o,s,a,i,t)}:null,u=t.getBaseAxis().isHorizontal(),f=Dfe(t,r,n,function(){var d=e._endLabel;d&&r&&s.originalX!=null&&d.attr({x:s.originalX,y:s.originalY})},l);if(!n.get("clip",!0)){var c=f.shape,h=Math.max(c.width,c.height);u?(c.y-=h,c.height+=h*2):(c.x-=h,c.width+=h*2)}return l&&l(1,f),f}else return Nfe(t,r,n)}function bAt(e,t){var r=t.getBaseAxis(),n=r.isHorizontal(),i=r.inverse,a=n?i?"right":"left":"center",o=n?"middle":i?"top":"bottom";return{normal:{align:e.get("align")||a,verticalAlign:e.get("verticalAlign")||o}}}var wAt=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(){var r=new Zn,n=new Afe;this.group.add(n.group),this._symbolDraw=n,this._lineGroup=r},t.prototype.render=function(r,n,i){var a=this,o=r.coordinateSystem,s=this.group,l=r.getData(),u=r.getModel("lineStyle"),f=r.getModel("areaStyle"),c=l.getLayout("points")||[],h=o.type==="polar",d=this._coordSys,v=this._symbolDraw,p=this._polyline,g=this._polygon,y=this._lineGroup,m=!n.ssr&&r.isAnimationEnabled(),b=!f.isEmpty(),S=f.get("origin"),x=Pfe(o,l,S),T=b&&cAt(o,l,x),E=r.get("showSymbol"),P=r.get("connectNulls"),R=E&&!h&&vAt(r,l,o),M=this._data;M&&M.eachItemGraphicEl(function(V,Y){V.__temp&&(s.remove(V),M.setItemGraphicEl(Y,null))}),E||v.remove(),s.add(y);var D=h?!1:r.get("step"),N;o&&o.getArea&&r.get("clip",!0)&&(N=o.getArea(),N.width!=null?(N.x-=.1,N.y-=.1,N.width+=.2,N.height+=.2):N.r0&&(N.r0-=.5,N.r+=.5)),this._clipShapeForSymbol=N;var B=dAt(l,o,i)||l.getVisual("style")[l.getVisual("drawType")];if(!(p&&d.type===o.type&&D===this._step))E&&v.updateData(l,{isIgnore:R,clipShape:N,disableAnimation:!0,getSymbolPoint:function(V){return[c[V*2],c[V*2+1]]}}),m&&this._initSymbolLabelAnimation(l,o,N),D&&(c=Ul(c,o,D,P),T&&(T=Ul(T,o,D,P))),p=this._newPolyline(c),b?g=this._newPolygon(c,T):g&&(y.remove(g),g=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,Xc(B)),y.setClipPath(BP(this,o,!0,r));else{b&&!g?g=this._newPolygon(c,T):g&&!b&&(y.remove(g),g=this._polygon=null),h||this._initOrUpdateEndLabel(r,o,Xc(B));var K=y.getClipPath();if(K){var Z=BP(this,o,!1,r);Aa(K,{shape:Z.shape},r)}else y.setClipPath(BP(this,o,!0,r));E&&v.updateData(l,{isIgnore:R,clipShape:N,disableAnimation:!0,getSymbolPoint:function(V){return[c[V*2],c[V*2+1]]}}),(!aq(this._stackedOnPoints,T)||!aq(this._points,c))&&(m?this._doUpdateAnimation(l,T,o,i,D,S,P):(D&&(c=Ul(c,o,D,P),T&&(T=Ul(T,o,D,P))),p.setShape({points:c}),g&&g.setShape({points:c,stackedOnPoints:T})))}var ie=r.getModel("emphasis"),me=ie.get("focus"),k=ie.get("blurScope"),w=ie.get("disabled");if(p.useStyle(fr(u.getLineStyle(),{fill:"none",stroke:B,lineJoin:"bevel"})),LT(p,r,"lineStyle"),p.style.lineWidth>0&&r.get(["emphasis","lineStyle","width"])==="bolder"){var C=p.getState("emphasis").style;C.lineWidth=+p.style.lineWidth+1}or(p).seriesIndex=r.seriesIndex,pw(p,me,k,w);var O=lq(r.get("smooth")),_=r.get("smoothMonotone");if(p.setShape({smooth:O,smoothMonotone:_,connectNulls:P}),g){var A=l.getCalculationInfo("stackedOnSeries"),I=0;g.useStyle(fr(f.getAreaStyle(),{fill:B,opacity:.7,lineJoin:"bevel",decal:l.getVisual("style").decal})),A&&(I=lq(A.get("smooth"))),g.setShape({smooth:O,stackedOnSmooth:I,smoothMonotone:_,connectNulls:P}),LT(g,r,"areaStyle"),or(g).seriesIndex=r.seriesIndex,pw(g,me,k,w)}var L=function(V){a._changePolyState(V)};l.eachItemGraphicEl(function(V){V&&(V.onHoverStateChange=L)}),this._polyline.onHoverStateChange=L,this._data=l,this._coordSys=o,this._stackedOnPoints=T,this._points=c,this._step=D,this._valueOrigin=S,r.get("triggerLineEvent")&&(this.packEventData(r,p),g&&this.packEventData(r,g))},t.prototype.packEventData=function(r,n){or(n).eventData={componentType:"series",componentSubType:"line",componentIndex:r.componentIndex,seriesIndex:r.seriesIndex,seriesName:r.name,seriesType:"line"}},t.prototype.highlight=function(r,n,i,a){var o=r.getData(),s=Yc(o,a);if(this._changePolyState("emphasis"),!(s instanceof Array)&&s!=null&&s>=0){var l=o.getLayout("points"),u=o.getItemGraphicEl(s);if(!u){var f=l[s*2],c=l[s*2+1];if(isNaN(f)||isNaN(c)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(f,c))return;var h=r.get("zlevel")||0,d=r.get("z")||0;u=new c4(o,s),u.x=f,u.y=c,u.setZ(h,d);var v=u.getSymbolPath().getTextContent();v&&(v.zlevel=h,v.z=d,v.z2=this._polyline.z2+1),u.__temp=!0,o.setItemGraphicEl(s,u),u.stopSymbolAnimation(!0),this.group.add(u)}u.highlight()}else Qo.prototype.highlight.call(this,r,n,i,a)},t.prototype.downplay=function(r,n,i,a){var o=r.getData(),s=Yc(o,a);if(this._changePolyState("normal"),s!=null&&s>=0){var l=o.getItemGraphicEl(s);l&&(l.__temp?(o.setItemGraphicEl(s,null),this.group.remove(l)):l.downplay())}else Qo.prototype.downplay.call(this,r,n,i,a)},t.prototype._changePolyState=function(r){var n=this._polygon;gK(this._polyline,r),n&&gK(n,r)},t.prototype._newPolyline=function(r){var n=this._polyline;return n&&this._lineGroup.remove(n),n=new sAt({shape:{points:r},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(n),this._polyline=n,n},t.prototype._newPolygon=function(r,n){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new uAt({shape:{points:r,stackedOnPoints:n},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},t.prototype._initSymbolLabelAnimation=function(r,n,i){var a,o,s=n.getBaseAxis(),l=s.inverse;n.type==="cartesian2d"?(a=s.isHorizontal(),o=!1):n.type==="polar"&&(a=s.dim==="angle",o=!0);var u=r.hostModel,f=u.get("animationDuration");gt(f)&&(f=f(null));var c=u.get("animationDelay")||0,h=gt(c)?c(null):c;r.eachItemGraphicEl(function(d,v){var p=d;if(p){var g=[d.x,d.y],y=void 0,m=void 0,b=void 0;if(i)if(o){var S=i,x=n.pointToCoord(g);a?(y=S.startAngle,m=S.endAngle,b=-x[1]/180*Math.PI):(y=S.r0,m=S.r,b=x[0])}else{var T=i;a?(y=T.x,m=T.x+T.width,b=d.x):(y=T.y+T.height,m=T.y,b=d.y)}var E=m===y?0:(b-y)/(m-y);l&&(E=1-E);var P=gt(c)?c(v):f*E+h,R=p.getSymbolPath(),M=R.getTextContent();p.attr({scaleX:0,scaleY:0}),p.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:P}),M&&M.animateFrom({style:{opacity:0}},{duration:300,delay:P}),R.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(r,n,i){var a=r.getModel("endLabel");if(Lfe(r)){var o=r.getData(),s=this._polyline,l=o.getLayout("points");if(!l){s.removeTextContent(),this._endLabel=null;return}var u=this._endLabel;u||(u=this._endLabel=new Jn({z2:200}),u.ignoreClip=!0,s.setTextContent(this._endLabel),s.disableLabelAnimation=!0);var f=yAt(l);f>=0&&(RS(s,kS(r,"endLabel"),{inheritColor:i,labelFetcher:r,labelDataIndex:f,defaultText:function(c,h,d){return d!=null?kfe(o,d):f4(o,c)},enableTextSetter:!0},bAt(a,n)),s.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(r,n,i,a,o,s,l){var u=this._endLabel,f=this._polyline;if(u){r<1&&a.originalX==null&&(a.originalX=u.x,a.originalY=u.y);var c=i.getLayout("points"),h=i.hostModel,d=h.get("connectNulls"),v=s.get("precision"),p=s.get("distance")||0,g=l.getBaseAxis(),y=g.isHorizontal(),m=g.inverse,b=n.shape,S=m?y?b.x:b.y+b.height:y?b.x+b.width:b.y,x=(y?p:0)*(m?-1:1),T=(y?0:-p)*(m?-1:1),E=y?"x":"y",P=mAt(c,S,E),R=P.range,M=R[1]-R[0],D=void 0;if(M>=1){if(M>1&&!d){var N=uq(c,R[0]);u.attr({x:N[0]+x,y:N[1]+T}),o&&(D=h.getRawValue(R[0]))}else{var N=f.getPointOn(S,E);N&&u.attr({x:N[0]+x,y:N[1]+T});var B=h.getRawValue(R[0]),K=h.getRawValue(R[1]);o&&(D=k1t(i,v,B,K,P.t))}a.lastFrameIndex=R[0]}else{var Z=r===1||a.lastFrameIndex>0?R[0]:0,N=uq(c,Z);o&&(D=h.getRawValue(Z)),u.attr({x:N[0]+x,y:N[1]+T})}o&&EE(u).setLabelText(D)}},t.prototype._doUpdateAnimation=function(r,n,i,a,o,s,l){var u=this._polyline,f=this._polygon,c=r.hostModel,h=oAt(this._data,r,this._stackedOnPoints,n,this._coordSys,i,this._valueOrigin),d=h.current,v=h.stackedOnCurrent,p=h.next,g=h.stackedOnNext;if(o&&(d=Ul(h.current,i,o,l),v=Ul(h.stackedOnCurrent,i,o,l),p=Ul(h.next,i,o,l),g=Ul(h.stackedOnNext,i,o,l)),sq(d,p)>3e3||f&&sq(v,g)>3e3){u.stopAnimation(),u.setShape({points:p}),f&&(f.stopAnimation(),f.setShape({points:p,stackedOnPoints:g}));return}u.shape.__points=h.current,u.shape.points=d;var y={shape:{points:p}};h.current!==d&&(y.shape.__points=h.next),u.stopAnimation(),Si(u,y,c),f&&(f.setShape({points:d,stackedOnPoints:v}),f.stopAnimation(),Si(f,{shape:{stackedOnPoints:g}},c),u.shape.points!==f.shape.points&&(f.shape.points=u.shape.points));for(var m=[],b=h.status,S=0;S<b.length;S++){var x=b[S].cmd;if(x==="="){var T=r.getItemGraphicEl(b[S].idx1);T&&m.push({el:T,ptIdx:S})}}u.animators&&u.animators.length&&u.animators[0].during(function(){f&&f.dirtyShape();for(var E=u.shape.__points,P=0;P<m.length;P++){var R=m[P].el,M=m[P].ptIdx*2;R.x=E[M],R.y=E[M+1],R.markRedraw()}})},t.prototype.remove=function(r){var n=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(a,o){a.__temp&&(n.remove(a),i.setItemGraphicEl(o,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(Qo);const SAt=wAt;function _At(e,t){return{seriesType:e,plan:X3(),reset:function(r){var n=r.getData(),i=r.coordinateSystem,a=r.pipelineContext,o=t||a.large;if(i){var s=ct(i.dimensions,function(d){return n.mapDimension(d)}).slice(0,2),l=s.length,u=n.getCalculationInfo("stackResultDimension");Zc(n,s[0])&&(s[0]=u),Zc(n,s[1])&&(s[1]=u);var f=n.getStore(),c=n.getDimensionIndex(s[0]),h=n.getDimensionIndex(s[1]);return l&&{progress:function(d,v){for(var p=d.end-d.start,g=o&&nl(p*l),y=[],m=[],b=d.start,S=0;b<d.end;b++){var x=void 0;if(l===1){var T=f.get(c,b);x=i.dataToPoint(T,null,m)}else y[0]=f.get(c,b),y[1]=f.get(h,b),x=i.dataToPoint(y,null,m);o?(g[S++]=x[0],g[S++]=x[1]):v.setItemLayout(b,x.slice())}o&&v.setLayout("points",g)}}}}}}var CAt={average:function(e){for(var t=0,r=0,n=0;n<e.length;n++)isNaN(e[n])||(t+=e[n],r++);return r===0?NaN:t/r},sum:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r]||0;return t},max:function(e){for(var t=-1/0,r=0;r<e.length;r++)e[r]>t&&(t=e[r]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,r=0;r<e.length;r++)e[r]<t&&(t=e[r]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},xAt=function(e){return Math.round(e.length/2)};function Ffe(e){return{seriesType:e,reset:function(t,r,n){var i=t.getData(),a=t.get("sampling"),o=t.coordinateSystem,s=i.count();if(s>10&&o.type==="cartesian2d"&&a){var l=o.getBaseAxis(),u=o.getOtherAxis(l),f=l.getExtent(),c=n.getDevicePixelRatio(),h=Math.abs(f[1]-f[0])*(c||1),d=Math.round(s/h);if(isFinite(d)&&d>1){a==="lttb"&&t.setData(i.lttbDownSample(i.mapDimension(u.dim),1/d));var v=void 0;st(a)?v=CAt[a]:gt(a)&&(v=a),v&&t.setData(i.downSample(i.mapDimension(u.dim),1/d,v,xAt))}}}}}function TAt(e){e.registerChartView(SAt),e.registerSeriesModel(eAt),e.registerLayout(_At("line",!0)),e.registerVisual({seriesType:"line",reset:function(t){var r=t.getData(),n=t.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=r.getVisual("style").fill),r.setVisual("legendLineStyle",n)}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Ffe("line"))}var $fe=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){return i4(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(r,n,i){var a=this.coordinateSystem;if(a&&a.clampData){var o=a.clampData(r),s=a.dataToPoint(o);if(i)le(a.getAxes(),function(h,d){if(h.type==="category"&&n!=null){var v=h.getTicksCoords(),p=o[d],g=n[d]==="x1"||n[d]==="y1";if(g&&(p+=1),v.length<2)return;if(v.length===2){s[d]=h.toGlobalCoord(h.getExtent()[g?1:0]);return}for(var y=void 0,m=void 0,b=1,S=0;S<v.length;S++){var x=v[S].coord,T=S===v.length-1?v[S-1].tickValue+b:v[S].tickValue;if(T===p){m=x;break}else if(T<p)y=x;else if(y!=null&&T>p){m=(x+y)/2;break}S===1&&(b=T-v[0].tickValue)}m==null&&(y?y&&(m=v[v.length-1].coord):m=v[0].coord),s[d]=h.toGlobalCoord(m)}});else{var l=this.getData(),u=l.getLayout("offset"),f=l.getLayout("size"),c=a.getBaseAxis().isHorizontal()?0:1;s[c]+=u+f/2}return s}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(Bu);Bu.registerClass($fe);const fq=$fe;var OAt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(){return i4(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},t.prototype.getProgressiveThreshold=function(){var r=this.get("progressiveThreshold"),n=this.get("largeThreshold");return n>r&&(r=n),r},t.prototype.brushSelector=function(r,n,i){return i.rect(n.getItemLayout(r))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=Lle(fq.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(fq);const EAt=OAt;var RAt=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),kAt=function(e){je(t,e);function t(r){var n=e.call(this,r)||this;return n.type="sausage",n}return t.prototype.getDefaultShape=function(){return new RAt},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r0||0,0),s=Math.max(n.r,0),l=(s-o)*.5,u=o+l,f=n.startAngle,c=n.endAngle,h=n.clockwise,d=Math.PI*2,v=h?c-f<d:f-c<d;v||(f=c-(h?d:-d));var p=Math.cos(f),g=Math.sin(f),y=Math.cos(c),m=Math.sin(c);v?(r.moveTo(p*o+i,g*o+a),r.arc(p*u+i,g*u+a,l,-Math.PI+f,f,!h)):r.moveTo(p*s+i,g*s+a),r.arc(i,a,s,f,c,!h),r.arc(y*u+i,m*u+a,l,c-Math.PI*2,c-Math.PI,!h),o!==0&&r.arc(i,a,o,c,f,h)},t}(hr);const cq=kAt;function AAt(e,t){t=t||{};var r=t.isRoundCap;return function(n,i,a){var o=i.position;if(!o||o instanceof Array)return kT(n,i,a);var s=e(o),l=i.distance!=null?i.distance:5,u=this.shape,f=u.cx,c=u.cy,h=u.r,d=u.r0,v=(h+d)/2,p=u.startAngle,g=u.endAngle,y=(p+g)/2,m=r?Math.abs(h-d)/2:0,b=Math.cos,S=Math.sin,x=f+h*b(p),T=c+h*S(p),E="left",P="top";switch(s){case"startArc":x=f+(d-l)*b(y),T=c+(d-l)*S(y),E="center",P="top";break;case"insideStartArc":x=f+(d+l)*b(y),T=c+(d+l)*S(y),E="center",P="bottom";break;case"startAngle":x=f+v*b(p)+A1(p,l+m,!1),T=c+v*S(p)+P1(p,l+m,!1),E="right",P="middle";break;case"insideStartAngle":x=f+v*b(p)+A1(p,-l+m,!1),T=c+v*S(p)+P1(p,-l+m,!1),E="left",P="middle";break;case"middle":x=f+v*b(y),T=c+v*S(y),E="center",P="middle";break;case"endArc":x=f+(h+l)*b(y),T=c+(h+l)*S(y),E="center",P="bottom";break;case"insideEndArc":x=f+(h-l)*b(y),T=c+(h-l)*S(y),E="center",P="top";break;case"endAngle":x=f+v*b(g)+A1(g,l+m,!0),T=c+v*S(g)+P1(g,l+m,!0),E="left",P="middle";break;case"insideEndAngle":x=f+v*b(g)+A1(g,-l+m,!0),T=c+v*S(g)+P1(g,-l+m,!0),E="right",P="middle";break;default:return kT(n,i,a)}return n=n||{},n.x=x,n.y=T,n.align=E,n.verticalAlign=P,n}}function PAt(e,t,r,n){if(Sr(n)){e.setTextConfig({rotation:n});return}else if(Ze(t)){e.setTextConfig({rotation:0});return}var i=e.shape,a=i.clockwise?i.startAngle:i.endAngle,o=i.clockwise?i.endAngle:i.startAngle,s=(a+o)/2,l,u=r(t);switch(u){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=s;break;case"startAngle":case"insideStartAngle":l=a;break;case"endAngle":case"insideEndAngle":l=o;break;default:e.setTextConfig({rotation:0});return}var f=Math.PI*1.5-l;u==="middle"&&f>Math.PI/2&&f<Math.PI*1.5&&(f-=Math.PI),e.setTextConfig({rotation:f})}function A1(e,t,r){return t*Math.sin(e)*(r?-1:1)}function P1(e,t,r){return t*Math.cos(e)*(r?1:-1)}function am(e,t,r){var n=e.get("borderRadius");if(n==null)return r?{cornerRadius:0}:null;Ze(n)||(n=[n,n,n,n]);var i=Math.abs(t.r||0-t.r0||0);return{cornerRadius:ct(n,function(a){return Fu(a,i)})}}var VP=Math.max,jP=Math.min;function IAt(e,t){var r=e.getArea&&e.getArea();if(h4(e,"cartesian2d")){var n=e.getBaseAxis();if(n.type!=="category"||!n.onBand){var i=t.getLayout("bandWidth");n.isHorizontal()?(r.x-=i,r.width+=i*2):(r.y-=i,r.height+=i*2)}}return r}var MAt=function(e){je(t,e);function t(){var r=e.call(this)||this;return r.type=t.type,r._isFirstFrame=!0,r}return t.prototype.render=function(r,n,i,a){this._model=r,this._removeOnRenderedListener(i),this._updateDrawMode(r);var o=r.get("coordinateSystem");(o==="cartesian2d"||o==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(r,n,i):this._renderNormal(r,n,i,a))},t.prototype.incrementalPrepareRender=function(r){this._clear(),this._updateDrawMode(r),this._updateLargeClip(r)},t.prototype.incrementalRender=function(r,n){this._progressiveEls=[],this._incrementalRenderLarge(r,n)},t.prototype.eachRendered=function(r){TE(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},t.prototype._renderNormal=function(r,n,i,a){var o=this.group,s=r.getData(),l=this._data,u=r.coordinateSystem,f=u.getBaseAxis(),c;u.type==="cartesian2d"?c=f.isHorizontal():u.type==="polar"&&(c=f.dim==="angle");var h=r.isAnimationEnabled()?r:null,d=DAt(r,u);d&&this._enableRealtimeSort(d,s,i);var v=r.get("clip",!0)||d,p=IAt(u,s);o.removeClipPath();var g=r.get("roundCap",!0),y=r.get("showBackground",!0),m=r.getModel("backgroundStyle"),b=m.get("borderRadius")||0,S=[],x=this._backgroundEls,T=a&&a.isInitSort,E=a&&a.type==="changeAxisOrder";function P(D){var N=I1[u.type](s,D),B=VAt(u,c,N);return B.useStyle(m.getItemStyle()),u.type==="cartesian2d"?B.setShape("r",b):B.setShape("cornerRadius",b),S[D]=B,B}s.diff(l).add(function(D){var N=s.getItemModel(D),B=I1[u.type](s,D,N);if(y&&P(D),!(!s.hasValue(D)||!gq[u.type](B))){var K=!1;v&&(K=hq[u.type](p,B));var Z=dq[u.type](r,s,D,B,c,h,f.model,!1,g);d&&(Z.forceLabelAnimation=!0),yq(Z,s,D,N,B,r,c,u.type==="polar"),T?Z.attr({shape:B}):d?vq(d,h,Z,B,D,c,!1,!1):Aa(Z,{shape:B},r,D),s.setItemGraphicEl(D,Z),o.add(Z),Z.ignore=K}}).update(function(D,N){var B=s.getItemModel(D),K=I1[u.type](s,D,B);if(y){var Z=void 0;x.length===0?Z=P(N):(Z=x[N],Z.useStyle(m.getItemStyle()),u.type==="cartesian2d"?Z.setShape("r",b):Z.setShape("cornerRadius",b),S[D]=Z);var ie=I1[u.type](s,D),me=Bfe(c,ie,u);Si(Z,{shape:me},h,D)}var k=l.getItemGraphicEl(N);if(!s.hasValue(D)||!gq[u.type](K)){o.remove(k);return}var w=!1;if(v&&(w=hq[u.type](p,K),w&&o.remove(k)),k?A3(k):k=dq[u.type](r,s,D,K,c,h,f.model,!!k,g),d&&(k.forceLabelAnimation=!0),E){var C=k.getTextContent();if(C){var O=EE(C);O.prevValue!=null&&(O.prevValue=O.value)}}else yq(k,s,D,B,K,r,c,u.type==="polar");T?k.attr({shape:K}):d?vq(d,h,k,K,D,c,!0,E):Si(k,{shape:K},r,D,null),s.setItemGraphicEl(D,k),k.ignore=w,o.add(k)}).remove(function(D){var N=l.getItemGraphicEl(D);N&&HT(N,r,D)}).execute();var R=this._backgroundGroup||(this._backgroundGroup=new Zn);R.removeAll();for(var M=0;M<S.length;++M)R.add(S[M]);o.add(R),this._backgroundEls=S,this._data=s},t.prototype._renderLarge=function(r,n,i){this._clear(),bq(r,this.group),this._updateLargeClip(r)},t.prototype._incrementalRenderLarge=function(r,n){this._removeBackground(),bq(n,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(r){var n=r.get("clip",!0)&&fAt(r.coordinateSystem,!1,r),i=this.group;n?i.setClipPath(n):i.removeClipPath()},t.prototype._enableRealtimeSort=function(r,n,i){var a=this;if(n.count()){var o=r.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(n,r,i),this._isFirstFrame=!1;else{var s=function(l){var u=n.getItemGraphicEl(l),f=u&&u.shape;return f&&Math.abs(o.isHorizontal()?f.height:f.width)||0};this._onRendered=function(){a._updateSortWithinSameData(n,s,o,i)},i.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(r,n,i){var a=[];return r.each(r.mapDimension(n.dim),function(o,s){var l=i(s);l=l??NaN,a.push({dataIndex:s,mappedValue:l,ordinalNumber:o})}),a.sort(function(o,s){return s.mappedValue-o.mappedValue}),{ordinalNumbers:ct(a,function(o){return o.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(r,n,i){for(var a=i.scale,o=r.mapDimension(i.dim),s=Number.MAX_VALUE,l=0,u=a.getOrdinalMeta().categories.length;l<u;++l){var f=r.rawIndexOf(o,a.getRawOrdinalNumber(l)),c=f<0?Number.MIN_VALUE:n(r.indexOfRawIndex(f));if(c>s)return!0;s=c}return!1},t.prototype._isOrderDifferentInView=function(r,n){for(var i=n.scale,a=i.getExtent(),o=Math.max(0,a[0]),s=Math.min(a[1],i.getOrdinalMeta().categories.length-1);o<=s;++o)if(r.ordinalNumbers[o]!==i.getRawOrdinalNumber(o))return!0},t.prototype._updateSortWithinSameData=function(r,n,i,a){if(this._isOrderChangedWithinSameData(r,n,i)){var o=this._dataSort(r,i,n);this._isOrderDifferentInView(o,i)&&(this._removeOnRenderedListener(a),a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:o}))}},t.prototype._dispatchInitSort=function(r,n,i){var a=n.baseAxis,o=this._dataSort(r,a,function(s){return r.get(r.mapDimension(n.otherAxis.dim),s)});i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",isInitSort:!0,axisId:a.index,sortInfo:o})},t.prototype.remove=function(r,n){this._clear(this._model),this._removeOnRenderedListener(n)},t.prototype.dispose=function(r,n){this._removeOnRenderedListener(n)},t.prototype._removeOnRenderedListener=function(r){this._onRendered&&(r.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(r){var n=this.group,i=this._data;r&&r.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(a){HT(a,r,or(a).dataIndex)})):n.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(Qo),hq={cartesian2d:function(e,t){var r=t.width<0?-1:1,n=t.height<0?-1:1;r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height);var i=e.x+e.width,a=e.y+e.height,o=VP(t.x,e.x),s=jP(t.x+t.width,i),l=VP(t.y,e.y),u=jP(t.y+t.height,a),f=s<o,c=u<l;return t.x=f&&o>i?s:o,t.y=c&&l>a?u:l,t.width=f?0:s-o,t.height=c?0:u-l,r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height),f||c},polar:function(e,t){var r=t.r0<=t.r?1:-1;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}var i=jP(t.r,e.r),a=VP(t.r0,e.r0);t.r=i,t.r0=a;var o=i-a<0;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}return o}},dq={cartesian2d:function(e,t,r,n,i,a,o,s,l){var u=new Cn({shape:Ne({},n),z2:1});if(u.__dataIndex=r,u.name="item",a){var f=u.shape,c=i?"height":"width";f[c]=0}return u},polar:function(e,t,r,n,i,a,o,s,l){var u=!i&&l?cq:bh,f=new u({shape:n,z2:1});f.name="item";var c=Hfe(i);if(f.calculateTextPosition=AAt(c,{isRoundCap:u===cq}),a){var h=f.shape,d=i?"r":"endAngle",v={};h[d]=i?n.r0:n.startAngle,v[d]=n[d],(s?Si:Aa)(f,{shape:v},a)}return f}};function DAt(e,t){var r=e.get("realtimeSort",!0),n=t.getBaseAxis();if(r&&n.type==="category"&&t.type==="cartesian2d")return{baseAxis:n,otherAxis:t.getOtherAxis(n)}}function vq(e,t,r,n,i,a,o,s){var l,u;a?(u={x:n.x,width:n.width},l={y:n.y,height:n.height}):(u={y:n.y,height:n.height},l={x:n.x,width:n.width}),s||(o?Si:Aa)(r,{shape:l},t,i,null);var f=t?e.baseAxis.model:null;(o?Si:Aa)(r,{shape:u},f,i)}function pq(e,t){for(var r=0;r<t.length;r++)if(!isFinite(e[t[r]]))return!0;return!1}var NAt=["x","y","width","height"],LAt=["cx","cy","r","startAngle","endAngle"],gq={cartesian2d:function(e){return!pq(e,NAt)},polar:function(e){return!pq(e,LAt)}},I1={cartesian2d:function(e,t,r){var n=e.getItemLayout(t),i=r?$At(r,n):0,a=n.width>0?1:-1,o=n.height>0?1:-1;return{x:n.x+a*i/2,y:n.y+o*i/2,width:n.width-a*i,height:n.height-o*i}},polar:function(e,t,r){var n=e.getItemLayout(t);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function FAt(e){return e.startAngle!=null&&e.endAngle!=null&&e.startAngle===e.endAngle}function Hfe(e){return function(t){var r=t?"Arc":"Angle";return function(n){switch(n){case"start":case"insideStart":case"end":case"insideEnd":return n+r;default:return n}}}(e)}function yq(e,t,r,n,i,a,o,s){var l=t.getItemVisual(r,"style");if(s){if(!a.get("roundCap")){var f=e.shape,c=am(n.getModel("itemStyle"),f,!0);Ne(f,c),e.setShape(f)}}else{var u=n.get(["itemStyle","borderRadius"])||0;e.setShape("r",u)}e.useStyle(l);var h=n.getShallow("cursor");h&&e.attr("cursor",h);var d=s?o?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":o?i.height>=0?"bottom":"top":i.width>=0?"right":"left",v=kS(n);RS(e,v,{labelFetcher:a,labelDataIndex:r,defaultText:f4(a.getData(),r),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var p=e.getTextContent();if(s&&p){var g=n.get(["label","position"]);e.textConfig.inside=g==="middle"?!0:null,PAt(e,g==="outside"?d:g,Hfe(o),n.get(["label","rotate"]))}Jxt(p,v,a.getRawValue(r),function(m){return kfe(t,m)});var y=n.getModel(["emphasis"]);pw(e,y.get("focus"),y.get("blurScope"),y.get("disabled")),LT(e,n),FAt(i)&&(e.style.fill="none",e.style.stroke="none",le(e.states,function(m){m.style&&(m.style.fill=m.style.stroke="none")}))}function $At(e,t){var r=e.get(["itemStyle","borderColor"]);if(!r||r==="none")return 0;var n=e.get(["itemStyle","borderWidth"])||0,i=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),a=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(n,i,a)}var HAt=function(){function e(){}return e}(),mq=function(e){je(t,e);function t(r){var n=e.call(this,r)||this;return n.type="largeBar",n}return t.prototype.getDefaultShape=function(){return new HAt},t.prototype.buildPath=function(r,n){for(var i=n.points,a=this.baseDimIdx,o=1-this.baseDimIdx,s=[],l=[],u=this.barWidth,f=0;f<i.length;f+=3)l[a]=u,l[o]=i[f+2],s[a]=i[f+a],s[o]=i[f+o],r.rect(s[0],s[1],l[0],l[1])},t}(hr);function bq(e,t,r,n){var i=e.getData(),a=i.getLayout("valueAxisHorizontal")?1:0,o=i.getLayout("largeDataIndices"),s=i.getLayout("size"),l=e.getModel("backgroundStyle"),u=i.getLayout("largeBackgroundPoints");if(u){var f=new mq({shape:{points:u},incremental:!!n,silent:!0,z2:0});f.baseDimIdx=a,f.largeDataIndices=o,f.barWidth=s,f.useStyle(l.getItemStyle()),t.add(f),r&&r.push(f)}var c=new mq({shape:{points:i.getLayout("largePoints")},incremental:!!n,ignoreCoarsePointer:!0,z2:1});c.baseDimIdx=a,c.largeDataIndices=o,c.barWidth=s,t.add(c),c.useStyle(i.getVisual("style")),or(c).seriesIndex=e.seriesIndex,e.get("silent")||(c.on("mousedown",wq),c.on("mousemove",wq)),r&&r.push(c)}var wq=HE(function(e){var t=this,r=BAt(t,e.offsetX,e.offsetY);or(t).dataIndex=r>=0?r:null},30,!1);function BAt(e,t,r){for(var n=e.baseDimIdx,i=1-n,a=e.shape.points,o=e.largeDataIndices,s=[],l=[],u=e.barWidth,f=0,c=a.length/3;f<c;f++){var h=f*3;if(l[n]=u,l[i]=a[h+2],s[n]=a[h+n],s[i]=a[h+i],l[i]<0&&(s[i]+=l[i],l[i]=-l[i]),t>=s[0]&&t<=s[0]+l[0]&&r>=s[1]&&r<=s[1]+l[1])return o[f]}return-1}function Bfe(e,t,r){if(h4(r,"cartesian2d")){var n=t,i=r.getArea();return{x:e?n.x:i.x,y:e?i.y:n.y,width:e?n.width:i.width,height:e?i.height:n.height}}else{var i=r.getArea(),a=t;return{cx:i.cx,cy:i.cy,r0:e?i.r0:a.r0,r:e?i.r:a.r,startAngle:e?a.startAngle:0,endAngle:e?a.endAngle:Math.PI*2}}}function VAt(e,t,r){var n=e.type==="polar"?bh:Cn;return new n({shape:Bfe(t,r,e),silent:!0,z2:0})}const jAt=MAt;function WAt(e){e.registerChartView(jAt),e.registerSeriesModel(EAt),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,wr(JRt,"bar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,QRt("bar")),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Ffe("bar")),e.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,r){var n=t.componentType||"series";r.eachComponent({mainType:n,query:t},function(i){t.sortInfo&&i.axis.setCategorySortInfo(t.sortInfo)})})}var M1=Math.PI*2,Sq=Math.PI/180;function Vfe(e,t){return vg(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function jfe(e,t){var r=Vfe(e,t),n=e.get("center"),i=e.get("radius");Ze(i)||(i=[0,i]);var a=xr(r.width,t.getWidth()),o=xr(r.height,t.getHeight()),s=Math.min(a,o),l=xr(i[0],s/2),u=xr(i[1],s/2),f,c,h=e.coordinateSystem;if(h){var d=h.dataToPoint(n);f=d[0]||0,c=d[1]||0}else Ze(n)||(n=[n,n]),f=xr(n[0],a)+r.x,c=xr(n[1],o)+r.y;return{cx:f,cy:c,r0:l,r:u}}function UAt(e,t,r){t.eachSeriesByType(e,function(n){var i=n.getData(),a=i.mapDimension("value"),o=Vfe(n,r),s=jfe(n,r),l=s.cx,u=s.cy,f=s.r,c=s.r0,h=-n.get("startAngle")*Sq,d=n.get("minAngle")*Sq,v=0;i.each(a,function(M){!isNaN(M)&&v++});var p=i.getSum(a),g=Math.PI/(p||v)*2,y=n.get("clockwise"),m=n.get("roseType"),b=n.get("stillShowZeroSum"),S=i.getDataExtent(a);S[0]=0;var x=M1,T=0,E=h,P=y?1:-1;if(i.setLayout({viewRect:o,r:f}),i.each(a,function(M,D){var N;if(isNaN(M)){i.setItemLayout(D,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:y,cx:l,cy:u,r0:c,r:m?NaN:f});return}m!=="area"?N=p===0&&b?g:M*g:N=M1/v,N<d?(N=d,x-=d):T+=M;var B=E+P*N;i.setItemLayout(D,{angle:N,startAngle:E,endAngle:B,clockwise:y,cx:l,cy:u,r0:c,r:m?LN(M,S,[c,f]):f}),E=B}),x<M1&&v)if(x<=.001){var R=M1/v;i.each(a,function(M,D){if(!isNaN(M)){var N=i.getItemLayout(D);N.angle=R,N.startAngle=h+P*D*R,N.endAngle=h+P*(D+1)*R}})}else g=x/T,E=h,i.each(a,function(M,D){if(!isNaN(M)){var N=i.getItemLayout(D),B=N.angle===d?d:M*g;N.startAngle=E,N.endAngle=E+P*B,E+=P*B}})})}function zAt(e){return{seriesType:e,reset:function(t,r){var n=r.findComponents({mainType:"legend"});if(!(!n||!n.length)){var i=t.getData();i.filterSelf(function(a){for(var o=i.getName(a),s=0;s<n.length;s++)if(!n[s].isSelected(o))return!1;return!0})}}}}var GAt=Math.PI/180;function _q(e,t,r,n,i,a,o,s,l,u){if(e.length<2)return;function f(p){for(var g=p.rB,y=g*g,m=0;m<p.list.length;m++){var b=p.list[m],S=Math.abs(b.label.y-r),x=n+b.len,T=x*x,E=Math.sqrt((1-Math.abs(S*S/y))*T),P=t+(E+b.len2)*i,R=P-b.label.x,M=b.targetTextWidth-R*i;Wfe(b,M,!0),b.label.x=P}}function c(p){for(var g={list:[],maxY:0},y={list:[],maxY:0},m=0;m<p.length;m++)if(p[m].labelAlignTo==="none"){var b=p[m],S=b.label.y>r?y:g,x=Math.abs(b.label.y-r);if(x>=S.maxY){var T=b.label.x-t-b.len2*i,E=n+b.len,P=Math.abs(T)<E?Math.sqrt(x*x/(1-T*T/E/E)):E;S.rB=P,S.maxY=x}S.list.push(b)}f(g),f(y)}for(var h=e.length,d=0;d<h;d++)if(e[d].position==="outer"&&e[d].labelAlignTo==="labelLine"){var v=e[d].label.x-u;e[d].linePoints[1][0]+=v,e[d].label.x=u}Ukt(e,l,l+o)&&c(e)}function YAt(e,t,r,n,i,a,o,s){for(var l=[],u=[],f=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<e.length;h++){var d=e[h].label;WP(e[h])||(d.x<t?(f=Math.min(f,d.x),l.push(e[h])):(c=Math.max(c,d.x),u.push(e[h])))}for(var h=0;h<e.length;h++){var v=e[h];if(!WP(v)&&v.linePoints){if(v.labelStyleWidth!=null)continue;var d=v.label,p=v.linePoints,g=void 0;v.labelAlignTo==="edge"?d.x<t?g=p[2][0]-v.labelDistance-o-v.edgeDistance:g=o+i-v.edgeDistance-p[2][0]-v.labelDistance:v.labelAlignTo==="labelLine"?d.x<t?g=f-o-v.bleedMargin:g=o+i-c-v.bleedMargin:d.x<t?g=d.x-o-v.bleedMargin:g=o+i-d.x-v.bleedMargin,v.targetTextWidth=g,Wfe(v,g)}}_q(u,t,r,n,1,i,a,o,s,c),_q(l,t,r,n,-1,i,a,o,s,f);for(var h=0;h<e.length;h++){var v=e[h];if(!WP(v)&&v.linePoints){var d=v.label,p=v.linePoints,y=v.labelAlignTo==="edge",m=d.style.padding,b=m?m[1]+m[3]:0,S=d.style.backgroundColor?0:b,x=v.rect.width+S,T=p[1][0]-p[2][0];y?d.x<t?p[2][0]=o+v.edgeDistance+x+v.labelDistance:p[2][0]=o+i-v.edgeDistance-x-v.labelDistance:(d.x<t?p[2][0]=d.x+v.labelDistance:p[2][0]=d.x-v.labelDistance,p[1][0]=p[2][0]+T),p[1][1]=p[2][1]=d.y}}}function Wfe(e,t,r){if(r===void 0&&(r=!1),e.labelStyleWidth==null){var n=e.label,i=n.style,a=e.rect,o=i.backgroundColor,s=i.padding,l=s?s[1]+s[3]:0,u=i.overflow,f=a.width+(o?0:l);if(t<f||r){var c=a.height;if(u&&u.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",t-l);var h=n.getBoundingRect();n.setStyle("width",Math.ceil(h.width)),n.setStyle("backgroundColor",o)}else{var d=t-l,v=t<f?d:r?d>e.unconstrainedWidth?null:d:null;n.setStyle("width",v)}var p=n.getBoundingRect();a.width=p.width;var g=(n.style.margin||0)+2.1;a.height=p.height+g,a.y-=(a.height-c)/2}}}function WP(e){return e.position==="center"}function KAt(e){var t=e.getData(),r=[],n,i,a=!1,o=(e.get("minShowLabelAngle")||0)*GAt,s=t.getLayout("viewRect"),l=t.getLayout("r"),u=s.width,f=s.x,c=s.y,h=s.height;function d(T){T.ignore=!0}function v(T){if(!T.ignore)return!0;for(var E in T.states)if(T.states[E].ignore===!1)return!0;return!1}t.each(function(T){var E=t.getItemGraphicEl(T),P=E.shape,R=E.getTextContent(),M=E.getTextGuideLine(),D=t.getItemModel(T),N=D.getModel("label"),B=N.get("position")||D.get(["emphasis","label","position"]),K=N.get("distanceToLabelLine"),Z=N.get("alignTo"),ie=xr(N.get("edgeDistance"),u),me=N.get("bleedMargin"),k=D.getModel("labelLine"),w=k.get("length");w=xr(w,u);var C=k.get("length2");if(C=xr(C,u),Math.abs(P.endAngle-P.startAngle)<o){le(R.states,d),R.ignore=!0,M&&(le(M.states,d),M.ignore=!0);return}if(v(R)){var O=(P.startAngle+P.endAngle)/2,_=Math.cos(O),A=Math.sin(O),I,L,V,Y;n=P.cx,i=P.cy;var ae=B==="inside"||B==="inner";if(B==="center")I=P.cx,L=P.cy,Y="center";else{var re=(ae?(P.r+P.r0)/2*_:P.r*_)+n,te=(ae?(P.r+P.r0)/2*A:P.r*A)+i;if(I=re+_*3,L=te+A*3,!ae){var ge=re+_*(w+l-P.r),H=te+A*(w+l-P.r),Ce=ge+(_<0?-1:1)*C,oe=H;Z==="edge"?I=_<0?f+ie:f+u-ie:I=Ce+(_<0?-K:K),L=oe,V=[[re,te],[ge,H],[Ce,oe]]}Y=ae?"center":Z==="edge"?_>0?"right":"left":_>0?"left":"right"}var Oe=Math.PI,Ee=0,be=N.get("rotate");if(Sr(be))Ee=be*(Oe/180);else if(B==="center")Ee=0;else if(be==="radial"||be===!0){var Ie=_<0?-O+Oe:-O;Ee=Ie}else if(be==="tangential"&&B!=="outside"&&B!=="outer"){var Me=Math.atan2(_,A);Me<0&&(Me=Oe*2+Me);var j=A>0;j&&(Me=Oe+Me),Ee=Me-Oe}if(a=!!Ee,R.x=I,R.y=L,R.rotation=Ee,R.setStyle({verticalAlign:"middle"}),ae){R.setStyle({align:Y});var fe=R.states.select;fe&&(fe.x+=R.x,fe.y+=R.y)}else{var U=R.getBoundingRect().clone();U.applyTransform(R.getComputedTransform());var Q=(R.style.margin||0)+2.1;U.y-=Q/2,U.height+=Q,r.push({label:R,labelLine:M,position:B,len:w,len2:C,minTurnAngle:k.get("minTurnAngle"),maxSurfaceAngle:k.get("maxSurfaceAngle"),surfaceNormal:new xt(_,A),linePoints:V,textAlign:Y,labelDistance:K,labelAlignTo:Z,edgeDistance:ie,bleedMargin:me,rect:U,unconstrainedWidth:U.width,labelStyleWidth:R.style.width})}E.setTextConfig({inside:ae})}}),!a&&e.get("avoidLabelOverlap")&&YAt(r,n,i,l,u,h,f,c);for(var p=0;p<r.length;p++){var g=r[p],y=g.label,m=g.labelLine,b=isNaN(y.x)||isNaN(y.y);if(y){y.setStyle({align:g.textAlign}),b&&(le(y.states,d),y.ignore=!0);var S=y.states.select;S&&(S.x+=y.x,S.y+=y.y)}if(m){var x=g.linePoints;b||!x?(le(m.states,d),m.ignore=!0):(Fkt(x,g.minTurnAngle),$kt(x,g.surfaceNormal,g.maxSurfaceAngle),m.setShape({points:x}),y.__hostTarget.textGuideLineConfig={anchor:new xt(x[0][0],x[0][1])})}}}var XAt=function(e){je(t,e);function t(r,n,i){var a=e.call(this)||this;a.z2=2;var o=new Jn;return a.setTextContent(o),a.updateData(r,n,i,!0),a}return t.prototype.updateData=function(r,n,i,a){var o=this,s=r.hostModel,l=r.getItemModel(n),u=l.getModel("emphasis"),f=r.getItemLayout(n),c=Ne(am(l.getModel("itemStyle"),f,!0),f);if(isNaN(c.startAngle)){o.setShape(c);return}if(a){o.setShape(c);var h=s.getShallow("animationType");s.ecModel.ssr?(Aa(o,{scaleX:0,scaleY:0},s,{dataIndex:n,isFrom:!0}),o.originX=c.cx,o.originY=c.cy):h==="scale"?(o.shape.r=f.r0,Aa(o,{shape:{r:f.r}},s,n)):i!=null?(o.setShape({startAngle:i,endAngle:i}),Aa(o,{shape:{startAngle:f.startAngle,endAngle:f.endAngle}},s,n)):(o.shape.endAngle=f.startAngle,Si(o,{shape:{endAngle:f.endAngle}},s,n))}else A3(o),Si(o,{shape:c},s,n);o.useStyle(r.getItemVisual(n,"style")),LT(o,l);var d=(f.startAngle+f.endAngle)/2,v=s.get("selectedOffset"),p=Math.cos(d)*v,g=Math.sin(d)*v,y=l.getShallow("cursor");y&&o.attr("cursor",y),this._updateLabel(s,r,n),o.ensureState("emphasis").shape=Ne({r:f.r+(u.get("scale")&&u.get("scaleSize")||0)},am(u.getModel("itemStyle"),f)),Ne(o.ensureState("select"),{x:p,y:g,shape:am(l.getModel(["select","itemStyle"]),f)}),Ne(o.ensureState("blur"),{shape:am(l.getModel(["blur","itemStyle"]),f)});var m=o.getTextGuideLine(),b=o.getTextContent();m&&Ne(m.ensureState("select"),{x:p,y:g}),Ne(b.ensureState("select"),{x:p,y:g}),pw(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r,n,i){var a=this,o=n.getItemModel(i),s=o.getModel("labelLine"),l=n.getItemVisual(i,"style"),u=l&&l.fill,f=l&&l.opacity;RS(a,kS(o),{labelFetcher:n.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:f,defaultText:r.getFormattedLabel(i,"normal")||n.getName(i)});var c=a.getTextContent();a.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var h=r.get(["label","position"]);if(h!=="outside"&&h!=="outer")a.removeTextGuideLine();else{var d=this.getTextGuideLine();d||(d=new xE,this.setTextGuideLine(d)),Bkt(this,Vkt(o),{stroke:u,opacity:Dm(s.get(["lineStyle","opacity"]),f,1)})}},t}(bh),qAt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,n,i,a){var o=r.getData(),s=this._data,l=this.group,u;if(!s&&o.count()>0){for(var f=o.getItemLayout(0),c=1;isNaN(f&&f.startAngle)&&c<o.count();++c)f=o.getItemLayout(c);f&&(u=f.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),o.count()===0&&r.get("showEmptyCircle")){var h=new bh({shape:jfe(r,i)});h.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=h,l.add(h)}o.diff(s).add(function(d){var v=new XAt(o,d,u);o.setItemGraphicEl(d,v),l.add(v)}).update(function(d,v){var p=s.getItemGraphicEl(v);p.updateData(o,d,u),p.off("click"),l.add(p),o.setItemGraphicEl(d,p)}).remove(function(d){var v=s.getItemGraphicEl(d);HT(v,r,d)}).execute(),KAt(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=o)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var o=r[0]-a.cx,s=r[1]-a.cy,l=Math.sqrt(o*o+s*s);return l<=a.r&&l>=a.r0}},t.type="pie",t}(Qo);const ZAt=qAt;function JAt(e,t,r){t=Ze(t)&&{coordDimensions:t}||Ne({encodeDefine:e.getEncode()},t);var n=e.getSource(),i=sfe(n,t).dimensions,a=new n4(i,e);return a.initData(n,r),a}var QAt=function(){function e(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return e.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},e.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},e.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},e.prototype.getItemVisual=function(t,r){var n=this._getDataWithEncodedVisual();return n.getItemVisual(t,r)},e}();const ePt=QAt;var tPt=Jr(),rPt=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new ePt(kr(this.getData,this),kr(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return JAt(this,{coordDimensions:["value"],encodeDefaulter:wr(OTt,this)})},t.prototype.getDataParams=function(r){var n=this.getData(),i=tPt(n),a=i.seats;if(!a){var o=[];n.each(n.mapDimension("value"),function(l){o.push(l)}),a=i.seats=f1t(o,n.hostModel.get("percentPrecision"))}var s=e.prototype.getDataParams.call(this,r);return s.percent=a[r]||0,s.$vars.push("percent"),s},t.prototype._defaultLabelLine=function(r){IT(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(Bu);const nPt=rPt;function iPt(e){return{seriesType:e,reset:function(t,r){var n=t.getData();n.filterSelf(function(i){var a=n.mapDimension("value"),o=n.get(a,i);return!(Sr(o)&&!isNaN(o)&&o<0)})}}}function aPt(e){e.registerChartView(ZAt),e.registerSeriesModel(nPt),cEt("pie",e.registerAction),e.registerLayout(wr(UAt,"pie")),e.registerProcessor(zAt("pie")),e.registerProcessor(iPt("pie"))}var oPt=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}(Er);const sPt=oPt;var hL=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",fo).models[0]},t.type="cartesian2dAxis",t}(Er);_o(hL,xkt);var Ufe={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},lPt=lr({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},Ufe),d4=lr({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},Ufe),uPt=lr({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},d4),fPt=fr({logBase:10},d4);const cPt={category:lPt,value:d4,time:uPt,log:fPt};var hPt={value:1,category:1,time:1,log:1};function Cq(e,t,r,n){le(hPt,function(i,a){var o=lr(lr({},cPt[a],!0),n,!0),s=function(l){je(u,l);function u(){var f=l!==null&&l.apply(this,arguments)||this;return f.type=t+"Axis."+a,f}return u.prototype.mergeDefaultAndTheme=function(f,c){var h=bw(this),d=h?NE(f):{},v=c.getTheme();lr(f,v.get(a+"Axis")),lr(f,this.getDefaultOption()),f.type=xq(f),h&&pg(f,d,h)},u.prototype.optionUpdated=function(){var f=this.option;f.type==="category"&&(this.__ordinalMeta=uL.createByAxisModel(this))},u.prototype.getCategories=function(f){var c=this.option;if(c.type==="category")return f?c.data:this.__ordinalMeta.categories},u.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},u.type=t+"Axis."+a,u.defaultOption=o,u}(r);e.registerComponentModel(s)}),e.registerSubTypeDefaulter(t+"Axis",xq)}function xq(e){return e.type||(e.data?"category":"value")}var dPt=function(){function e(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return e.prototype.getAxis=function(t){return this._axes[t]},e.prototype.getAxes=function(){return ct(this._dimList,function(t){return this._axes[t]},this)},e.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),Wn(this.getAxes(),function(r){return r.scale.type===t})},e.prototype.addAxis=function(t){var r=t.dim;this._axes[r]=t,this._dimList.push(r)},e}();const vPt=dPt;var dL=["x","y"];function Tq(e){return e.type==="interval"||e.type==="time"}var pPt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cartesian2d",r.dimensions=dL,r}return t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var r=this.getAxis("x").scale,n=this.getAxis("y").scale;if(!(!Tq(r)||!Tq(n))){var i=r.getExtent(),a=n.getExtent(),o=this.dataToPoint([i[0],a[0]]),s=this.dataToPoint([i[1],a[1]]),l=i[1]-i[0],u=a[1]-a[0];if(!(!l||!u)){var f=(s[0]-o[0])/l,c=(s[1]-o[1])/u,h=o[0]-i[0]*f,d=o[1]-a[0]*c,v=this._transform=[f,0,0,c,h,d];this._invTransform=h3([],v)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(r){var n=this.getAxis("x"),i=this.getAxis("y");return n.contain(n.toLocalCoord(r[0]))&&i.contain(i.toLocalCoord(r[1]))},t.prototype.containData=function(r){return this.getAxis("x").containData(r[0])&&this.getAxis("y").containData(r[1])},t.prototype.containZone=function(r,n){var i=this.dataToPoint(r),a=this.dataToPoint(n),o=this.getArea(),s=new ur(i[0],i[1],a[0]-i[0],a[1]-i[1]);return o.intersect(s)},t.prototype.dataToPoint=function(r,n,i){i=i||[];var a=r[0],o=r[1];if(this._transform&&a!=null&&isFinite(a)&&o!=null&&isFinite(o))return ka(i,r,this._transform);var s=this.getAxis("x"),l=this.getAxis("y");return i[0]=s.toGlobalCoord(s.dataToCoord(a,n)),i[1]=l.toGlobalCoord(l.dataToCoord(o,n)),i},t.prototype.clampData=function(r,n){var i=this.getAxis("x").scale,a=this.getAxis("y").scale,o=i.getExtent(),s=a.getExtent(),l=i.parse(r[0]),u=a.parse(r[1]);return n=n||[],n[0]=Math.min(Math.max(Math.min(o[0],o[1]),l),Math.max(o[0],o[1])),n[1]=Math.min(Math.max(Math.min(s[0],s[1]),u),Math.max(s[0],s[1])),n},t.prototype.pointToData=function(r,n){var i=[];if(this._invTransform)return ka(i,r,this._invTransform);var a=this.getAxis("x"),o=this.getAxis("y");return i[0]=a.coordToData(a.toLocalCoord(r[0]),n),i[1]=o.coordToData(o.toLocalCoord(r[1]),n),i},t.prototype.getOtherAxis=function(r){return this.getAxis(r.dim==="x"?"y":"x")},t.prototype.getArea=function(){var r=this.getAxis("x").getGlobalExtent(),n=this.getAxis("y").getGlobalExtent(),i=Math.min(r[0],r[1]),a=Math.min(n[0],n[1]),o=Math.max(r[0],r[1])-i,s=Math.max(n[0],n[1])-a;return new ur(i,a,o,s)},t}(vPt),gPt=function(e){je(t,e);function t(r,n,i,a,o){var s=e.call(this,r,n,i)||this;return s.index=0,s.type=a||"value",s.position=o||"bottom",s}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.getGlobalExtent=function(r){var n=this.getExtent();return n[0]=this.toGlobalCoord(n[0]),n[1]=this.toGlobalCoord(n[1]),r&&n[0]>n[1]&&n.reverse(),n},t.prototype.pointToData=function(r,n){return this.coordToData(this.toLocalCoord(r[this.dim==="x"?0:1]),n)},t.prototype.setCategorySortInfo=function(r){if(this.type!=="category")return!1;this.model.option.categorySortInfo=r,this.scale.setSortInfo(r)},t}(Lkt);const yPt=gPt;function vL(e,t,r){r=r||{};var n=e.coordinateSystem,i=t.axis,a={},o=i.getAxesOnZeroOf()[0],s=i.position,l=o?"onZero":s,u=i.dim,f=n.getRect(),c=[f.x,f.x+f.width,f.y,f.y+f.height],h={left:0,right:1,top:0,bottom:1,onZero:2},d=t.get("offset")||0,v=u==="x"?[c[2]-d,c[3]+d]:[c[0]-d,c[1]+d];if(o){var p=o.toGlobalCoord(o.dataToCoord(0));v[h.onZero]=Math.max(Math.min(p,v[1]),v[0])}a.position=[u==="y"?v[h[l]]:c[0],u==="x"?v[h[l]]:c[3]],a.rotation=Math.PI/2*(u==="x"?0:1);var g={top:-1,bottom:1,left:-1,right:1};a.labelDirection=a.tickDirection=a.nameDirection=g[s],a.labelOffset=o?v[h[s]]-v[h.onZero]:0,t.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),fw(r.labelInside,t.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var y=t.get(["axisLabel","rotate"]);return a.labelRotate=l==="top"?-y:y,a.z2=1,a}function Oq(e){return e.get("coordinateSystem")==="cartesian2d"}function Eq(e){var t={xAxisModel:null,yAxisModel:null};return le(t,function(r,n){var i=n.replace(/Model$/,""),a=e.getReferringComponents(i,fo).models[0];t[n]=a}),t}var UP=Math.log;function mPt(e,t,r){var n=AS.prototype,i=n.getTicks.call(r),a=n.getTicks.call(r,!0),o=i.length-1,s=n.getInterval.call(r),l=wfe(e,t),u=l.extent,f=l.fixMin,c=l.fixMax;if(e.type==="log"){var h=UP(e.base);u=[UP(u[0])/h,UP(u[1])/h]}e.setExtent(u[0],u[1]),e.calcNiceExtent({splitNumber:o,fixMin:f,fixMax:c});var d=n.getExtent.call(e);f&&(u[0]=d[0]),c&&(u[1]=d[1]);var v=n.getInterval.call(e),p=u[0],g=u[1];if(f&&c)v=(g-p)/o;else if(f)for(g=u[0]+v*o;g<u[1]&&isFinite(g)&&isFinite(u[1]);)v=FP(v),g=u[0]+v*o;else if(c)for(p=u[1]-v*o;p>u[0]&&isFinite(p)&&isFinite(u[0]);)v=FP(v),p=u[1]-v*o;else{var y=e.getTicks().length-1;y>o&&(v=FP(v));var m=v*o;g=Math.ceil(u[1]/v)*v,p=vn(g-m),p<0&&u[0]>=0?(p=0,g=vn(m)):g>0&&u[1]<=0&&(g=0,p=-vn(m))}var b=(i[0].value-a[0].value)/s,S=(i[o].value-a[o].value)/s;n.setExtent.call(e,p+v*b,g+v*S),n.setInterval.call(e,v),(b||S)&&n.setNiceExtent.call(e,p+v,g-v)}var bPt=function(){function e(t,r,n){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=dL,this._initCartesian(t,r,n),this.model=t}return e.prototype.getRect=function(){return this._rect},e.prototype.update=function(t,r){var n=this._axesMap;this._updateScale(t,this.model);function i(o){var s,l=Lr(o),u=l.length;if(u){for(var f=[],c=u-1;c>=0;c--){var h=+l[c],d=o[h],v=d.model,p=d.scale;fL(p)&&v.get("alignTicks")&&v.get("interval")==null?f.push(d):(qX(p,v),fL(p)&&(s=d))}f.length&&(s||(s=f.pop(),qX(s.scale,s.model)),le(f,function(g){mPt(g.scale,g.model,s.scale)}))}}i(n.x),i(n.y);var a={};le(n.x,function(o){Rq(n,"y",o,a)}),le(n.y,function(o){Rq(n,"x",o,a)}),this.resize(this.model,r)},e.prototype.resize=function(t,r,n){var i=t.getBoxLayoutParams(),a=!n&&t.get("containLabel"),o=vg(i,{width:r.getWidth(),height:r.getHeight()});this._rect=o;var s=this._axesList;l(),a&&(le(s,function(u){if(!u.model.get(["axisLabel","inside"])){var f=Skt(u);if(f){var c=u.isHorizontal()?"height":"width",h=u.model.get(["axisLabel","margin"]);o[c]-=f[c]+h,u.position==="top"?o.y+=f.height+h:u.position==="left"&&(o.x+=f.width+h)}}}),l()),le(this._coordsList,function(u){u.calcAffineTransform()});function l(){le(s,function(u){var f=u.isHorizontal(),c=f?[0,o.width]:[0,o.height],h=u.inverse?1:0;u.setExtent(c[h],c[1-h]),wPt(u,f?o.x:o.y)})}},e.prototype.getAxis=function(t,r){var n=this._axesMap[t];if(n!=null)return n[r||0]},e.prototype.getAxes=function(){return this._axesList.slice()},e.prototype.getCartesian=function(t,r){if(t!=null&&r!=null){var n="x"+t+"y"+r;return this._coordsMap[n]}vt(t)&&(r=t.yAxisIndex,t=t.xAxisIndex);for(var i=0,a=this._coordsList;i<a.length;i++)if(a[i].getAxis("x").index===t||a[i].getAxis("y").index===r)return a[i]},e.prototype.getCartesians=function(){return this._coordsList.slice()},e.prototype.convertToPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},e.prototype.convertFromPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},e.prototype._findConvertTarget=function(t){var r=t.seriesModel,n=t.xAxisModel||r&&r.getReferringComponents("xAxis",fo).models[0],i=t.yAxisModel||r&&r.getReferringComponents("yAxis",fo).models[0],a=t.gridModel,o=this._coordsList,s,l;if(r)s=r.coordinateSystem,ar(o,s)<0&&(s=null);else if(n&&i)s=this.getCartesian(n.componentIndex,i.componentIndex);else if(n)l=this.getAxis("x",n.componentIndex);else if(i)l=this.getAxis("y",i.componentIndex);else if(a){var u=a.coordinateSystem;u===this&&(s=this._coordsList[0])}return{cartesian:s,axis:l}},e.prototype.containPoint=function(t){var r=this._coordsList[0];if(r)return r.containPoint(t)},e.prototype._initCartesian=function(t,r,n){var i=this,a=this,o={left:!1,right:!1,top:!1,bottom:!1},s={x:{},y:{}},l={x:0,y:0};if(r.eachComponent("xAxis",u("x"),this),r.eachComponent("yAxis",u("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=s,le(s.x,function(f,c){le(s.y,function(h,d){var v="x"+c+"y"+d,p=new pPt(v);p.master=i,p.model=t,i._coordsMap[v]=p,i._coordsList.push(p),p.addAxis(f),p.addAxis(h)})});function u(f){return function(c,h){if(zP(c,t)){var d=c.get("position");f==="x"?d!=="top"&&d!=="bottom"&&(d=o.bottom?"top":"bottom"):d!=="left"&&d!=="right"&&(d=o.left?"right":"left"),o[d]=!0;var v=new yPt(f,bkt(c),[0,0],c.get("type"),d),p=v.type==="category";v.onBand=p&&c.get("boundaryGap"),v.inverse=c.get("inverse"),c.axis=v,v.model=c,v.grid=a,v.index=h,a._axesList.push(v),s[f][h]=v,l[f]++}}}},e.prototype._updateScale=function(t,r){le(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var a=i.model.get("categorySortInfo");i.scale.setSortInfo(a)}}),t.eachSeries(function(i){if(Oq(i)){var a=Eq(i),o=a.xAxisModel,s=a.yAxisModel;if(!zP(o,r)||!zP(s,r))return;var l=this.getCartesian(o.componentIndex,s.componentIndex),u=i.getData(),f=l.getAxis("x"),c=l.getAxis("y");n(u,f),n(u,c)}},this);function n(i,a){le(Ckt(i,a.dim),function(o){a.scale.unionExtentFromData(i,o)})}},e.prototype.getTooltipAxes=function(t){var r=[],n=[];return le(this.getCartesians(),function(i){var a=t!=null&&t!=="auto"?i.getAxis(t):i.getBaseAxis(),o=i.getOtherAxis(a);ar(r,a)<0&&r.push(a),ar(n,o)<0&&n.push(o)}),{baseAxes:r,otherAxes:n}},e.create=function(t,r){var n=[];return t.eachComponent("grid",function(i,a){var o=new e(i,t,r);o.name="grid_"+a,o.resize(i,r,!0),i.coordinateSystem=o,n.push(o)}),t.eachSeries(function(i){if(Oq(i)){var a=Eq(i),o=a.xAxisModel,s=a.yAxisModel,l=o.getCoordSysModel(),u=l.coordinateSystem;i.coordinateSystem=u.getCartesian(o.componentIndex,s.componentIndex)}}),n},e.dimensions=dL,e}();function zP(e,t){return e.getCoordSysModel()===t}function Rq(e,t,r,n){r.getAxesOnZeroOf=function(){return a?[a]:[]};var i=e[t],a,o=r.model,s=o.get(["axisLine","onZero"]),l=o.get(["axisLine","onZeroAxisIndex"]);if(!s)return;if(l!=null)kq(i[l])&&(a=i[l]);else for(var u in i)if(i.hasOwnProperty(u)&&kq(i[u])&&!n[f(i[u])]){a=i[u];break}a&&(n[f(a)]=!0);function f(c){return c.dim+"_"+c.index}}function kq(e){return e&&e.type!=="category"&&e.type!=="time"&&wkt(e)}function wPt(e,t){var r=e.getExtent(),n=r[0]+r[1];e.toGlobalCoord=e.dim==="x"?function(i){return i+t}:function(i){return n-i+t},e.toLocalCoord=e.dim==="x"?function(i){return i-t}:function(i){return n-i+t}}const SPt=bPt;var su=Math.PI,Rc=function(){function e(t,r){this.group=new Zn,this.opt=r,this.axisModel=t,fr(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var n=new Zn({x:r.position[0],y:r.position[1],rotation:r.rotation});n.updateTransform(),this._transformGroup=n}return e.prototype.hasBuilder=function(t){return!!Aq[t]},e.prototype.add=function(t){Aq[t](this.opt,this.axisModel,this.group,this._transformGroup)},e.prototype.getGroup=function(){return this.group},e.innerTextLayout=function(t,r,n){var i=Ise(r-t),a,o;return AT(i)?(o=n>0?"top":"bottom",a="center"):AT(i-su)?(o=n>0?"bottom":"top",a="center"):(o="middle",i>0&&i<su?a=n>0?"right":"left":a=n>0?"left":"right"),{rotation:i,textAlign:a,textVerticalAlign:o}},e.makeAxisEventDataBase=function(t){var r={componentType:t.mainType,componentIndex:t.componentIndex};return r[t.mainType+"Index"]=t.componentIndex,r},e.isLabelSilent=function(t){var r=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||r&&r.show)},e}(),Aq={axisLine:function(e,t,r,n){var i=t.get(["axisLine","show"]);if(i==="auto"&&e.handleAutoShown&&(i=e.handleAutoShown("axisLine")),!!i){var a=t.axis.getExtent(),o=n.transform,s=[a[0],0],l=[a[1],0],u=s[0]>l[0];o&&(ka(s,s,o),ka(l,l,o));var f=Ne({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),c=new Kc({shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:f,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1});gw(c.shape,c.style.lineWidth),c.anid="line",r.add(c);var h=t.get(["axisLine","symbol"]);if(h!=null){var d=t.get(["axisLine","symbolSize"]);st(h)&&(h=[h,h]),(st(d)||Sr(d))&&(d=[d,d]);var v=Mue(t.get(["axisLine","symbolOffset"])||0,d),p=d[0],g=d[1];le([{rotate:e.rotation+Math.PI/2,offset:v[0],r:0},{rotate:e.rotation-Math.PI/2,offset:v[1],r:Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1]))}],function(y,m){if(h[m]!=="none"&&h[m]!=null){var b=yg(h[m],-p/2,-g/2,p,g,f.stroke,!0),S=y.r+y.offset,x=u?l:s;b.attr({rotation:y.rotate,x:x[0]+S*Math.cos(e.rotation),y:x[1]-S*Math.sin(e.rotation),silent:!0,z2:11}),r.add(b)}})}}},axisTickLabel:function(e,t,r,n){var i=xPt(r,n,t,e),a=OPt(r,n,t,e);if(CPt(t,a,i),TPt(r,n,t,e.tickDirection),t.get(["axisLabel","hideOverlap"])){var o=jkt(ct(a,function(s){return{label:s,priority:s.z2,defaultAttr:{ignore:s.ignore}}}));zkt(o)}},axisName:function(e,t,r,n){var i=fw(e.axisName,t.get("name"));if(i){var a=t.get("nameLocation"),o=e.nameDirection,s=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,u=t.axis.getExtent(),f=u[0]>u[1]?-1:1,c=[a==="start"?u[0]-f*l:a==="end"?u[1]+f*l:(u[0]+u[1])/2,Iq(a)?e.labelOffset+o*l:0],h,d=t.get("nameRotate");d!=null&&(d=d*su/180);var v;Iq(a)?h=Rc.innerTextLayout(e.rotation,d??e.rotation,o):(h=_Pt(e.rotation,a,d||0,u),v=e.axisNameAvailableWidth,v!=null&&(v=Math.abs(v/Math.sin(h.rotation)),!isFinite(v)&&(v=null)));var p=s.getFont(),g=t.get("nameTruncate",!0)||{},y=g.ellipsis,m=fw(e.nameTruncateMaxWidth,g.maxWidth,v),b=new Jn({x:c[0],y:c[1],rotation:h.rotation,silent:Rc.isLabelSilent(t),style:Hu(s,{text:i,font:p,overflow:"truncate",width:m,ellipsis:y,fill:s.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:s.get("align")||h.textAlign,verticalAlign:s.get("verticalAlign")||h.textVerticalAlign}),z2:1});if(D3({el:b,componentModel:t,itemName:i}),b.__fullText=i,b.anid="name",t.get("triggerEvent")){var S=Rc.makeAxisEventDataBase(t);S.targetType="axisName",S.name=i,or(b).eventData=S}n.add(b),b.updateTransform(),r.add(b),b.decomposeTransform()}}};function _Pt(e,t,r,n){var i=Ise(r-e),a,o,s=n[0]>n[1],l=t==="start"&&!s||t!=="start"&&s;return AT(i-su/2)?(o=l?"bottom":"top",a="center"):AT(i-su*1.5)?(o=l?"top":"bottom",a="center"):(o="middle",i<su*1.5&&i>su/2?a=l?"left":"right":a=l?"right":"left"),{rotation:i,textAlign:a,textVerticalAlign:o}}function CPt(e,t,r){if(!Sfe(e.axis)){var n=e.get(["axisLabel","showMinLabel"]),i=e.get(["axisLabel","showMaxLabel"]);t=t||[],r=r||[];var a=t[0],o=t[1],s=t[t.length-1],l=t[t.length-2],u=r[0],f=r[1],c=r[r.length-1],h=r[r.length-2];n===!1?(da(a),da(u)):Pq(a,o)&&(n?(da(o),da(f)):(da(a),da(u))),i===!1?(da(s),da(c)):Pq(l,s)&&(i?(da(l),da(h)):(da(s),da(c)))}}function da(e){e&&(e.ignore=!0)}function Pq(e,t){var r=e&&e.getBoundingRect().clone(),n=t&&t.getBoundingRect().clone();if(!(!r||!n)){var i=f3([]);return c3(i,i,-e.rotation),r.applyTransform(Zd([],i,e.getLocalTransform())),n.applyTransform(Zd([],i,t.getLocalTransform())),r.intersect(n)}}function Iq(e){return e==="middle"||e==="center"}function zfe(e,t,r,n,i){for(var a=[],o=[],s=[],l=0;l<e.length;l++){var u=e[l].coord;o[0]=u,o[1]=0,s[0]=u,s[1]=r,t&&(ka(o,o,t),ka(s,s,t));var f=new Kc({shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:n,z2:2,autoBatch:!0,silent:!0});gw(f.shape,f.style.lineWidth),f.anid=i+"_"+e[l].tickValue,a.push(f)}return a}function xPt(e,t,r,n){var i=r.axis,a=r.getModel("axisTick"),o=a.get("show");if(o==="auto"&&n.handleAutoShown&&(o=n.handleAutoShown("axisTick")),!(!o||i.scale.isBlank())){for(var s=a.getModel("lineStyle"),l=n.tickDirection*a.get("length"),u=i.getTicksCoords(),f=zfe(u,t.transform,l,fr(s.getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])}),"ticks"),c=0;c<f.length;c++)e.add(f[c]);return f}}function TPt(e,t,r,n){var i=r.axis,a=r.getModel("minorTick");if(!(!a.get("show")||i.scale.isBlank())){var o=i.getMinorTicksCoords();if(o.length)for(var s=a.getModel("lineStyle"),l=n*a.get("length"),u=fr(s.getLineStyle(),fr(r.getModel("axisTick").getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])})),f=0;f<o.length;f++)for(var c=zfe(o[f],t.transform,l,u,"minorticks_"+f),h=0;h<c.length;h++)e.add(c[h])}}function OPt(e,t,r,n){var i=r.axis,a=fw(n.axisLabelShow,r.get(["axisLabel","show"]));if(!(!a||i.scale.isBlank())){var o=r.getModel("axisLabel"),s=o.get("margin"),l=i.getViewLabels(),u=(fw(n.labelRotate,o.get("rotate"))||0)*su/180,f=Rc.innerTextLayout(n.rotation,u,n.labelDirection),c=r.getCategories&&r.getCategories(!0),h=[],d=Rc.isLabelSilent(r),v=r.get("triggerEvent");return le(l,function(p,g){var y=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(p.tickValue):p.tickValue,m=p.formattedLabel,b=p.rawLabel,S=o;if(c&&c[y]){var x=c[y];vt(x)&&x.textStyle&&(S=new Gn(x.textStyle,o,r.ecModel))}var T=S.getTextColor()||r.get(["axisLine","lineStyle","color"]),E=i.dataToCoord(y),P=new Jn({x:E,y:n.labelOffset+n.labelDirection*s,rotation:f.rotation,silent:d,z2:10+(p.level||0),style:Hu(S,{text:m,align:S.getShallow("align",!0)||f.textAlign,verticalAlign:S.getShallow("verticalAlign",!0)||S.getShallow("baseline",!0)||f.textVerticalAlign,fill:gt(T)?T(i.type==="category"?b:i.type==="value"?y+"":y,g):T})});if(P.anid="label_"+y,v){var R=Rc.makeAxisEventDataBase(r);R.targetType="axisLabel",R.value=b,R.tickIndex=g,i.type==="category"&&(R.dataIndex=y),or(P).eventData=R}t.add(P),P.updateTransform(),h.push(P),e.add(P),P.decomposeTransform()}),h}}const Gfe=Rc;function EPt(e,t){var r={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return RPt(r,e,t),r.seriesInvolved&&APt(r,e),r}function RPt(e,t,r){var n=t.getComponent("tooltip"),i=t.getComponent("axisPointer"),a=i.get("link",!0)||[],o=[];le(r.getCoordinateSystems(),function(s){if(!s.axisPointerEnabled)return;var l=xw(s.model),u=e.coordSysAxesInfo[l]={};e.coordSysMap[l]=s;var f=s.model,c=f.getModel("tooltip",n);if(le(s.getAxes(),wr(p,!1,null)),s.getTooltipAxes&&n&&c.get("show")){var h=c.get("trigger")==="axis",d=c.get(["axisPointer","type"])==="cross",v=s.getTooltipAxes(c.get(["axisPointer","axis"]));(h||d)&&le(v.baseAxes,wr(p,d?"cross":!0,h)),d&&le(v.otherAxes,wr(p,"cross",!1))}function p(g,y,m){var b=m.model.getModel("axisPointer",i),S=b.get("show");if(!(!S||S==="auto"&&!g&&!pL(b))){y==null&&(y=b.get("triggerTooltip")),b=g?kPt(m,c,i,t,g,y):b;var x=b.get("snap"),T=xw(m.model),E=y||x||m.type==="category",P=e.axesInfo[T]={key:T,axis:m,coordSys:s,axisPointerModel:b,triggerTooltip:y,involveSeries:E,snap:x,useHandle:pL(b),seriesModels:[],linkGroup:null};u[T]=P,e.seriesInvolved=e.seriesInvolved||E;var R=PPt(a,m);if(R!=null){var M=o[R]||(o[R]={axesInfo:{}});M.axesInfo[T]=P,M.mapper=a[R].mapper,P.linkGroup=M}}}})}function kPt(e,t,r,n,i,a){var o=t.getModel("axisPointer"),s=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};le(s,function(h){l[h]=Xt(o.get(h))}),l.snap=e.type!=="category"&&!!a,o.get("type")==="cross"&&(l.type="line");var u=l.label||(l.label={});if(u.show==null&&(u.show=!1),i==="cross"){var f=o.get(["label","show"]);if(u.show=f??!0,!a){var c=l.lineStyle=o.get("crossStyle");c&&fr(u,c.textStyle)}}return e.model.getModel("axisPointer",new Gn(l,r,n))}function APt(e,t){t.eachSeries(function(r){var n=r.coordinateSystem,i=r.get(["tooltip","trigger"],!0),a=r.get(["tooltip","show"],!0);!n||i==="none"||i===!1||i==="item"||a===!1||r.get(["axisPointer","show"],!0)===!1||le(e.coordSysAxesInfo[xw(n.model)],function(o){var s=o.axis;n.getAxis(s.dim)===s&&(o.seriesModels.push(r),o.seriesDataCount==null&&(o.seriesDataCount=0),o.seriesDataCount+=r.getData().count())})})}function PPt(e,t){for(var r=t.model,n=t.dim,i=0;i<e.length;i++){var a=e[i]||{};if(GP(a[n+"AxisId"],r.id)||GP(a[n+"AxisIndex"],r.componentIndex)||GP(a[n+"AxisName"],r.name))return i}}function GP(e,t){return e==="all"||Ze(e)&&ar(e,t)>=0||e===t}function IPt(e){var t=v4(e);if(t){var r=t.axisPointerModel,n=t.axis.scale,i=r.option,a=r.get("status"),o=r.get("value");o!=null&&(o=n.parse(o));var s=pL(r);a==null&&(i.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(o==null||o>l[1])&&(o=l[1]),o<l[0]&&(o=l[0]),i.value=o,s&&(i.status=t.axis.scale.isBlank()?"hide":"show")}}function v4(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[xw(e)]}function MPt(e){var t=v4(e);return t&&t.axisPointerModel}function pL(e){return!!e.get(["handle","show"])}function xw(e){return e.type+"||"+e.id}var Mq={},DPt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){this.axisPointerClass&&IPt(r),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(r,i,!0)},t.prototype.updateAxisPointer=function(r,n,i,a){this._doUpdateAxisPointerClass(r,i,!1)},t.prototype.remove=function(r,n){var i=this._axisPointer;i&&i.remove(n)},t.prototype.dispose=function(r,n){this._disposeAxisPointer(n),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(r,n,i){var a=t.getAxisPointerClass(this.axisPointerClass);if(a){var o=MPt(r);o?(this._axisPointer||(this._axisPointer=new a)).render(r,o,n,i):this._disposeAxisPointer(n)}},t.prototype._disposeAxisPointer=function(r){this._axisPointer&&this._axisPointer.dispose(r),this._axisPointer=null},t.registerAxisPointerClass=function(r,n){Mq[r]=n},t.getAxisPointerClass=function(r){return r&&Mq[r]},t.type="axis",t}(rs);const Yfe=DPt;var gL=Jr();function NPt(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitArea"),o=a.getModel("areaStyle"),s=o.get("color"),l=n.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:a,clamp:!0});if(u.length){var f=s.length,c=gL(e).splitAreaColors,h=Bt(),d=0;if(c)for(var v=0;v<u.length;v++){var p=c.get(u[v].tickValue);if(p!=null){d=(p+(f-1)*v)%f;break}}var g=i.toGlobalCoord(u[0].coord),y=o.getAreaStyle();s=Ze(s)?s:[s];for(var v=1;v<u.length;v++){var m=i.toGlobalCoord(u[v].coord),b=void 0,S=void 0,x=void 0,T=void 0;i.isHorizontal()?(b=g,S=l.y,x=m-b,T=l.height,g=b+x):(b=l.x,S=g,x=l.width,T=m-S,g=S+T);var E=u[v-1].tickValue;E!=null&&h.set(E,d),t.add(new Cn({anid:E!=null?"area_"+E:null,shape:{x:b,y:S,width:x,height:T},style:fr({fill:s[d]},y),autoBatch:!0,silent:!0})),d=(d+1)%f}gL(e).splitAreaColors=h}}}function LPt(e){gL(e).splitAreaColors=null}var FPt=["axisLine","axisTickLabel","axisName"],$Pt=["splitArea","splitLine","minorSplitLine"],Kfe=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="CartesianAxisPointer",r}return t.prototype.render=function(r,n,i,a){this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new Zn,this.group.add(this._axisGroup),!!r.get("show")){var s=r.getCoordSysModel(),l=vL(s,r),u=new Gfe(r,Ne({handleAutoShown:function(c){for(var h=s.coordinateSystem.getCartesians(),d=0;d<h.length;d++)if(fL(h[d].getOtherAxis(r.axis).scale))return!0;return!1}},l));le(FPt,u.add,u),this._axisGroup.add(u.getGroup()),le($Pt,function(c){r.get([c,"show"])&&HPt[c](this,this._axisGroup,r,s)},this);var f=a&&a.type==="changeAxisOrder"&&a.isInitSort;f||Ile(o,this._axisGroup,r),e.prototype.render.call(this,r,n,i,a)}},t.prototype.remove=function(){LPt(this)},t.type="cartesianAxis",t}(Yfe),HPt={splitLine:function(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitLine"),o=a.getModel("lineStyle"),s=o.get("color");s=Ze(s)?s:[s];for(var l=n.coordinateSystem.getRect(),u=i.isHorizontal(),f=0,c=i.getTicksCoords({tickModel:a}),h=[],d=[],v=o.getLineStyle(),p=0;p<c.length;p++){var g=i.toGlobalCoord(c[p].coord);u?(h[0]=g,h[1]=l.y,d[0]=g,d[1]=l.y+l.height):(h[0]=l.x,h[1]=g,d[0]=l.x+l.width,d[1]=g);var y=f++%s.length,m=c[p].tickValue,b=new Kc({anid:m!=null?"line_"+c[p].tickValue:null,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:d[0],y2:d[1]},style:fr({stroke:s[y]},v),silent:!0});gw(b.shape,v.lineWidth),t.add(b)}}},minorSplitLine:function(e,t,r,n){var i=r.axis,a=r.getModel("minorSplitLine"),o=a.getModel("lineStyle"),s=n.coordinateSystem.getRect(),l=i.isHorizontal(),u=i.getMinorTicksCoords();if(u.length)for(var f=[],c=[],h=o.getLineStyle(),d=0;d<u.length;d++)for(var v=0;v<u[d].length;v++){var p=i.toGlobalCoord(u[d][v].coord);l?(f[0]=p,f[1]=s.y,c[0]=p,c[1]=s.y+s.height):(f[0]=s.x,f[1]=p,c[0]=s.x+s.width,c[1]=p);var g=new Kc({anid:"minor_line_"+u[d][v].tickValue,autoBatch:!0,shape:{x1:f[0],y1:f[1],x2:c[0],y2:c[1]},style:h,silent:!0});gw(g.shape,h.lineWidth),t.add(g)}},splitArea:function(e,t,r,n){NPt(e,t,r,n)}},Xfe=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="xAxis",t}(Kfe),BPt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=Xfe.type,r}return t.type="yAxis",t}(Kfe),VPt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="grid",r}return t.prototype.render=function(r,n){this.group.removeAll(),r.get("show")&&this.group.add(new Cn({shape:r.coordinateSystem.getRect(),style:fr({fill:r.get("backgroundColor")},r.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(rs),Dq={offset:0};function jPt(e){e.registerComponentView(VPt),e.registerComponentModel(sPt),e.registerCoordinateSystem("cartesian2d",SPt),Cq(e,"x",hL,Dq),Cq(e,"y",hL,Dq),e.registerComponentView(Xfe),e.registerComponentView(BPt),e.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}var Vf=Jr(),Nq=Xt,YP=kr,WPt=function(){function e(){this._dragging=!1,this.animationThreshold=15}return e.prototype.render=function(t,r,n,i){var a=r.get("value"),o=r.get("status");if(this._axisModel=t,this._axisPointerModel=r,this._api=n,!(!i&&this._lastValue===a&&this._lastStatus===o)){this._lastValue=a,this._lastStatus=o;var s=this._group,l=this._handle;if(!o||o==="hide"){s&&s.hide(),l&&l.hide();return}s&&s.show(),l&&l.show();var u={};this.makeElOption(u,a,t,r,n);var f=u.graphicKey;f!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=f;var c=this._moveAnimation=this.determineAnimation(t,r);if(!s)s=this._group=new Zn,this.createPointerEl(s,u,t,r),this.createLabelEl(s,u,t,r),n.getZr().add(s);else{var h=wr(Lq,r,c);this.updatePointerEl(s,u,h),this.updateLabelEl(s,u,h,r)}$q(s,r,!0),this._renderHandle(a)}},e.prototype.remove=function(t){this.clear(t)},e.prototype.dispose=function(t){this.clear(t)},e.prototype.determineAnimation=function(t,r){var n=r.get("animation"),i=t.axis,a=i.type==="category",o=r.get("snap");if(!o&&!a)return!1;if(n==="auto"||n==null){var s=this.animationThreshold;if(a&&i.getBandWidth()>s)return!0;if(o){var l=v4(t).seriesDataCount,u=i.getExtent();return Math.abs(u[0]-u[1])/l>s}return!1}return n===!0},e.prototype.makeElOption=function(t,r,n,i,a){},e.prototype.createPointerEl=function(t,r,n,i){var a=r.pointer;if(a){var o=Vf(t).pointerEl=new Yxt[a.type](Nq(r.pointer));t.add(o)}},e.prototype.createLabelEl=function(t,r,n,i){if(r.label){var a=Vf(t).labelEl=new Jn(Nq(r.label));t.add(a),Fq(a,i)}},e.prototype.updatePointerEl=function(t,r,n){var i=Vf(t).pointerEl;i&&r.pointer&&(i.setStyle(r.pointer.style),n(i,{shape:r.pointer.shape}))},e.prototype.updateLabelEl=function(t,r,n,i){var a=Vf(t).labelEl;a&&(a.setStyle(r.label.style),n(a,{x:r.label.x,y:r.label.y}),Fq(a,i))},e.prototype._renderHandle=function(t){if(!(this._dragging||!this.updateHandleTransform)){var r=this._axisPointerModel,n=this._api.getZr(),i=this._handle,a=r.getModel("handle"),o=r.get("status");if(!a.get("show")||!o||o==="hide"){i&&n.remove(i),this._handle=null;return}var s;this._handle||(s=!0,i=this._handle=M3(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(u){fse(u.event)},onmousedown:YP(this._onHandleDragMove,this,0,0),drift:YP(this._onHandleDragMove,this),ondragend:YP(this._onHandleDragEnd,this)}),n.add(i)),$q(i,r,!1),i.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=a.get("size");Ze(l)||(l=[l,l]),i.scaleX=l[0]/2,i.scaleY=l[1]/2,xue(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,s)}},e.prototype._moveHandleToValue=function(t,r){Lq(this._axisPointerModel,!r&&this._moveAnimation,this._handle,KP(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},e.prototype._onHandleDragMove=function(t,r){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(KP(n),[t,r],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(KP(i)),Vf(n).lastProp=null,this._doDispatchAxisPointer()}},e.prototype._doDispatchAxisPointer=function(){var t=this._handle;if(t){var r=this._payloadInfo,n=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:r.cursorPoint[0],y:r.cursorPoint[1],tooltipOption:r.tooltipOption,axesInfo:[{axisDim:n.axis.dim,axisIndex:n.componentIndex}]})}},e.prototype._onHandleDragEnd=function(){this._dragging=!1;var t=this._handle;if(t){var r=this._axisPointerModel.get("value");this._moveHandleToValue(r),this._api.dispatchAction({type:"hideTip"})}},e.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var r=t.getZr(),n=this._group,i=this._handle;r&&n&&(this._lastGraphicKey=null,n&&r.remove(n),i&&r.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),eL(this,"_doDispatchAxisPointer")},e.prototype.doClear=function(){},e.prototype.buildLabel=function(t,r,n){return n=n||0,{x:t[n],y:t[1-n],width:r[n],height:r[1-n]}},e}();function Lq(e,t,r,n){qfe(Vf(r).lastProp,n)||(Vf(r).lastProp=n,t?Si(r,n,e):(r.stopAnimation(),r.attr(n)))}function qfe(e,t){if(vt(e)&&vt(t)){var r=!0;return le(t,function(n,i){r=r&&qfe(e[i],n)}),!!r}else return e===t}function Fq(e,t){e[t.get(["label","show"])?"show":"hide"]()}function KP(e){return{x:e.x||0,y:e.y||0,rotation:e.rotation||0}}function $q(e,t,r){var n=t.get("z"),i=t.get("zlevel");e&&e.traverse(function(a){a.type!=="group"&&(n!=null&&(a.z=n),i!=null&&(a.zlevel=i),a.silent=r)})}const UPt=WPt;function zPt(e){var t=e.get("type"),r=e.getModel(t+"Style"),n;return t==="line"?(n=r.getLineStyle(),n.fill=null):t==="shadow"&&(n=r.getAreaStyle(),n.stroke=null),n}function GPt(e,t,r,n,i){var a=r.get("value"),o=Zfe(a,t.axis,t.ecModel,r.get("seriesDataIndices"),{precision:r.get(["label","precision"]),formatter:r.get(["label","formatter"])}),s=r.getModel("label"),l=DE(s.get("padding")||0),u=s.getFont(),f=p3(o,u),c=i.position,h=f.width+l[1]+l[3],d=f.height+l[0]+l[2],v=i.align;v==="right"&&(c[0]-=h),v==="center"&&(c[0]-=h/2);var p=i.verticalAlign;p==="bottom"&&(c[1]-=d),p==="middle"&&(c[1]-=d/2),YPt(c,h,d,n);var g=s.get("backgroundColor");(!g||g==="auto")&&(g=t.get(["axisLine","lineStyle","color"])),e.label={x:c[0],y:c[1],style:Hu(s,{text:o,font:u,fill:s.getTextColor(),padding:l,backgroundColor:g}),z2:10}}function YPt(e,t,r,n){var i=n.getWidth(),a=n.getHeight();e[0]=Math.min(e[0]+t,i)-t,e[1]=Math.min(e[1]+r,a)-r,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}function Zfe(e,t,r,n,i){e=t.scale.parse(e);var a=t.scale.getLabel({value:e},{precision:i.precision}),o=i.formatter;if(o){var s={value:l4(t,{value:e}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};le(n,function(l){var u=r.getSeriesByIndex(l.seriesIndex),f=l.dataIndexInside,c=u&&u.getDataParams(f);c&&s.seriesData.push(c)}),st(o)?a=o.replace("{value}",a):gt(o)&&(a=o(s))}return a}function Jfe(e,t,r){var n=cw();return c3(n,n,r.rotation),xN(n,n,r.position),I3([e.dataToCoord(t),(r.labelOffset||0)+(r.labelDirection||1)*(r.labelMargin||0)],n)}function KPt(e,t,r,n,i,a){var o=Gfe.innerTextLayout(r.rotation,0,r.labelDirection);r.labelMargin=i.get(["label","margin"]),GPt(t,n,i,a,{position:Jfe(n.axis,e,r),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function XPt(e,t,r){return r=r||0,{x1:e[r],y1:e[1-r],x2:t[r],y2:t[1-r]}}function qPt(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}}var ZPt=function(e){je(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,i,a,o){var s=i.axis,l=s.grid,u=a.get("type"),f=Hq(l,s).getOtherAxis(s).getGlobalExtent(),c=s.toGlobalCoord(s.dataToCoord(n,!0));if(u&&u!=="none"){var h=zPt(a),d=JPt[u](s,c,f);d.style=h,r.graphicKey=d.type,r.pointer=d}var v=vL(l.model,i);KPt(n,r,v,i,a,o)},t.prototype.getHandleTransform=function(r,n,i){var a=vL(n.axis.grid.model,n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var o=Jfe(n.axis,r,a);return{x:o[0],y:o[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,n,i,a){var o=i.axis,s=o.grid,l=o.getGlobalExtent(!0),u=Hq(s,o).getOtherAxis(o).getGlobalExtent(),f=o.dim==="x"?0:1,c=[r.x,r.y];c[f]+=n[f],c[f]=Math.min(l[1],c[f]),c[f]=Math.max(l[0],c[f]);var h=(u[1]+u[0])/2,d=[h,h];d[f]=c[f];var v=[{verticalAlign:"middle"},{align:"center"}];return{x:c[0],y:c[1],rotation:r.rotation,cursorPoint:d,tooltipOption:v[f]}},t}(UPt);function Hq(e,t){var r={};return r[t.dim+"AxisIndex"]=t.index,e.getCartesian(r)}var JPt={line:function(e,t,r){var n=XPt([t,r[0]],[t,r[1]],Bq(e));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(e,t,r){var n=Math.max(1,e.getBandWidth()),i=r[1]-r[0];return{type:"Rect",shape:qPt([t-n/2,r[0]],[n,i],Bq(e))}}};function Bq(e){return e.dim==="x"?0:1}const QPt=ZPt;var eIt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}(Er);const tIt=eIt;var il=Jr(),rIt=le;function Qfe(e,t,r){if(!Ht.node){var n=t.getZr();il(n).records||(il(n).records={}),nIt(n,t);var i=il(n).records[e]||(il(n).records[e]={});i.handler=r}}function nIt(e,t){if(il(e).initialized)return;il(e).initialized=!0,r("click",wr(Vq,"click")),r("mousemove",wr(Vq,"mousemove")),r("globalout",aIt);function r(n,i){e.on(n,function(a){var o=oIt(t);rIt(il(e).records,function(s){s&&i(s,a,o.dispatchAction)}),iIt(o.pendings,t)})}}function iIt(e,t){var r=e.showTip.length,n=e.hideTip.length,i;r?i=e.showTip[r-1]:n&&(i=e.hideTip[n-1]),i&&(i.dispatchAction=null,t.dispatchAction(i))}function aIt(e,t,r){e.handler("leave",null,r)}function Vq(e,t,r,n){t.handler(e,r,n)}function oIt(e){var t={showTip:[],hideTip:[]},r=function(n){var i=t[n.type];i?i.push(n):(n.dispatchAction=r,e.dispatchAction(n))};return{dispatchAction:r,pendings:t}}function yL(e,t){if(!Ht.node){var r=t.getZr(),n=(il(r).records||{})[e];n&&(il(r).records[e]=null)}}var sIt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=n.getComponent("tooltip"),o=r.get("triggerOn")||a&&a.get("triggerOn")||"mousemove|click";Qfe("axisPointer",i,function(s,l,u){o!=="none"&&(s==="leave"||o.indexOf(s)>=0)&&u({type:"updateAxisPointer",currTrigger:s,x:l&&l.offsetX,y:l&&l.offsetY})})},t.prototype.remove=function(r,n){yL("axisPointer",n)},t.prototype.dispose=function(r,n){yL("axisPointer",n)},t.type="axisPointer",t}(rs);const lIt=sIt;function ece(e,t){var r=[],n=e.seriesIndex,i;if(n==null||!(i=t.getSeriesByIndex(n)))return{point:[]};var a=i.getData(),o=Yc(a,e);if(o==null||o<0||Ze(o))return{point:[]};var s=a.getItemGraphicEl(o),l=i.coordinateSystem;if(i.getTooltipPosition)r=i.getTooltipPosition(o)||[];else if(l&&l.dataToPoint)if(e.isStacked){var u=l.getBaseAxis(),f=l.getOtherAxis(u),c=f.dim,h=u.dim,d=c==="x"||c==="radius"?1:0,v=a.mapDimension(h),p=[];p[d]=a.get(v,o),p[1-d]=a.get(a.getCalculationInfo("stackResultDimension"),o),r=l.dataToPoint(p)||[]}else r=l.dataToPoint(a.getValues(ct(l.dimensions,function(y){return a.mapDimension(y)}),o))||[];else if(s){var g=s.getBoundingRect().clone();g.applyTransform(s.transform),r=[g.x+g.width/2,g.y+g.height/2]}return{point:r,el:s}}var jq=Jr();function uIt(e,t,r){var n=e.currTrigger,i=[e.x,e.y],a=e,o=e.dispatchAction||kr(r.dispatchAction,r),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){VC(i)&&(i=ece({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},t).point);var l=VC(i),u=a.axesInfo,f=s.axesInfo,c=n==="leave"||VC(i),h={},d={},v={list:[],map:{}},p={showPointer:wr(cIt,d),showTooltip:wr(hIt,v)};le(s.coordSysMap,function(y,m){var b=l||y.containPoint(i);le(s.coordSysAxesInfo[m],function(S,x){var T=S.axis,E=gIt(u,S);if(!c&&b&&(!u||E)){var P=E&&E.value;P==null&&!l&&(P=T.pointToData(i)),P!=null&&Wq(S,P,p,!1,h)}})});var g={};return le(f,function(y,m){var b=y.linkGroup;b&&!d[m]&&le(b.axesInfo,function(S,x){var T=d[x];if(S!==y&&T){var E=T.value;b.mapper&&(E=y.axis.scale.parse(b.mapper(E,Uq(S),Uq(y)))),g[y.key]=E}})}),le(g,function(y,m){Wq(f[m],y,p,!0,h)}),dIt(d,f,h),vIt(v,i,e,o),pIt(f,o,r),h}}function Wq(e,t,r,n,i){var a=e.axis;if(!(a.scale.isBlank()||!a.containData(t))){if(!e.involveSeries){r.showPointer(e,t);return}var o=fIt(t,e),s=o.payloadBatch,l=o.snapToValue;s[0]&&i.seriesIndex==null&&Ne(i,s[0]),!n&&e.snap&&a.containData(l)&&l!=null&&(t=l),r.showPointer(e,t,s),r.showTooltip(e,o,l)}}function fIt(e,t){var r=t.axis,n=r.dim,i=e,a=[],o=Number.MAX_VALUE,s=-1;return le(t.seriesModels,function(l,u){var f=l.getData().mapDimensionsAll(n),c,h;if(l.getAxisTooltipData){var d=l.getAxisTooltipData(f,e,r);h=d.dataIndices,c=d.nestestValue}else{if(h=l.getData().indicesOfNearest(f[0],e,r.type==="category"?.5:null),!h.length)return;c=l.getData().get(f[0],h[0])}if(!(c==null||!isFinite(c))){var v=e-c,p=Math.abs(v);p<=o&&((p<o||v>=0&&s<0)&&(o=p,s=v,i=c,a.length=0),le(h,function(g){a.push({seriesIndex:l.seriesIndex,dataIndexInside:g,dataIndex:l.getData().getRawIndex(g)})}))}}),{payloadBatch:a,snapToValue:i}}function cIt(e,t,r,n){e[t.key]={value:r,payloadBatch:n}}function hIt(e,t,r,n){var i=r.payloadBatch,a=t.axis,o=a.model,s=t.axisPointerModel;if(!(!t.triggerTooltip||!i.length)){var l=t.coordSys.model,u=xw(l),f=e.map[u];f||(f=e.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(f)),f.dataByAxis.push({axisDim:a.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:n,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function dIt(e,t,r){var n=r.axesInfo=[];le(t,function(i,a){var o=i.axisPointerModel.option,s=e[a];s?(!i.useHandle&&(o.status="show"),o.value=s.value,o.seriesDataIndices=(s.payloadBatch||[]).slice()):!i.useHandle&&(o.status="hide"),o.status==="show"&&n.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:o.value})})}function vIt(e,t,r,n){if(VC(t)||!e.list.length){n({type:"hideTip"});return}var i=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:r.tooltipOption,position:r.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:e.list})}function pIt(e,t,r){var n=r.getZr(),i="axisPointerLastHighlights",a=jq(n)[i]||{},o=jq(n)[i]={};le(e,function(u,f){var c=u.axisPointerModel.option;c.status==="show"&&le(c.seriesDataIndices,function(h){var d=h.seriesIndex+" | "+h.dataIndex;o[d]=h})});var s=[],l=[];le(a,function(u,f){!o[f]&&l.push(u)}),le(o,function(u,f){!a[f]&&s.push(u)}),l.length&&r.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&r.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}function gIt(e,t){for(var r=0;r<(e||[]).length;r++){var n=e[r];if(t.axis.dim===n.axisDim&&t.axis.model.componentIndex===n.axisIndex)return n}}function Uq(e){var t=e.axis.model,r={},n=r.axisDim=e.axis.dim;return r.axisIndex=r[n+"AxisIndex"]=t.componentIndex,r.axisName=r[n+"AxisName"]=t.name,r.axisId=r[n+"AxisId"]=t.id,r}function VC(e){return!e||e[0]==null||isNaN(e[0])||e[1]==null||isNaN(e[1])}function tce(e){Yfe.registerAxisPointerClass("CartesianAxisPointer",QPt),e.registerComponentModel(tIt),e.registerComponentView(lIt),e.registerPreprocessor(function(t){if(t){(!t.axisPointer||t.axisPointer.length===0)&&(t.axisPointer={});var r=t.axisPointer.link;r&&!Ze(r)&&(t.axisPointer.link=[r])}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,function(t,r){t.getComponent("axisPointer").coordSysAxesInfo=EPt(t,r)}),e.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},uIt)}function yIt(e){Vu(jPt),Vu(tce)}function mIt(e,t){var r=DE(t.get("padding")),n=t.getItemStyle(["color","opacity"]);return n.fill=t.get("backgroundColor"),e=new Cn({shape:{x:e.x-r[3],y:e.y-r[0],width:e.width+r[1]+r[3],height:e.height+r[0]+r[2],r:t.get("borderRadius")},style:n,silent:!0,z2:-1}),e}var bIt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}(Er);const wIt=bIt;function rce(e){var t=e.get("confine");return t!=null?!!t:e.get("renderMode")==="richText"}function nce(e){if(Ht.domSupported){for(var t=document.documentElement.style,r=0,n=e.length;r<n;r++)if(e[r]in t)return e[r]}}var ice=nce(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),SIt=nce(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function ace(e,t){if(!e)return t;t=Kle(t,!0);var r=e.indexOf(t);return e=r===-1?t:"-"+e.slice(0,r)+"-"+t,e.toLowerCase()}function _It(e,t){var r=e.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(e);return r?t?r[t]:r:null}var CIt=ace(SIt,"transition"),p4=ace(ice,"transform"),xIt="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(Ht.transform3dSupported?"will-change:transform;":"");function TIt(e){return e=e==="left"?"right":e==="right"?"left":e==="top"?"bottom":"top",e}function OIt(e,t,r){if(!st(r)||r==="inside")return"";var n=e.get("backgroundColor"),i=e.get("borderWidth");t=Xc(t);var a=TIt(r),o=Math.max(Math.round(i)*1.5,6),s="",l=p4+":",u;ar(["left","right"],a)>-1?(s+="top:50%",l+="translateY(-50%) rotate("+(u=a==="left"?-225:-45)+"deg)"):(s+="left:50%",l+="translateX(-50%) rotate("+(u=a==="top"?225:45)+"deg)");var f=u*Math.PI/180,c=o+i,h=c*Math.abs(Math.cos(f))+c*Math.abs(Math.sin(f)),d=Math.round(((h-Math.SQRT2*i)/2+Math.SQRT2*i-(h-c)/2)*100)/100;s+=";"+a+":-"+d+"px";var v=t+" solid "+i+"px;",p=["position:absolute;width:"+o+"px;height:"+o+"px;z-index:-1;",s+";"+l+";","border-bottom:"+v,"border-right:"+v,"background-color:"+n+";"];return'<div style="'+p.join("")+'"></div>'}function EIt(e,t){var r="cubic-bezier(0.23,1,0.32,1)",n=" "+e/2+"s "+r,i="opacity"+n+",visibility"+n;return t||(n=" "+e+"s "+r,i+=Ht.transformSupported?","+p4+n:",left"+n+",top"+n),CIt+":"+i}function zq(e,t,r){var n=e.toFixed(0)+"px",i=t.toFixed(0)+"px";if(!Ht.transformSupported)return r?"top:"+i+";left:"+n+";":[["top",i],["left",n]];var a=Ht.transform3dSupported,o="translate"+(a?"3d":"")+"("+n+","+i+(a?",0":"")+")";return r?"top:0;left:0;"+p4+":"+o+";":[["top",0],["left",0],[ice,o]]}function RIt(e){var t=[],r=e.get("fontSize"),n=e.getTextColor();n&&t.push("color:"+n),t.push("font:"+e.getFont()),r&&t.push("line-height:"+Math.round(r*3/2)+"px");var i=e.get("textShadowColor"),a=e.get("textShadowBlur")||0,o=e.get("textShadowOffsetX")||0,s=e.get("textShadowOffsetY")||0;return i&&a&&t.push("text-shadow:"+o+"px "+s+"px "+a+"px "+i),le(["decoration","align"],function(l){var u=e.get(l);u&&t.push("text-"+l+":"+u)}),t.join(";")}function kIt(e,t,r){var n=[],i=e.get("transitionDuration"),a=e.get("backgroundColor"),o=e.get("shadowBlur"),s=e.get("shadowColor"),l=e.get("shadowOffsetX"),u=e.get("shadowOffsetY"),f=e.getModel("textStyle"),c=_ue(e,"html"),h=l+"px "+u+"px "+o+"px "+s;return n.push("box-shadow:"+h),t&&i&&n.push(EIt(i,r)),a&&n.push("background-color:"+a),le(["width","color","radius"],function(d){var v="border-"+d,p=Kle(v),g=e.get(p);g!=null&&n.push(v+":"+g+(d==="color"?"":"px"))}),n.push(RIt(f)),c!=null&&n.push("padding:"+DE(c).join("px ")+"px"),n.join(";")+";"}function Gq(e,t,r,n,i){var a=t&&t.painter;if(r){var o=a&&a.getViewportRoot();o&&YSt(e,o,document.body,n,i)}else{e[0]=n,e[1]=i;var s=a&&a.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var AIt=function(){function e(t,r,n){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,Ht.wxa)return null;var i=document.createElement("div");i.domBelongToZr=!0,this.el=i;var a=this._zr=r.getZr(),o=this._appendToBody=n&&n.appendToBody;Gq(this._styleCoord,a,o,r.getWidth()/2,r.getHeight()/2),o?document.body.appendChild(i):t.appendChild(i),this._container=t;var s=this;i.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},i.onmousemove=function(l){if(l=l||window.event,!s._enterable){var u=a.handler,f=a.painter.getViewportRoot();ya(f,l,!0),u.dispatch("mousemove",l)}},i.onmouseleave=function(){s._inContent=!1,s._enterable&&s._show&&s.hideLater(s._hideDelay)}}return e.prototype.update=function(t){var r=this._container,n=_It(r,"position"),i=r.style;i.position!=="absolute"&&n!=="absolute"&&(i.position="relative");var a=t.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=t.get("className")||""},e.prototype.show=function(t,r){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var n=this.el,i=n.style,a=this._styleCoord;n.innerHTML?i.cssText=xIt+kIt(t,!this._firstShow,this._longHide)+zq(a[0],a[1],!0)+("border-color:"+Xc(r)+";")+(t.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},e.prototype.setContent=function(t,r,n,i,a){var o=this.el;if(t==null){o.innerHTML="";return}var s="";if(st(a)&&n.get("trigger")==="item"&&!rce(n)&&(s=OIt(n,i,a)),st(t))o.innerHTML=t+s;else if(t){o.innerHTML="",Ze(t)||(t=[t]);for(var l=0;l<t.length;l++)ST(t[l])&&t[l].parentNode!==o&&o.appendChild(t[l]);if(s&&o.childNodes.length){var u=document.createElement("div");u.innerHTML=s,o.appendChild(u)}}},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el;return[t.offsetWidth,t.offsetHeight]},e.prototype.moveTo=function(t,r){var n=this._styleCoord;if(Gq(n,this._zr,this._appendToBody,t,r),n[0]!=null&&n[1]!=null){var i=this.el.style,a=zq(n[0],n[1]);le(a,function(o){i[o[0]]=o[1]})}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){var t=this,r=this.el.style;r.visibility="hidden",r.opacity="0",Ht.transform3dSupported&&(r.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(kr(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},e}();const PIt=AIt;var IIt=function(){function e(t){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=t.getZr(),Kq(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return e.prototype.update=function(t){var r=t.get("alwaysShowContent");r&&this._moveIfResized(),this._alwaysShowContent=r},e.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},e.prototype.setContent=function(t,r,n,i,a){var o=this;vt(t)&&Mi(""),this.el&&this._zr.remove(this.el);var s=n.getModel("textStyle");this.el=new Jn({style:{rich:r.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:s.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:_ue(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),le(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(u){o.el.style[u]=n.get(u)}),le(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(u){o.el.style[u]=s.get(u)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el,r=this.el.getBoundingRect(),n=Yq(t.style);return[r.width+n.left+n.right,r.height+n.top+n.bottom]},e.prototype.moveTo=function(t,r){var n=this.el;if(n){var i=this._styleCoord;Kq(i,this._zr,t,r),t=i[0],r=i[1];var a=n.style,o=Kl(a.borderWidth||0),s=Yq(a);n.x=t+o+s.left,n.y=r+o+s.top,n.markRedraw()}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(kr(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this._zr.remove(this.el)},e}();function Kl(e){return Math.max(0,e)}function Yq(e){var t=Kl(e.shadowBlur||0),r=Kl(e.shadowOffsetX||0),n=Kl(e.shadowOffsetY||0);return{left:Kl(t-r),right:Kl(t+r),top:Kl(t-n),bottom:Kl(t+n)}}function Kq(e,t,r,n){e[0]=r,e[1]=n,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}const MIt=IIt;var DIt=new Cn({shape:{x:-1,y:-1,width:2,height:2}}),NIt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){if(!(Ht.node||!n.getDom())){var i=r.getComponent("tooltip"),a=this._renderMode=R1t(i.get("renderMode"));this._tooltipContent=a==="richText"?new MIt(n):new PIt(n.getDom(),n,{appendToBody:i.get("appendToBody",!0)})}},t.prototype.render=function(r,n,i){if(!(Ht.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=r,this._ecModel=n,this._api=i;var a=this._tooltipContent;a.update(r),a.setEnterable(r.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&r.get("transitionDuration")?xue(this,"_updatePosition",50,"fixRate"):eL(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var r=this._tooltipModel,n=r.get("triggerOn");Qfe("itemTooltip",this._api,kr(function(i,a,o){n!=="none"&&(n.indexOf(i)>=0?this._tryShow(a,o):i==="leave"&&this._hide(o))},this))},t.prototype._keepShow=function(){var r=this._tooltipModel,n=this._ecModel,i=this._api,a=r.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&o.manuallyShowTip(r,n,i,{x:o._lastX,y:o._lastY,dataByCoordSys:o._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(r,n,i,a){if(!(a.from===this.uid||Ht.node||!i.getDom())){var o=Xq(a,i);this._ticket="";var s=a.dataByCoordSys,l=HIt(a,n,i);if(l){var u=l.el.getBoundingRect().clone();u.applyTransform(l.el.transform),this._tryShow({offsetX:u.x+u.width/2,offsetY:u.y+u.height/2,target:l.el,position:a.position,positionDefault:"bottom"},o)}else if(a.tooltip&&a.x!=null&&a.y!=null){var f=DIt;f.x=a.x,f.y=a.y,f.update(),or(f).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:f},o)}else if(s)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:s,tooltipOption:a.tooltipOption},o);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(r,n,i,a))return;var c=ece(a,n),h=c.point[0],d=c.point[1];h!=null&&d!=null&&this._tryShow({offsetX:h,offsetY:d,target:c.el,position:a.position,positionDefault:"bottom"},o)}else a.x!=null&&a.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:i.getZr().findHover(a.x,a.y).target},o))}},t.prototype.manuallyHideTip=function(r,n,i,a){var o=this._tooltipContent;this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(Xq(a,i))},t.prototype._manuallyAxisShowTip=function(r,n,i,a){var o=a.seriesIndex,s=a.dataIndex,l=n.getComponent("axisPointer").coordSysAxesInfo;if(!(o==null||s==null||l==null)){var u=n.getSeriesByIndex(o);if(u){var f=u.getData(),c=Ly([f.getItemModel(s),u,(u.coordinateSystem||{}).model],this._tooltipModel);if(c.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:s,position:a.position}),!0}}},t.prototype._tryShow=function(r,n){var i=r.target,a=this._tooltipModel;if(a){this._lastX=r.offsetX,this._lastY=r.offsetY;var o=r.dataByCoordSys;if(o&&o.length)this._showAxisTooltip(o,r);else if(i){this._lastDataByCoordSys=null;var s,l;im(i,function(u){if(or(u).dataIndex!=null)return s=u,!0;if(or(u).tooltipConfig!=null)return l=u,!0},!0),s?this._showSeriesItemTooltip(r,s,n):l?this._showComponentItemTooltip(r,l,n):this._hide(n)}else this._lastDataByCoordSys=null,this._hide(n)}},t.prototype._showOrMove=function(r,n){var i=r.get("showDelay");n=kr(n,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(n,i):n()},t.prototype._showAxisTooltip=function(r,n){var i=this._ecModel,a=this._tooltipModel,o=[n.offsetX,n.offsetY],s=Ly([n.tooltipOption],a),l=this._renderMode,u=[],f=qc("section",{blocks:[],noHeader:!0}),c=[],h=new TP;le(r,function(m){le(m.dataByAxis,function(b){var S=i.getComponent(b.axisDim+"Axis",b.axisIndex),x=b.value;if(!(!S||x==null)){var T=Zfe(x,S.axis,i,b.seriesDataIndices,b.valueLabelOpt),E=qc("section",{header:T,noHeader:!Ko(T),sortBlocks:!0,blocks:[]});f.blocks.push(E),le(b.seriesDataIndices,function(P){var R=i.getSeriesByIndex(P.seriesIndex),M=P.dataIndexInside,D=R.getDataParams(M);if(!(D.dataIndex<0)){D.axisDim=b.axisDim,D.axisIndex=b.axisIndex,D.axisType=b.axisType,D.axisId=b.axisId,D.axisValue=l4(S.axis,{value:x}),D.axisValueLabel=T,D.marker=h.makeTooltipMarker("item",Xc(D.color),l);var N=aX(R.formatTooltip(M,!0,null)),B=N.frag;if(B){var K=Ly([R],a).get("valueFormatter");E.blocks.push(K?Ne({valueFormatter:K},B):B)}N.text&&c.push(N.text),u.push(D)}})}})}),f.blocks.reverse(),c.reverse();var d=n.position,v=s.get("order"),p=fX(f,h,l,v,i.get("useUTC"),s.get("textStyle"));p&&c.unshift(p);var g=l==="richText"?`

`:"<br/>",y=c.join(g);this._showOrMove(s,function(){this._updateContentNotChangedOnAxis(r,u)?this._updatePosition(s,d,o[0],o[1],this._tooltipContent,u):this._showTooltipContent(s,y,u,Math.random()+"",o[0],o[1],d,null,h)})},t.prototype._showSeriesItemTooltip=function(r,n,i){var a=this._ecModel,o=or(n),s=o.seriesIndex,l=a.getSeriesByIndex(s),u=o.dataModel||l,f=o.dataIndex,c=o.dataType,h=u.getData(c),d=this._renderMode,v=r.positionDefault,p=Ly([h.getItemModel(f),u,l&&(l.coordinateSystem||{}).model],this._tooltipModel,v?{position:v}:null),g=p.get("trigger");if(!(g!=null&&g!=="item")){var y=u.getDataParams(f,c),m=new TP;y.marker=m.makeTooltipMarker("item",Xc(y.color),d);var b=aX(u.formatTooltip(f,!1,c)),S=p.get("order"),x=p.get("valueFormatter"),T=b.frag,E=T?fX(x?Ne({valueFormatter:x},T):T,m,d,S,a.get("useUTC"),p.get("textStyle")):b.text,P="item_"+u.name+"_"+f;this._showOrMove(p,function(){this._showTooltipContent(p,E,y,P,r.offsetX,r.offsetY,r.position,r.target,m)}),i({type:"showTip",dataIndexInside:f,dataIndex:h.getRawIndex(f),seriesIndex:s,from:this.uid})}},t.prototype._showComponentItemTooltip=function(r,n,i){var a=or(n),o=a.tooltipConfig,s=o.option||{};if(st(s)){var l=s;s={content:l,formatter:l}}var u=[s],f=this._ecModel.getComponent(a.componentMainType,a.componentIndex);f&&u.push(f),u.push({formatter:s.content});var c=r.positionDefault,h=Ly(u,this._tooltipModel,c?{position:c}:null),d=h.get("content"),v=Math.random()+"",p=new TP;this._showOrMove(h,function(){var g=Xt(h.get("formatterParams")||{});this._showTooltipContent(h,d,g,v,r.offsetX,r.offsetY,r.position,n,p)}),i({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(r,n,i,a,o,s,l,u,f){if(this._ticket="",!(!r.get("showContent")||!r.get("show"))){var c=this._tooltipContent;c.setEnterable(r.get("enterable"));var h=r.get("formatter");l=l||r.get("position");var d=n,v=this._getNearestPoint([o,s],i,r.get("trigger"),r.get("borderColor")),p=v.color;if(h)if(st(h)){var g=r.ecModel.get("useUTC"),y=Ze(i)?i[0]:i,m=y&&y.axisType&&y.axisType.indexOf("time")>=0;d=h,m&&(d=kE(y.axisValue,d,g)),d=Xle(d,i,!0)}else if(gt(h)){var b=kr(function(S,x){S===this._ticket&&(c.setContent(x,f,r,p,l),this._updatePosition(r,l,o,s,c,i,u))},this);this._ticket=a,d=h(i,a,b)}else d=h;c.setContent(d,f,r,p,l),c.show(r,p),this._updatePosition(r,l,o,s,c,i,u)}},t.prototype._getNearestPoint=function(r,n,i,a){if(i==="axis"||Ze(n))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!Ze(n))return{color:a||n.color||n.borderColor}},t.prototype._updatePosition=function(r,n,i,a,o,s,l){var u=this._api.getWidth(),f=this._api.getHeight();n=n||r.get("position");var c=o.getSize(),h=r.get("align"),d=r.get("verticalAlign"),v=l&&l.getBoundingRect().clone();if(l&&v.applyTransform(l.transform),gt(n)&&(n=n([i,a],s,o.el,v,{viewSize:[u,f],contentSize:c.slice()})),Ze(n))i=xr(n[0],u),a=xr(n[1],f);else if(vt(n)){var p=n;p.width=c[0],p.height=c[1];var g=vg(p,{width:u,height:f});i=g.x,a=g.y,h=null,d=null}else if(st(n)&&l){var y=$It(n,v,c,r.get("borderWidth"));i=y[0],a=y[1]}else{var y=LIt(i,a,o,u,f,h?null:20,d?null:20);i=y[0],a=y[1]}if(h&&(i-=qq(h)?c[0]/2:h==="right"?c[0]:0),d&&(a-=qq(d)?c[1]/2:d==="bottom"?c[1]:0),rce(r)){var y=FIt(i,a,o,u,f);i=y[0],a=y[1]}o.moveTo(i,a)},t.prototype._updateContentNotChangedOnAxis=function(r,n){var i=this._lastDataByCoordSys,a=this._cbParamsList,o=!!i&&i.length===r.length;return o&&le(i,function(s,l){var u=s.dataByAxis||[],f=r[l]||{},c=f.dataByAxis||[];o=o&&u.length===c.length,o&&le(u,function(h,d){var v=c[d]||{},p=h.seriesDataIndices||[],g=v.seriesDataIndices||[];o=o&&h.value===v.value&&h.axisType===v.axisType&&h.axisId===v.axisId&&p.length===g.length,o&&le(p,function(y,m){var b=g[m];o=o&&y.seriesIndex===b.seriesIndex&&y.dataIndex===b.dataIndex}),a&&le(h.seriesDataIndices,function(y){var m=y.seriesIndex,b=n[m],S=a[m];b&&S&&S.data!==b.data&&(o=!1)})})}),this._lastDataByCoordSys=r,this._cbParamsList=n,!!o},t.prototype._hide=function(r){this._lastDataByCoordSys=null,r({type:"hideTip",from:this.uid})},t.prototype.dispose=function(r,n){Ht.node||!n.getDom()||(eL(this,"_updatePosition"),this._tooltipContent.dispose(),yL("itemTooltip",n))},t.type="tooltip",t}(rs);function Ly(e,t,r){var n=t.ecModel,i;r?(i=new Gn(r,n,n),i=new Gn(t.option,i,n)):i=t;for(var a=e.length-1;a>=0;a--){var o=e[a];o&&(o instanceof Gn&&(o=o.get("tooltip",!0)),st(o)&&(o={formatter:o}),o&&(i=new Gn(o,i,n)))}return i}function Xq(e,t){return e.dispatchAction||kr(t.dispatchAction,t)}function LIt(e,t,r,n,i,a,o){var s=r.getSize(),l=s[0],u=s[1];return a!=null&&(e+l+a+2>n?e-=l+a:e+=a),o!=null&&(t+u+o>i?t-=u+o:t+=o),[e,t]}function FIt(e,t,r,n,i){var a=r.getSize(),o=a[0],s=a[1];return e=Math.min(e+o,n)-o,t=Math.min(t+s,i)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}function $It(e,t,r,n){var i=r[0],a=r[1],o=Math.ceil(Math.SQRT2*n)+8,s=0,l=0,u=t.width,f=t.height;switch(e){case"inside":s=t.x+u/2-i/2,l=t.y+f/2-a/2;break;case"top":s=t.x+u/2-i/2,l=t.y-a-o;break;case"bottom":s=t.x+u/2-i/2,l=t.y+f+o;break;case"left":s=t.x-i-o,l=t.y+f/2-a/2;break;case"right":s=t.x+u+o,l=t.y+f/2-a/2}return[s,l]}function qq(e){return e==="center"||e==="middle"}function HIt(e,t,r){var n=w3(e).queryOptionMap,i=n.keys()[0];if(!(!i||i==="series")){var a=OS(t,i,n.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),o=a.models[0];if(o){var s=r.getViewOfComponentModel(o),l;if(s.group.traverse(function(u){var f=or(u).tooltipConfig;if(f&&f.name===e.name)return l=u,!0}),l)return{componentMainType:i,componentIndex:o.componentIndex,el:l}}}}const BIt=NIt;function VIt(e){Vu(tce),e.registerComponentModel(wIt),e.registerComponentView(BIt),e.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Li),e.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Li)}var jIt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}(Er),WIt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){if(this.group.removeAll(),!!r.get("show")){var a=this.group,o=r.getModel("textStyle"),s=r.getModel("subtextStyle"),l=r.get("textAlign"),u=qt(r.get("textBaseline"),r.get("textVerticalAlign")),f=new Jn({style:Hu(o,{text:r.get("text"),fill:o.getTextColor()},{disableBox:!0}),z2:10}),c=f.getBoundingRect(),h=r.get("subtext"),d=new Jn({style:Hu(s,{text:h,fill:s.getTextColor(),y:c.height+r.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),v=r.get("link"),p=r.get("sublink"),g=r.get("triggerEvent",!0);f.silent=!v&&!g,d.silent=!p&&!g,v&&f.on("click",function(){VK(v,"_"+r.get("target"))}),p&&d.on("click",function(){VK(p,"_"+r.get("subtarget"))}),or(f).eventData=or(d).eventData=g?{componentType:"title",componentIndex:r.componentIndex}:null,a.add(f),h&&a.add(d);var y=a.getBoundingRect(),m=r.getBoxLayoutParams();m.width=y.width,m.height=y.height;var b=vg(m,{width:i.getWidth(),height:i.getHeight()},r.get("padding"));l||(l=r.get("left")||r.get("right"),l==="middle"&&(l="center"),l==="right"?b.x+=b.width:l==="center"&&(b.x+=b.width/2)),u||(u=r.get("top")||r.get("bottom"),u==="center"&&(u="middle"),u==="bottom"?b.y+=b.height:u==="middle"&&(b.y+=b.height/2),u=u||"top"),a.x=b.x,a.y=b.y,a.markRedraw();var S={align:l,verticalAlign:u};f.setStyle(S),d.setStyle(S),y=a.getBoundingRect();var x=b.margin,T=r.getItemStyle(["color","opacity"]);T.fill=r.get("backgroundColor");var E=new Cn({shape:{x:y.x-x[3],y:y.y-x[0],width:y.width+x[1]+x[3],height:y.height+x[0]+x[2],r:r.get("borderRadius")},style:T,subPixelOptimize:!0,silent:!0});a.add(E)}},t.type="title",t}(rs);function UIt(e){e.registerComponentModel(jIt),e.registerComponentView(WIt)}function zIt(e,t){if(!e)return!1;for(var r=Ze(e)?e:[e],n=0;n<r.length;n++)if(r[n]&&r[n][t])return!0;return!1}function D1(e){IT(e,"label",["show"])}var N1=Jr(),oce=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.createdBySelf=!1,r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),this._mergeOption(r,i,!1,!0)},t.prototype.isAnimationEnabled=function(){if(Ht.node)return!1;var r=this.__hostSeries;return this.getShallow("animation")&&r&&r.isAnimationEnabled()},t.prototype.mergeOption=function(r,n){this._mergeOption(r,n,!1,!1)},t.prototype._mergeOption=function(r,n,i,a){var o=this.mainType;i||n.eachSeries(function(s){var l=s.get(this.mainType,!0),u=N1(s)[o];if(!l||!l.data){N1(s)[o]=null;return}u?u._mergeOption(l,n,!0):(a&&D1(l),le(l.data,function(f){f instanceof Array?(D1(f[0]),D1(f[1])):D1(f)}),u=this.createMarkerModelFromSeries(l,this,n),Ne(u,{mainType:this.mainType,seriesIndex:s.seriesIndex,name:s.name,createdBySelf:!0}),u.__hostSeries=s),N1(s)[o]=u},this)},t.prototype.formatTooltip=function(r,n,i){var a=this.getData(),o=this.getRawValue(r),s=a.getName(r);return qc("section",{header:this.name,blocks:[qc("nameValue",{name:s,value:o,noName:!s,noValue:o==null})]})},t.prototype.getData=function(){return this._data},t.prototype.setData=function(r){this._data=r},t.getMarkerModelFromSeries=function(r,n){return N1(r)[n]},t.type="marker",t.dependencies=["series","grid","polar","geo"],t}(Er);_o(oce,due.prototype);const qT=oce;var GIt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,n,i){return new t(r,n,i)},t.type="markPoint",t.defaultOption={z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}},t}(qT);const YIt=GIt;function KIt(e){return!(isNaN(parseFloat(e.x))&&isNaN(parseFloat(e.y)))}function XIt(e){return!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y))}function L1(e,t,r,n,i,a){var o=[],s=Zc(t,n),l=s?t.getCalculationInfo("stackResultDimension"):n,u=sce(t,l,e),f=t.indicesOfNearest(l,u)[0];o[i]=t.get(r,f),o[a]=t.get(l,f);var c=t.get(n,f),h=Xo(t.get(n,f));return h=Math.min(h,20),h>=0&&(o[a]=+o[a].toFixed(h)),[o,c]}var XP={min:wr(L1,"min"),max:wr(L1,"max"),average:wr(L1,"average"),median:wr(L1,"median")};function qIt(e,t){if(t){var r=e.getData(),n=e.coordinateSystem,i=n&&n.dimensions;if(!XIt(t)&&!Ze(t.coord)&&Ze(i)){var a=ZIt(t,r,n,e);if(t=Xt(t),t.type&&XP[t.type]&&a.baseAxis&&a.valueAxis){var o=ar(i,a.baseAxis.dim),s=ar(i,a.valueAxis.dim),l=XP[t.type](r,a.baseDataDim,a.valueDataDim,o,s);t.coord=l[0],t.value=l[1]}else t.coord=[t.xAxis!=null?t.xAxis:t.radiusAxis,t.yAxis!=null?t.yAxis:t.angleAxis]}if(t.coord==null||!Ze(i))t.coord=[];else for(var u=t.coord,f=0;f<2;f++)XP[u[f]]&&(u[f]=sce(r,r.mapDimension(i[f]),u[f]));return t}}function ZIt(e,t,r,n){var i={};return e.valueIndex!=null||e.valueDim!=null?(i.valueDataDim=e.valueIndex!=null?t.getDimension(e.valueIndex):e.valueDim,i.valueAxis=r.getAxis(JIt(n,i.valueDataDim)),i.baseAxis=r.getOtherAxis(i.valueAxis),i.baseDataDim=t.mapDimension(i.baseAxis.dim)):(i.baseAxis=n.getBaseAxis(),i.valueAxis=r.getOtherAxis(i.baseAxis),i.baseDataDim=t.mapDimension(i.baseAxis.dim),i.valueDataDim=t.mapDimension(i.valueAxis.dim)),i}function JIt(e,t){var r=e.getData().getDimensionInfo(t);return r&&r.coordDim}function QIt(e,t){return e&&e.containData&&t.coord&&!KIt(t)?e.containData(t.coord):!0}function eMt(e,t){return e?function(r,n,i,a){var o=a<2?r.coord&&r.coord[a]:r.value;return tv(o,t[a])}:function(r,n,i,a){return tv(r.value,t[a])}}function sce(e,t,r){if(r==="average"){var n=0,i=0;return e.each(t,function(a,o){isNaN(a)||(n+=a,i++)}),n/i}else return r==="median"?e.getMedian(t):e.getDataExtent(t)[r==="max"?1:0]}var qP=Jr(),tMt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this.markerGroupMap=Bt()},t.prototype.render=function(r,n,i){var a=this,o=this.markerGroupMap;o.each(function(s){qP(s).keep=!1}),n.eachSeries(function(s){var l=qT.getMarkerModelFromSeries(s,a.type);l&&a.renderSeries(s,l,n,i)}),o.each(function(s){!qP(s).keep&&a.group.remove(s.group)})},t.prototype.markKeep=function(r){qP(r).keep=!0},t.prototype.toggleBlurSeries=function(r,n){var i=this;le(r,function(a){var o=qT.getMarkerModelFromSeries(a,i.type);if(o){var s=o.getData();s.eachItemGraphicEl(function(l){l&&(n?nle(l):T3(l))})}})},t.type="marker",t}(rs);const rMt=tMt;function Zq(e,t,r){var n=t.coordinateSystem;e.each(function(i){var a=e.getItemModel(i),o,s=xr(a.get("x"),r.getWidth()),l=xr(a.get("y"),r.getHeight());if(!isNaN(s)&&!isNaN(l))o=[s,l];else if(t.getMarkerPosition)o=t.getMarkerPosition(e.getValues(e.dimensions,i));else if(n){var u=e.get(n.dimensions[0],i),f=e.get(n.dimensions[1],i);o=n.dataToPoint([u,f])}isNaN(s)||(o[0]=s),isNaN(l)||(o[1]=l),e.setItemLayout(i,o)})}var nMt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,n,i){n.eachSeries(function(a){var o=qT.getMarkerModelFromSeries(a,"markPoint");o&&(Zq(o.getData(),a,i),this.markerGroupMap.get(a.id).updateLayout())},this)},t.prototype.renderSeries=function(r,n,i,a){var o=r.coordinateSystem,s=r.id,l=r.getData(),u=this.markerGroupMap,f=u.get(s)||u.set(s,new Afe),c=iMt(o,r,n);n.setData(c),Zq(n.getData(),r,a),c.each(function(h){var d=c.getItemModel(h),v=d.getShallow("symbol"),p=d.getShallow("symbolSize"),g=d.getShallow("symbolRotate"),y=d.getShallow("symbolOffset"),m=d.getShallow("symbolKeepAspect");if(gt(v)||gt(p)||gt(g)||gt(y)){var b=n.getRawValue(h),S=n.getDataParams(h);gt(v)&&(v=v(b,S)),gt(p)&&(p=p(b,S)),gt(g)&&(g=g(b,S)),gt(y)&&(y=y(b,S))}var x=d.getModel("itemStyle").getItemStyle(),T=Iue(l,"color");x.fill||(x.fill=T),c.setItemVisual(h,{symbol:v,symbolSize:p,symbolRotate:g,symbolOffset:y,symbolKeepAspect:m,style:x})}),f.updateData(c),this.group.add(f.group),c.eachItemGraphicEl(function(h){h.traverse(function(d){or(d).dataModel=n})}),this.markKeep(f),f.group.silent=n.get("silent")||r.get("silent")},t.type="markPoint",t}(rMt);function iMt(e,t,r){var n;e?n=ct(e&&e.dimensions,function(s){var l=t.getData().getDimensionInfo(t.getData().mapDimension(s))||{};return Ne(Ne({},l),{name:s,ordinalMeta:null})}):n=[{name:"value",type:"float"}];var i=new n4(n,r),a=ct(r.get("data"),wr(qIt,t));e&&(a=Wn(a,wr(QIt,e)));var o=eMt(!!e,n);return i.initData(a,null,o),i}const aMt=nMt;function oMt(e){e.registerComponentModel(YIt),e.registerComponentView(aMt),e.registerPreprocessor(function(t){zIt(t.series,"markPoint")&&(t.markPoint=t.markPoint||{})})}var sMt=function(e,t){if(t==="all")return{type:"all",title:e.getLocaleModel().get(["legend","selector","all"])};if(t==="inverse")return{type:"inverse",title:e.getLocaleModel().get(["legend","selector","inverse"])}},lMt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),r.selected=r.selected||{},this._updateSelector(r)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),this._updateSelector(r)},t.prototype._updateSelector=function(r){var n=r.selector,i=this.ecModel;n===!0&&(n=r.selector=["all","inverse"]),Ze(n)&&le(n,function(a,o){st(a)&&(a={type:a}),n[o]=lr(a,sMt(i,a.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var r=this._data;if(r[0]&&this.get("selectedMode")==="single"){for(var n=!1,i=0;i<r.length;i++){var a=r[i].get("name");if(this.isSelected(a)){this.select(a),n=!0;break}}!n&&this.select(r[0].get("name"))}},t.prototype._updateData=function(r){var n=[],i=[];r.eachRawSeries(function(l){var u=l.name;i.push(u);var f;if(l.legendVisualProvider){var c=l.legendVisualProvider,h=c.getAllNames();r.isSeriesFiltered(l)||(i=i.concat(h)),h.length?n=n.concat(h):f=!0}else f=!0;f&&b3(l)&&n.push(l.name)}),this._availableNames=i;var a=this.get("data")||n,o=Bt(),s=ct(a,function(l){return(st(l)||Sr(l))&&(l={name:l}),o.get(l.name)?null:(o.set(l.name,!0),new Gn(l,this,this.ecModel))},this);this._data=Wn(s,function(l){return!!l})},t.prototype.getData=function(){return this._data},t.prototype.select=function(r){var n=this.option.selected,i=this.get("selectedMode");if(i==="single"){var a=this._data;le(a,function(o){n[o.get("name")]=!1})}n[r]=!0},t.prototype.unSelect=function(r){this.get("selectedMode")!=="single"&&(this.option.selected[r]=!1)},t.prototype.toggleSelected=function(r){var n=this.option.selected;n.hasOwnProperty(r)||(n[r]=!0),this[n[r]?"unSelect":"select"](r)},t.prototype.allSelect=function(){var r=this._data,n=this.option.selected;le(r,function(i){n[i.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var r=this._data,n=this.option.selected;le(r,function(i){var a=i.get("name",!0);n.hasOwnProperty(a)||(n[a]=!0),n[a]=!n[a]})},t.prototype.isSelected=function(r){var n=this.option.selected;return!(n.hasOwnProperty(r)&&!n[r])&&ar(this._availableNames,r)>=0},t.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}(Er);const mL=lMt;var dd=wr,bL=le,F1=Zn,uMt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!1,r}return t.prototype.init=function(){this.group.add(this._contentGroup=new F1),this.group.add(this._selectorGroup=new F1),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(r,n,i){var a=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!r.get("show",!0)){var o=r.get("align"),s=r.get("orient");(!o||o==="auto")&&(o=r.get("left")==="right"&&s==="vertical"?"right":"left");var l=r.get("selector",!0),u=r.get("selectorPosition",!0);l&&(!u||u==="auto")&&(u=s==="horizontal"?"end":"start"),this.renderInner(o,r,n,i,l,s,u);var f=r.getBoxLayoutParams(),c={width:i.getWidth(),height:i.getHeight()},h=r.get("padding"),d=vg(f,c,h),v=this.layoutInner(r,o,d,a,l,u),p=vg(fr({width:v.width,height:v.height},f),c,h);this.group.x=p.x-v.x,this.group.y=p.y-v.y,this.group.markRedraw(),this.group.add(this._backgroundEl=mIt(v,r))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this.getContentGroup(),f=Bt(),c=n.get("selectedMode"),h=[];i.eachRawSeries(function(d){!d.get("legendHoverLink")&&h.push(d.id)}),bL(n.getData(),function(d,v){var p=d.get("name");if(!this.newlineDisabled&&(p===""||p===`
`)){var g=new F1;g.newline=!0,u.add(g);return}var y=i.getSeriesByName(p)[0];if(!f.get(p))if(y){var m=y.getData(),b=m.getVisual("legendLineStyle")||{},S=m.getVisual("legendIcon"),x=m.getVisual("style"),T=this._createItem(y,p,v,d,n,r,b,x,S,c,a);T.on("click",dd(Jq,p,null,a,h)).on("mouseover",dd(wL,y.name,null,a,h)).on("mouseout",dd(SL,y.name,null,a,h)),f.set(p,!0)}else i.eachRawSeries(function(E){if(!f.get(p)&&E.legendVisualProvider){var P=E.legendVisualProvider;if(!P.containName(p))return;var R=P.indexOfName(p),M=P.getItemVisual(R,"style"),D=P.getItemVisual(R,"legendIcon"),N=ll(M.fill);N&&N[3]===0&&(N[3]=.2,M=Ne(Ne({},M),{fill:yE(N,"rgba")}));var B=this._createItem(E,p,v,d,n,r,{},M,D,c,a);B.on("click",dd(Jq,null,p,a,h)).on("mouseover",dd(wL,null,p,a,h)).on("mouseout",dd(SL,null,p,a,h)),f.set(p,!0)}},this)},this),o&&this._createSelector(o,n,a,s,l)},t.prototype._createSelector=function(r,n,i,a,o){var s=this.getSelectorGroup();bL(r,function(u){var f=u.type,c=new Jn({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:f==="all"?"legendAllSelect":"legendInverseSelect"})}});s.add(c);var h=n.getModel("selectorLabel"),d=n.getModel(["emphasis","selectorLabel"]);RS(c,{normal:h,emphasis:d},{defaultText:u.title}),WN(c)})},t.prototype._createItem=function(r,n,i,a,o,s,l,u,f,c,h){var d=r.visualDrawType,v=o.get("itemWidth"),p=o.get("itemHeight"),g=o.isSelected(n),y=a.get("symbolRotate"),m=a.get("symbolKeepAspect"),b=a.get("icon");f=b||f||"roundRect";var S=fMt(f,a,l,u,d,g,h),x=new F1,T=a.getModel("textStyle");if(gt(r.getLegendIcon)&&(!b||b==="inherit"))x.add(r.getLegendIcon({itemWidth:v,itemHeight:p,icon:f,iconRotate:y,itemStyle:S.itemStyle,lineStyle:S.lineStyle,symbolKeepAspect:m}));else{var E=b==="inherit"&&r.getData().getVisual("symbol")?y==="inherit"?r.getData().getVisual("symbolRotate"):y:0;x.add(cMt({itemWidth:v,itemHeight:p,icon:f,iconRotate:E,itemStyle:S.itemStyle,lineStyle:S.lineStyle,symbolKeepAspect:m}))}var P=s==="left"?v+5:-5,R=s,M=o.get("formatter"),D=n;st(M)&&M?D=M.replace("{name}",n??""):gt(M)&&(D=M(n));var N=a.get("inactiveColor");x.add(new Jn({style:Hu(T,{text:D,x:P,y:p/2,fill:g?T.getTextColor():N,align:R,verticalAlign:"middle"})}));var B=new Cn({shape:x.getBoundingRect(),invisible:!0}),K=a.getModel("tooltip");return K.get("show")&&D3({el:B,componentModel:o,itemName:n,itemTooltipOption:K.option}),x.add(B),x.eachChild(function(Z){Z.silent=!0}),B.silent=!c,this.getContentGroup().add(x),WN(x),x.__legendDataIndex=i,x},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getContentGroup(),u=this.getSelectorGroup();Wm(r.get("orient"),l,r.get("itemGap"),i.width,i.height);var f=l.getBoundingRect(),c=[-f.x,-f.y];if(u.markRedraw(),l.markRedraw(),o){Wm("horizontal",u,r.get("selectorItemGap",!0));var h=u.getBoundingRect(),d=[-h.x,-h.y],v=r.get("selectorButtonGap",!0),p=r.getOrient().index,g=p===0?"width":"height",y=p===0?"height":"width",m=p===0?"y":"x";s==="end"?d[p]+=f[g]+v:c[p]+=h[g]+v,d[1-p]+=f[y]/2-h[y]/2,u.x=d[0],u.y=d[1],l.x=c[0],l.y=c[1];var b={x:0,y:0};return b[g]=f[g]+v+h[g],b[y]=Math.max(f[y],h[y]),b[m]=Math.min(0,h[m]+d[1-p]),b}else return l.x=c[0],l.y=c[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(rs);function fMt(e,t,r,n,i,a,o){function s(g,y){g.lineWidth==="auto"&&(g.lineWidth=y.lineWidth>0?2:0),bL(g,function(m,b){g[b]==="inherit"&&(g[b]=y[b])})}var l=t.getModel("itemStyle"),u=l.getItemStyle(),f=e.lastIndexOf("empty",0)===0?"fill":"stroke",c=l.getShallow("decal");u.decal=!c||c==="inherit"?n.decal:aL(c,o),u.fill==="inherit"&&(u.fill=n[i]),u.stroke==="inherit"&&(u.stroke=n[f]),u.opacity==="inherit"&&(u.opacity=(i==="fill"?n:r).opacity),s(u,n);var h=t.getModel("lineStyle"),d=h.getLineStyle();if(s(d,r),u.fill==="auto"&&(u.fill=n.fill),u.stroke==="auto"&&(u.stroke=n.fill),d.stroke==="auto"&&(d.stroke=n.fill),!a){var v=t.get("inactiveBorderWidth"),p=u[f];u.lineWidth=v==="auto"?n.lineWidth>0&&p?2:0:u.lineWidth,u.fill=t.get("inactiveColor"),u.stroke=t.get("inactiveBorderColor"),d.stroke=h.get("inactiveColor"),d.lineWidth=h.get("inactiveWidth")}return{itemStyle:u,lineStyle:d}}function cMt(e){var t=e.icon||"roundRect",r=yg(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill,e.symbolKeepAspect);return r.setStyle(e.itemStyle),r.rotation=(e.iconRotate||0)*Math.PI/180,r.setOrigin([e.itemWidth/2,e.itemHeight/2]),t.indexOf("empty")>-1&&(r.style.stroke=r.style.fill,r.style.fill="#fff",r.style.lineWidth=2),r}function Jq(e,t,r,n){SL(e,t,r,n),r.dispatchAction({type:"legendToggleSelect",name:e??t}),wL(e,t,r,n)}function lce(e){for(var t=e.getZr().storage.getDisplayList(),r,n=0,i=t.length;n<i&&!(r=t[n].states.emphasis);)n++;return r&&r.hoverLayer}function wL(e,t,r,n){lce(r)||r.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:n})}function SL(e,t,r,n){lce(r)||r.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:n})}const uce=uMt;function hMt(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(r){for(var n=0;n<t.length;n++)if(!t[n].isSelected(r.name))return!1;return!0})}function Fy(e,t,r){var n={},i=e==="toggleSelected",a;return r.eachComponent("legend",function(o){i&&a!=null?o[a?"select":"unSelect"](t.name):e==="allSelect"||e==="inverseSelect"?o[e]():(o[e](t.name),a=o.isSelected(t.name));var s=o.getData();le(s,function(l){var u=l.get("name");if(!(u===`
`||u==="")){var f=o.isSelected(u);n.hasOwnProperty(u)?n[u]=n[u]&&f:n[u]=f}})}),e==="allSelect"||e==="inverseSelect"?{selected:n}:{name:t.name,selected:n}}function dMt(e){e.registerAction("legendToggleSelect","legendselectchanged",wr(Fy,"toggleSelected")),e.registerAction("legendAllSelect","legendselectall",wr(Fy,"allSelect")),e.registerAction("legendInverseSelect","legendinverseselect",wr(Fy,"inverseSelect")),e.registerAction("legendSelect","legendselected",wr(Fy,"select")),e.registerAction("legendUnSelect","legendunselected",wr(Fy,"unSelect"))}function fce(e){e.registerComponentModel(mL),e.registerComponentView(uce),e.registerProcessor(e.PRIORITY.PROCESSOR.SERIES_FILTER,hMt),e.registerSubTypeDefaulter("legend",function(){return"plain"}),dMt(e)}var vMt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.setScrollDataIndex=function(r){this.option.scrollDataIndex=r},t.prototype.init=function(r,n,i){var a=NE(r);e.prototype.init.call(this,r,n,i),Qq(this,r,a)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),Qq(this,this.option,r)},t.type="legend.scroll",t.defaultOption=Lle(mL.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(mL);function Qq(e,t,r){var n=e.getOrient(),i=[1,1];i[n.index]=0,pg(t,r,{type:"box",ignoreSize:!!i})}const pMt=vMt;var eZ=Zn,ZP=["width","height"],JP=["x","y"],gMt=function(e){je(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!0,r._currentIndex=0,r}return t.prototype.init=function(){e.prototype.init.call(this),this.group.add(this._containerGroup=new eZ),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new eZ)},t.prototype.resetInner=function(){e.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this;e.prototype.renderInner.call(this,r,n,i,a,o,s,l);var f=this._controllerGroup,c=n.get("pageIconSize",!0),h=Ze(c)?c:[c,c];v("pagePrev",0);var d=n.getModel("pageTextStyle");f.add(new Jn({name:"pageText",style:{text:"xx/xx",fill:d.getTextColor(),font:d.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),v("pageNext",1);function v(p,g){var y=p+"DataIndex",m=M3(n.get("pageIcons",!0)[n.getOrient().name][g],{onclick:kr(u._pageGo,u,y,n,a)},{x:-h[0]/2,y:-h[1]/2,width:h[0],height:h[1]});m.name=p,f.add(m)}},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getSelectorGroup(),u=r.getOrient().index,f=ZP[u],c=JP[u],h=ZP[1-u],d=JP[1-u];o&&Wm("horizontal",l,r.get("selectorItemGap",!0));var v=r.get("selectorButtonGap",!0),p=l.getBoundingRect(),g=[-p.x,-p.y],y=Xt(i);o&&(y[f]=i[f]-p[f]-v);var m=this._layoutContentAndController(r,a,y,u,f,h,d,c);if(o){if(s==="end")g[u]+=m[f]+v;else{var b=p[f]+v;g[u]-=b,m[c]-=b}m[f]+=p[f]+v,g[1-u]+=m[d]+m[h]/2-p[h]/2,m[h]=Math.max(m[h],p[h]),m[d]=Math.min(m[d],p[d]+g[1-u]),l.x=g[0],l.y=g[1],l.markRedraw()}return m},t.prototype._layoutContentAndController=function(r,n,i,a,o,s,l,u){var f=this.getContentGroup(),c=this._containerGroup,h=this._controllerGroup;Wm(r.get("orient"),f,r.get("itemGap"),a?i.width:null,a?null:i.height),Wm("horizontal",h,r.get("pageButtonItemGap",!0));var d=f.getBoundingRect(),v=h.getBoundingRect(),p=this._showController=d[o]>i[o],g=[-d.x,-d.y];n||(g[a]=f[u]);var y=[0,0],m=[-v.x,-v.y],b=qt(r.get("pageButtonGap",!0),r.get("itemGap",!0));if(p){var S=r.get("pageButtonPosition",!0);S==="end"?m[a]+=i[o]-v[o]:y[a]+=v[o]+b}m[1-a]+=d[s]/2-v[s]/2,f.setPosition(g),c.setPosition(y),h.setPosition(m);var x={x:0,y:0};if(x[o]=p?i[o]:d[o],x[s]=Math.max(d[s],v[s]),x[l]=Math.min(0,v[l]+m[1-a]),c.__rectSize=i[o],p){var T={x:0,y:0};T[o]=Math.max(i[o]-v[o]-b,0),T[s]=x[s],c.setClipPath(new Cn({shape:T})),c.__rectSize=T[o]}else h.eachChild(function(P){P.attr({invisible:!0,silent:!0})});var E=this._getPageInfo(r);return E.pageIndex!=null&&Si(f,{x:E.contentPosition[0],y:E.contentPosition[1]},p?r:null),this._updatePageInfoView(r,E),x},t.prototype._pageGo=function(r,n,i){var a=this._getPageInfo(n)[r];a!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:a,legendId:n.id})},t.prototype._updatePageInfoView=function(r,n){var i=this._controllerGroup;le(["pagePrev","pageNext"],function(f){var c=f+"DataIndex",h=n[c]!=null,d=i.childOfName(f);d&&(d.setStyle("fill",h?r.get("pageIconColor",!0):r.get("pageIconInactiveColor",!0)),d.cursor=h?"pointer":"default")});var a=i.childOfName("pageText"),o=r.get("pageFormatter"),s=n.pageIndex,l=s!=null?s+1:0,u=n.pageCount;a&&o&&a.setStyle("text",st(o)?o.replace("{current}",l==null?"":l+"").replace("{total}",u==null?"":u+""):o({current:l,total:u}))},t.prototype._getPageInfo=function(r){var n=r.get("scrollDataIndex",!0),i=this.getContentGroup(),a=this._containerGroup.__rectSize,o=r.getOrient().index,s=ZP[o],l=JP[o],u=this._findTargetItemIndex(n),f=i.children(),c=f[u],h=f.length,d=h?1:0,v={contentPosition:[i.x,i.y],pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return v;var p=S(c);v.contentPosition[o]=-p.s;for(var g=u+1,y=p,m=p,b=null;g<=h;++g)b=S(f[g]),(!b&&m.e>y.s+a||b&&!x(b,y.s))&&(m.i>y.i?y=m:y=b,y&&(v.pageNextDataIndex==null&&(v.pageNextDataIndex=y.i),++v.pageCount)),m=b;for(var g=u-1,y=p,m=p,b=null;g>=-1;--g)b=S(f[g]),(!b||!x(m,b.s))&&y.i<m.i&&(m=y,v.pagePrevDataIndex==null&&(v.pagePrevDataIndex=y.i),++v.pageCount,++v.pageIndex),y=b;return v;function S(T){if(T){var E=T.getBoundingRect(),P=E[l]+T[l];return{s:P,e:P+E[s],i:T.__legendDataIndex}}}function x(T,E){return T.e>=E&&T.s<=E+a}},t.prototype._findTargetItemIndex=function(r){if(!this._showController)return 0;var n,i=this.getContentGroup(),a;return i.eachChild(function(o,s){var l=o.__legendDataIndex;a==null&&l!=null&&(a=s),l===r&&(n=s)}),n??a},t.type="legend.scroll",t}(uce);const yMt=gMt;function mMt(e){e.registerAction("legendScroll","legendscroll",function(t,r){var n=t.scrollDataIndex;n!=null&&r.eachComponent({mainType:"legend",subType:"scroll",query:t},function(i){i.setScrollDataIndex(n)})})}function bMt(e){Vu(fce),e.registerComponentModel(pMt),e.registerComponentView(yMt),mMt(e)}function wMt(e){Vu(fce),Vu(bMt)}var QP=null;function SMt(e){return QP||(QP=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),QP(e)}var eI=null;function _Mt(e){eI||(eI=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),eI(e)}function CMt(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function $1(e,t){t===void 0&&(t={});var r=document.createElement(e);return Object.keys(t).forEach(function(n){r[n]=t[n]}),r}function cce(e,t,r){var n=window.getComputedStyle(e,r||null)||{display:"none"};return n[t]}function _L(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(cce(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var xMt='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',CL=0,jC=null;function TMt(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=RMt.bind(e));var r=e.__resize_listeners__;if(!r){if(e.__resize_listeners__=[],window.ResizeObserver){var n=e.offsetWidth,i=e.offsetHeight,a=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===n&&e.offsetHeight===i)||ZT(e)}),o=_L(e),s=o.detached,l=o.rendered;e.__resize_observer_triggered__=s===!1&&l===!1,e.__resize_observer__=a,a.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){ZT(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(CL||(jC=CMt(xMt)),kMt(e),e.__resize_rendered__=_L(e).rendered,window.MutationObserver){var u=new MutationObserver(e.__resize_mutation_handler__);u.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=u}}e.__resize_listeners__.push(t),CL++}function OMt(e,t){var r=e.__resize_listeners__;if(r){if(t&&r.splice(r.indexOf(t),1),!r.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",g4),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--CL&&jC&&jC.parentNode.removeChild(jC)}}function EMt(e){var t=e.__resize_last__,r=t.width,n=t.height,i=e.offsetWidth,a=e.offsetHeight;return i!==r||a!==n?{width:i,height:a}:null}function RMt(){var e=_L(this),t=e.rendered,r=e.detached;t!==this.__resize_rendered__&&(!r&&this.__resize_triggers__&&(y4(this),this.addEventListener("scroll",g4,!0)),this.__resize_rendered__=t,ZT(this))}function g4(){var e=this;y4(this),this.__resize_raf__&&_Mt(this.__resize_raf__),this.__resize_raf__=SMt(function(){var t=EMt(e);t&&(e.__resize_last__=t,ZT(e))})}function ZT(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function kMt(e){var t=cce(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var r=$1("div",{className:"resize-triggers"}),n=$1("div",{className:"resize-expand-trigger"}),i=$1("div"),a=$1("div",{className:"resize-contract-trigger"});n.appendChild(i),r.appendChild(n),r.appendChild(a),e.appendChild(r),e.__resize_triggers__={triggers:r,expand:n,expandChild:i,contract:a},y4(e),e.addEventListener("scroll",g4,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function y4(e){var t=e.__resize_triggers__,r=t.expand,n=t.expandChild,i=t.contract,a=i.scrollWidth,o=i.scrollHeight,s=r.offsetWidth,l=r.offsetHeight,u=r.scrollWidth,f=r.scrollHeight;i.scrollLeft=a,i.scrollTop=o,n.style.width=s+1+"px",n.style.height=l+1+"px",r.scrollLeft=u,r.scrollTop=f}var Os=function(){return Os=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Os.apply(this,arguments)},AMt=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function PMt(e){return t=Object.create(null),AMt.forEach(function(r){t[r]=function(n){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[n].apply(e.value,i)}}(r)}),t;var t}var IMt={autoresize:Boolean},MMt=/^on[^a-z]/,DMt=function(e){return MMt.test(e)};function H1(e,t){var r=Rr(e);return r&&typeof r=="object"&&"value"in r?r.value||t:r||t}var NMt={loading:Boolean,loadingOptions:Object},$y=null,tZ=[],Hy=[];(function(e,t){if(e&&typeof document<"u"){var r,n=t.prepend===!0?"prepend":"append",i=t.singleTag===!0,a=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var o=tZ.indexOf(a);o===-1&&(o=tZ.push(a)-1,Hy[o]={}),r=Hy[o]&&Hy[o][n]?Hy[o][n]:Hy[o][n]=s()}else r=s();e.charCodeAt(0)===65279&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function s(){var l=document.createElement("style");if(l.setAttribute("type","text/css"),t.attributes)for(var u=Object.keys(t.attributes),f=0;f<u.length;f++)l.setAttribute(u[f],t.attributes[u[f]]);var c=n==="prepend"?"afterbegin":"beforeend";return a.insertAdjacentElement(c,l),l}})(`x-vue-echarts{display:block;width:100%;height:100%;min-width:0}
`,{});var LMt=function(){if($y!=null)return $y;if(typeof HTMLElement>"u"||typeof customElements>"u")return $y=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)("x-vue-echarts")}catch{return $y=!1}return $y=!0}(),FMt="ecTheme",$Mt=_i({name:"echarts",props:Os(Os({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},IMt),NMt),emits:{},inheritAttrs:!1,setup:function(e,t){var r=t.attrs,n=GE(),i=GE(),a=GE(),o=By("ecTheme",null),s=By("ecInitOptions",null),l=By("ecUpdateOptions",null),u=Mce(e),f=u.autoresize,c=u.manualUpdate,h=u.loading,d=u.loadingOptions,v=to(function(){return a.value||e.option||null}),p=to(function(){return e.theme||H1(o,{})}),g=to(function(){return e.initOptions||H1(s,{})}),y=to(function(){return e.updateOptions||H1(l,{})}),m=to(function(){return function(P){var R={};for(var M in P)DMt(M)||(R[M]=P[M]);return R}(r)}),b=Dce().proxy.$listeners;function S(P){if(n.value){var R=i.value=sRt(n.value,p.value,g.value);e.group&&(R.group=e.group);var M=b;M||(M={},Object.keys(r).filter(function(N){return N.indexOf("on")===0&&N.length>2}).forEach(function(N){var B=N.charAt(2).toLowerCase()+N.slice(3);B.substring(B.length-4)==="Once"&&(B="~".concat(B.substring(0,B.length-4))),M[B]=r[N]})),Object.keys(M).forEach(function(N){var B=M[N];if(B){var K=N.toLowerCase();K.charAt(0)==="~"&&(K=K.substring(1),B.__once__=!0);var Z=R;if(K.indexOf("zr:")===0&&(Z=R.getZr(),K=K.substring(3)),B.__once__){delete B.__once__;var ie=B;B=function(){for(var me=[],k=0;k<arguments.length;k++)me[k]=arguments[k];ie.apply(void 0,me),Z.off(K,B)}}Z.on(K,B)}}),f.value?WC(function(){R&&!R.isDisposed()&&R.resize(),D()}):D()}function D(){var N=P||v.value;N&&R.setOption(N,y.value)}}function x(){i.value&&(i.value.dispose(),i.value=void 0)}var T=null;jf(c,function(P){typeof T=="function"&&(T(),T=null),P||(T=jf(function(){return e.option},function(R,M){R&&(i.value?i.value.setOption(R,Os({notMerge:R!==M},y.value)):S())},{deep:!0}))},{immediate:!0}),jf([p,g],function(){x(),S()},{deep:!0}),w4(function(){e.group&&i.value&&(i.value.group=e.group)});var E=PMt(i);return function(P,R,M){var D=By("ecLoadingOptions",{}),N=to(function(){return Os(Os({},H1(D,{})),M==null?void 0:M.value)});w4(function(){var B=P.value;B&&(R.value?B.showLoading(N.value):B.hideLoading())})}(i,h,d),function(P,R,M){var D=null;jf([M,P,R],function(N,B,K){var Z=N[0],ie=N[1],me=N[2];Z&&ie&&me&&(D=HE(function(){ie.resize()},100),TMt(Z,D)),K(function(){D&&Z&&OMt(Z,D)})})}(i,f,n),Jc(function(){S()}),Nce(function(){LMt&&n.value?n.value.__dispose=x:x()}),Os({chart:i,root:n,setOption:function(P,R){e.manualUpdate&&(a.value=P),i.value?i.value.setOption(P,R||{}):S(P)},nonEventAttrs:m},E)},render:function(){var e=Os({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Lce("x-vue-echarts",e)}});const HMt={series:{type:"bar",barMaxWidth:40}},BMt={series:{type:"bar",barMaxWidth:40}},VMt={series:{radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},type:"pie"}},jMt={series:{type:"line"}},WMt={series:{step:"start",type:"line"}},UMt={series:{type:"pie",radius:"50%"}},zMt={series:{type:"pie",radius:[50,200],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:8}}},GMt={series:{type:"bar"}},YMt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAQEBAQEBAQEBAQGBgUGBggHBwcHCAwJCQkJCQwTDA4MDA4MExEUEA8QFBEeFxUVFx4iHRsdIiolJSo0MjRERFwBBAQEBAQEBAQEBAYGBQYGCAcHBwcIDAkJCQkJDBMMDgwMDgwTERQQDxAUER4XFRUXHiIdGx0iKiUlKjQyNEREXP/CABEIAKAA8gMBIgACEQEDEQH/xAAbAAADAQEBAQEAAAAAAAAAAAADBAUGAgABB//aAAgBAQAAAADbsmSfE+9nrWXDS1KIJVJdPcqylHkel4DWpy2foWHYWgmU3kKEEr61hNdXVpSGA2MNW4maXPcd/DxrbPJkHluNCRP1TJbdCA8ShlQH9XzJxEVhW7DB59uHTW4Tq+nVKqi3qchAlbiLHpTfG+VPV2YnqDEHvRGTpTZWqyoFIHVX7ZGDns3Jmo12c4F+etTVru8x/IlWzO3QekGN9mvttIN34ibkzyFuafX5482CWlN7+n0WbphYQfpQ2AHSoenmpGljFSpY9h6ZHpNV0ELYBQbGkWn83Q8TZF6NTvZ3lsIfqSbKO1z3mvSvbvK8NFPVhKRNhPkH6IYs9RxF+dqUhe98pGzt8mdNpPZafbmpbGdwq9JMOrJ0dCMkQzgr+QaRTts08cf5czdE78Grm1ktmnWfHmdOki2q09F7OhXmyKTmV0bko9ETOOPxpa6cCzG5sUo7yCzkvvwE7i4K8pqvmRrWJvWpqZg80LT0d6zPnM8MZLUVO5v2fboZpFaiv+goFnyF75psqr5n4jRiga0mVr8KWwZz5wdtaw/Icm3ocrXANWyr8eVdzGkBQuZ89mPFa7Chqn4gqKVFyjC7mmmOMnz55t9zOFq9Lx6/0dLhO9LAYlKDX5gjZdHAP3ZnvyOr0vJa0AtTAe7Vt5+p2EqtOAytHBel/FqJ1/kii7Ka/8QAGQEAAwEBAQAAAAAAAAAAAAAAAQIDAAQH/9oACAECEAAAAPUFSYdAW5OnWfn688ZEK457J0idiURQdJK26JJlaVEbFUHUrqjHIYVcISz05qLKxTVE8zzSdmQORaamdWWFXSsKF+ZwLCa0XS1nJ5qxujzByay2ULqzb//EABkBAQEBAQEBAAAAAAAAAAAAAAIDAQAEB//aAAgBAxAAAAD57re5u8fT51DPR5MnanJDrz3ztw47RLubnKDqdxig7nq8+mh448tIp8cwUG0madLa9hVOkUhmyb5gtSDl6Jk+k6payHlsiez0TtJDF2U2Ki9eTof/xAAwEAADAQACAgICAwABAgQHAAACAwQBBRIREwAUISIGFSMyJDEzNEFCFiVRUlNhYv/aAAgBAQABEgDk+ZTtRgB6aey93d5SGlqJcFG5gEfizukB93NtKLXiCcm8rJz1MrwNPoyibicTC+n6gjmEWAvmFFJxnG+aRQ3ah3FHxSMY439kO0B9a0MSjjUMpvo6rHy7V2xtav0G0lLEjM/tParH8ZFeLj9e9yrvVF9TWta1nszfh7zfHTqe4nCujr6/kwX3VLTSNhgBDm4i9bjVGmWhKltce/LGe+1zIw0xQoVgZVzTb6DceeUC8w8PWw7JZzJWmOYtdg8hvt7qV0/GAzJqw+3yOOPNEtBNLJZmvZxklpdEd1/OJviwiSPGzrd6h9i3UzY//d+57CLVpDkZmudqXWO7iP4k5BBnmqSYOYbPJ13KXOHrme4+3ncJHHP4n0KUz7Gf9RjZ5lW9PqUuTuqFh/PqpXMTmcjolQZfvlpBS9+G5s5iXp+cRy7mcm028a4kVyj0+CACIj/XTfjMz4zJkKan+v3GGfk282hGDJ2WSSYH7/OO5RaXycd2c0WH5zZleyo2SQaeYf8AtKuXV8W9zDUKqDH1hy3F+WqOqVuHrfX7a8vl45vQ0P4zqwzZMzjV51mjoto0OiDQSZFSpQthSK7YOctyn2Y3wA52Zj+7GS5HoLcqsAPS9hm6WJSXXsq3JwJa+7+iq4my2ECGE7NbNamOkf8A5gWDk7D8ugBMEcyaTKrsWvX9GxTEM+8nW9SSCuPquJ00qLlG3exmuqW1Voau31Fr2G75VytdXKO3oHtxQgDOIgvZ3DUCnQaubyvjIElSnbFA4xEPJvAGU8e1LnsYQ5rKk009uV/qwSmR7Hbswt0d1rFYPRm9G0yS/T8kj/U/ZuX8kAig19OjALTMKlBjsdC8xAST4xk65mjNnXdAjzIXoS9YNfSnVgS2fNsXjTesGu9VRBjO3PF+yeJd69/IfKeV92MCnqlumsF43j/cXRzlNVpke5nGRuoGPjPDRP8AGsFuwlVidYD8L06atkXxqftWUZ/7Pk9jttWER7QwKhAPlll6cZ2vyep5dGbLPModrn9v3W/+JNtNPIchMmlWRN9DMPS4sAfyHgAliX6em8rGCzBG4X+ZeNyDjWvFPiRPbRLp8ji3K0oTMo58GjTPEj9rvLxKxXP27nx7gxQC2A9/4s9n8idLrJAFIgJtLAyU87glnJqR0V/w45mE9iuPBRa/99y3hOVulqat4K6dtAJ9uQ8pq+Y8JU8TMOMB6NuOFkwCav8AzKW110cg2qluK30ggq1V7x3KrUZ6jf8AtgeLVdlGAf4CeLKGNW5q0IItf6+4Sc4yNT+PjVOnr59nrvxrxZSQawRZutkixym6h3rARez5xyOJWJH9VQ7vbdPkeTSK9A71pWAjufPa4P1G5HXPxnwI5MHWbyHtX3E2MpQDAmViMfGYDofMW2TEqmzUL0yzFj9Ob2vcejVol617v1MSszNqsEWaFSce/wCxP/kG0F5+a1q0L+6/K0e0dW1vKK4dOPWVrONBrGLNVlPIPQTFoG1ih0AbyQVDYjUzMVQKfOYolAr39VAtX+e+tHKwp+mtE8ixZu6iC9QcZiwzutTuk+Nqhx6UaDe/YHsKyzUTJ1IinTHzvJ8hSlG+zepLNbtS9cTfrCmnB8dsf840ONWfuFFDCPt+WShd9pOcY7MNXgMjl5SRy3/U1C3tEPNR8rVW6Fe+NYJY5fHSBh2mnZSJYD3RWTsUSzMCxrU549SkFSljEgU5kAaVwNYtbHNzdHytyWJYOjTyojudd8c1/TzbNsdxuLFF7MlRxboa2slUQ/8Av1KeGbL5WnBcYFmBk0LZJaaXt32foeLivSsEhOkhAcHCpxtqyBC2Jd+2rOnXIxJ7D0wAXjsmQfH1k9rhLwPfAK932XJZION6fKzvpqlDHKpdpMMWAq99yIKWkGIP85y0j+OYn6qPa6j8rHj3Wgx7pEOF4dffifuBygOcb0z6BBuUTcXLahFyGNtsL8ZyMXDrlbScmCtc6zzDaFOf9KsewCzwrYVUYjBNIO/XfZHxkHF8VVyX7/eULM+Md71py7fQn9d9eOt5TlcVUNOesRxeJZEj7OoxuFn+Pj3pQCdPaezO3+Wv4pyQQ8B+2wvGK9p5/WolQkl6ZBvzI3N1YmKNLDEw05bdx62UmhwevfZyTAmTIbI2toyoXeyanP7xIpWlDDnHD13FrRzWcdlTur5yxO5ScAumWBYvTLAy26uuYEgvw/Q96fn2n+0pmzKwjFgatPBUzUGZZmeG+cNPH/bU0/e8/JDi2jydXUf+kP8A7fLmsOooprSCzR9h5M9upjAzSPrIs1fFBUVSgpCjBaAu35VxqNSUuUvf6x/cx4/fMZ7ypD9cBP469ravq6mjZcaWhvOTcsEUwvUeIyciDeVQxJsqieRYwVr98/G5Yvtj3pZiPzimyr5CTGVCDfaQJ+VFbdgYsNJOkK9CpFmZGcs2glQs3AztCppuV7cagQ+FAaYrL25unqC3Ph1PrRxNLiWSmiL8+aIZy7EcYwCeX7m662jcCZdkuOwR12PhTTLLyJXljDD/AExnDcJCU2qeqcVtSe5xvNzLEHQVDvcv0+Qco7kHfYWzSzSIF6xZkqzXxk7yH4PlMV4jjpcOmbx6a+nzQjdS0SAlrxvLKA+YA8BHpxRZ82LkcBFIf5Ys+jFczLv1gb4InYTA6Ku86mZate0w9nytyXF7k8U1rT/Jm5xyu2SuOxsVKlnP8JvG9i6WKAfO+BCQdYytnGOBGtZ5sXys2oFNKXbqCLJvibwZSblmbamNFOfH+k8y6lNmSHOvNXVXS/6mZM8GN7YGwL+tdI9y25Jok7M5upS7uNBAUFGz2M2dVwcotgSuGeSlXcFJmPKwUSxwevjdoVMyrh0+mcRyhm4x9jGTv1ZT406BXgUyGgpirrHWMImbnIINe6vA8qMR9mPylEpsrqw1/r61QIc3+t+qxwVmJHpyyGdrlIcOZhFm0cxBkzQBsw9fV3zbVez+P8e56gnWEq93b5eKd63KBwunR/ozg7o5MSmDJFEw+/sZRYmUHIPfsATPONp90p0vR3JivPpure2KPjspih0zWWLm/QrfSsqGTqLw7+QV3LrmpkjJ25+GKbe7GcadT+ymT/8AU5SolifTkTzwZezeXXHJyGI8zkXQTWzhoJiimQ+AvbOP7s5BK7zUnj4+gr7OBn0pN/J8Rvb/ANfhtvoQfG0qXKib2Zpnx++xzmm3fJEEvzjpuKia3FkorNR4xvLWnyGCtNkuToAgPbpUBOAPvUM5yl6/nE8WZcpxg2ub9Sj/AMGXn4+H47k+OPjFefVQtfqcmaiq3+t9TQ1Hp1syFffAmVikei9M+Tbk1YEmlvqnEdP4ul5UzPyBi1aTqfhBU8E411A56BDyYBcfpQogiMBYzWtmVUPGw8q490ve75xwcWhUCGpuxFBlmMyp9XIG2WNO5hf57csqXdqXKdjFLHtPxkqOFMmTI+yucsE95PgIh7yhKzFglfq4ulrIyalKEr9vk2cdzpcnS5XF4WF2LAasqjXSaxkHOhGxzYWs4/jXZYlxsJZ6zjPr18naPI1geNjHNSbVdgRMCU7OfTvW2JkRrSRfdoUOepdMq4yd6HPrkMtqzkvrO0wo4o1jgka2xVxnRf8AUlen9FvWAV2wihIY3wA+PPqzfzvYd/8AtL79903G4xfhf/BVFJwcpZKx4PLDHNPat5B2xSxsxHcdcb28TKwZdUlxdRxmFuV8i6nkIw7HKWSrTIZ8pLvSUlYj2Ywwpmv1Kywn77DDeNTNjArpOj/UfJhFdx9NpxTNTqkAJ/OZ1FS0GxKiygvB/FQlhYTMxpegdYr6HFLfHignFWiXk6x4weP+tEhRdGlmsRxYV8efJan9FvYxzkO/tFwIK8pQUDMDBJcTypZYo2HlCzbRyTncpNrInfXAxwy5p/IOljCZMmCj1n7v48QtkR7KXTy6JOcr+Pp45q6X8ihrpV2r9aUn5Nn0Y5plrJnvc27MBU5PJ6zBmHrHv5QYplua4Q66xcsIBzTlq9MywQX4rXxLdvSw3CWtY7cnmqkvw31aWb2+cg7lfWVKsmxRmWfMsebZM5CNLmrJgO+T1Px7lEvX4BCkMKaFYucTezWqEMxXCA5S3OSZMYGGZchAUwKs2hrrd7L8Ox6XJTCnSpYY7TvGSqegqe69eo2buX5cgvsudMOqR0WAJfp5Y1PgHxsPM5XmaWZGC5t8LAVm6YGXzo3GCJHQQONDZtjP2d1KV7EIbDSCLuRxlLmizqGZyE0rOU4hUsBivVDgY1e1UWTJ5LAVrVrzNXGmkEo2wuimHp8pUgpUh0cI68d6pSir2FvYRw/Pwjji43iK8QZs32HuyM/sMTSg506gGD4eaL6zieeEWEk5dwGqkdxUuJ1wdQNvCyZN6P8Aacm41xr+cbyI8mjkoHuf9VdC9pVxzPs3OBD0Tr7uHflEkA+x+P8As+SHcB/Pp2JCdbGLlksw+IjmHkkNr3cUwfYeclKvkrRsYDegUCCwqqV9t0dbCeww7pVRyho4hyV8Q89B5IW2ZvJcj2yWSdJNUzAYibluHe+SuvBYvqe0QQF7KRu5c/Q8C/y2At/PYPnKbNlCjQ+vSR/z+Ub/AFpAQKo12iOb8kNx1vKr/wArgE4/nMVvppi8RFPJjemZEi6qqNZVFuMnqNeqgh1kcWyAJdy9h81tK8mBaCSSHj8XTJDldC5ujM+xoZG0Nula+rr3R+dmZtfPbTfmvlmUtebcuP1YEsYoeygj1tNnsozJjQp6pyx228h6CSe1G0qQXndV6fp3IaDfar1hnydiAjQtU2mswZjF417padf60YwXB4pXIynjbKs7Dql6zObDivdilsJDXqSw8OG3ZUfWloakGs3c4T8Mpu+rHO9pCbEwGbVV1O5Qk4sfOjcXG5x4tllKio3kAA++Wbh3RpBIFvr1jIlcltfqNxMYtTNWp/mJaRKzT1bxzc5OSnOclCawgJ86QM3L9xXcf/Y2ej6o918Je+WpB7bgisxXp3u+/cy2xas1QEC1cfyXUipcPfdL178+ny5fseL7b+d+Cm1ciAqZJ4Uf+Z8tyDm8ghzLEO9BD4N7kuevrF1UaHIzdmVSZ1P7rmX1zouY2clCnj+O0sZ7sZq5XO+m4xwM0/03kXWKBFftJHsq8eeUyFUQp2vBOk2YauKTtletbLp/THxibIGJxnJJjkF1D+/R9PN8gzEyoxHHH+PPNIpl5GKZjVYrCWHTnuMchM9ldhs3PWa1xxRZxdhyj5w3L1G8gtSeO47UwsoYalglMsM27V996lb18GD5uPVTxIg/xp1J3N5eJg8rq0XfrqhMzxPG7A36IC6tFRavOLpeyrkglmcpNPZneFfjkLC2s/OqXurKLdkZzJTdsULAXokDuF2mr3DKtBfXTSyZPLwZx/gSY1iy+Mr9sCwGXzptIzM9sXfx7cW7ziGTYd7VbY3UzEHvUw2OkyTa7yaSgTPOmlC4mD9BLlAgWYDAxWe01qds2ezBYfq6sP8AZ3KcuLd/JiqnhkcWBqBWWA0v9/5I6SfhK8498znseOae4nSmP3Ka2gfDvl32XIUgHYEizEw+E6l7FyzrVqDaSdopdyUCUQ3GBDhEvGcs72TJ1z5/GD5Xi/dbtlHFzaC89mbv3GyqCNQep5j69P8Akm6rjOOgkCkR38OZy9R/ajRpqCZfpXquYjq3meHW9+7pmX+n8gBMEVMrSSLQ+ua/gWBnEqRaB++jscy+Sgm4+T7jQcVjQFZ5xs6lcZbmZOY6r/PXo+zvDZppB05D4zlYKU8xn+6hWES3ZvGOqcZS+3czK+5/ELyDleQNsdLRjaxmDxOVc2931OP851+VxXrlZ7nwToDqvcTxNXJJarLKWjn/ADDYQSnju4Ixa2j7HPY2GE5mY7x2I1/GZLsPECgPGH+PWc32hjsrcWqXH4zL34zleHNsaNj2d0Pjjmo2d/mwQ3GsX0n5huAmlAFQVHVGh/b8v/8AWYf/AOeWdr1vMQe1W0Fm6SeQsordkKMmASSfyhYC1Juz3Coy6L5Jp3x5uCkfL/Zua5ii2RLXHQB+53xeTGtDikxqlvZ0bdkxSoeggE8Q4E7x7jxckeJdQ1jydq7hcfJcUH6A1DS3vyCqZOz6ORzVTh534MJ380sLDd/mKzDNGBP8nOaZx76yLv8AP55TJqAauTwTBXifmOV/XSHrT2pSB3fnLVKSvQp5H7GP6m75/HSTsTkDKE6NNmro5eWBc/FMN/t9aPPihFTeWM4YMJQK8nnDrvY56bnwRCp69xaUv/uuVR3ocl4l3z+Pp5BHKckk0G5Og4zCr7gMfIBRTh1I8+cLrFG/j/8A4iJQ6JZuwyxpgfG2nHtMvTpz6zleMcPjvk5u3vae1cAtkyiwll+WMe66VBWHd65J/IfOszV8exuYiVF6c88q6RVNsnC3InnNomtioiCean7LhXhEnuQeCLPrQZ+d/CeR5jkePNIArdaZaxz27Jxzw9O5mD6z+J/rrqWLpAFaBD0mahSpnoQBp0+3uBPEZxiabffpEaO613exARhVZg4ForXlW/WmBWVqoLt7A3+PcnyFCgcuZ71GZYZgh7Nv592IceGJ6xtUHIOfa7xprb3X84SqapDqrmBhmIrD5Qt32/vx5KGMvHEZ/LFf4zA2lpkAitzZEwRBMeB3HCLDZz6DpS180zZ1LQXn5xWzBxYbu4LmiW67kOSaqnj07ij9fsk6Icr74uutWlf1fGANPG/ZFqzzO7RM9qxH9xmKpOhJqLMPhR+zc5Jo3MM3Z5vVLENkKFO2gzL17/H1cdlTFNTrWH696KyMY7eNUnc33l4ZxfIUs/teNICVKFReW13QM41MeftPlXTFcXfGtFKHBS5qhHQ1riphLjWpPvvVgJ80sq3kLowd3nX0npzk70glM2KlX6zMJ+FlJCS2FvnVjvyVWeg/1dutItZsfDyXICn3i4QNm6fI5NNyJ6npiEf5yLrp1XJ8lCwj0mAJ5sh8bvhdNmklSHL3UogHj+gfWEl1DuNr0OVmp1s+D62ikAlvp+mmeXN1yi8M0VWsCmkqRFedvKf65pwOVU6bVmPnPnCyu2blMpxHTDdmL5XjDkkgcLiOjT8HvNyLxPpWlXRRr9gQypTy7gaB47DJgMsrXsQB0YpzRHdZxAHUEyHB53S/AcjxhpZZgImVL7RzWfx5MCkcnawO+TklYGqoFR2Nevylb1uXt/LWW84tKY0gLy8Lzg/7GZ/rCmZNPtYHd3DzNc8220t3B6Mz+NJDH0rVMOuNQrzWVn9psmmpRGAs0OPeILtAUjpG9Zr3juHorZiddVIM7176/qvXTatF9U6g9gfEe1v6VWSoX08AoaxCTEfQUocMT1rbjTx/haEq8gvPK1cl6w6JsMeueCjmTPvIbbYWYfY0qnapU7lIm5Brz7Hm4lw7T3fhPMCD2LYBg8MD2lgeUhBx2utgtYkG0Lalnn+Su4RcdcXmNenQkwbEviujHT8W5wK9fsP6N1Q2TcfJQJreIbpQGW+hWTNb/i7GWNoORoZhq8H5DIGgmZ0G7uuMBxecko5uK08WemY+O9o/2R2OFhCyMx3D4DaHJ73yq5H2xjuHyb1U6xaGniewhvyJh/cZMtjB+uQ5utyNyn9ZiHWD7NNPIb7Lc1X/AErRJhfJ+Usdx31o48aoA878N8noTcUYrrWXnvw7iVa4leSbg+vT5Db/AMuSjAL7ArAFKsUyE5XgDmitJ5i5l8xAsh0KM9yzNKip3lOOSe+3BWa9/q/rF+SnbVnu/fFura2mLhEbiwL8SIj9S+8y5mUCWnQEcp8dYvb2N0zLz89TmysflXdxyj5aLb+o/m7/ALZ8o39m0tjencR5zONYbx3dQWeRLHM5GwGdJQPMSBEafky/t6oteKJ1k7XtlShmJQs/sifbQ+ckhq9ENSBEhS2IxirFTrarp7aRFbD/AI9L9PkXwMJXRRDujMkM5fmdb5HOg6jVvmxM6rmrDV0CnAS0d5NIhCyhlD2az5yTTbw18Da/Ul/X8oWoeDr5Mx0zWpgBkL6hQxcs2ZX+uMazikrqWFh66o6h1zf4qhY8jyDt64OEW5vJ6kFWGlXYGiWb8hIc4Q+KSiemikfdnzi+POaU/tPwlZ1z1MyOWj3A7ce8fDtKmpc6atd2Dt4A+U5dKFje5yQcb0nvyW3VmxSfsdzeXc+YOnj+RipXTvt15bm8Hc7j+a5VVLtp00Fp5yL7b26tMQ6rDZvmVnLrJiFJjyrFM6Zxrbd8WcjZEspm+NUcpNtc4qUiKjEyolSpPHZgC3W/6LM9jb/+J2//ALGZjZgdS9wvMB3xyHrCqGNKiazt4PQ4xjStynT+woixBcYgGCcp0ngkRHp0eiEnJ+q0sM+mbRw+etdYrULcMt3NdNu0py/dSoC3F8dT0rvZXM7VGLnm/wBWNsjzkH+MYLAObjPc7+QPfMlQ5H1850bvLclQVbc3DXh/OZlxaaYzfp/8fK5un9IYJm3K1ezHJ461EuB7nbjsNYek7CbyYGiPZ0aZGZyJnaA0a5rBoEvPzmbUSwU8WAnrJv0P5wa+Phip+16nujJLPHG59YG1S8aTkqt8M16Sryzwc0bp+rNOSGKnh2WOfrUyF0NcSgW3PCE4L+q0h/G27svLOpkzcULvLP5DXbexOrwgeoPclWvXbz9j7kiMv1xDQZNBLxtgKW0aNH8LncDaUVL5Al+fX/rOhy+Vpuc/MeaizVs5aJjUMXFiTncPsc3kUuP2jSIlpEDs8J/9qKev/p8VJLi0JF793RIN1zcVEk2WPM8IgYxKTc5eoIzSfr8mZeus4c66KhXnS1ULqvuBcWaqr0h8VLxo8WRanGtwmHrYdSGn+m4LA8H8vOZ1sjZJeq9EmbtaZlNQeeX56iDc4mnj4eRp9frzWGOYAPcwvMSia/fxrYz2kSe1rda/9PKJY9mv+z40QaPyGQc5KpzI9S6YvL85Qlbc6VWb66QGb2zP+mGx+nzRX2X6eSzWEnafOr0hSZyU+omWugx+9BTq+Mvq/dKkCwug7hkl0hcgjXqxYT+dDj2ObNYFOq8z2pt8cY5wpcGgdT1PHQYq52W08aMm5CwypPa9ZttSGKbm6LN8r2X+xfY7cxWWT4WMRVZyzo2145kwk7XcX1K7o2JRKmMl5nJZB/Y0myJU/gvO4jlpnRbFGmfroiG/EtSlLvUOIzXie0fcYf74Z+N/Pz//xAA8EAABAgUCBAQFAgYBAwUBAAACARIAAxEiMiFCEzFRUkFhYnEEI4GRoXKCM7HB0eHwFFOy8SRDY5LC0v/aAAgBAQATPwCUrhDu4guLomMAVAMTq0Rc1pd3akJNCwm4iO5vXlEszAkEhaTSJt0TfiZpkdzduXvWJYmNrkG5xlbrc2OI2QZAKtKWeJF5FrCLwmPuEiDb4tbpCiZiptyltLEe4omIQgu0mjl5QrviKluJjWkQ9K0hWteYq7dcI/aAZJJBPJ30RPeJhCxRdiOXgtPOERwKRBd+6iojo4YteFRJxCvmkGgiCsFok51par4RQ5pOcjiuIYBOEJym2lUbiItV526VhTIAXiirGkTR5rE35u5znDaXPrEr4YdL/wBzWwa2zAa5wi4Rb4W1jhuNRyIdwly9oArsm3NIiuVUgHNSbuy7l26uhJghbuEWj1VboOaJEpATRKJIEZqPw+4Ra1pL0iYnCLihaQ2u6InWHlCygHbuHa3lXl1hRIiNn/TLH6FpCKIli5u325wc4yNR127S84lCOpuxFzre6lIlNmylutFto8tvOAQTICd2Fh+Yr82WO45bitb05VhXWM3TBrcWu3TxVIVTsfQrR3a1TpHxBtqLVaUsdxeHSPiJl3xDCR5F2yxp0g7WC0LvSOqJ1hHGE/kIiIttctE8oa8QICv4t3XH7wnwwgLW8S7u5JEuSKsIyvErstOkNFrMScW0daNiWpfMYK4i7Km2Aspy7vp9KxLmE5S0IrnWuqlsJLuMd2X0QSiasrtRw2/yhHNUQ2DaPjrCEI0ZcLm3Z9aQhPKz9P26RMMgudbbLLHWAkC5zlbu60gZTbW3EWtw184lCTsbnDc2GysfCElu4Q/uUmj5wk0QBuuDbRma9KRJMgDFzCuyGiXQc4mhtY51w1RF6xKIz/477XdPmL9oK0kIBdcBEQtGmMNFJCi+1wbPTpEsaioOTErR821SEQXTRMktt2x8MLSQmbe726wcwjYOVwuz56DC3cN9SxK0i9W2Da3FC3XCQ62+esS7mWNEiLb1b7KsLMF5vyJu7WqOgJ9RWxRHXcXO1I4ghKTnuG53msBLEiS5HCRu3c4VXEpNta3QeUGtxk5tzREm6ZJEr4WaZIIj/vOJaABGOt/zCIhcv1pSJ3xIlbNFBxbaJR/F4b91zboMSIT4XeIxLZKJPSIkt31iSUoXsqOQj0RXQc4iK8sSafXWOGJj6RluJvhT3hJYkTpRIRWuLwpD/BP3QhiU+WPaO4uWW2EMiFA1uaJNEvTHw0toz5QVISEyxPu0p1hVdce7FvOJiMNJZijcsh1VG9YSZcgh3CNpc4DIyfg7J3kUS5V8iYZN6W84awZo5CWTXQj3g0FcJD3VTb4wbGyw9TiyrVG/mAtM7c/3a2wCkFHgoucRO8VWFVwy32tdvIqfWEl3qIVcLrhbys21WElOsMkud26LikTJYnQj2iJFl4Qkpwr6fv8A3iZPMbjtGyWP+IoIkBSicIiRHuTKukB8USSjZc0eGjXFuTosS5RGSXLi5LS1SFmkIoIGjRIdw6dIl2UAyc95Jc1IBxCpBbjtdDCem4bpn86Rx2iu4SEbRhTfSW3aTsqLWEliZKQEhO/cu2GgAIM20htGFJKqg6VhUFp2uI5hFbd0r4pCoLUIxytxLRFbCOMgL/qj+qlCHbExRlDL9F2XK6EcBgytvaRWWjB2Ejx7hTy8KxMITH4gW3CR4lp9Y+InCkiUwkEQmbiHtOlR8YlqL/hDY5je2tXfjSFmuFgXOIRKElkYyzDd6nVxp9IRwULHIciqqYxKQjMyDINrea+Q9Ylk4phazCb+ncvXlSFQlJH0uL6p7lEpQEQEKlddiW6FRou1IicK/wDnWElkAo/9PnEx4ll2/VFupEyYJE5ys7m80dAyzI0Pdw3CLYRgiZaZOUhbr5wcz5SjKG5zvJYlKJiYiW3TMq9FhSvkC5XAW3wRvksFwnL6hyL8QkoRw3OIRv5JBzOXK7dEqa1gttLIf3DSJazSBrbiISK12qcov/8A4iaIIQSmYFba6it5dVjhvo8bStuKZz9q9YCYwELc5w+ziGEQGo/1F20X2TnCzHEpOUhuG4G1t0hJYma2XOFv56a6QaDNEO5vDy02pHxCEBs0cEzh2k5Kt7uUTJ1yiGX7vEYPhHSUAuE3lcLvprACQ15tyG3SjYA3MJzRL793hWHCImOROuJsuq7coMhQJgcJRa3tGlG/SDKgKJjaMxu3k3tpCymCggC2/Mu35a684kyyaDwtAnCPgnvE0xEVfk0BuiYoq8tSImEW7W4oNkqVL4RK31eUSZBziP0vJoiNInzWkH/1+vjFhHio9SIYO4VeLcXXS9aQqtIJjshCW5zfOJaCBIRlaZORxDRfFVXWEAiJ24bSy0ti2UUwQHEnC5tFy8khFBnC0uIcvt4pE1B2TXMIR8tXa6wrqinTlBoHFdo9wlkI0RsSgMP+RzaQl7LEtGkjOwSIfFLR20rE5RKpEKkJETt1bW6RLHggcsK3W2+COEsYWWZEZmGTvfWFAhMLkeIja5yLj5LrAtIlE9xOx8LFSDcVZZ0u23UBEGOGTkYKk63HXTnHCoSF3ZYwbxrg0Wiu2lsKrgQu6Z2818YRB4viLiHb/tINGi06iRTC2tRLaYw47yMVddu5rCoRljudurp4ws1pqRji1uWscQReTWiPy2+NFivFNedxDLG77pBzJXwgGOttCccKpFVg43C7rrtpHwwl8RPBgq0phcudLR1iZKIqE5Jl17RL7wEwTYwLritEtcYMyIW7RL9MPASmCeJu2t1+ixLmvpLxMC7eaYwk4wBbrrRL68oOWZ/Kclw7R5QkoaVhRfcFHDl/SDXhEgud8wRxHxEfLWG1NSAVtI5hWjorvtDhHil2iNrRGAY5bkFu75WnvpWJky9ZfuRf6kLNcYE1SsQic0VTFPFYmCHyiMbmu86W+HWFmk5RArmiP+jXSElkYt2k4u6JpjKJoCjSaJeSeFOkAFssWpl9EVC5ecTvmkZHRznEIuGiK2kGYsmDKFBHHERqil+IQSXik20R9PO6PiSIJqCBKP7edBGJT5Qo8XCI4uHRHcoNC+awHCQ9paeES5XFJGC4stusTkFqy8RGpKLW66l5pCKJA0KXSyER/KrFpz1YW5zrtUiZLM2THLkRE1o9BSsSkJAmGFpNAcusTpgka3KJEQy91aQEoiJSarnOFt0HJuWXN/8ACWwaiBIB1liJNddyxWHCVSMOGQi7zWDMSqM0kFg9nqHmPhHF5eXOAlEInMehEJNyEeZLBqTgIxR1pe/sMTVYCidRErttVW3dziVJFh82tJrSbS5INAGUHCrcQtdbWscMy4g7iHFojonqrBo4maYkTmjotxZeEThIhDc6W20oOWwf0jj/AFSEO6a8HNG3yXGAT02EPp/pE1xC0Btdt8V6xLluIxx2t8YOaw0ZaMgQ2j/VYlIIEYtSY0v/ABEyU+omLXW7dNv8omIMoLwS4r7v80g5pjV4KJAzJutbolIMoFZUREi3FytHKER0hR0K8iaJfVaRMKxR2sGg3e0TFGVw5oE4XCSERuVP5awE0tNxOMnCLvJIlGQjstI9wiyJZCJOMgIWju8boUxIZY6k0vVCy7jYSYj70X8pAzNki0hFSc7XpoMAooMuUdwh6pkXgIFNC1u21deXKOLI1Ikqq5QZsEyc1penu59YtvY94W7RrX8RNGxxk1zdpUokI5qy3LtrmNUSF4rFFyXEO5y5f2hZjq2rbtIueUJLcSFoNp/9vh4QlwP3CTrnapqOUXFUWI0bdun5WEIpNRAkxudcq3LEqdxSQQFHA4rhzq6JaiJGUomucWRc3RxxMjIKE5jrhKJcqaYmTbbihFESAmq1w5N/MTZo6PF1rnO5wkwjFBaksSuLKp47VhUYR25CW0oMSMkICuIXbqVaVETyiUgjU5VziLaNKeMTZnFJLQFhFiRadFiVJIAcWIOJHNprrEs+KQC5pERWhEpRGgmaDdb5opCNOaVhUumFiQ/iEC2Zzu9PP2iYoiDJspoXXEI9xc4mIRkBOubtu9oCVxheFe4riFFuiZLF3yqEAj/fnHGOJjjKZ3NIhyFIVojLluUiu+kS5glw33DxBxdSATbreTmuKqXFBFwglNqTJbcuaZRKVxzZhlldlFB0eQlaOwqJ9omS33dzvV1GDNohMC54jkXt0hEI6i7ERluEtNPzBkIkggXuRNHzhEKdTim4ju3a06awksRM5jmkP7edtPGkfEzCajR2i7+UKjhN49zRb7VhFvWXoNv1pHw7WOc30/uj4e6swHuBo2t5OiZMGVKMgFxNB2RJo0liZLEhkTANRxddySJUpryxuJu76xNMhBScpFta2iVJ3SJkoTNSdk2X73DRInIIEoNcDhytVIA+RBc0WuL9S0j4a2kp6kTbcaQjFF4WiItETHSkKgsWZqJeRDqixxeCKbXt7Ylq4TmNaAeka1/rA/DA2vl5RMmMFSd/+dYBxs9RC1rawqiJz5jncUjJpNLVtetYl/wkJ23u/rSJs1pLLbiI+ywkwzFRDaJYuhREqNJMjIrh7orao7haOJa+UKAkRhK7SIulYmTSIkELREWjbzpHFIhUjJBNrl/lp0iTKtXk3ux1X3jnw/S+1/vSJYurLbcRKV3VG8ypWCmOJCsFxN+9awpuIH02kVvLzdE20FIAWYLbelbeUIBSqSzqJNLIXa2wbviBZuInFjzSFaJIL1LEe6qqOsSZRPxO51xNLypBuOgPW5xWuJaRJEXKRlc4hS708oMqkgzakIu7a6+8XNaYKN31RYmA4luQj/V09UTEMKlk0RLItMuUTWHSbqLRFt0BLeMyaBCV3boqL9VjkTpROEmkOPnASrUJeaJryhZZkSiE3a4YVR4sznYICNo+HtVYoJignaQSfV3NhAERNhJdltpT/EKpDNUj+uNK+cG1qy2Ox7o4wnN4gYD/ADTrAFwazGpiRC7wW6NplNHa0uiQkoXtC4huyLwtgwaMiW5SBvcUZsEhG21ou8ChJbqiZoLricOtYQi2EhGLRS0tfLRUioyhc1LZYuLHnbBS3mjxW4fro6lqVhSIase24vZUhEMyAXKIi0rS1TdFZQGYhiVaeaL0hFfWXNpMISuaOu6DmkFBAlu/P3hHGKkJK1t13ikfDyhAAt3E4WiXTnH8WbZQWuK0YRGi8MRJu4qonvFRec06EWWIlVVdD7TEKi0t3R0L/wC5NC4C/VovjCTiEQFuRNipkSMLh3Fj5tSOFy8sYQGhedrXYjXLrSJhkYoR0dwxEci61iVaDwuuIdvdr4aRdNOaQC24bWgOiD4Qp/wxduKXlqqZLdWiRNIkL4gcTAXOa6i2wjBBQMUa13atEKAHkTcX+1YNRCar6Yi3p1i2aUuXraPq/nExGmgAKC523mvkMTPiSMmmOQt80+sN5kBJcJf5gJjWEeF7Wt8q06x8MPFILtx4sLVNF5pE6aPFbtERHIS5trAFNAlHK4chKi2xMMJXCDR1ouurE6WU4m7Wni3krYkymiZAKNcJNHxRYX4kQGw8Sbl/eFmEXDF3qXOtYlMbMA65XNt1aUTZpGK8rRD+0SnNOaAjb8wYRG14QLjbc3TL3igsTmIiJSxu5pE4DGaoOaRdotVfeEQVBpihWlM96lEwG1uAnD2jp9arHG/zCTSZLZQitJ35iZ8S0VIqDaNt3n+YlDtDG/8A7iHGqRLmmPHHG79KLjEtxChcVBeRbi1+kTFHIxaTRG7kvt4QEoiHuFrcS1SFltGUyjWkTS8Ei0rQyaJCVun9o4IgIEA//GQ3aQYko2GpE51o+DolIIGsvXEhudSHCRoZknyhG4uSJ4+8BKEHzAqJERTCcTdLuixJue8siIvvQYVakFzWj26e0SpgscdrrsfcolnXivJwuaWWleUTBIyQb/p4fWEltqTVcRYjaiY0iaVsq/Lu8MeUAICS8t3qqsKfIQFXOISa0YlBcoucIuF0TCECAABMRbd1iU5xvEhDG61ftAynArCuG7MRplziUo2DtKYbi6WjCHQZYgLbQblROcAThvFSd+YoPT3hTaAEZNLG7/dIY8W6uJxZQikT5QHeRD26LCyCYgmKuaRWjpoXjHxJE2Z2iI7eXKKCRgGlw3FcKwa2zBa67cOqQiNBpkrSIi9tqcqxKQf/AFNqFuyEVrdTksGrSQjFo2iPSDcYWDbZjEsbQHQmCPdycW2JLXTM3XzLm6JrDmnNHUhLtJsfwhUQyIgxEqVxWDXvuhRaSsoQutaQ6V69YlynDwiFxEKttL3iYrC8Wjc4ibXwiatkr1EIo4ne6QgUJL0ucWXODIyrdtH3hAaMuXqTrt0IBCSi1pNL6QaiJTCMW3F3RJnjeJ7rkLxVbomSgejDUf4pNK7S0a81iXMKScwXKIkJdxcnR8PMebm3CTSc3xdyhXAUsRHuyIaawwbk65wj1MCdYIiJFbRE5wc4pVv7u5aRQdDc1svuEUx18awriKYfcTshGi3boACGUgtymXYlCq4zJyPFw3Dy94lSSCvN+TeqRMnCQIDnEBDd7lSGCA4ZD2jz+iLEtRPEHEBYt194VeV1133ugJhaC3JvtthWiJ8nuHcP+pH8I09Tu37LH8IlI6Werw0iUov7Wy9xaKnnpHxOXjaREWVNekKptx9v9rzhFARQQpcLmkQ+RQkwVu0xLtJekJLIhyQhu+nX6RUQJR9riLwthUcSCZo3tKFQjIyDJvdpTKAS6X6omSy1ZUnF6qViUjAWY5xEQ7hH+tIURnGjCxbUfFKdImtlSkeK4ju5/TrE1bDFzRD1eOMAFv005QDULhffqu2AlFNJpbhIt0KouxQSbblEqWRSnATW44+8TJ7aC1xG0fbckJLb80CtNtvmrfLlCEQEBd0sv6wq73KVx5XIsLqLpVSER/TEtCIkfdaOTqrCIICFq2i7bWkSphKUu9ptdhEtRlEzFrNwwZE3K136ekKLRAWoWGI8kSABopzIhIvtAXUIza1359MKjiliNxERbfpEqa29uJEV38vaFmvFGbi7R1T3hJRMPtC60ecKIuUm5NEsfzCfDGQr824nFthZTKvDIu11IlyyM0fUh/T9YmTBEgHutGFUhqXCc1zctYmy3UJ1xNFvVcveDF/EJrrQcVsTUcYMNCEZY7S/rH/Ip+HRURYQEm4ch8YqQ2tdbda7T9NYRqkonb8ssW+e6sIRMdpa3E+S+Qweot7f1UXn1jimNxg0RHwERp5wkvi2hi0cnVSEFi45CBXEUScm6NLqXLJdIXHK0rdwqi+NtVhBawAO4ZaZc1VP5woPJBbdbuLWJlopKCrXF6kRV/EGQ/MEBy9RU16xNtID/humXWiVKQHhzFze0dUiYpGKS5o59oiSrBSucs7WiQ+VV52waikpk3ELkIh99sSQfUT2iRWi7lyhZ5ILjLFjbi1xgJfJ5Lll41WFLkQFi0sS0r4xaRKEokK67oGUKd3/ACTBSAWiruqRLUsWoTB7hHdWJjRNwDi0nOHTGDUCJSM3EMvtLzGJU501eYtdW3X3iUREZi5cjydrjpDR5QswjICMXbbRd7wBCIvArWt20+9dYYQHNE8he7alXRNmsALlbjcRap0SEmkIYoRCIj7dbqQRWgQEpOEfZIRxGBAKfubADarButuLksTZYyiSVuJ253nAA2ohg5uQ8/eJmLTLu3aboVXElyC63HVKNpyiXLuboLSuu1rCTXEcp2Qt8qK3pWJdwgWhARerkkKtrztIfv8AikKtsyaFRubtHRolCcIBkbXNgDIRfKFwk3EuX1hZjhmFoWXaSHWF8SEkaTXOtrSJcsmte5o2kI6pBzbmyiVwiIuLZuhVDQAFtv8AmHueQVHKJswhFultu7yGEmEVXlxMiG7RUhZYnw5bXE5vdBywOepGVpiGXndSPiZYlNQWtK0fLw5a9YZIH8eEf//EACARAQEAAwEBAQEBAAMAAAAAAAECAxESACETIjEQMjP/2gAIAQIBAQgAnFjvk8wwUVH9ZP64alWimgGyEG47N+khNe6KrVH8z1ZEN1Uajn4DPPDFz7XXU+17+D5H3/HHA97qXUzL2ITdJMz5p26MS5Jv1RJK+jczU0wQOSt7PV3o9FLJfqqSuq6x+m0BOpKS/wBPmp77iJ98tdRsNUqgehJ69enlpnUrBVSpVSZIPTX8R3i1w8ubJet9z4qb3+h9yahqHHT7ccYkTdgTj/N+IhE+21VhV/zha3VYkYws7K2RF6ECBhewUrvr/iOaNlctEkxVPOPNbEk+nETkH237tKmJfEGrTIEuJ9cuT9eZxk0lsoPo3zyByO1kGjo9jV1Jo2XTWnfvhOOG+GmfY4Bmar86xxXsPOqr2+rx+jI3OTyE36a/9JmN/V5OEqdBUe3Xok3GSrN1i1MkvuuMexmesVelDgnENYcdUFGFqh65Qom8oVszammhr0nTr0wztoSjqvxj1uM+svfLNVUVuui8bKs73W4nNQTfWEPCuHVXUOIoiWqrXQZVcquSgmZKun59oOhNfnfr/wCrSiyVfy80LWZmclk2tG2WrhNdxcDkmcVaizhUIbsm5pyTRzTXKFzbPv8ASpOtfT9J9L1Xras583wQlGlj07MeRkmpSvTcUZd/WDmYTFzP3ul4o/bwc5W2p2yeDiqkMet+/v3/xAAqEQEAAgIBBAICAQMFAAAAAAABABECITESQVFhIpFxgQMTMqFScpKxwf/aAAgBAgEJPwATwzjzoufycZMyUMu1dvzxML3tXtMDbv4sODQXqZaNbsWp0mVKNsenX9t6nU2d/wDy4eku9webu4tWdiYa6QGJ/wAo9MXI+2bHzxMd740MK1sO24/nKZDZ5Z70MviqqZnooKiW14WVfJX1NvsWY5BxVJDJbrcyxgV4bm2oY0DvxHFW99tTJExpMRme/wA3UzemyvfqYl009idRf5YZ5f7uLldocmUyG8TnW4CeDtOZ/E/TOzqm5imIV1NzWIPnf4hl/bpy7b7+5k3XhmQE5LWzgnFO0j8rOCYZdPbqYA2PupaCrp5uY+vcGtx3yDcyYnTXFVuPFlX3iVVc8TlaemORWN3z2uZOzgjkfK1dwf6ezYc3MSzs8VFMbxuvEv6th0lZaqPbY7mGNFl3UaPV7n/cpAb3CtVM61wa3vxMb6lNX5jWTjQ2auZW06crqW/I2HuDz326mSANQ+9TJLSg124mO7b7kAd81CxN6Jjo+JOn6YpWXUmWX+I68vaAnNd5hu3TKveSc2znH+PLJovmDblf7JkvyGZUVlpJVdIxx6aEjoSqO009dMeNa7QTqqhmJ9QDEyugl1RkDLd/6e0wHLq3fb6mRfB0tUVxHloO3FxdX+4UYs/GvcGscU5GNYgaNy3Q/U+NOL+65j4ZgeAn8/8AllvF7KmmZJ08HHePUnAt8QujF17LmvkL+5xjkA8VqChjZMVtxKWq7w73q9zHHevMaXHL9xOlxMrlAVVO9xVchnTHha1XMy3V8cRytadMHY71qtwcrwQK1E+IFHqXzcHHUXbaj3iDqt3q5mO/q4bSz0VM3HEB9ahzj67TBElT/8QAHxEBAQADAQEBAAMBAAAAAAAAAQIAERIDISITMTJB/9oACAEDAQEIAK9bndYUWiP4j52TWiWSVZhs+RTDlN7zlJ3K7rU9URM11XWlSitlRX9laZTbh07a+f8ALrXGTYq0MUbZkaUJNG31OEybpTL+0VJfSQaBclhXKk64yRTU6vKgV3zTIzw7arli6o2zrdaVZn5ty/1zqdnRM075vU0CFcU5RqrI9NlAnl5xvXDjNRrj+p3YWWGasqzCtQq+nZmz9OaCYamP16kgT6Gq9OtaCvSzEd2lzudm545csodM9B01cz9vxjpaH0XzzR8wSroxr/A+a1/IZFHmeW303IyUKadbWn7/AETTsfuXo3WbeWJIdazSt1Md89Zdruie4upfUoYnCeZvKgl8wFZyjXFVYZs6/P3orNGVVHXnEV+b3Vb+mu71RVc+s59emvVD19JlYfUkRnoWeo83I0+W6klkynU/Ksr4O5dT/NWSejrVhBXczNmp44soCn5J3XiLUM+m8dHr1PnPp/Jy3RMSPO/IDzA85culJg+/BeUd78sjXXIOq1H+fG9HiUxDUaM7Jit75ubo87fSRuK6AaoiO4qTzZSp4EeKgcDTLnO84rL/ADORzP6wgurll/zeU79PMpqaGcfOpfJPhdd1cvr1RzxOdj/Di785g6J25suSsfT+tbM//8QAKhEAAgICAQMDBAIDAQAAAAAAAREAIQIxQRJRYSKBkQMycaGSwUKisvD/2gAIAQMBCT8AOJe4LaVlT6QDExAJHL/rczVOhMqA7iHmyTMbN8VGmiEJi72rgAX/ALiBcgpTIaiauzMxvUwP8YsveLEyiO0NDvZHmXyCYPaAgA9hBtWcZ0hcgzEjuWS4MkG9r9wkhK/mUPBAmQJHkGECnBlCX3pSgzVQkM924MgAqNbmIROyQRMKXaYglfEypj3cTHtOnHyI5dg/ExIs6uoS59sz/Yna2JliT2CheVdqhGwwOa4mI33BmJJlcb5hZqgZ9pHKmWPUv8Q4Sdjw4USlfiZbtcQi13g8EiYRt7brsoPdcRtvW5Q2HqDEspamOO1cANfiEdaB2ZmUeQbcDKKfeAQ9RYcGjRFOZ5NArcvLyqn/ADGCSFUPILMwZf5r3mS6VtQDINog8TEgMWMVF9rRPidvwLExBZEP9wA0W/HMy7V4Ma9OnDY8mZN2YMv5CI0ACMTBe0HcJB/UzKqxCVWINTRzAFrUIQCgxx9Jo7uYhk46Mb6qmOTsGDwWZbxYlPZMOtkTLKZE5EbJiYyTEQWOurmfUy6emlzBWz1WzBq/MAsgfibyxh8+rxCCyEEZs5FuK2Nd5ZIImNpPvMj3Jn0v9YV7Fy5iPVs7gT5AW4UyR8S6IHtN5A5EC24QCcpliCAS1Da54mR73UDAI9rj6mQpy2xEgF8QQfk9T1Maa3udKx1YhFEVcIxWTJcfqdnzF2hGVn5MVAgVxAxfCuYKr8qGgUfJmIyyOR/cKWXmZAgx/An/2Q==",KMt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAACplBMVEXt8fHu8vPx9PXw9PTx9fbv8/Tw9PXy9vfu8vLy9fbs8PHr7+/t8fLx9fXu8fHv8/Pz9/jx9PTs8PDz9vfs7/Dr7/Dv8vPr7u/q7u/w8/Tr7+7w8/Pp7Ozu8fLv8vLu8PDq7e7q7e3q7u7s7u7o6+rp7e3s8O/t8PHy9fXq7/Lq7ezo7Ovo6+vs7+/n6+rn6+3q7u3q7/Hw8vLo7Ozt8O/u8vHs7+7n6ejy9vbp7e7o7e/m6ejn7O7p6+vn6un09/j0+Pnq7Ozv8/Lu8fDp7vDo7fDu8PHp7ezp7vHr8fTw9PPo6unm6Ofp7O3p7Ovq8PPs8PPn6+zn7O/o6urt7+/q8PLm6+7i6Ons8vTo7O7x8/Tr7ezo6+3n6urj6Oni6Ofq7vHl6uzk6u3s7u/u8vDl6ens7u3l6+zl6eri5+fs8O7k6evl6+309/fq7Ovi8u/l6uvi6Ojt8vXo7O/p7fDr7e3n6+7z9vbn7Ozr7e7n6+nq7vDl6+vo7Ork6Onj6erl6ejv8fLh5ebh5eXw8vPp7e/k6uvr8fLm6+vz9fbj6Orr7+3x9fTy9PXo7e7l6evq7e/i5ubl6urr8fPt8e/j6Ojt7/Di5+bj6ezl6+7O3+nn6+vq7O3v8vHw9PLs7+3p7evt8/bp7Orn6eng5eTl6ebq7evk6enp7u/O3ujo6+nm6ObQ4ezg5OTR4+7s8fPq7uzl6Obm6+ro7vHq7/Dv8/HP4ezQ4u3h5+rU5fHV5vLj6u3e4+TS5O/p7O/0+Pjo7O3p7/Lm6uzi5+vo6+zh5ujM3OXM3ejn7fDj5+rK2+Xm6efq8PHt8O7p6+zj6Ozy9vXf5ebm6uvq7fDN3+v09vfm7O7j5+fQ4Ovm7e/m6ujq7+/I2OLj5ePn6efn6ujo6uu61egLgEBdAACIS0lEQVR42lzY+3cb12Eo6r1n9mP2nj2YwbwHwECDMcEB+BL4FECRBPiARciiUFMiXcuRSkTxYSSOtCSKoo4s24xqWSdSpMSWLNeN7DRpciKvtE7sJq6dkzhxnHjVdyW3jductulZq/f8Kfenu+5d98/4PtDX19CR14LJGvMcbEDDo1t+lL88kXdi3FFgggMrhOwTlEjw/LF8oT6jeInmkkTQz5DHLf1oAZm7gefigND5xb2Bvx5+7z8f+y9H+n/+7jxV8iuu596nnggDW4H0M4GMiNtUBPeDyFkxI+6Fu1IcmpkjC79Z/Kz80GzItnbY7hm2dzgPfejfd6HScMsSOJ1ynBBGiln/V4YneUPYHT/0DV/RY1mjtvIPgEWOZ0W6ZrUDC+IWt7lUZZ7Ul8VJ4eqqY0HLEk0C17hwxIkFVTnW4wrDEWGQrlmQQb0ccbMjLKFZGlvJv1QcyuT6lUKucql+gttxHEfOuhAWZJrQWEfXILQg40ZqR07kMQfzdWhppfIxtZDt3cHGVW7e0OytFrO8N+ME8zURcYJZEFeWJrmlGbx50lmFFh/G2LgSL02CmOSJxuA3QZ/sC9dzA7dKOUVIonbYCRM0aHv1LD5VdMI6dWwRpAmk+lVde/bongzMw5nS1dnCUy8cGzaVY1NA36N+Av3IHtefV771zIh2ujYG2nMTJw8fn7DL7haGANrIlUg3MFRiODjxN8LI4SqWOLpPeVIGC+MjYVdFxoornOLpZcexST9/nLjr1DYcLAzorevHHvNUFg+RjmFT3/YMvThNmApdh2DwBzCBbmkVlxk8lROBmClcXmVERYBUVHUTqpIqm9TmG76PiWuaSv4Ts56RC4WgBp5WLxcyjswzmXuGY1BGRDj70pj82oT6WO7IwT+7EmuXx+Q4x6vMxw1OJSL1hMmNpktVvsGMls9ty6dV0aCxZBp1K3XLJhFkGGW3ucMMnFA4nEohdCdtOzF2KkXUED7Vrc5k3XOp2gzPdXRKkSCMsp8C7lD1zcjRvNsWE9yCdqR3seZY2Atk+UJsNaHRZJC1PcE9jy+I5pYPskcmWKQZHU+SCLZZk10AifAsTRPS9wbGclL2yMDgwEx58Vhfrr+fOWsE6sTintfsSpEFDZt51pplOU0oDAZ7AbYYb0Zmq6fxgBNbh15VYgRyJuGgE2FGbBs22apkNbnwSAyWzSuSJlY8LbogVIEDW2jG3wM2/EszjqQg+UbRQLbBQ4+uEyQF8bHiuVzVdXziGkmEqioKnAYEDuk4jFyOTBXyDRsi3yWA28t+vgHdgFok7X+CRvPfOjh48H9NnZ0amDj4rMq3sY1EQ7iCLvs+hg7EdtAmAnDf41Zjy3NgQV1AGugmgkNKgOR3wiCMnIVYTn5hCz9IMA3CthO4EbLU1wvTCZIcG3KHdsN8o04thJyPgD7OTucTmfhPtwIDwVDYds8ZVsL664zwJWa4BLs0tHYNlftOw6bOjkgUynynAXuSz4jhiySocr+FmqavgqdjaI4X+l+TJ/6iAqbOVxRU+OUeT3SDq3JgdHjghjYJMOsoDSuhFBrBJVYWjVlKSWsjwM3Q/ZiTYMehgWonyuvNrexp2Qx8yQ8uYSr5UujH/Cml0SSSjX1pOT5dR1Io+d5HwI0MUtJaGmx70GMWtwXvWKIYxVcZkKbvYkiEHWG9xyPHiohns5RD4QU296SqLXQWMUjs24xwrDehpvTw/87cGOwb6T/wUq3UN3a2UjokUkcY3BJO01uVBCMSxlFr2RJBZIuAkTUj8sxFz8IwZVhgC5qml14ZhtzyiG2OlgoO9wizm23BNM8hlqCfsMjjmggsvs6aAgqCLfgRgMRwknIrwMu+TrEh3Aht5zRDkj3HIF3HCpEU2NDtJZHLGl7IaDuUEqtluRB1UN3x3cQw0FbIfc8QPpFS8vviSF92JFN7tTg3a8pnz5vBdAYZko8lK2z7Fk4CH3vGOiLAQLYf0C3fD+3MFSKcqouNoGx9baj2wHWoZ/DQ493YCy0CQwltGYJGAIaJv95ACLrCEGSPU9MLpET4H4Av7nZ6O51ed/tX653u8mja3e7+ejpd3by/XL3U+bzdme5sb62m7dX1nTSd3lneTj+r7uwsb+/2et/5VXVre2d7s5N2/vin2+n28qXt7vI/bex0Rk/dP3Vh++evPNj/4st/9tXNzc+q3erOerdTrf4q3egur6fT250vVjvf2V3tVdPpf53pXBudvr21/I1fT++2N3b2Zpbuf9jtpstp+qft9q+q1dXNjeXldOOz1er2pTTdTnd/tZFWd9Ludm+6u1rtLK9vrW6vfhNwm9uexwVYcgQkgnmmuxedjjSoGXx4DXJGWIRXjDbmHoxwwGFqQY1YuOmxjo1hRITj2Q+KiqMZjHNvHRcKtWxBqhSeP9sHSu53j1611oVgkDNh8WpgQTvQIi56LHI0yxLM+8RjCnBlVrox7RGJr5jmCSltsShqMWnol1v8qiGTFcfDbUs0PQk2I+N3VhRAbcXjrCNVHAtqghkfACsKnTBymX0qkBDkMKN5M7bqSgQhRu5T3Y4otxO0jqBjNBD3ky1HcgUXCPJ1XA/0Rt1wX5iRc7U6932C0uTY1GRcuJ4dfungwLzmq0N6/xLCwEKJEfjLLamBg4jWww3Vci0KHRFOtyBmhRXltPtynYfFQ/K4kptGvlsGTpJoKX7dzexbkWaTThgkJJR8QkcJQha2JUFTtNCAjoGE9FPgI+G0QmEunopDw+UNhpxuMNzsVw0RursyYaTZkJC9QxuSryQYSR1oBnYLOaroUaPpGLbUX/70VhxgRiiVtmgGDMePgbA42ndERubE2dl8x6Fe4mDsB5dsIqktKmGxK0iAFNK8cX0TINAojd8tl6poWGjFWhzSHcs3MLyRJfy2YcjIwAtK2MOO48PQNcwtBdmh0bCosdmU80VBWsj8JtAhhESYh0sv5gtN5nELe1WswSbXuWatQyZWAsvSvDUiAoyZY8Gq0RQR95pYqhKmWzZsNa0qg/ZKC0JorWPdFTqIePbVG7nBA2cnj9Qy6zgybBLxCN7WLZszyxJOx5bzquYxAHvFWDHN/3lnSCxVTMnSTCa8NUlAS5WGrSsdRqArg7IiVXWItUATkT7KiaHZHDa1PctSNEPzbOuHQAgOTHijUj6DjBCHnNSdTiNxgnAlD/2q5Bh1KbATUMUolCgOYHI/9P0I+Q1EVxPkOr6gOtoyggRLkl02tt16i7n68ZOP7ZVPnh+Y0p47lun6wohQ3XBoVdJt0mKqmayrRClm5EjQlLJ7R2sJLgU9OwmgsUKuX1+VrKQcI4r9jlt37qpIu0JPtWBYp1CFQYd6LT+0HClZ7Q+8xPUJph8BswjLv1SbWnbJLKo+owEWu4u/edOnl1nCOtxx5Lux2+AdiUi+sLlh7FgOx8xo+TylvkVEw3KktEmpihuciKpDJcM8NIb27V4xR/oyl3MZmDpJ02XYaoieRQwD0sZ1KzXMCimes5CosrpEj9GWzrotDJFEIAq6OBD0NKKh2GG+Uw9CTOkF44ZJZZO74mkFiYDa3FQ6knOXNp3F0/JPQb/PPK67hUJ3UpVKlo0jZ9lnkrh1ADB228Iem8QKgW2NOTYmEJK2BHEkCYvDdRvrAns6IVUhokj3IuFVPdtgXB0sVNpqdnh4TAEqq2qRgYmlE7saYKaZmPHWKpOysswMQXqOWXFMuSnFa9oKZBFn2FqFXtbhXoU7qRYFLNa9SL5oRhh7wsPSjyCB3OJQ87YMDm1hKSD4e5DHSRnlzLjee5w13NAhZZ7asWthOMzUrTBS61LF9oJuo+47DStkdEvSXeQECXGXSF3yw7rhqFuGHxJDd+vuhmFzAQFy5Nsk88R7g4srdzLbKGlJCQHQX6Xsqjmixiba+BjTgCIjIG2kjpTeRfHvM12NUJ9EVODVfPCQGxmNhG3bdhrlOANJSphNqBESdwkJKqjHff8p3/IhEEkd/QEcMyGxQfZQ/AgYUsyoocLdPJIDKoui6FnIT7CpqFKXYmZQ1WoEXdt0Q0iYK+86tm2KhCfucotwn1FKxE4rFKHzuPFxfmYOLP6X3NShOt9oJa1QUaVA6elUK93664kXKilDUiBUyeBV7Dd0QCd9VlWR7PiuUCvbNqKJrZou3xAu8/MyyPGl2cB3cWAY7JKkNh2FeqbTgW4Q6rET8p+CTzY3un/y1KNXlz6cqaad6trq7QufbfXaq6vLG731P3ZOvf27tNpLtz9b7VbXVtONavufNtbWq9vtXrr9s/Xuxnq1nXY7H7a319e2q+nt1e76eru6fLtTnVl/uvzOtc6D0c83P1u7vdFer25000/T5++NvppWL1Z/lrZX19fW19fW/mm9U13a2+qk2z/rLafL7U539fZfttd63Wpnudf9cXW5s9a9Xd3rfJamq93ueqeX/rra6W23b693Op/OrG+3/7TbXd34A/hunOmXAZ2Yf5VIZsk0QuSuIxz4h37vDP3g+SEzVAzJTYwl5AVMFa6E0hDawoF+JKUJASwhQKAq8huJwRpWayOpc+YiP9DPKGf7vmUWbXNitYw1A9nDjWg6E88NHPd829hwRRi42HHcTmgkzyFLFSB1oeNjTFRvBhk+cRi2g54qqI/KrkXv40lice4moEtsoKsESep/G2bI5jD0pL8H8r0vDRWVwtTBB/FwSMwiCIv7YzfKGHb28tiDG3N5wgglzQ2BIRVE9oNeC7m45frY3nao7AchdqSeCBQMCXd51VFtJHxIaIfJU3Nx41yp9rTnKYgiaGZHrYZRkmKDipQR2aSqFzq7MJQyRzHHMOWq5Pu2jPhNjiTqBTxsdhhhrkGvjCfVE7nAbiKB7U2HMqLYcqjcVlyQCTKMtH4IFtV9s8fUcgXsSeoKV/gVWDilgwLApaI5+SguPFHiVhQ56yRysMUEE6scWkRongWrMHKwTSARqx4R2CIQqlUcMcvmHgaj+ZJvenHl/bMbEbMs6Y5/2B8NdGYHHiEiZdjiGnM0q8cw8bImhNKaxyRoYYdbVehZQrctG3Y9DO07v/ELfEuxNAKZHcEtm0mMewGLuiV7hYG7ViR9BGpSVFbYRE5bdkzMk4XH5gubCOCi/Jw5pMxo2vwdX0ee0ab1wEAISOQ+MhpWKyCotZEgSUpQwMJlYPl1Cm2BL+bqgUg0yo1lp2J6/tm+gdqGh6lZ80JDvoAs6oXCRcEGIqFuR9Tyd12eRPm7CKNt5NHIRQ4PV0OJwED4trNuJ1xklHPF3BayEAG6IUDbF60IY1/C7UQvs5xrJK0PwPHLxX3HhyWN9aQb9LGFhxT07/eVCNlyZYBODxzJILvhhOKSQbDPXIlKWy2ThzzklHdEyB1qi8SoyglDNp3UBm66ITxpPmQ4vITR15TZIVryfsFs+HBRl3IgFQ3Jth1G4CWmYleETUds2yFHxZyr4p7kQ99B3HE3MVUaLYcZcIvSio9mCzLtZkMjtF2D8F2OPUpD6PPnrTAoq+EvffkjsBAXj73PHGZV78bz2aw1m3/tGoY26O8Dx8y3nziqHqZYELjdZAHWmHXF2wqEZVmesJ3U4o5GPGaRnmh6RLfxQXWJQRPo5mSWLflYyS+COUladYeKs9mjksw7Fo+w4UWRvg4Zgx4JiLXsNXm06EHPSC1bt21NcNFlWBDLs7jxjdhcELN9cye09evC4iyyLZhiAmHEmcZ7qrkCRRQT9gGYL/h5pc6dj/f3j2cWzbn5PvMiBsdH9EotpzxQz0WlghkJuu5jxFzPhbQXihAiCRFapSjgPgI8qQLmRq2IFNRVP5LP1grJ3eun+jNyf3FOq0uprkyNaLOxT6pc+EnAbYhW1XIoqOf6KA0Y9ihL6lIPWyjC0LforuQYwrDcKFzNWNddemzoutnOWqGQHFQOUkwcvWFzEa7lbiRQ0hvY/wCYp91Dqm/7YhPoGSJ9O6sb+yvDi4pJuDz4F0dHxk/eKgQ23DWI7fuJHfhVRh0buky1tykVv3ESyWG7tiO5zSKn7JJCmVyjkQ/++VyhlMlrRk7af/xgPhPIzcTvQmQkLdclXuo0WpQZkit1cOh7WTdQmzvch4lC7UDsCNfBtuuGzWu+Dsed4dk47rBAhHYgNWAXuThQP5YSd7/xG6pis+VbPwV/FSn9lVjhcPXEpISlBXa4ePPNw7Wyqqv5/nfokbG+mHsRW4YeZNgDxJoOIotJtqbpqeWpbx4mpvDWA8cRkhoX4KrlTR7Lx/mK/oDeTVjwpmxVXgVqybK4ZDdXDQtHEGJLrzYjhwgoWXBVslmh6GHiLEc2F1ATRLQl7GEPNrk0I6sn3tRlSa5UDcIxtDgJvgGOtRh0Wzhql62YBR4W+t+DUzP/snZmdHejO7r5+aNT209fal/77N5P9l7uVLtr7U8vvrN24Qsfd9ON1Z3V6kZvt5NWfzaTXqr22jvpxq87vY2tvVO/2Lr04/Xnp3/Smbn4u/Szalo9M735cjrz4b+0dzvd3m77/u2Z33Xb3dW0u/yzne1ed3272+l8ttvuLvXanWubP9vo7lQv9fZPp591quuru51ur/vjjW6nmq532/v/cm96M/3y3tZM+9NuezntrHWWNj578ctr1Z3lnU4nvbh+qZeuV9P1P4CBq5Z5tt6vFfcrSgYNh/24cjGjlFF9lpGRnw+/MIBu3UNE7BrEcwT2aGsTI4NKJsXNVMESRQ1mtDrB/I2+Q0P9VO26yfDrHoI59U+zDrMFNQxpL9KE0wpFoqTCNVzeYJR3g6RpcgMkExd0zEizIZHSy/9/hfo1fhudO+efG5bMeKvpBPgurteDp7QMDnkCw6AbP6SGHig2+ym4nH2rVpCZUDcNM29CCQr/RelY39H+A0XFfGWsv5YvZo+aVgoFY5zrHG7pnoe50GxrVbOFdIc4kahWDlyRiiorsSW2IskedsuVaUlAoXuEtLrCdjwsoAdXhceZhCGXlknEcZO3kkKVxsLjGJf8UUI4x6TlaVsW4dCxddmvFrhhWSTQzu0JLGwmO3bwyWHMbMtjWd5bADbmmGvi78FA/8H4IcxamenauHw5EwwVjFO1wrvZ46p76Pi0JqE7xASX1Q7yOENYktQqZyp04lrsTl/Xh4TtORy+us9U5kzTjqQetkJDe0I+OFENHNcOLB+ilFjUx5HhN3q+YyAjwFBa9xGyVM8Xdi9wiyuJE0Zo+vGYnrMF9dWOI1ThQOSVrxEUOKEwnGS/qxOCAkSMrllymD1s5u1u4Btl6viJ8wewcNx8rPwYzGRGZ+/JGnAX4xOjI/IT84MmGC/+c0nJv2BoRSB2BZGQQppBcAlS8LAwLo33LcnzJnFVO9GeroxTCFyJiC3DkKmhvAaO3/x/soD3/j9ZQCRXkBbiu0rCESMyivY3E4OWaiCResWGGHbDls+W5VCisOFQ6+UGPUw54oh1Wn4rVBAy7R233nRaPjznVKErsAhdn30EhobUgqKY+Wwc1470TRRW1OyZsbERs/+JjK+fKR3Kzqu5BVN0OBMaZjrHVS+JjlTevIrR2uDkuOfddSFoo3loxoeJ7bWFZvFbkwcO3FqzvOaKsJtE2vKiADPesslqy7OI4WHBtiLbahJNNM1lxbKAkvWihc3I1q9ani68dY83sWdrTjy6oriMregerDKC4TnQP+BUpbsO82wn4t0W4ZrORcJ+Cg4cqNVirWzOzvT/nwf7R14bVtEXTvZP/ecL8wfjkZ/omVgdmYDlsIuwG/hlSYS7rYJ+YJ9qrKC1uWPuyrjn+N+eKRZeADSwIUopjk5oYOrsV3YdC9kcqnVjyY0cB0EakLYr2Z4fhBHo+XVfanjUGdw0/X0lEEPsrIaoYdmYR2QZBKHlsjAu3naJyX3oOHbKrdAK+eVCf1ubN6BvORDvUgnDwDeg8QEYv1yIDdA3NPblsj4y8ZpOxsGnxydvTExMXHnM3Ir3EXlWVm17S9BWIBA2laclVOy3Go4Ol4oZhosni0rQzmS+Nh4NB35ztxUD7UZtfrLwqEWkUAoCLFWNUHKNkFFpBzYkw06c0E59JCXclg26p2b2lVqJ6bMLtMH2jV9nrtjkvsAtv5WxXnZDCTm+FdIe9ouk2chnvKoRS6ZhNAntMBqQpqM0Wh8BjV+B5mHXfOIBKpVmz/bpMDO6YPZnTV0F2VOv5SYnVQ49pQcjh9ic8UqaLdUms3J80qzmv2tY+rg2e+P57H8qwLmDbWMZl8/mzGPuwq23BfeiAIpIb/NIWATqgrQlz4Yt0eRex/J0bsPg6ux0IBeuBlozyu4xnYNCHDBvzYMWMzRXNzY5hJwRwXGPabJn8IrMU8EdbEPB+FYQeYJhyNlHgNc1/7gSZcFFdE4enjhgRvRaoe/4iHz4enHlpcGxKT2Qihytq2VJ+MNxA71KCjWSKwwPjH/c11fYFx6bUJV3tJLy5pCEbWkaDci5EpiblB+YvhtxbntG20hCYduuZd93fSNygwShDRc6hlt3lYN7ro50ajUiM43rEs8hibv3JZHYLqvZZtfHwCGe49tbKFuz8o6G/R6uByyHnMhe3rdAh0PJSIIPwPdmpjcvfv3r+zd+PL3V+WR09O86b3/4yjuPXnpprbv8nS9+/QvdC5eeSpff/uLm/dG0tzu9f/vTa/d2em9fvHam/H88HH368539p576u5+nn3aWNtKd3sYXX3owOv30l59+9dM3Zi5Nb/e665dWu2n3O710J+2t/no13VheTzc63Tc2quud6la3U33jJ1s7ve3u6ubSh537P9lJe+vdjR9XqxuXumnv82tfTNO0t73V3Vr/8ermpTR9Ou2l/1q9uXypc3t7t/rhXrW6Wb30nUudfwfv5YOhyVy2dmtTsuUsiMfKT6TZfPZvvtS/COE0LTE1W7kVDz44JuVlGRvQ2nJv3TqB8uqxvj9RByZulEQ+NKeDSF1wNGjHz0++d7Z/MDeS7Zvx7Uh40PLgmsV0z/KYxqtcgxgSAfXVJnEElgW2RnUGI4sI0boglQypqTGBq4GHNQZNtbKkcQcSm1laD4omUe8yYXW1CFR0P+BaCoW9AklElB+Ck/OxO2hGxUNVs9L4j9f3TQ3I+y/HfQfBt1DmYa+4Eqq5of6BkVeAkhkJ40BHy4gO9BcrEwP0zOwR2EhWcsHRGcdXDjtBYp0bfS43MfBMbmpA+fPXJTdyjNCmPeQFvo+BQVZbfoJohKDTCbErJaZs+b1ASoSkYxH0sF2v2TYPwt3ACbEkxfHIllnwYQM7nHZD6EdGYNeDDVnPmBgQn7YlI8RcciH9CLzwQhaWzUil03eD+Gg8QuWFavkHGUC1o0Px8lX5xNWCfqh/YFRTBp+Z+7ZUk7aaeWPQIa0EdvPjuWJoL9h8C5CMEiDfjpbG5HOX0cFJZXBUoUb4S0RtVjWIMd4yJEK3pYRillDXuiTZTd8gsN+t2o7huhkDiW1JbZpclU131zIlBHw1/uVyjJuUJ9ClOxJiidzvoObeYqLGfsiQVG0hjjyX+uJvwfFnn8h7XguaKeSqqvX3vZfvzh/O1LJ98a3CvddUUznxfva9zLW5XPYIOJIr9Y9KV7gX8KbmbJpvXrFYRB3SiwqscINoxOoqRySoxr6pbrqWN8SaEMN1jZVZxB0CtwLoEcluMqnKudCIJjRrOYCCQc+LWC/SLG7e0W1v1cIsoooNpVH1N0YTsxbDVcWDnh8JoXdKK0CaV2nEuoZtEQlz8suPQN8TU0Ove4ZDU9eJ8fcLl7+lPFnCaFyeR3N9m2buYN/BMTBgptpp/chz2WdGpqYzSjlBkm2DtKyD8iGMRFjlyj7PtVS7tfV4H3KPlspgfL8q/Ig6quBtmjQMlbREo2tIKgIOQnQjrLu++3viJD2pRJErfI93Quyo+1is4K1Q2OXYbJRRikRouUlL0PY+gCFtuAmqNiDy0WHTols+tO2W9ZCgbwLvaGXKMGEiUh0BBObonPnkWVIp7psqoX1r4fGRF/qnZDM7enLIfGxQzpwfbLtqnkrJZAyqZgKIrwC/8vywn/iMcENOqVIYKsqvyeWq3RAEu4YNq61ENiW3lQRVQRTMQofYnSDhJg2Z6XZlwtWWrPhWqhSdjHQ9T0THInepOUBNWFUTQRnhobpp4XKMXZEcruZti6qxQO5O0xU298u1+N8BV/b1LRQCwHsmvvqbxBybHfy3EwotwScmstJ0/n2Q18bmjkpvj+diaawvc6BwBskaB64Zz6bQW8RQrljuZhZyy8BEMaqWSgtZcyKrXLC0pg0xJ3xd8xxBPAuTnmQ1NT0ikbQmPDj8ZmQwnFrMYleGMXHWvMi/05QNL04DZsr57MJhdeYfscE1xppXnxegLCSorfh7GDoRw4ywLaiBO0ai340+AMA094VD8Ylc1eWqQEM1tfZxQ1ODQmFcffZeve880LLPHKAXAXj3refA1EQ8c3kyTFru3OV9r1xWDCkkj6+QS7EwIuoYsrGmz09kjn93Ygw8X9QRRMIX0jqpIydJWpLfNXRUR76NglVsI3PY5lGy7EuhbjJUl5ZQ8ngWmwGs/y5/LDbjlYHJd/fsuh/YXuiUL2UWj2tugKG5P6MEfoO4Vm60wYf/kfruMPoDGJJVTF83zGLVM51GS8ujzJMBgqE/zDKZv2BTgwdz579Gjn4hnhqYGg8LU/s2K0UfgoNx3Le3gqSiOezls0/16wjjoPxs8ZOJ8/QIOdr/Ar1oGY4v+47NU+5KDnebROwwx8AeahG844c2RVfN0Ok03cC3HepaG9LjLjEPRYHbM8djVNBP/kB65IfQCVRQzredYRN5VMHO53lFBOE5jNxe8HGRCNNx42+CexeeSvfS7qn0Z53O8vrahbXRtTfay3/a7WylS+l655UzFx+9dOba858vbV58u9u+udf5/JXNCzNn9va//fTtpemPZ6rVbq/6r53N6ae2Rzc3L6YPXnn0ytKpzrWbn1c7vdtpe311+7P2Vne52q1ubf/TejtdXe+k3dW/THud9d7N7dFLb3S7vW6700uX/nL14vre2ujby+0ft3/34MH2+oPN6hurF9tra+n6qb2fb9zc63XXVmeqn6Yzq6vdUzPbvZ/d7C5dWErbW9V/AH25Cff1GPhqz4j8kpmZOzIxSoep+bjnXtH/TZmrz2dyJ7+77ylwPhM/fihIlKWMah7ILx5U0JmBuRsAYc7dHrc0QVcIRK8oR5RB2cxk51edgNicYQSqNEKWSoLA7obQxcin2O3gCFj4dPnK4+vmleGE+jjh1UZsixo3JLJLvcbVsqOZKI37UYmORwfqF4jUwIGOomCdgHxRAz6ka7Ha+L0DST34IXj3ZGY+U2yG0rLcH2QmM9FXxjaNWvZZM7G18ldVvfZMRo6VxWenLsc6jaFycskcDzRpsPDC5IMJPWu6Nib8EjPdEGs3UHBhUMk+M3CeDqMdiCTXdgzVTl1fCvKoUlQ6MuKu5U8MS12RYNONlHF/yTktxVbCbNiVcDw+Sa983NoOThuxVUS/ye7EyoJKw8AON82hLGkhxbZv5hMwMjUMYt6VXDeRXMnnPwTaQiFWHc60aiAd8+smu/FEj8dv9cFIJHDPKLzfP5EDY7l3jjGkFKRMti92sofHzhUsU+meMB2MmWE3t/SmR6BSAGaaeyKv5M190d21u8SKJI14YrWpLRDGgBMvC0GGW/JCYfa2tsKF4AGIU1aZ162rJBId7FBddrhOVk0ox1lmzibdqERhBAOvMjqoNm3LIp6XNm0RAxBJeMYg2kqraWveB+BLICOOqq7u3nfelFmmeLlPWfO1k6WyXixn9gbf6j9As/3933/UBzJj8wqamLqXSOePDBVI5HdRErLQcyBqU5/i0AVK/6tyJZOt65m8uVVU/SiEocV7CVKFNq5V6t8wJAzMLIXlGdvkFUIC6eCXUY1o456XSKkb9dce50YDL13vB3dqB8YZ3Rm/41aOIs7w737ZMIRrocSfduvGOFox6cpyotsYwDBCH4HFh8WMFrdsaZNRcDl7eWiqMooe5icmzIXr9PNKPCbT84NH+9Yy/ZkJLb7Vt697TtYgGF8x8KUACVdycSD1IOIEm+pj2adMs2YW5MK+8r2C6YdNRyHNjus347xuKqVp4ALFNM2rxtKhYV0Dyv/EE21zTgbqsOFbaQu1SCXRZXdLxyfMcErLnLjgJ8EhiTK//4IhO6jpUiRtCSTHRe9uP/hEbSjYIy4WPwUjQ1n/TfWu1Owa8GppvBIXMo/UWBuT1MXDwbXCrTIYyUpR7uuTuYGxvu8uPhHffE0Bx/JHFSfZtLETcWjZXs8i1opkgxtoVFZMKfv+YJSfrimcWZxEPLUIsw+pi7X/vGfGAk68v8DczYWcalXUIpD210PraBZjJq0z0uJCEXK8ly3Nxu7sCdM9hbPnTigrUkGZBsPCc2xLdlOmGZVsFGjeUmTbpMWaHv8AvAVep+OeF6irDifDblyQjZ4yTzV51py4nO7LzSvjqmKWP0UD3x97Fpdfm3sp8OtwSpuLtY3foMCnQoJk15VoxHV53tzJmFNn58KQXX7w/UFXhLoqpA1iJ3MHa+MHat9762TpjpY7vlLuKvN00gTFxdpSPmjcmcgYIugRGDBkS2xqtJalmGS0O6+//O0j72aTBFH5JU1qJOgfE7nYCRNTMm3Okoux5EPq47L/EagppVCLeSPocROU2JRxGu7ykikPyGDceNXM9Ctj5sTUbHdR7p86+Jw5Ic8wMjdkDsf1/IsFWTIDKiVKihEPIVKBupV9ru/gwJCkx2uvvUBk7ktU7nDkPawBM1M/kwN0/kuHguvGlzOKqfeD/GND0yWaHy68i4al510kE6628OJT2cLivvLltx6XRmtyRWZ183T9nwVybJMyOd41MxYxbd0VnyyQwLaoo4qfAgQLJpSBfGVUZ0ohq3De2mKlc2OV90+o5szEE+bkDVVVs9MLg339oG8s+/4ZtXYFx1kmKqPvH+AMc+n/lRpWlp2FbBbkpFidGesHpmGRFdj2VsSdeC5Xmds89MTAgRGFC7eaM4uLZWUfWLxYuiOy5cNzfeoDVig67HQRV7byplrLlRcOFzYn36s4nm5kC6dM1xmuaELw9E702mEOFMVa/qUuPItBG/4PcDG9mC4vj769/4+X2r2ta6OdrbVP09sX97rdlx8tffqVR8/O3P+XmZ9c/HRmb3Tnq9OjT760tXSt2t55fusv7m3t/W7/drr6neqlD7vpZqe7cWm5mrbbS9cebT5dvfeztSefTLeubW9d+nB3b2Zrbf+zZ87c7oyeeenJ/9rr7H7+0vRXXvl86cl3vvqvv+jd3HuUzoye+fH+tZdndpc7N5/616++8tKjMzPLa3tvPPnqaGdzabd7/4/d6try9lL1fvrrp360sbH81EZneunSUq/6nbR7v/tDUMQBHip5iK0ZiVE+LHsIrBmZcwTFWYVO0yO0HhBKi1/WQPY0mco+k/k3q4x089B1pXSRmiBjIGFIm01XqLLpJlYqybW5Q+fPwfJMRS7E4HGUCdYqiaweUiojX3t24Px4fxbmsTE9qByYICO1mvnlE9gNwXjuYO3R2R+oZp5Kfrx0S7/R95pmzsO9kBauB+PBvswnh8cNWzIUw005lmzutjT1Pgg5EoRi6W9BEYghWPGBtxvHhTuBerR0/UdX4hi68bm4dEoazw9ZeMUcS6M3o75yPz1Q2URAreWzff+ZTaW5iRIkhkfajta0JWFZxhrL3sgPA21WfYcqwDxmZk2U4og15ye1hcMPBm8tZEey6sJbM4O5s0/EcxP5whnzLlOUhVqWjvbnxrL5E3EhvFm/deJIrvBE37m0hPNX5WyxL/6RL0Mv+48mtJYFlgTQDLk0HVgQehbhwR+A7Q2ePFl4XaDVer6EiVbD4dcRqHMaFUZWLg5mCxDw4cPKSyMjr5/sP6JkyJnvD0xhp4AUbXN8dthVSeiry4HleoYUJkaXlujf/F+zU9oPzmRccifOPDMwtOFiZJn/Iavkd5fpvgHlSN+Rg2syoBNT/cicevVr+RByaWq2fO/8ee1kWHJV853Mw32lqYp5IJ8+fPP1vtP/gTKg5/oYN1SEpLYy1LjxehIaD0cdYVsOMyLnh8CJ+0B5uJSrfLLQx5E1/lZs3DfUw5nJzMJU/9L4vOQODxnD9tKIUjheGMq8QKdNdMi8Ip9UXjtTj/MZlmBi9LjLEhwEGH6hDHL6u7MDI5lNkHGSoDjWB26roV0ufhw0km7FNp/tkzMF9tXMZGZqajKvjFe/tM8Is4UbGX1U7sujogER/Xo+Q2W1qA7Fo4vDJ2h9XMKFT9jHi/ICKg6bVeDZCESc+L+wfKnhBY5t/xCAwlvAPCFBtVrMe9CKzVJ+lHPdUaKFUmFmPJY9Sz0cK6OTYOS3cV76z1trxWF2lSkn3sssFRTXtKAk4KruEdJiwi6/atZyB3KHBg4MXisC4AcKOOBfsnzDHJKM06LnKIvfHZ9UcHwRKPTA5G+zYPz5kXlF9rMHTFrNKq7WvAow2Mq+H5WKV+/g7IuVmEn+/CK4Ou1A544a60cKqQx1oWEorqwbtq1ziG34B5CPM3Ny/7DSmFYrHkKcKu9exHWn5AsA6fTxkwoIsuacsfeDWiH33OFSNl7lh/T4azEB+zZ1ErHX674Zrrq+XaZSCMPqvDIyop0fPAseTP32NCZx4ei7f97fNzKuK1P9+t6+yaM1VCixQ8//4HBm8JkDUwf736mVRzBvxKXjo+dHWg6xzFlynwwpR/0K0oIZFPuTGlbtuF2WZHN4/IUCnYYFrhtREIxfCHkjkvwGAT8FeumWnFduxYtd3da+LXJIOdFzVUypKsJgS52Sp2qKdjK6pw1PyhMldcjpmYNfi4tzZ2tjf4bG1ccbI+bDyiWLKmozEUiaHjKfkKemckem3slMxXEsh0p+aR8aB9oPivFKG5QLfeMZdz47Kvflflua6jvytWUf0fHDr8euun/kEEAiUXAxtY5qs9mQDsdPnpgTaixfHTqxZtRQ2RxEmYVLUp27rlpxa5/ihCJo0LL9U5ATZcaZCazlhdLCbHRrQVGqBEpEYzrB3cmFbP9E7QAwTsUHJuYKJ5kCehxU8rUCNEtr8bGC5BwuZeHtQMM2tz076MxKZrZ/4K8Wi++MjOUmR/oLubHRY8A8MJmtKWrVYAuT2kIld2O0b/DALaU/c8TcCCwgYtmKpNEFHdhN8svIWmUK6NtnHiv0pdnvlsx8PhNPnjp3hYHM+1mZ7kUQXmnKsVq4yC2wwohNjI9A/vdoBSvFycy0EVNOJJQ4qW9JAcYGpL2AaodRfni20K3V9uVLvLgQtovjA3o5/9js4PPgvamzR0XM4mXHaQgfUi+s1rWJcfmAsvjEx0OLA8PPTJzPTe0h2FeaUp6ZkKcz0mMHyL75HN3TD9AsVZSBqWm34RIiTEE+ll/3FWxrV0gvTCgYGSOmPKoM1fIT80VVOVNTa7+9vO+ekvmFhyjTFZQbWEYLGFCml8MPwP570/ery6vV9MP1T3trLy+lm6M/7nW+kfa2293tX49+Yf/Sqf1/9/VLb1S71848Ofonm+nna59/dWbtyaerm1udMxcfPD2zttn9dae6urW+k3aWu90vd2b+bubRo1c/vTb96N5LD+7981r6VHttp7O09oVrW9VPTl3Y7G6ubf5xdGb04uhLoy9e+9lPRm/ubv+iU515Y33zk97mhXR/94udtfXp0bWvzuy/Xb03+qD7Z3tP7f38Qvfmkxc++bg6+une7Xav2usudT7c3b9R7V3c7m7/AwBRfCKOgaWt8vfzB5BtRaINhcMjjUG8SuOFk/GV3FDmbTuZjydB7MQvPgEGjwxOLpTPvt03MDGeG/N4c0u3LSygLZxqqTxyYGxuMNf3SBv4m/zQJItnrzHCmV1gktRWroBjRbYwm3ugHNFOmIMjR+PqAvGijDUvggc2F6V5MDR3uMeEyO6rsUH0dbU01l85sKgutGP9ToFe8U/QvRUheJNFWemCYmm/cVR5xfgfYO50TVMKdSszWs+cLFE9waBqJ6HTSKSIzOQjHVO3SJILk9C9/sy3tMzBF6dGDvYpgy9cRadAoay+cMQFbtuAGAdcB+7b4/9dyZGCcqTvxcGxg7Vvj/XVij8aJgEMbSChLVca14cbelbeOzo7UbgMdNO8UJRUgcyEh11iBeoLGJlX9xtA47W8mRs5Ix8YGakdyewz1/TJ1+9clw4ptBcKwrzhTJzcdv0Ic0Fs+u/g+xQUF7Gpx9PZSQkxKtnSruFViqprG/XdfH3fw2DcGLf2902Zj0Vm3wuZB8U4eO61kfx46aJ8dN7OKgY1LtmmQ0V/8RDfrcPKM8dhVh7s5sCcfveFAZC/JBBvuD5M3GXZZ4cCk79QfnroKwNT8nOz5fq0NS6puE4xq7roCvGHLcx3TA2VikPRDyozY+cHpqbOH3gm86KZCfV8vWjf3RWGVQwyVtHYaZkoXEDSsPURmIjzQHYWF9hFVdG4TjDWlz0ImOqYnr4JwkIi4YWj5ktz8dAB8L/dY4VXsjX1yEh2cr6+X1ECxVTyd7xuQJpC8g6LfDUovZVVK7mx7MwNkC/WFp84ElcFZ00rYlq0bkVAdy1xqPZKrTA4VjtyaGE2rVwlhQjPe15bPwk8gg2orZvZWpQvlFi8Od6n9ffnDpn5a1Sq6CqIC0bXjlgFQynWepatFGLPEfoPwT4wlVUK/ZXJTdUKBbfshPaw6RS/UnD4oXs0gDZ1yqWTFwmQBwcFXUHfGzyinZezZd39r/qxrIlBPo+WHUHrPB7X/Bldy5zVchmt76WB48PKtxcPKnr68dXAp6LFkg4SuBD6j+vyRfM/ninXFH0ILAcWuRPkQ5JsmXbLoQllZM0vzslT5mOAnDqefSurzJvx7Kvx0Ozl42PPyDSVUQvowpXCbmjVSr6/UjC+CRb1PESgQPZtKnGYyK7he93WcHE+p18Zop/3j+cztpsZOfGyRysTxVjE+c3s+TE5M5GxrRdH5mJZfVjBi/stM26EOENKa/nL+aJUOibTe3eJ/l+KA3PPFG6XbRy2VDuhPUxj0qRcyz+9b3ZMk58zhxcfWeRu5srHi5roGOXEVDAP4wswPI5KsGiaX0D27AiV3Tm0/1as1SoKovZ2JmkiV9UzRocbsWlEUiz/LdBCM6/oQjLfnlCiE77FBL90+MBg1swtsuyL55QSC3hs8hlVVsFYyY9ro2N9749pfTk1s2GaFZmrcUEa9VW1ZPYpdyrTcqXiSd8t5g+8+le1Q4vF4eHBvl7BE8LmOmlWuacxS+PAWC8MjOQq7+X1oaUAc+A1Y6W12hTQJlhxYMey2cDE0aB04l8UqB4Flfh99UF8GFwR8wvY7ColDzsea8ZrV3ghjmEMwA8BAIGLtbA48TszI5sZ0MDGxfkjUwf7/jsKzNv9Cq0DxwW17nzf0FifcnBs6nsTmam+8b6RUr4zUnErxweOZ/Qzcf6yMpSbM0k3htfHlWx/Zv5/0fyiQjJyDq59e9g3MJYi975kJdCRjBLqKuD7IxowxuULKNC9QBQSp43KXKB6kZPUoBQWM7KifX4SJEzDh+KjFx0pjpD7A0h/EZ9uNbDgwcebeckcLrpmjH4KphIpk5BYri0tyFN9X8KxXftUflgAGkqQk5o078rEiCe/PKi89dcnazlFfvGcfvKhoctz9KXSD84pxSN9I8UvZOfpc5ln6JC1RBsLw/nfHvu2vJZRDpEa+Jp8a/8i4r5r26a72fIztp34pXMvD70QzA8qs/syS5VGseHKFajvGCE2Obao0y3FfpkTasajZsF87ISWv06fihdNORvKJDhTxHdJoIiGn+pD6KqRy6ATfwu+nm6uf+PMXvWdn5+6OH1mb7p7bS+9efPU86NLM2u9X60ur95Ol9Pqanrv3pnpdHp05vk3bi5Nn9oYPXPx1Tceff3pF7eeP/XiWvrxxplXRkf/5esX05vVazMb//bkn0//7NGrL2+OXnx74+Yff3Shu1xNO6vtv6wunepW252ZMx+uLa2eGX309IXup2l1rz19YfTT3u3V3lJnrdrupp/OnOp1R0dv3t5ZOjV6Zu9Ud6a69um1mUujN5fuLT39xtvV6tbMtc6F9MPOmeenO+32xsf/DnIjeUAK9Yy2eSijw0BSlIMvx1l5oHCZZu37TnlFb0WGaGxp3+pTh5mZVZbMyXmI8peV45vo2Hi2NH/ygPI9YxIdfmsSHtG6ydV3j1zOHRw8P53Jv/c33z97lWlnhn6fLdLXDUiqraIMQ2Fc1Z5/+CZanM+ZKrkgLw6xsPxtpbHhC8MJvRvg8c2i0iASc6Fzswgm8nS4rCozxRKqeJWjca3rWSqjynGg7jfU4Rixx0DuA3AU1JSMWR7PVPPzKIbFs2bhYua3A0o81z80cQkMu9RKghBu5ufyJ08OsQn67Ng8pVaMAP0zcjRzuTxeOv21e30yugxqi335ron6ny0oGWViujKw+F4OZEhxtEayw5kQ2MXbvHwd83LwcPKri0n2eEEpfTv7OZXn5i23geWuYvzfLNz7dxP3gfj9z9xnNJoZzUf3mdEgTUYjaXRhdLd1sy3ZkWXJdsE21HZM8BJQbGQfzHUxEIcaWAcCAQeTbRNourS4DWVbuunT5Fk2ZXtKN2ez27N0v71ku7c/5fnh+f4X7x9e5434bcRAhI7BlIoP4D7Mv9cTqONZEtBUy57wpRyX1YY6qfaFoGPlHQ4/y2YdEAng3vqPQVPmJYPewwRLoD6meLCgSC2imVRH0s2o+AKVNY3igkE42s6s6FKeE8GSiERDdkEQxSd5kRIFVtQmNqVodSzP6mY8zepmlJ6S4/HbXBQ8LWa06ko37INeDVC0thZlJuqXbYzGfkODeQ3Scj36jM88NJhxLIjsRzjUaXf5bQNp7bwydW7AGaKuEUc0RVQu0/VSNEo/jQLIhnrAfllUHkadcAT4xlCNGXf5fgFqWlxscgbNvtenaS6Hh4/g6dSDebGsFyRrzewI9Kt5+O6Z2U6RMtcl2rKeaH5Cg+zED/iD2SqtHmEF3apIEjZl4TUznjb0QsIqqrWh76cy68VCav6BdogKEZQrizPEIZydELibRMRR6rdT/PpqmH/7U441E7Aft/uPs8igz0O47ZGeloVKvz+EwS6ORPAQJ7NWhWcS0iuqMMUf/phzaPhYUEmegA78PzjRq1H/AJJQQyigSYPX0WSTHrJUrr7LG0YSwzJlvvdO8vI2A28U9H1xzBLkKoWxL2VO+XXoFS15rgSzczkVUz90vKdZYUvDsph1wqeLGjv0Ds2fkOkUJpF6FZyYrkkLGA2mc2kohJuOI95AtKdmoYCeZ03XC/VS2EKJfCDa9XjsAQdrd7hPuUlVo+O5hftrxniI0EKIxs/Ys45Lc/iNo+j7qOZkvQJDyrMDEY0fILxJ7TugwcI6nHCcQ07xIphTnSwmV0Qj5P+5aJrGH9GkmwgWTSN+GwIfwURFtlZR6HpY0YamQmkZarIsU2ioJ0+N1ZrVOoN+I9SWgKygQCyJuvGUjyr5vlvR4rIl6TkAS1NVDe6ZmhqT08RYVhrzMoxtpK9oaKKNQ+Sey+7k7AyCkAfEoTYMNeWh+MUJ9rKkIY452/461BCtXnyq/IRwChwUHUxoRhxgMUDaxrXfgEudRyI8sqLSJ4wGtB41CI2cPNN5JOo6t6xU5DCBJUxOx2K0otgc2ivJQO9oxjC5HL2+MnMJq4VIbLzxynFhmRjKho8kHWt7xnReL+bi7cp8CoBHKcygN8sPJKba4Y/CEytzZ57eDyEJ6ioHWFWAqkjE+v3aOcrmdTlirj6bz0cMBh37NQ3/Nw0OMZ60QAQaEzTuSab3GNR5t786lLhOhgcF6l1/HrmOOwMuEAwg2R8B6SsZwjP5hGPD09fog5ob8f8qVKBoEzPPBGM2ATP4SwpY2RCT7v7ovZXz4WE5SxaybzeGwqWVhEg0EtAnX/RbKqEF0JC1w297OrkzPNZXMXJZUhviOqElPCmoPJxYyL1O7bFouM0n2fT9Wki9nEU87F4g8JotzGoD190+u9/twyjHojMS0BAcDflfOJLqK9lwXRN/JWt81n9GFuRTfh/qYenfh40X9QhF2KCfdf8YiFNTbeN8Tqz3NIymKWL8HLsjFZd1cQoPgQ1NjuuSWAcgjSqUK6qzEPbCbqUuQwCp7lgn+w4M+jn7fq8NE1hN0/RKvKb9PB9ezuu7OQWi3nC0s7yDInbEZdOI0GI2gYbctBfiu0UxWz+nKXPRUlPWPkJlEam36JDfyXkRF3ndwdjdPq8XbdyqfsSfq9r9QbbLJoKEVhNCzIid8dsHgg4CHIh6mHG/nSPZH4P0vxw6XGpd/Pelv/7d9bXNrQN7N2e+3tl9e2tn5GSv9dnSZqWb/sv0X53+w8FurJIeeX/x/S/3lq4unt1/cOPQRumtO7MHRw7vP/X11eOjO7tXD7Zaz5b+PLtUuZjenXlx9VDp0+0TwxsvNtIzreOx0dPDp7/dOt7aP9k6eXbxxZ307OypyszFyRezk61/mbl99M6hf+x2T8/0RmLDp75OHzwx2Uuf6vWOVzbP/uVGaXFm99trG9f3X+/G1vZ+2Xr/9OLkzszh3pcHLmyfOnX47Mjp74BUIgrxcToLS84FfnqIdijqm334OQTn/FiuEo03PvzlFVQIzuLAeYQfF1fYtJO46fX1oVQoBkm/bPcQvsZ1hAtakFjx0MM3cAcHCxkMS08k+KEoh6Xgjj4xEHGTqJtpeXx2h4v0sOgLbVqEN6D6SiDmxMKQxwqFWpoP5Rc85gDbN8z29bm8focv9KIQokkxotGXR965HHTA+PTHnp6DHYCBCTcZ6SG4zCMk5Rv4E7Dm6IEI5uCw0ytRFmghNwYOYOdWQhhdNDPPIIageZt3DHRDAtSHCJ9H3PG3E0g/G7KLS64QSjohY3fHaPCuojnddnuPASrQJVkWb3M/1wKGLgrhHXkMJTkv42LeU70ur12w29FNqZqtZWE8YCsF7T49BYoGtRv1ZzNFVqTPdzXaGfRzLtJxu41o0dCv2anQJMqQhEpriXMzTq8taDPdNDHihmHWzRF22+fgv6qhKA9kP7XoR1hStPXb+Bky4pAXilSG3nQkQsqKClLNF9MGBx1eFHFcp+5zQT9Chvuv4U6U8UZ5NPK+w36ECI/zLveBQGhFn19NmZ0lin97CoMT5MIWxKlxGPKg5MgemrJ73CYg02U6pXz4AyvaV0oySX1eAg/4fdhXqWkT8MvCsNpPkDhDEMmXb9+70k/dGwzemxToIKnpHO0fIQi/HxEoIIw4aOLfUCESRj8HRzU90QfQpu+qs9+Rhf2DEWfLTb9RwMr8kNzN0zhQ7lFkdilLHQkwFOZxzMo4ZBE/ittjPpyB/Zfy/Y5Tg0SDEl2Miziukoy2pyNdKgxn3uYFP0dy/IgHQ/ol7yB09BiOwZOERsDXIJQXeErFsDdp1irrZcs0SgVa/ESlqfnMtoB7cISyaRMvU76Bfr+LPkMNK/3hiJlLIUzL7UI8qOWl+lr2cRhB3UzE9R3wyEZNFeuURF9jxxiFGreNoyNBuFzMw+w55pSqhIZkGtXkGQER7E6b2+uNaTqK2e2M3baIcH4mJN9nyVEmPCU6aOc55tS7wAf1TsKEPUpPaEyVzbTTUdTN/Bzx27hJJmm30ZofQSvo/wLGxuCd8CGAmVIqa7HLsWKjkbSSZLOz6XCSioNwhsQdkXQMeJ11wHx614vQfaIe9Y0MBBk74kXddE/DMA4lXJzzczANhSIejWc6SxjfkQqaYODdieq8idf2RD+smKnCkKVqVTLm8jr8ZNDtdL0PwuArnnbgnuNEhMz2Aa7BxigeCII/K/x0koRJEwOmeGkpBan4L8HbRS591JTwwrt90ch+6KfIAGrBX65dIqAtG+aKeJdyAolICA8Ka+2nx777VJ/PGH9O9CdpSGFFfQZBHDbKjovUMFmPwBULs7I9EgnUeReF4BUFv+eyCf2E+xfAobBHCzXzba4EU2aB4qRP3tjL4jCsEKyQGM6X9yB1yRvSLvopl8NPCUl11JmNI4BzB1ynGOq8qtbkvsgoza1gIkEJ7+yTufBqmeNz6os8JnMGDOepJYyTaWvCkXdcd75KEajGv6q9pSed4zASxfa8OadRuJPnQbREltvHfopRdGqXDfv6wMIcwo46CMgO+hjeXaoafi5/RG7QpyiK8aHEQMC/4bwMPC6/jbJ/DhhGZukqXrVNBrV2JgcaFtxRoNtJmLL224t5NkoHvQTM9oiQjHBQaoZO2JjEVNhNBt2jTgbc1EwFMmnbWBWFAqiF9+pAAmazCNhSlGahQtO1TFpXHsJQXdXDleB5J0fPhRgmLY+xmBtVDfmtPW2aZkNzhrj2hlp7Qy5eAWCDsQG7nNdRueQkfNBJIl5nt5F0HgFoFdh73LjNZfcKTi5Gi94gEnQx6OfAwkhPhFaKoOexU19hWsRLvaRRLcxPpYLmIbZOeG11DDzaEjSH50NhRU1WgiAxRmqa3daiEH9/oojlhBJ5N0IY4Rp49YX+37rYaZRT9JICNcUT1qr8vnWzkOmMWblP7mCeJHGZCuCBDRD3o0N6ajl1x1T0BwVcG5pfazfJhGAm8Nq2LAmEZ7lQWylRwBNi7X6GSOMf+e69quH0qz2cAAJF8HbXfsoHI5SPcNk+By93v9ftvnX17NKX6bOtyoXNb7Y2/rB0aKb04rVTJ2J/0eod6JVOnHwZ/nJ3uLfx7ycOjD5/ERvtvv6N05OLvX/c39p//PDB8O9Ofl15eeHEhbX3S63ja6X0vtnS7dLm32+8P3mi2/3m8PbXa3feeq31pHVi7bOTrcXegZOHW60vZ2f3n36/crG0tdZaWivtvvXiZfrZ+9ux4edbt++kvzy1u/GitPf64v6/S89cX9x/unSy9WKjFbva2nvy7OSX34u1TpfOfu/syb9Y3IidHjl9utf6E5CA3YaIURvSs7sFfW6qWMMrjCaz56IrSWZ00MZ4ZVZRgj1ohRnGrbKeEyijMbTmJdGYwDmAsMCO2X/IixoqahBa2+xTs51sNB83nuWgpqnAS+tr+bJD7Oh9gnLKE7VFIeEiHRVWoBWQ4dROhZcMKydOycu3RFEqtjsUTYyIjDTnRgbOOVqoxgYH7ALBbHhIAvixoM3Z4+x2F0J6EaLn/8jpRb2uceE7wPYRxWABqh8Z9oeV5KCYRPpmVnWdH9JE6BjFI8/jRM10vdJFDMUSMJ9MXkfDWh9qpwjyhNfuYScMuon9C0xo7/40zBnm7OUpTC6vUnH6z3xqYYjSNE3e6ggqixlCjYqF0XGNk8cR/hpt47SP9fkm+SwnlsGjxLT+aHZ1Cmm0i5yHPO5m9HdhNpCQRxwkHyQiuI8qOQSWxD2AxCf7SeDAI8BOxYCTDbr9jvDgj0Edc5GQk3nsUD3rIWxhMsDsZjCd7ptAA/6eM+LxoISvT+5ScMLEBZDt2+vRKC/NaYJ9kel3x5cvQUwcBkQoYdTCGD/KfnKXLmPFVHlGovEaP30Zm3jtBoDTGYwfh7FzWdbnTASId/Z5KJpf0ePVRle8lCmLwOzEt1KYQQqrFEbH7Mk4ZJBQYeqEK8mQPsLpd6QH/IzKuOJJ+0k7heAU6fQxi04XGsBIX2DwH4A+dJMQNZShe3kb4w3rCSF4SM5LlmyFq/BTD+NlUEAg6LWi7KCjUQYZ64XtoYTmAtDR9dqcVVaszkUPa2Kdvhyui+KOpUh6BmSg/EwSQxluitWM4QkplbWk5XeqJQ+ECAXHp1YmyfEVgD4U2+pzLtoWlyXxje8uGRIn6mKcHjjOuOikPy6ZKU0Y8xMuzslhMTfJIW4IzzlHSGbQbguiNvuo/fcEiQSDpPf/AR1R4CGBqsgI5oSIx8ljjsMerZbjOlZCe2L9Fide9Z2Hjpj+cE9eE5NsNp1Ew5xHzxGXu5LXzYKozxGYuSxpNJlIYIXbKTYhgQcpWHgiUBPGPEpxWIwUuBwxFtbejvE54wc8Q48lh33kLxVyjG7omxSP1ziJTjbWjjVTZjnEjUtnKacnQoY4kduapimGCrqFezODjO+I4WP7AoskYUMpwmZzHMdpjfDZPLj/xyCJxfc0+tGAe9HuRj123IHbz/rO5xMLq2ICiynTfNPP+hPebUw3IHoP9sFYiOZJIF2mlR7QnOF+2klpw/qlMPdGjheiS3u0LFD14vyNkjhE0cWFFYJZozpmigL3j2YP5iE5RCnqK45rDnIgwVuZp+UlkbsvmNxPG9YwaUp0PIVI2q8I9yArnIkPTb1OwaCbidhw31UMpz5EfB6SOez3DPCBJJT7WknS7XL126nBvwVZF/SzhNPm6iEDnBZ1Or3IfgLjkTlagsqOKNbCDZ9NUS9cgaJTDDK/pT9NKJJlG6sDz4GQprnZUIiFFaqudzKiTIf2OllLmrL6Hje6xTyQJGMqalWicUoy2yqt7fDn0BAel9rotbExmdZqfFSvLOtFsBxtPlZv6fmcXoTwCNdiGQb62PM27ZZiRL0EabfZRr1kENAkc44ZIb0OLxsNuocmBYGw+71eu+3/Bb/mfI0QCRDifYBeZnPQRVKLASyMescxjr4TTxX0nEq4AhuWwBpA4e3wr0gKrmqoAI0DFMTyLoHPpXb6tFqxUDaMXJo2LLFAx5fpzYJE04/Meb2wOd/JQn1IUJA3Ce8RUuDLT+fT9H+s4HQIV4Qe1zGSicaxNrllDBXYZE1GHZMBm0/hgUspdLWphpNAPHZiBPWxYNDWd8/XorwetonI/b5RFGVdftQRxP8PqMOB/iBiC3gWEZ/HuunyB2wnXdQAybiEhUQpWuAnaFf419qkQQKam/Cy6KiXD3/s9KB0aNtmOXAPpsXVkoMKT0AhRWdePyqEcxYWReJH2/G50NwCB1eW4oCaL2B8TasgLk+SXbhB1ks83bZ8JIpTG+e+ytEJ4Zhwc4sSxEsZ4CQHjw86/IKI+13MVVRzeqgACh2LA7gniWGaNHDaExjAWAfqdpy2u/0uIkK50M/BD2NnJ2cOnRhZ/Ox7reMzrQP7Jyc/6/Vix1utXu/wSKu09sMLM29t9Pd+8sMdbSb9/vCBr8/+6r3e9xZnepUXvUMn93dPnBx5r3dicfLwydKTZ+kXS+l9axtru7u93msb3xpuHbp9sfv12rdaBy/uXux9+u30T9ZKP9kofbrzh6WDF3ux4daJtevbM7efrK1tht//eun2bmXtyUar9+3YzKc/nBm5PnP426WN4ZHRkZOLx7/83kjswP6Z1vGTL/Yfj1XW9l9dnPm6983WaOzA/t7kL4BAUH5S8LgTMWCLkIDxBAeP41633TdO0vA9KObaJsTY3BMMU+MCUkjg7/nGCYKFYU3tVlkSNrOv2rid6Sw5tEcGQ32Hhx7wNUOkO8bFmoid8Wu4yaULD+/Bgji9h1pSPGckvzPA3t8g/wNqHiK83FmKm/P0x9NVq/GzcrIscas8JM/iPpJAVJx0HNYCAaeL9Ps81weZADJIZwn3yf5/82ehjWeJ41CNEAGURWyfA1V7h8LKrJndXYFuEg3epNAudLjIgCR+yJ5icgbwwGk6WgkjKganpzj1zXpCnWA+Jmn2JB76yLPSHwoHNgAejSi0CpjZBAXDhXUjxX3AfFz4JIxpupSWA3aBXGA06mCEDyS9bBiTT6jJ6Jm5X4e5Gx/cBTfMYlVtND9otot72FSYRnsBWnslzwYoW9eREDQKiQTce10enyvZT7G2Uz44oGUdLDl4Nog5SBtuZ52fA2eICteLeDS8IwtI0hkat/n22wAqBEmb4OqyQ3TiIzfIx+8MjfFiMaAZ4oW5sTGAR8UEnHnXq3qZd22EsuOLYgRgEQneAXbIAlN9I3pRyrPmCgOM3IwQ9Q+4x1QgVmwM5wQQDs3thOh40YLxjNGNA1EUpa+M1PM3EnFL+60myj0rk8ngN5MIc1youkN1xjngPY54ohqDOUlnj/5fmXETFDewWI8gLj+JkN7/AyJA79MQh4Rvn0kAOsJ6nNSBPo334S58jh4FrMBoMpxKzRZELZUntAw8lMopukD1c3g3e8RGN2lQz39LVYc04B+na/sKCMWBJp/CNufRWijMvCLlKp6gG5GifBy8NY4EIo4rR4vqrWyIjx9r0pa+lE2tj5UXsiF+syxxYoiEYGKX43WQoiKEZzGI2FAXEUDCowE/R+/J9xP+RYILwjACGeJEQ2C9DiaAuz8H/VSd8gdoFd/QOJXTXnUHmBZLYOGbFNxjtAYpBnsHoXh0JnzmI4qHfEdtoVQDhoSVj6PpOYHVHMRgP7X3nOpR8oXsmaEut62sYsLd1cwOxeF7BIGjowdZD0INkqEh84Ubz/sYWSN+/4WiU2XVTEyXl+4Ke0L8Hh6K6UyNz3FW/jlVYqdTRpYEONMdxO39aF+y3z0L7lEE0s94/JP+rMNyB9y8rQWp/3vL+QXAMK93ADsXGrhudw2Q/vGg4hlhbIPnBeioMjGHl4Bioh10tgTMds6iJTG6H2GSCu1VtMZStJ1jlXDI7SyFvFgwJBfZy+mbD5eLEsgA4yLHSgpLy5lUWnO5gzZmkFaGaZ/NHmUEhFprw+V8w5LVxhO+Xq/fB9L41K5RxM2o3ljhKtrYkLIyRkB/jCBQzgn9hHP/zSgBoYI5fb0Q1NhxDrW5ev4Bp8tGEK7BX4Ag6R6HiYA9MOr3kV7UHmprV7VmI0+Ewho36ggSQZ4hBfxwoM9xM6uQ/MR+4MRdqI/1UrP0eaNhDS0Y0zvQExE4R8BF9rxRbtmQcJ68SIUFyEehjp12uAKCi7T56OuaSwhyOVC9n6bI6U7ycaOxujmfWhjC5cIE9u/YAyxRyOuytmjzU/ig1kzKkxEcdRIEK/SPUj5iTKBYGKmE7ChCht02YsQ3jhO4TAb5fwD3+nxKNuz1ORYxSEcGsHC2+mYY8RIoHpLAKcbNUlFOq7F7UZZxxZsyj+/TcDSAUBRlb/VLNP/LjzVenBzw+e8h/VHVc4vSavQNwTlEbRl0ojqxQGH+FupBKU/gfFPem9comK0tH4HpBDQLzWPt6dSWMY8DHRY68d3yapsUaS3JjqLPDZK5DAPe42iEiPzy1063p+cI431aWA66uqzmDqCszeOIAQ/DDvj78cF/APaQXAUhp8016vUi5GUbFNSea67BeBU1BHowEgShOis1Fge8DmedZgXlWxkxgERo+7i357Q57RyqeV0x5jx4GIzSyP1vNYeyUVESdb2biUZrYeVKEU3bxp0u0uWIyju5mkJb9Y9QdVIvZqJWkwTFJV6yJClejHO9vCH+d7gdxc61EOcUK4YYuNIinE7GRjJOrjX0+wH6JjNAIJMkZo8SnEDaJlknY7cTXND2Odg//M1/f330+HDsRWXk1N7hq3svbn3WO9Q9cPb42f2lr4c3ro22YreW9v7jqd7pa93J44dHnpX27tud3TjZi02ebZ3e3x252ut9+3uTi+mfdT8ovf0Xpe7s2gfd1lLl+sHNynZrd6lU+mxy5MDx070DsdbL9O23dn52/PTG1ZdblaWt50tvr3WfXf3+2ROz6ZnK3r94/c9ru+nN3sHJvz88vPfi0p29J763vxc7dfzU/lOt0c+uXf1i4/Th3sjpL091e8e7iyePL35WObx4/HCr1Z38DhjU5nCfgPSLZ10+u6Z6bOTvJ+3JILwyHkySH4ikFkA0OeS/zrqcRoNnAvb3XTiL1Ps8Lizmi9h9VL9CO07acU0JcXyhUeHW72phWp0ovynR2CpFJxLUMOcb7LezgyR6cCKl5kRz5RP+KFWOArJ815JfPrxE4jxtckapwUXnbwjKh4GeC16ecMQDEddZn2vQ72OZiG1S4T2cs9/jI2IMMhZwBAhoG3VSbtwF3c9tnwOEptwRctCG9FBiAHo4G4nEuAjLfTR3mZ34o2jDtPxNBLO95yToIBNECNd+VBirswxKMi2bzYHYOU3TJhnO61LYqKBtSFKIpcd4JXM71Y7n70LGrh2sBlmXC9Kk1m2Mueu6BZ8W1zpgOSPHlai2JObznVxHNHMbD62HAFaXw+J+hmOgQ3mXsaVt4yjiDdpd5KhLZDC7PejyLwbdTi/DuAVkEbWRQZuNcdl/AQgXrnq8bsDFAs6IHbUTXvfIeJLSsjArTXfv8X1CIZ+E4EIiryT6/w11BGIBh2MsjAKmEfMSAZ8vCLVXrjucEdtPcyGkb4Ni9aN5gOfoHx7LdYYwQArUBkZDOuANIB9uuGlsaIF/m83tWrCQanTM+500V1TG+I4hYbvcKp8AY69oQtcnUBz+kCA8pQDi8FF23Ok4Gw6Pn0P9BOEYoYKyw8E5mMCizxGw+xkXgv4tiEQGcQ8x4KB7Lr89gsJBgjnr649ua0fYoft7w0McpxG4D120capGISi0n0YD9gAqzXH0GqTsLMVHPJ5FJ+W+90sN59SNxBB16caQWiiXGvMcQFODK67Ygi7SCUhr6Ckn6w5JZxwf5tMpYKamdRPc+CADQuvRXGZhImZhoayazZ+h0shz0YVm++iBL1jS6UdxBvfFIIVH7BEHaW/ZfF7/4PPBgK87QLkjdoefcn4ObOPOJJlcYZhFIegi7ZyXQU+6vOjv7TaKbu/wkgXsvqDNMfpugFGgwnDOFuIMIs4j51x9k4jTybgJxon95PzAAMIwAzR7WKCljJFfBvHbKfEKtIGxqnsGsMuiOEHlz8/43SHJZG11aySjx+OmrLbfuMrpoWwuAwGThpLZluW4Ju3AkIBFwc8ZZzc67me8LgGxxxhEsLHu8y77fpdNIAcI6OViTs6GDCK2iO8XwIm/6iCSWPjedQ+Du/zBiEudJJsig3A4A0o8v1qDGuVyVAgBu+kjWSYy6hHIsMdBcHgveR5qvo8ASI7COdKLMw5W6F0mpjOrDxK18pNyGavxypDZdzWlJKwa1Hn6r1ivKdGJcRFL60/jplGkzfIm/6+cTRFpqzBJjj3iOg8LLLcZX4YclYLQs4ghKEpFfExk0mGj7B70ucu35ujjHAKCOmEv6CYRv5tC2H8CXo3BcATB+YN1imERNzr++xif1FiWA3vir+dxfVpNNJLwRbihZVGNidAtLDkYGfAH+OgpfCGfZEiXB90+x7H4gNaflK4NUkEB0y0h80RpqqlzuGaJMzhkMZUMr6olB7ZAO3AKSBVzvXqeWhfnb2waKfwV8xJlhEuWHsUooLyNLcW5QpVdDYWwSQ/rJR2S00O3bD5HiH6VVtFRET/voXwY3l/yRuiA0++I2H8BZEQV3fawgB3SGAKzvetUxJkQrRLeMcMAe8WPonQDFapsbCwcPgclDXV3GYWw2bjxoPtA1eTqmM2pVa9VNYaOaiHAXHeOw6lziigWuxDMPVRZjM39MArjkJlT9Kl0GIyhagBl+ViiyBJC3sy3b2XinWKuKJqOC6Z4xaqH8jp7SwzDp1KcHWPWBA51MlGRI2Ig6DrvcDttztjYmMZ5OYQEXVGhnaiTsQm/ANCrMmbSkYXX+9QJljXCRHA7McWFJZsC8F9lHazgsP0aow43sRtBDMP55Kd7snv6cHeyKh/ChBw7HnRHrVOKjxdTy0YxecAVdnsSPxDi9O68WBiiWBwUujSkxl81BXW8J/j6+iSUrNUu6joVzQpYXPsXurOu8x1MzF6kH/TxIUyONt/kIU6X71OMY1YjgduXdLjx/QHt3kcOxOUaPCyR0E31DfoXvo95WafHFomAX4AToxuz3e3DL3qfHVjbF7tQ6o5uvOweXJw5HNs+fvXLjdbi7tI3K+lvvLjwWnh0o1RJn/qL2OSFjeHWydcPvZxcGxl+/4vhydneyZ3FN2f3pZcuvJxMV64v7t1Ib32ZfqtVqgxfe/PQ9cl0d3bpRHdrsrc0G6t8Y7TVu3399s7SW9szG+mf9dKV9Mvbm+md2bV9lTu/++apbww//+vt1w/eWXr9Z7+bvB6LHYi1WqfSV7/dmp088c3egcXeZ73W4tX9e0dasRfvHby1GFucjJ38J/BHvRnSAlkNjrBzU+E9X32lP/yhHaPYIZENzY2i48jRPjutVXtTMBeXqiIYG42CFUVkFCh9n7biDxVdRcI/xDPhZjsLv2pvy21RbLM5HSzxRV0XFdPMXIxnLDEOcqL0x1y+Ew9NyZ3ULVE0M0U9KxoXc3mxDaV2g1/rmFJGVqhM8VtUJtOhOvG24xbohBMAito7S6rBdKi6WOO79c5UWEZVOZxmBejHDa0e/ifwXzRmrhK5VPkEd5eoUY0hg7/qXaf6pt91oHuGA1lN0fpdrkDrUmc+U7ZwHZuh+nFCzk8A6vb66ry5LiBqYbhmYmc4saP/dNeowaP6ak7intC5Y82GuPo0NYMZNbHwIK6ul2iZ7FDS/APs4rqUE7EiVZ5Ppxqr0qNcu1nYBAaWK9SwDOhx5WSjUWuvUrfnDY47U03tUd5SFc6gzc5T+sknQ2dMQ1Is+s9xHunw5eoY/xtAY/xQphqu3ZgMI9NnQvcUzHjd6lNTcgji1PtqNiuwmiOZ7IGQC+I5pSynFYIfYkyFM3cLq3eBTEe/4of1Atbhj95YhSUeMy7ldIqubTbLAnkzxemN11O1aALCDMDS/FOhYMzH542tHKY/Fchk7saSKtSEYrWWNDZzZrvRWKcwvtusNhsN+qcgum96XsJulPVy5uVDAVu16MK6fpScFsukYfB8xexw+BsYJdz9Dvgbw2ywRajDT3VFG6OABaSZqAyNuj+K6t+CEoOKU1I13HWy/WN0VUbpOxYzBZZ1cKfZzUgSyFvLGbGSAiCzDDsZddcoqrqoi/nEBTnx2OCKnc5316RMRmrnIRC7xZvx4rJuFck7sv6v7fYbzbh5O5NsNuSinOA2483vWkW9qL6xm7PkhPq4LVt3kg1L6sTVfHzHynaM5sOQMLchgbiV1BvR6g6lgyAFFEn7EViX5tmclUStN4V89rcOMCTEL6xLqRRQVtRXZrIWgdTkQgevIKyg3ROofquHWa/AHLSk1L7VB/OmXuSl1YtxCRp01vxB4mLqq0LH6DwS6Z1j5fIDPo5JjedJqcAbICUWupRlFOnlAo2tGQ8KZJUmedDlxNVkotymzV0gkuVGo9ykn803jtWPNdv0/No6PV9eB6l/pZ+oU28btfgCUJ+sdvhpwaRD+qfzFj2lcbpm/AbQNStB0fyHvoP5PX0uR7+cdCxx4J0Eb2U6C4sMpQoSdZeWZqgkIELjtJXdASlq3RjKntF3KFhMZVbj9NGtuwj2tlEugMy+XCE6X9DjOSzdplO63jGxvn1N2rh0Y17F+G60nDIMwBfEEl/mGyrdyN3YLK7myjerfe1kTJ3XQWKdajR2+enpZKNBzvNb3Lwq8AXpbX5GD6Xm9UtHBX4nrt/lOD1byC1RQ/GUeAn7SvwNaBQzAFo8Aw6GnQwSYoCoHZ6ozzHnaissG2PsIagy56aob7FisC6xFojvLk/lDZGmg0w6D7kiALye3aWuSAYXNdu1SjzOx6NGxuw8Ux/rcckEUnxXzcTzmceNYuJqoykaGTNh8Rfjkpp4Q/1uMXHbjIuS2Ug+li8UE31xNcO3H9/pSzQTjeTjPH9RNNTHN0XlSmdJzHek5XieFdd0XQoxTy+LxYpUNXQrbxYz3wE5ev5fC0M3rvhivkTiXdEREZItnHMzAmOIQ8MBrX+ct0eKXPqMZTWGABfndhMLoMHx5Lv81a+GaEkwuDBXmZcKiiV19MQW0I/CDgvN+W4h1Xj8iO+I3JN2nS8aEtYkdxq1Rt1s0qvlLewB9hgkj3332DZZFkxa5lZTd8pyYzqZ5Cxhc5ok66RqFo/OzDenM7rEL893+YUhOs4nQ+GL4Ol0Q4Nxcb2bitesmoQV5/8E/gZ7RwhPiAR71U7hIX/WazlH0VcgDzVFU7uEXyUYh2co86bGMTlPIZrjtqhLGBT6/AozTOlSgQXxiSsf6KvqJRTy63yaoo0Ov6CCGx9IqdR6VMjpYonDxFQO6I3aZqLRR/fVEtW7pRs0j2XoxLFy9+YnGSzDxeel3eaxhqk+bX/S2G4/FYzMtFCWKjfom1UeK86bPQnkCmHlVSGzw61C3ghotcKTEAFrRqpQkH4DDm1/8872rfRa7Nu91shIabjbi/3dzs7sD09cO10Z/vvDi7FrrQO9nUN/uLi2b+lid/bW2svNze6hxZHre9c+S9+62Dv0ZKay1ttb0rp7uz/s3n6W3n4eu9g7eKt7PX17Y+/MxZlD6a9vVZ5fSK89v7P5Mr27+/z9C5uV2892b23u3roY2959cmF3bTO9u7l59Vk3fOf5k2fPN9ee7Xv+ZG2pUrm91du9E9vdrSwtzXx2a/fgv8+WTm3u6124GkvfOnS4t9RL72zcSlcqlY0fgZ/qOdnQcVmbEX2Ek1SATYlxmhrGWepcYCeCeJiAhyqmZk3pvjhv8rrw/ZweIHz18Hlld57+qee8xC+Xu2WJG7pv5VfpTUDTDRpwOb07L07kc0cLnb7b8wa13DFqZPnPufKx5rGa0Xm0b9Uw+XUp0Shv1jJ6Z56nRfKC+fjjstD++Lv/c+eYTNePSYDm1rg2XcYePIqDYY+PqNaM1Or8dtKq8eswwjYPqQtvV2Fmvaj9LXhciH88TUa53O9u4g7tl9JceGXS5hXzqsb4+veGXCAiw3hemTUmQgm+Vv2YHw0rbhLF+2llG8eu0HIhimGbJp2ZyP8NR4f2pdbjmAqkS7mjUqdQsCx+Xn1OFSRQ0PuE6e5djMfucibNb3GGSWe4ZjW3lEmZIF6+YSRKuWRimiRls9xt5zKr8dV4OZ7GjjVpDIvS8X1ydi6hpDKcGEv8j1XAhqJ83wiqwKP3MZN2/gn8l5S7Mne0ocBhhiTsFITnvaNi1CdXzf6EO0YR7rFG1tTmZmiAt9uAr4Meg2LjqDCGqSXbVNWEHY59Z2mZyVvhul6kbgGTB4bB58VdPik3MyKQrCcNudYsmqn443DD1HU+KurxrqFTIf2xnFCfycnHVsaIF+ObcaOveNMik9ZuI1PsiFams7xpNchiQ0rlmSWeZVA8n8lk0skGp5tPKQB6NYgCXDM6mR+D9SLNI1XcS84AN2/z8pdYKaYF5d9mNayRPIF5kiFcwtreLz7W9oTN3/IJoesBzaibwTHyWq6m8Jik+qydcvHSWFIcAtyaXhP4slVLYF06V24/SnH16av/U2w0OLGWapdqGaCXM58Yj9ICHZc6RTrReEJOk8U4z5mFtNF5lDOr0832E1MugIba0VNXG/W+pvB0OvPJpzkUk1ZkWqdnhQbV4USep2O8RkDaIljsR6DzCaxBje1HT7k4Bhez9z8WZilEpAyocnvedGTZrByeTsERFoY/xvAwnz85yGn8WMTjIXrcJRbkylV8ekdcwC7Vs1nDnJTPUOUbgljDtnSsYBjghqkO1/7nLrhhNo41du+W+dWoeUOP7yus3k0Vko1Gc6dYPlYuzpcN/XWOluZr5ZvTzeG7uYxxdz5jZDbJYw3yWDIB9uwVBQtGLWpVTGcAj/Wd4VP6jjh0A6yQcfrKPwMVpdrViehHTCwyJQb9mjjHnADl8FgYJEQwE5yoM7QdBeFrNATQmuiHzhEGYxS7lyEdJ+3iQyNT5NhojGcydRs2Nid/oyZS+XyeAuat+3kzDzOSYaaLGVGKS5mifjsnSRlRiRrxNDSDRrxpZRJdOdFuWzffKMppsSiZyTdyDfW5lUw8FsVifHmtWWxkMkk1OndHLBr5VFwypVt5KWdOheJaaE2xJODI61NzfwJM0pKbIYkhY24YcvXJn0xMP9dXoVzQMXThW48y8xLe0PXQRjbols7AYCQQA4wv4g/2u3yxANdnro9ZYWEYKxa+ouwBTdn/IVTZgoJJ+VvYMq4I4jqcf5Jspsp6m89VRzhZXy0rhVptGwvhTE0qpJJLfPl/2kKiatIX9QePxHZjWpxfyvGd6qMy3Uk9F+SPM+V2XJy+mOOxYk5aB/zaU9OSEdOBpp5QGaG90tGnHH8CR3BxQk4Ew44Yc88WoLUF642dAoQgw72hyW+aHFfgCxx8Z9YRYlQPp7JUbBDSHjtpczGLWlJNYbyaUicdROErtV8k7NcaE+fDlNC4RJaiGDbRACmgL8UBRVOfxFcbI5LAY1eIJq/M4udRfI6Ln7lx1Cw0TPVprd3Yrj2Vp9WkXL5RkWhulcfK8+a+ZuNuIb5u0Jmd6FDBkHLxcvKZKUiJ6Uv0HmOH57Chu/M3dPWfwUOvKCIsqjl/4vAgAi6LnVTXlFeutBV2auICfJg3mmNR4Os5p0So0brmmfHbSUJAGIY5REMc0v/bB6yejwhlLBTzDh4OJzxiqJySfCe4vNS5YoAM/ySqJyTdjIvV25ahP4z6NBc1DMIyGspIYntpWbI65mO18d2ulZHyj4t9pn4xY0pPrXxeD60l7jTiD4uZvLWR0SXJlMRiM1a0wig91NDZTbXdfJzK6MV//Wew+9bS2vDS1Qsv/v7godLS7sut7uaLze7shaOVo2vp62ev3tlpHd+70f3Hq5Uv1l6LtdKxLyf3j57ttSYXe1+P9GavbqevXXj9r3vda2/NVk4NH//7nZ2Na6eX9l489XL70B+fzL6ozGx/md5Mb25V9i3te/FF+kV3dGO0NfmysjlzfWnpzlrrDzOv9S7Orm2WSn/Y3NzcvbO577W9z46u7T4p/Wx3M/3l0m5684P00rWdz9YulpYOvlYp7Xt5dHdm6a23trYqvdhs6fnM7a2lpX8C9CpvaVkhmznh1/iF+6s8ze9OlxvHUiCaMq4LR7hA2PRY2iQVidZw4vckd5CBDgLD7R7tNVkJkzIHaergTQrSdT8g7Xv5gBymAhBTD7Lk3JCO8clQ2lwVy/xqFqS22SNe6KTlI8xxTXuoUCDaVPZFs31vx59SVTGdMu7+/3D66F3AGfo8KSTu1IS2mcHuFrhtlTPX2T08bVZSdOZSef1umXtzhb7BZYYyuvGf4L+M6TZAIJBGGmEtoeji09RmPFkrGhk8LnZzIYCKGvbbXx4gbMEpELrpInp0iLShKAH5OwJQ6tEgnAKLTtIbUl1JNNoTizgarYvF/A5F0/UQVMDcmp7nM3HAtcdiGkYj7BXN5YlxOkdDv6xkL8zBj+RlS8+Yu5mvVEsHD3V9Lc6idMbMFFO7j4tkQ9XjRuYZ19GfUqFMJlUxJLENEhnJqHCgLeHoRDH1J/AIJERQw3CwnSsWpriM/rCwhD3IfbfciWem0yqf0zDNiqOlcNAX5tbJYjN2Q4MRLbeuZ2eRqYIkZCkId/pF5AiKOOxcLwQTDWLop+XCEyUcquISrlkbE3pB1B9MZ6k1yCdxAeagdtLDwbu1Kp+nexj6dmfeWn/A714SeKXwgDdXlwqZT8z5TNn4eAkUa+X2Y7qxns7FaRAvGw9gep1OdXRQWMaWLB5P8nFDon4DOOxueTnZwAs9aiEB2AKPGW+ql8RObp0Hqa2Hl5pDgLaA/RQaUPj+ew7N8+acCw2KSAaIFRyacJlzCXCprjgwwj/oUb4I4iFsT6JuFTb5mgSNPQYd3lKAntKF0IIxylAOil4wa86undckiDF44XdXaG6dupQpR9PWxJwAJ8RU+ai+emNeLaRAfN+NdqLGl4uXcqX4QlDgsRqMH+WwDMj838aTQ/VLHG39CJTRHAqsZTpzR5GlnytSTcuka4Av5kWNtm73ifk8lxdZeTLpnmIERK6BtBq1gWyemRLTeRDSGUDVxO2ogJhXEK9N64kdVpNllc2vUVFRytWZPLdZtCwxmk9Z7HGb0x5EaR1Qo97zK8qYFabb7/GZZJwHUlNO1xN+QjRzHbErGUUjK8bzmbWbbzQ7QM4W29shQwTLxbzEp8FTKq6bcUm/3RQ1qOmybv4GPDUohbbCC2CbMmu0kEKM8PcLiqZyNVI+c+dRqlDk49P51HPCKylGCq1OX5OjFJ3jJ8biu9h/FBaw5vTy/MVs6p7i8LjIyNIrMIIiWc0DNws5XZq+r1Wtl+tFrnO0+AiGN2Qn5cK1VxR+UggJNfwMLy0cupxqrPLW/FN+FwqqUeg0vluucKnVpzmTNpS1QjEh0hZ2FCvhMv2YzmJG7rYupWB+QvHD4RsqNyVEm2D6RyD1SQbcSIrZ6S1zHrdcnP5KOK1WYaJwlD96446ONNeNVAGTXjpCfvxGjemTX2dYN4kKvBU9msqdo7PVRO5oGn3FCGuaI+A/GA4Mhj30kGZsTJX5cpvWBPAmPi1xNzDeCsQwiuVZGg0LwyHunSZOhmpwl+W4jiiY1Wiptq7tKWNUqlCKYvcnxBy+Lu1rkHInw1EYv5O5FC9LXJw2dlLzcXJPSKPkbdkCfef61E7xOyCRT3SmZPkdoyJFo6JbBqJ1wQ2kYrEDNekJJ5pmM5kA3K4ThqfyIErPpWnht25ZykB8TaQBhLokFTc0UA99RIzTag8igibo7JgyiXfiGbUGDKb7TpPX8xkphB7wEk5ZrI3R+QoNKEW05lDnRlYviioNDK4rFvcw0Su4LG22o5KVy2Qlvisl+WKoruSlpbiUf7psZKVUugqzQwnXFHAu2jBnNF8Vi+p3gATvL0MgiPN7LzNJwrGnsFr7gvptsjZfhFN016zpEiXqxdzWUDSZrZFJ8dcx9SGk94TXp+KHYFTHcw9y0nwFH09gvNgPw/sFzncZKiTlHbkncg/oDJbv2wcehLWOeB8Gdv1OYSyZTxGOXWxMuK+3V2Rqk5OEhhovmKndssU9/ETj0NxbmMSJ3HKBxm9jj1O58xiVKb9lltcfzC/QQDvN0e5wn4IBaXScVXE/BLDwGzCzby19+3cX0+m/O3By41ppq/XB2vX+9Dc2rm5X1m4fev58Zmez9LPSzIvW3tLwi43FjZN/N9O6utU/s2/r0GcX9j0/2No6dOdnL7rpjcqJ17r73vvD4tXT3VZp8eoXn/XevLOzmb5duXh9rXfhRXc49sXeb/eOp9889auTB2Mv9u60XqZndl7Mvlx6/fjxja3ZD9auz1S2ty68PrPv5R9OlvZt7WwvpdMvDx1dS89s/eXLgy/TW+nu7a19w73Pjp8eXutuLLaOf339+MxGd+/PPvjL/wSaKJmmbkrRnsP+EeODdFO8lTfgVFTiJONZQjLyql98qnSNKk6zQSfm7VECG2ahrOeuyVNqeAJoenEpVa9PUUAT0K6XcCDnQowy9d5NEJBNsx5lS2HIO20AdWM9P2ZPzA1FofHHcD33c8VCYf6QEq0H42o7nluSDFgXFS6TH6bC2pUGmymyGyLI6FJxWRSXQpKhS1CGWsw57najNtkZ2LB5lZqmaXH+P8F/jZGGzgoJ6688IPkurnFGcHJajy/r5nxG72LxT0IRKl8UYlyooAVwmRduJe/qX+HMggYPnlFUmTawPnqJq/JYNgztfIxE/GBcCYf1t9wuC1L8+n/TaYG2Gg4AEN9ZxxQNsjJgrX0LqAVxjWLPLPF7zig8R+vchtbGNEHgc8p7/r51UEiUwfTkUIfm1+lcOLs/GQeohmJDiR6LuNUhlgwHhg13CC7w28b0j0AjNZVL6RPQf92elcE7lmyykzdWM+U4Z86bS9HCZd7LYxgzQwlSbjnsFLRdVFCBrKEfM9f4j7V4qAB59CAisVn2cthDHPZF7FIChvZQb1FYnNan56a1fRb/Tu0yAbHBWKiRJUM1baE5yeEyr3rYBXKEybIfwkvxgrovYWpaIp8vhNMrHxdoPUiVpaVCGQihMo/0feFOFjDtSMNqDKMkSoo4o9qPMyw845/AcsqfgNgRM/E4V09sQKIqUxNQwCfpqgjEogRAWqyNRR1RWhO73oQU1ccaVvWiIoKQ5CSq8rX/r6l7f27iPhQF/t2X9r2r/eq9u1ppv+hlvVg9LT8kLEvEL9m6YBuCXSi+aa5qIzN2gkPBgEMMDCSEBhIncwThpJdzSkiBhDZx0klImTbEHafTCS3nnPQcMmfuf3J/uT/cP+Qzn7BWusQ0xrTg2oCAwhCZgn3YqbNs+bOApcwnYglzAYGCVo81DG2SiyXlZcDDwvs4ZwYuOEaDJvprjMXnxSH5hF5RxmDvIMayzK3jDFzSI6oKY5MPtC41og4NZtNK8oIu840aGAPSf1zCfQSEnGibxgiWkVTLB78F3RSRjcRFNd0mjdMInT14k+hH3+VyRFyqnG7bxw3Zy6VQeD/Q01JILprEqdmSU1QEWMhn+njLYCp56fRf7C7xsidpmcUROkyz+lFRaqx/Ar+7vJieZcgmCBF5IgTd2Ag9Lit0TEbE3EfdKfIjm4TSS0PKu+gNEoxha0ik7XJifMZcswOzaummKv725ANGmSACFnlIpyfieb4ImAPESRzvYWiTOuLnUoShvGCefQqsV2uERKjFdN2eJggNs07Svfa+2CwRkT6oXfQ4e4pKRa8qXWedWpUWY0WpNybTyCPVCLo3vWJVcoR6UOlHFI3xn9AvajsRFrQgU6tKLThL2GYOGsCx8+y140bNn/JxI4JNK9MyX9GmE33lHajokKU1XNJIo2KfyC3xEJFBkou6LsQ+QCuXsLPxbG+aUAl9ojYlPbauEQBMFQm1Nz00AKEbTxlHMOJNBFXuursDfnygJELKQsI8AnORbL7czYgbmqoqiW5aj5wCzCDIKg0YW8MInRkzeVXrLZlBBl5SunNr+qCdDWUtxlxPsEjQBgsFul4hDKh2L0BwSrzVGLRzTFjNOMbtphDEMU+vVJYZdIkF2gU0cY5RPDgr9zMc69InQ0z63swogArnOiFkpOytGbcTg9nlRpaOKIqCEafSaqhbt9Q4vRQaYm8IrD7DdrlYQtY4IhbbAj8y+XRD/STJNIeyzNEEmuD1PSGVqRSBpZf7K7WKWswTirgbmxTT1dGkJzkN81OckUwivQl0DFUQ5MSXcxUAeng/cu8roE/0SiWBf7Ouh2tJb8F2GTajAofRNoB7m7OB1LiX4eXUT1astJHCSudgr8vn1in89AsHL1YJLezEXF66q5jtGxVZmUmfN0elvBwKjFP1X6cZaMuB0eBh4pa8UPOUONg2fDkRF2iK74DfENmjRYji8LGagAz/qtT42Z43ZqXZBAidzj5ZJPpCsXwflJsFmq8NMY4UyMDrZ8lLcoUxlqT8OwQiGYoeiRzkxxcln9vXVSSGpuylmEj+jb9OW0AqeUYP+/y4zxV1uNiWlXhOvgEN82dPyA+UIDeO5aQRLsrSjlSO9FzJhnxe1o+/i79SmH1D1HILeeWPPjFr2VI6pd2OiGkmR4o0O7wwlS0m/Mcp/85Bm5vCkgEqehd8tX57vrXz0Ebvv6+u9Q9fyPR/lfndldt77p26N/3W8le/2Mi8tac9v35h9+6/HKv3t7rm1r5abc3Pz69nXjv85NCHtw/1z7V2Lz0+1N975kp/19Xpx/3rVz8cXjvf/viLZv/azvndzbn2F8NH9u3bN/fS7pE/tZfmDu3J3F69eG/k9Xqm/WlmuP5P7ZeGm739y0c+/PKtdubjI0d6e9u/W709f+V8q7fr/BfttYura63W368euT1/ZX55Y+5Q1z/WuvYsrw63N3r3nm/OZebmbw9f2QI/NvqStkpAP7FGGjk9He+LpA+Am+nEUZVJ92UIJfQgYYEx5lTYo9VIwcUy15DC3Py12JhMtcmxcA2MloJMq1hhgGbYqn1vlRkR0cBvXF8aCpE3ZZoSjBG/4OVsmA+Re1EOxVfwJPzkF0hwGUngx+hhr1sKc9wjJ/qYgXHYQyll2BTzszB3C67kr5EVW/jdEP2i3JXuK04mTOSBdflGboFg1AL1S9r9yGY3dsB0BzBVPWkrK6+KF0N5JR9P516M76H76CI5FbGM+sRBYgeezFdgnQ76JCTbVe3nl0olRiGytsE6mRCuL/qNwME9l6QSGkxmyaFeEWQ/8NJ4KTwNKa3G+/1BYc5NelwM+W+wVgclmninOEOyTW94cIWkWS/TTrnsUSelWHjTF7JIncLCviP8FJFXoWTV6mShHJAImE9Ou1dgRUMlk+2K0mw86b+UCx+Reb+opXSm0AH5QQ0wjW5g3VbZSkHnw0r6rdhv0rA8Zk2ENww5NCaxo1Xjw+qMVp5RNOBeLgQdojOk3qKbfugtT4xKWdAPI5/p5mSBD+/vboiNwYNIC2/krQmIvBMM3sYER9DhNcxkr2aCOA3xKFfXoaKHk4aZagtOBxjgIM+1GQ3F4NjiJNwNZ0YhBGU8kInAkK6qCjPTFdQtxLMyz2coj8ZSrggCnyKIBhOMHprpgMaYoZnxShz0q+FQ6EVYbiQOgHJROmnlE9ZfUFhsFBMiBton4+l839FkmJzjMF6gzYaCVukXkhrBIC10ldAwOBXbcQtmmO7ZJPxXWrM20snTN/O1yqTxkhfDvc4Tlp5sB5OFsgiiJXeLjJMGFGx58ohPoJhcTZ4sfey5TPdcRyoiP01qRNWKURV9DfwnTZ/mbTGyDjV4mYd+sPhWhRpYLIGUD82n4+ItQj0x7n8KHnzkIwkxkX7jIr5CRGKAOPnOPUmOA7FAh+DP4QcB4C+kw+DrfN8YIwHDxr/CRmkaSORBZsmHZqbgSd0i+lViYYexop0O/Tyt40M5S98hneEDtBzJw6rzsMvmfBQU3WSxn6ftZNjms8MMgnzOOx5BxtwusrYjPsUzl67Zd+hpBcQCtkwkkESaZQOOCyQTQTCkpnJrwQCOgu6cNPhHiWHCWsVi0s1LFZ7UvvH5Y9+CHytio/Ag4TNfWzAn1Jw+EaldteJKQwm/X+7ul3Q5ZVc1HvY2VEVPNAJlc05wOoQ/qJCH+wQcxmCF7lZbarYAzkKdhZlIZCyk8nhB+/tY0rISihz2NG1OjZURCKtXEhF4WWf4qrI21rDKo0zYIc/FBquTklLT9L+Xb/EFHtCI76UROGFEjnu1TBCooBBPF8ZWJWhWWWHQZKYx2TRZoHZnNyAwoQZGCfQDGDJpkVDzkq1OpsdBCiex9O1QI6HEuzF4sl/Mf1Sm+wAfPPBdKK/BqpS32rTDFsQ1mjt3hGaKtTSGlHJdzpFyJAlHw1cr5q9VgvKnwSkDB/+5ODTEo71I9MZMNdgjz8d5kjjLU4TeFR/V9R1QClffIyQLTilVLDlPnkB5UM0nU8M2b9m0GrDqnaOYWRV0FxfKLdqLlCEGXXZfSJWnDsLGbF+lPpS2KkXlhYT9KfjRYgkR1IB9g4c1FGOs0DvzWZANkVWFMTeAlYDmFKK4C8Z3IUsrRo5qu7Go3b/LxVHcyz4EX8xP4CtSK0zmiONMNlR4nAaXipLuT+We6ETNBmTS9KwpzMQOfYKFWr/Jc+gPpEEE5yVAk2HEy7nhmf99kEJnVeJ4XU+VE+fK2YP0brsXMYupKcJY5jF/PH803vfG9KCsUTd4RGkZO3KkJSpM5LvY4qKsnFaIxfugYS0UtAle1S+EgZ40JhATfwsBy8oy50KVNj3TUOwy0lxdzGgFgO5sJNzlswmCjHko9iWWc3Z3qzV1rFUbmiyTIGKp/ZFIOgRjwi6wXIp5BMHJRNCSDJUTiNculYfDCuXRqhM8fjX74J3Y8ZgGiGlzCIStGVlXd4YYbTDkQ8rMGY8Ax943QUg5VPWbVR4EeKvXQDzOsBMh9zzPI77M6wXr1EKIDZHKIAXvgsenMmvN+QOnpr9qHpteP9Dq/5cnX9Qzq3+fzyyd/9ufX9p7pnf//mvzh/7UOjQy/7efz99+/PqvDh+Za+5tNef+/Xyzee/Fe9cP9H/5k0fNCxeX3+uf/sd67/zy46vtkZEvT02/3D6wO/Pp+f/59sbc36/1n7/S9efD+3uHuzLt1otf3dv4yXKz9fyhVr3e2l+/sPZ27/k/7Wzt+cnO3uf7+//UbPV/en7Pxr0Df14+s7/1ZP7qav+f2ms7myNr77XOP57e2L9cn8/c6319/WK9/dvln863NoElhhiiOvFBYo8O1SmtEgDxDQRMqVIEEv08C98/Gcu9Qdw4FSRB8Wx0cLznFc6OO9mo10+9YqfMyvtToVljrQBnis6JxGk905cuT2g5j5vOWDYmykcXGfMKsgtSMWlKrjp016DpXoDKnmKxLEnJGdJcuuGvUe4wyqM1mokwaUIhiGGdsWzGFBF656oB4mkiopzWMnpBPJktSmVlo1iUQJqQVsR2GdEySJIpfwc8SMYL4DM4qPRDntf4yeR32dcqn7HQKtTM4F6HrHSTGAK+adc47WBiA6zcJXswj8sjCPJLziDQyqrYONdlP4EzWk0H9GoIQVQdxEXswzJwcPbjkzq6VtDPjum8GziWZygGaiy8FZpW4CQLNBM3/8I6do3bYUSL7TPVvKJ000nYlRg0IxZIxBeuFiIKiNxSsoW2OAaAVA3r9FsqFGNmWZfRBbfLwbBwchLvgE+GPvhn0EgocKmI2yYW3UOjgbXTEGKI+eSs2OY4p0Lx1GW6HY36WLdM49Hempf8no9Cj79NkbQhx8gEM29o48gvICBfmdoR1tMnagL6o+Gz2ziv7fvSapVbVMucF5DrvsCrjFFLAb0ZitCqaFlh/7CfcztKLhpJa3KIOQeA6pWbyJitpKUdivUEgJyWn6wshNYZ8rpMcj0nzF98gKVq8pjh86xZUoUJMinG/nvwHoiJcSZ0OpcpSG7mUjhgheuGx+OvyTHnQNPj/YPMege+4doDNrzHhUb95M4/eJXnBnpoavGCz88+Gq+ytLtuie/YGLK0otaDSTAUNinXQIuKuqIeOICZczhCVBIWCNtjf3qKUdyadOnaVCgRIIgQFWw7ewTS7uZErBWBGmGA40lvnZHdz8Vkd87o1Zj3pUhl8mh+PVZdNDF6pqhfGRqyY8YOtyTtNAC5w4Dku7H74MdsvhKxFkLgnipzkB8sq+EPdY+LdYWAyI7YHUyS8zicwrDTKTvYWAESn9KeXZ6ZGzGNb1+2nePxsino+1VVFryDVaAeqiaN8l9NjXUe4Vgb67GlePrjUUbzswpbDqMZLzDpGATJQ2ZWk80Q5NF+mXJBn3CZGDgGqYJ+fEaS3V1uFoupuBwRrwwVzl0aygXCg1fjg/EKpMxRqddkaMcM1OVyL84j3tRNnL0LfgTJHPhXWnl1nqxdB3CmqqADiLILTiIVdL9tZ3tsOObGfCPekhun2R1pdIiW3LKBp0aHemkHHbNBV5K8VlyQTQlOQWNPBYnIJgD+uS4v5nb6esiy9nriu6mkVHIh7C90JC1yuM2UlwumwQMkqdWmiFKA5OTvib0iCM4wO/z2cJeLlmOkb0VlLlZUwm3F4UygdyUHgaqVCFfb6SCD5PfuWKnLxZFCVPMw1h3wkQUJTXx/JVzHUzxatIgpOKwFPF7a8rjcc7jPR7Nuhh5tcm4HckcVGS3BuD9Yq4Rhbgk3YwhHApW9Yva9IbKv2u2+JXECh+Q4fjY8TEC7G4/6IfP4fcZuq5koGWiBnN8vII409hSPSgEtFy7SP7e/GyYved1O13lfj0dTZA9vDA/0KOFYAAXM/RITwpKzMYKsv1Own7byET02zHkIL2tjefsSSwqWH3pgsAPeG5OqETWOzH5EID5fdZj09CgFGT2pOKhhAQPfnEg5XGy/GPOgFDUzqX6ViFGEUUG6/j9YqOimX3HE1j1Im8QHPX91/JKp0viMKScneuGoyeK7PKbyMc/TlF42eNSGLg9np0Qstp5o4DIb45VGi3U6OJKlHI4mR+HHRfbGruO9LLsLAzMyAw/DwgIYyqaV7LV4bbSCWAy908Q9AzYn63N59vGYMIpkRec74JNuUToBJcNcL5WKN2n8rM04Am+gMHKetfNH/KyXJ2/Jo+RcSTYKKYzOnj4zi4ZssiQRyRa5Qiqvmp9YkatSTo8HInRSPBZAPhalvbStPx2DIsfyNjlT0gcE6yahftTvc5SCA16/o+fAUTUumRAmCy/TPiNowwnKPicTCp96d4CF/fRi1OnS0Ip0SIww8Ve/wxonN1acgON5UgwfkHW854So8LZ+m+AUjIjJkE/Bf7x8fvr80sjVpSeZ5YvrF4bbO1uvT09f+Lo18quRff+UeeXYy/1r0z9t/ePrJxtvH9jIrGf+5RdXD7VvNw+3nn9yKtN8krm4MX3gy5frrb8dnr5w7dN/tC6uvry6M7N2fv/IL/tb+w4fa1/54uX64frSLw/tP/DFL1+eG263X+pq759fn/66lfnFztV2vZXpPbw8cqyreWx4X9fhYx93tb/8+JVfvTIykuk9/Lu3Nw7MH1nLbPz2y5Hptfrq40dda18cPjDySutMs93+YqR94VTX6+cza1sAjZoAEnoh/Nq5iXI3rw8C7wiYUD7Tkz4H1XSx6Bs4CiHd5gFtgaoUiS3nCwmggoKlfxrCDSsUioHRJWbGz+T0SwxYe7PMM4jDscEPU7GYjXVwHL1XEL1OVyxGvLCXwxwixzGAvwY/y3twLR0Kf1oALHS6Uh6+5eQwW9BVGOUzOkeNe2CFKXTF9LCSmlAKha+kJMsHrApfHcbMmgtXFWJm74CHYDkbSLrvAA/rwd9FOX7i0+JQFXeHQUj9mGZ9yes24LLvq3EveCBDCtwR+WYiWzwqJv979QMrXp6qAUAewmxhyVbxJau3p875L88miiH7dG4snrQ5FnlyTXN5g3aXmyK7SFHTScwNhl5xy+6SK2hjpUfxCQYPX+5Dud0BXVK9CmYOjFAUEDyyob1Qp88ZMOpA3aF5pjs8wxydzc6uJwRSIMfJ2rvH3FRq0oafc9BNny8adLu8wec6wAlBKQzjRbRnIpCAICVGJo65c95UD/TQbF14LofhuYjNcdgPQw3paKRc+kqr/K+xUh8hhubdyMN7TT5vvKdP0TKC2slLXydluiC5T6T0aTbC+TnabozOuaxYgPTj0tkuweWV5TCfMzMVMBYmqwkrslHQ+SHF7ZKwppfGDFQ5F4C9btpPYbx2rVC3JqowfTI+oWcipdoKVKHFXqNTHjocxSFZ90lGcMBt98tbgMdkD2wsZLtfU88pKhy1cHsTY3CWZV0eas7+bzM3MFe5at9XBlKokK2NJVcrP7O6a79JWkoLUrgAZHpU32nEItyNmByG81RZTCg2waGdOWFzBD0eLCWPiFxYZmCJCI4ITuyG4TmO6ENqdzjmMiPsaBsQb47bBUcQ7MYEb/i7Qhb626Xo5UbYwYcCH8bNSX4QmAidCTHhbn3ws8QCmkASggpyHZ8vmDFMwJyAfwg8HhfHKGmx+F95dRYSuRzh7+oRXJjte97nnidoJEOWFskuAogL4GZy6MFqbSr1YEpLDc5eTBJ/8NouUz7PPC2ROs3LfmnN4NPxcYE2rRbtcEdJwe6w1902cqb010Qt+vYA64XAy5eiywAinPS7XIuHRIyXx11u0reXwqAqX6YOwv6SYKTpcykud+DkzV9rcpU+p69rseR3aTUUF1dT3XIeiL5xeo0XhjjOwZfA58BOCzR9sHs2Pk8TfTKLauKba5wT77HbXX76bYfEEwaBnPgBmhljaPHNqU8eDVUq5VJFjqvrUF2MclXacNWtCZq0Swf7lNsuEsZrL3AR39uy12vb5aLd2Iig2pE/CvNvdrG0l3J4fWTwfHoFREVmFwTHona6B6kucmDERUKJ7/HYwjs1Cid3aTnqZ9eK/x2xJHgpmcvYU+6VOBAr7BM1LaWCEtbD9gZpmsIh42QfAkFwEDEzHklmlO6QGVYcPn6EwzjkibkwqgufUcBYFvK1DTUOodLozsZu14YSQOxWHqivycBDCRWNck6TjFyFHhko1y7jhh8gkvMc8V72jDtYgXPsdo4XcEr0srZ9uE10ehy7MPvzGmDBjajnBGoPYrvMMM8G5ZEbBB0zYyyFtdhdOAKQL+OooCrdSIEx/DXO5YSJSHcIttVYQqZAgXLMVc1dLB50YPZN4BBcPViNWGD+Cwa+cVI8VaPbJTklGCgFHy3xDDNRkRpq/vZspJgGjV9LjVXbb0I3pUZEJVqLTo2nRBi1nXmxJt4kklikuMcQyAphMSz9Cs//v5BlN+3x2en/j6SmBN+jIqblnCTvg3McI6elPGL4EZ7yhh9xPUzpSBSnv89XiDJ1LAQS0g5QPFvtd0dpJh0vEu8eIBiopXTSHd1rT4qeAdZOkh1AkixJQLOPmEcnYh5cQnSwy5MDuSBVSLmWWJgLSUS+OJkRIwlApMJEYn2slj0Nr79RtK5JmOANpwSS/9uEbBUVCRLKGRpUz9qxUCDw+q5STXbRAXLXMVeUcg9An901p7zro3b5DYC6xqUwVHoGHwmnhJSItJVzFDGH91B0AQNEoW4SJDZDaaL2U+lo7PRMsTyVbjqgRhcaUoV+QkKUL6Z4g2/jL2iQdfl49g54eH9r6872s+3Os62t+9udTufp0+0ftjt3ftjqdDa3O3c6d54962w93O48297evrt9Z/vb7e07m1udO9t3trc6d7fvdLbvdp7dvX93e3u7s/3t1t2tztbm3U7nh637m5sP7z/c7DzdfLi5ufn7zYf3Nz9/eP/p099vdrbvPPu8c+eHTqfz8O7m0879rc7mw4ebTz/fvL+1udX5vLO1ufXD9t2tTueHrWfPvv1h89nnd+88e9i5v3n32Z1vt7fubD/sdLbvdDa3H96///nnm0+f3v8//xcn+8ysvLHpFAAAAABJRU5ErkJggg==",hce=new Image;hce.src=YMt;const dce=new Image;dce.src=KMt;const XMt={backgroundColor:{image:dce,repeat:"repeat"},series:{name:"pie",type:"pie",selectedMode:"single",selectedOffset:30,clockwise:!0,label:{fontSize:18,color:"#235894"},labelLine:{lineStyle:{color:"#235894"}},itemStyle:{opacity:.7,color:{image:hce,repeat:"repeat"},borderWidth:3,borderColor:"#235894"}}},qMt={series:{type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2}}},m4={DYNAMIC_LINE_BAR_MIX:HMt,DYNAMIC_RANKING_BAR:BMt,DYNAMIC_RING:VMt,LINE_STEP:WMt,PIE_PATTERN:XMt,PIE_ROSE:zMt,LINE_BASICS:jMt,PIE_BASICS:UMt,BAR_BASICS:GMt,RING_BASICS:qMt},xL={westeros:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],wonderland:["#4ea397","#22c3aa","#7bd9a5","#d0648a","#f58db2","#f2b3c9"],walden:["#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],chalk:["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb","#d2f5a6","#76f2f2"],macarons:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"]},ZMt=Object.keys(xL).map(e=>({value:e,color:xL[e]})),vce=e=>{var r;const t=(r=e==null?void 0:e.config)==null?void 0:r.title;return{title:{show:t.show,text:t.value,left:10,top:10,textStyle:{color:t.color}}}},pce=e=>{var r;const t=((r=e==null?void 0:e.config)==null?void 0:r.theme)||"westeros";return{color:xL[t]}},gce=e=>({tooltip:{trigger:!(di(e,"pie")||di(e,"ring"))?"axis":"item"}}),yce=e=>{var i;const t=((i=e==null?void 0:e.config)==null?void 0:i.backgroundColor)||"#ffffff",{type:r}=e,n=m4[r];return n!=null&&n.backgroundColor?{backgroundColor:{...n==null?void 0:n.backgroundColor}}:{backgroundColor:t}},di=(e,t)=>{const{type:r}=e;return r===t},mce=e=>{const{config:t}=e;return{legend:{show:t==null?void 0:t.legend,bottom:"10"}}},bce=e=>{const{type:t}=e;return!!["BAR_BASICS","LINE_BASICS","LINE_STEP"].includes(t)},JMt=e=>{const{config:t}=e,{data:r=[]}=t,n={};if(bce(e)){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{xAxis:n}}return{}},QMt=e=>{const{config:t,type:r}=e,{data:n=[]}=t,i=m4[r],a=[],o=Qi.cloneDeep(n);if((di(e,"BAR_BASICS")||di(e,"LINE_BASICS")||di(e,"LINE_STEP"))&&(o[0].shift(),o[0].forEach((l,u)=>{const f={name:l,...i.series,data:[]};for(let c=1;c<o.length;c++){const h=o[c];f.data.push(+h[u+1])}a.push(f)})),di(e,"PIE_BASICS")||di(e,"RING_BASICS")||di(e,"PIE_PATTERN")||di(e,"PIE_ROSE")){const s={name:o.shift()[0],...i.series,data:[]};o.forEach(l=>{const[u,f]=l;s.data.push({value:f,name:u})}),a.push(s)}return{series:a}},e2t=e=>{const t={};return bce(e)?(t.type="value",{yAxis:t}):{}};function t2t(e){const t=Qi.cloneDeep(e),r=JMt(t),n=e2t(t),i=QMt(t),a=mce(t),o=vce(t),s=pce(t),l=yce(t),u=gce(t),f={...s,...r,...n,...i,...a,...o,...l,...u};return console.log("option: ",f),f}const r2t=e=>{const t={axisTick:{show:!1}};return di(e,"DYNAMIC_RANKING_BAR")?(t.type="value",{xAxis:t}):{}},n2t=e=>{const{config:t}=e,{data:r=[]}=t,n={axisTick:{show:!1}};if(di(e,"DYNAMIC_RANKING_BAR")){n.type="category",n.data=[];for(let i=1;i<r.length;i++)n.data.push(r[i][0]);return{yAxis:n}}return{}},i2t=e=>{const{config:t,type:r}=e,{data:n=[]}=t,i=m4[r],a=[],o=Qi.cloneDeep(n);if(di(e,"DYNAMIC_RANKING_BAR")&&(o[0].shift(),o[0].forEach((l,u)=>{const f={name:l,...i.series,data:[]};for(let c=1;c<o.length;c++){const h=o[c];f.data.push(+h[u+1])}a.push(f)})),di(e,"DYNAMIC_RING")){const s={name:o.shift()[0],data:[],...i.series};o.forEach(l=>{const[u,f]=l;s.data.push({value:f,name:u})}),a.push(s)}return{series:a}},a2t=(e,t)=>{const r=Qi.cloneDeep(e.config.data),n=r.shift();if(di(e,"DYNAMIC_RANKING_BAR")){const i=r.reverse().filter((a,o)=>o<=t);return i.unshift(n),i}return di(e,"DYNAMIC_RING")?n.map((a,o)=>[a,r[t][o]]):r};function rZ(e,t){const r=Qi.cloneDeep(e),{config:n}=r;n.data=a2t(r,t);const{animation:i}=n,a=r2t(r),o=n2t(r),s=i2t(r),l=mce(r),u=vce(r),f=pce(r),c=yce(r),h=gce(r);return{...f,...a,...o,...s,...l,...u,...c,...h,animationDuration:i.moveTime*1e3,animationEasing:"linear",animationEasingUpdate:"linear"}}const o2t=1e3;let UE=null,Pd=0;const IS=Mn("clear"),s2t=e=>{var r;return(((r=e==null?void 0:e.config)==null?void 0:r.data)||[]).length-1},nZ=(e,t)=>{UE=setInterval(()=>{IS.value="start",Pd=Pd+1,Pd>=s2t(e)&&u2t(),t&&t(Pd-1)},o2t)},l2t=()=>{IS.value="stop",clearInterval(UE)},u2t=()=>{clearInterval(UE),setTimeout(()=>{IS.value="end",Pd=0},1e3)},TL=()=>{IS.value="clear",clearInterval(UE),Pd=0};oZ(()=>{TL()});const iZ=(e,t,r="png")=>{const n=document.createElement("a");n.download=e.name+"."+r,n.href=t,document.body.appendChild(n),n.click(),n.remove()};var OL={},f2t={get exports(){return OL},set exports(e){OL=e}};(function(e,t){(function(r,n,i,a){var o={URL:r.URL||r.webkitURL||r.mozURL||r.msURL,getUserMedia:function(){var k=i.getUserMedia||i.webkitGetUserMedia||i.mozGetUserMedia||i.msGetUserMedia;return k&&k.bind(i)}(),requestAnimFrame:r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame,requestTimeout:function(w,C){if(w=w||o.noop,C=C||0,!o.requestAnimFrame)return setTimeout(w,C);var O=new Date().getTime(),_=new Object,A=o.requestAnimFrame,I=function L(){var V=new Date().getTime(),Y=V-O;Y>=C?w.call():_.value=A(L)};return _.value=A(I),_},Blob:r.Blob||r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder,btoa:function(){var k=r.btoa||function(w){for(var C="",O=0,_=w.length,A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",I=void 0,L=void 0,V=void 0,Y=void 0,ae=void 0,re=void 0,te=void 0;O<_;)I=w.charCodeAt(O++),L=w.charCodeAt(O++),V=w.charCodeAt(O++),Y=I>>2,ae=(I&3)<<4|L>>4,re=(L&15)<<2|V>>6,te=V&63,isNaN(L)?re=te=64:isNaN(V)&&(te=64),C=C+A.charAt(Y)+A.charAt(ae)+A.charAt(re)+A.charAt(te);return C};return k?k.bind(r):o.noop}(),isObject:function(w){return w&&Object.prototype.toString.call(w)==="[object Object]"},isEmptyObject:function(w){return o.isObject(w)&&!Object.keys(w).length},isArray:function(w){return w&&Array.isArray(w)},isFunction:function(w){return w&&typeof w=="function"},isElement:function(w){return w&&w.nodeType===1},isString:function(w){return typeof w=="string"||Object.prototype.toString.call(w)==="[object String]"},isSupported:{canvas:function(){var w=n.createElement("canvas");return w&&w.getContext&&w.getContext("2d")},webworkers:function(){return r.Worker},blob:function(){return o.Blob},Uint8Array:function(){return r.Uint8Array},Uint32Array:function(){return r.Uint32Array},videoCodecs:function(){var k=n.createElement("video"),w={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{k&&k.canPlayType&&(w.mp4=k.canPlayType('video/mp4; codecs="mp4v.20.8"')!=="",w.h264=(k.canPlayType('video/mp4; codecs="avc1.42E01E"')||k.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))!=="",w.ogv=k.canPlayType('video/ogg; codecs="theora"')!=="",w.ogg=k.canPlayType('video/ogg; codecs="theora"')!=="",w.webm=k.canPlayType('video/webm; codecs="vp8, vorbis"')!==-1)}catch{}return w}()},noop:function(){},each:function(w,C){var O=void 0,_=void 0;if(o.isArray(w))for(O=-1,_=w.length;++O<_&&C(O,w[O])!==!1;);else if(o.isObject(w)){for(O in w)if(w.hasOwnProperty(O)&&C(O,w[O])===!1)break}},mergeOptions:function(w,C){if(!(!o.isObject(w)||!o.isObject(C)||!Object.keys)){var O={};return o.each(w,function(_,A){O[_]=w[_]}),o.each(C,function(_,A){var I=C[_];o.isObject(I)&&w[_]?O[_]=o.mergeOptions(w[_],I):O[_]=I}),O}},setCSSAttr:function(w,C,O){o.isElement(w)&&(o.isString(C)&&o.isString(O)?w.style[C]=O:o.isObject(C)&&o.each(C,function(_,A){w.style[_]=A}))},removeElement:function(w){o.isElement(w)&&w.parentNode&&w.parentNode.removeChild(w)},createWebWorker:function(w){if(!o.isString(w))return{};try{var C=new o.Blob([w],{type:"text/javascript"}),O=o.URL.createObjectURL(C),_=new Worker(O);return{objectUrl:O,worker:_}}catch(A){return""+A}},getExtension:function(w){return w.substr(w.lastIndexOf(".")+1,w.length)},getFontSize:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{};if(!n.body||w.resizeFont===!1)return w.fontSize;var C=w.text,O=w.gifWidth,_=parseInt(w.fontSize,10),A=parseInt(w.minFontSize,10),I=n.createElement("div"),L=n.createElement("span");for(I.setAttribute("width",O),I.appendChild(L),L.innerHTML=C,L.style.fontSize=_+"px",L.style.textIndent="-9999px",L.style.visibility="hidden",n.body.appendChild(L);L.offsetWidth>O&&_>=A;)L.style.fontSize=--_+"px";return n.body.removeChild(L),_+"px"},webWorkerError:!1},s=Object.freeze({default:o}),l={validate:function(w){w=o.isObject(w)?w:{};var C={};return o.each(l.validators,function(O,_){var A=_.errorCode;if(!w[A]&&!_.condition)return C=_,C.error=!0,!1}),delete C.condition,C},isValid:function(w){var C=l.validate(w),O=C.error!==!0;return O},validators:[{condition:o.isFunction(o.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:o.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:o.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:o.isFunction(o.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:o.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:o.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:o.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},u=Object.freeze({default:l}),f=function(){},c={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:f,completeCallback:f,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},h=Object.freeze({default:c});function d(){return l.isValid()}function v(){return l.isValid()}function p(){var k={getUserMedia:!0};return l.isValid(k)}function g(k){var w=!1;if(o.isArray(k)&&k.length){if(o.each(k,function(C,O){o.isSupported.videoCodecs[O]&&(w=!0)}),!w)return!1}else if(o.isString(k)&&k.length&&!o.isSupported.videoCodecs[k])return!1;return l.isValid({getUserMedia:!0})}function y(){var k=256,w=499,C=491,O=487,_=503,A=3*_,I=k-1,L=4,V=100,Y=16,ae=1<<Y,re=10,te=10,ge=ae>>te,H=ae<<re-te,Ce=k>>3,oe=6,Oe=1<<oe,Ee=Ce*Oe,be=30,Ie=10,Me=1<<Ie,j,U=8,Q=1<<U,fe=Ie+U,ee=1<<fe,pe,se,ue,ce,ve=[],de=[],Te=[],Le=[];function $e(Ke,Be,at){var He,ot;for(pe=Ke,se=Be,ue=at,ce=new Array(k),He=0;He<k;He++)ce[He]=new Array(4),ot=ce[He],ot[0]=ot[1]=ot[2]=(He<<L+8)/k|0,Te[He]=ae/k|0,de[He]=0}function it(){for(var Ke=[],Be=new Array(k),at=0;at<k;at++)Be[ce[at][3]]=at;for(var He=0,ot=0;ot<k;ot++){var We=Be[ot];Ke[He++]=ce[We][0],Ke[He++]=ce[We][1],Ke[He++]=ce[We][2]}return Ke}function yt(){var Ke,Be,at,He,ot,We,Je,Wt;for(Je=0,Wt=0,Ke=0;Ke<k;Ke++){for(ot=ce[Ke],at=Ke,He=ot[1],Be=Ke+1;Be<k;Be++)We=ce[Be],We[1]<He&&(at=Be,He=We[1]);if(We=ce[at],Ke!=at&&(Be=We[0],We[0]=ot[0],ot[0]=Be,Be=We[1],We[1]=ot[1],ot[1]=Be,Be=We[2],We[2]=ot[2],ot[2]=Be,Be=We[3],We[3]=ot[3],ot[3]=Be),He!=Je){for(ve[Je]=Wt+Ke>>1,Be=Je+1;Be<He;Be++)ve[Be]=Ke;Je=He,Wt=Ke}}for(ve[Je]=Wt+I>>1,Be=Je+1;Be<256;Be++)ve[Be]=I}function Vt(){var Ke,Be,at,He,ot,We,Je,Wt,Ut,Jt,kn,dr,F,X;for(se<A&&(ue=1),j=30+(ue-1)/3,dr=pe,F=0,X=se,kn=se/(3*ue),Jt=kn/V|0,Wt=Me,We=Ee,Je=We>>oe,Je<=1&&(Je=0),Ke=0;Ke<Je;Ke++)Le[Ke]=Wt*((Je*Je-Ke*Ke)*Q/(Je*Je));for(se<A?Ut=3:se%w!==0?Ut=3*w:se%C!==0?Ut=3*C:se%O!==0?Ut=3*O:Ut=3*_,Ke=0;Ke<kn;)if(at=(dr[F+0]&255)<<L,He=(dr[F+1]&255)<<L,ot=(dr[F+2]&255)<<L,Be=wt(at,He,ot),Dt(Wt,Be,at,He,ot),Je!==0&&Ft(Je,Be,at,He,ot),F+=Ut,F>=X&&(F-=se),Ke++,Jt===0&&(Jt=1),Ke%Jt===0)for(Wt-=Wt/j,We-=We/be,Je=We>>oe,Je<=1&&(Je=0),Be=0;Be<Je;Be++)Le[Be]=Wt*((Je*Je-Be*Be)*Q/(Je*Je))}function ut(Ke,Be,at){var He,ot,We,Je,Wt,Ut,Jt;for(Wt=1e3,Jt=-1,He=ve[Be],ot=He-1;He<k||ot>=0;)He<k&&(Ut=ce[He],We=Ut[1]-Be,We>=Wt?He=k:(He++,We<0&&(We=-We),Je=Ut[0]-Ke,Je<0&&(Je=-Je),We+=Je,We<Wt&&(Je=Ut[2]-at,Je<0&&(Je=-Je),We+=Je,We<Wt&&(Wt=We,Jt=Ut[3])))),ot>=0&&(Ut=ce[ot],We=Be-Ut[1],We>=Wt?ot=-1:(ot--,We<0&&(We=-We),Je=Ut[0]-Ke,Je<0&&(Je=-Je),We+=Je,We<Wt&&(Je=Ut[2]-at,Je<0&&(Je=-Je),We+=Je,We<Wt&&(Wt=We,Jt=Ut[3]))));return Jt}function ft(){return Vt(),Et(),yt(),it()}function Et(){var Ke;for(Ke=0;Ke<k;Ke++)ce[Ke][0]>>=L,ce[Ke][1]>>=L,ce[Ke][2]>>=L,ce[Ke][3]=Ke}function Ft(Ke,Be,at,He,ot){var We,Je,Wt,Ut,Jt,kn,dr;for(Wt=Be-Ke,Wt<-1&&(Wt=-1),Ut=Be+Ke,Ut>k&&(Ut=k),We=Be+1,Je=Be-1,kn=1;We<Ut||Je>Wt;){if(Jt=Le[kn++],We<Ut){dr=ce[We++];try{dr[0]-=Jt*(dr[0]-at)/ee|0,dr[1]-=Jt*(dr[1]-He)/ee|0,dr[2]-=Jt*(dr[2]-ot)/ee|0}catch{}}if(Je>Wt){dr=ce[Je--];try{dr[0]-=Jt*(dr[0]-at)/ee|0,dr[1]-=Jt*(dr[1]-He)/ee|0,dr[2]-=Jt*(dr[2]-ot)/ee|0}catch{}}}}function Dt(Ke,Be,at,He,ot){var We=ce[Be],Je=Ke/Me;We[0]-=Je*(We[0]-at)|0,We[1]-=Je*(We[1]-He)|0,We[2]-=Je*(We[2]-ot)|0}function wt(Ke,Be,at){var He,ot,We,Je,Wt,Ut,Jt,kn,dr,F;for(kn=~(1<<31),dr=kn,Ut=-1,Jt=Ut,He=0;He<k;He++)F=ce[He],ot=F[0]-Ke,ot<0&&(ot=-ot),We=F[1]-Be,We<0&&(We=-We),ot+=We,We=F[2]-at,We<0&&(We=-We),ot+=We,ot<kn&&(kn=ot,Ut=He),Je=ot-(de[He]>>Y-L),Je<dr&&(dr=Je,Jt=He),Wt=Te[He]>>te,Te[He]-=Wt,de[He]+=Wt<<re;return Te[Ut]+=ge,de[Ut]-=H,Jt}$e.apply(this,arguments);var dt={};return dt.map=ut,dt.process=ft,dt}function m(){var k=this;try{k.onmessage=function(C){var O=C.data||{},_;O.gifshot&&(_=w.run(O),postMessage(_))}}catch{}var w={dataToRGB:function(O,_,A){for(var I=_*A*4,L=0,V=[];L<I;)V.push(O[L++]),V.push(O[L++]),V.push(O[L++]),L++;return V},componentizedPaletteToArray:function(O){O=O||[];for(var _=[],A=0;A<O.length;A+=3){var I=O[A],L=O[A+1],V=O[A+2];_.push(I<<16|L<<8|V)}return _},processFrameWithQuantizer:function(O,_,A,I){for(var L=this.dataToRGB(O,_,A),V=new y(L,L.length,I),Y=V.process(),ae=new Uint32Array(this.componentizedPaletteToArray(Y)),re=_*A,te=new Uint8Array(re),ge=0,H=0;H<re;H++){var Ce=L[ge++],oe=L[ge++],Oe=L[ge++];te[H]=V.map(Ce,oe,Oe)}return{pixels:te,palette:ae}},run:function(O){O=O||{};var _=O,A=_.height;_.palette;var I=_.sampleInterval,L=_.width,V=O.data;return this.processFrameWithQuantizer(V,L,A,I)}};return w}function b(k,w,C,O){var _=0;O=O===a?{}:O;var A=O.loop===a?null:O.loop,I=O.palette===a?null:O.palette;if(w<=0||C<=0||w>65535||C>65535)throw"Width/Height invalid.";function L(te){var ge=te.length;if(ge<2||ge>256||ge&ge-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return ge}k[_++]=71,k[_++]=73,k[_++]=70,k[_++]=56,k[_++]=57,k[_++]=97;var V=0,Y=0;if(k[_++]=w&255,k[_++]=w>>8&255,k[_++]=C&255,k[_++]=C>>8&255,k[_++]=(I!==null?128:0)|V,k[_++]=Y,k[_++]=0,A!==null){if(A<0||A>65535)throw"Loop count invalid.";k[_++]=33,k[_++]=255,k[_++]=11,k[_++]=78,k[_++]=69,k[_++]=84,k[_++]=83,k[_++]=67,k[_++]=65,k[_++]=80,k[_++]=69,k[_++]=50,k[_++]=46,k[_++]=48,k[_++]=3,k[_++]=1,k[_++]=A&255,k[_++]=A>>8&255,k[_++]=0}var ae=!1;this.addFrame=function(te,ge,H,Ce,oe,Oe){if(ae===!0&&(--_,ae=!1),Oe=Oe===a?{}:Oe,te<0||ge<0||te>65535||ge>65535)throw"x/y invalid.";if(H<=0||Ce<=0||H>65535||Ce>65535)throw"Width/Height invalid.";if(oe.length<H*Ce)throw"Not enough pixels for the frame size.";var Ee=!0,be=Oe.palette;if((be===a||be===null)&&(Ee=!1,be=I),be===a||be===null)throw"Must supply either a local or global palette.";for(var Ie=L(be),Me=0;Ie>>=1;)++Me;Ie=1<<Me;var j=Oe.delay===a?0:Oe.delay,U=Oe.disposal===a?0:Oe.disposal;if(U<0||U>3)throw"Disposal out of range.";var Q=!1,fe=0;if(Oe.transparent!==a&&Oe.transparent!==null&&(Q=!0,fe=Oe.transparent,fe<0||fe>=Ie))throw"Transparent color index.";if((U!==0||Q||j!==0)&&(k[_++]=33,k[_++]=249,k[_++]=4,k[_++]=U<<2|(Q===!0?1:0),k[_++]=j&255,k[_++]=j>>8&255,k[_++]=fe,k[_++]=0),k[_++]=44,k[_++]=te&255,k[_++]=te>>8&255,k[_++]=ge&255,k[_++]=ge>>8&255,k[_++]=H&255,k[_++]=H>>8&255,k[_++]=Ce&255,k[_++]=Ce>>8&255,k[_++]=Ee===!0?128|Me-1:0,Ee===!0)for(var ee=0,pe=be.length;ee<pe;++ee){var se=be[ee];k[_++]=se>>16&255,k[_++]=se>>8&255,k[_++]=se&255}_=re(k,_,Me<2?2:Me,oe)},this.end=function(){return ae===!1&&(k[_++]=59,ae=!0),_};function re(te,ge,H,Ce){te[ge++]=H;var oe=ge++,Oe=1<<H,Ee=Oe-1,be=Oe+1,Ie=be+1,Me=H+1,j=0,U=0;function Q(Te){for(;j>=Te;)te[ge++]=U&255,U>>=8,j-=8,ge===oe+256&&(te[oe]=255,oe=ge++)}function fe(Te){U|=Te<<j,j+=Me,Q(8)}var ee=Ce[0]&Ee,pe={};fe(Oe);for(var se=1,ue=Ce.length;se<ue;++se){var ce=Ce[se]&Ee,ve=ee<<8|ce,de=pe[ve];if(de===a){for(U|=ee<<j,j+=Me;j>=8;)te[ge++]=U&255,U>>=8,j-=8,ge===oe+256&&(te[oe]=255,oe=ge++);Ie===4096?(fe(Oe),Ie=be+1,Me=H+1,pe={}):(Ie>=1<<Me&&++Me,pe[ve]=Ie++),ee=ce}else ee=de}return fe(ee),fe(be),Q(1),oe+1===ge?te[oe]=0:(te[oe]=ge-oe-1,te[ge++]=0),ge}}var S=function(){},x=function(w){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=S,this.onRenderProgressCallback=S,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=w,this.initializeWebWorkers(w)};x.prototype={workerMethods:m(),initializeWebWorkers:function(w){var C=this,O=y.toString()+"("+m.toString()+"());",_=void 0,A=void 0,I=void 0,L=void 0,V=-1,Y="";for(L=w.numWorkers;++V<L;)_=o.createWebWorker(O),o.isObject(_)?(A=_.objectUrl,I=_.worker,C.workers.push({worker:I,objectUrl:A}),C.availableWorkers.push(I)):(Y=_,o.webWorkerError=!!_);this.workerError=Y,this.canvas=n.createElement("canvas"),this.canvas.width=w.gifWidth,this.canvas.height=w.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(w){this.availableWorkers.push(w)},byteMap:function(){for(var k=[],w=0;w<256;w++)k[w]=String.fromCharCode(w);return k}(),bufferToString:function(w){for(var C=w.length,O="",_=-1;++_<C;)O+=this.byteMap[w[_]];return O},onFrameFinished:function(w){var C=this,O=C.frames,_=C.options,A=!!(_.images||[]).length,I=O.every(function(L){return!L.beingProcessed&&L.done});C.numRenderedFrames++,A&&w(C.numRenderedFrames/O.length),C.onRenderProgressCallback(C.numRenderedFrames*.75/O.length),I?C.generatingGIF||C.generateGIF(O,C.onRenderCompleteCallback):o.requestTimeout(function(){C.processNextFrame()},1)},processFrame:function(w){var C=this;this.options;var O=this.options,_=O.progressCallback,A=O.sampleInterval,I=this.frames,L=void 0,V=void 0,Y=function(){var re=arguments.length>0&&arguments[0]!==a?arguments[0]:{},te=re.data;delete L.data,L.pixels=Array.prototype.slice.call(te.pixels),L.palette=Array.prototype.slice.call(te.palette),L.done=!0,L.beingProcessed=!1,C.freeWorker(V),C.onFrameFinished(_)};if(L=I[w],L.beingProcessed||L.done){this.onFrameFinished();return}L.sampleInterval=A,L.beingProcessed=!0,L.gifshot=!0,V=this.getWorker(),V?(V.onmessage=Y,V.postMessage(L)):Y({data:C.workerMethods.run(L)})},startRendering:function(w){this.onRenderCompleteCallback=w;for(var C=0;C<this.options.numWorkers&&C<this.frames.length;C++)this.processFrame(C)},processNextFrame:function(){for(var w=-1,C=0;C<this.frames.length;C++){var O=this.frames[C];if(!O.done&&!O.beingProcessed){w=C;break}}w>=0&&this.processFrame(w)},generateGIF:function(w,C){var O=[],_={loop:this.repeat},A=this.options,I=A.interval,L=A.frameDuration,V=A.images,Y=!!V.length,ae=A.gifHeight,re=A.gifWidth,te=new b(O,re,ae,_),ge=this.onRenderProgressCallback,H=Y?I*100:0,Ce=void 0,oe=void 0;this.generatingGIF=!0,o.each(w,function(Oe,Ee){var be=Ee.palette;ge(.75+.25*Ee.position*1/w.length);for(var Ie=0;Ie<L;Ie++)te.addFrame(0,0,re,ae,Ee.pixels,{palette:be,delay:H})}),te.end(),ge(1),this.frames=[],this.generatingGIF=!1,o.isFunction(C)&&(Ce=this.bufferToString(O),oe="data:image/gif;base64,"+o.btoa(Ce),C(oe))},setRepeat:function(w){this.repeat=w},addFrame:function(w,C){C=o.isObject(C)?C:{};var O=this,_=O.ctx,A=O.options,I=A.gifWidth,L=A.gifHeight,V=o.getFontSize(C),Y=C,ae=Y.filter,re=Y.fontColor,te=Y.fontFamily,ge=Y.fontWeight;Y.gifHeight,Y.gifWidth;var H=Y.text,Ce=Y.textAlign,oe=Y.textBaseline,Oe=C.textXCoordinate?C.textXCoordinate:Ce==="left"?1:Ce==="right"?I:I/2,Ee=C.textYCoordinate?C.textYCoordinate:oe==="top"?1:oe==="center"?L/2:L,be=ge+" "+V+" "+te,Ie=void 0;try{_.filter=ae,_.drawImage(w,0,0,I,L),H&&(_.font=be,_.fillStyle=re,_.textAlign=Ce,_.textBaseline=oe,_.fillText(H,Oe,Ee)),Ie=_.getImageData(0,0,I,L),O.addFrameImageData(Ie)}catch(Me){return""+Me}},addFrameImageData:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{},C=this.frames,O=w.data;this.frames.push({data:O,width:w.width,height:w.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:C.length})},onRenderProgress:function(w){this.onRenderProgressCallback=w},isRendering:function(){return this.generatingGIF},getBase64GIF:function(w){var C=this,O=function(A){C.destroyWorkers(),o.requestTimeout(function(){w(A)},0)};C.startRendering(O)},destroyWorkers:function(){if(!this.workerError){var w=this.workers;o.each(w,function(C,O){var _=O.worker,A=O.objectUrl;_.terminate(),o.URL.revokeObjectURL(A)})}}};function T(k,w){k.getBase64GIF(function(C){w({error:!1,errorCode:"",errorMsg:"",image:C})})}function E(){var k=arguments.length>0&&arguments[0]!==a?arguments[0]:{},w=k.callback,C=k.images,O=k.options,_=k.imagesLength,A={getUserMedia:!0,"window.URL":!0},I=l.validate(A),L=[],V=0,Y=void 0,ae=void 0;if(I.error)return w(I);ae=new x(O),o.each(C,function(te,ge){var H=ge;ge.src&&(H=H.src),o.isElement(H)?(O.crossOrigin&&(H.crossOrigin=O.crossOrigin),L[te]=H,V+=1,V===_&&re()):o.isString(H)&&(Y=new Image,O.crossOrigin&&(Y.crossOrigin=O.crossOrigin),function(Ce){ge.text&&(Ce.text=ge.text),Ce.onerror=function(oe){var Oe=void 0;if(--_,_===0)return Oe={},Oe.error="None of the requested images was capable of being retrieved",w(Oe)},Ce.onload=function(oe){ge.text?L[te]={img:Ce,text:Ce.text}:L[te]=Ce,V+=1,V===_&&re(),o.removeElement(Ce)},Ce.src=H}(Y),o.setCSSAttr(Y,{position:"fixed",opacity:"0"}),n.body.appendChild(Y))});function re(){o.each(L,function(te,ge){ge&&(ge.text?ae.addFrame(ge.img,O,ge.text):ae.addFrame(ge,O))}),T(ae,w)}}var P=function(){},R={getGIF:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{},C=arguments[1];C=o.isFunction(C)?C:P;var O=n.createElement("canvas"),_=void 0,A=w.images,I=!!A.length,L=w.cameraStream,V=w.crop,Y=w.filter,ae=w.fontColor,re=w.fontFamily,te=w.fontWeight,ge=w.keepCameraOn;w.numWorkers;var H=w.progressCallback,Ce=w.saveRenderingContexts,oe=w.savedRenderingContexts,Oe=w.text,Ee=w.textAlign,be=w.textBaseline,Ie=w.videoElement,Me=w.videoHeight,j=w.videoWidth,U=w.webcamVideoElement,Q=Number(w.gifWidth),fe=Number(w.gifHeight),ee=Number(w.interval);Number(w.sampleInterval);var pe=I?0:ee*1e3,se=[],ue=oe.length?oe.length:w.numFrames,ce=ue,ve=new x(w),de=o.getFontSize(w),Te=w.textXCoordinate?w.textXCoordinate:Ee==="left"?1:Ee==="right"?Q:Q/2,Le=w.textYCoordinate?w.textYCoordinate:be==="top"?1:be==="center"?fe/2:fe,$e=te+" "+de+" "+re,it=V?Math.floor(V.scaledWidth/2):0,yt=V?j-V.scaledWidth:0,Vt=V?Math.floor(V.scaledHeight/2):0,ut=V?Me-V.scaledHeight:0,ft=function Et(){var Ft=ce-1;oe.length?(_.putImageData(oe[ue-ce],0,0),wt()):Dt();function Dt(){try{yt>j&&(yt=j),ut>Me&&(ut=Me),it<0&&(it=0),Vt<0&&(Vt=0),_.filter=Y,_.drawImage(Ie,it,Vt,yt,ut,0,0,Q,fe),wt()}catch(dt){if(dt.name==="NS_ERROR_NOT_AVAILABLE")o.requestTimeout(Dt,100);else throw dt}}function wt(){var dt=void 0;Ce&&se.push(_.getImageData(0,0,Q,fe)),Oe&&(_.font=$e,_.fillStyle=ae,_.textAlign=Ee,_.textBaseline=be,_.fillText(Oe,Te,Le)),dt=_.getImageData(0,0,Q,fe),ve.addFrameImageData(dt),ce=Ft,H((ue-ce)/ue),Ft>0&&o.requestTimeout(Et,pe),ce||ve.getBase64GIF(function(Ke){C({error:!1,errorCode:"",errorMsg:"",image:Ke,cameraStream:L,videoElement:Ie,webcamVideoElement:U,savedRenderingContexts:se,keepCameraOn:ge})})}};ue=ue!==a?ue:10,ee=ee!==a?ee:.1,O.width=Q,O.height=fe,_=O.getContext("2d"),function Et(){if(!oe.length&&Ie.currentTime===0){o.requestTimeout(Et,100);return}ft()}()},getCropDimensions:function(){var w=arguments.length>0&&arguments[0]!==a?arguments[0]:{},C=w.videoWidth,O=w.videoHeight,_=w.gifWidth,A=w.gifHeight,I={width:0,height:0,scaledWidth:0,scaledHeight:0};return C>O?(I.width=Math.round(C*(A/O))-_,I.scaledWidth=Math.round(I.width*(O/A))):(I.height=Math.round(O*(_/C))-A,I.scaledHeight=Math.round(I.height*(C/_))),I}},M={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function k(w){k.attempts=k.attempts||0;var C=w.cameraStream,O=w.completedCallback,_=w.videoElement;_&&(_.videoWidth>0&&_.videoHeight>0?(_.removeEventListener("loadeddata",M.findVideoSize),O({videoElement:_,cameraStream:C,videoWidth:_.videoWidth,videoHeight:_.videoHeight})):k.attempts<10?(k.attempts+=1,o.requestTimeout(function(){M.findVideoSize(w)},400)):O({videoElement:_,cameraStream:C,videoWidth:M.defaultVideoDimensions.width,videoHeight:M.defaultVideoDimensions.height}))},onStreamingTimeout:function(w){o.isFunction(w)&&w({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(w){var C=o.isArray(w.existingVideo)?w.existingVideo[0]:w.existingVideo,O=w.cameraStream,_=w.completedCallback,A=w.streamedCallback,I=w.videoElement;if(o.isFunction(A)&&A(),C){if(o.isString(C))I.src=C,I.innerHTML='<source src="'+C+'" type="video/'+o.getExtension(C)+'" />';else if(C instanceof Blob){try{I.src=o.URL.createObjectURL(C)}catch{}I.innerHTML='<source src="'+C+'" type="'+C.type+'" />'}}else if(I.mozSrcObject)I.mozSrcObject=O;else if(o.URL)try{I.srcObject=O,I.src=o.URL.createObjectURL(O)}catch{I.srcObject=O}I.play(),o.requestTimeout(function L(){L.count=L.count||0,M.loadedData===!0?(M.findVideoSize({videoElement:I,cameraStream:O,completedCallback:_}),M.loadedData=!1):(L.count+=1,L.count>10?M.findVideoSize({videoElement:I,cameraStream:O,completedCallback:_}):L())},0)},startStreaming:function(w){var C=o.isFunction(w.error)?w.error:o.noop,O=o.isFunction(w.streamed)?w.streamed:o.noop,_=o.isFunction(w.completed)?w.completed:o.noop,A=w.crossOrigin,I=w.existingVideo,L=w.lastCameraStream,V=w.options,Y=w.webcamVideoElement,ae=o.isElement(I)?I:Y||n.createElement("video");A&&(ae.crossOrigin=V.crossOrigin),ae.autoplay=!0,ae.loop=!0,ae.muted=!0,ae.addEventListener("loadeddata",function(re){M.loadedData=!0,V.offset&&(ae.currentTime=V.offset)}),I?M.stream({videoElement:ae,existingVideo:I,completedCallback:_}):L?M.stream({videoElement:ae,cameraStream:L,streamedCallback:O,completedCallback:_}):o.getUserMedia({video:!0},function(re){M.stream({videoElement:ae,cameraStream:re,streamedCallback:O,completedCallback:_})},C)},startVideoStreaming:function(w){var C=arguments.length>1&&arguments[1]!==a?arguments[1]:{},O=C.timeout!==a?C.timeout:0,_=C.callback,A=C.webcamVideoElement,I=void 0;O>0&&(I=o.requestTimeout(function(){M.onStreamingTimeout(_)},1e4)),M.startStreaming({error:function(){_({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(I)},completed:function(){var V=arguments.length>0&&arguments[0]!==a?arguments[0]:{},Y=V.cameraStream,ae=V.videoElement,re=V.videoHeight,te=V.videoWidth;w({cameraStream:Y,videoElement:ae,videoHeight:re,videoWidth:te})},lastCameraStream:C.lastCameraStream,webcamVideoElement:A,crossOrigin:C.crossOrigin,options:C})},stopVideoStreaming:function(w){w=o.isObject(w)?w:{};var C=w,O=C.keepCameraOn,_=C.videoElement,A=C.webcamVideoElement,I=w.cameraStream||{},L=I.getTracks?I.getTracks()||[]:[],V=!!L.length,Y=L[0];!O&&V&&o.isFunction(Y.stop)&&Y.stop(),o.isElement(_)&&!A&&(_.pause(),o.isFunction(o.URL.revokeObjectURL)&&!o.webWorkerError&&_.src&&o.URL.revokeObjectURL(_.src),o.removeElement(_))}};function D(k){k=o.isObject(k)?k:{},M.stopVideoStreaming(k)}function N(k,w){var C=k.options||{},O=C.images,_=C.video,A=Number(C.gifWidth),I=Number(C.gifHeight);Number(C.numFrames);var L=k.cameraStream,V=k.videoElement,Y=k.videoWidth,ae=k.videoHeight,re=R.getCropDimensions({videoWidth:Y,videoHeight:ae,gifHeight:I,gifWidth:A}),te=w;C.crop=re,C.videoElement=V,C.videoWidth=Y,C.videoHeight=ae,C.cameraStream=L,o.isElement(V)&&(V.width=A+re.width,V.height=I+re.height,C.webcamVideoElement||(o.setCSSAttr(V,{position:"fixed",opacity:"0"}),n.body.appendChild(V)),V.play(),R.getGIF(C,function(ge){(!O||!O.length)&&(!_||!_.length)&&D(ge),te(ge)}))}function B(){var k=arguments.length>0&&arguments[0]!==a?arguments[0]:{},w=k.callback,C=k.existingVideo,O=k.options,_={getUserMedia:!0,"window.URL":!0},A=l.validate(_),I=void 0,L=void 0;if(A.error)return w(A);if(o.isElement(C)&&C.src){if(L=C.src,I=o.getExtension(L),!o.isSupported.videoCodecs[I])return w(l.messages.videoCodecs)}else o.isArray(C)&&o.each(C,function(V,Y){if(Y instanceof Blob?I=Y.type.substr(Y.type.lastIndexOf("/")+1,Y.length):I=Y.substr(Y.lastIndexOf(".")+1,Y.length),o.isSupported.videoCodecs[I])return C=Y,!1});M.startStreaming({completed:function(Y){Y.options=O||{},N(Y,w)},existingVideo:C,crossOrigin:O.crossOrigin,options:O})}function K(){var k=arguments.length>0&&arguments[0]!==a?arguments[0]:{},w=k.callback,C=k.lastCameraStream,O=k.options,_=k.webcamVideoElement;if(!v())return w(l.validate());if(O.savedRenderingContexts.length){R.getGIF(O,function(A){w(A)});return}M.startVideoStreaming(function(){var A=arguments.length>0&&arguments[0]!==a?arguments[0]:{};A.options=O||{},N(A,w)},{lastCameraStream:C,callback:w,webcamVideoElement:_,crossOrigin:O.crossOrigin})}function Z(k,w){if(w=o.isFunction(k)?k:w,k=o.isObject(k)?k:{},!!o.isFunction(w)){var C=o.mergeOptions(c,k)||{},O=k.cameraStream,_=C.images,A=_?_.length:0,I=C.video,L=C.webcamVideoElement;C=o.mergeOptions(C,{gifWidth:Math.floor(C.gifWidth),gifHeight:Math.floor(C.gifHeight)}),A?E({images:_,imagesLength:A,callback:w,options:C}):I?B({existingVideo:I,callback:w,options:C}):K({lastCameraStream:O,callback:w,webcamVideoElement:L,options:C})}}function ie(k,w){if(w=o.isFunction(k)?k:w,k=o.isObject(k)?k:{},!!o.isFunction(w)){var C=o.mergeOptions(c,k),O=o.mergeOptions(C,{interval:.1,numFrames:1,gifWidth:Math.floor(C.gifWidth),gifHeight:Math.floor(C.gifHeight)});Z(O,w)}}var me={utils:s,error:u,defaultOptions:h,createGIF:Z,takeSnapShot:ie,stopVideoStreaming:D,isSupported:d,isWebCamGIFSupported:v,isExistingVideoGIFSupported:g,isExistingImagesGIFSupported:p,VERSION:"0.4.5"};typeof a=="function"&&a.amd?a([],function(){return me}):e.exports=me})(typeof window<"u"?window:{},typeof document<"u"?document:{createElement:function(){}},typeof window<"u"?window.navigator:{})})(f2t);const c2t=OL,h2t={class:"preview-block"},d2t={class:"v-chart-box"},v2t={key:0,class:"iconfont icon-weibiaoti519"},p2t={key:1,class:"iconfont icon-bofang"},g2t=_i({__name:"previewBlock",setup(e){Vu([yIt,Jkt,aPt,TAt,WAt,UIt,VIt,wMt,oMt]),e4("westeros",pSt),sZ(FMt,"westeros");const t=xl(fs),r=to(()=>~t.value.type.indexOf(Oce)),n=Mn(null),i=Mn(!1),a=Mn(!1);let o=[],s=null;jf(()=>IS.value,d=>{i.value=d==="start",a.value&&d==="end"&&h()},{deep:!0}),jf(()=>t.value.config,d=>{TL()},{deep:!0});const l=to(()=>t!=null&&t.value.id?r.value?rZ(t.value,0):t2t(t.value):{}),u=()=>{i.value=!i.value,i.value?nZ(t.value,f):l2t()},f=d=>{WC(()=>{var p;const v=(p=n.value)==null?void 0:p.setOption;v&&v(rZ(t.value,d))})},c=()=>{o=[],s=setInterval(()=>{var v;const d=(v=n.value)==null?void 0:v.getDataURL({type:"png",pixelRatio:3,backgroundColor:t.value.config.backgroundColor});o.push(d)},100)},h=()=>{clearInterval(s),!(!o.length||!a.value)&&(c2t.createGIF({gifWidth:1e3,gifHeight:630,interval:.1,images:o},d=>{if(!d.error){const v=d.image;console.log("src: ",v),iZ(t.value,v,"gif"),o=[],Oa.emit("chartLoading",!1)}}),a.value=!1)};return Oa.on("handleChart",d=>{r.value?(Oa.emit("chartLoading",!0),TL(),nZ(t.value,f),a.value=!0,c()):WC(()=>{var p;Oa.emit("chartLoading",!0);const v=(p=n.value)==null?void 0:p.getDataURL({type:"png",pixelRatio:10,backgroundColor:t.value.config.backgroundColor});iZ(t.value,v,"png"),setTimeout(()=>{Oa.emit("chartLoading",!1)},1e3)})}),oZ(()=>{o=[],clearInterval(s)}),(d,v)=>(tr(),Cr("div",h2t,[Ct("div",d2t,[Kr(Rr($Mt),{ref_key:"chartRef",ref:n,class:"chart",autoresize:"",option:Rr(l)},null,8,["option"]),Rr(r)?(tr(),Cr("div",{key:0,class:"play-btn",onClick:u},[i.value?(tr(),Cr("i",v2t)):(tr(),Cr("i",p2t))])):rv("",!0)])]))}});const y2t=Da(g2t,[["__scopeId","data-v-1968d3ac"]]),wce=e=>(EL("data-v-adddbc27"),e=e(),RL(),e),m2t=wce(()=>Ct("i",{class:"iconfont icon-fanhui"},null,-1)),b2t=wce(()=>Ct("i",{class:"iconfont icon-fanhui"},null,-1)),w2t={class:"content"},S2t=_i({__name:"widget",props:{title:{type:String,default:"æ é¢"},tooltip:{type:String,default:""},open:{type:Boolean,default:!1}},setup(e){const t=e,r=Mn(!1),n=()=>{r.value=!r.value};return Jc(()=>{r.value=t.open}),(i,a)=>{const o=co("el-tooltip");return tr(),Cr("div",{class:Lf(["widget",{open:r.value}])},[e.tooltip?(tr(),mg(o,{key:0,effect:"dark",content:e.tooltip,placement:"left"},{default:ho(()=>[Ct("div",{class:"top",onClick:n},[Ct("div",null,Xm(e.title),1),m2t])]),_:1},8,["content"])):(tr(),Cr("div",{key:1,class:"top",onClick:n},[Ct("div",null,Xm(e.title),1),b2t])),Ct("div",w2t,[aZ(i.$slots,"default",{},void 0,!0)])],2)}}});const b4=Da(S2t,[["__scopeId","data-v-adddbc27"]]),JT=(e,t,r)=>{const n=Qi.cloneDeep(e),{config:i}=n;i[t]=Qi.isObject(r)?Qi.cloneDeep(r):r,console.log("config[key]: ",i[t]),Oa.emit("updateChart",n)},_2t={class:"wrapper"},C2t=_i({__name:"title",setup(e){const t=xl(fs),r=Mn({}),n=Mn(["#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"]),i=()=>{const{config:o}=t.value;r.value={...o==null?void 0:o.title}},a=()=>{JT(t.value,"title",r.value)};return Jc(()=>{i()}),(o,s)=>{const l=co("el-checkbox"),u=co("el-input"),f=co("el-color-picker");return tr(),mg(Rr(b4),{title:"æ é¢",tooltip:"è®¾ç½®å¾è¡¨æ é¢"},{default:ho(()=>[Ct("div",_2t,[Kr(l,{modelValue:r.value.show,"onUpdate:modelValue":s[0]||(s[0]=c=>r.value.show=c),label:"",size:"small",onChange:a},null,8,["modelValue"]),Kr(u,{modelValue:r.value.value,"onUpdate:modelValue":s[1]||(s[1]=c=>r.value.value=c),size:"small",onInput:a},null,8,["modelValue"]),Kr(f,{modelValue:r.value.color,"onUpdate:modelValue":s[2]||(s[2]=c=>r.value.color=c),size:"small",predefine:n.value,onChange:a},null,8,["modelValue","predefine"])])]),_:1})}}});const x2t=Da(C2t,[["__scopeId","data-v-c87806e1"]]),T2t={class:"wrapper"},O2t=["onClick"],E2t={class:"background-color"},R2t=_i({__name:"theme",setup(e){const t=xl(fs),r=Mn(["#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgba(255, 69, 0, 0.68)","rgb(255, 120, 0)","#c7158577"]),n=Mn({theme:"",backgroundColor:"#ffffff"}),i=()=>{const{config:l}=t.value;n.value.theme=(l==null?void 0:l.theme)||"westeros",n.value.backgroundColor=(l==null?void 0:l.backgroundColor)||"#ffffff"},a=l=>l.filter((u,f)=>f<6),o=l=>{n.value.theme=l,JT(t.value,"theme",n.value.theme)},s=()=>{JT(t.value,"backgroundColor",n.value.backgroundColor)};return Jc(()=>{i()}),(l,u)=>{const f=co("el-color-picker");return tr(),mg(Rr(b4),{title:"ä¸»é¢",tooltip:"è®¾ç½®å¾è¡¨ä¸»é¢"},{default:ho(()=>[Ct("div",T2t,[(tr(!0),Cr(om,null,sm(Rr(ZMt),c=>(tr(),Cr("div",{key:c.value,class:Lf(["theme",{active:c.value===n.value.theme}]),onClick:h=>o(c.value)},[(tr(!0),Cr(om,null,sm(a(c.color),h=>(tr(),Cr("div",{key:h,style:Fce({background:h}),class:"color"},null,4))),128))],10,O2t))),128)),Ct("div",E2t,[Km(" ç»å¸é¢è² "),Kr(f,{modelValue:n.value.backgroundColor,"onUpdate:modelValue":u[0]||(u[0]=c=>n.value.backgroundColor=c),"show-alpha":"",predefine:r.value,onChange:s},null,8,["modelValue","predefine"])])])]),_:1})}}});const k2t=Da(R2t,[["__scopeId","data-v-b8ad6e19"]]),A2t={class:"wrapper"},P2t=_i({__name:"legend",setup(e){const t=xl(fs),r=Mn({legend:!0}),n=()=>{const{config:a}=t.value;r.value.legend=a==null?void 0:a.legend},i=()=>{JT(t.value,"legend",r.value.legend)};return Jc(()=>{n()}),(a,o)=>{const s=co("el-checkbox");return tr(),mg(Rr(b4),{title:"å¾ä¾",tooltip:"é¢è²æä»£è¡¨åå®¹ä¸ææ è¯´æ"},{default:ho(()=>[Ct("div",A2t,[Kr(s,{modelValue:r.value.legend,"onUpdate:modelValue":o[0]||(o[0]=l=>r.value.legend=l),label:"å¾ä¾æ¾ç¤º",size:"small",onChange:i},null,8,["modelValue"])])]),_:1})}}});const I2t=Da(P2t,[["__scopeId","data-v-970e77c3"]]),M2t={class:"setting"},D2t=_i({__name:"setting",setup(e){return xl(fs),(t,r)=>(tr(),Cr("div",M2t,[Kr(Rr(x2t),{open:!0}),Kr(Rr(k2t),{open:!0}),Kr(Rr(I2t),{open:!0})]))}});const N2t=Da(D2t,[["__scopeId","data-v-518ab403"]]),L2t={class:"setting-block"},F2t={class:"chart-setting"},$2t=_i({__name:"settingBlock",setup(e){xl(fs);const t=Mn("setting");return(r,n)=>(tr(),Cr("div",L2t,[UC(Ct("div",F2t,[Kr(Rr(N2t))],512),[[rI,t.value==="setting"]])]))}});const H2t=Da($2t,[["__scopeId","data-v-eefe544e"]]),B2t=["loading"],V2t={key:1,class:"container"},j2t=_i({__name:"chart",setup(e){const t=Ece(),r=$ce(),n=to(()=>+r.params.id),i=Mn({}),a=Mn(!0),o=async()=>{const l=await t.get(n.value);i.value=l};sZ(fs,Hce(i)),Oa.on("updateChart",async l=>{l.updatedTime=new Date().getTime(),await t.set(l),await o(),s()});const s=()=>{new BroadcastChannel("chart").postMessage("updateChart")};return Jc(async()=>{var l;await o(),a.value=!1,(l=document.querySelector("html"))==null||l.classList.add("dark")}),(l,u)=>(tr(),Cr("div",{class:"chart-wrapper",loading:a.value},[a.value?rv("",!0):(tr(),mg(Rr(Zwt),{key:0})),a.value?rv("",!0):(tr(),Cr("div",V2t,[Kr(Rr(fSt)),Kr(Rr(y2t)),Kr(Rr(H2t))])),Kr(Rr(vSt))],8,B2t))}});const z2t=Da(j2t,[["__scopeId","data-v-422f22e1"]]);export{z2t as default};
