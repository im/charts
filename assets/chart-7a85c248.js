import{d as F,c as Y,o as k,g as V,f as K,i as W,_ as X,y as H}from"./index-744e9c01.js";function G(e){return{all:e=e||new Map,on:function(t,n){var s=e.get(t);s?s.push(n):e.set(t,[n])},off:function(t,n){var s=e.get(t);s&&(n?s.splice(s.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var s=e.get(t);s&&s.slice().map(function(r){r(n)}),(s=e.get("*"))&&s.slice().map(function(r){r(t,n)})}}}const he=G(),v="/charts/assets/DYNAMIC_LINE_BAR_MIX-a5981d26.gif",R="/charts/assets/DYNAMIC_RANKING_BAR-097dd3db.gif",x="/charts/assets/LINE_BASICS-35682591.gif",$="/charts/assets/folder-big-144a6fca.svg",U="/charts/assets/plus-6fef50b3.svg",ge=e=>new URL(Object.assign({"../assets/images/charts/DYNAMIC_LINE_BAR_MIX.gif":v,"../assets/images/charts/DYNAMIC_RANKING_BAR.gif":R,"../assets/images/charts/LINE_BASICS.gif":x,"../assets/images/folder-big.svg":$,"../assets/images/plus.svg":U})[`../assets/images/${e}`],self.location).href,z=e=>new URL(Object.assign({"../assets/images/charts/DYNAMIC_LINE_BAR_MIX.gif":v,"../assets/images/charts/DYNAMIC_RANKING_BAR.gif":R,"../assets/images/charts/LINE_BASICS.gif":x})[`../assets/images/charts/${e}`],self.location).href,J=F({__name:"previewImage",props:{chart:{type:Object,default:()=>({})}},setup(e){const t=e,n=Y(()=>z((t.chart.value||t.chart.type)+".gif"));return(s,r)=>{const a=W("el-image");return k(),V(a,{src:K(n),fit:"cover"},null,8,["src"])}}});const me=X(J,[["__scopeId","data-v-a7a00566"]]),p="DYNAMIC",L="LINE",A={[p]:"动态图表",[L]:"线形图"},B={[p+"_RANKING_BAR"]:"动态排名变化图",[p+"_LINE_BAR_MIX"]:"动态折线条形混合图",[L+"_BASICS"]:"基础折线图"},Q=Object.keys(B).map(e=>({label:B[e],value:e})),pe=()=>Object.keys(A).map(e=>({label:A[e],value:e,children:Q.filter(t=>{const n=t.value.indexOf(e);return~n&&n===0})})),D=(e,t)=>t.some(n=>e instanceof n);let C,E;function Z(){return C||(C=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function q(){return E||(E=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const P=new WeakMap,w=new WeakMap,T=new WeakMap,g=new WeakMap,h=new WeakMap;function ee(e){const t=new Promise((n,s)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",o)},a=()=>{n(c(e.result)),r()},o=()=>{s(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&P.set(n,e)}).catch(()=>{}),h.set(t,e),t}function te(e){if(w.has(e))return;const t=new Promise((n,s)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",o),e.removeEventListener("abort",o)},a=()=>{n(),r()},o=()=>{s(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",o),e.addEventListener("abort",o)});w.set(e,t)}let y={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return w.get(e);if(t==="objectStoreNames")return e.objectStoreNames||T.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return c(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function O(e){y=e(y)}function ne(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const s=e.call(I(this),t,...n);return T.set(s,t.sort?t.sort():[t]),c(s)}:q().includes(e)?function(...t){return e.apply(I(this),t),c(P.get(this))}:function(...t){return c(e.apply(I(this),t))}}function se(e){return typeof e=="function"?ne(e):(e instanceof IDBTransaction&&te(e),D(e,Z())?new Proxy(e,y):e)}function c(e){if(e instanceof IDBRequest)return ee(e);if(g.has(e))return g.get(e);const t=se(e);return t!==e&&(g.set(e,t),h.set(t,e)),t}const I=e=>h.get(e);function re(e,t,{blocked:n,upgrade:s,blocking:r,terminated:a}={}){const o=indexedDB.open(e,t),d=c(o);return s&&o.addEventListener("upgradeneeded",i=>{s(c(o.result),i.oldVersion,i.newVersion,c(o.transaction),i)}),n&&o.addEventListener("blocked",i=>n(i.oldVersion,i.newVersion,i)),d.then(i=>{a&&i.addEventListener("close",()=>a()),r&&i.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),d}const oe=["get","getKey","getAll","getAllKeys","count"],ae=["put","add","delete","clear"],m=new Map;function M(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(m.get(t))return m.get(t);const n=t.replace(/FromIndex$/,""),s=t!==n,r=ae.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||oe.includes(n)))return;const a=async function(o,...d){const i=this.transaction(o,r?"readwrite":"readonly");let u=i.store;return s&&(u=u.index(d.shift())),(await Promise.all([u[n](...d),r&&i.done]))[0]};return m.set(t,a),a}O(e=>({...e,get:(t,n,s)=>M(t,n)||e.get(t,n,s),has:(t,n)=>!!M(t,n)||e.has(t,n)}));const ie=["continue","continuePrimaryKey","advance"],N={},b=new WeakMap,j=new WeakMap,ce={get(e,t){if(!ie.includes(t))return e[t];let n=N[t];return n||(n=N[t]=function(...s){b.set(this,j.get(this)[t](...s))}),n}};async function*ue(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,ce);for(j.set(n,t),h.set(n,I(t));t;)yield n,t=await(b.get(n)||t.continue()),b.delete(n)}function S(e,t){return t===Symbol.asyncIterator&&D(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&D(e,[IDBIndex,IDBObjectStore])}O(e=>({...e,get(t,n,s){return S(t,n)?ue:e.get(t,n,s)},has(t,n){return S(t,n)||e.has(t,n)}}));const de="chart",fe=1,_e="folder",f="chart";let _=null;const le=()=>_||(_=re(de,fe,{upgrade(e){e.createObjectStore(f,{keyPath:"id",autoIncrement:!0}).createIndex("id","id",{unique:!0}),e.createObjectStore(_e,{keyPath:"id",autoIncrement:!0}).createIndex("id","id",{unique:!0})}}),_),l=le(),De=H("Chart",{state:()=>({list:[]}),actions:{async update(){const e=await(await l).getAllFromIndex(f,"id");this.list=(e||[]).sort((t,n)=>n.updatedTime-t.updatedTime)},async get(e){return await(await l).transaction(f,"readwrite").store.get(+e)},async set(e){const t=(await l).transaction(f,"readwrite");if(e.id){const n=t.store.index("id");for await(const s of n.iterate(e.id)){const r=Object.assign(s.value,e);s.update(r)}return await t.done,e.id}else{const n=await t.store.add(e);return this.update(),await t.done,n}},async del(e){await(await l).delete(f,e),this.update()}}});export{le as D,_e as F,me as P,pe as a,he as e,ge as g,De as u};
